<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ã€æœå‡ºæ¥çš„æ–‡æœ¬ã€‘â‹…ï¼ˆäºŒï¼‰ä»MCMCåˆ°æ¨¡æ‹Ÿé€€ç«</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ã€æœå‡ºæ¥çš„æ–‡æœ¬ã€‘â‹…ï¼ˆäºŒï¼‰ä»MCMCåˆ°æ¨¡æ‹Ÿé€€ç«</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-12-31 | ğŸ“„ å¤§å°: 24.9 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8084">https://spaces.ac.cn/archives/8084</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†â€œå—é™æ–‡æœ¬ç”Ÿæˆâ€è¿™ä¸ªæ¦‚å¿µï¼ŒæŒ‡å‡ºå¯ä»¥é€šè¿‡é‡åŒ–ç›®æ ‡å¹¶ä»ä¸­é‡‡æ ·çš„æ–¹å¼æ¥æ— ç›‘ç£åœ°å®ŒæˆæŸäº›å¸¦æ¡ä»¶çš„æ–‡æœ¬ç”Ÿæˆä»»åŠ¡ã€‚åŒæ—¶ï¼Œä¸Šä¸€ç¯‡æ–‡ç« è¿˜ä»‹ç»äº†â€œé‡è¦æ€§é‡‡æ ·â€å’Œâ€œæ‹’ç»é‡‡æ ·â€ä¸¤ä¸ªæ–¹æ³•ï¼Œå¹¶ä¸”æŒ‡å‡ºå¯¹äºé«˜ç»´ç©ºé—´è€Œè¨€ï¼Œå®ƒä»¬æ‰€ä¾èµ–çš„æ˜“äºé‡‡æ ·çš„åˆ†å¸ƒå¾€å¾€éš¾ä»¥è®¾è®¡ï¼Œå¯¼è‡´å®ƒä»¬éš¾ä»¥æ»¡è¶³æˆ‘ä»¬çš„é‡‡æ ·éœ€æ±‚ã€‚</p>
<p>æ­¤æ—¶ï¼Œæˆ‘ä»¬å°±éœ€è¦å¼•å…¥é‡‡æ ·ç•Œæœ€é‡è¦çš„ç®—æ³•ä¹‹ä¸€â€œMarkov Chain Monte Carloï¼ˆMCMCï¼‰â€æ–¹æ³•äº†ï¼Œå®ƒå°†é©¬å°”å¯å¤«é“¾å’Œè’™ç‰¹å¡æ´›æ–¹æ³•ç»“åˆèµ·æ¥ï¼Œä½¿å¾—ï¼ˆè‡³å°‘ç†è®ºä¸Šæ˜¯è¿™æ ·ï¼‰æˆ‘ä»¬ä»å¾ˆå¤šé«˜ç»´åˆ†å¸ƒä¸­è¿›è¡Œé‡‡æ ·æˆä¸ºå¯èƒ½ï¼Œä¹Ÿæ˜¯åé¢æˆ‘ä»¬ä»‹ç»çš„å—é™æ–‡æœ¬ç”Ÿæˆåº”ç”¨çš„é‡è¦åŸºç¡€ç®—æ³•ä¹‹ä¸€ã€‚æœ¬æ–‡è¯•å›¾å¯¹å®ƒåšä¸€ä¸ªåŸºæœ¬çš„ä»‹ç»ã€‚</p>
<h2 id="_1">é©¬å°”å¯å¤«é“¾</h2>
<p>é©¬å°”å¯å¤«é“¾å®é™…ä¸Šå°±æ˜¯ä¸€ç§â€œæ— è®°å¿†â€çš„éšæœºæ¸¸èµ°è¿‡ç¨‹ï¼Œå®ƒä»¥è½¬ç§»æ¦‚ç‡$p(\boldsymbol{y}\leftarrow\boldsymbol{x})$ä¸ºåŸºç¡€ï¼Œä»ä¸€ä¸ªåˆå§‹çŠ¶æ€$\boldsymbol{x}_0$å‡ºå‘ï¼Œæ¯ä¸€æ­¥å‡é€šè¿‡è¯¥è½¬ç§»æ¦‚ç‡éšæœºé€‰æ‹©ä¸‹ä¸€ä¸ªçŠ¶æ€ï¼Œä»è€Œæ„æˆéšæœºçŠ¶æ€åˆ—$\boldsymbol{x}_0, \boldsymbol{x}_1, \boldsymbol{x}_2, \cdots, \boldsymbol{x}_t, \cdots $ï¼Œæˆ‘ä»¬å¸Œæœ›è€ƒå¯Ÿå¯¹äºè¶³å¤Ÿå¤§çš„æ­¥æ•°$t$ï¼Œ$\boldsymbol{x}_t$æ‰€æœä»çš„åˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯è¯¥é©¬å°”å¯å¤«é“¾çš„â€œå¹³ç¨³åˆ†å¸ƒâ€ã€‚</p>
<p>$\setCounter{11}$å‡è®¾$\boldsymbol{x}<em t_1="t+1">t$æ‰€æœä»çš„åˆ†å¸ƒä¸º$p^{(t)}(\boldsymbol{x}_t)$ï¼Œé‚£ä¹ˆ$\boldsymbol{x}</em>$æ‰€æœä»çš„åˆ†å¸ƒå°±æ˜¯<br />
\begin{equation}p^{(t+1)}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">{t+1}) = \sum</em><em t_1="t+1">t} p(\boldsymbol{x}</em>} \leftarrow \boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t)p^{(t)}(\boldsymbol{x}_t)\end{equation}<br />
å¦‚æœå·²ç»è¾¾åˆ°å¹³è¡¡ï¼Œé‚£ä¹ˆåº”è¯¥æœ‰$p^{(t+1)}=p^{(t)}$ï¼Œæ‰€ä»¥å¦‚æœ$p(\boldsymbol{x})$æ˜¯å¹³ç¨³åˆ†å¸ƒï¼Œé‚£ä¹ˆå®ƒæ»¡è¶³<br />
\begin{equation}p(\boldsymbol{y}) = \sum</em>}} p(\boldsymbol{y} \leftarrow \boldsymbol{x})p(\boldsymbol{x})\label{eq:stable}\end{equation<br />
æˆ–è€…è¯´ï¼Œå¹³ç¨³åˆ†å¸ƒå°±æ˜¯ä¸Šè¿°å…³äº$p(\boldsymbol{x})$çš„æ–¹ç¨‹çš„éé›¶è§£ã€‚</p>
<p>é‚£ä¹ˆï¼Œæœ‰ä¸€ä¸ªéœ€è¦å›ç­”çš„é—®é¢˜æ˜¯ï¼šä¸Šè¿°æ–¹ç¨‹çš„éé›¶è§£å”¯ä¸€å—ï¼Ÿè¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆå…³ç³»åˆ°é©¬å°”å¯å¤«é“¾çš„å¹³ç¨³åˆ†å¸ƒ <em>æ˜¯å¦ä¾èµ–äºåˆå§‹çŠ¶æ€$\boldsymbol{x}_0$</em> ã€‚å¾ˆé—æ†¾ï¼Œç­”æ¡ˆæ˜¯ä¸ä¸€å®šã€‚ç®€å•æ¥è¯´ï¼Œéé›¶è§£å”¯ä¸€çš„æ¡ä»¶æ˜¯è¯¥é©¬å°”å¯å¤«é“¾çš„ä»»æ„ä¸¤ä¸ªçŠ¶æ€éƒ½æ˜¯è¿é€šçš„ï¼Œè¯´å…·ä½“ç‚¹å°±æ˜¯å¯¹äºä»»æ„ä¸¤ä¸ªçŠ¶æ€$\boldsymbol{x},\boldsymbol{y}$ï¼Œå­˜åœ¨çŠ¶æ€é“¾$\boldsymbol{x}=\boldsymbol{x}<em n-1="n-1">0,\boldsymbol{x}_1,\cdots,\boldsymbol{x}</em>},\boldsymbol{x<em 1="1">n=\boldsymbol{y}$ï¼Œä½¿å¾—<br />
\begin{equation}\begin{aligned}<br />
&amp;p(\boldsymbol{x}</em>} \leftarrow \boldsymbol{x<em 2="2">0) &gt; 0 \\\<br />
&amp;p(\boldsymbol{x}</em>} \leftarrow \boldsymbol{x<em n="n">1) &gt; 0 \\\<br />
&amp;\qquad\vdots \\\<br />
&amp;p(\boldsymbol{x}</em>) &gt; 0} \leftarrow \boldsymbol{x}_{n-1<br />
\end{aligned}\end{equation}<br />
è¯´ç™½äº†ï¼Œå°±æ˜¯ä»çŠ¶æ€$\boldsymbol{x}$è·³è½¬åˆ°$\boldsymbol{y}$ï¼ˆä¸è¦æ±‚ä¸€æ­¥åˆ°ä½ï¼Œå¯ä»¥å¤šæ­¥ï¼‰çš„æ¦‚ç‡å¤§äº0ã€‚å…¶å®è¿™ä¸ªåˆ¤æ®ä¹Ÿä¸éš¾ç†è§£ï¼Œå½¢è±¡æ¯”å–»å°±æ˜¯æŒ‡å¹³ç¨³åˆ†å¸ƒå”¯ä¸€çš„æ¡ä»¶æ˜¯é©¬å°”å¯å¤«é“¾ä¸èƒ½å­˜åœ¨â€œå­¤å²›â€ï¼Œè¦ä¸ç„¶å¦‚æœ$\boldsymbol{x}_0$åœ¨å­¤å²›å†…ï¼Œé‚£ä¹ˆå°±æ°¸è¿œåœ¨å­¤å²›å†…æ¸¸èµ°äº†ï¼Œå¦‚æœ$\boldsymbol{x}_0$åœ¨å­¤å²›å¤–ï¼Œé‚£ä¹ˆä¹Ÿå°±æ°¸è¿œåœ¨å­¤å²›å¤–æ¸¸èµ°äº†ï¼Œä»è€Œä¸åŒçš„åˆå§‹çŠ¶æ€å¯¼è‡´äº†ä¸åŒçš„å¹³ç¨³åˆ†å¸ƒã€‚</p>
<h2 id="_2">ç»†è‡´å¹³ç¨³</h2>
<p>ç”±äºé©¬å°”å¯å¤«é“¾å­˜åœ¨ä¸€ä¸ªå¹³ç¨³åˆ†å¸ƒï¼Œè€Œæ„å»ºé©¬å°”å¯å¤«é“¾åˆ™åªéœ€è¦ä¸€ä¸ªè½¬ç§»çŸ©é˜µï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªæ˜“äºé‡‡æ ·çš„è½¬ç§»çŸ©é˜µï¼Œå¹¶ä¸”å®ƒçš„å¹³ç¨³åˆ†å¸ƒå°±æ˜¯æˆ‘ä»¬è¦é‡‡æ ·çš„åˆ†å¸ƒ$p(\boldsymbol{x})$ï¼Œé‚£ä¹ˆè¿­ä»£è¶³å¤Ÿå¤šæ­¥åï¼Œä¸å°±ç›¸å½“äºä»$p(\boldsymbol{x})$ä¸­é‡‡æ ·äº†ï¼Ÿè¿™å°±æ˜¯æ‰€æœ‰MCMCæ–¹æ³•çš„æ€æƒ³ã€‚å½“ç„¶ï¼Œé©¬å°”å¯å¤«é“¾å¾€å¾€éœ€è¦è¿­ä»£å¤šæ­¥æ‰èƒ½è¾¾åˆ°å¹³ç¨³ï¼Œå› æ­¤é‡‡æ ·å¾€å¾€æ¯”è¾ƒè´¹æ—¶ï¼Œä½†å³ä¾¿å¦‚æ­¤ï¼Œç»ˆç©¶èƒ½åœ¨æœ‰é™æˆæœ¬å†…å®Œæˆäº†é‡‡æ ·è¿‡ç¨‹ï¼Œå› æ­¤åœ¨å¾ˆå¤šæƒ…å†µä¸‹ä¾ç„¶æ˜¯å®ç”¨çš„ã€‚</p>
<p>å‡è®¾MCMCæ˜¯å¯è¡Œçš„ï¼Œé‚£ä¹ˆå¾ˆæ˜¾ç„¶å…³é”®ä¹‹å¤„å°±æ˜¯å¦‚ä½•æ„é€ å‡ºä¸€ä¸ªè½¬ç§»æ¦‚ç‡$p(\boldsymbol{y}\leftarrow\boldsymbol{x})$ï¼Œä½¿å¾—å®ƒçš„å¹³ç¨³åˆ†å¸ƒæ˜¯æˆ‘ä»¬ç»™å®šçš„åˆ†å¸ƒ$p(\boldsymbol{x})$ï¼ŒåŒæ—¶ï¼Œæ ¹æ®ä¸Šä¸€ç¯‡æ–‡ç« çš„ä»‹ç»ï¼Œæˆ‘ä»¬å¾€å¾€åªçŸ¥é“è·Ÿ$p(\boldsymbol{x})$æˆæ­£æ¯”çš„$\rho(\boldsymbol{x})$ï¼Œè€Œ <em>ä¸çŸ¥é“å½’ä¸€åŒ–å› å­</em> ï¼Œå› æ­¤æ„å»º$p(\boldsymbol{y}\leftarrow\boldsymbol{x})$çš„è¿‡ç¨‹ä¸­ï¼Œä¸èƒ½ä¾èµ–äº$p(\boldsymbol{x})$çš„å½’ä¸€åŒ–å› å­ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬éœ€è¦ç”¨åˆ°ä¸€ä¸ªâ€œç»†è‡´å¹³ç¨³æ¡ä»¶â€ï¼š</p>
<blockquote>
<p><strong>ç»†è‡´å¹³ç¨³æ¡ä»¶</strong> å¦‚æœåˆ†å¸ƒ$p(\boldsymbol{x})$å’Œè½¬ç§»æ¦‚ç‡$p(\boldsymbol{y}\leftarrow\boldsymbol{x})$æ»¡è¶³æ’ç­‰å¼\begin{equation}p(\boldsymbol{y}\leftarrow\boldsymbol{x})p(\boldsymbol{x})=p(\boldsymbol{x}\leftarrow\boldsymbol{y})p(\boldsymbol{y})\end{equation} é‚£ä¹ˆ$p(\boldsymbol{x})$å°±æ˜¯$p(\boldsymbol{y}\leftarrow\boldsymbol{x})$çš„å¹³ç¨³åˆ†å¸ƒã€‚</p>
</blockquote>
<p>åå­—çœ‹ä¸Šå»é«˜ç«¯ï¼Œå®é™…ä¸Šå®ƒéå¸¸å®¹æ˜“è¯æ˜ï¼Œåªè¦ä¸¤ç«¯å¯¹$\boldsymbol{x}$æ±‚å’Œï¼Œé©¬ä¸Šå°±å¾—åˆ°å¼$\eqref{eq:stable}$äº†ï¼Œæ»¡è¶³å¼$\eqref{eq:stable}$å°±è¯´æ˜$p(\boldsymbol{x})$æ˜¯$p(\boldsymbol{y}\leftarrow\boldsymbol{x})$çš„å¹³ç¨³åˆ†å¸ƒã€‚â€œç»†è‡´å¹³ç¨³æ¡ä»¶â€æ˜¯åˆ¤æ–­å¹³ç¨³åˆ†å¸ƒçš„ä¸€ä¸ª <em>å……åˆ†æ¡ä»¶</em> ï¼Œä½†ä¸æ˜¯å¿…è¦çš„ï¼Œå®ƒçš„ä»·å€¼åœ¨äºæä¾›äº†ä¸€ç§æ¯”è¾ƒæ–¹ä¾¿çš„ä¸ºä»»æ„åˆ†å¸ƒæ„å»ºè½¬ç§»æ¦‚ç‡çš„æ–¹å¼ã€‚</p>
<h2 id="_3">è½¬ç§»æ¦‚ç‡</h2>
<p>ç»™å®šå¹³ç¨³åˆ†å¸ƒ$p(\boldsymbol{x})$ä»¥åŠä»»æ„çš„å‚è€ƒè½¬ç§»æ¦‚ç‡$q(\boldsymbol{y}\leftarrow\boldsymbol{x})$ï¼Œå¦‚æœå®ƒæ»¡è¶³ç»†è‡´å¹³ç¨³æ¡ä»¶ï¼Œé‚£ä¹ˆå°±ä¸‡äº‹å¤§å‰ï¼Œç›´æ¥ç”¨å‚è€ƒè½¬ç§»æ¦‚ç‡$q(\boldsymbol{y}\leftarrow\boldsymbol{x})$ä½œä¸ºæœ€ç»ˆçš„æ¦‚ç‡å°±å¥½ï¼Œå¦‚æœå®ƒä¸æ»¡è¶³ï¼Œé‚£ä¹ˆè®°$\alpha(\boldsymbol{x}\leftarrow\boldsymbol{y})=q(\boldsymbol{y}\leftarrow\boldsymbol{x})p(\boldsymbol{x})$ï¼Œé‚£ä¹ˆæœ‰ä¸‹è¿°æ˜¾ç„¶æˆç«‹çš„æ’ç­‰å¼ï¼š<br />
\begin{equation}\underbrace{\alpha(\boldsymbol{y}\leftarrow\boldsymbol{x})q(\boldsymbol{y}\leftarrow\boldsymbol{x})}<em _tilde_q="\tilde{q">{\tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x})}p(\boldsymbol{x})=\underbrace{\alpha(\boldsymbol{x}\leftarrow\boldsymbol{y})q(\boldsymbol{x}\leftarrow\boldsymbol{y})}</em>}(\boldsymbol{x}\leftarrow\boldsymbol{y})}p(\boldsymbol{y})\label{eq:feihua}\end{equation<br />
äº‹å®ä¸Šï¼Œè¿™ä¸ªæ’ç­‰å¼è¿‘ä¹åºŸè¯ï¼Œå®ƒç›¸å½“äºè¯´â€œè™½ç„¶$a\neq b$ï¼Œä½†$ab=ba$å§‹ç»ˆæˆç«‹â€ã€‚ä½†å°±æ˜¯è¿™ä¹ˆä¸ªâ€œåºŸè¯â€èˆ¬çš„æ’ç­‰å¼ï¼Œç»™äº†æˆ‘ä»¬å¯ç¤ºï¼šå¦‚æœç”¨$\tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x})$ä½œä¸ºè½¬ç§»æ¦‚ç‡ï¼Œé‚£ä¹ˆå¯¹åº”çš„å¹³ç¨³åˆ†å¸ƒä¸å°±æ˜¯$p(\boldsymbol{x})$äº†ï¼Ÿ</p>
<p>å…¶å®æ²¡é‚£ä¹ˆç®€å•ï¼Œå› ä¸ºè¿™æ ·æ„é€ å‡ºæ¥çš„$\tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x})$é€šå¸¸æ˜¯æ²¡æœ‰å½’ä¸€åŒ–çš„ï¼Œè€Œæ²¡æœ‰å½’ä¸€åŒ–å³æ„å‘³ç€å®ƒæœ¬èº«å°±ä¸æ˜¯ä¸€ä¸ªåˆç†çš„è½¬ç§»æ¦‚ç‡ï¼Œä¹Ÿå°±æ²¡æœ‰ä»€ä¹ˆå¹³ç¨³åˆ†å¸ƒä¹‹è¯´äº†ã€‚æ³¨æ„ï¼Œ <em>å¦‚æœè¦è¿›è¡Œé‡‡æ ·ï¼Œæˆ‘ä»¬æˆ–è®¸å¯ä»¥ä¸éœ€è¦çŸ¥é“å½’ä¸€åŒ–å› å­ï¼Œä½†æ˜¯ç†è®ºåˆ†å¸ƒçš„æ—¶å€™ï¼Œæˆ‘ä»¬æ˜¯éœ€è¦ä¿è¯å½’ä¸€åŒ–æˆç«‹çš„</em> ã€‚æœ‰çš„è¯»è€…å¯èƒ½ä¼šæƒ³ï¼Œé‚£æˆ‘æ‰‹åŠ¨é™¤ä»¥ä¸ªå½’ä¸€åŒ–å› å­è¡Œä¸ï¼Ÿä¸è¡Œï¼Œå› ä¸ºé™¤ä»¥å½’ä¸€åŒ–å› å­ä¹‹åï¼Œç»†è‡´å¹³ç¨³æ¡ä»¶å°±æœªå¿…æˆç«‹äº†ï¼Œç”šè‡³å¼$\eqref{eq:stable}$éƒ½å¯èƒ½ä¸æˆç«‹äº†ã€‚ç¬”è€…æŸ¥é˜…äº†å¾ˆå¤šä»‹ç»èµ„æ–™ï¼Œéƒ½æ²¡æœ‰æ¾„æ¸…è¿™ä¸ªé—®é¢˜ï¼Œéƒ½æ˜¯è¯´ç›´æ¥ç”¨$\tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x})$ä½œä¸ºè½¬ç§»æ¦‚ç‡çš„ï¼Œå›°æƒ‘äº†å¾ˆé•¿æ—¶é—´ã€‚</p>
<p>äº‹å®ä¸Šï¼ŒMCMCæ–¹æ³•æ ¹æœ¬å°±æ²¡æœ‰å»å½’ä¸€åŒ–$\tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x})$ï¼Œè€Œæ˜¯å°†å‰©ä½™éƒ¨åˆ†çš„æ¦‚ç‡æ¦‚ç‡å…¨éƒ¨è½¬ç§»åˆ°è‡ªèº«å»äº†ã€‚ç”¨æ•°å­¦çš„è¯æ¥è¯´ï¼Œå°±æ˜¯å®ƒæœ€åä½¿ç”¨çš„è½¬ç§»æ¦‚ç‡å®é™…ä¸Šæ˜¯ï¼š<br />
\begin{equation}p(\boldsymbol{y}\leftarrow\boldsymbol{x})=\tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x}) + \left(1 - \sum_{\boldsymbol{y}} \tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x})\right)\delta(\boldsymbol{y}\leftarrow\boldsymbol{x})<br />
\end{equation}<br />
å…¶ä¸­$\delta(\boldsymbol{y}\leftarrow\boldsymbol{x}) = \left\{\begin{aligned}1,\boldsymbol{y}=\boldsymbol{x} \\\ 0, \boldsymbol{y}\neq \boldsymbol{x}\end{aligned}\right.$ï¼Œä»£è¡¨äº†åªèƒ½è½¬ç§»åˆ°è‡ªèº«ï¼ˆå³â€œæ°¸è¿œä¸å˜â€ï¼‰çš„è½¬ç§»æ¦‚ç‡ã€‚æ‰€ä»¥ï¼Œ$p(\boldsymbol{y}\leftarrow\boldsymbol{x})$çš„å®šä¹‰å…¶å®å°±æ˜¯æŠŠå¤šå‡ºæ¥çš„æ¦‚ç‡ç»Ÿç»Ÿå åŠ åˆ°â€œä¸å˜â€è¿™ä¸€æ“ä½œä¸Šï¼Œæ‰€ä»¥å®ƒæ˜¾ç„¶æ»¡è¶³å½’ä¸€åŒ–ï¼Œè‡³äºç»†è‡´å¹³ç¨³æ¡ä»¶å¯ä»¥ä»£å…¥æ£€éªŒï¼ŒåŒæ ·æ˜¯æ»¡è¶³çš„ï¼Œå…¶ä¸­ä¸»è¦æ˜¯å› ä¸ºå¯¹äºä»»æ„çš„$p(\boldsymbol{x})$å’Œ$f(\boldsymbol{x},\boldsymbol{y})$ï¼Œä¸‹å¼æ€»æ˜¯æ’æˆç«‹çš„ã€‚<br />
\begin{equation}f(\boldsymbol{x},\boldsymbol{y})\delta(\boldsymbol{y}\leftarrow \boldsymbol{x})p(\boldsymbol{x})=f(\boldsymbol{y},\boldsymbol{x})\delta(\boldsymbol{x}\leftarrow \boldsymbol{y})p(\boldsymbol{y})\end{equation}<br />
æ‰€ä»¥$p(\boldsymbol{y}\leftarrow\boldsymbol{x})$æ‰æ˜¯æˆ‘ä»¬æ‰€è¦å¯»æ±‚çš„çœŸæ­£çš„è½¬ç§»æ¦‚ç‡ã€‚å¦‚æœçŠ¶æ€ç©ºé—´æœ‰é™çš„è¯ï¼Œé‚£ä¹ˆè½¬ç§»æ¦‚ç‡å°±å¯¹åº”ä¸€ä¸ªæœ‰é™çš„çŸ©é˜µï¼Œä¸Šè¿°ç»“æœå…¶å®å°±æ˜¯è¯´â€œé€šè¿‡è°ƒæ•´è½¬ç§»çŸ©é˜µçš„å¯¹è§’çº¿å…ƒç´ å¯ä»¥å®Œæˆå½’ä¸€åŒ–ï¼Œå¹¶ä¸”ä¸å½±å“ç»†è‡´å¹³ç¨³æ¡ä»¶çš„æˆç«‹â€ã€‚</p>
<h2 id="mcmc">MCMCæ–¹æ³•</h2>
<p>æ€ä¹ˆå®ç°ä»ä¸Šè¿°$p(\boldsymbol{y}\leftarrow\boldsymbol{x})$ä»é‡‡æ ·å‘¢ï¼Ÿå¾ˆç®€å•ï¼Œå…ˆå®ç°ä»$\tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x})$é‡‡æ ·ï¼Œç„¶åå¦‚æœä¸æ»¡è¶³ä»$\tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x})$é‡‡æ ·çš„æ¡ä»¶ï¼Œé‚£ä¹ˆå°±ä¿æŒä¸å˜ï¼›è€Œ$\tilde{q}(\boldsymbol{y}\leftarrow\boldsymbol{x})=\alpha(\boldsymbol{y}\leftarrow\boldsymbol{x})q(\boldsymbol{y}\leftarrow\boldsymbol{x})$ï¼Œæˆ‘ä»¬å‡å®šä»$q(\boldsymbol{y}\leftarrow\boldsymbol{x})$ä¸­é‡‡æ ·æ˜¯å®¹æ˜“çš„ï¼Œé‚£ä¹ˆå›å¿†ä¸Šä¸€ç¯‡æ–‡ç« ä»‹ç»çš„æ‹’ç»é‡‡æ ·ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¿›ä¸€æ­¥é‡‡æ ·ä¸€ä¸ª$\varepsilon\sim U[0,1]$ï¼Œé€šè¿‡$ \alpha(\boldsymbol{y}\leftarrow\boldsymbol{x}) &lt; \varepsilon$æ¥å†³å®šæ˜¯å¦æ¥å—é‡‡æ ·å‡ºæ¥çš„$\boldsymbol{y}$ã€‚ç»¼ä¸Šæ‰€è¿°ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†å¦‚ä¸‹çš„MCMCé‡‡æ ·æµç¨‹ï¼š</p>
<blockquote>
<p><strong>Metropolisé‡‡æ ·</strong></p>
<p>åˆå§‹çŠ¶æ€ä¸º$\boldsymbol{x}_0$ï¼Œ$t$æ—¶åˆ»çŠ¶æ€ä¸º$\boldsymbol{x}_t$ã€‚</p>
<p>é€šè¿‡å¦‚ä¸‹æµç¨‹é‡‡æ ·å‡º$\boldsymbol{x}<em t_1="t+1">{t+1}$ï¼š<br />
 1ã€é‡‡æ ·$\boldsymbol{y}\sim q(\boldsymbol{y}\leftarrow\boldsymbol{x}_t)$ï¼›<br />
 2ã€é‡‡æ ·$\varepsilon\sim U[0,1]$ï¼›<br />
 3ã€è®¡ç®—$\alpha(\boldsymbol{y}\leftarrow\boldsymbol{x}_t)=q(\boldsymbol{x}_t\leftarrow\boldsymbol{y})p(\boldsymbol{y})$ï¼›<br />
 4ã€å¦‚æœ$\varepsilon \leq \alpha(\boldsymbol{y}\leftarrow\boldsymbol{x}_t)$ï¼Œé‚£ä¹ˆ$\boldsymbol{x}</em>_t$ã€‚} = \boldsymbol{y}$ï¼Œå¦åˆ™$\boldsymbol{x}_{t+1}=\boldsymbol{x</p>
</blockquote>
<p>è¿™å°±æ˜¯ç”±Metropolisåœ¨1953å¹´æå‡ºæ¥çš„é‡‡æ ·ç®—æ³•ï¼Œä¸€èˆ¬ç§°ä¸ºMetropolisç®—æ³•ï¼Œæˆ–è€…å¹²è„†ç§°ä¸ºMCMCæ–¹æ³•ã€‚å®ƒéœ€è¦çŸ¥é“$p(\boldsymbol{x})$çš„ç²¾ç¡®è¡¨è¾¾å¼ï¼Œå¹¶ä¸”éœ€è¦çŸ¥é“ä¸€ä¸ªæ˜“äºé‡‡æ ·çš„è½¬ç§»æ¦‚ç‡$q(\boldsymbol{y}\leftarrow\boldsymbol{x})$ï¼Œç„¶åæ ¹æ®ä¸Šè¿°æµç¨‹è¿­ä»£é‡‡æ ·è¶³å¤Ÿå¤šæ­¥åï¼Œæ‰€å¾—çš„$\boldsymbol{x}_t$æˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºæ˜¯ä»$p(\boldsymbol{x})$ä¸­é‡‡æ ·å‡ºæ¥çš„ã€‚è¿™é‡Œçš„è¶³å¤Ÿå¤šæ­¥å–å†³äº$p(\boldsymbol{x})$å’Œ$q(\boldsymbol{y}\leftarrow\boldsymbol{x})$çš„å…·ä½“é€‰æ‹©ï¼Œä¸€èˆ¬æ¥è¯´åªèƒ½æ ¹æ®å®éªŒç»“æœç¡®å®šï¼Œæ²¡æœ‰ç»Ÿä¸€çš„æ ‡å‡†ã€‚</p>
<p>å¯èƒ½æœ‰è¯»è€…è§‰å¾—ï¼Œè¿™ä¸å°±æ˜¯ä¸€ä¸ªæ™®é€šçš„æ‹’ç»é‡‡æ ·å—ï¼Ÿåˆšæ‰è¯´çš„â€œæŠŠå¤šå‡ºæ¥çš„æ¦‚ç‡ç»Ÿç»Ÿå åŠ åˆ°â€˜ä¸å˜â€™è¿™ä¸€æ“ä½œä¸Šâ€ä½“ç°åœ¨å“ªï¼Ÿäº‹å®ä¸Šï¼Œè·Ÿæ™®é€šçš„æ‹’ç»é‡‡æ ·è¿˜æ˜¯æœ‰ç‚¹ä¸ä¸€æ ·çš„ï¼Œåœ¨æ™®é€šçš„æ‹’ç»é‡‡æ ·ä¸­ï¼Œå¦‚æœ$\varepsilon &gt; \alpha(\boldsymbol{y}\leftarrow\boldsymbol{x})$ï¼Œé‚£å°±é‡å¤1ã€2ã€3æ­¥é‡‡æ ·è¿‡ç¨‹ï¼Œç›´åˆ°é‡‡æ ·å‡º$\varepsilon \leq \alpha(\boldsymbol{y}\leftarrow\boldsymbol{x})$çš„$\boldsymbol{y}$ä¸ºæ­¢ï¼Œç„¶åè®©$\boldsymbol{x}<em t_1="t+1">{t+1} = \boldsymbol{y}$ï¼›è€Œä¸Šè¿°é‡‡æ ·è¿‡ç¨‹ä¸­ï¼Œå¦‚æœ$\varepsilon &gt; \alpha(\boldsymbol{y}\leftarrow\boldsymbol{x})$ï¼Œé‚£ä¹ˆç›´æ¥è®©$\boldsymbol{x}</em>} = \boldsymbol{x<em t_2="t+2">t$äº†ï¼Œå†ä¸‹ä¸€æ­¥é‡‡æ ·å‡ºæ¥çš„å°±æ˜¯$\boldsymbol{x}</em>}$äº†ã€‚å‡å¦‚æˆ‘ä»¬è®¤ä¸ºä»$T$æ—¶åˆ»å¼€å§‹ï¼Œåˆ†å¸ƒå°±å¹³ç¨³äº†ï¼Œé‚£ä¹ˆ$\{\boldsymbol{x<em t="T">t\}</em>}^{\infty}$éƒ½æ˜¯$p(\boldsymbol{x})$ä¸­é‡‡æ ·å‡ºæ¥çš„æ ·æœ¬ï¼ˆåŒåˆ†å¸ƒä½†ä¸ç‹¬ç«‹ï¼‰ï¼Œæ˜¾ç„¶ä¸¤ç§ä¸åŒçš„æ‹’ç»æ–¹å¼ï¼Œä¼šå½±å“$\{\boldsymbol{x<em t="T">t\}</em>$æœ€ç»ˆçš„åˆ†å¸ƒæƒ…å†µã€‚}^{\infty</p>
<p>æ­¤å¤–ï¼Œå€¼å¾—æŒ‡å‡ºçš„æ˜¯ï¼Œå°½ç®¡æœ¬ç³»åˆ—æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ‰€å¤„ç†çš„$\boldsymbol{x}$æ˜¯ç¦»æ•£å¯¹è±¡ï¼Œä½†äº‹å®ä¸ŠåŒæ ·çš„ç»“è®ºä¹Ÿé€‚ç”¨äºè¿ç»­å‹å¯¹è±¡çš„é‡‡æ ·ï¼Œåªéœ€è¦åœ¨å‰é¢çš„æ¨å¯¼è¿‡ç¨‹ä¸­ï¼Œå°†æ±‚å’Œæ”¹ä¸ºå¯¹æ¦‚ç‡å¯†åº¦çš„ç§¯åˆ†å°±è¡Œäº†ï¼Œæ²¡æœ‰å®è´¨çš„åŒºåˆ«ã€‚</p>
<h2 id="mh">MHé‡‡æ ·</h2>
<p>ä¸Šè¿°Metropolisé‡‡æ ·åœ¨å¾ˆå¤šåœºæ™¯ä¸‹å·²ç»å¯ç”¨äº†ï¼Œä½†å®ƒè¿˜ä¸æ˜¯ç‰¹åˆ«å®Œç¾ã€‚é¦–å…ˆï¼Œåˆšæ‰è¯´äº†ï¼ŒMetropolisé‡‡æ ·éœ€è¦çŸ¥é“$p(\boldsymbol{x})$çš„ç²¾ç¡®è¡¨è¾¾å¼ï¼Œè¿™åœ¨ä¸å°‘ä»»åŠ¡ä¸‹æ˜¯éš¾ä»¥åšåˆ°çš„ï¼›å…¶æ¬¡ï¼Œæ¥å—ç‡$\alpha(\boldsymbol{y}\leftarrow\boldsymbol{x})$å¾€å¾€è¿‡å°ï¼Œå¯¼è‡´é•¿æ—¶é—´â€œåŸåœ°è¸æ­¥â€ï¼Œä»è€Œè¾¾åˆ°å¹³ç¨³çŠ¶æ€çš„æ—¶é—´è¿‡é•¿ã€‚å¹¸è¿çš„æ˜¯ï¼Œæœ‰ä¸€ä¸ªç®€å•çš„æŠ€å·§å¯ä»¥åŒæ—¶è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ã€‚</p>
<p>è¯¥æŠ€å·§å°±æ˜¯ä½¿ç”¨å¦‚ä¸‹å¼å­ä½œä¸ºæ¥å—ç‡<br />
\begin{equation}\mathcal{A}(\boldsymbol{y}\leftarrow\boldsymbol{x}) = \min\left(1, \frac{q(\boldsymbol{x}\leftarrow\boldsymbol{y})p(\boldsymbol{y})}{q(\boldsymbol{y}\leftarrow\boldsymbol{x})p(\boldsymbol{x})}\right)\end{equation}<br />
è¯¥æ¥å—ç‡å…¶å®ä¹Ÿæ˜¯æºäºæ’ç­‰å¼$\eqref{eq:feihua}$ï¼Œå¯¹äºæ¥å—ç‡è€Œè¨€ï¼Œæˆ‘ä»¬å”¯ä¸€çš„è¦æ±‚å°±æ˜¯å®ƒåœ¨0ï½1ä¹‹é—´ï¼Œæ­¤å¤–æ˜¯è¶Šæ¥è¿‘äº1è¶Šå¥½ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è®©æ’ç­‰å¼$\eqref{eq:feihua}$ä¸¤è¾¹çš„æ¥å—ç‡éƒ½é™¤ä»¥$\max(\alpha(\boldsymbol{y}\leftarrow\boldsymbol{x}),\alpha(\boldsymbol{x}\leftarrow\boldsymbol{y}))$ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå®ƒä»¬ä¿©å…¶ä¸­ä¸€ä¸ªå°±å˜æˆäº†1ï¼Œå¦ä¸€ä¸ªä¹Ÿä¸å¤§äº1ï¼Œå¹¶ä¸”å¾—åˆ°äº†æ”¾å¤§ï¼ŒåŒ–ç®€ä¹‹åå°±å¾—åˆ°äº†$\mathcal{A}(\boldsymbol{y}\leftarrow\boldsymbol{x})$ã€‚è€Œä¸”ç›¸å½“å·§å¦™çš„æ˜¯ï¼Œæ­¤æ—¶$\mathcal{A}(\boldsymbol{y}\leftarrow\boldsymbol{x})$åªä¾èµ–äº$p(\boldsymbol{y})$çš„ç›¸å¯¹å€¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä¸ç”¨ç®—å‡ºå®ƒçš„å½’ä¸€åŒ–å› å­äº†ã€‚</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†æ”¹è¿›ç‰ˆçš„Metropolisé‡‡æ ·ç®—æ³•ï¼Œè¿™å°±æ˜¯å¤§åé¼é¼çš„Metropolis-Hastings Samplingï¼ˆMHé‡‡æ ·ï¼‰ï¼š</p>
<blockquote>
<p><strong>Metropolis-Hastingsé‡‡æ ·</strong></p>
<p>åˆå§‹çŠ¶æ€ä¸º$\boldsymbol{x}_0$ï¼Œ$t$æ—¶åˆ»çŠ¶æ€ä¸º$\boldsymbol{x}_t$ã€‚</p>
<p>é€šè¿‡å¦‚ä¸‹æµç¨‹é‡‡æ ·å‡º$\boldsymbol{x}<em t_1="t+1">{t+1}$ï¼š<br />
 1ã€é‡‡æ ·$\boldsymbol{y}\sim q(\boldsymbol{y}\leftarrow\boldsymbol{x}_t)$ï¼›<br />
 2ã€é‡‡æ ·$\varepsilon\sim U[0,1]$ï¼›<br />
 3ã€è®¡ç®—$\mathcal{A}(\boldsymbol{y}\leftarrow\boldsymbol{x}_t) = \min\left(1, \frac{q(\boldsymbol{x}_t\leftarrow\boldsymbol{y})p(\boldsymbol{y})}{q(\boldsymbol{y}\leftarrow\boldsymbol{x}_t)p(\boldsymbol{x}_t)}\right)$ï¼›<br />
 4ã€å¦‚æœ$\varepsilon \leq \mathcal{A}(\boldsymbol{y}\leftarrow\boldsymbol{x}_t)$ï¼Œé‚£ä¹ˆ$\boldsymbol{x}</em>_t$ã€‚} = \boldsymbol{y}$ï¼Œå¦åˆ™$\boldsymbol{x}_{t+1}=\boldsymbol{x</p>
</blockquote>
<h2 id="_4">åˆ†ææ€è€ƒ</h2>
<p>ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æŒ‡å‡ºç›´æ¥ä»$p(\boldsymbol{x})$ä¸­é‡‡æ ·æ˜¯å¾ˆå›°éš¾çš„ï¼Œå°±ç®—æ˜¯æ‹’ç»é‡‡æ ·ï¼Œå¦‚æœ$\boldsymbol{x}$çš„ç»´åº¦è¿‡é«˜ï¼Œé‚£ä¹ˆä»è¿‘ä¼¼åˆ†å¸ƒ$q(\boldsymbol{x})$é‡‡æ ·åå…¶æ¥å—ç‡é€šå¸¸ä¹Ÿä¼šå¾ˆä½ï¼Œå¯¼è‡´æ‹’ç»é‡‡æ ·çš„æ•ˆç‡æä½è€Œæ— æ³•ä½¿ç”¨ã€‚é‚£ä¹ˆå¾ˆè‡ªç„¶çš„ä¸€ä¸ªé—®é¢˜æ˜¯ï¼š</p>
<blockquote>
<p>åœ¨MCMCæ–¹æ³•ä¸­ï¼ŒåŒæ ·è¦ä»è½¬ç§»æ¦‚ç‡$q(\boldsymbol{y}\leftarrow \boldsymbol{x})$ä¸­é‡‡æ ·ï¼ŒåŒæ ·æœ‰æ¥å—æ¦‚ç‡$\mathcal{A}(\boldsymbol{y}\leftarrow \boldsymbol{x})$ï¼Œé‚£ä¸ºä»€ä¹ˆMCMCå°±æ˜¯å®ç”¨çš„ï¼Œè€Œæ™®é€šçš„æ‹’ç»é‡‡æ ·å°±æ˜¯ä¸å®ç”¨çš„ï¼Ÿ</p>
</blockquote>
<p>å…¶å®ï¼Œå¯¹äºç›´æ¥æ‹’ç»é‡‡æ ·æ¥è¯´ï¼Œå®ƒè¦ä»è¿‘ä¼¼åˆ†å¸ƒ$q(\boldsymbol{x})$ä¸­ç›´æ¥é‡‡æ ·çš„æ˜¯æ•´ä¸ªé«˜ç»´åºåˆ—ï¼Œå¦‚æœ$q(\boldsymbol{x})$ä¸ç²¾ç¡®çš„$p(\boldsymbol{x})$å·®å¾—æ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆæ¥å—æ¦‚ç‡å¾€å¾€æ˜¯æŒ‡æ•°è¡°å‡çš„ï¼Œå› æ­¤æ¥å—æ¦‚ç‡æä½ï¼›è€Œå¯¹äºMCMCæ–¹æ³•æ¥è¯´ï¼Œæˆ‘ä»¬å¯¹$q(\boldsymbol{y}\leftarrow \boldsymbol{x})$çš„å½¢å¼æ²¡æœ‰è¿‡å¤šçš„é™åˆ¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥é€‚å½“åœ°è®¾è®¡$q(\boldsymbol{y}\leftarrow \boldsymbol{x})$ï¼Œä½¿å¾—æ¦‚ç‡åˆ†å¸ƒåªé›†ä¸­åœ¨è·Ÿ$\boldsymbol{x}$ç›¸ä¼¼çš„é‚£äº›$\boldsymbol{y}$ä¸­ï¼Œæ¢å¥è¯è¯´ï¼Œåªæœ‰å½“$\boldsymbol{y}$ä¸$\boldsymbol{x}$å¾ˆç›¸ä¼¼æ—¶ï¼Œ$q(\boldsymbol{y}\leftarrow \boldsymbol{x})$æ‰ä¸ä¸º0ï¼Œå¦åˆ™å°±ä¸º0ã€‚è¿™æ ·ä¸€æ¥ï¼Œä»$q(\boldsymbol{y}\leftarrow \boldsymbol{x})$é‡‡æ ·çš„ç»“æœè·Ÿè¾“å…¥$\boldsymbol{x}$åªæœ‰å°çš„å·®åˆ«ï¼Œå˜åŒ–ä¸å¤§çš„æƒ…å†µä¸‹ï¼Œæ¥å—ç‡å¾€å¾€æ›´é«˜äº›ï¼Œæ‰€ä»¥ä½¿å¾—æ‹’ç»é‡‡æ ·æˆä¸ºå¯èƒ½ã€‚</p>
<p>æ‰€ä»¥ï¼Œè¯´ç™½äº†ï¼ŒMCMCæ–¹æ³•å°±æ˜¯å°†â€œç›´æ¥ç”Ÿæˆ$\boldsymbol{x}$â€ï¼Œè½¬æ¢ä¸ºäº†â€œä»$\boldsymbol{x}_0$å‡ºå‘ï¼Œåå¤å¯¹å®ƒå¾®è°ƒã€æ¶¦è‰²ï¼Œç›´åˆ°ç”Ÿæˆç¬¦åˆæ¡ä»¶çš„$\boldsymbol{x}$â€è¿™ä¹ˆä¸€ä¸ªæ¸è¿›å¼è¿‡ç¨‹ï¼Œä»è€Œä½¿å¾—å®ƒè¡Œä¹‹æœ‰æ•ˆï¼Œè¿™è·Ÿä¸Šä¸€ç¯‡æ–‡ç« æåˆ°çš„â€œä¸€æ­¥æ­¥æ¥â€çš„æ€æƒ³æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†ä»‹ç»ä¸¤ä¸ªMHé‡‡æ ·çš„ä¾‹å­ï¼šGibbsé‡‡æ ·å’Œæ¨¡æ‹Ÿé€€ç«ï¼Œå®ƒä»¬éƒ½ä½“ç°äº†MCMCçš„è¿™ç§å¾®è°ƒã€æ¸è¿›çš„æ€æƒ³ã€‚</p>
<h2 id="gibbs">Gibbsé‡‡æ ·</h2>
<p>å‡è®¾$\boldsymbol{x}=(x_1,x_2,\dots,x_l)$æ˜¯ä¸€ä¸ªé•¿åº¦ä¸º$l$çš„åºåˆ—ï¼ŒGibbsé‡‡æ ·æ¯æ¬¡åªè°ƒæ•´å…¶ä¸­ä¸€ä¸ªå…ƒç´ ã€‚å…·ä½“æ¥è¯´ï¼ŒGibbsé‡‡æ ·å°†å‚è€ƒè½¬ç§»æ¦‚ç‡å®šä¹‰ä¸ºï¼ˆä¸¥æ ¼æ¥è¯´è¿˜è¦å†é™¤ä»¥ä¸ª$l$ï¼Œä½†å¸¸æ•°ä¸æ”¹å˜ç»“æœï¼Œå°±ä¸å†™å‡ºæ¥äº†ï¼‰ï¼š<br />
\begin{equation}q(\boldsymbol{x}<em -i="-i">{[x_i=y]}\leftarrow \boldsymbol{x}) = p(y|\boldsymbol{x}</em>})\triangleq\frac{p(x_1,\dots,x_{i-1},y,x_{i+1},\cdots,x_l)}{\sum\limits_y p(x_1,\dots,x_{i-1},y,x_{i+1},\cdots,x_l)}\end{equation<br />
å…¶ä¸­$\boldsymbol{x}<em -i="-i">{[x_i=y]}$æ˜¯å°†$\boldsymbol{x}$çš„ç¬¬$i$ä¸ªä½ç½®æ›¿æ¢ä¸º$y$åçš„åºåˆ—ã€‚è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒæ ¹æ®å¾…é‡‡æ ·åˆ†å¸ƒ$p(\boldsymbol{x})$è‡ªèº«æ¥æ„å»º$p(y|\boldsymbol{x}</em>})$ä½œä¸ºè½¬ç§»æ¦‚ç‡ï¼Œæ¯æ¬¡å…ˆä»$1,2,\cdots,l$ä¸­éšæœºé€‰æ‹©ä¸€ä¸ªä½ç½®$i$ï¼Œç„¶åå°†ä½ç½®$i$çš„å…ƒç´ æ›¿æ¢æˆä»åˆ†å¸ƒ$p(y|\boldsymbol{x<em _x_i="y]">{-i})$é‡‡æ ·å‡ºæ¥çš„ç»“æœã€‚æ›´å¦™çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜è¿™ç§æƒ…å†µä¸‹æ¥å—æ¦‚ç‡æ’ä¸º1ï¼š<br />
\begin{equation}\begin{aligned}<br />
\mathcal{A}(\boldsymbol{x}</em>}\leftarrow \boldsymbol{x}) =&amp;\, \min\left(1, \frac{p(x_i|\boldsymbol{x<em _x_i="y]">{-i})p(\boldsymbol{x}</em>})}{p(y|\boldsymbol{x<em -i="-i">{-i})p(\boldsymbol{x})}\right) \\\<br />
=&amp;\, \min\left(1, \frac{p(x_i|\boldsymbol{x}</em>})p(y|\boldsymbol{x<em -i="-i">{-i})p(\boldsymbol{x}</em>})}{p(y|\boldsymbol{x<em -i="-i">{-i})p(x_i|\boldsymbol{x}</em>\right)\\\})p(\boldsymbol{x}_{-i})<br />
=&amp;\, \min\left(1, 1\right)\\\<br />
=&amp;\,1<br />
\end{aligned}\end{equation}<br />
ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå¦‚ä¸‹çš„Gibbsé‡‡æ ·è¿‡ç¨‹ï¼š</p>
<blockquote>
<p><strong>Gibbsé‡‡æ ·</strong></p>
<p>åˆå§‹çŠ¶æ€ä¸º$\boldsymbol{x}<em 0_1="0,1">0=(x</em>},x_{0,2},\cdots,x_{0,l})$ï¼Œ$t$æ—¶åˆ»çŠ¶æ€ä¸º$\boldsymbol{x<em t_1="t,1">t=(x</em>)$ã€‚},x_{t,2},\cdots,x_{t,l</p>
<p>é€šè¿‡å¦‚ä¸‹æµç¨‹é‡‡æ ·å‡º$\boldsymbol{x}<em t_-i="t,-i">{t+1}$ï¼š<br />
 1ã€å‡åŒ€åœ°ä»$1,2,\cdots,l$ä¸­é‡‡æ ·ä¸€ä¸ª$i$ï¼›<br />
 2ã€è®¡ç®—$p(y|\boldsymbol{x}</em>$ï¼›})=\frac{p(x_{t,1},\dots,x_{t,i-1},y,x_{t,i+1},\cdots,x_{t,l})}{\sum\limits_y p(x_{t,1},\dots,x_{t,i-1},y,x_{t,i+1},\cdots,x_{t,l})<br />
 3ã€é‡‡æ ·$y\sim p(y|\boldsymbol{x}<em t_1="t+1">{t,-i})$ï¼›<br />
 4ã€$\boldsymbol{x}</em>} = {\boldsymbol{x<em _x__t_i="[x_{t,i">t}</em>}=y]}$ï¼ˆå³å°†$\boldsymbol{x<em t_1="t+1">t$çš„ç¬¬$i$ä¸ªä½ç½®æ›¿æ¢ä¸º$y$ä½œä¸º$\boldsymbol{x}</em>$ï¼‰ã€‚</p>
</blockquote>
<h2 id="_5">æ¨¡æ‹Ÿé€€ç«</h2>
<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯æ¨¡æ‹Ÿé€€ç«ï¼ˆSimulated Annealingï¼‰ç®—æ³•ã€‚å‰ä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æåˆ°äº†æœ€å¤§åŒ–ä¸€ä¸ªç›®æ ‡ï¼Œå…¶å®ä¹Ÿå¯ä»¥çœ‹æˆæ˜¯ä»è¿™ä¸ªç›®æ ‡ä¸­è¿›è¡Œéšæœºé‡‡æ ·ï¼Œå…¶ç»“æœä¾¿å¯¹åº”ç€æ¨¡æ‹Ÿé€€ç«ç®—æ³•ã€‚</p>
<p>é¦–å…ˆï¼Œè®¾æˆ‘ä»¬è¦æœ€å¤§åŒ–çš„å‡½æ•°æ˜¯$f(\boldsymbol{x})$ï¼Œå¹¶ä¸”å‡è®¾å­˜åœ¨æŸä¸ªå¸¸æ•°$T &gt; 0$ï¼Œä½¿å¾—å¯¹äºä»»æ„$0 &lt; \tau \leq T$ï¼Œéƒ½æœ‰<br />
\begin{equation}\sum_{\boldsymbol{x}} e^{f(\boldsymbol{x})/\tau} &lt; \infty\end{equation}<br />
è¿™é‡Œçš„$\tau$çš„ç‰©ç†æ„ä¹‰å°±æ˜¯æ¸©åº¦ã€‚è¿™ä¸ªå‡è®¾çœ‹èµ·æ¥æ˜¯é¢å¤–çš„çº¦æŸï¼Œä½†äº‹å®ä¸Šæ¨¡æ‹Ÿé€€ç«ä¹Ÿå°±åªé€‚ç”¨äºæ»¡è¶³è¿™ä¸ªæ¡ä»¶çš„åœºæ™¯ã€‚ç”±äºæ»¡è¶³è¯¥æ¡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥æ„é€ åˆ†å¸ƒ<br />
\begin{equation}p_{\tau}(\boldsymbol{x}) = \frac{e^{f(\boldsymbol{x})/\tau}}{\sum\limits_{\boldsymbol{x}} e^{f(\boldsymbol{x})/\tau}}\end{equation}<br />
å‡è®¾æœ€å¤§å€¼ç‚¹æ˜¯å”¯ä¸€çš„ï¼Œé‚£ä¹ˆå½“$\tau\to 0$æ—¶ï¼Œ$p_{\tau}(\boldsymbol{x})$å°±ä¼šé€€åŒ–ä¸ºone hotåˆ†å¸ƒï¼Œä¹Ÿå°±æ˜¯åªæœ‰æœ€å¤§å€¼ç‚¹çš„æ¦‚ç‡ä¸º1ï¼Œå¦‚æœä»$p_{\tau}(\boldsymbol{x})$ä¸­é‡‡æ ·ï¼Œé‚£ä¹ˆé‡‡æ ·ç»“æœå°±æ˜¯æœ€å¤§å€¼ç‚¹äº†ã€‚å³ä½¿$\tau &gt; 0$ï¼Œé‚£ä¹ˆä¾ç„¶æ˜¯æœ€å¤§å€¼ç‚¹çš„æ¦‚ç‡æœ€å¤§ï¼Œæ‰€ä»¥ä»$p_{\tau}(\boldsymbol{x})$ä¸­é‡‡æ ·ï¼Œä¹Ÿä¼šæœ‰è¶‹äºæœ€å¤§å€¼ç‚¹çš„è¶‹åŠ¿ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå›ºå®šæ¸©åº¦$\tau$ï¼Œæ„é€ ä¸€ä¸ªä»$p_{\tau}(\boldsymbol{x})$è¿›è¡ŒMHé‡‡æ ·çš„éšæœºè¿‡ç¨‹ï¼Œç„¶åå†æ…¢æ…¢è®©$\tau$ä¸‹é™ï¼Œé‚£ä¹ˆæœ€ç»ˆçš„æ”¶æ•›ç»“æœå°±æ˜¯æœ€å¤§å€¼ç‚¹é™„è¿‘äº†ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„â€œæ¨¡æ‹Ÿé€€ç«â€äº†ã€‚</p>
<p>ä¸ºäº†è¿›è¡ŒMHé‡‡æ ·ï¼Œæˆ‘ä»¬éœ€è¦æ„å»ºè½¬ç§»çŸ©é˜µï¼Œæ¨¡æ‹Ÿé€€ç«çš„é€‰æ‹©æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯æ ¹æ®å½“å‰çŠ¶æ€$\boldsymbol{x}$è®¾è®¡å›ºå®šæ•°ç›®çš„$\boldsymbol{y}$ä½œä¸ºæ–°çš„$\boldsymbol{x}$çš„å€™é€‰å€¼ï¼ˆè¿™æ­¥é€šå¸¸ç§°ä¸ºâ€œå˜å¼‚â€ï¼Œå¾€å¾€åªæ˜¯å¯¹$\boldsymbol{x}$è¿›è¡Œç®€å•ä¿®æ”¹æ¥å¾—åˆ°$\boldsymbol{y}$ï¼‰ï¼Œç„¶å$q(\boldsymbol{y}\leftarrow \boldsymbol{x})$å°±æ˜¯ä»å€™é€‰ä¸­å‡å…éšæœºåœ°é€‰ä¸€ä¸ªã€‚æ—¢ç„¶æ˜¯å‡åŒ€çš„ï¼Œé‚£ä¹ˆ$q(\boldsymbol{y}\leftarrow \boldsymbol{x})$å°±æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œå¹¶ä¸”$q(\boldsymbol{y}\leftarrow \boldsymbol{x})=q(\boldsymbol{x}\leftarrow \boldsymbol{y})$ï¼Œå› æ­¤å°±æœ‰<br />
\begin{equation}\mathcal{A}(\boldsymbol{y}\leftarrow\boldsymbol{x}) = \min\left(1, \frac{q(\boldsymbol{x}\leftarrow\boldsymbol{y})p_{\tau}(\boldsymbol{y})}{q(\boldsymbol{y}\leftarrow\boldsymbol{x})p_{\tau}(\boldsymbol{x})}\right) = \min\left(1, e^{[f(\boldsymbol{y}) - f(\boldsymbol{x})]/\tau}\right)\end{equation}<br />
æ‰€ä»¥ï¼Œæ¨¡æ‹Ÿé€€ç«å°±æ˜¯ä¸€ç§æœç´¢ç­–ç•¥ï¼Œå¦‚æœ$f(\boldsymbol{y}) \geq f(\boldsymbol{x})$ï¼Œé‚£ä¹ˆå°±æ›´æ–°$\boldsymbol{x}=\boldsymbol{y}$ï¼Œå°±ç®—ä¸æ˜¯ï¼Œé‚£ä¹ˆè¿˜æœ‰ä¸€å®šçš„æ¦‚ç‡æ›´æ–°$\boldsymbol{x}=\boldsymbol{y}$ã€‚åœ¨æ•´ä¸ªæœç´¢è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ…¢æ…¢è¿›è¡Œé€€ç«ï¼ˆ$\tau$æ…¢æ…¢è¶‹äº0ï¼‰ï¼Œåœ¨é€‚å½“çš„é€€ç«ç­–ç•¥ä¸‹ï¼Œæ¨¡æ‹Ÿé€€ç«å‡ ä¹æ€»æ˜¯èƒ½æ‰¾åˆ°æœ€å¤§å€¼ç‚¹çš„ã€‚å½“ç„¶ï¼Œå¦‚ä½•æ ¹æ®å…·ä½“é—®é¢˜åˆ¶å®šâ€œé€‚å½“çš„â€é€€ç«ç­–ç•¥ï¼Œé‚£åˆæ˜¯ä¸€ä¸ªå€¼å¾—æ€è€ƒçš„é—®é¢˜äº†ã€‚</p>
<blockquote>
<p><strong>æ¨¡æ‹Ÿé€€ç«</strong></p>
<p>åˆå§‹çŠ¶æ€ä¸º$\boldsymbol{x}_0$ï¼Œåˆå§‹æ¸©åº¦ä¸º$\tau_0$ï¼Œæ¸©åº¦æŒ‰ç…§äº‹å…ˆåˆ¶å®šçš„ç­–ç•¥ä¸‹é™ï¼Œ$t$æ—¶åˆ»çŠ¶æ€ä¸º$\boldsymbol{x}_t$ï¼Œæ¸©åº¦ä¸º$\tau_t$ã€‚</p>
<p>é€šè¿‡å¦‚ä¸‹æµç¨‹é‡‡æ ·å‡º$\boldsymbol{x}<em t_1="t+1">{t+1}$ï¼š<br />
 1ã€é‡‡æ ·$\boldsymbol{y}\sim q(\boldsymbol{y}\leftarrow\boldsymbol{x}_t)$ï¼›<br />
 2ã€é‡‡æ ·$\varepsilon\sim U[0,1]$ï¼›<br />
 3ã€è®¡ç®—$\mathcal{A}(\boldsymbol{y}\leftarrow\boldsymbol{x}_t) = \min\left(1, e^{[f(\boldsymbol{y}) - f(\boldsymbol{x}_t)]/\tau_t}\right)$ï¼›<br />
 4ã€å¦‚æœ$\varepsilon\leq \mathcal{A}(\boldsymbol{y}\leftarrow\boldsymbol{x}_t)$ï¼Œé‚£ä¹ˆ$\boldsymbol{x}</em>_t$ã€‚} = \boldsymbol{y}$ï¼Œå¦åˆ™$\boldsymbol{x}_{t+1}=\boldsymbol{x</p>
</blockquote>
<p>å¦‚æœç®€å•ä¿®æ”¹ä¸€ä¸‹ï¼Œå°†æ¥å—ç­–ç•¥æ”¹ä¸ºâ€œå¦‚æœ$f(\boldsymbol{y}) \geq f(\boldsymbol{x}_t)$åˆ™æ¥å—ï¼Œå¦åˆ™å°±æ‹’ç»â€ï¼Œé‚£ä¹ˆå°±å˜æˆäº†æ›´æœ´ç´ çš„â€œçˆ¬å±±æ³•ï¼ˆHill Climbingï¼‰â€äº†ã€‚æ˜¾ç„¶ï¼Œçˆ¬å±±æ³•ç›®æ ‡æ›´æ˜ç¡®ï¼Œå‰æœŸå¯èƒ½æ”¶æ•›æ›´å¿«ï¼Œä½†æ˜¯ä¸€æ—¦é™·å…¥äº†å±€éƒ¨æœ€å¤§å€¼åï¼Œé€šå¸¸å°±è·³ä¸å‡ºæ¥äº†ï¼Œæœ€ç»ˆçš„æ”¶æ•›ç»“æœæ²¡æœ‰æ¨¡æ‹Ÿé€€ç«é‚£ä¹ˆå¥½ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é€‰æ‹©ä¸åŒçš„åˆå§‹å€¼æ¥é‡å¤å®éªŒï¼Œæå‡çˆ¬å±±æ³•çš„æ•ˆæœã€‚å…·ä½“é€‰æ‹©ä»€ä¹ˆç®—æ³•ï¼Œé‚£å°±çœ‹å…·ä½“é—®é¢˜è€Œå®šäº†ã€‚</p>
<h2 id="_6">æœ¬æ–‡å°ç»“</h2>
<p>æœ¬æ–‡ä¾ç„¶ä»‹ç»â€œå—é™æ–‡æœ¬ç”Ÿæˆâ€æ‰€éœ€è¦çš„åŸºç¡€é‡‡æ ·ç®—æ³•â€”â€”MCMCæ–¹æ³•ã€‚ç»è¿‡åå¤ä¿®æ”¹ï¼Œæœ¬æ–‡æ€»ç®—å†™å‡ºäº†ç¬”è€…è§‰å¾—æ¯”è¾ƒæ»¡æ„çš„MCMCæ–¹æ³•ä»‹ç»ï¼Œå…¶ä¸­ä¸»è¦çš„åŒºåˆ«æ˜¯å›ç­”äº†ä¸€äº›å¸¸è§çš„MCMCæ–¹æ³•æ•™ç¨‹ä¸­æ²¡æœ‰æåŠåˆ°çš„ç»†èŠ‚é—®é¢˜ã€‚å¯¹äºåŸºç¡€ç®—æ³•çš„ä»‹ç»ï¼Œåˆ°æ­¤å°±å‘Šä¸€æ®µè½ã€‚ä»ä¸‹ä¸€ç¯‡æ–‡ç« å¼€å§‹ï¼Œæˆ‘ä»¬å°†é€æ­¥ä»‹ç»å¦‚ä½•å°†è¿™äº›çœ‹ä¼¼æ¯ç‡¥çš„é‡‡æ ·ç®—æ³•åº”ç”¨åˆ°ç”ŸåŠ¨ã€å…·ä½“çš„æ–‡æœ¬ç”Ÿæˆä»»åŠ¡ä¸­å»ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8084">https://spaces.ac.cn/archives/8084</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jan. 14, 2021). ã€Šã€æœå‡ºæ¥çš„æ–‡æœ¬ã€‘â‹…ï¼ˆäºŒï¼‰ä»MCMCåˆ°æ¨¡æ‹Ÿé€€ç« ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8084">https://spaces.ac.cn/archives/8084</a></p>
<p>@online{kexuefm-8084,<br />
title={ã€æœå‡ºæ¥çš„æ–‡æœ¬ã€‘â‹…ï¼ˆäºŒï¼‰ä»MCMCåˆ°æ¨¡æ‹Ÿé€€ç«},<br />
author={è‹å‰‘æ—},<br />
year={2021},<br />
month={Jan},<br />
url={\url{https://spaces.ac.cn/archives/8084}},<br />
} </p>
<hr />
<h2 id="_7">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>TODO: æ·»åŠ è¯¦ç»†çš„æ•°å­¦å…¬å¼æ¨å¯¼å’Œæ³¨é‡Š</p>
        </div>
    </div>
</body>
</html>