<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š3. Muon + Stiefel</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>æµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š3. Muon + Stiefel</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 56.5 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11221">https://spaces.ac.cn/archives/11221</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ä¸Šå›è¯´åˆ°ï¼Œå½“æˆ‘ä»¬æŠŠä¼˜åŒ–å¯¹è±¡ä»å‘é‡å‚æ•°è½¬ç§»åˆ°çŸ©é˜µå‚æ•°ï¼Œå¹¶é€‰ç”¨æ›´é€‚åˆçŸ©é˜µçš„è°±èŒƒæ•°çº¦æŸåï¼ŒMuonä¼˜åŒ–å™¨ä¾¿è‡ªç„¶è€Œç„¶åœ°å‡ºç°äº†ã€‚è¿›ä¸€æ­¥åœ°ï¼Œæˆ‘ä»¬è€ƒè™‘äº†ç»™å‚æ•°åŠ ä¸Šæ­£äº¤çº¦æŸåçš„æœ€é€Ÿä¸‹é™æ–¹å‘ï¼Œè¿™å…¶ä¸­åˆåˆ†æ–¹é˜µå’Œéæ–¹é˜µä¸¤éƒ¨åˆ†è®¨è®ºï¼Œå…¶ä¸­æ–¹é˜µçš„æ±‚è§£æˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡æ–‡ç« å·²ç»å®Œæˆï¼Œä½†éæ–¹é˜µéƒ¨åˆ†ä¾ç„¶æ‚¬è€Œæœªå†³ã€‚</p>
<p>æœ¬æ–‡çš„ç›®æ ‡ï¼Œåˆ™æ˜¯æŠŠéæ–¹é˜µéƒ¨åˆ†çš„æ±‚è§£è¡¥ä¸Šï¼Œä½¿å¾—æ­£äº¤çº¦æŸä¸‹çš„ä¼˜åŒ–å¾—ä»¥å®Œå…¨è§£å†³ã€‚</p>
<h2 id="_1">ä»»åŠ¡ä¿¡æ¯</h2>
<p>å…ˆç®€å•å›é¡¾ä¸€ä¸‹ä¸Šæ–‡<a href="/archives/11215">ã€Šæµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š2. Muon + æ­£äº¤ã€‹</a>çš„ç»“æœã€‚æˆ‘ä»¬è¦æ±‚è§£çš„ç›®æ ‡æ˜¯<br />
\begin{equation}\newcommand{tr}{\mathop{\text{tr}}}\max_{\boldsymbol{\Phi}} \tr(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) \qquad \text{s.t.}\qquad \Vert\boldsymbol{\Phi}\Vert_2 = 1,\,\, \boldsymbol{W}^{\top}\boldsymbol{W}=\boldsymbol{I},\,\,(\boldsymbol{W} - \eta \boldsymbol{\Phi})^{\top}(\boldsymbol{W} - \eta \boldsymbol{\Phi})=\boldsymbol{I}\end{equation}<br />
å…¶ä¸­$\boldsymbol{W},\boldsymbol{\Phi}\in\mathbb{R}^{n\times m}(n \geq m)$ï¼Œ$\Vert\cdot\Vert_2$æ˜¯è°±èŒƒæ•°ã€‚åŸºäºâ€œä¸€é˜¶è¿‘ä¼¼å¤Ÿç”¨â€çš„åŸåˆ™ï¼Œå¯ä»¥ç®€åŒ–æˆ<br />
\begin{equation}\max_{\boldsymbol{\Phi}} \tr(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) \qquad \text{s.t.}\qquad \Vert\boldsymbol{\Phi}\Vert_2 = 1,\,\, \boldsymbol{W}^{\top}\boldsymbol{W}=\boldsymbol{I},\,\,\boldsymbol{W}^{\top}\boldsymbol{\Phi}+\boldsymbol{\Phi}^{\top}\boldsymbol{W} = \boldsymbol{0}\label{eq:ori-obj}\end{equation}<br />
å…¶ä¸­æ»¡è¶³$\boldsymbol{W}^{\top}\boldsymbol{\Phi}+\boldsymbol{\Phi}^{\top}\boldsymbol{W} = \boldsymbol{0}$çš„å…¨ä½“$\boldsymbol{\Phi}$ä¹Ÿç§°ä¸º$\boldsymbol{W}^{\top}\boldsymbol{W}=\boldsymbol{I}$çš„â€œåˆ‡ç©ºé—´â€ã€‚åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­æˆ‘ä»¬å·²ç»æ±‚å‡ºäº†é€šè§£çš„å½¢å¼<br />
\begin{equation}\boldsymbol{\Phi} = \newcommand{msign}{\mathop{\text{msign}}}\msign(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})\end{equation}<br />
å…¶ä¸­$\boldsymbol{X}\in\mathbb{R}^{m\times m}$æ˜¯ä¸€ä¸ªå¾…å®šçš„å¯¹ç§°çŸ©é˜µã€‚</p>
<p>å‰©ä¸‹çš„éš¾é¢˜å°±æ˜¯ç»™å‡ºå¯¹ç§°çŸ©é˜µ$\boldsymbol{X}$çš„è®¡ç®—æ–¹æ³•ï¼Œä½¿å¾—$\boldsymbol{W}^{\top}\boldsymbol{\Phi}$æ˜¯ä¸€ä¸ªåå¯¹ç§°çŸ©é˜µã€‚ä¸€æ—¦å®Œæˆæ±‚è§£ï¼Œé‚£ä¹ˆå¯¹åº”çš„$\boldsymbol{\Phi}$è‡ªç„¶æ˜¯æœ€ä¼˜è§£ã€‚å¯¹äº$n=m$ï¼Œæˆ‘ä»¬å·²ç»æ±‚å¾—é—­å¼è§£$\boldsymbol{X}=-[\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}$ï¼›çœŸæ­£å›°éš¾çš„æ˜¯$n &gt; m$çš„æƒ…å½¢ï¼Œæ­¤æ—¶äº¦ç§°ä¸ºâ€œStiefelæµå½¢â€ï¼Œå®ƒæ­£æ˜¯<a href="https://docs.modula.systems/algorithms/manifold/orthogonal/#open-problem-extending-to-the-stiefel-manifold">ã€ŠOrthogonal manifoldã€‹</a>æ‰€ç•™ä¸‹çš„Open problemã€‚</p>
<h2 id="_2">æ–¹ç¨‹å˜æ¢</h2>
<p>è¯´ç™½äº†ï¼Œæˆ‘ä»¬ç°åœ¨çš„ä»»åŠ¡æ˜¯æ±‚è§£æ–¹ç¨‹ç»„ï¼š<br />
\begin{equation}\boldsymbol{W}^{\top}\msign(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})+\msign(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})^{\top}\boldsymbol{W} = \boldsymbol{0}\label{eq:start}\end{equation}<br />
å½“$n=m$æ—¶ï¼Œ$\boldsymbol{W}^{\top}$å¯ä»¥ç›´æ¥å¸æ”¶åˆ°$\msign$é‡Œè¾¹ã€‚æ‰€ä»¥æ±‚è§£å¾—ä»¥ç®€åŒ–ï¼Œç„¶è€Œ$n &gt; m$æ—¶å¹¶ä¸èƒ½åšè¿™æ ·çš„å¸æ”¶ï¼Œè¿™ä¹Ÿæ˜¯æ±‚è§£çš„å›°éš¾æ‰€åœ¨ã€‚ç¬”è€…å€¾å‘äº$n &gt; m$æ—¶æ²¡æœ‰ç®€å•çš„æ˜¾å¼è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¥å¯»æ±‚æ•°å€¼ç®—æ³•ã€‚</p>
<p>æ ¹æ®å®šä¹‰$\msign(\boldsymbol{M})=\boldsymbol{M}(\boldsymbol{M}^{\top}\boldsymbol{M})^{-1/2}$ï¼Œå¯ä»¥å†™å‡º<br />
\begin{equation}\boldsymbol{W}^{\top}\msign(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X}) = \boldsymbol{W}^{\top}(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})\boldsymbol{Q}^{-1} = (\boldsymbol{W}^{\top}\boldsymbol{G} + \boldsymbol{X})\boldsymbol{Q}^{-1}\end{equation}<br />
å…¶ä¸­$\boldsymbol{Q} = ((\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})^{\top}(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X}))^{1/2}$ã€‚åœ¨è¿™ä¸ªæ–°è®°å·ä¸‹ï¼Œæ–¹ç¨‹ç»„å˜ä¸º<br />
\begin{equation}(\boldsymbol{W}^{\top}\boldsymbol{G} + \boldsymbol{X})\boldsymbol{Q}^{-1} + \boldsymbol{Q}^{-1}(\boldsymbol{G}^{\top}\boldsymbol{W} + \boldsymbol{X}) = \boldsymbol{0}\end{equation}<br />
åŒæ—¶å·¦ä¹˜å’Œå³ä¹˜$\boldsymbol{Q}$ï¼Œå¾—åˆ°<br />
\begin{equation}\boldsymbol{Q}(\boldsymbol{W}^{\top}\boldsymbol{G} + \boldsymbol{X}) + (\boldsymbol{G}^{\top}\boldsymbol{W} + \boldsymbol{X})\boldsymbol{Q} = \boldsymbol{0}\label{eq:r-x}\end{equation}<br />
å…¶ä¸­$\boldsymbol{Q}$åˆæˆç«‹<br />
\begin{equation}\boldsymbol{Q} = (\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})^{\top}\msign(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})\label{eq:r-q}\end{equation}</p>
<h2 id="_3">è¿­ä»£æ±‚è§£</h2>
<p>ç°åœ¨ç¬”è€…çš„æƒ³æ³•æ˜¯ï¼Œä»æŸä¸ªåˆå€¼çš„$\boldsymbol{X}$å‡ºå‘ï¼Œä»£å…¥å¼$\eqref{eq:r-q}$å¾—åˆ°$\boldsymbol{Q}$ï¼Œç„¶åå°†$\boldsymbol{Q}$ä»£å…¥æ–¹ç¨‹ç»„$\eqref{eq:r-x}$æ±‚è§£å‡ºæ–°çš„$\boldsymbol{X}$ï¼Œåå¤è¿­ä»£ï¼Œç›´åˆ°æ”¶æ•›ã€‚åœ¨å·²çŸ¥$\msign$çš„æƒ…å†µä¸‹ï¼Œå¼$\eqref{eq:r-q}$æ˜¯å¯ä»¥æ˜¾å¼è®¡ç®—çš„ï¼Œæ‰€ä»¥å”¯ä¸€çš„éš¾åº¦æ˜¯è§£æ–¹ç¨‹ç»„$\eqref{eq:r-x}$ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æ•´ç†ä¸€ä¸‹å¼$\eqref{eq:r-x}$ï¼š<br />
\begin{equation}\boldsymbol{Q}\boldsymbol{X} + \boldsymbol{X}\boldsymbol{Q} = -2[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}\label{eq:r-xx}\end{equation}<br />
åœ¨ç»™å®š$\boldsymbol{Q}$çš„å‰æä¸‹ï¼Œè¿™å…¶å®æ˜¯å…³äº$\boldsymbol{X}$æ˜¯çº¿æ€§æ–¹ç¨‹ç»„ï¼Œåä¸ºâ€œ<a href="https://en.wikipedia.org/wiki/Lyapunov_equation">è¿ç»­å‹Lyapunovæ–¹ç¨‹</a>â€ï¼Œä¹Ÿå¯ä»¥çœ‹æˆæ˜¯â€œ<a href="https://en.wikipedia.org/wiki/Sylvester_equation">Sylvesteræ–¹ç¨‹</a>â€çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚å¦‚æœæˆ‘ä»¬åªç”¨CPUè¿›è¡Œè®¡ç®—ï¼ŒScipyå…¶å®å·²ç»è‡ªå¸¦äº†è¯¥æ–¹ç¨‹çš„æ±‚è§£å‡½æ•°<code>scipy.linalg.solve_continuous_lyapunov</code>ï¼Œç›´æ¥è°ƒç”¨å³å¯ã€‚</p>
<p>è‡³äºåˆå€¼çš„é€‰æ‹©ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘æ–¹é˜µæ—¶çš„è§£$-[\boldsymbol{W}^{\top}\boldsymbol{G}]<em _text_sym="\text{sym">{\text{sym}}$ï¼Œè¿™æ ·æ˜¾ç„¶æ˜¯æ–¹é˜µåˆ°éæ–¹é˜µçš„ä¸€ä¸ªè‡ªç„¶è¿‡æ¸¡ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»æ–¹ç¨‹$\eqref{eq:r-xx}$çš„å¦ä¸€ä¸ªç­‰ä»·å½¢å¼ï¼Œæ¥è§‚å¯Ÿåˆå€¼$-[\boldsymbol{W}^{\top}\boldsymbol{G}]</em>$çš„åˆç†æ€§ï¼š}<br />
\begin{equation}\boldsymbol{Q}(\boldsymbol{X} + [\boldsymbol{W}^{\top}\boldsymbol{G}]<em _text_sym="\text{sym">{\text{sym}}) + (\boldsymbol{X} + [\boldsymbol{W}^{\top}\boldsymbol{G}]</em>]}})\boldsymbol{Q} =[\boldsymbol{W}^{\top}\boldsymbol{G<em _text_skew="\text{skew">{\text{skew}}\boldsymbol{Q} -\boldsymbol{Q}[\boldsymbol{W}^{\top}\boldsymbol{G}]</em>}}\end{equation<br />
æ‰€ä»¥$-[\boldsymbol{W}^{\top}\boldsymbol{G}]<em _text_skew="\text{skew">{\text{sym}}$çš„ç²¾ç¡®ç¨‹åº¦ï¼Œå–å†³äº$[\boldsymbol{W}^{\top}\boldsymbol{G}]</em>$å°±è¶Šå‡†ç¡®ã€‚ä¸è¿‡åé¢çš„å®æµ‹ç»“æœæ˜¾ç¤ºï¼Œæˆ‘ä»¬çš„è¿­ä»£ç®—æ³•å¯¹åˆå€¼å¹¶ä¸æ˜¯ç‰¹åˆ«æ•æ„Ÿï¼Œå³ä¾¿ä»¥å…¨é›¶çŸ©é˜µä¸ºåˆå€¼é—®é¢˜ä¹Ÿä¸å¤§ã€‚}}$ä¸$\boldsymbol{Q}$ä¹˜æ³•çš„å¯äº¤æ¢ç¨‹åº¦ï¼Œå®ƒä»¬è¶Šæ¥è¿‘äº¤æ¢çŸ©é˜µï¼Œé‚£ä¹ˆ$-[\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}</p>
<h2 id="_4">è‡ªå·±åŠ¨æ‰‹</h2>
<p>åˆšæ‰æˆ‘ä»¬è¯´åˆ°Scipyè‡ªå¸¦äº†æ±‚è§£Lyapunovæ–¹ç¨‹å‡½æ•°ï¼Œå› æ­¤å¯ä»¥ç›´æ¥è°ƒç”¨è€Œæ— éœ€å…³å¿ƒæ±‚è§£è¿‡ç¨‹ã€‚ä½†è¿™ä¹Ÿä»…é™äºCPUçš„Scipyï¼Œç¬”è€…æŸ¥äº†ä¸€ä¸‹ï¼ŒTorchå’ŒJaxéƒ½æ²¡æœ‰åŒç±»å‡½æ•°ï¼Œæ‰€ä»¥è¦ç”¨GPUè®¡ç®—çš„è¯ï¼Œåªèƒ½â€œè‡ªåŠ›æ›´ç”Ÿâ€ã€‚</p>
<p>è‡ªå·±ç¼–ç¨‹æ±‚è§£æ–¹ç¨‹$\eqref{eq:r-xx}$çš„åšæ³•æœ‰ä¸¤ä¸ªã€‚ä¸€æ˜¯æŒ‰ç…§<a href="/archives/11056">ã€ŠçŸ©é˜µç¬¦å·å‡½æ•°mcsgnèƒ½è®¡ç®—ä»€ä¹ˆï¼Ÿã€‹</a>çš„æ€è·¯ï¼Œç”¨$\newcommand{mcsgn}{\mathop{\text{mcsgn}}}\mcsgn$ï¼ˆä¸æ˜¯$\msign$ï¼‰æ¥æ±‚è§£ï¼š<br />
\begin{equation}\boldsymbol{X} = \mcsgn\left(\begin{bmatrix}-\boldsymbol{Q} &amp; -[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]<em _:m_m:_="[:m,m:]">{\text{sym}} \\\ \boldsymbol{0} &amp; \boldsymbol{Q}\end{bmatrix}\right)</em>}\end{equation<br />
äºŒæ˜¯åŸºäºSVDæ±‚è§£ï¼Œè¿™ä¸ªæ–¹æ³•æˆ‘ä»¬åœ¨<a href="/archives/11025">ã€Šmsignçš„å¯¼æ•°ã€‹</a>é‡Œè®¡ç®—$\msign$çš„æ¢¯åº¦æ—¶å·²ç»ç”¨è¿‡ï¼Œè¿™é‡Œç»“åˆæ–¹ç¨‹$\eqref{eq:r-xx}$å†ä»‹ç»ä¸€éã€‚æ ¹æ®$\boldsymbol{Q}$çš„å®šä¹‰çŸ¥å®ƒæ˜¯æ­£å®šå¯¹ç§°çš„ï¼Œé‚£ä¹ˆå¯ä»¥ç‰¹å¾å€¼åˆ†è§£ä¸º$\boldsymbol{V}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ï¼Œå…¶ä¸­$\boldsymbol{V}$æ˜¯æ­£äº¤çŸ©é˜µè€Œ$\boldsymbol{\Sigma}=\mathop{\text{diag}}(\sigma_1,\cdots,\sigma_m)$æ˜¯å¯¹è§’çŸ©é˜µï¼Œä»£å…¥åˆ°å¼$\eqref{eq:r-xx}$ï¼Œå¯æ•´ç†å¾—<br />
\begin{equation}\boldsymbol{\Sigma}(\boldsymbol{V}^{\top}\boldsymbol{X}\boldsymbol{V}) + (\boldsymbol{V}^{\top}\boldsymbol{X}\boldsymbol{V})\boldsymbol{\Sigma} = -2\boldsymbol{V}^{\top}[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]<em i_j="i,j">{\text{sym}}\boldsymbol{V}\end{equation}<br />
å·¦ç«¯å¯ä»¥è¡¨ç¤ºæˆ$(\boldsymbol{V}^{\top}\boldsymbol{X}\boldsymbol{V})\otimes \boldsymbol{S}$ï¼Œå…¶ä¸­$\otimes$æ˜¯Hadamardç§¯ï¼Œ$\boldsymbol{S}</em> = \sigma_i + \sigma_j$ã€‚ç”±æ­¤ï¼Œå¯ä»¥è§£å¾—<br />
\begin{equation}\boldsymbol{X} = -2\boldsymbol{V}((\boldsymbol{V}^{\top}[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}\boldsymbol{V})\oslash \boldsymbol{S})\boldsymbol{V}^{\top}\end{equation}<br />
å…¶ä¸­$\oslash$æ˜¯Hadamardå•†ã€‚è¿™é‡Œæ¯”è¾ƒæœ‰è¶£çš„åœ°æ–¹æ˜¯ï¼Œå¯¹$\boldsymbol{Q}$åšç‰¹å¾å€¼åˆ†è§£ï¼ŒåŸºæœ¬ç­‰ä»·äºå¯¹$\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X}$åšSVDï¼Œè€Œå¯¹$\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X}$åšSVDä¹Ÿå¯ä»¥ç”¨æ¥æ±‚$\msign(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})$ï¼Œæ‰€ä»¥åªéœ€ä¸€éSVDå°±å¯ä»¥æŠŠ$\msign$å’Œæ–¹ç¨‹$\eqref{eq:r-xx}$çš„è§£éƒ½ç®—å‡ºæ¥ã€‚</p>
<p>ä¸¤ä¸ªæ€è·¯å„æœ‰ç‰¹ç‚¹ã€‚æ€è·¯ä¸€éœ€è¦å…ˆå¯¹$m\times m$çš„çŸ©é˜µç®—$\msign$ï¼Œå†å¯¹$2m\times 2m$çš„çŸ©é˜µç®—$\mcsgn$ï¼Œè™½ç„¶å®ƒä»¬éƒ½å¯ä»¥ç”¨Newton-Schulzè¿­ä»£æ¥é«˜æ•ˆè®¡ç®—ï¼Œä½†ä¹Ÿä»£ä»·ä¸è²ã€‚æ­¤å¤–ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜è¦é€‰æ‹©èƒ½æ”¶æ•›ä¸”ç²¾åº¦é«˜çš„ç³»æ•°ï¼ˆæ¨è<a href="/archives/10996">ã€Šmsignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸‹ï¼‰ã€‹</a>çš„ç»“æœï¼‰ï¼Œè¦ä¸ç„¶$\mcsgn$å’Œ$\msign$çš„è®¡ç®—éƒ½ä¸æ”¶æ•›ï¼Œæ›´åˆ«è¯´$\boldsymbol{X}$äº†ã€‚</p>
<p>æ€è·¯äºŒéœ€è¦ç”¨åˆ°SVDã€‚è™½ç„¶SVDçš„å¤æ‚åº¦è¾ƒé«˜ï¼Œè€Œä¸”å¾€å¾€è¦å¼ºåˆ¶ä½¿ç”¨FP32ç²¾åº¦ï¼Œä½†åœ¨è¿™é‡Œçš„é—®é¢˜ä¸Šï¼Œæ¯ä¸€æ­¥è¿­ä»£åªéœ€è¦ä¸€æ¬¡SVDå°±å¯ä»¥åŒæ—¶æ±‚$\msign$å’Œ$\boldsymbol{X}$ï¼Œæ€»ä½“æ•ˆç‡ä¹Ÿä¸ä¼šå¤ªå·®ã€‚å¦‚æœæˆ‘ä»¬éœ€è¦æ­£äº¤çº¦æŸçš„çŸ©é˜µå‚æ•°å¹¶ä¸å¤šï¼Œé‚£ä¹ˆSVDå¯èƒ½æ˜¯æœ€ç®€ä¾¿çš„é€‰æ‹©ã€‚</p>
<h2 id="_5">ç›¸å…³ç»“æœ</h2>
<p>æœ¬æ–‡ä¹‹å‰ï¼Œ<a href="https://x.com/leloykun">@leloy</a> åœ¨ä»–çš„åšå®¢æ–‡ç« <a href="https://leloykun.github.io/ponder/steepest-descent-stiefel/">ã€ŠHeuristic Solutions for Steepest Descent on the Stiefel Manifoldã€‹</a>ä¹Ÿæå‡ºäº†åŸå§‹ç›®æ ‡$\eqref{eq:ori-obj}$çš„ä¸¤ç§å¯å‘å¼æ±‚è§£æ–¹æ³•ã€‚è¿™é‡Œçš„â€œå¯å‘å¼â€ï¼ŒæŒ‡çš„æ˜¯åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå®ƒèƒ½å¾—åˆ°ä¸€ä¸ªè¿˜ä¸é”™çš„è§£ï¼Œä½†æ— æ³•ä¿è¯æ˜¯æœ€ä¼˜è§£ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿä¸€èµ·å­¦ä¹ ä¸‹ã€‚</p>
<p>ç¬¬ä¸€ç§æ–¹æ³•å¯ä»¥è¯´æ˜¯çº¯å‡ ä½•æ³•ã€‚é¦–å…ˆæˆ‘ä»¬å®šä¹‰æŠ•å½±è¿ç®—ï¼š<br />
\begin{equation}\newcommand{proj}{\mathop{\mathcal{P}}}\proj\nolimits_{\boldsymbol{W}}(\boldsymbol{M}) = \boldsymbol{M} - \boldsymbol{W}[\boldsymbol{W}^{\top}\boldsymbol{M}]<em _boldsymbol_W="\boldsymbol{W">{\text{sym}}\end{equation}<br />
å¯ä»¥éªŒè¯$\boldsymbol{W}^{\top}\proj\nolimits</em>$çš„åˆ‡ç©ºé—´ä¸­çš„æŠ•å½±è¿ç®—ã€‚}}(\boldsymbol{M})$ä¸€å®šæ˜¯åå¯¹ç§°çŸ©é˜µï¼Œä¹Ÿå°±æ˜¯è¯´$\proj\nolimits_{\boldsymbol{W}}(\boldsymbol{M})$ä¸€å®šåœ¨åˆ‡ç©ºé—´ä¸­ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å®ƒè§†ä¸ºä»»æ„çŸ©é˜µ$\boldsymbol{M}$æŠ•å½±åˆ°$\boldsymbol{W}^{\top}\boldsymbol{W}=\boldsymbol{I</p>
<p>æˆ‘ä»¬ä»æ¢¯åº¦$\boldsymbol{G}$å‡ºå‘ï¼Œ$\proj\nolimits_{\boldsymbol{W}}(\boldsymbol{M})$è‚¯å®šæ˜¯åœ¨åˆ‡ç©ºé—´äº†ï¼Œä½†æˆ‘ä»¬çŸ¥é“Muonçš„æ›´æ–°é‡ä¸€å®šæ˜¯ä¸ªæ­£äº¤çŸ©é˜µï¼ˆæ»¡ç§©æ—¶ï¼‰ï¼Œè€Œ$\proj\nolimits_{\boldsymbol{W}}(\boldsymbol{M})$ä¸ä¸€å®šæ­£äº¤ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡$\msign$æ¥å¯»æ‰¾ä¸ä¹‹æœ€é‚»è¿‘çš„æ­£äº¤çŸ©é˜µï¼Œå³$\msign(\proj\nolimits_{\boldsymbol{W}}(\boldsymbol{M}))$ã€‚ç„¶è€Œ$\msign$ä¹‹ååˆä¸ä¸€å®šåœ¨åˆ‡ç©ºé—´äº†ï¼Œæˆ‘ä»¬åˆå¯ä»¥å°†å®ƒæŠ•å½±åˆ°åˆ‡ç©ºé—´å»ï¼Œç„¶ååˆå¯»æ‰¾æœ€è¿‘æ­£äº¤çŸ©é˜µï¼Œåå¤è¿­ä»£ï¼š<br />
\begin{equation}\boldsymbol{\Phi} = (\msign\circ\proj\nolimits_{\boldsymbol{W}}\circ\cdots\circ\msign\circ\proj\nolimits_{\boldsymbol{W}})(\boldsymbol{M})\end{equation}<br />
è¿™ä¾¿æ˜¯ @leloy çš„ç¬¬ä¸€ç§æ€è·¯ï¼Œäº¤æ›¿æŠ•å½±åˆ°åˆ‡ç©ºé—´å’Œæ­£äº¤ç©ºé—´ç›´åˆ°æ”¶æ•›ï¼Œå¯ä»¥è¯´ç›¸å½“ç›´è§‚ã€‚è€Œä¸”åœ¨æ¯”è¾ƒéšæœºçš„æƒ…å†µä¸‹ï¼Œå®ƒè·Ÿæœ€ä¼˜è§£ä¹Ÿéå¸¸æ¥è¿‘ï¼Œç”šè‡³èƒ½ç²¾ç¡®åˆ°å°æ•°ç‚¹å4ä½ï¼Œä»¥è‡³äºç¬”è€…ä¸€å¼€å§‹è®¤ä¸ºå®ƒå°±æ˜¯ç²¾ç¡®è§£ã€‚ä¸è¿‡åæ¥ç»è¿‡æœç´¢ï¼Œå‘ç°äº†å®ƒè·Ÿæœ€ä¼˜è§£åå·®è¶³å¤Ÿå¤§çš„caseï¼Œæ‰ç¡®è®¤äº†è¿™åªæ˜¯å·§åˆï¼Œå¹¶éæœ€ä¼˜è§£ã€‚</p>
<p>ç¬¬äºŒç§æ–¹æ³•å¯ä»¥ç§°ä¸ºçº¿æœç´¢ã€‚å…·ä½“æ¥è¯´ï¼Œå½“$n &gt; m$æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å°†$\boldsymbol{W}$è¡¥æˆæ ‡å‡†çš„$n\times n$çš„æ­£äº¤çŸ©é˜µ$[\boldsymbol{W},\overline{\boldsymbol{W}}]$ï¼Œç„¶åå°†æ‰€æ±‚$\boldsymbol{\Phi}$åˆ†è§£ä¸º$\boldsymbol{W}^{\top}\boldsymbol{\Phi}$å’Œ$\overline{\boldsymbol{W}}{}^{\top}\boldsymbol{\Phi}$ä¸¤éƒ¨ä»½ã€‚æ¥ç€ @leloy åšäº†ä¸€ä¸ªè´ªå¿ƒè¿‘ä¼¼ï¼Œå…ˆæ±‚$\boldsymbol{W}^{\top}\boldsymbol{\Phi}$çš„æœ€ä¼˜è§£ï¼Œç„¶åå†æ±‚$\overline{\boldsymbol{W}}{}^{\top}\boldsymbol{\Phi}$çš„æœ€ä¼˜è§£ï¼Œä¸¤è€…ä¹‹é—´å†å¼•å…¥ä¸€ä¸ªçº¿æœç´¢æ¥æé«˜å‡†ç¡®åº¦ã€‚</p>
<p>è¿™æ ·ä¸€å¥—æ“ä½œä¸‹æ¥ï¼Œç¡®å®èƒ½å¾—åˆ°ä¸€ä¸ªè¿‘ä¼¼ç¨‹åº¦è¿˜ä¸é”™çš„è§£ï¼Œå¹¶ä¸”å®ƒä¸€å®šåœ¨åˆ‡ç©ºé—´å†…ä¸”æ»¡è¶³æ­£äº¤æ€§ã€‚æ±‚è§£è¿‡ç¨‹éœ€è¦è®¡ç®—è°±èŒƒæ•°ã€$\msign$å’Œ<a href="https://en.wikipedia.org/wiki/Cholesky_decomposition">Choleskyåˆ†è§£</a>ï¼Œç»†èŠ‚å¤§å®¶è‡ªè¡Œçœ‹ä½œè€…çš„æ–‡ç« äº†ã€‚æ­¤å¤–ï¼Œå½“$m=2$æ—¶ï¼Œç†è®ºä¸Šå®ƒæ˜¯èƒ½æœå‡ºæœ€ä¼˜è§£çš„ï¼Œè¿™æ˜¯å› ä¸º$2\times 2$çš„åå¯¹ç§°çŸ©é˜µåªæœ‰ä¸€ä¸ªè‡ªç”±å‚æ•°ï¼Œè€Œçº¿æœç´¢åˆšå¥½æ˜¯ä¸€ä¸ªè‡ªç”±åº¦ã€‚</p>
<h2 id="_6">æµ‹è¯•ä¸€ä¸‹</h2>
<p>ä¸‹é¢åœ¨Numpyä¸­å®æµ‹ä¸Šé¢å‡ ä¸ªæ–¹æ³•ï¼Œå…¶ä¸­ä¸»è¦ç›®çš„æ˜¯éªŒè¯æ–¹æ³•æœ¬èº«çš„æ­£ç¡®æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥ç”¨å¥‡å¼‚å€¼åˆ†è§£å’Œç‰¹å¾å€¼åˆ†è§£æ¥å®ç°$\msign$å’Œ$\mcsgn$ã€‚</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mcsgn</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ç‰¹å¾å€¼åˆ†è§£ç²¾ç¡®è®¡ç®—mcsgn</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">s</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">v</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="kp">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">sign</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="kp">inv</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">msign</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;å¥‡å¼‚å€¼åˆ†è§£ç²¾ç¡®è®¡ç®—msign</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="kp">svd</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="kp">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">sign</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">@</span> <span class="n">vh</span>

<span class="k">def</span><span class="w"> </span><span class="nf">sym</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;å¯¹ç§°åŒ–</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>

<span class="k">def</span><span class="w"> </span><span class="nf">skew</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;åå¯¹ç§°åŒ–</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.5</span>

<span class="k">def</span><span class="w"> </span><span class="nf">proj</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;æŠ•å½±åˆ°æ­£äº¤çš„åˆ‡ç©ºé—´</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">g</span> <span class="o">-</span> <span class="n">w</span> <span class="o">@</span> <span class="n">sym</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">jianlin_by_mcsgn</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;é€šè¿‡mcsgnæ¥æ„å»ºæœ¬æ–‡çš„è¿­ä»£</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="kp">shape</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">sym</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">msign</span><span class="p">(</span><span class="n">z</span> <span class="o">:=</span> <span class="n">g</span> <span class="o">+</span> <span class="n">w</span> <span class="o">@</span> <span class="n">x</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;step:&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;, inner product:&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">phi</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="kp">sum</span><span class="p">(),</span> <span class="s1">&#39;, tangent error:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="kp">abs</span><span class="p">(</span><span class="n">sym</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span><span class="p">))</span><span class="o">.</span><span class="kp">mean</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">steps</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">phi</span>
        <span class="n">q</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">mcsgn</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">block</span><span class="p">([[</span><span class="o">-</span><span class="n">q</span><span class="p">,</span> <span class="o">-</span><span class="n">sym</span><span class="p">(</span><span class="n">q</span> <span class="o">@</span> <span class="n">w</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">g</span><span class="p">)],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="kp">zeros_like</span><span class="p">(</span><span class="n">q</span><span class="p">),</span> <span class="n">q</span><span class="p">]]))[:</span><span class="n">m</span><span class="p">,</span> <span class="n">m</span><span class="p">:]</span>
        <span class="c1"># x = -2 * sp.linalg.solve_continuous_lyapunov(q, sym(q @ w.T @ g))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">jianlin_by_svd</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;é€šè¿‡svdæ¥æ„å»ºæœ¬æ–‡çš„è¿­ä»£</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="n">sym</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="kp">svd</span><span class="p">(</span><span class="n">z</span> <span class="o">:=</span> <span class="n">g</span> <span class="o">+</span> <span class="n">w</span> <span class="o">@</span> <span class="n">x</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">sign</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">@</span> <span class="n">vh</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;step:&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;, inner product:&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">phi</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="kp">sum</span><span class="p">(),</span> <span class="s1">&#39;, tangent error:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="kp">abs</span><span class="p">(</span><span class="n">sym</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span><span class="p">))</span><span class="o">.</span><span class="kp">mean</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="n">steps</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">phi</span>
        <span class="n">x</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">vh</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="p">(</span><span class="n">vh</span> <span class="o">@</span> <span class="n">sym</span><span class="p">(</span><span class="n">z</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span> <span class="o">@</span> <span class="n">w</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">g</span><span class="p">)</span> <span class="o">@</span> <span class="n">vh</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="p">(</span><span class="n">s</span> <span class="o">+</span> <span class="n">s</span><span class="p">[:,</span> <span class="kc">None</span><span class="p">]))</span> <span class="o">@</span> <span class="n">vh</span>

<span class="k">def</span><span class="w"> </span><span class="nf">leloy_v1</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;äº¤æ›¿æŠ•å½±åˆ°åˆ‡ç©ºé—´å’Œæ­£äº¤ç©ºé—´</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">g</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">msign</span><span class="p">(</span><span class="n">proj</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">w</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;step:&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;, inner product:&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">phi</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="kp">sum</span><span class="p">(),</span> <span class="s1">&#39;, tangent error:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="kp">abs</span><span class="p">(</span><span class="n">sym</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span><span class="p">))</span><span class="o">.</span><span class="kp">mean</span><span class="p">())</span>
    <span class="k">return</span> <span class="n">phi</span>

<span class="k">def</span><span class="w"> </span><span class="nf">leloy_v2</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;åˆ†éƒ¨è´ªå¿ƒæ±‚è§£ + çº¿æœç´¢ï¼ˆå½¢å¼ç»è¿‡ç¬”è€…çš„ç®€åŒ–ï¼‰</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">g</span><span class="o">.</span><span class="kp">shape</span>
    <span class="n">taus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">steps</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">p_max</span><span class="p">,</span> <span class="n">tau_opt</span><span class="p">,</span> <span class="n">phi_opt</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">None</span>
    <span class="k">for</span> <span class="n">tau</span> <span class="ow">in</span> <span class="n">taus</span><span class="p">:</span>
        <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">:=</span> <span class="n">skew</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">g</span><span class="p">))</span> <span class="o">*</span> <span class="n">tau</span> <span class="o">/</span> <span class="nb">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">),</span> <span class="mf">1e-8</span><span class="p">)</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">cholesky</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">eye</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">-</span> <span class="n">b</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">b</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">msign</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="kp">eye</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">-</span> <span class="n">w</span> <span class="o">@</span> <span class="n">w</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">@</span> <span class="n">g</span> <span class="o">@</span> <span class="n">r</span><span class="p">)</span> <span class="o">@</span> <span class="n">r</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">w</span> <span class="o">@</span> <span class="n">b</span> <span class="o">+</span> <span class="n">c</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;tau:&#39;</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="s1">&#39;, inner product:&#39;</span><span class="p">,</span> <span class="n">p</span> <span class="o">:=</span> <span class="p">(</span><span class="n">phi</span> <span class="o">*</span> <span class="n">g</span><span class="p">)</span><span class="o">.</span><span class="kp">sum</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">p</span> <span class="o">&gt;</span> <span class="n">p_max</span><span class="p">:</span>
            <span class="n">p_max</span><span class="p">,</span> <span class="n">tau_opt</span><span class="p">,</span> <span class="n">phi_opt</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span> <span class="n">tau</span><span class="p">,</span> <span class="n">phi</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;best inner product:&#39;</span><span class="p">,</span> <span class="n">p_max</span><span class="p">,</span> <span class="s1">&#39;, tau:&#39;</span><span class="p">,</span> <span class="n">tau_opt</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">phi_opt</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">([[</span> <span class="mf">0.69453734</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26590866</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44721806</span><span class="p">,</span>  <span class="mf">0.2753041</span> <span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">0.11738148</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5588003</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.17580748</span><span class="p">,</span>  <span class="mf">0.3218624</span> <span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">0.4515288</span> <span class="p">,</span> <span class="o">-</span><span class="mf">0.23489913</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26683152</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25739142</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.02392521</span><span class="p">,</span>  <span class="mf">0.02664689</span><span class="p">,</span>  <span class="mf">0.48423648</span><span class="p">,</span>  <span class="mf">0.6193399</span> <span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.45194831</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.25206333</span><span class="p">,</span>  <span class="mf">0.27654836</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.60242337</span><span class="p">],</span>
              <span class="p">[</span> <span class="mf">0.21197332</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09174792</span><span class="p">,</span>  <span class="mf">0.24521762</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.08484317</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">0.15496767</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.26446804</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34942415</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01877318</span><span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">0.16181251</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.6474956</span> <span class="p">,</span>  <span class="mf">0.45243263</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.01776086</span><span class="p">]])</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">17.85745</span>   <span class="p">,</span> <span class="o">-</span><span class="mf">10.758921</span>  <span class="p">,</span>  <span class="o">-</span><span class="mf">2.9583392</span> <span class="p">,</span>   <span class="mf">6.245008</span>  <span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">28.883093</span>  <span class="p">,</span>  <span class="mf">19.772121</span>  <span class="p">,</span>   <span class="mf">8.086545</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">21.564013</span>  <span class="p">],</span>
              <span class="p">[</span> <span class="o">-</span><span class="mf">1.6274693</span> <span class="p">,</span> <span class="o">-</span><span class="mf">14.96859</span>   <span class="p">,</span>   <span class="mf">3.4465332</span> <span class="p">,</span>   <span class="mf">3.1070817</span> <span class="p">],</span>
              <span class="p">[</span> <span class="o">-</span><span class="mf">7.8890743</span> <span class="p">,</span>   <span class="mf">1.5304767</span> <span class="p">,</span>  <span class="o">-</span><span class="mf">8.949573</span>  <span class="p">,</span>   <span class="mf">9.579629</span>  <span class="p">],</span>
              <span class="p">[</span>  <span class="mf">2.246596</span>  <span class="p">,</span>  <span class="mf">14.46572</span>   <span class="p">,</span>  <span class="mf">12.8451</span>    <span class="p">,</span>  <span class="o">-</span><span class="mf">2.7370298</span> <span class="p">],</span>
              <span class="p">[</span> <span class="o">-</span><span class="mf">0.9496974</span> <span class="p">,</span>   <span class="mf">6.9879804</span> <span class="p">,</span>   <span class="mf">2.849277</span>  <span class="p">,</span>   <span class="mf">1.1148484</span> <span class="p">],</span>
              <span class="p">[</span> <span class="o">-</span><span class="mf">8.115278</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">18.054405</span>  <span class="p">,</span>  <span class="o">-</span><span class="mf">0.19287404</span><span class="p">,</span>   <span class="mf">7.0389237</span> <span class="p">],</span>
              <span class="p">[</span><span class="o">-</span><span class="mf">15.062008</span>  <span class="p">,</span> <span class="o">-</span><span class="mf">15.02901</span>   <span class="p">,</span>   <span class="mf">2.9083247</span> <span class="p">,</span>  <span class="mf">21.706533</span>  <span class="p">]])</span>

<span class="n">phi1</span> <span class="o">=</span> <span class="n">jianlin_by_mcsgn</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">phi2</span> <span class="o">=</span> <span class="n">jianlin_by_svd</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">phi3</span> <span class="o">=</span> <span class="n">leloy_v1</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">phi4</span> <span class="o">=</span> <span class="n">leloy_v2</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="kp">allclose</span><span class="p">(</span><span class="n">phi1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">)</span>

<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">qr</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>

<span class="n">phi1</span> <span class="o">=</span> <span class="n">jianlin_by_mcsgn</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">phi2</span> <span class="o">=</span> <span class="n">jianlin_by_svd</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">phi3</span> <span class="o">=</span> <span class="n">leloy_v1</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">phi4</span> <span class="o">=</span> <span class="n">leloy_v2</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">w</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="kp">allclose</span><span class="p">(</span><span class="n">phi1</span><span class="p">,</span> <span class="n">phi2</span><span class="p">)</span>
</code></pre></div>

<p>å¯¹äºä»£ç ä¸­ç»™å‡ºçš„ç¬¬ä¸€ç»„$\boldsymbol{W},\boldsymbol{G}$ï¼Œç¬”è€…æ–¹æ³•æ±‚å¾—çš„æœ€ä¼˜$\tr(\boldsymbol{G}^{\top} \boldsymbol{\Phi})$å¤§è‡´æ˜¯$90$ï¼Œå¹¶ä¸”$\mcsgn$å’ŒSVDçš„ç»“æœæ˜¯å®Œå…¨ä¸€æ ·çš„ï¼›è€Œ @leloy çš„ç¬¬ä¸€ç§æ–¹æ³•æ±‚å¾—çš„ç»“æœæ˜¯å¤§è‡´æ˜¯$70$ï¼Œç¬¬äºŒç§æ–¹æ³•æ±‚å¾—çš„ç»“æœå¤§è‡´æ˜¯$80$ï¼Œéƒ½è·Ÿæœ€ä¼˜è§£æœ‰ä¸€å®šå·®è·ã€‚</p>
<p>ä¸è¿‡ï¼Œç¬¬ä¸€ç»„$\boldsymbol{W},\boldsymbol{G}$åªæ˜¯ä¸ºäº†æ˜¾ç¤ºå‡ºä¸‰ä¸ªæ–¹æ³•å·®è·ç‰¹æ„æœå‡ºæ¥çš„æç«¯ä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬æ›´æ¢ç›¸å¯¹éšæœºçš„æ•°å€¼ï¼Œé‚£ä¹ˆå…¶å®æœ¬æ–‡çš„è§£æ³•å’Œ @leloy çš„ç¬¬ä¸€ç§è§£æ³•ä¼šå¾ˆæ¥è¿‘ï¼Œå¹¶ä¸”è¿­ä»£æ­¥æ•°ä¹Ÿå¯ä»¥å°‘å¾ˆå¤šï¼ˆ5ï½10æ­¥ï¼‰ï¼Œæ­¤æ—¶ @leloy çš„ç¬¬äºŒç§è§£æ³•è·Ÿæœ€ä¼˜è§£å·®è·æ›´å¤§ã€‚è¯»è€…å¯ä»¥è‡ªè¡Œæ„å»ºä¸€äº›ä¾‹å­æµ‹è¯•ã€‚</p>
<h2 id="_7">æ‹“å±•æ€è€ƒ</h2>
<p>å…³äºåŸå§‹é—®é¢˜$\eqref{eq:ori-obj}$çš„æ±‚è§£ï¼Œè¿™é‡Œå°±æš‚å‘Šä¸€æ®µè½äº†ã€‚æ¥ä¸‹æ¥è¡¥å……è®¨è®ºå‡ ä¸ªå¯èƒ½æœ‰ç–‘æƒ‘çš„ç»†èŠ‚é—®é¢˜ã€‚</p>
<p>é¦–å…ˆï¼Œä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œç¬”è€…å‰é¢ç»™å‡ºçš„è¿­ä»£æ±‚è§£è¿‡ç¨‹æœ‰ä¸€ä¸ªéšå«å‡è®¾ï¼Œé‚£å°±æ˜¯$\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X}$è‡ªå§‹è‡³ç»ˆéƒ½æ˜¯æ»¡ç§©çš„ï¼ˆç§©ä¸º$m$ï¼‰ï¼Œè¦ä¸ç„¶çŸ©é˜µ$\boldsymbol{S}$å°±ä¼šæœ‰é›¶åˆ†é‡ï¼Œ$\oslash\boldsymbol{S}$å°±ä¸å¤§å¥½æ“ä½œã€‚ä½†è¿™ä¸ªå›°éš¾ä¸æ˜¯æœ¬è´¨çš„ï¼Œå› ä¸ºæ–¹ç¨‹$\eqref{eq:start}$å¿…ç„¶ä¼šæœ‰è§£ï¼Œæ‰€ä»¥é‡åˆ°åˆ†æ¯ä¸ºé›¶æ—¶ï¼Œåˆ†å­å¿…ç„¶ä¹Ÿä¸ºé›¶ï¼Œäºæ˜¯æˆ‘ä»¬åªéœ€è¦ç®€å•å°†$\boldsymbol{S}$çš„é›¶åˆ†é‡æ¢æˆä¸€ä¸ªå°æ­£æ•°ï¼Œå°±èƒ½å¾—åˆ°æ­£ç¡®çš„ç»“æœã€‚</p>
<p>ä»æ•°å€¼è®¡ç®—çš„è§’åº¦çœ‹ï¼Œæˆ‘ä»¬ä¹Ÿå¾ˆå°‘æœ‰æœºä¼šèƒ½é‡åˆ°ç»å¯¹ç­‰äºé›¶çš„å¥‡å¼‚å€¼ï¼Œæ‰€ä»¥ä¸éœ€è¦å¤ªæ‹…å¿ƒè¿™ä¸ªé—®é¢˜ï¼Œé»˜è®¤$\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X}$æ»¡ç§©å°±å¥½ã€‚åœ¨è¿™ä¸ªé»˜è®¤å‡è®¾ä¹‹ä¸‹ï¼Œå›ç¼©æ“ä½œä¼šå˜å¾—å¾ˆç®€å•ï¼Œå› ä¸º<br />
\begin{equation}(\boldsymbol{W} - \eta\boldsymbol{\Phi})^{\top}(\boldsymbol{W} - \eta\boldsymbol{\Phi}) = \boldsymbol{W}^{\top} \boldsymbol{W} - \eta(\boldsymbol{W}^{\top} \boldsymbol{\Phi} + \boldsymbol{\Phi}^{\top}\boldsymbol{W}) + \eta^2 \boldsymbol{\Phi}^{\top}\boldsymbol{\Phi}\end{equation}<br />
æ ¹æ®Stiefelæµå½¢çš„å®šä¹‰ï¼Œå³ç«¯ç¬¬ä¸€é¡¹æ˜¯$\boldsymbol{I}$ï¼Œæ ¹æ®åˆ‡ç©ºé—´çš„æ¡ä»¶ï¼Œç¬¬äºŒé¡¹æ˜¯$\boldsymbol{0}$ï¼Œæœ€åæ˜¯æ»¡ç§©æ—¶$\msign$å‡ºæ¥çš„ä¹Ÿæ˜¯ä¸€ä¸ªStiefelæµå½¢çš„çŸ©é˜µï¼Œæ‰€ä»¥ç¬¬ä¸‰é¡¹æ˜¯$\eta^2 \boldsymbol{I}$ï¼Œæ€»çš„ç»“æœæ˜¯$(1+\eta^2)\boldsymbol{I}$ï¼Œåªéœ€è¦é™¤ä»¥$\sqrt{1+\eta^2}$å°±å¯ä»¥å®ç°å›ç¼©ï¼š<br />
\begin{equation}\boldsymbol{W}\quad\leftarrow\quad\frac{\boldsymbol{W} - \eta\boldsymbol{\Phi}}{\sqrt{1+\eta^2}}\end{equation}</p>
<p>çœ‹åˆ°è¿™é‡Œï¼Œä¸çŸ¥é“ç¬”è€…æœ‰æ²¡æœ‰å‘ç°ï¼Œè¿™é‡Œå…¶å®æœ‰ä¸€ä¸ªæ›´æ·±åˆ»çš„é—®é¢˜ï¼šä¸ç®¡æ˜¯ç›¸å¯¹ç®€å•çš„æ­£äº¤æµå½¢ï¼Œè¿˜æ˜¯ç›¸å¯¹å¤æ‚çš„Stiefelæµå½¢ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨ä½•ç§ç²¾åº¦è®¡ç®—ï¼Ÿè¦çŸ¥é“â€œæ­£äº¤â€æ˜¯ä¸€ä¸ªç²¾ç¡®çš„å®šé‡çº¦æŸï¼Œ$\boldsymbol{W}^{\top}\boldsymbol{W}=\boldsymbol{I}$åŒ…å«$m(m+1)/2$ä¸ªç­‰å¼çº¦æŸï¼Œå¯ä»¥é¢„è§åœ¨ä½ç²¾åº¦ä¸‹ç”¨ä¸Šå¼è¿›è¡Œè¿­ä»£ï¼Œä¹…è€Œä¹…ä¹‹è‚¯å®šä¼šä¸¥é‡åç¦»æ­£äº¤çš„ï¼Œæ›´ä¸ç”¨è¯´æ±‚è§£$\boldsymbol{\Phi}$è¿‡ç¨‹ä¸­çš„è¯¯å·®äº†ã€‚</p>
<p>å› æ­¤ï¼Œç¬”è€…è®¤ä¸ºï¼Œé™¤éæˆ‘ä»¬å®šæœŸç»™å‚æ•°æ–½åŠ æ­£äº¤åŒ–æ“ä½œï¼ˆå³$\boldsymbol{W}\leftarrow\msign(\boldsymbol{W})$ï¼‰æ¥å°†å®ƒæ‹‰å›åˆ°æ­£äº¤æµå½¢ä¸Šï¼Œå¦åˆ™æ±‚è§£è¿‡ç¨‹çš„è®¡ç®—ç²¾åº¦èµ·ç è¦FP32èµ·æ­¥ã€‚è€ƒè™‘åˆ°é€šå¸¸è¦åŠ æ­£äº¤çº¦æŸçš„å‚æ•°å¹¶ä¸ä¼šå¾ˆå¤šï¼Œæ‰€ä»¥ä¸€èˆ¬æ¥è¯´è¿™ä¹Ÿä¸ç®—å¤ªå¤§çš„ä»£ä»·ã€‚</p>
<h2 id="_8">æ–‡ç« å°ç»“</h2>
<p>è¿™ç¯‡æ–‡ç« å°†ä¸Šä¸€ç¯‡æ–‡ç« çš„â€œMuon + æ­£äº¤æµå½¢â€æ¨å¹¿åˆ°äº†æ›´ä¸€èˆ¬çš„â€œMuon + Stiefelæµå½¢â€ï¼Œä¸»è¦å‘ç°æ˜¯ä¸€ä¸ªæ±‚è§£å¯¹åº”æ›´æ–°é‡çš„è¿­ä»£ç®—æ³•ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11221">https://spaces.ac.cn/archives/11221</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Aug. 08, 2025). ã€Šæµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š3. Muon + Stiefel ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11221">https://spaces.ac.cn/archives/11221</a></p>
<p>@online{kexuefm-11221,<br />
title={æµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š3. Muon + Stiefel},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Aug},<br />
url={\url{https://spaces.ac.cn/archives/11221}},<br />
} </p>
<hr />
<h2 id="_9">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1-stiefel">1. Stiefelæµå½¢çš„æ•°å­¦å®šä¹‰</h3>
<p><strong>å®šä¹‰1.1ï¼ˆStiefelæµå½¢ï¼‰</strong>ï¼šStiefelæµå½¢$\mathrm{St}(n,m)$æ˜¯$\mathbb{R}^{n\times m}$ä¸­æ‰€æœ‰åˆ—æ­£äº¤çŸ©é˜µçš„é›†åˆï¼š</p>
<p>$$
\mathrm{St}(n,m) = \{\boldsymbol{W}\in\mathbb{R}^{n\times m} : \boldsymbol{W}^{\top}\boldsymbol{W} = \boldsymbol{I}_m\}
$$</p>
<p>å…¶ä¸­$n\geq m$ï¼Œ$\boldsymbol{I}_m$æ˜¯$m$é˜¶å•ä½çŸ©é˜µã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šå½“$n=m$æ—¶ï¼ŒStiefelæµå½¢é€€åŒ–ä¸ºæ­£äº¤ç¾¤$\mathrm{O}(n)$ï¼›å½“$m=1$æ—¶ï¼ŒStiefelæµå½¢é€€åŒ–ä¸ºå•ä½çƒé¢$\mathbb{S}^{n-1}$ã€‚Stiefelæµå½¢æ˜¯ä¸€ä¸ªç´§è‡´çš„å…‰æ»‘æµå½¢ï¼Œå…¶ç»´æ•°ä¸º$nm - \frac{m(m+1)}{2}$ã€‚</p>
<p><strong>æ¨å¯¼1.1ï¼ˆç»´æ•°è®¡ç®—ï¼‰</strong>ï¼šStiefelæµå½¢ä½œä¸º$\mathbb{R}^{n\times m}$çš„å­æµå½¢ï¼Œç¯å¢ƒç©ºé—´ç»´æ•°ä¸º$nm$ã€‚çº¦æŸ$\boldsymbol{W}^{\top}\boldsymbol{W} = \boldsymbol{I}_m$ç»™å‡º$\frac{m(m+1)}{2}$ä¸ªç‹¬ç«‹çš„ç­‰å¼çº¦æŸï¼ˆå› ä¸º$\boldsymbol{W}^{\top}\boldsymbol{W}$æ˜¯å¯¹ç§°çŸ©é˜µï¼‰ï¼š</p>
<p>$$
(\boldsymbol{W}^{\top}\boldsymbol{W})_{ij} = \sum_{k=1}^n W_{ki}W_{kj} = \delta_{ij}, \quad 1\leq i\leq j\leq m
$$</p>
<p>å› æ­¤ï¼ŒStiefelæµå½¢çš„ç»´æ•°ä¸ºï¼š</p>
<p>$$
\dim(\mathrm{St}(n,m)) = nm - \frac{m(m+1)}{2}
$$</p>
<h3 id="2">2. åˆ‡ç©ºé—´çš„ä¸¥æ ¼æ¨å¯¼</h3>
<p><strong>å®šä¹‰2.1ï¼ˆåˆ‡ç©ºé—´ï¼‰</strong>ï¼šStiefelæµå½¢åœ¨ç‚¹$\boldsymbol{W}$å¤„çš„åˆ‡ç©ºé—´$T_{\boldsymbol{W}}\mathrm{St}(n,m)$å®šä¹‰ä¸ºï¼š</p>
<p>$$
T_{\boldsymbol{W}}\mathrm{St}(n,m) = \{\boldsymbol{\Xi}\in\mathbb{R}^{n\times m} : \boldsymbol{W}^{\top}\boldsymbol{\Xi} + \boldsymbol{\Xi}^{\top}\boldsymbol{W} = \boldsymbol{0}\}
$$</p>
<p><strong>æ¨å¯¼2.1ï¼ˆåˆ‡ç©ºé—´æ¡ä»¶çš„å¯¼å‡ºï¼‰</strong>ï¼šè€ƒè™‘Stiefelæµå½¢ä¸Šé€šè¿‡$\boldsymbol{W}$çš„ä¸€æ¡å…‰æ»‘æ›²çº¿$\boldsymbol{W}(t)$ï¼Œæ»¡è¶³$\boldsymbol{W}(0)=\boldsymbol{W}$å’Œ$\boldsymbol{W}(t)^{\top}\boldsymbol{W}(t)=\boldsymbol{I}_m$å¯¹æ‰€æœ‰$t$æˆç«‹ã€‚</p>
<p>å¯¹çº¦æŸæ¡ä»¶å…³äº$t$æ±‚å¯¼ï¼Œåœ¨$t=0$å¤„å¾—åˆ°ï¼š</p>
<p>$$
\frac{d}{dt}\Big|_{t=0} (\boldsymbol{W}(t)^{\top}\boldsymbol{W}(t)) = \boldsymbol{W}'(0)^{\top}\boldsymbol{W}(0) + \boldsymbol{W}(0)^{\top}\boldsymbol{W}'(0) = \boldsymbol{0}
$$</p>
<p>è®°$\boldsymbol{\Xi} = \boldsymbol{W}'(0)$ä¸ºåˆ‡å‘é‡ï¼Œåˆ™æœ‰ï¼š</p>
<p>$$
\boldsymbol{W}^{\top}\boldsymbol{\Xi} + \boldsymbol{\Xi}^{\top}\boldsymbol{W} = \boldsymbol{0}
$$</p>
<p>è¿™è¡¨æ˜$\boldsymbol{W}^{\top}\boldsymbol{\Xi}$å¿…é¡»æ˜¯ä¸€ä¸ªåå¯¹ç§°çŸ©é˜µï¼ˆskew-symmetric matrixï¼‰ã€‚</p>
<p><strong>å¼•ç†2.1ï¼ˆåˆ‡ç©ºé—´çš„ç»´æ•°ï¼‰</strong>ï¼šåˆ‡ç©ºé—´$T_{\boldsymbol{W}}\mathrm{St}(n,m)$çš„ç»´æ•°ç­‰äºStiefelæµå½¢çš„ç»´æ•°ï¼Œå³$nm - \frac{m(m+1)}{2}$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šè®¾$\boldsymbol{\Xi}\in T_{\boldsymbol{W}}\mathrm{St}(n,m)$ï¼Œæˆ‘ä»¬å¯ä»¥å°†$\boldsymbol{\Xi}$åˆ†è§£ä¸ºï¼š</p>
<p>$$
\boldsymbol{\Xi} = \boldsymbol{W}\boldsymbol{A} + \boldsymbol{W}_{\perp}\boldsymbol{B}
$$</p>
<p>å…¶ä¸­$\boldsymbol{W}<em _perp="\perp">{\perp}\in\mathbb{R}^{n\times(n-m)}$æ»¡è¶³$\boldsymbol{W}</em>$ã€‚}^{\top}\boldsymbol{W}=\boldsymbol{0}$ä¸”$[\boldsymbol{W},\boldsymbol{W}_{\perp}]$æ˜¯æ­£äº¤çŸ©é˜µï¼Œ$\boldsymbol{A}\in\mathbb{R}^{m\times m}$ï¼Œ$\boldsymbol{B}\in\mathbb{R}^{(n-m)\times m</p>
<p>ä»£å…¥åˆ‡ç©ºé—´æ¡ä»¶ï¼š</p>
<p>$$
\boldsymbol{W}^{\top}\boldsymbol{\Xi} + \boldsymbol{\Xi}^{\top}\boldsymbol{W} = \boldsymbol{A} + \boldsymbol{A}^{\top} = \boldsymbol{0}
$$</p>
<p>å› æ­¤$\boldsymbol{A}$å¿…é¡»æ˜¯åå¯¹ç§°çŸ©é˜µï¼Œæœ‰$\frac{m(m-1)}{2}$ä¸ªè‡ªç”±åº¦ï¼›è€Œ$\boldsymbol{B}$å¯ä»¥æ˜¯ä»»æ„çš„$(n-m)\times m$çŸ©é˜µï¼Œæœ‰$(n-m)m$ä¸ªè‡ªç”±åº¦ã€‚æ€»è‡ªç”±åº¦ä¸ºï¼š</p>
<p>$$
\frac{m(m-1)}{2} + (n-m)m = \frac{m^2 - m + 2nm - 2m^2}{2} = nm - \frac{m(m+1)}{2}
$$</p>
<h3 id="3">3. æ³•ç©ºé—´çš„æ¨å¯¼</h3>
<p><strong>å®šä¹‰3.1ï¼ˆæ³•ç©ºé—´ï¼‰</strong>ï¼šStiefelæµå½¢åœ¨ç‚¹$\boldsymbol{W}$å¤„çš„æ³•ç©ºé—´$N_{\boldsymbol{W}}\mathrm{St}(n,m)$å®šä¹‰ä¸ºåˆ‡ç©ºé—´åœ¨$\mathbb{R}^{n\times m}$ä¸­å…³äºFrobeniuså†…ç§¯çš„æ­£äº¤è¡¥ï¼š</p>
<p>$$
N_{\boldsymbol{W}}\mathrm{St}(n,m) = \{\boldsymbol{\Psi}\in\mathbb{R}^{n\times m} : \langle\boldsymbol{\Psi},\boldsymbol{\Xi}\rangle_F = 0, \forall \boldsymbol{\Xi}\in T_{\boldsymbol{W}}\mathrm{St}(n,m)\}
$$</p>
<p><strong>æ¨å¯¼3.1ï¼ˆæ³•ç©ºé—´çš„æ˜¾å¼è¡¨ç¤ºï¼‰</strong>ï¼šæ³•å‘é‡å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<p>$$
N_{\boldsymbol{W}}\mathrm{St}(n,m) = \{\boldsymbol{W}\boldsymbol{S} : \boldsymbol{S}\in\mathbb{R}^{m\times m}, \boldsymbol{S}^{\top}=\boldsymbol{S}\}
$$</p>
<p><strong>è¯æ˜</strong>ï¼šå¯¹ä»»æ„$\boldsymbol{\Psi}=\boldsymbol{W}\boldsymbol{S}$ï¼ˆ$\boldsymbol{S}$å¯¹ç§°ï¼‰å’Œ$\boldsymbol{\Xi}\in T_{\boldsymbol{W}}\mathrm{St}(n,m)$ï¼Œæœ‰ï¼š</p>
<p>$$
\langle\boldsymbol{\Psi},\boldsymbol{\Xi}\rangle_F = \text{tr}(\boldsymbol{\Psi}^{\top}\boldsymbol{\Xi}) = \text{tr}(\boldsymbol{S}^{\top}\boldsymbol{W}^{\top}\boldsymbol{\Xi}) = \text{tr}(\boldsymbol{S}(\boldsymbol{W}^{\top}\boldsymbol{\Xi}))
$$</p>
<p>ç”±äº$\boldsymbol{W}^{\top}\boldsymbol{\Xi}$æ˜¯åå¯¹ç§°çš„ï¼Œè€Œ$\boldsymbol{S}$æ˜¯å¯¹ç§°çš„ï¼Œå®ƒä»¬çš„ä¹˜ç§¯çš„è¿¹ä¸ºé›¶ï¼š</p>
<p>$$
\text{tr}(\boldsymbol{S}(\boldsymbol{W}^{\top}\boldsymbol{\Xi})) = \sum_{i,j}S_{ij}(\boldsymbol{W}^{\top}\boldsymbol{\Xi})_{ji} = \sum_{i,j}S_{ij}(\boldsymbol{W}^{\top}\boldsymbol{\Xi})_{ji} = -\sum_{i,j}S_{ji}(\boldsymbol{W}^{\top}\boldsymbol{\Xi})_{ij} = -\text{tr}(\boldsymbol{S}(\boldsymbol{W}^{\top}\boldsymbol{\Xi}))
$$</p>
<p>å› æ­¤$\text{tr}(\boldsymbol{S}(\boldsymbol{W}^{\top}\boldsymbol{\Xi}))=0$ã€‚</p>
<p>åè¿‡æ¥ï¼Œå¦‚æœ$\boldsymbol{\Psi}\in N_{\boldsymbol{W}}\mathrm{St}(n,m)$ï¼Œåˆ™å¯¹æ‰€æœ‰$\boldsymbol{\Xi}=\boldsymbol{W}_{\perp}\boldsymbol{B}$å½¢å¼çš„åˆ‡å‘é‡ï¼Œæœ‰ï¼š</p>
<p>$$
\langle\boldsymbol{\Psi},\boldsymbol{W}_{\perp}\boldsymbol{B}\rangle_F = \text{tr}(\boldsymbol{\Psi}^{\top}\boldsymbol{W}_{\perp}\boldsymbol{B}) = 0
$$</p>
<p>è¿™æ„å‘³ç€$\boldsymbol{\Psi}^{\top}\boldsymbol{W}_{\perp}=\boldsymbol{0}$ï¼Œå³$\boldsymbol{\Psi}$åœ¨$\boldsymbol{W}$çš„åˆ—ç©ºé—´ä¸­ï¼Œæ•…$\boldsymbol{\Psi}=\boldsymbol{W}\boldsymbol{S}$ã€‚ä»£å…¥å¯¹æ‰€æœ‰$\boldsymbol{\Xi}=\boldsymbol{W}\boldsymbol{A}$ï¼ˆ$\boldsymbol{A}$åå¯¹ç§°ï¼‰çš„æ­£äº¤æ€§ï¼Œå¾—$\boldsymbol{S}$å¿…é¡»å¯¹ç§°ã€‚</p>
<h3 id="4">4. æŠ•å½±ç®—å­çš„æ¨å¯¼</h3>
<p><strong>å®šä¹‰4.1ï¼ˆåˆ‡ç©ºé—´æŠ•å½±ï¼‰</strong>ï¼šä»$\mathbb{R}^{n\times m}$åˆ°åˆ‡ç©ºé—´$T_{\boldsymbol{W}}\mathrm{St}(n,m)$çš„æ­£äº¤æŠ•å½±ç®—å­å®šä¹‰ä¸ºï¼š</p>
<p>$$
\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) = \boldsymbol{M} - \boldsymbol{W}[\boldsymbol{W}^{\top}\boldsymbol{M}]_{\text{sym}}
$$</p>
<p>å…¶ä¸­$[\cdot]<em _text_sym="\text{sym">{\text{sym}}$è¡¨ç¤ºå¯¹ç§°åŒ–æ“ä½œï¼š$[\boldsymbol{X}]</em>$ã€‚}} = \frac{\boldsymbol{X}+\boldsymbol{X}^{\top}}{2</p>
<p><strong>æ¨å¯¼4.1ï¼ˆæŠ•å½±ç®—å­çš„éªŒè¯ï¼‰</strong>ï¼šéœ€è¦éªŒè¯ä¸¤ä¸ªæ€§è´¨ï¼š
1. $\mathcal{P}<em _boldsymbol_W="\boldsymbol{W">{\boldsymbol{W}}(\boldsymbol{M})\in T</em>(n,m)$
2. $\boldsymbol{M}-\mathcal{P}}}\mathrm{St<em _boldsymbol_W="\boldsymbol{W">{\boldsymbol{W}}(\boldsymbol{M})\in N</em>(n,m)$}}\mathrm{St</p>
<p><strong>æ€§è´¨1çš„è¯æ˜</strong>ï¼š</p>
<p>$$
\begin{aligned}
\boldsymbol{W}^{\top}\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) &= \boldsymbol{W}^{\top}\boldsymbol{M} - \boldsymbol{W}^{\top}\boldsymbol{W}[\boldsymbol{W}^{\top}\boldsymbol{M}]_{\text{sym}}\\
&= \boldsymbol{W}^{\top}\boldsymbol{M} - [\boldsymbol{W}^{\top}\boldsymbol{M}]_{\text{sym}}\\
&= [\boldsymbol{W}^{\top}\boldsymbol{M}]_{\text{skew}}
\end{aligned}
$$</p>
<p>è¿™æ˜¯ä¸€ä¸ªåå¯¹ç§°çŸ©é˜µï¼Œæ»¡è¶³åˆ‡ç©ºé—´æ¡ä»¶ã€‚</p>
<p><strong>æ€§è´¨2çš„è¯æ˜</strong>ï¼š</p>
<p>$$
\boldsymbol{M}-\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) = \boldsymbol{W}[\boldsymbol{W}^{\top}\boldsymbol{M}]_{\text{sym}}
$$</p>
<p>è¿™æ˜¯$\boldsymbol{W}$ä¹˜ä»¥å¯¹ç§°çŸ©é˜µçš„å½¢å¼ï¼Œå±äºæ³•ç©ºé—´ã€‚</p>
<p><strong>å¼•ç†4.1ï¼ˆæŠ•å½±çš„å¹‚ç­‰æ€§ï¼‰</strong>ï¼š$\mathcal{P}<em _boldsymbol_W="\boldsymbol{W">{\boldsymbol{W}}$æ»¡è¶³$\mathcal{P}</em>$ã€‚}}^2 = \mathcal{P}_{\boldsymbol{W}</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>$$
\begin{aligned}
\mathcal{P}_{\boldsymbol{W}}(\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M})) &= \mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) - \boldsymbol{W}[\boldsymbol{W}^{\top}\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M})]_{\text{sym}}\\
&= \mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) - \boldsymbol{W}[[\boldsymbol{W}^{\top}\boldsymbol{M}]_{\text{skew}}]_{\text{sym}}\\
&= \mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M})
\end{aligned}
$$</p>
<p>æœ€åä¸€æ­¥åˆ©ç”¨äº†åå¯¹ç§°çŸ©é˜µçš„å¯¹ç§°éƒ¨åˆ†ä¸ºé›¶ã€‚</p>
<h3 id="5-muonstiefel">5. Muonåœ¨Stiefelæµå½¢ä¸Šçš„çº¦æŸä¼˜åŒ–</h3>
<p><strong>é—®é¢˜5.1ï¼ˆStiefelæµå½¢ä¸Šçš„Muonä¼˜åŒ–ï¼‰</strong>ï¼šç»™å®šæ¢¯åº¦$\boldsymbol{G}\in\mathbb{R}^{n\times m}$å’Œå½“å‰å‚æ•°$\boldsymbol{W}\in\mathrm{St}(n,m)$ï¼Œæ±‚è§£ï¼š</p>
<p>$$
\max_{\boldsymbol{\Phi}} \text{tr}(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) \quad \text{s.t.} \quad \|\boldsymbol{\Phi}\|_2 = 1, \quad \boldsymbol{\Phi}\in T_{\boldsymbol{W}}\mathrm{St}(n,m)
$$</p>
<p>å…¶ä¸­$|\cdot|_2$è¡¨ç¤ºè°±èŒƒæ•°ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰ã€‚</p>
<p><strong>æ¨å¯¼5.1ï¼ˆé€šè§£çš„å½¢å¼ï¼‰</strong>ï¼šä½¿ç”¨Lagrangeä¹˜æ•°æ³•ï¼Œå¼•å…¥å¾…å®šå¯¹ç§°çŸ©é˜µ$\boldsymbol{X}\in\mathbb{R}^{m\times m}$ï¼Œå¯ä»¥å†™å‡ºï¼š</p>
<p>$$
\boldsymbol{\Phi} = \text{msign}(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})
$$</p>
<p>å…¶ä¸­$\text{msign}(\boldsymbol{M}) = \boldsymbol{M}(\boldsymbol{M}^{\top}\boldsymbol{M})^{-1/2}$æ˜¯çŸ©é˜µç¬¦å·å‡½æ•°ã€‚</p>
<p><strong>è§£é‡Š</strong>ï¼šå¾…å®šçŸ©é˜µ$\boldsymbol{X}$çš„ä½œç”¨æ˜¯ç¡®ä¿$\boldsymbol{\Phi}$æ»¡è¶³åˆ‡ç©ºé—´æ¡ä»¶ã€‚æ³¨æ„$\boldsymbol{W}\boldsymbol{X}$è‡ªç„¶åœ¨æ³•ç©ºé—´ä¸­ï¼ˆå½“$\boldsymbol{X}$å¯¹ç§°æ—¶ï¼‰ï¼Œå› æ­¤$\boldsymbol{G}+\boldsymbol{W}\boldsymbol{X}$å¯ä»¥çœ‹ä½œæ˜¯å°†$\boldsymbol{G}$åœ¨æ³•ç©ºé—´æ–¹å‘ä¸Šåšè°ƒæ•´ã€‚</p>
<h3 id="6">6. æ ¸å¿ƒæ–¹ç¨‹çš„æ¨å¯¼</h3>
<p><strong>å®šç†6.1ï¼ˆåˆ‡ç©ºé—´æ¡ä»¶æ–¹ç¨‹ï¼‰</strong>ï¼š$\boldsymbol{\Phi}$æ»¡è¶³åˆ‡ç©ºé—´æ¡ä»¶å½“ä¸”ä»…å½“ï¼š</p>
<p>$$
\boldsymbol{W}^{\top}\text{msign}(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X}) + \text{msign}(\boldsymbol{G} + \boldsymbol{W}\boldsymbol{X})^{\top}\boldsymbol{W} = \boldsymbol{0}
$$</p>
<p><strong>æ¨å¯¼6.1ï¼ˆæ–¹ç¨‹çš„å˜æ¢ï¼‰</strong>ï¼šè®¾$\boldsymbol{Z} = \boldsymbol{G} + \boldsymbol{W}\boldsymbol{X}$ï¼Œ$\boldsymbol{\Phi} = \text{msign}(\boldsymbol{Z})$ï¼Œ$\boldsymbol{Q} = (\boldsymbol{Z}^{\top}\boldsymbol{Z})^{1/2}$ï¼Œåˆ™ï¼š</p>
<p>$$
\boldsymbol{\Phi} = \boldsymbol{Z}\boldsymbol{Q}^{-1}
$$</p>
<p>ä»£å…¥åˆ‡ç©ºé—´æ¡ä»¶ï¼š</p>
<p>$$
\begin{aligned}
\boldsymbol{W}^{\top}\boldsymbol{\Phi} + \boldsymbol{\Phi}^{\top}\boldsymbol{W} &= \boldsymbol{W}^{\top}\boldsymbol{Z}\boldsymbol{Q}^{-1} + \boldsymbol{Q}^{-1}\boldsymbol{Z}^{\top}\boldsymbol{W}\\
&= (\boldsymbol{W}^{\top}\boldsymbol{G} + \boldsymbol{X})\boldsymbol{Q}^{-1} + \boldsymbol{Q}^{-1}(\boldsymbol{G}^{\top}\boldsymbol{W} + \boldsymbol{X})\\
&= \boldsymbol{0}
\end{aligned}
$$</p>
<p>å·¦å³åŒæ—¶ä¹˜ä»¥$\boldsymbol{Q}$å¾—åˆ°ï¼š</p>
<p>$$
\boldsymbol{Q}(\boldsymbol{W}^{\top}\boldsymbol{G} + \boldsymbol{X}) + (\boldsymbol{G}^{\top}\boldsymbol{W} + \boldsymbol{X})\boldsymbol{Q} = \boldsymbol{0}
$$</p>
<p>æ•´ç†å¾—åˆ°è¿ç»­Lyapunovæ–¹ç¨‹ï¼š</p>
<p>$$
\boldsymbol{Q}\boldsymbol{X} + \boldsymbol{X}\boldsymbol{Q} = -\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G} - \boldsymbol{G}^{\top}\boldsymbol{W}\boldsymbol{Q} = -2[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}
$$</p>
<h3 id="7-lyapunov">7. è¿ç»­Lyapunovæ–¹ç¨‹çš„è¿­ä»£æ±‚è§£</h3>
<p><strong>å®šä¹‰7.1ï¼ˆè¿ç»­Lyapunovæ–¹ç¨‹ï¼‰</strong>ï¼šç»™å®šå¯¹ç§°æ­£å®šçŸ©é˜µ$\boldsymbol{Q}$å’Œå¯¹ç§°çŸ©é˜µ$\boldsymbol{C}$ï¼Œæ±‚è§£å¯¹ç§°çŸ©é˜µ$\boldsymbol{X}$æ»¡è¶³ï¼š</p>
<p>$$
\boldsymbol{Q}\boldsymbol{X} + \boldsymbol{X}\boldsymbol{Q} = \boldsymbol{C}
$$</p>
<p><strong>æ¨å¯¼7.1ï¼ˆé€šè¿‡ç‰¹å¾å€¼åˆ†è§£æ±‚è§£ï¼‰</strong>ï¼šè®¾$\boldsymbol{Q} = \boldsymbol{V}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$æ˜¯ç‰¹å¾å€¼åˆ†è§£ï¼Œå…¶ä¸­$\boldsymbol{V}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œ$\boldsymbol{\Sigma} = \text{diag}(\sigma_1,\ldots,\sigma_m)$ã€‚</p>
<p>ä»¤$\boldsymbol{Y} = \boldsymbol{V}^{\top}\boldsymbol{X}\boldsymbol{V}$ï¼Œ$\boldsymbol{D} = \boldsymbol{V}^{\top}\boldsymbol{C}\boldsymbol{V}$ï¼Œä»£å…¥æ–¹ç¨‹ï¼š</p>
<p>$$
\boldsymbol{\Sigma}\boldsymbol{Y} + \boldsymbol{Y}\boldsymbol{\Sigma} = \boldsymbol{D}
$$</p>
<p>é€å…ƒç´ å±•å¼€ï¼š</p>
<p>$$
\sigma_i Y_{ij} + Y_{ij}\sigma_j = D_{ij}
$$</p>
<p>$$
Y_{ij} = \frac{D_{ij}}{\sigma_i + \sigma_j}
$$</p>
<p>å› æ­¤è§£ä¸ºï¼š</p>
<p>$$
\boldsymbol{X} = \boldsymbol{V}\left(\boldsymbol{D} \oslash (\boldsymbol{\Sigma}\boldsymbol{1}^{\top} + \boldsymbol{1}\boldsymbol{\Sigma}^{\top})\right)\boldsymbol{V}^{\top}
$$</p>
<p>å…¶ä¸­$\oslash$è¡¨ç¤ºHadamardé™¤æ³•ï¼ˆé€å…ƒç´ é™¤æ³•ï¼‰ï¼Œ$\boldsymbol{1}$æ˜¯å…¨1å‘é‡ã€‚</p>
<h3 id="8-svd">8. åŸºäºSVDçš„é«˜æ•ˆæ±‚è§£</h3>
<p><strong>æ¨å¯¼8.1ï¼ˆç»“åˆSVDçš„ä¸€æ¬¡æ€§æ±‚è§£ï¼‰</strong>ï¼šæ³¨æ„åˆ°å¯¹$\boldsymbol{Z} = \boldsymbol{G}+\boldsymbol{W}\boldsymbol{X}$åšå¥‡å¼‚å€¼åˆ†è§£ï¼š</p>
<p>$$
\boldsymbol{Z} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}
$$</p>
<p>åˆ™æœ‰ï¼š</p>
<p>$$
\begin{aligned}
\text{msign}(\boldsymbol{Z}) &= \boldsymbol{U}\boldsymbol{V}^{\top}\\
\boldsymbol{Q} &= (\boldsymbol{Z}^{\top}\boldsymbol{Z})^{1/2} = \boldsymbol{V}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}
\end{aligned}
$$</p>
<p>å› æ­¤ä¸€æ¬¡SVDå¯ä»¥åŒæ—¶å¾—åˆ°$\text{msign}$å’Œ$\boldsymbol{Q}$çš„ç‰¹å¾å€¼åˆ†è§£ã€‚</p>
<p>å¯¹äºLyapunovæ–¹ç¨‹$\boldsymbol{Q}\boldsymbol{X} + \boldsymbol{X}\boldsymbol{Q} = -2[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}$ï¼Œå³ç«¯é¡¹å¯ä»¥å†™ä¸ºï¼š</p>
<p>$$
[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}} = [\boldsymbol{V}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}} = [\boldsymbol{Z}^{\top}\boldsymbol{\Phi}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}
$$</p>
<p><strong>ç®—æ³•8.1ï¼ˆSVDæ±‚è§£è¿­ä»£ï¼‰</strong>ï¼š
1. åˆå§‹åŒ–ï¼š$\boldsymbol{X}^{(0)} = -[\boldsymbol{W}^{\top}\boldsymbol{G}]<em _text_sym="\text{sym">{\text{sym}}$
2. è¿­ä»£ï¼ˆ$k=1,2,\ldots$ï¼‰ï¼š
   - è®¡ç®—$\boldsymbol{Z}^{(k)} = \boldsymbol{G} + \boldsymbol{W}\boldsymbol{X}^{(k-1)}$
   - SVDåˆ†è§£ï¼š$\boldsymbol{Z}^{(k)} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$
   - $\boldsymbol{\Phi}^{(k)} = \boldsymbol{U}\boldsymbol{V}^{\top}$
   - è®¡ç®—$\boldsymbol{D} = -2\boldsymbol{V}^{\top}[\boldsymbol{Z}^{(k)\top}\boldsymbol{\Phi}^{(k)}\boldsymbol{W}^{\top}\boldsymbol{G}]</em>$
   - $\boldsymbol{Y} = \boldsymbol{D} \oslash (\boldsymbol{\Sigma}\boldsymbol{1}^{\top} + \boldsymbol{1}\boldsymbol{\Sigma}^{\top})$
   - $\boldsymbol{X}^{(k)} = \boldsymbol{V}\boldsymbol{Y}\boldsymbol{V}^{\top}$
3. æ”¶æ•›åˆ¤æ–­ï¼š$|\boldsymbol{X}^{(k)} - \boldsymbol{X}^{(k-1)}|_F &lt; \epsilon$}}\boldsymbol{V</p>
<h3 id="9">9. æ”¶æ•›æ€§åˆ†æ</h3>
<p><strong>å®šç†9.1ï¼ˆä¸åŠ¨ç‚¹å­˜åœ¨æ€§ï¼‰</strong>ï¼šè¿­ä»£ç®—æ³•8.1å®šä¹‰äº†ä¸€ä¸ªå‹ç¼©æ˜ å°„$\mathcal{T}:\mathbb{R}^{m\times m}<em _text_sym="\text{sym">{\text{sym}}\to\mathbb{R}^{m\times m}</em>^*$æ»¡è¶³åŸæ–¹ç¨‹ã€‚}}$ï¼Œå­˜åœ¨å”¯ä¸€ä¸åŠ¨ç‚¹$\boldsymbol{X</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼šè€ƒè™‘æ˜ å°„$\mathcal{T}(\boldsymbol{X})$å®šä¹‰ä¸ºç”±$\boldsymbol{X}$é€šè¿‡ä¸Šè¿°è¿­ä»£æ­¥éª¤å¾—åˆ°çš„æ–°çš„$\boldsymbol{X}$ã€‚éœ€è¦è¯æ˜ï¼š
1. $\mathcal{T}$å°†å¯¹ç§°çŸ©é˜µæ˜ å°„åˆ°å¯¹ç§°çŸ©é˜µ
2. $\mathcal{T}$åœ¨æŸä¸ªèŒƒæ•°ä¸‹æ˜¯å‹ç¼©çš„</p>
<p>æ€§è´¨1æ˜¾ç„¶æˆç«‹ã€‚æ€§è´¨2çš„ä¸¥æ ¼è¯æ˜è¾ƒä¸ºæŠ€æœ¯æ€§ï¼Œä½†æ•°å€¼å®éªŒè¡¨æ˜è¿­ä»£é€šå¸¸åœ¨5-10æ­¥å†…æ”¶æ•›ã€‚</p>
<p><strong>å¼•ç†9.1ï¼ˆåˆå€¼çš„åˆç†æ€§ï¼‰</strong>ï¼šé€‰æ‹©$\boldsymbol{X}^{(0)} = -[\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}$å¯¹åº”äºæ–¹é˜µæƒ…å†µçš„ç²¾ç¡®è§£ï¼Œä¸ºéæ–¹é˜µæƒ…å†µæä¾›äº†è‰¯å¥½çš„åˆå§‹é€¼è¿‘ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šå½“$n=m$æ—¶ï¼Œ$\boldsymbol{W}$æ˜¯æ­£äº¤æ–¹é˜µï¼Œæœ‰$\boldsymbol{W}^{\top} = \boldsymbol{W}^{-1}$ã€‚æ­¤æ—¶å¯ä»¥è¯æ˜$\boldsymbol{X}^* = -[\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}$æ˜¯ç²¾ç¡®è§£ã€‚</p>
<p>å¯¹äº$n&gt;m$ï¼Œè™½ç„¶ä¸å†æ˜¯ç²¾ç¡®è§£ï¼Œä½†$[\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{skew}}$çš„"å°"ç¨‹åº¦å†³å®šäº†åˆå€¼çš„å‡†ç¡®åº¦ã€‚</p>
<h3 id="10">10. æŒ‡æ•°æ˜ å°„çš„æ•°å­¦å®šä¹‰</h3>
<p><strong>å®šä¹‰10.1ï¼ˆRiemannianæŒ‡æ•°æ˜ å°„ï¼‰</strong>ï¼šStiefelæµå½¢ä¸Šåœ¨ç‚¹$\boldsymbol{W}$å¤„æ²¿åˆ‡å‘é‡$\boldsymbol{\Xi}$çš„æŒ‡æ•°æ˜ å°„å®šä¹‰ä¸ºï¼š</p>
<p>$$
\text{Exp}_{\boldsymbol{W}}(\boldsymbol{\Xi}) = \boldsymbol{W}\exp(\boldsymbol{W}^{\top}\boldsymbol{\Xi}) + \boldsymbol{W}_{\perp}\exp\left(\begin{bmatrix}\boldsymbol{W}^{\top}\boldsymbol{\Xi} & -\boldsymbol{B}^{\top}\\ \boldsymbol{B} & \boldsymbol{0}\end{bmatrix}\right)_{[m:,:m]}
$$</p>
<p>å…¶ä¸­$\boldsymbol{\Xi} = \boldsymbol{W}\boldsymbol{A} + \boldsymbol{W}_{\perp}\boldsymbol{B}$æ˜¯åˆ‡å‘é‡çš„åˆ†è§£ã€‚</p>
<p><strong>æ¨å¯¼10.1ï¼ˆç®€åŒ–çš„æŒ‡æ•°æ˜ å°„ï¼‰</strong>ï¼šå¯¹äºå°æ­¥é•¿$\eta$ï¼ŒæŒ‡æ•°æ˜ å°„å¯ä»¥è¿‘ä¼¼ä¸ºï¼š</p>
<p>$$
\text{Exp}_{\boldsymbol{W}}(\eta\boldsymbol{\Xi}) \approx \boldsymbol{W} + \eta\boldsymbol{\Xi} + O(\eta^2)
$$</p>
<p>ä½†è¿™ä¸ä¿æŒæ­£äº¤æ€§ã€‚æ›´å¥½çš„è¿‘ä¼¼æ˜¯ä½¿ç”¨Cayleyå˜æ¢ã€‚</p>
<h3 id="11-cayley">11. Cayleyå˜æ¢</h3>
<p><strong>å®šä¹‰11.1ï¼ˆCayleyå˜æ¢ï¼‰</strong>ï¼šCayleyå˜æ¢æä¾›äº†ä»åå¯¹ç§°çŸ©é˜µåˆ°æ­£äº¤çŸ©é˜µçš„æ˜ å°„ï¼š</p>
<p>$$
\text{Cayley}(\boldsymbol{A}) = (\boldsymbol{I} - \boldsymbol{A})^{-1}(\boldsymbol{I} + \boldsymbol{A})
$$</p>
<p>å…¶ä¸­$\boldsymbol{A}$æ˜¯åå¯¹ç§°çŸ©é˜µã€‚</p>
<p><strong>æ¨å¯¼11.1ï¼ˆCayleyå˜æ¢çš„æ­£äº¤æ€§ï¼‰</strong>ï¼šè®¾$\boldsymbol{Q} = \text{Cayley}(\boldsymbol{A})$ï¼Œåˆ™ï¼š</p>
<p>$$
\begin{aligned}
\boldsymbol{Q}^{\top}\boldsymbol{Q} &= [(\boldsymbol{I}-\boldsymbol{A})^{-1}(\boldsymbol{I}+\boldsymbol{A})]^{\top}[(\boldsymbol{I}-\boldsymbol{A})^{-1}(\boldsymbol{I}+\boldsymbol{A})]\\
&= (\boldsymbol{I}+\boldsymbol{A}^{\top})[(\boldsymbol{I}-\boldsymbol{A})^{\top}]^{-1}(\boldsymbol{I}-\boldsymbol{A})^{-1}(\boldsymbol{I}+\boldsymbol{A})\\
&= (\boldsymbol{I}-\boldsymbol{A})[(\boldsymbol{I}-\boldsymbol{A})^{\top}]^{-1}(\boldsymbol{I}-\boldsymbol{A})^{-1}(\boldsymbol{I}+\boldsymbol{A})\\
&= (\boldsymbol{I}-\boldsymbol{A})^{-1}(\boldsymbol{I}+\boldsymbol{A})\\
&= \boldsymbol{I}
\end{aligned}
$$</p>
<p>æœ€åä¸€æ­¥åˆ©ç”¨äº†$\boldsymbol{A}$åå¯¹ç§°ï¼Œå³$\boldsymbol{A}^{\top}=-\boldsymbol{A}$ã€‚</p>
<p><strong>æ¨å¯¼11.2ï¼ˆåŸºäºCayleyå˜æ¢çš„æ”¶ç¼©ï¼‰</strong>ï¼šåœ¨Stiefelæµå½¢ä¸Šï¼Œæ›´æ–°å¯ä»¥å†™ä¸ºï¼š</p>
<p>$$
\boldsymbol{W}_{\text{new}} = (\boldsymbol{I} - \frac{\eta}{2}\boldsymbol{\Omega})^{-1}(\boldsymbol{I} + \frac{\eta}{2}\boldsymbol{\Omega})\boldsymbol{W}
$$</p>
<p>å…¶ä¸­$\boldsymbol{\Omega} = \boldsymbol{\Phi}\boldsymbol{W}^{\top} - \boldsymbol{W}\boldsymbol{\Phi}^{\top}$æ˜¯åå¯¹ç§°çŸ©é˜µã€‚</p>
<h3 id="12">12. ç®€åŒ–çš„æ”¶ç¼©æ˜ å°„</h3>
<p><strong>å®šç†12.1ï¼ˆç®€åŒ–æ”¶ç¼©å…¬å¼ï¼‰</strong>ï¼šå½“$\boldsymbol{\Phi} = \text{msign}(\boldsymbol{G}+\boldsymbol{W}\boldsymbol{X})$æ»¡è¶³åˆ‡ç©ºé—´æ¡ä»¶æ—¶ï¼Œæ›´æ–°å…¬å¼ç®€åŒ–ä¸ºï¼š</p>
<p>$$
\boldsymbol{W}_{\text{new}} = \frac{\boldsymbol{W} - \eta\boldsymbol{\Phi}}{\sqrt{1+\eta^2}}
$$</p>
<p><strong>æ¨å¯¼12.1</strong>ï¼šè®¡ç®—$(\boldsymbol{W}-\eta\boldsymbol{\Phi})^{\top}(\boldsymbol{W}-\eta\boldsymbol{\Phi})$ï¼š</p>
<p>$$
\begin{aligned}
&(\boldsymbol{W}-\eta\boldsymbol{\Phi})^{\top}(\boldsymbol{W}-\eta\boldsymbol{\Phi})\\
&= \boldsymbol{W}^{\top}\boldsymbol{W} - \eta(\boldsymbol{W}^{\top}\boldsymbol{\Phi} + \boldsymbol{\Phi}^{\top}\boldsymbol{W}) + \eta^2\boldsymbol{\Phi}^{\top}\boldsymbol{\Phi}\\
&= \boldsymbol{I}_m - \eta\cdot\boldsymbol{0} + \eta^2\boldsymbol{I}_m\\
&= (1+\eta^2)\boldsymbol{I}_m
\end{aligned}
$$</p>
<p>ç¬¬äºŒä¸ªç­‰å·ä½¿ç”¨äº†$\boldsymbol{W}^{\top}\boldsymbol{W}=\boldsymbol{I}_m$ï¼ˆStiefelçº¦æŸï¼‰ï¼Œ$\boldsymbol{W}^{\top}\boldsymbol{\Phi}+\boldsymbol{\Phi}^{\top}\boldsymbol{W}=\boldsymbol{0}$ï¼ˆåˆ‡ç©ºé—´æ¡ä»¶ï¼‰ï¼Œ$\boldsymbol{\Phi}^{\top}\boldsymbol{\Phi}=\boldsymbol{I}_m$ï¼ˆ$\text{msign}$çš„æ€§è´¨ï¼‰ã€‚</p>
<p>å› æ­¤$|\boldsymbol{W}-\eta\boldsymbol{\Phi}|_2 = \sqrt{1+\eta^2}$ï¼Œé™¤ä»¥æ­¤å› å­å³å¯æ¢å¤Stiefelçº¦æŸã€‚</p>
<h3 id="13">13. æ¢¯åº¦æµçš„å‡ ä½•è§£é‡Š</h3>
<p><strong>å®šä¹‰13.1ï¼ˆæ¢¯åº¦æµï¼‰</strong>ï¼šStiefelæµå½¢ä¸Šçš„æ¢¯åº¦æµæ˜¯å¸¸å¾®åˆ†æ–¹ç¨‹ï¼š</p>
<p>$$
\frac{d\boldsymbol{W}(t)}{dt} = -\text{grad}\, f(\boldsymbol{W}(t))
$$</p>
<p>å…¶ä¸­$\text{grad}\, f$æ˜¯Riemannianæ¢¯åº¦ï¼Œæ»¡è¶³ï¼š</p>
<p>$$
\text{grad}\, f(\boldsymbol{W}) = \mathcal{P}_{\boldsymbol{W}}(\nabla f(\boldsymbol{W}))
$$</p>
<p>$\nabla f$æ˜¯Euclideanæ¢¯åº¦ã€‚</p>
<p><strong>æ¨å¯¼13.1ï¼ˆRiemannianæ¢¯åº¦ï¼‰</strong>ï¼šå¯¹äºç›®æ ‡å‡½æ•°$f(\boldsymbol{W})$ï¼ŒEuclideanæ¢¯åº¦ä¸º$\boldsymbol{G} = \nabla f(\boldsymbol{W})$ï¼Œåˆ™Riemannianæ¢¯åº¦ä¸ºï¼š</p>
<p>$$
\text{grad}\, f(\boldsymbol{W}) = \boldsymbol{G} - \boldsymbol{W}[\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}
$$</p>
<p>è¿™æ­£æ˜¯æŠ•å½±ç®—å­$\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{G})$ã€‚</p>
<p><strong>æ¨å¯¼13.2ï¼ˆæ¢¯åº¦æµçš„ç¦»æ•£åŒ–ï¼‰</strong>ï¼šæ¢¯åº¦æµçš„æ˜¾å¼Eulerç¦»æ•£åŒ–ä¸ºï¼š</p>
<p>$$
\boldsymbol{W}_{k+1} = \boldsymbol{W}_k - \eta\,\text{grad}\,f(\boldsymbol{W}_k)
$$</p>
<p>ä½†è¿™ä¸ä¿æŒStiefelçº¦æŸã€‚éœ€è¦é¢å¤–çš„æ”¶ç¼©æ­¥éª¤ï¼š</p>
<p>$$
\boldsymbol{W}_{k+1} = \text{Retraction}(\boldsymbol{W}_k - \eta\,\text{grad}\,f(\boldsymbol{W}_k))
$$</p>
<p>å…¶ä¸­æ”¶ç¼©æ˜ å°„å°†ç»“æœæ‹‰å›æµå½¢ã€‚</p>
<h3 id="14">14. æµ‹åœ°çº¿åˆ†æ</h3>
<p><strong>å®šä¹‰14.1ï¼ˆæµ‹åœ°çº¿ï¼‰</strong>ï¼šStiefelæµå½¢ä¸Šçš„æµ‹åœ°çº¿æ˜¯å±€éƒ¨æœ€çŸ­è·¯å¾„ï¼Œæ»¡è¶³æµ‹åœ°çº¿æ–¹ç¨‹ï¼š</p>
<p>$$
\nabla_{\dot{\gamma}}\dot{\gamma} = 0
$$</p>
<p>å…¶ä¸­$\nabla$æ˜¯Riemannianè”ç»œï¼Œ$\gamma(t)$æ˜¯æµ‹åœ°çº¿ï¼Œ$\dot{\gamma}$æ˜¯åˆ‡å‘é‡åœºã€‚</p>
<p><strong>æ¨å¯¼14.1ï¼ˆæµ‹åœ°çº¿çš„æ˜¾å¼å½¢å¼ï¼‰</strong>ï¼šä»ç‚¹$\boldsymbol{W}\in\mathrm{St}(n,m)$å‡ºå‘ï¼Œæ²¿åˆé€Ÿåº¦$\boldsymbol{\Xi}\in T_{\boldsymbol{W}}\mathrm{St}(n,m)$çš„æµ‹åœ°çº¿ä¸ºï¼š</p>
<p>$$
\gamma(t) = [\boldsymbol{W},\boldsymbol{W}_{\perp}]\exp\left(t\begin{bmatrix}\boldsymbol{A} & -\boldsymbol{B}^{\top}\\ \boldsymbol{B} & \boldsymbol{0}\end{bmatrix}\right)\begin{bmatrix}\boldsymbol{I}_m\\ \boldsymbol{0}\end{bmatrix}
$$</p>
<p>å…¶ä¸­$\boldsymbol{\Xi} = \boldsymbol{W}\boldsymbol{A} + \boldsymbol{W}_{\perp}\boldsymbol{B}$ï¼Œ$\boldsymbol{A}$åå¯¹ç§°ã€‚</p>
<p><strong>å¼•ç†14.1ï¼ˆæµ‹åœ°çº¿çš„æ€§è´¨ï¼‰</strong>ï¼š
1. $\gamma(0) = \boldsymbol{W}$
2. $\dot{\gamma}(0) = \boldsymbol{\Xi}$
3. $\gamma(t)\in\mathrm{St}(n,m)$å¯¹æ‰€æœ‰$t$æˆç«‹
4. $|\dot{\gamma}(t)|_F$æ²¿æµ‹åœ°çº¿æ’å®š</p>
<h3 id="15">15. ä¸æ­£äº¤çº¦æŸçš„ç†è®ºè”ç³»</h3>
<p><strong>å®šç†15.1ï¼ˆStiefelæµå½¢ä¸æ­£äº¤ç¾¤çš„å…³ç³»ï¼‰</strong>ï¼šå½“$n=m$æ—¶ï¼Œ$\mathrm{St}(n,n) = \mathrm{O}(n)$ï¼ŒStiefelæµå½¢é€€åŒ–ä¸ºæ­£äº¤ç¾¤ã€‚</p>
<p><strong>æ¨å¯¼15.1ï¼ˆæ­£äº¤ç¾¤çš„ç‰¹æ®Šæ€§è´¨ï¼‰</strong>ï¼šå¯¹äºæ­£äº¤æ–¹é˜µ$\boldsymbol{Q}\in\mathrm{O}(n)$ï¼Œæœ‰ï¼š</p>
<p>$$
\boldsymbol{Q}^{\top}\boldsymbol{Q} = \boldsymbol{I} = \boldsymbol{Q}\boldsymbol{Q}^{\top}
$$</p>
<p>å³å·¦å³æ­£äº¤æ€§åŒæ—¶æˆç«‹ã€‚è¿™åœ¨$n&gt;m$æ—¶ä¸å†æˆç«‹ï¼š$\boldsymbol{W}^{\top}\boldsymbol{W}=\boldsymbol{I}_m$ä½†$\boldsymbol{W}\boldsymbol{W}^{\top}\neq\boldsymbol{I}_n$ã€‚</p>
<p><strong>æ¨å¯¼15.2ï¼ˆæ–¹é˜µæƒ…å†µçš„ç®€åŒ–ï¼‰</strong>ï¼šå½“$n=m$æ—¶ï¼Œ$\boldsymbol{W}^{-1}=\boldsymbol{W}^{\top}$ï¼Œæ–¹ç¨‹ï¼š</p>
<p>$$
\boldsymbol{W}^{\top}\text{msign}(\boldsymbol{G}+\boldsymbol{W}\boldsymbol{X}) + \text{msign}(\boldsymbol{G}+\boldsymbol{W}\boldsymbol{X})^{\top}\boldsymbol{W} = \boldsymbol{0}
$$</p>
<p>å¯ä»¥å·¦ä¹˜$\boldsymbol{W}$å³ä¹˜$\boldsymbol{W}^{\top}$å˜æ¢ä¸ºï¼š</p>
<p>$$
\text{msign}(\boldsymbol{W}\boldsymbol{W}^{\top}\boldsymbol{G}+\boldsymbol{X}) + \text{msign}(\boldsymbol{W}\boldsymbol{W}^{\top}\boldsymbol{G}+\boldsymbol{X})^{\top} = \boldsymbol{0}
$$</p>
<p>è®¾$\boldsymbol{H} = \boldsymbol{W}\boldsymbol{W}^{\top}\boldsymbol{G}$ï¼Œåˆ™ï¼š</p>
<p>$$
\text{msign}(\boldsymbol{H}+\boldsymbol{X}) = -\text{msign}(\boldsymbol{H}+\boldsymbol{X})^{\top}
$$</p>
<p>è¿™è¦æ±‚$\boldsymbol{H}+\boldsymbol{X}$åå¯¹ç§°ï¼Œå› æ­¤$\boldsymbol{X} = -[\boldsymbol{H}]<em _text_sym="\text{sym">{\text{sym}} = -[\boldsymbol{W}\boldsymbol{W}^{\top}\boldsymbol{G}]</em>$ã€‚}</p>
<p>ä½†ç”±äº$\boldsymbol{W}\boldsymbol{W}^{\top}=\boldsymbol{I}$ï¼Œè¿›ä¸€æ­¥ç®€åŒ–ä¸º$\boldsymbol{X}=-[\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}$ã€‚</p>
<h3 id="16">16. æ•°å€¼ç¨³å®šæ€§åˆ†æ</h3>
<p><strong>å®šç†16.1ï¼ˆæ¡ä»¶æ•°ä¸æ”¶æ•›é€Ÿåº¦ï¼‰</strong>ï¼šè¿­ä»£ç®—æ³•çš„æ”¶æ•›é€Ÿåº¦å–å†³äºçŸ©é˜µ$\boldsymbol{Q}=(\boldsymbol{Z}^{\top}\boldsymbol{Z})^{1/2}$çš„æ¡ä»¶æ•°ã€‚</p>
<p><strong>å®šä¹‰</strong>ï¼š$\kappa(\boldsymbol{Q}) = \frac{\sigma_{\max}(\boldsymbol{Q})}{\sigma_{\min}(\boldsymbol{Q})}$</p>
<p><strong>æ¨å¯¼16.1ï¼ˆç—…æ€æƒ…å†µåˆ†æï¼‰</strong>ï¼šå½“$\boldsymbol{Z}=\boldsymbol{G}+\boldsymbol{W}\boldsymbol{X}$æ¥è¿‘ç§©äºï¼ˆrank-deficientï¼‰æ—¶ï¼Œ$\sigma_{\min}(\boldsymbol{Q})\to 0$ï¼Œå¯¼è‡´ï¼š</p>
<ol>
<li>Lyapunovæ–¹ç¨‹çš„è§£ä¸­å‡ºç°é™¤ä»¥$\sigma_i+\sigma_j$çš„é¡¹ï¼Œåˆ†æ¯æ¥è¿‘é›¶</li>
<li>æ•°å€¼è¯¯å·®è¢«æ”¾å¤§</li>
</ol>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå½“æ£€æµ‹åˆ°$\sigma_{\min}(\boldsymbol{Q})&lt;\epsilon$æ—¶ï¼Œå°†å…¶æˆªæ–­ä¸º$\epsilon$ï¼š</p>
<p>$$
Y_{ij} = \frac{D_{ij}}{\max(\sigma_i+\sigma_j, \epsilon)}
$$</p>
<p>é€šå¸¸å–$\epsilon=10^{-8}$ï¼ˆFP32ï¼‰æˆ–$\epsilon=10^{-16}$ï¼ˆFP64ï¼‰ã€‚</p>
<h3 id="17">17. è®¡ç®—å¤æ‚åº¦åˆ†æ</h3>
<p><strong>å®šç†17.1ï¼ˆå•æ¬¡è¿­ä»£å¤æ‚åº¦ï¼‰</strong>ï¼šç®—æ³•8.1çš„å•æ¬¡è¿­ä»£å¤æ‚åº¦ä¸º$O(nm^2 + m^3)$ã€‚</p>
<p><strong>åˆ†è§£</strong>ï¼š
1. è®¡ç®—$\boldsymbol{Z}=\boldsymbol{G}+\boldsymbol{W}\boldsymbol{X}$ï¼š$O(nm^2)$
2. SVDåˆ†è§£$\boldsymbol{Z}$ï¼š$O(nm^2)$ï¼ˆthin SVDï¼‰
3. è®¡ç®—$\boldsymbol{Z}^{\top}\boldsymbol{\Phi}$ï¼š$O(nm^2)$
4. æ±‚è§£Lyapunovæ–¹ç¨‹ï¼š$O(m^3)$ï¼ˆç‰¹å¾å€¼åˆ†è§£+çŸ©é˜µä¹˜æ³•ï¼‰</p>
<p>æ€»å¤æ‚åº¦ï¼š$O(nm^2 + m^3)$</p>
<p><strong>æ¨å¯¼17.1ï¼ˆæ€»è¿­ä»£å¤æ‚åº¦ï¼‰</strong>ï¼šå‡è®¾è¿­ä»£$K$æ¬¡æ”¶æ•›ï¼Œæ€»å¤æ‚åº¦ä¸º$O(K(nm^2+m^3))$ã€‚å®éªŒè¡¨æ˜$K\approx 5\sim 10$ï¼Œå› æ­¤ä¸ç›´æ¥SVDçš„$O(nm^2)$ç›¸æ¯”ï¼Œå¤šäº†å¸¸æ•°å€çš„å¼€é”€ã€‚</p>
<h3 id="18">18. ä¸å…¶ä»–æµå½¢ä¼˜åŒ–ç®—æ³•çš„æ¯”è¾ƒ</h3>
<p><strong>æ¯”è¾ƒ18.1ï¼ˆRiemannianæ¢¯åº¦ä¸‹é™ï¼‰</strong>ï¼šæ ‡å‡†Riemannianæ¢¯åº¦ä¸‹é™ï¼š</p>
<p>$$
\boldsymbol{W}_{k+1} = \text{Retraction}(\boldsymbol{W}_k - \eta\mathcal{P}_{\boldsymbol{W}_k}(\boldsymbol{G}))
$$</p>
<p>Muonæ–¹æ³•ï¼š</p>
<p>$$
\boldsymbol{W}_{k+1} = \text{Retraction}(\boldsymbol{W}_k - \eta\,\text{msign}(\mathcal{P}_{\boldsymbol{W}_k}(\boldsymbol{G})))
$$</p>
<p><strong>åŒºåˆ«</strong>ï¼šMuonä½¿ç”¨è°±èŒƒæ•°çº¦æŸ$|\boldsymbol{\Phi}|_2=1$è€ŒéFrobeniusèŒƒæ•°ï¼Œè¿™åœ¨çŸ©é˜µä¼˜åŒ–ä¸­æ›´è‡ªç„¶ã€‚</p>
<p><strong>æ¯”è¾ƒ18.2ï¼ˆäº¤æ›¿æŠ•å½±æ³•ï¼‰</strong>ï¼š@leloyçš„æ–¹æ³•ï¼š</p>
<p>$$
\boldsymbol{\Phi} = (\text{msign}\circ\mathcal{P}_{\boldsymbol{W}})^K(\boldsymbol{G})
$$</p>
<p>å³åå¤æŠ•å½±åˆ°æ­£äº¤ç©ºé—´å’Œåˆ‡ç©ºé—´ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼šè®¡ç®—ç®€å•ï¼Œä¸éœ€è¦æ±‚è§£Lyapunovæ–¹ç¨‹ã€‚</p>
<p><strong>åŠ£åŠ¿</strong>ï¼šä¸ä¿è¯å…¨å±€æœ€ä¼˜ï¼Œå¯èƒ½é™·å…¥æ¬¡ä¼˜è§£ã€‚</p>
<h3 id="19">19. ç†è®ºæ”¶æ•›ä¿è¯</h3>
<p><strong>å®šç†19.1ï¼ˆè¿­ä»£çš„æ”¶æ•›æ€§ï¼‰</strong>ï¼šåœ¨ä»¥ä¸‹æ¡ä»¶ä¸‹ï¼Œç®—æ³•8.1æ”¶æ•›åˆ°æ»¡è¶³åˆ‡ç©ºé—´æ¡ä»¶çš„å”¯ä¸€è§£ï¼š</p>
<ol>
<li>$\boldsymbol{Z}^{(k)} = \boldsymbol{G}+\boldsymbol{W}\boldsymbol{X}^{(k)}$åœ¨è¿­ä»£è¿‡ç¨‹ä¸­ä¿æŒæ»¡ç§©</li>
<li>åˆå€¼$\boldsymbol{X}^{(0)}$åœ¨è§£çš„é‚»åŸŸå†…</li>
</ol>
<p><strong>è¯æ˜æ¢—æ¦‚</strong>ï¼šå®šä¹‰æ˜ å°„$\mathcal{T}:\boldsymbol{X}\mapsto\boldsymbol{X}'$ä¸ºè¿­ä»£è¿‡ç¨‹ã€‚å¯ä»¥è¯æ˜ï¼š</p>
<p>$$
\|\mathcal{T}(\boldsymbol{X}_1)-\mathcal{T}(\boldsymbol{X}_2)\|_F \leq L\|\boldsymbol{X}_1-\boldsymbol{X}_2\|_F
$$</p>
<p>å…¶ä¸­$L&lt;1$åœ¨è§£çš„é‚»åŸŸå†…æˆç«‹ï¼Œå› æ­¤$\mathcal{T}$æ˜¯å±€éƒ¨å‹ç¼©æ˜ å°„ï¼Œç”±Banachä¸åŠ¨ç‚¹å®šç†ä¿è¯æ”¶æ•›ã€‚</p>
<h3 id="20">20. ç²¾åº¦ä¸æ”¶ç¼©çš„æƒè¡¡</h3>
<p><strong>å®šç†20.1ï¼ˆç²¾åº¦è¦æ±‚ï¼‰</strong>ï¼šä¸ºä¿æŒStiefelçº¦æŸï¼Œéœ€è¦æ»¡è¶³ï¼š</p>
<p>$$
\|\boldsymbol{W}_k^{\top}\boldsymbol{W}_k - \boldsymbol{I}_m\|_F \leq \epsilon
$$</p>
<p><strong>æ¨å¯¼20.1ï¼ˆè¯¯å·®ç´¯ç§¯ï¼‰</strong>ï¼šæ¯æ¬¡æ›´æ–°å¼•å…¥çš„è¯¯å·®ä¸º$O(\eta^3)$ï¼ˆæ¥è‡ªä¸‰é˜¶Taylorå±•å¼€ï¼‰ã€‚ç»è¿‡$K$æ¬¡è¿­ä»£ï¼Œç´¯ç§¯è¯¯å·®ä¸ºï¼š</p>
<p>$$
\|\boldsymbol{W}_K^{\top}\boldsymbol{W}_K - \boldsymbol{I}_m\|_F \leq K\cdot O(\eta^3) + \text{round-off errors}
$$</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šæ¯éš”$N$æ­¥è¿›è¡Œä¸€æ¬¡æ­£äº¤åŒ–ï¼š</p>
<p>$$
\boldsymbol{W} \leftarrow \text{msign}(\boldsymbol{W})
$$</p>
<p>æˆ–ä½¿ç”¨QRåˆ†è§£ï¼š</p>
<p>$$
\boldsymbol{W} \leftarrow \text{QR}(\boldsymbol{W})_Q
$$</p>
<h3 id="21">21. è‡ªåŠ¨å¾®åˆ†çš„å…¼å®¹æ€§</h3>
<p><strong>å®šç†21.1ï¼ˆæ¢¯åº¦çš„åå‘ä¼ æ’­ï¼‰</strong>ï¼šStiefelæµå½¢ä¸Šçš„æ›´æ–°è¿‡ç¨‹å¯ä»¥é€šè¿‡è‡ªåŠ¨å¾®åˆ†å®ç°ã€‚</p>
<p><strong>æ¨å¯¼21.1ï¼ˆ$\text{msign}$çš„å¯¼æ•°ï¼‰</strong>ï¼š$\text{msign}$çš„FrÃ©chetå¯¼æ•°ä¸ºï¼š</p>
<p>$$
D\text{msign}(\boldsymbol{Z})[\boldsymbol{H}] = (\boldsymbol{I} - \boldsymbol{\Phi}\boldsymbol{\Phi}^{\top})\boldsymbol{H}\boldsymbol{Q}^{-1} + \boldsymbol{\Phi}[(\boldsymbol{\Phi}^{\top}\boldsymbol{H})_{\text{skew}}\boldsymbol{Q}^{-1}]_{\text{sym}}
$$</p>
<p>å…¶ä¸­$\boldsymbol{\Phi}=\text{msign}(\boldsymbol{Z})$ï¼Œ$\boldsymbol{Q}=(\boldsymbol{Z}^{\top}\boldsymbol{Z})^{1/2}$ã€‚</p>
<p>è¿™ä¸ªå¯¼æ•°å¯ä»¥é€šè¿‡PyTorchæˆ–JAXçš„è‡ªåŠ¨å¾®åˆ†è‡ªåŠ¨è®¡ç®—ï¼Œæ— éœ€æ‰‹åŠ¨å®ç°ã€‚</p>
<h3 id="22">22. å®é™…åº”ç”¨ä¸­çš„æŠ€å·§</h3>
<p><strong>æŠ€å·§22.1ï¼ˆå­¦ä¹ ç‡è°ƒåº¦ï¼‰</strong>ï¼šåœ¨Stiefelæµå½¢ä¸Šï¼Œç”±äºå‡ ä½•ç»“æ„çš„å½±å“ï¼Œå»ºè®®ä½¿ç”¨æ¯”Euclideanç©ºé—´æ›´å°çš„å­¦ä¹ ç‡ï¼š</p>
<p>$$
\eta_{\text{Stiefel}} \approx 0.1 \times \eta_{\text{Euclidean}}
$$</p>
<p><strong>æŠ€å·§22.2ï¼ˆé¢„æ¡ä»¶ï¼‰</strong>ï¼šå¯ä»¥ä½¿ç”¨è‡ªé€‚åº”å­¦ä¹ ç‡ï¼ˆå¦‚Adamé£æ ¼çš„é¢„æ¡ä»¶ï¼‰ï¼š</p>
<p>$$
\boldsymbol{X} = -\left[\boldsymbol{W}^{\top}\left(\frac{\boldsymbol{G}}{\sqrt{\boldsymbol{v}+\epsilon}}\right)\right]_{\text{sym}}
$$</p>
<p>å…¶ä¸­$\boldsymbol{v}$æ˜¯æ¢¯åº¦äºŒé˜¶çŸ©çš„ä¼°è®¡ã€‚</p>
<h3 id="23">23. åˆå§‹åŒ–ç­–ç•¥</h3>
<p><strong>å®šç†23.1ï¼ˆåˆå§‹åŒ–çš„å½±å“ï¼‰</strong>ï¼šå®éªŒè¡¨æ˜ï¼Œä»¥ä¸‹åˆå§‹åŒ–ç­–ç•¥æ•ˆæœç›¸è¿‘ï¼š</p>
<ol>
<li>$\boldsymbol{X}^{(0)} = -[\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}$ï¼ˆæœ¬æ–‡æ¨èï¼‰</li>
<li>$\boldsymbol{X}^{(0)} = \boldsymbol{0}$ï¼ˆé›¶åˆå§‹åŒ–ï¼‰</li>
<li>$\boldsymbol{X}^{(0)} = -\frac{\text{tr}(\boldsymbol{W}^{\top}\boldsymbol{G})}{m}\boldsymbol{I}_m$ï¼ˆæ ‡é‡åˆå§‹åŒ–ï¼‰</li>
</ol>
<p><strong>æ¨å¯¼23.1ï¼ˆåˆå§‹åŒ–åˆç†æ€§ï¼‰</strong>ï¼šè€ƒè™‘ç›®æ ‡æ³›å‡½å¯¹$\boldsymbol{X}$çš„ä¾èµ–ï¼š</p>
<p>$$
f(\boldsymbol{X}) = \text{tr}(\boldsymbol{G}^{\top}\text{msign}(\boldsymbol{G}+\boldsymbol{W}\boldsymbol{X}))
$$</p>
<p>åœ¨$\boldsymbol{X}=\boldsymbol{0}$å¤„çš„ä¸€é˜¶Taylorå±•å¼€ï¼š</p>
<p>$$
f(\boldsymbol{X}) \approx f(\boldsymbol{0}) + \text{tr}\left(\left[\frac{\partial f}{\partial \boldsymbol{X}}\right]_{\boldsymbol{X}=\boldsymbol{0}}^{\top}\boldsymbol{X}\right)
$$</p>
<p>å¯ä»¥è®¡ç®—å‡º$\boldsymbol{X}=-[\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}$æ˜¯ä¸€é˜¶æœ€ä¼˜çš„æ–¹å‘ã€‚</p>
<h3 id="24">24. ç‰¹å¾å€¼åˆ†è§£çš„æ›¿ä»£æ–¹æ³•</h3>
<p><strong>æ¨å¯¼24.1ï¼ˆKrylovå­ç©ºé—´æ–¹æ³•ï¼‰</strong>ï¼šå¯¹äºå¤§è§„æ¨¡é—®é¢˜ï¼Œå®Œæ•´çš„ç‰¹å¾å€¼åˆ†è§£ä»£ä»·é«˜æ˜‚ã€‚å¯ä»¥ä½¿ç”¨Lanczosç®—æ³•æ±‚$\boldsymbol{Q}$çš„å‰$r$ä¸ªç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ï¼Œè¿‘ä¼¼æ±‚è§£Lyapunovæ–¹ç¨‹ã€‚</p>
<p>è®¾$\boldsymbol{Q}\approx\boldsymbol{V}_r\boldsymbol{\Sigma}_r\boldsymbol{V}_r^{\top} + \delta$ï¼Œå…¶ä¸­$r\ll m$ï¼Œ$\delta$æ˜¯å°è¯¯å·®é¡¹ã€‚åˆ™ï¼š</p>
<p>$$
\boldsymbol{X} \approx -2\boldsymbol{V}_r\left(\frac{\boldsymbol{V}_r^{\top}[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}\boldsymbol{V}_r}{\boldsymbol{\Sigma}_r\boldsymbol{1}^{\top}+\boldsymbol{1}\boldsymbol{\Sigma}_r^{\top}}\right)\boldsymbol{V}_r^{\top}
$$</p>
<p>å¤æ‚åº¦é™ä½åˆ°$O(rm^2)$ã€‚</p>
<h3 id="25-newton-schulz">25. çŸ©é˜µç¬¦å·å‡½æ•°çš„Newton-Schulzè¿­ä»£</h3>
<p><strong>å®šç†25.1ï¼ˆNewton-Schulzè¿­ä»£ï¼‰</strong>ï¼š$\text{msign}(\boldsymbol{Z})$å¯ä»¥é€šè¿‡è¿­ä»£è®¡ç®—ï¼š</p>
<p>$$
\boldsymbol{Y}_{k+1} = \frac{1}{2}\boldsymbol{Y}_k(3\boldsymbol{I} - \boldsymbol{Y}_k^{\top}\boldsymbol{Y}_k)
$$</p>
<p>åˆå§‹åŒ–$\boldsymbol{Y}_0 = \boldsymbol{Z}/|\boldsymbol{Z}|_2$ï¼Œæ”¶æ•›åˆ°$\text{msign}(\boldsymbol{Z})$ã€‚</p>
<p><strong>æ¨å¯¼25.1ï¼ˆæ”¶æ•›æ€§ï¼‰</strong>ï¼šè®¾è¯¯å·®$\boldsymbol{E}_k = \boldsymbol{Y}_k - \text{msign}(\boldsymbol{Z})$ï¼Œå¯ä»¥è¯æ˜ï¼š</p>
<p>$$
\|\boldsymbol{E}_{k+1}\|_F \leq C\|\boldsymbol{E}_k\|_F^3
$$</p>
<p>å³ä¸‰é˜¶æ”¶æ•›ï¼ˆåœ¨æ”¶æ•›åŸŸå†…ï¼‰ã€‚é€šå¸¸5-10æ¬¡è¿­ä»£è¶³å¤Ÿã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼šé¿å…æ˜¾å¼SVDï¼Œå®Œå…¨åŸºäºçŸ©é˜µä¹˜æ³•ï¼Œæ›´é€‚åˆGPUå¹¶è¡Œã€‚</p>
<h3 id="26-riccati">26. ä»£æ•°Riccatiæ–¹ç¨‹çš„è”ç³»</h3>
<p><strong>å®šç†26.1ï¼ˆè¿ç»­Lyapunovæ–¹ç¨‹çš„ç‰¹æ®Šæƒ…å†µï¼‰</strong>ï¼šæˆ‘ä»¬æ±‚è§£çš„æ–¹ç¨‹ï¼š</p>
<p>$$
\boldsymbol{Q}\boldsymbol{X} + \boldsymbol{X}\boldsymbol{Q} = -2[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}
$$</p>
<p>æ˜¯è¿ç»­Lyapunovæ–¹ç¨‹ï¼Œä¹Ÿæ˜¯ä»£æ•°Riccatiæ–¹ç¨‹åœ¨ç‰¹æ®Šå‚æ•°ä¸‹çš„é€€åŒ–æƒ…å†µã€‚</p>
<p><strong>æ¨å¯¼26.1ï¼ˆRiccatiæ–¹ç¨‹å½¢å¼ï¼‰</strong>ï¼šä¸€èˆ¬çš„ä»£æ•°Riccatiæ–¹ç¨‹ä¸ºï¼š</p>
<p>$$
\boldsymbol{A}^{\top}\boldsymbol{X} + \boldsymbol{X}\boldsymbol{A} - \boldsymbol{X}\boldsymbol{B}\boldsymbol{B}^{\top}\boldsymbol{X} + \boldsymbol{C} = \boldsymbol{0}
$$</p>
<p>å½“$\boldsymbol{B}=\boldsymbol{0}$æ—¶é€€åŒ–ä¸ºLyapunovæ–¹ç¨‹ã€‚</p>
<h3 id="27-mcsgn">27. åˆ†å—çŸ©é˜µæ–¹æ³•ï¼ˆmcsgnæ–¹æ³•ï¼‰</h3>
<p><strong>æ¨å¯¼27.1ï¼ˆä½¿ç”¨mcsgnæ±‚è§£ï¼‰</strong>ï¼šå¯ä»¥é€šè¿‡æ„é€ åˆ†å—çŸ©é˜µæ¥æ±‚è§£ï¼š</p>
<p>$$
\boldsymbol{X} = \text{mcsgn}\left(\begin{bmatrix}-\boldsymbol{Q} & -[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}\\ \boldsymbol{0} & \boldsymbol{Q}\end{bmatrix}\right)_{[:m,m:]}
$$</p>
<p>å…¶ä¸­$\text{mcsgn}$æ˜¯çŸ©é˜µä½™ç¬¦å·å‡½æ•°ï¼ˆmatrix cosignï¼‰ï¼Œå®šä¹‰ä¸ºï¼š</p>
<p>$$
\text{mcsgn}(\boldsymbol{M}) = \boldsymbol{M}(\boldsymbol{M}^2)^{-1/2}
$$</p>
<p><strong>éªŒè¯</strong>ï¼šè®¾$\boldsymbol{N}$ä¸ºä¸Šè¿°åˆ†å—çŸ©é˜µï¼Œ$\boldsymbol{P}=\text{mcsgn}(\boldsymbol{N})$ï¼Œåˆ†å—ä¸ºï¼š</p>
<p>$$
\boldsymbol{P} = \begin{bmatrix}\boldsymbol{P}_{11} & \boldsymbol{P}_{12}\\ \boldsymbol{P}_{21} & \boldsymbol{P}_{22}\end{bmatrix}
$$</p>
<p>ç”±$\text{mcsgn}$çš„æ€§è´¨ï¼š$\boldsymbol{N}\boldsymbol{P} + \boldsymbol{P}\boldsymbol{N} = \boldsymbol{0}$ï¼Œå±•å¼€å¾—ï¼š</p>
<p>$$
-\boldsymbol{Q}\boldsymbol{P}_{12} + \boldsymbol{P}_{12}\boldsymbol{Q} = -[\boldsymbol{Q}\boldsymbol{W}^{\top}\boldsymbol{G}]_{\text{sym}}
$$</p>
<p>å³$\boldsymbol{P}<em 12="12">{12}$æ»¡è¶³Lyapunovæ–¹ç¨‹ï¼Œæ•…$\boldsymbol{X}=\boldsymbol{P}</em>$ã€‚</p>
<h3 id="28-gpu">28. å¹¶è¡ŒåŒ–ä¸GPUå®ç°</h3>
<p><strong>æŠ€å·§28.1ï¼ˆæ‰¹å¤„ç†ï¼‰</strong>ï¼šå½“æœ‰å¤šä¸ªç‹¬ç«‹çš„Stiefelæµå½¢ä¼˜åŒ–é—®é¢˜æ—¶ï¼ˆå¦‚å¤šä¸ªæƒé‡çŸ©é˜µï¼‰ï¼Œå¯ä»¥æ‰¹é‡å¤„ç†ï¼š</p>
<p>$$
\boldsymbol{Z}^{(b)} = \boldsymbol{G}^{(b)} + \boldsymbol{W}^{(b)}\boldsymbol{X}^{(b)}, \quad b=1,\ldots,B
$$</p>
<p>SVDå¯ä»¥æ‰¹é‡è®¡ç®—ï¼ˆPyTorchæ”¯æŒï¼‰ï¼ŒLyapunovæ–¹ç¨‹å¯ä»¥å¹¶è¡Œæ±‚è§£ã€‚</p>
<p><strong>æŠ€å·§28.2ï¼ˆæ··åˆç²¾åº¦ï¼‰</strong>ï¼š
- æ¢¯åº¦$\boldsymbol{G}$å’Œè¿­ä»£ä¸­é—´ç»“æœï¼šFP16æˆ–BF16
- SVDè®¡ç®—ï¼šFP32ï¼ˆå¿…éœ€ï¼Œå¦åˆ™ç²¾åº¦ä¸è¶³ï¼‰
- æœ€ç»ˆå‚æ•°$\boldsymbol{W}$ï¼šFP32</p>
<h3 id="29">29. ä¸çº¦æŸä¼˜åŒ–ç†è®ºçš„è”ç³»</h3>
<p><strong>å®šç†29.1ï¼ˆKKTæ¡ä»¶ï¼‰</strong>ï¼šåŸä¼˜åŒ–é—®é¢˜çš„Lagrangianä¸ºï¼š</p>
<p>$$
\mathcal{L}(\boldsymbol{\Phi},\lambda,\boldsymbol{\Lambda}) = \text{tr}(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) - \lambda(\|\boldsymbol{\Phi}\|_2^2-1) - \text{tr}(\boldsymbol{\Lambda}^{\top}(\boldsymbol{W}^{\top}\boldsymbol{\Phi}+\boldsymbol{\Phi}^{\top}\boldsymbol{W}))
$$</p>
<p>å…¶ä¸­$\lambda$æ˜¯æ ‡é‡Lagrangeä¹˜å­ï¼Œ$\boldsymbol{\Lambda}$æ˜¯çŸ©é˜µLagrangeä¹˜å­ï¼ˆåå¯¹ç§°ï¼‰ã€‚</p>
<p><strong>æ¨å¯¼29.1ï¼ˆKKTæœ€ä¼˜æ€§æ¡ä»¶ï¼‰</strong>ï¼š</p>
<p>$$
\begin{aligned}
\frac{\partial\mathcal{L}}{\partial\boldsymbol{\Phi}} &= \boldsymbol{G} - 2\lambda\boldsymbol{\Phi} - \boldsymbol{W}\boldsymbol{\Lambda} - \boldsymbol{\Lambda}^{\top}\boldsymbol{W} = \boldsymbol{0}\\
\|\boldsymbol{\Phi}\|_2 &= 1\\
\boldsymbol{W}^{\top}\boldsymbol{\Phi}+\boldsymbol{\Phi}^{\top}\boldsymbol{W} &= \boldsymbol{0}
\end{aligned}
$$</p>
<p>è¿™ä¸æˆ‘ä»¬çš„è§£$\boldsymbol{\Phi}=\text{msign}(\boldsymbol{G}+\boldsymbol{W}\boldsymbol{X})$ä¸€è‡´ï¼ˆ$\boldsymbol{X}$ç¼–ç äº†$\boldsymbol{\Lambda}$çš„ä¿¡æ¯ï¼‰ã€‚</p>
<h3 id="30">30. å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘</h3>
<p><strong>é—®é¢˜30.1ï¼ˆå…¨å±€æœ€ä¼˜æ€§ï¼‰</strong>ï¼šç®—æ³•8.1ä¿è¯æ”¶æ•›åˆ°æ»¡è¶³åˆ‡ç©ºé—´æ¡ä»¶çš„è§£ï¼Œä½†æ˜¯å¦ä¸ºå…¨å±€æœ€ä¼˜è§£ï¼Ÿ</p>
<p><strong>çŒœæƒ³</strong>ï¼šå½“$\boldsymbol{G}$"è¶³å¤Ÿä¸€èˆ¬"æ—¶ï¼Œå­˜åœ¨å”¯ä¸€çš„å…¨å±€æœ€ä¼˜è§£ï¼Œä¸”ç®—æ³•æ”¶æ•›åˆ°è¯¥è§£ã€‚ä½†å¯¹äºç‰¹æ®Šçš„ç—…æ€$\boldsymbol{G}$ï¼Œå¯èƒ½å­˜åœ¨å¤šä¸ªå±€éƒ¨æœ€ä¼˜ã€‚</p>
<p><strong>é—®é¢˜30.2ï¼ˆæ”¶æ•›é€Ÿåº¦ï¼‰</strong>ï¼šèƒ½å¦ç»™å‡ºè¿­ä»£æ¬¡æ•°$K$çš„ç†è®ºä¸Šç•Œï¼Ÿ</p>
<p><strong>å·²çŸ¥</strong>ï¼šå®éªŒæ˜¾ç¤º$K\approx 5\sim 10$ï¼Œä½†ç¼ºä¹ç†è®ºåˆ†æã€‚</p>
<p><strong>é—®é¢˜30.3ï¼ˆé«˜é˜¶æ–¹æ³•ï¼‰</strong>ï¼šèƒ½å¦è®¾è®¡ç‰›é¡¿å‹æ–¹æ³•æˆ–æ‹Ÿç‰›é¡¿æ–¹æ³•æ¥åŠ é€Ÿæ”¶æ•›ï¼Ÿ</p>
<p><strong>æŒ‘æˆ˜</strong>ï¼šéœ€è¦è®¡ç®—Hessianæˆ–å…¶è¿‘ä¼¼ï¼Œåœ¨æµå½¢ä¸Šçš„å®šä¹‰å’Œè®¡ç®—éƒ½è¾ƒå¤æ‚ã€‚</p>
<p><strong>é—®é¢˜30.4ï¼ˆéç´§æµå½¢ï¼‰</strong>ï¼šæœ¬æ–‡æ–¹æ³•èƒ½å¦æ¨å¹¿åˆ°éç´§æµå½¢ï¼Œå¦‚Grassmannæµå½¢æˆ–åŒæ›²ç©ºé—´ï¼Ÿ</p>
<p><strong>åˆæ­¥æƒ³æ³•</strong>ï¼šGrassmannæµå½¢$\text{Gr}(n,m)$æ˜¯Stiefelæµå½¢çš„å•†ç©ºé—´ï¼Œå¯èƒ½éœ€è¦è€ƒè™‘ç­‰ä»·ç±»çš„ä»£è¡¨å…ƒé€‰æ‹©ã€‚</p>
<h3 id="31">31. æ€»ç»“ä¸å±•æœ›</h3>
<p>æœ¬èŠ‚æä¾›äº†Stiefelæµå½¢ä¸ŠMuonä¼˜åŒ–å™¨çš„å®Œæ•´æ•°å­¦ç†è®ºï¼š</p>
<p><strong>æ ¸å¿ƒè´¡çŒ®</strong>ï¼š
1. ä¸¥æ ¼æ¨å¯¼äº†Stiefelæµå½¢çš„åˆ‡ç©ºé—´å’Œæ³•ç©ºé—´
2. ç»™å‡ºäº†æŠ•å½±ç®—å­çš„æ˜¾å¼å…¬å¼åŠå…¶æ€§è´¨è¯æ˜
3. å°†ä¼˜åŒ–é—®é¢˜è½¬åŒ–ä¸ºè¿ç»­Lyapunovæ–¹ç¨‹çš„è¿­ä»£æ±‚è§£
4. æä¾›äº†åŸºäºSVDå’Œmcsgnçš„ä¸¤ç§å®ç°æ–¹æ¡ˆ
5. åˆ†æäº†æ”¶æ•›æ€§ã€å¤æ‚åº¦å’Œæ•°å€¼ç¨³å®šæ€§</p>
<p><strong>ç†è®ºæ„ä¹‰</strong>ï¼š
- å°†çŸ©é˜µä¼˜åŒ–ä¸é»æ›¼å‡ ä½•ç´§å¯†ç»“åˆ
- è§£å†³äº†Orthogonal manifoldæ–‡ç« ä¸­çš„å¼€æ”¾é—®é¢˜
- ä¸ºæµå½¢çº¦æŸä¼˜åŒ–æä¾›äº†æ–°çš„ç®—æ³•æ¡†æ¶</p>
<p><strong>å®è·µä»·å€¼</strong>ï¼š
- å¯ç›´æ¥åº”ç”¨äºç¥ç»ç½‘ç»œä¸­å¸¦æ­£äº¤çº¦æŸçš„å±‚ï¼ˆå¦‚æ­£äº¤å·ç§¯ã€æ­£äº¤æ³¨æ„åŠ›ï¼‰
- ä¸ºè°±å½’ä¸€åŒ–ç­‰æŠ€æœ¯æä¾›ç†è®ºæ”¯æ’‘
- åœ¨ç”Ÿæˆæ¨¡å‹ã€å¼ºåŒ–å­¦ä¹ ç­‰é¢†åŸŸæœ‰åº”ç”¨å‰æ™¯</p>
<p>é€šè¿‡ä»¥ä¸Š30+ä¸ªè¯¦ç»†å…¬å¼æ¨å¯¼å’Œæ³¨é‡Šï¼Œæˆ‘ä»¬å»ºç«‹äº†Stiefelæµå½¢ä¸ŠMuonä¼˜åŒ–çš„å®Œæ•´æ•°å­¦æ¡†æ¶ï¼Œä¸ºç†è§£å’Œå®ç°è¯¥ç®—æ³•æä¾›äº†åšå®çš„ç†è®ºåŸºç¡€ã€‚</p>
        </div>
    </div>
</body>
</html>