<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>msignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸Šï¼‰</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>msignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸Šï¼‰</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 52.6 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10922">https://spaces.ac.cn/archives/10922</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨ä¹‹å‰çš„<a href="/archives/10592">ã€ŠMuonä¼˜åŒ–å™¨èµæï¼šä»å‘é‡åˆ°çŸ©é˜µçš„æœ¬è´¨è·¨è¶Šã€‹</a>ã€<a href="/archives/10739">ã€ŠMuonç»­é›†ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬é€‰æ‹©å°è¯•Muonï¼Ÿã€‹</a>ç­‰æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸ªæå…·æ½œåŠ›ã€æœ‰æœ›æ›¿ä»£Adamçš„æ–°å…´ä¼˜åŒ–å™¨â€”â€”â€œMuonâ€ã€‚éšç€ç›¸å…³ç ”ç©¶çš„ä¸æ–­æ·±å…¥ï¼ŒMuonä¼˜åŒ–å™¨å—åˆ°çš„å…³æ³¨åº¦ä¹Ÿåœ¨æ—¥ç›Šå¢åŠ ã€‚</p>
<p>äº†è§£è¿‡Muonçš„è¯»è€…éƒ½çŸ¥é“ï¼ŒMuonçš„æ ¸å¿ƒè¿ç®—æ˜¯$\newcommand{msign}{\mathop{\text{msign}}}\msign$ç®—å­ï¼Œä¸ºå…¶å¯»æ‰¾æ›´é«˜æ•ˆçš„è®¡ç®—æ–¹æ³•æ˜¯å­¦æœ¯ç¤¾åŒºçš„ä¸€ä¸ªæŒç»­ç›®æ ‡ã€‚æœ¬æ–‡å°†æ€»ç»“ä¸€ä¸‹å®ƒçš„æœ€æ–°è¿›å±•ã€‚</p>
<h2 id="_1">å†™åœ¨å‰é¢</h2>
<p>$\msign$çš„å®šä¹‰è·ŸSVDå¯†åˆ‡ç›¸å…³ã€‚å‡è®¾çŸ©é˜µ$\boldsymbol{M}\in\mathbb{R}^{n\times m}$ï¼Œé‚£ä¹ˆ<br />
\begin{equation}\boldsymbol{U},\boldsymbol{\Sigma},\boldsymbol{V}^{\top} = \text{SVD}(\boldsymbol{M}) \quad\Rightarrow\quad \msign(\boldsymbol{M}) = \boldsymbol{U}<em _:_:r_="[:,:r]">{[:,:r]}\boldsymbol{V}</em>}^{\top}\end{equation<br />
å…¶ä¸­$\boldsymbol{U}\in\mathbb{R}^{n\times n},\boldsymbol{\Sigma}\in\mathbb{R}^{n\times m},\boldsymbol{V}\in\mathbb{R}^{m\times m}$ï¼Œ$r$æ˜¯$\boldsymbol{M}$çš„ç§©ã€‚ç®€å•æ¥è¯´ï¼Œ$\msign$å°±æ˜¯æŠŠçŸ©é˜µçš„æ‰€æœ‰éé›¶å¥‡å¼‚å€¼éƒ½å˜æˆ1åæ‰€å¾—çš„æ–°çŸ©é˜µã€‚åŸºäºSVDï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¯æ˜<br />
\begin{equation}\text{msign}(\boldsymbol{M}) = (\boldsymbol{M}\boldsymbol{M}^{\top})^{-1/2}\boldsymbol{M}= \boldsymbol{M}(\boldsymbol{M}^{\top}\boldsymbol{M})^{-1/2}\end{equation}<br />
è¿™é‡Œçš„$^{-1/2}$çš„çŸ©é˜µçš„$-1/2$æ¬¡å¹‚ã€‚è¿™ä¸ªå½¢å¼è·Ÿæ ‡é‡çš„$\mathop{\text{sign}}(x) = x / \sqrt{x^2}$å¾ˆç›¸ä¼¼ï¼Œæ‰€ä»¥ç¬”è€…ç”¨äº†$\msign$è¿™ä¸ªåå­—ã€‚ä½†è¦æ³¨æ„çš„æ˜¯è¿™è·Ÿç»´åŸºçš„â€œ<a href="https://en.wikipedia.org/wiki/Matrix_sign_function">Matrix Sign</a>â€ä¸å®Œå…¨ç›¸åŒï¼Œç»´åŸºçš„æ¦‚å¿µåªé€‚ç”¨äºæ–¹é˜µï¼Œä½†å½“$\boldsymbol{M}$æ˜¯å¯¹ç§°çŸ©é˜µæ—¶ï¼Œä¸¤è€…æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>å½“$m=n=r$æ—¶ï¼Œ$\text{msign}(\boldsymbol{M})$è¿˜æœ‰ä¸€ä¸ªæ„ä¹‰æ˜¯â€œæœ€ä¼˜æ­£äº¤è¿‘ä¼¼â€ï¼š<br />
\begin{equation}\text{msign}(\boldsymbol{M}) = \mathop{\text{argmin}}_{\boldsymbol{O}^{\top}\boldsymbol{O} = \boldsymbol{I}}\Vert \boldsymbol{M} - \boldsymbol{O}\Vert_F^2\end{equation}<br />
è¯æ˜è¿‡ç¨‹å¯å‚è€ƒ<a href="/archives/10592">ã€ŠMuonä¼˜åŒ–å™¨èµæï¼šä»å‘é‡åˆ°çŸ©é˜µçš„æœ¬è´¨è·¨è¶Šã€‹</a>ã€‚å› ä¸ºè¿™ä¸ªç‰¹æ€§ï¼Œ$\msign$ä¹Ÿè¢«ç§°ä¸ºâ€œå¯¹ç§°æ­£äº¤åŒ–â€ï¼Œè¿™ä¸ªåå­—æœ€æ—©å‡ºè‡ª<a href="https://www.sciencedirect.com/science/article/abs/pii/S0065327608603391">ã€ŠOn the Nonorthogonality Problemã€‹</a>ï¼ˆå‚è€ƒç»´åŸºç™¾ç§‘çš„â€œ<a href="https://en.wikipedia.org/wiki/Orthogonalization">Orthogonalization</a>â€æ¡ç›®ï¼‰ã€‚</p>
<p>æœ€åï¼Œåœ¨<a href="/archives/10795">ã€Šé«˜é˜¶MuPï¼šæ›´ç®€æ˜ä½†æ›´é«˜æ˜çš„è°±æ¡ä»¶ç¼©æ”¾ã€‹</a>ä¸­ï¼Œ$\msign$è¿˜è¢«ç¬”è€…è§†ä¸ºâ€œå¥‡å¼‚å€¼è£å‰ªâ€çš„æé™ç‰ˆæœ¬ã€‚</p>
<h2 id="_2">è¿­ä»£è®¡ç®—</h2>
<p>$\msign$ç”±SVDå®šä¹‰ï¼Œè‡ªç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç”¨SVDæ¥ç²¾ç¡®è®¡ç®—ï¼Œç„¶è€Œç²¾ç¡®çš„SVDè®¡ç®—å¤æ‚åº¦æ¯”è¾ƒé«˜ï¼Œæ‰€ä»¥å®è·µä¸­å¾€å¾€éƒ½æ˜¯ç”¨â€œNewton-Schulzè¿­ä»£â€è¿‘ä¼¼è®¡ç®—ã€‚</p>
<p>Newton-Schulzè¿­ä»£æ˜¯æ±‚çŸ©é˜µå‡½æ•°çš„å¸¸ç”¨è¿­ä»£ç®—æ³•ï¼Œåœ¨$\msign$è¿™é‡Œå®ƒçš„è¿­ä»£æ ¼å¼æ˜¯<br />
\begin{equation}\boldsymbol{X}<em t_1="t+1">0 = \frac{\boldsymbol{M}}{\Vert\boldsymbol{M}\Vert_F},\qquad \boldsymbol{X}</em>} = a\boldsymbol{X<em t_1="t+1">t + b\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t) + c\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2+\cdots\end{equation}<br />
å…¶ä¸­$\Vert\boldsymbol{M}\Vert_F$æ˜¯$\boldsymbol{M}$çš„$F$èŒƒæ•°ï¼Œå³æ‰€æœ‰å…ƒç´ çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ï¼Œ$(a,b,c,\cdots)$æ˜¯å¾…å®šç³»æ•°ï¼Œå®é™…è®¡ç®—ä¸­æˆ‘ä»¬éœ€è¦æˆªæ–­æœ‰é™é¡¹ï¼Œå¸¸è§çš„æ˜¯2é¡¹æˆ–è€…3é¡¹ï¼Œå³å¦‚ä¸‹äºŒé€‰ä¸€ï¼š<br />
\begin{gather}\boldsymbol{X}</em>} = a\boldsymbol{X<em t_1="t+1">t + b\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t) \\\[8pt]<br />
\boldsymbol{X}</em>} = a\boldsymbol{X}_t + b\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t) + c\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2\label{eq:power-5}\end{gather<br />
æœ€åè¿”å›$T$æ­¥è¿­ä»£åçš„$\boldsymbol{X}_T$ä½œä¸º$\msign(\boldsymbol{M})$çš„è¿‘ä¼¼ã€‚è¿™æ ·ä¸€æ¥ï¼Œç³»æ•°$(a,b,c)$å’Œè¿­ä»£æ­¥æ•°$T$å°±æ„æˆäº†Newton-Schulzè¿­ä»£çš„å…¨éƒ¨è¶…å‚æ•°ï¼ŒMuonä½œè€…<a href="https://github.com/KellerJordan/Muon">KellerJordan</a>ç»™å‡ºçš„å‚è€ƒé€‰æ‹©æ˜¯<br />
\begin{equation}(a,b,c)=(3.4445, -4.7750, 2.0315),\qquad T = 5\end{equation}<br />
æ¥ä¸‹æ¥æˆ‘ä»¬çš„ä¸»é¢˜å°±æ˜¯ç†è§£å®ƒï¼Œç„¶åå°è¯•æ”¹è¿›å®ƒã€‚</p>
<h2 id="_3">å‚è€ƒå®ç°</h2>
<p>è¿™é‡Œç»™å‡ºä¸€ä¸ªæç®€çš„å‚è€ƒå®ç°ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nx">def</span><span class="w"> </span><span class="nx">msign</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">steps</span><span class="p">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="nx">eps</span><span class="p">=</span><span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m m-Double">3.4445</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m m-Double">4.7750</span><span class="p">,</span><span class="w"> </span><span class="m m-Double">2.0315</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">astype</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">bfloat16</span><span class="err">&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">y</span><span class="p">.</span><span class="nx">mT</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nx">y</span>
<span class="w">    </span><span class="nx">y</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="p">((</span><span class="nx">y</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nx">sum</span><span class="p">(</span><span class="nx">axis</span><span class="p">=(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="nx">keepdims</span><span class="p">=</span><span class="nx">True</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">eps</span><span class="p">)</span><span class="o">**</span><span class="m m-Double">0.5</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">_</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">range</span><span class="p">(</span><span class="nx">steps</span><span class="p">):</span>
<span class="w">        </span><span class="nx">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="nx">y2</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="nx">y</span><span class="p">.</span><span class="nx">mT</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">y2</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="nx">y2</span><span class="p">)</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="nx">y</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">y</span><span class="p">.</span><span class="nx">mT</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nx">y</span>
</code></pre></div>

<p>è¿™ä¸ªå®ç°å·²ç»åŒ…å«äº†batchè¿è¡Œèƒ½åŠ›ï¼ˆåªå¯¹æœ€åä¸¤ä¸ªdimsåš$\msign$ï¼‰ï¼Œå¯ä»¥åœ¨Jaxè·‘é€šï¼›å¦‚æœå°†<code>x.astype('bfloat16')</code>æ”¹ä¸º<code>x.to(torch.bfloat16)</code>å¯ä»¥åœ¨Torchè·‘é€šï¼›ç›´æ¥å°†<code>x.astype('bfloat16')</code>æ”¹ä¸º<code>x</code>ä¹Ÿå¯ä»¥åœ¨Numpyè·‘é€šã€‚</p>
<h2 id="_4">åŸç†åˆ†æ</h2>
<p>ä¸ºäº†ç†è§£Newton-Schulzè¿­ä»£çš„åŸç†ï¼Œæˆ‘ä»¬çš„é€ä¸€åˆ†æå®ƒçš„æ­¥éª¤ã€‚é¦–å…ˆæ˜¯$\boldsymbol{X}<em _:_:r_="[:,:r]">0 = \boldsymbol{M}/\Vert\boldsymbol{M}\Vert_F$ï¼Œæˆ‘ä»¬ä»£å…¥$\boldsymbol{M}$çš„SVDï¼š<br />
\begin{equation}\boldsymbol{X}_0 = \frac{\boldsymbol{M}}{\Vert\boldsymbol{M}\Vert_F} = \boldsymbol{U}</em>}\left(\frac{\boldsymbol{\Sigma<em _:_:r_="[:,:r]">{[:r,:r]}}{\Vert\boldsymbol{M}\Vert_F}\right)\boldsymbol{V}</em>}^{\top} = \boldsymbol{U<em _:r_:r_="[:r,:r]">{[:,:r]}\underbrace{\left(\frac{\boldsymbol{\Sigma}</em>}}{\Vert\boldsymbol{\Sigma<em _boldsymbol_S="\boldsymbol{S">{[:r,:r]}\Vert_F}\right)}</em><em _:_:r_="[:,:r]">0}\boldsymbol{V}</em>}^{\top}\end{equation<br />
æœ€åä¸€ä¸ªç­‰å·ï¼Œæ˜¯å› ä¸º$F$èŒƒæ•°çš„å¹³æ–¹ï¼Œæ—¢ç­‰äºå…¨ä½“åˆ†é‡çš„å¹³æ–¹å’Œï¼Œåˆç­‰äºå…¨ä½“å¥‡å¼‚å€¼çš„å¹³æ–¹å’Œã€‚æœ€åçš„ç»“æœè¡¨æ˜$\boldsymbol{S}<em _:_:r_="[:,:r]">0$æ˜¯ä¸€ä¸ªåˆ†é‡å‡åœ¨$[0,1]$å†…çš„å¯¹è§’é˜µï¼Œæ¢è¨€ä¹‹$\boldsymbol{X}_0=\boldsymbol{U}</em>}\boldsymbol{S<em _:_:r_="[:,:r]">0\boldsymbol{V}</em>\Vert_F$çš„ç›®çš„ã€‚}^{\top}$çš„å…¨ä½“å¥‡å¼‚å€¼éƒ½ä¸è¶…è¿‡1ï¼Œè¿™å°±æ˜¯ç¬¬ä¸€æ­¥$\boldsymbol{X}_0 = \boldsymbol{M}/\Vert\boldsymbol{M</p>
<p>æ¥ç€ï¼Œæˆ‘ä»¬ä»£å…¥$\boldsymbol{U}<em _:_:r_="[:,:r]">{[:,:r]}\boldsymbol{S}_t\boldsymbol{V}</em>$ï¼Œå°†ä¼šå¾—åˆ°}^{\top}$åˆ°å¼$\eqref{eq:power-5<br />
\begin{equation}\boldsymbol{X}<em _:_:r_="[:,:r]">{t+1} = \boldsymbol{U}</em>}\left(a\boldsymbol{S<em _:_:r_="[:,:r]">t + b\boldsymbol{S}_t^3 + c\boldsymbol{S}_t^5\right)\boldsymbol{V}</em>}^{\top}\end{equation<br />
ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿­ä»£ä¸æ”¹å˜å·¦å³çš„$\boldsymbol{U}<em _:_:r_="[:,:r]">{[:,:r]}$å’Œ$\boldsymbol{V}</em>$ï¼Œæœ¬è´¨ä¸Šå¼å¯¹è§’é˜µçš„è¿­ä»£}^{\top<br />
\begin{equation}\boldsymbol{S}<em t_1="t+1">{t+1} = a\boldsymbol{S}_t + b\boldsymbol{S}_t^3 + c\boldsymbol{S}_t^5\end{equation}<br />
ç„¶åå¯¹è§’é˜µçš„å¹‚åˆç­‰ä»·äºå¯¹è§’çº¿å…ƒç´ å„è‡ªå–å¹‚ï¼Œæ‰€ä»¥è¿™æœ¬è´¨åˆç­‰ä»·äºæ ‡é‡$x_t$çš„è¿­ä»£<br />
\begin{equation}x</em>} = a x_t + b x_t^3 + c x_t^5\end{equation<br />
ç”±äº$\boldsymbol{X}_0 = \boldsymbol{M}/\Vert\boldsymbol{M}\Vert_F$å·²ç»å°†å¥‡å¼‚å€¼éƒ½å‹ç¼©åœ¨$(0,1]$å†…ï¼Œæ‰€ä»¥æˆ‘ä»¬å¸Œæœ›ä»ä»»æ„$x_0\in(0,1]$å‡ºå‘ï¼Œç»è¿‡$T$æ­¥è¿­ä»£åï¼Œ$x_T$èƒ½å¤Ÿå°½å¯èƒ½æ¥è¿‘äº1ï¼Œé‚£ä¹ˆè¿­ä»£$\eqref{eq:power-5}$å°±å¯ä»¥è¶³å¤Ÿè¿‘ä¼¼$\msign$ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°†çŸ©é˜µçš„è¿­ä»£åˆ†æç®€åŒ–ä¸ºæ ‡é‡çš„è¿­ä»£åˆ†æï¼Œå¤§å¤§é™ä½äº†åˆ†æéš¾åº¦ã€‚</p>
<h2 id="_5">ä¼˜åŒ–æ±‚è§£</h2>
<p>å…¶å®$a,b,c$çš„æ±‚è§£ï¼Œæˆ‘ä»¬åœ¨<a href="/archives/10592">ã€ŠMuonä¼˜åŒ–å™¨èµæï¼šä»å‘é‡åˆ°çŸ©é˜µçš„æœ¬è´¨è·¨è¶Šã€‹</a>é¦–æ¬¡ä»‹ç»Muonæ—¶ä¹Ÿç®€å•è®¨è®ºè¿‡ï¼ŒåŸºæœ¬æ€è·¯æ˜¯å°†$a,b,c$è§†ä¸ºä¼˜åŒ–å‚æ•°ï¼Œç”¨$x_T$ä¸$1$çš„å·®æ¥æ„å»ºLossï¼Œç„¶åç”¨SGDæ¥ä¼˜åŒ–ã€‚</p>
<p>æœ¬æ–‡çš„æ€è·¯å¤§è‡´ç›¸åŒï¼Œä½†ç¨ä½œè°ƒæ•´ã€‚å¾ˆæ˜æ˜¾ï¼Œä¼˜åŒ–ç»“æœå°†ä¼šä¾èµ–äºå¥‡å¼‚å€¼åˆ†å¸ƒï¼Œä¹‹å‰ç¬”è€…çš„æ€è·¯æ˜¯ç”¨éšæœºçŸ©é˜µSVDæ¥æ¨¡æ‹ŸçœŸå®å¥‡å¼‚å€¼åˆ†å¸ƒï¼Œä½†SVDè´¹æ—¶è´¹åŠ›ï¼Œå¹¶ä¸”ç»“æœè¿˜ä¼šä¾èµ–äºçŸ©é˜µçš„shapeï¼Œç°åœ¨çœ‹æ¥æ²¡å¤ªå¤§å¿…è¦ï¼Œæˆ‘ä»¬æ”¹ä¸ºåœ¨$[0,1]$å†…å‡åŒ€å–ç‚¹ï¼Œç„¶åé€‰æ‹©$|x_T-1|$æœ€å¤§çš„$k$ä¸ªç‚¹æ¥æ„å»ºLossï¼Œè¿™æ ·è½¬åŒ–ä¸ºä¸€ä¸ª$\min\text{-}\max$é—®é¢˜ï¼Œå°½å¯èƒ½å‡è½»å¥‡å¼‚å€¼åˆ†å¸ƒçš„å½±å“ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>

<span class="k">def</span><span class="w"> </span><span class="nf">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="p">[</span><span class="n">w</span><span class="p">]</span> <span class="o">*</span> <span class="n">iters</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">5</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()[</span><span class="o">-</span><span class="n">k</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">G</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">g</span> <span class="o">:=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">)(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">fmax</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">G</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">tol</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">G</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">tol</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

<span class="n">iters</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10001</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">m</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Adam&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
    <span class="n">l</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">g</span>
    <span class="n">v</span> <span class="o">=</span> <span class="mf">0.999</span> <span class="o">*</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">lr</span> <span class="o">*</span> <span class="n">m</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mf">1e-20</span><span class="p">)</span>
    <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loss: </span><span class="si">{</span><span class="n">l</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">, LR: </span><span class="si">{</span><span class="n">lr</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10000</span><span class="p">]:</span>
        <span class="n">lr</span> <span class="o">*=</span> <span class="mf">0.1</span>
</code></pre></div>

<p>æ­¤å¤–ï¼Œä¼˜åŒ–å™¨ä¹Ÿä»SGDæ”¹ä¸ºAdamï¼Œè¿™æ¯”è¾ƒå®¹æ˜“æ§åˆ¶å‚æ•°çš„æ›´æ–°å¹…åº¦ï¼ŒåŒæ—¶ä¸ºäº†å¢å¼ºè§£çš„å™ªå£°æŠµå¾¡èƒ½åŠ›ï¼Œæˆ‘ä»¬ç»™$a,b,c$åŠ ä¸Šä¸€å®šæ‰°åŠ¨ï¼Œç„¶åå°†æ‰°åŠ¨åçš„æ¢¯åº¦ä¹Ÿæ··åˆè¿›æ¥ã€‚ä¸Šè¿°è„šæœ¬çš„ä¼˜åŒ–ç»“æœæ˜¯ï¼š<br />
\begin{equation}(a,b,c)=(3.3748, -4.6969, 2.1433)\end{equation}<br />
å¯ä»¥çœ‹åˆ°è·ŸKellerJordanè§£ç›¸å·®ä¸è¿œã€‚è¿›ä¸€æ­¥é€šè¿‡å›¾åƒæ¯”è¾ƒä¸€ä¸‹ä¸¤è€…å·®å¼‚ï¼š  </p>
<p><a href="/usr/uploads/2025/05/812396616.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 1]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/812396616.png" /></a></p>
<p>[0, 1]çš„è¿‘ä¼¼æ•ˆæœ</p>
<p><a href="/usr/uploads/2025/05/519231176.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/519231176.png" /></a></p>
<p>[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå…¨å±€æ¥çœ‹ï¼Œæˆ‘ä»¬è¿™é‡Œæ±‚å‡ºçš„è§£å¹³å‡è¯¯å·®å°ä¸€ç‚¹ï¼ŒKellerJordanè§£çš„å¥½å¤„åˆ™æ˜¯åœ¨$[0, 0.01]$åŒºé—´å†…çš„æ–œç‡å¤§ä¸€ç‚¹ï¼Œè¿™æ„å‘³ç€å®ƒå¯¹æ›´å°çš„å¥‡å¼‚å€¼ä¼šæ›´æœ‰åˆ©ã€‚</p>
<h2 id="_6">åˆå€¼åˆ†å¸ƒ</h2>
<p>åœ¨è¿›ä¸€æ­¥è®¨è®ºä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®ä¸€ä¸ªé—®é¢˜ï¼šæˆ‘ä»¬ç©¶ç«Ÿè¦å…³å¿ƒå¤šå°çš„å¥‡å¼‚å€¼ï¼Ÿè¿™è¦å›åˆ°$\boldsymbol{S}_0$çš„åˆ†å¸ƒä¸Šã€‚ç”±äº$\boldsymbol{S}_0$ç»è¿‡$F$èŒƒæ•°å½’ä¸€åŒ–ï¼Œæ‰€ä»¥$\mathop{\text{diag}}(\boldsymbol{S}_0)$å®é™…ä¸Šæ˜¯ä¸€ä¸ª$r$ç»´å•ä½å‘é‡ã€‚å¦‚æœå…¨ä½“å¥‡å¼‚å€¼éƒ½ç›¸ç­‰ï¼Œé‚£ä¹ˆå¯ä»¥æ¨å‡ºæ¯ä¸ªå¥‡å¼‚å€¼éƒ½æ˜¯$1/\sqrt{r}$ã€‚</p>
<p>äºæ˜¯ï¼Œæ ¹æ®é¸½ç¬¼åŸç†ï¼Œæˆ‘ä»¬å¾—åˆ°éå‡åŒ€çš„æƒ…å†µä¸‹å¿…ç„¶å­˜åœ¨å°‘äº$1/\sqrt{r}$çš„å¥‡å¼‚å€¼ã€‚ä¿é™©èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€ä¸ªå€æ•°ï¼Œæ¯”å¦‚10å€ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬è‡³å°‘è¦å…¼é¡¾åˆ°$0.1/\sqrt{r}$å¤§å°çš„å¥‡å¼‚å€¼ã€‚å®é™…æƒ…å†µä¸­ï¼Œä¸€ä¸ªçŸ©é˜µä¸¥æ ¼ä½ç§©ï¼ˆå³å¥‡å¼‚å€¼ä¸¥æ ¼ç­‰äº0ï¼‰çš„æ¦‚ç‡æ˜¯å¾ˆå°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸€èˆ¬éƒ½æ˜¯å‡è®¾çŸ©é˜µæ»¡ç§©ï¼Œå³$r = \min(n,m)$ï¼Œå› æ­¤è‡³å°‘è¦å…¼é¡¾$0.1/\sqrt{\min(n,m)}$çš„å¥‡å¼‚å€¼ã€‚</p>
<p>è€ƒè™‘åˆ°ç°åœ¨æœ€å¤§çš„LLMï¼Œhidden_sizeå·²ç»æ¥åˆ°äº†$8192\sim 100^2$è¿™ä¸ªçº§åˆ«ï¼Œæ‰€ä»¥æ ¹æ®è¿™ä¸ªæ•°å€¼ä¼°è®¡ï¼Œä¸€ä¸ªé€šç”¨çš„Muonä¼˜åŒ–å™¨ï¼Œå®ƒçš„$\msign$ç®—æ³•è‡³å°‘è¦å…¼é¡¾åˆ°$0.001$å¤§å°çš„å¥‡å¼‚å€¼ï¼Œå³èƒ½å¤Ÿå°†$0.001$æ˜ å°„åˆ°æ¥è¿‘äº1çš„å€¼ï¼Œè¿™æ ·çœ‹æ¥ä¸ç®¡æ˜¯KellerJordanè§£è¿˜æ˜¯æˆ‘ä»¬æ–°æ±‚å‡ºçš„è§£ï¼Œéƒ½å·®ç‚¹æ„æ€ã€‚</p>
<p>æ³¨ï¼šå…³äºåˆå€¼åˆ†å¸ƒçš„è®¨è®ºï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å‚è€ƒ<a href="https://papers.cool/arxiv/2505.04005">ã€ŠIterative Orthogonalization Scaling Lawsã€‹</a>ã€‚</p>
<h2 id="_7">è§£å¼€çº¦æŸ</h2>
<p>è¿™æ—¶å€™ï¼Œæ¨ç‰¹ä¸Š<a href="https://twitter.com/YouJiacheng/status/1893704552689303901">@YouJiacheng</a>ï¼ˆMuonä¸»è¦æ¨åŠ¨è€…ä¹‹ä¸€ï¼‰æå‡ºäº†ä¸€ä¸ªéå¸¸æœºæ™ºçš„æƒ³æ³•ï¼šæ¯ä¸€æ­¥è¿­ä»£æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç³»æ•°ï¼ä¹Ÿå°±æ˜¯å°†è¿­ä»£æ”¹ä¸º<br />
\begin{equation}\boldsymbol{X}<em t_1="t+1">{t+1} = a</em>}\boldsymbol{X<em t_1="t+1">t + b</em>}\boldsymbol{X<em t_1="t+1">t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t) + c</em>}\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2\end{equation<br />
è¿™æ ·æ”¹åŠ¨çš„å¥½å¤„æ˜¯å½“é€‰å®š$T$åï¼Œæ€»è®¡ç®—é‡å®Œå…¨ä¸ä¼šæœ‰ä»»ä½•å˜åŒ–ï¼Œä½†ä»æ‹Ÿåˆçš„è§’åº¦çœ‹ï¼ŒåŸæœ¬åªæœ‰$3$ä¸ªè®­ç»ƒå‚æ•°ï¼Œç°åœ¨å˜æˆäº†$3T$ä¸ªï¼Œæ‹Ÿåˆèƒ½åŠ›å°†ä¼šå¤§å¤§åŠ å¼ºã€‚ä»–æœ¬äººç»™å‡ºçš„å‚è€ƒç»“æœæ˜¯ä¸€ä¸ª6æ­¥è¿­ä»£ï¼š<br />
\begin{array}{c|ccc}<br />
\hline<br />
t &amp; a &amp; b &amp; c \\\<br />
\hline<br />
\quad 1\quad &amp; 3955/1024 &amp; -8306/1024 &amp; 5008/1024 \\\<br />
2 &amp; 3735/1024 &amp; -6681/1024 &amp; 3463/1024 \\\<br />
3 &amp; 3799/1024 &amp; -6499/1024 &amp; 3211/1024 \\\<br />
4 &amp; 4019/1024 &amp; -6385/1024 &amp; 2906/1024 \\\<br />
5 &amp; 2677/1024 &amp; -3029/1024 &amp; 1162/1024 \\\<br />
6 &amp; 2172/1024 &amp; -1833/1024 &amp; 682/1024 \\\<br />
\hline<br />
\end{array}<br />
æˆ‘ä»¬å¯ä»¥ç”»å‡ºæ¥å¯¹æ¯”ä¸€ä¸‹ï¼š  </p>
<p><a href="/usr/uploads/2025/05/350533843.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 1]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/350533843.png" /></a></p>
<p>[0, 1]çš„è¿‘ä¼¼æ•ˆæœ</p>
<p><a href="/usr/uploads/2025/05/3892110485.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/3892110485.png" /></a></p>
<p>[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ</p>
<p>å…¬å¹³èµ·è§ï¼ŒKellerJordanè§£å’ŒOursè§£ä¹Ÿéƒ½æ”¹ä¸ºäº†$T=6$ã€‚å¯è§ï¼Œä¸ç®¡æ˜¯ä»å…‰æ»‘ç¨‹åº¦è¿˜æ˜¯æ•´ä½“è¿‘ä¼¼ç¨‹åº¦æ¥çœ‹ï¼ŒYouJiachengè§£éƒ½æœ‰éå¸¸æ˜æ˜¾çš„æå‡ï¼Œè¿™å……åˆ†ä½“ç°äº†å»æ‰å‚æ•°å…±äº«åæ‰€é‡Šæ”¾çš„â€œå®Œå…¨ä½“â€å¨åŠ›ã€‚</p>
<h2 id="_8">è‡ªå·±è¯•è¯•</h2>
<p>YouJiachengè§£æ˜¯æ€ä¹ˆæ±‚å‡ºæ¥çš„å‘¢ï¼Ÿä½œè€…åœ¨<a href="https://gist.github.com/YouJiacheng/393c90cbdc23b09d5688815ba382288b/5bff1f7781cf7d062a155eecd2f13075756482ae">è¿™é‡Œ</a>åˆ†äº«äº†ä»–çš„ä»£ç ï¼Œæ€è·¯ä¹Ÿæ˜¯ç”¨Adamæ¥æ±‚è§£ï¼Œä½†åŒ…å«äº†å¾ˆå¤šä¸åŒçš„Lossï¼Œç†è§£èµ·æ¥æœ‰ç‚¹éº»çƒ¦ã€‚äº‹å®ä¸Šï¼Œç”¨æˆ‘ä»¬å‰é¢çš„è„šæœ¬ï¼Œé…åˆä»–æä¾›çš„åˆå§‹åŒ–ï¼Œå¯ä»¥å¾—åˆ°åŒæ ·å¥½çš„ç»“æœï¼š<br />
\begin{array}{c|ccc}<br />
\hline<br />
t &amp; a &amp; b &amp; c \\\<br />
\hline<br />
\quad 1\quad &amp; 4140/1024 &amp; -7553/1024 &amp; 3571/1024 \\\<br />
2 &amp; 3892/1024 &amp; -6637/1024 &amp; 2973/1024 \\\<br />
3 &amp; 3668/1024 &amp; -6456/1024 &amp; 3021/1024 \\\<br />
4 &amp; 3248/1024 &amp; -6211/1024 &amp; 3292/1024 \\\<br />
5 &amp; 2792/1024 &amp; -5759/1024 &amp; 3796/1024 \\\<br />
6 &amp; 3176/1024 &amp; -5507/1024 &amp; 4048/1024 \\\<br />
\hline<br />
\end{array}</p>
<p>å‚è€ƒä»£ç ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">jax</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">tqdm</span><span class="w"> </span><span class="kn">import</span> <span class="n">tqdm</span>

<span class="k">def</span><span class="w"> </span><span class="nf">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">w</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">5</span>
    <span class="k">return</span> <span class="n">jnp</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">sort</span><span class="p">()[</span><span class="o">-</span><span class="n">k</span><span class="p">:]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nd">@jax</span><span class="o">.</span><span class="n">jit</span>
<span class="k">def</span><span class="w"> </span><span class="nf">grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">tol</span><span class="o">=</span><span class="mf">0.1</span><span class="p">):</span>
    <span class="n">G</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">:</span> <span class="p">(</span><span class="n">g</span> <span class="o">:=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">)(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">fmax</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">g</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="mf">0.6</span> <span class="o">*</span> <span class="n">G</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span> <span class="o">*</span> <span class="p">(</span><span class="n">G</span><span class="p">(</span><span class="n">w</span> <span class="o">+</span> <span class="n">tol</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="n">G</span><span class="p">(</span><span class="n">w</span> <span class="o">-</span> <span class="n">tol</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="n">x</span><span class="p">))</span>

<span class="n">iters</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10001</span><span class="p">)[</span><span class="mi">1</span><span class="p">:]</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">3.5</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.04444444444</span><span class="p">,</span> <span class="mf">2.84444444444</span><span class="p">]]</span> <span class="o">*</span> <span class="n">iters</span><span class="p">)</span>
<span class="n">m</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">w</span><span class="p">)</span>
<span class="n">lr</span> <span class="o">=</span> <span class="mf">1e-3</span>
<span class="n">pbar</span> <span class="o">=</span> <span class="n">tqdm</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">20000</span><span class="p">),</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s1">&#39;Adam&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pbar</span><span class="p">:</span>
    <span class="n">l</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">loss</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">grad</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">g</span>
    <span class="n">v</span> <span class="o">=</span> <span class="mf">0.999</span> <span class="o">*</span> <span class="n">v</span> <span class="o">+</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="n">lr</span> <span class="o">*</span> <span class="n">m</span> <span class="o">/</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="mf">1e-20</span><span class="p">)</span>
    <span class="n">pbar</span><span class="o">.</span><span class="n">set_description</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Loss: </span><span class="si">{</span><span class="n">l</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">, LR: </span><span class="si">{</span><span class="n">lr</span><span class="si">:</span><span class="s1">.6f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">10000</span><span class="p">]:</span>
        <span class="n">lr</span> <span class="o">*=</span> <span class="mf">0.1</span>
</code></pre></div>

<p>å¯¹æ¯”å¦‚ä¸‹ï¼ˆæ ‡è®°ä¸ºâ€œOurs-Xâ€ï¼‰ï¼š  </p>
<p><a href="/usr/uploads/2025/05/518737221.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 1]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/518737221.png" /></a></p>
<p>[0, 1]çš„è¿‘ä¼¼æ•ˆæœ</p>
<p><a href="/usr/uploads/2025/05/3430771328.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/3430771328.png" /></a></p>
<p>[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ</p>
<p>ç”±å›¾å¯è§ï¼Œç›¸æ¯”YouJiachengè§£ï¼Œæˆ‘ä»¬çš„ç»“æœæŒ¯è¡æ›´å¤šï¼Œä½†æ¢æ¥äº†$[0,0.001]$å¤„æ›´å¤§çš„æ–œç‡ã€‚</p>
<h2 id="_9">å…¶ä»–è§£é›†</h2>
<p>å¦‚æœè¯»è€…æƒ³è¦æŒ¯è¡æ›´å°‘çš„è§£ï¼Œé‚£ä¹ˆåªéœ€è¦è°ƒå¤§$k$å€¼ï¼Œæ¯”å¦‚$k=200$çš„ç»“æœæ˜¯ï¼š<br />
\begin{array}{c|ccc}<br />
\hline<br />
t &amp; a &amp; b &amp; c \\\<br />
\hline<br />
\quad 1\quad &amp; 4059/1024 &amp; -7178/1024 &amp; 3279/1024 \\\<br />
2 &amp; 3809/1024 &amp; -6501/1024 &amp; 2925/1024 \\\<br />
3 &amp; 3488/1024 &amp; -6308/1024 &amp; 3063/1024 \\\<br />
4 &amp; 2924/1024 &amp; -5982/1024 &amp; 3514/1024 \\\<br />
5 &amp; 2439/1024 &amp; -5439/1024 &amp; 4261/1024 \\\<br />
6 &amp; 3148/1024 &amp; -5464/1024 &amp; 4095/1024 \\\<br />
\hline<br />
\end{array}</p>
<p>è¿™æ—¶å€™å°±è·ŸYouJiachengè§£ç›¸å·®æ— å‡ äº†ï¼ˆOurs-X2ï¼‰ï¼š  </p>
<p><a href="/usr/uploads/2025/05/1050151153.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 1]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/1050151153.png" /></a></p>
<p>[0, 1]çš„è¿‘ä¼¼æ•ˆæœ</p>
<p><a href="/usr/uploads/2025/05/617077151.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/617077151.png" /></a></p>
<p>[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ</p>
<p>å¦å¤–å†ç»™å‡ºä¸€ä¸ª5æ­¥çš„è§£ï¼Œæ–¹ä¾¿å¤§å®¶è·ŸåŸå§‹è§£å¯¹æ¯”ï¼š<br />
\begin{array}{c|ccc}<br />
\hline<br />
t &amp; a &amp; b &amp; c \\\<br />
\hline<br />
\quad 1\quad &amp; 4.6182 &amp; -12.9582 &amp; 9.3299 \\\<br />
2 &amp; 3.8496 &amp; -7.9585 &amp; 4.3052 \\\<br />
3 &amp; 3.5204 &amp; -7.2918 &amp; 4.0606 \\\<br />
4 &amp; 3.2067 &amp; -6.8243 &amp; 4.2802 \\\<br />
5 &amp; 3.2978 &amp; -5.7848 &amp; 3.8917 \\\<br />
\hline<br />
\end{array}<br />
æ•ˆæœå›¾ï¼ˆOurs-X3ï¼‰ï¼š  </p>
<p><a href="/usr/uploads/2025/05/2624824428.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 1]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/2624824428.png" /></a></p>
<p>[0, 1]çš„è¿‘ä¼¼æ•ˆæœ</p>
<p><a href="/usr/uploads/2025/05/1368764254.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ" src="/usr/uploads/2025/05/1368764254.png" /></a></p>
<p>[0, 0.01]çš„è¿‘ä¼¼æ•ˆæœ</p>
<h2 id="_10">æ”¹è‰¯åˆå€¼</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å…³äº$a,b,c$çš„æ±‚è§£å‘Šä¸€æ®µè½ã€‚æ€»çš„æ¥è¯´ï¼Œæ¯ä¸€æ­¥ä½¿ç”¨ä¸åŒçš„$a,b,c$ï¼Œç¡®å®èƒ½å¤§å¹…æé«˜Newton-Schulzè¿­ä»£çš„æ”¶æ•›æ€§è´¨ï¼Œå¹¶ä¸”ä¸å¢åŠ ä»»ä½•è®¡ç®—æˆæœ¬ï¼Œç®—å¾—ä¸Šå…è´¹åˆé¤äº†ã€‚</p>
<p>é™¤äº†ä¼˜åŒ–Newton-Schulzè¿­ä»£çš„ç³»æ•°å¤–ï¼Œè¿˜æœ‰å…¶ä»–æ€è·¯å¯ä»¥æ”¹è¿›è¿­ä»£çš„æ”¶æ•›æ€§è´¨å—ï¼Ÿè¿˜çœŸæœ‰ã€‚<a href="https://github.com/KellerJordan/modded-nanogpt/discussions/23#discussioncomment-11293594">@johanwind</a>ã€<a href="https://x.com/YouJiacheng/status/1866505635329978803">@YouJiacheng</a>ã€<a href="https://x.com/ZhangRuichong/status/1866496714733211809">@ZhangRuichong</a>ç­‰äººå‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨Newton-Schulzè¿­ä»£çš„ç‰¹ç‚¹ï¼Œè¿‘ä¹å…è´¹åœ°æé«˜åˆå€¼çš„è´¨é‡ï¼Œä»è€Œæé«˜æ”¶æ•›é€Ÿåº¦ã€‚<a href="https://x.com/leloykun">@leloykun</a>åˆ™åœ¨<a href="https://github.com/KellerJordan/Muon/pull/14/files">è¿™é‡Œ</a>ç»™å‡ºäº†ä¸€ä¸ªå‚è€ƒå®ç°ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œç›®å‰æ”¹è¿›Newton-Schulzè¿­ä»£çš„ä¸»è¦åŠªåŠ›éƒ½å¯ä»¥æ€»ç»“ä¸ºâ€œåœ¨ä¿è¯æ”¶æ•›çš„å‰æä¸‹ï¼Œå°½å¯èƒ½åœ°æé«˜æ¥è¿‘äºé›¶çš„å¥‡å¼‚å€¼çš„æ”¶æ•›é€Ÿåº¦â€ã€‚å¦‚æœæˆ‘ä»¬èƒ½äº‹å…ˆæŠŠè¿™äº›æ¥è¿‘äºé›¶çš„å¥‡å¼‚å€¼æ”¾å¤§ä¸€ç‚¹ï¼Œé‚£ä¹ˆåœ¨ä¸æ”¹å˜è¿­ä»£ç®—æ³•çš„å‰æä¸‹ä¹Ÿèƒ½æé«˜æ”¶æ•›é€Ÿåº¦ã€‚ç›®å‰ä¸ºäº†å°†å¥‡å¼‚å€¼å‹ç¼©åˆ°$[0,1]$å†…ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯$F$èŒƒæ•°å½’ä¸€åŒ–$\boldsymbol{M}/\Vert\boldsymbol{M}\Vert_F$ï¼Œå®ƒå°†å¥‡å¼‚å€¼å‹ç¼©æˆ<br />
\begin{equation}\sigma_i \quad\to\quad \frac{\sigma_i}{\Vert\boldsymbol{M}\Vert_F} = \frac{\sigma_i}{\sqrt{\sum\limits_{j=1}^r \sigma_i^2}} \in [0, 1]\end{equation}<br />
è¿™æ ·åšç¡®å®èƒ½è¾¾åˆ°ç›®æ ‡ï¼Œä½†ä¹Ÿæœ‰å‹ç¼©è¿‡åº¦çš„é—®é¢˜ï¼Œæœ€ç´§å‡‘çš„å‹ç¼©æ–¹å¼åº”è¯¥æ˜¯$\sigma_i\to \sigma_i/\sigma_1$ï¼Œå³è°±å½’ä¸€åŒ–ã€‚é—®é¢˜æ˜¯è°±èŒƒæ•°ä¸å¦‚$F$èŒƒæ•°å®¹æ˜“è®¡ç®—ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¾—å·²é€‰æ‹©äº†$F$èŒƒæ•°ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\sigma_1 \quad\leq\quad \underbrace{\sqrt[\uproot{10}8]{\sum_{j=1}^r \sigma_i^8}}<em j="1">{\sqrt[4]{\Vert(\boldsymbol{M}^{\top}\boldsymbol{M})^2\Vert_F}}\quad\leq\quad \underbrace{\sqrt[\uproot{10}4]{\sum</em>}^r \sigma_i^4}<em j="1">{\sqrt{\Vert\boldsymbol{M}^{\top}\boldsymbol{M}\Vert_F}} \quad\leq\quad \underbrace{\sqrt{\sum</em>}^r \sigma_i^2}}_{\Vert\boldsymbol{M}\Vert_F} \end{equation<br />
è¿™æ„å‘³ç€ç”¨$\sqrt[4]{\Vert(\boldsymbol{M}^{\top}\boldsymbol{M})^2\Vert_F}$æˆ–$\sqrt{\Vert\boldsymbol{M}^{\top}\boldsymbol{M}\Vert_F}$ä½œä¸ºå½’ä¸€åŒ–å› å­ï¼Œç†è®ºä¸Šéƒ½æ¯”$\Vert\boldsymbol{M}\Vert_F$æ›´å¥½ã€‚éå¸¸å·§å¦™çš„æ˜¯ï¼Œåœ¨Newton-Schulzè¿­ä»£ä¸‹ï¼Œå®ƒä»¬çš„è®¡ç®—æ˜¯è¿‘ä¹å…è´¹çš„ï¼ä¸ºç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å†™å‡ºç¬¬ä¸€æ­¥è¿­ä»£<br />
\begin{equation}\boldsymbol{X}_0 = \frac{\boldsymbol{M}}{\Vert\boldsymbol{M}\Vert_F},\qquad \boldsymbol{X}_1 = a\boldsymbol{X}_0 + b\boldsymbol{X}_0(\boldsymbol{X}_0^{\top}\boldsymbol{X}_t) + c\boldsymbol{X}_0(\boldsymbol{X}_0^{\top}\boldsymbol{X}_0)^2\end{equation}<br />
å¯ä»¥çœ‹åˆ°$\boldsymbol{X}_0^{\top}\boldsymbol{X}_0$å’Œ$(\boldsymbol{X}_0^{\top}\boldsymbol{X}_0)^2$æ˜¯å¿…ç„¶è¦ç®—å‡ºæ¥çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç›´æ¥æ‹¿å®ƒä»¬ç®—$F$èŒƒæ•°ï¼Œç„¶åé‡æ–°å½’ä¸€åŒ–å°±è¡Œï¼Œå‚è€ƒä»£ç ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="nx">def</span><span class="w"> </span><span class="nx">msign</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">steps</span><span class="p">=</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="nx">eps</span><span class="p">=</span><span class="mi">1</span><span class="nx">e</span><span class="o">-</span><span class="mi">20</span><span class="p">):</span>
<span class="w">    </span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="nx">c</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="m m-Double">3.4445</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="m m-Double">4.7750</span><span class="p">,</span><span class="w"> </span><span class="m m-Double">2.0315</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">astype</span><span class="p">(</span><span class="err">&#39;</span><span class="nx">bfloat16</span><span class="err">&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="nx">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">y</span><span class="p">.</span><span class="nx">mT</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nx">y</span>
<span class="w">    </span><span class="nx">y</span><span class="w"> </span><span class="o">/=</span><span class="w"> </span><span class="p">((</span><span class="nx">y</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nx">sum</span><span class="p">(</span><span class="nx">axis</span><span class="p">=[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="nx">keepdims</span><span class="p">=</span><span class="nx">True</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">eps</span><span class="p">)</span><span class="o">**</span><span class="m m-Double">0.5</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">range</span><span class="p">(</span><span class="nx">steps</span><span class="p">):</span>
<span class="w">        </span><span class="nx">y4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">(</span><span class="nx">y2</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="nx">y</span><span class="p">.</span><span class="nx">mT</span><span class="p">)</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="nx">y2</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span>
<span class="w">            </span><span class="nx">n</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">((</span><span class="nx">y4</span><span class="o">**</span><span class="mi">2</span><span class="p">).</span><span class="nx">sum</span><span class="p">(</span><span class="nx">axis</span><span class="p">=[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="nx">keepdims</span><span class="p">=</span><span class="nx">True</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">eps</span><span class="p">)</span><span class="o">**</span><span class="m m-Double">0.125</span>
<span class="w">            </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">y2</span><span class="p">,</span><span class="w"> </span><span class="nx">y4</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">n</span><span class="p">,</span><span class="w"> </span><span class="nx">y2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">n</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="nx">y4</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">n</span><span class="o">**</span><span class="mi">4</span>
<span class="w">        </span><span class="nx">y</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="nx">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">y2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">y4</span><span class="p">)</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="nx">y</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="nx">y</span><span class="p">.</span><span class="nx">mT</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="nx">y</span>
</code></pre></div>

<p>å®æµ‹ç»“æœï¼Œå¯¹äºä¸€ä¸ª$100\times 100$çš„éšæœºé«˜æ–¯çŸ©é˜µï¼Œæ”¹è¿›åçš„æœ€å°å¥‡å¼‚å€¼ï¼Œå¤§å¤šæ•°éƒ½åœ¨æ”¹è¿›å‰çš„2å€ä»¥ä¸Šï¼Œå¹³å‡å¥‡å¼‚å€¼ä¹Ÿæ›´æ¥è¿‘äº1ã€‚ä¸è¿‡ï¼ŒMuonä½œè€…ä¹Ÿè¡¨ç¤ºå®ƒå¯èƒ½ä¼šå¸¦æ¥é¢å¤–çš„ä¸ç¨³å®šæ€§ï¼Œå› æ­¤è¿˜æ²¡æœ‰é‡‡çº³åˆ°å®˜æ–¹ä»£ç ä¸­ã€‚</p>
<h2 id="_11">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†é€šè¿‡Newton-Schulzè¿­ä»£æ¥è®¡ç®—$\msign$çš„ä¼˜åŒ–æ€è·¯ï¼Œæ‰€å¾—ç»“æœç›¸æ¯”Muonçš„å®˜æ–¹è§£ï¼Œèƒ½å¤Ÿæ˜æ˜¾æé«˜è¿­ä»£çš„æ”¶æ•›é€Ÿåº¦å’Œæ•ˆæœã€‚</p>
<p>æœ€åéœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œå¯¹äºMuonæ¥è¯´ï¼Œå°è§„æ¨¡çš„å®éªŒç»“æœæ˜¾ç¤ºï¼Œ$\msign$çš„è®¡ç®—ç²¾åº¦è·Ÿæ¨¡å‹çš„æœ€ç»ˆæ•ˆæœä¼¼ä¹æ²¡æœ‰å¿…ç„¶è”ç³»ï¼Œå°æ¨¡å‹ä¸‹æé«˜$\msign$çš„ç²¾åº¦ä¼¼ä¹åªèƒ½åœ¨å‰æœŸåŠ é€Ÿä¸€ç‚¹æ”¶æ•›é€Ÿåº¦ï¼Œä½†æœ€ç»ˆç»“æœå¹¶æ— å˜åŒ–ã€‚ç›®å‰å°šä¸æ¸…æ¥šè¿™ä¸ªç»“è®ºåœ¨æ›´å¤§è§„æ¨¡çš„æ¨¡å‹ä¸‹æ˜¯å¦æˆç«‹ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10922">https://spaces.ac.cn/archives/10922</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (May. 11, 2025). ã€Šmsignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸Šï¼‰ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10922">https://spaces.ac.cn/archives/10922</a></p>
<p>@online{kexuefm-10922,<br />
title={msignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸Šï¼‰},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={May},<br />
url={\url{https://spaces.ac.cn/archives/10922}},<br />
} </p>
<hr />
<h2 id="_12">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚å°†è¯¦ç»†æ¨å¯¼Newton-Schulzè¿­ä»£ç®—æ³•çš„æ•°å­¦åŸç†ï¼ŒåŒ…æ‹¬è¿­ä»£å…¬å¼çš„æ¨å¯¼ã€æ”¶æ•›æ€§åˆ†æã€ç³»æ•°ä¼˜åŒ–ç†è®ºã€ä»¥åŠæ•°å€¼ç¨³å®šæ€§ç­‰å…³é”®é—®é¢˜ã€‚</p>
<h3 id="1-newton-schulz">1. Newton-Schulzè¿­ä»£çš„ç†è®ºåŸºç¡€</h3>
<h4 id="11-newton">1.1 çŸ©é˜µå‡½æ•°çš„Newtonè¿­ä»£</h4>
<p>Newton-Schulzè¿­ä»£æ˜¯æ±‚è§£çŸ©é˜µå‡½æ•°çš„ç»å…¸æ–¹æ³•ã€‚å¯¹äºçŸ©é˜µæ–¹ç¨‹$f(\boldsymbol{X}) = \boldsymbol{0}$ï¼ŒNewtonè¿­ä»£çš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š
\begin{equation}
\boldsymbol{X}_{t+1} = \boldsymbol{X}_t - [f'(\boldsymbol{X}_t)]^{-1}f(\boldsymbol{X}_t)
\tag{1}\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™é‡Œ$f'(\boldsymbol{X})$æ˜¯$f$å…³äºçŸ©é˜µ$\boldsymbol{X}$çš„FrÃ©chetå¯¼æ•°ã€‚</p>
<p>å¯¹äº$\msign$ç®—å­ï¼Œæˆ‘ä»¬å¸Œæœ›æ±‚è§£æ»¡è¶³$\boldsymbol{X}\boldsymbol{X}^{\top} = \boldsymbol{I}$çš„çŸ©é˜µ$\boldsymbol{X}$ï¼ˆå½“çŸ©é˜µæ»¡ç§©æ—¶ï¼‰ã€‚ç­‰ä»·åœ°ï¼Œæˆ‘ä»¬æ±‚è§£æ–¹ç¨‹ï¼š
\begin{equation}
f(\boldsymbol{X}) = \boldsymbol{X}\boldsymbol{X}^{\top} - \boldsymbol{I} = \boldsymbol{0}
\tag{2}\end{equation}</p>
<p><strong>FrÃ©chetå¯¼æ•°çš„è®¡ç®—</strong>ï¼šå¯¹äº$f(\boldsymbol{X}) = \boldsymbol{X}\boldsymbol{X}^{\top} - \boldsymbol{I}$ï¼Œå…¶FrÃ©chetå¯¼æ•°ä¸ºï¼š
\begin{equation}
f'(\boldsymbol{X})[\boldsymbol{H}] = \boldsymbol{H}\boldsymbol{X}^{\top} + \boldsymbol{X}\boldsymbol{H}^{\top}
\tag{3}\end{equation}</p>
<p>è¿™é‡Œ$\boldsymbol{H}$æ˜¯æ‰°åŠ¨çŸ©é˜µã€‚éªŒè¯å¦‚ä¸‹ï¼š
\begin{align}
f(\boldsymbol{X} + \boldsymbol{H}) - f(\boldsymbol{X}) &amp;= (\boldsymbol{X}+\boldsymbol{H})(\boldsymbol{X}+\boldsymbol{H})^{\top} - \boldsymbol{X}\boldsymbol{X}^{\top} \tag{4}\
&amp;= \boldsymbol{X}\boldsymbol{X}^{\top} + \boldsymbol{X}\boldsymbol{H}^{\top} + \boldsymbol{H}\boldsymbol{X}^{\top} + \boldsymbol{H}\boldsymbol{H}^{\top} - \boldsymbol{X}\boldsymbol{X}^{\top} \tag{5}\
&amp;= \boldsymbol{H}\boldsymbol{X}^{\top} + \boldsymbol{X}\boldsymbol{H}^{\top} + o(\Vert\boldsymbol{H}\Vert) \tag{6}
\end{align}</p>
<h4 id="12-newton-schulz">1.2 ç®€åŒ–çš„Newton-Schulzè¿­ä»£</h4>
<p>æ ‡å‡†Newtonè¿­ä»£éœ€è¦æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„$f'(\boldsymbol{X}_t)[\boldsymbol{H}] = -f(\boldsymbol{X}_t)$ï¼Œè¿™åœ¨é«˜ç»´æƒ…å†µä¸‹è®¡ç®—é‡å¾ˆå¤§ã€‚Newton-Schulzè¿­ä»£çš„æ€è·¯æ˜¯ç”¨å¹‚çº§æ•°è¿‘ä¼¼$(f'(\boldsymbol{X}_t))^{-1}$ã€‚</p>
<p>å‡è®¾$\boldsymbol{X}<em k="0">t$å·²ç»æ¥è¿‘ç›®æ ‡ï¼Œå³$\boldsymbol{E}_t = \boldsymbol{I} - \boldsymbol{X}_t^{\top}\boldsymbol{X}_t$æ˜¯ä¸€ä¸ªå°é‡ï¼Œé‚£ä¹ˆï¼š
\begin{equation}
(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^{-1} = (\boldsymbol{I} - \boldsymbol{E}_t)^{-1} = \sum</em>_t^2 + \cdots
\tag{7}\end{equation}}^{\infty} \boldsymbol{E}_t^k = \boldsymbol{I} + \boldsymbol{E}_t + \boldsymbol{E</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ä¸ªå±•å¼€åœ¨$\Vert\boldsymbol{E}_t\Vert &lt; 1$æ—¶æ”¶æ•›ï¼Œå³è¦æ±‚$\boldsymbol{X}_t$çš„å¥‡å¼‚å€¼éƒ½åœ¨$(0, \sqrt{2}]$èŒƒå›´å†…ã€‚</p>
<p>åŸºäºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å¯¼å‡ºï¼š
\begin{equation}
\boldsymbol{X}<em k="0">t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^{-1/2} \approx \boldsymbol{X}_t(\boldsymbol{I} - \boldsymbol{E}_t)^{-1/2} = \boldsymbol{X}_t\sum</em>_t)^k
\tag{8}\end{equation}}^{\infty} \binom{-1/2}{k}(-\boldsymbol{E</p>
<p>å…¶ä¸­å¹¿ä¹‰äºŒé¡¹å¼ç³»æ•°ä¸ºï¼š
\begin{equation}
\binom{-1/2}{k} = \frac{(-1/2)(-1/2-1)\cdots(-1/2-k+1)}{k!}
\tag{9}\end{equation}</p>
<p>å‰å‡ é¡¹ä¸ºï¼š
\begin{align}
\binom{-1/2}{0} &amp;= 1 \tag{10}\
\binom{-1/2}{1} &amp;= -\frac{1}{2} \tag{11}\
\binom{-1/2}{2} &amp;= \frac{(-1/2)(-3/2)}{2} = \frac{3}{8} \tag{12}\
\binom{-1/2}{3} &amp;= \frac{(-1/2)(-3/2)(-5/2)}{6} = -\frac{5}{16} \tag{13}
\end{align}</p>
<p>å› æ­¤æˆªæ–­åˆ°$k=2$çš„è¿‘ä¼¼ä¸ºï¼š
\begin{align}
(\boldsymbol{I} - \boldsymbol{E}_t)^{-1/2} &amp;\approx \boldsymbol{I} + \frac{1}{2}\boldsymbol{E}_t + \frac{3}{8}\boldsymbol{E}_t^2 \tag{14}\
&amp;= \boldsymbol{I} + \frac{1}{2}(\boldsymbol{I} - \boldsymbol{X}_t^{\top}\boldsymbol{X}_t) + \frac{3}{8}(\boldsymbol{I} - \boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2 \tag{15}
\end{align}</p>
<p>å³ä¹˜$\boldsymbol{X}<em t_1="t+1">t$å¾—åˆ°æ ‡å‡†çš„Newton-Schulzè¿­ä»£ï¼ˆ3é¡¹ï¼‰ï¼š
\begin{equation}
\boldsymbol{X}</em>_t)^2
\tag{16}\end{equation}} = \frac{3}{2}\boldsymbol{X}_t - \frac{1}{2}\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t) + 0 \cdot \boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ç»™å‡ºäº†$(a,b,c) = (3/2, -1/2, 0)$ï¼Œè¿™æ˜¯ç»å…¸çš„Newton-Schulzç³»æ•°ã€‚</p>
<h4 id="13-newton-schulz">1.3 é«˜é˜¶Newton-Schulzè¿­ä»£</h4>
<p>ä¸ºäº†è·å¾—æ›´å¿«çš„æ”¶æ•›é€Ÿåº¦ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ›´å¤šé¡¹çš„å±•å¼€ã€‚æˆªæ–­åˆ°$k=4$ï¼š
\begin{align}
(\boldsymbol{I} - \boldsymbol{E}_t)^{-1/2} &amp;\approx \boldsymbol{I} + \frac{1}{2}\boldsymbol{E}_t + \frac{3}{8}\boldsymbol{E}_t^2 + \frac{5}{16}\boldsymbol{E}_t^3 + \frac{35}{128}\boldsymbol{E}_t^4 \tag{17}
\end{align}</p>
<p>å±•å¼€$\boldsymbol{E}_t$çš„å¹‚æ¬¡ï¼š
\begin{align}
\boldsymbol{E}_t &amp;= \boldsymbol{I} - \boldsymbol{X}_t^{\top}\boldsymbol{X}_t \tag{18}\
\boldsymbol{E}_t^2 &amp;= (\boldsymbol{I} - \boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2 = \boldsymbol{I} - 2\boldsymbol{X}_t^{\top}\boldsymbol{X}_t + (\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2 \tag{19}\
\boldsymbol{E}_t^3 &amp;= \boldsymbol{I} - 3\boldsymbol{X}_t^{\top}\boldsymbol{X}_t + 3(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2 - (\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^3 \tag{20}\
\boldsymbol{E}_t^4 &amp;= \boldsymbol{I} - 4\boldsymbol{X}_t^{\top}\boldsymbol{X}_t + 6(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2 - 4(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^3 + (\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^4 \tag{21}
\end{align}</p>
<p>å³ä¹˜$\boldsymbol{X}_t$åæ”¶é›†$\boldsymbol{X}_t, \boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t), \boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2$çš„ç³»æ•°ï¼Œå¯ä»¥æ¨å¯¼å‡º5é¡¹Newton-Schulzè¿­ä»£çš„ç†è®ºç³»æ•°ã€‚</p>
<h3 id="2">2. æ ‡é‡è¿­ä»£çš„åˆ†æ</h3>
<h4 id="21">2.1 å¥‡å¼‚å€¼çš„è§£è€¦</h4>
<p>æ­£æ–‡ä¸­å·²ç»è¯æ˜ï¼ŒNewton-Schulzè¿­ä»£ä¿æŒçŸ©é˜µçš„å·¦å³å¥‡å¼‚å‘é‡ä¸å˜ï¼Œåªæ”¹å˜å¥‡å¼‚å€¼ã€‚å› æ­¤æˆ‘ä»¬å°†åˆ†æç®€åŒ–ä¸ºæ ‡é‡è¿­ä»£ï¼š
\begin{equation}
x_{t+1} = g(x_t) = a x_t + b x_t^3 + c x_t^5
\tag{22}\end{equation}</p>
<p>è¿™é‡Œ$x_t \in (0,1]$ä»£è¡¨å½’ä¸€åŒ–åçš„å¥‡å¼‚å€¼ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯è®¾è®¡$(a,b,c)$ä½¿å¾—å¯¹æ‰€æœ‰$x_0 \in (0,1]$ï¼Œè¿­ä»£éƒ½èƒ½å¿«é€Ÿæ”¶æ•›åˆ°$x_{\infty} = 1$ã€‚</p>
<h4 id="22">2.2 ä¸åŠ¨ç‚¹åˆ†æ</h4>
<p><strong>å®šä¹‰</strong>ï¼š$x^<em>$æ˜¯è¿­ä»£$x_{t+1} = g(x_t)$çš„ä¸åŠ¨ç‚¹ï¼Œå¦‚æœ$g(x^</em>) = x^*$ã€‚</p>
<p>å¯¹äºæˆ‘ä»¬çš„è¿­ä»£ï¼Œä¸åŠ¨ç‚¹æ»¡è¶³ï¼š
\begin{equation}
x^<em> = a x^</em> + b (x^<em>)^3 + c (x^</em>)^5
\tag{23}\end{equation}</p>
<p>å³ï¼š
\begin{equation}
(1-a) x^<em> - b (x^</em>)^3 - c (x^*)^5 = 0
\tag{24}\end{equation}</p>
<p>æå–$x^<em>$ï¼š
\begin{equation}
x^</em>\left[(1-a) - b (x^<em>)^2 - c (x^</em>)^4\right] = 0
\tag{25}\end{equation}</p>
<p>æ‰€ä»¥$x^<em> = 0$æ€»æ˜¯ä¸€ä¸ªä¸åŠ¨ç‚¹ã€‚éé›¶ä¸åŠ¨ç‚¹æ»¡è¶³ï¼š
\begin{equation}
(1-a) - b (x^</em>)^2 - c (x^*)^4 = 0
\tag{26}\end{equation}</p>
<p><strong>ç›®æ ‡ä¸åŠ¨ç‚¹</strong>ï¼šæˆ‘ä»¬å¸Œæœ›$x^* = 1$æ˜¯ä¸åŠ¨ç‚¹ï¼Œå› æ­¤ï¼š
\begin{equation}
(1-a) - b - c = 0 \quad\Rightarrow\quad a + b + c = 1
\tag{27}\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™æ˜¯ç³»æ•°$(a,b,c)$å¿…é¡»æ»¡è¶³çš„ç¬¬ä¸€ä¸ªçº¦æŸæ¡ä»¶ã€‚</p>
<h4 id="23">2.3 ç¨³å®šæ€§åˆ†æ</h4>
<p>ä¸åŠ¨ç‚¹çš„ç¨³å®šæ€§ç”±å¯¼æ•°$g'(x^*)$å†³å®šã€‚è®¡ç®—å¯¼æ•°ï¼š
\begin{equation}
g'(x) = a + 3bx^2 + 5cx^4
\tag{28}\end{equation}</p>
<p>åœ¨$x^* = 1$å¤„ï¼š
\begin{equation}
g'(1) = a + 3b + 5c
\tag{29}\end{equation}</p>
<p><strong>ç¨³å®šæ€§æ¡ä»¶</strong>ï¼šä¸åŠ¨ç‚¹$x^* = 1$æ˜¯å¸å¼•çš„ï¼ˆç¨³å®šçš„ï¼‰ï¼Œå½“ä¸”ä»…å½“$|g'(1)| &lt; 1$ã€‚</p>
<p>ä¸ºäº†å¿«é€Ÿæ”¶æ•›ï¼Œæˆ‘ä»¬å¸Œæœ›$g'(1)$å°½å¯èƒ½å°ã€‚ç‰¹åˆ«åœ°ï¼Œå¦‚æœ$g'(1) = 0$ï¼Œåˆ™è¿­ä»£åœ¨$x=1$é™„è¿‘æ˜¯äºŒé˜¶æ”¶æ•›çš„ï¼ˆè¶…çº¿æ€§æ”¶æ•›ï¼‰ã€‚è¿™ç»™å‡ºç¬¬äºŒä¸ªçº¦æŸï¼š
\begin{equation}
a + 3b + 5c = 0
\tag{30}\end{equation}</p>
<p><strong>è”ç«‹çº¦æŸ</strong>ï¼šç»“åˆå¼(27)å’Œå¼(30)ï¼Œæˆ‘ä»¬æœ‰ï¼š
\begin{align}
a + b + c &amp;= 1 \tag{31}\
a + 3b + 5c &amp;= 0 \tag{32}
\end{align}</p>
<p>ä»(31)å¾—$a = 1 - b - c$ï¼Œä»£å…¥(32)ï¼š
\begin{equation}
(1-b-c) + 3b + 5c = 0 \quad\Rightarrow\quad 1 + 2b + 4c = 0
\tag{33}\end{equation}</p>
<p>æ‰€ä»¥ï¼š
\begin{equation}
b = -\frac{1 + 4c}{2}
\tag{34}\end{equation}
\begin{equation}
a = 1 - b - c = 1 + \frac{1+4c}{2} - c = \frac{3 + 2c}{2}
\tag{35}\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™è¡¨æ˜$(a,b,c)$ä¸­åªæœ‰ä¸€ä¸ªè‡ªç”±å‚æ•°$c$ã€‚ç»å…¸çš„Newton-Schulzè¿­ä»£é€‰æ‹©$c=0$ï¼Œå¾—åˆ°$(a,b,c) = (3/2, -1/2, 0)$ã€‚</p>
<h4 id="24">2.4 æ”¶æ•›é€Ÿåº¦åˆ†æ</h4>
<p>ä¸ºäº†åˆ†ææ”¶æ•›é€Ÿåº¦ï¼Œæˆ‘ä»¬åœ¨$x=1$é™„è¿‘åšæ³°å‹’å±•å¼€ã€‚è®¾$\epsilon_t = 1 - x_t$ä¸ºè¯¯å·®ï¼Œåˆ™ï¼š
\begin{align}
x_{t+1} &amp;= g(1-\epsilon_t) \tag{36}\
&amp;= a(1-\epsilon_t) + b(1-\epsilon_t)^3 + c(1-\epsilon_t)^5 \tag{37}
\end{align}</p>
<p>å±•å¼€åˆ°$O(\epsilon^3)$ï¼š
\begin{align}
(1-\epsilon_t)^3 &amp;= 1 - 3\epsilon_t + 3\epsilon_t^2 - \epsilon_t^3 + O(\epsilon_t^4) \tag{38}\
(1-\epsilon_t)^5 &amp;= 1 - 5\epsilon_t + 10\epsilon_t^2 - 10\epsilon_t^3 + O(\epsilon_t^4) \tag{39}
\end{align}</p>
<p>ä»£å…¥ï¼š
\begin{align}
x_{t+1} &amp;= a(1-\epsilon_t) + b(1-3\epsilon_t+3\epsilon_t^2-\epsilon_t^3) + c(1-5\epsilon_t+10\epsilon_t^2-10\epsilon_t^3) + O(\epsilon_t^4) \tag{40}\
&amp;= (a+b+c) - (a+3b+5c)\epsilon_t + (3b+10c)\epsilon_t^2 - (b+10c)\epsilon_t^3 + O(\epsilon_t^4) \tag{41}
\end{align}</p>
<p>ç”±çº¦æŸå¼(27)å’Œ(30)ï¼Œå‰ä¸¤é¡¹ç³»æ•°ä¸º0å’Œ0ï¼Œæ‰€ä»¥ï¼š
\begin{equation}
x_{t+1} = 1 - (3b+10c)\epsilon_t^2 + (b+10c)\epsilon_t^3 + O(\epsilon_t^4)
\tag{42}\end{equation}</p>
<p>å³ï¼š
\begin{equation}
\epsilon_{t+1} = -(3b+10c)\epsilon_t^2 + (b+10c)\epsilon_t^3 + O(\epsilon_t^4)
\tag{43}\end{equation}</p>
<p><strong>äºŒé˜¶æ”¶æ•›æ¡ä»¶</strong>ï¼šå½“$(3b+10c) \neq 0$æ—¶ï¼Œè¿­ä»£æ˜¯äºŒé˜¶æ”¶æ•›çš„ï¼Œå³$\epsilon_{t+1} \sim \epsilon_t^2$ã€‚</p>
<p>ä»£å…¥$b = -(1+4c)/2$ï¼š
\begin{equation}
3b + 10c = 3 \cdot \frac{-(1+4c)}{2} + 10c = -\frac{3+12c}{2} + 10c = \frac{-3-12c+20c}{2} = \frac{8c-3}{2}
\tag{44}\end{equation}</p>
<p>æ‰€ä»¥å½“$c \neq 3/8$æ—¶ï¼Œè¿­ä»£æ˜¯äºŒé˜¶æ”¶æ•›çš„ã€‚</p>
<p><strong>ç»å…¸é€‰æ‹©åˆ†æ</strong>ï¼š$c=0$æ—¶ï¼Œ$3b+10c = -3/2 &lt; 0$ï¼Œæ‰€ä»¥ï¼š
\begin{equation}
\epsilon_{t+1} \approx \frac{3}{2}\epsilon_t^2
\tag{45}\end{equation}</p>
<p>è¿™æ„å‘³ç€è¯¯å·®å¹³æ–¹ä¸‹é™ï¼Œè¿™æ˜¯è‰¯å¥½çš„äºŒé˜¶æ”¶æ•›æ€§è´¨ã€‚</p>
<h3 id="3">3. å°å¥‡å¼‚å€¼çš„æ”¶æ•›æ€§</h3>
<h4 id="31">3.1 é›¶ç‚¹é™„è¿‘çš„è¡Œä¸º</h4>
<p>å¯¹äºå¾ˆå°çš„$x_0 \ll 1$ï¼Œæˆ‘ä»¬åˆ†æè¿­ä»£å‡½æ•°$g(x)$åœ¨$x \to 0^+$æ—¶çš„è¡Œä¸ºï¼š
\begin{equation}
g(x) = ax + bx^3 + cx^5 \approx ax \qquad (x \to 0^+)
\tag{46}\end{equation}</p>
<p>æ‰€ä»¥ï¼š
\begin{equation}
x_{t+1} \approx a \cdot x_t \approx a^{t+1} x_0
\tag{47}\end{equation}</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šå¦‚æœ$a &gt; 1$ï¼Œåˆ™å°å¥‡å¼‚å€¼ä¼šæŒ‡æ•°å¢é•¿ï¼›å¦‚æœ$a &lt; 1$ï¼Œåˆ™ä¼šæŒ‡æ•°è¡°å‡åˆ°0ã€‚</p>
<p>ä¸ºäº†è®©å°å¥‡å¼‚å€¼èƒ½å¤Ÿæ”¶æ•›åˆ°1ï¼ˆè€Œé0ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦$a &gt; 1$ã€‚å›é¡¾$a = (3+2c)/2$ï¼Œè¿™è¦æ±‚ï¼š
\begin{equation}
\frac{3+2c}{2} &gt; 1 \quad\Rightarrow\quad 3 + 2c &gt; 2 \quad\Rightarrow\quad c &gt; -\frac{1}{2}
\tag{48}\end{equation}</p>
<p><strong>å¢é•¿å€ç‡</strong>ï¼šæ¯æ­¥è¿­ä»£ï¼Œå°å¥‡å¼‚å€¼å¤§çº¦è¢«æ”¾å¤§$a$å€ã€‚ä¸ºäº†å¿«é€Ÿä»å°å€¼å¢é•¿åˆ°1ï¼Œæˆ‘ä»¬å¸Œæœ›$a$å°½å¯èƒ½å¤§ã€‚</p>
<h4 id="32">3.2 æœ€å¤§åŒ–å¢é•¿ç‡</h4>
<p>è€ƒè™‘çº¦æŸ$a = (3+2c)/2$å’Œæ”¶æ•›æ€§è¦æ±‚ï¼Œæˆ‘ä»¬å¸Œæœ›æœ€å¤§åŒ–$a$ï¼Œè¿™ç­‰ä»·äºæœ€å¤§åŒ–$c$ã€‚ä½†$c$ä¹Ÿä¸èƒ½å¤ªå¤§ï¼Œå¦åˆ™å¯èƒ½ç ´åå…¨å±€æ”¶æ•›æ€§ã€‚</p>
<p><strong>æ•°å€¼å®éªŒæŒ‡å¯¼</strong>ï¼šä»æ­£æ–‡çš„ä¼˜åŒ–å®éªŒå¯ä»¥çœ‹å‡ºï¼Œæœ€ä¼˜çš„$c$å€¼é€šå¸¸åœ¨$[0, 5]$èŒƒå›´å†…ï¼Œå¯¹åº”$a \in [1.5, 6.5]$ã€‚</p>
<h4 id="33">3.3 ä¸­é—´å€¼çš„æ”¶æ•›è½¨è¿¹</h4>
<p>å¯¹äº$x \in (0,1)$çš„ä¸€èˆ¬æƒ…å†µï¼Œæˆ‘ä»¬éœ€è¦ä¿è¯$g(x) &gt; x$ï¼ˆå¢é•¿ï¼‰ä¸”$g(x) \leq 1$ï¼ˆä¸è¶…è¿‡ç›®æ ‡ï¼‰ã€‚</p>
<p><strong>å¢é•¿æ¡ä»¶</strong>ï¼š
\begin{equation}
g(x) &gt; x \quad\Leftrightarrow\quad ax + bx^3 + cx^5 &gt; x \quad\Leftrightarrow\quad (a-1) + bx^2 + cx^4 &gt; 0
\tag{49}\end{equation}</p>
<p>ä»£å…¥$b = -(1+4c)/2$å’Œ$a = (3+2c)/2$ï¼š
\begin{equation}
(a-1) = \frac{3+2c}{2} - 1 = \frac{1+2c}{2}
\tag{50}\end{equation}</p>
<p>æ‰€ä»¥ï¼š
\begin{equation}
g(x) &gt; x \quad\Leftrightarrow\quad \frac{1+2c}{2} - \frac{1+4c}{2}x^2 + cx^4 &gt; 0
\tag{51}\end{equation}</p>
<p>å³ï¼š
\begin{equation}
(1+2c) - (1+4c)x^2 + 2cx^4 &gt; 0
\tag{52}\end{equation}</p>
<p>è¿™æ˜¯å…³äº$x^2$çš„äºŒæ¬¡ä¸ç­‰å¼ï¼ˆå½“$c \neq 0$æ—¶ï¼‰ã€‚</p>
<h3 id="4">4. ä¼˜åŒ–é—®é¢˜çš„æ•°å­¦è¡¨è¿°</h3>
<h4 id="41">4.1 ä¼˜åŒ–ç›®æ ‡çš„å½¢å¼åŒ–</h4>
<p>æ­£æ–‡ä¸­çš„ä¼˜åŒ–æ€è·¯æ˜¯ï¼šé€‰æ‹©è‹¥å¹²æµ‹è¯•ç‚¹${x_i}<em a_b_c="a,b,c">{i=1}^N \subset (0,1]$ï¼Œç»è¿‡$T$æ­¥è¿­ä»£åå¾—åˆ°$x_i^{(T)}$ï¼Œæœ€å°åŒ–æœ€åæƒ…å†µä¸‹çš„è¯¯å·®ï¼š
\begin{equation}
\min</em> - 1|
\tag{53}\end{equation}} \max_{i=1,\ldots,N} |x_i^{(T)</p>
<p>è¿™æ˜¯ä¸€ä¸ªminimaxä¼˜åŒ–é—®é¢˜ã€‚ä¸ºäº†ç”¨æ¢¯åº¦ä¸‹é™æ±‚è§£ï¼Œæ­£æ–‡ä¸­é‡‡ç”¨äº†"è½¯åŒ–"ç­–ç•¥ï¼šé€‰æ‹©è¯¯å·®æœ€å¤§çš„å‰$k$ä¸ªç‚¹çš„å¹³å‡ï¼š
\begin{equation}
\min_{a,b,c} \frac{1}{k}\sum_{j=1}^k |x_{i_j}^{(T)} - 1|
\tag{54}\end{equation}</p>
<p>å…¶ä¸­$i_1, \ldots, i_k$æ˜¯ä½¿å¾—$|x_i^{(T)} - 1|$æœ€å¤§çš„$k$ä¸ªç´¢å¼•ã€‚</p>
<h4 id="42">4.2 æ¢¯åº¦è®¡ç®—</h4>
<p>è®¾æŸå¤±å‡½æ•°ä¸ºï¼š
\begin{equation}
L(a,b,c) = \frac{1}{k}\sum_{j=1}^k |x_{i_j}^{(T)} - 1|
\tag{55}\end{equation}</p>
<p>ä¸ºäº†è®¡ç®—æ¢¯åº¦ï¼Œæˆ‘ä»¬éœ€è¦$\frac{\partial x_i^{(T)}}{\partial (a,b,c)}$ã€‚ç”±é“¾å¼æ³•åˆ™ï¼š
\begin{equation}
\frac{\partial x_i^{(T)}}{\partial a} = \sum_{t=0}^{T-1} \frac{\partial g}{\partial a}\Big|<em s="t+1">{x_i^{(t)}} \prod</em>\right)
\tag{56}\end{equation}}^{T-1} g'\left(x_i^{(s)</p>
<p>å…¶ä¸­ï¼š
\begin{align}
\frac{\partial g}{\partial a}(x) &amp;= x \tag{57}\
\frac{\partial g}{\partial b}(x) &amp;= x^3 \tag{58}\
\frac{\partial g}{\partial c}(x) &amp;= x^5 \tag{59}\
g'(x) &amp;= a + 3bx^2 + 5cx^4 \tag{60}
\end{align}</p>
<p><strong>è‡ªåŠ¨å¾®åˆ†</strong>ï¼šå®è·µä¸­ä½¿ç”¨JAXç­‰æ¡†æ¶çš„è‡ªåŠ¨å¾®åˆ†åŠŸèƒ½è‡ªåŠ¨è®¡ç®—è¿™äº›æ¢¯åº¦ï¼Œé¿å…æ‰‹åŠ¨æ¨å¯¼çš„å¤æ‚æ€§ã€‚</p>
<h4 id="43-adam">4.3 Adamä¼˜åŒ–å™¨</h4>
<p>æ­£æ–‡ä½¿ç”¨Adamä¼˜åŒ–å™¨æ›´æ–°å‚æ•°ã€‚Adamçš„æ›´æ–°è§„åˆ™ä¸ºï¼š
\begin{align}
\boldsymbol{m}<em t-1="t-1">t &amp;= \beta_1 \boldsymbol{m}</em>} + (1-\beta_1)\boldsymbol{g<em t-1="t-1">t \tag{61}\
\boldsymbol{v}_t &amp;= \beta_2 \boldsymbol{v}</em>} + (1-\beta_2)\boldsymbol{g<em t-1="t-1">t^2 \tag{62}\
\hat{\boldsymbol{m}}_t &amp;= \frac{\boldsymbol{m}_t}{1-\beta_1^t} \tag{63}\
\hat{\boldsymbol{v}}_t &amp;= \frac{\boldsymbol{v}_t}{1-\beta_2^t} \tag{64}\
\boldsymbol{w}_t &amp;= \boldsymbol{w}</em>
\end{align}} - \alpha \frac{\hat{\boldsymbol{m}}_t}{\sqrt{\hat{\boldsymbol{v}}_t} + \epsilon} \tag{65</p>
<p>å…¶ä¸­$\boldsymbol{w} = (a,b,c)$æ˜¯å‚æ•°å‘é‡ï¼Œ$\boldsymbol{g}_t$æ˜¯æ¢¯åº¦ï¼Œ$(\beta_1, \beta_2) = (0.9, 0.999)$æ˜¯åŠ¨é‡ç³»æ•°ã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šAdamç›¸æ¯”SGDçš„ä¼˜åŠ¿æ˜¯è‡ªé€‚åº”å­¦ä¹ ç‡ï¼Œèƒ½å¤Ÿè‡ªåŠ¨è°ƒæ•´ä¸åŒå‚æ•°çš„æ›´æ–°æ­¥é•¿ã€‚</p>
<h3 id="5-newton-schulz">5. å˜ç³»æ•°Newton-Schulzè¿­ä»£</h3>
<h4 id="51">5.1 ç†è®ºåŠ¨æœº</h4>
<p>æ ‡å‡†Newton-Schulzè¿­ä»£å¯¹æ‰€æœ‰æ­¥éƒ½ä½¿ç”¨ç›¸åŒçš„$(a,b,c)$ï¼š
\begin{equation}
x_{t+1} = ax_t + bx_t^3 + cx_t^5, \quad t=0,1,\ldots,T-1
\tag{66}\end{equation}</p>
<p>è¿™ç›¸å½“äºç”¨å•ä¸ªå¤šé¡¹å¼å‡½æ•°$g(x) = ax + bx^3 + cx^5$çš„$T$æ¬¡å¤åˆæ¥é€¼è¿‘æ’ç­‰æ˜ å°„$\text{id}(x) \equiv 1$ã€‚</p>
<p><strong>å˜ç³»æ•°æ–¹æ¡ˆ</strong>ï¼šå…è®¸æ¯æ­¥ä½¿ç”¨ä¸åŒçš„ç³»æ•°$(a_t, b_t, c_t)$ï¼š
\begin{equation}
x_{t+1} = a_t x_t + b_t x_t^3 + c_t x_t^5, \quad t=0,1,\ldots,T-1
\tag{67}\end{equation}</p>
<p>è¿™ç›¸å½“äºç”¨$T$ä¸ªä¸åŒå¤šé¡¹å¼çš„å¤åˆï¼š
\begin{equation}
x^{(T)} = g_{T-1} \circ g_{T-2} \circ \cdots \circ g_0(x)
\tag{68}\end{equation}</p>
<p>å…¶ä¸­$g_t(x) = a_t x + b_t x^3 + c_t x^5$ã€‚</p>
<p><strong>è‡ªç”±åº¦æå‡</strong>ï¼š
- å›ºå®šç³»æ•°æ–¹æ¡ˆï¼š3ä¸ªå‚æ•°$(a,b,c)$
- å˜ç³»æ•°æ–¹æ¡ˆï¼š$3T$ä¸ªå‚æ•°$(a_0,b_0,c_0,\ldots,a_{T-1},b_{T-1},c_{T-1})$</p>
<p>è‡ªç”±åº¦çš„å¤§å¹…å¢åŠ ç†è®ºä¸Šå…è®¸æ›´å¥½çš„é€¼è¿‘æ•ˆæœã€‚</p>
<h4 id="52">5.2 å¤åˆå‡½æ•°çš„é€¼è¿‘ç†è®º</h4>
<p><strong>å®šç†ï¼ˆå¤šé¡¹å¼é€¼è¿‘ï¼‰</strong>ï¼šè®¾$f: [0,1] \to \mathbb{R}$æ˜¯è¿ç»­å‡½æ•°ã€‚å¯¹äºä»»æ„$\epsilon &gt; 0$ï¼Œå­˜åœ¨å¤šé¡¹å¼$p(x)$ä½¿å¾—ï¼š
\begin{equation}
\max_{x \in [0,1]} |f(x) - p(x)| &lt; \epsilon
\tag{69}\end{equation}</p>
<p>è¿™æ˜¯Weierstrassé€¼è¿‘å®šç†ã€‚</p>
<p><strong>æ¨è®º</strong>ï¼šç›®æ ‡å‡½æ•°$f(x) = 1$ï¼ˆå¸¸æ•°ï¼‰æ˜¾ç„¶å¯ä»¥è¢«å¤šé¡¹å¼ä»»æ„é€¼è¿‘ã€‚ä½†æˆ‘ä»¬çš„çº¦æŸæ˜¯å¤šé¡¹å¼å¿…é¡»æ˜¯ç‰¹æ®Šå½¢å¼$ax + bx^3 + cx^5$çš„å¤åˆã€‚</p>
<p><strong>å¤åˆå¤šé¡¹å¼çš„è¡¨è¾¾èƒ½åŠ›</strong>ï¼š$T$ä¸ªäº”æ¬¡å¤šé¡¹å¼çš„å¤åˆï¼Œå…¶å±•å¼€å¼çš„æœ€é«˜æ¬¡æ•°ä¸º$5^T$ã€‚ä¾‹å¦‚$T=6$æ—¶æœ€é«˜æ¬¡æ•°ä¸º$5^6 = 15625$ï¼Œè¿™æ˜¯ä¸€ä¸ªæé«˜æ¬¡çš„å¤šé¡¹å¼ï¼Œç†è®ºä¸Šå¯ä»¥éå¸¸ç²¾ç¡®åœ°é€¼è¿‘ä»»æ„è¿ç»­å‡½æ•°ã€‚</p>
<h4 id="53">5.3 æ¯æ­¥çš„ä¼˜åŒ–çº¦æŸ</h4>
<p>è™½ç„¶æ¯æ­¥å¯ä»¥ä½¿ç”¨ä¸åŒçš„ç³»æ•°ï¼Œä½†æŸäº›çº¦æŸåº”å½“å¯¹æ‰€æœ‰æ­¥ä¿æŒï¼š</p>
<p><strong>ä¸åŠ¨ç‚¹çº¦æŸ</strong>ï¼šä¸ºäº†ä½¿$x=1$åœ¨æ¯æ­¥è¿­ä»£ä¸­éƒ½ä¿æŒä¸å˜ï¼Œæ¯æ­¥éƒ½åº”è¯¥æ»¡è¶³ï¼š
\begin{equation}
a_t + b_t + c_t = 1, \quad t = 0,1,\ldots,T-1
\tag{70}\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ä¸ªçº¦æŸç¡®ä¿å¦‚æœæŸä¸ªå¥‡å¼‚å€¼å·²ç»è¾¾åˆ°1ï¼Œåç»­è¿­ä»£ä¸ä¼šæ”¹å˜å®ƒã€‚</p>
<p><strong>å¢é•¿æ€§çº¦æŸ</strong>ï¼ˆå¯é€‰ï¼‰ï¼šä¸ºäº†ç¡®ä¿å°å¥‡å¼‚å€¼èƒ½å¤Ÿå¢é•¿ï¼Œæˆ‘ä»¬å¯ä»¥è¦æ±‚ï¼š
\begin{equation}
a_t &gt; 1, \quad t = 0,1,\ldots,T-1
\tag{71}\end{equation}</p>
<p>ä½†å®è·µä¸­å‘ç°ï¼Œä¼˜åŒ–å™¨é€šå¸¸ä¼šè‡ªåŠ¨æ»¡è¶³è¿™ä¸ªæ¡ä»¶ï¼Œä¸éœ€è¦æ˜¾å¼çº¦æŸã€‚</p>
<h3 id="6">6. å½’ä¸€åŒ–æ–¹æ³•çš„æ•°å­¦åˆ†æ</h3>
<h4 id="61-frobenius">6.1 FrobeniusèŒƒæ•°å½’ä¸€åŒ–</h4>
<p>æ ‡å‡†æ–¹æ³•ä½¿ç”¨FrobeniusèŒƒæ•°å½’ä¸€åŒ–ï¼š
\begin{equation}
\boldsymbol{X}<em i_j="i,j">0 = \frac{\boldsymbol{M}}{\Vert\boldsymbol{M}\Vert_F}, \qquad \Vert\boldsymbol{M}\Vert_F = \sqrt{\sum</em>
\tag{72}\end{equation}} M_{ij}^2} = \sqrt{\sum_{i=1}^r \sigma_i^2</p>
<p>å½’ä¸€åŒ–åçš„å¥‡å¼‚å€¼ä¸ºï¼š
\begin{equation}
\sigma_i^{(0)} = \frac{\sigma_i}{\sqrt{\sum_{j=1}^r \sigma_j^2}}
\tag{73}\end{equation}</p>
<p><strong>æ€§è´¨</strong>ï¼š$\sum_{i=1}^r (\sigma_i^{(0)})^2 = 1$ï¼Œå³å½’ä¸€åŒ–åçš„å¥‡å¼‚å€¼æ„æˆå•ä½å‘é‡ã€‚</p>
<p><strong>é—®é¢˜</strong>ï¼šå¦‚æœå¥‡å¼‚å€¼åˆ†å¸ƒä¸å‡åŒ€ï¼Œæœ€å¤§å¥‡å¼‚å€¼$\sigma_1$è¿œå¤§äºå…¶ä»–å¥‡å¼‚å€¼ï¼Œåˆ™ï¼š
\begin{equation}
\sigma_{\min}^{(0)} \approx \frac{\sigma_{\min}}{\sigma_1}
\tag{74}\end{equation}</p>
<p>å¯èƒ½éå¸¸å°ï¼Œå¯¼è‡´å°å¥‡å¼‚å€¼éœ€è¦æ›´å¤šè¿­ä»£æ­¥æ‰èƒ½æ”¶æ•›åˆ°1ã€‚</p>
<h4 id="62">6.2 è°±èŒƒæ•°å½’ä¸€åŒ–</h4>
<p>ç†è®ºä¸Šæœ€ä¼˜çš„å½’ä¸€åŒ–æ˜¯è°±èŒƒæ•°ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰ï¼š
\begin{equation}
\boldsymbol{X}_0 = \frac{\boldsymbol{M}}{\Vert\boldsymbol{M}\Vert_2}, \qquad \Vert\boldsymbol{M}\Vert_2 = \sigma_1
\tag{75}\end{equation}</p>
<p>å½’ä¸€åŒ–åï¼š
\begin{equation}
\sigma_i^{(0)} = \frac{\sigma_i}{\sigma_1}
\tag{76}\end{equation}</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼šæ‰€æœ‰å½’ä¸€åŒ–åçš„å¥‡å¼‚å€¼éƒ½åœ¨$(0, 1]$å†…ï¼Œä¸”æœ€å¤§å¥‡å¼‚å€¼æ°å¥½ç­‰äº1ï¼Œä¸éœ€è¦è¿­ä»£ã€‚æœ€å°å¥‡å¼‚å€¼$\sigma_r^{(0)} = \sigma_r/\sigma_1$æ˜¯çŸ©é˜µæ¡ä»¶æ•°çš„å€’æ•°ã€‚</p>
<p><strong>é—®é¢˜</strong>ï¼šç²¾ç¡®è®¡ç®—è°±èŒƒæ•°éœ€è¦å¹‚è¿­ä»£æˆ–Lanczosç®—æ³•ï¼Œè®¡ç®—æˆæœ¬è¾ƒé«˜ã€‚</p>
<h4 id="63-frobenius">6.3 é«˜é˜¶FrobeniusèŒƒæ•°</h4>
<p>æ­£æ–‡æå‡ºäº†ä¸€ä¸ªå·§å¦™çš„æŠ˜ä¸­æ–¹æ¡ˆï¼šä½¿ç”¨é«˜é˜¶FrobeniusèŒƒæ•°ä½œä¸ºè°±èŒƒæ•°çš„è¿‘ä¼¼ã€‚</p>
<p><strong>p-èŒƒæ•°çš„å…³ç³»</strong>ï¼šå¯¹äº$p \geq 2$ï¼Œå®šä¹‰ï¼š
\begin{equation}
\Vert\boldsymbol{M}\Vert_{F,p} = \left(\sum_{i=1}^r \sigma_i^p\right)^{1/p}
\tag{77}\end{equation}</p>
<p>å½“$p \to \infty$æ—¶ï¼š
\begin{equation}
\lim_{p \to \infty} \Vert\boldsymbol{M}\Vert_{F,p} = \max_{i=1,\ldots,r} \sigma_i = \Vert\boldsymbol{M}\Vert_2
\tag{78}\end{equation}</p>
<p><strong>è®¡ç®—æ–¹æ³•</strong>ï¼šæ³¨æ„åˆ°ï¼š
\begin{align}
\Vert\boldsymbol{M}\Vert_{F,4} &amp;= \left(\sum_{i=1}^r \sigma_i^4\right)^{1/4} = \Vert\boldsymbol{M}^{\top}\boldsymbol{M}\Vert_F^{1/2} \tag{79}\
\Vert\boldsymbol{M}\Vert_{F,8} &amp;= \left(\sum_{i=1}^r \sigma_i^8\right)^{1/8} = \Vert(\boldsymbol{M}^{\top}\boldsymbol{M})^2\Vert_F^{1/4} \tag{80}
\end{align}</p>
<p><strong>å…è´¹è®¡ç®—çš„å…³é”®</strong>ï¼šåœ¨Newton-Schulzè¿­ä»£ä¸­ï¼Œç¬¬ä¸€æ­¥éœ€è¦è®¡ç®—ï¼š
\begin{equation}
\boldsymbol{X}_1 = a\boldsymbol{X}_0 + b\boldsymbol{X}_0(\boldsymbol{X}_0^{\top}\boldsymbol{X}_0) + c\boldsymbol{X}_0(\boldsymbol{X}_0^{\top}\boldsymbol{X}_0)^2
\tag{81}\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{X}<em i="1">0^{\top}\boldsymbol{X}_0$å’Œ$(\boldsymbol{X}_0^{\top}\boldsymbol{X}_0)^2$å¿…é¡»è®¡ç®—ã€‚å› æ­¤ï¼š
\begin{align}
\Vert\boldsymbol{X}_0^{\top}\boldsymbol{X}_0\Vert_F &amp;= \sqrt{\text{trace}((\boldsymbol{X}_0^{\top}\boldsymbol{X}_0)^2)} = \sqrt{\sum</em>\
\Vert(\boldsymbol{X}}^r (\sigma_i^{(0)})^4} \tag{82<em i="1">0^{\top}\boldsymbol{X}_0)^2\Vert_F &amp;= \sqrt{\text{trace}((\boldsymbol{X}_0^{\top}\boldsymbol{X}_0)^4)} = \sqrt{\sum</em>
\end{align}}^r (\sigma_i^{(0)})^8} \tag{83</p>
<p>è¿™äº›é‡å¯ä»¥å‡ ä¹"å…è´¹"åœ°ä»å·²è®¡ç®—çš„çŸ©é˜µä¸­æå–å‡ºæ¥ã€‚</p>
<h4 id="64">6.4 é‡å½’ä¸€åŒ–çš„æ•°å­¦æ•ˆæœ</h4>
<p>è®¾åˆå§‹å½’ä¸€åŒ–å› å­ä¸º$\Vert\boldsymbol{M}\Vert_F$ï¼Œç»è¿‡ç¬¬ä¸€æ­¥è¿­ä»£åï¼Œæˆ‘ä»¬è®¡ç®—$\Vert(\boldsymbol{X}_0^{\top}\boldsymbol{X}_0)^2\Vert_F$å¹¶ç”¨å®ƒé‡æ–°å½’ä¸€åŒ–ï¼š
\begin{equation}
n = \Vert(\boldsymbol{X}_0^{\top}\boldsymbol{X}_0)^2\Vert_F^{1/8}
\tag{84}\end{equation}</p>
<p>æ–°çš„å½’ä¸€åŒ–å› å­ç›¸å½“äºç”¨$\Vert\boldsymbol{M}\Vert_{F,8}$ä»£æ›¿$\Vert\boldsymbol{M}\Vert_F$ï¼š
\begin{equation}
\boldsymbol{X}<em F_8="F,8">0' = \frac{\boldsymbol{X}_0}{n} = \frac{\boldsymbol{M}}{\Vert\boldsymbol{M}\Vert_F \cdot n} \approx \frac{\boldsymbol{M}}{\Vert\boldsymbol{M}\Vert</em>
\tag{85}\end{equation}}</p>
<p><strong>å¥‡å¼‚å€¼çš„æ”¹å–„</strong>ï¼šå½’ä¸€åŒ–åçš„å¥‡å¼‚å€¼ä»$\sigma_i/\Vert\boldsymbol{M}\Vert_F$å˜ä¸º$\sigma_i/\Vert\boldsymbol{M}\Vert_{F,8}$ã€‚ç”±äºï¼š
\begin{equation}
\Vert\boldsymbol{M}\Vert_{F,8} \leq \Vert\boldsymbol{M}\Vert_{F,4} \leq \Vert\boldsymbol{M}\Vert_F
\tag{86}\end{equation}</p>
<p>æ–°çš„å½’ä¸€åŒ–å› å­æ›´æ¥è¿‘è°±èŒƒæ•°ï¼Œå› æ­¤å½’ä¸€åŒ–åçš„å°å¥‡å¼‚å€¼æ›´å¤§ï¼Œæ”¶æ•›é€Ÿåº¦æ›´å¿«ã€‚</p>
<h3 id="7">7. è¯¯å·®åˆ†æä¸æ•°å€¼ç¨³å®šæ€§</h3>
<h4 id="71">7.1 ç†è®ºè¯¯å·®ç•Œ</h4>
<p>è®¾$\boldsymbol{X}_T$æ˜¯$T$æ­¥Newton-Schulzè¿­ä»£çš„ç»“æœï¼Œ$\boldsymbol{X}^<em> = \msign(\boldsymbol{M})$æ˜¯ç²¾ç¡®å€¼ã€‚æˆ‘ä»¬åˆ†æè¯¯å·®$\Vert\boldsymbol{X}_T - \boldsymbol{X}^</em>\Vert_F$ã€‚</p>
<p>ç”±äºè¿­ä»£ä¿æŒå·¦å³å¥‡å¼‚å‘é‡ä¸å˜ï¼Œè¯¯å·®å®Œå…¨æ¥è‡ªå¥‡å¼‚å€¼çš„è¯¯å·®ï¼š
\begin{equation}
\Vert\boldsymbol{X}<em i="1">T - \boldsymbol{X}^*\Vert_F^2 = \sum</em> - 1)^2
\tag{87}\end{equation}}^r (x_i^{(T)</p>
<p><strong>äºŒé˜¶æ”¶æ•›çš„è¯¯å·®ç•Œ</strong>ï¼šå¯¹äºæ»¡è¶³$a+b+c=1$å’Œ$a+3b+5c=0$çš„ç³»æ•°ï¼Œè¿­ä»£åœ¨$x=1$é™„è¿‘æ˜¯äºŒé˜¶æ”¶æ•›çš„ã€‚è®¾åˆå§‹è¯¯å·®ä¸º$\epsilon_0 = 1 - x_0$ï¼Œåˆ™ï¼š
\begin{equation}
\epsilon_T \leq C \epsilon_0^{2^T}
\tag{88}\end{equation}</p>
<p>å…¶ä¸­$C$æ˜¯ä¸ç³»æ•°ç›¸å…³çš„å¸¸æ•°ã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šäºŒé˜¶æ”¶æ•›æ„å‘³ç€æ¯æ­¥è¿­ä»£ï¼Œæœ‰æ•ˆæ•°å­—ä½æ•°å¤§çº¦ç¿»å€ã€‚ä¾‹å¦‚ï¼Œ$T=5$æ­¥åï¼Œè¯¯å·®å¯ä»¥ä»$\epsilon_0$é™ä½åˆ°$O(\epsilon_0^{32})$ã€‚</p>
<h4 id="72">7.2 èˆå…¥è¯¯å·®çš„å½±å“</h4>
<p>åœ¨æœ‰é™ç²¾åº¦ç®—æœ¯ä¸­ï¼Œæ¯æ¬¡è¿ç®—éƒ½ä¼šå¼•å…¥èˆå…¥è¯¯å·®ã€‚è®¾æœºå™¨ç²¾åº¦ä¸º$u$ï¼ˆå¯¹äºfloat32ï¼Œ$u \approx 10^{-7}$ï¼›å¯¹äºbfloat16ï¼Œ$u \approx 10^{-3}$ï¼‰ã€‚</p>
<p><strong>çŸ©é˜µä¹˜æ³•çš„è¯¯å·®</strong>ï¼šè®¡ç®—$\boldsymbol{A}\boldsymbol{B}$ï¼ˆ$\boldsymbol{A}, \boldsymbol{B} \in \mathbb{R}^{n \times n}$ï¼‰æ—¶ï¼Œèˆå…¥è¯¯å·®æ»¡è¶³ï¼š
\begin{equation}
\text{fl}(\boldsymbol{A}\boldsymbol{B}) = \boldsymbol{A}\boldsymbol{B} + \boldsymbol{E}, \qquad \Vert\boldsymbol{E}\Vert_F \leq nu\Vert\boldsymbol{A}\Vert_F\Vert\boldsymbol{B}\Vert_F
\tag{89}\end{equation}</p>
<p><strong>è¿­ä»£ä¸­çš„è¯¯å·®ç´¯ç§¯</strong>ï¼šæ¯æ­¥è¿­ä»£æ¶‰åŠå¤šæ¬¡çŸ©é˜µä¹˜æ³•ï¼Œèˆå…¥è¯¯å·®ä¼šç´¯ç§¯ã€‚è®¾æ¯æ­¥å¼•å…¥çš„è¯¯å·®ä¸º$\delta_t$ï¼Œåˆ™æ€»è¯¯å·®ä¸ºï¼š
\begin{equation}
\text{total error} \leq \sum_{t=0}^{T-1} \delta_t \prod_{s=t+1}^{T-1} (1 + \kappa_s)
\tag{90}\end{equation}</p>
<p>å…¶ä¸­$\kappa_s$æ˜¯ç¬¬$s$æ­¥çš„æ¡ä»¶æ•°ã€‚</p>
<p><strong>bfloat16çš„å½±å“</strong>ï¼šæ­£æ–‡å®ç°ä¸­ä½¿ç”¨bfloat16ï¼Œå…¶æœºå™¨ç²¾åº¦$u \approx 8 \times 10^{-3}$ã€‚è™½ç„¶ç²¾åº¦è¾ƒä½ï¼Œä½†å¯¹äº$\msign$è¿™æ ·çš„"é²æ£’"è¿ç®—ï¼ˆç›®æ ‡æ˜¯å°†å¥‡å¼‚å€¼éƒ½å˜ä¸º1ï¼Œå¯¹ç²¾ç¡®å€¼ä¸æ•æ„Ÿï¼‰ï¼Œbfloat16è¶³å¤Ÿä½¿ç”¨ï¼Œå¹¶ä¸”èƒ½æ˜¾è‘—å‡å°‘å†…å­˜å’Œè®¡ç®—æ—¶é—´ã€‚</p>
<h4 id="73">7.3 æ¡ä»¶æ•°ä¸ç¨³å®šæ€§</h4>
<p>çŸ©é˜µ$\boldsymbol{M}$çš„æ¡ä»¶æ•°å®šä¹‰ä¸ºï¼š
\begin{equation}
\kappa(\boldsymbol{M}) = \frac{\sigma_{\max}(\boldsymbol{M})}{\sigma_{\min}(\boldsymbol{M})} = \frac{\sigma_1}{\sigma_r}
\tag{91}\end{equation}</p>
<p><strong>é«˜æ¡ä»¶æ•°çš„å½±å“</strong>ï¼šå½“$\kappa(\boldsymbol{M})$å¾ˆå¤§æ—¶ï¼ˆå³çŸ©é˜µæ¥è¿‘å¥‡å¼‚ï¼‰ï¼Œå½’ä¸€åŒ–åçš„æœ€å°å¥‡å¼‚å€¼$\sigma_r^{(0)} = \sigma_r/\Vert\boldsymbol{M}\Vert_F$ä¼šéå¸¸å°ã€‚</p>
<p>å¯¹äº$x_0 \ll 1$çš„æƒ…å†µï¼Œä»å¼(47)çŸ¥é“éœ€è¦$\log_{a}(1/x_0)$æ­¥è¿­ä»£æ‰èƒ½å°†$x$å¢é•¿åˆ°æ¥è¿‘1ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ$x_0 = 10^{-3}$ï¼Œ$a = 3.5$ï¼Œåˆ™éœ€è¦ï¼š
\begin{equation}
T \geq \frac{\log(1000)}{\log(3.5)} \approx \frac{6.9}{1.25} \approx 5.5
\tag{92}\end{equation}</p>
<p>æ‰€ä»¥è‡³å°‘éœ€è¦6æ­¥è¿­ä»£ã€‚</p>
<p><strong>ç¼“è§£ç­–ç•¥</strong>ï¼š
1. ä½¿ç”¨é«˜é˜¶å½’ä¸€åŒ–ï¼ˆå¦‚å‰æ‰€è¿°ï¼‰æé«˜æœ€å°å¥‡å¼‚å€¼
2. å¢åŠ è¿­ä»£æ­¥æ•°$T$
3. ä½¿ç”¨å˜ç³»æ•°æ–¹æ¡ˆï¼Œé’ˆå¯¹å°å¥‡å¼‚å€¼ä¼˜åŒ–å‰å‡ æ­¥çš„ç³»æ•°</p>
<h3 id="8">8. å…·ä½“è®¡ç®—ç¤ºä¾‹</h3>
<h4 id="81-2x2">8.1 ç®€å•2x2çŸ©é˜µ</h4>
<p>è€ƒè™‘çŸ©é˜µï¼š
\begin{equation}
\boldsymbol{M} = \begin{pmatrix} 2 &amp; 0 \ 0 &amp; 0.5 \end{pmatrix}
\tag{93}\end{equation}</p>
<p>å¥‡å¼‚å€¼ä¸º$\sigma_1 = 2, \sigma_2 = 0.5$ï¼Œ$\Vert\boldsymbol{M}\Vert_F = \sqrt{4 + 0.25} = \sqrt{4.25} \approx 2.062$ã€‚</p>
<p><strong>å½’ä¸€åŒ–</strong>ï¼š
\begin{equation}
\boldsymbol{X}_0 = \frac{1}{2.062}\begin{pmatrix} 2 &amp; 0 \ 0 &amp; 0.5 \end{pmatrix} \approx \begin{pmatrix} 0.970 &amp; 0 \ 0 &amp; 0.242 \end{pmatrix}
\tag{94}\end{equation}</p>
<p>å½’ä¸€åŒ–åçš„å¥‡å¼‚å€¼ä¸º$x_1^{(0)} = 0.970, x_2^{(0)} = 0.242$ã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥è¿­ä»£</strong>ï¼ˆä½¿ç”¨$(a,b,c) = (3.5, -6.0, 2.8)$ï¼Œè¿™æ˜¯ä¸€ä¸ªä¼˜åŒ–è¿‡çš„ç³»æ•°ï¼‰ï¼š</p>
<p>å¯¹äº$x_1^{(0)} = 0.970$ï¼š
\begin{align}
x_1^{(1)} &amp;= 3.5 \times 0.970 + (-6.0) \times (0.970)^3 + 2.8 \times (0.970)^5 \tag{95}\
&amp;\approx 3.395 - 5.480 + 2.455 \tag{96}\
&amp;\approx 0.997 \tag{97}
\end{align}</p>
<p>å¯¹äº$x_2^{(0)} = 0.242$ï¼š
\begin{align}
x_2^{(1)} &amp;= 3.5 \times 0.242 + (-6.0) \times (0.242)^3 + 2.8 \times (0.242)^5 \tag{98}\
&amp;\approx 0.847 - 0.085 + 0.003 \tag{99}\
&amp;\approx 0.765 \tag{100}
\end{align}</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œè¾ƒå¤§çš„å¥‡å¼‚å€¼$x_1$åœ¨ä¸€æ­¥åå·²ç»éå¸¸æ¥è¿‘1ï¼ˆè¯¯å·®$&lt; 0.3\%$ï¼‰ï¼Œè€Œè¾ƒå°çš„å¥‡å¼‚å€¼$x_2$å¢é•¿åˆ°0.765ï¼ˆå¢é•¿äº†3å€ä»¥ä¸Šï¼‰ã€‚</p>
<h4 id="82">8.2 æ”¶æ•›æ›²çº¿</h4>
<p>å¯¹äº$x_0 \in {0.1, 0.3, 0.5, 0.7, 0.9}$ï¼Œä½¿ç”¨$(a,b,c) = (3.5, -6.0, 2.8)$è¿›è¡Œ5æ­¥è¿­ä»£ï¼Œæ”¶æ•›è½¨è¿¹å¦‚ä¸‹ï¼š</p>
<table>
<thead>
<tr>
<th>$t$</th>
<th>$x_0=0.1$</th>
<th>$x_0=0.3$</th>
<th>$x_0=0.5$</th>
<th>$x_0=0.7$</th>
<th>$x_0=0.9$</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0.100</td>
<td>0.300</td>
<td>0.500</td>
<td>0.700</td>
<td>0.900</td>
</tr>
<tr>
<td>1</td>
<td>0.351</td>
<td>0.838</td>
<td>0.964</td>
<td>0.992</td>
<td>0.998</td>
</tr>
<tr>
<td>2</td>
<td>0.911</td>
<td>0.995</td>
<td>0.999</td>
<td>1.000</td>
<td>1.000</td>
</tr>
<tr>
<td>3</td>
<td>0.998</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
</tr>
<tr>
<td>4</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
</tr>
<tr>
<td>5</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
<td>1.000</td>
</tr>
</tbody>
</table>
<p><strong>è§‚å¯Ÿ</strong>ï¼š
1. æ‰€æœ‰åˆå€¼åœ¨5æ­¥å†…éƒ½æ”¶æ•›åˆ°1ï¼ˆè¯¯å·®$&lt; 10^{-3}$ï¼‰
2. è¾ƒå¤§çš„åˆå€¼ï¼ˆ$\geq 0.5$ï¼‰åœ¨2-3æ­¥å†…å°±æ”¶æ•›
3. è¾ƒå°çš„åˆå€¼ï¼ˆ$0.1$ï¼‰éœ€è¦4æ­¥æ‰èƒ½å……åˆ†æ”¶æ•›
4. ç¬¬ä¸€æ­¥çš„å¢é•¿æœ€æ˜¾è‘—ï¼Œç‰¹åˆ«æ˜¯å¯¹å°å¥‡å¼‚å€¼</p>
<h3 id="9">9. ç®—æ³•å¤æ‚åº¦åˆ†æ</h3>
<h4 id="91">9.1 æ¯æ­¥è¿­ä»£çš„è®¡ç®—æˆæœ¬</h4>
<p>å¯¹äºçŸ©é˜µ$\boldsymbol{M} \in \mathbb{R}^{n \times m}$ï¼ˆå‡è®¾$n \geq m$ï¼‰ï¼Œä¸€æ­¥Newton-Schulzè¿­ä»£éœ€è¦è®¡ç®—ï¼š
\begin{equation}
\boldsymbol{X}_{t+1} = a\boldsymbol{X}_t + b\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t) + c\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2
\tag{101}\end{equation}</p>
<p><strong>çŸ©é˜µä¹˜æ³•æ¬¡æ•°</strong>ï¼š
1. è®¡ç®—$\boldsymbol{X}_t^{\top}\boldsymbol{X}_t$ï¼š$O(nm^2)$ï¼ˆ$m \times n$ çŸ©é˜µä¹˜ä»¥ $n \times m$ çŸ©é˜µå¾—åˆ° $m \times m$ï¼‰
2. è®¡ç®—$(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2$ï¼š$O(m^3)$ï¼ˆ$m \times m$ çŸ©é˜µå¹³æ–¹ï¼‰
3. è®¡ç®—$\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)$ï¼š$O(nm^2)$ï¼ˆ$n \times m$ çŸ©é˜µä¹˜ä»¥ $m \times m$ çŸ©é˜µï¼‰
4. è®¡ç®—$\boldsymbol{X}_t(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2$ï¼š$O(nm^2)$ï¼ˆåŒä¸Šï¼‰</p>
<p><strong>æ€»å¤æ‚åº¦</strong>ï¼šæ¯æ­¥è¿­ä»£çš„å¤æ‚åº¦ä¸ºï¼š
\begin{equation}
O(nm^2 + m^3) = O(nm^2) \qquad (\text{å½“ } n \geq m)
\tag{102}\end{equation}</p>
<p><strong>$T$æ­¥è¿­ä»£çš„æ€»å¤æ‚åº¦</strong>ï¼š
\begin{equation}
O(Tnm^2)
\tag{103}\end{equation}</p>
<h4 id="92-svd">9.2 ä¸SVDçš„æ¯”è¾ƒ</h4>
<p><strong>ç²¾ç¡®SVDçš„å¤æ‚åº¦</strong>ï¼šå¯¹äº$n \times m$çŸ©é˜µï¼ˆ$n \geq m$ï¼‰ï¼Œç²¾ç¡®SVDçš„å¤æ‚åº¦ä¸ºï¼š
\begin{equation}
O(nm^2 + m^3) = O(nm^2)
\tag{104}\end{equation}</p>
<p>è¿™çœ‹èµ·æ¥ä¸ä¸€æ­¥Newton-Schulzè¿­ä»£ç›¸åŒï¼Œä½†å®é™…ä¸ŠSVDçš„å¸¸æ•°å› å­æ›´å¤§ï¼Œå¹¶ä¸”SVDç®—æ³•æ›´å¤æ‚ã€‚</p>
<p><strong>å®è·µä¸­çš„ä¼˜åŠ¿</strong>ï¼š
1. Newton-Schulzè¿­ä»£å¯ä»¥åœ¨$T=5$æ­¥å·¦å³è¾¾åˆ°è¶³å¤Ÿç²¾åº¦ï¼Œæ€»å¤æ‚åº¦çº¦ä¸º$5nm^2$
2. SVDéœ€è¦å®Œæ•´çš„åˆ†è§£è¿‡ç¨‹ï¼Œå®é™…è¿è¡Œæ—¶é—´é€šå¸¸æ˜¯Newton-Schulzçš„2-5å€
3. Newton-Schulzè¿­ä»£æ›´å®¹æ˜“å¹¶è¡ŒåŒ–å’Œç¡¬ä»¶åŠ é€Ÿï¼ˆåªæ¶‰åŠçŸ©é˜µä¹˜æ³•ï¼‰</p>
<h4 id="93">9.3 å†…å­˜æ¶ˆè€—</h4>
<p><strong>Newton-Schulzè¿­ä»£</strong>ï¼šéœ€è¦å­˜å‚¨$\boldsymbol{X}_t$ï¼ˆ$n \times m$ï¼‰å’Œä¸´æ—¶çŸ©é˜µ$\boldsymbol{X}_t^{\top}\boldsymbol{X}_t$ï¼ˆ$m \times m$ï¼‰ï¼Œæ€»å†…å­˜ï¼š
\begin{equation}
O(nm + m^2) = O(nm)
\tag{105}\end{equation}</p>
<p><strong>SVD</strong>ï¼šéœ€è¦å­˜å‚¨$\boldsymbol{U}$ï¼ˆ$n \times m$ï¼‰ã€$\boldsymbol{\Sigma}$ï¼ˆ$m$ï¼‰ã€$\boldsymbol{V}$ï¼ˆ$m \times m$ï¼‰ï¼Œæ€»å†…å­˜ï¼š
\begin{equation}
O(nm + m^2) = O(nm)
\tag{106}\end{equation}</p>
<p>ä¸¤è€…å†…å­˜æ¶ˆè€—ç›¸å½“ã€‚</p>
<h3 id="10">10. ä¸å…¶ä»–è¿­ä»£æ–¹æ³•çš„æ¯”è¾ƒ</h3>
<h4 id="101-newton">10.1 æ ‡å‡†Newtonè¿­ä»£</h4>
<p>æ ‡å‡†Newtonè¿­ä»£æ±‚è§£$\boldsymbol{X}\boldsymbol{X}^{\top} = \boldsymbol{I}$ï¼š
\begin{equation}
\boldsymbol{X}_{t+1} = \frac{1}{2}\boldsymbol{X}_t(3\boldsymbol{I} - \boldsymbol{X}_t^{\top}\boldsymbol{X}_t)
\tag{107}\end{equation}</p>
<p>è¿™å¯¹åº”$(a,b,c) = (3/2, -1/2, 0)$ï¼Œæ˜¯äºŒé˜¶æ”¶æ•›çš„ã€‚</p>
<p><strong>ä¸ä¼˜åŒ–çš„Newton-Schulzçš„æ¯”è¾ƒ</strong>ï¼š
- æ ‡å‡†Newtonè¿­ä»£åªä½¿ç”¨åˆ°$x^3$é¡¹ï¼Œè€Œä¼˜åŒ–çš„Newton-Schulzä½¿ç”¨åˆ°$x^5$é¡¹
- ä¼˜åŒ–åçš„ç³»æ•°èƒ½å¤Ÿæ›´å¥½åœ°å¤„ç†å°å¥‡å¼‚å€¼ï¼ˆå¢é•¿å€ç‡æ›´å¤§ï¼‰
- å®éªŒæ˜¾ç¤ºï¼Œä¼˜åŒ–çš„5æ­¥Newton-Schulzå¯ä»¥è¾¾åˆ°æ ‡å‡†æ–¹æ³•7-8æ­¥çš„æ•ˆæœ</p>
<h4 id="102-pade">10.2 PadÃ©é€¼è¿‘</h4>
<p>å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨PadÃ©é€¼è¿‘æ¥é€¼è¿‘$(\boldsymbol{I} - \boldsymbol{E})^{-1/2}$ã€‚$(m,n)$é˜¶PadÃ©é€¼è¿‘æ˜¯ä¸€ä¸ªæœ‰ç†å‡½æ•°ï¼š
\begin{equation}
R_{m,n}(\boldsymbol{E}) = \frac{P_m(\boldsymbol{E})}{Q_n(\boldsymbol{E})}
\tag{108}\end{equation}</p>
<p>å…¶ä¸­$P_m, Q_n$æ˜¯$m$æ¬¡å’Œ$n$æ¬¡å¤šé¡¹å¼ã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼šPadÃ©é€¼è¿‘åœ¨æŸäº›æƒ…å†µä¸‹æ”¶æ•›æ›´å¿«</p>
<p><strong>åŠ£åŠ¿</strong>ï¼šéœ€è¦æ±‚è§£çŸ©é˜µæ–¹ç¨‹$Q_n(\boldsymbol{E})\boldsymbol{Y} = P_m(\boldsymbol{E})$ï¼Œè®¡ç®—æˆæœ¬æ›´é«˜</p>
<h4 id="103-halley">10.3 Halleyè¿­ä»£</h4>
<p>Halleyè¿­ä»£æ˜¯ä¸‰é˜¶æ”¶æ•›çš„è¿­ä»£æ–¹æ³•ï¼š
\begin{equation}
\boldsymbol{X}_{t+1} = \boldsymbol{X}_t\left(\frac{1}{8}(15\boldsymbol{I} - 10\boldsymbol{X}_t^{\top}\boldsymbol{X}_t + 3(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2)\right)
\tag{109}\end{equation}</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼šæ”¶æ•›é€Ÿåº¦æ›´å¿«ï¼ˆä¸‰é˜¶ï¼‰</p>
<p><strong>åŠ£åŠ¿</strong>ï¼šæ¯æ­¥éœ€è¦è®¡ç®—$(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^2$ï¼Œè®¡ç®—æˆæœ¬ä¸Newton-Schulzç›¸å½“ï¼Œä½†ç³»æ•°å›ºå®šï¼Œæ— æ³•é’ˆå¯¹ç‰¹å®šåˆ†å¸ƒä¼˜åŒ–</p>
<h3 id="11">11. å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘</h3>
<h4 id="111">11.1 ç†è®ºæœ€ä¼˜ç³»æ•°</h4>
<p><strong>é—®é¢˜</strong>ï¼šå¯¹äºç»™å®šçš„è¿­ä»£æ­¥æ•°$T$å’Œå¥‡å¼‚å€¼åˆ†å¸ƒï¼Œæ˜¯å¦å­˜åœ¨ç†è®ºä¸Šçš„æœ€ä¼˜ç³»æ•°$(a_0,b_0,c_0,\ldots,a_{T-1},b_{T-1},c_{T-1})$ï¼Ÿ</p>
<p><strong>æŒ‘æˆ˜</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªé«˜åº¦éå‡¸çš„ä¼˜åŒ–é—®é¢˜ï¼Œå¯èƒ½æœ‰å¤šä¸ªå±€éƒ¨æœ€ä¼˜è§£ã€‚ç›®å‰çš„æ•°å€¼ä¼˜åŒ–æ–¹æ³•åªèƒ½æ‰¾åˆ°å±€éƒ¨æœ€ä¼˜ã€‚</p>
<h4 id="112">11.2 æ›´é«˜æ¬¡é¡¹çš„æƒè¡¡</h4>
<p><strong>é—®é¢˜</strong>ï¼šæ˜¯å¦åº”è¯¥ä½¿ç”¨$x^7, x^9$ç­‰æ›´é«˜æ¬¡é¡¹ï¼Ÿ</p>
<p><strong>åˆ†æ</strong>ï¼šæ›´é«˜æ¬¡é¡¹ç†è®ºä¸Šå¯ä»¥æä¾›æ›´å¥½çš„é€¼è¿‘ï¼Œä½†ä¹Ÿå¢åŠ äº†è®¡ç®—æˆæœ¬ã€‚å¯¹äº$(a,b,c,d,e)$å¯¹åº”$ax + bx^3 + cx^5 + dx^7 + ex^9$ï¼Œæ¯æ­¥éœ€è¦è®¡ç®—$(\boldsymbol{X}_t^{\top}\boldsymbol{X}_t)^4$ï¼Œå¤æ‚åº¦æ˜¾è‘—å¢åŠ ã€‚</p>
<p>åˆæ­¥å®éªŒè¡¨æ˜ï¼Œäº”æ¬¡é¡¹($x^5$)å·²ç»æä¾›äº†å¾ˆå¥½çš„æ€§ä»·æ¯”ï¼Œæ›´é«˜æ¬¡é¡¹çš„æ”¶ç›Šé€’å‡ã€‚</p>
<h4 id="113">11.3 è‡ªé€‚åº”è¿­ä»£æ­¥æ•°</h4>
<p><strong>é—®é¢˜</strong>ï¼šèƒ½å¦æ ¹æ®çŸ©é˜µçš„æ¡ä»¶æ•°æˆ–å¥‡å¼‚å€¼åˆ†å¸ƒï¼Œè‡ªé€‚åº”åœ°é€‰æ‹©è¿­ä»£æ­¥æ•°$T$ï¼Ÿ</p>
<p><strong>æ€è·¯</strong>ï¼šåœ¨æ¯æ­¥è¿­ä»£åï¼Œæ£€æŸ¥$\Vert\boldsymbol{X}_t^{\top}\boldsymbol{X}_t - \boldsymbol{I}\Vert_F$ï¼Œå¦‚æœè¶³å¤Ÿå°åˆ™æå‰ç»ˆæ­¢ã€‚ä½†è¿™å¢åŠ äº†è®¡ç®—å¼€é”€ï¼ˆéœ€è¦é¢å¤–çš„çŸ©é˜µä¹˜æ³•å’ŒèŒƒæ•°è®¡ç®—ï¼‰ã€‚</p>
<p><strong>å®è·µå»ºè®®</strong>ï¼šå¯¹äºMuonä¼˜åŒ–å™¨ç­‰åº”ç”¨ï¼Œå›ºå®š$T=5$æˆ–$T=6$å·²ç»è¶³å¤Ÿï¼Œè‡ªé€‚åº”æ–¹æ¡ˆçš„é¢å¤–æ”¶ç›Šæœ‰é™ã€‚</p>
<hr />
<p><strong>å°ç»“</strong>ï¼šæœ¬èŠ‚è¯¦ç»†æ¨å¯¼äº†Newton-Schulzè¿­ä»£çš„æ•°å­¦åŸç†ï¼ŒåŒ…æ‹¬è¿­ä»£å…¬å¼çš„æ¨å¯¼ï¼ˆä»çŸ©é˜µå¹³æ–¹æ ¹çš„å¹‚çº§æ•°å±•å¼€ï¼‰ã€æ”¶æ•›æ€§åˆ†æï¼ˆä¸åŠ¨ç‚¹ã€ç¨³å®šæ€§ã€æ”¶æ•›é€Ÿåº¦ï¼‰ã€ç³»æ•°ä¼˜åŒ–ï¼ˆminimaxé—®é¢˜ã€Adamæ±‚è§£ï¼‰ã€å½’ä¸€åŒ–æ–¹æ³•çš„æ¯”è¾ƒï¼ˆFrobeniusèŒƒæ•° vs è°±èŒƒæ•° vs é«˜é˜¶èŒƒæ•°ï¼‰ã€è¯¯å·®åˆ†æï¼ˆç†è®ºè¯¯å·®ç•Œã€èˆå…¥è¯¯å·®ã€æ¡ä»¶æ•°å½±å“ï¼‰ã€ä»¥åŠä¸å…¶ä»–æ–¹æ³•çš„æ¯”è¾ƒã€‚è¿™äº›æ¨å¯¼ä¸ºç†è§£å’Œæ”¹è¿›$\msign$ç®—å­çš„è®¡ç®—æä¾›äº†åšå®çš„æ•°å­¦åŸºç¡€ã€‚</p>
        </div>
    </div>
</body>
</html>