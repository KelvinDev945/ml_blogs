<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸æˆåŠŸçš„å°è¯•ï¼šå°†å¤šæ ‡ç­¾äº¤å‰ç†µæ¨å¹¿åˆ°â€œnä¸ªmåˆ†ç±»â€ä¸Šå»</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ä¸æˆåŠŸçš„å°è¯•ï¼šå°†å¤šæ ‡ç­¾äº¤å‰ç†µæ¨å¹¿åˆ°â€œnä¸ªmåˆ†ç±»â€ä¸Šå»</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 24.3 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9158">https://spaces.ac.cn/archives/9158</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å¯èƒ½æœ‰è¯»è€…ç•™æ„åˆ°ï¼Œè¿™æ¬¡æ›´æ–°ç›¸å¯¹æ¥è¯´éš”å¾—æ¯”è¾ƒä¹…äº†ã€‚äº‹å®ä¸Šï¼Œåœ¨ä¸Šå‘¨æœ«æ—¶å°±å¼€å§‹å‡†å¤‡è¿™ç¯‡æ–‡ç« äº†ï¼Œç„¶è€Œç¬”è€…ä½ä¼°äº†è¿™ä¸ªé—®é¢˜çš„éš¾åº¦ï¼Œå‡ ä¹æ¨å¯¼äº†æ•´æ•´ä¸€å‘¨ï¼Œä»ç„¶è¿˜æ²¡å¾—åˆ°ä¸€ä¸ªå®Œå–„çš„ç»“æœå‡ºæ¥ã€‚ç›®å‰å‘å‡ºæ¥çš„ï¼Œä»ç„¶åªæ˜¯ä¸€ä¸ªå¤±è´¥çš„ç»“æœï¼Œå¸Œæœ›æœ‰ç»éªŒçš„è¯»è€…å¯ä»¥æŒ‡ç‚¹æŒ‡ç‚¹ã€‚</p>
<p>åœ¨æ–‡ç« <a href="/archives/7359">ã€Šå°†â€œSoftmax+äº¤å‰ç†µâ€æ¨å¹¿åˆ°å¤šæ ‡ç­¾åˆ†ç±»é—®é¢˜ã€‹</a>ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†ä¸€ä¸ªå¤šæ ‡ç­¾åˆ†ç±»æŸå¤±å‡½æ•°ï¼Œå®ƒèƒ½è‡ªåŠ¨è°ƒèŠ‚æ­£è´Ÿç±»çš„ä¸å¹³è¡¡é—®é¢˜ï¼Œåæ¥åœ¨<a href="/archives/9064">ã€Šå¤šæ ‡ç­¾â€œSoftmax+äº¤å‰ç†µâ€çš„è½¯æ ‡ç­¾ç‰ˆæœ¬ã€‹</a>ä¸­æˆ‘ä»¬è¿˜è¿›ä¸€æ­¥å¾—åˆ°äº†å®ƒçš„â€œè½¯æ ‡ç­¾â€ç‰ˆæœ¬ã€‚æœ¬è´¨ä¸Šæ¥è¯´ï¼Œå¤šæ ‡ç­¾åˆ†ç±»å°±æ˜¯â€œ$n$ä¸ª2åˆ†ç±»â€é—®é¢˜ï¼Œé‚£ä¹ˆç›¸åº”çš„ï¼Œâ€œ$n$ä¸ª$m$åˆ†ç±»â€çš„æŸå¤±å‡½æ•°åˆè¯¥æ˜¯æ€æ ·çš„å‘¢ï¼Ÿ</p>
<p>è¿™å°±æ˜¯æœ¬æ–‡æ‰€è¦æ¢è®¨çš„é—®é¢˜ã€‚</p>
<h2 id="_1">ç±»æ¯”å°è¯•</h2>
<p>åœ¨è½¯æ ‡ç­¾æ¨å¹¿çš„æ–‡ç« <a href="/archives/9064">ã€Šå¤šæ ‡ç­¾â€œSoftmax+äº¤å‰ç†µâ€çš„è½¯æ ‡ç­¾ç‰ˆæœ¬ã€‹</a>ä¸­ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡ç›´æ¥å°†â€œ$n$ä¸ª2åˆ†ç±»â€çš„sigmoidäº¤å‰ç†µæŸå¤±ï¼Œåœ¨$\log$å†…åšä¸€é˜¶æˆªæ–­æ¥å¾—åˆ°æœ€ç»ˆç»“æœçš„ã€‚åŒæ ·çš„è¿‡ç¨‹ç¡®å®ä¹Ÿå¯ä»¥æ¨å¹¿åˆ°â€œ$n$ä¸ª$m$åˆ†ç±»â€çš„softmaxäº¤å‰ç†µæŸå¤±ï¼Œè¿™æ˜¯ç¬”è€…çš„ç¬¬ä¸€æ¬¡å°è¯•ã€‚</p>
<p>è®°$\text{softmax}(s_{i,j}) = \frac{e^{s_{i,j}}}{\sum\limits_j e^{s_{i,j}}}$ï¼Œ$s_{i,j}$ä¸ºé¢„æµ‹ç»“æœï¼Œè€Œ$t_{i,j}$åˆ™ä¸ºæ ‡ç­¾ï¼Œé‚£ä¹ˆ<br />
\begin{equation}\begin{aligned}-\sum_i\sum_j t_{i,j}\log \text{softmax}(s_{i,j}) =&amp;\,\sum_i\sum_j t_{i,j}\log \left(1 + \sum_{k\neq j} e^{s_{i,k} - s_{i,j}}\right)\\\<br />
=&amp;\,\sum_j \log \prod_i\left(1 + \sum_{k\neq j} e^{s_{i,k} - s_{i,j}}\right)^{t_{i,j}}\\\<br />
=&amp;\,\sum_j \log \left(1 + \sum_i t_{i,j}\sum_{k\neq j} e^{s_{i,k} - s_{i,j}}+\cdots\right)\\\<br />
\end{aligned}\end{equation}<br />
å¯¹$i$çš„æ±‚å’Œé»˜è®¤æ˜¯$1\sim n$ï¼Œå¯¹$j$çš„æ±‚å’Œé»˜è®¤æ˜¯$1\sim m$ã€‚æˆªæ–­$\cdots$çš„é«˜é˜¶é¡¹ï¼Œå¾—åˆ°<br />
\begin{equation}l = \sum_j \log \left(1 + \sum_{i,k\neq j} t_{i,j}e^{- s_{i,j} + s_{i,k}}\right)\label{eq:loss-1}\end{equation}<br />
è¿™å°±æ˜¯ç¬”è€…å¼€å§‹å¾—åˆ°çš„lossï¼Œå®ƒæ˜¯ä¹‹å‰çš„ç»“æœåˆ°â€œ$n$ä¸ª$m$åˆ†ç±»â€çš„è‡ªç„¶æ¨å¹¿ã€‚äº‹å®ä¸Šï¼Œå¦‚æœ$t_{i,j}$æ˜¯ç¡¬æ ‡ç­¾ï¼Œé‚£ä¹ˆè¯¥lossåŸºæœ¬ä¸Šæ²¡ä»€ä¹ˆé—®é¢˜ã€‚ä½†ç¬”è€…å¸Œæœ›å®ƒåƒ<a href="/archives/9064">ã€Šå¤šæ ‡ç­¾â€œSoftmax+äº¤å‰ç†µâ€çš„è½¯æ ‡ç­¾ç‰ˆæœ¬ã€‹</a>ä¸€æ ·ï¼Œå¯¹äºè½¯æ ‡ç­¾ä¹Ÿèƒ½å¾—åˆ°æ¨å¯¼å‡ºç›¸åº”çš„è§£æè§£ã€‚ä¸ºæ­¤ï¼Œç¬”è€…å¯¹å®ƒè¿›è¡Œæ±‚å¯¼ï¼š<br />
\begin{equation}\frac{\partial l}{\partial s_{i,j}} = \frac{- t_{i,j}e^{- s_{i,j}}\sum\limits_{k\neq j} e^{s_{i,k}}}{1 + \sum\limits_{i,k\neq j} t_{i,j}e^{- s_{i,j} + s_{i,k}}} + \sum_{h\neq j} \frac{t_{i,h}e^{- s_{i,h}}e^{s_{i,j}}}{1 + \sum\limits_{i,k\neq h} t_{i,h}e^{- s_{i,h} + s_{i,k}}}\end{equation}<br />
æ‰€è°“è§£æè§£ï¼Œå°±æ˜¯é€šè¿‡æ–¹ç¨‹$\frac{\partial l}{\partial s_{i,j}}=0$æ¥è§£å‡ºã€‚ç„¶è€Œç¬”è€…å°è¯•äº†å¥½å‡ å¤©ï¼Œéƒ½æ±‚ä¸å‡ºæ–¹ç¨‹çš„è§£ï¼Œä¼°è®¡å¹¶æ²¡æœ‰ç®€å•çš„æ˜¾å¼è§£ï¼Œå› æ­¤ï¼Œç¬¬ä¸€æ¬¡å°è¯•å¤±è´¥ã€‚</p>
<h2 id="_2">ç»“æœå€’æ¨</h2>
<p>å°è¯•äº†å‡ å¤©å®åœ¨æ²¡åŠæ³•åï¼Œç¬”è€…åˆåè¿‡æ¥æƒ³ï¼šæ—¢ç„¶ç›´æ¥ç±»æ¯”å‡ºæ¥çš„ç»“æœæ— æ³•æ±‚è§£ï¼Œé‚£ä¹ˆæˆ‘å¹²è„†ä»ç»“æœå€’æ¨å¥½äº†ï¼Œå³å…ˆæŠŠè§£ç¡®å®šï¼Œç„¶åå†åæ¨æ–¹ç¨‹åº”è¯¥æ˜¯æ€æ ·çš„ã€‚äºæ˜¯ï¼Œç¬”è€…å¼€å§‹äº†ç¬¬äºŒæ¬¡å°è¯•ã€‚</p>
<p>é¦–å…ˆï¼Œè§‚å¯Ÿå‘ç°åŸæ¥çš„å¤šæ ‡ç­¾æŸå¤±ï¼Œæˆ–è€…å‰é¢å¾—åˆ°çš„æŸå¤±$\eqref{eq:loss-1}$ï¼Œéƒ½å…·æœ‰å¦‚ä¸‹çš„å½¢å¼ï¼š<br />
\begin{equation}l = \sum_j \log \left(1 + \sum_i t_{i,j}e^{- f(s_{i,j})}\right)\label{eq:loss-2}\end{equation}<br />
æˆ‘ä»¬å°±ä»¥è¿™ä¸ªå½¢å¼ä¸ºå‡ºå‘ç‚¹ï¼Œæ±‚å¯¼<br />
\begin{equation}\frac{\partial l}{\partial s_{i,k}} = \sum_j \frac{- t_{i,j}e^{- f(s_{i,j})}\frac{\partial f(s_{i,j})}{\partial s_{i,k}}}{1 + \sum\limits_i t_{i,j}e^{- f(s_{i,j})}}\end{equation}<br />
æˆ‘ä»¬å¸Œæœ›$t_{i,j}=\text{softmax}(f(s_{i,j}))=e^{f(s_{i,j})}/Z_i$å°±æ˜¯$\frac{\partial l}{\partial s_{i,k}}=0$çš„è§£æè§£ï¼Œå…¶ä¸­$Z_i=\sum\limits_j e^{f(s_{i,j})}$ã€‚é‚£ä¹ˆä»£å…¥å¾—åˆ°<br />
\begin{equation}0=\frac{\partial l}{\partial s_{i,k}} = \sum_j \frac{- (1/Z_i)\frac{\partial f(s_{i,j})}{\partial s_{i,k}}}{1 + \sum\limits_i 1/Z_i} = \frac{- (1/Z_i)\frac{\partial \left(\sum\limits_j f(s_{i,j})\right)}{\partial s_{i,k}}}{1 + \sum\limits_i 1/Z_i}\end{equation}<br />
æ‰€ä»¥è¦è®©ä¸Šå¼è‡ªç„¶æˆç«‹ï¼Œæˆ‘ä»¬å‘ç°åªéœ€è¦è®©$\sum\limits_j f(s_{i,j})$ç­‰äºä¸€ä¸ªè·Ÿ$i,j$éƒ½æ— å…³çš„å¸¸æ•°ã€‚ç®€å•èµ·è§ï¼Œæˆ‘ä»¬è®©<br />
\begin{equation}f(s_{i,j})=s_{i,j}-<br />
\bar{s}<em i_j="i,j">i,\qquad \bar{s}_i=\frac{1}{m}\sum_j s</em>}\end{equation<br />
è¿™æ ·è‡ªç„¶åœ°æœ‰$\sum\limits_j f(s_{i,j})=0$ï¼Œå¯¹åº”çš„ä¼˜åŒ–ç›®æ ‡å°±æ˜¯<br />
\begin{equation}l = \sum_j \log \left(1 + \sum_i t_{i,j}e^{- s_{i,j} + \bar{s}<em i_j="i,j">i}\right)\label{eq:loss-3}\end{equation}<br />
$\bar{s}_i$ä¸å½±å“å½’ä¸€åŒ–ç»“æœï¼Œæ‰€ä»¥å®ƒçš„ç†è®ºæœ€ä¼˜è§£æ˜¯$t</em>)$ã€‚}=\text{softmax}(s_{i,j</p>
<p>ç„¶è€Œï¼Œçœ‹ä¸Šå»å¾ˆç¾å¥½ï¼Œç„¶è€Œå®ƒå®é™…ä¸Šçš„æ•ˆæœä¼šæ¯”è¾ƒç³Ÿç³•ï¼Œ$t_{i,j}=\text{softmax}(s_{i,j})$ç¡®å®æ˜¯ç†è®ºæœ€ä¼˜è§£ï¼Œä½†å®é™…ä¸Šæ ‡ç­¾è¶Šæ¥è¿‘ç¡¬æ ‡ç­¾ï¼Œå®ƒçš„æ•ˆæœä¼šè¶Šå·®ã€‚å› ä¸ºæˆ‘ä»¬çŸ¥é“å¯¹äºæŸå¤±$\eqref{eq:loss-3}$æ¥è¯´ï¼Œåªè¦$s_{i,j} \gg \bar{s}<em i_j="i,j">i$ï¼ŒæŸå¤±å°±ä¼šå¾ˆæ¥è¿‘äº0ï¼Œè€Œè¦è¾¾åˆ°$s</em>} \gg \bar{s<em i_j="i,j">i$ï¼Œ$s</em>$ä¸­çš„æœ€å¤§è€…ï¼Œè¿™å°±æ— æ³•å®ç°åˆ†ç±»ç›®æ ‡äº†ã€‚}$ä¸ä¸€å®šæ˜¯$s_{i,1},s_{i,2},\cdots,s_{i,m</p>
<h2 id="_3">æ€è€ƒåˆ†æ</h2>
<p>ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†ä¸¤ä¸ªç»“æœï¼Œå¼$\eqref{eq:loss-1}$æ˜¯åŸæ¥å¤šæ ‡ç­¾äº¤å‰ç†µçš„ç±»æ¯”æ¨å¹¿ï¼Œå®ƒåœ¨ç¡¬æ ‡ç­¾çš„æƒ…å†µä¸‹æ•ˆæœè¿˜æ˜¯ä¸é”™çš„ï¼Œä½†æ˜¯ç”±äºæ±‚ä¸å‡ºè½¯æ ‡ç­¾æƒ…å†µä¸‹çš„è§£æè§£ï¼Œå› æ­¤è½¯æ ‡ç­¾çš„æƒ…å†µæ— æ³•åšç†è®ºè¯„ä¼°ï¼›å¼$\eqref{eq:loss-3}$æ˜¯ä»ç»“æœç†è®ºå€’æ¨å‡ºæ¥çš„ï¼Œç†è®ºä¸Šå®ƒçš„è§£æè§£å°±æ˜¯ç®€å•çš„softmaxï¼Œä½†ç”±äºå®é™…ä¼˜åŒ–ç®—æ³•çš„é™åˆ¶ï¼Œç¡¬æ ‡ç­¾çš„è¡¨ç°é€šå¸¸å¾ˆå·®ï¼Œç”šè‡³æ— æ³•ä¿è¯ç›®æ ‡logitsæ˜¯æœ€å¤§å€¼ã€‚ç‰¹åˆ«åœ°ï¼Œå½“$m=2$æ—¶ï¼Œå¼$\eqref{eq:loss-1}$å’Œå¼$\eqref{eq:loss-3}$éƒ½èƒ½é€€åŒ–ä¸ºå¤šæ ‡ç­¾äº¤å‰ç†µã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¤šæ ‡ç­¾äº¤å‰ç†µèƒ½å¤Ÿè‡ªåŠ¨è°ƒèŠ‚æ­£è´Ÿæ ·æœ¬ä¸å¹³è¡¡çš„é—®é¢˜ï¼ŒåŒæ ·åœ°ï¼Œè™½ç„¶æˆ‘ä»¬ç›®å‰è¿˜æ²¡èƒ½å¾—åˆ°ä¸€ä¸ªå®Œç¾çš„æ¨å¹¿ï¼Œä½†ç†è®ºä¸Šæ¨å¹¿åˆ°â€œ$n$ä¸ª$m$åˆ†ç±»â€åä¾ç„¶èƒ½å¤Ÿè‡ªåŠ¨è°ƒèŠ‚$m$ä¸ªç±»çš„ä¸å¹³è¡¡é—®é¢˜ã€‚é‚£ä¹ˆå¹³è¡¡çš„æœºåˆ¶æ˜¯æ€æ ·çš„å‘¢ï¼Ÿå…¶å®ä¸éš¾ç†è§£ï¼Œä¸ç®¡æ˜¯ç±»æ¯”æ¨å¹¿çš„å¼$\eqref{eq:loss-1}$ï¼Œè¿˜æ˜¯ä¸€èˆ¬çš„å‡è®¾å¼$\eqref{eq:loss-2}$ï¼Œå¯¹$i$çš„æ±‚å’Œéƒ½æ”¾åœ¨äº†$\log$é‡Œè¾¹ï¼ŒåŸæœ¬æ¯ä¸ªç±»çš„æŸå¤±å æ¯”å¤§ä½“ä¸Šæ˜¯æ­£æ¯”äºâ€œ <em>è¯¥ç±»çš„æ ·æœ¬æ•°</em> â€çš„ï¼Œæ”¹ä¸ºæ”¾åœ¨äº†$\log$é‡Œè¾¹æ±‚å’Œåï¼Œæ¯ä¸ªç±»çš„æŸå¤±å å°±å¤§è‡´ç­‰äºâ€œ <em>è¯¥ç±»çš„æ ·æœ¬æ•°çš„ å¯¹æ•°</em>â€ï¼Œä»è€Œç¼©å°äº†æ¯ä¸ªç±»çš„æŸå¤±å·®è·ï¼Œè‡ªåŠ¨ç¼“è§£äº†ä¸å¹³è¡¡é—®é¢˜ã€‚</p>
<p>é—æ†¾çš„æ˜¯ï¼Œæœ¬æ–‡è¿˜æ²¡æœ‰å¾—å‡ºå…³äºâ€œ$n$ä¸ª$m$åˆ†ç±»â€çš„å®Œç¾æ¨å¹¿â€”â€”å®ƒåº”è¯¥åŒ…å«ä¸¤ä¸ªç‰¹æ€§ï¼š1ã€é€šè¿‡$\log$çš„æ–¹æ³•è‡ªåŠ¨è°ƒèŠ‚ç±»åˆ«ä¸å¹³è¡¡ç°è±¡ï¼›2ã€èƒ½å¤Ÿæ±‚å‡ºè½¯æ ‡ç­¾æƒ…å†µä¸‹çš„è§£æè§£ã€‚å¯¹äºç¡¬æ ‡ç­¾æ¥è¯´ï¼Œç›´æ¥ç”¨å¼$\eqref{eq:loss-1}$åº”è¯¥æ˜¯è¶³å¤Ÿäº†ï¼›è€Œå¯¹äºè½¯æ ‡ç­¾æ¥è¯´ï¼Œç¬”è€…å®åœ¨æ˜¯æ²¡è¾™äº†ï¼Œæ¬¢è¿æœ‰å…´è¶£çš„è¯»è€…ä¸€èµ·æ€è€ƒäº¤æµã€‚</p>
<h2 id="_4">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡å°è¯•å°†ä¹‹å‰çš„å¤šæ ‡ç­¾äº¤å‰ç†µæ¨å¹¿åˆ°â€œ$n$ä¸ª$m$åˆ†ç±»â€ä¸Šå»ï¼Œé—æ†¾çš„æ˜¯ï¼Œè¿™ä¸€æ¬¡çš„æ¨å¹¿å¹¶ä¸ç®—æˆåŠŸï¼Œæš‚ä¸”å°†ç»“æœåˆ†äº«åœ¨æ­¤ï¼Œå¸Œæœ›æœ‰å…´è¶£çš„è¯»è€…èƒ½ä¸€èµ·å‚ä¸æ”¹è¿›ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9158">https://spaces.ac.cn/archives/9158</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jul. 15, 2022). ã€Šä¸æˆåŠŸçš„å°è¯•ï¼šå°†å¤šæ ‡ç­¾äº¤å‰ç†µæ¨å¹¿åˆ°â€œnä¸ªmåˆ†ç±»â€ä¸Šå» ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9158">https://spaces.ac.cn/archives/9158</a></p>
<p>@online{kexuefm-9158,<br />
title={ä¸æˆåŠŸçš„å°è¯•ï¼šå°†å¤šæ ‡ç­¾äº¤å‰ç†µæ¨å¹¿åˆ°â€œnä¸ªmåˆ†ç±»â€ä¸Šå»},<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={Jul},<br />
url={\url{https://spaces.ac.cn/archives/9158}},<br />
} </p>
<hr />
<h2 id="_5">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">1. é—®é¢˜èƒŒæ™¯ä¸åŠ¨æœº</h3>
<p><strong>é—®é¢˜1.1 (å¤šæ ‡ç­¾åˆ†ç±»å›é¡¾)</strong></p>
<p>å¤šæ ‡ç­¾åˆ†ç±»æœ¬è´¨ä¸Šæ˜¯$n$ä¸ªäºŒåˆ†ç±»é—®é¢˜ã€‚å¯¹äºæ ·æœ¬$x$ï¼Œæˆ‘ä»¬éœ€è¦é¢„æµ‹$n$ä¸ªæ ‡ç­¾${y_1, \ldots, y_n}$ï¼Œæ¯ä¸ª$y_i \in {0, 1}$ã€‚</p>
<p><strong>æ ‡å‡†æ–¹æ³•</strong>: ä½¿ç”¨$n$ä¸ªç‹¬ç«‹çš„sigmoidäºŒåˆ†ç±»ï¼š
\begin{equation}
L_{binary} = -\sum_{i=1}^n \left[y_i\log\sigma(s_i) + (1-y_i)\log(1-\sigma(s_i))\right]
\tag{1}
\end{equation}</p>
<p>å…¶ä¸­$s_i$æ˜¯ç¬¬$i$ä¸ªç±»åˆ«çš„logitï¼Œ$\sigma(x) = 1/(1+e^{-x})$ã€‚</p>
<p><strong>é—®é¢˜</strong>: å½“æ­£è´Ÿæ ·æœ¬ä¸¥é‡ä¸å¹³è¡¡æ—¶ï¼ˆä¾‹å¦‚$n=1000$ï¼Œä½†åªæœ‰3ä¸ªæ­£ç±»ï¼‰ï¼Œå¼(1)çš„è¡¨ç°ä¼šæ€¥å‰§ä¸‹é™ã€‚</p>
<p><strong>æ”¹è¿›æ–¹æ¡ˆ (å¤šæ ‡ç­¾äº¤å‰ç†µ)</strong>: åœ¨ä¹‹å‰çš„å·¥ä½œä¸­ï¼Œæˆ‘ä»¬æå‡ºï¼š
\begin{equation}
L_{multilabel} = \log\left(1 + \sum_{i \in \Omega_{neg}} e^{s_i}\right) + \log\left(1 + \sum_{j \in \Omega_{pos}} e^{-s_j}\right)
\tag{2}
\end{equation}</p>
<p>å…¶ä¸­$\Omega_{pos}$æ˜¯æ­£ç±»ç´¢å¼•é›†ï¼Œ$\Omega_{neg}$æ˜¯è´Ÿç±»ç´¢å¼•é›†ã€‚</p>
<h3 id="2-m">2. ä»äºŒåˆ†ç±»åˆ°måˆ†ç±»çš„æ¨å¹¿</h3>
<p><strong>é—®é¢˜2.1 (æ¨å¹¿ç›®æ ‡)</strong></p>
<p>ç°åœ¨è€ƒè™‘æ›´ä¸€èˆ¬çš„æƒ…å†µï¼šæœ‰$n$ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡æ˜¯$m$åˆ†ç±»é—®é¢˜ï¼ˆè€Œä¸æ˜¯äºŒåˆ†ç±»ï¼‰ã€‚è®°ï¼š
- $s_{i,j}$: ç¬¬$i$ä¸ªä»»åŠ¡ï¼ˆ$i=1,\ldots,n$ï¼‰çš„ç¬¬$j$ä¸ªç±»åˆ«ï¼ˆ$j=1,\ldots,m$ï¼‰çš„logit
- $t_{i,j}$: å¯¹åº”çš„æ ‡ç­¾ï¼ˆç¡¬æ ‡ç­¾æ—¶ä¸º0æˆ–1ï¼Œè½¯æ ‡ç­¾æ—¶ä¸º$[0,1]$åŒºé—´çš„å®æ•°ï¼‰</p>
<p><strong>ç›®æ ‡</strong>: è®¾è®¡ä¸€ä¸ªæŸå¤±å‡½æ•°ï¼Œä½¿å¾—ï¼š
1. å…·æœ‰ç±»åˆ«ä¸å¹³è¡¡è‡ªåŠ¨è°ƒèŠ‚èƒ½åŠ›ï¼ˆç±»ä¼¼å¼(2)ï¼‰
2. æ”¯æŒè½¯æ ‡ç­¾ä¼˜åŒ–
3. å­˜åœ¨è§£æè§£</p>
<h3 id="3">3. ç¬¬ä¸€æ¬¡å°è¯•ï¼šç›´æ¥ç±»æ¯”</h3>
<p><strong>æ¨å¯¼3.1 (ä»Softmaxäº¤å‰ç†µå‡ºå‘)</strong></p>
<p>æ ‡å‡†çš„$n$ä¸ª$m$åˆ†ç±»çš„softmaxäº¤å‰ç†µä¸ºï¼š
\begin{equation}
L_{softmax} = -\sum_{i=1}^n \sum_{j=1}^m t_{i,j} \log p_{i,j}
\tag{3}
\end{equation}</p>
<p>å…¶ä¸­$p_{i,j} = \text{softmax}(s_{i,j}) = \frac{e^{s_{i,j}}}{\sum_{k=1}^m e^{s_{i,k}}}$ã€‚</p>
<p><strong>å±•å¼€</strong>:
\begin{equation}
\begin{aligned}
-\sum_i \sum_j t_{i,j} \log p_{i,j} &amp;= -\sum_i \sum_j t_{i,j} \left(s_{i,j} - \log\sum_{k=1}^m e^{s_{i,k}}\right) \
&amp;= \sum_i \sum_j t_{i,j} \log\sum_{k=1}^m e^{s_{i,k}} - \sum_i \sum_j t_{i,j} s_{i,j} \
&amp;= \sum_i \log\sum_{k=1}^m e^{s_{i,k}} - \sum_i \sum_j t_{i,j} s_{i,j}
\end{aligned}
\tag{4}
\end{equation}</p>
<p>æœ€åä¸€æ­¥åˆ©ç”¨äº†$\sum_{j=1}^m t_{i,j} = 1$ï¼ˆæ¦‚ç‡å½’ä¸€åŒ–ï¼‰ã€‚</p>
<p><strong>æ”¹å†™å½¢å¼</strong>:
\begin{equation}
-\sum_i \sum_j t_{i,j} \log p_{i,j} = \sum_i \sum_j t_{i,j} \log\left(1 + \sum_{k \neq j} e^{s_{i,k} - s_{i,j}}\right)
\tag{5}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:
\begin{equation}
\begin{aligned}
\log p_{i,j}^{-1} &amp;= \log\frac{\sum_k e^{s_{i,k}}}{e^{s_{i,j}}} \
&amp;= \log\left(\frac{e^{s_{i,j}} + \sum_{k \neq j} e^{s_{i,k}}}{e^{s_{i,j}}}\right) \
&amp;= \log\left(1 + \sum_{k \neq j} e^{s_{i,k} - s_{i,j}}\right)
\end{aligned}
\tag{6}
\end{equation}</p>
<h3 id="4">4. ä¸€é˜¶æˆªæ–­è¿‘ä¼¼</h3>
<p><strong>å¼•ç†4.1 (ä¹˜ç§¯çš„å¯¹æ•°å±•å¼€)</strong></p>
<p>å¯¹äºå°é‡$\epsilon$ï¼Œæœ‰ï¼š
\begin{equation}
\log(1 + \epsilon) \approx \epsilon \quad \text{ï¼ˆä¸€é˜¶Taylorå±•å¼€ï¼‰}
\tag{7}
\end{equation}</p>
<p><strong>åº”ç”¨åˆ°å¤šä¸ªä¹˜ç§¯</strong>:
\begin{equation}
\begin{aligned}
\log \prod_{i=1}^n (1 + a_i) &amp;= \sum_{i=1}^n \log(1 + a_i) \
&amp;= \log\left(1 + \sum_i a_i + \sum_{i&lt;j} a_i a_j + \cdots\right) \
&amp;\approx \log\left(1 + \sum_i a_i\right)
\end{aligned}
\tag{8}
\end{equation}</p>
<p>æˆªæ–­é«˜é˜¶é¡¹ï¼ˆäº¤å‰é¡¹ï¼‰åå¾—åˆ°ä¸€é˜¶è¿‘ä¼¼ã€‚</p>
<p><strong>å®šç†4.1 (ç±»æ¯”æ¨å¹¿çš„æŸå¤±å‡½æ•°)</strong></p>
<p>å°†å¼(5)æ”¹å†™å¹¶åº”ç”¨ä¸€é˜¶æˆªæ–­ï¼š
\begin{equation}
\begin{aligned}
L_1 &amp;= \sum_j \log \prod_i \left(1 + \sum_{k \neq j} e^{s_{i,k} - s_{i,j}}\right)^{t_{i,j}} \
&amp;= \sum_j \log\left(1 + \sum_i t_{i,j} \sum_{k \neq j} e^{s_{i,k} - s_{i,j}} + \text{é«˜é˜¶é¡¹}\right) \
&amp;\approx \sum_j \log\left(1 + \sum_i \sum_{k \neq j} t_{i,j} e^{s_{i,k} - s_{i,j}}\right)
\end{aligned}
\tag{9}
\end{equation}</p>
<p><strong>é‡æ–°æ•´ç†</strong>:
\begin{equation}
L_1 = \sum_{j=1}^m \log\left(1 + \sum_{i=1}^n \sum_{k \neq j} t_{i,j} e^{s_{i,k} - s_{i,j}}\right)
\tag{10}
\end{equation}</p>
<h3 id="5">5. æ¢¯åº¦è®¡ç®—ä¸è§£æè§£åˆ†æ</h3>
<p><strong>å®šç†5.1 (æŸå¤±å‡½æ•°æ¢¯åº¦)</strong></p>
<p>å¯¹$s_{i,j}$æ±‚åå¯¼ï¼š
\begin{equation}
\frac{\partial L_1}{\partial s_{i,j}} = \sum_{h \neq j} \frac{t_{i,h} e^{s_{i,j} - s_{i,h}}}{1 + \sum_{i,k \neq h} t_{i,k} e^{s_{i,k} - s_{i,h}}} - \frac{t_{i,j} e^{-s_{i,j}} \sum_{k \neq j} e^{s_{i,k}}}{1 + \sum_{i,k \neq j} t_{i,k} e^{s_{i,k} - s_{i,j}}}
\tag{11}
\end{equation}</p>
<p><strong>æ¨å¯¼</strong>: æ³¨æ„$s_{i,j}$å‡ºç°åœ¨ä¸¤ä¸ªåœ°æ–¹ï¼š
1. ä½œä¸ºåˆ†å­ï¼šåœ¨ç¬¬$j$é¡¹çš„$\sum_{k \neq j} t_{i,j} e^{s_{i,k} - s_{i,j}}$ä¸­
2. ä½œä¸ºåˆ†æ¯ï¼šåœ¨æ‰€æœ‰$h \neq j$é¡¹çš„$\sum_{i,k \neq h} t_{i,k} e^{s_{i,k} - s_{i,h}}$ä¸­</p>
<p>å¯¹ç¬¬ä¸€éƒ¨åˆ†ï¼š
\begin{equation}
\frac{\partial}{\partial s_{i,j}} \log\left(1 + \sum_i \sum_{k \neq j} t_{i,k} e^{s_{i,k} - s_{i,j}}\right) = \frac{-t_{i,j} e^{-s_{i,j}} \sum_{k \neq j} e^{s_{i,k}}}{1 + \sum_{i,k \neq j} t_{i,k} e^{s_{i,k} - s_{i,j}}}
\tag{12}
\end{equation}</p>
<p>å¯¹ç¬¬äºŒéƒ¨åˆ†ï¼ˆæ‰€æœ‰$h \neq j$ï¼‰ï¼š
\begin{equation}
\sum_{h \neq j} \frac{\partial}{\partial s_{i,j}} \log\left(1 + \sum_i \sum_{k \neq h} t_{i,k} e^{s_{i,k} - s_{i,h}}\right) = \sum_{h \neq j} \frac{t_{i,h} e^{s_{i,j} - s_{i,h}}}{1 + \sum_{i,k \neq h} t_{i,k} e^{s_{i,k} - s_{i,h}}}
\tag{13}
\end{equation}</p>
<p><strong>é—®é¢˜</strong>: ä»¤$\frac{\partial L_1}{\partial s_{i,j}} = 0$å¾—åˆ°çš„æ–¹ç¨‹ç»„æå…¶å¤æ‚ï¼Œæ²¡æœ‰ç®€å•çš„è§£æè§£ã€‚</p>
<h3 id="6">6. ç¬¬äºŒæ¬¡å°è¯•ï¼šä»è§£å€’æ¨</h3>
<p><strong>ç­–ç•¥6.1</strong>: æ—¢ç„¶æ­£å‘æ¨å¯¼æ— æ³•å¾—åˆ°è§£æè§£ï¼Œæˆ‘ä»¬åå‘æ€è€ƒï¼š
1. å…ˆå‡è®¾ç†æƒ³çš„è§£çš„å½¢å¼
2. åæ¨å¯¹åº”çš„æŸå¤±å‡½æ•°
3. æ£€éªŒè¯¥æŸå¤±å‡½æ•°æ˜¯å¦åˆç†</p>
<p><strong>å‡è®¾6.1 (ç†æƒ³è§£çš„å½¢å¼)</strong></p>
<p>å‡è®¾æœ€ä¼˜è§£åº”è¯¥æ˜¯ï¼š
\begin{equation}
t_{i,j} = \text{softmax}(f(s_{i,j})) = \frac{e^{f(s_{i,j})}}{\sum_k e^{f(s_{i,k})}}
\tag{14}
\end{equation}</p>
<p>å…¶ä¸­$f: \mathbb{R} \to \mathbb{R}$æ˜¯æŸä¸ªå‡½æ•°ã€‚</p>
<p><strong>ä¸€èˆ¬æŸå¤±å½¢å¼</strong>:
\begin{equation}
L_2 = \sum_{j=1}^m \log\left(1 + \sum_{i=1}^n t_{i,j} e^{-f(s_{i,j})}\right)
\tag{15}
\end{equation}</p>
<h3 id="7">7. æ¢¯åº¦ä¸æœ€ä¼˜æ€§æ¡ä»¶</h3>
<p><strong>å®šç†7.1 (ä¸€èˆ¬å½¢å¼çš„æ¢¯åº¦)</strong></p>
<p>å¯¹å¼(15)æ±‚æ¢¯åº¦ï¼š
\begin{equation}
\frac{\partial L_2}{\partial s_{i,k}} = \sum_{j=1}^m \frac{-t_{i,j} e^{-f(s_{i,j})} \frac{\partial f(s_{i,j})}{\partial s_{i,k}}}{1 + \sum_i t_{i,j} e^{-f(s_{i,j})}}
\tag{16}
\end{equation}</p>
<p><strong>åŒ–ç®€</strong>: ä»¤$Z_j = 1 + \sum_i t_{i,j} e^{-f(s_{i,j})}$ï¼Œåˆ™ï¼š
\begin{equation}
\frac{\partial L_2}{\partial s_{i,k}} = -\sum_{j=1}^m \frac{t_{i,j} e^{-f(s_{i,j})}}{Z_j} \cdot \frac{\partial f(s_{i,j})}{\partial s_{i,k}}
\tag{17}
\end{equation}</p>
<p><strong>æœ€ä¼˜æ€§æ¡ä»¶</strong>: å¦‚æœ$t_{i,j} = \frac{e^{f(s_{i,j})}}{\sum_k e^{f(s_{i,k})}}$æ˜¯è§£ï¼Œä»£å…¥å¼(17)ï¼š
\begin{equation}
\frac{\partial L_2}{\partial s_{i,k}} = -\sum_{j=1}^m \frac{e^{f(s_{i,j})}/Z_i \cdot e^{-f(s_{i,j})}}{Z_j} \cdot \frac{\partial f(s_{i,j})}{\partial s_{i,k}}
\tag{18}
\end{equation}</p>
<p>å…¶ä¸­$Z_i = \sum_k e^{f(s_{i,k})}$ã€‚</p>
<h3 id="8-f">8. å‡½æ•°fçš„ç¡®å®š</h3>
<p><strong>è¦æ±‚</strong>: ä¸ºäº†è®©å¼(18)å¯¹æ‰€æœ‰$k$éƒ½ç­‰äº0ï¼Œæˆ‘ä»¬éœ€è¦ï¼š
\begin{equation}
\sum_{j=1}^m f(s_{i,j}) = C \quad \text{ï¼ˆä¸$i,j$æ— å…³çš„å¸¸æ•°ï¼‰}
\tag{19}
\end{equation}</p>
<p><strong>æœ€ç®€å•çš„é€‰æ‹©</strong>: ä»¤$C=0$ï¼Œå³ï¼š
\begin{equation}
\sum_{j=1}^m f(s_{i,j}) = 0
\tag{20}
\end{equation}</p>
<p><strong>è§£</strong>: å–å¹³å‡ä¸­å¿ƒåŒ–ï¼š
\begin{equation}
f(s_{i,j}) = s_{i,j} - \bar{s}<em j="1">i, \quad \bar{s}_i = \frac{1}{m}\sum</em>
\tag{21}
\end{equation}}^m s_{i,j</p>
<p><strong>éªŒè¯</strong>:
\begin{equation}
\sum_{j=1}^m f(s_{i,j}) = \sum_{j=1}^m (s_{i,j} - \bar{s}<em j="1">i) = \sum</em>_i = 0
\tag{22}
\end{equation}}^m s_{i,j} - m\bar{s</p>
<h3 id="9">9. å€’æ¨çš„æŸå¤±å‡½æ•°</h3>
<p><strong>å®šä¹‰9.1 (ä¸­å¿ƒåŒ–æŸå¤±å‡½æ•°)</strong></p>
<p>æ ¹æ®å¼(15)å’Œ(21)ï¼Œå¾—åˆ°ï¼š
\begin{equation}
L_3 = \sum_{j=1}^m \log\left(1 + \sum_{i=1}^n t_{i,j} e^{-(s_{i,j} - \bar{s}<em j="1">i)}\right) = \sum</em>}^m \log\left(1 + \sum_{i=1}^n t_{i,j} e^{\bar{s<em i_j="i,j">i - s</em>\right)
\tag{23}
\end{equation}}</p>
<p><strong>ç†è®ºæœ€ä¼˜è§£</strong>:
\begin{equation}
t_{i,j} = \frac{e^{s_{i,j} - \bar{s}<em i_k="i,k">i}}{\sum_k e^{s</em>} - \bar{s<em i_1="i,1">i}} = \text{softmax}(s</em>
\tag{24}
\end{equation}}, \ldots, s_{i,m})_{j</p>
<p>æ³¨æ„$\bar{s}_i$ä¸å½±å“softmaxçš„ç»“æœã€‚</p>
<h3 id="10">10. ç¡¬æ ‡ç­¾æƒ…å†µåˆ†æ</h3>
<p><strong>é—®é¢˜10.1</strong>: ä¸ºä»€ä¹ˆå¼(23)åœ¨ç¡¬æ ‡ç­¾æƒ…å†µä¸‹è¡¨ç°ä¸ä½³ï¼Ÿ</p>
<p><strong>åˆ†æ</strong>: è€ƒè™‘ç¬¬$i$ä¸ªä»»åŠ¡ï¼Œå‡è®¾çœŸå®æ ‡ç­¾æ˜¯ç¬¬$j^<em>$ç±»ï¼ˆ$t_{i,j^</em>}=1$ï¼Œå…¶ä»–ä¸º0ï¼‰ã€‚</p>
<p>æŸå¤±å‡½æ•°ç®€åŒ–ä¸ºï¼š
\begin{equation}
L_3 \supset \log\left(1 + e^{\bar{s}<em i_j_="i,j^*">i - s</em>\right)
\tag{25}
\end{equation}}</p>
<p><strong>é—®é¢˜</strong>: åªè¦$s_{i,j^<em>} \gg \bar{s}<em>i$ï¼ŒæŸå¤±å°±ä¼šå¾ˆå°ã€‚ä½†$s</em>{i,j^</em>}$ä¸ä¸€å®šæ˜¯${s_{i,1}, \ldots, s_{i,m}}$ä¸­çš„æœ€å¤§å€¼ï¼</p>
<p><strong>å…·ä½“ä¾‹å­</strong>:
- å‡è®¾$s_{i,1} = 10, s_{i,2} = 5, s_{i,3} = -5$ï¼ˆçœŸå®ç±»åˆ«æ˜¯ç¬¬2ç±»ï¼‰
- $\bar{s}<em i_2="i,2">i = \frac{10+5-5}{3} = 3.33$
- $s</em>} - \bar{s<em i_2="i,2">i = 5 - 3.33 = 1.67 &gt; 0$
- ä½†$s</em>$ä¸æ˜¯æœ€å¤§å€¼ï¼æ¨¡å‹ä¼šé”™è¯¯åœ°é¢„æµ‹ç¬¬1ç±»</p>
<h3 id="11-vs">11. è½¯æ ‡ç­¾vsç¡¬æ ‡ç­¾çš„çŸ›ç›¾</h3>
<p><strong>çŸ›ç›¾11.1</strong>:
- <strong>è½¯æ ‡ç­¾æƒ…å†µ</strong>: $L_3$æœ‰ç¾å¥½çš„ç†è®ºæ€§è´¨ï¼ˆè§£æè§£ä¸ºsoftmaxï¼‰
- <strong>ç¡¬æ ‡ç­¾æƒ…å†µ</strong>: $L_3$æ— æ³•ä¿è¯æ­£ç¡®åˆ†ç±»ï¼ˆæœ€å¤§logitä¸ä¸€å®šå¯¹åº”æœ€å¤§æ¦‚ç‡ï¼‰</p>
<p><strong>æ ¹æœ¬åŸå› </strong>: å¹³å‡ä¸­å¿ƒåŒ–$\bar{s}_i$ç ´åäº†logitsçš„ç›¸å¯¹å¤§å°å…³ç³»ã€‚</p>
<p><strong>å¯¹æ¯”</strong>: æ ‡å‡†softmaxäº¤å‰ç†µä¸å­˜åœ¨è¿™ä¸ªé—®é¢˜ï¼š
\begin{equation}
L_{standard} = -\sum_i t_{i,j^<em>} \log\frac{e^{s_{i,j^</em>}}}{\sum_k e^{s_{i,k}}}
\tag{26}
\end{equation}</p>
<p>è¿™ä¼šå¼ºåˆ¶$s_{i,j^*}$æˆä¸ºæœ€å¤§å€¼ã€‚</p>
<h3 id="12">12. ç±»åˆ«ä¸å¹³è¡¡çš„è‡ªåŠ¨è°ƒèŠ‚æœºåˆ¶</h3>
<p><strong>æœºåˆ¶12.1 (å¯¹æ•°å†…æ±‚å’Œ)</strong></p>
<p>å›é¡¾å¤šæ ‡ç­¾äº¤å‰ç†µï¼ˆå¼2ï¼‰å’Œæ¨å¹¿å½¢å¼ï¼ˆå¼10ã€23ï¼‰ï¼Œå…³é”®ç‰¹å¾æ˜¯ï¼š</p>
<p><strong>æ ‡å‡†å½¢å¼</strong>:
\begin{equation}
L_{standard} = \sum_i L_i
\tag{27}
\end{equation}
æ¯ä¸ªç±»çš„æŸå¤±æƒé‡æ­£æ¯”äºæ ·æœ¬æ•°ã€‚</p>
<p><strong>æ”¹è¿›å½¢å¼</strong>:
\begin{equation}
L_{improved} = \sum_j \log\left(1 + \sum_i (\cdots)\right)
\tag{28}
\end{equation}
æ¯ä¸ªç±»çš„æŸå¤±æƒé‡æ­£æ¯”äºæ ·æœ¬æ•°çš„å¯¹æ•°ã€‚</p>
<p><strong>æ•°å­¦åˆ†æ</strong>: å‡è®¾ç¬¬$j$ç±»æœ‰$N_j$ä¸ªæ ·æœ¬ï¼š
- æ ‡å‡†æ–¹æ³•: è´¡çŒ®$\sim N_j$
- æ”¹è¿›æ–¹æ³•: è´¡çŒ®$\sim \log(1 + N_j) \approx \log N_j$</p>
<p><strong>æ•ˆæœ</strong>:
\begin{equation}
\frac{\log N_1}{\log N_2} &lt; \frac{N_1}{N_2} \quad \text{å½“} \quad N_1 &gt; N_2 &gt; 1
\tag{29}
\end{equation}</p>
<p>ç¼©å°äº†ç±»åˆ«é—´çš„æƒé‡å·®å¼‚ã€‚</p>
<h3 id="13">13. é€€åŒ–åˆ°äºŒåˆ†ç±»çš„éªŒè¯</h3>
<p><strong>å®šç†13.1 (m=2æ—¶çš„é€€åŒ–)</strong></p>
<p>å½“$m=2$æ—¶ï¼Œå¼(10)å’Œå¼(23)éƒ½é€€åŒ–ä¸ºå¤šæ ‡ç­¾äº¤å‰ç†µã€‚</p>
<p><strong>è¯æ˜</strong>: å¯¹äºäºŒåˆ†ç±»ï¼Œä¸å¤±ä¸€èˆ¬æ€§å‡è®¾ç¬¬2ç±»æ˜¯"è´Ÿç±»"ï¼ˆ$t_{i,2} = 1 - t_{i,1}$ï¼‰ã€‚</p>
<p>å¼(23)å˜ä¸ºï¼š
\begin{equation}
\begin{aligned}
L_3 &amp;= \log\left(1 + \sum_i t_{i,1} e^{\bar{s}<em i_1="i,1">i - s</em>}}\right) + \log\left(1 + \sum_i (1-t_{i,1}) e^{\bar{s<em i_2="i,2">i - s</em>\right)
\end{aligned}
\tag{30}
\end{equation}}</p>
<p>å®šä¹‰$\tilde{s}<em i_1="i,1">i = s</em>$ï¼ˆç›¸å¯¹logitï¼‰ï¼Œåˆ™ï¼š
\begin{equation}
\bar{s}} - s_{i,2<em i_1="i,1">i - s</em>
\tag{31}
\end{equation}} = \frac{s_{i,1} + s_{i,2}}{2} - s_{i,1} = \frac{s_{i,2} - s_{i,1}}{2} = -\frac{\tilde{s}_i}{2</p>
<p>ç±»ä¼¼åœ°ï¼š
\begin{equation}
\bar{s}<em i_2="i,2">i - s</em>
\tag{32}
\end{equation}} = \frac{\tilde{s}_i}{2</p>
<p>ä»£å…¥å¼(30)ï¼š
\begin{equation}
L_3 = \log\left(1 + \sum_i t_{i,1} e^{-\tilde{s}<em i_1="i,1">i/2}\right) + \log\left(1 + \sum_i (1-t</em>\right)
\tag{33}
\end{equation}}) e^{\tilde{s}_i/2</p>
<p>è¿™ä¸å¤šæ ‡ç­¾äº¤å‰ç†µå½¢å¼ä¸€è‡´ï¼ˆç›¸å·®ä¸€ä¸ªå¸¸æ•°å› å­1/2ï¼‰ã€‚</p>
<h3 id="14">14. æ•°å€¼ç¤ºä¾‹ï¼šç¡¬æ ‡ç­¾å¤±è´¥</h3>
<p><strong>ä¾‹14.1</strong>: è€ƒè™‘3ä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªä»»åŠ¡3åˆ†ç±»ã€‚</p>
<p><strong>Logits</strong>:
\begin{equation}
\mathbf{S} = \begin{pmatrix}
5 &amp; 2 &amp; 1 \
3 &amp; 6 &amp; 0 \
1 &amp; 2 &amp; 8
\end{pmatrix}
\tag{34}
\end{equation}</p>
<p>çœŸå®æ ‡ç­¾: ä»»åŠ¡1é€‰ç±»1ï¼Œä»»åŠ¡2é€‰ç±»2ï¼Œä»»åŠ¡3é€‰ç±»3ã€‚</p>
<p><strong>å¹³å‡å€¼</strong>: $\bar{s}_1 = 8/3 \approx 2.67$, $\bar{s}_2 = 3$, $\bar{s}_3 = 11/3 \approx 3.67$</p>
<p><strong>æŸå¤±è´¡çŒ®</strong>:
- ä»»åŠ¡1: $\log(1 + e^{2.67-5}) = \log(1 + e^{-2.33}) \approx 0.091$
- ä»»åŠ¡2: $\log(1 + e^{3-6}) = \log(1 + e^{-3}) \approx 0.048$
- ä»»åŠ¡3: $\log(1 + e^{3.67-8}) = \log(1 + e^{-4.33}) \approx 0.013$</p>
<p>çœ‹èµ·æ¥æŸå¤±å¾ˆå°ï¼ä½†ç”¨argmaxé¢„æµ‹ï¼š
- ä»»åŠ¡1: argmax$(5,2,1) = 1$ âœ“
- ä»»åŠ¡2: argmax$(3,6,0) = 2$ âœ“
- ä»»åŠ¡3: argmax$(1,2,8) = 3$ âœ“</p>
<p>è¿™ä¸ªä¾‹å­ä¸­æ°å¥½æ­£ç¡®ã€‚ä½†è€ƒè™‘è½»å¾®æ‰°åŠ¨ï¼š</p>
<p><strong>æ‰°åŠ¨Logits</strong>:
\begin{equation}
\mathbf{S'} = \begin{pmatrix}
5 &amp; 2 &amp; 4 \
3 &amp; 6 &amp; 0 \
1 &amp; 2 &amp; 8
\end{pmatrix}
\tag{35}
\end{equation}</p>
<p>ç°åœ¨$\bar{s}<em 1_1="1,1">1 = 11/3 \approx 3.67$ï¼Œ$s</em>_1 = 5 - 3.67 = 1.33 &gt; 0$ï¼ŒæŸå¤±ä»ç„¶å°ï¼Œä½†argmaxå·²ç»é”™äº†ï¼ˆå¦‚æœç¬¬3ç±»ä¹Ÿå¾ˆæ¥è¿‘ï¼‰ã€‚} - \bar{s</p>
<h3 id="15">15. è½¯æ ‡ç­¾çš„ä¼˜åŠ¿åˆ†æ</h3>
<p><strong>è§‚å¯Ÿ15.1</strong>: è½¯æ ‡ç­¾æƒ…å†µä¸‹ï¼Œå¼(23)çš„è§£æè§£æ˜¯softmaxï¼Œè¿™æ„å‘³ç€ï¼š</p>
<p><strong>æ”¶æ•›æ€§</strong>: æ¢¯åº¦ä¸‹é™ä¼šæ”¶æ•›åˆ°softmaxåˆ†å¸ƒ
<strong>å…‰æ»‘æ€§</strong>: æŸå¤±å‡½æ•°å…³äºlogitsæ˜¯å…‰æ»‘çš„
<strong>å”¯ä¸€æ€§</strong>: åœ¨å‡¸ä¼˜åŒ–æ¡†æ¶ä¸‹ï¼Œè§£æ˜¯å”¯ä¸€çš„</p>
<p><strong>ä½†</strong>: è¿™äº›ä¼˜ç‚¹åœ¨ç¡¬æ ‡ç­¾æƒ…å†µä¸‹éƒ½ä¸é‡è¦ï¼Œå› ä¸ºæˆ‘ä»¬çš„è¯„ä¼°æŒ‡æ ‡æ˜¯argmaxæ­£ç¡®ç‡ï¼Œè€Œéæ¦‚ç‡åˆ†å¸ƒçš„æ¥è¿‘ç¨‹åº¦ã€‚</p>
<h3 id="16">16. ç»„åˆä¼˜åŒ–è§†è§’</h3>
<p><strong>è§†è§’16.1 (ç¡¬æ ‡ç­¾ä½œä¸ºç»„åˆä¼˜åŒ–)</strong></p>
<p>ç¡¬æ ‡ç­¾åˆ†ç±»æœ¬è´¨ä¸Šæ˜¯ç»„åˆä¼˜åŒ–é—®é¢˜ï¼š
\begin{equation}
\hat{y}<em _123_1_ldots_m_125_="{1,\ldots,m}" _in="\in" j="j">i = \arg\max</em>
\tag{36}
\end{equation}} s_{i,j</p>
<p><strong>æ¾å¼›</strong>: softmaxæ˜¯è¿™ä¸ªç»„åˆä¼˜åŒ–çš„å‡¸æ¾å¼›ï¼š
\begin{equation}
p_{i,j} = \text{softmax}(s_{i,1}, \ldots, s_{i,m})<em i_k="i,k">j \approx \mathbb{I}[j = \arg\max_k s</em>]
\tag{37}
\end{equation}</p>
<p><strong>é—®é¢˜</strong>: å¹³å‡ä¸­å¿ƒåŒ–æ”¹å˜äº†argmaxï¼Œå› æ­¤ç ´åäº†è¿™ä¸ªæ¾å¼›å…³ç³»ã€‚</p>
<h3 id="17">17. ä¿¡æ¯è®ºè§£é‡Š</h3>
<p><strong>å®šä¹‰17.1 (äº¤å‰ç†µ)</strong></p>
<p>æ ‡å‡†softmaxäº¤å‰ç†µå¯ä»¥å†™ä¸ºï¼š
\begin{equation}
H(t, p) = -\sum_{i,j} t_{i,j} \log p_{i,j}
\tag{38}
\end{equation}</p>
<p>è¿™æ˜¯çœŸå®åˆ†å¸ƒ$t$å’Œé¢„æµ‹åˆ†å¸ƒ$p$ä¹‹é—´çš„äº¤å‰ç†µã€‚</p>
<p><strong>å¼(10)çš„è§£é‡Š</strong>:
\begin{equation}
L_1 = \sum_j \log\left(1 + \sum_i \sum_{k \neq j} t_{i,j} e^{s_{i,k} - s_{i,j}}\right)
\tag{39}
\end{equation}</p>
<p>å¯ä»¥ç†è§£ä¸º"åŠ æƒå‡ ä½•å¹³å‡"çš„å¯¹æ•°å½¢å¼ï¼Œä½†ç¼ºä¹æ¸…æ™°çš„ä¿¡æ¯è®ºè§£é‡Šã€‚</p>
<h3 id="18-sigmoid-vs-softmax">18. Sigmoid vs Softmax</h3>
<p><strong>å¯¹æ¯”18.1</strong>:</p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>Sigmoid</th>
<th>Softmax</th>
</tr>
</thead>
<tbody>
<tr>
<td>è¾“å‡ºèŒƒå›´</td>
<td>$[0,1]$</td>
<td>$[0,1]$</td>
</tr>
<tr>
<td>å½’ä¸€åŒ–</td>
<td>ç‹¬ç«‹</td>
<td>$\sum_j p_j = 1$</td>
</tr>
<tr>
<td>å†³ç­–è¾¹ç•Œ</td>
<td>$s &gt; 0$</td>
<td>$s_j = \max_k s_k$</td>
</tr>
<tr>
<td>å¤šæ ‡ç­¾</td>
<td>è‡ªç„¶æ”¯æŒ</td>
<td>éœ€è¦æ¨å¹¿</td>
</tr>
<tr>
<td>ç±»åˆ«ä¸å¹³è¡¡</td>
<td>ä¸¥é‡é—®é¢˜</td>
<td>ç›¸å¯¹è¾ƒå¥½</td>
</tr>
</tbody>
</table>
<p><strong>å…³é”®å·®å¼‚</strong>: Sigmoidå…è®¸å¤šä¸ªç±»åˆ«åŒæ—¶ä¸ºæ­£ï¼ŒSoftmaxå¼ºåˆ¶å•é€‰ã€‚</p>
<p><strong>$n$ä¸ª$m$åˆ†ç±»çš„æŒ‘æˆ˜</strong>: éœ€è¦åœ¨æ¯ä¸ªä»»åŠ¡å†…ä¿æŒsoftmaxçš„å½’ä¸€åŒ–çº¦æŸï¼ŒåŒæ—¶åœ¨ä»»åŠ¡é—´å¤„ç†ä¸å¹³è¡¡ã€‚</p>
<h3 id="19">19. å®è·µå»ºè®®ä¸æƒè¡¡</h3>
<p><strong>å»ºè®®19.1 (ä½•æ—¶ä½¿ç”¨å„ç§æŸå¤±)</strong></p>
<ol>
<li><strong>ç¡¬æ ‡ç­¾ + ç±»åˆ«å¹³è¡¡</strong>: ä½¿ç”¨æ ‡å‡†softmaxäº¤å‰ç†µï¼ˆå¼3ï¼‰</li>
<li><strong>ç¡¬æ ‡ç­¾ + ç±»åˆ«ä¸å¹³è¡¡</strong>: ä½¿ç”¨å¼(10)ï¼Œå¯èƒ½éœ€è¦è°ƒæ•´</li>
<li><strong>è½¯æ ‡ç­¾ + éœ€è¦è§£æè§£</strong>: å¯ä»¥å°è¯•å¼(23)ï¼Œä½†æ³¨æ„ç¡¬æ ‡ç­¾æµ‹è¯•æ—¶çš„é—®é¢˜</li>
<li><strong>å¤šæ ‡ç­¾ï¼ˆçœŸæ­£çš„ï¼‰</strong>: ä½¿ç”¨å¼(2)æˆ–GlobalPointer</li>
</ol>
<p><strong>å»ºè®®19.2 (æ··åˆç­–ç•¥)</strong></p>
<p>å¯ä»¥è€ƒè™‘åŠ æƒç»„åˆï¼š
\begin{equation}
L_{hybrid} = \alpha L_1 + (1-\alpha) L_{standard}
\tag{40}
\end{equation}</p>
<p>å…¶ä¸­$\alpha \in [0,1]$å¹³è¡¡ç±»åˆ«ä¸å¹³è¡¡è°ƒèŠ‚å’Œåˆ†ç±»æ­£ç¡®æ€§ã€‚</p>
<h3 id="20">20. æœªæ¥æ–¹å‘ä¸å¼€æ”¾é—®é¢˜</h3>
<p><strong>å¼€æ”¾é—®é¢˜20.1</strong>:
- æ˜¯å¦å­˜åœ¨åŒæ—¶æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„æŸå¤±å‡½æ•°ï¼š
  1. è‡ªåŠ¨ç±»åˆ«ä¸å¹³è¡¡è°ƒèŠ‚
  2. è½¯æ ‡ç­¾è§£æè§£
  3. ç¡¬æ ‡ç­¾æƒ…å†µä¸‹ä¿è¯argmaxæ­£ç¡®</p>
<p><strong>å¯èƒ½æ–¹å‘</strong>:
1. <strong>è‡ªé€‚åº”æƒé‡</strong>: åŠ¨æ€è°ƒæ•´æ¯ä¸ªç±»åˆ«çš„æƒé‡
2. <strong>å¤šç›®æ ‡ä¼˜åŒ–</strong>: åŒæ—¶ä¼˜åŒ–è½¯æ ‡ç­¾å’Œç¡¬æ ‡ç­¾ç›®æ ‡
3. <strong>ç»“æ„åŒ–é¢„æµ‹</strong>: åˆ©ç”¨ä»»åŠ¡é—´çš„ç›¸å…³æ€§</p>
<p><strong>ç†è®ºæŒ‘æˆ˜</strong>: å¯èƒ½éœ€è¦è¯æ˜ä¸å­˜åœ¨"å®Œç¾"è§£ï¼Œæˆ–è€…éœ€è¦å¼•å…¥é¢å¤–çš„å‡è®¾ã€‚</p>
<h3 id="21">21. æ€»ç»“</h3>
<p><strong>æœ¬æ–‡è´¡çŒ®</strong>:
1. æå‡ºäº†ä¸¤ç§"$n$ä¸ª$m$åˆ†ç±»"æŸå¤±å‡½æ•°çš„å€™é€‰å½¢å¼
2. åˆ†æäº†å„è‡ªçš„ä¼˜ç¼ºç‚¹å’Œé€‚ç”¨åœºæ™¯
3. æ­ç¤ºäº†è½¯æ ‡ç­¾ä¼˜åŒ–å’Œç¡¬æ ‡ç­¾è¯„ä¼°ä¹‹é—´çš„å†…åœ¨çŸ›ç›¾</p>
<p><strong>å…³é”®æ´å¯Ÿ</strong>:
- ç±»åˆ«ä¸å¹³è¡¡è°ƒèŠ‚ä¸åˆ†ç±»æ­£ç¡®æ€§å­˜åœ¨æƒè¡¡
- å¹³å‡ä¸­å¿ƒåŒ–è™½ç„¶ç†è®ºä¼˜ç¾ï¼Œä½†åœ¨å®è·µä¸­å¯èƒ½å¤±æ•ˆ
- äºŒåˆ†ç±»çš„æˆåŠŸç»éªŒä¸èƒ½ç›´æ¥æ¨å¹¿åˆ°$m$åˆ†ç±»ï¼ˆ$m&gt;2$ï¼‰</p>
<p><strong>å®è·µå¯ç¤º</strong>:
- ç¡¬æ ‡ç­¾æƒ…å†µï¼šå¼(10)å¯ä»¥å°è¯•ï¼Œä½†éœ€è¦å®éªŒéªŒè¯
- è½¯æ ‡ç­¾æƒ…å†µï¼šå¼(23)æœ‰ç†è®ºä¿è¯
- å®é™…åº”ç”¨ï¼šå¯èƒ½éœ€è¦é’ˆå¯¹å…·ä½“é—®é¢˜å®šåˆ¶æŸå¤±å‡½æ•°</p>
        </div>
    </div>
</body>
</html>