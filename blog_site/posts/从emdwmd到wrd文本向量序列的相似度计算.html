<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»EMDã€WMDåˆ°WRDï¼šæ–‡æœ¬å‘é‡åºåˆ—çš„ç›¸ä¼¼åº¦è®¡ç®—</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ä»EMDã€WMDåˆ°WRDï¼šæ–‡æœ¬å‘é‡åºåˆ—çš„ç›¸ä¼¼åº¦è®¡ç®—</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-12-31 | ğŸ“„ å¤§å°: 14.1 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/7388">https://spaces.ac.cn/archives/7388</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨NLPä¸­ï¼Œæˆ‘ä»¬ç»å¸¸è¦å»æ¯”è¾ƒä¸¤ä¸ªå¥å­çš„ç›¸ä¼¼åº¦ï¼Œå…¶æ ‡å‡†æ–¹æ³•æ˜¯æƒ³åŠæ³•å°†å¥å­ç¼–ç ä¸ºå›ºå®šå¤§å°çš„å‘é‡ï¼Œç„¶åç”¨æŸç§å‡ ä½•è·ç¦»ï¼ˆæ¬§æ°è·ç¦»ã€$\cos$è·ç¦»ç­‰ï¼‰ä½œä¸ºç›¸ä¼¼åº¦ã€‚è¿™ç§æ–¹æ¡ˆç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œè€Œä¸”æ£€ç´¢èµ·æ¥æ¯”è¾ƒå¿«é€Ÿï¼Œä¸€å®šç¨‹åº¦ä¸Šèƒ½æ»¡è¶³å·¥ç¨‹éœ€æ±‚ã€‚</p>
<p>æ­¤å¤–ï¼Œè¿˜å¯ä»¥ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªå˜é•¿åºåˆ—çš„å·®å¼‚æ€§ï¼Œæ¯”å¦‚ç¼–è¾‘è·ç¦»ï¼Œå®ƒé€šè¿‡åŠ¨æ€è§„åˆ’æ‰¾å‡ºä¸¤ä¸ªå­—ç¬¦ä¸²ä¹‹é—´çš„æœ€ä¼˜æ˜ å°„ï¼Œç„¶åç®—ä¸åŒ¹é…ç¨‹åº¦ï¼›ç°åœ¨æˆ‘ä»¬è¿˜æœ‰Word2Vecã€BERTç­‰å·¥å…·ï¼Œå¯ä»¥å°†æ–‡æœ¬åºåˆ—è½¬æ¢ä¸ºå¯¹åº”çš„å‘é‡åºåˆ—ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç›´æ¥æ¯”è¾ƒè¿™ä¸¤ä¸ªå‘é‡åºåˆ—çš„å·®å¼‚ï¼Œè€Œä¸æ˜¯å…ˆå°†å‘é‡åºåˆ—å¼„æˆå•ä¸ªå‘é‡ã€‚</p>
<p>åä¸€ç§æ–¹æ¡ˆé€Ÿåº¦ç›¸å¯¹æ…¢ä¸€ç‚¹ï¼Œä½†å¯ä»¥æ¯”è¾ƒå¾—æ›´ç²¾ç»†ä¸€äº›ï¼Œå¹¶ä¸”ç†è®ºæ¯”è¾ƒä¼˜é›…ï¼Œæ‰€ä»¥ä¹Ÿæœ‰ä¸€å®šçš„åº”ç”¨åœºæ™¯ã€‚æœ¬æ–‡å°±æ¥ç®€å•ä»‹ç»ä¸€ä¸‹å±äºåè€…çš„ä¸¤ä¸ªç›¸ä¼¼åº¦æŒ‡æ ‡ï¼Œåˆ†åˆ«ç®€ç§°ä¸ºWMDã€WRDã€‚</p>
<h2 id="earth-movers-distance">Earth Mover's Distance</h2>
<p>æœ¬æ–‡è¦ä»‹ç»çš„ä¸¤ä¸ªæŒ‡æ ‡éƒ½æ˜¯ä»¥Wassersteinè·ç¦»ä¸ºåŸºç¡€ï¼Œè¿™é‡Œä¼šå…ˆå¯¹å®ƒåšä¸€ä¸ªç®€å•çš„ä»‹ç»ï¼Œç›¸å…³å†…å®¹ä¹Ÿå¯ä»¥é˜…è¯»ç¬”è€…æ—§ä½œ<a href="/archives/6280">ã€Šä»Wassersteinè·ç¦»ã€å¯¹å¶ç†è®ºåˆ°WGANã€‹</a>ã€‚Wassersteinè·ç¦»ä¹Ÿè¢«å½¢è±¡åœ°ç§°ä¹‹ä¸ºâ€œæ¨åœŸæœºè·ç¦»â€ï¼ˆEarth Mover's Distanceï¼ŒEMDï¼‰ï¼Œå› ä¸ºå®ƒå¯ä»¥ç”¨ä¸€ä¸ªâ€œæ¨åœŸâ€çš„ä¾‹å­æ¥é€šä¿—åœ°è¡¨è¾¾å®ƒçš„å«ä¹‰ã€‚</p>
<h3 id="_1">æœ€ä¼˜ä¼ è¾“</h3>
<p>å‡è®¾åœ¨ä½ç½®$i=1,2,\dots,n$å¤„æˆ‘ä»¬åˆ†å¸ƒæœ‰$p_1,p_2,\dots,p_n$é‚£ä¹ˆå¤šçš„åœŸï¼Œç®€å•èµ·è§æˆ‘ä»¬è®¾åœŸçš„æ€»æ•°é‡ä¸º1ï¼Œå³$p_1 + p_2 + \dots + p_n=1$ï¼Œç°åœ¨è¦å°†åœŸæ¨åˆ°ä½ç½®$j=1,2,\dots,n'$ä¸Šï¼Œæ¯å¤„çš„é‡ä¸º$q_1, q_2, \dots, q_{n'}$ï¼Œè€Œä»$i$æ¨åˆ°$j$çš„æˆæœ¬ä¸º$d_{i,j}$ï¼Œæ±‚æˆæœ¬æœ€ä½çš„æ–¹æ¡ˆä»¥åŠå¯¹åº”çš„æœ€ä½æˆæœ¬ã€‚</p>
<p>è¿™å…¶å®å°±æ˜¯ä¸€ä¸ªç»å…¸çš„æœ€ä¼˜ä¼ è¾“é—®é¢˜ã€‚æˆ‘ä»¬å°†æœ€ä¼˜æ–¹æ¡ˆè¡¨ç¤ºä¸º$\gamma_{i,j}$ï¼Œè¡¨ç¤ºè¿™ä¸ªæ–¹æ¡ˆä¸­è¦ä»$i$ä¸­æŠŠ$\gamma_{i,j}$æ•°é‡çš„åœŸæ¨åˆ°$j$å¤„ï¼Œå¾ˆæ˜æ˜¾æˆ‘ä»¬æœ‰çº¦æŸ<br />
\begin{equation}\sum_j \gamma_{i,j}=p_i,\quad \sum_i \gamma_{i,j}=q_j,\quad \gamma_{i,j} \geq 0\label{eq:cond}\end{equation}<br />
æ‰€ä»¥æˆ‘ä»¬çš„ä¼˜åŒ–é—®é¢˜æ˜¯<br />
\begin{equation}\min_{\gamma_{i,j} \geq 0} \sum_{i,j} \gamma_{i,j} d_{i,j}\quad \text{s.t.} \quad \sum_j \gamma_{i,j}=p_i,\sum_i \gamma_{i,j}=q_j\end{equation}</p>
<h3 id="_2">å‚è€ƒå®ç°</h3>
<p>çœ‹ä¸Šå»å¤æ‚ï¼Œä½†è®¤çœŸè§‚å¯Ÿä¸‹å°±èƒ½å‘ç°ä¸Šå¼å…¶å®å°±æ˜¯ä¸€ä¸ªçº¿æ€§è§„åˆ’é—®é¢˜â€”â€”åœ¨çº¿æ€§çº¦æŸä¸‹æ±‚çº¿æ€§å‡½æ•°çš„æå€¼ã€‚è€Œ<code>scipy</code>å°±è‡ªå¸¦äº†çº¿æ€§è§„åˆ’æ±‚è§£å‡½æ•°<code>linprog</code>ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒå®ç°æ±‚Wassersteinè·ç¦»çš„å‡½æ•°ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">linprog</span>

<span class="k">def</span><span class="w"> </span><span class="nf">wasserstein_distance</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">D</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;é€šè¿‡çº¿æ€§è§„åˆ’æ±‚Wassersteinè·ç¦»</span>
<span class="sd">    p.shape=[m], q.shape=[n], D.shape=[m, n]</span>
<span class="sd">    p.sum()=1, q.sum()=1, pâˆˆ[0,1], qâˆˆ[0,1]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">A_eq</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">p</span><span class="p">)):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros_like</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
        <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="p">:]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">A_eq</span><span class="o">.</span><span class="kp">append</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="kp">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)):</span>
        <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros_like</span><span class="p">(</span><span class="n">D</span><span class="p">)</span>
        <span class="n">A</span><span class="p">[:,</span> <span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">A_eq</span><span class="o">.</span><span class="kp">append</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="kp">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
    <span class="n">A_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">array</span><span class="p">(</span><span class="n">A_eq</span><span class="p">)</span>
    <span class="n">b_eq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">concatenate</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">])</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">D</span><span class="o">.</span><span class="kp">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">linprog</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">A_eq</span><span class="o">=</span><span class="n">A_eq</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">b_eq</span><span class="o">=</span><span class="n">b_eq</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
</code></pre></div>

<p>è¯»è€…å¯ä»¥ç•™æ„åˆ°ï¼Œåœ¨ä¼ å…¥çº¦æŸçš„æ—¶å€™ç”¨çš„æ˜¯<code>A_eq=A_eq[:-1], b_eq=b_eq[:-1]</code>ï¼Œä¹Ÿå°±æ˜¯å»æ‰äº†æœ€åä¸€ä¸ªçº¦æŸã€‚è¿™æ˜¯å› ä¸º$1=\sum\limits_{i=1}^n p_i = \sum\limits_{j=1}^{n'} q_j$ï¼Œæ‰€ä»¥$\eqref{eq:cond}$ä¸­çš„ç­‰å¼çº¦æŸæœ¬èº«å­˜åœ¨å†—ä½™ï¼Œè€Œå®é™…è®¡ç®—ä¸­æœ‰æ—¶å€™å¯èƒ½å­˜åœ¨æµ®ç‚¹è¯¯å·®ï¼Œå¯¼è‡´å†—ä½™çš„çº¦æŸä¹‹é—´ç›¸äº’çŸ›ç›¾ï¼Œä»è€Œä½¿å¾—çº¿æ€§è§„åˆ’çš„æ±‚è§£å¤±è´¥ï¼Œæ‰€ä»¥å¹²è„†å»æ‰æœ€åä¸€ä¸ªå†—ä½™çš„çº¦æŸï¼Œå‡å°‘å‡ºé”™çš„å¯èƒ½æ€§ã€‚</p>
<h2 id="word-movers-distance">Word Mover's Distance</h2>
<p>å¾ˆæ˜æ˜¾ï¼ŒWassersteinè·ç¦»é€‚åˆäºç”¨æ¥è®¡ç®—ä¸¤ä¸ªä¸åŒé•¿åº¦çš„åºåˆ—çš„å·®å¼‚æ€§ï¼Œè€Œæˆ‘ä»¬è¦åšè¯­ä¹‰ç›¸ä¼¼åº¦çš„æ—¶å€™ï¼Œä¸¤ä¸ªå¥å­é€šå¸¸ä¹Ÿæ˜¯ä¸åŒé•¿åº¦çš„ï¼Œåˆšå¥½å¯¹åº”è¿™ä¸ªç‰¹æ€§ï¼Œå› æ­¤å¾ˆè‡ªç„¶åœ°å°±ä¼šè”æƒ³åˆ°Wassersteinè·ç¦»ä¹Ÿè®¸å¯ä»¥ç”¨æ¥æ¯”è¾ƒå¥å­ç›¸ä¼¼åº¦ï¼Œè€Œé¦–æ¬¡è¿›è¡Œè¿™ä¸ªå°è¯•çš„æ˜¯è®ºæ–‡<a href="http://proceedings.mlr.press/v37/kusnerb15.html">ã€ŠFrom Word Embeddings To Document Distancesã€‹</a>ã€‚</p>
<h3 id="_3">åŸºæœ¬å½¢å¼</h3>
<p>è®¾æœ‰ä¸¤ä¸ªå¥å­$s = (t_1,t_2,\dots,t_n), s' = (t'<em n_="n'">1, t'_2, \dots, t'</em>})$ï¼Œç»è¿‡æŸç§æ˜ å°„ï¼ˆæ¯”å¦‚Word2Vecæˆ–è€…BERTï¼‰åï¼Œå®ƒä»¬å˜æˆäº†å¯¹åº”çš„å‘é‡åºåˆ—$(\boldsymbol{w<em n_="n'">1,\boldsymbol{w}_2,\dots,\boldsymbol{w}_n), (\boldsymbol{w}'_1, \boldsymbol{w}'_2, \dots, \boldsymbol{w}'</em>)$ï¼Œç°åœ¨æˆ‘ä»¬å°±æƒ³åŠæ³•ç”¨Wassersteinè·ç¦»æ¥æ¯”è¾ƒè¿™ä¸¤ä¸ªåºåˆ—çš„ç›¸ä¼¼åº¦ã€‚</p>
<p>æ ¹æ®å‰ä¸€èŠ‚çš„ä»‹ç»ï¼ŒWassersteinè·ç¦»éœ€è¦çŸ¥é“$p_i,q_j,d_{i,j}$ä¸‰ä¸ªé‡ï¼Œæˆ‘ä»¬é€ä¸€æŠŠå®ƒä»¬éƒ½å®šä¹‰å¥½å³å¯ã€‚ç”±äºæ²¡æœ‰ä»€ä¹ˆå…ˆéªŒçŸ¥è¯†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å¾ˆæœ´ç´ åœ°å°†è®©$p_i\equiv \frac{1}{n}, q_j\equiv \frac{1}{n'}$ï¼Œæ‰€ä»¥ç°åœ¨è¿˜å‰©$d_{i,j}$ã€‚æ˜¾ç„¶ï¼Œ$d_{i,j}$ä»£è¡¨ç€ç¬¬ä¸€ä¸ªåºåˆ—çš„å‘é‡$\boldsymbol{w}<em _gamma__i_j="\gamma_{i,j">i$ä¸ç¬¬äºŒä¸ªåºåˆ—çš„å‘é‡$\boldsymbol{w}'_j$çš„æŸç§å·®å¼‚æ€§ï¼Œç®€å•èµ·è§æˆ‘ä»¬å¯ä»¥ç”¨æ¬§æ°è·ç¦»$\left\Vert \boldsymbol{w}_i - \boldsymbol{w}'_j\right\Vert$ï¼Œæ‰€ä»¥ä¸¤ä¸ªå¥å­çš„å·®å¼‚ç¨‹åº¦å¯ä»¥è¡¨ç¤ºä¸º<br />
\begin{equation}\min</em>} \geq 0} \sum_{i,j} \gamma_{i,j} \left\Vert \boldsymbol{w<em i_j="i,j">i - \boldsymbol{w}'_j\right\Vert\quad \text{s.t.} \quad \sum_j \gamma</em>}=\frac{1}{n},\sum_i \gamma_{i,j}=\frac{1}{n'}\end{equation<br />
è¿™ä¾¿æ˜¯Word Mover's Distanceï¼ˆWMDï¼‰ï¼ˆæ¨è¯æœºè·ç¦»ï¼Ÿï¼Ÿï¼‰ï¼Œå¤§æ¦‚å¯ä»¥ç†è§£ä¸ºå°†ä¸€ä¸ªå¥å­å˜ä¸ºå¦ä¸€ä¸ªå¥å­çš„æœ€çŸ­è·¯å¾„ï¼ŒæŸç§æ„ä¹‰ä¸Šä¹Ÿå¯ä»¥ç†è§£ä¸ºç¼–è¾‘è·ç¦»çš„å…‰æ»‘ç‰ˆã€‚å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œé€šå¸¸ä¼šå»æ‰åœç”¨è¯åå†è®¡ç®—WMDã€‚</p>
<p><a href="/usr/uploads/2020/05/1630018657.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="Word Mover's Distanceçš„ç¤ºæ„å›¾ï¼Œæ¥è‡ªè®ºæ–‡ã€ŠFrom Word Embeddings To Document Distancesã€‹" src="/usr/uploads/2020/05/1630018657.png" /></a></p>
<p>Word Mover's Distanceçš„ç¤ºæ„å›¾ï¼Œæ¥è‡ªè®ºæ–‡ã€ŠFrom Word Embeddings To Document Distancesã€‹</p>
<h3 id="_4">å‚è€ƒå®ç°</h3>
<p>å‚è€ƒå®ç°å¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code>def word_mover_distance(x, y):
    &quot;&quot;&quot;WMDï¼ˆWord Mover&#39;s Distanceï¼‰çš„å‚è€ƒå®ç°
    x.shape=[m,d], y.shape=[n,d]
    &quot;&quot;&quot;
    p = np.ones(x.shape[0]) / x.shape[0]
    q = np.ones(y.shape[0]) / y.shape[0]
    D = np.sqrt(np.square(x[:, None] - y[None, :]).mean(axis=2))
    return wasserstein_distance(p, q, D)
</code></pre></div>

<h3 id="_5">ä¸‹ç•Œå…¬å¼</h3>
<p>å¦‚æœæ˜¯æ£€ç´¢åœºæ™¯ï¼Œè¦å°†è¾“å…¥å¥å­è·Ÿæ•°æ®åº“é‡Œè¾¹æ‰€æœ‰å¥å­ä¸€ä¸€ç®—WMDå¹¶æ’åºçš„è¯ï¼Œé‚£è®¡ç®—æˆæœ¬æ˜¯ç›¸å½“å¤§çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦å°½é‡å‡å°‘ç®—WMDçš„æ¬¡æ•°ï¼Œæ¯”å¦‚é€šè¿‡ä¸€äº›æ›´ç®€å•é«˜æ•ˆçš„æŒ‡æ ‡æ¥è¿‡æ»¤æ‰ä¸€äº›æ ·æœ¬ï¼Œç„¶åæ‰å¯¹å‰©ä¸‹çš„æ ·æœ¬ç®—WMDã€‚</p>
<p>å¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬ç¡®å®å¯ä»¥æ¨å¯¼å‡ºWMDçš„ä¸€ä¸ªä¸‹ç•Œå…¬å¼ï¼ŒåŸè®ºæ–‡ç§°ä¹‹ä¸ºWord Centroid Distanceï¼ˆWCDï¼‰ï¼š<br />
\begin{equation}\begin{aligned}<br />
\sum_{i,j} \gamma_{i,j} \left\Vert \boldsymbol{w}<em i_j="i,j">i - \boldsymbol{w}'_j\right\Vert =&amp; \sum</em>} \left\Vert \gamma_{i,j}(\boldsymbol{w<em i_j="i,j">i - \boldsymbol{w}'_j)\right\Vert\\\<br />
\geq&amp; \left\Vert \sum</em>}\gamma_{i,j}(\boldsymbol{w<em i_j="i,j">i - \boldsymbol{w}'_j)\right\Vert\\\<br />
=&amp; \left\Vert \sum_i\left(\sum_j\gamma</em>}\right)\boldsymbol{w<em i_j="i,j">i - \sum_j\left(\sum_i\gamma</em>'_j\right\Vert\\\}\right)\boldsymbol{w<br />
=&amp; \left\Vert \frac{1}{n}\sum_i\boldsymbol{w}_i - \frac{1}{n'}\sum_j\boldsymbol{w}'_j\right\Vert\\\<br />
\end{aligned}\end{equation}<br />
ä¹Ÿå°±æ˜¯è¯´ï¼ŒWMDå¤§äºä¸¤ä¸ªå¥å­çš„å¹³å‡å‘é‡çš„æ¬§æ°è·ç¦»ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ£€ç´¢WMDæ¯”è¾ƒå°çš„å¥å­æ—¶ï¼Œå¯ä»¥å…ˆç”¨WCDæŠŠè·ç¦»æ¯”è¾ƒå¤§çš„å¥å­å…ˆè¿‡æ»¤æ‰ï¼Œç„¶åå‰©ä¸‹çš„é‡‡ç”¨WMDæ¯”è¾ƒã€‚</p>
<h2 id="word-rotators-distance">Word Rotator's Distance</h2>
<p>WMDå…¶å®å·²ç»æŒºä¸é”™äº†ï¼Œä½†éè¦é¸¡è›‹é‡ŒæŒ‘éª¨å¤´çš„è¯ï¼Œè¿˜æ˜¯èƒ½æŒ‘å‡ºä¸€äº›ç¼ºç‚¹æ¥ï¼š</p>
<blockquote>
<p>1ã€å®ƒä½¿ç”¨çš„æ˜¯æ¬§æ°è·ç¦»ä½œä¸ºè¯­ä¹‰å·®è·åº¦é‡ï¼Œä½†ä»Word2Vecçš„ç»éªŒæˆ‘ä»¬å°±çŸ¥é“è¦ç®—è¯å‘é‡çš„ç›¸ä¼¼åº¦çš„è¯ï¼Œç”¨$\cos$å¾€å¾€æ¯”æ¬§æ°è·ç¦»è¦å¥½ï¼›</p>
<p>2ã€WMDç†è®ºä¸Šæ˜¯ä¸€ä¸ªæ— ä¸Šç•Œçš„é‡ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬ä¸å¤§å¥½ç›´è§‚æ„ŸçŸ¥ç›¸ä¼¼ç¨‹åº¦ï¼Œä»è€Œä¸èƒ½å¾ˆå¥½è°ƒæ•´ç›¸ä¼¼ä¸å¦çš„é˜ˆå€¼ã€‚</p>
</blockquote>
<p>ä¸ºäº†è§£å†³è¿™ä¸¤ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªæ¯”è¾ƒæœ´ç´ çš„æƒ³æ³•æ˜¯å°†æ‰€æœ‰å‘é‡é™¤ä»¥å„è‡ªçš„æ¨¡é•¿æ¥å½’ä¸€åŒ–åå†ç®—WMDï¼Œä½†è¿™æ ·å°±å®Œå…¨å¤±å»äº†æ¨¡é•¿ä¿¡æ¯äº†ã€‚æœ€è¿‘çš„è®ºæ–‡<a href="https://papers.cool/arxiv/2004.15003">ã€ŠWord Rotator's Distance: Decomposing Vectors Gives Better Representationsã€‹</a>åˆ™å·§å¦™åœ°æå‡ºï¼Œåœ¨å½’ä¸€åŒ–çš„åŒæ—¶å¯ä»¥æŠŠæ¨¡é•¿èå…¥åˆ°çº¦æŸæ¡ä»¶$p,q$é‡Œè¾¹å»ï¼Œè¿™å°±å½¢æˆäº†WRDã€‚</p>
<h3 id="_6">åŸºæœ¬å½¢å¼</h3>
<p>é¦–å…ˆï¼ŒWRDæå‡ºäº†â€œè¯å‘é‡çš„æ¨¡é•¿æ­£ç›¸å…³äºè¿™ä¸ªè¯çš„é‡è¦ç¨‹åº¦â€çš„è§‚ç‚¹ï¼Œå¹¶é€šè¿‡ä¸€äº›å®éªŒç»“æœéªŒè¯äº†è¿™ä¸ªè§‚ç‚¹ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸ªè§‚ç‚¹è·Ÿç¬”è€…ä¹‹å‰æå‡ºçš„simpler gloveæ¨¡å‹çš„è§‚ç‚¹ä¸€è‡´ï¼Œå‚è€ƒ<a href="/archives/4677">ã€Šæ›´åˆ«è‡´çš„è¯å‘é‡æ¨¡å‹(äº”)ï¼šæœ‰è¶£çš„ç»“æœã€‹</a>ã€‚è€Œåœ¨WMDä¸­ï¼Œ$p_i,q_j$æŸç§æ„ä¹‰ä¸Šä¹Ÿä»£è¡¨ç€å¯¹åº”å¥å­ä¸­æŸä¸ªè¯çš„é‡è¦ç¨‹åº¦ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¾<br />
\begin{equation}\begin{aligned}&amp;p_i = \frac{\left\Vert \boldsymbol{w}<em i="1">i\right\Vert}{Z}, &amp;Z=\sum</em>}^n \left\Vert\boldsymbol{w<em j="1">i\right\Vert\\\<br />
&amp;q_j = \frac{\left\Vert \boldsymbol{w}'_j\right\Vert}{Z'}, &amp;Z'=\sum</em>'}^{n'}\left\Vert\boldsymbol{w<em i_j="i,j">j\right\Vert<br />
\end{aligned}\end{equation}<br />
ç„¶å$d</em>$å°±ç”¨ä½™å¼¦è·ç¦»ï¼š<br />
\begin{equation}d_{i,j}=1 - \frac{\boldsymbol{w}<em _gamma__i_j="\gamma_{i,j">i\cdot \boldsymbol{w}'_j}{\left\Vert\boldsymbol{w}_i\right\Vert\times \left\Vert\boldsymbol{w}'_j\right\Vert}\end{equation}<br />
å¾—åˆ°<br />
\begin{equation}\min</em>} \geq 0} \sum_{i,j} \gamma_{i,j} \left(1 - \frac{\boldsymbol{w<em i_j="i,j">i\cdot \boldsymbol{w}'_j}{\left\Vert\boldsymbol{w}_i\right\Vert\times \left\Vert\boldsymbol{w}'_j\right\Vert}\right)\quad \text{s.t.} \quad \sum_j \gamma</em>}=\frac{\left\Vert \boldsymbol{w<em i_j="i,j">i\right\Vert}{Z},\sum_i \gamma</em>}=\frac{\left\Vert \boldsymbol{w}'_j\right\Vert}{Z'}\end{equation<br />
è¿™å°±æ˜¯Word Rotator's Distanceï¼ˆWRDï¼‰äº†ã€‚ç”±äºä½¿ç”¨çš„åº¦é‡æ˜¯ä½™å¼¦è·ç¦»ï¼Œæ‰€ä»¥ä¸¤ä¸ªå‘é‡ä¹‹é—´çš„å˜æ¢æ›´åƒæ˜¯ä¸€ç§æ—‹è½¬ï¼ˆrotateï¼‰è€Œä¸æ˜¯ç§»åŠ¨ï¼ˆmoveï¼‰ï¼Œæ‰€ä»¥æœ‰äº†è¿™ä¸ªå‘½åï¼›åŒæ ·ç”±äºä½¿ç”¨äº†ä½™å¼¦è·ç¦»ï¼Œæ‰€ä»¥å®ƒçš„ç»“æœåœ¨$[0,2]$å†…ï¼Œç›¸å¯¹æ¥è¯´æ›´å®¹æ˜“å»æ„ŸçŸ¥å…¶ç›¸ä¼¼ç¨‹åº¦ã€‚</p>
<h3 id="_7">å‚è€ƒå®ç°</h3>
<p>å‚è€ƒå®ç°å¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code>def word_rotator_distance(x, y):
    &quot;&quot;&quot;WRDï¼ˆWord Rotator&#39;s Distanceï¼‰çš„å‚è€ƒå®ç°
    x.shape=[m,d], y.shape=[n,d]
    &quot;&quot;&quot;
    x_norm = (x**2).sum(axis=1, keepdims=True)**0.5
    y_norm = (y**2).sum(axis=1, keepdims=True)**0.5
    p = x_norm[:, 0] / x_norm.sum()
    q = y_norm[:, 0] / y_norm.sum()
    D = 1 - np.dot(x / x_norm, (y / y_norm).T)
    return wasserstein_distance(p, q, D)


def word_rotator_similarity(x, y):
    &quot;&quot;&quot;1 - WRD
    x.shape=[m,d], y.shape=[n,d]
    &quot;&quot;&quot;
    return 1 - word_rotator_distance(x, y)
</code></pre></div>

<h3 id="_8">ä¸‹ç•Œå…¬å¼</h3>
<p>åŒWMDä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ¨å¯¼å‡ºWRDçš„ä¸€ä¸ªä¸‹ç•Œå…¬å¼ï¼š<br />
\begin{equation}\begin{aligned}<br />
2\sum_{i,j} \gamma_{i,j} \left(1 - \frac{\boldsymbol{w}<em i_j="i,j">i\cdot \boldsymbol{w}'_j}{\left\Vert\boldsymbol{w}_i\right\Vert\times \left\Vert\boldsymbol{w}'_j\right\Vert}\right)=&amp;\sum</em>} \gamma_{i,j} \left\Vert \frac{\boldsymbol{w<em i_j="i,j">i}{\left\Vert \boldsymbol{w}_i\right\Vert} - \frac{\boldsymbol{w}'_j}{\left\Vert \boldsymbol{w}'_j\right\Vert}\right\Vert^2 \\\<br />
\geq&amp; \left\Vert \sum</em>}\gamma_{i,j}\left(\frac{\boldsymbol{w<em i_j="i,j">i}{\left\Vert \boldsymbol{w}_i\right\Vert} - \frac{\boldsymbol{w}'_j}{\left\Vert \boldsymbol{w}'_j\right\Vert}\right)\right\Vert^2\\\<br />
=&amp; \left\Vert \sum_i\left(\sum_j\gamma</em>}\right)\frac{\boldsymbol{w<em i_j="i,j">i}{\left\Vert \boldsymbol{w}_i\right\Vert} - \sum_j\left(\sum_i\gamma</em>\right\Vert^2\\\}\right)\frac{\boldsymbol{w}'_j}{\left\Vert \boldsymbol{w}'_j\right\Vert<br />
=&amp; \left\Vert \frac{1}{Z}\sum_i\boldsymbol{w}_i - \frac{1}{Z'}\sum_j\boldsymbol{w}'_j\right\Vert^2\\\<br />
\end{aligned}\end{equation}<br />
å…¶ä¸­ä¸ç­‰å·åŸºäºè©¹æ£®ä¸ç­‰å¼ï¼ˆæˆ–è€…åŸºæœ¬ä¸ç­‰å¼çš„æ¨å¹¿ç‰ˆï¼‰ã€‚ä¸è¿‡è¿™éƒ¨åˆ†å†…å®¹å¹¶æ²¡æœ‰å‡ºç°åœ¨WRDçš„è®ºæ–‡ä¸­ï¼Œåªæ˜¯ç¬”è€…è‡ªè¡Œè¡¥å……çš„ã€‚</p>
<h2 id="_9">åˆåˆ°äº†æ–‡æœ«å°ç»“çš„æ—¶å€™</h2>
<p>æ–‡æœ¬ä»‹ç»äº†ä¸¤ç§æ–‡æœ¬ç›¸ä¼¼åº¦ç®—æ³•WMDã€WRDï¼Œå®ƒä»¬éƒ½æ˜¯åˆ©ç”¨Wassersteinè·ç¦»ï¼ˆEarth Mover's Distanceï¼Œæ¨åœŸæœºè·ç¦»ï¼‰æ¥ç›´æ¥æ¯”è¾ƒä¸¤ä¸ªä¸å®šé•¿å‘é‡çš„å·®å¼‚æ€§ã€‚è¿™ç±»ç›¸ä¼¼åº¦ç®—æ³•åœ¨æ•ˆç‡ä¸Šä¼šæœ‰æ‰€æ¬ ç¼ºï¼Œä½†æ˜¯ç†è®ºä¸Šæ¯”è¾ƒä¼˜é›…ï¼Œè€Œä¸”æ•ˆæœä¹Ÿé¢‡ä¸ºä¸é”™ï¼Œå€¼å¾—å­¦ä¹ ä¸€ç•ªã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/7388">https://spaces.ac.cn/archives/7388</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (May. 13, 2020). ã€Šä»EMDã€WMDåˆ°WRDï¼šæ–‡æœ¬å‘é‡åºåˆ—çš„ç›¸ä¼¼åº¦è®¡ç®— ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/7388">https://spaces.ac.cn/archives/7388</a></p>
<p>@online{kexuefm-7388,<br />
title={ä»EMDã€WMDåˆ°WRDï¼šæ–‡æœ¬å‘é‡åºåˆ—çš„ç›¸ä¼¼åº¦è®¡ç®—},<br />
author={è‹å‰‘æ—},<br />
year={2020},<br />
month={May},<br />
url={\url{https://spaces.ac.cn/archives/7388}},<br />
} </p>
<hr />
<h2 id="_10">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>TODO: æ·»åŠ è¯¦ç»†çš„æ•°å­¦å…¬å¼æ¨å¯¼å’Œæ³¨é‡Š</p>
        </div>
    </div>
</body>
</html>