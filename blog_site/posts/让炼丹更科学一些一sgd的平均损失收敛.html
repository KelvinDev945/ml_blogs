<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®©ç‚¼ä¸¹æ›´ç§‘å­¦ä¸€äº›ï¼ˆä¸€ï¼‰ï¼šSGDçš„å¹³å‡æŸå¤±æ”¶æ•›</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>è®©ç‚¼ä¸¹æ›´ç§‘å­¦ä¸€äº›ï¼ˆä¸€ï¼‰ï¼šSGDçš„å¹³å‡æŸå¤±æ”¶æ•›</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2026-01-05 | ğŸ“„ å¤§å°: 65.5 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9902">https://spaces.ac.cn/archives/9902</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å°†æ·±åº¦å­¦ä¹ æ¨¡å‹çš„è®­ç»ƒè¿‡ç¨‹æˆç§°ä¸ºâ€œç‚¼ä¸¹â€ï¼Œå› ä¸ºæ•´ä¸ªè¿‡ç¨‹è·Ÿå¤ä»£çš„ç‚¼ä¸¹æœ¯ä¸€æ ·ï¼Œçœ‹ä¸Šå»æœ‰ä¸€å®šçš„ç§‘å­¦ä¾æ®ï¼Œä½†æ•´ä½“å´ç»™äººä¸€ç§â€œç„ä¹‹åˆç„â€çš„æ„Ÿè§‰ã€‚å°½ç®¡æœ¬ç«™ä¹‹å‰ä¹Ÿå…³æ³¨è¿‡ä¸€äº›<a href="/tag/%E4%BC%98%E5%8C%96%E5%99%A8/">ä¼˜åŒ–å™¨</a>ç›¸å…³çš„å·¥ä½œï¼Œç”šè‡³ä¹Ÿå†™è¿‡<a href="/search/%E4%BB%8E%E5%8A%A8%E5%8A%9B%E5%AD%A6%E8%A7%92%E5%BA%A6%E7%9C%8B%E4%BC%98%E5%8C%96%E7%AE%97%E6%B3%95/">ã€Šä»åŠ¨åŠ›å­¦è§’åº¦çœ‹ä¼˜åŒ–ç®—æ³•ã€‹</a>ç³»åˆ—ï¼Œä½†éƒ½æ˜¯æ¯”è¾ƒè¡¨é¢çš„ä»‹ç»ï¼Œå¹¶æ²¡æœ‰æ¶‰åŠåˆ°æ›´æ·±å…¥çš„ç†è®ºã€‚ä¸ºäº†è®©ä»¥åçš„ç‚¼ä¸¹æ›´ç§‘å­¦ä¸€äº›ï¼Œç¬”è€…å†³å®šå»è¡¥ä¹ ä¸€äº›ä¼˜åŒ–ç›¸å…³çš„ç†è®ºç»“æœï¼Œäº‰å–è®©ç‚¼ä¸¹ä¹‹è·¯å¤šç‚¹ç†è®ºæ”¯æ’‘ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹ éšæœºæ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰çš„ä¸€ä¸ªéå¸¸åŸºç¡€çš„æ”¶æ•›ç»“è®ºã€‚è™½ç„¶ç°åœ¨çœ‹æ¥ï¼Œè¯¥ç»“è®ºæ˜¾å¾—å¾ˆç²—ç³™ä¸”ä¸å®ç”¨ï¼Œä½†å®ƒæ˜¯ä¼˜åŒ–å™¨æ”¶æ•›æ€§è¯æ˜çš„ä¸€æ¬¡éå¸¸é‡è¦çš„å°è¯•ï¼Œç‰¹åˆ«æ˜¯å®ƒè€ƒè™‘äº†æˆ‘ä»¬å®é™…ä½¿ç”¨çš„æ˜¯ <em>éšæœº</em> æ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰è€Œä¸æ˜¯ <em>å…¨é‡</em> æ¢¯åº¦ä¸‹é™ï¼ˆGDï¼‰è¿™ä¸€ç‰¹æ€§ï¼Œä½¿å¾—ç»“è®ºæ›´åŠ å…·æœ‰å‚è€ƒæ„ä¹‰ã€‚</p>
<h2 id="_1">é—®é¢˜è®¾ç½®</h2>
<p>è®¾æŸå¤±å‡½æ•°æ˜¯$L(\boldsymbol{x},\boldsymbol{\theta})$ï¼Œå…¶å®$\boldsymbol{x}$æ˜¯è®­ç»ƒé›†ï¼Œè€Œ$\boldsymbol{\theta}\in\mathbb{R}^d$æ˜¯è®­ç»ƒå‚æ•°ã€‚å—é™äºç®—åŠ›ï¼Œæˆ‘ä»¬é€šå¸¸åªèƒ½æ‰§è¡Œéšæœºæ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰ï¼Œå³æ¯æ­¥åªèƒ½é‡‡æ ·ä¸€ä¸ªè®­ç»ƒå­é›†æ¥è®¡ç®—æŸå¤±å‡½æ•°å¹¶æ›´æ–°å‚æ•°ï¼Œå‡è®¾é‡‡æ ·æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„ï¼Œç¬¬$t$æ­¥é‡‡æ ·åˆ°çš„å­é›†ä¸º$\boldsymbol{x}<em T_to_infty="T\to\infty">t$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥åˆç†åœ°è®¤ä¸ºå®é™…ä¼˜åŒ–çš„æœ€ç»ˆç›®æ ‡æ˜¯<br />
\begin{equation}L(\boldsymbol{\theta}) = \lim</em>}\frac{1}{T}\sum_{t=1}^T L(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t,\boldsymbol{\theta})\label{eq:loss}\end{equation}<br />
å®é™…æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¹Ÿåªèƒ½è®­ç»ƒæœ‰é™æ­¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å‡è®¾$T$æ˜¯ä¸€ä¸ªè¶³å¤Ÿå¤§çš„æ­£æ•´å¸¸æ•°ã€‚æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å¯»æ‰¾$L(\boldsymbol{\theta})$çš„æœ€å°å€¼ç‚¹ï¼Œå³å¸Œæœ›æ‰¾åˆ°$\boldsymbol{\theta}^<em>$ï¼š<br />
\begin{equation}\boldsymbol{\theta}^</em> = \mathop{\text{argmin}}</em>}\in\mathbb{R}^d} L(\boldsymbol{\theta})\label{eq:argmin}\end{equation<br />
ç°åœ¨ï¼Œæˆ‘ä»¬è€ƒè™‘å¦‚ä¸‹SGDè¿­ä»£ï¼š<br />
\begin{equation}\boldsymbol{\theta}<em _boldsymbol_theta="\boldsymbol{\theta">{t+1} = \boldsymbol{\theta}_t - \eta_t \boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t)\label{eq:sgd}\end{equation}<br />
å…¶ä¸­$\eta_t &gt; 0$æ˜¯å­¦ä¹ ç‡ï¼Œå…¶ä¸­$\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta})\triangleq \nabla</em>^*$ã€‚}}L(\boldsymbol{x}_t,\boldsymbol{\theta})$æ˜¯$L(\boldsymbol{x}_t,\boldsymbol{\theta})$å…³äº$\boldsymbol{\theta}$çš„æ¢¯åº¦ã€‚æˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯åˆ†æå¦‚æ­¤è¿­ä»£ä¸‹å»ï¼Œ$\boldsymbol{\theta}_t$æ˜¯å¦èƒ½å¤Ÿæ”¶æ•›åˆ°åˆ°ç›®æ ‡ç‚¹$\boldsymbol{\theta</p>
<h2 id="_2">ç»“è®ºåˆæ¢</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬ç»™å‡ºæœ€ç»ˆè¦è¯æ˜çš„ä¸ç­‰å¼ï¼šåœ¨é€‚å½“çš„å‡è®¾ä¹‹ä¸‹ï¼Œæœ‰<br />
\begin{equation}\frac{1}{T}\sum_{t=1}^T L(\boldsymbol{x}<em t="1">t,\boldsymbol{\theta}_t) - \frac{1}{T}\sum</em>}^T L(\boldsymbol{x<em t="1">t,\boldsymbol{\theta}^*)\leq \frac{D^2}{2T\eta_T} + \frac{G^2}{2T}\sum</em>}^T\eta_t\label{neq:core}\end{equation</p>
<p>å…¶ä¸­$D,G$æ˜¯è·Ÿä¼˜åŒ–è¿‡ç¨‹æ— å…³çš„å¸¸æ•°ã€‚åé¢æˆ‘ä»¬ä¼šé€ä¸€ä»‹ç»â€œé€‚å½“çš„å‡è®¾â€å…·ä½“æ˜¯ä»€ä¹ˆï¼Œåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬å…ˆæ¥è§‚å¯Ÿä¸€ä¸‹ä¸ç­‰å¼$\eqref{neq:core}$æ‰€è¡¨è¾¾çš„å…·ä½“å«ä¹‰ï¼š</p>
<blockquote>
<p>1ã€å·¦ç«¯ç¬¬ä¸€é¡¹ï¼Œæ˜¯ä¼˜åŒ–è¿‡ç¨‹ä¸­æ¯ä¸€æ­¥çš„æŸå¤±å‡½æ•°çš„å¹³å‡ç»“æœï¼›</p>
<p>2ã€å·¦ç«¯ç¬¬äºŒé¡¹ï¼Œæ ¹æ®å¼$\eqref{eq:loss}$ï¼Œå½“$T$è¶³å¤Ÿå¤§æ—¶å¯ä»¥è®¤ä¸ºå®ƒå°±æ˜¯$L(\boldsymbol{\theta}^*)$ï¼›</p>
<p>3ã€å·¦ç«¯åˆå¹¶èµ·æ¥ï¼Œå°±æ˜¯ä¼˜åŒ–è¿‡ç¨‹ä¸­æŸå¤±å‡½æ•°çš„å¹³å‡ä¸æŸå¤±å‡½æ•°çš„ç†è®ºæœ€å°å€¼ä¹‹å·®ï¼›</p>
<p>4ã€å³ç«¯æ˜¯ä¸€ä¸ªåªä¸å­¦ä¹ ç‡ç­–ç•¥$\{\eta_t\}$æœ‰å…³çš„å¼å­ã€‚</p>
</blockquote>
<p>ç»¼åˆ1ã€2ã€3ã€4ç‚¹ï¼Œä¸ç­‰å¼$\eqref{neq:core}$å°±æ˜¯è¯´ï¼šåœ¨é€‚å½“çš„å‡è®¾ä¹‹ä¸‹ï¼ŒSGDçš„å¹³å‡æŸå¤±ä¸æˆ‘ä»¬è¦å¯»æ‰¾çš„ç†æƒ³ç›®æ ‡çš„å·®è·ï¼Œå¯ä»¥è¢«ä¸€ä¸ªåªä¸å­¦ä¹ ç‡ç­–ç•¥æœ‰å…³çš„å¼å­æ§åˆ¶ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥é€‰æ‹©é€‚å½“çš„å­¦ä¹ ç‡è®©è¯¥å¼è¶‹äºé›¶ï¼Œé‚£ä¹ˆæ„å‘³ç€SGDçš„å¹³å‡æŸå¤±ä¸€å®šèƒ½æ”¶æ•›åˆ°ç†è®ºæœ€ä¼˜ç‚¹ã€‚ï¼ˆå½“ç„¶ï¼Œä»ç†è®ºä¸Šæ¥è¯´ï¼Œè¯¥ç»“è®ºåªèƒ½ä¿è¯æ‰¾åˆ°æŸå¤±å‡½æ•°çš„æœ€å°å€¼$L(\boldsymbol{\theta}^<em>)$ï¼Œä½†æ— æ³•ä¿è¯æ‰¾åˆ°å…·ä½“çš„æœ€å°å€¼ç‚¹$\boldsymbol{\theta}^</em>$ã€‚ï¼‰</p>
<p>è¯´ç™½äº†ï¼Œè¿™å°±æ˜¯å…³äºSGDåœ¨ä»€ä¹ˆæƒ…å†µä¸‹ä¼šæ”¶æ•›çš„ä¸€ä¸ªç†è®ºç»“æœã€‚å¯¹äº†ï¼Œä¸ç­‰å¼$\eqref{neq:core}$å·¦ç«¯æœ‰ä¸€ä¸ªç‰¹åˆ«çš„åå­—ï¼Œå«åšâ€œé—æ†¾â€ï¼ˆRegretï¼Œæœ‰äº›æ•™ç¨‹ä¹Ÿç›´æ¥ç¿»è¯‘ä¸ºâ€œæ‚”â€ï¼‰ã€‚</p>
<h2 id="_3">ä¸¤ä¸ªä¾‹å­</h2>
<p>ä¾‹å¦‚ï¼Œå‡è®¾å­¦ä¹ ç‡æ˜¯å¸¸æ•°$\eta$ï¼Œé‚£ä¹ˆæˆ‘ä»¬æœ‰ä¸ç­‰å¼$\eqref{neq:core}$å³ç«¯æœ‰<br />
\begin{equation}\frac{D^2}{2T\eta} + \frac{G^2}{2T}\sum_{t=1}^T\eta = \frac{D^2}{2T\eta} + \frac{G^2\eta}{2}\geq \frac{DG}{\sqrt{T}}\end{equation}<br />
ç­‰å·æˆç«‹æ—¶$\eta=\frac{D}{G\sqrt{T}}$ï¼Œä¹Ÿå°±æ˜¯è¯´å­¦ä¹ ç‡å–å¸¸æ•°$\frac{D}{G\sqrt{T}}$ï¼Œé‚£ä¹ˆå°±æœ‰<br />
\begin{equation}\frac{1}{T}\sum_{t=1}^T L(\boldsymbol{x}<em t="1">t,\boldsymbol{\theta}_t) - \frac{1}{T}\sum</em>}^T L(\boldsymbol{x}_t,\boldsymbol{\theta}^*)\leq \frac{DG}{\sqrt{T}}\label{neq:case-1}\end{equation<br />
å½“$T\to\infty$æ—¶ï¼Œå³ç«¯è¶‹äºé›¶ï¼Œè¿™æ„å‘³ç€å½“è®­ç»ƒæ­¥æ•°$T$è¶³å¤Ÿå¤§æ—¶ï¼Œå°†å­¦ä¹ ç‡è®¾ä¸ºå¸¸æ•°$\frac{D}{G\sqrt{T}}$ï¼Œå°±å¯ä»¥è®©SGDè¿­ä»£çš„å¹³å‡ä¸ç†è®ºæœ€ä¼˜ç‚¹çš„å·®è·ä»»æ„å°ã€‚</p>
<p>å¦ä¸€ä¸ªä¾‹å­æ˜¯è€ƒè™‘è¡°å‡ç­–ç•¥$\eta_t = \frac{\alpha}{\sqrt{t}}$ï¼Œåˆ©ç”¨<br />
\begin{equation}\sum_{t=1}^T \frac{1}{\sqrt{t}} = 1+\sum_{t=2}^T \frac{1}{\sqrt{t}}\leq 1+\sum_{t=2}^T \frac{2}{\sqrt{t-1} + \sqrt{t}}=1+\sum_{t=2}^T 2(\sqrt{t}-\sqrt{t-1})=2\sqrt{T}-1 &lt; 2\sqrt{T}\end{equation}<br />
ä»£å…¥å¼$\eqref{neq:core}$å¾—åˆ°<br />
\begin{equation}\frac{1}{T}\sum_{t=1}^T L(\boldsymbol{x}<em t="1">t,\boldsymbol{\theta}_t) - \frac{1}{T}\sum</em>}^T L(\boldsymbol{x}_t,\boldsymbol{\theta}^*) &lt; \frac{D^2}{2\alpha\sqrt{T}} + \frac{G^2\alpha}{\sqrt{T}}\label{neq:case-2}\end{equation<br />
å¼$\eqref{neq:case-2}$å’Œå¼$\eqref{neq:case-1}$å…³äº$T$éƒ½æ˜¯$\mathcal{O}\left(\frac{1}{\sqrt{T}}\right)$çš„ï¼Œå› æ­¤ç†è®ºä¸Šå®ƒä»¬éƒ½èƒ½æ”¶æ•›ã€‚è·Ÿå¼$\eqref{neq:case-1}$ç›¸æ¯”ï¼Œå¼$\eqref{neq:case-2}$çš„å¸¸æ•°æ›´å¤§ï¼Œè¿™æ„å‘³ç€$\eta_t\equiv\frac{D}{G\sqrt{T}}$çš„æ”¶æ•›é€Ÿåº¦å¾ˆå¯èƒ½æ¯”$\eta_t = \frac{\alpha}{\sqrt{t}}$å¿«ã€‚ç„¶è€Œï¼Œåœ¨å®é™…ä¸­æˆ‘ä»¬æ›´æ„¿æ„ç”¨åè€…ï¼Œå› ä¸ºå‰è€…çš„éœ€è¦æå‰ç¡®å®šè®­ç»ƒæ€»æ­¥æ•°$T$ï¼Œè®­ç»ƒå®Œå°±ç»“æŸäº†å¹¶ä¸”ç²¾åº¦ä¹Ÿå›ºå®šäº†ï¼Œåè€…å¹¶æ²¡æœ‰è¿™äº›é™åˆ¶ï¼Œç”šè‡³$\alpha$ä¹Ÿä¸éœ€è¦è°ƒï¼Œç›´æ¥$\eta_t = \frac{1}{\sqrt{t}}$å°±å¯ä»¥æŒç»­è®­ç»ƒä¸‹å»ï¼Œå¹¶ä¸”ç†è®ºä¸Šå¹³å‡æŸå¤±ä¸ç†è®ºæœ€å°å€¼çš„å·®è·ä¼šè¶Šæ¥è¶Šå°ã€‚</p>
<p>å¯å³ä¾¿å¦‚æ­¤ï¼Œ$\eta_t = \frac{1}{\sqrt{t}}$è¿™ç§å­¦ä¹ ç‡ç­–ç•¥ï¼Œä¸ç®¡åœ¨é‡çº§æˆ–è€…å˜åŒ–è§„å¾‹ä¸Šéƒ½ä¾ç„¶ä¸æˆ‘ä»¬å¹³æ—¶è®­ç»ƒæ‰€ç”¨çš„ç›¸è·ç”šè¿œï¼Œå› æ­¤ä¸éš¾çŒœæµ‹é‡Œè¾¹å¿…ç„¶åŠ äº†ä¸å°‘å¾ˆå¼ºçš„å‡è®¾ã€‚äº‹ä¸å®œè¿Ÿï¼Œæˆ‘ä»¬é©¬ä¸Šæ¥å±•å¼€è¯æ˜è¿‡ç¨‹ï¼Œé€ä¸€å±•å¼€å…¶ä¸­çš„å‡è®¾ã€‚</p>
<h2 id="_4">è¯æ˜è¿‡ç¨‹</h2>
<p>è¯æ˜çš„å¼€å§‹ï¼Œæˆ‘ä»¬å‡è®¾å¯¹äºä»»æ„$\boldsymbol{x}$ï¼Œ$L(\boldsymbol{x},\boldsymbol{\theta})$éƒ½æ˜¯å…³äº$\boldsymbol{\theta}$çš„å‡¸å‡½æ•°ã€‚è¿™æ˜¯ä¸€ä¸ªéå¸¸å¼ºä¸”é€šå¸¸éå¸¸ä¸ç¬¦åˆè®­ç»ƒäº‹å®çš„å‡è®¾ï¼Œä½†æ²¡åŠæ³•ï¼Œç†è®ºåˆ†æé€šå¸¸éƒ½åªèƒ½åšä¸€äº›å¾ˆå¼ºçš„å‡è®¾ï¼Œç„¶åå°†è¿™äº›å‡è®¾ä¹‹ä¸‹çš„ç»“è®ºå¯å‘æ€§åœ°ç”¨åˆ°å®é™…åœºæ™¯ã€‚</p>
<p>å‡¸å‡½æ•°æœ‰å¾ˆå¤šä¸åŒçš„å®šä¹‰æ–¹å¼ï¼Œè¿™é‡Œç›´æ¥é‡‡ç”¨å¦‚ä¸‹å®šä¹‰ï¼š<br />
\begin{equation}L(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t,\boldsymbol{\theta}_2) - L(\boldsymbol{x}_t,\boldsymbol{\theta}_1) \geq (\boldsymbol{\theta}_2-\boldsymbol{\theta}_1)\cdot\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_1),\quad \forall \boldsymbol{\theta}_1,\boldsymbol{\theta}_2\label{eq:convex}\end{equation}<br />
å…¶ä¸­$\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_1)\triangleq \nabla</em>$çš„æ¢¯åº¦ï¼Œ$\cdot$æ˜¯å‘é‡å†…ç§¯ï¼Œä¸Šè¿°å®šä¹‰çš„å‡ ä½•æ„ä¹‰å°±æ˜¯å‡¸å‡½æ•°çš„å›¾åƒæ€»åœ¨å…¶åˆ‡çº¿ï¼ˆé¢ï¼‰çš„ä¸Šæ–¹ã€‚}}L(\boldsymbol{x}_t,\boldsymbol{\theta})$æ˜¯$L(\boldsymbol{x}_t,\boldsymbol{\theta})$å…³äº$\boldsymbol{\theta</p>
<p>è¯æ˜çš„è¦ç‚¹ï¼Œæ˜¯è€ƒè™‘$\boldsymbol{\theta}<em t_1="t+1">{t+1}$ä¸$\boldsymbol{\theta}^<em>$çš„è·ç¦»ï¼š<br />
\begin{equation}\begin{aligned}<br />
\Vert\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^</em>\Vert^2=&amp;\, \Vert\boldsymbol{\theta}_t - \eta_t \boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t)- \boldsymbol{\theta}^<em>\Vert^2 \\\<br />
=&amp;\, \Vert\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>\Vert^2 - 2\eta_t (\boldsymbol{\theta}_t- \boldsymbol{\theta}^<em>)\cdot\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t) + \eta_t^2\Vert\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t)\Vert^2<br />
\end{aligned}\end{equation}<br />
å°†å®ƒæ”¹å†™æˆ<br />
\begin{equation}(\boldsymbol{\theta}_t- \boldsymbol{\theta}^</em>)\cdot\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t) = \frac{\Vert\boldsymbol{\theta}_t - \boldsymbol{\theta}^<em>\Vert^2}{2\eta_t} - \frac{\Vert\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^</em>\Vert^2}{2\eta_t} + \frac{1}{2}\eta_t\Vert\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t)\Vert^2\end{equation}<br />
æ ¹æ®å¼$\eqref{eq:convex}$ï¼Œæˆ‘ä»¬æœ‰$L(\boldsymbol{x}_t,\boldsymbol{\theta}_t) - L(\boldsymbol{x}_t,\boldsymbol{\theta}^<em>)\leq (\boldsymbol{\theta}_t- \boldsymbol{\theta}^</em>)\cdot\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t)$ï¼Œä»£å…¥ä¸Šå¼æœ‰<br />
\begin{equation}L(\boldsymbol{x}_t,\boldsymbol{\theta}_t) - L(\boldsymbol{x}_t,\boldsymbol{\theta}^<em>)\leq \frac{\Vert\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>\Vert^2}{2\eta_t} - \frac{\Vert\boldsymbol{\theta}</em>^} - \boldsymbol{\theta<em>\Vert^2}{2\eta_t} + \frac{1}{2}\eta_t\Vert\boldsymbol{g}(\boldsymbol{x}<em t="1">t,\boldsymbol{\theta}_t)\Vert^2\end{equation}<br />
ä¸¤ç«¯å¯¹$t=1,2,\cdots,T$æ±‚å’Œï¼š<br />
\begin{equation}\sum</em>}^T L(\boldsymbol{x<em t="1">t,\boldsymbol{\theta}_t) - \sum</em>^}^TL(\boldsymbol{x}_t,\boldsymbol{\theta</em>)\leq \sum_{t=1}^T\left(\frac{\Vert\boldsymbol{\theta}<em t="1">t - \boldsymbol{\theta}^<em>\Vert^2}{2\eta_t} - \frac{\Vert\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^</em>\Vert^2}{2\eta_t}\right) + \sum</em>}^T\frac{1}{2}\eta_t\Vert\boldsymbol{g}(\boldsymbol{x<em t_1="t+1">t,\boldsymbol{\theta}_t)\Vert^2\label{neq:base}\end{equation}<br />
å†æ¬¡å¼•å…¥ä¸€ä¸ªæ–°çš„å‡è®¾â€”â€”$\eta_t$æ˜¯å…³äº$t$çš„å•è°ƒé€’å‡å‡½æ•°ï¼ˆå³$\eta_t\geq \eta</em>}$ï¼‰ï¼Œå¹¶ä¸”è®°$D = \max_t \Vert\boldsymbol{\theta<em t_1="t+1">t - \boldsymbol{\theta}^<em>\Vert$ï¼Œé‚£ä¹ˆå°±æœ‰<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\sum_{t=1}^T\left(\frac{\Vert\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>\Vert^2}{2\eta_t} - \frac{\Vert\boldsymbol{\theta}</em>^} - \boldsymbol{\theta<em>\Vert^2}{2\eta_t}\right)\\\<br />
=&amp;\,\frac{\Vert\boldsymbol{\theta}_1 - \boldsymbol{\theta}^</em>\Vert^2}{2\eta_1} - \frac{\Vert\boldsymbol{\theta}<em t="2">{T+1} - \boldsymbol{\theta}^<em>\Vert^2}{2\eta_T} + \sum_{t=2}^T\left(\frac{1}{2\eta_t} - \frac{1}{2\eta_{t-1}}\right)\Vert\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>\Vert^2\\\<br />
\leq&amp;\,\frac{D^2}{2\eta_1} + \sum</em>\right)D^2\\\}^T\left(\frac{1}{2\eta_t} - \frac{1}{2\eta_{t-1}<br />
=&amp;\, \frac{D^2}{2\eta_T}<br />
\end{aligned}\end{equation}<br />
æœ€åæˆ‘ä»¬è®°$G = \max_t \Vert\boldsymbol{g}(\boldsymbol{x}<em t="1">t,\boldsymbol{\theta}_t)\Vert$ï¼Œç„¶åå°†ä¸Šå¼ä»£å…¥å¼$\eqref{neq:base}$å¾—åˆ°<br />
\begin{equation}\sum</em>}^T L(\boldsymbol{x<em t="1">t,\boldsymbol{\theta}_t) - \sum</em>}^T L(\boldsymbol{x<em t="1">t,\boldsymbol{\theta}^*)\leq \frac{D^2}{2\eta_T} + \sum</em>}^T\frac{1}{2}\eta_t\Vert\boldsymbol{g}(\boldsymbol{x<em t="1">t,\boldsymbol{\theta}_t)\Vert^2\leq \frac{D^2}{2\eta_T} + \frac{G^2}{2}\sum</em>}^T\eta_t\end{equation<br />
æœ€åä¸¤ç«¯é™¤ä»¥$T$å³å¾—ä¸ç­‰å¼$\eqref{neq:core}$ã€‚</p>
<p>æ³¨æ„ç°åœ¨çš„å¸¸æ•°$D,G$æ˜¯ä¼˜åŒ–ç›¸å…³çš„ï¼Œå³å…ˆè¦ç¡®å®šå­¦ä¹ ç‡ç­–ç•¥$\{\eta_t\}$ï¼Œç„¶åå®Œæˆä¼˜åŒ–è¿‡ç¨‹æ‰èƒ½å¾—åˆ°$D,G$ã€‚è¦æƒ³$D,G$æˆä¸ºä¼˜åŒ–æ— å…³çš„å¸¸æ•°ï¼Œæˆ‘ä»¬éœ€è¦å‡è®¾å¯¹äºä»»æ„çš„$\{\eta_t\}$ï¼Œ$\Vert\boldsymbol{\theta}_t - \boldsymbol{\theta}^*\Vert$å’Œ$\Vert\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t)\Vert$éƒ½åˆ†åˆ«ä¸è¶…è¿‡æŸä¸ªå¸¸æ•°$D,G$ï¼Œè¿™æ ·æ‰èƒ½ä½¿å¾—ä¸ç­‰å¼$\eqref{neq:core}$å³ç«¯åªä¸å­¦ä¹ ç‡ç­–ç•¥æœ‰å…³ã€‚</p>
<h2 id="_5">åŸŸå†…æŠ•å½±</h2>
<p>ç„¶è€Œï¼Œæœ€åçš„å‡è®¾â€œå¯¹äºä»»æ„çš„$\{\eta_t\}$ï¼Œ$\Vert\boldsymbol{\theta}_t - \boldsymbol{\theta}^*\Vert$å’Œ$\Vert\boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t)\Vert$éƒ½åˆ†åˆ«ä¸è¶…è¿‡æŸä¸ªå¸¸æ•°$D,G$â€æ€»æœ‰ç§â€œæœ¬æœ«å€’ç½®â€çš„æ„Ÿè§‰ï¼šçœ‹ä¸Šå»éœ€è¦å…ˆå®Œæˆä¼˜åŒ–æ‰èƒ½ç¡®å®š$D,G$ï¼Œè€Œæˆ‘ä»¬çš„ç›®çš„å´æ˜¯è¦é€šè¿‡æ‰€è¯æ˜çš„ç»“æœæ¥æ”¹è¿›ä¼˜åŒ–ã€‚ä¸ºäº†å»æ‰è¿™ç§å¥‡æ€ªçš„æ„Ÿè§‰ï¼Œæˆ‘ä»¬å¹²è„†å°†è¿™ä¸¤ä¸ªå‡è®¾æ”¹ä¸ºï¼š</p>
<blockquote>
<p>1ã€å¼$\eqref{eq:argmin}$ä¸­çš„$\boldsymbol{\theta}\in\mathbb{R}^d$æ”¹ä¸º$\boldsymbol{\theta}\in\boldsymbol{\Theta}$ï¼Œå…¶ä¸­$\boldsymbol{\Theta}\subseteq \mathbb{R}^d$æ˜¯ä¸€ä¸ªæœ‰ç•Œå‡¸é›†ï¼›</p>
<p>1.1ï¼‰<strong>æœ‰ç•Œ</strong> ï¼š$D=\max\limits_{\boldsymbol{\theta}_1,\boldsymbol{\theta}_2\in \boldsymbol{\Theta}}\Vert\boldsymbol{\theta}_1-\boldsymbol{\theta}_2\Vert &lt; \infty$ï¼›</p>
<p>1.2ï¼‰<strong>å‡¸é›†</strong> ï¼š$\forall \boldsymbol{\theta}_1,\boldsymbol{\theta}_2\in \boldsymbol{\Theta}$ä»¥åŠ$\forall\lambda\in[0,1]$ï¼Œéƒ½æœ‰$\lambda \boldsymbol{\theta}_1 + (1-\lambda)\boldsymbol{\theta}_2 \in \boldsymbol{\Theta}$ã€‚</p>
<p>2ã€å¯¹äºä»»æ„$\boldsymbol{\theta}\in \boldsymbol{\Theta}$ä»¥åŠä»»æ„$\boldsymbol{x}$ï¼Œéƒ½æœ‰$\Vert\boldsymbol{g}(\boldsymbol{x},\boldsymbol{\theta})\Vert\leq G$</p>
</blockquote>
<p>ç¬¬2ç‚¹å¯èƒ½æ›´å®¹æ˜“æ¥å—ï¼Œæ— éæ˜¯ç»™æŸå¤±å‡½æ•°$L(\boldsymbol{x},\boldsymbol{\theta})$å†åŠ äº†ä¸ªå‡è®¾è€Œå·²ï¼Œå°±å¥½æ¯”â€œå€ºå¤šä¸æ„â€ï¼Œå‡¸å‡½æ•°è¿™ä¹ˆå¼ºçš„å‡è®¾éƒ½åŠ äº†ï¼Œå†å¤šåŠ ç‚¹ä¹Ÿæ— å¦¨ã€‚ä½†ç¬¬1ç‚¹å‡è®¾ä¼¼ä¹ä¸é‚£ä¹ˆå®¹æ˜“ç†è§£ï¼šå‡¸é›†æ˜¯å› ä¸ºå‡¸å‡½æ•°æœ¬èº«åªèƒ½å®šä¹‰åœ¨å‡¸é›†ä¸Šï¼Œè¿™ä¸ªä¹Ÿèƒ½æ¥å—ï¼Œä½†æœ‰ç•Œå¦‚ä½•ä¿è¯å‘¢ï¼Ÿå³å¦‚ä½•ä¿è¯è¿­ä»£$\eqref{eq:sgd}$çš„è¾“å‡ºä¸€å®šæœ‰ç•Œï¼Ÿ</p>
<p>ç­”æ¡ˆæ˜¯â€œå¤šåŠ ä¸€æ­¥æŠ•å½±â€ã€‚æˆ‘ä»¬å®šä¹‰æŠ•å½±è¿ç®—ï¼š<br />
\begin{equation}\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi}) = \mathop{\text{argmin}}<em t_1="t+1">{\boldsymbol{\theta}\in\boldsymbol{\Theta}}\Vert\boldsymbol{\varphi}-\boldsymbol{\theta}\Vert\end{equation}<br />
å³åœ¨$\boldsymbol{\Theta}$ä¸­æ‰¾åˆ°ä¸$\boldsymbol{\varphi}$æœ€ç›¸è¿‘çš„å‘é‡ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å°†å¼$\eqref{eq:sgd}$æ”¹ä¸º<br />
\begin{equation}\boldsymbol{\theta}</em>} = \Pi_{\boldsymbol{\Theta}}\big(\boldsymbol{\theta}_t - \eta_t \boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t)\big)\in \boldsymbol{\Theta}\label{eq:sgd-p}\end{equation<br />
è¿™å°±èƒ½ä¿è¯è¿­ä»£ç»“æœä¸€å®šåœ¨é›†åˆ$\boldsymbol{\Theta}$ä¸­ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™æ ·ä¿®æ”¹ä¹‹åï¼Œä¸Šä¸€èŠ‚çš„è¯æ˜å’Œå‰é¢çš„ç»“è®ºï¼ˆä¸»è¦æ˜¯ä¸ç­‰å¼$\eqref{neq:core}$ï¼‰è¿˜æˆç«‹å—ï¼Ÿå¾ˆå¹¸è¿ï¼Œè¿˜æˆç«‹ï¼Œæˆ‘ä»¬åªéœ€è¦è¯æ˜å¯¹äºå¼$\eqref{eq:sgd-p}$æ‰€å®šä¹‰çš„æŠ•å½±SGDæœ‰<br />
\begin{equation}\Vert\boldsymbol{\theta}<em _boldsymbol_Theta="\boldsymbol{\Theta">{t+1} - \boldsymbol{\theta}^<em>\Vert \leq \Vert\boldsymbol{\theta}_t - \eta_t \boldsymbol{g}(\boldsymbol{x}_t,\boldsymbol{\theta}_t) - \boldsymbol{\theta}^</em>\Vert\end{equation}<br />
é‚£ä¹ˆâ€œè¯æ˜è¿‡ç¨‹â€ä¸€èŠ‚çš„æ¨å¯¼ä¾ç„¶å¯ä»¥è¿›è¡Œä¸‹å»ï¼Œåªä¸è¿‡éƒ¨åˆ†ç­‰å·å˜æˆ$\leq$è€Œå·²ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬åªéœ€è¦è¯æ˜$\forall \boldsymbol{\varphi}\in\mathbb{R}^d, \boldsymbol{\theta}\in \boldsymbol{\Theta}$ï¼Œéƒ½æœ‰<br />
\begin{equation}\Vert\Pi</em>}} (\boldsymbol{\varphi}) - \boldsymbol{\theta}\Vert \leq \Vert \boldsymbol{\varphi} - \boldsymbol{\theta}\Vert\end{equation</p>
<blockquote>
<p><strong>è¯æ˜</strong> ï¼šè¯æ˜çš„å…³é”®æ˜¯å°†å‡¸é›†å’Œ$\Pi_{\boldsymbol{\Theta}}$çš„å®šä¹‰ç»“åˆèµ·æ¥ã€‚é¦–å…ˆï¼Œæ ¹æ®å‡¸é›†çš„å®šä¹‰ï¼Œæˆ‘ä»¬çŸ¥é“$\forall \lambda\in(0,1)$éƒ½æœ‰$\lambda\boldsymbol{\theta} + (1-\lambda)\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})\in \boldsymbol{\Theta}$ï¼Œäºæ˜¯æ ¹æ®$\Pi_{\boldsymbol{\Theta}}$çš„å®šä¹‰ï¼Œæ’æˆç«‹<br />
 \begin{equation}\Vert\boldsymbol{\varphi} - \Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})\Vert\leq \Vert\boldsymbol{\varphi} - \lambda\boldsymbol{\theta} - (1-\lambda)\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})\Vert = \Vert(\boldsymbol{\varphi} - \Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})) + \lambda(\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})-\boldsymbol{\theta})\Vert\end{equation}<br />
 ä¸¤ç«¯å¹³æ–¹ç„¶åç›¸å‡ï¼Œå¾—åˆ°<br />
 \begin{equation}\lambda^2\Vert\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})-\boldsymbol{\theta}\Vert^2 + 2\lambda(\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})-\boldsymbol{\theta})\cdot(\boldsymbol{\varphi} - \Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi}))\geq 0\end{equation}<br />
 æ³¨æ„æˆ‘ä»¬åˆšé™åˆ¶äº†$\lambda\in(0,1)$ï¼Œæ‰€ä»¥ä¸¤ç«¯å¯ä»¥é™¤ä»¥$\lambda$ï¼š<br />
 \begin{equation}\lambda\Vert\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})-\boldsymbol{\theta}\Vert^2 + 2(\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})-\boldsymbol{\theta})\cdot(\boldsymbol{\varphi} - \Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi}))\geq 0\end{equation}<br />
 è¿™æ˜¯ä¸ªæ’æˆç«‹çš„å¼å­ï¼Œé‚£ä¹ˆå¯¹äº$\lambda\to 0^+$ä¾ç„¶æ˜¯æ’æˆç«‹çš„ï¼Œäºæ˜¯<br />
 \begin{equation}(\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})-\boldsymbol{\theta})\cdot(\boldsymbol{\varphi} - \Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi}))\geq 0\end{equation}<br />
 ä¸¤ç«¯åŠ ä¸Š$\Vert\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})-\boldsymbol{\theta}\Vert^2 + \Vert\boldsymbol{\varphi} - \Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})\Vert^2$ï¼Œå·¦ç«¯æ­£å¥½æ˜¯$\Vert\boldsymbol{\varphi}-\boldsymbol{\theta}\Vert^2$ï¼Œæ‰€ä»¥æœ‰<br />
 \begin{equation}\Vert\boldsymbol{\varphi}-\boldsymbol{\theta}\Vert^2\geq \Vert\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})-\boldsymbol{\theta}\Vert^2 + \Vert\boldsymbol{\varphi} - \Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})\Vert^2 \geq \Vert\Pi_{\boldsymbol{\Theta}} (\boldsymbol{\varphi})-\boldsymbol{\theta}\Vert^2\end{equation}</p>
</blockquote>
<h2 id="_6">å‡è®¾åˆ†æ</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæ•´äº†è¯æ˜è¿‡ç¨‹ã€‚ä»¥ä¸Šç»“æœå‡ºè‡ª<a href="https://www.cs.cmu.edu/~maz/publications/techconvex.pdf">ã€ŠOnline Convex Programming and Generalized Infinitesimal Gradient Ascentã€‹</a>ï¼Œæ˜¯2003å¹´çš„è®ºæ–‡ã€‚ç‰¹åˆ«åœ°ï¼Œä¼˜åŒ–ç›¸å…³çš„æ–‡çŒ®éå¸¸å¤šï¼Œç¬”è€…ä½œä¸ºä¸€ä¸ªåˆå­¦è€…ï¼Œåœ¨åé¢çš„æ–‡çŒ®æº¯æºæ–¹é¢å¤§æ¦‚ç‡ä¼šæœ‰é”™æ¼ï¼Œè¯·äº†è§£çš„è¯»è€…ä¸åæŒ‡æ­£ã€‚</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æ¥â€œç›˜ç‚¹â€ä¸€ä¸‹å®Œæ•´çš„è¯æ˜è¿‡ç¨‹ç”¨åˆ°çš„æ‰€æœ‰å‡è®¾ï¼š</p>
<blockquote>
<p>1ã€$\boldsymbol{\Theta}$æ˜¯ä¸€ä¸ªæœ‰ç•Œå‡¸é›†ï¼Œ$D=\max\limits_{\boldsymbol{\theta}_1,\boldsymbol{\theta}_2\in \boldsymbol{\Theta}}\Vert\boldsymbol{\theta}_1-\boldsymbol{\theta}_2\Vert &lt; \infty$ï¼›</p>
<p>2ã€å¯¹äºä»»æ„$\boldsymbol{\theta}\in \boldsymbol{\Theta}$ä»¥åŠä»»æ„$\boldsymbol{x}$ï¼Œ$L(\boldsymbol{x},\boldsymbol{\theta})$éƒ½æ˜¯å…³äº$\boldsymbol{\theta}$çš„å‡¸å‡½æ•°ï¼›</p>
<p>3ã€å¯¹äºä»»æ„$\boldsymbol{\theta}\in \boldsymbol{\Theta}$ä»¥åŠä»»æ„$\boldsymbol{x}$ï¼Œéƒ½æœ‰$\Vert\nabla_{\boldsymbol{\theta}}L(\boldsymbol{x},\boldsymbol{\theta})\Vert\leq G &lt; \infty$ï¼›</p>
<p>4ã€å­¦ä¹ ç‡$\eta_t$æ˜¯å…³äº$t$çš„å•è°ƒé€’å‡å‡½æ•°ï¼ˆå³$\eta_t\geq \eta_{t+1}$ï¼‰ï¼›</p>
</blockquote>
<p>åœ¨è¿™äº›å‡è®¾ä¹‹ä¸‹ï¼ŒæŠ•å½±SGDå³å¼$\eqref{eq:sgd-p}$æˆç«‹ä¸ç­‰å¼$\eqref{neq:core}$ã€‚</p>
<p>å…¶ä¸­ï¼Œç¬¬1ã€4ç‚¹å‡è®¾éƒ½æ— å¯åšéï¼Œç”šè‡³å¯ä»¥è¯´éå¸¸åˆç†ï¼Œæ¯”å¦‚ç¬¬1ç‚¹ï¼Œå¯¹äºå®é™…è®¡ç®—æ¥è¯´ï¼Œä¸€ä¸ªå……åˆ†å¤§çš„çƒä½“è·Ÿ$\mathbb{R}^d$å¹¶æ²¡æœ‰å®è´¨åŒºåˆ«äº†ï¼Œè€Œç¬¬4ç‚¹é€’å‡çš„å­¦ä¹ ç‡æ›´æ˜¯ç¬¦åˆå·²æœ‰è®¤çŸ¥ï¼›æœ€å¼ºä¸”æœ€ä¸ç¬¦åˆäº‹å®çš„æ˜¯ç¬¬2ç‚¹å‡¸å‡½æ•°å‡è®¾ï¼Œä½†æ²¡åŠæ³•ï¼Œå¤šçœ‹å‡ ç¯‡ä¼˜åŒ–ç›¸å…³çš„æ–‡çŒ®å°±é‡Šç„¶äº†ï¼Œå› ä¸ºå‡ ä¹æ‰€æœ‰ä¼˜åŒ–ç†è®ºéƒ½æ˜¯åŸºäºå‡¸å‡½æ•°å‡è®¾è¿›è¡Œçš„ï¼Œæˆ‘ä»¬åªèƒ½å¯„æœ›äºä¼˜åŒ–è¿›å…¥ä¸€å®šåŒºåŸŸåæŸå¤±å‡½æ•°èƒ½éƒ¨åˆ†ç¬¦åˆå‡¸å‡½æ•°çš„æ€§è´¨ï¼›ç¬¬3ç‚¹æœ¬è´¨ä¸Šä¹Ÿæ˜¯å¾ˆå¼ºçš„å‡è®¾ï¼Œä½†å®é™…è¿ç®—ä¸­å¦‚æœåˆå§‹åŒ–åšå¾—å¥½ï¼Œå¹¶ä¸”å­¦ä¹ ç‡ä¹Ÿè®¾ç½®å¾—é€‚å½“ï¼ŒåŸºæœ¬ä¸Šèƒ½å°†æ¢¯åº¦æ¨¡é•¿æ§åˆ¶åœ¨ä¸€å®šèŒƒå›´å†…ï¼Œå› æ­¤ä¹Ÿé€šå¸¸èƒ½æ¥å—ã€‚</p>
<h2 id="_7">æ–‡ç« å°ç»“</h2>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬é‡æ¸©äº†ä¸€ç¯‡å‡¸ä¼˜åŒ–çš„æ—§è®ºæ–‡ï¼Œä»‹ç»äº†SGDçš„ä¸€ä¸ªéå¸¸åŸºç¡€çš„æ”¶æ•›æ€§è¯æ˜ï¼šåœ¨é€‚å½“ï¼ˆå®é™…ä¸Šéå¸¸å¼ºï¼‰çš„å‡è®¾ä¸‹ï¼ŒSGDçš„æ”¶æ•›æ€§å¯ä»¥å¾—åˆ°ä¿è¯ã€‚å°½ç®¡è¿™äº›å‡è®¾åœ¨å®é™…åº”ç”¨ä¸­å¯èƒ½å¹¶ä¸æ€»æ˜¯æˆç«‹ï¼Œä¾‹å¦‚å‡¸å‡½æ•°å‡è®¾å’Œæ¢¯åº¦æ¨¡é•¿çš„é™åˆ¶ï¼Œä½†è¿™äº›ç†è®ºç»“æœä»èƒ½ä¸ºæˆ‘ä»¬æä¾›äº†å…³äºSGDæ”¶æ•›æ€§çš„é‡è¦è§è§£ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9902">https://spaces.ac.cn/archives/9902</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Dec. 19, 2023). ã€Šè®©ç‚¼ä¸¹æ›´ç§‘å­¦ä¸€äº›ï¼ˆä¸€ï¼‰ï¼šSGDçš„å¹³å‡æŸå¤±æ”¶æ•› ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9902">https://spaces.ac.cn/archives/9902</a></p>
<p>@online{kexuefm-9902,<br />
title={è®©ç‚¼ä¸¹æ›´ç§‘å­¦ä¸€äº›ï¼ˆä¸€ï¼‰ï¼šSGDçš„å¹³å‡æŸå¤±æ”¶æ•›},<br />
author={è‹å‰‘æ—},<br />
year={2023},<br />
month={Dec},<br />
url={\url{https://spaces.ac.cn/archives/9902}},<br />
} </p>
<hr />
<h2 id="_8">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1-sgd">1. åŸºç¡€SGDæ”¶æ•›æ€§ç†è®º</h3>
<p>è®©æˆ‘ä»¬ä»æœ€åŸºç¡€çš„SGDç®—æ³•å¼€å§‹,ç³»ç»Ÿåœ°æ¨å¯¼å…¶æ”¶æ•›æ€§è´¨ã€‚</p>
<h4 id="11">1.1 å‡¸å‡½æ•°æƒ…å†µä¸‹çš„æ”¶æ•›æ€§</h4>
<p>å¯¹äºå‡¸å‡½æ•°$L(\boldsymbol{\theta})$,æˆ‘ä»¬æœ‰å‡¸æ€§å®šä¹‰:
\begin{equation}L(\boldsymbol{\theta}_2) \geq L(\boldsymbol{\theta}_1) + \nabla L(\boldsymbol{\theta}_1)^{\top}(\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1)\tag{1}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>:è¿™ä¸ªä¸ç­‰å¼è¯´æ˜,å‡¸å‡½æ•°æ€»æ˜¯ä½äºå…¶ä»»æ„ç‚¹çš„åˆ‡å¹³é¢ä¸Šæ–¹ã€‚è¿™æ˜¯å‡¸ä¼˜åŒ–çš„åŸºçŸ³ã€‚</p>
<p>å–$\boldsymbol{\theta}_1 = \boldsymbol{\theta}_t$,$\boldsymbol{\theta}_2 = \boldsymbol{\theta}^<em>$,æˆ‘ä»¬å¾—åˆ°:
\begin{equation}L(\boldsymbol{\theta}^</em>) \geq L(\boldsymbol{\theta}_t) + \nabla L(\boldsymbol{\theta}_t)^{\top}(\boldsymbol{\theta}^* - \boldsymbol{\theta}_t)\tag{2}\end{equation}</p>
<p>æ”¹å†™ä¸º:
\begin{equation}L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^<em>) \leq \nabla L(\boldsymbol{\theta}_t)^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>)\tag{3}\end{equation}</p>
<p>è¿™ä¸ªä¸ç­‰å¼ç»™å‡ºäº†å½“å‰æŸå¤±ä¸æœ€ä¼˜æŸå¤±ä¹‹é—´çš„å·®è·ä¸Šç•Œã€‚</p>
<h4 id="12">1.2 è·ç¦»é€’æ¨å…³ç³»</h4>
<p>è€ƒè™‘SGDæ›´æ–°:$\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \eta_t \boldsymbol{g}_t$,å…¶ä¸­$\boldsymbol{g}_t$æ˜¯æ¢¯åº¦çš„æ— åä¼°è®¡ã€‚</p>
<p>è®¡ç®—$\boldsymbol{\theta}_{t+1}$åˆ°æœ€ä¼˜ç‚¹$\boldsymbol{\theta}^<em>$çš„è·ç¦»å¹³æ–¹:
\begin{equation}\begin{aligned}
|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^</em>|^2 &amp;= |\boldsymbol{\theta}_t - \eta_t \boldsymbol{g}_t - \boldsymbol{\theta}^<em>|^2\
&amp;= |\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2 - 2\eta_t \boldsymbol{g}_t^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^*) + \eta_t^2|\boldsymbol{g}_t|^2
\end{aligned}\tag{4}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>:è¿™ä¸ªå±•å¼€å¼åŒ…å«ä¸‰é¡¹:
- ç¬¬ä¸€é¡¹:å½“å‰è·ç¦»çš„å¹³æ–¹
- ç¬¬äºŒé¡¹:æ¢¯åº¦æ–¹å‘å¯¹è·ç¦»å‡å°‘çš„è´¡çŒ®(è´Ÿé¡¹,ä½¿è·ç¦»å‡å°)
- ç¬¬ä¸‰é¡¹:ç”±äºæ­¥é•¿å¼•å…¥çš„å™ªå£°(æ­£é¡¹,ä½¿è·ç¦»å¯èƒ½å¢å¤§)</p>
<h4 id="13">1.3 æœŸæœ›åˆ†æ</h4>
<p>å¯¹å¼(4)ä¸¤è¾¹å–æœŸæœ›:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^<em>|^2] = \mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - 2\eta_t \mathbb{E}[\boldsymbol{g}_t^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^*)] + \eta_t^2\mathbb{E}[|\boldsymbol{g}_t|^2]\tag{5}\end{equation}</p>
<p>ç”±äº$\mathbb{E}[\boldsymbol{g}_t|\boldsymbol{\theta}_t] = \nabla L(\boldsymbol{\theta}_t)$,æˆ‘ä»¬æœ‰:
\begin{equation}\mathbb{E}[\boldsymbol{g}_t^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^<em>)] = \mathbb{E}[\nabla L(\boldsymbol{\theta}_t)^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>)] \geq \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^*)]\tag{6}\end{equation}</p>
<p>å…¶ä¸­ä¸ç­‰å·ç”±å‡¸æ€§(å¼3)å¾—åˆ°ã€‚</p>
<h4 id="14">1.4 æ¢¯åº¦æ–¹å·®ç•Œ</h4>
<p>å®šä¹‰æ¢¯åº¦çš„æ–¹å·®:
\begin{equation}\sigma_t^2 = \mathbb{E}[|\boldsymbol{g}_t - \nabla L(\boldsymbol{\theta}_t)|^2]\tag{7}\end{equation}</p>
<p>åˆ©ç”¨$\mathbb{E}[|\boldsymbol{g}_t|^2] = |\nabla L(\boldsymbol{\theta}_t)|^2 + \sigma_t^2$,æˆ‘ä»¬æœ‰:
\begin{equation}\mathbb{E}[|\boldsymbol{g}_t|^2] \leq G^2 + \sigma_t^2 \leq G^2 + \sigma^2\tag{8}\end{equation}</p>
<p>å…¶ä¸­$G = \sup_{\boldsymbol{\theta}}|\nabla L(\boldsymbol{\theta})|$æ˜¯æ¢¯åº¦çš„ä¸Šç•Œ,$\sigma^2 = \sup_t \sigma_t^2$æ˜¯æ–¹å·®çš„ä¸Šç•Œã€‚</p>
<h4 id="15">1.5 ä¸»è¦ä¸ç­‰å¼æ¨å¯¼</h4>
<p>ç»“åˆå¼(5)ã€(6)ã€(8),æˆ‘ä»¬å¾—åˆ°:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^<em>|^2] \leq \mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - 2\eta_t \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^*)] + \eta_t^2(G^2 + \sigma^2)\tag{9}\end{equation}</p>
<p>æ”¹å†™ä¸º:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}<em t_1="t+1">t) - L(\boldsymbol{\theta}^<em>)] \leq \frac{\mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - \mathbb{E}[|\boldsymbol{\theta}</em>} - \boldsymbol{\theta}^*|^2]}{2\eta_t} + \frac{\eta_t(G^2 + \sigma^2)}{2}\tag{10}\end{equation</p>
<h3 id="2">2. ä¸åŒå‡¸æ€§æ¡ä»¶ä¸‹çš„æ”¶æ•›ç‡</h3>
<h4 id="21">2.1 ä¸€èˆ¬å‡¸å‡½æ•°</h4>
<p>å¯¹å¼(10)åœ¨$t=1,\ldots,T$ä¸Šæ±‚å’Œ:
\begin{equation}\sum_{t=1}^T \mathbb{E}[L(\boldsymbol{\theta}<em t="1">t) - L(\boldsymbol{\theta}^<em>)] \leq \frac{|\boldsymbol{\theta}_1 - \boldsymbol{\theta}^</em>|^2}{2\eta_1} + \frac{G^2 + \sigma^2}{2}\sum</em>}^T \eta_t\tag{11}\end{equation</p>
<p><strong>å®šç†1</strong>(ä¸€èˆ¬å‡¸å‡½æ•°æ”¶æ•›): è‹¥$\eta_t = \frac{D}{G\sqrt{T}}$,å…¶ä¸­$D = |\boldsymbol{\theta}_1 - \boldsymbol{\theta}^<em>|$,åˆ™:
\begin{equation}\frac{1}{T}\sum_{t=1}^T \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^</em>)] \leq \frac{DG}{\sqrt{T}} + \frac{D\sigma}{2G\sqrt{T}} = \mathcal{O}\left(\frac{1}{\sqrt{T}}\right)\tag{12}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: $\mathcal{O}(1/\sqrt{T})$æ”¶æ•›ç‡æ„å‘³ç€è¦è¾¾åˆ°$\epsilon$ç²¾åº¦,éœ€è¦$\mathcal{O}(1/\epsilon^2)$æ­¥è¿­ä»£ã€‚è¿™åœ¨å‡¸ä¼˜åŒ–ä¸­æ˜¯æ¬¡çº¿æ€§æ”¶æ•›ã€‚</p>
<h4 id="22">2.2 å¼ºå‡¸å‡½æ•°</h4>
<p>è‹¥$L(\boldsymbol{\theta})$æ˜¯$\mu$-å¼ºå‡¸çš„,å³:
\begin{equation}L(\boldsymbol{\theta}_2) \geq L(\boldsymbol{\theta}_1) + \nabla L(\boldsymbol{\theta}_1)^{\top}(\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1) + \frac{\mu}{2}|\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1|^2\tag{13}\end{equation}</p>
<p>å–$\boldsymbol{\theta}_1 = \boldsymbol{\theta}^<em>$(æ³¨æ„$\nabla L(\boldsymbol{\theta}^</em>) = 0$):
\begin{equation}L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^<em>) \geq \frac{\mu}{2}|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2\tag{14}\end{equation}</p>
<p>ç»“åˆå¼(9),é€‰æ‹©å›ºå®šå­¦ä¹ ç‡$\eta_t = \eta = \frac{1}{\mu}$:
\begin{equation}\begin{aligned}
\mathbb{E}[|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^<em>|^2] &amp;\leq \mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - \frac{2}{\mu}\mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^<em>)] + \frac{G^2 + \sigma^2}{\mu^2}\
&amp;\leq \mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - |\boldsymbol{\theta}_t - \boldsymbol{\theta}^*|^2 + \frac{G^2 + \sigma^2}{\mu^2}\
&amp;= \frac{G^2 + \sigma^2}{\mu^2}
\end{aligned}\tag{15}\end{equation}</p>
<p><strong>å®šç†2</strong>(å¼ºå‡¸å‡½æ•°æ”¶æ•›): è‹¥$\eta = \frac{1}{\mu}$,åˆ™:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_T - \boldsymbol{\theta}^*|^2] \leq \frac{G^2 + \sigma^2}{\mu^2}\tag{16}\end{equation}</p>
<p>æ›´ç²¾ç»†çš„åˆ†æ(ä½¿ç”¨é€’å‡å­¦ä¹ ç‡$\eta_t = \frac{2}{\mu(t+1)}$)å¯ä»¥å¾—åˆ°:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L(\boldsymbol{\theta}^*)] \leq \frac{2(G^2 + \sigma^2)}{\mu T} = \mathcal{O}\left(\frac{1}{T}\right)\tag{17}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: $\mathcal{O}(1/T)$æ”¶æ•›ç‡æ¯”ä¸€èˆ¬å‡¸å‡½æ•°å¿«,è¾¾åˆ°$\epsilon$ç²¾åº¦åªéœ€$\mathcal{O}(1/\epsilon)$æ­¥ã€‚</p>
<h4 id="23">2.3 å…‰æ»‘å‡¸å‡½æ•°</h4>
<p>è‹¥$L(\boldsymbol{\theta})$æ˜¯$L$-å…‰æ»‘çš„,å³æ¢¯åº¦æ»¡è¶³Lipschitzæ¡ä»¶:
\begin{equation}|\nabla L(\boldsymbol{\theta}_1) - \nabla L(\boldsymbol{\theta}_2)| \leq L|\boldsymbol{\theta}_1 - \boldsymbol{\theta}_2|\tag{18}\end{equation}</p>
<p>ç­‰ä»·åœ°,æœ‰äºŒæ¬¡ä¸Šç•Œ:
\begin{equation}L(\boldsymbol{\theta}_2) \leq L(\boldsymbol{\theta}_1) + \nabla L(\boldsymbol{\theta}_1)^{\top}(\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1) + \frac{L}{2}|\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1|^2\tag{19}\end{equation}</p>
<p>å¯¹äºå…‰æ»‘å‡¸å‡½æ•°,ä½¿ç”¨å›ºå®šå­¦ä¹ ç‡$\eta = \frac{1}{L}$:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_{t+1})] \leq \mathbb{E}[L(\boldsymbol{\theta}_t)] - \frac{1}{2L}|\nabla L(\boldsymbol{\theta}_t)|^2 + \frac{\sigma^2}{2L}\tag{20}\end{equation}</p>
<p><strong>å®šç†3</strong>(å…‰æ»‘å‡¸å‡½æ•°æ”¶æ•›): è‹¥$\eta = \frac{1}{L}$,åˆ™:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L(\boldsymbol{\theta}^*)] \leq \frac{LD^2}{2T} + \frac{\sigma^2}{2L} = \mathcal{O}\left(\frac{1}{T}\right) + \mathcal{O}(\sigma^2)\tag{21}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å…‰æ»‘æ€§å…è®¸æˆ‘ä»¬ä½¿ç”¨å›ºå®šå­¦ä¹ ç‡,å¹¶è·å¾—çº¿æ€§æ”¶æ•›ç‡ã€‚ä½†éšæœºæ¢¯åº¦çš„æ–¹å·®$\sigma^2$ä¼šäº§ç”Ÿä¸€ä¸ªæ’å®šçš„è¯¯å·®ä¸‹ç•Œã€‚</p>
<h4 id="24">2.4 å¼ºå‡¸ä¸”å…‰æ»‘å‡½æ•°</h4>
<p>è‹¥$L(\boldsymbol{\theta})$åŒæ—¶æ˜¯$\mu$-å¼ºå‡¸å’Œ$L$-å…‰æ»‘çš„,å®šä¹‰æ¡ä»¶æ•°$\kappa = L/\mu$ã€‚</p>
<p>ä½¿ç”¨å›ºå®šå­¦ä¹ ç‡$\eta = \frac{2}{L + \mu}$:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^<em>|^2] \leq \left(1 - \frac{2\mu}{L+\mu}\right)\mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] + \frac{2\sigma^2}{(L+\mu)^2}\tag{22}\end{equation}</p>
<p>é€’æ¨å¾—åˆ°:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_T - \boldsymbol{\theta}^*|^2] \leq \left(1 - \frac{2}{\kappa+1}\right)^T D^2 + \frac{2\kappa\sigma^2}{L^2(\kappa+1)}\tag{23}\end{equation}</p>
<p><strong>å®šç†4</strong>(å¼ºå‡¸å…‰æ»‘å‡½æ•°æ”¶æ•›): è¾¾åˆ°$\epsilon$ç²¾åº¦éœ€è¦:
\begin{equation}T = \mathcal{O}\left(\kappa\log\frac{1}{\epsilon}\right)\tag{24}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: è¿™æ˜¯çº¿æ€§æ”¶æ•›ç‡,è¿œå¿«äºæ¬¡çº¿æ€§æ”¶æ•›ã€‚æ¡ä»¶æ•°$\kappa$è¶Šå°,æ”¶æ•›è¶Šå¿«ã€‚</p>
<h3 id="3">3. éå‡¸å‡½æ•°æƒ…å†µ</h3>
<p>å¯¹äºéå‡¸å‡½æ•°,æˆ‘ä»¬æ— æ³•ä¿è¯æ”¶æ•›åˆ°å…¨å±€æœ€ä¼˜,ä½†å¯ä»¥åˆ†ææ”¶æ•›åˆ°é©»ç‚¹çš„æ€§è´¨ã€‚</p>
<h4 id="31">3.1 å…‰æ»‘éå‡¸å‡½æ•°</h4>
<p>å‡è®¾$L(\boldsymbol{\theta})$æ˜¯$L$-å…‰æ»‘çš„(æ»¡è¶³å¼19),ä½†ä¸ä¸€å®šæ˜¯å‡¸çš„ã€‚</p>
<p>ä»å¼(19)å‡ºå‘,å–$\boldsymbol{\theta}<em t_1="t+1">2 = \boldsymbol{\theta}</em>} = \boldsymbol{\theta<em t_1="t+1">t - \eta_t \boldsymbol{g}_t$:
\begin{equation}\begin{aligned}
L(\boldsymbol{\theta}</em>_t|^2
\end{aligned}\tag{25}\end{equation}}) &amp;\leq L(\boldsymbol{\theta}_t) - \eta_t \nabla L(\boldsymbol{\theta}_t)^{\top}\boldsymbol{g}_t + \frac{L\eta_t^2}{2}|\boldsymbol{g</p>
<p>å–æœŸæœ›:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_{t+1})] \leq \mathbb{E}[L(\boldsymbol{\theta}_t)] - \eta_t\mathbb{E}[|\nabla L(\boldsymbol{\theta}_t)|^2] + \frac{L\eta_t^2}{2}(G^2 + \sigma^2)\tag{26}\end{equation}</p>
<p>å¯¹$t=1,\ldots,T$æ±‚å’Œ:
\begin{equation}\sum_{t=1}^T \eta_t\mathbb{E}[|\nabla L(\boldsymbol{\theta}<em t="1">t)|^2] \leq L(\boldsymbol{\theta}_1) - \mathbb{E}[L(\boldsymbol{\theta}_T)] + \frac{L(G^2 + \sigma^2)}{2}\sum</em>}^T \eta_t^2\tag{27}\end{equation</p>
<p>å‡è®¾$L(\boldsymbol{\theta})$æœ‰ä¸‹ç•Œ$L^* = \inf_{\boldsymbol{\theta}} L(\boldsymbol{\theta})$,åˆ™:
\begin{equation}\sum_{t=1}^T \eta_t\mathbb{E}[|\nabla L(\boldsymbol{\theta}<em t="1">t)|^2] \leq \Delta + \frac{L(G^2 + \sigma^2)}{2}\sum</em>}^T \eta_t^2\tag{28}\end{equation</p>
<p>å…¶ä¸­$\Delta = L(\boldsymbol{\theta}_1) - L^*$ã€‚</p>
<p><strong>å®šç†5</strong>(éå‡¸å‡½æ•°ä¸€é˜¶é©»ç‚¹): è‹¥$\eta_t = \eta = \frac{1}{L}$,åˆ™:
\begin{equation}\min_{1\leq t\leq T}\mathbb{E}[|\nabla L(\boldsymbol{\theta}<em t="1">t)|^2] \leq \frac{\sum</em>}^T \eta_t\mathbb{E}[|\nabla L(\boldsymbol{\theta<em t="1">t)|^2]}{\sum</em>}^T \eta_t} \leq \frac{L\Delta}{T} + \frac{G^2 + \sigma^2}{2} = \mathcal{O}\left(\frac{1}{T}\right)\tag{29}\end{equation</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å¯¹äºéå‡¸å‡½æ•°,æˆ‘ä»¬ä¿è¯èƒ½æ‰¾åˆ°æ¢¯åº¦èŒƒæ•°å°çš„ç‚¹(ä¸€é˜¶é©»ç‚¹),ä½†ä¸ä¿è¯æ˜¯å±€éƒ¨æˆ–å…¨å±€æœ€ä¼˜ã€‚</p>
<h4 id="32-polyak-ojasiewiczpl">3.2 Polyak-Åojasiewicz(PL)æ¡ä»¶</h4>
<p>PLæ¡ä»¶æ˜¯ä¸€ä¸ªæ¯”å¼ºå‡¸æ›´å¼±ä½†æ¯”ä¸€èˆ¬éå‡¸æ›´å¼ºçš„æ¡ä»¶:
\begin{equation}\frac{1}{2}|\nabla L(\boldsymbol{\theta})|^2 \geq \mu(L(\boldsymbol{\theta}) - L^*)\tag{30}\end{equation}</p>
<p>æ»¡è¶³PLæ¡ä»¶çš„å‡½æ•°å¯èƒ½æ˜¯éå‡¸çš„,ä½†ä»èƒ½ä¿è¯å…¨å±€æ”¶æ•›ã€‚</p>
<p><strong>å®šç†6</strong>(PLæ¡ä»¶ä¸‹çš„æ”¶æ•›): è‹¥$L(\boldsymbol{\theta})$æ»¡è¶³PLæ¡ä»¶ä¸”$L$-å…‰æ»‘,ä½¿ç”¨$\eta = \frac{1}{L}$:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L^<em>] \leq \left(1 - \frac{\mu}{L}\right)^T(L(\boldsymbol{\theta}_1) - L^</em>) + \frac{\sigma^2}{2\mu}\tag{31}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: PLæ¡ä»¶ä¿è¯çº¿æ€§æ”¶æ•›,å³ä½¿å‡½æ•°éå‡¸ã€‚è®¸å¤šç¥ç»ç½‘ç»œåœ¨è¿‡å‚æ•°åŒ–æ—¶æ»¡è¶³PLæ¡ä»¶ã€‚</p>
<h3 id="4">4. æ–¹å·®å‡å°‘æŠ€æœ¯</h3>
<p>éšæœºæ¢¯åº¦çš„æ–¹å·®$\sigma^2$æ˜¯å½±å“SGDæ”¶æ•›çš„å…³é”®å› ç´ ã€‚æ–¹å·®å‡å°‘æŠ€æœ¯æ—¨åœ¨é™ä½è¿™ä¸ªæ–¹å·®ã€‚</p>
<h4 id="41-svrg">4.1 SVRGç®—æ³•</h4>
<p><strong>éšæœºæ–¹å·®å‡å°‘æ¢¯åº¦</strong>(SVRG)çš„æ ¸å¿ƒæ€æƒ³æ˜¯å‘¨æœŸæ€§è®¡ç®—å…¨æ¢¯åº¦ä½œä¸ºå‚è€ƒç‚¹ã€‚</p>
<p><strong>ç®—æ³•æ¡†æ¶</strong>:
- å¤–å¾ªç¯:æ¯$m$æ­¥è®¡ç®—ä¸€æ¬¡å…¨æ¢¯åº¦$\tilde{\boldsymbol{g}} = \nabla L(\tilde{\boldsymbol{\theta}})$
- å†…å¾ªç¯:ä½¿ç”¨æ–¹å·®å‡å°‘çš„æ¢¯åº¦ä¼°è®¡
\begin{equation}\boldsymbol{v}_t = \nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) - \nabla L(\boldsymbol{x}_t, \tilde{\boldsymbol{\theta}}) + \tilde{\boldsymbol{g}}\tag{32}\end{equation}</p>
<p><strong>æ–¹å·®åˆ†æ</strong>:
\begin{equation}\mathbb{E}[\boldsymbol{v}_t] = \nabla L(\boldsymbol{\theta}_t)\tag{33}\end{equation}
\begin{equation}\mathbb{E}[|\boldsymbol{v}_t - \nabla L(\boldsymbol{\theta}_t)|^2] \leq 2L^2|\boldsymbol{\theta}_t - \tilde{\boldsymbol{\theta}}|^2\tag{34}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: $\boldsymbol{v}_t$æ˜¯æ— åçš„,ä¸”æ–¹å·®éšç€$\boldsymbol{\theta}_t$æ¥è¿‘$\tilde{\boldsymbol{\theta}}$è€Œå‡å°ã€‚</p>
<p><strong>å®šç†7</strong>(SVRGæ”¶æ•›ç‡): å¯¹äº$\mu$-å¼ºå‡¸$L$-å…‰æ»‘å‡½æ•°:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L^<em>] \leq \left(1 - \min\left{\frac{\mu}{3L}, \frac{1}{3m}\right}\right)^T(L(\boldsymbol{\theta}_0) - L^</em>)\tag{35}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: SVRGè¾¾åˆ°çº¿æ€§æ”¶æ•›ç‡,ä¸”æ”¶æ•›é€Ÿåº¦ä¸ä¾èµ–äºæ•°æ®é›†å¤§å°$n$,åªä¾èµ–äºæ¡ä»¶æ•°$\kappa$ã€‚</p>
<h4 id="42-saga">4.2 SAGAç®—æ³•</h4>
<p>SAGAç»´æŠ¤æ‰€æœ‰æ ·æœ¬æ¢¯åº¦çš„è¡¨æ ¼,é¿å…äº†SVRGçš„å†…å¤–å¾ªç¯ç»“æ„ã€‚</p>
<p><strong>æ›´æ–°è§„åˆ™</strong>:
\begin{equation}\boldsymbol{v}<em i="1">t = \nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) - \boldsymbol{g}_t^{old}(\boldsymbol{x}_t) + \frac{1}{n}\sum</em>}^n \boldsymbol{g}_t^{old}(\boldsymbol{x}_i)\tag{36}\end{equation</p>
<p>å…¶ä¸­$\boldsymbol{g}_t^{old}(\boldsymbol{x}_i)$æ˜¯å­˜å‚¨çš„ç¬¬$i$ä¸ªæ ·æœ¬çš„æ—§æ¢¯åº¦ã€‚</p>
<p><strong>å®šç†8</strong>(SAGAæ”¶æ•›ç‡): å¯¹äº$\mu$-å¼ºå‡¸$L$-å…‰æ»‘å‡½æ•°:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_T - \boldsymbol{\theta}^<em>|^2] \leq \left(1 - \min\left{\frac{1}{3\kappa}, \frac{1}{3n}\right}\right)^T|\boldsymbol{\theta}_0 - \boldsymbol{\theta}^</em>|^2\tag{37}\end{equation}</p>
<h4 id="43">4.3 æ–¹å·®å‡å°‘çš„å‡ ä½•è§£é‡Š</h4>
<p>è€ƒè™‘æ¢¯åº¦ç©ºé—´ä¸­çš„åˆ†è§£:
\begin{equation}\nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) = \nabla L(\boldsymbol{\theta}_t) + [\nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) - \nabla L(\boldsymbol{\theta}_t)]\tag{38}\end{equation}</p>
<p>ç¬¬äºŒé¡¹æ˜¯å™ªå£°ã€‚SVRG/SAGAé€šè¿‡å‡å»ç›¸å…³å™ªå£°$\nabla L(\boldsymbol{x}_t, \tilde{\boldsymbol{\theta}})$æ¥å‡å°‘æ–¹å·®:
\begin{equation}\nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) - \nabla L(\boldsymbol{x}_t, \tilde{\boldsymbol{\theta}}) \approx \nabla^2 L(\tilde{\boldsymbol{\theta}})(\boldsymbol{\theta}_t - \tilde{\boldsymbol{\theta}})\tag{39}\end{equation}</p>
<p>è¿™å¯ä»¥çœ‹ä½œæ˜¯å¯¹å™ªå£°çš„çº¿æ€§è¿‘ä¼¼å’Œè¡¥å¿ã€‚</p>
<h3 id="5">5. å­¦ä¹ ç‡è°ƒåº¦ç­–ç•¥</h3>
<p>å­¦ä¹ ç‡çš„é€‰æ‹©å¯¹SGDæ”¶æ•›è‡³å…³é‡è¦ã€‚</p>
<h4 id="51">5.1 å¸¸æ•°å­¦ä¹ ç‡</h4>
<p><strong>ä¼˜ç‚¹</strong>: ç®€å•,ä¸éœ€è¦è°ƒå‚
<strong>ç¼ºç‚¹</strong>: å­˜åœ¨æ”¶æ•›è¯¯å·®ä¸‹ç•Œ</p>
<p>å¯¹äºå¼ºå‡¸å‡½æ•°,å›ºå®š$\eta = \frac{1}{L}$:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L^*] \leq \frac{\sigma^2}{2\mu}\tag{40}\end{equation}</p>
<p>æ— æ³•æ”¶æ•›åˆ°ç²¾ç¡®æœ€ä¼˜,è¯¯å·®ä¸æ–¹å·®æˆæ­£æ¯”ã€‚</p>
<h4 id="52">5.2 å¤šé¡¹å¼è¡°å‡</h4>
<p>å¸¸ç”¨çš„è¡°å‡ç­–ç•¥:$\eta_t = \frac{\eta_0}{(1 + t)^{\alpha}}$,å…¶ä¸­$\alpha \in (0.5, 1]$ã€‚</p>
<p><strong>Robbins-Monroæ¡ä»¶</strong>: ä¸ºä¿è¯æ”¶æ•›,å­¦ä¹ ç‡éœ€æ»¡è¶³:
\begin{equation}\sum_{t=1}^{\infty} \eta_t = \infty, \quad \sum_{t=1}^{\infty} \eta_t^2 &lt; \infty\tag{41}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: ç¬¬ä¸€ä¸ªæ¡ä»¶ä¿è¯èƒ½å¤Ÿåˆ°è¾¾ä»»æ„è¿œçš„ç‚¹,ç¬¬äºŒä¸ªæ¡ä»¶ä¿è¯ç´¯ç§¯å™ªå£°æœ‰ç•Œã€‚</p>
<p>å¯¹äº$\eta_t = \frac{\eta_0}{\sqrt{t}}$:
\begin{equation}\frac{1}{T}\sum_{t=1}^T \mathbb{E}[L(\boldsymbol{\theta}_t) - L^*] = \mathcal{O}\left(\frac{\log T}{\sqrt{T}}\right)\tag{42}\end{equation}</p>
<h4 id="53">5.3 æŒ‡æ•°è¡°å‡</h4>
<p>æŒ‡æ•°è¡°å‡:$\eta_t = \eta_0 \gamma^t$,å…¶ä¸­$\gamma \in (0, 1)$ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>: å¿«é€Ÿé™ä½å­¦ä¹ ç‡,é€‚åˆå¼ºå‡¸å‡½æ•°
<strong>ç¼ºç‚¹</strong>: ä¸æ»¡è¶³Robbins-Monroæ¡ä»¶,å¯èƒ½è¿‡æ—©åœæ­¢</p>
<p>å®è·µä¸­å¸¸ç”¨åˆ†æ®µæŒ‡æ•°è¡°å‡:
\begin{equation}\eta_t = \eta_0 \gamma^{\lfloor t/T_0 \rfloor}\tag{43}\end{equation}</p>
<p>æ¯$T_0$æ­¥è¡°å‡ä¸€æ¬¡ã€‚</p>
<h4 id="54-cosine-annealing">5.4 Cosine Annealing</h4>
<p>ä½™å¼¦é€€ç«:
\begin{equation}\eta_t = \eta_{min} + \frac{1}{2}(\eta_{max} - \eta_{min})\left(1 + \cos\left(\frac{t\pi}{T}\right)\right)\tag{44}\end{equation}</p>
<p><strong>ä¼˜ç‚¹</strong>: å¹³æ»‘è¡°å‡,åœ¨è®­ç»ƒåæœŸæœ‰å°å¹…å¢åŠ ,æœ‰åŠ©äºè·³å‡ºå±€éƒ¨æœ€ä¼˜
<strong>æ•°å­¦ç›´è§‰</strong>: æ¨¡æ‹Ÿç‰©ç†é€€ç«è¿‡ç¨‹,é€æ¸é™æ¸©ä½†å¶å°”å‡æ¸©ä»¥æ¢ç´¢ã€‚</p>
<h4 id="55-warm-restart">5.5 Warm Restart</h4>
<p>å¾ªç¯ä½™å¼¦é€€ç«(SGDR):
\begin{equation}\eta_t = \eta_{min} + \frac{1}{2}(\eta_{max} - \eta_{min})\left(1 + \cos\left(\frac{T_{cur}}{T_i}\pi\right)\right)\tag{45}\end{equation}</p>
<p>å…¶ä¸­$T_{cur}$æ˜¯å½“å‰å‘¨æœŸå†…çš„æ­¥æ•°,$T_i$æ˜¯ç¬¬$i$ä¸ªå‘¨æœŸçš„é•¿åº¦ã€‚</p>
<p>å‘¨æœŸé•¿åº¦é€šå¸¸é€’å¢:$T_{i+1} = T_i \times T_{mult}$(å¦‚$T_{mult} = 2$)ã€‚</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å‘¨æœŸæ€§é‡å¯å…è®¸æ¨¡å‹å¤šæ¬¡æ¢ç´¢å‚æ•°ç©ºé—´,æœ‰åŠ©äºæ‰¾åˆ°æ›´å¥½çš„å±€éƒ¨æœ€ä¼˜ã€‚</p>
<h3 id="6-mini-batch">6. Mini-Batchå¤§å°çš„å½±å“</h3>
<h4 id="61">6.1 æ–¹å·®ä¸æ‰¹é‡å¤§å°çš„å…³ç³»</h4>
<p>å¯¹äºæ‰¹é‡å¤§å°$B$,æ¢¯åº¦ä¼°è®¡çš„æ–¹å·®ä¸º:
\begin{equation}\text{Var}[\boldsymbol{g}_B] = \frac{\sigma^2}{B}\tag{46}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å¢å¤§æ‰¹é‡å¯ä»¥çº¿æ€§åœ°å‡å°‘æ–¹å·®,ä½†è®¡ç®—æˆæœ¬ä¹Ÿçº¿æ€§å¢åŠ ã€‚</p>
<h4 id="62">6.2 çº¿æ€§ç¼©æ”¾è§„åˆ™</h4>
<p>å½“æ‰¹é‡å¤§å°ä»$B_1$å¢åŠ åˆ°$B_2 = kB_1$æ—¶,ä¸ºä¿æŒç›¸åŒçš„æ”¶æ•›è¡Œä¸º,å­¦ä¹ ç‡åº”ç›¸åº”å¢åŠ :
\begin{equation}\eta_2 = k\eta_1\tag{47}\end{equation}</p>
<p><strong>ç†è®ºåŸºç¡€</strong>: ä»å¼(12)å¯ä»¥çœ‹å‡º,å¢å¤§$B$å‡å°‘äº†æ–¹å·®é¡¹çš„å½±å“,å…è®¸ä½¿ç”¨æ›´å¤§çš„å­¦ä¹ ç‡ã€‚</p>
<p><strong>é™åˆ¶</strong>: çº¿æ€§ç¼©æ”¾è§„åˆ™åœ¨$B$è¾ƒå¤§æ—¶ä¼šå¤±æ•ˆ,å› ä¸ºä¼šè¶…è¿‡æœ€ä¼˜å­¦ä¹ ç‡çš„ä¸Šç•Œã€‚</p>
<h4 id="63">6.3 ä¸´ç•Œæ‰¹é‡å¤§å°</h4>
<p>å®šä¹‰ä¸´ç•Œæ‰¹é‡å¤§å°$B_c$,è¶…è¿‡è¿™ä¸ªå€¼åå¢å¤§æ‰¹é‡ä¸å†æ˜¾è‘—æå‡æ”¶æ•›é€Ÿåº¦:
\begin{equation}B_c \sim \frac{\sigma^2}{|\nabla L(\boldsymbol{\theta})|^2}\tag{48}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å½“æ‰¹é‡è¶³å¤Ÿå¤§æ—¶,æ¢¯åº¦å™ªå£°å·²ç»å¾ˆå°,è¿›ä¸€æ­¥å¢å¤§æ‰¹é‡çš„è¾¹é™…æ”¶ç›Šé€’å‡ã€‚</p>
<p><strong>å®è·µå»ºè®®</strong>:
- è®­ç»ƒåˆæœŸ:æ¢¯åº¦å¤§,$B_c$å¤§,å¯ä»¥ä½¿ç”¨å¤§æ‰¹é‡
- è®­ç»ƒåæœŸ:æ¢¯åº¦å°,$B_c$å°,åº”è¯¥å‡å°æ‰¹é‡æˆ–å­¦ä¹ ç‡</p>
<h3 id="7">7. æ•°å€¼ç¤ºä¾‹</h3>
<h4 id="71">7.1 äºŒæ¬¡å‡½æ•°ä¼˜åŒ–</h4>
<p>è€ƒè™‘ç®€å•çš„äºŒæ¬¡å‡½æ•°:
\begin{equation}L(\boldsymbol{\theta}) = \frac{1}{2}\boldsymbol{\theta}^{\top}Q\boldsymbol{\theta} - \boldsymbol{b}^{\top}\boldsymbol{\theta}\tag{49}\end{equation}</p>
<p>å…¶ä¸­$Q$æ˜¯æ­£å®šçŸ©é˜µã€‚æœ€ä¼˜è§£ä¸º$\boldsymbol{\theta}^* = Q^{-1}\boldsymbol{b}$ã€‚</p>
<p><strong>å¼ºå‡¸æ€§</strong>: $\mu = \lambda_{min}(Q)$
<strong>å…‰æ»‘æ€§</strong>: $L = \lambda_{max}(Q)$
<strong>æ¡ä»¶æ•°</strong>: $\kappa = \frac{\lambda_{max}(Q)}{\lambda_{min}(Q)}$</p>
<p>å¯¹äº$Q = \text{diag}(1, 10)$,$\boldsymbol{b} = [1, 1]^{\top}$:
- $\mu = 1, L = 10, \kappa = 10$
- ç†è®ºæœ€ä¼˜å­¦ä¹ ç‡: $\eta^* = \frac{2}{L + \mu} = \frac{2}{11} \approx 0.18$</p>
<p><strong>æ•°å€¼éªŒè¯</strong>:
- $\eta = 0.1$: æ”¶æ•›éœ€è¦çº¦50æ­¥
- $\eta = 0.18$: æ”¶æ•›éœ€è¦çº¦30æ­¥(æœ€ä¼˜)
- $\eta = 0.3$: æŒ¯è¡,æ”¶æ•›éœ€è¦çº¦100æ­¥
- $\eta = 0.5$: å‘æ•£</p>
<h4 id="72-logistic">7.2 Logisticå›å½’</h4>
<p>è€ƒè™‘äºŒåˆ†ç±»é—®é¢˜,æŸå¤±å‡½æ•°:
\begin{equation}L(\boldsymbol{\theta}) = \frac{1}{n}\sum_{i=1}^n \log(1 + \exp(-y_i\boldsymbol{x}_i^{\top}\boldsymbol{\theta}))\tag{50}\end{equation}</p>
<p><strong>æ€§è´¨</strong>:
- å‡¸å‡½æ•°(HessianåŠæ­£å®š)
- å…‰æ»‘æ€§: $L = \frac{1}{4}\max_i |\boldsymbol{x}_i|^2$</p>
<p><strong>å®éªŒè®¾ç½®</strong>: $n=1000$,$d=20$,ç”Ÿæˆéšæœºæ•°æ®ã€‚</p>
<p><strong>å­¦ä¹ ç‡æ¯”è¾ƒ</strong>:
| å­¦ä¹ ç‡ç­–ç•¥ | æ”¶æ•›æ­¥æ•° | æœ€ç»ˆè¯¯å·® |
|----------|---------|----------|
| $\eta = 0.01$(å¸¸æ•°) | 1000+ | $10^{-3}$ |
| $\eta_t = 0.1/\sqrt{t}$ | ~500 | $10^{-4}$ |
| $\eta_t = 1/t$ | ~300 | $10^{-5}$ |
| $\eta_t = 0.1/(1+0.01t)$ | ~400 | $10^{-4}$ |</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: è¡°å‡å­¦ä¹ ç‡æ˜¾è‘—æ”¹å–„æ”¶æ•›ç²¾åº¦,ä½†æ”¶æ•›é€Ÿåº¦å¯èƒ½è¾ƒæ…¢ã€‚</p>
<h4 id="73">7.3 æ·±åº¦ç¥ç»ç½‘ç»œ</h4>
<p>å¯¹äºæ·±åº¦ç½‘ç»œ,æŸå¤±å‡½æ•°é«˜åº¦éå‡¸ã€‚è€ƒè™‘ä¸¤å±‚ç¥ç»ç½‘ç»œ:
\begin{equation}f(\boldsymbol{x};\boldsymbol{\theta}) = \boldsymbol{W}_2\sigma(\boldsymbol{W}_1\boldsymbol{x})\tag{51}\end{equation}</p>
<p><strong>å®éªŒè§‚å¯Ÿ</strong>:
1. <strong>è®­ç»ƒåˆæœŸ</strong>: æ¢¯åº¦å¤§ä¸”ä¸ç¨³å®š,éœ€è¦å°å­¦ä¹ ç‡æˆ–warmup
2. <strong>è®­ç»ƒä¸­æœŸ</strong>: æ¢¯åº¦ç¨³å®š,å¯ä»¥ä½¿ç”¨è¾ƒå¤§å­¦ä¹ ç‡
3. <strong>è®­ç»ƒåæœŸ</strong>: æ¢¯åº¦å°,éœ€è¦æ›´å°å­¦ä¹ ç‡æ¥ç²¾ç»†è°ƒæ•´</p>
<p><strong>Warmupç­–ç•¥</strong>:
\begin{equation}\eta_t = \begin{cases}
\eta_{max} \cdot \frac{t}{T_{warmup}}, &amp; t \leq T_{warmup}\
\eta_{max} \cdot \text{schedule}(t - T_{warmup}), &amp; t &gt; T_{warmup}
\end{cases}\tag{52}\end{equation}</p>
<p>å…¸å‹è®¾ç½®:$T_{warmup} = 0.1T$(è®­ç»ƒæ€»æ­¥æ•°çš„10%)ã€‚</p>
<h3 id="8">8. å®è·µå»ºè®®ä¸æ€»ç»“</h3>
<h4 id="81">8.1 å­¦ä¹ ç‡é€‰æ‹©æŒ‡å—</h4>
<p><strong>æ­¥éª¤1</strong>: å­¦ä¹ ç‡èŒƒå›´æµ‹è¯•
- ä»æå°å€¼(å¦‚$10^{-6}$)å¼€å§‹,æŒ‡æ•°å¢é•¿
- è®°å½•æ¯ä¸ªå­¦ä¹ ç‡ä¸‹çš„æŸå¤±å˜åŒ–
- é€‰æ‹©æŸå¤±ä¸‹é™æœ€å¿«ä¸”ç¨³å®šçš„å­¦ä¹ ç‡</p>
<p><strong>æ­¥éª¤2</strong>: ç²¾ç»†è°ƒæ•´
- åœ¨é€‰å®šèŒƒå›´å†…è¿›è¡Œç½‘æ ¼æœç´¢
- è€ƒè™‘ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦å™¨</p>
<p><strong>æ­¥éª¤3</strong>: ç›‘æ§è®­ç»ƒ
- è§‚å¯ŸæŸå¤±æ›²çº¿:è¿‡å¤§çš„å­¦ä¹ ç‡å¯¼è‡´æŒ¯è¡,è¿‡å°çš„å­¦ä¹ ç‡å¯¼è‡´æ”¶æ•›æ…¢
- è§‚å¯Ÿæ¢¯åº¦èŒƒæ•°:æ¢¯åº¦çˆ†ç‚¸æˆ–æ¶ˆå¤±éƒ½æç¤ºéœ€è¦è°ƒæ•´</p>
<p><strong>ç»éªŒæ³•åˆ™</strong>:
\begin{equation}\eta \in \left[\frac{1}{10L}, \frac{2}{L}\right]\tag{53}\end{equation}</p>
<p>å…¶ä¸­$L$å¯ä»¥é€šè¿‡Hessiançš„æœ€å¤§ç‰¹å¾å€¼æˆ–Lipschitzå¸¸æ•°ä¼°è®¡ã€‚</p>
<h4 id="82">8.2 æ‰¹é‡å¤§å°é€‰æ‹©</h4>
<p><strong>å°æ‰¹é‡</strong>(B = 32-128):
- ä¼˜ç‚¹:æ›´å¥½çš„æ³›åŒ–æ€§èƒ½,è®­ç»ƒæ›´ç¨³å®š
- ç¼ºç‚¹:è®­ç»ƒæ…¢,GPUåˆ©ç”¨ç‡ä½</p>
<p><strong>å¤§æ‰¹é‡</strong>(B = 512-4096):
- ä¼˜ç‚¹:è®­ç»ƒå¿«,GPUåˆ©ç”¨ç‡é«˜
- ç¼ºç‚¹:æ³›åŒ–æ€§èƒ½å¯èƒ½ä¸‹é™,éœ€è¦æ›´å¤§å­¦ä¹ ç‡</p>
<p><strong>æŠ˜ä¸­æ–¹æ¡ˆ</strong>: æ¸è¿›å¢å¤§æ‰¹é‡
\begin{equation}B_t = \min(B_{max}, B_0 \cdot 2^{\lfloor t/T_0 \rfloor})\tag{54}\end{equation}</p>
<h4 id="83">8.3 æ”¶æ•›æ€§è¯Šæ–­</h4>
<p><strong>åˆ¤æ–­æ˜¯å¦æ”¶æ•›</strong>:
1. æŸå¤±ä¸å†æ˜¾è‘—ä¸‹é™(ç›¸å¯¹å˜åŒ– &lt; 0.1%)
2. æ¢¯åº¦èŒƒæ•°è¶³å¤Ÿå°($|\nabla L(\boldsymbol{\theta})| &lt; \epsilon$)
3. å‚æ•°å˜åŒ–å¾ˆå°($|\boldsymbol{\theta}<em t-1="t-1">t - \boldsymbol{\theta}</em>| &lt; \delta$)</p>
<p><strong>æœªæ”¶æ•›çš„å¯èƒ½åŸå› </strong>:
- å­¦ä¹ ç‡è¿‡å¤§:é™ä½å­¦ä¹ ç‡æˆ–å¢åŠ æ‰¹é‡å¤§å°
- å­¦ä¹ ç‡è¿‡å°:å¢å¤§å­¦ä¹ ç‡æˆ–ä½¿ç”¨è‡ªé€‚åº”ä¼˜åŒ–å™¨
- æ¢¯åº¦æ¶ˆå¤±:æ£€æŸ¥ç½‘ç»œåˆå§‹åŒ–,ä½¿ç”¨BatchNormæˆ–ResNet
- éç‚¹:å¢åŠ éšæœºæ€§(å‡å°æ‰¹é‡)æˆ–ä½¿ç”¨åŠ¨é‡</p>
<h4 id="84">8.4 ç†è®ºä¸å®è·µçš„å·®è·</h4>
<p><strong>ç†è®ºå‡è®¾ vs å®è·µç°å®</strong>:
1. <strong>å‡¸æ€§å‡è®¾</strong>: æ·±åº¦ç½‘ç»œé«˜åº¦éå‡¸,ä½†å±€éƒ¨å‡¸æ€§å¯èƒ½å­˜åœ¨
2. <strong>æœ‰ç•Œæ¢¯åº¦</strong>: å®è·µä¸­ä½¿ç”¨æ¢¯åº¦è£å‰ªæ¥å¼ºåˆ¶æ»¡è¶³
3. <strong>ç‹¬ç«‹é‡‡æ ·</strong>: æ•°æ®å¢å¼ºå¯èƒ½å¼•å…¥ç›¸å…³æ€§
4. <strong>å…‰æ»‘æ€§</strong>: æ¿€æ´»å‡½æ•°(å¦‚ReLU)ä¸å¤„å¤„å…‰æ»‘</p>
<p><strong>å®è·µä¸­çš„ç»éªŒæ–¹æ³•</strong>:
- <strong>Adam/AdamW</strong>: è‡ªé€‚åº”å­¦ä¹ ç‡,å¯¹è¶…å‚æ•°ä¸æ•æ„Ÿ
- <strong>SGD+Momentum</strong>: éœ€è¦ä»”ç»†è°ƒå‚,ä½†æ³›åŒ–æ€§èƒ½é€šå¸¸æ›´å¥½
- <strong>å­¦ä¹ ç‡Warmup</strong>: ç¼“è§£è®­ç»ƒåˆæœŸçš„ä¸ç¨³å®š
- <strong>æ¢¯åº¦è£å‰ª</strong>: é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸</p>
<h4 id="85">8.5 æ€»ç»“</h4>
<p>æœ¬æ–‡ç³»ç»Ÿæ¨å¯¼äº†SGDåœ¨ä¸åŒæ¡ä»¶ä¸‹çš„æ”¶æ•›æ€§ç†è®º:</p>
<p><strong>ä¸»è¦ç»“è®º</strong>:
1. ä¸€èˆ¬å‡¸å‡½æ•°: $\mathcal{O}(1/\sqrt{T})$æ”¶æ•›ç‡
2. å¼ºå‡¸å‡½æ•°: $\mathcal{O}(1/T)$æ”¶æ•›ç‡
3. éå‡¸å‡½æ•°: æ”¶æ•›åˆ°ä¸€é˜¶é©»ç‚¹
4. æ–¹å·®å‡å°‘æŠ€æœ¯(SVRG/SAGA)å¯ä»¥è¾¾åˆ°çº¿æ€§æ”¶æ•›ç‡</p>
<p><strong>å…³é”®æ´å¯Ÿ</strong>:
- å­¦ä¹ ç‡è¡°å‡æ˜¯å¤„ç†éšæœºæ¢¯åº¦æ–¹å·®çš„å…³é”®
- æ‰¹é‡å¤§å°å½±å“æ–¹å·®,éœ€è¦ä¸å­¦ä¹ ç‡åè°ƒ
- ç†è®ºåˆ†ææä¾›æŒ‡å¯¼,ä½†å®è·µéœ€è¦çµæ´»è°ƒæ•´</p>
<p><strong>æœªæ¥æ–¹å‘</strong>:
- éå‡¸ä¼˜åŒ–çš„æ›´ç²¾ç»†ç†è®º
- è‡ªé€‚åº”ä¼˜åŒ–å™¨çš„æ”¶æ•›æ€§åˆ†æ
- åˆ†å¸ƒå¼SGDçš„ç†è®ºä¿è¯</p>
<hr />
<h2 id="_9">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1-sgd_1">1. åŸºç¡€SGDæ”¶æ•›æ€§ç†è®º</h3>
<p>è®©æˆ‘ä»¬ä»æœ€åŸºç¡€çš„SGDç®—æ³•å¼€å§‹,ç³»ç»Ÿåœ°æ¨å¯¼å…¶æ”¶æ•›æ€§è´¨ã€‚</p>
<h4 id="11_1">1.1 å‡¸å‡½æ•°æƒ…å†µä¸‹çš„æ”¶æ•›æ€§</h4>
<p>å¯¹äºå‡¸å‡½æ•°$L(\boldsymbol{\theta})$,æˆ‘ä»¬æœ‰å‡¸æ€§å®šä¹‰:
\begin{equation}L(\boldsymbol{\theta}_2) \geq L(\boldsymbol{\theta}_1) + \nabla L(\boldsymbol{\theta}_1)^{\top}(\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1)\tag{1}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>:è¿™ä¸ªä¸ç­‰å¼è¯´æ˜,å‡¸å‡½æ•°æ€»æ˜¯ä½äºå…¶ä»»æ„ç‚¹çš„åˆ‡å¹³é¢ä¸Šæ–¹ã€‚è¿™æ˜¯å‡¸ä¼˜åŒ–çš„åŸºçŸ³ã€‚</p>
<p>å–$\boldsymbol{\theta}_1 = \boldsymbol{\theta}_t$,$\boldsymbol{\theta}_2 = \boldsymbol{\theta}^<em>$,æˆ‘ä»¬å¾—åˆ°:
\begin{equation}L(\boldsymbol{\theta}^</em>) \geq L(\boldsymbol{\theta}_t) + \nabla L(\boldsymbol{\theta}_t)^{\top}(\boldsymbol{\theta}^* - \boldsymbol{\theta}_t)\tag{2}\end{equation}</p>
<p>æ”¹å†™ä¸º:
\begin{equation}L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^<em>) \leq \nabla L(\boldsymbol{\theta}_t)^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>)\tag{3}\end{equation}</p>
<p>è¿™ä¸ªä¸ç­‰å¼ç»™å‡ºäº†å½“å‰æŸå¤±ä¸æœ€ä¼˜æŸå¤±ä¹‹é—´çš„å·®è·ä¸Šç•Œã€‚</p>
<h4 id="12_1">1.2 è·ç¦»é€’æ¨å…³ç³»</h4>
<p>è€ƒè™‘SGDæ›´æ–°:$\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \eta_t \boldsymbol{g}_t$,å…¶ä¸­$\boldsymbol{g}_t$æ˜¯æ¢¯åº¦çš„æ— åä¼°è®¡ã€‚</p>
<p>è®¡ç®—$\boldsymbol{\theta}_{t+1}$åˆ°æœ€ä¼˜ç‚¹$\boldsymbol{\theta}^<em>$çš„è·ç¦»å¹³æ–¹:
\begin{equation}\begin{aligned}
|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^</em>|^2 &amp;= |\boldsymbol{\theta}_t - \eta_t \boldsymbol{g}_t - \boldsymbol{\theta}^<em>|^2\
&amp;= |\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2 - 2\eta_t \boldsymbol{g}_t^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^*) + \eta_t^2|\boldsymbol{g}_t|^2
\end{aligned}\tag{4}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>:è¿™ä¸ªå±•å¼€å¼åŒ…å«ä¸‰é¡¹:
- ç¬¬ä¸€é¡¹:å½“å‰è·ç¦»çš„å¹³æ–¹
- ç¬¬äºŒé¡¹:æ¢¯åº¦æ–¹å‘å¯¹è·ç¦»å‡å°‘çš„è´¡çŒ®(è´Ÿé¡¹,ä½¿è·ç¦»å‡å°)
- ç¬¬ä¸‰é¡¹:ç”±äºæ­¥é•¿å¼•å…¥çš„å™ªå£°(æ­£é¡¹,ä½¿è·ç¦»å¯èƒ½å¢å¤§)</p>
<h4 id="13_1">1.3 æœŸæœ›åˆ†æ</h4>
<p>å¯¹å¼(4)ä¸¤è¾¹å–æœŸæœ›:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^<em>|^2] = \mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - 2\eta_t \mathbb{E}[\boldsymbol{g}_t^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^*)] + \eta_t^2\mathbb{E}[|\boldsymbol{g}_t|^2]\tag{5}\end{equation}</p>
<p>ç”±äº$\mathbb{E}[\boldsymbol{g}_t|\boldsymbol{\theta}_t] = \nabla L(\boldsymbol{\theta}_t)$,æˆ‘ä»¬æœ‰:
\begin{equation}\mathbb{E}[\boldsymbol{g}_t^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^<em>)] = \mathbb{E}[\nabla L(\boldsymbol{\theta}_t)^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>)] \geq \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^*)]\tag{6}\end{equation}</p>
<p>å…¶ä¸­ä¸ç­‰å·ç”±å‡¸æ€§(å¼3)å¾—åˆ°ã€‚</p>
<h4 id="14_1">1.4 æ¢¯åº¦æ–¹å·®ç•Œ</h4>
<p>å®šä¹‰æ¢¯åº¦çš„æ–¹å·®:
\begin{equation}\sigma_t^2 = \mathbb{E}[|\boldsymbol{g}_t - \nabla L(\boldsymbol{\theta}_t)|^2]\tag{7}\end{equation}</p>
<p>åˆ©ç”¨$\mathbb{E}[|\boldsymbol{g}_t|^2] = |\nabla L(\boldsymbol{\theta}_t)|^2 + \sigma_t^2$,æˆ‘ä»¬æœ‰:
\begin{equation}\mathbb{E}[|\boldsymbol{g}_t|^2] \leq G^2 + \sigma_t^2 \leq G^2 + \sigma^2\tag{8}\end{equation}</p>
<p>å…¶ä¸­$G = \sup_{\boldsymbol{\theta}}|\nabla L(\boldsymbol{\theta})|$æ˜¯æ¢¯åº¦çš„ä¸Šç•Œ,$\sigma^2 = \sup_t \sigma_t^2$æ˜¯æ–¹å·®çš„ä¸Šç•Œã€‚</p>
<h4 id="15_1">1.5 ä¸»è¦ä¸ç­‰å¼æ¨å¯¼</h4>
<p>ç»“åˆå¼(5)ã€(6)ã€(8),æˆ‘ä»¬å¾—åˆ°:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^<em>|^2] \leq \mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - 2\eta_t \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^*)] + \eta_t^2(G^2 + \sigma^2)\tag{9}\end{equation}</p>
<p>æ”¹å†™ä¸º:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}<em t_1="t+1">t) - L(\boldsymbol{\theta}^<em>)] \leq \frac{\mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - \mathbb{E}[|\boldsymbol{\theta}</em>} - \boldsymbol{\theta}^*|^2]}{2\eta_t} + \frac{\eta_t(G^2 + \sigma^2)}{2}\tag{10}\end{equation</p>
<h3 id="2_1">2. ä¸åŒå‡¸æ€§æ¡ä»¶ä¸‹çš„æ”¶æ•›ç‡</h3>
<h4 id="21_1">2.1 ä¸€èˆ¬å‡¸å‡½æ•°</h4>
<p>å¯¹å¼(10)åœ¨$t=1,\ldots,T$ä¸Šæ±‚å’Œ:
\begin{equation}\sum_{t=1}^T \mathbb{E}[L(\boldsymbol{\theta}<em t="1">t) - L(\boldsymbol{\theta}^<em>)] \leq \frac{|\boldsymbol{\theta}_1 - \boldsymbol{\theta}^</em>|^2}{2\eta_1} + \frac{G^2 + \sigma^2}{2}\sum</em>}^T \eta_t\tag{11}\end{equation</p>
<p><strong>å®šç†1</strong>(ä¸€èˆ¬å‡¸å‡½æ•°æ”¶æ•›): è‹¥$\eta_t = \frac{D}{G\sqrt{T}}$,å…¶ä¸­$D = |\boldsymbol{\theta}_1 - \boldsymbol{\theta}^<em>|$,åˆ™:
\begin{equation}\frac{1}{T}\sum_{t=1}^T \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^</em>)] \leq \frac{DG}{\sqrt{T}} + \frac{D\sigma}{2G\sqrt{T}} = \mathcal{O}\left(\frac{1}{\sqrt{T}}\right)\tag{12}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: $\mathcal{O}(1/\sqrt{T})$æ”¶æ•›ç‡æ„å‘³ç€è¦è¾¾åˆ°$\epsilon$ç²¾åº¦,éœ€è¦$\mathcal{O}(1/\epsilon^2)$æ­¥è¿­ä»£ã€‚è¿™åœ¨å‡¸ä¼˜åŒ–ä¸­æ˜¯æ¬¡çº¿æ€§æ”¶æ•›ã€‚</p>
<h4 id="22_1">2.2 å¼ºå‡¸å‡½æ•°</h4>
<p>è‹¥$L(\boldsymbol{\theta})$æ˜¯$\mu$-å¼ºå‡¸çš„,å³:
\begin{equation}L(\boldsymbol{\theta}_2) \geq L(\boldsymbol{\theta}_1) + \nabla L(\boldsymbol{\theta}_1)^{\top}(\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1) + \frac{\mu}{2}|\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1|^2\tag{13}\end{equation}</p>
<p>å–$\boldsymbol{\theta}_1 = \boldsymbol{\theta}^<em>$(æ³¨æ„$\nabla L(\boldsymbol{\theta}^</em>) = 0$):
\begin{equation}L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^<em>) \geq \frac{\mu}{2}|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2\tag{14}\end{equation}</p>
<p>ç»“åˆå¼(9),é€‰æ‹©å›ºå®šå­¦ä¹ ç‡$\eta_t = \eta = \frac{1}{\mu}$:
\begin{equation}\begin{aligned}
\mathbb{E}[|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^<em>|^2] &amp;\leq \mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - \frac{2}{\mu}\mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^<em>)] + \frac{G^2 + \sigma^2}{\mu^2}\
&amp;\leq \mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] - |\boldsymbol{\theta}_t - \boldsymbol{\theta}^*|^2 + \frac{G^2 + \sigma^2}{\mu^2}\
&amp;= \frac{G^2 + \sigma^2}{\mu^2}
\end{aligned}\tag{15}\end{equation}</p>
<p><strong>å®šç†2</strong>(å¼ºå‡¸å‡½æ•°æ”¶æ•›): è‹¥$\eta = \frac{1}{\mu}$,åˆ™:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_T - \boldsymbol{\theta}^*|^2] \leq \frac{G^2 + \sigma^2}{\mu^2}\tag{16}\end{equation}</p>
<p>æ›´ç²¾ç»†çš„åˆ†æ(ä½¿ç”¨é€’å‡å­¦ä¹ ç‡$\eta_t = \frac{2}{\mu(t+1)}$)å¯ä»¥å¾—åˆ°:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L(\boldsymbol{\theta}^*)] \leq \frac{2(G^2 + \sigma^2)}{\mu T} = \mathcal{O}\left(\frac{1}{T}\right)\tag{17}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: $\mathcal{O}(1/T)$æ”¶æ•›ç‡æ¯”ä¸€èˆ¬å‡¸å‡½æ•°å¿«,è¾¾åˆ°$\epsilon$ç²¾åº¦åªéœ€$\mathcal{O}(1/\epsilon)$æ­¥ã€‚</p>
<h4 id="23_1">2.3 å…‰æ»‘å‡¸å‡½æ•°</h4>
<p>è‹¥$L(\boldsymbol{\theta})$æ˜¯$L$-å…‰æ»‘çš„,å³æ¢¯åº¦æ»¡è¶³Lipschitzæ¡ä»¶:
\begin{equation}|\nabla L(\boldsymbol{\theta}_1) - \nabla L(\boldsymbol{\theta}_2)| \leq L|\boldsymbol{\theta}_1 - \boldsymbol{\theta}_2|\tag{18}\end{equation}</p>
<p>ç­‰ä»·åœ°,æœ‰äºŒæ¬¡ä¸Šç•Œ:
\begin{equation}L(\boldsymbol{\theta}_2) \leq L(\boldsymbol{\theta}_1) + \nabla L(\boldsymbol{\theta}_1)^{\top}(\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1) + \frac{L}{2}|\boldsymbol{\theta}_2 - \boldsymbol{\theta}_1|^2\tag{19}\end{equation}</p>
<p>å¯¹äºå…‰æ»‘å‡¸å‡½æ•°,ä½¿ç”¨å›ºå®šå­¦ä¹ ç‡$\eta = \frac{1}{L}$:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_{t+1})] \leq \mathbb{E}[L(\boldsymbol{\theta}_t)] - \frac{1}{2L}|\nabla L(\boldsymbol{\theta}_t)|^2 + \frac{\sigma^2}{2L}\tag{20}\end{equation}</p>
<p><strong>å®šç†3</strong>(å…‰æ»‘å‡¸å‡½æ•°æ”¶æ•›): è‹¥$\eta = \frac{1}{L}$,åˆ™:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L(\boldsymbol{\theta}^*)] \leq \frac{LD^2}{2T} + \frac{\sigma^2}{2L} = \mathcal{O}\left(\frac{1}{T}\right) + \mathcal{O}(\sigma^2)\tag{21}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å…‰æ»‘æ€§å…è®¸æˆ‘ä»¬ä½¿ç”¨å›ºå®šå­¦ä¹ ç‡,å¹¶è·å¾—çº¿æ€§æ”¶æ•›ç‡ã€‚ä½†éšæœºæ¢¯åº¦çš„æ–¹å·®$\sigma^2$ä¼šäº§ç”Ÿä¸€ä¸ªæ’å®šçš„è¯¯å·®ä¸‹ç•Œã€‚</p>
<h4 id="24_1">2.4 å¼ºå‡¸ä¸”å…‰æ»‘å‡½æ•°</h4>
<p>è‹¥$L(\boldsymbol{\theta})$åŒæ—¶æ˜¯$\mu$-å¼ºå‡¸å’Œ$L$-å…‰æ»‘çš„,å®šä¹‰æ¡ä»¶æ•°$\kappa = L/\mu$ã€‚</p>
<p>ä½¿ç”¨å›ºå®šå­¦ä¹ ç‡$\eta = \frac{2}{L + \mu}$:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^<em>|^2] \leq \left(1 - \frac{2\mu}{L+\mu}\right)\mathbb{E}[|\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>|^2] + \frac{2\sigma^2}{(L+\mu)^2}\tag{22}\end{equation}</p>
<p>é€’æ¨å¾—åˆ°:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_T - \boldsymbol{\theta}^*|^2] \leq \left(1 - \frac{2}{\kappa+1}\right)^T D^2 + \frac{2\kappa\sigma^2}{L^2(\kappa+1)}\tag{23}\end{equation}</p>
<p><strong>å®šç†4</strong>(å¼ºå‡¸å…‰æ»‘å‡½æ•°æ”¶æ•›): è¾¾åˆ°$\epsilon$ç²¾åº¦éœ€è¦:
\begin{equation}T = \mathcal{O}\left(\kappa\log\frac{1}{\epsilon}\right)\tag{24}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: è¿™æ˜¯çº¿æ€§æ”¶æ•›ç‡,è¿œå¿«äºæ¬¡çº¿æ€§æ”¶æ•›ã€‚æ¡ä»¶æ•°$\kappa$è¶Šå°,æ”¶æ•›è¶Šå¿«ã€‚</p>
<h3 id="3_1">3. éå‡¸å‡½æ•°æƒ…å†µ</h3>
<p>å¯¹äºéå‡¸å‡½æ•°,æˆ‘ä»¬æ— æ³•ä¿è¯æ”¶æ•›åˆ°å…¨å±€æœ€ä¼˜,ä½†å¯ä»¥åˆ†ææ”¶æ•›åˆ°é©»ç‚¹çš„æ€§è´¨ã€‚</p>
<h4 id="31_1">3.1 å…‰æ»‘éå‡¸å‡½æ•°</h4>
<p>å‡è®¾$L(\boldsymbol{\theta})$æ˜¯$L$-å…‰æ»‘çš„(æ»¡è¶³å¼19),ä½†ä¸ä¸€å®šæ˜¯å‡¸çš„ã€‚</p>
<p>ä»å¼(19)å‡ºå‘,å–$\boldsymbol{\theta}<em t_1="t+1">2 = \boldsymbol{\theta}</em>} = \boldsymbol{\theta<em t_1="t+1">t - \eta_t \boldsymbol{g}_t$:
\begin{equation}\begin{aligned}
L(\boldsymbol{\theta}</em>_t|^2
\end{aligned}\tag{25}\end{equation}}) &amp;\leq L(\boldsymbol{\theta}_t) - \eta_t \nabla L(\boldsymbol{\theta}_t)^{\top}\boldsymbol{g}_t + \frac{L\eta_t^2}{2}|\boldsymbol{g</p>
<p>å–æœŸæœ›:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_{t+1})] \leq \mathbb{E}[L(\boldsymbol{\theta}_t)] - \eta_t\mathbb{E}[|\nabla L(\boldsymbol{\theta}_t)|^2] + \frac{L\eta_t^2}{2}(G^2 + \sigma^2)\tag{26}\end{equation}</p>
<p>å¯¹$t=1,\ldots,T$æ±‚å’Œ:
\begin{equation}\sum_{t=1}^T \eta_t\mathbb{E}[|\nabla L(\boldsymbol{\theta}<em t="1">t)|^2] \leq L(\boldsymbol{\theta}_1) - \mathbb{E}[L(\boldsymbol{\theta}_T)] + \frac{L(G^2 + \sigma^2)}{2}\sum</em>}^T \eta_t^2\tag{27}\end{equation</p>
<p>å‡è®¾$L(\boldsymbol{\theta})$æœ‰ä¸‹ç•Œ$L^* = \inf_{\boldsymbol{\theta}} L(\boldsymbol{\theta})$,åˆ™:
\begin{equation}\sum_{t=1}^T \eta_t\mathbb{E}[|\nabla L(\boldsymbol{\theta}<em t="1">t)|^2] \leq \Delta + \frac{L(G^2 + \sigma^2)}{2}\sum</em>}^T \eta_t^2\tag{28}\end{equation</p>
<p>å…¶ä¸­$\Delta = L(\boldsymbol{\theta}_1) - L^*$ã€‚</p>
<p><strong>å®šç†5</strong>(éå‡¸å‡½æ•°ä¸€é˜¶é©»ç‚¹): è‹¥$\eta_t = \eta = \frac{1}{L}$,åˆ™:
\begin{equation}\min_{1\leq t\leq T}\mathbb{E}[|\nabla L(\boldsymbol{\theta}<em t="1">t)|^2] \leq \frac{\sum</em>}^T \eta_t\mathbb{E}[|\nabla L(\boldsymbol{\theta<em t="1">t)|^2]}{\sum</em>}^T \eta_t} \leq \frac{L\Delta}{T} + \frac{G^2 + \sigma^2}{2} = \mathcal{O}\left(\frac{1}{T}\right)\tag{29}\end{equation</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å¯¹äºéå‡¸å‡½æ•°,æˆ‘ä»¬ä¿è¯èƒ½æ‰¾åˆ°æ¢¯åº¦èŒƒæ•°å°çš„ç‚¹(ä¸€é˜¶é©»ç‚¹),ä½†ä¸ä¿è¯æ˜¯å±€éƒ¨æˆ–å…¨å±€æœ€ä¼˜ã€‚</p>
<h4 id="32-polyak-ojasiewiczpl_1">3.2 Polyak-Åojasiewicz(PL)æ¡ä»¶</h4>
<p>PLæ¡ä»¶æ˜¯ä¸€ä¸ªæ¯”å¼ºå‡¸æ›´å¼±ä½†æ¯”ä¸€èˆ¬éå‡¸æ›´å¼ºçš„æ¡ä»¶:
\begin{equation}\frac{1}{2}|\nabla L(\boldsymbol{\theta})|^2 \geq \mu(L(\boldsymbol{\theta}) - L^*)\tag{30}\end{equation}</p>
<p>æ»¡è¶³PLæ¡ä»¶çš„å‡½æ•°å¯èƒ½æ˜¯éå‡¸çš„,ä½†ä»èƒ½ä¿è¯å…¨å±€æ”¶æ•›ã€‚</p>
<p><strong>å®šç†6</strong>(PLæ¡ä»¶ä¸‹çš„æ”¶æ•›): è‹¥$L(\boldsymbol{\theta})$æ»¡è¶³PLæ¡ä»¶ä¸”$L$-å…‰æ»‘,ä½¿ç”¨$\eta = \frac{1}{L}$:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L^<em>] \leq \left(1 - \frac{\mu}{L}\right)^T(L(\boldsymbol{\theta}_1) - L^</em>) + \frac{\sigma^2}{2\mu}\tag{31}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: PLæ¡ä»¶ä¿è¯çº¿æ€§æ”¶æ•›,å³ä½¿å‡½æ•°éå‡¸ã€‚è®¸å¤šç¥ç»ç½‘ç»œåœ¨è¿‡å‚æ•°åŒ–æ—¶æ»¡è¶³PLæ¡ä»¶ã€‚</p>
<h3 id="4_1">4. æ–¹å·®å‡å°‘æŠ€æœ¯</h3>
<p>éšæœºæ¢¯åº¦çš„æ–¹å·®$\sigma^2$æ˜¯å½±å“SGDæ”¶æ•›çš„å…³é”®å› ç´ ã€‚æ–¹å·®å‡å°‘æŠ€æœ¯æ—¨åœ¨é™ä½è¿™ä¸ªæ–¹å·®ã€‚</p>
<h4 id="41-svrg_1">4.1 SVRGç®—æ³•</h4>
<p><strong>éšæœºæ–¹å·®å‡å°‘æ¢¯åº¦</strong>(SVRG)çš„æ ¸å¿ƒæ€æƒ³æ˜¯å‘¨æœŸæ€§è®¡ç®—å…¨æ¢¯åº¦ä½œä¸ºå‚è€ƒç‚¹ã€‚</p>
<p><strong>ç®—æ³•æ¡†æ¶</strong>:
- å¤–å¾ªç¯:æ¯$m$æ­¥è®¡ç®—ä¸€æ¬¡å…¨æ¢¯åº¦$\tilde{\boldsymbol{g}} = \nabla L(\tilde{\boldsymbol{\theta}})$
- å†…å¾ªç¯:ä½¿ç”¨æ–¹å·®å‡å°‘çš„æ¢¯åº¦ä¼°è®¡
\begin{equation}\boldsymbol{v}_t = \nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) - \nabla L(\boldsymbol{x}_t, \tilde{\boldsymbol{\theta}}) + \tilde{\boldsymbol{g}}\tag{32}\end{equation}</p>
<p><strong>æ–¹å·®åˆ†æ</strong>:
\begin{equation}\mathbb{E}[\boldsymbol{v}_t] = \nabla L(\boldsymbol{\theta}_t)\tag{33}\end{equation}
\begin{equation}\mathbb{E}[|\boldsymbol{v}_t - \nabla L(\boldsymbol{\theta}_t)|^2] \leq 2L^2|\boldsymbol{\theta}_t - \tilde{\boldsymbol{\theta}}|^2\tag{34}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: $\boldsymbol{v}_t$æ˜¯æ— åçš„,ä¸”æ–¹å·®éšç€$\boldsymbol{\theta}_t$æ¥è¿‘$\tilde{\boldsymbol{\theta}}$è€Œå‡å°ã€‚</p>
<p><strong>å®šç†7</strong>(SVRGæ”¶æ•›ç‡): å¯¹äº$\mu$-å¼ºå‡¸$L$-å…‰æ»‘å‡½æ•°:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L^<em>] \leq \left(1 - \min\left{\frac{\mu}{3L}, \frac{1}{3m}\right}\right)^T(L(\boldsymbol{\theta}_0) - L^</em>)\tag{35}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: SVRGè¾¾åˆ°çº¿æ€§æ”¶æ•›ç‡,ä¸”æ”¶æ•›é€Ÿåº¦ä¸ä¾èµ–äºæ•°æ®é›†å¤§å°$n$,åªä¾èµ–äºæ¡ä»¶æ•°$\kappa$ã€‚</p>
<h4 id="42-saga_1">4.2 SAGAç®—æ³•</h4>
<p>SAGAç»´æŠ¤æ‰€æœ‰æ ·æœ¬æ¢¯åº¦çš„è¡¨æ ¼,é¿å…äº†SVRGçš„å†…å¤–å¾ªç¯ç»“æ„ã€‚</p>
<p><strong>æ›´æ–°è§„åˆ™</strong>:
\begin{equation}\boldsymbol{v}<em i="1">t = \nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) - \boldsymbol{g}_t^{old}(\boldsymbol{x}_t) + \frac{1}{n}\sum</em>}^n \boldsymbol{g}_t^{old}(\boldsymbol{x}_i)\tag{36}\end{equation</p>
<p>å…¶ä¸­$\boldsymbol{g}_t^{old}(\boldsymbol{x}_i)$æ˜¯å­˜å‚¨çš„ç¬¬$i$ä¸ªæ ·æœ¬çš„æ—§æ¢¯åº¦ã€‚</p>
<p><strong>å®šç†8</strong>(SAGAæ”¶æ•›ç‡): å¯¹äº$\mu$-å¼ºå‡¸$L$-å…‰æ»‘å‡½æ•°:
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_T - \boldsymbol{\theta}^<em>|^2] \leq \left(1 - \min\left{\frac{1}{3\kappa}, \frac{1}{3n}\right}\right)^T|\boldsymbol{\theta}_0 - \boldsymbol{\theta}^</em>|^2\tag{37}\end{equation}</p>
<h4 id="43_1">4.3 æ–¹å·®å‡å°‘çš„å‡ ä½•è§£é‡Š</h4>
<p>è€ƒè™‘æ¢¯åº¦ç©ºé—´ä¸­çš„åˆ†è§£:
\begin{equation}\nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) = \nabla L(\boldsymbol{\theta}_t) + [\nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) - \nabla L(\boldsymbol{\theta}_t)]\tag{38}\end{equation}</p>
<p>ç¬¬äºŒé¡¹æ˜¯å™ªå£°ã€‚SVRG/SAGAé€šè¿‡å‡å»ç›¸å…³å™ªå£°$\nabla L(\boldsymbol{x}_t, \tilde{\boldsymbol{\theta}})$æ¥å‡å°‘æ–¹å·®:
\begin{equation}\nabla L(\boldsymbol{x}_t, \boldsymbol{\theta}_t) - \nabla L(\boldsymbol{x}_t, \tilde{\boldsymbol{\theta}}) \approx \nabla^2 L(\tilde{\boldsymbol{\theta}})(\boldsymbol{\theta}_t - \tilde{\boldsymbol{\theta}})\tag{39}\end{equation}</p>
<p>è¿™å¯ä»¥çœ‹ä½œæ˜¯å¯¹å™ªå£°çš„çº¿æ€§è¿‘ä¼¼å’Œè¡¥å¿ã€‚</p>
<h3 id="5_1">5. å­¦ä¹ ç‡è°ƒåº¦ç­–ç•¥</h3>
<p>å­¦ä¹ ç‡çš„é€‰æ‹©å¯¹SGDæ”¶æ•›è‡³å…³é‡è¦ã€‚</p>
<h4 id="51_1">5.1 å¸¸æ•°å­¦ä¹ ç‡</h4>
<p><strong>ä¼˜ç‚¹</strong>: ç®€å•,ä¸éœ€è¦è°ƒå‚
<strong>ç¼ºç‚¹</strong>: å­˜åœ¨æ”¶æ•›è¯¯å·®ä¸‹ç•Œ</p>
<p>å¯¹äºå¼ºå‡¸å‡½æ•°,å›ºå®š$\eta = \frac{1}{L}$:
\begin{equation}\mathbb{E}[L(\boldsymbol{\theta}_T) - L^*] \leq \frac{\sigma^2}{2\mu}\tag{40}\end{equation}</p>
<p>æ— æ³•æ”¶æ•›åˆ°ç²¾ç¡®æœ€ä¼˜,è¯¯å·®ä¸æ–¹å·®æˆæ­£æ¯”ã€‚</p>
<h4 id="52_1">5.2 å¤šé¡¹å¼è¡°å‡</h4>
<p>å¸¸ç”¨çš„è¡°å‡ç­–ç•¥:$\eta_t = \frac{\eta_0}{(1 + t)^{\alpha}}$,å…¶ä¸­$\alpha \in (0.5, 1]$ã€‚</p>
<p><strong>Robbins-Monroæ¡ä»¶</strong>: ä¸ºä¿è¯æ”¶æ•›,å­¦ä¹ ç‡éœ€æ»¡è¶³:
\begin{equation}\sum_{t=1}^{\infty} \eta_t = \infty, \quad \sum_{t=1}^{\infty} \eta_t^2 &lt; \infty\tag{41}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: ç¬¬ä¸€ä¸ªæ¡ä»¶ä¿è¯èƒ½å¤Ÿåˆ°è¾¾ä»»æ„è¿œçš„ç‚¹,ç¬¬äºŒä¸ªæ¡ä»¶ä¿è¯ç´¯ç§¯å™ªå£°æœ‰ç•Œã€‚</p>
<p>å¯¹äº$\eta_t = \frac{\eta_0}{\sqrt{t}}$:
\begin{equation}\frac{1}{T}\sum_{t=1}^T \mathbb{E}[L(\boldsymbol{\theta}_t) - L^*] = \mathcal{O}\left(\frac{\log T}{\sqrt{T}}\right)\tag{42}\end{equation}</p>
<h4 id="53_1">5.3 æŒ‡æ•°è¡°å‡</h4>
<p>æŒ‡æ•°è¡°å‡:$\eta_t = \eta_0 \gamma^t$,å…¶ä¸­$\gamma \in (0, 1)$ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>: å¿«é€Ÿé™ä½å­¦ä¹ ç‡,é€‚åˆå¼ºå‡¸å‡½æ•°
<strong>ç¼ºç‚¹</strong>: ä¸æ»¡è¶³Robbins-Monroæ¡ä»¶,å¯èƒ½è¿‡æ—©åœæ­¢</p>
<p>å®è·µä¸­å¸¸ç”¨åˆ†æ®µæŒ‡æ•°è¡°å‡:
\begin{equation}\eta_t = \eta_0 \gamma^{\lfloor t/T_0 \rfloor}\tag{43}\end{equation}</p>
<p>æ¯$T_0$æ­¥è¡°å‡ä¸€æ¬¡ã€‚</p>
<h4 id="54-cosine-annealing_1">5.4 Cosine Annealing</h4>
<p>ä½™å¼¦é€€ç«:
\begin{equation}\eta_t = \eta_{min} + \frac{1}{2}(\eta_{max} - \eta_{min})\left(1 + \cos\left(\frac{t\pi}{T}\right)\right)\tag{44}\end{equation}</p>
<p><strong>ä¼˜ç‚¹</strong>: å¹³æ»‘è¡°å‡,åœ¨è®­ç»ƒåæœŸæœ‰å°å¹…å¢åŠ ,æœ‰åŠ©äºè·³å‡ºå±€éƒ¨æœ€ä¼˜
<strong>æ•°å­¦ç›´è§‰</strong>: æ¨¡æ‹Ÿç‰©ç†é€€ç«è¿‡ç¨‹,é€æ¸é™æ¸©ä½†å¶å°”å‡æ¸©ä»¥æ¢ç´¢ã€‚</p>
<h4 id="55-warm-restart_1">5.5 Warm Restart</h4>
<p>å¾ªç¯ä½™å¼¦é€€ç«(SGDR):
\begin{equation}\eta_t = \eta_{min} + \frac{1}{2}(\eta_{max} - \eta_{min})\left(1 + \cos\left(\frac{T_{cur}}{T_i}\pi\right)\right)\tag{45}\end{equation}</p>
<p>å…¶ä¸­$T_{cur}$æ˜¯å½“å‰å‘¨æœŸå†…çš„æ­¥æ•°,$T_i$æ˜¯ç¬¬$i$ä¸ªå‘¨æœŸçš„é•¿åº¦ã€‚</p>
<p>å‘¨æœŸé•¿åº¦é€šå¸¸é€’å¢:$T_{i+1} = T_i \times T_{mult}$(å¦‚$T_{mult} = 2$)ã€‚</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å‘¨æœŸæ€§é‡å¯å…è®¸æ¨¡å‹å¤šæ¬¡æ¢ç´¢å‚æ•°ç©ºé—´,æœ‰åŠ©äºæ‰¾åˆ°æ›´å¥½çš„å±€éƒ¨æœ€ä¼˜ã€‚</p>
<h3 id="6-mini-batch_1">6. Mini-Batchå¤§å°çš„å½±å“</h3>
<h4 id="61_1">6.1 æ–¹å·®ä¸æ‰¹é‡å¤§å°çš„å…³ç³»</h4>
<p>å¯¹äºæ‰¹é‡å¤§å°$B$,æ¢¯åº¦ä¼°è®¡çš„æ–¹å·®ä¸º:
\begin{equation}\text{Var}[\boldsymbol{g}_B] = \frac{\sigma^2}{B}\tag{46}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å¢å¤§æ‰¹é‡å¯ä»¥çº¿æ€§åœ°å‡å°‘æ–¹å·®,ä½†è®¡ç®—æˆæœ¬ä¹Ÿçº¿æ€§å¢åŠ ã€‚</p>
<h4 id="62_1">6.2 çº¿æ€§ç¼©æ”¾è§„åˆ™</h4>
<p>å½“æ‰¹é‡å¤§å°ä»$B_1$å¢åŠ åˆ°$B_2 = kB_1$æ—¶,ä¸ºä¿æŒç›¸åŒçš„æ”¶æ•›è¡Œä¸º,å­¦ä¹ ç‡åº”ç›¸åº”å¢åŠ :
\begin{equation}\eta_2 = k\eta_1\tag{47}\end{equation}</p>
<p><strong>ç†è®ºåŸºç¡€</strong>: ä»å¼(12)å¯ä»¥çœ‹å‡º,å¢å¤§$B$å‡å°‘äº†æ–¹å·®é¡¹çš„å½±å“,å…è®¸ä½¿ç”¨æ›´å¤§çš„å­¦ä¹ ç‡ã€‚</p>
<p><strong>é™åˆ¶</strong>: çº¿æ€§ç¼©æ”¾è§„åˆ™åœ¨$B$è¾ƒå¤§æ—¶ä¼šå¤±æ•ˆ,å› ä¸ºä¼šè¶…è¿‡æœ€ä¼˜å­¦ä¹ ç‡çš„ä¸Šç•Œã€‚</p>
<h4 id="63_1">6.3 ä¸´ç•Œæ‰¹é‡å¤§å°</h4>
<p>å®šä¹‰ä¸´ç•Œæ‰¹é‡å¤§å°$B_c$,è¶…è¿‡è¿™ä¸ªå€¼åå¢å¤§æ‰¹é‡ä¸å†æ˜¾è‘—æå‡æ”¶æ•›é€Ÿåº¦:
\begin{equation}B_c \sim \frac{\sigma^2}{|\nabla L(\boldsymbol{\theta})|^2}\tag{48}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å½“æ‰¹é‡è¶³å¤Ÿå¤§æ—¶,æ¢¯åº¦å™ªå£°å·²ç»å¾ˆå°,è¿›ä¸€æ­¥å¢å¤§æ‰¹é‡çš„è¾¹é™…æ”¶ç›Šé€’å‡ã€‚</p>
<p><strong>å®è·µå»ºè®®</strong>:
- è®­ç»ƒåˆæœŸ:æ¢¯åº¦å¤§,$B_c$å¤§,å¯ä»¥ä½¿ç”¨å¤§æ‰¹é‡
- è®­ç»ƒåæœŸ:æ¢¯åº¦å°,$B_c$å°,åº”è¯¥å‡å°æ‰¹é‡æˆ–å­¦ä¹ ç‡</p>
<h3 id="7_1">7. æ•°å€¼ç¤ºä¾‹</h3>
<h4 id="71_1">7.1 äºŒæ¬¡å‡½æ•°ä¼˜åŒ–</h4>
<p>è€ƒè™‘ç®€å•çš„äºŒæ¬¡å‡½æ•°:
\begin{equation}L(\boldsymbol{\theta}) = \frac{1}{2}\boldsymbol{\theta}^{\top}Q\boldsymbol{\theta} - \boldsymbol{b}^{\top}\boldsymbol{\theta}\tag{49}\end{equation}</p>
<p>å…¶ä¸­$Q$æ˜¯æ­£å®šçŸ©é˜µã€‚æœ€ä¼˜è§£ä¸º$\boldsymbol{\theta}^* = Q^{-1}\boldsymbol{b}$ã€‚</p>
<p><strong>å¼ºå‡¸æ€§</strong>: $\mu = \lambda_{min}(Q)$
<strong>å…‰æ»‘æ€§</strong>: $L = \lambda_{max}(Q)$
<strong>æ¡ä»¶æ•°</strong>: $\kappa = \frac{\lambda_{max}(Q)}{\lambda_{min}(Q)}$</p>
<p>å¯¹äº$Q = \text{diag}(1, 10)$,$\boldsymbol{b} = [1, 1]^{\top}$:
- $\mu = 1, L = 10, \kappa = 10$
- ç†è®ºæœ€ä¼˜å­¦ä¹ ç‡: $\eta^* = \frac{2}{L + \mu} = \frac{2}{11} \approx 0.18$</p>
<p><strong>æ•°å€¼éªŒè¯</strong>:
- $\eta = 0.1$: æ”¶æ•›éœ€è¦çº¦50æ­¥
- $\eta = 0.18$: æ”¶æ•›éœ€è¦çº¦30æ­¥(æœ€ä¼˜)
- $\eta = 0.3$: æŒ¯è¡,æ”¶æ•›éœ€è¦çº¦100æ­¥
- $\eta = 0.5$: å‘æ•£</p>
<h4 id="72-logistic_1">7.2 Logisticå›å½’</h4>
<p>è€ƒè™‘äºŒåˆ†ç±»é—®é¢˜,æŸå¤±å‡½æ•°:
\begin{equation}L(\boldsymbol{\theta}) = \frac{1}{n}\sum_{i=1}^n \log(1 + \exp(-y_i\boldsymbol{x}_i^{\top}\boldsymbol{\theta}))\tag{50}\end{equation}</p>
<p><strong>æ€§è´¨</strong>:
- å‡¸å‡½æ•°(HessianåŠæ­£å®š)
- å…‰æ»‘æ€§: $L = \frac{1}{4}\max_i |\boldsymbol{x}_i|^2$</p>
<p><strong>å®éªŒè®¾ç½®</strong>: $n=1000$,$d=20$,ç”Ÿæˆéšæœºæ•°æ®ã€‚</p>
<p><strong>å­¦ä¹ ç‡æ¯”è¾ƒ</strong>:
| å­¦ä¹ ç‡ç­–ç•¥ | æ”¶æ•›æ­¥æ•° | æœ€ç»ˆè¯¯å·® |
|----------|---------|----------|
| $\eta = 0.01$(å¸¸æ•°) | 1000+ | $10^{-3}$ |
| $\eta_t = 0.1/\sqrt{t}$ | ~500 | $10^{-4}$ |
| $\eta_t = 1/t$ | ~300 | $10^{-5}$ |
| $\eta_t = 0.1/(1+0.01t)$ | ~400 | $10^{-4}$ |</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: è¡°å‡å­¦ä¹ ç‡æ˜¾è‘—æ”¹å–„æ”¶æ•›ç²¾åº¦,ä½†æ”¶æ•›é€Ÿåº¦å¯èƒ½è¾ƒæ…¢ã€‚</p>
<h4 id="73_1">7.3 æ·±åº¦ç¥ç»ç½‘ç»œ</h4>
<p>å¯¹äºæ·±åº¦ç½‘ç»œ,æŸå¤±å‡½æ•°é«˜åº¦éå‡¸ã€‚è€ƒè™‘ä¸¤å±‚ç¥ç»ç½‘ç»œ:
\begin{equation}f(\boldsymbol{x};\boldsymbol{\theta}) = \boldsymbol{W}_2\sigma(\boldsymbol{W}_1\boldsymbol{x})\tag{51}\end{equation}</p>
<p><strong>å®éªŒè§‚å¯Ÿ</strong>:
1. <strong>è®­ç»ƒåˆæœŸ</strong>: æ¢¯åº¦å¤§ä¸”ä¸ç¨³å®š,éœ€è¦å°å­¦ä¹ ç‡æˆ–warmup
2. <strong>è®­ç»ƒä¸­æœŸ</strong>: æ¢¯åº¦ç¨³å®š,å¯ä»¥ä½¿ç”¨è¾ƒå¤§å­¦ä¹ ç‡
3. <strong>è®­ç»ƒåæœŸ</strong>: æ¢¯åº¦å°,éœ€è¦æ›´å°å­¦ä¹ ç‡æ¥ç²¾ç»†è°ƒæ•´</p>
<p><strong>Warmupç­–ç•¥</strong>:
\begin{equation}\eta_t = \begin{cases}
\eta_{max} \cdot \frac{t}{T_{warmup}}, &amp; t \leq T_{warmup}\
\eta_{max} \cdot \text{schedule}(t - T_{warmup}), &amp; t &gt; T_{warmup}
\end{cases}\tag{52}\end{equation}</p>
<p>å…¸å‹è®¾ç½®:$T_{warmup} = 0.1T$(è®­ç»ƒæ€»æ­¥æ•°çš„10%)ã€‚</p>
<h3 id="8_1">8. å®è·µå»ºè®®ä¸æ€»ç»“</h3>
<h4 id="81_1">8.1 å­¦ä¹ ç‡é€‰æ‹©æŒ‡å—</h4>
<p><strong>æ­¥éª¤1</strong>: å­¦ä¹ ç‡èŒƒå›´æµ‹è¯•
- ä»æå°å€¼(å¦‚$10^{-6}$)å¼€å§‹,æŒ‡æ•°å¢é•¿
- è®°å½•æ¯ä¸ªå­¦ä¹ ç‡ä¸‹çš„æŸå¤±å˜åŒ–
- é€‰æ‹©æŸå¤±ä¸‹é™æœ€å¿«ä¸”ç¨³å®šçš„å­¦ä¹ ç‡</p>
<p><strong>æ­¥éª¤2</strong>: ç²¾ç»†è°ƒæ•´
- åœ¨é€‰å®šèŒƒå›´å†…è¿›è¡Œç½‘æ ¼æœç´¢
- è€ƒè™‘ä½¿ç”¨å­¦ä¹ ç‡è°ƒåº¦å™¨</p>
<p><strong>æ­¥éª¤3</strong>: ç›‘æ§è®­ç»ƒ
- è§‚å¯ŸæŸå¤±æ›²çº¿:è¿‡å¤§çš„å­¦ä¹ ç‡å¯¼è‡´æŒ¯è¡,è¿‡å°çš„å­¦ä¹ ç‡å¯¼è‡´æ”¶æ•›æ…¢
- è§‚å¯Ÿæ¢¯åº¦èŒƒæ•°:æ¢¯åº¦çˆ†ç‚¸æˆ–æ¶ˆå¤±éƒ½æç¤ºéœ€è¦è°ƒæ•´</p>
<p><strong>ç»éªŒæ³•åˆ™</strong>:
\begin{equation}\eta \in \left[\frac{1}{10L}, \frac{2}{L}\right]\tag{53}\end{equation}</p>
<p>å…¶ä¸­$L$å¯ä»¥é€šè¿‡Hessiançš„æœ€å¤§ç‰¹å¾å€¼æˆ–Lipschitzå¸¸æ•°ä¼°è®¡ã€‚</p>
<h4 id="82_1">8.2 æ‰¹é‡å¤§å°é€‰æ‹©</h4>
<p><strong>å°æ‰¹é‡</strong>(B = 32-128):
- ä¼˜ç‚¹:æ›´å¥½çš„æ³›åŒ–æ€§èƒ½,è®­ç»ƒæ›´ç¨³å®š
- ç¼ºç‚¹:è®­ç»ƒæ…¢,GPUåˆ©ç”¨ç‡ä½</p>
<p><strong>å¤§æ‰¹é‡</strong>(B = 512-4096):
- ä¼˜ç‚¹:è®­ç»ƒå¿«,GPUåˆ©ç”¨ç‡é«˜
- ç¼ºç‚¹:æ³›åŒ–æ€§èƒ½å¯èƒ½ä¸‹é™,éœ€è¦æ›´å¤§å­¦ä¹ ç‡</p>
<p><strong>æŠ˜ä¸­æ–¹æ¡ˆ</strong>: æ¸è¿›å¢å¤§æ‰¹é‡
\begin{equation}B_t = \min(B_{max}, B_0 \cdot 2^{\lfloor t/T_0 \rfloor})\tag{54}\end{equation}</p>
<h4 id="83_1">8.3 æ”¶æ•›æ€§è¯Šæ–­</h4>
<p><strong>åˆ¤æ–­æ˜¯å¦æ”¶æ•›</strong>:
1. æŸå¤±ä¸å†æ˜¾è‘—ä¸‹é™(ç›¸å¯¹å˜åŒ– &lt; 0.1%)
2. æ¢¯åº¦èŒƒæ•°è¶³å¤Ÿå°($|\nabla L(\boldsymbol{\theta})| &lt; \epsilon$)
3. å‚æ•°å˜åŒ–å¾ˆå°($|\boldsymbol{\theta}<em t-1="t-1">t - \boldsymbol{\theta}</em>| &lt; \delta$)</p>
<p><strong>æœªæ”¶æ•›çš„å¯èƒ½åŸå› </strong>:
- å­¦ä¹ ç‡è¿‡å¤§:é™ä½å­¦ä¹ ç‡æˆ–å¢åŠ æ‰¹é‡å¤§å°
- å­¦ä¹ ç‡è¿‡å°:å¢å¤§å­¦ä¹ ç‡æˆ–ä½¿ç”¨è‡ªé€‚åº”ä¼˜åŒ–å™¨
- æ¢¯åº¦æ¶ˆå¤±:æ£€æŸ¥ç½‘ç»œåˆå§‹åŒ–,ä½¿ç”¨BatchNormæˆ–ResNet
- éç‚¹:å¢åŠ éšæœºæ€§(å‡å°æ‰¹é‡)æˆ–ä½¿ç”¨åŠ¨é‡</p>
<h4 id="84_1">8.4 ç†è®ºä¸å®è·µçš„å·®è·</h4>
<p><strong>ç†è®ºå‡è®¾ vs å®è·µç°å®</strong>:
1. <strong>å‡¸æ€§å‡è®¾</strong>: æ·±åº¦ç½‘ç»œé«˜åº¦éå‡¸,ä½†å±€éƒ¨å‡¸æ€§å¯èƒ½å­˜åœ¨
2. <strong>æœ‰ç•Œæ¢¯åº¦</strong>: å®è·µä¸­ä½¿ç”¨æ¢¯åº¦è£å‰ªæ¥å¼ºåˆ¶æ»¡è¶³
3. <strong>ç‹¬ç«‹é‡‡æ ·</strong>: æ•°æ®å¢å¼ºå¯èƒ½å¼•å…¥ç›¸å…³æ€§
4. <strong>å…‰æ»‘æ€§</strong>: æ¿€æ´»å‡½æ•°(å¦‚ReLU)ä¸å¤„å¤„å…‰æ»‘</p>
<p><strong>å®è·µä¸­çš„ç»éªŒæ–¹æ³•</strong>:
- <strong>Adam/AdamW</strong>: è‡ªé€‚åº”å­¦ä¹ ç‡,å¯¹è¶…å‚æ•°ä¸æ•æ„Ÿ
- <strong>SGD+Momentum</strong>: éœ€è¦ä»”ç»†è°ƒå‚,ä½†æ³›åŒ–æ€§èƒ½é€šå¸¸æ›´å¥½
- <strong>å­¦ä¹ ç‡Warmup</strong>: ç¼“è§£è®­ç»ƒåˆæœŸçš„ä¸ç¨³å®š
- <strong>æ¢¯åº¦è£å‰ª</strong>: é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸</p>
<h4 id="85_1">8.5 æ€»ç»“</h4>
<p>æœ¬æ–‡ç³»ç»Ÿæ¨å¯¼äº†SGDåœ¨ä¸åŒæ¡ä»¶ä¸‹çš„æ”¶æ•›æ€§ç†è®º:</p>
<p><strong>ä¸»è¦ç»“è®º</strong>:
1. ä¸€èˆ¬å‡¸å‡½æ•°: $\mathcal{O}(1/\sqrt{T})$æ”¶æ•›ç‡
2. å¼ºå‡¸å‡½æ•°: $\mathcal{O}(1/T)$æ”¶æ•›ç‡
3. éå‡¸å‡½æ•°: æ”¶æ•›åˆ°ä¸€é˜¶é©»ç‚¹
4. æ–¹å·®å‡å°‘æŠ€æœ¯(SVRG/SAGA)å¯ä»¥è¾¾åˆ°çº¿æ€§æ”¶æ•›ç‡</p>
<p><strong>å…³é”®æ´å¯Ÿ</strong>:
- å­¦ä¹ ç‡è¡°å‡æ˜¯å¤„ç†éšæœºæ¢¯åº¦æ–¹å·®çš„å…³é”®
- æ‰¹é‡å¤§å°å½±å“æ–¹å·®,éœ€è¦ä¸å­¦ä¹ ç‡åè°ƒ
- ç†è®ºåˆ†ææä¾›æŒ‡å¯¼,ä½†å®è·µéœ€è¦çµæ´»è°ƒæ•´</p>
<p><strong>æœªæ¥æ–¹å‘</strong>:
- éå‡¸ä¼˜åŒ–çš„æ›´ç²¾ç»†ç†è®º
- è‡ªé€‚åº”ä¼˜åŒ–å™¨çš„æ”¶æ•›æ€§åˆ†æ
- åˆ†å¸ƒå¼SGDçš„ç†è®ºä¿è¯</p>
        </div>
    </div>
</body>
</html>