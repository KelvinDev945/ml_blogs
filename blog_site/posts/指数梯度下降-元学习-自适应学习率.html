<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒ‡æ•°æ¢¯åº¦ä¸‹é™ + å…ƒå­¦ä¹  = è‡ªé€‚åº”å­¦ä¹ ç‡</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>æŒ‡æ•°æ¢¯åº¦ä¸‹é™ + å…ƒå­¦ä¹  = è‡ªé€‚åº”å­¦ä¹ ç‡</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 30.7 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8968">https://spaces.ac.cn/archives/8968</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å‰ä¸¤å¤©åˆ·åˆ°äº†Googleçš„ä¸€ç¯‡è®ºæ–‡<a href="https://papers.cool/arxiv/2202.00145">ã€ŠStep-size Adaptation Using Exponentiated Gradient Updatesã€‹</a>ï¼Œåœ¨å…¶ä¸­å­¦åˆ°äº†ä¸€äº›æ–°çš„æ¦‚å¿µï¼Œæ‰€ä»¥åœ¨æ­¤è®°å½•åˆ†äº«ä¸€ä¸‹ã€‚ä¸»è¦çš„å†…å®¹æœ‰ä¸¤ä¸ªï¼Œä¸€æ˜¯éè´Ÿä¼˜åŒ–çš„æŒ‡æ•°æ¢¯åº¦ä¸‹é™ï¼ŒäºŒæ˜¯åŸºäºå…ƒå­¦ä¹ æ€æƒ³çš„å­¦ä¹ ç‡è°ƒæ•´ç®—æ³•ï¼Œä¸¤è€…éƒ½é¢‡æœ‰æ„æ€ï¼Œæœ‰å…´è¶£çš„è¯»è€…ä¹Ÿå¯ä»¥äº†è§£ä¸€ä¸‹ã€‚</p>
<h2 id="_1">æŒ‡æ•°æ¢¯åº¦ä¸‹é™</h2>
<p>æ¢¯åº¦ä¸‹é™å¤§å®¶å¯èƒ½å¬è¯´å¾—å¤šäº†ï¼ŒæŒ‡çš„æ˜¯å¯¹äºæ— çº¦æŸå‡½æ•°$\mathcal{L}(\boldsymbol{\theta})$çš„æœ€å°åŒ–ï¼Œæˆ‘ä»¬ç”¨å¦‚ä¸‹æ ¼å¼è¿›è¡Œæ›´æ–°ï¼š<br />
\begin{equation}\boldsymbol{\theta}<em _boldsymbol_theta="\boldsymbol{\theta">{t+1} = \boldsymbol{\theta}_t - \eta\nabla</em>}}\mathcal{L}(\boldsymbol{\theta<em t_1="t+1">t)\end{equation}<br />
å…¶ä¸­$\eta$æ˜¯å­¦ä¹ ç‡ã€‚ç„¶è€Œå¾ˆå¤šä»»åŠ¡å¹¶éæ€»æ˜¯æ— çº¦æŸçš„ï¼Œå¯¹äºæœ€ç®€å•çš„éè´Ÿçº¦æŸï¼Œæˆ‘ä»¬å¯ä»¥æ”¹ä¸ºå¦‚ä¸‹æ ¼å¼æ›´æ–°ï¼š<br />
\begin{equation}\boldsymbol{\theta}</em>} = \boldsymbol{\theta<em _boldsymbol_theta="\boldsymbol{\theta">t \odot \exp\left(- \eta\nabla</em>}}\mathcal{L}(\boldsymbol{\theta}_t)\right)\label{eq:egd}\end{equation<br />
è¿™é‡Œçš„$\odot$æ˜¯é€ä½å¯¹åº”ç›¸ä¹˜ï¼ˆHadamardç§¯ï¼‰ã€‚å®¹æ˜“çœ‹åˆ°ï¼Œåªè¦åˆå§‹åŒ–çš„$\boldsymbol{\theta}_0$æ˜¯éè´Ÿçš„ï¼Œé‚£ä¹ˆåœ¨æ•´ä¸ªæ›´æ–°è¿‡ç¨‹ä¸­$\boldsymbol{\theta}_t$éƒ½ä¼šä¿æŒéè´Ÿï¼Œè¿™å°±æ˜¯ç”¨äºéè´Ÿçº¦æŸä¼˜åŒ–çš„â€œæŒ‡æ•°æ¢¯åº¦ä¸‹é™â€ã€‚</p>
<p>æ€ä¹ˆç†è§£è¿™ä¸ªâ€œæŒ‡æ•°æ¢¯åº¦ä¸‹é™â€å‘¢ï¼Ÿä¹Ÿä¸éš¾ï¼Œè½¬åŒ–ä¸ºæ— çº¦æŸçš„æƒ…å½¢è¿›è¡Œæ¨å¯¼å°±è¡Œäº†ã€‚å¦‚æœ$\boldsymbol{\theta}$æ˜¯éè´Ÿçš„ï¼Œé‚£ä¹ˆ$\boldsymbol{\varphi}=\log\boldsymbol{\theta}$å°±æ˜¯å¯æ­£å¯è´Ÿçš„äº†ï¼Œå› æ­¤å¯ä»¥è®¾$\boldsymbol{\theta}=e^{\boldsymbol{\varphi}}$è½¬åŒ–ä¸ºå…³äº$\boldsymbol{\varphi}$çš„æ— çº¦æŸä¼˜åŒ–é—®é¢˜ï¼Œç»§è€Œå°±å¯ä»¥ç”¨æ¢¯åº¦ä¸‹é™è§£å†³ï¼š<br />
\begin{equation}\boldsymbol{\varphi}<em _boldsymbol_varphi="\boldsymbol{\varphi">{t+1} = \boldsymbol{\varphi}_t - \eta\nabla</em>}}\mathcal{L}(e^{\boldsymbol{\varphi<em e_boldsymbol_varphi="e^{\boldsymbol{\varphi">t}) = \boldsymbol{\varphi}_t - \eta e^{\boldsymbol{\varphi}_t}\odot\nabla</em>}}}\mathcal{L}(e^{\boldsymbol{\varphi<em t_1="t+1">t})\end{equation}<br />
æˆ‘ä»¬è®¤ä¸ºæ¢¯åº¦çš„$e^{\boldsymbol{\varphi}_t}\odot$è¿™éƒ¨åˆ†åªèµ·åˆ°äº†è°ƒèŠ‚å­¦ä¹ ç‡çš„ä½œç”¨ï¼Œæ‰€ä»¥å®ƒä¸æ˜¯æœ¬è´¨é‡è¦çš„ï¼Œæˆ‘ä»¬å°†å®ƒèˆå»å¾—åˆ°<br />
\begin{equation}\boldsymbol{\varphi}</em>} = \boldsymbol{\varphi<em e_boldsymbol_varphi="e^{\boldsymbol{\varphi">t - \eta \nabla</em>}}}\mathcal{L}(e^{\boldsymbol{\varphi<em t_1="t+1">t})\end{equation}<br />
ä¸¤è¾¹å–æŒ‡æ•°å¾—<br />
\begin{equation}e^{\boldsymbol{\varphi}</em>}} = e^{\boldsymbol{\varphi<em e_boldsymbol_varphi="e^{\boldsymbol{\varphi">t}\odot\exp\left( - \eta \nabla</em>}}}\mathcal{L}(e^{\boldsymbol{\varphi}_t})\right)\end{equation<br />
æ¢å›$\boldsymbol{\theta}=e^{\boldsymbol{\varphi}}$å°±å¾—åˆ°å¼$\eqref{eq:egd}$ã€‚</p>
<h2 id="_2">å…ƒå­¦ä¹ è°ƒå­¦ä¹ ç‡</h2>
<p>å¯¹äºå…ƒå­¦ä¹ ï¼ˆMeta Learningï¼‰ï¼Œå¯èƒ½å¤šæ•°è¯»è€…éƒ½è·Ÿç¬”è€…ä¸€æ ·å¬å¾—å¤šï¼Œä½†å‡ ä¹æ²¡æ¥è§¦è¿‡ã€‚ç®€å•æ¥è¯´ï¼Œæ™®é€šæœºå™¨å­¦ä¹ è·Ÿå…ƒå­¦ä¹ çš„å…³ç³»ï¼Œå°±åƒæ˜¯æ•°å­¦ä¸­â€œå‡½æ•°â€è·Ÿâ€œæ³›å‡½â€çš„å…³ç³»ï¼Œæ³›å‡½æ˜¯â€œå‡½æ•°çš„å‡½æ•°â€ï¼Œå…ƒå­¦ä¹ åˆ™æ˜¯â€œå­¦ä¹ å¦‚ä½•å­¦ä¹ ï¼ˆLearning How to Learnï¼‰â€ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒæ˜¯å…³äºâ€œå­¦ä¹ â€æœ¬èº«çš„æ–¹æ³•è®ºï¼Œæ¯”å¦‚æ¥ä¸‹æ¥è¦ä»‹ç»çš„ï¼Œå°±æ˜¯â€œç”¨æ¢¯åº¦ä¸‹é™å»è°ƒæ•´æ¢¯åº¦ä¸‹é™â€ã€‚</p>
<p>æˆ‘ä»¬ä»ä¸€èˆ¬çš„æ¢¯åº¦ä¸‹é™å‡ºå‘ï¼Œè®°ç›®æ ‡å‡½æ•°$\mathcal{L}$çš„æ¢¯åº¦ä¸º$\boldsymbol{g}$ï¼Œé‚£ä¹ˆæ›´æ–°å…¬å¼ä¸º<br />
\begin{equation}\boldsymbol{\theta}<em t_1="t+1">{t+1} = \boldsymbol{\theta}_t - \eta\boldsymbol{g}_t\end{equation}<br />
æˆ‘ä»¬å¸Œæœ›ç»™æ¯ä¸ªåˆ†é‡éƒ½è°ƒèŠ‚ä¸€ä¸‹å­¦ä¹ ç‡ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼•å…¥è·Ÿå‚æ•°ä¸€æ ·å¤§å°çš„éè´Ÿå˜é‡$\boldsymbol{\nu}$ï¼Œä¿®æ”¹æ›´æ–°å…¬å¼ä¸º<br />
\begin{equation}\boldsymbol{\theta}</em>} = \boldsymbol{\theta<em t_1="t+1">t - \eta\boldsymbol{\nu}</em>}\odot\boldsymbol{g<em t_1="t+1">t\label{eq:update}\end{equation}<br />
é‚£ä¹ˆï¼Œ$\boldsymbol{\nu}$è¦æŒ‰ç…§ä»€ä¹ˆè§„åˆ™è¿­ä»£å‘¢ï¼Ÿè®°ä½æˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„æ˜¯æœ€å°åŒ–$\mathcal{L}$ï¼Œæ‰€ä»¥$\boldsymbol{\nu}$çš„æ›´æ–°è§„åˆ™åº”è¯¥ä¹Ÿè¦æ˜¯æ¢¯åº¦ä¸‹é™ï¼Œè€Œè¿™é‡Œ$\boldsymbol{\nu}$è¦æ±‚æ˜¯éè´Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨æŒ‡æ•°æ¢¯åº¦ä¸‹é™ï¼š<br />
\begin{equation}\boldsymbol{\nu}</em>} = \boldsymbol{\nu<em _boldsymbol_nu="\boldsymbol{\nu">t \odot\exp\left(- \gamma\nabla</em><em t-1="t-1">t}\mathcal{L}\right)\label{eq:update-nu}\end{equation}<br />
æ³¨æ„$\mathcal{L}$æœ¬æ¥åªæ˜¯$\boldsymbol{\theta}$çš„å‡½æ•°ï¼Œä½†æ ¹æ®$\eqref{eq:update}$ï¼Œåœ¨$t$æ—¶åˆ»æˆ‘ä»¬æœ‰$\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>} - \eta\boldsymbol{\nu<em t-1="t-1">t\odot\boldsymbol{g}</em>$ï¼Œæ‰€ä»¥æ ¹æ®é“¾å¼æ³•åˆ™æœ‰<br />
\begin{equation}\nabla_{\boldsymbol{\nu}<em t-1="t-1">t}\mathcal{L} = -\eta\boldsymbol{g}</em>} \odot\nabla_{\boldsymbol{\theta<em t-1="t-1">t}\mathcal{L}= -\eta\boldsymbol{g}</em>} \odot\boldsymbol{g<em t_1="t+1">t\end{equation}<br />
ä»£å…¥åˆ°$\nu$çš„æ›´æ–°å…¬å¼$\eqref{eq:update-nu}$ï¼Œå¾—åˆ°<br />
\begin{equation}\boldsymbol{\nu}</em>} = \boldsymbol{\nu<em t-1="t-1">t \odot\exp\left( \gamma\eta\boldsymbol{g}</em>} \odot\boldsymbol{g<em t_1="t+1">t\right)\end{equation}<br />
å°†$\gamma\eta$åˆæˆä¸€ä¸ªå‚æ•°$\gamma$ï¼Œäºæ˜¯æ•´ä¸ªæ¨¡å‹çš„æ›´æ–°å…¬å¼æ˜¯ï¼š<br />
\begin{equation}\begin{aligned}&amp;\boldsymbol{\nu}</em>} = \boldsymbol{\nu<em t-1="t-1">t \odot\exp\left( \gamma\boldsymbol{g}</em>} \odot\boldsymbol{g<em t_1="t+1">t\right) \\\<br />
&amp;\boldsymbol{\theta}</em>} = \boldsymbol{\theta<em t_1="t+1">t - \eta\boldsymbol{\nu}</em>}\odot\boldsymbol{g<em t_1="t+1">t\end{aligned}\end{equation}<br />
å¦‚æœ$\boldsymbol{\nu}$åˆå§‹åŒ–ä¸ºå…¨1ï¼Œé‚£ä¹ˆå°†æœ‰<br />
\begin{equation}\boldsymbol{\nu}</em>} = \exp\left(\gamma\sum_{k=1}^t\boldsymbol{g}_{k-1} \odot\boldsymbol{g}_k\right)\end{equation<br />
å¯ä»¥çœ‹åˆ°ï¼Œè¯¥æ–¹æ³•çš„å­¦ä¹ ç‡è°ƒèŠ‚æ€è·¯æ˜¯ï¼šå¦‚æœæŸåˆ†é‡ç›¸é‚»ä¸¤æ­¥çš„æ¢¯åº¦ç»å¸¸åŒå·ï¼Œé‚£ä¹ˆå¯¹åº”é¡¹çš„ç´¯åŠ ç»“æœå°±æ˜¯æ­£çš„ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€‚å½“æ‰©å¤§ä¸€ä¸‹å­¦ä¹ ç‡ï¼›å¦‚æœç›¸é‚»ä¸¤æ­¥çš„æ¢¯åº¦ç»å¸¸å¼‚å·ï¼Œé‚£ä¹ˆå¯¹åº”é¡¹çš„ç´¯åŠ ç»“æœå¾ˆå¯èƒ½æ˜¯è´Ÿçš„ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€‚å½“ç¼©å°ä¸€ä¸‹å­¦ä¹ ç‡ã€‚</p>
<p>æ³¨æ„è¿™è·ŸAdamè°ƒå­¦ä¹ ç‡çš„æ€æƒ³æ˜¯ä¸ä¸€æ ·çš„ï¼ŒAdamè°ƒèŠ‚å­¦ä¹ ç‡çš„æ€æƒ³æ˜¯å¦‚æœæŸä¸ªåˆ†é‡çš„æ¢¯åº¦é•¿æ—¶é—´å¾ˆå°ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€è¯¥å‚æ•°å¯èƒ½æ²¡å­¦å¥½ï¼Œæ‰€ä»¥å°è¯•æ”¾å¤§å®ƒçš„å­¦ä¹ ç‡ã€‚ä¸¤è€…ä¹Ÿç®—æ˜¯å„æœ‰å„çš„é“ç†å§ã€‚</p>
<h2 id="_3">ç®€å•åšä¸ªå°ç»“</h2>
<p>æœ¬æ–‡ä¸»è¦å¯¹â€œæŒ‡æ•°æ¢¯åº¦ä¸‹é™â€å’Œâ€œå…ƒå­¦ä¹ è°ƒå­¦ä¹ ç‡â€ä¸¤ä¸ªæ¦‚å¿µåšäº†ç®€å•ç¬”è®°ï¼Œâ€œæŒ‡æ•°æ¢¯åº¦ä¸‹é™â€æ˜¯éè´Ÿçº¦æŸä¼˜åŒ–çš„ä¸€ä¸ªç®€å•æœ‰æ•ˆçš„æ–¹æ¡ˆï¼Œè€Œâ€œå…ƒå­¦ä¹ è°ƒå­¦ä¹ ç‡â€åˆ™æ˜¯å…ƒå­¦ä¹ çš„ä¸€ä¸ªç®€å•æ˜“æ‡‚çš„åº”ç”¨ã€‚å…¶ä¸­åœ¨ä»‹ç»â€œå…ƒå­¦ä¹ è°ƒå­¦ä¹ ç‡â€æ—¶ç¬”è€…åšäº†ä¸€äº›ç®€åŒ–ï¼Œç›¸æ¯”åŸè®ºæ–‡çš„å½¢å¼æ›´ä¸ºç®€å•ä¸€äº›ï¼Œä½†æ€æƒ³æ˜¯ä¸€è‡´çš„ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8968">https://spaces.ac.cn/archives/8968</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Mar. 03, 2022). ã€ŠæŒ‡æ•°æ¢¯åº¦ä¸‹é™ + å…ƒå­¦ä¹  = è‡ªé€‚åº”å­¦ä¹ ç‡ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8968">https://spaces.ac.cn/archives/8968</a></p>
<p>@online{kexuefm-8968,<br />
title={æŒ‡æ•°æ¢¯åº¦ä¸‹é™ + å…ƒå­¦ä¹  = è‡ªé€‚åº”å­¦ä¹ ç‡},<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={Mar},<br />
url={\url{https://spaces.ac.cn/archives/8968}},<br />
} </p>
<hr />
<h2 id="_4">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">1. æŒ‡æ•°æ¢¯åº¦ä¸‹é™çš„ç†è®ºåŸºç¡€</h3>
<h4 id="11">1.1 éè´Ÿçº¦æŸä¼˜åŒ–é—®é¢˜</h4>
<p>å¯¹äºå‚æ•°ç©ºé—´å—é™äºéè´Ÿè±¡é™çš„ä¼˜åŒ–é—®é¢˜ï¼š
\begin{equation}\min_{\boldsymbol{\theta} \geq \boldsymbol{0}} \mathcal{L}(\boldsymbol{\theta})\tag{1}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šè®¸å¤šå®é™…é—®é¢˜å…·æœ‰éè´Ÿçº¦æŸï¼Œå¦‚æ¦‚ç‡åˆ†å¸ƒã€æ³¨æ„åŠ›æƒé‡ã€èµ„æºåˆ†é…ç­‰ã€‚</p>
<p>æ ‡å‡†æ¢¯åº¦ä¸‹é™æ— æ³•ä¿è¯éè´Ÿæ€§ï¼š
\begin{equation}\boldsymbol{\theta}<em _boldsymbol_theta="\boldsymbol{\theta">{t+1} = \boldsymbol{\theta}_t - \eta\nabla</em>}}\mathcal{L}(\boldsymbol{\theta}_t)\tag{2}\end{equation</p>
<p>å³ä½¿$\boldsymbol{\theta}<em t_1="t+1">t \geq \boldsymbol{0}$ï¼Œä¹Ÿå¯èƒ½äº§ç”Ÿ$\boldsymbol{\theta}</em>$çš„æŸäº›åˆ†é‡ä¸ºè´Ÿã€‚</p>
<h4 id="12">1.2 æŒ‡æ•°æ¢¯åº¦ä¸‹é™æ›´æ–°è§„åˆ™</h4>
<p>æŒ‡æ•°æ¢¯åº¦ä¸‹é™ï¼ˆEGDï¼‰å®šä¹‰ä¸ºï¼š
\begin{equation}\boldsymbol{\theta}<em _boldsymbol_theta="\boldsymbol{\theta">{t+1} = \boldsymbol{\theta}_t \odot \exp\left(- \eta\nabla</em>}}\mathcal{L}(\boldsymbol{\theta}_t)\right)\tag{3}\end{equation</p>
<p><strong>å…³é”®æ€§è´¨</strong>ï¼š
1. <strong>éè´Ÿæ€§ä¿æŒ</strong>ï¼š$\boldsymbol{\theta}_0 &gt; \boldsymbol{0} \Rightarrow \boldsymbol{\theta}_t &gt; \boldsymbol{0}, \forall t$
2. <strong>ä¹˜æ€§æ›´æ–°</strong>ï¼šç›¸å¯¹å˜åŒ–ä¸æ¢¯åº¦æˆæ­£æ¯”
3. <strong>å°ºåº¦ä¸å˜æ€§</strong>ï¼šå¯¹å‚æ•°ç¼©æ”¾å…·æœ‰è‰¯å¥½æ€§è´¨</p>
<p>åˆ†é‡å½¢å¼ï¼š
\begin{equation}\theta_{t+1,i} = \theta_{t,i} \exp\left(- \eta \frac{\partial \mathcal{L}}{\partial \theta_{t,i}}\right)\tag{4}\end{equation}</p>
<h4 id="13">1.3 ä»å¯¹æ•°ç©ºé—´çš„è§’åº¦ç†è§£</h4>
<p>å¼•å…¥å¯¹æ•°å‚æ•°åŒ–ï¼š
\begin{equation}\boldsymbol{\varphi} = \log \boldsymbol{\theta} \quad \Leftrightarrow \quad \boldsymbol{\theta} = \exp(\boldsymbol{\varphi})\tag{5}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šå¯¹æ•°å˜æ¢å°†éè´Ÿçº¦æŸ$\boldsymbol{\theta} &gt; \boldsymbol{0}$è½¬åŒ–ä¸ºæ— çº¦æŸé—®é¢˜$\boldsymbol{\varphi} \in \mathbb{R}^d$ã€‚</p>
<p>é“¾å¼æ³•åˆ™ç»™å‡ºæ¢¯åº¦å…³ç³»ï¼š
\begin{equation}\nabla_{\boldsymbol{\varphi}}\mathcal{L}(e^{\boldsymbol{\varphi}}) = e^{\boldsymbol{\varphi}} \odot \nabla_{\boldsymbol{\theta}}\mathcal{L}(\boldsymbol{\theta})\tag{6}\end{equation}</p>
<p>åœ¨å¯¹æ•°ç©ºé—´è¿›è¡Œæ ‡å‡†æ¢¯åº¦ä¸‹é™ï¼š
\begin{equation}\boldsymbol{\varphi}<em _boldsymbol_varphi="\boldsymbol{\varphi">{t+1} = \boldsymbol{\varphi}_t - \eta \nabla</em>}}\mathcal{L}(e^{\boldsymbol{\varphi}_t})\tag{7}\end{equation</p>
<p>ä»£å…¥å¼(6)ï¼š
\begin{equation}\boldsymbol{\varphi}<em _boldsymbol_theta="\boldsymbol{\theta">{t+1} = \boldsymbol{\varphi}_t - \eta e^{\boldsymbol{\varphi}_t} \odot \nabla</em>}}\mathcal{L}(\boldsymbol{\theta}_t)\tag{8}\end{equation</p>
<p><strong>é¢„æ¡ä»¶åŒ–è§£é‡Š</strong>ï¼š$e^{\boldsymbol{\varphi}<em t_1="t+1">t}$é¡¹å¯è§†ä¸ºè‡ªé€‚åº”å­¦ä¹ ç‡ã€‚å¿½ç•¥æ­¤é¡¹å¾—åˆ°ï¼š
\begin{equation}\boldsymbol{\varphi}</em>} = \boldsymbol{\varphi<em _boldsymbol_theta="\boldsymbol{\theta">t - \eta \nabla</em>}}\mathcal{L}(\boldsymbol{\theta}_t)\tag{9}\end{equation</p>
<p>ä¸¤è¾¹å–æŒ‡æ•°ï¼š
\begin{equation}e^{\boldsymbol{\varphi}<em _boldsymbol_theta="\boldsymbol{\theta">{t+1}} = e^{\boldsymbol{\varphi}_t} \odot \exp\left(- \eta \nabla</em>}}\mathcal{L}(\boldsymbol{\theta}_t)\right)\tag{10}\end{equation</p>
<p>æ¢å¤åŸå‚æ•°$\boldsymbol{\theta} = e^{\boldsymbol{\varphi}}$å³å¾—å¼(3)ã€‚</p>
<h3 id="2-bregman">2. é•œåƒä¸‹é™ä¸Bregmanæ•£åº¦</h3>
<h4 id="21-bregman">2.1 Bregmanæ•£åº¦</h4>
<p>ç»™å®šä¸¥æ ¼å‡¸å‡½æ•°$\psi: \mathbb{R}^d \to \mathbb{R}$ï¼ŒBregmanæ•£åº¦å®šä¹‰ä¸ºï¼š
\begin{equation}D_\psi(\boldsymbol{\theta}_1, \boldsymbol{\theta}_2) = \psi(\boldsymbol{\theta}_1) - \psi(\boldsymbol{\theta}_2) - \nabla\psi(\boldsymbol{\theta}_2)^{\top}(\boldsymbol{\theta}_1 - \boldsymbol{\theta}_2)\tag{11}\end{equation}</p>
<p><strong>å‡ ä½•æ„ä¹‰</strong>ï¼šå‡½æ•°å€¼ä¸å…¶çº¿æ€§è¿‘ä¼¼ä¹‹å·®ã€‚</p>
<p><strong>æ€§è´¨</strong>ï¼š
1. $D_\psi(\boldsymbol{\theta}<em>1, \boldsymbol{\theta}_2) \geq 0$ï¼ˆå‡¸æ€§ä¿è¯ï¼‰
2. $D</em>\psi(\boldsymbol{\theta}<em>1, \boldsymbol{\theta}_2) = 0 \Leftrightarrow \boldsymbol{\theta}_1 = \boldsymbol{\theta}_2$ï¼ˆä¸¥æ ¼å‡¸ä¿è¯ï¼‰
3. ä¸€èˆ¬ä¸å¯¹ç§°ï¼š$D</em>\psi(\boldsymbol{\theta}<em>1, \boldsymbol{\theta}_2) \neq D</em>\psi(\boldsymbol{\theta}_2, \boldsymbol{\theta}_1)$</p>
<h4 id="22">2.2 é•œåƒä¸‹é™æ¡†æ¶</h4>
<p>é•œåƒä¸‹é™æ›´æ–°è§„åˆ™ï¼š
\begin{equation}\boldsymbol{\theta}<em _boldsymbol_theta="\boldsymbol{\theta">{t+1} = \arg\min</em>}} \left{\eta \nabla\mathcal{L}(\boldsymbol{\theta<em>t)^{\top}\boldsymbol{\theta} + D</em>\psi(\boldsymbol{\theta}, \boldsymbol{\theta}_t)\right}\tag{12}\end{equation}</p>
<p>ä¸€é˜¶æœ€ä¼˜æ€§æ¡ä»¶ï¼š
\begin{equation}\eta \nabla\mathcal{L}(\boldsymbol{\theta}<em t_1="t+1">t) + \nabla\psi(\boldsymbol{\theta}</em>}) - \nabla\psi(\boldsymbol{\theta}_t) = \boldsymbol{0}\tag{13}\end{equation</p>
<p>å³ï¼š
\begin{equation}\nabla\psi(\boldsymbol{\theta}_{t+1}) = \nabla\psi(\boldsymbol{\theta}_t) - \eta \nabla\mathcal{L}(\boldsymbol{\theta}_t)\tag{14}\end{equation}</p>
<h4 id="23">2.3 è´Ÿç†µä½œä¸ºé•œåƒå‡½æ•°</h4>
<p>å¯¹äºéè´Ÿå•çº¯å½¢$\Delta_d = {\boldsymbol{\theta} \geq \boldsymbol{0}: \sum_i \theta_i = 1}$ï¼Œé€‰æ‹©è´Ÿç†µï¼š
\begin{equation}\psi(\boldsymbol{\theta}) = \sum_{i=1}^d \theta_i \log \theta_i\tag{15}\end{equation}</p>
<p>æ¢¯åº¦ä¸ºï¼š
\begin{equation}\nabla\psi(\boldsymbol{\theta}) = \boldsymbol{1} + \log \boldsymbol{\theta}\tag{16}\end{equation}</p>
<p>ä»£å…¥å¼(14)ï¼š
\begin{equation}\boldsymbol{1} + \log \boldsymbol{\theta}_{t+1} = \boldsymbol{1} + \log \boldsymbol{\theta}_t - \eta \nabla\mathcal{L}(\boldsymbol{\theta}_t)\tag{17}\end{equation}</p>
<p>åŒ–ç®€å¾—ï¼š
\begin{equation}\log \boldsymbol{\theta}_{t+1} = \log \boldsymbol{\theta}_t - \eta \nabla\mathcal{L}(\boldsymbol{\theta}_t)\tag{18}\end{equation}</p>
<p>ä¸¤è¾¹å–æŒ‡æ•°ï¼š
\begin{equation}\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t \odot \exp(-\eta \nabla\mathcal{L}(\boldsymbol{\theta}_t))\tag{19}\end{equation}</p>
<p><strong>é‡è¦ç»“è®º</strong>ï¼šæŒ‡æ•°æ¢¯åº¦ä¸‹é™æ˜¯ä»¥è´Ÿç†µä¸ºé•œåƒå‡½æ•°çš„é•œåƒä¸‹é™ã€‚</p>
<h4 id="24-klbregman">2.4 KLæ•£åº¦ä¸è´Ÿç†µBregmanæ•£åº¦</h4>
<p>è´Ÿç†µçš„Bregmanæ•£åº¦æ­£æ˜¯KLæ•£åº¦ï¼š
\begin{equation}\begin{aligned}
D_\psi(\boldsymbol{p}, \boldsymbol{q}) &amp;= \sum_i p_i \log p_i - \sum_i q_i \log q_i - \sum_i (1 + \log q_i)(p_i - q_i)\
&amp;= \sum_i p_i \log p_i - \sum_i p_i \log q_i\
&amp;= \sum_i p_i \log \frac{p_i}{q_i}\
&amp;= \text{KL}(\boldsymbol{p} | \boldsymbol{q})
\end{aligned}\tag{20}\end{equation}</p>
<h3 id="3">3. åœ¨çº¿å­¦ä¹ ç†è®ºä¸é—æ†¾ç•Œ</h3>
<h4 id="31">3.1 åœ¨çº¿å‡¸ä¼˜åŒ–è®¾ç½®</h4>
<p>åœ¨çº¿å­¦ä¹ åè®®ï¼š
1. ç¬¬$t$è½®ï¼Œå­¦ä¹ è€…é€‰æ‹©$\boldsymbol{\theta}_t \in \mathcal{K}$
2. ç¯å¢ƒæ­ç¤ºå‡¸æŸå¤±å‡½æ•°$\mathcal{L}_t: \mathcal{K} \to \mathbb{R}$
3. å­¦ä¹ è€…é­å—æŸå¤±$\mathcal{L}_t(\boldsymbol{\theta}_t)$</p>
<p><strong>é—æ†¾ï¼ˆRegretï¼‰</strong>å®šä¹‰ä¸ºç´¯ç§¯æŸå¤±ä¸æœ€ä¼˜å›ºå®šç­–ç•¥çš„å·®è·ï¼š
\begin{equation}R_T = \sum_{t=1}^T \mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">t(\boldsymbol{\theta}_t) - \min</em>^<em> \in \mathcal{K}} \sum_{t=1}^T \mathcal{L}_t(\boldsymbol{\theta}^</em>)\tag{21}\end{equation}</p>
<p><strong>ç›®æ ‡</strong>ï¼šè®¾è®¡ç®—æ³•ä½¿$R_T = o(T)$ï¼ˆæ¬¡çº¿æ€§é—æ†¾ï¼‰ã€‚</p>
<h4 id="32">3.2 æŒ‡æ•°æ¢¯åº¦ä¸‹é™çš„é—æ†¾ç•Œ</h4>
<p><strong>å®šç†1</strong>ï¼ˆEGDé—æ†¾ç•Œï¼‰ï¼šè®¾$\mathcal{K} = \Delta_d$ï¼ˆæ¦‚ç‡å•çº¯å½¢ï¼‰ï¼ŒæŸå¤±å‡½æ•°$\mathcal{L}<em>t$å‡¸ä¸”$|\nabla\mathcal{L}_t|</em>\infty \leq G$ã€‚æŒ‡æ•°æ¢¯åº¦ä¸‹é™ï¼ˆå­¦ä¹ ç‡$\eta = \sqrt{\frac{2\log d}{GT}}$ï¼‰ä¿è¯ï¼š
\begin{equation}R_T \leq \sqrt{2GT \log d}\tag{22}\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼šåˆ©ç”¨KLæ•£åº¦åˆ†ææ¡†æ¶ã€‚å¯¹ä»»æ„$\boldsymbol{\theta}^* \in \Delta_d$ï¼š</p>
<p><strong>æ­¥éª¤1</strong>ï¼šå‡¸å‡½æ•°æ€§è´¨
\begin{equation}\mathcal{L}_t(\boldsymbol{\theta}_t) - \mathcal{L}_t(\boldsymbol{\theta}^<em>) \leq \nabla\mathcal{L}_t(\boldsymbol{\theta}_t)^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>)\tag{23}\end{equation}</p>
<p><strong>æ­¥éª¤2</strong>ï¼šé•œåƒä¸‹é™åŸºæœ¬ä¸ç­‰å¼
\begin{equation}\nabla\mathcal{L}<em>t(\boldsymbol{\theta}_t)^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^<em>) \leq \frac{1}{\eta}\left[D_\psi(\boldsymbol{\theta}^</em>, \boldsymbol{\theta}_t) - D</em>\psi(\boldsymbol{\theta}^*, \boldsymbol{\theta}_{t+1})\right] + \frac{\eta}{2}|\nabla\mathcal{L}_t(\boldsymbol{\theta}_t)|^2\tag{24}\end{equation}</p>
<p>å…¶ä¸­$|\cdot|$æ˜¯å…³äº$\nabla^2\psi$çš„å¯¹å¶èŒƒæ•°ã€‚</p>
<p><strong>æ­¥éª¤3</strong>ï¼šå¯¹$t$æ±‚å’Œï¼ˆæœ›è¿œé•œå’Œï¼‰
\begin{equation}\sum_{t=1}^T \nabla\mathcal{L}<em t="1">t(\boldsymbol{\theta}_t)^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^<em>) \leq \frac{D_\psi(\boldsymbol{\theta}^</em>, \boldsymbol{\theta}_1)}{\eta} + \frac{\eta}{2}\sum</em>}^T |\nabla\mathcal{L}_t(\boldsymbol{\theta}_t)|^2\tag{25}\end{equation</p>
<p><strong>æ­¥éª¤4</strong>ï¼šç•Œå®šå„é¡¹</p>
<p>è´Ÿç†µæ•£åº¦æœ‰ç•Œï¼š
\begin{equation}D_\psi(\boldsymbol{\theta}^<em>, \boldsymbol{\theta}_1) = \text{KL}(\boldsymbol{\theta}^</em> | \boldsymbol{\theta}_1) \leq \log d\tag{26}\end{equation}</p>
<p>ï¼ˆå½“$\boldsymbol{\theta}_1 = (1/d, \ldots, 1/d)$å‡åŒ€åˆå§‹åŒ–æ—¶å–ç­‰ï¼‰</p>
<p>æ¢¯åº¦å¹³æ–¹å’Œï¼š
\begin{equation}\sum_{t=1}^T |\nabla\mathcal{L}_t(\boldsymbol{\theta}_t)|^2 \leq TG^2\tag{27}\end{equation}</p>
<p><strong>æ­¥éª¤5</strong>ï¼šä»£å…¥å¹¶ä¼˜åŒ–å­¦ä¹ ç‡
\begin{equation}R_T \leq \frac{\log d}{\eta} + \frac{\eta TG^2}{2}\tag{28}\end{equation}</p>
<p>é€‰æ‹©$\eta = \sqrt{\frac{2\log d}{TG^2}}$æœ€å°åŒ–å³ç«¯ï¼š
\begin{equation}R_T \leq \sqrt{2TG^2 \log d} = \sqrt{2GT\log d}\tag{29}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼š$O(\sqrt{T})$é—æ†¾æ˜¯æœ€ä¼˜çš„ï¼ŒKLæ•£åº¦çš„å¯¹æ•°ä¸Šç•Œæä¾›äº†ç»´åº¦ä¾èµ–ã€‚</p>
<h3 id="4">4. å…ƒå­¦ä¹ çš„æ•°å­¦æ¡†æ¶</h3>
<h4 id="41">4.1 åŒå±‚ä¼˜åŒ–è§†è§’</h4>
<p>å…ƒå­¦ä¹ ç›®æ ‡ï¼šå­¦ä¹ å¦‚ä½•å­¦ä¹ ï¼Œå³ä¼˜åŒ–ä¼˜åŒ–å™¨æœ¬èº«ã€‚</p>
<p><strong>å¤–å±‚ä¼˜åŒ–</strong>ï¼šä¼˜åŒ–å™¨å‚æ•°ï¼ˆå¦‚å­¦ä¹ ç‡ï¼‰
\begin{equation}\min_{\boldsymbol{\nu}} \mathbb{E}<em _text_val="\text{val">{\text{task}} \left[\mathcal{L}</em>}}(\boldsymbol{\theta}^*(\boldsymbol{\nu}))\right]\tag{30}\end{equation</p>
<p><strong>å†…å±‚ä¼˜åŒ–</strong>ï¼šæ¨¡å‹å‚æ•°
\begin{equation}\boldsymbol{\theta}^*(\boldsymbol{\nu}) = \arg\min_{\boldsymbol{\theta}} \mathcal{L}_{\text{train}}(\boldsymbol{\theta}; \boldsymbol{\nu})\tag{31}\end{equation}</p>
<h4 id="42">4.2 è‡ªé€‚åº”å­¦ä¹ ç‡çš„å…ƒå­¦ä¹ æ¨å¯¼</h4>
<p>ç›®æ ‡å‡½æ•°ï¼š
\begin{equation}\mathcal{L}(\boldsymbol{\theta})\tag{32}\end{equation}</p>
<p>å¼•å…¥åˆ†é‡çº§å­¦ä¹ ç‡$\boldsymbol{\nu} \in \mathbb{R}<em t_1="t+1">{++}^d$ï¼š
\begin{equation}\boldsymbol{\theta}</em>} = \boldsymbol{\theta<em t_1="t+1">t - \eta \boldsymbol{\nu}</em>} \odot \boldsymbol{g}_t\tag{33}\end{equation</p>
<p>å…¶ä¸­$\boldsymbol{g}<em _boldsymbol_theta="\boldsymbol{\theta">t = \nabla</em>_t)$ã€‚}}\mathcal{L}(\boldsymbol{\theta</p>
<p><strong>å…ƒå­¦ä¹ åŸåˆ™</strong>ï¼š$\boldsymbol{\nu}$çš„æ›´æ–°ä¹Ÿåº”æœ€å°åŒ–$\mathcal{L}$ã€‚</p>
<h4 id="43">4.3 å­¦ä¹ ç‡çš„æ¢¯åº¦è®¡ç®—</h4>
<p>é“¾å¼æ³•åˆ™ï¼š
\begin{equation}\nabla_{\boldsymbol{\nu}<em _boldsymbol_nu="\boldsymbol{\nu">t} \mathcal{L}(\boldsymbol{\theta}_t) = \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t} \boldsymbol{\theta}_t \cdot \nabla</em>}_t} \mathcal{L}(\boldsymbol{\theta}_t)\tag{34}\end{equation</p>
<p>ç”±å¼(33)ï¼š
\begin{equation}\frac{\partial \theta_{t,i}}{\partial \nu_{t,j}} = -\eta g_{t-1,i} \delta_{ij}\tag{35}\end{equation}</p>
<p>çŸ©é˜µå½¢å¼ï¼š
\begin{equation}\nabla_{\boldsymbol{\nu}<em t-1="t-1">t} \boldsymbol{\theta}_t = -\eta \text{diag}(\boldsymbol{g}</em>})\tag{36}\end{equation</p>
<p>ä»£å…¥å¼(34)ï¼š
\begin{equation}\nabla_{\boldsymbol{\nu}<em t-1="t-1">t} \mathcal{L} = -\eta \text{diag}(\boldsymbol{g}</em>}) \boldsymbol{g<em t-1="t-1">t = -\eta \boldsymbol{g}</em>} \odot \boldsymbol{g}_t\tag{37}\end{equation</p>
<h4 id="44">4.4 æŒ‡æ•°æ¢¯åº¦æ›´æ–°å­¦ä¹ ç‡</h4>
<p>ç”±äº$\boldsymbol{\nu} &gt; \boldsymbol{0}$ï¼Œä½¿ç”¨æŒ‡æ•°æ¢¯åº¦ä¸‹é™ï¼š
\begin{equation}\boldsymbol{\nu}<em _boldsymbol_nu="\boldsymbol{\nu">{t+1} = \boldsymbol{\nu}_t \odot \exp\left(-\gamma \nabla</em>}_t} \mathcal{L}\right)\tag{38}\end{equation</p>
<p>ä»£å…¥å¼(37)ï¼š
\begin{equation}\boldsymbol{\nu}<em t-1="t-1">{t+1} = \boldsymbol{\nu}_t \odot \exp\left(\gamma \eta \boldsymbol{g}</em>} \odot \boldsymbol{g}_t\right)\tag{39}\end{equation</p>
<p>å®šä¹‰$\gamma' = \gamma \eta$ï¼Œåˆå¹¶è¶…å‚æ•°ï¼š
\begin{equation}\boldsymbol{\nu}<em t-1="t-1">{t+1} = \boldsymbol{\nu}_t \odot \exp\left(\gamma' \boldsymbol{g}</em>} \odot \boldsymbol{g}_t\right)\tag{40}\end{equation</p>
<p><strong>å®Œæ•´ç®—æ³•</strong>ï¼š
\begin{equation}\begin{cases}
\boldsymbol{\nu}<em t-1="t-1">{t+1} = \boldsymbol{\nu}_t \odot \exp\left(\gamma \boldsymbol{g}</em>} \odot \boldsymbol{g<em t_1="t+1">t\right)\
\boldsymbol{\theta}</em>} = \boldsymbol{\theta<em t_1="t+1">t - \eta \boldsymbol{\nu}</em>_t
\end{cases}\tag{41}\end{equation}} \odot \boldsymbol{g</p>
<h4 id="45">4.5 ç´¯ç§¯å½¢å¼ä¸ç›´è§‰</h4>
<p>åˆå§‹åŒ–$\boldsymbol{\nu}<em k="1">0 = \boldsymbol{1}$ï¼Œé€’æ¨å±•å¼€ï¼š
\begin{equation}\boldsymbol{\nu}_t = \exp\left(\gamma \sum</em>}^{t-1} \boldsymbol{g<em k_1="k+1">k \odot \boldsymbol{g}</em>}\right)\tag{42}\end{equation</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼š
1. <strong>åŒå·æ¢¯åº¦</strong>ï¼šè‹¥$g_{k,i} \cdot g_{k+1,i} &gt; 0$ï¼ˆæ–¹å‘ä¸€è‡´ï¼‰ï¼Œç´¯ç§¯é¡¹å¢å¤§ï¼Œ$\nu_{t,i}$å¢å¤§ï¼ŒåŠ é€Ÿè¯¥æ–¹å‘
2. <strong>å¼‚å·æ¢¯åº¦</strong>ï¼šè‹¥$g_{k,i} \cdot g_{k+1,i} &lt; 0$ï¼ˆæ–¹å‘æŒ¯è¡ï¼‰ï¼Œç´¯ç§¯é¡¹å‡å°ï¼Œ$\nu_{t,i}$å‡å°ï¼ŒæŠ‘åˆ¶æŒ¯è¡
3. <strong>è‡ªé€‚åº”æ€§</strong>ï¼šæ¯ä¸ªåˆ†é‡ç‹¬ç«‹è°ƒæ•´ï¼Œå®ç°åˆ†é‡çº§å­¦ä¹ ç‡è‡ªé€‚åº”</p>
<h3 id="5-adam">5. ä¸Adamçš„æ¯”è¾ƒåˆ†æ</h3>
<h4 id="51-adam">5.1 Adamçš„å­¦ä¹ ç‡è°ƒæ•´æœºåˆ¶</h4>
<p>Adamæ›´æ–°è§„åˆ™ï¼š
\begin{equation}\begin{aligned}
\boldsymbol{m}<em t-1="t-1">t &amp;= \beta_1 \boldsymbol{m}</em>} + (1-\beta_1) \boldsymbol{g<em t-1="t-1">t\
\boldsymbol{v}_t &amp;= \beta_2 \boldsymbol{v}</em>} + (1-\beta_2) \boldsymbol{g<em t_1="t+1">t^2\
\boldsymbol{\theta}</em>
\end{aligned}\tag{43}\end{equation}} &amp;= \boldsymbol{\theta}_t - \eta \frac{\boldsymbol{m}_t}{\sqrt{\boldsymbol{v}_t} + \epsilon</p>
<p>æœ‰æ•ˆå­¦ä¹ ç‡ï¼š
\begin{equation}\boldsymbol{\nu}_t^{\text{Adam}} = \frac{\eta}{\sqrt{\boldsymbol{v}_t} + \epsilon}\tag{44}\end{equation}</p>
<p><strong>AdamåŸåˆ™</strong>ï¼šæ¢¯åº¦å°çš„åˆ†é‡éœ€è¦æ›´å¤§å­¦ä¹ ç‡ï¼ˆå¯èƒ½æœªå……åˆ†å­¦ä¹ ï¼‰ã€‚</p>
<h4 id="52">5.2 å…ƒå­¦ä¹ æ–¹æ³•çš„åŸåˆ™</h4>
<p>å…ƒå­¦ä¹ æœ‰æ•ˆå­¦ä¹ ç‡ï¼ˆä»å¼(42)ï¼‰ï¼š
\begin{equation}\boldsymbol{\nu}<em k="1">t^{\text{Meta}} = \eta \exp\left(\gamma \sum</em>}^{t-1} \boldsymbol{g<em k_1="k+1">k \odot \boldsymbol{g}</em>}\right)\tag{45}\end{equation</p>
<p><strong>å…ƒå­¦ä¹ åŸåˆ™</strong>ï¼šæ¢¯åº¦æ–¹å‘ä¸€è‡´çš„åˆ†é‡éœ€è¦æ›´å¤§å­¦ä¹ ç‡ï¼ˆç¨³å®šä¼˜åŒ–æ–¹å‘ï¼‰ã€‚</p>
<h4 id="53">5.3 å®šé‡æ¯”è¾ƒ</h4>
<p>è€ƒè™‘å•ä¸ªåˆ†é‡$i$ï¼š</p>
<p><strong>åœºæ™¯1ï¼šæŒç»­å°æ¢¯åº¦</strong>
- Adamï¼š$v_{t,i}$å° â†’ $\nu_{t,i}^{\text{Adam}}$å¤§
- å…ƒå­¦ä¹ ï¼šè‹¥$g_{k,i}$åŒå·ä½†å°ï¼Œç´¯ç§¯æ…¢ â†’ $\nu_{t,i}^{\text{Meta}}$å¢é•¿æ…¢</p>
<p><strong>åœºæ™¯2ï¼šå¤§æ¢¯åº¦ç¨³å®šæ–¹å‘</strong>
- Adamï¼š$v_{t,i}$å¤§ â†’ $\nu_{t,i}^{\text{Adam}}$å°
- å…ƒå­¦ä¹ ï¼š$g_{k,i} \cdot g_{k+1,i}$æŒç»­å¤§æ­£å€¼ â†’ $\nu_{t,i}^{\text{Meta}}$æŒ‡æ•°å¢é•¿</p>
<p><strong>åœºæ™¯3ï¼šæ¢¯åº¦æŒ¯è¡</strong>
- Adamï¼š$v_{t,i}$å–å†³äº$\beta_2$ï¼Œç›¸å¯¹ç¨³å®š
- å…ƒå­¦ä¹ ï¼š$g_{k,i} \cdot g_{k+1,i}$æ­£è´Ÿäº¤æ›¿ â†’ $\nu_{t,i}^{\text{Meta}}$è¢«æŠ‘åˆ¶</p>
<p><strong>ç»“è®º</strong>ï¼šä¸¤ç§æ–¹æ³•åŸºäºä¸åŒå¯å‘å¼ï¼Œé€‚ç”¨äºä¸åŒä¼˜åŒ–æ™¯è§‚ã€‚</p>
<h3 id="6">6. æ”¶æ•›æ€§åˆ†æ</h3>
<h4 id="61">6.1 å‡¸æƒ…å†µçš„æ”¶æ•›ç‡</h4>
<p><strong>å®šç†2</strong>ï¼ˆå…ƒå­¦ä¹ EGDæ”¶æ•›ï¼‰ï¼šè®¾$\mathcal{L}$ä¸º$L$-Lipschitzå‡¸å‡½æ•°ï¼Œå­¦ä¹ ç‡$\eta = O(1/\sqrt{T})$ï¼Œ$\gamma = O(1)$ã€‚åˆ™å…ƒå­¦ä¹ æŒ‡æ•°æ¢¯åº¦ä¸‹é™æ»¡è¶³ï¼š
\begin{equation}\frac{1}{T}\sum_{t=1}^T \mathcal{L}(\boldsymbol{\theta}_t) - \mathcal{L}(\boldsymbol{\theta}^*) = O\left(\frac{\log T}{\sqrt{T}}\right)\tag{46}\end{equation}</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼š
1. åˆ©ç”¨å‡¸æ€§ï¼š$\mathcal{L}(\boldsymbol{\theta}_t) - \mathcal{L}(\boldsymbol{\theta}^<em>) \leq \boldsymbol{g}_t^{\top}(\boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>)$
2. åˆ†æ$|\boldsymbol{\theta}_t - \boldsymbol{\theta}^*|^2$çš„é€’æ¨
3. $\boldsymbol{\nu}_t$çš„æŒ‡æ•°å¢é•¿éœ€è¦é¢å¤–$\log T$å› å­æ§åˆ¶</p>
<h4 id="62">6.2 å¼ºå‡¸æƒ…å†µ</h4>
<p><strong>å®šç†3</strong>ï¼šè‹¥$\mathcal{L}$ä¸º$\mu$-å¼ºå‡¸ï¼Œåˆ™å­˜åœ¨$\eta, \gamma$ä½¿å¾—ï¼š
\begin{equation}\mathbb{E}[|\boldsymbol{\theta}_T - \boldsymbol{\theta}^<em>|^2] \leq \left(1 - \frac{\mu\eta}{2}\right)^T |\boldsymbol{\theta}_0 - \boldsymbol{\theta}^</em>|^2 + O\left(\frac{\eta^2 \sigma^2}{\mu}\right)\tag{47}\end{equation}</p>
<p>å…¶ä¸­$\sigma^2$æ˜¯æ¢¯åº¦æ–¹å·®ä¸Šç•Œã€‚</p>
<p><strong>æ”¶æ•›é€Ÿç‡</strong>ï¼šçº¿æ€§æ”¶æ•› + æ–¹å·®ä¸»å¯¼çš„æ®‹å·®ã€‚</p>
<h3 id="7">7. æ•°å€¼ç¨³å®šæ€§åˆ†æ</h3>
<h4 id="71">7.1 æŒ‡æ•°æº¢å‡ºé—®é¢˜</h4>
<p>å¼(40)ä¸­çš„æŒ‡æ•°è¿ç®—å¯èƒ½å¯¼è‡´æ•°å€¼æº¢å‡ºï¼š
\begin{equation}\nu_{t+1,i} = \nu_{t,i} \exp(\gamma g_{t-1,i} g_{t,i})\tag{48}\end{equation}</p>
<p><strong>é—®é¢˜</strong>ï¼šè‹¥$\gamma g_{t-1,i} g_{t,i}$å¤§ï¼Œ$\exp(\cdot)$å¯èƒ½è¶…å‡ºæµ®ç‚¹è¡¨ç¤ºèŒƒå›´ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ1ï¼šå¯¹æ•°ç©ºé—´è®¡ç®—</strong>
\begin{equation}\log \nu_{t+1,i} = \log \nu_{t,i} + \gamma g_{t-1,i} g_{t,i}\tag{49}\end{equation}</p>
<p>ä½¿ç”¨æ—¶ï¼š
\begin{equation}\theta_{t+1,i} = \theta_{t,i} - \eta \exp(\log \nu_{t+1,i}) g_{t,i}\tag{50}\end{equation}</p>
<p><strong>è§£å†³æ–¹æ¡ˆ2ï¼šè£å‰ªæœºåˆ¶</strong>
\begin{equation}\nu_{t+1,i} = \nu_{t,i} \exp\left(\gamma \cdot \text{clip}(g_{t-1,i} g_{t,i}, -c, c)\right)\tag{51}\end{equation}</p>
<p>å…¶ä¸­$c &gt; 0$æ˜¯è£å‰ªé˜ˆå€¼ã€‚</p>
<h4 id="72">7.2 å­¦ä¹ ç‡çˆ†ç‚¸é˜²æŠ¤</h4>
<p>é™åˆ¶$\boldsymbol{\nu}<em t_i="t,i">t$çš„èŒƒå›´ï¼š
\begin{equation}\nu</em>} \in [\nu_{\min}, \nu_{\max}]\tag{52}\end{equation</p>
<p>æŠ•å½±æ“ä½œï¼š
\begin{equation}\nu_{t+1,i} = \text{clip}\left(\nu_{t,i} \exp(\gamma g_{t-1,i} g_{t,i}), \nu_{\min}, \nu_{\max}\right)\tag{53}\end{equation}</p>
<p>å…¸å‹å€¼ï¼š$\nu_{\min} = 10^{-3}, \nu_{\max} = 10^3$ã€‚</p>
<h4 id="73">7.3 æ¢¯åº¦å™ªå£°çš„å½±å“</h4>
<p>éšæœºæ¢¯åº¦æƒ…å†µï¼š$\tilde{\boldsymbol{g}}_t = \boldsymbol{g}_t + \boldsymbol{\xi}_t$ï¼Œå…¶ä¸­$\mathbb{E}[\boldsymbol{\xi}_t] = \boldsymbol{0}$ã€‚</p>
<p>å™ªå£°å¯¹å­¦ä¹ ç‡æ›´æ–°çš„å½±å“ï¼š
\begin{equation}\mathbb{E}[\tilde{g}<em t_i="t,i">{t-1,i} \tilde{g}</em>}] = g_{t-1,i} g_{t,i} + \mathbb{E}[\xi_{t-1,i} \xi_{t,i}]\tag{54}\end{equation</p>
<p>è‹¥å™ªå£°ç‹¬ç«‹ï¼š$\mathbb{E}[\xi_{t-1,i} \xi_{t,i}] = 0$ï¼Œæ–¹æ³•å¯¹å™ªå£°é²æ£’ã€‚</p>
<p>ä½†æ–¹å·®å½±å“ï¼š
\begin{equation}\text{Var}(\tilde{g}<em t_i="t,i">{t-1,i} \tilde{g}</em>}) \approx g_{t-1,i}^2 \sigma_{t,i}^2 + g_{t,i}^2 \sigma_{t-1,i}^2\tag{55}\end{equation</p>
<p><strong>å»ºè®®</strong>ï¼šåœ¨å™ªå£°å¤§çš„åœºæ™¯å‡å°$\gamma$ã€‚</p>
<h3 id="8">8. å®é™…ç®—æ³•å®ç°</h3>
<h4 id="81">8.1 å®Œæ•´ä¼ªä»£ç </h4>
<div class="codehilite"><pre><span></span><code>è¾“å…¥ï¼šåˆå§‹å‚æ•° Î¸â‚€ï¼ŒåŸºç¡€å­¦ä¹ ç‡ Î·ï¼Œå…ƒå­¦ä¹ ç‡ Î³
      æœ€å¤§è¿­ä»£æ•° T
åˆå§‹åŒ–ï¼šÎ½â‚€ = 1ï¼ˆå…¨1å‘é‡ï¼‰
       gâ‚€ = 0

for t = 1 to T do
    # è®¡ç®—æ¢¯åº¦
    g_t = âˆ‡_Î¸ L(Î¸_{t-1})

    # æ›´æ–°è‡ªé€‚åº”å­¦ä¹ ç‡
    Î½_t = Î½_{t-1} âŠ™ exp(Î³ Â· g_{t-1} âŠ™ g_t)

    # æ•°å€¼ç¨³å®šæ€§ï¼šè£å‰ªå­¦ä¹ ç‡
    Î½_t = clip(Î½_t, Î½_min, Î½_max)

    # æ›´æ–°å‚æ•°
    Î¸_t = Î¸_{t-1} - Î· Â· Î½_t âŠ™ g_t

end for
è¿”å›ï¼šÎ¸_T
</code></pre></div>

<h4 id="82-pytorch">8.2 PyTorchå®ç°ç¤ºä¾‹</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MetaEGD</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Optimizer</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">meta_lr</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span>
                 <span class="n">nu_min</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span> <span class="n">nu_max</span><span class="o">=</span><span class="mf">1e3</span><span class="p">):</span>
        <span class="n">defaults</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span> <span class="n">meta_lr</span><span class="o">=</span><span class="n">meta_lr</span><span class="p">,</span>
                       <span class="n">nu_min</span><span class="o">=</span><span class="n">nu_min</span><span class="p">,</span> <span class="n">nu_max</span><span class="o">=</span><span class="n">nu_max</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MetaEGD</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">defaults</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">closure</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">closure</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">loss</span> <span class="o">=</span> <span class="n">closure</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">param_groups</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;params&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="n">grad</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">data</span>
                <span class="n">state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state</span><span class="p">[</span><span class="n">p</span><span class="p">]</span>

                <span class="c1"># çŠ¶æ€åˆå§‹åŒ–</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">state</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                    <span class="n">state</span><span class="p">[</span><span class="s1">&#39;prev_grad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

                <span class="c1"># è·å–çŠ¶æ€</span>
                <span class="n">nu</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span>
                <span class="n">prev_grad</span> <span class="o">=</span> <span class="n">state</span><span class="p">[</span><span class="s1">&#39;prev_grad&#39;</span><span class="p">]</span>

                <span class="c1"># æ›´æ–°è‡ªé€‚åº”å­¦ä¹ ç‡</span>
                <span class="n">nu</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
                    <span class="n">group</span><span class="p">[</span><span class="s1">&#39;meta_lr&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">prev_grad</span> <span class="o">*</span> <span class="n">grad</span>
                <span class="p">)</span>

                <span class="c1"># è£å‰ª</span>
                <span class="n">nu</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">clamp</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;nu_min&#39;</span><span class="p">],</span> <span class="n">group</span><span class="p">[</span><span class="s1">&#39;nu_max&#39;</span><span class="p">])</span>

                <span class="c1"># æ›´æ–°å‚æ•°</span>
                <span class="n">p</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=-</span><span class="n">group</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">nu</span><span class="p">)</span>

                <span class="c1"># ä¿å­˜çŠ¶æ€</span>
                <span class="n">state</span><span class="p">[</span><span class="s1">&#39;nu&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">nu</span>
                <span class="n">state</span><span class="p">[</span><span class="s1">&#39;prev_grad&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">grad</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

        <span class="k">return</span> <span class="n">loss</span>
</code></pre></div>

<h3 id="9">9. è®¡ç®—å¤æ‚åº¦åˆ†æ</h3>
<h4 id="91">9.1 æ—¶é—´å¤æ‚åº¦</h4>
<p>æ¯æ¬¡è¿­ä»£çš„æ“ä½œï¼š
1. æ¢¯åº¦è®¡ç®—ï¼š$O(M)$ï¼ˆ$M$ä¸ºæ¨¡å‹å¤æ‚åº¦ï¼‰
2. é€å…ƒç´ ä¹˜æ³• $\boldsymbol{g}_{t-1} \odot \boldsymbol{g}_t$ï¼š$O(d)$
3. æŒ‡æ•°è¿ç®—ï¼š$O(d)$
4. å‚æ•°æ›´æ–°ï¼š$O(d)$</p>
<p><strong>æ€»å¤æ‚åº¦</strong>ï¼š$O(M + d)$ï¼Œä¸æ ‡å‡†SGDç›¸åŒé‡çº§ã€‚</p>
<h4 id="92">9.2 ç©ºé—´å¤æ‚åº¦</h4>
<p>éœ€è¦é¢å¤–å­˜å‚¨ï¼š
1. $\boldsymbol{\nu}<em t-1="t-1">t$ï¼š$O(d)$
2. $\boldsymbol{g}</em>$ï¼š$O(d)$</p>
<p><strong>æ€»é¢å¤–ç©ºé—´</strong>ï¼š$O(d)$</p>
<p>ä¸Adamï¼ˆå­˜å‚¨$\boldsymbol{m}_t, \boldsymbol{v}_t$ï¼Œå…±$2d$ï¼‰ç›¸æ¯”æ›´èŠ‚çœã€‚</p>
<h3 id="10">10. å®è·µå»ºè®®ä¸è¶…å‚æ•°è°ƒä¼˜</h3>
<h4 id="101">10.1 è¶…å‚æ•°é€‰æ‹©æŒ‡å—</h4>
<p><strong>åŸºç¡€å­¦ä¹ ç‡ $\eta$</strong>ï¼š
- åˆå§‹å°è¯•ï¼š$\eta \in [10^{-4}, 10^{-2}]$
- ä¸æ ‡å‡†SGDç›¸æ¯”å¯ç•¥å°ï¼ˆå› ä¸º$\boldsymbol{\nu}_t$ä¼šæ”¾å¤§ï¼‰</p>
<p><strong>å…ƒå­¦ä¹ ç‡ $\gamma$</strong>ï¼š
- æ¨èèŒƒå›´ï¼š$\gamma \in [0.01, 0.5]$
- æ¢¯åº¦å™ªå£°å¤§æ—¶å‡å°$\gamma$
- æŸå¤±landscapeå¹³æ»‘æ—¶å¯å¢å¤§$\gamma$</p>
<p><strong>è£å‰ªèŒƒå›´</strong>ï¼š
- $\nu_{\min} = 10^{-3}, \nu_{\max} = 10^{3}$ï¼ˆé»˜è®¤ï¼‰
- è®­ç»ƒä¸ç¨³å®šæ—¶æ”¶ç´§èŒƒå›´</p>
<h4 id="102">10.2 é€‚ç”¨åœºæ™¯</h4>
<p><strong>æ¨èä½¿ç”¨</strong>ï¼š
1. ç¨€ç–æ¢¯åº¦é—®é¢˜ï¼ˆNLPã€æ¨èç³»ç»Ÿï¼‰
2. ä¸åŒå‚æ•°æœ‰ä¸åŒä¼˜åŒ–éš¾åº¦
3. æ¢¯åº¦æ–¹å‘ç›¸å¯¹ç¨³å®š</p>
<p><strong>ä¸æ¨èä½¿ç”¨</strong>ï¼š
1. æé«˜ç»´é—®é¢˜ï¼ˆå­˜å‚¨$\boldsymbol{g}_{t-1}$ï¼‰
2. æ¢¯åº¦å™ªå£°æå¤§
3. éœ€è¦å¿«é€Ÿæ”¶æ•›çš„åœºæ™¯ï¼ˆwarmupæ…¢ï¼‰</p>
<h4 id="103">10.3 è°ƒè¯•æŠ€å·§</h4>
<p><strong>ç›‘æ§æŒ‡æ ‡</strong>ï¼š
1. $|\boldsymbol{\nu}<em>t|</em>\infty$ï¼šæ£€æŸ¥æ˜¯å¦è§¦åŠè¾¹ç•Œ
2. $\text{sign}(\boldsymbol{g}_{t-1} \odot \boldsymbol{g}_t)$çš„æ­£è´Ÿæ¯”ä¾‹
3. æœ‰æ•ˆå­¦ä¹ ç‡åˆ†å¸ƒï¼š$\eta \boldsymbol{\nu}_t$</p>
<p><strong>å¸¸è§é—®é¢˜</strong>ï¼š
- <strong>å­¦ä¹ ç‡çˆ†ç‚¸</strong>ï¼šå‡å°$\gamma$æˆ–æ”¶ç´§$\nu_{\max}$
- <strong>æ”¶æ•›æ…¢</strong>ï¼šå¢å¤§$\eta$æˆ–$\gamma$
- <strong>æŸå¤±æŒ¯è¡</strong>ï¼šå‡å°$\gamma$ï¼ˆè¿‡åº¦æ”¾å¤§æŒ¯è¡æ–¹å‘ï¼‰</p>
<h3 id="11_1">11. ç†è®ºæ‰©å±•ä¸å˜ä½“</h3>
<h4 id="111">11.1 å¸¦åŠ¨é‡çš„å˜ä½“</h4>
<p>ç»“åˆNesterovåŠ¨é‡ï¼š
\begin{equation}\begin{aligned}
\boldsymbol{v}<em t-1="t-1">t &amp;= \beta \boldsymbol{v}</em>} + \boldsymbol{g<em t_1="t+1">t\
\boldsymbol{\nu}</em>} &amp;= \boldsymbol{\nu<em t-1="t-1">t \odot \exp(\gamma \boldsymbol{v}</em>} \odot \boldsymbol{v<em t_1="t+1">t)\
\boldsymbol{\theta}</em>} &amp;= \boldsymbol{\theta<em t_1="t+1">t - \eta \boldsymbol{\nu}</em>_t
\end{aligned}\tag{56}\end{equation}} \odot \boldsymbol{v</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼šåŠ¨é‡å¹³æ»‘æ¢¯åº¦ä¼°è®¡ï¼Œå‡å°‘å™ªå£°å½±å“ã€‚</p>
<h4 id="112">11.2 è‡ªé€‚åº”å…ƒå­¦ä¹ ç‡</h4>
<p>ä½¿$\gamma$ä¹Ÿè‡ªé€‚åº”ï¼š
\begin{equation}\gamma_t = \gamma_0 \cdot \exp\left(-\alpha \cdot \frac{t}{T}\right)\tag{57}\end{equation}</p>
<p><strong>åŠ¨æœº</strong>ï¼šè®­ç»ƒåæœŸæ¢¯åº¦æ›´ç¨³å®šï¼Œå¯å‡å°å…ƒå­¦ä¹ ç‡é¿å…è¿‡æ‹Ÿåˆã€‚</p>
<h4 id="113">11.3 åˆ†ç»„å­¦ä¹ ç‡</h4>
<p>å°†å‚æ•°åˆ†ç»„${\boldsymbol{\theta}^{(1)}, \ldots, \boldsymbol{\theta}^{(K)}}$ï¼Œæ¯ç»„ç‹¬ç«‹$\boldsymbol{\nu}^{(k)}$ï¼š
\begin{equation}\nu_{t+1}^{(k)} = \nu_t^{(k)} \odot \exp\left(\gamma_k \boldsymbol{g}_{t-1}^{(k)} \odot \boldsymbol{g}_t^{(k)}\right)\tag{58}\end{equation}</p>
<p><strong>åº”ç”¨</strong>ï¼šç¥ç»ç½‘ç»œä¸åŒå±‚ä½¿ç”¨ä¸åŒ$\gamma_k$ã€‚</p>
<h3 id="12_1">12. å®éªŒå»ºè®®ä¸åŸºå‡†æµ‹è¯•</h3>
<h4 id="121">12.1 ç©å…·é—®é¢˜éªŒè¯</h4>
<p><strong>äºŒæ¬¡ç¢—æµ‹è¯•</strong>ï¼š
\begin{equation}\mathcal{L}(\boldsymbol{\theta}) = \frac{1}{2}\boldsymbol{\theta}^{\top} Q \boldsymbol{\theta}\tag{59}\end{equation}</p>
<p>å…¶ä¸­$Q = \text{diag}(1, 10, 100)$ï¼ˆä¸åŒæ›²ç‡ï¼‰ã€‚</p>
<p><strong>æœŸæœ›è¡Œä¸º</strong>ï¼š$\nu_{t,3} &gt; \nu_{t,2} &gt; \nu_{t,1}$ï¼ˆé«˜æ›²ç‡æ–¹å‘æ›´å¤§å­¦ä¹ ç‡ï¼‰ã€‚</p>
<h4 id="122">12.2 æ ‡å‡†åŸºå‡†</h4>
<ol>
<li><strong>MNIST/CIFAR-10</strong>ï¼šå°è§„æ¨¡è§†è§‰ä»»åŠ¡</li>
<li><strong>Penn TreeBank</strong>ï¼šè¯­è¨€å»ºæ¨¡</li>
<li><strong>IMDBæƒ…æ„Ÿåˆ†æ</strong>ï¼šç¨€ç–ç‰¹å¾åœºæ™¯</li>
</ol>
<p><strong>å¯¹æ¯”ä¼˜åŒ–å™¨</strong>ï¼šSGD, Adam, RMSProp, AdaGradã€‚</p>
<p><strong>è¯„ä¼°æŒ‡æ ‡</strong>ï¼š
- è®­ç»ƒæŸå¤±æ›²çº¿
- éªŒè¯å‡†ç¡®ç‡
- æ”¶æ•›æ­¥æ•°ï¼ˆè¾¾åˆ°ç›®æ ‡æŸå¤±çš„è¿­ä»£æ¬¡æ•°ï¼‰</p>
<h3 id="_5">æ€»ç»“</h3>
<p>æœ¬æ–‡è¯¦ç»†æ¨å¯¼äº†æŒ‡æ•°æ¢¯åº¦ä¸‹é™ä¸å…ƒå­¦ä¹ è‡ªé€‚åº”å­¦ä¹ ç‡çš„æ•°å­¦åŸºç¡€ï¼š</p>
<ol>
<li><strong>æŒ‡æ•°æ¢¯åº¦ä¸‹é™</strong>ï¼šé€šè¿‡å¯¹æ•°ç©ºé—´å˜æ¢å’Œé•œåƒä¸‹é™æ¡†æ¶ï¼Œå»ºç«‹äº†éè´Ÿçº¦æŸä¼˜åŒ–çš„ç†è®ºåŸºç¡€</li>
<li><strong>KLæ•£åº¦è”ç³»</strong>ï¼šè¯æ˜äº†è´Ÿç†µBregmanæ•£åº¦å³KLæ•£åº¦ï¼Œè¿æ¥ä¿¡æ¯å‡ ä½•ä¸ä¼˜åŒ–</li>
<li><strong>åœ¨çº¿å­¦ä¹ ç†è®º</strong>ï¼šç»™å‡ºäº†$O(\sqrt{T\log d})$é—æ†¾ç•Œ</li>
<li><strong>å…ƒå­¦ä¹ æ¨å¯¼</strong>ï¼šä»åŒå±‚ä¼˜åŒ–å‡ºå‘ï¼Œä¸¥æ ¼æ¨å¯¼äº†è‡ªé€‚åº”å­¦ä¹ ç‡æ›´æ–°è§„åˆ™</li>
<li><strong>æ•°å€¼ç¨³å®šæ€§</strong>ï¼šæä¾›äº†å¯¹æ•°ç©ºé—´è®¡ç®—å’Œè£å‰ªæœºåˆ¶</li>
<li><strong>å®è·µæŒ‡å¯¼</strong>ï¼šåŒ…å«å®Œæ•´å®ç°ã€è¶…å‚æ•°å»ºè®®å’Œè°ƒè¯•æŠ€å·§</li>
</ol>
<p>æ ¸å¿ƒæ´å¯Ÿï¼šæ¢¯åº¦æ–¹å‘çš„ä¸€è‡´æ€§ï¼ˆ$\boldsymbol{g}_{t-1} \odot \boldsymbol{g}_t$ï¼‰å¯ä½œä¸ºå­¦ä¹ ç‡è°ƒæ•´çš„ä¿¡å·ï¼Œè¿™ä¸AdamåŸºäºæ¢¯åº¦å¤§å°çš„ç­–ç•¥å½¢æˆäº’è¡¥ã€‚</p>
        </div>
    </div>
</body>
</html>