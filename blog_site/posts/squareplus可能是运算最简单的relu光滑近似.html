<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SquarePlusï¼šå¯èƒ½æ˜¯è¿ç®—æœ€ç®€å•çš„ReLUå…‰æ»‘è¿‘ä¼¼</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>SquarePlusï¼šå¯èƒ½æ˜¯è¿ç®—æœ€ç®€å•çš„ReLUå…‰æ»‘è¿‘ä¼¼</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 26.3 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8833">https://spaces.ac.cn/archives/8833</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ReLUå‡½æ•°ï¼Œä¹Ÿå°±æ˜¯$\max(x,0)$ï¼Œæ˜¯æœ€å¸¸è§çš„æ¿€æ´»å‡½æ•°ä¹‹ä¸€ï¼Œç„¶è€Œå®ƒåœ¨$x=0$å¤„çš„ä¸å¯å¯¼é€šå¸¸ä¹Ÿè¢«è§†ä¸ºä¸€ä¸ªâ€œæ§½ç‚¹â€ã€‚ä¸ºæ­¤ï¼Œæœ‰è¯¸å¤šçš„å…‰æ»‘è¿‘ä¼¼è¢«æå‡ºï¼Œæ¯”å¦‚SoftPlusã€GeLUã€Swishç­‰ï¼Œä¸è¿‡è¿™äº›å…‰æ»‘è¿‘ä¼¼æ— ä¸€ä¾‹å¤–åœ°è‡³å°‘éƒ½ä½¿ç”¨äº†æŒ‡æ•°è¿ç®—$e^x$ï¼ˆSoftPlusè¿˜ç”¨åˆ°äº†å¯¹æ•°ï¼‰ï¼Œä»â€œç²¾æ‰“ç»†ç®—â€çš„è§’åº¦æ¥çœ‹ï¼Œè®¡ç®—é‡è¿˜æ˜¯ä¸å°çš„ï¼ˆè™½ç„¶å½“å‰åœ¨GPUåŠ é€Ÿä¹‹ä¸‹ï¼Œæˆ‘ä»¬å¾ˆå°‘å»æ„ŸçŸ¥è¿™ç‚¹è®¡ç®—é‡äº†ï¼‰ã€‚æœ€è¿‘æœ‰ä¸€ç¯‡è®ºæ–‡<a href="https://papers.cool/arxiv/2112.11687">ã€ŠSquareplus: A Softplus-Like Algebraic Rectifierã€‹</a>æäº†ä¸€ä¸ªæ›´ç®€å•çš„è¿‘ä¼¼ï¼Œç§°ä¸ºSquarePlusï¼Œæˆ‘ä»¬ä¹Ÿæ¥è®¨è®ºè®¨è®ºã€‚</p>
<p>éœ€è¦äº‹å…ˆæŒ‡å‡ºçš„æ˜¯ï¼Œç¬”è€…æ˜¯ä¸å»ºè®®å¤§å®¶èŠ±å¤ªå¤šæ—¶é—´åœ¨æ¿€æ´»å‡½æ•°çš„é€‰æ‹©å’Œè®¾è®¡ä¸Šçš„ï¼Œæ‰€ä»¥è™½ç„¶åˆ†äº«äº†è¿™ç¯‡è®ºæ–‡ï¼Œä½†ä¸»è¦æ˜¯æä¾›ä¸€ä¸ªå‚è€ƒç»“æœï¼Œå¹¶å……å½“ä¸€é“ç»ƒä¹ é¢˜æ¥ç»™å¤§å®¶â€œç»ƒç»ƒæ‰‹â€ã€‚</p>
<h2 id="_1">å®šä¹‰</h2>
<p>SquarePlusçš„å½¢å¼å¾ˆç®€å•ï¼Œåªç”¨åˆ°äº†åŠ ã€ä¹˜ã€é™¤å’Œå¼€æ–¹ï¼š<br />
\begin{equation}\text{SquarePlus}(x)=\frac{x+\sqrt{x^2+b}}{2}\end{equation}<br />
å…¶ä¸­$b &gt; 0$ã€‚å½“$b=0$æ—¶ï¼Œæ­£å¥½é€€åŒ–ä¸º$\text{ReLU}(x)=\max(x,0)$ã€‚SquarePlusçš„çµæ„Ÿæ¥æºå¤§è‡´æ˜¯<br />
\begin{equation}\max(x,0)=\frac{x+|x|}{2}=\frac{x+\sqrt{x^2}}{2}\end{equation}<br />
å› æ­¤ä¸ºäº†è¡¥å……åœ¨$x=0$çš„å¯å¯¼æ€§ï¼Œåœ¨æ ¹å·é‡Œè¾¹å¤šåŠ ä¸€ä¸ªå¤§äº0çš„å¸¸æ•°$b$ï¼ˆé˜²æ­¢å¯¼æ•°å‡ºç°é™¤é›¶é—®é¢˜ï¼‰ã€‚</p>
<p>åŸè®ºæ–‡æŒ‡å‡ºï¼Œç”±äºåªç”¨åˆ°äº†åŠ ã€ä¹˜ã€é™¤å’Œå¼€æ–¹ï¼Œæ‰€ä»¥SquarePlusçš„é€Ÿåº¦ï¼ˆä¸»è¦æ˜¯åœ¨CPUä¸Šï¼‰ä¼šæ¯”SoftPlusç­‰å‡½æ•°è¦å¿«ï¼š  </p>
<p><a href="/usr/uploads/2021/12/1253499993.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="SquarePlusä¸å…¶ä»–ç±»ä¼¼å‡½æ•°çš„é€Ÿåº¦æ¯”è¾ƒ" src="/usr/uploads/2021/12/1253499993.png" /></a></p>
<p>SquarePlusä¸å…¶ä»–ç±»ä¼¼å‡½æ•°çš„é€Ÿåº¦æ¯”è¾ƒ</p>
<p>å½“ç„¶ï¼Œå¦‚æœä½ ä¸å…³å¿ƒè¿™ç‚¹é€Ÿåº¦æå‡ï¼Œé‚£ä¹ˆå°±åƒæœ¬æ–‡å¼€å¤´è¯´çš„ï¼Œå½“ä½œæ•°å­¦ç»ƒä¹ é¢˜æ¥çœ‹çœ‹å°±å¥½ã€‚</p>
<h2 id="_2">æ€§æ€</h2>
<p>è·ŸSoftPluså‡½æ•°ï¼ˆ$\log(e^x+1)$ï¼‰ä¸€æ ·ï¼ŒSquarePlusä¹Ÿæ˜¯å…¨å±€å•è°ƒé€’å¢çš„ï¼Œå¹¶ä¸”æ’å¤§äºReLUï¼Œå¦‚ä¸‹å›¾ï¼ˆä¸‹å›¾çš„SquarePlusçš„$b=1$ï¼‰ï¼š  </p>
<p><a href="/usr/uploads/2021/12/3874442376.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="ReLUã€SoftPlusã€SquarePluså‡½æ•°å›¾åƒï¼ˆä¸€ï¼‰" src="/usr/uploads/2021/12/3874442376.png" /></a></p>
<p>ReLUã€SoftPlusã€SquarePluså‡½æ•°å›¾åƒï¼ˆä¸€ï¼‰</p>
<p>ç›´æ¥æ±‚å®ƒçš„å¯¼å‡½æ•°ä¹Ÿå¯ä»¥çœ‹å‡ºå•è°ƒæ€§ï¼š<br />
\begin{equation}\frac{d}{dx}\text{SquarePlus}(x)=\frac{1}{2}\left(1+\frac{x}{\sqrt{x^2+b}}\right) &gt; 0\end{equation}<br />
è‡³äºäºŒé˜¶å¯¼æ•°<br />
\begin{equation}\frac{d^2}{dx^2}\text{SquarePlus}(x)=\frac{b}{2(x^2+b)^{3/2}}\end{equation}<br />
ä¹Ÿæ˜¯æ’å¤§äº0çš„å­˜åœ¨ï¼Œæ‰€ä»¥SquarePlusè¿˜æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ã€‚</p>
<h2 id="_3">é€¼è¿‘</h2>
<p>ç°åœ¨æœ‰ä¸¤é“ç»ƒä¹ é¢˜å¯ä»¥åšäº†ï¼š</p>
<blockquote>
<p>1ã€å½“$b$å–ä»€ä¹ˆæ—¶SquarePlusæ’å¤§äºSoftPlusï¼Ÿ</p>
<p>2ã€å½“$b$å–ä»€ä¹ˆæ—¶ï¼ŒSquarePlusä¸SoftPlusè¯¯å·®æœ€å°ï¼Ÿ</p>
</blockquote>
<p>ç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œç›´æ¥ä»$\text{SquarePlus}(x)\geq \text{SoftPlus}(x)$è§£å¾—ï¼š<br />
\begin{equation}b\geq 4\log(e^x+1)\left[\log(e^x+1) - x\right]=4\log(e^x+1)\log(e^{-x}+1)\end{equation}<br />
è¦ä½¿å¾—ä¸Šå¼æ’æˆç«‹ï¼Œ$b$å¿…é¡»å¤§äºç­‰äºå³ç«¯çš„æœ€å¤§å€¼ï¼Œè€Œæˆ‘ä»¬å¯ä»¥è¯æ˜å³ç«¯æœ€å¤§å€¼åœ¨$x=0$å¤„å–åˆ°ï¼Œæ‰€ä»¥$b\geq 4\log^2 2=1.921812\cdots$ã€‚è‡³æ­¤ï¼Œç¬¬ä¸€ä¸ªé—®é¢˜è§£å†³ã€‚</p>
<blockquote>
<p><strong>è¯æ˜ï¼š</strong> ç•™æ„åˆ°<br />
 \begin{equation}<br />
 \frac{d^2}{dx^2}\log\log(e^x+1)=\frac{e^x(\log(e^x+1)-e^x)}{(e^x+1)^2\log^2(e^x+1)} &lt; 0\end{equation}</p>
<p>æ‰€ä»¥$\log\log(e^x+1)$æ˜¯ä¸€ä¸ªå‡¹å‡½æ•°ï¼Œé‚£ä¹ˆç”±è©¹æ£®ä¸ç­‰å¼å¾—<br />
 \begin{equation}<br />
 \frac{1}{2}\left(\log\log(e^x+1) + \log\log(e^{-x}+1)\right)\leq \log\log(e^{(x+(-x))/2}+1)=\log\log 2\end{equation}<br />
 ä¹Ÿå°±æ˜¯$\log\left(\log(e^x+1)\log(e^{-x}+1)\right)\leq 2\log\log 2$ï¼Œæˆ–è€…$\log(e^x+1)\log(e^{-x}+1)\leq \log^2 2$ï¼Œä¸¤è¾¹ä¹˜ä»¥4å³å¾—å¾…è¯ç»“è®ºã€‚ç­‰å·æˆç«‹çš„æ¡ä»¶ä¸º$x=-x$ï¼Œå³$x=0$ã€‚</p>
</blockquote>
<p>è‡³äºç¬¬äºŒä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬éœ€è¦æœ‰ä¸€ä¸ªâ€œè¯¯å·®â€çš„æ ‡å‡†ã€‚è¿™é‡Œè·Ÿä¹‹å‰çš„æ–‡ç« <a href="/archives/7309">ã€ŠGELUçš„ä¸¤ä¸ªåˆç­‰å‡½æ•°è¿‘ä¼¼æ˜¯æ€ä¹ˆæ¥çš„ã€‹</a>ä¸€æ ·ï¼Œè½¬åŒ–ä¸ºæ— é¢å¤–å‚æ•°çš„$\min\text{-}\max$é—®é¢˜ï¼š<br />
\begin{equation}\min_{b} \max_x \left|\frac{x+\sqrt{x^2+b}}{2} - \log(e^x+1)\right|\end{equation}<br />
è¿™ä¸ªé—®é¢˜ç¬”è€…æ²¡æ³•æ±‚å¾—è§£æè§£ï¼Œç›®å‰åªèƒ½é€šè¿‡æ•°å€¼æ±‚è§£ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">erf</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>

<span class="k">def</span><span class="w"> </span><span class="nf">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">abs</span><span class="p">((</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="kp">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="kp">log</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">exp</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">g</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="kp">max</span><span class="p">([</span><span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="kp">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">)])</span>

<span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;xtol&#39;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="s1">&#39;ftol&#39;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="s1">&#39;maxiter&#39;</span><span class="p">:</span> <span class="mi">100000</span><span class="p">}</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Powell&#39;</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="nb">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></div>

<p>æœ€ç»ˆç®—å‡ºçš„ç»“æœæ˜¯$b=1.52382103\cdots$ï¼Œè¯¯å·®æœ€å¤§å€¼ä¸º$0.075931\cdots$ï¼Œæ¯”è¾ƒå¦‚ä¸‹ï¼š  </p>
<p><a href="/usr/uploads/2021/12/1431410191.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="ReLUã€SoftPlusã€SquarePluså‡½æ•°å›¾åƒï¼ˆäºŒï¼‰" src="/usr/uploads/2021/12/1431410191.png" /></a></p>
<p>ReLUã€SoftPlusã€SquarePluså‡½æ•°å›¾åƒï¼ˆäºŒï¼‰</p>
<h2 id="_4">å°ç»“</h2>
<p>ä¼¼ä¹ä¹Ÿæ²¡å•¥å¥½æ€»ç»“çš„ï¼Œå°±æ˜¯ä»‹ç»äº†ä¸€ä¸ªReLUçš„å…‰æ»‘è¿‘ä¼¼ï¼Œå¹¶é…ä¸Šäº†ä¸¤é“ç®€å•çš„å‡½æ•°ç»ƒä¹ é¢˜ï½</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8833">https://spaces.ac.cn/archives/8833</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Dec. 29, 2021). ã€ŠSquarePlusï¼šå¯èƒ½æ˜¯è¿ç®—æœ€ç®€å•çš„ReLUå…‰æ»‘è¿‘ä¼¼ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8833">https://spaces.ac.cn/archives/8833</a></p>
<p>@online{kexuefm-8833,<br />
title={SquarePlusï¼šå¯èƒ½æ˜¯è¿ç®—æœ€ç®€å•çš„ReLUå…‰æ»‘è¿‘ä¼¼},<br />
author={è‹å‰‘æ—},<br />
year={2021},<br />
month={Dec},<br />
url={\url{https://spaces.ac.cn/archives/8833}},<br />
} </p>
<hr />
<h2 id="_5">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1-squareplus">1. SquarePluså‡½æ•°çš„å®šä¹‰ä¸åŸºæœ¬æ€§è´¨</h3>
<p><strong>å®šä¹‰</strong> (SquarePluså‡½æ•°)</p>
<p>SquarePluså‡½æ•°å®šä¹‰ä¸ºï¼š
\begin{equation}
\text{SquarePlus}(x; b) = \frac{x + \sqrt{x^2 + b}}{2} \tag{1}
\end{equation}
å…¶ä¸­$b &gt; 0$ä¸ºå…‰æ»‘å‚æ•°ã€‚</p>
<p><strong>æ³¨é‡Š1.1</strong>: è¯¥å‡½æ•°çš„è®¾è®¡çµæ„Ÿæ¥è‡ªReLUçš„å¯¹ç§°å½¢å¼ã€‚å›é¡¾ReLUå‡½æ•°å¯ä»¥å†™æˆï¼š
\begin{equation}
\text{ReLU}(x) = \max(x, 0) = \frac{x + |x|}{2} = \frac{x + \sqrt{x^2}}{2} \tag{2}
\end{equation}</p>
<p>é—®é¢˜åœ¨äº$\sqrt{x^2} = |x|$åœ¨$x=0$å¤„ä¸å¯å¯¼ã€‚ä¸ºäº†ä½¿å‡½æ•°å…‰æ»‘ï¼Œæˆ‘ä»¬åœ¨æ ¹å·å†…æ·»åŠ æ­£å¸¸æ•°$b$ï¼š
\begin{equation}
\sqrt{x^2} \quad \rightarrow \quad \sqrt{x^2 + b} \tag{3}
\end{equation}</p>
<p>è¿™æ ·åšæœ‰ä¸¤ä¸ªå¥½å¤„ï¼š
- <strong>å…‰æ»‘æ€§</strong>: $\sqrt{x^2 + b}$åœ¨å…¨å±€å¯å¯¼ï¼Œé¿å…äº†$|x|$åœ¨åŸç‚¹çš„ä¸å¯å¯¼é—®é¢˜
- <strong>æ¸è¿‘æ€§</strong>: å½“$|x| \gg \sqrt{b}$æ—¶ï¼Œ$\sqrt{x^2 + b} \approx |x|$ï¼ŒSquarePlusæ¥è¿‘ReLU</p>
<hr />
<h3 id="2">2. ä¸€é˜¶å¯¼æ•°åˆ†æï¼ˆæ¢¯åº¦æ€§è´¨ï¼‰</h3>
<p><strong>å‘½é¢˜2.1</strong> (ä¸€é˜¶å¯¼æ•°å…¬å¼)</p>
<p>SquarePluså‡½æ•°çš„ä¸€é˜¶å¯¼æ•°ä¸ºï¼š
\begin{equation}
\frac{d}{dx}\text{SquarePlus}(x; b) = \frac{1}{2}\left(1 + \frac{x}{\sqrt{x^2 + b}}\right) \tag{4}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:
å¯¹å¼(1)æ±‚å¯¼ï¼š
\begin{align}
\frac{d}{dx}\text{SquarePlus}(x; b) &amp;= \frac{1}{2}\left(1 + \frac{d}{dx}\sqrt{x^2 + b}\right) \tag{5} \
&amp;= \frac{1}{2}\left(1 + \frac{1}{2\sqrt{x^2 + b}} \cdot 2x\right) \tag{6} \
&amp;= \frac{1}{2}\left(1 + \frac{x}{\sqrt{x^2 + b}}\right) \tag{7}
\end{align}</p>
<p><strong>æ³¨é‡Š2.1</strong>: å…³é”®æ€§è´¨åˆ†æ</p>
<p>(1) <strong>ä¸¥æ ¼å•è°ƒæ€§</strong>: ç”±äº$x^2 + b &gt; 0$æ’æˆç«‹ï¼Œæˆ‘ä»¬æœ‰ï¼š
\begin{equation}
\left|\frac{x}{\sqrt{x^2 + b}}\right| &lt; 1 \tag{8}
\end{equation}
å› æ­¤ï¼š
\begin{equation}
0 &lt; \frac{1}{2}\left(1 + \frac{x}{\sqrt{x^2 + b}}\right) &lt; 1 \tag{9}
\end{equation}
è¿™è¯´æ˜SquarePlusæ˜¯ä¸¥æ ¼å•è°ƒé€’å¢çš„ï¼Œä¸”æ¢¯åº¦æœ‰ç•Œã€‚</p>
<p>(2) <strong>åŸç‚¹å¯¼æ•°</strong>: å½“$x = 0$æ—¶ï¼š
\begin{equation}
\frac{d}{dx}\text{SquarePlus}(0; b) = \frac{1}{2}\left(1 + \frac{0}{\sqrt{b}}\right) = \frac{1}{2} \tag{10}
\end{equation}</p>
<p>(3) <strong>æ¸è¿‘è¡Œä¸º</strong>:
- å½“$x \to +\infty$æ—¶ï¼š$\frac{x}{\sqrt{x^2 + b}} \to 1$ï¼Œæ•…å¯¼æ•°$\to 1$
- å½“$x \to -\infty$æ—¶ï¼š$\frac{x}{\sqrt{x^2 + b}} \to -1$ï¼Œæ•…å¯¼æ•°$\to 0$</p>
<p><strong>å‘½é¢˜2.2</strong> (å¯¼æ•°çš„æœ‰ç•Œæ€§)</p>
<p>å¯¹äºä»»æ„$x \in \mathbb{R}$å’Œ$b &gt; 0$ï¼Œæœ‰ï¼š
\begin{equation}
0 &lt; \frac{d}{dx}\text{SquarePlus}(x; b) &lt; 1 \tag{11}
\end{equation}</p>
<p><strong>è¯æ˜</strong>: ä»¤$t = \frac{x}{\sqrt{x^2 + b}}$ï¼Œåˆ™$t \in (-1, 1)$ï¼ˆä¸¥æ ¼ä¸ç­‰ï¼‰ã€‚å› æ­¤ï¼š
\begin{equation}
\frac{d}{dx}\text{SquarePlus}(x; b) = \frac{1 + t}{2} \in (0, 1) \tag{12}
\end{equation}</p>
<hr />
<h3 id="3">3. äºŒé˜¶å¯¼æ•°åˆ†æï¼ˆå‡¸æ€§ï¼‰</h3>
<p><strong>å‘½é¢˜3.1</strong> (äºŒé˜¶å¯¼æ•°å…¬å¼)</p>
<p>SquarePluså‡½æ•°çš„äºŒé˜¶å¯¼æ•°ä¸ºï¼š
\begin{equation}
\frac{d^2}{dx^2}\text{SquarePlus}(x; b) = \frac{b}{2(x^2 + b)^{3/2}} \tag{13}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:
å¯¹å¼(4)æ±‚å¯¼ï¼š
\begin{align}
\frac{d^2}{dx^2}\text{SquarePlus}(x; b) &amp;= \frac{1}{2} \cdot \frac{d}{dx}\left(\frac{x}{\sqrt{x^2 + b}}\right) \tag{14} \
&amp;= \frac{1}{2} \cdot \frac{\sqrt{x^2 + b} - x \cdot \frac{x}{\sqrt{x^2 + b}}}{x^2 + b} \tag{15} \
&amp;= \frac{1}{2} \cdot \frac{x^2 + b - x^2}{(x^2 + b)^{3/2}} \tag{16} \
&amp;= \frac{b}{2(x^2 + b)^{3/2}} \tag{17}
\end{align}</p>
<p><strong>æ³¨é‡Š3.1</strong>: å‡¸æ€§åˆ†æ</p>
<p>ç”±äº$b &gt; 0$ä¸”$(x^2 + b)^{3/2} &gt; 0$ï¼Œæˆ‘ä»¬æœ‰ï¼š
\begin{equation}
\frac{d^2}{dx^2}\text{SquarePlus}(x; b) &gt; 0, \quad \forall x \in \mathbb{R} \tag{18}
\end{equation}</p>
<p>è¿™æ„å‘³ç€<strong>SquarePlusæ˜¯ä¸¥æ ¼å‡¸å‡½æ•°</strong>ã€‚</p>
<p><strong>å‘½é¢˜3.2</strong> (äºŒé˜¶å¯¼æ•°çš„æ€§è´¨)</p>
<p>(1) <strong>åŸç‚¹å¤„çš„æ›²ç‡</strong>:
\begin{equation}
\frac{d^2}{dx^2}\text{SquarePlus}(0; b) = \frac{b}{2b^{3/2}} = \frac{1}{2\sqrt{b}} \tag{19}
\end{equation}</p>
<p>(2) <strong>æ¸è¿‘è¡Œä¸º</strong>:
\begin{equation}
\lim_{|x| \to \infty} \frac{d^2}{dx^2}\text{SquarePlus}(x; b) = 0 \tag{20}
\end{equation}
è¿™è¯´æ˜åœ¨è¿œç¦»åŸç‚¹æ—¶ï¼ŒSquarePlusé€æ¸è¶‹å‘çº¿æ€§ã€‚</p>
<p>(3) <strong>å•è°ƒé€’å‡æ€§</strong>: å¯¹äº$x &gt; 0$ï¼ŒäºŒé˜¶å¯¼æ•°å…³äº$x$å•è°ƒé€’å‡ï¼š
\begin{equation}
\frac{d}{dx}\left[\frac{b}{2(x^2 + b)^{3/2}}\right] = -\frac{3bx}{2(x^2 + b)^{5/2}} &lt; 0 \tag{21}
\end{equation}</p>
<hr />
<h3 id="4-relu">4. ä¸ReLUçš„é€¼è¿‘åˆ†æ</h3>
<p><strong>å‘½é¢˜4.1</strong> (é€¼è¿‘è¯¯å·®)</p>
<p>å®šä¹‰é€¼è¿‘è¯¯å·®ä¸ºï¼š
\begin{equation}
E(x; b) = \text{SquarePlus}(x; b) - \text{ReLU}(x) = \frac{x + \sqrt{x^2 + b}}{2} - \max(x, 0) \tag{22}
\end{equation}</p>
<p>åˆ†æƒ…å†µè®¨è®ºï¼š</p>
<p>(1) <strong>å½“$x \geq 0$æ—¶</strong>:
\begin{align}
E(x; b) &amp;= \frac{x + \sqrt{x^2 + b}}{2} - x \tag{23} \
&amp;= \frac{\sqrt{x^2 + b} - x}{2} \tag{24} \
&amp;= \frac{b}{2(\sqrt{x^2 + b} + x)} \tag{25}
\end{align}</p>
<p>å…¶ä¸­å¼(25)é€šè¿‡åˆ†å­æœ‰ç†åŒ–å¾—åˆ°ï¼š
\begin{equation}
\sqrt{x^2 + b} - x = \frac{(\sqrt{x^2 + b} - x)(\sqrt{x^2 + b} + x)}{\sqrt{x^2 + b} + x} = \frac{b}{\sqrt{x^2 + b} + x} \tag{26}
\end{equation}</p>
<p>(2) <strong>å½“$x &lt; 0$æ—¶</strong>:
\begin{align}
E(x; b) &amp;= \frac{x + \sqrt{x^2 + b}}{2} - 0 \tag{27} \
&amp;= \frac{x + \sqrt{x^2 + b}}{2} \tag{28}
\end{align}</p>
<p><strong>æ³¨é‡Š4.1</strong>: è¯¯å·®çš„å®šé‡åˆ†æ</p>
<p>(1) å¯¹äº$x \geq 0$ï¼Œè¯¯å·®æ»¡è¶³ï¼š
\begin{equation}
0 &lt; E(x; b) \leq \frac{b}{2x} \quad \text{(å½“$x &gt; 0$)} \tag{29}
\end{equation}
ç‰¹åˆ«åœ°ï¼Œ$E(0; b) = \frac{\sqrt{b}}{2}$ã€‚</p>
<p>(2) å¯¹äº$x &lt; 0$ï¼Œç”±äº$\sqrt{x^2 + b} &gt; |x| = -x$ï¼Œæˆ‘ä»¬æœ‰ï¼š
\begin{equation}
0 &lt; E(x; b) &lt; \frac{\sqrt{x^2 + b}}{2} \tag{30}
\end{equation}</p>
<p><strong>å‘½é¢˜4.2</strong> (æœ€å¤§è¯¯å·®ç‚¹)</p>
<p>å¯¹äºå›ºå®šçš„$b &gt; 0$ï¼Œè¯¯å·®$E(x; b)$åœ¨$x = 0$å¤„è¾¾åˆ°æœ€å¤§å€¼ï¼š
\begin{equation}
\max_{x \in \mathbb{R}} E(x; b) = E(0; b) = \frac{\sqrt{b}}{2} \tag{31}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:
å¯¹äº$x \geq 0$ï¼Œå¼(25)è¡¨æ˜$E(x; b)$å…³äº$x$å•è°ƒé€’å‡ï¼Œä¸”$\lim_{x \to \infty} E(x; b) = 0$ã€‚</p>
<p>å¯¹äº$x \leq 0$ï¼Œæˆ‘ä»¬è®¡ç®—ï¼š
\begin{align}
\frac{dE}{dx} &amp;= \frac{1}{2}\left(1 + \frac{x}{\sqrt{x^2 + b}}\right) \tag{32} \
&amp;= \frac{1}{2}\left(1 - \frac{|x|}{\sqrt{x^2 + b}}\right) &gt; 0 \tag{33}
\end{align}</p>
<p>å› æ­¤$E(x; b)$åœ¨$x &lt; 0$æ—¶å…³äº$x$å•è°ƒé€’å¢ï¼Œåœ¨$x = 0$æ—¶è¾¾åˆ°æœ€å¤§å€¼ã€‚</p>
<hr />
<h3 id="5-softplus">5. ä¸SoftPlusçš„æ¯”è¾ƒåˆ†æ</h3>
<p><strong>å®šä¹‰</strong> (SoftPluså‡½æ•°)</p>
<p>SoftPluså‡½æ•°å®šä¹‰ä¸ºï¼š
\begin{equation}
\text{SoftPlus}(x) = \log(1 + e^x) \tag{34}
\end{equation}</p>
<p><strong>å‘½é¢˜5.1</strong> (æ’å¤§äºå…³ç³»)</p>
<p>å½“$b \geq 4\log^2 2 \approx 1.922$æ—¶ï¼Œå¯¹äºæ‰€æœ‰$x \in \mathbb{R}$æœ‰ï¼š
\begin{equation}
\text{SquarePlus}(x; b) \geq \text{SoftPlus}(x) \tag{35}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:
æˆ‘ä»¬éœ€è¦è¯æ˜ï¼š
\begin{equation}
\frac{x + \sqrt{x^2 + b}}{2} \geq \log(1 + e^x) \tag{36}
\end{equation}</p>
<p>ç­‰ä»·äºï¼š
\begin{equation}
b \geq 4\log(1 + e^x)[\log(1 + e^x) - x] \tag{37}
\end{equation}</p>
<p>è¿›ä¸€æ­¥åŒ–ç®€ï¼š
\begin{align}
\log(1 + e^x) - x &amp;= \log\left(\frac{1 + e^x}{e^x}\right) \tag{38} \
&amp;= \log(e^{-x} + 1) \tag{39}
\end{align}</p>
<p>å› æ­¤æ¡ä»¶å˜ä¸ºï¼š
\begin{equation}
b \geq 4\log(1 + e^x)\log(1 + e^{-x}) \tag{40}
\end{equation}</p>
<p><strong>å¼•ç†5.1</strong> (å¯¹æ•°ä¹˜ç§¯çš„æœ€å¤§å€¼)</p>
<p>å‡½æ•°$g(x) = \log(1 + e^x)\log(1 + e^{-x})$åœ¨$x = 0$å¤„è¾¾åˆ°æœ€å¤§å€¼ï¼š
\begin{equation}
\max_{x \in \mathbb{R}} g(x) = g(0) = \log^2 2 \tag{41}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:
è®¡ç®—äºŒé˜¶å¯¼æ•°ï¼š
\begin{align}
\frac{d^2}{dx^2}\log\log(1 + e^x) &amp;= \frac{e^x(\log(1 + e^x) - e^x)}{(1 + e^x)^2\log^2(1 + e^x)} \tag{42}
\end{align}</p>
<p>ç”±äº$\log(1 + e^x) &lt; e^x$ï¼ˆå¯¹æ‰€æœ‰$x &gt; 0$ï¼‰ï¼Œåˆ†å­ä¸ºè´Ÿï¼Œå› æ­¤ï¼š
\begin{equation}
\frac{d^2}{dx^2}\log\log(1 + e^x) &lt; 0 \tag{43}
\end{equation}</p>
<p>è¿™è¯´æ˜$\log\log(1 + e^x)$æ˜¯ä¸¥æ ¼å‡¹å‡½æ•°ã€‚ç”±Jensenä¸ç­‰å¼ï¼š
\begin{align}
\frac{1}{2}[\log\log(1 + e^x) + \log\log(1 + e^{-x})] &amp;\leq \log\log\left(1 + e^{(x + (-x))/2}\right) \tag{44} \
&amp;= \log\log 2 \tag{45}
\end{align}</p>
<p>ä¸¤è¾¹ä¹˜ä»¥2å¹¶å–æŒ‡æ•°ï¼š
\begin{equation}
\log(1 + e^x)\log(1 + e^{-x}) \leq \log^2 2 \tag{46}
\end{equation}</p>
<p>ç­‰å·æˆç«‹å½“ä¸”ä»…å½“$x = 0$ã€‚å› æ­¤ï¼š
\begin{equation}
b \geq 4\log^2 2 \approx 1.922 \tag{47}
\end{equation}</p>
<hr />
<h3 id="6">6. æœ€ä¼˜é€¼è¿‘å‚æ•°çš„æ±‚è§£</h3>
<p><strong>ä¼˜åŒ–é—®é¢˜</strong> (Minimaxé€¼è¿‘)</p>
<p>å¯»æ‰¾æœ€ä¼˜å‚æ•°$b^<em>$ä½¿å¾—SquarePlusä¸SoftPlusçš„æœ€å¤§è¯¯å·®æœ€å°ï¼š
\begin{equation}
b^</em> = \argmin_b \max_x |{\text{SquarePlus}(x; b) - \text{SoftPlus}(x)}| \tag{48}
\end{equation}</p>
<p><strong>æ³¨é‡Š6.1</strong>: è¿™æ˜¯ä¸€ä¸ªæ— çº¦æŸçš„minimaxä¼˜åŒ–é—®é¢˜ã€‚ç”±äºç›®æ ‡å‡½æ•°éå‡¸ä¸”ä¸å¯å¯¼ï¼Œæˆ‘ä»¬é‡‡ç”¨Powellæ³•æ±‚è§£ã€‚</p>
<p><strong>æ•°å€¼æ±‚è§£ç®—æ³•</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.optimize</span><span class="w"> </span><span class="kn">import</span> <span class="n">minimize</span>

<span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ç›®æ ‡å‡½æ•°ï¼šæœ€å¤§è¯¯å·®</span>
<span class="sd">    å‚æ•°: a = sqrt(b) (ä¿è¯b &gt; 0)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">sp</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_grid</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_grid</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">softplus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">x_grid</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">,</span> <span class="mi">20</span><span class="p">)))</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sp</span> <span class="o">-</span> <span class="n">softplus</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="c1"># Powellæ³•ä¼˜åŒ–</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">objective</span><span class="p">,</span> <span class="n">x0</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;Powell&#39;</span><span class="p">,</span>
                  <span class="n">options</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;xtol&#39;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="s1">&#39;ftol&#39;</span><span class="p">:</span> <span class="mf">1e-10</span><span class="p">})</span>
<span class="n">b_optimal</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
<span class="n">max_error</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">fun</span>
</code></pre></div>

<p><strong>å‘½é¢˜6.1</strong> (æ•°å€¼æœ€ä¼˜è§£)</p>
<p>é€šè¿‡æ•°å€¼ä¼˜åŒ–ï¼Œå¾—åˆ°ï¼š
\begin{equation}
b^<em> \approx 1.5238, \quad \max_x |E(x; b^</em>)| \approx 0.0759 \tag{49}
\end{equation}</p>
<p><strong>æ³¨é‡Š6.2</strong>: è§‚å¯Ÿåˆ°$b^* &lt; 4\log^2 2$ï¼Œè¿™æ„å‘³ç€æœ€ä¼˜é€¼è¿‘æ—¶SquarePlusä¸æ˜¯å¤„å¤„å¤§äºSoftPlusï¼Œè€Œæ˜¯åœ¨æŸäº›åŒºåŸŸå¤§äºã€æŸäº›åŒºåŸŸå°äºï¼Œä»è€Œè¾¾åˆ°è¯¯å·®çš„å¹³è¡¡ã€‚</p>
<hr />
<h3 id="7">7. æ³°å‹’å±•å¼€ä¸å±€éƒ¨é€¼è¿‘</h3>
<p><strong>å‘½é¢˜7.1</strong> (åŸç‚¹å¤„çš„æ³°å‹’å±•å¼€)</p>
<p>åœ¨$x = 0$é™„è¿‘ï¼ŒSquarePlusæœ‰å¦‚ä¸‹å±•å¼€ï¼š
\begin{equation}
\text{SquarePlus}(x; b) = \frac{\sqrt{b}}{2} + \frac{x}{2} + \frac{x^2}{4\sqrt{b}} - \frac{x^4}{16b^{5/2}} + O(x^6) \tag{50}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:
é¦–å…ˆå±•å¼€$\sqrt{x^2 + b}$ï¼š
\begin{align}
\sqrt{x^2 + b} &amp;= \sqrt{b}\sqrt{1 + \frac{x^2}{b}} \tag{51} \
&amp;= \sqrt{b}\left(1 + \frac{x^2}{2b} - \frac{x^4}{8b^2} + O(x^6)\right) \tag{52} \
&amp;= \sqrt{b} + \frac{x^2}{2\sqrt{b}} - \frac{x^4}{8b^{3/2}} + O(x^6) \tag{53}
\end{align}</p>
<p>ä»£å…¥SquarePluså®šä¹‰ï¼š
\begin{align}
\text{SquarePlus}(x; b) &amp;= \frac{1}{2}\left(x + \sqrt{b} + \frac{x^2}{2\sqrt{b}} - \frac{x^4}{8b^{3/2}} + O(x^6)\right) \tag{54} \
&amp;= \frac{\sqrt{b}}{2} + \frac{x}{2} + \frac{x^2}{4\sqrt{b}} - \frac{x^4}{16b^{5/2}} + O(x^6) \tag{55}
\end{align}</p>
<p><strong>å‘½é¢˜7.2</strong> (SoftPlusçš„æ³°å‹’å±•å¼€)</p>
<p>åœ¨$x = 0$é™„è¿‘ï¼š
\begin{equation}
\text{SoftPlus}(x) = \log 2 + \frac{x}{2} + \frac{x^2}{8} - \frac{x^4}{192} + O(x^6) \tag{56}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:
åˆ©ç”¨$\log(1 + e^x) = \log 2 + \log(1 + \frac{e^x - 1}{2})$ï¼š
\begin{align}
\text{SoftPlus}(x) &amp;= \log 2 + \log\left(1 + \frac{\sinh(x/2)}{e^{x/2}}\right) \tag{57}
\end{align}</p>
<p>é€šè¿‡æ ‡å‡†çš„æ³°å‹’çº§æ•°è®¡ç®—å¯å¾—å¼(56)ã€‚</p>
<p><strong>æ³¨é‡Š7.1</strong>: æ¯”è¾ƒç³»æ•°</p>
<p>æ¯”è¾ƒå¼(50)å’Œ(56)çš„ç³»æ•°ï¼š
- <strong>å¸¸æ•°é¡¹</strong>: $\frac{\sqrt{b}}{2}$ vs $\log 2$ï¼Œå½“$b = 4\log^2 2$æ—¶ç›¸ç­‰
- <strong>ä¸€æ¬¡é¡¹</strong>: ç³»æ•°éƒ½æ˜¯$\frac{1}{2}$ï¼Œå®Œå…¨ä¸€è‡´
- <strong>äºŒæ¬¡é¡¹</strong>: $\frac{1}{4\sqrt{b}}$ vs $\frac{1}{8}$ï¼Œå½“$b = 4$æ—¶ç›¸ç­‰</p>
<p>è¿™è§£é‡Šäº†ä¸ºä½•$b$åœ¨1.5åˆ°2ä¹‹é—´èƒ½å¤Ÿè¾ƒå¥½åœ°é€¼è¿‘SoftPlusã€‚</p>
<hr />
<h3 id="8">8. æ¸è¿‘æ€§è´¨åˆ†æ</h3>
<p><strong>å‘½é¢˜8.1</strong> (æ­£å‘æ¸è¿‘)</p>
<p>å½“$x \to +\infty$æ—¶ï¼š
\begin{equation}
\text{SquarePlus}(x; b) = x + \frac{b}{4x} - \frac{b^2}{32x^3} + O(x^{-5}) \tag{58}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:
å¯¹äº$x \gg \sqrt{b}$ï¼Œæœ‰ï¼š
\begin{align}
\sqrt{x^2 + b} &amp;= x\sqrt{1 + \frac{b}{x^2}} \tag{59} \
&amp;= x\left(1 + \frac{b}{2x^2} - \frac{b^2}{8x^4} + O(x^{-6})\right) \tag{60} \
&amp;= x + \frac{b}{2x} - \frac{b^2}{8x^3} + O(x^{-5}) \tag{61}
\end{align}</p>
<p>å› æ­¤ï¼š
\begin{align}
\text{SquarePlus}(x; b) &amp;= \frac{1}{2}\left(2x + \frac{b}{2x} - \frac{b^2}{8x^3} + O(x^{-5})\right) \tag{62} \
&amp;= x + \frac{b}{4x} - \frac{b^2}{16x^3} + O(x^{-5}) \tag{63}
\end{align}</p>
<p><strong>å‘½é¢˜8.2</strong> (è´Ÿå‘æ¸è¿‘)</p>
<p>å½“$x \to -\infty$æ—¶ï¼š
\begin{equation}
\text{SquarePlus}(x; b) = \frac{b}{4|x|} - \frac{b^2}{32|x|^3} + O(|x|^{-5}) \tag{64}
\end{equation}</p>
<p><strong>è¯æ˜</strong>: ç±»ä¼¼äºå‘½é¢˜8.1ï¼Œåˆ©ç”¨$\sqrt{x^2 + b} = |x|\sqrt{1 + \frac{b}{x^2}}$å±•å¼€å³å¯ã€‚</p>
<hr />
<h3 id="9">9. æ•°å€¼ç¨³å®šæ€§åˆ†æ</h3>
<p><strong>é—®é¢˜9.1</strong> (è®¡ç®—ç²¾åº¦)</p>
<p>ç›´æ¥è®¡ç®—$\sqrt{x^2 + b}$å¯èƒ½åœ¨æç«¯æƒ…å†µä¸‹æŸå¤±ç²¾åº¦ã€‚æˆ‘ä»¬éœ€è¦åˆ†æä½•æ—¶éœ€è¦ç‰¹æ®Šå¤„ç†ã€‚</p>
<p><strong>ç¨³å®šè®¡ç®—æ–¹æ³•</strong>:</p>
<p>(1) <strong>å½“$|x| \ll \sqrt{b}$æ—¶</strong> (å°å‚æ•°åŒºåŸŸ):
ä½¿ç”¨æ³°å‹’å±•å¼€å¼(50)é¿å…æµ®ç‚¹è¯¯å·®ã€‚</p>
<p>(2) <strong>å½“$|x| \gg \sqrt{b}$æ—¶</strong> (å¤§å‚æ•°åŒºåŸŸ):
- å¯¹äº$x &gt; 0$: ä½¿ç”¨åˆ†å­æœ‰ç†åŒ–
\begin{equation}
\text{SquarePlus}(x; b) = x + \frac{b}{2(\sqrt{x^2 + b} + x)} \tag{65}
\end{equation}</p>
<ul>
<li>å¯¹äº$x &lt; 0$: ç›´æ¥è®¡ç®—
\begin{equation}
\text{SquarePlus}(x; b) = \frac{b}{2(\sqrt{x^2 + b} - x)} \tag{66}
\end{equation}</li>
</ul>
<p><strong>ç®—æ³•9.1</strong> (æ•°å€¼ç¨³å®šå®ç°)</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">squareplus_stable</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;æ•°å€¼ç¨³å®šçš„SquarePluså®ç°&quot;&quot;&quot;</span>
    <span class="n">abs_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">sqrt_b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

    <span class="c1"># å°å‚æ•°æƒ…å†µï¼š|x| &lt; 0.1 * sqrt(b)</span>
    <span class="n">small_mask</span> <span class="o">=</span> <span class="n">abs_x</span> <span class="o">&lt;</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">sqrt_b</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">small_mask</span><span class="p">):</span>
        <span class="n">x_small</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">small_mask</span><span class="p">]</span>
        <span class="n">result_small</span> <span class="o">=</span> <span class="p">(</span><span class="n">sqrt_b</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">x_small</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span>
                        <span class="n">x_small</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">sqrt_b</span><span class="p">)</span> <span class="o">-</span>
                        <span class="n">x_small</span><span class="o">**</span><span class="mi">4</span> <span class="o">/</span> <span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="n">b</span><span class="o">**</span><span class="p">(</span><span class="mi">5</span><span class="o">/</span><span class="mi">2</span><span class="p">)))</span>

    <span class="c1"># å¤§å‚æ•°æƒ…å†µ</span>
    <span class="n">large_mask</span> <span class="o">=</span> <span class="o">~</span><span class="n">small_mask</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">large_mask</span><span class="p">):</span>
        <span class="n">x_large</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="n">large_mask</span><span class="p">]</span>
        <span class="n">sqrt_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_large</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>

        <span class="c1"># æ­£æ•°ï¼šä½¿ç”¨æœ‰ç†åŒ–</span>
        <span class="n">pos_mask</span> <span class="o">=</span> <span class="n">x_large</span> <span class="o">&gt;</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">pos_mask</span><span class="p">):</span>
            <span class="n">x_pos</span> <span class="o">=</span> <span class="n">x_large</span><span class="p">[</span><span class="n">pos_mask</span><span class="p">]</span>
            <span class="n">sqrt_pos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_pos</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="p">)</span>
            <span class="n">result_pos</span> <span class="o">=</span> <span class="n">x_pos</span> <span class="o">+</span> <span class="n">b</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">sqrt_pos</span> <span class="o">+</span> <span class="n">x_pos</span><span class="p">))</span>

        <span class="c1"># è´Ÿæ•°ï¼šç›´æ¥è®¡ç®—</span>
        <span class="n">neg_mask</span> <span class="o">=</span> <span class="n">x_large</span> <span class="o">&lt;=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">neg_mask</span><span class="p">):</span>
            <span class="n">x_neg</span> <span class="o">=</span> <span class="n">x_large</span><span class="p">[</span><span class="n">neg_mask</span><span class="p">]</span>
            <span class="n">result_neg</span> <span class="o">=</span> <span class="p">(</span><span class="n">x_neg</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x_neg</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">b</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># ç»„åˆç»“æœ</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">empty_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">result</span><span class="p">[</span><span class="n">small_mask</span><span class="p">]</span> <span class="o">=</span> <span class="n">result_small</span>
    <span class="c1"># ... (åˆå¹¶large_maskçš„ç»“æœ)</span>
    <span class="k">return</span> <span class="n">result</span>
</code></pre></div>

<hr />
<h3 id="10">10. è®¡ç®—å¤æ‚åº¦åˆ†æ</h3>
<p><strong>å‘½é¢˜10.1</strong> (è¿ç®—æ¬¡æ•°æ¯”è¾ƒ)</p>
<p>å„æ¿€æ´»å‡½æ•°çš„åŸºæœ¬è¿ç®—æ¬¡æ•°ï¼ˆæ¯æ¬¡è°ƒç”¨ï¼‰ï¼š</p>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>åŠ æ³•</th>
<th>ä¹˜æ³•</th>
<th>é™¤æ³•</th>
<th>å¼€æ–¹</th>
<th>æŒ‡æ•°</th>
<th>å¯¹æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ReLU</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>SquarePlus</td>
<td>2</td>
<td>1</td>
<td>1</td>
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr>
<td>SoftPlus</td>
<td>1</td>
<td>0</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>1</td>
</tr>
<tr>
<td>GeLU</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
<tr>
<td>Swish</td>
<td>2</td>
<td>2</td>
<td>0</td>
<td>0</td>
<td>1</td>
<td>0</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨é‡Š10.1</strong>:
- æŒ‡æ•°å’Œå¯¹æ•°è¿ç®—é€šå¸¸æ¯”å››åˆ™è¿ç®—å’Œå¼€æ–¹æ…¢å¾—å¤šï¼ˆå°¤å…¶åœ¨CPUä¸Šï¼‰
- å¼€æ–¹è¿ç®—å¯é€šè¿‡Newton-Raphsonå¿«é€Ÿé€¼è¿‘ï¼Œå¤æ‚åº¦çº¦ä¸º3-4æ¬¡ä¹˜æ³•
- SquarePlusé¿å…äº†æ˜‚è´µçš„è¶…è¶Šå‡½æ•°ï¼ˆexp, logï¼‰ï¼Œåœ¨CPUä¸Šæœ‰é€Ÿåº¦ä¼˜åŠ¿</p>
<hr />
<h3 id="11">11. ä¸å…¶ä»–å…‰æ»‘æ¿€æ´»å‡½æ•°çš„æ¯”è¾ƒ</h3>
<p><strong>å®šä¹‰11.1</strong> (GeLUå‡½æ•°)</p>
<p>Gaussian Error Linear Unit:
\begin{equation}
\text{GeLU}(x) = x \cdot \Phi(x) = \frac{x}{2}\left[1 + \text{erf}\left(\frac{x}{\sqrt{2}}\right)\right] \tag{67}
\end{equation}
å…¶ä¸­$\Phi$æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ã€‚</p>
<p><strong>å®šä¹‰11.2</strong> (Swishå‡½æ•°)</p>
<p>ä¹Ÿç§°ä¸ºSiLU (Sigmoid Linear Unit):
\begin{equation}
\text{Swish}(x; \beta) = \frac{x}{1 + e^{-\beta x}} \tag{68}
\end{equation}</p>
<p><strong>å‘½é¢˜11.1</strong> (åŸç‚¹å¤„çš„æ€§è´¨æ¯”è¾ƒ)</p>
<p>åœ¨$x = 0$å¤„ï¼š</p>
<table>
<thead>
<tr>
<th>å‡½æ•°</th>
<th>å‡½æ•°å€¼</th>
<th>ä¸€é˜¶å¯¼æ•°</th>
<th>äºŒé˜¶å¯¼æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>ReLU</td>
<td>0</td>
<td>ä¸å­˜åœ¨</td>
<td>ä¸å­˜åœ¨</td>
</tr>
<tr>
<td>SquarePlus($b$)</td>
<td>$\frac{\sqrt{b}}{2}$</td>
<td>$\frac{1}{2}$</td>
<td>$\frac{1}{2\sqrt{b}}$</td>
</tr>
<tr>
<td>SoftPlus</td>
<td>$\log 2$</td>
<td>$\frac{1}{2}$</td>
<td>$\frac{1}{4}$</td>
</tr>
<tr>
<td>GeLU</td>
<td>0</td>
<td>$\frac{1}{2}$</td>
<td>$\frac{1}{\sqrt{2\pi}}$</td>
</tr>
<tr>
<td>Swish($\beta=1$)</td>
<td>0</td>
<td>$\frac{1}{2}$</td>
<td>$\frac{1}{4}$</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨é‡Š11.1</strong>: è§‚å¯Ÿ
- é™¤ReLUå¤–ï¼Œæ‰€æœ‰å…‰æ»‘è¿‘ä¼¼çš„ä¸€é˜¶å¯¼æ•°åœ¨åŸç‚¹éƒ½æ˜¯$\frac{1}{2}$
- SquarePluså’ŒSoftPlusåœ¨åŸç‚¹æœ‰éé›¶å‡½æ•°å€¼ï¼ˆæ­£åç§»ï¼‰
- GeLUå’ŒSwishä¿æŒReLUåœ¨åŸç‚¹çš„é›¶å€¼ç‰¹æ€§</p>
<hr />
<h3 id="12">12. åå‘ä¼ æ’­çš„æ¢¯åº¦è®¡ç®—</h3>
<p><strong>ç®—æ³•12.1</strong> (SquarePlusçš„åå‘ä¼ æ’­)</p>
<p>å‰å‘ä¼ æ’­ï¼š
\begin{equation}
y = \text{SquarePlus}(x; b) = \frac{x + \sqrt{x^2 + b}}{2} \tag{69}
\end{equation}</p>
<p>åå‘ä¼ æ’­ï¼ˆé“¾å¼æ³•åˆ™ï¼‰ï¼š
\begin{equation}
\frac{\partial \mathcal{L}}{\partial x} = \frac{\partial \mathcal{L}}{\partial y} \cdot \frac{\partial y}{\partial x} = \frac{\partial \mathcal{L}}{\partial y} \cdot \frac{1}{2}\left(1 + \frac{x}{\sqrt{x^2 + b}}\right) \tag{70}
\end{equation}</p>
<p><strong>æ•°å€¼ç¨³å®šå®ç°</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">SquarePlus</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="n">b</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">sqrt_term</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">sqrt_term</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
        <span class="c1"># ç¼“å­˜ä¸­é—´ç»“æœç”¨äºåå‘ä¼ æ’­</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;sqrt_term&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sqrt_term</span>
        <span class="k">return</span> <span class="n">y</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grad_y</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
        <span class="n">sqrt_term</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cache</span><span class="p">[</span><span class="s1">&#39;sqrt_term&#39;</span><span class="p">]</span>
        <span class="c1"># æ¢¯åº¦è®¡ç®—</span>
        <span class="n">grad_x</span> <span class="o">=</span> <span class="n">grad_y</span> <span class="o">*</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">x</span> <span class="o">/</span> <span class="n">sqrt_term</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">grad_x</span>
</code></pre></div>

<p><strong>æ³¨é‡Š12.1</strong>:
- é€šè¿‡ç¼“å­˜$\sqrt{x^2 + b}$ï¼Œé¿å…åœ¨åå‘ä¼ æ’­æ—¶é‡å¤è®¡ç®—
- å†…å­˜å¼€é”€ï¼šéœ€è¦å­˜å‚¨è¾“å…¥$x$å’Œä¸­é—´é¡¹$\sqrt{x^2 + b}$
- è®¡ç®—å¼€é”€ï¼šåå‘ä¼ æ’­ä»…éœ€1æ¬¡é™¤æ³•å’Œ2æ¬¡åŠ æ³•</p>
<hr />
<h3 id="13-b">13. å‚æ•°$b$çš„é€‰æ‹©æŒ‡å¯¼</h3>
<p><strong>å‡†åˆ™13.1</strong> (å‚æ•°é€‰æ‹©ç­–ç•¥)</p>
<p>æ ¹æ®ä¸åŒéœ€æ±‚é€‰æ‹©$b$ï¼š</p>
<p>(1) <strong>æœ€å¤§å…‰æ»‘æ€§</strong> ($b$è¾ƒå¤§):
- æ¨è: $b \in [2, 4]$
- ä¼˜ç‚¹: äºŒé˜¶å¯¼æ•°å°ï¼Œæ›²ç‡å¹³ç¼“
- ç¼ºç‚¹: ä¸ReLUåå·®è¾ƒå¤§</p>
<p>(2) <strong>æœ€ä½³SoftPlusé€¼è¿‘</strong>:
- æ¨è: $b \approx 1.52$
- ä¼˜ç‚¹: ä¸SoftPlusè¯¯å·®æœ€å°
- é€‚ç”¨: éœ€è¦æ›¿ä»£SoftPlusçš„åœºæ™¯</p>
<p>(3) <strong>æ’å¤§äºSoftPlus</strong>:
- æ¨è: $b \geq 1.92$
- ä¼˜ç‚¹: ä¸¥æ ¼ä¿æŒä¸Šç•Œæ€§è´¨
- é€‚ç”¨: éœ€è¦ä¿å®ˆä¼°è®¡çš„åœºæ™¯</p>
<p>(4) <strong>æ¥è¿‘ReLU</strong> ($b$è¾ƒå°):
- æ¨è: $b \in [0.5, 1]$
- ä¼˜ç‚¹: ä¸ReLUåå·®å°ï¼Œæ¢¯åº¦æ¥è¿‘0/1
- ç¼ºç‚¹: åœ¨åŸç‚¹é™„è¿‘ä»æœ‰è¾ƒå¤§æ›²ç‡</p>
<p><strong>å‘½é¢˜13.1</strong> (å‚æ•°å¯¹æ¢¯åº¦çš„å½±å“)</p>
<p>å¯¹äºå›ºå®šè¾“å…¥$x$ï¼Œæ¢¯åº¦å…³äº$b$çš„å¯¼æ•°ä¸ºï¼š
\begin{equation}
\frac{\partial}{\partial b}\left[\frac{d}{dx}\text{SquarePlus}(x; b)\right] = -\frac{x}{4(x^2 + b)^{3/2}} \tag{71}
\end{equation}</p>
<p>è¿™è¯´æ˜ï¼š
- å½“$x &gt; 0$æ—¶ï¼Œ$b$å¢å¤§ä¼šä½¿æ¢¯åº¦å‡å°
- å½“$x &lt; 0$æ—¶ï¼Œ$b$å¢å¤§ä¼šä½¿æ¢¯åº¦å¢å¤§ï¼ˆæ›´æ¥è¿‘0.5ï¼‰</p>
<hr />
<h3 id="14">14. åº”ç”¨åœºæ™¯ä¸å®è·µå»ºè®®</h3>
<p><strong>å»ºè®®14.1</strong> (ä½•æ—¶ä½¿ç”¨SquarePlus)</p>
<p>æ¨èä½¿ç”¨åœºæ™¯ï¼š
1. <strong>CPUå¯†é›†å‹æ¨ç†</strong>: é¿å…exp/logè¿ç®—ï¼Œæå‡é€Ÿåº¦
2. <strong>è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²</strong>: ç¡¬ä»¶ä¸æ”¯æŒé«˜æ•ˆè¶…è¶Šå‡½æ•°æ—¶
3. <strong>æ•°å€¼æ•æ„Ÿä»»åŠ¡</strong>: éœ€è¦é¿å…expæº¢å‡ºçš„åœºæ™¯
4. <strong>ç†è®ºåˆ†æ</strong>: éœ€è¦æ˜¾å¼è§£æå½¢å¼çš„ç ”ç©¶</p>
<p>ä¸æ¨èåœºæ™¯ï¼š
1. <strong>GPUè®­ç»ƒ</strong>: GPUå¯¹exp/logä¼˜åŒ–è‰¯å¥½ï¼Œé€Ÿåº¦ä¼˜åŠ¿ä¸æ˜æ˜¾
2. <strong>å·²æœ‰é¢„è®­ç»ƒæ¨¡å‹</strong>: æ›´æ¢æ¿€æ´»å‡½æ•°éœ€é‡æ–°è®­ç»ƒ
3. <strong>éœ€è¦ç²¾ç¡®é›¶ç‚¹</strong>: SquarePlusåœ¨åŸç‚¹æœ‰åç§»</p>
<p><strong>å»ºè®®14.2</strong> (åˆå§‹åŒ–ç­–ç•¥)</p>
<p>ä½¿ç”¨SquarePlusæ—¶çš„æƒé‡åˆå§‹åŒ–å»ºè®®ï¼š</p>
<p>ç”±äºSquarePlusçš„æ¢¯åº¦èŒƒå›´æ˜¯$(0, 1)$ï¼Œå…¶æœŸæœ›çº¦ä¸º$\frac{1}{2}$ï¼ˆå‡è®¾è¾“å…¥å¯¹ç§°åˆ†å¸ƒï¼‰ï¼Œç›¸æ¯”ReLUçš„æœŸæœ›$\frac{1}{2}$ï¼ˆæ­£åŠè½´ï¼‰åŸºæœ¬ä¸€è‡´ã€‚å› æ­¤ï¼š</p>
<ul>
<li><strong>Xavieråˆå§‹åŒ–</strong>: ä»ç„¶é€‚ç”¨</li>
<li><strong>Heåˆå§‹åŒ–</strong>: å¯ä»¥ä½¿ç”¨ï¼Œä½†å¯èƒ½è¿‡äºä¿å®ˆ</li>
<li><strong>æ¨è</strong>: ä½¿ç”¨æ ‡å‡†Xavierï¼Œæ–¹å·®ä¸º$\frac{2}{n_{\text{in}} + n_{\text{out}}}$</li>
</ul>
<p><strong>å»ºè®®14.3</strong> (è°ƒå‚ç»éªŒ)</p>
<ul>
<li><strong>é»˜è®¤å€¼</strong>: $b = 1.0$ï¼ˆå¹³è¡¡æ€§èƒ½å’Œé€¼è¿‘è´¨é‡ï¼‰</li>
<li><strong>ç²¾ç»†è°ƒä¼˜</strong>: åœ¨$[0.8, 1.5]$èŒƒå›´å†…ç½‘æ ¼æœç´¢</li>
<li><strong>é¿å…æç«¯</strong>: $b &lt; 0.1$æˆ–$b &gt; 4$é€šå¸¸ä¸å¿…è¦</li>
</ul>
<hr />
<h3 id="15">15. ç†è®ºæ‰©å±•ï¼šå¤šå‚æ•°æ³›åŒ–</h3>
<p><strong>å®šä¹‰15.1</strong> (å¹¿ä¹‰SquarePlus)</p>
<p>å¼•å…¥ä¸¤ä¸ªå‚æ•°çš„ç‰ˆæœ¬ï¼š
\begin{equation}
\text{SquarePlus}(x; a, b) = \frac{x + \sqrt{x^2 + b}}{2} + a \tag{72}
\end{equation}
å…¶ä¸­$a$æ˜¯åç§»å‚æ•°ï¼Œ$b &gt; 0$æ˜¯å…‰æ»‘å‚æ•°ã€‚</p>
<p><strong>æ€§è´¨15.1</strong>:
- $a$æ§åˆ¶å‡½æ•°çš„çºµå‘åç§»
- å¯¼æ•°ä¸å—$a$å½±å“
- å½“$a = -\frac{\sqrt{b}}{2}$æ—¶ï¼Œ$\text{SquarePlus}(0; a, b) = 0$ï¼Œç±»ä¼¼GeLU</p>
<p><strong>å®šä¹‰15.2</strong> (ç¼©æ”¾ç‰ˆæœ¬)</p>
<p>\begin{equation}
\text{SquarePlus}(x; b, \alpha) = \alpha \cdot \frac{x + \sqrt{x^2 + b}}{2} \tag{73}
\end{equation}</p>
<p>å½“$\alpha = \frac{2}{\sqrt{b}}$æ—¶ï¼ŒåŸç‚¹å¯¼æ•°æ°å¥½ä¸º1ã€‚</p>
<hr />
<h3 id="_6">æ€»ç»“</h3>
<p>æœ¬æ–‡ä»æ•°å­¦è§’åº¦å…¨é¢åˆ†æäº†SquarePluså‡½æ•°ï¼š</p>
<ol>
<li><strong>åŸºæœ¬æ€§è´¨</strong>: ä¸¥æ ¼å•è°ƒé€’å¢ã€ä¸¥æ ¼å‡¸ã€å…¨å±€å¯å¯¼</li>
<li><strong>é€¼è¿‘è´¨é‡</strong>: æœ€ä¼˜å‚æ•°$b^* \approx 1.52$æ—¶ä¸SoftPlusæœ€å¤§è¯¯å·®çº¦0.076</li>
<li><strong>è®¡ç®—æ•ˆç‡</strong>: é¿å…è¶…è¶Šå‡½æ•°ï¼Œä»…éœ€å››åˆ™è¿ç®—å’Œå¼€æ–¹</li>
<li><strong>æ•°å€¼ç¨³å®š</strong>: æä¾›äº†ç¨³å®šçš„è®¡ç®—æ–¹æ³•å’Œåå‘ä¼ æ’­å®ç°</li>
<li><strong>å®ç”¨æŒ‡å¯¼</strong>: ç»™å‡ºå‚æ•°é€‰æ‹©å’Œåº”ç”¨åœºæ™¯å»ºè®®</li>
</ol>
<p>SquarePlusä½œä¸ºReLUçš„å…‰æ»‘è¿‘ä¼¼ï¼Œåœ¨ä¿æŒè®¡ç®—ç®€å•æ€§çš„åŒæ—¶ï¼Œæä¾›äº†è‰¯å¥½çš„å¯å¯¼æ€§å’Œé€¼è¿‘è´¨é‡ï¼Œæ˜¯æ·±åº¦å­¦ä¹ ä¸­å€¼å¾—è€ƒè™‘çš„æ¿€æ´»å‡½æ•°é€‰æ‹©ã€‚</p>
        </div>
    </div>
</body>
</html>