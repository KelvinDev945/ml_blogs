<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transformerå‡çº§ä¹‹è·¯ï¼š4ã€äºŒç»´ä½ç½®çš„æ—‹è½¬å¼ä½ç½®ç¼–ç </title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>Transformerå‡çº§ä¹‹è·¯ï¼š4ã€äºŒç»´ä½ç½®çš„æ—‹è½¬å¼ä½ç½®ç¼–ç </h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-12-31 | ğŸ“„ å¤§å°: 21.5 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8397">https://spaces.ac.cn/archives/8397</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨ä¹‹å‰çš„æ–‡ç« <a href="/archives/8265">ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š2ã€åšé‡‡ä¼—é•¿çš„æ—‹è½¬å¼ä½ç½®ç¼–ç ã€‹</a>ä¸­æˆ‘ä»¬æå‡ºäº†æ—‹è½¬å¼ä½ç½®ç¼–ç RoPEä»¥åŠå¯¹åº”çš„Transformeræ¨¡å‹RoFormerã€‚ç”±äºç¬”è€…ä¸»è¦ç ”ç©¶çš„é¢†åŸŸè¿˜æ˜¯NLPï¼Œæ‰€ä»¥æœ¬æ¥è¿™ä¸ªäº‹æƒ…å¯¹äºç¬”è€…æ¥è¯´å·²ç»å®Œäº†ã€‚ä½†æ˜¯æœ€è¿‘ä¸€æ®µæ—¶é—´ï¼ŒTransformeræ¨¡å‹åœ¨è§†è§‰é¢†åŸŸä¹Ÿå¤§ç«ï¼Œå„ç§Vision Transformerï¼ˆViTï¼‰å±‚å‡ºä¸ç©·ï¼Œäºæ˜¯å°±æœ‰äº†é—®é¢˜ï¼šäºŒç»´æƒ…å½¢çš„RoPEåº”è¯¥æ˜¯æ€æ ·çš„å‘¢ï¼Ÿ</p>
<p>å’‹çœ‹ä¸Šå»ï¼Œè¿™ä¸ªä¼¼ä¹åº”è¯¥åªæ˜¯ä¸€ç»´æƒ…å½¢çš„ç®€å•æ¨å¹¿ï¼Œä½†å…¶ä¸­æ¶‰åŠåˆ°çš„æ¨å¯¼å’Œç†è§£å´è¿œæ¯”æˆ‘ä»¬æƒ³è±¡ä¸­å¤æ‚ï¼Œæœ¬æ–‡å°±å¯¹æ­¤åšä¸€ä¸ªåˆ†æï¼Œä»è€Œæ·±åŒ–æˆ‘ä»¬å¯¹RoPEçš„ç†è§£ã€‚</p>
<h2 id="rope">äºŒç»´RoPE</h2>
<p>ä»€ä¹ˆæ˜¯äºŒç»´ä½ç½®ï¼Ÿå¯¹åº”çš„äºŒç»´RoPEåˆæ˜¯æ€æ ·çš„ï¼Ÿå®ƒçš„éš¾åº¦åœ¨å“ªé‡Œï¼Ÿåœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å…ˆç®€å•ä»‹ç»äºŒç»´ä½ç½®ï¼Œç„¶åç›´æ¥ç»™å‡ºäºŒç»´RoPEçš„ç»“æœå’Œæ¨å¯¼æ€è·¯ï¼Œåœ¨éšåçš„å‡ èŠ‚ä¸­ï¼Œæˆ‘ä»¬å†è¯¦ç»†ç»™å‡ºæ¨å¯¼è¿‡ç¨‹ã€‚</p>
<h3 id="_1">äºŒç»´ä½ç½®</h3>
<p>åœ¨NLPä¸­ï¼Œè¯­è¨€çš„ä½ç½®ä¿¡æ¯æ˜¯ä¸€ç»´çš„ï¼Œæ¢å¥è¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦å‘Šè¯‰æ¨¡å‹è¿™ä¸ªè¯æ˜¯å¥å­çš„ç¬¬å‡ ä¸ªè¯ï¼›ä½†æ˜¯åœ¨CVä¸­ï¼Œå›¾åƒçš„ä½ç½®ä¿¡æ¯æ˜¯äºŒç»´çš„ï¼Œå³æˆ‘ä»¬éœ€è¦å‘Šè¯‰æ¨¡å‹è¿™ä¸ªç‰¹å¾æ˜¯åœ¨ç¬¬å‡ è¡Œã€ç¬¬å‡ åˆ—ã€‚è¿™é‡Œçš„äºŒç»´æŒ‡çš„æ˜¯å®Œæ•´æè¿°ä½ç½®ä¿¡æ¯éœ€è¦ä¸¤ä¸ªæ•°å­—ï¼Œå¹¶ä¸æ˜¯æŒ‡ä½ç½®å‘é‡çš„ç»´æ•°ã€‚</p>
<p>æœ‰è¯»è€…å¯èƒ½æƒ³ï¼šç®€å•å±•å¹³åå½“ä½œä¸€ç»´çš„å¤„ç†ä¸è¡Œå—ï¼Ÿç¡®å®ä¸å¤§è¡Œï¼Œæ¯”å¦‚ä¸€ä¸ª$h\times h$çš„feature mapï¼Œä½ç½®$(x,y)$å±•å¹³åå°±å˜æˆäº†$xh + y$ï¼Œè€Œä½ç½®$(x+1,y)$å’Œ$(x,y+1)$å±•å¹³åå°±åˆ†åˆ«å˜æˆäº†$xh+y+h$å’Œ$xh+y+1$ï¼Œä¸¤è€…ä¸$xh + y$çš„å·®åˆ†åˆ«æ˜¯$h$å’Œ$1$ã€‚ç„¶è€Œï¼ŒæŒ‰ç…§æˆ‘ä»¬ç›´è§‚çš„è®¤è¯†ï¼Œ$(x+1,y)$ã€$(x,y+1)$å®ƒä»¬ä¸$(x,y)$çš„è·ç¦»åº”è¯¥æ˜¯ä¸€æ ·çš„æ‰å¯¹ï¼Œä½†æ˜¯å±•å¹³åå´å¾—åˆ°äº†ä¸ä¸€æ ·çš„$h$å’Œ$1$ï¼Œè¿™æœªå…å°±ä¸åˆç†äº†ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦ä¸“é—¨ä¸ºäºŒç»´æƒ…å½¢è®¾è®¡çš„ä½ç½®ç¼–ç ï¼Œä¸èƒ½ç®€å•åœ°å±•å¹³ä¸ºä¸€ç»´æ¥åšã€‚</p>
<h3 id="_2">æ ‡å‡†ç­”æ¡ˆ</h3>
<p>ç»è¿‡åé¢çš„ä¸€ç•ªæ¨å¯¼ï¼Œå¾—åˆ°äºŒç»´RoPEçš„ä¸€ä¸ªè§£ä¸ºï¼š<br />
\begin{equation}\boldsymbol{\mathcal{R}}_{x,y}=\left(<br />
\begin{array}{cc:cc}<br />
\cos x\theta &amp; -\sin x\theta &amp; 0 &amp; 0 \\\<br />
\sin x\theta &amp; \cos x\theta &amp; 0 &amp; 0 \\\<br />
\hdashline<br />
0 &amp; 0 &amp; \cos y\theta &amp; -\sin y\theta \\\<br />
0 &amp; 0 &amp; \sin y\theta &amp; \cos y\theta \\\<br />
\end{array}\right)\label{eq:rope-2d}\end{equation}<br />
å…¶ä¸­è¿™ä¸ªè§£å¾ˆå®¹æ˜“ç†è§£ï¼Œå®ƒæ˜¯ä¸¤ä¸ªä¸€ç»´RoPEç»„æˆçš„åˆ†å—çŸ©é˜µï¼Œå®ç°ä¸Šå®ƒå°±æ˜¯å°†è¾“å…¥å‘é‡åˆ†ä¸ºä¸¤åŠï¼Œä¸€åŠæ–½åŠ $x$çš„ä¸€ç»´RoPEï¼Œä¸€åŠæ–½åŠ $y$çš„ä¸€ç»´RoPEã€‚ç”±æ­¤å½¢å¼æˆ‘ä»¬ä¹Ÿä¸éš¾ç±»æ¯”ä¸‰ç»´ã€å››ç»´ç­‰ä½ç½®çš„RoPEã€‚</p>
<p>çŸ©é˜µ$\eqref{eq:rope-2d}$æ˜¯ä¸€ä¸ªæ­£äº¤çŸ©é˜µï¼Œå®ƒæ»¡è¶³ä¸¤ä¸ªå…³é”®æ€§è´¨ï¼š</p>
<blockquote>
<p>1ã€<strong>ç›¸å¯¹æ€§</strong> ï¼šå³$\boldsymbol{\mathcal{R}}<em x_2_y_2="x_2,y_2">{x_1,y_1}^{\top}\boldsymbol{\mathcal{R}}</em>$ï¼Œä¹Ÿæ­£æ˜¯ç”±äºè¿™ä¸ªæ€§è´¨ï¼ŒRoPEæ‰å…·æœ‰é€šè¿‡ç»å¯¹ä½ç½®å®ç°ç›¸å¯¹ä½ç½®çš„èƒ½åŠ›ï¼›}=\boldsymbol{\mathcal{R}}_{x_2-x_1,y_2-y_1</p>
<p>2ã€<strong>å¯é€†æ€§</strong> ï¼šç»™å®š$\boldsymbol{\mathcal{R}}_{x,y}$å¯ä»¥åè§£å‡º$x,y$ï¼Œè¿™æ„å‘³ç€å¯¹ä½ç½®ä¿¡æ¯çš„ç¼–ç æ˜¯æ— æŸçš„ã€‚</p>
</blockquote>
<p>æŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œå¼$\eqref{eq:rope-2d}$æ˜¯æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªæ€§è´¨çš„æœ€ç®€å•è§£ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œè™½ç„¶å­˜åœ¨ç•¥æœ‰ä¸åŒçš„è§£æ»¡è¶³ä¸Šè¿°ä¸¤ä¸ªæ€§è´¨ï¼Œä½†æ˜¯å®ƒä»¬å½¢å¼ä¸Šå’Œå®ç°ä¸Šéƒ½ç›¸å¯¹å¤æ‚äº›ã€‚</p>
<h3 id="_3">æ¨å¯¼æ€è·¯</h3>
<p>äº‹åæ¥çœ‹ï¼ŒRoPEå…¶å®å°±æ˜¯æ‰¾åˆ°äº†çŸ©é˜µ$\boldsymbol{\mathcal{R}}<em n-m="n-m">n=\begin{pmatrix}\cos n\theta &amp; -\sin n\theta\\\ \sin n\theta &amp; \cos n\theta\end{pmatrix}$ï¼Œä½¿å¾—æ»¡è¶³â€œç›¸å¯¹æ€§â€æ¡ä»¶ï¼š<br />
\begin{equation}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n=\boldsymbol{\mathcal{R}}</em>}\label{eq:re}\end{equation<br />
æ‰€ä»¥ï¼Œä¸éš¾æƒ³åˆ°ï¼ŒäºŒç»´RoPEçš„åŸºæœ¬è¦æ±‚ä¹Ÿæ˜¯æ»¡è¶³ç›¸å¯¹æ€§ï¼Œå³è¦æ‰¾åˆ°çŸ©é˜µ$\boldsymbol{\mathcal{R}}<em x_1_y_1="x_1,y_1">{x,y}$ï¼Œä½¿å¾—å®ƒæ»¡è¶³äºŒç»´çš„ç›¸å¯¹æ€§æ¡ä»¶$\boldsymbol{\mathcal{R}}</em>}^{\top}\boldsymbol{\mathcal{R}<em x_2-x_1_y_2-y_1="x_2-x_1,y_2-y_1">{x_2,y_2}=\boldsymbol{\mathcal{R}}</em>$ã€‚ä¸è¿‡ï¼Œå¦‚æœä»…ä»…æ˜¯è¿™ä¸ªè¦æ±‚çš„è¯ï¼Œå¯è¡Œè§£å°±å¾ˆå¤šäº†ï¼Œæ¯”å¦‚ç›´æ¥è®©<br />
\begin{equation}\boldsymbol{\mathcal{R}}_{x,y} = \begin{pmatrix}\cos (x+y)\theta &amp; -\sin (x+y)\theta\\\ \sin (x+y)\theta &amp; \cos (x+y)\theta\end{pmatrix}\end{equation}<br />
ä½†è¿™ä¸ªè§£çš„é—®é¢˜æ˜¯ï¼Œæˆ‘ä»¬æ— æ³•ä»$x+y$é€†å‘æ¨å‡º$(x,y)$ï¼Œè¿™æ„å‘³ç€è¿™ä¸ªé€‰æ‹©å¯¹ä½ç½®ä¿¡æ¯æ¥è¯´æ˜¯æœ‰æŸçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å¤šä¸€ä¸ªâ€œå¯é€†æ€§â€ï¼Œä¿è¯å¯ä»¥ä»ä½ç½®çŸ©é˜µä¸­æ— æŸåœ°é‡æ„å‡ºåŸå§‹ä½ç½®ä¿¡å·ã€‚</p>
<p>å¯¹æ­¤ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ¯”è¾ƒè‡ªç„¶çš„é€”å¾„é€‰æ‹©ï¼š1ã€å››å…ƒæ•°ï¼›2ã€çŸ©é˜µæŒ‡æ•°ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†ä¼šé€ä¸€ä»‹ç»å®ƒä»¬ã€‚</p>
<h2 id="_4">å››å…ƒæ•°</h2>
<p>åœ¨ä¸€ç»´RoPEçš„æ¨å¯¼ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦ä»¥å¤æ•°ä¸ºå·¥å…·ï¼Œè€Œ<a href="https://en.wikipedia.org/wiki/Quaternion">å››å…ƒæ•°ï¼ˆQuaternionï¼‰</a>æ˜¯å¤æ•°çš„æ¨å¹¿ï¼Œå®ƒåŒæ—¶ä¹Ÿä¿ç•™äº†å¤æ•°çš„å¾ˆå¤šæ€§è´¨ï¼Œæ‰€ä»¥ç”¨å®ƒæ¥æ¨å¯¼äºŒç»´RoPEä¹Ÿç®—æ˜¯ä¸€ä¸ªè‡ªç„¶çš„æ€è·¯ã€‚ä¸è¿‡å¾ˆé—æ†¾ï¼Œè¿™æ˜¯ä¸€æ¡ <em>èµ°ä¸é€š</em> çš„é€”å¾„ï¼Œä½†ç¬”è€…ä»ç„¶å°†æ€è€ƒè¿‡ç¨‹æ”¾ç½®åœ¨æ­¤ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚</p>
<h3 id="_5">å¤æ•°ä¸çŸ©é˜µ</h3>
<p>åœ¨é«˜ä¸­æ—¶æˆ‘ä»¬å°±å­¦ä¹ è¿‡ï¼Œå¤æ•°$a+b\boldsymbol{i}$è·ŸäºŒç»´å‘é‡$(a,b)$æ—¶ä¸€ä¸€å¯¹åº”çš„ï¼ˆä¸ºäº†è·Ÿåé¢çš„å››å…ƒæ•°å¯¹é½ï¼Œè¿™é‡ŒæŠŠè™šæ•°å•ä½$\boldsymbol{i}$ä¹ŸåŠ ç²—äº†ï¼‰ï¼Œä½†è¿™ä¸ªå¯¹åº”å…³ç³»åªèƒ½ä¿æŒåŠ å‡æ³•å¯¹åº”ï¼ˆå› ä¸ºå‘é‡æ²¡æœ‰é€šç”¨çš„ä¹˜æ³•è¿ç®—ï¼‰ã€‚æ›´ç²¾å¦™çš„å¯¹åº”æ˜¯å°†å¤æ•°ä¸çŸ©é˜µå¯¹åº”<br />
\begin{equation}a+b\boldsymbol{i} \quad \leftrightarrow \quad \begin{pmatrix} a &amp; -b \\\ b &amp; a \end{pmatrix}\end{equation}<br />
åœ¨è¿™ä¸ªæ˜ å°„ä¸‹ï¼Œå¤æ•°çš„åŠ å‡ä¹˜é™¤ä¸çŸ©é˜µçš„åŠ å‡ä¹˜é™¤ä¸€ä¸€å¯¹åº”ï¼Œæ¯”å¦‚<br />
\begin{equation}\begin{array}{ccc}<br />
(a+b\boldsymbol{i})(c+d\boldsymbol{i}) &amp;=&amp; (ac - bd) + (ad + bc)\boldsymbol{i} \\\[5pt]<br />
\begin{pmatrix} a &amp; -b \\\ b &amp; a \end{pmatrix}\begin{pmatrix} c &amp; -d \\\ d &amp; c \end{pmatrix} &amp;=&amp; \begin{pmatrix} ac - bd &amp; - ad - bc \\\ ad + bc &amp; ac - bd \end{pmatrix}<br />
\end{array}\end{equation}<br />
æ‰€ä»¥ï¼ŒçŸ©é˜µæ˜ å°„æ‰æ˜¯å¤æ•°åŸŸçš„å®Œå…¨åŒæ„ï¼Œè€Œå‘é‡æ˜ å°„åªæ˜¯ç›´è§‚çš„å‡ ä½•ç†è§£ã€‚</p>
<p>å¤æ•°çš„çŸ©é˜µæ˜ å°„ä¹Ÿæ˜¯RoPEçš„é‡è¦åŸºç¡€ï¼Œåœ¨<a href="/archives/8265">ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š2ã€åšé‡‡ä¼—é•¿çš„æ—‹è½¬å¼ä½ç½®ç¼–ç ã€‹</a>ä¸­æˆ‘ä»¬å·²ç»æ¨å¯¼å¾—åˆ°RoPEçš„å¤æ•°è¡¨ç¤ºæ˜¯$\boldsymbol{q}e^{n\boldsymbol{i}\theta}=(\cos n\theta + \boldsymbol{i}\sin n\theta)\boldsymbol{q}$ï¼Œæ‰€ä»¥æ ¹æ®å¤æ•°çš„çŸ©é˜µæ˜ å°„ï¼Œ$\cos n\theta + \boldsymbol{i}\sin n\theta$å°±å¯¹åº”ç€çŸ©é˜µ<br />
\begin{equation}\boldsymbol{\mathcal{R}}_n=\begin{pmatrix}\cos n\theta &amp; -\sin n\theta\\\ \sin n\theta &amp; \cos n\theta\end{pmatrix}\end{equation}<br />
ä»è€Œå¾—åˆ°äº†ä¸€ç»´RoPEçš„çŸ©é˜µå½¢å¼ã€‚</p>
<h3 id="_6">å››å…ƒæ•°ç®€ä»‹</h3>
<p>å‰é¢è¯´äº†ï¼Œå››å…ƒæ•°æ˜¯å¤æ•°æ˜¯ä¸€ç§æ¨å¹¿ï¼Œäº‹å®ä¸Šå®ƒè¿˜æ˜¯çŸ©é˜µçš„â€œé¼»ç¥–â€ï¼Œä»å†å²ä¸Šæ¥è¯´ï¼Œæ˜¯å…ˆæœ‰å››å…ƒæ•°ç„¶åæ‰æœ‰ä¸€èˆ¬çš„çŸ©é˜µè¿ç®—ï¼Œå¹¶ä¸”å››å…ƒæ•°å¯å‘äº†çŸ©é˜µçš„å¾ˆå¤šè¿ç®—ã€‚æ—©å¹´ç¬”è€…ä¹Ÿå†™äº†<a href="/archives/898">ã€Šä¸å‘é‡çš„æ¸Šæºææ·±çš„å››å…ƒæ•°ã€‹</a>ã€<a href="/archives/2291">ã€Šå‡ ä½•çš„æ•°ä¸æ•°çš„å‡ ä½•ï¼šè¶…å¤æ•°çš„æµ…æ¢ç©¶ã€‹</a>ç­‰æ–‡ç« æ¥ä»‹ç»å››å…ƒæ•°ï¼Œæ¬¢è¿è¯»è€…å‚è€ƒã€‚</p>
<p>å¦‚æœè¯´å¤æ•°æ˜¯ä¸€ä¸ªäºŒç»´å‘é‡ï¼Œé‚£ä¹ˆå››å…ƒæ•°å°±æ˜¯ä¸€ä¸ªå››ç»´å‘é‡ï¼Œè¡¨ç¤ºä¸º$a+b\boldsymbol{i}+c\boldsymbol{j}+d\boldsymbol{k}$ï¼Œè¿™é‡Œçš„$\boldsymbol{i}^2=\boldsymbol{j}^2=\boldsymbol{k}^2=-1$ï¼Œä½†æ˜¯å®ƒä»¬æœ¬èº«éƒ½å„ä¸ç›¸ç­‰ï¼Œå‡ ä¸ªåŸºä¹‹é—´çš„è¿ç®—è§„åˆ™æ˜¯ï¼š<br />
\begin{array}{c|cccc}<br />
\times &amp; 1 &amp; \boldsymbol{i} &amp; \boldsymbol{j} &amp; \boldsymbol{k} \\\<br />
\hline<br />
1 &amp; 1 &amp; \boldsymbol{i} &amp; \boldsymbol{j} &amp; \boldsymbol{k} \\\<br />
\boldsymbol{i} &amp; \boldsymbol{i} &amp; -1 &amp; \boldsymbol{k} &amp; -\boldsymbol{j} \\\<br />
\boldsymbol{j} &amp; \boldsymbol{j} &amp; -\boldsymbol{k} &amp; -1 &amp; \boldsymbol{i} \\\<br />
\boldsymbol{k} &amp; \boldsymbol{k} &amp; \boldsymbol{j} &amp; -\boldsymbol{i} &amp; -1 \\\<br />
\end{array}<br />
åœ¨å½“æ—¶å®ƒç»™äººä»¬æœ€å¤§çš„å†²å‡»æ˜¯éäº¤æ¢æ€§ï¼Œæ¯”å¦‚$\boldsymbol{i}\boldsymbol{j}=-\boldsymbol{j}\boldsymbol{i}\neq \boldsymbol{j}\boldsymbol{i}$ã€‚ä½†é™¤æ­¤ä¹‹å¤–ï¼Œå®ƒè·Ÿå¤æ•°è¿ç®—å…¶å®æ˜¯é«˜åº¦ç›¸ä¼¼çš„ã€‚</p>
<p>æ¯”å¦‚ç±»ä¼¼å¤æ•°çš„æ¬§æ‹‰å…¬å¼<br />
\begin{equation}e^{a+b\boldsymbol{i}+c\boldsymbol{j}+d\boldsymbol{k}} = e^a\left(\cos r + \frac{b\boldsymbol{i}+c\boldsymbol{j}+d\boldsymbol{k}}{r}\sin r\right)\label{eq:euler}\end{equation}<br />
è¿™é‡Œ$r = \Vert b\boldsymbol{i}+c\boldsymbol{j}+d\boldsymbol{k}\Vert = \sqrt{b^2+c^2+d^2}$ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ç±»ä¼¼çš„çŸ©é˜µæ˜ å°„<br />
\begin{equation}<br />
a+b\boldsymbol{i}+c\boldsymbol{j}+d\boldsymbol{k} \quad \leftrightarrow \quad \begin{pmatrix}<br />
a &amp; -b &amp; -c &amp; -d \\\<br />
b &amp; a &amp; -d &amp; c \\\<br />
c &amp; d &amp; a &amp; -b \\\<br />
d &amp; -c &amp; b &amp; a<br />
\end{pmatrix}\label{eq:mapping}\end{equation}</p>
<h3 id="_7">è¿èƒŒç›¸å¯¹æ€§</h3>
<p>å…³äºè¿™äº›å…¬å¼èƒŒåçš„èµ·æºï¼Œé‚£å°±è¯´æ¥è¯é•¿äº†ï¼Œè¿™é‡Œä¹Ÿä¸æ‰“ç®—ç»†è°ˆï¼Œæœ‰å…´è¶£çš„è¯»è€…è¯·è‡ªè¡Œæœç´¢èµ„æ–™é˜…è¯»ã€‚æœ‰äº†æ¬§æ‹‰å…¬å¼å’ŒæŒ‡æ•°æ˜ å°„åï¼Œè¯»è€…æˆ–è®¸ååº”è¿‡æ¥ï¼šä¸€ç»´RoPEæ— éæ˜¯$e^{n\boldsymbol{i}\theta}$å¯¹åº”çš„çŸ©é˜µæ˜ å°„ï¼Œé‚£ä¹ˆäºŒç»´RoPEçš„è¯å°†$e^{x\boldsymbol{i}\theta + y\boldsymbol{j}\theta}$æ˜ å°„ä¸ºçŸ©é˜µå½¢å¼ä¸å°±è¡Œäº†ï¼Ÿ</p>
<p>ç¬”è€…ä¸€å¼€å§‹ä¹Ÿæ˜¯è¿™æ ·æƒ³çš„ï¼Œå¾ˆé—æ†¾ï¼Œè¿™æ˜¯é”™çš„ã€‚é”™åœ¨å“ªé‡Œå‘¢ï¼Ÿåœ¨ä¸€ç»´RoPEä¸­ï¼Œæˆ‘ä»¬åˆ©ç”¨äº†å†…ç§¯çš„å¤æ•°è¡¨ç¤ºï¼š<br />
\begin{equation}\langle\boldsymbol{q},\boldsymbol{k}\rangle=\text{Re}[\boldsymbol{q}\boldsymbol{k}^<em>]\end{equation}<br />
è¯¥æ’ç­‰å¼åœ¨å››å…ƒæ•°ä¸­åŒæ ·æˆç«‹ï¼Œå› æ­¤å¯ä»¥ç…§æ¬ã€‚æ¥ç€æˆ‘ä»¬åˆ©ç”¨äº†å¤æŒ‡æ•°ï¼š<br />
\begin{equation}\langle\boldsymbol{q}e^{m\boldsymbol{i}\theta},\boldsymbol{k}\boldsymbol{q}e^{n\boldsymbol{i}\theta}\rangle=\text{Re}\left[\left(\boldsymbol{q}e^{m\boldsymbol{i}\theta}\right)\left(\boldsymbol{k}e^{n\boldsymbol{i}\theta}\right)^</em>\right]=\text{Re}\left[\boldsymbol{q}e^{m\boldsymbol{i}\theta}e^{-n\boldsymbol{i}\theta}\boldsymbol{k}^<em>\right]=\text{Re}\left[\boldsymbol{q}e^{(m-n)\boldsymbol{i}\theta}\boldsymbol{k}^</em>\right]\end{equation}<br />
å‰ä¸¤ä¸ªç­‰å·éƒ½å¯ä»¥ç…§æ¬åˆ°å››å…ƒæ•°ä¸­ï¼Œå…³é”®æ˜¯ç¬¬ä¸‰ä¸ªç­‰å·åœ¨å››å…ƒæ•°ä¸­å¹¶ä¸æ’æˆç«‹ï¼ä¸€èˆ¬åœ°ï¼Œå¯¹äºä¸¤ä¸ªå››å…ƒæ•°$\boldsymbol{p},\boldsymbol{q}$ï¼Œç­‰å¼$e^{\boldsymbol{p}+\boldsymbol{q}}=e^{\boldsymbol{p}}e^{\boldsymbol{q}}$å¹¶ä¸æˆç«‹ï¼æ›´å¹¿ä¹‰æ¥è¯´ï¼Œå¯¹äºä¸¤ä¸ªä¹˜æ³•ä¸æ»¡è¶³äº¤æ¢å¾‹çš„å¯¹è±¡ï¼Œä¸€èˆ¬éƒ½æœ‰$e^{\boldsymbol{p}+\boldsymbol{q}}\neq e^{\boldsymbol{p}}e^{\boldsymbol{q}}$ã€‚</p>
<p>æ‰€ä»¥ï¼Œæ¨å¯¼åˆ°æœ€åï¼Œç”±äºæŒ‡æ•°ä¹˜æ³•æ— æ³•è½¬æ¢ä¸ºåŠ æ³•ï¼Œæœ€åçš„ç›¸å¯¹æ€§æ²¡æ³•å¾—åˆ°ä¿è¯ã€‚å› æ­¤é€šè¿‡å››å…ƒæ•°æ¨å¯¼è¿™æ¡è·¯ï¼Œå°±æ­¤å¤­æŠ˜äº†...</p>
<h2 id="_8">çŸ©é˜µæŒ‡æ•°</h2>
<p>å››å…ƒæ•°çš„çŸ©é˜µæ˜ å°„è¡¨æ˜å››å…ƒæ•°äº‹å®ä¸Šä»£è¡¨äº†ä¸€ç°‡ç‰¹å®šçš„$4\times 4$çŸ©é˜µï¼Œå››å…ƒæ•°æ¨å¯¼èµ°ä¸é€šï¼Œé‚£ä¹ˆæˆ–è®¸ä½¿ç”¨ä¸€èˆ¬çš„çŸ©é˜µåˆ†æå¯ä»¥èµ°å¾—é€šã€‚äº‹å®ä¸Šç¡®å®å¦‚æ­¤ï¼Œåœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†åˆ©ç”¨çŸ©é˜µæŒ‡æ•°ç»™å‡ºä¸€ä¸ªæ¨å¯¼ç»“æœã€‚</p>
<h3 id="_9">çŸ©é˜µæŒ‡æ•°</h3>
<p>è¿™é‡Œçš„<a href="https://en.wikipedia.org/wiki/Matrix_exponential">çŸ©é˜µæŒ‡æ•°</a>ï¼Œå¹¶ä¸æ˜¯ç¥ç»ç½‘ç»œçš„ç”¨æŒ‡æ•°å‡½æ•°ä½œä¸ºæ¿€æ´»å‡½æ•°çš„é€ä½è¿ç®—ï¼Œè€Œæ˜¯æ˜¯æŒ‰ç…§å¹‚çº§æ•°å®šä¹‰çš„è¿ç®—ï¼š<br />
\begin{equation}\exp \boldsymbol{B} = \sum_{k=0}^{\infty}\frac{\boldsymbol{B}^k}{k!}\end{equation}<br />
å…¶ä¸­$\boldsymbol{B}^k$æ˜¯æŒ‡æŒ‰ç…§çŸ©é˜µä¹˜æ³•å°†$k$ä¸ª$\boldsymbol{B}$è¿ä¹˜ã€‚å…³äºçŸ©é˜µæŒ‡æ•°ï¼Œç¬”è€…ä¹‹å‰æ›¾å†™è¿‡<a href="/archives/6377">ã€Šæ’ç­‰å¼ det(exp(A)) = exp(Tr(A)) èµæã€‹</a>ï¼Œä¹Ÿæ¬¢è¿å‚è€ƒé˜…è¯»ã€‚</p>
<p>çŸ©é˜µæŒ‡æ•°æ˜¯éå¸¸é‡è¦çš„ä¸€ç§çŸ©é˜µè¿ç®—ï¼Œå®ƒå¯ä»¥ç›´æ¥å†™å‡ºå¸¸ç³»æ•°å¾®åˆ†æ–¹ç¨‹ç»„$\frac{d}{dt}\boldsymbol{x}_t=\boldsymbol{A}\boldsymbol{x}_t$çš„è§£ï¼š<br />
\begin{equation}\boldsymbol{x}_t = \big(\exp t\boldsymbol{A}\big)\boldsymbol{x}_0\end{equation}<br />
å½“ç„¶è¿™è·Ÿæœ¬æ–‡çš„ä¸»é¢˜å…³ç³»ä¸å¤§ã€‚å¯¹äºRoPEçš„æ¨å¯¼ï¼Œæˆ‘ä»¬ä¸»è¦åˆ©ç”¨åˆ°çŸ©é˜µæŒ‡æ•°çš„å¦‚ä¸‹æ€§è´¨ï¼š<br />
\begin{equation}\boldsymbol{A}\boldsymbol{B} = \boldsymbol{B}\boldsymbol{A} \quad\Rightarrow\quad \big(\exp \boldsymbol{A}\big)\big(\exp \boldsymbol{B}\big) = \exp \big(\boldsymbol{A} + \boldsymbol{B}\big)\label{eq:expm-ex}\end{equation}<br />
ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœ$\boldsymbol{A},\boldsymbol{B}$çš„ä¹˜æ³•å¯ä»¥äº¤æ¢ï¼Œé‚£ä¹ˆçŸ©é˜µæŒ‡æ•°å°±å¯ä»¥åƒæ•°çš„æŒ‡æ•°ä¸€æ ·å°†ä¹˜æ³•è½¬æ¢ä¸ºåŠ æ³•ã€‚ä¸è¿‡è¦æ³¨æ„è¿™æ˜¯ä¸€ä¸ªå……åˆ†ä¸å¿…è¦æ¡ä»¶ã€‚</p>
<p>è‡³äºæ€ä¹ˆæŠŠçŸ©é˜µæŒ‡æ•°ç®—å‡ºæ¥ï¼Œè¿™é‡Œæ²¡æ³•å†å±•å¼€ä»‹ç»äº†ï¼Œä½†æ˜¯å¾ˆå¤šè½¯ä»¶åº“å·²ç»è‡ªå¸¦äº†çŸ©é˜µæŒ‡æ•°è¿ç®—ï¼Œæ¯”å¦‚æ•°å€¼è®¡ç®—åº“scipyå’Œtensorflowéƒ½æœ‰<code>expm</code>å‡½æ•°ï¼Œè€Œç¬¦å·è®¡ç®—çš„è¯ï¼ŒMathematicaé‡Œè¾¹æœ‰<code>MatrixExp</code>å‡½æ•°ã€‚</p>
<h3 id="_10">ä¸€ç»´é€šè§£</h3>
<p>ä¸ºä»€ä¹ˆèƒ½å¤Ÿå°†RoPEè·ŸçŸ©é˜µæŒ‡æ•°è”ç³»èµ·æ¥å‘¢ï¼Ÿå› ä¸ºä¸€ç»´çš„RoPEå­˜åœ¨æ¯”è¾ƒç®€å•çš„æŒ‡æ•°è¡¨è¾¾å¼ï¼š<br />
\begin{equation}\boldsymbol{\mathcal{R}}_n=\begin{pmatrix}\cos n\theta &amp; -\sin n\theta\\\ \sin n\theta &amp; \cos n\theta\end{pmatrix}=\exp\left\{n\theta\begin{pmatrix}0 &amp; -1\\\ 1 &amp; 0\end{pmatrix}\right\}\label{eq:rope-exp}\end{equation}<br />
äºæ˜¯ç¬”è€…å¼€å§‹æ€è€ƒå¦‚ä¸‹å½¢å¼çš„çŸ©é˜µä½œä¸ºRoPEçš„è§£ï¼š<br />
\begin{equation}\boldsymbol{\mathcal{R}}_n=\exp n\boldsymbol{B}\end{equation}<br />
å…¶ä¸­$\boldsymbol{B}$æ˜¯ä¸€ä¸ªè·Ÿ$n$æ— å…³çš„çŸ©é˜µã€‚RoPEçš„å¿…è¦æ¡ä»¶æ˜¯æ»¡è¶³â€œç›¸å¯¹æ€§â€æ¡ä»¶$\eqref{eq:re}$ï¼Œäºæ˜¯æˆ‘ä»¬åˆ†æ<br />
\begin{equation}\big(\exp m\boldsymbol{B}\big)^{\top}\big(\exp n\boldsymbol{B}\big) = \big(\exp m\boldsymbol{B}^{\top}\big)\big(\exp n\boldsymbol{B}\big)\end{equation}<br />
è¿™é‡Œå…ˆå‡è®¾$\boldsymbol{B}^{\top},\boldsymbol{B}$æ˜¯å¯äº¤æ¢çš„ï¼Œé‚£ä¹ˆæ ¹æ®å¼$\eqref{eq:expm-ex}$æœ‰<br />
\begin{equation}\big(\exp m\boldsymbol{B}^{\top}\big)\big(\exp n\boldsymbol{B}\big) = \exp \big(m\boldsymbol{B}^{\top} + n\boldsymbol{B}\big)\end{equation}<br />
è¦è®©$m\boldsymbol{B}^{\top} + n\boldsymbol{B}=(n-m)\boldsymbol{B}$ï¼Œåªéœ€è¦æ»¡è¶³<br />
\begin{equation}\boldsymbol{B}^{\top} = - \boldsymbol{B}\end{equation}<br />
è¿™ä¾¿æ˜¯â€œç›¸å¯¹æ€§â€ç»™å‡ºçš„çº¦æŸæ¡ä»¶ï¼Œåˆšæ‰æˆ‘ä»¬è¿˜å‡è®¾äº†$\boldsymbol{B}^{\top},\boldsymbol{B}$æ˜¯å¯äº¤æ¢çš„ï¼Œç°åœ¨å¯ä»¥æ£€éªŒæ»¡è¶³è¿™ä¸ªç­‰å¼çš„$\boldsymbol{B}^{\top},\boldsymbol{B}$ä¸€å®šæ˜¯å¯äº¤æ¢çš„ï¼Œæ‰€ä»¥ç»“æœæ˜¯è‡ªæ´½çš„ã€‚</p>
<p>è¿™ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹äºä»»ä½•æ»¡è¶³$\boldsymbol{B}^{\top} + \boldsymbol{B} = 0$çš„çŸ©é˜µ$\boldsymbol{B}$ï¼Œ$\exp n\boldsymbol{B}$éƒ½æ˜¯æ–¹ç¨‹$\eqref{eq:re}$çš„è§£ï¼Œå¹¶ä¸”è¿˜å¯ä»¥è¯æ˜å®ƒä¸€å®šæ˜¯æ­£äº¤çŸ©é˜µã€‚å½“ç„¶ï¼Œæ ¹æ®$\exp n\boldsymbol{B}=\left(\exp \boldsymbol{B}\right)^n$ï¼Œæˆ‘ä»¬æ›´ç›´æ¥çš„å¾—åˆ°ï¼šå¯¹äºä»»æ„æ­£äº¤çŸ©é˜µ$\boldsymbol{O}$ï¼Œ$\boldsymbol{\mathcal{R}}_n=\boldsymbol{O}^n$éƒ½æ˜¯æ–¹ç¨‹$\eqref{eq:re}$çš„è§£ã€‚</p>
<p>å¯¹äº$2\times 2$çš„çŸ©é˜µæ¥è¯´ï¼Œ$\boldsymbol{B}^{\top} + \boldsymbol{B} = 0$çš„é€šè§£æ˜¯$\boldsymbol{B}=\begin{pmatrix}0 &amp; -\theta\\\ \theta &amp; 0\end{pmatrix}$ï¼Œäºæ˜¯å°±æœ‰äº†å¦‚å¼$\eqref{eq:rope-exp}$çš„è§£ã€‚</p>
<h3 id="_11">äºŒç»´çº¦æŸ</h3>
<p>ç±»ä¼¼åœ°ï¼Œå¯¹äºäºŒç»´RoPEï¼Œæˆ‘ä»¬è€ƒè™‘<br />
\begin{equation}\boldsymbol{\mathcal{R}}_{x,y}=\exp \big(x\boldsymbol{B}_1 + y\boldsymbol{B}_2\big)\end{equation}<br />
ä½œä¸ºå€™é€‰è§£ã€‚é‡å¤ä¸Šè¿°å…³äºâ€œç›¸å¯¹æ€§â€æ¡ä»¶çš„æ¨å¯¼ï¼šå…ˆå‡è®¾$x_1\boldsymbol{B}_1^{\top} + y_1\boldsymbol{B}_2^{\top}$ä¸$x_2\boldsymbol{B}_1 + y_2\boldsymbol{B}_2$æ˜¯å¯äº¤æ¢çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¦‚ä¸‹çº¦æŸæ¡ä»¶ï¼š<br />
\begin{equation}\boldsymbol{B}_1^{\top} + \boldsymbol{B}_1 = 0,\quad \boldsymbol{B}_2^{\top} + \boldsymbol{B}_2 = 0\end{equation}<br />
ç„¶è€Œï¼Œ$x_1\boldsymbol{B}_1^{\top} + y_1\boldsymbol{B}_2^{\top}$ä¸$x_2\boldsymbol{B}_1 + y_2\boldsymbol{B}_2$å¯äº¤æ¢ï¼Œæ„å‘³ç€$(\boldsymbol{B}_1,\boldsymbol{B}_1^{\top})$ã€$(\boldsymbol{B}_2,\boldsymbol{B}_2^{\top})$ã€$(\boldsymbol{B}_1,\boldsymbol{B}_2^{\top})$å’Œ$(\boldsymbol{B}_2,\boldsymbol{B}_1^{\top})$éƒ½å¯äº¤æ¢ï¼Œä½†æ˜¯ä¸Šè¿°ä¸¤ä¸ªçº¦æŸåªèƒ½ä¿è¯$(\boldsymbol{B}_1,\boldsymbol{B}_1^{\top})$å’Œ$(\boldsymbol{B}_2,\boldsymbol{B}_2^{\top})$å¯äº¤æ¢ï¼Œä¸èƒ½ä¿è¯åä¸¤è€…çš„äº¤æ¢æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŠŠå®ƒä½œä¸ºçº¦æŸæ¡ä»¶è¡¥å……ä¸Šå»ï¼Œå¾—åˆ°ï¼š<br />
\begin{equation}\left\{\begin{aligned}<br />
&amp;\boldsymbol{B}_1^{\top} + \boldsymbol{B}_1 = 0\\\<br />
&amp;\boldsymbol{B}_2^{\top} + \boldsymbol{B}_2 = 0\\\<br />
&amp;\boldsymbol{B}_1 \boldsymbol{B}_2^{\top} = \boldsymbol{B}_2^{\top} \boldsymbol{B}_1<br />
\end{aligned}\right.\label{eq:2d-conds}\end{equation}<br />
ä¸éš¾è¯æ˜åœ¨å‰ä¸¤ä¸ªæ¡ä»¶ä¸‹ï¼Œæ–°å¢çš„çº¦æŸæ¡ä»¶ä¹Ÿç›¸å½“äº$\boldsymbol{B}_1 \boldsymbol{B}_2 = \boldsymbol{B}_2 \boldsymbol{B}_1$ã€‚</p>
<h3 id="rope_1">RoPEç°èº«</h3>
<p>ç”±äºæ»¡è¶³å‰ä¸¤ä¸ªæ¡ä»¶çš„$2\times 2$çŸ©é˜µåªæœ‰ä¸€ä¸ªç‹¬ç«‹å‚æ•°ï¼Œä¸æ»¡è¶³â€œå¯é€†æ€§â€ï¼Œæ‰€ä»¥æˆ‘ä»¬è‡³å°‘è¦è€ƒè™‘$3\times 3$çŸ©é˜µï¼Œå®ƒæœ‰3ä¸ªç‹¬ç«‹å‚æ•°<br />
\begin{equation}\begin{pmatrix}0 &amp; -a &amp; -b \\\ a &amp; 0 &amp; -c \\\ b &amp; c &amp; 0\end{pmatrix}\end{equation}<br />
ä¸ºäº†ä¿è¯å¯é€†æ€§ï¼Œæˆ‘ä»¬ä¸å¦¨è®¾$\boldsymbol{B}_1,\boldsymbol{B}_2$æ˜¯â€œæ­£äº¤â€çš„ï¼Œæ¯”å¦‚è®¾ï¼š<br />
\begin{equation}\boldsymbol{B}_1=\begin{pmatrix}0 &amp; -a &amp; 0 \\\ a &amp; 0 &amp; 0 \\\ 0 &amp; 0 &amp; 0\end{pmatrix},\quad\boldsymbol{B}_2=\begin{pmatrix}0 &amp; 0 &amp; -b \\\ 0 &amp; 0 &amp; -c \\\ b &amp; c &amp; 0\end{pmatrix}\end{equation}<br />
ä¸å¤±ä¸€èˆ¬æ€§è¿˜å¯ä»¥è®¾$a=1$ï¼Œé‚£ä¹ˆç”±æ¡ä»¶$\eqref{eq:2d-conds}$è§£å¾—$b=0,c=0$ï¼Œå³$\boldsymbol{B}_2$åªèƒ½æ˜¯å…¨é›¶è§£ï¼Œè¿™ä¸ç¬¦åˆæˆ‘ä»¬çš„è¦æ±‚ã€‚Mathematicaçš„æ±‚è§£ä»£ç ä¸ºï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="x">B[a_, b_, c_] = </span><span class="cp">{{</span><span class="m">0</span><span class="o">,</span> <span class="o">-</span><span class="nv">a</span><span class="o">,</span> <span class="o">-</span><span class="nv">b</span><span class="o">},</span> <span class="o">{</span><span class="nv">a</span><span class="o">,</span> <span class="m">0</span><span class="o">,</span> <span class="o">-</span><span class="nv">c</span><span class="o">},</span> <span class="o">{</span><span class="nv">b</span><span class="o">,</span> <span class="nv">c</span><span class="o">,</span> <span class="m">0</span><span class="cp">}}</span><span class="x">;</span>
<span class="x">B1 = B[1, 0, 0];</span>
<span class="x">B2 = B[0, b, c];</span>
<span class="x">Solve[{Dot[B1, B2] == Dot[B2, B1]}, {b, c}]</span>
</code></pre></div>

<p>å› æ­¤ï¼Œæˆ‘ä»¬è‡³å°‘è¦è€ƒè™‘$4\times 4$çŸ©é˜µï¼Œå®ƒæœ‰6ä¸ªç‹¬ç«‹å‚æ•°ï¼Œä¸å¤±ä¸€èˆ¬æ€§ï¼Œè€ƒè™‘æ­£äº¤åˆ†è§£ï¼š<br />
\begin{equation}\boldsymbol{B}_1=\begin{pmatrix}0 &amp; -a &amp; -b &amp; 0 \\\ a &amp; 0 &amp; -c &amp; 0 \\\ b &amp; c &amp; 0 &amp; 0 \\\ 0 &amp; 0 &amp; 0 &amp; 0\end{pmatrix},\quad\boldsymbol{B}_2=\begin{pmatrix}0 &amp; 0 &amp; 0 &amp; -d \\\ 0 &amp; 0 &amp; 0 &amp; -e \\\ 0 &amp; 0 &amp; 0 &amp; -f \\\ d &amp; e &amp; f &amp; 0\end{pmatrix}\end{equation}<br />
è§£å¾—<br />
\begin{equation}d=cf,\quad e=-bf\end{equation}<br />
æ±‚è§£ä»£ç ï¼š</p>
<div class="codehilite"><pre><span></span><code>B[a_, b_, c_, d_, e_, 
   f_] = {{0, -a, -b, -d}, {a, 0, -c, -e}, {b, c, 0, -f}, {d, e, f, 
    0}};
B1 = B[1, b, c, 0, 0, 0];
B2 = B[0, 0, 0, d, e, f];
Solve[{Dot[B1, B2] == Dot[B2, B1]}, {b, c, d, e, f}]
</code></pre></div>

<p>å¯ä»¥å‘ç°ç»“æœæ²¡æœ‰å¯¹$f$æå‡ºçº¦æŸï¼Œæ‰€ä»¥ä»æœ€ç®€å•èµ·è§ï¼Œæˆ‘ä»¬å¯ä»¥è®©$f=1$ï¼Œå‰©ä¸‹çš„$b,c,d,e$å…¨éƒ¨ä¸º0ï¼Œæ­¤æ—¶<br />
\begin{equation}\boldsymbol{\mathcal{R}}<em x_y="x,y">{x,y}=\exp \,\begin{pmatrix}0 &amp; -x &amp; 0 &amp; 0 \\\ x &amp; 0 &amp; 0 &amp; 0 \\\ 0 &amp; 0 &amp; 0 &amp; -y \\\ 0 &amp; 0 &amp; y &amp; 0\end{pmatrix}\end{equation}<br />
å¯ä»¥å¢åŠ ä¸ªå‚æ•°$\theta$ï¼Œå®Œæˆå±•å¼€ï¼Œå°±å¾—åˆ°ï¼š<br />
\begin{equation}\boldsymbol{\mathcal{R}}</em>=\left(}=\exp \,\left\{\begin{pmatrix}0 &amp; -x &amp; 0 &amp; 0 \\\ x &amp; 0 &amp; 0 &amp; 0 \\\ 0 &amp; 0 &amp; 0 &amp; -y \\\ 0 &amp; 0 &amp; y &amp; 0\end{pmatrix}\theta\right\<br />
\begin{array}{cc:cc}<br />
\cos x\theta &amp; -\sin x\theta &amp; 0 &amp; 0 \\\<br />
\sin x\theta &amp; \cos x\theta &amp; 0 &amp; 0 \\\<br />
\hdashline<br />
0 &amp; 0 &amp; \cos y\theta &amp; -\sin y\theta \\\<br />
0 &amp; 0 &amp; \sin y\theta &amp; \cos y\theta \\\<br />
\end{array}\right)\end{equation}</p>
<h2 id="_12">å»¶ä¼¸æ•…äº‹</h2>
<p>è‡³æ­¤ï¼Œå…³äºäºŒç»´RoPEçš„æ¨å¯¼ä»‹ç»å®Œæ¯•ã€‚ç°åœ¨è¯»è€…å¯èƒ½æƒ³é—®çš„æ˜¯æ•ˆæœå¦‚ä½•ï¼Ÿå¾ˆé—æ†¾ï¼Œç°åœ¨è¿˜æ²¡æœ‰å¾ˆå®Œæ•´çš„å®éªŒç»“æœï¼Œæ¯•ç«Ÿç¬”è€…ä¹‹å‰ä¹Ÿæ²¡åšè¿‡ViTç›¸å…³çš„å·¥ä½œï¼Œè€Œè¿™ä¸ªäºŒç»´RoPEçš„æ¨å¯¼ä¹Ÿåˆšå®Œæˆæ²¡å¤šä¹…ï¼Œæ‰€ä»¥è¿›å±•æ¯”è¾ƒæ…¢ï¼Œåªèƒ½è¯´åˆæ­¥çš„ç»“æœæ˜¾ç¤ºè¿˜æ˜¯æŒºæœ‰æ•ˆçš„ã€‚EleutherAIå›¢é˜Ÿçš„æˆå‘˜ä¹Ÿå®éªŒè¿‡è¿™ä¸ªæ–¹æ¡ˆï¼Œæ•ˆæœä¹Ÿæ¯”å·²æœ‰çš„å…¶ä»–ä½ç½®ç¼–ç å¥½ã€‚</p>
<p>è¯´åˆ°EleutherAIå›¢é˜Ÿï¼Œè¿™é‡Œå†å¤šè¯´å‡ å¥ã€‚EleutherAIå›¢é˜Ÿæ˜¯å‰æ®µæ—¶å€™æ¯”è¾ƒç«çš„å·ç§°è¦â€œå¤ç°GPT3â€çš„é‚£ä¸ªå›¢é˜Ÿï¼Œæˆ‘ä»¬åœ¨æ–‡ç« <a href="/archives/8265">ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š2ã€åšé‡‡ä¼—é•¿çš„æ—‹è½¬å¼ä½ç½®ç¼–ç ã€‹</a>ä¸­æå‡ºäº†RoPEåŠRoFormeråï¼Œæœ‰å¹¸å¾—åˆ°äº†EleutherAIå›¢é˜Ÿçš„å…³æ³¨ï¼Œä»–ä»¬åšäº†å¾ˆå¤šè¡¥å……å®éªŒï¼Œç¡®è®¤äº†RoPEæ¯”å¾ˆå¤šå…¶ä»–ä½ç½®ç¼–ç éƒ½æ›´åŠ æœ‰æ•ˆï¼ˆå‚è€ƒä»–ä»¬çš„åšå®¢<a href="https://blog.eleuther.ai/rotary-embeddings/">ã€ŠRotary Embeddings: A Relative Revolutionã€‹</a>ï¼‰ï¼Œè¿™ä¿ƒä½¿æˆ‘ä»¬å®Œæˆäº†è‹±æ–‡è®ºæ–‡<a href="https://papers.cool/arxiv/2104.09864">ã€ŠRoFormer: Enhanced Transformer with Rotary Position Embeddingã€‹</a>å¹¶æäº¤åˆ°äº†Arxivä¸Šã€‚è€Œå…³äºäºŒç»´RoPEçš„ç–‘é—®ï¼Œæœ€åˆä¹Ÿæ˜¯æ¥æºäºEleutherAIå›¢é˜Ÿã€‚</p>
<h2 id="_13">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†æˆ‘ä»¬å¯¹RoPEçš„äºŒç»´æ¨å¹¿ï¼Œä¸»è¦ä»¥â€œç›¸å¯¹æ€§â€ã€â€œå¯é€†æ€§â€ä¸ºå‡ºå‘ç‚¹æ¥ç¡®å®šäºŒç»´RoPEçš„æœ€ç»ˆå½¢å¼ï¼Œå°è¯•äº†å››å…ƒæ•°å’ŒçŸ©é˜µæŒ‡æ•°ä¸¤ç§æ¨å¯¼è¿‡ç¨‹ï¼Œæœ€ç»ˆé€šè¿‡çŸ©é˜µæŒ‡æ•°æ¥ç»™å‡ºäº†æœ€ç»ˆçš„è§£ï¼Œä»æ¨å¯¼è¿‡ç¨‹ä¸­æˆ‘ä»¬è¿˜å¯ä»¥æ·±åŒ–å¯¹RoPEçš„ç†è§£ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8397">https://spaces.ac.cn/archives/8397</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (May. 10, 2021). ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š4ã€äºŒç»´ä½ç½®çš„æ—‹è½¬å¼ä½ç½®ç¼–ç  ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8397">https://spaces.ac.cn/archives/8397</a></p>
<p>@online{kexuefm-8397,<br />
title={Transformerå‡çº§ä¹‹è·¯ï¼š4ã€äºŒç»´ä½ç½®çš„æ—‹è½¬å¼ä½ç½®ç¼–ç },<br />
author={è‹å‰‘æ—},<br />
year={2021},<br />
month={May},<br />
url={\url{https://spaces.ac.cn/archives/8397}},<br />
} </p>
<hr />
<h2 id="_14">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>TODO: æ·»åŠ è¯¦ç»†çš„æ•°å­¦å…¬å¼æ¨å¯¼å’Œæ³¨é‡Š</p>
        </div>
    </div>
</body>
</html>