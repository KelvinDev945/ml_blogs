<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€šå‘æœ€ä¼˜åˆ†å¸ƒä¹‹è·¯ï¼šæ¦‚ç‡ç©ºé—´çš„æœ€å°åŒ–</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>é€šå‘æœ€ä¼˜åˆ†å¸ƒä¹‹è·¯ï¼šæ¦‚ç‡ç©ºé—´çš„æœ€å°åŒ–</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 49.8 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10289">https://spaces.ac.cn/archives/10289</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å½“è¦æ±‚å‡½æ•°çš„æœ€å°å€¼æ—¶ï¼Œæˆ‘ä»¬é€šå¸¸ä¼šå…ˆæ±‚å¯¼å‡½æ•°ç„¶åå¯»æ‰¾å…¶é›¶ç‚¹ï¼Œæ¯”è¾ƒå¹¸è¿çš„æƒ…å†µä¸‹ï¼Œè¿™äº›é›¶ç‚¹ä¹‹ä¸€æ­£å¥½æ˜¯åŸå‡½æ•°çš„æœ€å°å€¼ç‚¹ã€‚å¦‚æœæ˜¯å‘é‡å‡½æ•°ï¼Œåˆ™å°†å¯¼æ•°æ”¹ä¸ºæ¢¯åº¦å¹¶æ±‚å…¶é›¶ç‚¹ã€‚å½“æ¢¯åº¦é›¶ç‚¹ä¸æ˜“æ±‚å¾—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¢¯åº¦ä¸‹é™æ¥é€æ¸é€¼è¿‘æœ€å°å€¼ç‚¹ã€‚</p>
<p>ä»¥ä¸Šè¿™äº›éƒ½æ˜¯æ— çº¦æŸä¼˜åŒ–çš„åŸºç¡€ç»“æœï¼Œç›¸ä¿¡ä¸å°‘è¯»è€…éƒ½æœ‰æ‰€äº†è§£ã€‚ç„¶è€Œï¼Œæœ¬æ–‡çš„ä¸»é¢˜æ˜¯æ¦‚ç‡ç©ºé—´ä¸­çš„ä¼˜åŒ–ï¼Œå³ç›®æ ‡å‡½æ•°çš„è¾“å…¥æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œè¿™ç±»ç›®æ ‡çš„ä¼˜åŒ–æ›´ä¸ºå¤æ‚ï¼Œå› ä¸ºå®ƒçš„æœç´¢ç©ºé—´ä¸å†æ˜¯æ— çº¦æŸçš„ï¼Œå¦‚æœæˆ‘ä»¬ä¾æ—§å»æ±‚è§£æ¢¯åº¦é›¶ç‚¹æˆ–è€…æ‰§è¡Œæ¢¯åº¦ä¸‹é™ï¼Œæ‰€å¾—ç»“æœæœªå¿…èƒ½ä¿è¯æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ç§æ–°çš„åˆ†æå’Œè®¡ç®—æ–¹æ³•ï¼Œä»¥ç¡®ä¿ä¼˜åŒ–ç»“æœèƒ½å¤Ÿç¬¦åˆæ¦‚ç‡åˆ†å¸ƒçš„ç‰¹æ€§ã€‚</p>
<p>å¯¹æ­¤ï¼Œç¬”è€…ä¸€ç›´ä»¥æ¥ä¹Ÿæ„Ÿåˆ°é¢‡ä¸ºå¤´ç–¼ï¼Œæ‰€ä»¥è¿‘æ¥å†³å®šâ€ç—›å®šæ€ç—›â€œï¼Œé’ˆå¯¹æ¦‚ç‡åˆ†å¸ƒçš„ä¼˜åŒ–é—®é¢˜ç³»ç»Ÿå­¦ä¹ äº†ä¸€ç•ªï¼Œæœ€åå°†å­¦ä¹ æ‰€å¾—æ•´ç†åœ¨æ­¤ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚</p>
<h2 id="_1">æ¢¯åº¦ä¸‹é™</h2>
<p>æˆ‘ä»¬å…ˆæ¥é‡æ¸©ä¸€ä¸‹æ— çº¦æŸä¼˜åŒ–çš„ç›¸å…³å†…å®¹ã€‚é¦–å…ˆï¼Œå‡è®¾æˆ‘ä»¬çš„ç›®æ ‡æ˜¯<br />
\begin{equation}\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">* = \mathop{\text{argmin}}</em>}\in\mathbb{R}^n} F(\boldsymbol{x})\end{equation<br />
é«˜ä¸­ç”Ÿéƒ½çŸ¥é“ï¼Œè¦æ±‚å‡½æ•°çš„æœ€å€¼ï¼Œå¾€å¾€å…ˆæ±‚å¯¼åœ¨è®©å®ƒç­‰äºé›¶æ¥æ‰¾æå€¼ç‚¹ï¼Œè¿™å¯¹å¾ˆå¤šäººæ¥è¯´å·²ç»æˆä¸ºâ€œå¸¸è¯†â€ã€‚ä½†è¿™é‡Œä¸å¦¨è€ƒè€ƒå„ä½è¯»è€…ï¼Œæœ‰å¤šå°‘äººèƒ½è¯æ˜è¿™ä¸ªç»“è®ºï¼Ÿæ¢å¥è¯è¯´ï¼Œå‡½æ•°çš„æœ€å€¼ä¸ºä»€ä¹ˆä¼šè·Ÿâ€œå¯¼æ•°ç­‰äºé›¶â€æ‰¯ä¸Šå…³ç³»å‘¢ï¼Ÿ</p>
<h3 id="_2">æœç´¢è§†è§’</h3>
<p>æˆ‘ä»¬å¯ä»¥ä»æœç´¢çš„è§†è§’æ¥æ¢ç©¶è¿™ä¸ªé—®é¢˜ã€‚å‡è®¾æˆ‘ä»¬å½“å‰æ‰€çŸ¥çš„$\boldsymbol{x}$ä¸º$\boldsymbol{x}<em t_eta="t+\eta">t$ï¼Œæˆ‘ä»¬æ€ä¹ˆåˆ¤æ–­$\boldsymbol{x}_t$æ˜¯ä¸æ˜¯æœ€å°å€¼ç‚¹å‘¢ï¼Ÿè¿™ä¸ªé—®é¢˜å¯ä»¥åè¿‡æ¥æ€è€ƒï¼šå¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ°$\boldsymbol{x}</em>}$ï¼Œä½¿å¾—$F(\boldsymbol{x<em t_eta="t+\eta">{t+\eta}) &lt; F(\boldsymbol{x}_t)$ï¼Œé‚£ä¹ˆ$\boldsymbol{x}_t$è‡ªç„¶å°±ä¸å¯èƒ½æ˜¯æœ€å°å€¼ç‚¹äº†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æœç´¢å¦‚ä¸‹æ ¼å¼çš„$\boldsymbol{x}</em>$ï¼š<br />
\begin{equation}\boldsymbol{x}<em t_eta="t+\eta">{t+\eta} = \boldsymbol{x}_t + \eta \boldsymbol{u}_t,\quad 0 &lt; \eta \ll 1\end{equation}<br />
å½“$F(\boldsymbol{x})$è¶³å¤Ÿå…‰æ»‘ã€$\eta$è¶³å¤Ÿå°æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºä¸€é˜¶è¿‘ä¼¼çš„ç²¾åº¦æ˜¯å¤Ÿç”¨çš„ï¼Œäºæ˜¯å¯ä»¥åˆ©ç”¨ä¸€é˜¶è¿‘ä¼¼ï¼š<br />
\begin{equation}F(\boldsymbol{x}</em>}) = F(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t + \eta \boldsymbol{u}_t) \approx F(\boldsymbol{x}_t) + \eta \boldsymbol{u}_t \cdot \nabla</em><em _boldsymbol_x="\boldsymbol{x">t}F(\boldsymbol{x}_t)\end{equation}<br />
åªè¦$\nabla</em><em _boldsymbol_x="\boldsymbol{x">t}F(\boldsymbol{x}_t)\neq 0$ï¼Œæˆ‘ä»¬æˆ‘ä»¬å°±å¯ä»¥é€‰å–$\boldsymbol{u}_t = -\nabla</em><em t_eta="t+\eta">t}F(\boldsymbol{x}_t)$ï¼Œä½¿å¾—<br />
\begin{equation}F(\boldsymbol{x}</em>}) \approx F(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t) - \eta \Vert\nabla</em><em _boldsymbol_x="\boldsymbol{x">t}F(\boldsymbol{x}_t)\Vert^2 &lt; F(\boldsymbol{x}_t)\end{equation}<br />
è¿™æ„å‘³ç€ï¼Œå¯¹äºè¶³å¤Ÿå…‰æ»‘çš„å‡½æ•°ï¼Œå®ƒçš„æœ€å°å€¼åªèƒ½åœ¨æ»¡è¶³$\nabla</em><em _boldsymbol_x="\boldsymbol{x">t}F(\boldsymbol{x}_t) = 0$çš„ç‚¹æˆ–è€…æ— ç©·è¿œå¤„å–åˆ°ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆæ±‚æœ€å€¼çš„ç¬¬ä¸€æ­¥é€šå¸¸æ˜¯â€œå¯¼æ•°ç­‰äºé›¶â€ã€‚å¦‚æœ$\nabla</em><em t_eta="t+\eta">t}F(\boldsymbol{x}_t) \neq 0$ï¼Œæˆ‘ä»¬æ€»å¯é€‰æ‹©è¶³å¤Ÿå°çš„$\eta$ï¼Œé€šè¿‡<br />
\begin{equation}\boldsymbol{x}</em>} = \boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t-\eta\nabla</em><em _boldsymbol_x="\boldsymbol{x">t}F(\boldsymbol{x}_t)\label{eq:gd}\end{equation}<br />
æ¥å¾—åˆ°è®©$f$æ›´å°çš„ç‚¹ï¼Œè¿™ä¾¿æ˜¯æ¢¯åº¦ä¸‹é™ã€‚å¦‚æœè®©$\eta\to 0$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ODEï¼š<br />
\begin{equation}\frac{d\boldsymbol{x}_t}{dt} = -\nabla</em>}_t}F(\boldsymbol{x}_t)\end{equation<br />
è¿™å°±æ˜¯<a href="/archives/9660">ã€Šæ¢¯åº¦æµï¼šæ¢ç´¢é€šå‘æœ€å°å€¼ä¹‹è·¯ã€‹</a>ä»‹ç»è¿‡çš„â€œæ¢¯åº¦æµâ€ï¼Œå®ƒå¯ä»¥è§†ä¸ºæˆ‘ä»¬ç”¨æ¢¯åº¦ä¸‹é™æœç´¢æœ€å°å€¼ç‚¹çš„è½¨è¿¹ã€‚</p>
<h3 id="_3">æŠ•å½±ä¸‹é™</h3>
<p>åˆšæ‰æˆ‘ä»¬è¯´çš„éƒ½æ˜¯æ— çº¦æŸä¼˜åŒ–ï¼Œç°åœ¨æˆ‘ä»¬æ¥ç®€å•è®¨è®ºæ¢¯åº¦ä¸‹é™åœ¨çº¦æŸä¼˜åŒ–ä¸­çš„ä¸€ä¸ªç®€å•æ¨å¹¿ã€‚å‡è®¾æˆ‘ä»¬é¢ä¸´çš„é—®é¢˜æ˜¯ï¼š<br />
\begin{equation}\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">* = \mathop{\text{argmin}}</em>}\in\mathbb{X}} F(\boldsymbol{x})\label{eq:c-loss}\end{equation<br />
å…¶ä¸­$\mathbb{X}$æ˜¯$\mathbb{R}^n$çš„ä¸€ä¸ªå­é›†ï¼Œå¦‚æœæ˜¯ç†è®ºåˆ†æï¼Œé€šå¸¸è¦ç»™$\mathbb{X}$åŠ ä¸Šâ€œæœ‰ç•Œå‡¸é›†â€çš„è¦æ±‚ï¼Œä½†å¦‚æœæ˜¯ç®€å•äº†è§£çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å…ˆä¸ç®¡è¿™äº›ç»†èŠ‚äº†ã€‚</p>
<p>å¦‚æœæ­¤æ—¶æˆ‘ä»¬ä»ç”¨æ¢¯åº¦ä¸‹é™$\eqref{eq:gd}$ï¼Œé‚£ä¹ˆæœ€å¤§çš„é—®é¢˜å°±æ˜¯æ— æ³•ä¿è¯$\boldsymbol{x}<em _mathbb_X="\mathbb{X">{t+\eta}\in\mathbb{X}$ï¼Œä½†å…¶å®æˆ‘ä»¬å¯ä»¥å¤šåŠ ä¸€æ­¥æŠ•å½±è¿ç®—<br />
\begin{equation}\Pi</em>}} (\boldsymbol{y}) = \mathop{\text{argmin}<em t_eta="t+\eta">{\boldsymbol{x}\in\mathbb{X}}\Vert\boldsymbol{x}-\boldsymbol{y}\Vert\label{eq:project}\end{equation}<br />
ä»è€Œå½¢æˆâ€œæŠ•å½±æ¢¯åº¦ä¸‹é™â€ï¼š<br />
\begin{equation}\boldsymbol{x}</em>} = \Pi_{\mathbb{X}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t-\eta\nabla</em>}_t}F(\boldsymbol{x}_t))\label{eq:pgd}\end{equation<br />
è¯´ç™½äº†ï¼ŒæŠ•å½±æ¢¯åº¦ä¸‹é™å°±æ˜¯å…ˆæ¢¯åº¦ä¸‹é™ï¼Œç„¶ååœ¨$\mathbb{X}$ä¸­æ‰¾åˆ°è·Ÿæ¢¯åº¦ä¸‹é™ç»“æœæœ€ç›¸è¿‘çš„ç‚¹ä½œä¸ºè¾“å‡ºï¼Œè¿™æ ·å°±ä¿è¯äº†è¾“å‡ºç»“æœä¸€å®šåœ¨$\mathbb{X}$å†…ã€‚åœ¨<a href="/archives/9902#åŸŸå†…æŠ•å½±">ã€Šè®©ç‚¼ä¸¹æ›´ç§‘å­¦ä¸€äº›ï¼ˆä¸€ï¼‰ï¼šSGDçš„å¹³å‡æŸå¤±æ”¶æ•›ã€‹</a>ä¸­æˆ‘ä»¬è¯æ˜äº†ï¼Œåœ¨ä¸€å®šå‡è®¾ä¸‹ï¼ŒæŠ•å½±æ¢¯åº¦ä¸‹é™å¯ä»¥æ‰¾åˆ°çº¦æŸä¼˜åŒ–é—®é¢˜$\eqref{eq:c-loss}$çš„æœ€ä¼˜è§£ã€‚</p>
<p>ä»ç»“æœæ¥çœ‹ï¼ŒæŠ•å½±æ¢¯åº¦ä¸‹é™å°†çº¦æŸä¼˜åŒ–$\eqref{eq:c-loss}$è½¬åŒ–ä¸ºäº†â€œæ¢¯åº¦ä¸‹é™+æŠ•å½±â€ä¸¤æ­¥ï¼Œè€ŒæŠ•å½±$\eqref{eq:project}$æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªçº¦æŸä¼˜åŒ–é—®é¢˜ï¼Œè™½ç„¶ä¼˜åŒ–ç›®æ ‡å·²ç»å›ºå®šäº†ï¼Œä½†ä»å±äºæœªè§£å†³çš„é—®é¢˜ï¼Œéœ€è¦å…·ä½“$\mathbb{X}$å…·ä½“åˆ†æï¼Œå› æ­¤è¿˜éœ€è¦è¿›ä¸€æ­¥æ¢ç´¢ä¸‹å»ã€‚</p>
<h2 id="_4">ç¦»æ•£åˆ†å¸ƒ</h2>
<p>æœ¬æ–‡èšç„¦äºæ¦‚ç‡ç©ºé—´ä¸­çš„ä¼˜åŒ–ï¼Œå³æœç´¢å¯¹è±¡å¿…é¡»æ˜¯ä¸€ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬å…ˆå…³æ³¨ç¦»æ•£åˆ†å¸ƒï¼Œæœç´¢ç©ºé—´æˆ‘ä»¬è®°ä¸º$\Delta^{n-1}$ï¼Œå®ƒæ˜¯å…¨ä½“$n$å…ƒç¦»æ•£å‹æ¦‚ç‡åˆ†å¸ƒçš„é›†åˆï¼Œå³<br />
\begin{equation}\Delta^{n-1} = \left\{\boldsymbol{p}=(p_1,p_2,\cdots,p_n)\left|\, p_1,p_2,\cdots,p_n\geq 0,\sum_{i=1}^n p_i = 1\right.\right\}\end{equation}<br />
æˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡åˆ™æ˜¯<br />
\begin{equation}\boldsymbol{p}<em _boldsymbol_p="\boldsymbol{p">* = \mathop{\text{argmin}}</em>}\in\Delta^{n-1}} F(\boldsymbol{p})\label{eq:p-loss}\end{equation</p>
<h3 id="_5">æ‹‰æ°ä¹˜å­</h3>
<p>å¯¹äºç­‰å¼æˆ–ä¸ç­‰å¼çº¦æŸä¸‹çš„ä¼˜åŒ–é—®é¢˜ï¼Œæ ‡å‡†æ–¹æ³•é€šå¸¸æ˜¯â€œ<a href="https://en.wikipedia.org/wiki/Lagrange_multiplier">æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•</a>â€ï¼Œå®ƒå°†çº¦æŸä¼˜åŒ–é—®é¢˜$\eqref{eq:p-loss}$è½¬åŒ–ä¸ºä¸€ä¸ªå¼±çº¦æŸçš„$\text{min-max}$é—®é¢˜ï¼š<br />
\begin{equation}\min_{\boldsymbol{p}\in\Delta^{n-1}} F(\boldsymbol{p}) = \min_{\boldsymbol{p}\in\mathbb{R}^n} \max_{\mu_i \geq 0,\lambda\in\mathbb{R}}F(\boldsymbol{p}) - \sum_{i=1}^n \mu_i p_i + \lambda\left(\sum_{i=1}^n p_i - 1\right)\label{eq:min-max}\end{equation}<br />
æ³¨æ„åœ¨è¿™ä¸ª$\text{min-max}$ä¼˜åŒ–ä¸­ï¼Œæˆ‘ä»¬å»æ‰äº†$\boldsymbol{p}\in\Delta^{n-1}$è¿™ä¸ªçº¦æŸï¼Œåªæ˜¯åœ¨$\max$è¿™ä¸€æ­¥æœ‰ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„$\mu_i \geq 0$çš„çº¦æŸã€‚æ€ä¹ˆè¯æ˜å³è¾¹çš„ä¼˜åŒ–é—®é¢˜ç­‰ä»·äºå·¦è¾¹å‘¢ï¼Ÿå…¶å®å¹¶ä¸éš¾ï¼Œåˆ†ä¸‰æ­¥æ¥ç†è§£ï¼š</p>
<blockquote>
<p>1ã€æˆ‘ä»¬å…ˆè¦ç†è§£å³ç«¯çš„$\text{min-max}$å«ä¹‰ï¼š$\min$åœ¨å·¦ï¼Œ$\max$åœ¨å³ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬æœ€ç»ˆæ˜¯è¦æ±‚ä¸€ä¸ªå°½å¯èƒ½å°çš„ç»“æœï¼Œä½†è¿™ä¸ªç›®æ ‡å‡½æ•°æ˜¯å…ˆè¦å¯¹æŸäº›å˜é‡å–$\max$ï¼›</p>
<p>2ã€å½“$p_i &lt; 0$æ˜¯ï¼Œé‚£ä¹ˆ$\max$è¿™ä¸€æ­¥å¿…ç„¶æœ‰$\mu_i\to\infty$ï¼Œæ­¤æ—¶ç»“æœç›®æ ‡å‡½æ•°å€¼æ˜¯$\infty$ï¼Œè€Œå¦‚æœ$p_i \geq 0$ï¼Œé‚£ä¹ˆ$\max$è¿™ä¸€æ­¥å°±å¿…ç„¶æœ‰$\mu_i p_i =0$ï¼Œæ­¤æ—¶ç›®æ ‡å‡½æ•°å€¼æ˜¯æœ‰é™çš„ï¼Œæ˜¾ç„¶åè€…æ›´å°ä¸€ç‚¹ï¼Œå› æ­¤å½“å³ç«¯å–æœ€ä¼˜å€¼æ—¶$p_i\geq 0$æˆç«‹ï¼ŒåŒç†æˆ‘ä»¬ä¹Ÿå¯ä»¥è¯æ˜$\sum_{i=1}^n p_i = 1$æˆç«‹ï¼›</p>
<p>3ã€ç”±ç¬¬2æ­¥çš„åˆ†æå¯çŸ¥ï¼Œå½“å³ç«¯å–æœ€ä¼˜å€¼æ—¶ï¼Œå¿…ç„¶æ»¡è¶³$\boldsymbol{p}\in\Delta^{n-1}$ï¼Œä¸”å¤šå‡ºæ¥çš„é¡¹ä¸ºé›¶ï¼Œé‚£ä¹ˆå°±ç­‰ä»·äºå·¦è¾¹çš„ä¼˜åŒ–é—®é¢˜ã€‚</p>
</blockquote>
<p>æ¥ä¸‹æ¥è¦ç”¨åˆ°ä¸€ä¸ªâ€œ<a href="https://en.wikipedia.org/wiki/Minimax_theorem">Minimaxå®šç†</a>â€ï¼š</p>
<blockquote>
<p>å¦‚æœ$\mathbb{X},\mathbb{Y}$æ˜¯ä¸¤ä¸ªå‡¸é›†ï¼Œ$\boldsymbol{x}\in\mathbb{X},\boldsymbol{y}\in\mathbb{Y}$ï¼Œå¹¶ä¸”$f(\boldsymbol{x},\boldsymbol{y})$å…³äº$\boldsymbol{x}$æ˜¯å‡¸å‡½æ•°çš„ï¼ˆå¯¹äºä»»æ„å›ºå®š$\boldsymbol{y}$ï¼‰ï¼Œå…³äº$\boldsymbol{y}$æ˜¯å‡¹å‡½æ•°çš„ï¼ˆå¯¹äºä»»æ„å›ºå®š$\boldsymbol{x}$ï¼‰ï¼Œé‚£ä¹ˆæˆç«‹ \begin{equation}\min_{\boldsymbol{x}\in\mathbb{X}}\max_{\boldsymbol{y}\in\mathbb{Y}} f(\boldsymbol{x},\boldsymbol{y}) = \max_{\boldsymbol{y}\in\mathbb{Y}}\min_{\boldsymbol{x}\in\mathbb{X}} f(\boldsymbol{x},\boldsymbol{y})\end{equation}</p>
</blockquote>
<p>Minimaxå®šç†æä¾›äº†$\min,\max$å¯äº¤æ¢çš„ä¸€ä¸ªå……åˆ†æ¡ä»¶ï¼Œè¿™é‡Œè¾¹å‡ºç°äº†ä¸€ä¸ªæ–°åè¯â€œå‡¸é›†â€ï¼ŒæŒ‡çš„æ˜¯é›†åˆå†…ä»»æ„ä¸¤ç‚¹çš„åŠ æƒå¹³å‡ï¼Œç»“æœä¾ç„¶åœ¨é›†åˆå†…ï¼Œå³<br />
\begin{equation}(1-\lambda)\boldsymbol{x}_1 + \lambda \boldsymbol{x}_2\in \mathbb{X},\qquad\forall \boldsymbol{x}_1,\boldsymbol{x}_2\in \mathbb{X},\quad\forall \lambda\in [0, 1]\end{equation}<br />
ç”±æ­¤å¯è§å‡¸é›†çš„æ¡ä»¶å¹¶ä¸æ˜¯å¤ªè‹›åˆ»ï¼Œ$\mathbb{R}^n,\Delta^{n-1}$éƒ½æ˜¯å‡¸é›†ï¼Œè¿˜æœ‰å…¨ä½“éè´Ÿæ•°ä¹Ÿæ˜¯å‡¸é›†ï¼Œç­‰ç­‰ã€‚</p>
<p>å¯¹äºå¼$\eqref{eq:min-max}$å³ç«¯çš„ç›®æ ‡å‡½æ•°ï¼Œå®ƒå…³äº$\mu_i,\lambda$æ˜¯ä¸€æ¬¡å‡½æ•°ï¼Œå› æ­¤ç¬¦åˆå…³äº$\mu_i,\lambda$æ˜¯å‡¹å‡½æ•°çš„æ¡ä»¶ï¼Œå¹¶ä¸”é™¤å¼€$F(\boldsymbol{p})$å¤–çš„é¡¹å…³äº$\boldsymbol{p}$ä¹Ÿæ˜¯ä¸€æ¬¡çš„ï¼Œæ‰€ä»¥æ•´ä¸ªç›®æ ‡å‡½æ•°å…³äº$\boldsymbol{p}$çš„å‡¸æ€§ï¼Œç­‰ä»·äº$F(\boldsymbol{p})$å…³äº$\boldsymbol{p}$çš„å‡¸æ€§ï¼Œå³å¦‚æœ$F(\boldsymbol{p})$æ˜¯å…³äº$\boldsymbol{p}$çš„å‡¸å‡½æ•°ï¼Œé‚£ä¹ˆå¼$\eqref{eq:min-max}$çš„$\min,\max$å°±å¯ä»¥äº¤æ¢ï¼š<br />
\begin{equation}\small\min_{\boldsymbol{p}\in\mathbb{R}^n} \max_{\mu_i \geq 0,\lambda\in\mathbb{R}}F(\boldsymbol{p}) - \sum_{i=1}^n \mu_i p_i + \lambda\left(\sum_{i=1}^n p_i - 1\right) = \max_{\mu_i \geq 0,\lambda\in\mathbb{R}} \min_{\boldsymbol{p}\in\mathbb{R}^n}<br />
F(\boldsymbol{p}) - \sum_{i=1}^n \mu_i p_i + \lambda\left(\sum_{i=1}^n p_i - 1\right)\end{equation}<br />
è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥å…ˆå¯¹$\boldsymbol{p}$æ±‚$\min$äº†ï¼Œè¿™æ˜¯ä¸€ä¸ªæ— çº¦æŸæœ€å°åŒ–é—®é¢˜ï¼Œå¯ä»¥é€šè¿‡æ±‚è§£æ¢¯åº¦ç­‰äºé›¶çš„æ–¹ç¨‹ç»„æ¥å®Œæˆï¼Œç»“æœå°†å¸¦æœ‰å‚æ•°$\lambda$å’Œ$\mu_i$ï¼Œæœ€åé€šè¿‡$p_i \geq 0$ã€$\mu_i p_i = 0$å’Œ$\sum_{i=1}^n p_i = 1$æ¥ç¡®å®šè¿™äº›å‚æ•°ã€‚</p>
<h3 id="_6">å‡¸é›†æœç´¢</h3>
<p>ç„¶è€Œï¼Œå°½ç®¡æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•è¢«è§†ä¸ºæ±‚è§£çº¦æŸä¼˜åŒ–é—®é¢˜çš„æ ‡å‡†æ–¹æ³•ï¼Œä½†å®ƒå¹¶ä¸ç®—ç›´è§‚ï¼Œè€Œä¸”å®ƒåªèƒ½é€šè¿‡è§£æ–¹ç¨‹æ¥æ±‚å¾—ç²¾ç¡®è§£ï¼Œå¹¶ä¸èƒ½å¯¼å‡ºç±»ä¼¼æ¢¯åº¦ä¸‹é™çš„è¿­ä»£é€¼è¿‘ç®—æ³•ï¼Œå› æ­¤æˆ‘ä»¬ä¸èƒ½æ»¡è¶³äºæ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ã€‚</p>
<p>ä»æœç´¢çš„è§†è§’çœ‹ï¼Œæ±‚è§£æ¦‚ç‡ç©ºé—´ä¸­çš„ä¼˜åŒ–é—®é¢˜çš„å…³é”®ï¼Œæ˜¯ä¿è¯åœ¨æœç´¢è¿‡ç¨‹ä¸­è¯•æ¢ç‚¹éƒ½åœ¨é›†åˆ$\Delta^{n-1}$å†…ã€‚æ¢å¥è¯è¯´ï¼Œå‡è®¾å½“å‰æ¦‚ç‡åˆ†å¸ƒä¸º$\boldsymbol{p}<em t_eta="t+\eta">t\in \Delta^{n-1}$ï¼Œæˆ‘ä»¬æ€ä¹ˆæ„é€ ä¸‹ä¸€ä¸ªè¯•æ¢ç‚¹$\boldsymbol{p}</em>}$å‘¢ï¼Ÿå®ƒæœ‰ä¸¤ä¸ªè¦æ±‚ï¼Œä¸€æ˜¯$\boldsymbol{p<em t_eta="t+\eta">{t+\eta}\in \Delta^{n-1}$ï¼ŒäºŒæ˜¯å¯ä»¥é€šè¿‡æ§åˆ¶$\eta$çš„å¤§å°æ¥æ§åˆ¶å®ƒè·Ÿ$\boldsymbol{p}_t$çš„æ¥è¿‘ç¨‹åº¦ã€‚è¿™æ—¶å€™$\Delta^{n-1}$çš„â€œå‡¸é›†â€æ€§è´¨å°±æ´¾ä¸Šç”¨åœºäº†ï¼Œåˆ©ç”¨è¿™ä¸€æ€§è´¨æˆ‘ä»¬å¯ä»¥å°†$\boldsymbol{p}</em>$å®šä¸º<br />
\begin{equation}\boldsymbol{p}<em t_eta="t+\eta">{t+\eta} = (1-\eta)\boldsymbol{p}_t + \eta \boldsymbol{q}_t,\quad \boldsymbol{q}_t\in \Delta^{n-1}\end{equation}<br />
é‚£ä¹ˆæœ‰<br />
\begin{equation}F(\boldsymbol{p}</em>}) = F((1-\eta)\boldsymbol{p<em _boldsymbol_p="\boldsymbol{p">t + \eta \boldsymbol{q}_t) \approx F(\boldsymbol{p}_t) + \eta(\boldsymbol{q}_t - \boldsymbol{p}_t)\cdot\nabla</em><em _boldsymbol_q="\boldsymbol{q">t} F(\boldsymbol{p}_t)\end{equation}<br />
å‡è®¾ä¸€é˜¶è¿‘ä¼¼çš„ç²¾åº¦è¶³å¤Ÿï¼Œé‚£ä¹ˆè¦è·å¾—ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼Œå°±ç›¸å½“äºæ±‚è§£<br />
\begin{equation}\mathop{\text{argmin}}</em><em _boldsymbol_p="\boldsymbol{p">t\in\Delta^{n-1}}\,\boldsymbol{q}_t\cdot\nabla</em><em _boldsymbol_p="\boldsymbol{p">t} F(\boldsymbol{p}_t) \end{equation}<br />
è¿™ä¸ªç›®æ ‡å‡½æ•°å€’æ˜¯å¾ˆç®€å•ï¼Œç­”æ¡ˆæ˜¯<br />
\begin{equation}\boldsymbol{q}_t = \text{onehot}(\text{argmin}(\nabla</em><em _boldsymbol_p="\boldsymbol{p">t} F(\boldsymbol{p}_t)))\end{equation}<br />
è¿™é‡Œ$\nabla</em><em _boldsymbol_p="\boldsymbol{p">t} F(\boldsymbol{p}_t)$æ˜¯ä¸€ä¸ªå‘é‡ï¼Œå¯¹ä¸€ä¸ªå‘é‡åš$\text{argmin}$æŒ‡çš„æ˜¯æ‰¾å‡ºæœ€å°åˆ†é‡çš„ä½ç½®ã€‚æ‰€ä»¥ï¼Œä¸Šå¼ä¹Ÿå°±æ˜¯è¯´$\boldsymbol{q}_t$æ˜¯ä¸€ä¸ªone hotåˆ†å¸ƒï¼Œå…¶ä¸­$1$æ‰€åœ¨çš„ä½ç½®ï¼Œå°±æ˜¯æ¢¯åº¦$\nabla</em>_t)$æœ€å°çš„åˆ†é‡æ‰€åœ¨çš„ä½ç½®ã€‚}_t} F(\boldsymbol{p</p>
<p>ç”±æ­¤å¯è§ï¼Œæ¦‚ç‡ç©ºé—´çš„æ¢¯åº¦ä¸‹é™å½¢å¼æ˜¯<br />
\begin{equation}\boldsymbol{p}<em _boldsymbol_p="\boldsymbol{p">{t+\eta} = (1 - \eta)\boldsymbol{p}_t + \eta\, \text{onehot}(\text{argmin}(\nabla</em><em _boldsymbol_p="\boldsymbol{p">t} F(\boldsymbol{p}_t)))\end{equation}<br />
ä»¥åŠ$\boldsymbol{p}_t$æ˜¯$F(\boldsymbol{p}_t)$æå°å€¼ç‚¹çš„æ¡ä»¶æ˜¯ï¼š<br />
\begin{equation}\boldsymbol{p}_t\cdot\nabla</em><em _boldsymbol_p="\boldsymbol{p">t} F(\boldsymbol{p}_t) = (\nabla</em><em _min="\min">t} F(\boldsymbol{p}_t))</em>}\label{eq:p-min}\end{equation<br />
è¿™é‡Œå¯¹å‘é‡çš„$\min$æ˜¯æŒ‡è¿”å›æœ€å°çš„é‚£ä¸ªåˆ†é‡ã€‚</p>
<h3 id="_7">ä¸€ä¸ªä¾‹å­</h3>
<p>ä»¥<a href="/archives/10145">ã€Šé€šå‘æ¦‚ç‡åˆ†å¸ƒä¹‹è·¯ï¼šç›˜ç‚¹SoftmaxåŠå…¶æ›¿ä»£å“ã€‹</a>ä»‹ç»çš„Sparsemaxä¸ºä¾‹ï¼Œå®ƒçš„åŸå§‹å®šä¹‰ä¸º<br />
\begin{equation}Sparsemax(\boldsymbol{x}) = \mathop{\text{argmin}}\limits_{\boldsymbol{p}\in\Delta^{n-1}}\Vert \boldsymbol{p} - \boldsymbol{x}\Vert^2\end{equation}<br />
å…¶ä¸­$\boldsymbol{x}\in\mathbb{R}^n$ã€‚ä¸éš¾å‘ç°ï¼Œä»å‰é¢æŠ•å½±æ¢¯åº¦ä¸‹é™çš„è§’åº¦æ¥çœ‹ï¼ŒSparsemaxæ­£å¥½æ˜¯ä»$\mathbb{R}^n$åˆ°$\Delta^{n-1}$çš„â€œæŠ•å½±â€æ“ä½œã€‚</p>
<p>æˆ‘ä»¬è®°$F(\boldsymbol{p})=\Vert \boldsymbol{p} - \boldsymbol{x}\Vert^2$ï¼Œå®ƒå¯¹$\boldsymbol{p}$çš„æ¢¯åº¦æ˜¯$2(\boldsymbol{p} - \boldsymbol{x})$ï¼Œæ‰€ä»¥æ ¹æ®å¼$\eqref{eq:p-min}$ï¼Œæå°å€¼ç‚¹æ»¡è¶³çš„æ–¹ç¨‹å°±æ˜¯<br />
\begin{equation}\boldsymbol{p}\cdot(\boldsymbol{p}-\boldsymbol{x}) = (\boldsymbol{p}-\boldsymbol{x})_{\min}\end{equation}<br />
æˆ‘ä»¬çº¦å®š$x_i = x_j\Leftrightarrow p_i = p_j$ï¼Œè¿™é‡Œæ²¡æœ‰åŠ ç²—çš„ä¸‹æ ‡å¦‚$p_i$è¡¨ç¤ºå‘é‡$\boldsymbol{p}$çš„ç¬¬$i$ä¸ªåˆ†é‡ï¼ˆå³æ˜¯ä¸€ä¸ªæ ‡é‡ï¼‰ï¼Œå‰ä¸€èŠ‚åŠ ç²—çš„ä¸‹æ ‡å¦‚$\boldsymbol{p}_t$è¡¨ç¤º$\boldsymbol{p}$çš„ç¬¬$t$æ¬¡è¿­ä»£ç»“æœï¼ˆå³è¿˜æ˜¯ä¸€ä¸ªå‘é‡ï¼‰ï¼Œè¯·è¯»è€…ç»†å¿ƒåŒºåˆ†ã€‚</p>
<p>åœ¨è¯¥çº¦å®šä¸‹ï¼Œç”±ä¸Šå¼å¯ä»¥å¾—åˆ°<br />
\begin{equation}p_i &gt; 0 \quad \Leftrightarrow \quad p_i-x_i = (\boldsymbol{p}-\boldsymbol{x})<em _min="\min">{\min}\end{equation}<br />
å› ä¸º$\boldsymbol{p}$å¯ä»¥ç”±$\boldsymbol{x}$ç¡®å®šï¼Œæ‰€ä»¥$(\boldsymbol{p}-\boldsymbol{x})</em>) &lt; 0$ã€‚åŸºäºè¿™ä¸¤ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç»Ÿä¸€è®°}$æ˜¯$\boldsymbol{x}$çš„å‡½æ•°ï¼Œæˆ‘ä»¬è®°ä¸º$-\lambda(\boldsymbol{x})$ï¼Œé‚£ä¹ˆ$p_i = x_i - \lambda(\boldsymbol{x})$ï¼Œä½†è¿™åªæ˜¯å¯¹äº$p_i &gt; 0$æˆç«‹ï¼Œå¯¹äº$p_i=0$ï¼Œæˆ‘ä»¬æœ‰$p_i-x_i &gt; (\boldsymbol{p}-\boldsymbol{x})_{\min}$ï¼Œå³$x_i - \lambda(\boldsymbol{x<br />
\begin{equation}p_i = \text{relu}(x_i - \lambda(\boldsymbol{x}))\end{equation}<br />
å…¶ä¸­$\lambda(\boldsymbol{x})$ç”±$\boldsymbol{p}$çš„å„åˆ†é‡ä¹‹å’Œä¸º1æ¥ç¡®å®šï¼Œå…¶ä»–ç»†èŠ‚å†…å®¹è¯·å‚è€ƒ<a href="/archives/10145">ã€Šé€šå‘æ¦‚ç‡åˆ†å¸ƒä¹‹è·¯ï¼šç›˜ç‚¹SoftmaxåŠå…¶æ›¿ä»£å“ã€‹</a>ã€‚</p>
<h2 id="_8">è¿ç»­åˆ†å¸ƒ</h2>
<p>è¯´å®Œç¦»æ•£åˆ†å¸ƒï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è½¬åˆ°è¿ç»­åˆ†å¸ƒäº†ã€‚çœ‹ä¸Šå»è¿ç»­å‹åˆ†å¸ƒåªæ˜¯ç¦»æ•£å‹åˆ†å¸ƒçš„æé™ç‰ˆæœ¬ï¼Œç»“æœä¼¼ä¹ä¸åº”è¯¥æœ‰å¤ªå¤§å·®åˆ«ï¼Œä½†äº‹å®ä¸Šå®ƒä»¬ä¹‹é—´çš„ç‰¹æ€§æœ‰ç€æœ¬è´¨ä¸åŒï¼Œä»¥è‡³äºæˆ‘ä»¬éœ€è¦ä¸ºè¿ç»­åˆ†å¸ƒæ„å»ºå…¨æ–°çš„æ–¹æ³•è®ºã€‚</p>
<h3 id="_9">ç›®æ ‡æ³›å‡½</h3>
<p>é¦–å…ˆæˆ‘ä»¬æ¥è¯´è¯´ç›®æ ‡å‡½æ•°ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œæè¿°è¿ç»­å‹åˆ†å¸ƒçš„æ–¹å¼æ˜¯æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œæ‰€ä»¥æ­¤æ—¶ç›®æ ‡å‡½æ•°çš„è¾“å…¥æ˜¯ä¸€ä¸ªæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œè€Œæ­¤æ—¶çš„ç›®æ ‡å‡½æ•°å…¶å®ä¹Ÿä¸æ˜¯æ™®é€šçš„å‡½æ•°äº†ï¼Œæˆ‘ä»¬é€šå¸¸ç§°ä¹‹ä¸ºâ€œæ³›å‡½â€â€”â€”ä»ä¸€æ•´ä¸ªå‡½æ•°åˆ°ä¸€ä¸ªæ ‡é‡çš„æ˜ å°„ã€‚æ¢è¨€ä¹‹ï¼Œæˆ‘ä»¬éœ€è¦å¯»æ‰¾ä¸€ä¸ªæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œä½¿å¾—æŸä¸ªç›®æ ‡æ³›å‡½æœ€å°åŒ–ã€‚</p>
<p>å°½ç®¡å¾ˆå¤šäººè§‰å¾—â€œæ³›å‡½åˆ†æå¿ƒçŠ¯å¯’â€ï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬å¤§éƒ¨ä»½äººéƒ½æ¥è§¦è¿‡æ³›å‡½ï¼Œå› ä¸ºæ»¡è¶³â€œè¾“å…¥å‡½æ•°ï¼Œè¾“å‡ºæ ‡é‡â€çš„æ˜ å°„å¤ªå¤šäº†ï¼Œæ¯”å¦‚å®šç§¯åˆ†<br />
\begin{equation}\mathcal{I}[f]\triangleq \int_a^b f(x) dx\end{equation}<br />
å°±æ˜¯ä¸€ä¸ªå‡½æ•°åˆ°æ ‡é‡çš„æ˜ å°„ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ˜¯æ³›å‡½ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬åœ¨å®é™…åº”ç”¨ä¸­ä¼šé‡åˆ°çš„æ³›å‡½ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯ç”±å®šç§¯åˆ†æ„å»ºå‡ºæ¥çš„ï¼Œæ¯”å¦‚æ¦‚ç‡åˆ†å¸ƒçš„KLæ•£åº¦ï¼š<br />
\begin{equation}\mathcal{KL}[p\Vert q] = \int p(\boldsymbol{x})\log \frac{p(\boldsymbol{x})}{q(\boldsymbol{x})}d\boldsymbol{x}\end{equation}<br />
å…¶ä¸­ç§¯åˆ†é»˜è®¤åœ¨å…¨ç©ºé—´ï¼ˆæ•´ä¸ª$\mathbb{R}^n$ï¼‰è¿›è¡Œã€‚æ›´ä¸€èˆ¬çš„æ³›å‡½çš„è¢«ç§¯å‡½æ•°é‡Œè¾¹å¯èƒ½è¿˜åŒ…å«å¯¼æ•°é¡¹ï¼Œå¦‚ç†è®ºç‰©ç†ä¸­çš„æœ€å°ä½œç”¨é‡ï¼š<br />
\begin{equation}\mathcal{A}[x] = \int_{t_a}^{t_b} L(x(t),x'(t),t)dt\end{equation}</p>
<p>è€Œæ¥ä¸‹æ¥æˆ‘ä»¬è¦æœ€å°åŒ–çš„ç›®æ ‡æ³›å‡½ï¼Œåˆ™å¯ä»¥ä¸€èˆ¬åœ°å†™æˆ<br />
\begin{equation}\mathcal{F}[p] = \int F(p(\boldsymbol{x}))d\boldsymbol{x}\end{equation}<br />
æ–¹ä¾¿èµ·è§ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰æ³›å‡½å¯¼æ•°<br />
\begin{equation}\frac{\delta\mathcal{F}[p]}{\delta p}(\boldsymbol{x}) = \frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\end{equation}</p>
<h3 id="_10">ç´§æ”¯æ’‘é›†</h3>
<p>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªè¿ç»­å‹æ¦‚ç‡ç©ºé—´çš„è®°å·ï¼Œå®ƒçš„åŸºæœ¬å®šä¹‰æ˜¯<br />
\begin{equation}\mathbb{P} = \left\{p(\boldsymbol{x}) \,\Bigg|\, p(\boldsymbol{x})\geq 0(\forall\boldsymbol{x}\in\mathbb{R}^n),\int p(\boldsymbol{x})d\boldsymbol{x} = 1\right\}\end{equation}<br />
ä¸éš¾è¯æ˜ï¼Œå¦‚æœæ¦‚ç‡å¯†åº¦å‡½æ•°$p(\boldsymbol{x})$çš„æé™$\lim_{\Vert\boldsymbol{x}\Vert\to\infty} p(\boldsymbol{x})$å­˜åœ¨ï¼Œé‚£ä¹ˆå¿…ç„¶æœ‰$\lim_{\Vert\boldsymbol{x}\Vert\to\infty} p(\boldsymbol{x}) = 0$ï¼Œè¿™ä¹Ÿæ˜¯åé¢çš„è¯æ˜ä¸­è¦ç”¨åˆ°çš„ä¸€ä¸ªæ€§è´¨ã€‚</p>
<p>ç„¶è€Œï¼Œå¯ä»¥ä¸¾ä¾‹è¯æ˜çš„æ˜¯ï¼Œå¹¶éæ‰€æœ‰æ¦‚ç‡å¯†åº¦å‡½æ•°åœ¨æ— ç©·è¿œå¤„éƒ½å­˜åœ¨æé™ã€‚ä¸ºäº†é¿å…ç†è®ºä¸Šçš„å›°éš¾ï¼Œæˆ‘ä»¬é€šå¸¸åœ¨ç†è®ºè¯æ˜æ—¶å‡è®¾$p(\boldsymbol{x})$çš„æ”¯æ’‘é›†æ˜¯ç´§é›†ã€‚è¿™é‡Œè¾¹åˆæœ‰ä¸¤ä¸ªæ¦‚å¿µï¼š<strong>æ”¯æ’‘é›†ï¼ˆSupportï¼‰</strong> å’Œ<strong>ç´§é›†ï¼ˆCompact Setï¼‰</strong> ï¼Œ <em>æ”¯æ’‘é›†</em> æŒ‡çš„æ˜¯è®©$p(\boldsymbol{x}) &gt; 0$çš„å…¨ä½“$\boldsymbol{x}$çš„é›†åˆï¼Œå³<br />
\begin{equation}\text{supp}(p) = \{\boldsymbol{x} | p(\boldsymbol{x}) &gt; 0\}\end{equation}<br />
<em>ç´§é›†</em> çš„ä¸€èˆ¬å®šä¹‰æ¯”è¾ƒå¤æ‚ï¼Œä¸è¿‡åœ¨$\mathbb{R}^n$ä¸­ï¼Œç´§é›†ç­‰ä»·äºæœ‰ç•Œé—­é›†ã€‚æ‰€ä»¥è¯´ç™½äº†ï¼Œ$p(\boldsymbol{x})$çš„æ”¯æ’‘é›†æ˜¯ç´§é›†çš„å‡è®¾ï¼Œç›´æ¥ä½œç”¨æ˜¯è®©$p(\boldsymbol{x})$å…·æœ‰â€œå­˜åœ¨å¸¸æ•°$C$ï¼Œä½¿å¾—$\forall |\boldsymbol{x}| &gt; C$éƒ½æœ‰$p(\boldsymbol{x}) = 0$â€çš„æ€§è´¨ï¼Œç®€åŒ–äº†$p(\boldsymbol{x})$åœ¨æ— ç©·è¿œå¤„çš„æ€§æ€ï¼Œä»æ ¹æœ¬ä¸Šé¿å…äº†$\lim_{\Vert\boldsymbol{x}\Vert\to\infty} p(\boldsymbol{x}) = 0$çš„è®¨è®ºã€‚</p>
<p>ä»ç†è®ºä¸Šæ¥çœ‹ï¼Œè¿™ä¸ªå‡è®¾æ˜¯éå¸¸å¼ºçš„ï¼Œå®ƒç”šè‡³æ’é™¤äº†åƒæ­£æ€åˆ†å¸ƒè¿™æ ·çš„ç®€å•åˆ†å¸ƒï¼ˆæ­£æ€åˆ†å¸ƒçš„æ”¯æ’‘é›†æ˜¯$\mathbb{R}^n$ï¼‰ã€‚ä¸è¿‡ï¼Œä»å®è·µä¸Šæ¥è¯´ï¼Œè¿™ä¸ªå‡è®¾å¹¶ä¸ç®—ç¦»è°±ï¼Œå› ä¸ºæˆ‘ä»¬è¯´äº†å¦‚æœæé™$\lim_{\Vert\boldsymbol{x}\Vert\to\infty} p(\boldsymbol{x})$å­˜åœ¨å°±å¿…ç„¶ä¸ºé›¶ï¼Œå› æ­¤åœ¨è¶…å‡ºä¸€å®šèŒƒå›´åå®ƒå°±è·Ÿç­‰äºé›¶æ²¡æœ‰å¤ªå¤§åŒºåˆ«äº†ã€‚æé™ä¸å­˜åœ¨çš„ä¾‹å­ç¡®å®æœ‰ï¼Œä½†ä¸€èˆ¬éƒ½éœ€è¦æ¯”è¾ƒåˆ»æ„æ„é€ ï¼Œå¯¹äºæˆ‘ä»¬å®é™…èƒ½é‡åˆ°çš„æ•°æ®ï¼ŒåŸºæœ¬ä¸Šéƒ½æ»¡è¶³æé™å­˜åœ¨çš„æ¡ä»¶ã€‚</p>
<h3 id="_11">æ—§è·¯ä¸é€š</h3>
<p>ç›´è§‰ä¸Šï¼Œè¿ç»­åˆ†å¸ƒçš„ä¼˜åŒ–åº”è¯¥æ˜¯ç…§æ¬ç¦»æ•£åˆ†å¸ƒçš„æ€è·¯ï¼Œå³è®¾$\boldsymbol{p}<em t_eta="t+\eta">{t+\eta}(\boldsymbol{x}) = (1 - \eta)\boldsymbol{p}_t(\boldsymbol{x}) + \eta \boldsymbol{q}_t(\boldsymbol{x})$ï¼Œå› ä¸ºè·Ÿç¦»æ•£åˆ†å¸ƒä¸€æ ·ï¼Œè¿ç»­åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°é›†$\mathbb{P}$åŒæ ·æ˜¯ä¸€ä¸ªå‡¸é›†ã€‚ç°åœ¨æˆ‘ä»¬å°†å®ƒä»£å…¥ç›®æ ‡æ³›å‡½<br />
\begin{equation}\begin{aligned}<br />
\mathcal{F}[p</em> \\\}] =&amp;\, \int F(p_{t+\eta}(\boldsymbol{x}))d\boldsymbol{x<br />
=&amp;\, \int F((1 - \eta)\boldsymbol{p}<em _mathbb_P="\mathbb{P" q_t_in="q_t\in">t(\boldsymbol{x}) + \eta \boldsymbol{q}_t(\boldsymbol{x}))d\boldsymbol{x} \\\<br />
\approx&amp;\,\int \left[F(p_t(\boldsymbol{x})) + \eta\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\Big(q_t(\boldsymbol{x}) - p_t(\boldsymbol{x})\Big)\right]d\boldsymbol{x}<br />
\end{aligned}\end{equation}<br />
å‡è®¾ä¸€é˜¶è¿‘ä¼¼å¤Ÿç”¨ï¼Œé‚£ä¹ˆé—®é¢˜è½¬åŒ–ä¸º<br />
\begin{equation}\mathop{\text{argmin}}</em>}}\int\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}q_t(\boldsymbol{x})d\boldsymbol{x}\end{equation<br />
è¿™ä¸ªé—®é¢˜å€’ä¹Ÿæ˜¯ä¸éš¾è§£ï¼Œç­”æ¡ˆè·Ÿç¦»æ•£åˆ†å¸ƒçš„one hotç±»ä¼¼<br />
\begin{equation}q_t(\boldsymbol{x}) = \delta\left(\boldsymbol{x} - \mathop{\text{argmin}}_{\boldsymbol{x}'} \frac{\partial F(p_t(\boldsymbol{x}'))}{\partial p_t(\boldsymbol{x}')}\right)\end{equation}<br />
è¿™é‡Œçš„$\delta(\cdot)$æ˜¯<a href="/archives/1870">ç‹„æ‹‰å…‹deltaå‡½æ•°</a>ï¼Œè¡¨ç¤ºå•ç‚¹åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦ã€‚</p>
<p>çœ‹ä¸Šå»å¾ˆé¡ºåˆ©ï¼Œç„¶è€Œå®é™…ä¸Šæ­¤è·¯å¹¶ä¸é€šã€‚é¦–å…ˆï¼Œç‹„æ‹‰å…‹deltaå‡½æ•°å¹¶ä¸æ˜¯å¸¸è§„æ„ä¹‰ä¸‹çš„å‡½æ•°ï¼Œå®ƒæ˜¯å¹¿ä¹‰å‡½æ•°ï¼ˆä¹Ÿæ˜¯æ³›å‡½çš„ä¸€ç§ï¼‰ï¼›å…¶æ¬¡ï¼Œå¦‚æœæˆ‘ä»¬ç”¨æ™®é€šå‡½æ•°çš„è§†è§’å»çœ‹çš„è¯ï¼Œç‹„æ‹‰å…‹deltaå‡½æ•°åœ¨æŸç‚¹å¤„å…·æœ‰æ— ç©·å¤§çš„å€¼ï¼Œè€Œæ—¢ç„¶æ˜¯æ— ç©·å¤§çš„å€¼ï¼Œé‚£ä¹ˆæ¨å¯¼è¿‡ç¨‹ä¸­çš„â€œä¸€é˜¶è¿‘ä¼¼å¤Ÿç”¨â€çš„å‡è®¾å°±ä¸å¯èƒ½æˆç«‹äº†ã€‚</p>
<h3 id="_12">å˜é‡ä»£æ¢</h3>
<p>æˆ‘ä»¬å¯ä»¥è€ƒè™‘ç»§ç»­å¯¹ä¸Šä¸€èŠ‚çš„æ¨å¯¼åšä¸€äº›ä¿®è¡¥ï¼Œæ¯”å¦‚åŠ ä¸Š$q_t(\boldsymbol{x}) \leq C$çš„é™åˆ¶ï¼Œä»¥è·å¾—æœ‰æ„ä¹‰çš„ç»“æœï¼Œç„¶è€Œè¿™ç§ç¼ç¼è¡¥è¡¥çš„åšæ³•ç»ˆç©¶æ˜¾å¾—ä¸å¤Ÿä¼˜é›…ã€‚å¯æ˜¯å¦‚æœä¸åˆ©ç”¨å‡¸é›†çš„æ€§è´¨ï¼Œåˆè¯¥å¦‚ä½•æ„å»ºä¸‹ä¸€æ­¥çš„è¯•æ¢åˆ†å¸ƒ$\boldsymbol{p}_{t+\eta}(\boldsymbol{x})$å‘¢ï¼Ÿ</p>
<p>è¿™æ—¶å€™å°±è¦å……åˆ†å‘æŒ¥æ¦‚ç‡å¯†åº¦å‡½æ•°çš„ç‰¹æ€§äº†â€”â€”æˆ‘ä»¬å¯ä»¥é€šè¿‡å˜é‡ä»£æ¢ï¼Œæ¥å°†ä¸€ä¸ªæ¦‚ç‡å¯†åº¦å‡½æ•°å˜æ¢ä¸ºå¦ä¸€ä¸ªæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œè¿™æ˜¯è¿ç»­å‹åˆ†å¸ƒçš„ç‹¬æœ‰æ€§è´¨ã€‚å…·ä½“æ¥è¯´ï¼Œå¦‚æœ$p(\boldsymbol{x})$æ˜¯ä¸€ä¸ªæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œ$\boldsymbol{y}=\boldsymbol{T}(\boldsymbol{x})$æ˜¯ä¸€ä¸ªå¯é€†å˜æ¢ï¼Œé‚£ä¹ˆ$p(\boldsymbol{T}(\boldsymbol{x}))\left|\frac{\partial \boldsymbol{T}(\boldsymbol{x})}{\partial\boldsymbol{x}}\right|$åŒæ ·æ˜¯ä¸€ä¸ªæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œå…¶ä¸­$|\cdot|$è¡¨ç¤ºçŸ©é˜µçš„è¡Œåˆ—å¼ç»å¯¹å€¼ã€‚</p>
<p>åŸºäºè¿™ä¸ªç‰¹æ€§ï¼Œæˆ‘ä»¬å°†ä¸‹ä¸€æ­¥è¦è¯•æ¢çš„æ¦‚ç‡åˆ†å¸ƒå®šä¹‰ä¸º<br />
\begin{equation}\begin{aligned}<br />
p_{t+\eta}(\boldsymbol{x}) =&amp;\, p_t(\boldsymbol{x} + \eta\boldsymbol{\mu}<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x}))\left|\boldsymbol{I} + \eta\frac{\partial \boldsymbol{\mu}_t(\boldsymbol{x})}{\partial\boldsymbol{x}}\right| \\\<br />
\approx &amp;\, \Big[p_t(\boldsymbol{x}) + \eta\boldsymbol{\mu}_t(\boldsymbol{x})\cdot\nabla</em>}} p_t(\boldsymbol{x})\Big]\left[1 + \eta\,\text{Tr}\frac{\partial \boldsymbol{\mu<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x})}{\partial\boldsymbol{x}}\right] \\\[3pt]<br />
\approx &amp;\, p_t(\boldsymbol{x}) + \eta\boldsymbol{\mu}_t(\boldsymbol{x})\cdot\nabla</em>}} p_t(\boldsymbol{x}) + \eta\, p_t(\boldsymbol{x})\nabla_{\boldsymbol{x}}\cdot\boldsymbol{\mu<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x}) \\\[5pt]<br />
= &amp;\, p_t(\boldsymbol{x}) + \eta\nabla</em>)\big] \\\}}\cdot\big[p_t(\boldsymbol{x})\boldsymbol{\mu}_t(\boldsymbol{x<br />
\end{aligned}\end{equation}<br />
åŒæ ·çš„ç»“æœæˆ‘ä»¬åœ¨<a href="/archives/9280">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåäºŒï¼‰ï¼šâ€œç¡¬åˆšâ€æ‰©æ•£ODEã€‹</a>å·²ç»æ¨å¯¼è¿‡ï¼Œå…¶ä¸­è¡Œåˆ—å¼çš„è¿‘ä¼¼å±•å¼€ï¼Œå¯ä»¥å‚è€ƒ<a href="/archives/2383">ã€Šè¡Œåˆ—å¼çš„å¯¼æ•°ã€‹</a>ä¸€æ–‡ã€‚</p>
<h3 id="_13">ç§¯åˆ†å˜æ¢</h3>
<p>åˆ©ç”¨è¿™ä¸ªæ–°çš„$p_{t+\eta}(\boldsymbol{x})$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
\mathcal{F}[p_{t+\eta}] =&amp;\, \int F(p_{t+\eta}(\boldsymbol{x}))d\boldsymbol{x} \\\<br />
\approx&amp;\, \int F\Big(p_t(\boldsymbol{x}) + \eta\nabla_{\boldsymbol{x}}\cdot\big[p_t(\boldsymbol{x})\boldsymbol{\mu}<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x})\big]\Big)d\boldsymbol{x} \\\<br />
\approx&amp;\, \int \left[F(p_t(\boldsymbol{x})) + \eta\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\nabla</em>}}\cdot\big[p_t(\boldsymbol{x})\boldsymbol{\mu<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x})\big]\right]d\boldsymbol{x} \\\<br />
=&amp;\, \mathcal{F}[p_t] + \eta\int \frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\nabla</em>}}\cdot\big[p_t(\boldsymbol{x})\boldsymbol{\mu<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x})\big] d\boldsymbol{x} \\\<br />
\end{aligned}\label{eq:px-approx}\end{equation}<br />
æ¥ä¸‹æ¥éœ€è¦åƒ<a href="/archives/9461">ã€Šæµ‹è¯•å‡½æ•°æ³•æ¨å¯¼è¿ç»­æ€§æ–¹ç¨‹å’ŒFokker-Planckæ–¹ç¨‹ã€‹</a>ä¸€æ ·ï¼Œæ¨å¯¼ä¸€ä¸ªæ¦‚ç‡å¯†åº¦ç›¸å…³çš„ç§¯åˆ†æ’ç­‰å¼ã€‚é¦–å…ˆæˆ‘ä»¬æœ‰<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\int \nabla</em>}}\cdot\left[\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})} p_t(\boldsymbol{x})\boldsymbol{\mu<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x})\right] d\boldsymbol{x} \\\[5pt]<br />
=&amp;\, \int \frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\nabla</em>}}\cdot\big[p_t(\boldsymbol{x})\boldsymbol{\mu<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x})\big] d\boldsymbol{x} + \int \left(\nabla</em>}}\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\right)\cdot\big[p_t(\boldsymbol{x})\boldsymbol{\mu<em _Omega="\Omega">t(\boldsymbol{x})\big] d\boldsymbol{x}<br />
\end{aligned}\end{equation}<br />
æ ¹æ®<a href="https://en.wikipedia.org/wiki/Divergence_theorem">æ•£åº¦å®šç†</a>ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\int</em>} \nabla_{\boldsymbol{x}}\cdot\left[\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})} p_t(\boldsymbol{x})\boldsymbol{\mu<em _partial_Omega="\partial\Omega">t(\boldsymbol{x})\right] d\boldsymbol{x} = \int</em>} \left[\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})} p_t(\boldsymbol{x})\boldsymbol{\mu<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x})\right]\cdot \hat{\boldsymbol{n}} dS\end{equation}<br />
å…¶ä¸­$\Omega$æ˜¯ç§¯åˆ†åŒºåŸŸï¼Œåœ¨è¿™é‡Œæ˜¯æ•´ä¸ª$\mathbb{R}^n$ï¼Œ$\partial\Omega$æ˜¯åŒºåŸŸè¾¹ç•Œï¼Œ$\mathbb{R}^n$çš„è¾¹ç•Œè‡ªç„¶æ˜¯æ— ç©·è¿œå¤„ï¼Œ$\hat{\boldsymbol{n}}$æ˜¯è¾¹ç•Œçš„å¤–å‘å•ä½æ³•å‘é‡ï¼Œ$dS$æ˜¯é¢ç§¯å¾®å…ƒã€‚åœ¨ç´§æ”¯æ’‘é›†çš„å‡è®¾ä¸‹ï¼Œæ— ç©·è¿œå¤„$p_t(\boldsymbol{x})=0$ï¼Œæ‰€ä»¥ä¸Šå¼å³ç«¯å®é™…ä¸Šå°±æ˜¯é›¶çš„ç§¯åˆ†ï¼Œç»“æœæ˜¯é›¶ã€‚å› æ­¤æˆ‘ä»¬æœ‰<br />
\begin{equation}\int \frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\nabla</em>}}\cdot\big[p_t(\boldsymbol{x})\boldsymbol{\mu<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x})\big] d\boldsymbol{x} = - \int \left(\nabla</em>}}\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\right)\cdot\big[p_t(\boldsymbol{x})\boldsymbol{\mu<em t_eta="t+\eta">t(\boldsymbol{x})\big] d\boldsymbol{x}\end{equation}<br />
ä»£å…¥å¼$\eqref{eq:px-approx}$å¾—åˆ°<br />
\begin{equation}\mathcal{F}[p</em>}] \approx \mathcal{F}[p_t] - \eta\int \left(p_t(\boldsymbol{x})\nabla_{\boldsymbol{x}}\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\right)\cdot \boldsymbol{\mu}_t(\boldsymbol{x}) d\boldsymbol{x} \label{eq:px-approx-2}\end{equation</p>
<h3 id="_14">æ¢¯åº¦ä¹‹æµ</h3>
<p>æ ¹æ®å¼$\eqref{eq:px-approx-2}$ï¼Œè®©$\mathcal{F}[p_{t+\eta}] \leq \mathcal{F}[p_t]$çš„ä¸€ä¸ªç®€å•é€‰æ‹©æ˜¯<br />
\begin{equation}\boldsymbol{\mu}<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x}) = \nabla</em>}}\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\end{equation<br />
ç›¸åº”çš„è¿­ä»£æ ¼å¼æ˜¯<br />
\begin{equation}p_{t+\eta}(\boldsymbol{x}) \approx p_t(\boldsymbol{x}) + \eta\nabla_{\boldsymbol{x}}\cdot\left[p_t(\boldsymbol{x})\nabla_{\boldsymbol{x}}\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\right] \end{equation}<br />
æˆ‘ä»¬è¿˜å¯ä»¥å–$\eta\to 0$çš„æé™å¾—<br />
\begin{equation}\frac{\partial}{\partial t}p_t(\boldsymbol{x}) = \nabla_{\boldsymbol{x}}\cdot\left[p_t(\boldsymbol{x})\nabla_{\boldsymbol{x}}\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\right] \end{equation}<br />
æˆ–è€…ç®€å†™æˆ<br />
\begin{equation}\frac{\partial p_t}{\partial t} = \nabla\cdot\left[p_t\nabla\frac{\delta \mathcal{F}[p_t]}{\delta p_t}\right] \end{equation}<br />
è¿™å°±æ˜¯<a href="/archives/9660">ã€Šæ¢¯åº¦æµï¼šæ¢ç´¢é€šå‘æœ€å°å€¼ä¹‹è·¯ã€‹</a>ä»‹ç»è¿‡çš„Wassersteinæ¢¯åº¦æµï¼Œä½†è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰å¼•å…¥Wassersteinè·ç¦»çš„æ¦‚å¿µä¹Ÿå¾—åˆ°äº†ç›¸åŒçš„ç»“æœã€‚</p>
<p>ç”±äº$p_{t+\eta}(\boldsymbol{x})$æ˜¯$p_t(\boldsymbol{x})$é€šè¿‡å˜æ¢$\boldsymbol{x}\to \boldsymbol{x} + \eta \boldsymbol{\mu}<em t_eta="t+\eta">t(\boldsymbol{x})$å¾—åˆ°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜å¯ä»¥å†™å‡º$\boldsymbol{x}$çš„è¿åŠ¨è½¨è¿¹ODEï¼š<br />
\begin{equation}\boldsymbol{x}_t = \boldsymbol{x}</em>} + \eta \boldsymbol{\mu<em t_eta="t+\eta">t(\boldsymbol{x}</em>})\quad\Rightarrow\quad \frac{d\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t}{dt} = -\boldsymbol{\mu}_t(\boldsymbol{x}_t) = -\nabla</em>}}\frac{\partial F(p_t(\boldsymbol{x}))}{\partial p_t(\boldsymbol{x})}\end{equation<br />
è¿™ä¸ªODEçš„æ„ä¹‰æ˜¯ï¼Œä»åˆ†å¸ƒ$p_0(\boldsymbol{x})$çš„é‡‡æ ·ç»“æœ$\boldsymbol{x}_0$å‡ºå‘ï¼ŒæŒ‰ç…§æ­¤ODEè¿åŠ¨åˆ°$\boldsymbol{x}_t$æ—¶ï¼Œ$\boldsymbol{x}_t$æ‰€æœä»çš„åˆ†å¸ƒæ­£æ˜¯$p_t(\boldsymbol{x})$ã€‚</p>
<h2 id="_15">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ç³»ç»Ÿæ•´ç†äº†æ¦‚ç‡ç©ºé—´ä¸­ç›®æ ‡å‡½æ•°çš„æœ€å°åŒ–æ–¹æ³•ï¼ŒåŒ…æ‹¬å–åˆ°æå°å€¼çš„å¿…è¦æ¡ä»¶ã€ç±»ä¼¼æ¢¯åº¦ä¸‹é™çš„è¿­ä»£æ³•ç­‰å†…å®¹ï¼Œç›¸å…³ç»“æœåœ¨æœ€ä¼˜åŒ–ã€ç”Ÿæˆæ¨¡å‹ï¼ˆå°¤å…¶æ˜¯æ‰©æ•£æ¨¡å‹ï¼‰ç­‰åœºæ™¯ä¸­æ—¶æœ‰ç”¨åˆ°ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10289">https://spaces.ac.cn/archives/10289</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Aug. 06, 2024). ã€Šé€šå‘æœ€ä¼˜åˆ†å¸ƒä¹‹è·¯ï¼šæ¦‚ç‡ç©ºé—´çš„æœ€å°åŒ– ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10289">https://spaces.ac.cn/archives/10289</a></p>
<p>@online{kexuefm-10289,<br />
title={é€šå‘æœ€ä¼˜åˆ†å¸ƒä¹‹è·¯ï¼šæ¦‚ç‡ç©ºé—´çš„æœ€å°åŒ–},<br />
author={è‹å‰‘æ—},<br />
year={2024},<br />
month={Aug},<br />
url={\url{https://spaces.ac.cn/archives/10289}},<br />
} </p>
<hr />
<h2 id="_16">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚æä¾›æå…¶è¯¦ç»†çš„æ•°å­¦æ¨å¯¼ï¼Œæ·±å…¥æ¢è®¨æ¦‚ç‡ç©ºé—´ä¸­çš„ä¼˜åŒ–ç†è®ºï¼ŒåŒ…æ‹¬Wassersteinæ¢¯åº¦æµã€æœ€ä¼˜ä¼ è¾“ã€f-æ•£åº¦ç­‰æ ¸å¿ƒæ¦‚å¿µã€‚</p>
<h3 id="1">1. æ¦‚ç‡ç©ºé—´çš„æ•°å­¦å®šä¹‰</h3>
<p><strong>æ¨å¯¼1ï¼šæ¦‚ç‡æµ‹åº¦ç©ºé—´</strong></p>
<p>è®¾ $(\mathcal{X}, \mathcal{B}, \mu)$ æ˜¯ä¸€ä¸ªæµ‹åº¦ç©ºé—´ï¼Œå…¶ä¸­ï¼š
- $\mathcal{X}$ æ˜¯æ ·æœ¬ç©ºé—´ï¼ˆé€šå¸¸å– $\mathbb{R}^n$ï¼‰
- $\mathcal{B}$ æ˜¯ $\sigma$-ä»£æ•°ï¼ˆBorelé›†ï¼‰
- $\mu$ æ˜¯æ¦‚ç‡æµ‹åº¦ï¼Œæ»¡è¶³ $\mu(\mathcal{X}) = 1$</p>
<p><strong>æ¨å¯¼2ï¼šæ¦‚ç‡å¯†åº¦å‡½æ•°</strong></p>
<p>å¯¹äºè¿ç»­å‹åˆ†å¸ƒï¼Œå­˜åœ¨å¯†åº¦å‡½æ•° $p:\mathcal{X}\to\mathbb{R}_+$ ä½¿å¾—ï¼š</p>
<p>$$
\mu(A) = \int_A p(\boldsymbol{x})d\boldsymbol{x}, \quad \forall A \in \mathcal{B}
$$</p>
<p>å¹¶ä¸”æ»¡è¶³å½’ä¸€åŒ–æ¡ä»¶ï¼š</p>
<p>$$
\int_{\mathcal{X}} p(\boldsymbol{x})d\boldsymbol{x} = 1
$$</p>
<p><strong>æ³¨é‡Š1</strong>ï¼šæ¦‚ç‡å¯†åº¦å‡½æ•° $p(\boldsymbol{x})$ å¿…é¡»éè´Ÿä¸”ç§¯åˆ†ä¸º1ï¼Œè¿™ä¸¤ä¸ªçº¦æŸä½¿å¾—ä¼˜åŒ–é—®é¢˜å˜å¾—å¤æ‚ã€‚</p>
<p><strong>æ¨å¯¼3ï¼šæ¦‚ç‡ç©ºé—´çš„æ‹“æ‰‘ç»“æ„</strong></p>
<p>å®šä¹‰æ¦‚ç‡æµ‹åº¦ç©ºé—´ $\mathcal{P}(\mathcal{X})$ ä¸º $\mathcal{X}$ ä¸Šæ‰€æœ‰æ¦‚ç‡æµ‹åº¦çš„é›†åˆã€‚è¿™æ˜¯ä¸€ä¸ªæ— ç©·ç»´ç©ºé—´ï¼Œéœ€è¦åˆé€‚çš„åº¦é‡ï¼ˆmetricï¼‰æ¥å®šä¹‰"è·ç¦»"ã€‚</p>
<h3 id="2">2. æ³›å‡½ä¸æ³›å‡½å¯¼æ•°</h3>
<p><strong>æ¨å¯¼4ï¼šèƒ½é‡æ³›å‡½çš„å®šä¹‰</strong></p>
<p>è€ƒè™‘å½¢å¦‚ä¸‹å¼çš„èƒ½é‡æ³›å‡½ï¼š</p>
<p>$$
\mathcal{F}[p] = \int_{\mathcal{X}} F(p(\boldsymbol{x}), \boldsymbol{x})d\boldsymbol{x}
$$</p>
<p>å¸¸è§ä¾‹å­ï¼š</p>
<ol>
<li>KLæ•£åº¦ï¼š$\mathcal{F}[p] = \int p(\boldsymbol{x})\log p(\boldsymbol{x})d\boldsymbol{x}$</li>
<li>åŠ¿èƒ½ï¼š$\mathcal{F}[p] = \int p(\boldsymbol{x})V(\boldsymbol{x})d\boldsymbol{x}$</li>
<li>äº¤äº’èƒ½ï¼š$\mathcal{F}[p] = \iint p(\boldsymbol{x})p(\boldsymbol{y})W(\boldsymbol{x},\boldsymbol{y})d\boldsymbol{x}d\boldsymbol{y}$</li>
</ol>
<p><strong>æ¨å¯¼5ï¼šæ³›å‡½å¯¼æ•°çš„å®šä¹‰</strong></p>
<p>æ³›å‡½ $\mathcal{F}[p]$ åœ¨ $p$ å¤„æ²¿æ–¹å‘ $h$ çš„Gateauxå¯¼æ•°å®šä¹‰ä¸ºï¼š</p>
<p>$$
\frac{d}{d\epsilon}\mathcal{F}[p+\epsilon h]\bigg|_{\epsilon=0} = \int \frac{\delta\mathcal{F}}{\delta p}(\boldsymbol{x})h(\boldsymbol{x})d\boldsymbol{x}
$$</p>
<p>å…¶ä¸­ $\frac{\delta\mathcal{F}}{\delta p}$ ç§°ä¸ºæ³›å‡½å¯¼æ•°ã€‚</p>
<p><strong>æ¨å¯¼6ï¼šç®€å•æ³›å‡½çš„æ³›å‡½å¯¼æ•°</strong></p>
<p>å¯¹äº $\mathcal{F}[p] = \int F(p(\boldsymbol{x}))d\boldsymbol{x}$ï¼š</p>
<p>$$
\begin{aligned}
\frac{d}{d\epsilon}\mathcal{F}[p+\epsilon h]\bigg|_{\epsilon=0} &= \frac{d}{d\epsilon}\int F(p(\boldsymbol{x})+\epsilon h(\boldsymbol{x}))d\boldsymbol{x}\bigg|_{\epsilon=0} \\
&= \int \frac{\partial F}{\partial p}(p(\boldsymbol{x}))h(\boldsymbol{x})d\boldsymbol{x}
\end{aligned}
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
\frac{\delta\mathcal{F}}{\delta p}(\boldsymbol{x}) = \frac{\partial F}{\partial p}(p(\boldsymbol{x}))
$$</p>
<p><strong>æ³¨é‡Š2</strong>ï¼šæ³›å‡½å¯¼æ•°å¯ä»¥ç†è§£ä¸ºæ— ç©·ç»´ç©ºé—´ä¸­çš„"æ¢¯åº¦"ã€‚</p>
<h3 id="3-kl">3. KLæ•£åº¦çš„å˜åˆ†æ¨å¯¼</h3>
<p><strong>æ¨å¯¼7ï¼šKLæ•£åº¦çš„å®šä¹‰</strong></p>
<p>ç»™å®šå‚è€ƒåˆ†å¸ƒ $q(\boldsymbol{x})$ï¼ŒKLæ•£åº¦å®šä¹‰ä¸ºï¼š</p>
<p>$$
\text{KL}[p\|q] = \int p(\boldsymbol{x})\log\frac{p(\boldsymbol{x})}{q(\boldsymbol{x})}d\boldsymbol{x}
$$</p>
<p><strong>æ¨å¯¼8ï¼šKLæ•£åº¦çš„åˆ†è§£</strong></p>
<p>$$
\begin{aligned}
\text{KL}[p\|q] &= \int p(\boldsymbol{x})\log p(\boldsymbol{x})d\boldsymbol{x} - \int p(\boldsymbol{x})\log q(\boldsymbol{x})d\boldsymbol{x} \\
&= H[p] + \mathbb{E}_p[-\log q(\boldsymbol{x})]
\end{aligned}
$$</p>
<p>å…¶ä¸­ $H[p] = -\int p(\boldsymbol{x})\log p(\boldsymbol{x})d\boldsymbol{x}$ æ˜¯ç†µã€‚</p>
<p><strong>æ¨å¯¼9ï¼šKLæ•£åº¦çš„æ³›å‡½å¯¼æ•°</strong></p>
<p>è®¡ç®— $\frac{\delta}{\delta p}\text{KL}[p|q]$ï¼š</p>
<p>$$
\begin{aligned}
\frac{d}{d\epsilon}\text{KL}[p+\epsilon h\|q]\bigg|_{\epsilon=0} &= \frac{d}{d\epsilon}\int (p+\epsilon h)\log\frac{p+\epsilon h}{q}d\boldsymbol{x}\bigg|_{\epsilon=0} \\
&= \int h\log\frac{p}{q}d\boldsymbol{x} + \int p\cdot\frac{1}{p}\cdot h d\boldsymbol{x} \\
&= \int h\left(\log\frac{p}{q}+1\right)d\boldsymbol{x}
\end{aligned}
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
\frac{\delta\text{KL}[p\|q]}{\delta p} = \log\frac{p(\boldsymbol{x})}{q(\boldsymbol{x})} + 1
$$</p>
<p><strong>æ¨å¯¼10ï¼šæœ€å°åŒ–KLæ•£åº¦</strong></p>
<p>è€ƒè™‘çº¦æŸä¼˜åŒ–é—®é¢˜ï¼š</p>
<p>$$
\min_p \text{KL}[p\|q], \quad \text{s.t. } \int p(\boldsymbol{x})d\boldsymbol{x} = 1
$$</p>
<p>ä½¿ç”¨æ‹‰æ ¼æœ—æ—¥ä¹˜å­ $\lambda$ï¼š</p>
<p>$$
\mathcal{L}[p] = \text{KL}[p\|q] + \lambda\left(\int p(\boldsymbol{x})d\boldsymbol{x} - 1\right)
$$</p>
<p>ä»¤æ³›å‡½å¯¼æ•°ä¸ºé›¶ï¼š</p>
<p>$$
\frac{\delta\mathcal{L}}{\delta p} = \log\frac{p(\boldsymbol{x})}{q(\boldsymbol{x})} + 1 + \lambda = 0
$$</p>
<p>è§£å¾—ï¼š</p>
<p>$$
p^*(\boldsymbol{x}) = q(\boldsymbol{x})e^{-1-\lambda}
$$</p>
<p>ç”±å½’ä¸€åŒ–æ¡ä»¶ $\int p^<em>(\boldsymbol{x})d\boldsymbol{x} = 1$ å¾— $e^{-1-\lambda} = 1$ï¼Œå› æ­¤ $p^</em>(\boldsymbol{x}) = q(\boldsymbol{x})$ã€‚</p>
<p><strong>æ³¨é‡Š3</strong>ï¼šKLæ•£åº¦åœ¨ $p=q$ æ—¶è¾¾åˆ°æœ€å°å€¼0ï¼Œè¿™éªŒè¯äº†æˆ‘ä»¬çš„æ¨å¯¼ã€‚</p>
<h3 id="4-f-">4. f-æ•£åº¦çš„ä¸€èˆ¬æ¡†æ¶</h3>
<p><strong>æ¨å¯¼11ï¼šf-æ•£åº¦çš„å®šä¹‰</strong></p>
<p>ç»™å®šå‡¸å‡½æ•° $f:\mathbb{R}_+ \to \mathbb{R}$ æ»¡è¶³ $f(1)=0$ï¼Œf-æ•£åº¦å®šä¹‰ä¸ºï¼š</p>
<p>$$
D_f[p\|q] = \int q(\boldsymbol{x})f\left(\frac{p(\boldsymbol{x})}{q(\boldsymbol{x})}\right)d\boldsymbol{x}
$$</p>
<p><strong>æ¨å¯¼12ï¼šå¸¸è§f-æ•£åº¦çš„ä¾‹å­</strong></p>
<ol>
<li>
<p><strong>KLæ•£åº¦</strong>ï¼š$f(t) = t\log t$
   $$D_f[p\|q] = \int q \cdot \frac{p}{q}\log\frac{p}{q}d\boldsymbol{x} = \text{KL}[p\|q]$$</p>
</li>
<li>
<p><strong>åå‘KLæ•£åº¦</strong>ï¼š$f(t) = -\log t$
   $$D_f[p\|q] = \int q(-\log\frac{p}{q})d\boldsymbol{x} = \text{KL}[q\|p]$$</p>
</li>
<li>
<p><strong>$\chi^2$æ•£åº¦</strong>ï¼š$f(t) = (t-1)^2$
   $$D_f[p\|q] = \int q\left(\frac{p}{q}-1\right)^2d\boldsymbol{x} = \int\frac{(p-q)^2}{q}d\boldsymbol{x}$$</p>
</li>
<li>
<p><strong>Hellingerè·ç¦»</strong>ï¼š$f(t) = (\sqrt{t}-1)^2$
   $$D_f[p\|q] = \int q(\sqrt{p/q}-1)^2d\boldsymbol{x} = \int(\sqrt{p}-\sqrt{q})^2d\boldsymbol{x}$$</p>
</li>
</ol>
<p><strong>æ¨å¯¼13ï¼šf-æ•£åº¦çš„æ³›å‡½å¯¼æ•°</strong></p>
<p>$$
\begin{aligned}
\frac{d}{d\epsilon}D_f[p+\epsilon h\|q]\bigg|_{\epsilon=0} &= \frac{d}{d\epsilon}\int q f\left(\frac{p+\epsilon h}{q}\right)d\boldsymbol{x}\bigg|_{\epsilon=0} \\
&= \int q \cdot f'\left(\frac{p}{q}\right)\cdot\frac{h}{q}d\boldsymbol{x} \\
&= \int f'\left(\frac{p(\boldsymbol{x})}{q(\boldsymbol{x})}\right)h(\boldsymbol{x})d\boldsymbol{x}
\end{aligned}
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
\frac{\delta D_f[p\|q]}{\delta p}(\boldsymbol{x}) = f'\left(\frac{p(\boldsymbol{x})}{q(\boldsymbol{x})}\right)
$$</p>
<h3 id="5-wasserstein">5. Wassersteinè·ç¦»ä¸æœ€ä¼˜ä¼ è¾“</h3>
<p><strong>æ¨å¯¼14ï¼šWasserstein-2è·ç¦»çš„å®šä¹‰</strong></p>
<p>è®¾ $p, q$ æ˜¯ $\mathbb{R}^n$ ä¸Šçš„ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒï¼ŒWasserstein-2è·ç¦»å®šä¹‰ä¸ºï¼š</p>
<p>$$
W_2^2(p, q) = \inf_{\gamma \in \Gamma(p,q)} \int\int \|\boldsymbol{x}-\boldsymbol{y}\|^2 d\gamma(\boldsymbol{x},\boldsymbol{y})
$$</p>
<p>å…¶ä¸­ $\Gamma(p,q)$ æ˜¯è¾¹é™…åˆ†å¸ƒä¸º $p$ å’Œ $q$ çš„æ‰€æœ‰è”åˆåˆ†å¸ƒçš„é›†åˆã€‚</p>
<p><strong>æ³¨é‡Š4</strong>ï¼š$\gamma(\boldsymbol{x},\boldsymbol{y})$ ç§°ä¸ºä¼ è¾“è®¡åˆ’ï¼ˆtransport planï¼‰ï¼Œæè¿°äº†å¦‚ä½•å°†è´¨é‡ä» $\boldsymbol{x}$ ç§»åŠ¨åˆ° $\boldsymbol{y}$ã€‚</p>
<p><strong>æ¨å¯¼15ï¼šKantorovichå¯¹å¶å½¢å¼</strong></p>
<p>Wassersteinè·ç¦»æœ‰å¯¹å¶è¡¨ç¤ºï¼š</p>
<p>$$
W_2^2(p,q) = \sup_{\phi,\psi} \left\{\int \phi(\boldsymbol{x})dp(\boldsymbol{x}) + \int \psi(\boldsymbol{y})dq(\boldsymbol{y})\right\}
$$</p>
<p>å…¶ä¸­ä¸Šç¡®ç•Œå–éæ»¡è¶³ $\phi(\boldsymbol{x}) + \psi(\boldsymbol{y}) \leq |\boldsymbol{x}-\boldsymbol{y}|^2$ çš„å‡½æ•°å¯¹ã€‚</p>
<p><strong>æ¨å¯¼16ï¼šBrenierå®šç†ï¼ˆæœ€ä¼˜ä¼ è¾“æ˜ å°„ï¼‰</strong></p>
<p>åœ¨åˆé€‚çš„æ¡ä»¶ä¸‹ï¼Œå­˜åœ¨å”¯ä¸€çš„æœ€ä¼˜ä¼ è¾“æ˜ å°„ $T:\mathbb{R}^n\to\mathbb{R}^n$ ä½¿å¾—ï¼š</p>
<p>$$
T_\#p = q
$$</p>
<p>å³ $q(\boldsymbol{y}) = \int \delta(\boldsymbol{y}-T(\boldsymbol{x}))p(\boldsymbol{x})d\boldsymbol{x}$ï¼Œä¸” $T$ æ˜¯æŸä¸ªå‡¸å‡½æ•°çš„æ¢¯åº¦ï¼š</p>
<p>$$
T(\boldsymbol{x}) = \nabla\phi(\boldsymbol{x})
$$</p>
<p><strong>æ¨å¯¼17ï¼šWassersteinè·ç¦»çš„ä¸€é˜¶å˜åˆ†</strong></p>
<p>è€ƒè™‘åˆ†å¸ƒæ— $p_t$ï¼Œå…¶Wasserstein-2è·ç¦»å…³äº $t$ çš„å¯¼æ•°ï¼š</p>
<p>$$
\frac{d}{dt}W_2^2(p_t, q) = -2\int (\boldsymbol{x}-T_t(\boldsymbol{x}))\cdot\boldsymbol{v}_t(\boldsymbol{x})p_t(\boldsymbol{x})d\boldsymbol{x}
$$</p>
<p>å…¶ä¸­ $\boldsymbol{v}_t$ æ˜¯é€Ÿåº¦åœºï¼Œ$T_t$ æ˜¯ä» $p_t$ åˆ° $q$ çš„æœ€ä¼˜ä¼ è¾“æ˜ å°„ã€‚</p>
<h3 id="6-wasserstein">6. Wassersteinæ¢¯åº¦æµçš„è¯¦ç»†æ¨å¯¼</h3>
<p><strong>æ¨å¯¼18ï¼šæ¢¯åº¦æµçš„åŸºæœ¬æ¦‚å¿µ</strong></p>
<p>åœ¨æ¬§æ°ç©ºé—´ä¸­ï¼Œæ¢¯åº¦æµå®šä¹‰ä¸ºï¼š</p>
<p>$$
\frac{d\boldsymbol{x}}{dt} = -\nabla_{\boldsymbol{x}} E(\boldsymbol{x})
$$</p>
<p>åœ¨æ¦‚ç‡ç©ºé—´ä¸­ï¼Œæˆ‘ä»¬éœ€è¦å®šä¹‰æ¦‚ç‡åˆ†å¸ƒçš„"æ¢¯åº¦"ã€‚</p>
<p><strong>æ¨å¯¼19ï¼šè¿ç»­æ€§æ–¹ç¨‹</strong></p>
<p>è®¾ç²’å­æŒ‰é€Ÿåº¦åœº $\boldsymbol{v}_t(\boldsymbol{x})$ è¿åŠ¨ï¼Œå¯†åº¦ $p_t(\boldsymbol{x})$ æ»¡è¶³è¿ç»­æ€§æ–¹ç¨‹ï¼š</p>
<p>$$
\frac{\partial p_t}{\partial t} + \nabla \cdot (p_t \boldsymbol{v}_t) = 0
$$</p>
<p><strong>æ³¨é‡Š5</strong>ï¼šè¿™æ˜¯è´¨é‡å®ˆæ’çš„æ•°å­¦è¡¨è¾¾â€”â€”å¯†åº¦çš„å˜åŒ–ç­‰äºæµé‡çš„æ•£åº¦ã€‚</p>
<p><strong>æ¨å¯¼20ï¼šWassersteinæ¢¯åº¦çš„å®šä¹‰</strong></p>
<p>æ³›å‡½ $\mathcal{F}[p]$ çš„Wassersteinæ¢¯åº¦å®šä¹‰ä¸ºæ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„å‘é‡åœº $\nabla_W\mathcal{F}[p]$ï¼š</p>
<p>$$
\frac{d}{dt}\mathcal{F}[p_t]\bigg|_{t=0} = -\int \|\nabla_W\mathcal{F}[p](\boldsymbol{x})\|^2 p(\boldsymbol{x})d\boldsymbol{x}
$$</p>
<p>å½“ $p_t$ æ²¿é€Ÿåº¦åœº $\boldsymbol{v}_t = -\nabla_W\mathcal{F}[p_t]$ æ¼”åŒ–æ—¶ã€‚</p>
<p><strong>æ¨å¯¼21ï¼šç®€å•æ³›å‡½çš„Wassersteinæ¢¯åº¦</strong></p>
<p>å¯¹äº $\mathcal{F}[p] = \int F(p(\boldsymbol{x}))d\boldsymbol{x}$ï¼š</p>
<p>$$
\begin{aligned}
\frac{d\mathcal{F}[p_t]}{dt} &= \int \frac{\partial F}{\partial p}\frac{\partial p_t}{\partial t}d\boldsymbol{x} \\
&= -\int \frac{\partial F}{\partial p}\nabla\cdot(p_t\boldsymbol{v}_t)d\boldsymbol{x} \\
&= \int \nabla\left(\frac{\partial F}{\partial p}\right)\cdot(p_t\boldsymbol{v}_t)d\boldsymbol{x} \quad \text{(åˆ†éƒ¨ç§¯åˆ†)} \\
&= \int p_t\nabla\left(\frac{\partial F}{\partial p}\right)\cdot\boldsymbol{v}_td\boldsymbol{x}
\end{aligned}
$$</p>
<p><strong>æ¨å¯¼22ï¼šåŒ–ç®€ä¸ºæ ‡å‡†å½¢å¼</strong></p>
<p>è¦ä½¿ä¸Šå¼ç­‰äº $-\int p_t|\boldsymbol{v}_t|^2d\boldsymbol{x}$ï¼Œéœ€è¦ï¼š</p>
<p>$$
\boldsymbol{v}_t = -\nabla\left(\frac{\partial F}{\partial p}\right) = -\nabla\frac{\delta\mathcal{F}}{\delta p}
$$</p>
<p>å› æ­¤Wassersteinæ¢¯åº¦ä¸ºï¼š</p>
<p>$$
\nabla_W\mathcal{F}[p](\boldsymbol{x}) = \nabla_{\boldsymbol{x}}\frac{\delta\mathcal{F}}{\delta p}(\boldsymbol{x})
$$</p>
<p><strong>æ¨å¯¼23ï¼šWassersteinæ¢¯åº¦æµæ–¹ç¨‹</strong></p>
<p>å°†è¿ç»­æ€§æ–¹ç¨‹å’Œé€Ÿåº¦åœºç»“åˆï¼š</p>
<p>$$
\frac{\partial p_t}{\partial t} = \nabla \cdot \left(p_t\nabla\frac{\delta\mathcal{F}}{\delta p_t}\right)
$$</p>
<p>è¿™å°±æ˜¯Wassersteinæ¢¯åº¦æµçš„ä¸€èˆ¬å½¢å¼ã€‚</p>
<h3 id="7-fokker-planck">7. Fokker-Planckæ–¹ç¨‹</h3>
<p><strong>æ¨å¯¼24ï¼šéšæœºå¾®åˆ†æ–¹ç¨‹ï¼ˆSDEï¼‰</strong></p>
<p>è€ƒè™‘ç²’å­çš„éšæœºè¿åŠ¨ï¼š</p>
<p>$$
d\boldsymbol{X}_t = \boldsymbol{b}(\boldsymbol{X}_t, t)dt + \boldsymbol{\sigma}(\boldsymbol{X}_t, t)d\boldsymbol{W}_t
$$</p>
<p>å…¶ä¸­ $\boldsymbol{b}$ æ˜¯æ¼‚ç§»é¡¹ï¼Œ$\boldsymbol{\sigma}$ æ˜¯æ‰©æ•£é¡¹ï¼Œ$\boldsymbol{W}_t$ æ˜¯Wienerè¿‡ç¨‹ã€‚</p>
<p><strong>æ¨å¯¼25ï¼šFokker-Planckæ–¹ç¨‹çš„æ¨å¯¼</strong></p>
<p>ç²’å­å¯†åº¦ $p_t(\boldsymbol{x})$ çš„æ¼”åŒ–æ»¡è¶³Fokker-Planckæ–¹ç¨‹ï¼š</p>
<p>$$
\frac{\partial p_t}{\partial t} = -\nabla \cdot (\boldsymbol{b}p_t) + \frac{1}{2}\sum_{i,j}\frac{\partial^2}{\partial x_i\partial x_j}(D_{ij}p_t)
$$</p>
<p>å…¶ä¸­ $\boldsymbol{D} = \boldsymbol{\sigma}\boldsymbol{\sigma}^T$ æ˜¯æ‰©æ•£çŸ©é˜µã€‚</p>
<p><strong>æ¨å¯¼26ï¼šå¸¸æ•°æ‰©æ•£çš„ç®€åŒ–</strong></p>
<p>å½“ $\boldsymbol{\sigma} = \sqrt{2}\boldsymbol{I}$ æ—¶ï¼š</p>
<p>$$
\frac{\partial p_t}{\partial t} = -\nabla \cdot (\boldsymbol{b}p_t) + \Delta p_t
$$</p>
<p>å…¶ä¸­ $\Delta = \sum_i \frac{\partial^2}{\partial x_i^2}$ æ˜¯æ‹‰æ™®æ‹‰æ–¯ç®—å­ã€‚</p>
<p><strong>æ¨å¯¼27ï¼šæ¢¯åº¦æµå½¢å¼</strong></p>
<p>å–æ¼‚ç§»é¡¹ $\boldsymbol{b} = -\nabla V$ï¼š</p>
<p>$$
\frac{\partial p_t}{\partial t} = \nabla \cdot (p_t\nabla V) + \Delta p_t = \nabla \cdot \left(p_t\nabla V + \nabla p_t\right)
$$</p>
<p>è¿›ä¸€æ­¥ï¼š</p>
<p>$$
\frac{\partial p_t}{\partial t} = \nabla \cdot \left(p_t\nabla(V + \log p_t)\right)
$$</p>
<p><strong>æ³¨é‡Š6</strong>ï¼šè¿™æ­£æ˜¯è‡ªç”±èƒ½ $\mathcal{F}[p] = \int p(V+\log p)d\boldsymbol{x}$ çš„Wassersteinæ¢¯åº¦æµï¼</p>
<p><strong>æ¨å¯¼28ï¼šç¨³æ€åˆ†å¸ƒ</strong></p>
<p>ç¨³æ€æ—¶ $\frac{\partial p}{\partial t} = 0$ï¼Œè¦æ±‚ï¼š</p>
<p>$$
p\nabla(V+\log p) = 0
$$</p>
<p>è§£å¾—ï¼š</p>
<p>$$
p^*(\boldsymbol{x}) = \frac{e^{-V(\boldsymbol{x})}}{Z}, \quad Z = \int e^{-V(\boldsymbol{y})}d\boldsymbol{y}
$$</p>
<p>è¿™æ˜¯Boltzmannåˆ†å¸ƒã€‚</p>
<h3 id="8-jkoeuler">8. JKOæ ¼å¼ï¼ˆéšå¼Eulerç¦»æ•£åŒ–ï¼‰</h3>
<p><strong>æ¨å¯¼29ï¼šæ—¶é—´ç¦»æ•£åŒ–</strong></p>
<p>å°†Wassersteinæ¢¯åº¦æµç¦»æ•£åŒ–ï¼Œæ—¶é—´æ­¥é•¿ä¸º $\tau$ï¼š</p>
<p>$$
\frac{p_{k+1} - p_k}{\tau} \approx -\nabla_W\mathcal{F}[p_{k+1}]
$$</p>
<p><strong>æ¨å¯¼30ï¼šJKOæ ¼å¼çš„æ¨å¯¼</strong></p>
<p>ä¸Šå¼ç­‰ä»·äºä¼˜åŒ–é—®é¢˜ï¼š</p>
<p>$$
p_{k+1} = \arg\min_p \left\{\mathcal{F}[p] + \frac{1}{2\tau}W_2^2(p, p_k)\right\}
$$</p>
<p><strong>æ³¨é‡Š7</strong>ï¼šè¿™ä¸ªæ ¼å¼ç”±Jordan-Kinderlehrer-Ottoæå‡ºï¼Œæ˜¯æ•°å€¼æ±‚è§£Wassersteinæ¢¯åº¦æµçš„æ ‡å‡†æ–¹æ³•ã€‚</p>
<p><strong>æ¨å¯¼31ï¼šèƒ½é‡è¡°å‡æ€§è´¨</strong></p>
<p>å®šä¹‰ç¦»æ•£èƒ½é‡ï¼š</p>
<p>$$
\mathcal{E}_k = \mathcal{F}[p_k]
$$</p>
<p>æ ¹æ®JKOæ ¼å¼çš„å®šä¹‰ï¼š</p>
<p>$$
\mathcal{F}[p_{k+1}] + \frac{1}{2\tau}W_2^2(p_{k+1}, p_k) \leq \mathcal{F}[p_k]
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
\mathcal{E}_{k+1} \leq \mathcal{E}_k - \frac{1}{2\tau}W_2^2(p_{k+1}, p_k)
$$</p>
<p>èƒ½é‡å•è°ƒé€’å‡ï¼</p>
<h3 id="9">9. æœ€ä¼˜ä¼ è¾“çš„è®¡ç®—æ–¹æ³•</h3>
<p><strong>æ¨å¯¼32ï¼šç†µæ­£åˆ™åŒ–</strong></p>
<p>åŸå§‹æœ€ä¼˜ä¼ è¾“é—®é¢˜çš„è®¡ç®—å¤æ‚åº¦å¾ˆé«˜ã€‚å¼•å…¥ç†µæ­£åˆ™åŒ–ï¼š</p>
<p>$$
W_{2,\epsilon}^2(p,q) = \min_{\gamma\in\Gamma(p,q)} \left\{\int\int \|\boldsymbol{x}-\boldsymbol{y}\|^2d\gamma + \epsilon H[\gamma]\right\}
$$</p>
<p>å…¶ä¸­ç†µé¡¹ä¸ºï¼š</p>
<p>$$
H[\gamma] = -\int\int \gamma(\boldsymbol{x},\boldsymbol{y})\log\gamma(\boldsymbol{x},\boldsymbol{y})d\boldsymbol{x}d\boldsymbol{y}
$$</p>
<p><strong>æ¨å¯¼33ï¼šSinkhornç®—æ³•</strong></p>
<p>æ­£åˆ™åŒ–é—®é¢˜çš„è§£å…·æœ‰ç‰¹æ®Šç»“æ„ï¼š</p>
<p>$$
\gamma^*(\boldsymbol{x},\boldsymbol{y}) = \alpha(\boldsymbol{x})\exp\left(-\frac{\|\boldsymbol{x}-\boldsymbol{y}\|^2}{\epsilon}\right)\beta(\boldsymbol{y})
$$</p>
<p>å…¶ä¸­ $\alpha, \beta$ é€šè¿‡è¿­ä»£æ±‚è§£ï¼š</p>
<p>$$
\begin{aligned}
\alpha^{(k+1)}(\boldsymbol{x}) &= \frac{p(\boldsymbol{x})}{\int \exp(-\|\boldsymbol{x}-\boldsymbol{y}\|^2/\epsilon)\beta^{(k)}(\boldsymbol{y})q(\boldsymbol{y})d\boldsymbol{y}} \\
\beta^{(k+1)}(\boldsymbol{y}) &= \frac{q(\boldsymbol{y})}{\int \exp(-\|\boldsymbol{x}-\boldsymbol{y}\|^2/\epsilon)\alpha^{(k+1)}(\boldsymbol{x})p(\boldsymbol{x})d\boldsymbol{x}}
\end{aligned}
$$</p>
<p><strong>æ³¨é‡Š8</strong>ï¼šSinkhornç®—æ³•æ”¶æ•›é€Ÿåº¦å¿«ï¼Œé€‚åˆå¤§è§„æ¨¡é—®é¢˜ã€‚</p>
<h3 id="10">10. ä¸ç”Ÿæˆæ¨¡å‹çš„è”ç³»</h3>
<p><strong>æ¨å¯¼34ï¼šç”Ÿæˆæ¨¡å‹çš„ç›®æ ‡</strong></p>
<p>ç»™å®šæ•°æ®åˆ†å¸ƒ $p_{\text{data}}$ï¼Œæˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°æ¨¡å‹åˆ†å¸ƒ $p_\theta$ ä½¿å¾—ï¼š</p>
<p>$$
\min_\theta D(p_{\text{data}}\|p_\theta)
$$</p>
<p>å…¶ä¸­ $D$ å¯ä»¥æ˜¯KLæ•£åº¦ã€Wassersteinè·ç¦»ç­‰ã€‚</p>
<p><strong>æ¨å¯¼35ï¼šGANçš„WassersteinæŸå¤±</strong></p>
<p>Wasserstein GANï¼ˆWGANï¼‰ä½¿ç”¨ï¼š</p>
<p>$$
\min_G \max_{D\in\mathcal{D}_1} \mathbb{E}_{\boldsymbol{x}\sim p_{\text{data}}}[D(\boldsymbol{x})] - \mathbb{E}_{\boldsymbol{z}\sim p_z}[D(G(\boldsymbol{z}))]
$$</p>
<p>å…¶ä¸­ $\mathcal{D}<em _text_data="\text{data">1$ æ˜¯1-Lipschitzå‡½æ•°ç±»ã€‚è¿™ç­‰ä»·äºæœ€å°åŒ– $W_1(p</em>, p_G)$ã€‚}</p>
<p><strong>æ¨å¯¼36ï¼šæ‰©æ•£æ¨¡å‹çš„åˆ†æ•°åŒ¹é…</strong></p>
<p>æ‰©æ•£æ¨¡å‹å­¦ä¹ åˆ†æ•°å‡½æ•° $\nabla_{\boldsymbol{x}}\log p_t(\boldsymbol{x})$ï¼Œç›®æ ‡ä¸ºï¼š</p>
<p>$$
\min_\theta \mathbb{E}_t\mathbb{E}_{\boldsymbol{x}_t}\left[\left\|\boldsymbol{s}_\theta(\boldsymbol{x}_t, t) - \nabla_{\boldsymbol{x}}\log p_t(\boldsymbol{x}_t)\right\|^2\right]
$$</p>
<p><strong>æ¨å¯¼37ï¼šé€†å‘SDE</strong></p>
<p>å‰å‘æ‰©æ•£è¿‡ç¨‹ï¼š</p>
<p>$$
d\boldsymbol{X}_t = \boldsymbol{f}(\boldsymbol{X}_t,t)dt + g(t)d\boldsymbol{W}_t
$$</p>
<p>å¯¹åº”çš„é€†å‘SDEï¼ˆAnderson, 1982ï¼‰ï¼š</p>
<p>$$
d\boldsymbol{X}_t = [\boldsymbol{f}(\boldsymbol{X}_t,t) - g(t)^2\nabla_{\boldsymbol{x}}\log p_t(\boldsymbol{X}_t)]dt + g(t)d\bar{\boldsymbol{W}}_t
$$</p>
<p>å…¶ä¸­ $\bar{\boldsymbol{W}}_t$ æ˜¯åå‘æ—¶é—´çš„Wienerè¿‡ç¨‹ã€‚</p>
<p><strong>æ³¨é‡Š9</strong>ï¼šæ‰©æ•£æ¨¡å‹é€šè¿‡å­¦ä¹ åˆ†æ•°å‡½æ•°æ¥å®ç°ä»å™ªå£°åˆ°æ•°æ®çš„é‡‡æ ·ã€‚</p>
<h3 id="11">11. æ”¶æ•›æ€§åˆ†æ</h3>
<p><strong>æ¨å¯¼38ï¼šLyapunovå‡½æ•°æ–¹æ³•</strong></p>
<p>å¯¹äºWassersteinæ¢¯åº¦æµï¼š</p>
<p>$$
\frac{\partial p_t}{\partial t} = \nabla\cdot\left(p_t\nabla\frac{\delta\mathcal{F}}{\delta p_t}\right)
$$</p>
<p>æ³›å‡½ $\mathcal{F}[p_t]$ æ²¿ç€æµå•è°ƒé€’å‡ï¼š</p>
<p>$$
\frac{d\mathcal{F}[p_t]}{dt} = -\int p_t\left\|\nabla\frac{\delta\mathcal{F}}{\delta p_t}\right\|^2d\boldsymbol{x} \leq 0
$$</p>
<p><strong>æ¨å¯¼39ï¼šFisherä¿¡æ¯</strong></p>
<p>å¯¹äºKLæ•£åº¦ $\mathcal{F}[p] = \text{KL}[p|q]$ï¼Œæœ‰ï¼š</p>
<p>$$
\frac{\delta\mathcal{F}}{\delta p} = \log\frac{p}{q} + 1
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
\frac{d\mathcal{F}[p_t]}{dt} = -\int p_t\left\|\nabla\log\frac{p_t}{q}\right\|^2d\boldsymbol{x} = -I[p_t\|q]
$$</p>
<p>å…¶ä¸­ $I[p|q]$ æ˜¯Fisherä¿¡æ¯ï¼Œè¡¡é‡äº†æ”¶æ•›é€Ÿåº¦ã€‚</p>
<p><strong>æ¨å¯¼40ï¼šå¯¹æ•°Sobolevä¸ç­‰å¼</strong></p>
<p>åœ¨å¼ºå‡¸æ¡ä»¶ä¸‹ï¼Œå­˜åœ¨å¸¸æ•° $C_{\text{LS}}$ ä½¿å¾—ï¼š</p>
<p>$$
\text{KL}[p\|q] \leq \frac{1}{2C_{\text{LS}}}I[p\|q]
$$</p>
<p>ç»“åˆå‰é¢çš„ç»“æœï¼š</p>
<p>$$
\frac{d\text{KL}[p_t\|q]}{dt} \leq -2C_{\text{LS}}\text{KL}[p_t\|q]
$$</p>
<p>è¿™ç»™å‡ºæŒ‡æ•°æ”¶æ•›ï¼š</p>
<p>$$
\text{KL}[p_t\|q] \leq e^{-2C_{\text{LS}}t}\text{KL}[p_0\|q]
$$</p>
<h3 id="12">12. æ‰©å±•åˆ°çº¦æŸä¼˜åŒ–</h3>
<p><strong>æ¨å¯¼41ï¼šç­‰å¼çº¦æŸ</strong></p>
<p>è€ƒè™‘çº¦æŸ $\int g_i(\boldsymbol{x})p(\boldsymbol{x})d\boldsymbol{x} = c_i$ï¼Œæ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š</p>
<p>$$
\mathcal{L}[p] = \mathcal{F}[p] + \sum_i \lambda_i\left(\int g_i(\boldsymbol{x})p(\boldsymbol{x})d\boldsymbol{x} - c_i\right)
$$</p>
<p>æ¢¯åº¦æµï¼š</p>
<p>$$
\frac{\partial p_t}{\partial t} = \nabla\cdot\left(p_t\nabla\left(\frac{\delta\mathcal{F}}{\delta p_t} + \sum_i\lambda_i g_i\right)\right)
$$</p>
<p><strong>æ¨å¯¼42ï¼šæŠ•å½±æ¢¯åº¦æµ</strong></p>
<p>å¯¹äºä¸ç­‰å¼çº¦æŸ $p(\boldsymbol{x}) \geq 0$ï¼ˆè‡ªåŠ¨æ»¡è¶³ï¼‰å’Œ $\int p(\boldsymbol{x})d\boldsymbol{x} = 1$ï¼Œå¯ä»¥è¯æ˜Wassersteinæ¢¯åº¦æµè‡ªåŠ¨ä¿æŒè¿™äº›çº¦æŸã€‚</p>
<h3 id="13">13. æ•°å€¼å®ç°çš„ç»†èŠ‚</h3>
<p><strong>æ¨å¯¼43ï¼šæœ‰é™å…ƒç¦»æ•£åŒ–</strong></p>
<p>åœ¨è®¡ç®—æœºä¸Šï¼Œè¿ç»­åˆ†å¸ƒéœ€è¦ç¦»æ•£åŒ–ã€‚ä½¿ç”¨ç²’å­è¿‘ä¼¼ï¼š</p>
<p>$$
p(\boldsymbol{x}) \approx \frac{1}{N}\sum_{i=1}^N \delta(\boldsymbol{x}-\boldsymbol{x}_i)
$$</p>
<p><strong>æ¨å¯¼44ï¼šç²’å­çš„æ¼”åŒ–æ–¹ç¨‹</strong></p>
<p>å°†Wassersteinæ¢¯åº¦æµåº”ç”¨äºç²’å­ï¼š</p>
<p>$$
\frac{d\boldsymbol{x}_i}{dt} = -\nabla_{\boldsymbol{x}}\frac{\delta\mathcal{F}}{\delta p}(\boldsymbol{x}_i)
$$</p>
<p>è¿™æ˜¯æœ‰é™ç²’å­ç³»ç»Ÿçš„ODEã€‚</p>
<p><strong>æ¨å¯¼45ï¼šæ ¸å¯†åº¦ä¼°è®¡</strong></p>
<p>ä½¿ç”¨å…‰æ»‘æ ¸ä»£æ›¿deltaå‡½æ•°ï¼š</p>
<p>$$
p(\boldsymbol{x}) \approx \frac{1}{N}\sum_{i=1}^N K_h(\boldsymbol{x}-\boldsymbol{x}_i)
$$</p>
<p>å…¶ä¸­ $K_h(\boldsymbol{x}) = \frac{1}{h^n}K(\boldsymbol{x}/h)$ æ˜¯å¸¦å®½ä¸º $h$ çš„æ ¸å‡½æ•°ã€‚</p>
<h3 id="14-steinsvgd">14. Steinå˜åˆ†æ¢¯åº¦ä¸‹é™ï¼ˆSVGDï¼‰</h3>
<p><strong>æ¨å¯¼46ï¼šSVGDçš„åŠ¨æœº</strong></p>
<p>ç›®æ ‡ï¼šä»å…ˆéªŒ $p_0$ å‡ºå‘ï¼Œé€šè¿‡å˜æ¢ $T$ å¾—åˆ°åéªŒ $p = T_#p_0$ï¼Œä½¿å¾— $\text{KL}[p|q]$ æœ€å°ã€‚</p>
<p><strong>æ¨å¯¼47ï¼šæ‰°åŠ¨åˆ†æ</strong></p>
<p>è€ƒè™‘æ— ç©·å°å˜æ¢ $T(\boldsymbol{x}) = \boldsymbol{x} + \epsilon\phi(\boldsymbol{x})$ï¼ŒKLæ•£åº¦çš„å˜åŒ–ï¼š</p>
<p>$$
\frac{d}{d\epsilon}\text{KL}[T_\#p\|q]\bigg|_{\epsilon=0} = -\mathbb{E}_p[\text{Tr}(\nabla\phi) + \nabla\log q\cdot\phi]
$$</p>
<p><strong>æ¨å¯¼48ï¼šæœ€ä¼˜æ–¹å‘</strong></p>
<p>åœ¨å†ç”Ÿæ ¸Hilbertç©ºé—´ï¼ˆRKHSï¼‰ä¸­ï¼Œæœ€ä¼˜ $\phi$ ä¸ºï¼š</p>
<p>$$
\phi^*(\boldsymbol{x}) = \mathbb{E}_p[k(\boldsymbol{x},\cdot)\nabla\log q + \nabla k(\boldsymbol{x},\cdot)]
$$</p>
<p>å…¶ä¸­ $k$ æ˜¯æ ¸å‡½æ•°ï¼ˆå¦‚RBFæ ¸ï¼‰ã€‚</p>
<p><strong>æ¨å¯¼49ï¼šSVGDæ›´æ–°è§„åˆ™</strong></p>
<p>ç²’å­æ›´æ–°ï¼š</p>
<p>$$
\boldsymbol{x}_i^{(t+1)} = \boldsymbol{x}_i^{(t)} + \epsilon\phi(\boldsymbol{x}_i^{(t)})
$$</p>
<p>å…¶ä¸­ï¼š</p>
<p>$$
\phi(\boldsymbol{x}_i) = \frac{1}{N}\sum_{j=1}^N \left[k(\boldsymbol{x}_j,\boldsymbol{x}_i)\nabla_{\boldsymbol{x}_j}\log q(\boldsymbol{x}_j) + \nabla_{\boldsymbol{x}_j}k(\boldsymbol{x}_j,\boldsymbol{x}_i)\right]
$$</p>
<p><strong>æ³¨é‡Š10</strong>ï¼šç¬¬ä¸€é¡¹æ˜¯å¸å¼•åŠ›ï¼ˆå‘é«˜æ¦‚ç‡åŒºç§»åŠ¨ï¼‰ï¼Œç¬¬äºŒé¡¹æ˜¯æ’æ–¥åŠ›ï¼ˆä¿æŒç²’å­å¤šæ ·æ€§ï¼‰ã€‚</p>
<h3 id="15-cnf">15. è¿ç»­å½’ä¸€åŒ–æµï¼ˆCNFï¼‰</h3>
<p><strong>æ¨å¯¼50ï¼šODEå½¢å¼çš„ç”Ÿæˆæ¨¡å‹</strong></p>
<p>å®šä¹‰ä»ç®€å•åˆ†å¸ƒ $p_0$ åˆ°å¤æ‚åˆ†å¸ƒ $p_1$ çš„è¿ç»­å˜æ¢ï¼š</p>
<p>$$
\frac{d\boldsymbol{z}_t}{dt} = \boldsymbol{f}_t(\boldsymbol{z}_t)
$$</p>
<p>å¯†åº¦æ¼”åŒ–éµå¾ªLiouvilleæ–¹ç¨‹ï¼š</p>
<p>$$
\frac{\partial\log p_t(\boldsymbol{z}_t)}{\partial t} = -\text{Tr}\left(\frac{\partial\boldsymbol{f}_t}{\partial\boldsymbol{z}_t}\right)
$$</p>
<p><strong>æ¨å¯¼51ï¼šå¯¹æ•°ä¼¼ç„¶çš„è®¡ç®—</strong></p>
<p>$$
\log p_1(\boldsymbol{z}_1) = \log p_0(\boldsymbol{z}_0) - \int_0^1 \text{Tr}\left(\frac{\partial\boldsymbol{f}_t}{\partial\boldsymbol{z}_t}\right)dt
$$</p>
<p>é€šè¿‡ODEæ±‚è§£å™¨å¯ä»¥ç²¾ç¡®è®¡ç®—ã€‚</p>
<h3 id="16">16. æ€»ç»“ä¸ç»Ÿä¸€è§†è§’</h3>
<p><strong>æ¨å¯¼52ï¼šä¼˜åŒ–ç®—æ³•çš„ç»Ÿä¸€æ¡†æ¶</strong></p>
<p>æ‰€æœ‰åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–éƒ½å¯ä»¥å†™æˆï¼š</p>
<p>$$
\frac{dx_t}{dt} = -M\nabla f(x_t)
$$</p>
<p>å…¶ä¸­ $M$ æ˜¯åº¦é‡å¼ é‡ï¼š</p>
<ul>
<li>æ¬§æ°ç©ºé—´ï¼š$M = I$ï¼ˆæ¢¯åº¦ä¸‹é™ï¼‰</li>
<li>é»æ›¼æµå½¢ï¼š$M = G^{-1}$ï¼ˆè‡ªç„¶æ¢¯åº¦ï¼‰</li>
<li>æ¦‚ç‡ç©ºé—´ï¼š$M$ å¯¹åº”Wassersteinåº¦é‡</li>
</ul>
<p><strong>æ¨å¯¼53ï¼šä¿¡æ¯å‡ ä½•çš„è§†è§’</strong></p>
<p>åœ¨æ¦‚ç‡æµå½¢ä¸Šï¼ŒFisheråº¦é‡å®šä¹‰ä¸ºï¼š</p>
<p>$$
g_{ij}(\theta) = \mathbb{E}_{p_\theta}\left[\frac{\partial\log p_\theta}{\partial\theta_i}\frac{\partial\log p_\theta}{\partial\theta_j}\right]
$$</p>
<p>è‡ªç„¶æ¢¯åº¦ä¸ºï¼š</p>
<p>$$
\tilde{\nabla}_\theta = G^{-1}\nabla_\theta
$$</p>
<h3 id="17">17. å®é™…åº”ç”¨ä¸­çš„æŠ€å·§</h3>
<p><strong>æ¨å¯¼54ï¼šè‡ªé€‚åº”æ­¥é•¿</strong></p>
<p>ä½¿ç”¨çº¿æœç´¢é€‰æ‹©æ­¥é•¿ $\eta_t$ï¼š</p>
<p>$$
\eta_t = \arg\min_\eta \mathcal{F}[p_t - \eta\nabla_W\mathcal{F}[p_t]]
$$</p>
<p><strong>æ¨å¯¼55ï¼šåŠ¨é‡æ–¹æ³•</strong></p>
<p>å¼•å…¥åŠ¨é‡åŠ é€Ÿæ”¶æ•›ï¼š</p>
<p>$$
\begin{aligned}
\boldsymbol{v}_{t+1} &= \beta\boldsymbol{v}_t - \nabla_W\mathcal{F}[p_t] \\
p_{t+1} &= p_t + \eta\boldsymbol{v}_{t+1}
\end{aligned}
$$</p>
<p><strong>æ¨å¯¼56ï¼šéšæœºæ¢¯åº¦</strong></p>
<p>å½“æ³›å‡½æ¶‰åŠæœŸæœ›æ—¶ï¼š</p>
<p>$$
\mathcal{F}[p] = \mathbb{E}_p[f(\boldsymbol{x})]
$$</p>
<p>å¯ä»¥ä½¿ç”¨è’™ç‰¹å¡æ´›ä¼°è®¡ï¼š</p>
<p>$$
\nabla_W\mathcal{F}[p] \approx \frac{1}{N}\sum_{i=1}^N \nabla f(\boldsymbol{x}_i)
$$</p>
<h3 id="_17">æ€»ç»“</h3>
<p>æœ¬èŠ‚ç³»ç»Ÿæ¨å¯¼äº†æ¦‚ç‡ç©ºé—´ä¸­çš„ä¼˜åŒ–ç†è®ºï¼Œå…³é”®è¦ç‚¹ï¼š</p>
<ol>
<li><strong>æ³›å‡½å¯¼æ•°</strong>ï¼šæ¦‚ç‡åˆ†å¸ƒç©ºé—´ä¸­çš„"æ¢¯åº¦"æ¦‚å¿µ</li>
<li><strong>Wassersteinæ¢¯åº¦æµ</strong>ï¼šä¿æŒæ¦‚ç‡çº¦æŸçš„æ¢¯åº¦ä¸‹é™</li>
<li><strong>Fokker-Planckæ–¹ç¨‹</strong>ï¼šæè¿°æ¦‚ç‡å¯†åº¦çš„æ¼”åŒ–</li>
<li><strong>æœ€ä¼˜ä¼ è¾“</strong>ï¼šå®šä¹‰æ¦‚ç‡åˆ†å¸ƒä¹‹é—´çš„è·ç¦»</li>
<li><strong>æ”¶æ•›æ€§</strong>ï¼šé€šè¿‡Lyapunovå‡½æ•°å’ŒFisherä¿¡æ¯åˆ†æ</li>
<li><strong>åº”ç”¨</strong>ï¼šç”Ÿæˆæ¨¡å‹ã€å˜åˆ†æ¨æ–­ã€é‡‡æ ·ç®—æ³•ç­‰</li>
</ol>
<p>è¿™äº›ç†è®ºå·¥å…·åœ¨ç°ä»£æœºå™¨å­¦ä¹ ä¸­æœ‰å¹¿æ³›åº”ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨ç”Ÿæˆæ¨¡å‹ã€è´å¶æ–¯æ¨æ–­å’Œå¼ºåŒ–å­¦ä¹ ç­‰é¢†åŸŸã€‚</p>
        </div>
    </div>
</body>
</html>