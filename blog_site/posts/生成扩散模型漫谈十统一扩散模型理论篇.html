<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåï¼‰ï¼šç»Ÿä¸€æ‰©æ•£æ¨¡å‹ï¼ˆç†è®ºç¯‡ï¼‰</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåï¼‰ï¼šç»Ÿä¸€æ‰©æ•£æ¨¡å‹ï¼ˆç†è®ºç¯‡ï¼‰</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 48.3 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9262">https://spaces.ac.cn/archives/9262</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>è€è¯»è€…ä¹Ÿè®¸ä¼šå‘ç°ï¼Œç›¸æ¯”ä¹‹å‰çš„æ›´æ–°é¢‘ç‡ï¼Œè¿™ç¯‡æ–‡ç« å¯è°“æ˜¯â€œå§—å§—æ¥è¿Ÿâ€ï¼Œå› ä¸ºè¿™ç¯‡æ–‡ç« â€œæƒ³å¾—å¤ªå¤šâ€äº†ã€‚</p>
<p>é€šè¿‡å‰é¢ä¹ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å·²ç»å¯¹ç”Ÿæˆæ‰©æ•£æ¨¡å‹åšäº†ä¸€ä¸ªç›¸å¯¹å…¨é¢çš„ä»‹ç»ã€‚è™½ç„¶ç†è®ºå†…å®¹å¾ˆå¤šï¼Œä½†æˆ‘ä»¬å¯ä»¥å‘ç°ï¼Œå‰é¢ä»‹ç»çš„æ‰©æ•£æ¨¡å‹å¤„ç†çš„éƒ½æ˜¯è¿ç»­å‹å¯¹è±¡ï¼Œå¹¶ä¸”éƒ½æ˜¯åŸºäºæ­£æ€å™ªå£°æ¥æ„å»ºå‰å‘è¿‡ç¨‹ã€‚è€Œâ€œæƒ³å¾—å¤ªå¤šâ€çš„æœ¬æ–‡ï¼Œåˆ™å¸Œæœ›èƒ½å¤Ÿæ„å»ºä¸€ä¸ªèƒ½çªç ´ä»¥ä¸Šé™åˆ¶çš„æ‰©æ•£æ¨¡å‹ç»Ÿä¸€æ¡†æ¶ï¼ˆUnified Diffusion Modelï¼ŒUDMï¼‰ï¼š</p>
<blockquote>
<p>1ã€ä¸é™å¯¹è±¡ç±»å‹ï¼ˆå¯ä»¥æ˜¯è¿ç»­å‹$\boldsymbol{x}$ï¼Œä¹Ÿå¯ä»¥æ˜¯ç¦»æ•£å‹çš„$\boldsymbol{x}$ï¼‰ï¼›</p>
<p>2ã€ä¸é™å‰å‘è¿‡ç¨‹ï¼ˆå¯ä»¥ç”¨åŠ å™ªã€æ¨¡ç³Šã€é®æ©ã€åˆ å‡ç­‰å„ç§å˜æ¢æ„å»ºå‰å‘è¿‡ç¨‹ï¼‰ï¼›</p>
<p>3ã€ä¸é™æ—¶é—´ç±»å‹ï¼ˆå¯ä»¥æ˜¯ç¦»æ•£å‹çš„$t$ï¼Œä¹Ÿå¯ä»¥æ˜¯è¿ç»­å‹çš„$t$ï¼‰ï¼›</p>
<p>4ã€åŒ…å«å·²æœ‰ç»“æœï¼ˆå¯ä»¥æ¨å‡ºå‰é¢çš„DDPMã€DDIMã€SDEã€ODEç­‰ç»“æœï¼‰ã€‚</p>
</blockquote>
<p>è¿™æ˜¯ä¸æ˜¯å¤ªè¿‡â€œå¼‚æƒ³å¤©å¼€â€äº†ï¼Ÿæœ‰æ²¡æœ‰é‚£ä¹ˆç†æƒ³çš„æ¡†æ¶ï¼Ÿæœ¬æ–‡å°±æ¥å°è¯•ä¸€ä¸‹ã€‚</p>
<h2 id="_1">å‰å‘è¿‡ç¨‹</h2>
<p>ä»å‰é¢çš„ä¸€ç³»åˆ—ä»‹ç»ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“æ„å»ºä¸€ä¸ªæ‰©æ•£æ¨¡å‹åŒ…å«â€œå‰å‘è¿‡ç¨‹â€ã€â€œåå‘è¿‡ç¨‹â€ã€â€œè®­ç»ƒç›®æ ‡â€ä¸‰ä¸ªéƒ¨åˆ†ï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬æ¥åˆ†æâ€œå‰å‘è¿‡ç¨‹â€ã€‚</p>
<p>åœ¨æœ€åˆçš„<a href="/archives/9119">DDPM</a>ä¸­ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡$p(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>)$æ¥æè¿°å‰å‘è¿‡ç¨‹çš„ï¼›åæ¥ï¼Œéšç€<a href="/archives/9181">DDIM</a>ç­‰å·¥ä½œçš„å‘è¡¨ï¼Œæˆ‘ä»¬é€æ¸æ„è¯†åˆ°ï¼Œæ‰©æ•£æ¨¡å‹çš„è®­ç»ƒç›®æ ‡å’Œç”Ÿæˆè¿‡ç¨‹ï¼Œéƒ½è·Ÿ$p(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>})$æ²¡ç›´æ¥è”ç³»ï¼Œåè€Œè·Ÿ$p(\boldsymbol{x<em t-1="t-1">t|\boldsymbol{x}_0)$çš„è”ç³»æ›´ä¸ºç›´æ¥ï¼Œè€Œä»$p(\boldsymbol{x}_t|\boldsymbol{x}</em>_0)$è§†ä¸ºå‰å‘è¿‡ç¨‹ã€‚})$æ¨å¯¼$p(\boldsymbol{x}_t|\boldsymbol{x}_0)$å¾€å¾€ä¹Ÿæ¯”è¾ƒå›°éš¾ã€‚å› æ­¤ï¼Œä¸€ä¸ªæ›´ä¸ºå®ç”¨çš„æ“ä½œå°±æ˜¯ç›´æ¥ä»¥$p(\boldsymbol{x}_t|\boldsymbol{x}_0)$ä¸ºå‡ºå‘ç‚¹ï¼Œä¹Ÿå°±æ˜¯å°†$p(\boldsymbol{x}_t|\boldsymbol{x</p>
<p>$p(\boldsymbol{x}_t|\boldsymbol{x}_0)$çš„æœ€ç›´æ¥ä½œç”¨ï¼Œå°±æ˜¯ç”¨æ¥æ„å»ºæ‰©æ•£æ¨¡å‹çš„è®­ç»ƒæ•°æ®ï¼Œå› æ­¤$p(\boldsymbol{x}_t|\boldsymbol{x}_0)$çš„æœ€åŸºæœ¬è¦æ±‚æ˜¯ä¾¿äºé‡‡æ ·ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‡å‚æ•°<br />
\begin{equation}\boldsymbol{x}_t = \boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0,\boldsymbol{\varepsilon})\label{eq:re-param}\end{equation}<br />
å…¶ä¸­$\boldsymbol{\mathcal{F}}$æ˜¯å…³äº$t,\boldsymbol{x}_0,\boldsymbol{\varepsilon}$çš„ç¡®å®šæ€§å‡½æ•°ï¼Œ$\boldsymbol{\varepsilon}$æ˜¯é‡‡æ ·è‡ªæŸä¸ªæ ‡å‡†åˆ†å¸ƒ$q(\boldsymbol{\varepsilon})$çš„éšæœºå˜é‡ï¼Œå¸¸è§é€‰æ‹©æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œä½†å…¶ä»–åˆ†å¸ƒé€šå¸¸ä¹Ÿæ˜¯å¯è¡Œçš„ã€‚å¯ä»¥æƒ³åƒï¼Œè¯¥å½¢å¼åŒ…å«äº†è¶³å¤Ÿä¸°å¯Œçš„$\boldsymbol{x}_0$åˆ°$\boldsymbol{x}_t$çš„å˜æ¢ï¼Œå®ƒå¯¹$\boldsymbol{x}_0$ã€$\boldsymbol{x}_t$çš„æ•°æ®ç±»å‹ä¹Ÿæ²¡æœ‰çº¦æŸã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå”¯ä¸€çš„é™åˆ¶æ˜¯$t$è¶Šå°ï¼Œ$\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0,\boldsymbol{\varepsilon})$æ‰€åŒ…å«çš„$\boldsymbol{x}_0$çš„ä¿¡æ¯è¶Šå®Œæ•´ï¼Œæ¢è¨€ä¹‹ç”¨$\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0,\boldsymbol{\varepsilon})$é‡æ„$\boldsymbol{x}_0$è¶Šå®¹æ˜“ï¼Œåä¹‹$t$è¶Šå¤§é‡æ„å°±è¶Šå›°éš¾ï¼Œç›´åˆ°æŸä¸ªä¸Šç•Œ$T$æ—¶ï¼Œ$\boldsymbol{\mathcal{F}}_T(\boldsymbol{x}_0,\boldsymbol{\varepsilon})$æ‰€åŒ…å«çš„$\boldsymbol{x}_0$çš„ä¿¡æ¯å‡ ä¹æ¶ˆå¤±ï¼Œé‡æ„å‡ ä¹ä¸èƒ½å®Œæˆã€‚</p>
<h2 id="_2">åå‘è¿‡ç¨‹</h2>
<p>æ‰©æ•£æ¨¡å‹çš„åå‘è¿‡ç¨‹æ˜¯é€šè¿‡å¤šæ­¥è¿­ä»£æ¥é€æ¸ç”Ÿæˆé€¼çœŸçš„æ•°æ®ï¼Œå…¶å…³é”®å°±æ˜¯æ¦‚ç‡åˆ†å¸ƒ$p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t)$ã€‚ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t) = \int p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0) p(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x}_0\label{eq:p-factor}\end{equation}<br />
å¦‚æœ$\boldsymbol{x}_0$æ˜¯ç¦»æ•£å‹æ•°æ®ï¼Œå°†ç§¯åˆ†æ”¹ä¸ºæ±‚å’Œå³å¯ã€‚$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t)$çš„åŸºæœ¬è¦æ±‚ä¹Ÿæ˜¯ä¾¿äºé‡‡æ ·ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦æ±‚$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0)$å’Œ$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$ä¹Ÿè¦ä¾¿äºé‡‡æ ·ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ä¸‹è¿°æµç¨‹å®Œæˆ$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t)$çš„é‡‡æ ·ï¼š<br />
\begin{equation}\hat{\boldsymbol{x}}_0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)\quad \&amp; \quad \boldsymbol{x}</em>}\sim p(\boldsymbol{x<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0=\hat{\boldsymbol{x}}_0) \quad \Rightarrow \quad \boldsymbol{x}</em>}\sim p(\boldsymbol{x<em t-1="t-1">{t-1}|\boldsymbol{x}_t)\end{equation}<br />
ä»è¿™ä¸ªåˆ†è§£æ¥çœ‹ï¼Œæ¯ä¸€æ­¥$\boldsymbol{x}_t\to \boldsymbol{x}</em>$çš„é‡‡æ ·ï¼Œå®é™…ä¸ŠåŒ…å«äº†ä¸¤ä¸ªå­æ­¥éª¤ï¼š</p>
<blockquote>
<p>1ã€é¢„ä¼°ï¼šç”±$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$å¯¹$\boldsymbol{x}_0$åšä¸€ä¸ªç®€å•çš„â€œé¢„ä¼°â€ï¼›</p>
<p>2ã€ä¿®æ­£ï¼šç”±$p(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$æ•´åˆé¢„ä¼°ç»“æœï¼Œå°†ä¼°å€¼æ¨å‰ä¸€å°æ­¥ã€‚</p>
</blockquote>
<p>æ‰€ä»¥ï¼Œæ‰©æ•£æ¨¡å‹çš„åå‘è¿‡ç¨‹å°±æ˜¯ä¸€ä¸ªåå¤çš„â€œé¢„ä¼°-ä¿®æ­£â€è¿‡ç¨‹ï¼Œé€šè¿‡ä¸æ–­åœ°æ•´åˆ$\boldsymbol{x}<em t-1="t-1">t\to \boldsymbol{x}_0$çš„é¢„ä¼°ç»“æœï¼Œå¾—åˆ°é€æ­¥æ¨è¿›çš„ä¿®æ­£åºåˆ—$\boldsymbol{x}_T\to\cdots\to\boldsymbol{x}_t\to \boldsymbol{x}</em>_0$ï¼Œå°†åŸæœ¬éš¾ä»¥ä¸€æ­¥åˆ°ä½çš„ç”Ÿæˆåˆ†è§£ä¸ºäº†å¤šä¸ªæ­¥éª¤æ¥å®Œæˆã€‚}\to\cdots\to \boldsymbol{x</p>
<h2 id="_3">è®­ç»ƒç›®æ ‡</h2>
<p>å½“ç„¶ï¼Œç›®å‰çš„åå‘è¿‡ç¨‹è¿˜åªæ˜¯â€œçº¸ä¸Šè°ˆå…µâ€ï¼Œå› ä¸ºå¯¹äº$p(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$å’Œ$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$æˆ‘ä»¬è¿˜ä¸€æ— æ‰€çŸ¥ã€‚è¿™ä¸€èŠ‚æˆ‘ä»¬å…ˆæ¥è®¨è®º$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$ã€‚</p>
<p>å¾ˆæ˜æ˜¾ï¼Œ$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$å°±æ˜¯ç”¨$\boldsymbol{x}_t$æ¥é¢„æµ‹$\boldsymbol{x}_0$çš„æ¦‚ç‡æ¨¡å‹ï¼Œæˆ‘ä»¬éœ€è¦ç”¨ä¸€ä¸ªâ€œæ–¹ä¾¿é‡‡æ ·ä¸”å®¹æ˜“è®¡ç®—â€çš„åˆ†å¸ƒå»ä¼°è®¡å®ƒã€‚å½“$\boldsymbol{x}_0$æ˜¯è¿ç»­å‹æ•°æ®æ—¶ï¼Œæˆ‘ä»¬çš„é€‰æ‹©å¹¶ä¸å¤šï¼Œé€šå¸¸å°±æ˜¯å‡å€¼å¯è®­ç»ƒçš„æ­£æ€åˆ†å¸ƒ<br />
\begin{equation}p(\boldsymbol{x}_0|\boldsymbol{x}_t) \approx q(\boldsymbol{x}_0|\boldsymbol{x}_t) = \mathcal{N}(\boldsymbol{x}_0;\boldsymbol{\mathcal{G}}_t(\boldsymbol{x}_t),\bar{\sigma}_t^2 \boldsymbol{I})\label{eq:normal}\end{equation}<br />
ä¸ºäº†é™ä½è®­ç»ƒéš¾åº¦ï¼Œæˆ‘ä»¬ä¸€èˆ¬ä¸å°†æ–¹å·®$\bar{\sigma}_t^2$è§†ä¸ºå¯è®­ç»ƒå‚æ•°ï¼Œè€Œæ˜¯ç”¨<a href="/archives/9245">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸ƒï¼‰ï¼šæœ€ä¼˜æ‰©æ•£æ–¹å·®ä¼°è®¡ï¼ˆä¸Šï¼‰ã€‹</a>çš„æ–¹å¼å»äº‹åä¼°è®¡å®ƒã€‚å¦ä¸€æ–¹é¢ï¼Œå½“$\boldsymbol{x}_0$æ˜¯ç¦»æ•£å‹æ•°æ®æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨è‡ªå›å½’æˆ–è€…éè‡ªå›å½’çš„è¯­è¨€æ¨¡å‹ï¼ˆSeq2Seqï¼‰æ¥å»ºæ¨¡ï¼Œç¦»æ•£å‹çš„æ¦‚ç‡å»ºæ¨¡å’Œé‡‡æ ·ç›¸å¯¹æ¥è¯´éƒ½æ›´åŠ å®¹æ˜“äº›ã€‚</p>
<p>æœ‰äº†è¿‘ä¼¼åˆ†å¸ƒ$q(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">0|\boldsymbol{x}_t)$çš„å…·ä½“å½¢å¼åï¼Œè®­ç»ƒç›®æ ‡å°±å¾ˆç®€å•äº†ï¼Œæ¯”è¾ƒè‡ªç„¶çš„é€‰æ‹©æ˜¯äº¤å‰ç†µï¼š<br />
\begin{equation}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim \tilde{p}(\boldsymbol{x}_0),\boldsymbol{x}_t\sim p(\boldsymbol{x}_t|\boldsymbol{x}_0)}[-\log q(\boldsymbol{x}_0|\boldsymbol{x}_t)] = \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim \tilde{p}(\boldsymbol{x}_0),\boldsymbol{\varepsilon}\sim q(\boldsymbol{\varepsilon})}[-\log q(\boldsymbol{x}_0|\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0,\boldsymbol{\varepsilon}))]\end{equation}<br />
è¿™å°±è§£å†³äº†$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$çš„ä¼°è®¡å’Œè®­ç»ƒç›®æ ‡çš„è®¾è®¡é—®é¢˜ã€‚å¦‚æœ$q(\boldsymbol{x}_0|\boldsymbol{x}_t)$æ˜¯å¼$\eqref{eq:normal}$çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œé‚£ä¹ˆçœå»å¸¸æ•°åçš„ç»“æœå°±æ˜¯<br />
\begin{equation}\mathbb{E}</em>}_0\sim \tilde{p}(\boldsymbol{x}_0),\boldsymbol{\varepsilon}\sim q(\boldsymbol{\varepsilon})}\left[\frac{1}{2\bar{\sigma}_t^2}\Vert\boldsymbol{x}_0 - \boldsymbol{\mathcal{G}}_t(\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0,\boldsymbol{\varepsilon}))\Vert^2\right]\end{equation</p>
<h2 id="_4">æ¡ä»¶æ¦‚ç‡</h2>
<p>ç°åœ¨å°±å‰©ä¸‹$p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$äº†ï¼Œå®ƒæ˜¯ç»™å®š$\boldsymbol{x}_t, \boldsymbol{x}_0$æ¥é¢„æµ‹$\boldsymbol{x}</em>$çš„æ¦‚ç‡ã€‚è¿™ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹Ÿæœ‰ä¸€å®šçš„è®¾è®¡ç©ºé—´ï¼Œä½†å‰ææ˜¯æ»¡è¶³è¾¹ç¼˜åˆ†å¸ƒçš„æ’ç­‰å¼<br />
\begin{equation}\int p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)p(\boldsymbol{x}_t|\boldsymbol{x}_0) d\boldsymbol{x}_t= p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">0)\label{eq:margin}\end{equation}<br />
å¾ˆæ˜¾ç„¶ï¼Œæ»¡è¶³è¿™ä¸ªç­‰å¼çš„ä¸€ä¸ªæœ€ç®€å•é€‰æ‹©æ˜¯ç›´æ¥å–<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0) = p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">0)\end{equation}<br />
å³è®©$p(\boldsymbol{x}</em>_t$æ— å…³ã€‚è¿™æ ·çš„æ‰©æ•£æ¨¡å‹ï¼Œå¯ä»¥ç”±ä¸‹é¢ä¸¤ä¸ªå›¾æè¿°ï¼ˆä»¥$T=5$ä¸ºä¾‹ï¼‰ï¼š  }|\boldsymbol{x}_t, \boldsymbol{x}_0)$è·Ÿ$\boldsymbol{x</p>
<p><a href="/usr/uploads/2022/09/2096401240.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="å‰å‘è¿‡ç¨‹å’Œè®­ç»ƒç›®æ ‡ç¤ºæ„å›¾" src="/usr/uploads/2022/09/2096401240.png" /></a></p>
<p>å‰å‘è¿‡ç¨‹å’Œè®­ç»ƒç›®æ ‡ç¤ºæ„å›¾</p>
<p><a href="/usr/uploads/2022/09/429962088.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="æœ€ç®€å•é€‰æ‹©ä¸‹çš„åå‘è¿‡ç¨‹" src="/usr/uploads/2022/09/429962088.png" /></a></p>
<p>æœ€ç®€å•é€‰æ‹©ä¸‹çš„åå‘è¿‡ç¨‹</p>
<p>è¿™ä¸ªæç®€çš„é€‰æ‹©åœ¨ç†è®ºä¸Šæ²¡æœ‰é—®é¢˜ï¼Œç„¶è€Œå®é™…ä¸Šçš„æ•ˆæœé€šå¸¸ä¸ä¼šå¤ªå¥½ï¼Œå› æ­¤æ­¤æ—¶$\boldsymbol{x}<em t-1="t-1">{t-1}$å®Œå…¨ä¾èµ–äº$\boldsymbol{x}_0$ï¼Œè€Œ$\boldsymbol{x}_0$æœ¬æ¥ä»£è¡¨çš„æ˜¯åŸå§‹çœŸå®æ ·æœ¬ï¼Œåœ¨åå‘è¿‡ç¨‹ä¸­æˆ‘ä»¬åˆ™åªèƒ½é€šè¿‡è¿‘ä¼¼åˆ†å¸ƒ$q(\boldsymbol{x}_0|\boldsymbol{x}_t)$æ¥è¿‘ä¼¼é‡‡æ ·ï¼Œè€Œ$q(\boldsymbol{x}_0|\boldsymbol{x}_t)$é€šå¸¸æ˜¯ä¸å¤Ÿå‡†ç¡®çš„ï¼Œå› æ­¤è¯¯å·®ä¼šæŒç»­ç´¯ç§¯ã€‚å¦å¤–ï¼Œ$p(\boldsymbol{x}</em>_0$ä¿¡æ¯ï¼Œä»è€Œä½¿å¾—ç”Ÿæˆæ•ˆæœå˜å·®ã€‚}|\boldsymbol{x}_0)$åœ¨é‡‡æ ·è¿‡ç¨‹ä¸­ä¼šå¸¦æœ‰å™ªå£°ï¼Œè¿™ä¸ªå™ªå£°å¯èƒ½ä¼šä¸¥é‡ç ´ååˆšåˆšé¢„ä¼°å‡ºæ¥çš„$\hat{\boldsymbol{x}</p>
<p>ä¸è¿‡å¾ˆå¹¸è¿ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥åŸºäº$p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">0)$è¿™ä¸ªç®€å•çš„é€‰æ‹©æ¥è¡ç”Ÿå‡ºä¸€ä¸ªæ–°çš„ç»“æœã€‚æ ¹æ®å¼$\eqref{eq:re-param}$ï¼Œæˆ‘ä»¬çŸ¥é“<br />
\begin{equation}\begin{aligned}<br />
\boldsymbol{x}</em>} \sim p(\boldsymbol{x<em t-1="t-1">{t-1}|\boldsymbol{x}_0)\quad\Leftrightarrow&amp;\,\quad\boldsymbol{x}</em>} = \boldsymbol{\mathcal{F}<em t-1="t-1">{t-1}(\boldsymbol{x}_0,\boldsymbol{\varepsilon}) \\\<br />
\boldsymbol{x}_t \sim p(\boldsymbol{x}_t|\boldsymbol{x}_0)\quad\Leftrightarrow&amp;\,\quad\boldsymbol{x}_t = \boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0,\boldsymbol{\varepsilon})<br />
\end{aligned}\end{equation}<br />
å‡å®š$\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0,\boldsymbol{\varepsilon})$å…³äº$\boldsymbol{\varepsilon}$æ˜¯å¯é€†çš„ï¼Œé‚£ä¹ˆå¯ä»¥è§£å‡º$\boldsymbol{\varepsilon} = \boldsymbol{\mathcal{F}}_t^{-1}(\boldsymbol{x}_0,\boldsymbol{x}_t)$ï¼Œæ­¤æ—¶å¯ä»¥ç”¨è§£å‡ºæ¥çš„è¿™ä¸ª$\boldsymbol{\varepsilon}$æ›¿æ¢æ‰$\boldsymbol{\mathcal{F}}</em>}(\boldsymbol{x<em t-1="t-1">0,\boldsymbol{\varepsilon})$ä¸­çš„$\boldsymbol{\varepsilon}$ï¼Œå¾—åˆ°<br />
\begin{equation}\boldsymbol{x}</em>} = \boldsymbol{\mathcal{F}<em t-1="t-1">{t-1}(\boldsymbol{x}_0,\boldsymbol{\mathcal{F}}_t^{-1}(\boldsymbol{x}_0,\boldsymbol{x}_t))\end{equation}<br />
è¿™å°±ç›¸å½“äº<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0) = \delta\big(\boldsymbol{x}</em>} - \boldsymbol{\mathcal{F}<em t-1="t-1">{t-1}(\boldsymbol{x}_0,\boldsymbol{\mathcal{F}}_t^{-1}(\boldsymbol{x}_0,\boldsymbol{x}_t))\big)\end{equation}<br />
æ˜¯ä¸€ä¸ªåŒæ—¶ä¾èµ–äº$\boldsymbol{x}_t, \boldsymbol{x}_0$çš„$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0)$è®¾è®¡ï¼Œ$\boldsymbol{x}_t$åˆ†æ‘Šäº†$\boldsymbol{x}</em>_0$çš„éƒ¨åˆ†ä¾èµ–ï¼Œå¹¶ä¸”æ¶ˆé™¤äº†å™ªå£°ï¼Œä½¿å¾—æ¯ä¸€æ­¥ç”Ÿæˆçš„â€œè¿›å±•â€å¯ä»¥ç¨³å®šåœ°ç´¯ç§¯ä¸‹æ¥ï¼Œå› æ­¤ç”¨è¿™ä¸ªè®¾è®¡çš„åå‘è¿‡ç¨‹å¾€å¾€æœ‰æ›´å¥½çš„æ•ˆæœã€‚}$å¯¹$\boldsymbol{x</p>
<p>æ­¤å¤–ï¼Œå¦‚æœæ˜¯$q(\boldsymbol{\varepsilon})$æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œé‚£ä¹ˆè¿˜å¯ä»¥å¾—åˆ°æ›´ä¸€èˆ¬çš„ç»“æœï¼Œå› ä¸ºç”±æ­£æ€åˆ†å¸ƒçš„å åŠ æ€§ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<br />
\begin{equation}\boldsymbol{x}<em t-1="t-1">{t-1} = \boldsymbol{\mathcal{F}}</em>}(\boldsymbol{x<em t-1="t-1">0,\boldsymbol{\varepsilon})\quad\Leftrightarrow\quad\boldsymbol{x}</em>} = \boldsymbol{\mathcal{F}<em t-1="t-1">{t-1}(\boldsymbol{x}_0,\sqrt{1 - \tilde{\sigma}_t^2}\boldsymbol{\varepsilon}_1 + \tilde{\sigma}_t \boldsymbol{\varepsilon}_2)\end{equation}<br />
è¿™æ ·ä¸€æ¥ï¼Œç”±$\boldsymbol{x}_0,\boldsymbol{x}_t$è§£å‡ºæ¥çš„$\boldsymbol{\varepsilon}$å¯ä»¥åªç”¨æ¥æ›¿æ¢$\boldsymbol{\varepsilon}_1$æˆ–$\boldsymbol{\varepsilon}_2$ä¸­çš„ä¸€ä¸ªï¼Œæœ€ç»ˆå¾—åˆ°çš„$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0)$çš„é‡‡æ ·è¿‡ç¨‹å°±æ˜¯<br />
\begin{equation}\quad\boldsymbol{x}</em>} = \boldsymbol{\mathcal{F}}_{t-1}(\boldsymbol{x}_0,\sqrt{1 - \tilde{\sigma}_t^2}\boldsymbol{\mathcal{F}}_t^{-1}(\boldsymbol{x}_0,\boldsymbol{x}_t) + \tilde{\sigma}_t \boldsymbol{\varepsilon})\end{equation</p>
<h2 id="_5">æ€è€ƒåˆ†æ</h2>
<p>è‡³æ­¤ï¼Œç»Ÿä¸€æ‰©æ•£æ¨¡å‹UDMçš„ç†è®ºæ¡†æ¶å·²ç»æ„å»ºå®Œæ¯•ï¼Œä¸‹ä¸€ç¯‡æ–‡ç« æˆ‘ä»¬ä¼šé€šè¿‡ä¸€äº›å…·ä½“ä¾‹å­ä»‹ç»å¦‚ä½•ä»UDMæ¡†æ¶æ¨å‡ºå·²æœ‰çš„æ‰©æ•£æ¨¡å‹ç»“æœï¼Œä»¥åŠè¿›ä¸€æ­¥å¾—åˆ°ä¸€äº›æ–°çš„ç»“æœï¼Œè¿™ä¸€èŠ‚æˆ‘ä»¬æ¥å¯¹å…¨æ–‡çš„æ¨ç†åšä¸€ä¸ªæ€è€ƒåˆ†æã€‚</p>
<p>çœ‹å®Œå…¨æ–‡ï¼Œç›¸ä¿¡ä¸å°‘è¯»è€…æ˜¯æ¯”è¾ƒæ‡µçš„ï¼Œå› ä¸ºæœ¬æ–‡çš„ç»“æœæ˜¯å»ºç«‹åœ¨ç¬”è€…å‰é¢å¯¹æ‰©æ•£æ¨¡å‹çš„æ‰€æœ‰ç†è§£åŸºç¡€ä¸Šæ€»ç»“å‡ºæ¥çš„ä¸€ä¸ªç»Ÿä¸€æ¡†æ¶ï¼Œæ€»ä½“çš„æŠ€æœ¯ä¸ç®—å¾ˆéš¾ï¼Œä½†æ˜¯é€»è¾‘ä¸Šå¹¶ä¸å®¹æ˜“æ‹æ¸…æ¥šã€‚é¦–å…ˆï¼Œæœ¬æ–‡çš„ç›®æ ‡æ˜¯â€œè®¾è®¡ä¸€ä¸ªç»Ÿä¸€çš„æ‰©æ•£æ¨¡å‹ç†è®ºæ¡†æ¶â€ï¼Œè¿™ä¸ªæ¡†æ¶èƒ½å¤Ÿå®Œæˆæœ¬æ–‡å¼€å¤´ç½—åˆ—å‡ºæ¥çš„ç›®æ ‡ã€‚â€œè®¾è®¡â€çš„å…³é”®æ˜¯æŠŠæ¡ä½â€œè‡ªç”±â€å’Œâ€œçº¦æŸâ€ï¼Œæœ‰ä¸€äº›éƒ¨åˆ†æ˜¯å¯ä»¥çµæ´»é€‰æ‹©çš„ï¼Œæœ‰ä¸€äº›éƒ¨åˆ†åˆ™æ˜¯å¸¦æœ‰çº¦æŸçš„ï¼Œä¸èƒ½ä¹±æ¥çš„ã€‚</p>
<p>å¦‚æœè¯»è€…å·²ç»å¯¹ç°æœ‰ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¯”è¾ƒç†Ÿæ‚‰ï¼Œæƒ³å¿…å°±èƒ½é¢†æ‚Ÿåˆ°æ‰©æ•£æ¨¡å‹çš„æœ¬è´¨æ€æƒ³å°±æ˜¯â€œä»ç ´åä¸­å­¦ä¹ å»ºè®¾â€ï¼Œå› æ­¤â€œç ´åâ€çš„æ–¹å¼ç†è®ºä¸Šæ˜¯å¯ä»¥éšæ„é€‰æ‹©çš„ï¼Œâ€œå»ºè®¾â€åˆ™æ˜¯éœ€è¦å­¦ä¹ çš„ã€‚å½“ç„¶ï¼Œâ€œç ´åâ€çš„æ–¹å¼å®é™…ä¸Šä¹Ÿä¸æ˜¯æ¯«æ— çº¦æŸï¼Œä¸€èˆ¬æ¥è¯´å¿…é¡»æ˜¯â€œæ¸è¿›å¼ç ´åâ€ï¼Œè¿™æ ·æˆ‘ä»¬æ‰èƒ½å­¦ä¼šâ€œæ¸è¿›å¼å»ºè®¾â€ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å°±æ„å»ºäº†å¼$\eqref{eq:re-param}$çš„ç ´åè¿‡ç¨‹ï¼ˆå‰å‘è¿‡ç¨‹ï¼‰ï¼Œ$t$ç”¨æ¥æè¿°ç ´åçš„è¿›åº¦ï¼Œ$\mathcal{F}$å¯ä»¥ç”¨æ¥è¡¨ç¤ºä»»æ„ç ´åæ–¹å¼ï¼Œå¯¹åŸå§‹æ•°æ®$\boldsymbol{x}_0$ä¹Ÿæ²¡æœ‰ç‰¹åˆ«é™åˆ¶ï¼Œè‡³äº$\boldsymbol{\varepsilon}$åˆ™ç”¨æ¥æè¿°ç ´åè¿‡ç¨‹ä¸­å¯èƒ½å­˜åœ¨çš„éšæœºå› ç´ ã€‚è¿™æ ·ï¼Œæˆ‘ä»¬å°±å»ºç«‹äº†ä¸€ä¸ªæœ€ä¸€èˆ¬çš„ç ´åè¿‡ç¨‹ã€‚</p>
<p>è‡³äºå»ºè®¾ï¼Œæˆ‘ä»¬é¦–å…ˆç»™å‡ºäº†åˆ†è§£å¼$\eqref{eq:p-factor}$ï¼Œè¿™æ˜¯æ¦‚ç‡è®ºæœ¬èº«ç»™å‡ºçš„ä¸€ä¸ªæ’ç­‰å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒç†è§£ä¸ºä¸€ä¸ªçº¦æŸï¼Œä¹Ÿå¯ä»¥ç†è§£ä¸ºæ˜¯ä¸€ä¸ªå¼•å¯¼ã€‚æ€ä¹ˆçŸ¥é“è¦å¾€å¼$\eqref{eq:p-factor}$æƒ³å‘¢ï¼Ÿäº‹åæ¥çœ‹ï¼Œå‰å‘è¿‡ç¨‹æ˜¯ä¸€ä¸ª$\boldsymbol{x}_0\to \boldsymbol{x}_t$çš„è¿‡ç¨‹ï¼Œæ‰€ä»¥åå‘è¿‡ç¨‹å°±åº”è¯¥å°½é‡ä¸$\boldsymbol{x}_t\to \boldsymbol{x}_0$è”ç³»èµ·æ¥ï¼Œå› æ­¤èƒ½è”æƒ³åˆ°å¼$\eqref{eq:p-factor}$ã€‚</p>
<p>åˆ†è§£å¼$\eqref{eq:p-factor}$åŒ…å«ä¸¤ä¸ªéƒ¨åˆ†ï¼Œå…¶ä¸­$p(\boldsymbol{x}<em t-1="t-1">0|\boldsymbol{x}_t)$å·²ç»å¾ˆæ˜ç¡®äº†ï¼Œå°±æ˜¯ç”¨$\boldsymbol{x}_t$æ¥é¢„æµ‹$\boldsymbol{x}_0$çš„æ¦‚ç‡ï¼Œè¿™ä¸ªéƒ¨åˆ†æ˜¾ç„¶å·²ç»æ²¡æœ‰ä»€ä¹ˆåŒ–ç®€ç©ºé—´äº†ï¼Œåªèƒ½ç›´æ¥ç”¨æ¨¡å‹æ¥å»ºæ¨¡ï¼›å¦ä¸€éƒ¨åˆ†$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0)$åˆ™æ˜¯å±äºâ€œè‡ªç”±è®¾è®¡â€çš„èŒƒç•´ï¼Œå®ƒè¦æ±‚çš„è¯ä¾¿äºé‡‡æ ·ï¼Œå…¶ä¸­çš„â€œçº¦æŸâ€åˆ™æ˜¯ç”±ä¸€ä¸ªæ’ç­‰å¼$\eqref{eq:margin}$ï¼Œè¿™ä¹Ÿæ˜¯æ¦‚ç‡è®ºæœ¬èº«ç»™å‡ºçš„ã€‚è‡³äºåé¢çš„åœ¨è¿™ä¸ªçº¦æŸä¹‹ä¸‹å»è®¾è®¡$p(\boldsymbol{x}</em>_0)$çš„è¿‡ç¨‹ï¼Œç¡®å®æœ‰äº›æŠ€å·§æ€§ï¼Œè¿™éƒ¨åˆ†æ²¡æœ‰ä»€ä¹ˆæ·å¾„ï¼Œç¬”è€…ä¹Ÿæ˜¯ç»“åˆå·²æœ‰çš„æ‰©æ•£æ¨¡å‹å·¥ä½œæ€è€ƒäº†å¾ˆä¹…ï¼Œæ‰æŠŠè¿™ä¸ªè¿‡ç¨‹æ‹æ¸…æ¥šçš„ã€‚}|\boldsymbol{x}_t, \boldsymbol{x</p>
<p>æ€»çš„æ¥è¯´ï¼Œè®¾è®¡ä¸€ä¸ªæ¨¡å‹çš„æ—¶å€™ï¼Œè¦æ—¶åˆ»çŸ¥é“è‡ªå·±è¦ä»€ä¹ˆï¼ˆâ€œè‡ªç”±â€ï¼‰ï¼Œè¿™ä¸ªæƒ³è¦çš„ä¸œè¥¿æœ‰ä»€ä¹ˆé™åˆ¶ï¼ˆâ€œçº¦æŸâ€ï¼‰ï¼Œåœ¨æ˜ç¡®â€œè‡ªç”±â€ä¸â€œçº¦æŸâ€çš„å‰æä¸‹ï¼Œå°½é‡å€Ÿé‰´å·²æœ‰çš„å·¥ä½œå’Œæ‰€å­¦çš„ç†è®ºåŸºç¡€ï¼Œä¸æ–­å¾€ç›®æ ‡å‡‘è¿‘ã€‚</p>
<h2 id="_6">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡æ„å»ºäº†ä¸€ä¸ªæ–°çš„æ‰©æ•£æ¨¡å‹ç†è®ºæ¡†æ¶ï¼ˆUnified Diffusion Modelï¼ŒUDMï¼‰ï¼Œç†è®ºä¸Šå®ƒèƒ½å¤ŸåŒ…å«ç°æœ‰çš„ç”Ÿæ´»æ‰©æ•£æ¨¡å‹ç»“æœï¼Œå¹¶ä¸”å…è®¸æ›´ä¸€èˆ¬çš„æ‰©æ•£æ–¹å¼å’Œæ•°æ®ç±»å‹ã€‚å…·ä½“çš„ä¾‹å­æˆ‘ä»¬ä¸‹ä¸€ç¯‡æ–‡ç« å†ä»‹ç»ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9262">https://spaces.ac.cn/archives/9262</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Sep. 14, 2022). ã€Š ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåï¼‰ï¼šç»Ÿä¸€æ‰©æ•£æ¨¡å‹ï¼ˆç†è®ºç¯‡ï¼‰ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9262">https://spaces.ac.cn/archives/9262</a></p>
<p>@online{kexuefm-9262,<br />
title={ ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåï¼‰ï¼šç»Ÿä¸€æ‰©æ•£æ¨¡å‹ï¼ˆç†è®ºç¯‡ï¼‰},<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={Sep},<br />
url={\url{https://spaces.ac.cn/archives/9262}},<br />
} </p>
<hr />
<h2 id="_7">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚å°†å¯¹ç»Ÿä¸€æ‰©æ•£æ¨¡å‹ï¼ˆUnified Diffusion Model, UDMï¼‰çš„ç†è®ºæ¡†æ¶è¿›è¡Œè¯¦ç»†çš„æ•°å­¦æ¨å¯¼ã€‚UDMæ¡†æ¶çš„æ ¸å¿ƒæ€æƒ³æ˜¯å°†æ‰©æ•£æ¨¡å‹ä»"åŸºäºé«˜æ–¯å™ªå£°çš„è¿ç»­æ•°æ®ç”Ÿæˆ"æ¨å¹¿åˆ°"ä»»æ„å˜æ¢ã€ä»»æ„æ•°æ®ç±»å‹"çš„ç»Ÿä¸€æ¡†æ¶ã€‚</p>
<h3 id="1">1. æ ¸å¿ƒæ¦‚å¿µä¸æ•°å­¦æ¡†æ¶</h3>
<h4 id="11">1.1 é‡å‚æ•°åŒ–æŠ€å·§çš„ä¸€èˆ¬å½¢å¼</h4>
<p>åœ¨ä¼ ç»ŸDDPMä¸­ï¼Œå‰å‘è¿‡ç¨‹å®šä¹‰ä¸ºï¼š</p>
<p>$
\boldsymbol{x}_t = \sqrt{\bar{\alpha}_t}\boldsymbol{x}_0 + \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}, \quad \boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I}) \tag{1}
$</p>
<p>è¿™åªæ˜¯ä¸€ä¸ªç‰¹ä¾‹ã€‚UDMå°†å…¶æ¨å¹¿ä¸ºä¸€èˆ¬å½¢å¼ï¼š</p>
<p>$
\boldsymbol{x}_t = \boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}), \quad \boldsymbol{\varepsilon} \sim q(\boldsymbol{\varepsilon}) \tag{2}
$</p>
<p>å…¶ä¸­ï¼š
- $\boldsymbol{\mathcal{F}}_t: \mathcal{X} \times \mathcal{E} \to \mathcal{X}$ æ˜¯ç¡®å®šæ€§å˜æ¢å‡½æ•°
- $t \in [0, T]$ æ˜¯æ‰©æ•£æ—¶é—´ï¼ˆå¯ç¦»æ•£å¯è¿ç»­ï¼‰
- $\boldsymbol{x}_0 \in \mathcal{X}$ æ˜¯åŸå§‹æ•°æ®ï¼ˆå¯è¿ç»­å¯ç¦»æ•£ï¼‰
- $\boldsymbol{\varepsilon} \in \mathcal{E}$ æ˜¯éšæœºæ‰°åŠ¨ï¼ˆä¸é™äºé«˜æ–¯ï¼‰
- $q(\boldsymbol{\varepsilon})$ æ˜¯æ˜“äºé‡‡æ ·çš„å…ˆéªŒåˆ†å¸ƒ</p>
<p><strong>å…³é”®æ€§è´¨</strong>ï¼š
1. <strong>æ¸è¿›æ€§</strong>ï¼š$t$ è¶Šå°ï¼Œ$\boldsymbol{\mathcal{F}}_t$ ä¿ç•™ $\boldsymbol{x}_0$ çš„ä¿¡æ¯è¶Šå¤š
2. <strong>ç»ˆæ€æ— å…³æ€§</strong>ï¼šå½“ $t=T$ æ—¶ï¼Œ$\boldsymbol{\mathcal{F}}_T(\boldsymbol{x}_0, \boldsymbol{\varepsilon}) \approx g(\boldsymbol{\varepsilon})$ï¼Œä¸ $\boldsymbol{x}_0$ è¿‘ä¼¼ç‹¬ç«‹</p>
<h4 id="12">1.2 å‰å‘è¿‡ç¨‹çš„æ¡ä»¶åˆ†å¸ƒ</h4>
<p>ç”±å¼ (2) å¯å¾—å‰å‘æ¡ä»¶åˆ†å¸ƒï¼š</p>
<p>$
p(\boldsymbol{x}_t|\boldsymbol{x}_0) = \int \delta(\boldsymbol{x}_t - \boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon})) q(\boldsymbol{\varepsilon}) d\boldsymbol{\varepsilon} \tag{3}
$</p>
<p>è¿™ä¸ªç§¯åˆ†å½¢å¼è¡¨æ˜ï¼Œ$\boldsymbol{x}_t$ çš„åˆ†å¸ƒæ˜¯é€šè¿‡ $\boldsymbol{\mathcal{F}}_t$ å¯¹å™ªå£°åˆ†å¸ƒ $q(\boldsymbol{\varepsilon})$ çš„æ¨å‰ï¼ˆpush-forwardï¼‰å¾—åˆ°çš„ã€‚</p>
<p><strong>ä¾‹å­</strong>ï¼šå¯¹äºä¼ ç»ŸDDPMï¼Œ$\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}) = \sqrt{\bar{\alpha}_t}\boldsymbol{x}_0 + \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}$ï¼Œå› æ­¤ï¼š</p>
<p>$
p(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t; \sqrt{\bar{\alpha}_t}\boldsymbol{x}_0, (1-\bar{\alpha}_t)\boldsymbol{I}) \tag{4}
$</p>
<h4 id="13">1.3 è¾¹ç¼˜åˆ†å¸ƒä¸æ•°æ®åˆ†å¸ƒ</h4>
<p>é€šè¿‡å¯¹ $\boldsymbol{x}_0$ æ±‚è¾¹ç¼˜åŒ–ï¼Œå¯å¾— $\boldsymbol{x}_t$ çš„è¾¹ç¼˜åˆ†å¸ƒï¼š</p>
<p>$
p(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t) = \int p(\boldsymbol{x}_t|\boldsymbol{x}_0) p(\boldsymbol{x}_0) d\boldsymbol{x}_0 = \mathbb{E}</em>
$}_0 \sim p(\boldsymbol{x}_0), \boldsymbol{\varepsilon} \sim q(\boldsymbol{\varepsilon})}[\delta(\boldsymbol{x}_t - \boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}))] \tag{5</p>
<p>å½“ $t=T$ æ—¶ï¼Œç”±ç»ˆæ€æ— å…³æ€§ï¼Œæˆ‘ä»¬æœ‰ï¼š</p>
<p>$
p(\boldsymbol{x}<em _text_prior="\text{prior">T) \approx p</em>
$}}(\boldsymbol{x}_T) = \int g(\boldsymbol{\varepsilon}) q(\boldsymbol{\varepsilon}) d\boldsymbol{\varepsilon} \tag{6</p>
<p>è¿™ä¸ªå…ˆéªŒåˆ†å¸ƒ $p_{\text{prior}}$ åº”è¯¥æ˜¯æ˜“äºé‡‡æ ·çš„ï¼ˆé€šå¸¸å°±æ˜¯ $q(\boldsymbol{\varepsilon})$ æœ¬èº«ï¼‰ã€‚</p>
<h3 id="2">2. åå‘è¿‡ç¨‹çš„ç†è®ºæ¨å¯¼</h3>
<h4 id="21">2.1 è´å¶æ–¯åˆ†è§£çš„å¿…ç„¶æ€§</h4>
<p>åå‘è¿‡ç¨‹çš„ç›®æ ‡æ˜¯ä» $\boldsymbol{x}<em t-1="t-1">t$ ç”Ÿæˆ $\boldsymbol{x}</em>$ã€‚æ ¹æ®æ¦‚ç‡è®ºåŸºæœ¬å®šç†ï¼Œæˆ‘ä»¬æœ‰ï¼š</p>
<p>$
p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t) = \int p(\boldsymbol{x}</em>}, \boldsymbol{x<em t-1="t-1">0|\boldsymbol{x}_t) d\boldsymbol{x}_0 = \int p(\boldsymbol{x}</em>
$}|\boldsymbol{x}_t, \boldsymbol{x}_0) p(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x}_0 \tag{7</p>
<p>è¿™ä¸ªåˆ†è§£ä¸æ˜¯"é€‰æ‹©"ï¼Œè€Œæ˜¯æ¦‚ç‡è®ºçš„<strong>å¿…ç„¶ç»“æœ</strong>ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šç”±æ¡ä»¶æ¦‚ç‡å®šä¹‰ï¼š</p>
<p>$
\begin{aligned}
p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t) &amp;= \frac{p(\boldsymbol{x}</em>}, \boldsymbol{x<em t-1="t-1">t)}{p(\boldsymbol{x}_t)} \
&amp;= \frac{\int p(\boldsymbol{x}</em>}, \boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0) d\boldsymbol{x}_0}{p(\boldsymbol{x}_t)} \
&amp;= \int \frac{p(\boldsymbol{x}</em>}, \boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0)}{p(\boldsymbol{x}_t, \boldsymbol{x}_0)} \cdot \frac{p(\boldsymbol{x}_t, \boldsymbol{x}_0)}{p(\boldsymbol{x}_t)} d\boldsymbol{x}_0 \
&amp;= \int p(\boldsymbol{x}</em>_0
\end{aligned} \tag{8}
$}|\boldsymbol{x}_t, \boldsymbol{x}_0) p(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x</p>
<h4 id="22-">2.2 é¢„ä¼°-ä¿®æ­£çš„ä¸¤é˜¶æ®µè§£é‡Š</h4>
<p>ä»å¼ (7) å¯ä»¥çœ‹å‡ºï¼Œåå‘é‡‡æ ·å¯ä»¥åˆ†è§£ä¸ºä¸¤ä¸ªå­æ­¥éª¤ï¼š</p>
<p><strong>æ­¥éª¤1ï¼ˆé¢„ä¼°ï¼‰</strong>ï¼šä»åéªŒåˆ†å¸ƒ $p(\boldsymbol{x}_0|\boldsymbol{x}_t)$ ä¸­é‡‡æ · $\hat{\boldsymbol{x}}_0$</p>
<p>$
\hat{\boldsymbol{x}}_0 \sim p(\boldsymbol{x}_0|\boldsymbol{x}_t) \tag{9}
$</p>
<p>æ ¹æ®è´å¶æ–¯å®šç†ï¼š</p>
<p>$
p(\boldsymbol{x}_0|\boldsymbol{x}_t) = \frac{p(\boldsymbol{x}_t|\boldsymbol{x}_0) p(\boldsymbol{x}_0)}{p(\boldsymbol{x}_t)} \propto p(\boldsymbol{x}_t|\boldsymbol{x}_0) p(\boldsymbol{x}_0) \tag{10}
$</p>
<p>ä½†è¿™ä¸ªåéªŒåˆ†å¸ƒé€šå¸¸éš¾ä»¥ç›´æ¥è®¡ç®—å’Œé‡‡æ ·ï¼Œå› æ­¤éœ€è¦ç”¨ç¥ç»ç½‘ç»œ $q(\boldsymbol{x}_0|\boldsymbol{x}_t)$ æ¥è¿‘ä¼¼ã€‚</p>
<p><strong>æ­¥éª¤2ï¼ˆä¿®æ­£ï¼‰</strong>ï¼šç»™å®šé¢„ä¼°çš„ $\hat{\boldsymbol{x}}<em t-1="t-1">0$ï¼Œä» $p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \hat{\boldsymbol{x}}_0)$ ä¸­é‡‡æ · $\boldsymbol{x}</em>$</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} \sim p(\boldsymbol{x}</em>
$}|\boldsymbol{x}_t, \boldsymbol{x}_0 = \hat{\boldsymbol{x}}_0) \tag{11</p>
<p>è¿™ä¸ªä¿®æ­£æ­¥éª¤åˆ©ç”¨äº† $\boldsymbol{x}_t$ çš„ä¿¡æ¯æ¥"çº æ­£"é¢„ä¼°ç»“æœã€‚</p>
<p><strong>æ•°å­¦éªŒè¯</strong>ï¼šé€šè¿‡è’™ç‰¹å¡æ´›é‡‡æ ·ï¼Œæˆ‘ä»¬æœ‰ï¼š</p>
<p>$
\begin{aligned}
\mathbb{E}<em t-1="t-1">{p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t)}[f(\boldsymbol{x}</em>})] &amp;= \int f(\boldsymbol{x<em t-1="t-1">{t-1}) p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t) d\boldsymbol{x}</em> \
&amp;= \int f(\boldsymbol{x}<em t-1="t-1">{t-1}) \int p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0) p(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x}_0 d\boldsymbol{x}</em> \
&amp;\approx \frac{1}{N}\sum_{i=1}^N \int f(\boldsymbol{x}<em t-1="t-1">{t-1}) p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \hat{\boldsymbol{x}}_0^{(i)}) d\boldsymbol{x}</em>
\end{aligned} \tag{12}
$</p>
<p>å…¶ä¸­ $\hat{\boldsymbol{x}}_0^{(i)} \sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)$ã€‚å½“ $N=1$ æ—¶ï¼Œè¿™å°±æ˜¯æˆ‘ä»¬çš„ä¸¤é˜¶æ®µé‡‡æ ·è¿‡ç¨‹ã€‚</p>
<h4 id="23">2.3 åéªŒåˆ†å¸ƒçš„ç¥ç»ç½‘ç»œé€¼è¿‘</h4>
<p>å¯¹äºè¿ç»­æ•°æ®ï¼Œæˆ‘ä»¬ç”¨é«˜æ–¯åˆ†å¸ƒæ¥é€¼è¿‘åéªŒï¼š</p>
<p>$
p(\boldsymbol{x}_0|\boldsymbol{x}_t) \approx q(\boldsymbol{x}_0|\boldsymbol{x}_t) = \mathcal{N}(\boldsymbol{x}_0; \boldsymbol{\mathcal{G}}_t(\boldsymbol{x}_t), \bar{\sigma}_t^2 \boldsymbol{I}) \tag{13}
$</p>
<p>å…¶ä¸­ $\boldsymbol{\mathcal{G}}_t: \mathcal{X} \to \mathcal{X}$ æ˜¯ç”±ç¥ç»ç½‘ç»œå‚æ•°åŒ–çš„é¢„æµ‹å‡½æ•°ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆé€‰æ‹©é«˜æ–¯åˆ†å¸ƒï¼Ÿ</strong></p>
<ol>
<li><strong>è®¡ç®—ä¾¿åˆ©æ€§</strong>ï¼šé«˜æ–¯åˆ†å¸ƒæœ‰è§£æå½¢å¼ï¼Œæ˜“äºè®¡ç®—å’Œé‡‡æ ·</li>
<li><strong>æœ€å¤§ç†µåŸç†</strong>ï¼šåœ¨ç»™å®šå‡å€¼å’Œæ–¹å·®çº¦æŸä¸‹ï¼Œé«˜æ–¯åˆ†å¸ƒå…·æœ‰æœ€å¤§ç†µ</li>
<li><strong>ä¸­å¿ƒæé™å®šç†</strong>ï¼šå¤šä¸ªç‹¬ç«‹éšæœºå˜é‡çš„å’Œè¶‹å‘äºé«˜æ–¯åˆ†å¸ƒ</li>
</ol>
<p>å¯¹äºç¦»æ•£æ•°æ®ï¼ˆå¦‚æ–‡æœ¬ï¼‰ï¼Œå¯ä»¥ç”¨åˆ†ç±»åˆ†å¸ƒï¼š</p>
<p>$
q(\boldsymbol{x}<em i="1">0|\boldsymbol{x}_t) = \prod</em>
$}^L \text{Categorical}(x_0^{(i)}; \boldsymbol{\pi}_{t,i}(\boldsymbol{x}_t)) \tag{14</p>
<p>å…¶ä¸­ $L$ æ˜¯åºåˆ—é•¿åº¦ï¼Œ$\boldsymbol{\pi}_{t,i}$ æ˜¯ç¬¬ $i$ ä¸ªä½ç½®çš„æ¦‚ç‡å‘é‡ã€‚</p>
<h3 id="3">3. è®­ç»ƒç›®æ ‡çš„è¯¦ç»†æ¨å¯¼</h3>
<h4 id="31">3.1 äº¤å‰ç†µæŸå¤±çš„æ¨å¯¼</h4>
<p>è®­ç»ƒç›®æ ‡æ˜¯æœ€å°åŒ–é¢„æµ‹åˆ†å¸ƒ $q(\boldsymbol{x}_0|\boldsymbol{x}_t)$ ä¸çœŸå®åéªŒ $p(\boldsymbol{x}_0|\boldsymbol{x}_t)$ ä¹‹é—´çš„KLæ•£åº¦ï¼š</p>
<p>$
\begin{aligned}
\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">{\text{KL}} &amp;= \mathbb{E}</em><em _text_KL="\text{KL">t \sim p(\boldsymbol{x}_t)}[D</em>}}(p(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">0|\boldsymbol{x}_t) | q(\boldsymbol{x}_0|\boldsymbol{x}_t))] \
&amp;= \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t}\left[\int p(\boldsymbol{x}_0|\boldsymbol{x}_t) \log \frac{p(\boldsymbol{x}_0|\boldsymbol{x}_t)}{q(\boldsymbol{x}_0|\boldsymbol{x}_t)} d\boldsymbol{x}_0\right] \
&amp;= \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t}\left[\int p(\boldsymbol{x}_0|\boldsymbol{x}_t) \log p(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x}_0\right] - \mathbb{E}</em>_0\right]
\end{aligned} \tag{15}
$}_t}\left[\int p(\boldsymbol{x}_0|\boldsymbol{x}_t) \log q(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x</p>
<p>ç¬¬ä¸€é¡¹ä¸å‚æ•°æ— å…³ï¼Œå› æ­¤ä¼˜åŒ–ç­‰ä»·äºæœ€å°åŒ–äº¤å‰ç†µï¼š</p>
<p>$
\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">{\text{CE}} = -\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t}\left[\int p(\boldsymbol{x}_0|\boldsymbol{x}_t) \log q(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x}_0\right] = -\mathbb{E}</em>
$}_t, \boldsymbol{x}_0 \sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}[\log q(\boldsymbol{x}_0|\boldsymbol{x}_t)] \tag{16</p>
<h4 id="32">3.2 ä»è”åˆåˆ†å¸ƒåˆ°ç‹¬ç«‹é‡‡æ ·</h4>
<p>åˆ©ç”¨é“¾å¼æ³•åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å°†æœŸæœ›æ”¹å†™ä¸ºï¼š</p>
<p>$
\begin{aligned}
\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">{\text{CE}} &amp;= -\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t, \boldsymbol{x}_0 \sim p(\boldsymbol{x}_0, \boldsymbol{x}_t)}[\log q(\boldsymbol{x}_0|\boldsymbol{x}_t)] \
&amp;= -\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0 \sim p(\boldsymbol{x}_0)}\left[\mathbb{E}</em>_t)]\right]
\end{aligned} \tag{17}
$}_t \sim p(\boldsymbol{x}_t|\boldsymbol{x}_0)}[\log q(\boldsymbol{x}_0|\boldsymbol{x</p>
<p>è¿›ä¸€æ­¥åˆ©ç”¨é‡å‚æ•°åŒ– (2)ï¼Œæˆ‘ä»¬æœ‰ï¼š</p>
<p>$
\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">{\text{CE}} = -\mathbb{E}</em>
$}_0 \sim \tilde{p}(\boldsymbol{x}_0), \boldsymbol{\varepsilon} \sim q(\boldsymbol{\varepsilon})}[\log q(\boldsymbol{x}_0|\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}))] \tag{18</p>
<p>å…¶ä¸­ $\tilde{p}(\boldsymbol{x}_0)$ æ˜¯è®­ç»ƒæ•°æ®åˆ†å¸ƒã€‚è¿™å°±æ˜¯æˆ‘ä»¬å®é™…ä½¿ç”¨çš„è®­ç»ƒç›®æ ‡ã€‚</p>
<h4 id="33-mse">3.3 é«˜æ–¯é€¼è¿‘ä¸‹çš„MSEæŸå¤±</h4>
<p>å½“ $q(\boldsymbol{x}_0|\boldsymbol{x}_t)$ æ˜¯é«˜æ–¯åˆ†å¸ƒ (13) æ—¶ï¼Œè´Ÿå¯¹æ•°ä¼¼ç„¶ä¸ºï¼š</p>
<p>$
\begin{aligned}
-\log q(\boldsymbol{x}_0|\boldsymbol{x}_t) &amp;= -\log \mathcal{N}(\boldsymbol{x}_0; \boldsymbol{\mathcal{G}}_t(\boldsymbol{x}_t), \bar{\sigma}_t^2 \boldsymbol{I}) \
&amp;= \frac{d}{2}\log(2\pi\bar{\sigma}_t^2) + \frac{1}{2\bar{\sigma}_t^2}|\boldsymbol{x}_0 - \boldsymbol{\mathcal{G}}_t(\boldsymbol{x}_t)|^2
\end{aligned} \tag{19}
$</p>
<p>å¿½ç•¥å¸¸æ•°é¡¹ï¼Œè®­ç»ƒç›®æ ‡ç®€åŒ–ä¸ºMSEæŸå¤±ï¼š</p>
<p>$
\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">{\text{MSE}} = \mathbb{E}</em>
$}_0 \sim \tilde{p}(\boldsymbol{x}_0), \boldsymbol{\varepsilon} \sim q(\boldsymbol{\varepsilon})}\left[\frac{1}{2\bar{\sigma}_t^2}|\boldsymbol{x}_0 - \boldsymbol{\mathcal{G}}_t(\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}))|^2\right] \tag{20</p>
<p><strong>æ–¹å·®é€‰æ‹©çš„å½±å“</strong>ï¼š
- è‹¥ $\bar{\sigma}_t^2$ è§†ä¸ºå¸¸æ•°ï¼Œåˆ™å®ƒåªå½±å“æŸå¤±çš„å°ºåº¦ï¼Œä¸å½±å“æœ€ä¼˜è§£
- è‹¥ $\bar{\sigma}_t^2 \propto t$ï¼Œåˆ™æ—©æœŸæ—¶åˆ»çš„æŸå¤±æƒé‡æ›´å¤§
- å®è·µä¸­å¸¸è®¾ $\bar{\sigma}_t^2 = 1$ æˆ–ç”¨Analytic-DPMæ–¹æ³•ä¼°è®¡</p>
<h4 id="34">3.4 ä¸å™ªå£°é¢„æµ‹çš„ç­‰ä»·æ€§</h4>
<p>åœ¨DDPMè®¾å®šä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å°† $\boldsymbol{x}_0$ é¢„æµ‹è½¬æ¢ä¸ºå™ªå£°é¢„æµ‹ã€‚ç”± $\boldsymbol{x}_t = \sqrt{\bar{\alpha}_t}\boldsymbol{x}_0 + \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}$ï¼Œè§£å‡ºï¼š</p>
<p>$
\boldsymbol{x}_0 = \frac{\boldsymbol{x}_t - \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}}{\sqrt{\bar{\alpha}_t}} \tag{21}
$</p>
<p>å› æ­¤ï¼Œé¢„æµ‹ $\boldsymbol{x}_0$ ç­‰ä»·äºé¢„æµ‹ $\boldsymbol{\varepsilon}$ï¼š</p>
<p>$
\boldsymbol{\mathcal{G}}<em>t(\boldsymbol{x}_t) = \frac{\boldsymbol{x}_t - \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}</em>\theta(\boldsymbol{x}_t, t)}{\sqrt{\bar{\alpha}_t}} \tag{22}
$</p>
<p>å°†æ­¤ä»£å…¥ (20) å¹¶åŒ–ç®€ï¼Œå¯å¾—DDPMçš„å™ªå£°é¢„æµ‹æŸå¤±ï¼š</p>
<p>$
\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">{\text{noise}} = \mathbb{E}</em><em>0, \boldsymbol{\varepsilon}, t}\left[\frac{1-\bar{\alpha}_t}{2\bar{\sigma}_t^2\bar{\alpha}_t}|\boldsymbol{\varepsilon} - \boldsymbol{\varepsilon}</em>\theta(\boldsymbol{x}_t, t)|^2\right] \tag{23}
$</p>
<p>DDPMç®€åŒ–ç‰ˆæœ¬è®¾æƒé‡ä¸º1ï¼š</p>
<p>$
\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">{\text{simple}} = \mathbb{E}</em><em>0, \boldsymbol{\varepsilon}, t}[|\boldsymbol{\varepsilon} - \boldsymbol{\varepsilon}</em>\theta(\boldsymbol{x}_t, t)|^2] \tag{24}
$</p>
<h3 id="4">4. æ¡ä»¶æ¦‚ç‡çš„è®¾è®¡ç†è®º</h3>
<h4 id="41">4.1 è¾¹ç¼˜åˆ†å¸ƒçº¦æŸ</h4>
<p>$p(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$ çš„è®¾è®¡å¿…é¡»æ»¡è¶³è¾¹ç¼˜åˆ†å¸ƒæ’ç­‰å¼ï¼š</p>
<p>$
\int p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) p(\boldsymbol{x}_t|\boldsymbol{x}_0) d\boldsymbol{x}_t = p(\boldsymbol{x}</em>
$}|\boldsymbol{x}_0) \tag{25</p>
<p><strong>è¯æ˜</strong>ï¼šç”±å…¨æ¦‚ç‡å…¬å¼ï¼š</p>
<p>$
\begin{aligned}
p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_0) &amp;= \int p(\boldsymbol{x}</em>}, \boldsymbol{x<em t-1="t-1">t|\boldsymbol{x}_0) d\boldsymbol{x}_t \
&amp;= \int p(\boldsymbol{x}</em>_t
\end{aligned} \tag{26}
$}|\boldsymbol{x}_t, \boldsymbol{x}_0) p(\boldsymbol{x}_t|\boldsymbol{x}_0) d\boldsymbol{x</p>
<p>è¿™ä¸ªçº¦æŸæ˜¯<strong>å¿…é¡»</strong>æ»¡è¶³çš„ï¼Œå¦åˆ™æ•´ä¸ªæ¦‚ç‡æ¨¡å‹æ˜¯ä¸ä¸€è‡´çš„ã€‚</p>
<h4 id="42-boldsymbolx_t">4.2 æœ€ç®€è®¾è®¡ï¼šç‹¬ç«‹äº $\boldsymbol{x}_t$</h4>
<p>æœ€ç›´æ¥çš„æ»¡è¶³çº¦æŸçš„æ–¹æ³•æ˜¯è®¾ï¼š</p>
<p>$
p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = p(\boldsymbol{x}</em>
$}|\boldsymbol{x}_0) \tag{27</p>
<p>å³ $\boldsymbol{x}_{t-1}$ åœ¨ç»™å®š $\boldsymbol{x}_0$ æ—¶ä¸ $\boldsymbol{x}_t$ æ¡ä»¶ç‹¬ç«‹ã€‚éªŒè¯çº¦æŸï¼š</p>
<p>$
\int p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_0) p(\boldsymbol{x}_t|\boldsymbol{x}_0) d\boldsymbol{x}_t = p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">0) \int p(\boldsymbol{x}_t|\boldsymbol{x}_0) d\boldsymbol{x}_t = p(\boldsymbol{x}</em>
$}|\boldsymbol{x}_0) \tag{28</p>
<p><strong>é‡‡æ ·è¿‡ç¨‹</strong>ï¼šåœ¨åå‘è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å…ˆé¢„æµ‹ $\hat{\boldsymbol{x}}<em t-1="t-1">0 \sim q(\boldsymbol{x}_0|\boldsymbol{x}_t)$ï¼Œç„¶åä» $p(\boldsymbol{x}</em>_0)$ é‡‡æ ·ã€‚}|\hat{\boldsymbol{x}</p>
<p>åˆ©ç”¨é‡å‚æ•°åŒ– (2)ï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} = \boldsymbol{\mathcal{F}}</em>
$}(\hat{\boldsymbol{x}}_0, \boldsymbol{\varepsilon}), \quad \boldsymbol{\varepsilon} \sim q(\boldsymbol{\varepsilon}) \tag{29</p>
<p><strong>ç¼ºç‚¹åˆ†æ</strong>ï¼š</p>
<ol>
<li><strong>è¯¯å·®ç´¯ç§¯</strong>ï¼š$\hat{\boldsymbol{x}}<em t-1="t-1">0$ çš„é¢„æµ‹è¯¯å·®ä¼šé€šè¿‡ $\boldsymbol{\mathcal{F}}</em>$}$ ç›´æ¥ä¼ æ’­åˆ° $\boldsymbol{x}_{t-1</li>
<li><strong>å™ªå£°ç ´å</strong>ï¼šæ–°é‡‡æ ·çš„ $\boldsymbol{\varepsilon}$ å¯èƒ½ä¼šç ´å $\hat{\boldsymbol{x}}_0$ ä¸­å·²æœ‰çš„æ­£ç¡®ä¿¡æ¯</li>
<li><strong>æœªåˆ©ç”¨ $\boldsymbol{x}_t$</strong>ï¼šå½“å‰è§‚æµ‹ $\boldsymbol{x}_t$ åŒ…å«çš„ä¿¡æ¯è¢«å®Œå…¨å¿½ç•¥</li>
</ol>
<h4 id="43">4.3 æ”¹è¿›è®¾è®¡ï¼šåŸºäºå¯é€†æ€§çš„ç¡®å®šæ€§æ˜ å°„</h4>
<p>å‡è®¾ $\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \cdot)$ å…³äº $\boldsymbol{\varepsilon}$ æ˜¯å¯é€†çš„ï¼Œå³å­˜åœ¨é€†æ˜ å°„ï¼š</p>
<p>$
\boldsymbol{\varepsilon} = \boldsymbol{\mathcal{F}}_t^{-1}(\boldsymbol{x}_0, \boldsymbol{x}_t) \tag{30}
$</p>
<p>åˆ™ä» $\boldsymbol{x}_t = \boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon})$ å’Œå·²çŸ¥çš„ $\boldsymbol{x}_0, \boldsymbol{x}_t$ å¯ä»¥åè§£å‡º $\boldsymbol{\varepsilon}$ã€‚</p>
<p><strong>å…³é”®æ€æƒ³</strong>ï¼šç”¨åè§£çš„ $\boldsymbol{\varepsilon}$ æ›¿æ¢ $\boldsymbol{x}_{t-1}$ é‡‡æ ·ä¸­çš„éšæœºå™ªå£°ï¼Œå¾—åˆ°ï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} = \boldsymbol{\mathcal{F}}</em>}(\boldsymbol{x<em t-1="t-1" t_to="t\to">0, \boldsymbol{\mathcal{F}}_t^{-1}(\boldsymbol{x}_0, \boldsymbol{x}_t)) \equiv \boldsymbol{\Phi}</em>
$}(\boldsymbol{x}_0, \boldsymbol{x}_t) \tag{31</p>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>ç¡®å®šæ€§</strong>æ˜ å°„ï¼å¯¹åº”çš„æ¡ä»¶åˆ†å¸ƒä¸ºç‹„æ‹‰å…‹deltaå‡½æ•°ï¼š</p>
<p>$
p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \delta(\boldsymbol{x}</em>
$} - \boldsymbol{\Phi}_{t\to t-1}(\boldsymbol{x}_0, \boldsymbol{x}_t)) \tag{32</p>
<p><strong>éªŒè¯è¾¹ç¼˜çº¦æŸ</strong>ï¼š</p>
<p>$
\begin{aligned}
\int p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) p(\boldsymbol{x}_t|\boldsymbol{x}_0) d\boldsymbol{x}_t
&amp;= \int \delta(\boldsymbol{x}</em>_t
\end{aligned} \tag{33}
$} - \boldsymbol{\Phi}_{t\to t-1}(\boldsymbol{x}_0, \boldsymbol{x}_t)) p(\boldsymbol{x}_t|\boldsymbol{x}_0) d\boldsymbol{x</p>
<p>åˆ©ç”¨ $\boldsymbol{x}_t = \boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon})$ï¼Œä½œå˜é‡æ›¿æ¢ $\boldsymbol{x}_t \to \boldsymbol{\varepsilon}$ï¼š</p>
<p>$
\begin{aligned}
&amp;= \int \delta(\boldsymbol{x}<em t-1="t-1">{t-1} - \boldsymbol{\mathcal{F}}</em>}(\boldsymbol{x<em t-1="t-1">0, \boldsymbol{\varepsilon})) q(\boldsymbol{\varepsilon}) \left|\det\frac{\partial \boldsymbol{\mathcal{F}}_t}{\partial \boldsymbol{\varepsilon}}\right| d\boldsymbol{\varepsilon} \
&amp;= p(\boldsymbol{x}</em>_0) \quad \checkmark
\end{aligned} \tag{34}
$}|\boldsymbol{x</p>
<p><strong>ä¼˜åŠ¿åˆ†æ</strong>ï¼š</p>
<ol>
<li><strong>æ— æ–°å™ªå£°</strong>ï¼šä¸å¼•å…¥æ–°çš„éšæœºæ€§ï¼Œé¿å…ç ´åå·²é¢„æµ‹çš„ä¿¡æ¯</li>
<li><strong>åˆ©ç”¨ $\boldsymbol{x}_t$</strong>ï¼šé€šè¿‡ $\boldsymbol{\mathcal{F}}_t^{-1}$ æå– $\boldsymbol{x}_t$ ä¸­çš„æœ‰ç”¨ä¿¡æ¯</li>
<li><strong>è¯¯å·®æ ¡æ­£</strong>ï¼š$\boldsymbol{x}_t$ æä¾›çš„çº¦æŸå¯ä»¥éƒ¨åˆ†çº æ­£ $\hat{\boldsymbol{x}}_0$ çš„è¯¯å·®</li>
</ol>
<h4 id="44-ddpm">4.4 DDPMè®¾å®šä¸‹çš„éªŒè¯</h4>
<p>å¯¹äºDDPMï¼Œ$\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}) = \sqrt{\bar{\alpha}_t}\boldsymbol{x}_0 + \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}$ï¼Œé€†æ˜ å°„ä¸ºï¼š</p>
<p>$
\boldsymbol{\varepsilon} = \frac{\boldsymbol{x}_t - \sqrt{\bar{\alpha}_t}\boldsymbol{x}_0}{\sqrt{1-\bar{\alpha}_t}} \tag{35}
$</p>
<p>ä»£å…¥ $\boldsymbol{\mathcal{F}}_{t-1}$ï¼š</p>
<p>$
\begin{aligned}
\boldsymbol{x}<em t-1="t-1">{t-1} &amp;= \sqrt{\bar{\alpha}</em>}}\boldsymbol{x<em t-1="t-1">0 + \sqrt{1-\bar{\alpha}</em>}} \cdot \frac{\boldsymbol{x<em t-1="t-1">t - \sqrt{\bar{\alpha}_t}\boldsymbol{x}_0}{\sqrt{1-\bar{\alpha}_t}} \
&amp;= \sqrt{\bar{\alpha}</em>}}\boldsymbol{x<em t-1="t-1">0 + \sqrt{\frac{1-\bar{\alpha}</em>_0)
\end{aligned} \tag{36}
$}}{1-\bar{\alpha}_t}}(\boldsymbol{x}_t - \sqrt{\bar{\alpha}_t}\boldsymbol{x</p>
<p>è¿™æ­£æ˜¯DDIMçš„ç¡®å®šæ€§é‡‡æ ·å…¬å¼ï¼ï¼ˆå¯¹åº” $\eta=0$ çš„æƒ…å†µï¼‰</p>
<h4 id="45">4.5 ä¸€èˆ¬åŒ–è®¾è®¡ï¼šæ’å€¼å™ªå£°</h4>
<p>å¯¹äºé«˜æ–¯å™ªå£° $\boldsymbol{\varepsilon} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼Œåˆ©ç”¨æ­£æ€åˆ†å¸ƒçš„å¯åŠ æ€§ï¼š</p>
<p>$
\boldsymbol{\varepsilon} \stackrel{d}{=} \sqrt{1-\tilde{\sigma}_t^2} \cdot \boldsymbol{\varepsilon}_1 + \tilde{\sigma}_t \cdot \boldsymbol{\varepsilon}_2, \quad \boldsymbol{\varepsilon}_1, \boldsymbol{\varepsilon}_2 \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I}) \text{ i.i.d.} \tag{37}
$</p>
<p>å…¶ä¸­ $\tilde{\sigma}_t \in [0, 1]$ æ˜¯å¯è°ƒå‚æ•°ã€‚æˆ‘ä»¬å¯ä»¥é€‰æ‹©ï¼š</p>
<ul>
<li>ç”¨ $\boldsymbol{\mathcal{F}}_t^{-1}(\boldsymbol{x}_0, \boldsymbol{x}_t)$ æ›¿æ¢ $\boldsymbol{\varepsilon}_1$ï¼ˆ"ç¡®å®šæ€§"éƒ¨åˆ†ï¼‰</li>
<li>é‡æ–°é‡‡æ · $\boldsymbol{\varepsilon}_2 \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼ˆ"éšæœºæ€§"éƒ¨åˆ†ï¼‰</li>
</ul>
<p>å¾—åˆ°æ’å€¼é‡‡æ ·å…¬å¼ï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} = \boldsymbol{\mathcal{F}}</em>
$}(\boldsymbol{x}_0, \sqrt{1-\tilde{\sigma}_t^2} \cdot \boldsymbol{\mathcal{F}}_t^{-1}(\boldsymbol{x}_0, \boldsymbol{x}_t) + \tilde{\sigma}_t \cdot \boldsymbol{\varepsilon}_2) \tag{38</p>
<p>å¯¹äºDDPMï¼Œè¿™å¯¹åº”ï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} = \sqrt{\bar{\alpha}</em>}}\boldsymbol{x<em t-1="t-1">0 + \sqrt{1-\bar{\alpha}</em>
$}} \left(\sqrt{1-\tilde{\sigma}_t^2} \cdot \frac{\boldsymbol{x}_t - \sqrt{\bar{\alpha}_t}\boldsymbol{x}_0}{\sqrt{1-\bar{\alpha}_t}} + \tilde{\sigma}_t \cdot \boldsymbol{\varepsilon}_2\right) \tag{39</p>
<p>è¿™æ­£æ˜¯DDIMçš„ä¸€èˆ¬å½¢å¼ï¼Œå…¶ä¸­ $\tilde{\sigma}<em t-1="t-1">t = \eta\sqrt{(1-\bar{\alpha}</em>})/(1-\bar{\alpha<em t-1="t-1">t)}\sqrt{1-\bar{\alpha}_t/\bar{\alpha}</em>$ã€‚}</p>
<p><strong>å‚æ•°é€‰æ‹©çš„å½±å“</strong>ï¼š
- $\tilde{\sigma}<em t-1="t-1">t = 0$ï¼šå®Œå…¨ç¡®å®šæ€§ï¼ˆDDIMï¼‰
- $\tilde{\sigma}_t = \sqrt{(1-\bar{\alpha}</em>})/(1-\bar{\alpha<em t-1="t-1">t)}\sqrt{1-\bar{\alpha}_t/\bar{\alpha}</em>$ï¼šéšæœºæ€§ï¼ˆDDPMï¼‰
- ä¸­é—´å€¼ï¼šç¡®å®šæ€§ä¸éšæœºæ€§çš„æŠ˜ä¸­}</p>
<h3 id="5-udm">5. UDMæ¡†æ¶çš„ç»Ÿä¸€æ€§åˆ†æ</h3>
<h4 id="51-ddpm">5.1 åŒ…å«DDPM</h4>
<p><strong>å‰å‘è¿‡ç¨‹</strong>ï¼š</p>
<p>$
\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}) = \sqrt{\bar{\alpha}_t}\boldsymbol{x}_0 + \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}, \quad \boldsymbol{\varepsilon} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I}) \tag{40}
$</p>
<p><strong>åéªŒé€¼è¿‘</strong>ï¼š</p>
<p>$
q(\boldsymbol{x}<em>0|\boldsymbol{x}_t) = \mathcal{N}\left(\boldsymbol{x}_0; \frac{\boldsymbol{x}_t - \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}</em>\theta(\boldsymbol{x}_t, t)}{\sqrt{\bar{\alpha}_t}}, \sigma_t^2 \boldsymbol{I}\right) \tag{41}
$</p>
<p><strong>æ¡ä»¶åˆ†å¸ƒ</strong>ï¼šDDPMåŸè®ºæ–‡æ¨å¯¼çš„åéªŒä¸ºï¼š</p>
<p>$
p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}</em>
$}; \tilde{\boldsymbol{\mu}}_t(\boldsymbol{x}_t, \boldsymbol{x}_0), \tilde{\beta}_t \boldsymbol{I}) \tag{42</p>
<p>å…¶ä¸­ï¼š</p>
<p>$
\tilde{\boldsymbol{\mu}}<em t-1="t-1">t = \frac{\sqrt{\bar{\alpha}</em>}}\beta_t}{1-\bar{\alpha<em t-1="t-1">t}\boldsymbol{x}_0 + \frac{\sqrt{\alpha_t}(1-\bar{\alpha}</em>})}{1-\bar{\alpha<em t-1="t-1">t}\boldsymbol{x}_t, \quad \tilde{\beta}_t = \frac{1-\bar{\alpha}</em>
$}}{1-\bar{\alpha}_t}\beta_t \tag{43</p>
<p>è¿™ä¹Ÿæ»¡è¶³è¾¹ç¼˜çº¦æŸ (25)ã€‚</p>
<h4 id="52-ddim">5.2 åŒ…å«DDIM</h4>
<p>DDIMä½¿ç”¨ç¡®å®šæ€§æ˜ å°„ (32)ï¼Œå¯¹åº”UDMçš„å¯é€†è®¾è®¡ã€‚DDIMçš„ODEé‡‡æ ·ï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} = \sqrt{\bar{\alpha}</em>}}\underbrace{\left(\frac{\boldsymbol{x<em>t - \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}</em>\theta}{\sqrt{\bar{\alpha}<em _hat_boldsymbol_x="\hat{\boldsymbol{x">t}}\right)}</em>}<em t-1="t-1">0} + \sqrt{1-\bar{\alpha}</em>
$}}\boldsymbol{\varepsilon}_\theta \tag{44</p>
<p>å¯ä»¥å†™æˆUDMå½¢å¼ï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} = \boldsymbol{\mathcal{F}}</em>
$}\left(\hat{\boldsymbol{x}}_0, \frac{\boldsymbol{x}_t - \sqrt{\bar{\alpha}_t}\hat{\boldsymbol{x}}_0}{\sqrt{1-\bar{\alpha}_t}}\right) \tag{45</p>
<h4 id="53-score-based-sde">5.3 åŒ…å«Score-based SDE</h4>
<p>è¿ç»­æ—¶é—´æƒ…å†µä¸‹ï¼Œä»¤ $\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}) = \alpha_t \boldsymbol{x}_0 + \sigma_t \boldsymbol{\varepsilon}$ï¼Œå½“ $\Delta t \to 0$ æ—¶ï¼š</p>
<p>$
d\boldsymbol{x} = \frac{d\alpha_t}{\alpha_t}\boldsymbol{x} dt + \sqrt{\frac{d\sigma_t^2}{dt} - \frac{2\sigma_t^2 d\alpha_t}{\alpha_t dt}} d\boldsymbol{w} \tag{46}
$</p>
<p>è¿™æ­£æ˜¯VE-SDEæˆ–VP-SDEçš„å½¢å¼ã€‚åå‘SDEä¸ºï¼š</p>
<p>$
d\boldsymbol{x} = \left[\frac{d\alpha_t}{\alpha_t}\boldsymbol{x} - \left(\frac{d\sigma_t^2}{dt} - \frac{2\sigma_t^2 d\alpha_t}{\alpha_t dt}\right)\nabla_{\boldsymbol{x}}\log p_t(\boldsymbol{x})\right] dt + \sqrt{\frac{d\sigma_t^2}{dt} - \frac{2\sigma_t^2 d\alpha_t}{\alpha_t dt}} d\bar{\boldsymbol{w}} \tag{47}
$</p>
<p>å…¶ä¸­ $\nabla_{\boldsymbol{x}}\log p_t(\boldsymbol{x})$ ç”± $\boldsymbol{\mathcal{G}}_t$ é€¼è¿‘ã€‚</p>
<h3 id="6-udm">6. å¤šè§’åº¦ç†è§£UDMæ¡†æ¶</h3>
<h4 id="61">6.1 ä¿¡æ¯è®ºè§†è§’</h4>
<p>ä»ä¿¡æ¯è®ºè§’åº¦ï¼Œæ‰©æ•£è¿‡ç¨‹å¯ä»¥ç†è§£ä¸º<strong>ä¿¡æ¯é€æ­¥ä¸¢å¤±</strong>çš„è¿‡ç¨‹ï¼š</p>
<p>$
I(\boldsymbol{x}_0; \boldsymbol{x}_t) = H(\boldsymbol{x}_0) - H(\boldsymbol{x}_0|\boldsymbol{x}_t) \tag{48}
$</p>
<p>å…¶ä¸­ $I$ æ˜¯äº’ä¿¡æ¯ï¼Œ$H$ æ˜¯ç†µã€‚éšç€ $t$ å¢å¤§ï¼š</p>
<ul>
<li>$I(\boldsymbol{x}_0; \boldsymbol{x}_t)$ é€’å‡ï¼ˆä¿¡æ¯ä¸¢å¤±ï¼‰</li>
<li>$H(\boldsymbol{x}_0|\boldsymbol{x}_t)$ é€’å¢ï¼ˆä¸ç¡®å®šæ€§å¢å¤§ï¼‰</li>
</ul>
<p>åå‘è¿‡ç¨‹åˆ™æ˜¯<strong>ä¿¡æ¯é€æ­¥æ¢å¤</strong>ï¼šé€šè¿‡é¢„æµ‹ $p(\boldsymbol{x}<em t-1="t-1">0|\boldsymbol{x}_t)$ å’Œä¿®æ­£ $p(\boldsymbol{x}</em>}|\boldsymbol{x<em t_="t'">t, \boldsymbol{x}_0)$ï¼Œé€æ­¥å‡å°‘ $H(\boldsymbol{x}_0|\boldsymbol{x}</em>)$ï¼ˆ$t' &lt; t$ï¼‰ã€‚</p>
<h4 id="62">6.2 å‡½æ•°é€¼è¿‘è§†è§’</h4>
<p>æ‰©æ•£æ¨¡å‹å¯ä»¥çœ‹ä½œå­¦ä¹ ä¸€ç³»åˆ—<strong>é€†æ˜ å°„</strong>ï¼š</p>
<p>$
\boldsymbol{\mathcal{G}}_t: \boldsymbol{x}_t \mapsto \hat{\boldsymbol{x}}_0 \tag{49}
$</p>
<p>è®­ç»ƒç›®æ ‡æ˜¯ä½¿ $\boldsymbol{\mathcal{G}}_t \circ \boldsymbol{\mathcal{F}}_t \approx \text{id}$ï¼ˆæ’ç­‰æ˜ å°„ï¼‰ï¼š</p>
<p>$
|\boldsymbol{\mathcal{G}}_t(\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon})) - \boldsymbol{x}_0|^2 \to \min \tag{50}
$</p>
<p>è¿™ç±»ä¼¼äº<strong>è‡ªç¼–ç å™¨</strong>çš„é‡æ„ç›®æ ‡ï¼Œä½†æœ‰ä¸¤ä¸ªå…³é”®åŒºåˆ«ï¼š</p>
<ol>
<li>ç¼–ç å™¨ $\boldsymbol{\mathcal{F}}_t$ æ˜¯å›ºå®šçš„ï¼ˆéå­¦ä¹ çš„ï¼‰</li>
<li>å¯¹æ¯ä¸ªæ—¶é—´æ­¥ $t$ éƒ½å­¦ä¹ ä¸€ä¸ªè§£ç å™¨ $\boldsymbol{\mathcal{G}}_t$</li>
</ol>
<h4 id="63">6.3 åŠ¨åŠ›ç³»ç»Ÿè§†è§’</h4>
<p>è¿ç»­æ—¶é—´UDMå®šä¹‰äº†ä¸€ä¸ª<strong>æ—¶é—´åè½¬çš„åŠ¨åŠ›ç³»ç»Ÿ</strong>ï¼š</p>
<p>$
\frac{d\boldsymbol{x}}{dt} = \boldsymbol{v}_t(\boldsymbol{x}) \tag{51}
$</p>
<p>å…¶ä¸­é€Ÿåº¦åœº $\boldsymbol{v}_t$ ç”±é¢„æµ‹-ä¿®æ­£æœºåˆ¶å®šä¹‰ï¼š</p>
<p>$
\boldsymbol{v}<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x}_t) = \mathbb{E}</em><em t-dt="t-dt" t_to="t\to">0 \sim q(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\frac{\partial}{\partial t}\boldsymbol{\Phi}</em>
$}(\boldsymbol{x}_0, \boldsymbol{x}_t)\right] \tag{52</p>
<p>è¿™ä¸ªåŠ¨åŠ›ç³»ç»Ÿçš„<strong>ä¸å˜æ€§è´¨</strong>ï¼š
- è½¨è¿¹ $\boldsymbol{x}_T \to \boldsymbol{x}_0$ åœ¨åˆ†å¸ƒæ„ä¹‰ä¸‹æ”¶æ•›åˆ°æ•°æ®åˆ†å¸ƒ
- èƒ½é‡å‡½æ•° $-\log p_t(\boldsymbol{x}_t)$ æ²¿è½¨è¿¹é€’å‡</p>
<h4 id="64">6.4 ä¼˜åŒ–è§†è§’</h4>
<p>æ¯ä¸€æ­¥é‡‡æ · $\boldsymbol{x}<em t-1="t-1">t \to \boldsymbol{x}</em>$ å¯ä»¥çœ‹ä½œ<strong>è¿‘ä¼¼åéªŒæ¨æ–­</strong>ï¼š</p>
<p>$
\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">{t-1}^* = \arg\max</em><em t-1="t-1">{t-1}} \log p(\boldsymbol{x}</em>
$}|\boldsymbol{x}_t) \tag{53</p>
<p>é¢„æµ‹-ä¿®æ­£åˆ†è§£è¿‘ä¼¼æ±‚è§£è¿™ä¸ªä¼˜åŒ–é—®é¢˜ï¼š</p>
<p>$
\begin{aligned}
\hat{\boldsymbol{x}}<em _boldsymbol_x="\boldsymbol{x">0 &amp;= \arg\max</em><em t-1="t-1">0} \log q(\boldsymbol{x}_0|\boldsymbol{x}_t) \quad &amp;\text{ï¼ˆé¢„æµ‹ï¼šè¿‘ä¼¼MAPä¼°è®¡ï¼‰} \
\boldsymbol{x}</em>
\end{aligned} \tag{54}
$} &amp;= \mathbb{E}[\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \hat{\boldsymbol{x}}_0] \quad &amp;\text{ï¼ˆä¿®æ­£ï¼šæ¡ä»¶æœŸæœ›ï¼‰</p>
<h3 id="7">7. å®ä¾‹åº”ç”¨ä¸ç®—æ³•å®ç°</h3>
<h4 id="71-cold-diffusion">7.1 Cold Diffusionå®ä¾‹</h4>
<p>Cold Diffusionä½¿ç”¨<strong>ç¡®å®šæ€§é™è´¨</strong>ï¼ˆå¦‚æ¨¡ç³Šï¼‰è€Œééšæœºå™ªå£°ï¼š</p>
<p>$
\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}) = \text{Blur}_t(\boldsymbol{x}_0), \quad t \in [0, 1] \tag{55}
$</p>
<p>å…¶ä¸­ $\text{Blur}_t$ æ˜¯é«˜æ–¯æ¨¡ç³Šï¼Œ$\varepsilon$ å®é™…ä¸Šä¸èµ·ä½œç”¨ï¼ˆå¯ä»¥çœç•¥ï¼‰ã€‚</p>
<p><strong>é€†æ˜ å°„</strong>ï¼šç”±äºæ²¡æœ‰éšæœºæ€§ï¼Œ$\boldsymbol{\mathcal{F}}_t$ ä¸å¯é€†ã€‚ä½†æˆ‘ä»¬å¯ä»¥ç”¨å»æ¨¡ç³Šç½‘ç»œ $\boldsymbol{\mathcal{G}}_t$ å­¦ä¹ é€†æ˜ å°„ã€‚</p>
<p><strong>é‡‡æ ·å…¬å¼</strong>ï¼šä½¿ç”¨æœ€ç®€è®¾è®¡ (27)ï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} = \text{Blur}</em>
$}(\hat{\boldsymbol{x}}_0), \quad \hat{\boldsymbol{x}}_0 = \boldsymbol{\mathcal{G}}_t(\boldsymbol{x}_t) \tag{56</p>
<p><strong>è®­ç»ƒç®—æ³•</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="err">è¾“å…¥</span><span class="o">:</span><span class="w"> </span><span class="err">æ•°æ®é›†</span><span class="w"> </span><span class="o">{</span><span class="n">x_0</span><span class="o">^(</span><span class="n">i</span><span class="o">)},</span><span class="w"> </span><span class="err">æ¨¡ç³Šç®—å­</span><span class="w"> </span><span class="n">Blur_t</span>
<span class="err">åˆå§‹åŒ–</span><span class="o">:</span><span class="w"> </span><span class="err">å»æ¨¡ç³Šç½‘ç»œ</span><span class="w"> </span><span class="n">G_Î¸</span>
<span class="k">for</span><span class="w"> </span><span class="n">epoch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="o">,</span><span class="w"> </span><span class="o">...</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="err">é‡‡æ ·</span><span class="w"> </span><span class="n">x_0</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="err">è®­ç»ƒæ•°æ®</span>
<span class="w">    </span><span class="err">é‡‡æ ·</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">Uniform</span><span class="o">[</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="mi">1</span><span class="o">]</span>
<span class="w">    </span><span class="err">è®¡ç®—</span><span class="w"> </span><span class="n">x_t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Blur_t</span><span class="o">(</span><span class="n">x_0</span><span class="o">)</span>
<span class="w">    </span><span class="err">é¢„æµ‹</span><span class="w"> </span><span class="n">x</span><span class="err">Ì‚</span><span class="n">_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">G_Î¸</span><span class="o">(</span><span class="n">x_t</span><span class="o">,</span><span class="w"> </span><span class="n">t</span><span class="o">)</span>
<span class="w">    </span><span class="err">æŸå¤±</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">||</span><span class="n">x_0</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="err">Ì‚</span><span class="n">_0</span><span class="o">||</span><span class="err">Â²</span>
<span class="w">    </span><span class="err">æ›´æ–°</span><span class="w"> </span><span class="err">Î¸</span><span class="w"> </span><span class="err">ä½¿</span><span class="w"> </span><span class="n">L</span><span class="w"> </span><span class="err">æœ€å°</span>
<span class="n">end</span><span class="w"> </span><span class="k">for</span>
</code></pre></div>

<h4 id="72-mask-based">7.2 ç¦»æ•£æ‰©æ•£å®ä¾‹ï¼ˆMask-basedï¼‰</h4>
<p>å¯¹äºæ–‡æœ¬æ•°æ®ï¼Œä½¿ç”¨<strong>æ©ç </strong>ä½œä¸ºé™è´¨ï¼š</p>
<p>$
\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon}) = \boldsymbol{m}_t \odot \boldsymbol{x}_0 + (1 - \boldsymbol{m}_t) \odot [\text{MASK}] \tag{57}
$</p>
<p>å…¶ä¸­ $\boldsymbol{m}_t \in {0, 1}^L$ æ˜¯äºŒå€¼æ©ç ï¼Œ$\boldsymbol{m}_t$ ä¸­1çš„æ¯”ä¾‹ä¸º $1-t/T$ã€‚</p>
<p><strong>åéªŒé€¼è¿‘</strong>ï¼šä½¿ç”¨è‡ªå›å½’æˆ–éè‡ªå›å½’è¯­è¨€æ¨¡å‹ï¼š</p>
<p>$
q(\boldsymbol{x}<em i="1">0|\boldsymbol{x}_t) = \prod</em>}^L q(x_0^{(i)}|\boldsymbol{x<em i="1">t) = \prod</em>
$}^L \text{Softmax}(\boldsymbol{W}_t \boldsymbol{h}_i(\boldsymbol{x}_t)) \tag{58</p>
<p><strong>é‡‡æ ·å…¬å¼</strong>ï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} = \boldsymbol{m}</em>} \odot \hat{\boldsymbol{x}<em t-1="t-1">0 + (1 - \boldsymbol{m}</em>
$}) \odot [\text{MASK}] \tag{59</p>
<p>å…¶ä¸­ $\hat{\boldsymbol{x}}_0 \sim q(\boldsymbol{x}_0|\boldsymbol{x}_t)$ã€‚</p>
<h4 id="73-udm">7.3 é€šç”¨UDMé‡‡æ ·ç®—æ³•</h4>
<div class="codehilite"><pre><span></span><code><span class="err">ç®—æ³•</span><span class="o">:</span><span class="w"> </span><span class="n">UDMé€šç”¨é‡‡æ ·</span>
<span class="err">è¾“å…¥</span><span class="o">:</span><span class="w"> </span><span class="err">å˜æ¢</span><span class="w"> </span><span class="n">F_t</span><span class="o">,</span><span class="w"> </span><span class="err">é€†å˜æ¢</span><span class="w"> </span><span class="n">F_t</span><span class="o">^{-</span><span class="mi">1</span><span class="o">},</span><span class="w"> </span><span class="err">é¢„æµ‹ç½‘ç»œ</span><span class="w"> </span><span class="n">G_Î¸</span><span class="o">,</span><span class="w"> </span><span class="err">åˆå§‹</span><span class="w"> </span><span class="n">x_T</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">p_prior</span>
<span class="err">è¾“å‡º</span><span class="o">:</span><span class="w"> </span><span class="err">ç”Ÿæˆæ ·æœ¬</span><span class="w"> </span><span class="n">x_0</span>

<span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">T</span><span class="o">,</span><span class="w"> </span><span class="n">T</span><span class="o">-</span><span class="mi">1</span><span class="o">,</span><span class="w"> </span><span class="o">...,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">do</span>
<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="err">æ­¥éª¤</span><span class="mi">1</span><span class="o">:</span><span class="w"> </span><span class="err">é¢„æµ‹åŸå§‹æ•°æ®</span>
<span class="w">    </span><span class="n">x</span><span class="err">Ì‚</span><span class="n">_0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">G_Î¸</span><span class="o">(</span><span class="n">x_t</span><span class="o">,</span><span class="w"> </span><span class="n">t</span><span class="o">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">ä»</span><span class="w"> </span><span class="n">q</span><span class="o">(</span><span class="n">x_0</span><span class="o">|</span><span class="n">x_t</span><span class="o">)</span><span class="w"> </span><span class="err">é‡‡æ ·ï¼ˆæˆ–å–å‡å€¼ï¼‰</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="err">æ­¥éª¤</span><span class="mi">2</span><span class="n">a</span><span class="o">:</span><span class="w"> </span><span class="err">ç¡®å®šæ€§ä¿®æ­£ï¼ˆå¦‚æœ</span><span class="w"> </span><span class="n">F_t</span><span class="w"> </span><span class="err">å¯é€†ï¼‰</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">F_t</span><span class="w"> </span><span class="err">å¯é€†</span><span class="w"> </span><span class="n">then</span>
<span class="w">        </span><span class="err">Îµ</span><span class="n">_recon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_t</span><span class="o">^{-</span><span class="mi">1</span><span class="o">}(</span><span class="n">x</span><span class="err">Ì‚</span><span class="n">_0</span><span class="o">,</span><span class="w"> </span><span class="n">x_t</span><span class="o">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">åè§£å™ªå£°</span>
<span class="w">        </span><span class="n">x_</span><span class="o">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="o">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_</span><span class="o">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="o">}(</span><span class="n">x</span><span class="err">Ì‚</span><span class="n">_0</span><span class="o">,</span><span class="w"> </span><span class="err">Îµ</span><span class="n">_recon</span><span class="o">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">ç¡®å®šæ€§æ˜ å°„</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="err">æ­¥éª¤</span><span class="mi">2</span><span class="n">b</span><span class="o">:</span><span class="w"> </span><span class="err">éšæœºä¿®æ­£ï¼ˆå¦‚æœ</span><span class="w"> </span><span class="n">F_t</span><span class="w"> </span><span class="err">ä¸å¯é€†æˆ–éœ€è¦éšæœºæ€§ï¼‰</span>
<span class="w">    </span><span class="k">else</span>
<span class="w">        </span><span class="n">x_</span><span class="o">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="o">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_</span><span class="o">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="o">}(</span><span class="n">x</span><span class="err">Ì‚</span><span class="n">_0</span><span class="o">,</span><span class="w"> </span><span class="err">Îµ</span><span class="n">_new</span><span class="o">)</span><span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="err">Îµ</span><span class="n">_new</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">q</span><span class="o">(</span><span class="err">Îµ</span><span class="o">)</span>
<span class="w">    </span><span class="n">end</span><span class="w"> </span><span class="k">if</span>

<span class="w">    </span><span class="err">#</span><span class="w"> </span><span class="err">æ­¥éª¤</span><span class="mi">2</span><span class="n">c</span><span class="o">:</span><span class="w"> </span><span class="err">æ··åˆä¿®æ­£ï¼ˆ</span><span class="n">DDIMæ³›åŒ–</span><span class="err">ï¼Œä»…é™é«˜æ–¯å™ªå£°ï¼‰</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="err">ä½¿ç”¨æ’å€¼</span><span class="w"> </span><span class="n">then</span>
<span class="w">        </span><span class="err">Îµ</span><span class="n">_recon</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_t</span><span class="o">^{-</span><span class="mi">1</span><span class="o">}(</span><span class="n">x</span><span class="err">Ì‚</span><span class="n">_0</span><span class="o">,</span><span class="w"> </span><span class="n">x_t</span><span class="o">)</span>
<span class="w">        </span><span class="err">Îµ</span><span class="n">_new</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">N</span><span class="o">(</span><span class="mi">0</span><span class="o">,</span><span class="w"> </span><span class="n">I</span><span class="o">)</span>
<span class="w">        </span><span class="err">Îµ</span><span class="n">_mixed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">âˆš</span><span class="o">(</span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="err">ÏƒÌƒ</span><span class="n">_tÂ²</span><span class="o">)</span><span class="w"> </span><span class="err">Â·</span><span class="w"> </span><span class="err">Îµ</span><span class="n">_recon</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="err">ÏƒÌƒ</span><span class="n">_t</span><span class="w"> </span><span class="err">Â·</span><span class="w"> </span><span class="err">Îµ</span><span class="n">_new</span>
<span class="w">        </span><span class="n">x_</span><span class="o">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="o">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">F_</span><span class="o">{</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="o">}(</span><span class="n">x</span><span class="err">Ì‚</span><span class="n">_0</span><span class="o">,</span><span class="w"> </span><span class="err">Îµ</span><span class="n">_mixed</span><span class="o">)</span>
<span class="w">    </span><span class="n">end</span><span class="w"> </span><span class="k">if</span>
<span class="n">end</span><span class="w"> </span><span class="k">for</span>

<span class="k">return</span><span class="w"> </span><span class="n">x_0</span>
</code></pre></div>

<h3 id="8">8. ç†è®ºæ€§è´¨ä¸æ”¶æ•›æ€§åˆ†æ</h3>
<h4 id="81">8.1 è¿‘ä¼¼è¯¯å·®çš„ä¼ æ’­</h4>
<p>è®¾é¢„æµ‹è¯¯å·®ä¸º $\boldsymbol{e}_t = \hat{\boldsymbol{x}}_0 - \boldsymbol{x}_0$ï¼Œåˆ™ï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} - \boldsymbol{x}</em>}^* = \boldsymbol{\mathcal{F}<em t-1="t-1">{t-1}(\hat{\boldsymbol{x}}_0, \boldsymbol{\varepsilon}) - \boldsymbol{\mathcal{F}}</em>}(\boldsymbol{x<em t-1="t-1">0, \boldsymbol{\varepsilon}) \approx \frac{\partial \boldsymbol{\mathcal{F}}</em>}}{\partial \boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">0}\bigg|</em>
$}_0} \boldsymbol{e}_t \tag{60</p>
<p>è¯¯å·®æ”¾å¤§ç³»æ•°ä¸º $\left|\frac{\partial \boldsymbol{\mathcal{F}}_{t-1}}{\partial \boldsymbol{x}_0}\right|$ã€‚</p>
<p>å¯¹äºDDPMï¼Œ$\frac{\partial \boldsymbol{\mathcal{F}}<em t-1="t-1">{t-1}}{\partial \boldsymbol{x}_0} = \sqrt{\bar{\alpha}</em>$ï¼Œå› æ­¤ï¼š}} \boldsymbol{I</p>
<p>$
|\boldsymbol{x}<em t-1="t-1">{t-1} - \boldsymbol{x}</em>
$}^*| \lesssim \sqrt{\bar{\alpha}_{t-1}} |\boldsymbol{e}_t| \tag{61</p>
<p>ç”±äº $\bar{\alpha}_{t-1} &lt; 1$ï¼Œè¯¯å·®ä¼šè¢«<strong>è¡°å‡</strong>ï¼Œè¿™æœ‰åŠ©äºç¨³å®šæ€§ã€‚</p>
<h4 id="82">8.2 ç¡®å®šæ€§é‡‡æ ·çš„ä¼˜åŠ¿</h4>
<p>ä½¿ç”¨ç¡®å®šæ€§æ˜ å°„ (32) æ—¶ï¼Œè¯¯å·®ä¼ æ’­å˜ä¸ºï¼š</p>
<p>$
\boldsymbol{x}<em t-1="t-1">{t-1} - \boldsymbol{x}</em>^<em> = \boldsymbol{\Phi}<em t-1="t-1" t_to="t\to">{t\to t-1}(\hat{\boldsymbol{x}}_0, \boldsymbol{x}_t) - \boldsymbol{\Phi}</em>_t^}(\boldsymbol{x}_0, \boldsymbol{x</em>) \tag{62}
$</p>
<p>ç”±äº $\boldsymbol{x}_t$ æä¾›äº†é¢å¤–çš„çº¦æŸï¼Œ$\boldsymbol{\Phi}$ å¯ä»¥éƒ¨åˆ†è¡¥å¿ $\hat{\boldsymbol{x}}_0$ çš„è¯¯å·®ã€‚</p>
<p><strong>ç›´è§‰</strong>ï¼šå¦‚æœ $\hat{\boldsymbol{x}}_0$ åœ¨æŸä¸ªæ–¹å‘ä¸Šæœ‰è¯¯å·®ï¼Œä½† $\boldsymbol{x}_t$ æ°å¥½åæ˜ äº†çœŸå®çš„å™ªå£°æ¨¡å¼ï¼Œé‚£ä¹ˆé€šè¿‡ $\boldsymbol{\mathcal{F}}_t^{-1}$ åè§£å¯ä»¥"çº æ­£"è¿™ä¸ªè¯¯å·®ã€‚</p>
<h4 id="83">8.3 æ”¶æ•›æ€§å®šç†ï¼ˆç®€åŒ–ç‰ˆï¼‰</h4>
<p><strong>å®šç†</strong>ï¼šå‡è®¾ $\boldsymbol{\mathcal{G}}_t$ æ»¡è¶³ï¼š</p>
<p>$
\mathbb{E}_{\boldsymbol{x}_0, \boldsymbol{\varepsilon}}[|\boldsymbol{\mathcal{G}}_t(\boldsymbol{\mathcal{F}}_t(\boldsymbol{x}_0, \boldsymbol{\varepsilon})) - \boldsymbol{x}_0|^2] \leq \delta_t^2 \tag{63}
$</p>
<p>åˆ™ç”Ÿæˆåˆ†å¸ƒ $p_{\text{gen}}(\boldsymbol{x}<em _text_data="\text{data">0)$ ä¸çœŸå®åˆ†å¸ƒ $p</em>_0)$ çš„2-Wassersteinè·ç¦»æ»¡è¶³ï¼š}}(\boldsymbol{x</p>
<p>$
W_2(p_{\text{gen}}, p_{\text{data}}) \leq C \sum_{t=1}^T \gamma_t \delta_t \tag{64}
$</p>
<p>å…¶ä¸­ $\gamma_t = \left|\frac{\partial \boldsymbol{\mathcal{F}}_t}{\partial \boldsymbol{x}_0}\right|$ï¼Œ$C$ æ˜¯å¸¸æ•°ã€‚</p>
<p><strong>æ¨è®º</strong>ï¼šå½“é¢„æµ‹è¯¯å·® $\delta_t$ è¶³å¤Ÿå°ä¸”æ­¥æ•° $T$ é€‚ä¸­æ—¶ï¼Œç”Ÿæˆåˆ†å¸ƒæ¥è¿‘çœŸå®åˆ†å¸ƒã€‚</p>
<h3 id="9">9. æ€»ç»“ä¸ç†è®ºå¯ç¤º</h3>
<h4 id="91-udm">9.1 UDMæ¡†æ¶çš„æ ¸å¿ƒè´¡çŒ®</h4>
<ol>
<li><strong>ç»Ÿä¸€æ€§</strong>ï¼šå°†DDPMã€DDIMã€Score SDEã€Cold Diffusionç­‰ç»Ÿä¸€åˆ°ä¸€ä¸ªæ¡†æ¶</li>
<li><strong>çµæ´»æ€§</strong>ï¼šæ”¯æŒä»»æ„å˜æ¢ $\boldsymbol{\mathcal{F}}_t$ã€ä»»æ„æ•°æ®ç±»å‹ã€ä»»æ„å™ªå£°åˆ†å¸ƒ</li>
<li><strong>æ¨¡å—åŒ–</strong>ï¼šæ¸…æ™°åˆ†ç¦»å‰å‘è¿‡ç¨‹ã€åéªŒé€¼è¿‘ã€æ¡ä»¶è®¾è®¡ä¸‰ä¸ªç»„ä»¶</li>
<li><strong>ç†è®ºæŒ‡å¯¼</strong>ï¼šæä¾›è¾¹ç¼˜çº¦æŸ (25) ä½œä¸ºè®¾è®¡å‡†åˆ™</li>
</ol>
<h4 id="92">9.2 è®¾è®¡å“²å­¦</h4>
<p>æ‰©æ•£æ¨¡å‹çš„æœ¬è´¨æ˜¯<strong>"ä»ç ´åä¸­å­¦ä¹ å»ºè®¾"</strong>ï¼š</p>
<ul>
<li><strong>ç ´åï¼ˆå‰å‘ï¼‰</strong>ï¼šæ¸è¿›å¼ä¿¡æ¯ä¸¢å¤±ï¼Œ$\boldsymbol{x}_0 \to \boldsymbol{x}_T$</li>
<li><strong>å»ºè®¾ï¼ˆåå‘ï¼‰</strong>ï¼šæ¸è¿›å¼ä¿¡æ¯æ¢å¤ï¼Œ$\boldsymbol{x}_T \to \boldsymbol{x}_0$</li>
</ul>
<p>å…³é”®æ˜¯å¹³è¡¡<strong>è‡ªç”±</strong>ä¸<strong>çº¦æŸ</strong>ï¼š</p>
<ul>
<li><strong>è‡ªç”±</strong>ï¼šé€‰æ‹© $\boldsymbol{\mathcal{F}}_t$ã€$q(\boldsymbol{\varepsilon})$ã€$q(\boldsymbol{x}_0|\boldsymbol{x}_t)$ çš„å½¢å¼</li>
<li><strong>çº¦æŸ</strong>ï¼šæ»¡è¶³è¾¹ç¼˜åˆ†å¸ƒæ’ç­‰å¼ (25)ã€æ˜“äºé‡‡æ ·ã€è®¡ç®—é«˜æ•ˆ</li>
</ul>
<h4 id="93">9.3 æœªæ¥ç ”ç©¶æ–¹å‘</h4>
<ol>
<li><strong>æœ€ä¼˜ $\boldsymbol{\mathcal{F}}_t$ è®¾è®¡</strong>ï¼šä»€ä¹ˆæ ·çš„å˜æ¢èƒ½æœ€å¿«æ”¶æ•›ï¼Ÿ</li>
<li><strong>è‡ªé€‚åº”æ­¥é•¿</strong>ï¼šå¦‚ä½•æ ¹æ® $\boldsymbol{x}_t$ åŠ¨æ€è°ƒæ•´æ—¶é—´æ­¥ï¼Ÿ</li>
<li><strong>å¤šæ¨¡æ€ç»Ÿä¸€</strong>ï¼šå¦‚ä½•åœ¨åŒä¸€æ¡†æ¶å¤„ç†å›¾åƒ+æ–‡æœ¬+éŸ³é¢‘ï¼Ÿ</li>
<li><strong>ç†è®ºä¿è¯</strong>ï¼šåœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹èƒ½ä¿è¯ç”Ÿæˆè´¨é‡ï¼Ÿ</li>
</ol>
<h4 id="94">9.4 æ•°å­¦ä¹‹ç¾</h4>
<p>UDMæ¡†æ¶å±•ç¤ºäº†æ•°å­¦å»ºæ¨¡çš„é­…åŠ›ï¼š</p>
<ul>
<li><strong>æŠ½è±¡ä¸å…·ä½“</strong>ï¼šä»å…·ä½“çš„DDPMæŠ½è±¡å‡ºä¸€èˆ¬çš„ $\boldsymbol{\mathcal{F}}_t$</li>
<li><strong>çº¦æŸä¸è‡ªç”±</strong>ï¼šåœ¨æ¦‚ç‡æ’ç­‰å¼çº¦æŸä¸‹æ¢ç´¢è®¾è®¡ç©ºé—´</li>
<li><strong>åˆ†æä¸ç»¼åˆ</strong>ï¼šé€šè¿‡åˆ†è§£ (7) ç®€åŒ–å¤æ‚é—®é¢˜</li>
</ul>
<p>æ­£å¦‚æœ¬æ–‡æ‰€è¨€ï¼š</p>
<blockquote>
<p>è®¾è®¡ä¸€ä¸ªæ¨¡å‹çš„æ—¶å€™ï¼Œè¦æ—¶åˆ»çŸ¥é“è‡ªå·±è¦ä»€ä¹ˆï¼ˆ"è‡ªç”±"ï¼‰ï¼Œè¿™ä¸ªæƒ³è¦çš„ä¸œè¥¿æœ‰ä»€ä¹ˆé™åˆ¶ï¼ˆ"çº¦æŸ"ï¼‰ï¼Œåœ¨æ˜ç¡®"è‡ªç”±"ä¸"çº¦æŸ"çš„å‰æä¸‹ï¼Œå°½é‡å€Ÿé‰´å·²æœ‰çš„å·¥ä½œå’Œæ‰€å­¦çš„ç†è®ºåŸºç¡€ï¼Œä¸æ–­å¾€ç›®æ ‡å‡‘è¿‘ã€‚</p>
</blockquote>
<p>è¿™ä¸ä»…é€‚ç”¨äºæ‰©æ•£æ¨¡å‹ï¼Œä¹Ÿæ˜¯æ‰€æœ‰ç§‘å­¦ç ”ç©¶çš„æ™®éæ–¹æ³•è®ºã€‚</p>
<hr />
<p><strong>æ¨å¯¼å®Œæˆ</strong>ï¼šæœ¬æ–‡è¯¦ç»†æ¨å¯¼äº†UDMæ¡†æ¶çš„æ‰€æœ‰æ ¸å¿ƒç†è®ºï¼ŒåŒ…æ‹¬é‡å‚æ•°åŒ–ã€è´å¶æ–¯åˆ†è§£ã€è®­ç»ƒç›®æ ‡ã€è¾¹ç¼˜çº¦æŸã€ç¡®å®šæ€§é‡‡æ ·ç­‰ï¼Œå¹¶ä»ä¿¡æ¯è®ºã€åŠ¨åŠ›ç³»ç»Ÿã€ä¼˜åŒ–ç­‰å¤šè§’åº¦ç†è§£å…¶æœ¬è´¨ã€‚é€šè¿‡DDPMã€DDIMã€Cold Diffusionç­‰å®ä¾‹éªŒè¯äº†æ¡†æ¶çš„ç»Ÿä¸€æ€§å’Œçµæ´»æ€§ã€‚</p>
        </div>
    </div>
</body>
</html>