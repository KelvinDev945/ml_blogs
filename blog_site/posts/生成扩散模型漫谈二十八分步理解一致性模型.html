<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåå…«ï¼‰ï¼šåˆ†æ­¥ç†è§£ä¸€è‡´æ€§æ¨¡å‹</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåå…«ï¼‰ï¼šåˆ†æ­¥ç†è§£ä¸€è‡´æ€§æ¨¡å‹</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 46.1 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10633">https://spaces.ac.cn/archives/10633</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ä¹¦æ¥ä¸Šæ–‡ï¼Œåœ¨<a href="/archives/10617">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåä¸ƒï¼‰ï¼šå°†æ­¥é•¿ä½œä¸ºæ¡ä»¶è¾“å…¥ã€‹</a>ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†åŠ é€Ÿé‡‡æ ·çš„Shortcutæ¨¡å‹ï¼Œå…¶å¯¹æ¯”çš„æ¨¡å‹ä¹‹ä¸€å°±æ˜¯â€œ<a href="https://papers.cool/arxiv/2303.01469">ä¸€è‡´æ€§æ¨¡å‹ï¼ˆConsistency Modelsï¼‰</a>â€ã€‚äº‹å®ä¸Šï¼Œæ—©åœ¨<a href="/archives/9497">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåä¸ƒï¼‰ï¼šæ„å»ºODEçš„ä¸€èˆ¬æ­¥éª¤ï¼ˆä¸‹ï¼‰ã€‹</a>ä»‹ç»ReFlowæ—¶ï¼Œå°±æœ‰è¯»è€…æåˆ°äº†ä¸€è‡´æ€§æ¨¡å‹ï¼Œä½†ç¬”è€…æ€»æ„Ÿè§‰å®ƒæ›´åƒæ˜¯å®è·µä¸Šçš„Trickï¼Œç†è®ºæ–¹é¢ç•¥æ˜¾å•è–„ï¼Œæ‰€ä»¥å…´è¶£å¯¥å¯¥ã€‚</p>
<p>ä¸è¿‡ï¼Œæ—¢ç„¶æˆ‘ä»¬å¼€å§‹å…³æ³¨æ‰©æ•£æ¨¡å‹åŠ é€Ÿé‡‡æ ·æ–¹é¢çš„è¿›å±•ï¼Œé‚£ä¹ˆä¸€è‡´æ€§æ¨¡å‹å°±æ˜¯ä¸€ä¸ªç»•ä¸å¼€çš„å·¥ä½œã€‚å› æ­¤ï¼Œè¶ç€è¿™ä¸ªæœºä¼šï¼Œç¬”è€…åœ¨è¿™é‡Œåˆ†äº«ä¸€ä¸‹è‡ªå·±å¯¹ä¸€è‡´æ€§æ¨¡å‹çš„ç†è§£ã€‚</p>
<h2 id="_1">ç†Ÿæ‚‰é…æ–¹</h2>
<p>è¿˜æ˜¯ç†Ÿæ‚‰çš„é…æ–¹ï¼Œæˆ‘ä»¬çš„å‡ºå‘ç‚¹ä¾æ—§æ˜¯<a href="/archives/9497">ReFlow</a>ï¼Œå› ä¸ºå®ƒå¤§æ¦‚æ˜¯ODEå¼æ‰©æ•£æœ€ç®€å•çš„ç†è§£æ–¹å¼ã€‚è®¾$\boldsymbol{x}<em>0\sim p_0(\boldsymbol{x}_0)$æ˜¯ç›®æ ‡åˆ†å¸ƒçš„ _çœŸå®æ ·æœ¬</em> ï¼Œ$\boldsymbol{x}<em>1\sim p_1(\boldsymbol{x}_1)$æ˜¯å…ˆéªŒåˆ†å¸ƒçš„ _éšæœºå™ªå£°</em> ï¼Œ$\boldsymbol{x}_t = (1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1$æ˜¯åŠ å™ªæ ·æœ¬ï¼Œé‚£ä¹ˆReFlowçš„è®­ç»ƒç›®æ ‡æ˜¯ï¼š<br />
\begin{equation}\boldsymbol{\theta}^<em> = \mathop{\text{argmin}}<em U_0_1_boldsymbol_x="U[0,1],\boldsymbol{x" t_sim="t\sim">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\left[w(t)\Vert\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) - (\boldsymbol{x}_1 - \boldsymbol{x}_0)\Vert^2\right]\label{eq:loss}\end{equation}<br />
å…¶ä¸­$w(t)$æ˜¯å¯è°ƒçš„æƒé‡ã€‚è®­ç»ƒå®Œæˆåå¯ä»¥é€šè¿‡æ±‚è§£$d\boldsymbol{x}_t/dt = \boldsymbol{v}</em>^</em>}(\boldsymbol{x}_t, t)$æ¥å®ç°$\boldsymbol{x}_1$åˆ°$\boldsymbol{x}_0$çš„å˜æ¢ï¼Œä»è€Œå®Œæˆé‡‡æ ·ã€‚</p>
<p>éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼Œä¸€è‡´æ€§æ¨¡å‹çš„Noise Scheduleæ˜¯$\boldsymbol{x}_t = \boldsymbol{x}_0 + t\boldsymbol{x}_1$ï¼ˆå½“$t$è¶³å¤Ÿå¤§æ—¶$\boldsymbol{x}_t$åŒæ ·æ¥è¿‘äºçº¯å™ªå£°ï¼‰ï¼Œè·ŸReFlowç•¥æœ‰ä¸åŒã€‚ä¸è¿‡æœ¬æ–‡çš„ä¸»è¦ç›®çš„ï¼Œæ˜¯å°è¯•ä¸€æ­¥æ­¥å¼•å¯¼å‡ºè·Ÿä¸€è‡´æ€§æ¨¡å‹ç›¸åŒçš„è®­ç»ƒæ€æƒ³å’Œè®­ç»ƒç›®æ ‡ï¼Œç¬”è€…è®¤ä¸ºReFlowçš„æ›´å¥½ç†è§£ä¸€äº›ï¼Œæ‰€ä»¥è¿˜æ˜¯æŒ‰ç…§ReFlowçš„æ¥ä»‹ç»ï¼Œè‡³äºå…·ä½“çš„è®­ç»ƒç»†èŠ‚å¤§å®¶æŒ‰éœ€è‡ªè¡Œè°ƒæ•´å°±å¥½ã€‚</p>
<p>åˆ©ç”¨$\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t = (1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1$ï¼Œæˆ‘ä»¬å¯ä»¥æ¶ˆå»ç›®æ ‡$\eqref{eq:loss}$ä¸­çš„$\boldsymbol{x}_1$ï¼š<br />
\begin{equation}\boldsymbol{\theta}^* = \mathop{\text{argmin}}</em>}} \mathbb{E<em _boldsymbol_theta="\boldsymbol{\theta">{t\sim U[0,1],\boldsymbol{x}_0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\big[\tilde{w}(t)\Vert \underbrace{\boldsymbol{x}_t - t\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_f="\boldsymbol{f">t, t)}</em><em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)} - \boldsymbol{x}_0\Vert^2\big]\label{eq:loss-2}\end{equation}<br />
å…¶ä¸­$\tilde{w}(t) = w(t)/t^2$ã€‚æ³¨æ„$\boldsymbol{x}_0$æ˜¯çœŸå®æ ·æœ¬ï¼Œ$\boldsymbol{x}_t$æ˜¯åŠ å™ªæ ·æœ¬ï¼Œæ‰€ä»¥ReFlowçš„è®­ç»ƒç›®æ ‡å®é™…ä¸Šä¹Ÿæ˜¯åœ¨å»å™ªã€‚é¢„æµ‹å¹²å‡€æ ·æœ¬çš„æ¨¡å‹ä¸º$\boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)=\boldsymbol{x}_t - t\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)$ï¼Œè¿™ä¸ªå‡½æ•°æœ‰ä¸€ä¸ªé‡è¦ç‰¹æ€§æ˜¯æ’æˆç«‹$\boldsymbol{f}</em>_0$ï¼Œè¿™æ­£æ˜¯ä¸€è‡´æ€§æ¨¡å‹çš„å…³é”®çº¦æŸä¹‹ä¸€ã€‚}}(\boldsymbol{x}_0, 0)=\boldsymbol{x</p>
<h2 id="_2">åˆ†æ­¥ç†è§£</h2>
<p>æ¥ä¸‹æ¥è®©æˆ‘ä»¬ä¸€æ­¥æ­¥è§£æ„ReFlowçš„è®­ç»ƒè¿‡ç¨‹ï¼Œè¯•å›¾ä»ä¸­æ‰¾åˆ°æ›´å¥½çš„è®­ç»ƒç›®æ ‡ã€‚é¦–å…ˆæˆ‘ä»¬å°†$[0,1]$ç­‰åˆ†ä¸º$n$ä»½ï¼Œæ¯ä»½å¤§å°ä¸º$1/n$ï¼Œè®°$t_k = k/n$ï¼Œé‚£ä¹ˆ$t$å°±åªéœ€ä»æœ‰é™é›†åˆ$\{0,t_1,t_2,\cdots,t_n\}$å‡åŒ€é‡‡æ ·ã€‚å½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€‰æ‹©éå‡åŒ€çš„ç¦»æ•£åŒ–æ–¹å¼ï¼Œè¿™äº›éƒ½æ˜¯éå…³é”®çš„ç»†èŠ‚é—®é¢˜ã€‚</p>
<p>ç”±äº$t_0=0$æ˜¯å¹³å‡¡çš„ï¼Œæˆ‘ä»¬ä»$t_1$å¼€å§‹ï¼Œç¬¬ä¸€æ­¥çš„è®­ç»ƒç›®æ ‡æ˜¯<br />
\begin{equation}\boldsymbol{\theta}<em _boldsymbol_theta="\boldsymbol{\theta">1^<em> = \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\big[\tilde{w}(t_1)\Vert \boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_1}, t_1) - \boldsymbol{x}_0\Vert^2\big]\end{equation}<br />
æ¥ç€ï¼Œè€ƒè™‘ç¬¬äºŒæ­¥çš„è®­ç»ƒç›®æ ‡ï¼Œè¿˜æ˜¯æŒ‰ç…§$\eqref{eq:loss-2}$çš„è¯ï¼Œé‚£ä¹ˆåº”è¯¥æ˜¯$\Vert \boldsymbol{f}</em>_0\Vert^2$çš„æœŸæœ›ï¼Œä½†ç°åœ¨æˆ‘ä»¬è¯„ä¼°ä¸€ä¸ªæ–°ç›®æ ‡ï¼š}}(\boldsymbol{x}_{t_2}, t_2) - \boldsymbol{x<br />
\begin{equation}\boldsymbol{\theta}_2^</em> = \mathop{\text{argmin}}</em>}} \mathbb{E<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{x}_0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\big[\tilde{w}(t_2)\Vert \boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_2}, t_2) - \boldsymbol{f}</em><em t_1="t_1">1^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t_1}, t_1)\Vert^2\big]\end{equation}<br />
ä¹Ÿå°±æ˜¯è¯´é¢„æµ‹å¯¹è±¡æ”¹ä¸º$\boldsymbol{f}</em>_1^</em>}(\boldsymbol{x}</em>}, t_1)$è€Œä¸æ˜¯$\boldsymbol{x<em t_2="t_2">0$ã€‚ä¸ºä»€ä¹ˆè¦è¿™æ ·æ”¹å‘¢ï¼Ÿæˆ‘ä»¬åˆ†å¯è¡Œæ€§å’Œå¿…è¦æ€§ä¸¤æ–¹é¢æ¥è®¨è®ºã€‚å¯è¡Œæ€§æ–¹é¢ï¼Œ$\boldsymbol{x}</em>}$ç›¸æ¯”$\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_1}$åŠ äº†æ›´å¤šå™ªå£°ï¼Œæ‰€ä»¥å®ƒå»å™ªä¼šæ›´å›°éš¾ï¼Œæ¢è¨€ä¹‹$\boldsymbol{f}</em><em t_1="t_1">2^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t_2}, t_2)$çš„å¤åŸç¨‹åº¦æ˜¯ä¸å¦‚$\boldsymbol{f}</em>_1^</em>}(\boldsymbol{x}</em>}, t_1)$çš„ï¼Œæ‰€ä»¥ç”¨$\boldsymbol{f<em t_1="t_1">{\boldsymbol{\theta}_1^*}(\boldsymbol{x}</em>_0$ä½œä¸ºç¬¬äºŒæ­¥çš„è®­ç»ƒç›®æ ‡å®Œå…¨æ˜¯å¯è¡Œçš„ã€‚}, t_1)$æ›¿æ¢æ‰$\boldsymbol{x</p>
<p>å¯å³ä¾¿å¦‚æ­¤ï¼Œé‚£åˆæœ‰ä»€ä¹ˆæ¢çš„å¿…è¦å‘¢ï¼Ÿç­”æ¡ˆæ˜¯å‡å°‘â€œè½¨è¿¹äº¤å‰â€ã€‚ç”±äº$\boldsymbol{x}<em t_k="t_k">{t_k} = (1-t_k)\boldsymbol{x}_0 + t_k\boldsymbol{x}_1$ï¼Œå› æ­¤éšç€$k$çš„å¢å¤§ï¼Œ$\boldsymbol{x}</em>}$å¯¹$\boldsymbol{x<em t_k="t_k">0$çš„ä¾èµ–ä¼šè¶Šæ¥è¶Šå¼±ï¼Œä»¥è‡³äºä¸¤ä¸ªä¸åŒçš„$\boldsymbol{x}_0$ï¼Œå®ƒä»¬å¯¹åº”çš„$\boldsymbol{x}</em>_0$ä¸ºé¢„æµ‹ç›®æ ‡çš„è¯ï¼Œå°±ä¼šå‡ºç°â€œä¸€ä¸ªè¾“å…¥ï¼Œå¤šä¸ªç›®æ ‡â€çš„å›°å¢ƒï¼Œè¿™å°±æ˜¯â€œè½¨è¿¹äº¤å‰â€ã€‚}$ä¼šå¾ˆæ¥è¿‘ï¼Œè¿™æ—¶å€™è¿˜æ˜¯ä»¥$\boldsymbol{x</p>
<p>é¢å¯¹è¿™ä¸ªå›°å¢ƒï¼ŒReFlowçš„ç­–ç•¥æ˜¯äº‹åè’¸é¦ï¼Œå› ä¸ºé¢„è®­ç»ƒå®Œåæ±‚è§£$d\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t/dt = \boldsymbol{v}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t, t)$å°±å¯ä»¥å¾—åˆ°å¾ˆå¤š$(\boldsymbol{x}_0,\boldsymbol{x}_1)$å¯¹ï¼Œç”¨è¿™äº›é…å¯¹çš„$\boldsymbol{x}_0,\boldsymbol{x}_1$å»æ„å»º$\boldsymbol{x}_t$å°±èƒ½é¿å…äº¤å‰ã€‚ä¸€è‡´æ€§æ¨¡å‹çš„æƒ³æ³•æ˜¯æŠŠé¢„æµ‹ç›®æ ‡æ¢æˆ$\boldsymbol{f}</em>^}_{k-1</em>}(\boldsymbol{x}<em k-1="k-1">{t</em>}}, t_{k-1})$ï¼Œå› ä¸ºå¯¹äºâ€œåŒä¸€$\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">1$ã€ä¸åŒ$\boldsymbol{x}_0$â€ï¼Œ$\boldsymbol{f}</em><em t__k-1="t_{k-1">{k-1}^*}(\boldsymbol{x}</em>_0$é—´çš„å·®å¼‚è¦å°ï¼Œæ‰€ä»¥ä¹Ÿèƒ½å‡å°‘äº¤å‰é£é™©ã€‚}}, t_{k-1})$é—´çš„å·®å¼‚ä¼šæ¯”$\boldsymbol{x</p>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯$\boldsymbol{f}<em t_1="t_1">{\boldsymbol{\theta}_2^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t_2}, t_2)$é¢„æµ‹$\boldsymbol{f}</em>_1^</em>}(\boldsymbol{x}</em>}, t_1)$æ¯”é¢„æµ‹$\boldsymbol{x<em t_2="t_2">0$æ›´å®¹æ˜“ï¼Œå¹¶ä¸”è¯¥è¾¾åˆ°çš„æ•ˆæœä¹Ÿèƒ½è¾¾åˆ°ï¼Œæ‰€ä»¥è°ƒæ•´äº†é¢„æµ‹ç›®æ ‡ã€‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡º<br />
\begin{equation}\begin{gathered}<br />
\boldsymbol{\theta}_3^<em> = \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\big[\tilde{w}(t_3)\Vert \boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_3}, t_3) - \boldsymbol{f}</em>_2^</em>}(\boldsymbol{x}</em>, t_2)\Vert^2\big] \\\<br />
\boldsymbol{\theta}<em t_3="t_3">4^<em> = \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\big[\tilde{w}(t_4)\Vert \boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_4}, t_4) - \boldsymbol{f}</em>_3^</em>}(\boldsymbol{x}</em>, t_3)\Vert^2\big] \\\<br />
\vdots \\\[5pt]<br />
\boldsymbol{\theta}<em t__n-1="t_{n-1">n^<em> = \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\big[\tilde{w}(t_n)\Vert \boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_n}, t_n) - \boldsymbol{f}</em>^}_{n-1</em>}(\boldsymbol{x}</em>)\Vert^2\big]}}, t_{n-1<br />
\end{gathered}\end{equation}</p>
<h2 id="_3">ä¸€è‡´è®­ç»ƒ</h2>
<p>ç°åœ¨æˆ‘ä»¬å·²ç»å®Œæˆäº†ReFlowæ¨¡å‹çš„è§£æ„ï¼Œå¹¶ä¸”å¾—åˆ°äº†ä¸€ä¸ªæ–°çš„è‡ªè®¤ä¸ºæ›´åˆç†çš„è®­ç»ƒç›®æ ‡ï¼Œä½†ä»£ä»·æ˜¯å¾—åˆ°äº†$n$å¥—å‚æ•°$\boldsymbol{\theta}<em t__k-1="t_{k-1">1^<em>,\boldsymbol{\theta}_2^</em>,\cdots,\boldsymbol{\theta}_n^<em>$ï¼Œè¿™å½“ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæˆ‘ä»¬åªæƒ³è¦ä¸€ä¸ªæ¨¡å‹ã€‚äºæ˜¯æˆ‘ä»¬è®¤ä¸ºæ‰€æœ‰çš„$\boldsymbol{\theta}_i^</em>$å¯ä»¥å…±ç”¨åŒä¸€å¥—å‚æ•°ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥å†™å‡ºè®­ç»ƒç›®æ ‡<br />
\begin{equation}\boldsymbol{\theta}^<em> = \mathop{\text{argmin}}<em k_sim_n_boldsymbol_x="k\sim[n],\boldsymbol{x">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\big[\tilde{w}(t_k)\Vert \boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_k}, t_k) - \boldsymbol{f}</em>^</em>}(\boldsymbol{x}</em>}}, t_{k-1})\Vert^2\big]\label{eq:loss-3}\end{equation<br />
è¿™é‡Œ$k\sim[n]$æ˜¯æŒ‡$k$ä»$\{1,2,\cdots,n\}$ä¸­å‡åŒ€é‡‡æ ·ã€‚ä¸Šå¼çš„é—®é¢˜æ˜¯ï¼Œ$\boldsymbol{\theta}^<em>$æ˜¯æˆ‘ä»¬è¦æ±‚çš„å‚æ•°ï¼Œä½†å®ƒåˆå‡ºç°åœ¨ç›®æ ‡å‡½æ•°ä¸­ï¼Œè¿™æ˜¾ç„¶æ˜¯ä¸ç§‘å­¦çš„ï¼ˆçŸ¥é“$\boldsymbol{\theta}^</em>$äº†æˆ‘è¿˜è®­ç»ƒå¹²å˜›ï¼‰ï¼Œå› æ­¤å¿…é¡»ä¿®æ”¹ä¸Šè¿°ç›®æ ‡ä½¿å¾—å®ƒæ›´ä¸ºå¯è¡Œã€‚</p>
<p>$\boldsymbol{\theta}^<em>$çš„æ„ä¹‰æ˜¯ç†è®ºæœ€ä¼˜è§£ï¼Œè€ƒè™‘åˆ°éšç€è®­ç»ƒçš„æ¨è¿›ï¼Œ$\boldsymbol{\theta}$ä¼šæ…¢æ…¢é€¼è¿‘$\boldsymbol{\theta}^</em>$ï¼Œæ‰€ä»¥åœ¨ç›®æ ‡å‡½æ•°ä¸­æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªæ¡ä»¶æ”¾å®½ä¸ºâ€œè¶…å‰è§£â€ï¼Œå³å®ƒåªè¦æ¯”å½“å‰çš„$\boldsymbol{\theta}$æ›´å¥½å°±è¡Œäº†ã€‚æ€ä¹ˆæ„å»ºâ€œè¶…å‰è§£â€å‘¢ï¼Ÿä¸€è‡´æ€§æ¨¡å‹çš„åšæ³•æ˜¯å¯¹å†å²æƒé‡è¿›è¡Œ<a href="/archives/6575#%E6%9D%83%E9%87%8D%E6%BB%91%E5%8A%A8%E5%B9%B3%E5%9D%87">EMAï¼ˆExponential Moving Averageï¼ŒæŒ‡æ•°æ»‘åŠ¨å¹³å‡</a>ï¼‰ï¼Œè¿™å¾€å¾€èƒ½å¾—åˆ°ä¸€ä¸ªæ›´ä¼˜ç§€çš„è§£ï¼Œæ—©äº›å¹´æˆ‘ä»¬åœ¨æ‰“æ¯”èµ›æ—¶å°±ç»å¸¸ç”¨åˆ°è¿™ä¸ªæŠ€å·§ã€‚</p>
<p>å› æ­¤ï¼Œä¸€è‡´æ€§æ¨¡å‹æœ€ç»ˆçš„è®­ç»ƒç›®æ ‡æ˜¯ï¼š<br />
\begin{equation}\boldsymbol{\theta}^* = \mathop{\text{argmin}}<em k_sim_n_boldsymbol_x="k\sim[n],\boldsymbol{x">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\big[\tilde{w}(t_k)\Vert \boldsymbol{f}</em>}}(\boldsymbol{x<em _bar_boldsymbol_theta="\bar{\boldsymbol{\theta">{t_k}, t_k) - \boldsymbol{f}</em>}}}(\boldsymbol{x<em k-1="k-1">{t</em>}}, t_{k-1})\Vert^2\big]\label{eq:loss-4}\end{equation<br />
å…¶ä¸­$\bar{\boldsymbol{\theta}}$æ˜¯$\boldsymbol{\theta}$çš„EMAã€‚è¿™å°±æ˜¯åŸè®ºæ–‡ä¸­çš„â€œä¸€è‡´æ€§è®­ç»ƒï¼ˆConsistency Trainingï¼ŒCTï¼‰â€ã€‚ä»å®è·µä¸Šæ¥çœ‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†$\Vert\cdot - \cdot\Vert^2$æ¢æˆæ›´ä¸€èˆ¬çš„åº¦é‡$d(\cdot, \cdot)$ï¼Œä»¥æ›´è´´åˆæ•°æ®ç‰¹æ€§ã€‚</p>
<h2 id="_4">é‡‡æ ·åˆ†æ</h2>
<p>ç”±äºæˆ‘ä»¬æ˜¯ä»ReFlowå‡ºå‘ä¸€æ­¥æ­¥â€œç­‰ä»·å˜æ¢â€è¿‡æ¥çš„ï¼Œæ‰€ä»¥è®­ç»ƒå®Œæˆåä¸€ç§åŸºæœ¬çš„é‡‡æ ·æ–¹å¼å°±æ˜¯è·ŸReFlowä¸€æ ·æ±‚è§£ODE<br />
\begin{equation}d\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t/dt = \boldsymbol{v}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t, t) = \frac{\boldsymbol{x}_t - \boldsymbol{f}</em>^</em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t, t)}{t}\label{eq:ode}\end{equation}<br />
å½“ç„¶ï¼Œå¦‚æœè´¹é‚£ä¹ˆå¤§åŠ²å¾—åˆ°çš„æ˜¯è·ŸReFlowä¸€æ ·çš„ç»“æœï¼Œé‚£ä¹ˆå°±çº¯ç²¹æ˜¯çæŠ˜è…¾äº†ã€‚å¹¸è¿çš„æ˜¯ï¼Œä¸€è‡´æ€§è®­ç»ƒæ‰€å¾—çš„æ¨¡å‹ï¼Œæœ‰ä¸€ä¸ªé‡è¦çš„ä¼˜åŠ¿æ˜¯å¯ä»¥ä½¿ç”¨æ›´å¤§çš„é‡‡æ ·æ­¥é•¿â€”â€”ç”šè‡³ç­‰äº1çš„æ­¥é•¿ï¼Œè¿™å°±å¯ä»¥å®ç°å•æ­¥ç”Ÿæˆï¼š<br />
\begin{equation}\boldsymbol{x}_0 = \boldsymbol{x}_1 - \boldsymbol{v}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1, 1)\times 1 = \boldsymbol{f}</em>^</em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1, 1)\end{equation}<br />
ç†ç”±æ˜¯<br />
\begin{equation}\begin{aligned}<br />
\Vert\boldsymbol{f}</em>^<em>}(\boldsymbol{x}<em k="1">1, 1) - \boldsymbol{x}_0\Vert =&amp;\, \left\Vert\sum</em>^}^n \Big[\boldsymbol{f}_{\boldsymbol{\theta</em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t_k}, t_k) - \boldsymbol{f}</em>^<em>}(\boldsymbol{x}<em k-1="k-1">{t</em>)\Big]\right\Vert \\\[5pt]}}, t_{k-1<br />
\leq&amp;\, \sum_{k=1}^n \Vert\boldsymbol{f}_{\boldsymbol{\theta}^</em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t_k}, t_k) - \boldsymbol{f}</em>^<em>}(\boldsymbol{x}<em k-1="k-1">{t</em>)\Vert \\\}}, t_{k-1<br />
\end{aligned}\label{eq:f-x1-x0}\end{equation}<br />
å¯ä»¥çœ‹åˆ°ï¼Œä¸€è‡´æ€§è®­ç»ƒç›¸å½“äºåœ¨ä¼˜åŒ–$\Vert\boldsymbol{f}_{\boldsymbol{\theta}^</em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1, 1) - \boldsymbol{x}_0\Vert$çš„ä¸Šç•Œï¼Œå½“æŸå¤±è¶³å¤Ÿå°æ—¶ï¼Œæ„å‘³ç€$\Vert\boldsymbol{f}</em>_0\Vert$ä¹Ÿè¶³å¤Ÿå°ï¼Œå› æ­¤å¯ä»¥ä¸€æ­¥ç”Ÿæˆã€‚}^*}(\boldsymbol{x}_1, 1) - \boldsymbol{x</p>
<p>å¯$\Vert\boldsymbol{f}<em t_k="t_k">{\boldsymbol{\theta}^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1, 1) - \boldsymbol{x}_0\Vert$æ˜¯åŸæœ¬ReFlowçš„è®­ç»ƒç›®æ ‡ï¼Œä¸ºä»€ä¹ˆç›´æ¥ä¼˜åŒ–å®ƒä¼šä¸å¦‚ä¼˜åŒ–å®ƒçš„ä¸Šç•Œå‘¢ï¼Ÿè¿™åˆå›åˆ°äº†â€œè½¨è¿¹äº¤å‰â€çš„é—®é¢˜äº†ï¼Œç›´æ¥è®­ç»ƒçš„è¯ï¼Œ$\boldsymbol{x}_0,\boldsymbol{x}_1$éƒ½æ˜¯éšæœºé‡‡æ ·çš„ï¼Œæ²¡æœ‰ä¸€ä¸€é…å¯¹å…³ç³»ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥è®­ç»ƒå‡ºä¸€æ­¥ç”Ÿæˆæ¨¡å‹ã€‚ä½†è®­ç»ƒä¸Šç•Œçš„è¯ï¼Œé€šè¿‡å¤šä¸ª$\boldsymbol{f}</em>^</em>}(\boldsymbol{x}</em>}, t_k),\boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}^*}(\boldsymbol{x}</em>_1$çš„é…å¯¹ã€‚}}, t_{k-1})$çš„ä¼ é€’æ€§ï¼Œéšå«åœ°å®ç°äº†$\boldsymbol{x}_0,\boldsymbol{x</p>
<p>å¦‚æœå•æ­¥ç”Ÿæˆçš„æ•ˆæœä¸èƒ½è®©æˆ‘ä»¬æ»¡æ„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å¢åŠ é‡‡æ ·æ­¥æ•°æ¥æé«˜ç”Ÿæˆè´¨é‡ï¼Œè¿™é‡Œè¾¹åˆæœ‰ä¸¤ç§æ€è·¯ï¼š1ã€ç”¨æ›´å°çš„æ­¥é•¿æ¥æ•°å€¼æ±‚è§£$\eqref{eq:ode}$ï¼›2ã€è½¬åŒ–ä¸ºç±»ä¼¼SDEçš„éšæœºè¿­ä»£ã€‚å‰è€…æ¯”è¾ƒå¸¸è§„ï¼Œæˆ‘ä»¬ä¸»è¦è®¨è®ºåè€…ã€‚</p>
<p>é¦–å…ˆæ³¨æ„åˆ°å¼$\eqref{eq:f-x1-x0}$ä¸­çš„$\boldsymbol{f}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1, 1)$æ¢æˆä»»æ„$\boldsymbol{f}</em>^</em>}(\boldsymbol{x}_t, t)$ï¼Œä¹Ÿå¯ä»¥å¾—åˆ°ç±»ä¼¼çš„ä¸ç­‰å…³ç³»ï¼Œè¿™æ„å‘³ç€ä»»æ„çš„$\boldsymbol{f}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t, t)$é¢„æµ‹çš„éƒ½æ˜¯$\boldsymbol{x}_0$ï¼Œè¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬ä»$\boldsymbol{x}_1$å‡ºå‘ï¼Œé€šè¿‡$\boldsymbol{f}</em>^</em>}(\boldsymbol{x}<em t__n-1="t_{n-1">1, 1)$å°±å¾—åˆ°ä¸€ä¸ªåˆæ­¥çš„$\boldsymbol{x}_0$ï¼Œä½†å¯èƒ½ä¸å¤Ÿå®Œç¾ï¼Œäºæ˜¯æˆ‘ä»¬é€šè¿‡åŠ å™ªæ¥â€œæ©é¥°â€è¿™ç§ä¸å®Œç¾ï¼Œå¾—åˆ°ä¸€ä¸ª$\boldsymbol{x}</em>}}$ï¼Œä»£å…¥$\boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}^<em>}(\boldsymbol{x}<em n-1="n-1">{t</em>)$å¾—åˆ°ä¸€ä¸ªæ›´å¥½ä¸€ç‚¹çš„ç»“æœï¼Œä¾æ­¤ç±»æ¨ï¼š}}, t_{n-1<br />
\begin{equation}\begin{aligned}<br />
&amp;\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I}) \\\<br />
&amp;\boldsymbol{x}_0\leftarrow \boldsymbol{f}</em>^</em>}(\boldsymbol{x}_1, 1) \\\<br />
&amp;\text{for }k=n-1,n-2,\cdots,1: \\\<br />
&amp;\qquad \boldsymbol{z} \sim \mathcal{N}(\boldsymbol{0},\boldsymbol{I}) \\\<br />
&amp;\qquad \boldsymbol{x}</em>} \leftarrow (1 - t_k)\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">0 + t_k\boldsymbol{z} \\\<br />
&amp;\qquad \boldsymbol{x}_0\leftarrow \boldsymbol{f}</em>, t_k)}^*}(\boldsymbol{x}_{t_k<br />
\end{aligned}\end{equation}</p>
<h2 id="_5">ç”¨äºè’¸é¦</h2>
<p>ä¸€è‡´æ€§æ¨¡å‹çš„è®­ç»ƒæ€æƒ³åŒæ ·å¯ä»¥ç”¨äºç°æˆæ‰©æ•£æ¨¡å‹çš„è’¸é¦ï¼Œç»“æœç§°ä¸ºâ€œä¸€è‡´æ€§è’¸é¦ï¼ˆConsistency Distillationï¼ŒCDï¼‰â€ï¼Œæ–¹æ³•æ˜¯æŠŠå¼$\eqref{eq:loss-4}$ä¸­$\boldsymbol{f}<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k)$çš„å­¦ä¹ ç›®æ ‡ç”±$\boldsymbol{f<em t__k-1="t_{k-1">{\bar{\boldsymbol{\theta}}}(\boldsymbol{x}</em>}}, t_{k-1})$æ¢æˆ$\boldsymbol{f<em t__k-1="t_{k-1">{\bar{\boldsymbol{\theta}}}(\hat{\boldsymbol{x}}</em>^}}^{\boldsymbol{\varphi<em>}, t_{k-1})$ï¼š<br />
\begin{equation}\boldsymbol{\theta}^</em> = \mathop{\text{argmin}}<em k_sim_n_boldsymbol_x="k\sim[n],\boldsymbol{x">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\big[\tilde{w}(t_k)\Vert \boldsymbol{f}</em>}}(\boldsymbol{x<em _bar_boldsymbol_theta="\bar{\boldsymbol{\theta">{t_k}, t_k) - \boldsymbol{f}</em>}}}(\hat{\boldsymbol{x}<em k-1="k-1">{t</em>^}}^{\boldsymbol{\varphi<em>}, t_{k-1})\Vert^2\big]\label{eq:loss-5}\end{equation}<br />
å…¶ä¸­$\hat{\boldsymbol{x}}<em k-1="k-1">{t</em>^}}^{\boldsymbol{\varphi</em>}$æ˜¯ç”±æ•™å¸ˆæ‰©æ•£æ¨¡å‹ä»¥$\boldsymbol{x}<em t__k-1="t_{k-1">{t_k}$ä¸ºåˆå€¼æ‰€é¢„æµ‹çš„$\boldsymbol{x}</em>$ï¼Œæ¯”å¦‚æœ€ç®€å•çš„æ¬§æ‹‰æ±‚è§£å™¨ï¼Œæˆ‘ä»¬æœ‰}<br />
\begin{equation}\hat{\boldsymbol{x}}<em k-1="k-1">{t</em>^}}^{\boldsymbol{\varphi<em>} \approx \boldsymbol{x}<em k-1="k-1">{t_k} - (t_k - t</em>^})\boldsymbol{v}_{\boldsymbol{\varphi</em>}(\boldsymbol{x}_{t_k}, t_k)\end{equation}<br />
è¿™æ ·åšçš„ç†ç”±ä¹Ÿå¾ˆç®€å•ï¼Œå¦‚æœæœ‰äº†é¢„è®­ç»ƒå¥½çš„æ‰©æ•£æ¨¡å‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±æ²¡å¿…è¦åœ¨ç›´çº¿$\boldsymbol{x}_t = (1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1$ä¸Šæ‰¾å­¦ä¹ ç›®æ ‡äº†ï¼Œå› ä¸ºè¿™æ˜¯äººä¸ºå®šä¹‰çš„ï¼Œç»ˆç©¶æœ‰äº¤å‰çš„é£é™©ï¼Œè€Œæ˜¯æ”¹ä¸ºç”±é¢„è®­ç»ƒå¥½æ‰©æ•£æ¨¡å‹æ¥é¢„æµ‹è½¨è¿¹ï¼Œè¿™æ ·æ‰¾å‡ºæ¥çš„å­¦ä¹ ç›®æ ‡å¯èƒ½å¹¶ä¸ä¸€å®šæ˜¯â€œæœ€ç›´â€çš„ï¼Œä½†è‚¯å®šä¸ä¼šæœ‰äº¤å‰ã€‚</p>
<p>å¦‚æœä¸è®¡æˆæœ¬ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ä»éšæœºé‡‡æ ·çš„$\boldsymbol{x}_1$å‡ºå‘ï¼ŒåŠ ä¸Šé¢„è®­ç»ƒæ‰©æ•£æ¨¡å‹è§£å‡ºçš„$\boldsymbol{x}_0$ï¼Œé€šè¿‡æˆå¯¹çš„$(\boldsymbol{x}_0,\boldsymbol{x}_1)$æ¥æ„å»ºå­¦ä¹ ç›®æ ‡ï¼Œè¿™å·®ä¸å¤šå°±æ˜¯ReFlowçš„è’¸é¦æ€è·¯ï¼Œç¼ºç‚¹æ˜¯å¿…é¡»å¯¹æ•™å¸ˆæ¨¡å‹è¿è¡Œå®Œæ•´çš„é‡‡æ ·è¿‡ç¨‹ï¼Œè´¹æ—¶è´¹åŠ›ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼Œä¸€è‡´æ€§è’¸é¦åªéœ€è¦è¿è¡Œå•æ­¥æ•™å¸ˆæ¨¡å‹ï¼Œè®¡ç®—æˆæœ¬æ›´ä½ã€‚</p>
<p>ä¸è¿‡ï¼Œä¸€è‡´æ€§è’¸é¦åœ¨è’¸é¦è¿‡ç¨‹ä¸­è¿˜éœ€è¦çœŸå®æ ·æœ¬ï¼Œè¿™åœ¨æŸäº›åœºæ™¯ä¸‹ä¹Ÿæ˜¯ä¸€ä¸ªç¼ºç‚¹ã€‚å¦‚æœè’¸é¦è¿‡ç¨‹æ—¢ä¸æƒ³è¿è¡Œå®Œæ•´çš„æ•™å¸ˆæ¨¡å‹é‡‡æ ·ï¼Œåˆä¸æƒ³æä¾›çœŸå®æ•°æ®ï¼Œé‚£ä¹ˆæœ‰ä¸€ä¸ªé€‰æ‹©å°±æ˜¯æˆ‘ä»¬ä¹‹å‰ä»‹ç»è¿‡çš„<a href="/archives/10085">SiD</a>ï¼Œä»£ä»·æ˜¯æ¨¡å‹çš„æ¨å¯¼æ›´åŠ å¤æ‚äº†ã€‚</p>
<h2 id="_6">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡é€šè¿‡é€æ­¥è§£æ„å’Œä¼˜åŒ–ReFLowè®­ç»ƒæµç¨‹çš„æ–¹å¼ï¼Œæä¾›äº†ä¸€ä¸ªä»ReFlowé€æ¸è¿‡æ¸¡åˆ°ä¸€è‡´æ€§æ¨¡å‹ï¼ˆConsistency Modelsï¼‰çš„ç›´è§‚ç†è§£è·¯å¾„ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10633">https://spaces.ac.cn/archives/10633</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Dec. 18, 2024). ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåå…«ï¼‰ï¼šåˆ†æ­¥ç†è§£ä¸€è‡´æ€§æ¨¡å‹ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10633">https://spaces.ac.cn/archives/10633</a></p>
<p>@online{kexuefm-10633,<br />
title={ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåå…«ï¼‰ï¼šåˆ†æ­¥ç†è§£ä¸€è‡´æ€§æ¨¡å‹},<br />
author={è‹å‰‘æ—},<br />
year={2024},<br />
month={Dec},<br />
url={\url{https://spaces.ac.cn/archives/10633}},<br />
} </p>
<hr />
<h2 id="_7">æ¨å¯¼</h2>
<h3 id="_8">ä¸€è‡´æ€§æ¨¡å‹çš„æ•°å­¦å®šä¹‰</h3>
<p>ä¸€è‡´æ€§æ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³æ˜¯æ„å»ºä¸€ä¸ªå‡½æ•°$\boldsymbol{f}_{\boldsymbol{\theta}}$ï¼Œå®ƒèƒ½å¤Ÿå°†ä»»æ„æ—¶åˆ»$t$çš„å™ªå£°æ ·æœ¬$\boldsymbol{x}_t$æ˜ å°„å›å¹²å‡€æ•°æ®$\boldsymbol{x}_0$ã€‚æˆ‘ä»¬é¦–å…ˆç»™å‡ºä¸€è‡´æ€§æ¨¡å‹çš„ä¸¥æ ¼æ•°å­¦å®šä¹‰ã€‚</p>
<p><strong>å®šä¹‰1ï¼ˆä¸€è‡´æ€§å‡½æ•°ï¼‰</strong>ï¼šç»™å®šä¸€ä¸ªæ¦‚ç‡æµODE
\begin{equation}
\frac{d\boldsymbol{x}<em t_in_0_T_="t\in[0,T]">t}{dt} = \boldsymbol{v}(\boldsymbol{x}_t, t), \quad t \in [0, T]
\end{equation}
å…¶è½¨è¿¹ä¸º${\boldsymbol{x}_t}</em>^d$æ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š}$ï¼Œä¸€è‡´æ€§å‡½æ•°$\boldsymbol{f}: (\mathbb{R}^d, \mathbb{R}_+) \to \mathbb{R</p>
<ol>
<li>
<p><strong>è‡ªæ´½æ€§ï¼ˆSelf-Consistencyï¼‰</strong>ï¼šå¯¹äºODEè½¨è¿¹ä¸Šçš„ä»»æ„ä¸¤ä¸ªç‚¹$\boldsymbol{x}<em t_="t'">t$å’Œ$\boldsymbol{x}</em>$ï¼ˆ$t, t' &gt; 0$ï¼‰ï¼Œæœ‰
\begin{equation}
\boldsymbol{f}(\boldsymbol{x}<em t_="t'">t, t) = \boldsymbol{f}(\boldsymbol{x}</em>, t')
\end{equation}</p>
</li>
<li>
<p><strong>è¾¹ç•Œæ¡ä»¶ï¼ˆBoundary Conditionï¼‰</strong>ï¼šå½“$t \to 0$æ—¶ï¼Œæœ‰
\begin{equation}
\boldsymbol{f}(\boldsymbol{x}_0, 0) = \boldsymbol{x}_0
\end{equation}</p>
</li>
</ol>
<p>è¿™ä¸¤ä¸ªæ€§è´¨ç¡®ä¿äº†ä¸€è‡´æ€§å‡½æ•°èƒ½å¤Ÿå°†ODEè½¨è¿¹ä¸Šçš„ä»»æ„ç‚¹æ˜ å°„åˆ°åŒä¸€ä¸ªç»ˆç‚¹$\boldsymbol{x}_0$ã€‚</p>
<p><strong>å‘½é¢˜1ï¼ˆä¸€è‡´æ€§å‡½æ•°çš„å­˜åœ¨æ€§ï¼‰</strong>ï¼šå¯¹äºä»»æ„æ»¡è¶³Lipschitzè¿ç»­æ¡ä»¶çš„æ¦‚ç‡æµODEï¼Œä¸€è‡´æ€§å‡½æ•°å­˜åœ¨ä¸”å”¯ä¸€ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šå¯¹äºç»™å®šçš„åˆå€¼$\boldsymbol{x}<em s_in_0_t_="s\in[0,t]">t$ï¼Œæ ¹æ®ODEç†è®ºï¼Œå­˜åœ¨å”¯ä¸€çš„è½¨è¿¹${\boldsymbol{x}_s}</em>$æ»¡è¶³
\begin{equation}
\boldsymbol{x}<em>s = \boldsymbol{x}_t + \int_t^s \boldsymbol{v}(\boldsymbol{x}</em>\tau, \tau) d\tau
\end{equation}
å®šä¹‰$\boldsymbol{f}(\boldsymbol{x}_t, t) = \boldsymbol{x}_0$ï¼Œå…¶ä¸­$\boldsymbol{x}_0$æ˜¯è¯¥è½¨è¿¹åœ¨$s=0$æ—¶çš„å–å€¼ã€‚ç”±ODEè§£çš„å”¯ä¸€æ€§ï¼Œè¿™ä¸ªå®šä¹‰æ˜¯è‰¯å®šä¹‰çš„ã€‚è‡ªæ´½æ€§ç”±ODEè½¨è¿¹çš„è¿ç»­æ€§ä¿è¯ï¼Œè¾¹ç•Œæ¡ä»¶æ˜¾ç„¶æˆç«‹ã€‚$\square$</p>
<h3 id="ode">ä»æ¦‚ç‡æµODEåˆ°ä¸€è‡´æ€§æ¨¡å‹</h3>
<p>æˆ‘ä»¬ä»æ‰©æ•£è¿‡ç¨‹çš„æ¦‚ç‡æµODEå‡ºå‘ã€‚è€ƒè™‘æ ‡å‡†çš„æ‰©æ•£è¿‡ç¨‹ï¼Œå…¶å‰å‘è¿‡ç¨‹ä¸º
\begin{equation}
d\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t = \boldsymbol{f}(t)\boldsymbol{x}_t dt + g(t) d\boldsymbol{w}_t
\end{equation}
å¯¹åº”çš„æ¦‚ç‡æµODEä¸º
\begin{equation}
\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{f}(t)\boldsymbol{x}_t - \frac{1}{2}g(t)^2 \nabla</em>_t)
\end{equation}}_t} \log p_t(\boldsymbol{x</p>
<p>å¯¹äºReFlowçš„ç‰¹æ®Šæƒ…å†µï¼Œæˆ‘ä»¬æœ‰$\boldsymbol{x}_t = (1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1$ï¼Œå› æ­¤
\begin{equation}
\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{x}_1 - \boldsymbol{x}_0
\end{equation}</p>
<p><strong>å‘½é¢˜2ï¼ˆReFlowçš„ä¸€è‡´æ€§å‡½æ•°ï¼‰</strong>ï¼šå¯¹äºReFlowçš„å™ªå£°è°ƒåº¦$\boldsymbol{x}_t = (1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1$ï¼Œç†æƒ³çš„ä¸€è‡´æ€§å‡½æ•°ä¸º
\begin{equation}
\boldsymbol{f}(\boldsymbol{x}_t, t) = \boldsymbol{x}_t - t(\boldsymbol{x}_1 - \boldsymbol{x}_0) = \boldsymbol{x}_0
\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼šä»$\boldsymbol{x}_t$åˆ°$\boldsymbol{x}_0$çš„è½¨è¿¹æ»¡è¶³
\begin{align}
\boldsymbol{x}_s &amp;= \boldsymbol{x}_t + \int_t^s (\boldsymbol{x}_1 - \boldsymbol{x}_0) d\tau \
&amp;= \boldsymbol{x}_t + (s - t)(\boldsymbol{x}_1 - \boldsymbol{x}_0) \
&amp;= (1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1 + (s-t)(\boldsymbol{x}_1 - \boldsymbol{x}_0) \
&amp;= (1-s)\boldsymbol{x}_0 + s\boldsymbol{x}_1
\end{align}
å½“$s=0$æ—¶ï¼Œ$\boldsymbol{x}_0 = \boldsymbol{x}_t - t(\boldsymbol{x}_1 - \boldsymbol{x}_0)$ã€‚$\square$</p>
<p>ç”±äº$\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1 - \boldsymbol{x}_0 = \boldsymbol{v}(\boldsymbol{x}_t, t)$æ˜¯æˆ‘ä»¬é€šè¿‡ç¥ç»ç½‘ç»œå­¦ä¹ çš„é€Ÿåº¦åœºï¼Œå› æ­¤
\begin{equation}
\boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) = \boldsymbol{x}_t - t\boldsymbol{v}</em>_t, t)
\end{equation}}}(\boldsymbol{x</p>
<p>è¿™ä¸ªå½¢å¼è‡ªç„¶æ»¡è¶³è¾¹ç•Œæ¡ä»¶$\boldsymbol{f}_{\boldsymbol{\theta}}(\boldsymbol{x}_0, 0) = \boldsymbol{x}_0$ã€‚</p>
<h3 id="_9">ä¸€è‡´æ€§å‡½æ•°çš„å…³é”®æ€§è´¨</h3>
<p><strong>æ€§è´¨1ï¼ˆLipschitzè¿ç»­æ€§ï¼‰</strong>ï¼šå¦‚æœé€Ÿåº¦åœº$\boldsymbol{v}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}, t)$å…³äº$\boldsymbol{x}$æ˜¯$L_v$-Lipschitzè¿ç»­çš„ï¼Œåˆ™ä¸€è‡´æ€§å‡½æ•°$\boldsymbol{f}</em>$æ˜¯$(1 + tL_v)$-Lipschitzè¿ç»­çš„ã€‚}}(\boldsymbol{x}, t)$å…³äº$\boldsymbol{x</p>
<p><strong>è¯æ˜</strong>ï¼šå¯¹äºä»»æ„$\boldsymbol{x}, \boldsymbol{y} \in \mathbb{R}^d$ï¼Œ
\begin{align}
|\boldsymbol{f}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}, t) - \boldsymbol{f}</em>}}(\boldsymbol{y}, t)| &amp;= |\boldsymbol{x} - t\boldsymbol{v<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}, t) - \boldsymbol{y} + t\boldsymbol{v}</em>, t)| \
&amp;\leq |\boldsymbol{x} - \boldsymbol{y}| + t|\boldsymbol{v}}}(\boldsymbol{y<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}, t) - \boldsymbol{v}</em>, t)| \
&amp;\leq |\boldsymbol{x} - \boldsymbol{y}| + tL_v|\boldsymbol{x} - \boldsymbol{y}| \
&amp;= (1 + tL_v)|\boldsymbol{x} - \boldsymbol{y}|
\end{align}
$\square$}}(\boldsymbol{y</p>
<p><strong>æ€§è´¨2ï¼ˆæ—¶é—´å¯å¾®æ€§ï¼‰</strong>ï¼šå¦‚æœ$\boldsymbol{v}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}$å…³äº$t$å¯å¾®ï¼Œåˆ™
\begin{equation}
\frac{\partial \boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)}{\partial t} = -\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) - t\frac{\partial \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t, t)}{\partial t} + t\nabla</em>}} \boldsymbol{v<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) \cdot \boldsymbol{v}</em>_t, t)
\end{equation}}}(\boldsymbol{x</p>
<p><strong>è¯æ˜</strong>ï¼šä½¿ç”¨é“¾å¼æ³•åˆ™ï¼Œ
\begin{align}
\frac{\partial \boldsymbol{f}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)}{\partial t} &amp;= \frac{\partial}{\partial t}\left[\boldsymbol{x}_t - t\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)\right] \
&amp;= \frac{\partial \boldsymbol{x}_t}{\partial t} - \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) - t\frac{\partial \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)}{\partial \boldsymbol{x}_t}\frac{\partial \boldsymbol{x}_t}{\partial t} - t\frac{\partial \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)}{\partial t} \
&amp;= \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) - \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t, t) - t\nabla</em>}} \boldsymbol{v<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) \cdot \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) - t\frac{\partial \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)}{\partial t}
\end{align}
å…¶ä¸­ä½¿ç”¨äº†$\frac{\partial \boldsymbol{x}_t}{\partial t} = \boldsymbol{v}</em>_t, t)$ã€‚$\square$}}(\boldsymbol{x</p>
<h3 id="cd">ä¸€è‡´æ€§è’¸é¦ï¼ˆCDï¼‰çš„å®Œæ•´æ¨å¯¼</h3>
<p>ä¸€è‡´æ€§è’¸é¦çš„ç›®æ ‡æ˜¯ä»é¢„è®­ç»ƒçš„æ‰©æ•£æ¨¡å‹$\boldsymbol{v}_{\boldsymbol{\varphi}^*}$ä¸­è’¸é¦å‡ºä¸€è‡´æ€§æ¨¡å‹ã€‚æˆ‘ä»¬ç»™å‡ºå®Œæ•´çš„ç†è®ºæ¨å¯¼ã€‚</p>
<p><strong>å®šç†1ï¼ˆä¸€è‡´æ€§è’¸é¦çš„æŸå¤±å‡½æ•°ï¼‰</strong>ï¼šç»™å®šé¢„è®­ç»ƒçš„é€Ÿåº¦åœº$\boldsymbol{v}<em t="t" t-_Delta="t-\Delta">{\boldsymbol{\varphi}^<em>}$ï¼Œä¸€è‡´æ€§è’¸é¦çš„æœ€ä¼˜ç›®æ ‡ä¸º
\begin{equation}
\mathcal{L}<em t_sim_mathcal_U="t\sim\mathcal{U">{CD}(\boldsymbol{\theta}) = \mathbb{E}</em>}[0,1], \boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0, \boldsymbol{x}_1\sim p_1}\left[w(t)d\left(\boldsymbol{f}</em>}}(\boldsymbol{x<em _text_sg="\text{sg">t, t), \boldsymbol{f}</em>^}(\boldsymbol{\theta})}(\hat{\boldsymbol{x}}_{t-\Delta t}^{\boldsymbol{\varphi</em>}, t-\Delta t)\right)\right]
\end{equation}
å…¶ä¸­$\text{sg}$è¡¨ç¤ºstop-gradientæ“ä½œï¼Œ$\hat{\boldsymbol{x}}</em>}^{\boldsymbol{\varphi}^*}$æ˜¯ä»$\boldsymbol{x<em t="t" t-_Delta="t-\Delta">t$å‡ºå‘ç”¨æ•™å¸ˆæ¨¡å‹é¢„æµ‹çš„$\boldsymbol{x}</em>$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ä½¿$\boldsymbol{f}<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{\theta}}$åœ¨ODEè½¨è¿¹ä¸Šä¿æŒä¸€è‡´ã€‚å¯¹äºODE
\begin{equation}
\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{v}</em>^<em>}(\boldsymbol{x}<em t="t" t-_Delta="t-\Delta">t, t)
\end{equation}
ä»$\boldsymbol{x}_t$åˆ°$\boldsymbol{x}</em>$çš„å•æ­¥Euleræ›´æ–°ä¸º
\begin{equation}
\hat{\boldsymbol{x}}_{t-\Delta t}^{\boldsymbol{\varphi}^</em>} = \boldsymbol{x}<em _boldsymbol_varphi="\boldsymbol{\varphi">t - \Delta t \cdot \boldsymbol{v}</em>_t, t) + O(\Delta t^2)
\end{equation}}^*}(\boldsymbol{x</p>
<p>ç”±ä¸€è‡´æ€§æ¡ä»¶ï¼Œæˆ‘ä»¬è¦æ±‚
\begin{equation}
\boldsymbol{f}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) \approx \boldsymbol{f}</em>, t-\Delta t)
\end{equation}}}(\hat{\boldsymbol{x}}_{t-\Delta t}^{\boldsymbol{\varphi}^*</p>
<p>ä¸ºäº†ç¨³å®šè®­ç»ƒï¼Œæˆ‘ä»¬å¯¹ç›®æ ‡ä½¿ç”¨EMAæˆ–stop-gradientï¼š
\begin{equation}
\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">{CD}(\boldsymbol{\theta}) = \mathbb{E}\left[w(t)d\left(\boldsymbol{f}</em>}}(\boldsymbol{x<em _bar_boldsymbol_theta="\bar{\boldsymbol{\theta">t, t), \boldsymbol{f}</em>, t-\Delta t)\right)\right]
\end{equation}
å…¶ä¸­$\bar{\boldsymbol{\theta}}$æ˜¯$\boldsymbol{\theta}$çš„EMAã€‚$\square$}}}(\hat{\boldsymbol{x}}_{t-\Delta t}^{\boldsymbol{\varphi}^*</p>
<p><strong>æ¨è®º1ï¼ˆç¦»æ•£åŒ–è¯¯å·®ï¼‰</strong>ï¼šå½“ä½¿ç”¨$n$æ­¥ç¦»æ•£åŒ–æ—¶ï¼Œä¸€è‡´æ€§è’¸é¦çš„ç´¯ç§¯è¯¯å·®ä¸º
\begin{equation}
|\boldsymbol{f}<em k="1">{\boldsymbol{\theta}}(\boldsymbol{x}_1, 1) - \boldsymbol{x}_0| \leq \sum</em>}^n |\boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}}(\boldsymbol{x}</em>)
\end{equation}}}, t_{k-1})| + O(n^{-1</p>
<p><strong>è¯æ˜</strong>ï¼šä½¿ç”¨ä¸‰è§’ä¸ç­‰å¼ï¼Œ
\begin{align}
|\boldsymbol{f}<em k="1">{\boldsymbol{\theta}}(\boldsymbol{x}_1, 1) - \boldsymbol{x}_0| &amp;= \left|\sum</em>}^n [\boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}}(\boldsymbol{x}</em>)]\right| \
&amp;\leq \sum_{k=1}^n |\boldsymbol{f}}}, t_{k-1<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}}(\boldsymbol{x}</em>)|
\end{align}}}, t_{k-1</p>
<p>æ¯ä¸ªå•æ­¥è¯¯å·®åŒ…å«ï¼š
1. æ¨¡å‹é¢„æµ‹è¯¯å·®ï¼š$|\boldsymbol{f}<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}}(\hat{\boldsymbol{x}}</em>)|$
2. æ•°å€¼ç¦»æ•£åŒ–è¯¯å·®ï¼š$O(\Delta t^2) = O(n^{-2})$}}, t_{k-1</p>
<p>æ€»ç¦»æ•£åŒ–è¯¯å·®ä¸º$n \cdot O(n^{-2}) = O(n^{-1})$ã€‚$\square$</p>
<h3 id="ct">ä¸€è‡´æ€§è®­ç»ƒï¼ˆCTï¼‰çš„æ•°å­¦åŸç†</h3>
<p>ä¸ä¸€è‡´æ€§è’¸é¦ä¸åŒï¼Œä¸€è‡´æ€§è®­ç»ƒä¸éœ€è¦é¢„è®­ç»ƒçš„æ•™å¸ˆæ¨¡å‹ï¼Œè€Œæ˜¯ç›´æ¥ä»æ•°æ®å­¦ä¹ ã€‚</p>
<p><strong>å®šç†2ï¼ˆä¸€è‡´æ€§è®­ç»ƒçš„æŸå¤±å‡½æ•°ï¼‰</strong>ï¼šä¸€è‡´æ€§è®­ç»ƒçš„ç›®æ ‡ä¸º
\begin{equation}
\mathcal{L}<em k_sim_text_Unif="k\sim\text{Unif">{CT}(\boldsymbol{\theta}) = \mathbb{E}</em>}[1,n], \boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0, \boldsymbol{x}_1\sim p_1}\left[w(t_k)d\left(\boldsymbol{f}</em>}}(\boldsymbol{x<em _bar_boldsymbol_theta="\bar{\boldsymbol{\theta">{t_k}, t_k), \boldsymbol{f}</em>}}}(\boldsymbol{x<em k-1="k-1">{t</em>)\right)\right]
\end{equation}
å…¶ä¸­$\boldsymbol{x}_{t_k} = (1-t_k)\boldsymbol{x}_0 + t_k\boldsymbol{x}_1$ï¼Œ$\bar{\boldsymbol{\theta}}$æ˜¯$\boldsymbol{\theta}$çš„EMAã€‚}}, t_{k-1</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šè¿™ä¸ªæŸå¤±å‡½æ•°çš„å·§å¦™ä¹‹å¤„åœ¨äºï¼š
1. $\boldsymbol{x}<em t__k-1="t_{k-1">{t_k}$å’Œ$\boldsymbol{x}</em>_1)$ï¼Œå› æ­¤å®ƒä»¬åœ¨åŒä¸€æ¡ODEè½¨è¿¹ä¸Š
2. é€šè¿‡è‡ªç›‘ç£çš„æ–¹å¼ï¼Œå¼ºåˆ¶æ¨¡å‹åœ¨è¿™æ¡è½¨è¿¹ä¸Šä¿æŒä¸€è‡´}}$å…±äº«åŒä¸€å¯¹$(\boldsymbol{x}_0, \boldsymbol{x</p>
<p><strong>å‘½é¢˜3ï¼ˆCTæŸå¤±çš„æ¢¯åº¦ï¼‰</strong>ï¼šä¸€è‡´æ€§è®­ç»ƒæŸå¤±çš„æ¢¯åº¦ä¸º
\begin{equation}
\nabla_{\boldsymbol{\theta}} \mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">{CT} = \mathbb{E}\left[w(t_k) \nabla</em>}} \boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k)^T \nabla d\left(\boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k), \boldsymbol{f<em t__k-1="t_{k-1">{\bar{\boldsymbol{\theta}}}(\boldsymbol{x}</em>)\right)\right]
\end{equation}}}, t_{k-1</p>
<p>å¯¹äº$L^2$è·ç¦»åº¦é‡$d(\boldsymbol{a}, \boldsymbol{b}) = |\boldsymbol{a} - \boldsymbol{b}|^2$ï¼Œæ¢¯åº¦ç®€åŒ–ä¸º
\begin{equation}
\nabla_{\boldsymbol{\theta}} \mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">{CT} = 2\mathbb{E}\left[w(t_k) \nabla</em>}} \boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k)^T \left(\boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\bar{\boldsymbol{\theta}}}(\boldsymbol{x}</em>)\right)\right]
\end{equation}}}, t_{k-1</p>
<p><strong>å®šç†3ï¼ˆCTçš„æ”¶æ•›æ€§ï¼‰</strong>ï¼šå‡è®¾$\boldsymbol{f}<em _min="\min">{\boldsymbol{\theta}}$æ˜¯$L_f$-Lipschitzè¿ç»­çš„ï¼Œæƒé‡æ»¡è¶³$w(t) \geq w</em>)$çš„é€Ÿç‡æ”¶æ•›åˆ°å±€éƒ¨æœ€ä¼˜ã€‚} &gt; 0$ï¼Œä¸”å­¦ä¹ ç‡é€‚å½“é€‰æ‹©ï¼Œåˆ™ä¸€è‡´æ€§è®­ç»ƒç®—æ³•ä»¥$O(1/\sqrt{T</p>
<p><strong>è¯æ˜ï¼ˆæ¢—æ¦‚ï¼‰</strong>ï¼šå…³é”®æ˜¯è¯æ˜æŸå¤±å‡½æ•°$\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">{CT}$æ»¡è¶³ï¼š
1. <strong>æ¢¯åº¦æœ‰ç•Œæ€§</strong>ï¼š$|\nabla</em>}} \mathcal{L<em CT="CT">{CT}| \leq G$å¯¹æŸä¸ªå¸¸æ•°$G$æˆç«‹
2. <strong>å…‰æ»‘æ€§</strong>ï¼š$\mathcal{L}</em>}$æ˜¯$L$-å…‰æ»‘çš„ï¼Œå³$|\nabla_{\boldsymbol{\theta}} \mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">{CT}(\boldsymbol{\theta}) - \nabla</em>'|$}} \mathcal{L}_{CT}(\boldsymbol{\theta}')| \leq L|\boldsymbol{\theta} - \boldsymbol{\theta</p>
<p>æ¢¯åº¦æœ‰ç•Œæ€§ç”±Lipschitzè¿ç»­æ€§ä¿è¯ï¼š
\begin{align}
|\nabla_{\boldsymbol{\theta}} \mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">{CT}| &amp;\leq 2\mathbb{E}\left[w(t_k) |\nabla</em>}} \boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k)| \cdot |\boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\bar{\boldsymbol{\theta}}}(\boldsymbol{x}</em>)|\right] \
&amp;\leq 2w_{\max} L_f \mathbb{E}\left[|\boldsymbol{f}}}, t_{k-1<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\bar{\boldsymbol{\theta}}}(\boldsymbol{x}</em>)|\right]
\end{align}}}, t_{k-1</p>
<p>åº”ç”¨æ ‡å‡†çš„éšæœºæ¢¯åº¦ä¸‹é™æ”¶æ•›ç†è®ºï¼Œå¾—åˆ°$O(1/\sqrt{T})$çš„æ”¶æ•›é€Ÿç‡ã€‚$\square$</p>
<h3 id="_10">è½¨è¿¹äº¤å‰é—®é¢˜çš„æ•°å­¦åˆ†æ</h3>
<p>è½¨è¿¹äº¤å‰æ˜¯å½±å“ä¸€è‡´æ€§æ¨¡å‹æ€§èƒ½çš„å…³é”®é—®é¢˜ã€‚æˆ‘ä»¬ç»™å‡ºå®šé‡åˆ†æã€‚</p>
<p><strong>å®šä¹‰2ï¼ˆè½¨è¿¹äº¤å‰åº¦ï¼‰</strong>ï¼šå¯¹äºä¸¤å¯¹ä¸åŒçš„åˆå§‹å€¼$(\boldsymbol{x}_0^{(1)}, \boldsymbol{x}_1^{(1)})$å’Œ$(\boldsymbol{x}_0^{(2)}, \boldsymbol{x}_1^{(2)})$ï¼Œå®šä¹‰åœ¨æ—¶åˆ»$t$çš„è½¨è¿¹äº¤å‰åº¦ä¸º
\begin{equation}
\rho(t) = \frac{|\boldsymbol{x}_t^{(1)} - \boldsymbol{x}_t^{(2)}|}{|\boldsymbol{x}_0^{(1)} - \boldsymbol{x}_0^{(2)}|}
\end{equation}</p>
<p><strong>å‘½é¢˜4ï¼ˆReFlowçš„è½¨è¿¹äº¤å‰ï¼‰</strong>ï¼šå¯¹äºReFlowçš„å™ªå£°è°ƒåº¦$\boldsymbol{x}_t = (1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1$ï¼Œè½¨è¿¹äº¤å‰åº¦ä¸º
\begin{equation}
\rho(t) = \frac{|(1-t)(\boldsymbol{x}_0^{(1)} - \boldsymbol{x}_0^{(2)}) + t(\boldsymbol{x}_1^{(1)} - \boldsymbol{x}_1^{(2)})|}{|\boldsymbol{x}_0^{(1)} - \boldsymbol{x}_0^{(2)}|}
\end{equation}</p>
<p>å½“$\boldsymbol{x}_1$ç‹¬ç«‹åŒåˆ†å¸ƒæ—¶ï¼ŒæœŸæœ›äº¤å‰åº¦ä¸º
\begin{equation}
\mathbb{E}[\rho(t)] \approx 1 - t + O(t^2)
\end{equation}
è¿™è¡¨æ˜å½“$t$å¢å¤§æ—¶ï¼Œè½¨è¿¹é—´çš„ç›¸å¯¹è·ç¦»ä¼šå‡å°ï¼Œå¯¼è‡´äº¤å‰é£é™©å¢åŠ ã€‚</p>
<p><strong>å®šç†4ï¼ˆä¸€è‡´æ€§è®­ç»ƒå‡å°‘è½¨è¿¹äº¤å‰ï¼‰</strong>ï¼šä½¿ç”¨ä¸€è‡´æ€§è®­ç»ƒçš„åˆ†æ­¥ç›®æ ‡ï¼Œæœ‰æ•ˆäº¤å‰åº¦é™ä½ä¸º
\begin{equation}
\tilde{\rho}<em _boldsymbol_theta="\boldsymbol{\theta">k = \frac{|\boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_k}^{(1)}, t_k) - \boldsymbol{f}</em>
\end{equation}
å½“$k$è¾ƒå°æ—¶ï¼Œ$\tilde{\rho}_k \approx 1$ï¼Œé¿å…äº†è½¨è¿¹äº¤å‰é—®é¢˜ã€‚}}(\boldsymbol{x}_{t_k}^{(2)}, t_k)|}{|\boldsymbol{x}_0^{(1)} - \boldsymbol{x}_0^{(2)}|</p>
<p><strong>è¯æ˜</strong>ï¼šå¯¹äºç›¸é‚»æ—¶åˆ»$t_{k-1}$å’Œ$t_k$ï¼Œç”±ä¸€è‡´æ€§è®­ç»ƒç›®æ ‡
\begin{equation}
\boldsymbol{f}<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) \approx \boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}}(\boldsymbol{x}</em>)
\end{equation}}}, t_{k-1</p>
<p>å½’çº³åœ°ï¼Œä»$k=1$å¼€å§‹ï¼š
\begin{align}
\boldsymbol{f}<em t_1="t_1">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_1) &amp;\approx \boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">0 \
\boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_2}, t_2) &amp;\approx \boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_1}, t_1) \approx \boldsymbol{x}_0 \
&amp;\vdots \
\boldsymbol{f}</em>_0
\end{align}}}(\boldsymbol{x}_{t_k}, t_k) &amp;\approx \boldsymbol{x</p>
<p>å› æ­¤
\begin{align}
\tilde{\rho}<em _boldsymbol_theta="\boldsymbol{\theta">k &amp;= \frac{|\boldsymbol{f}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_k}^{(1)}, t_k) - \boldsymbol{f}</em> \
&amp;\approx \frac{|\boldsymbol{x}_0^{(1)} - \boldsymbol{x}_0^{(2)}|}{|\boldsymbol{x}_0^{(1)} - \boldsymbol{x}_0^{(2)}|} = 1
\end{align}
$\square$}}(\boldsymbol{x}_{t_k}^{(2)}, t_k)|}{|\boldsymbol{x}_0^{(1)} - \boldsymbol{x}_0^{(2)}|</p>
<h3 id="_11">è‡ªæ´½æ€§æŸå¤±å‡½æ•°çš„æ·±å…¥åˆ†æ</h3>
<p>è‡ªæ´½æ€§æ˜¯ä¸€è‡´æ€§æ¨¡å‹çš„æ ¸å¿ƒçº¦æŸã€‚æˆ‘ä»¬åˆ†æä¸åŒå½¢å¼çš„è‡ªæ´½æ€§æŸå¤±ã€‚</p>
<p><strong>è·ç¦»åº¦é‡çš„é€‰æ‹©</strong>ï¼šå¸¸ç”¨çš„è·ç¦»åº¦é‡åŒ…æ‹¬ï¼š</p>
<ol>
<li>
<p><strong>$L^2$è·ç¦»</strong>ï¼š
\begin{equation}
d_{L^2}(\boldsymbol{a}, \boldsymbol{b}) = |\boldsymbol{a} - \boldsymbol{b}|<em i="1">2^2 = \sum</em>^d (a_i - b_i)^2
\end{equation}</p>
</li>
<li>
<p><strong>$L^1$è·ç¦»</strong>ï¼š
\begin{equation}
d_{L^1}(\boldsymbol{a}, \boldsymbol{b}) = |\boldsymbol{a} - \boldsymbol{b}|<em i="1">1 = \sum</em>^d |a_i - b_i|
\end{equation}</p>
</li>
<li>
<p><strong>æ„ŸçŸ¥æŸå¤±ï¼ˆPerceptual Lossï¼‰</strong>ï¼šå¯¹äºå›¾åƒæ•°æ®ï¼Œä½¿ç”¨é¢„è®­ç»ƒç½‘ç»œ$\Phi$çš„ç‰¹å¾è·ç¦»
\begin{equation}
d_{\text{perc}}(\boldsymbol{a}, \boldsymbol{b}) = \sum_{\ell} w_\ell |\Phi_\ell(\boldsymbol{a}) - \Phi_\ell(\boldsymbol{b})|<em>2^2
\end{equation}
å…¶ä¸­$\Phi</em>\ell$è¡¨ç¤ºç¬¬$\ell$å±‚çš„ç‰¹å¾æå–å™¨ã€‚</p>
</li>
</ol>
<p><strong>å‘½é¢˜5ï¼ˆè·ç¦»åº¦é‡çš„å½±å“ï¼‰</strong>ï¼šä¸åŒçš„è·ç¦»åº¦é‡å¯¹ä¸€è‡´æ€§è®­ç»ƒçš„å½±å“ä½“ç°åœ¨æ¢¯åº¦çš„å°ºåº¦å’Œæ–¹å‘ä¸Šã€‚å¯¹äº$L^2$è·ç¦»ï¼Œæ¢¯åº¦ä¸º
\begin{equation}
\nabla_{\boldsymbol{f}} d_{L^2}(\boldsymbol{f}, \boldsymbol{g}) = 2(\boldsymbol{f} - \boldsymbol{g})
\end{equation}
å¯¹äº$L^1$è·ç¦»ï¼Œæ¢¯åº¦ä¸º
\begin{equation}
\nabla_{\boldsymbol{f}} d_{L^1}(\boldsymbol{f}, \boldsymbol{g}) = \text{sign}(\boldsymbol{f} - \boldsymbol{g})
\end{equation}</p>
<p>$L^1$è·ç¦»çš„æ¢¯åº¦æ›´ç¨³å®šï¼Œå¯¹å¼‚å¸¸å€¼æ›´é²æ£’ï¼Œä½†åœ¨åŸç‚¹å¤„ä¸å¯å¾®ï¼›$L^2$è·ç¦»åœ¨ä¼˜åŒ–ä¸Šæ›´å¹³æ»‘ã€‚</p>
<p><strong>æƒé‡å‡½æ•°$w(t)$çš„è®¾è®¡</strong>ï¼šæƒé‡å‡½æ•°$w(t)$æ§åˆ¶ä¸åŒæ—¶åˆ»çš„é‡è¦æ€§ã€‚å¸¸è§é€‰æ‹©åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>å‡åŒ€æƒé‡</strong>ï¼š$w(t) = 1$</li>
<li><strong>æ—¶é—´ç›¸å…³æƒé‡</strong>ï¼š$w(t) = t^2$æˆ–$w(t) = 1/t^2$</li>
<li><strong>ä¿¡å™ªæ¯”ç›¸å…³æƒé‡</strong>ï¼š$w(t) = \text{SNR}(t) = \frac{(1-t)^2}{t^2}$</li>
</ol>
<p><strong>å®šç†5ï¼ˆæœ€ä¼˜æƒé‡å‡½æ•°ï¼‰</strong>ï¼šåœ¨æœ€å°åŒ–KLæ•£åº¦çš„æ„ä¹‰ä¸‹ï¼Œæœ€ä¼˜æƒé‡å‡½æ•°ä¸º
\begin{equation}
w^*(t) = \frac{p_t(\boldsymbol{x}<em KL="KL">t)}{p_0(\boldsymbol{x}_0)} \cdot \frac{\partial^2}{\partial t^2} D</em>(p_t | p_0)
\end{equation}
ä½†è¿™åœ¨å®è·µä¸­éš¾ä»¥è®¡ç®—ã€‚</p>
<h3 id="_12">å•æ­¥ç”Ÿæˆçš„ç†è®ºä¿è¯</h3>
<p>å•æ­¥ç”Ÿæˆæ˜¯ä¸€è‡´æ€§æ¨¡å‹æœ€å¸å¼•äººçš„ç‰¹æ€§ã€‚æˆ‘ä»¬ç»™å‡ºç†è®ºä¿è¯ã€‚</p>
<p><strong>å®šç†6ï¼ˆå•æ­¥ç”Ÿæˆè¯¯å·®ç•Œï¼‰</strong>ï¼šå‡è®¾ä¸€è‡´æ€§è®­ç»ƒè¾¾åˆ°$\epsilon$-æœ€ä¼˜ï¼Œå³
\begin{equation}
\mathbb{E}\left[|\boldsymbol{f}<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}}(\boldsymbol{x}</em>)|^2\right] \leq \epsilon^2
\end{equation}
å¯¹æ‰€æœ‰$k=1,\ldots,n$æˆç«‹ï¼Œåˆ™å•æ­¥ç”Ÿæˆçš„è¯¯å·®æ»¡è¶³
\begin{equation}
\mathbb{E}\left[|\boldsymbol{f}_{\boldsymbol{\theta}}(\boldsymbol{x}_1, 1) - \boldsymbol{x}_0|^2\right] \leq n\epsilon^2
\end{equation}}}, t_{k-1</p>
<p><strong>è¯æ˜</strong>ï¼šåˆ©ç”¨ä¸‰è§’ä¸ç­‰å¼å’ŒJensenä¸ç­‰å¼ï¼Œ
\begin{align}
\mathbb{E}\left[|\boldsymbol{f}<em k="1">{\boldsymbol{\theta}}(\boldsymbol{x}_1, 1) - \boldsymbol{x}_0|^2\right] &amp;= \mathbb{E}\left[\left|\sum</em>}^n [\boldsymbol{f<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}}(\boldsymbol{x}</em>)]\right|^2\right] \
&amp;\leq \mathbb{E}\left[\left(\sum_{k=1}^n |\boldsymbol{f}}}, t_{k-1<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}}(\boldsymbol{x}</em>)|\right)^2\right] \
&amp;\leq n \sum_{k=1}^n \mathbb{E}\left[|\boldsymbol{f}}}, t_{k-1<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k) - \boldsymbol{f<em t__k-1="t_{k-1">{\boldsymbol{\theta}}(\boldsymbol{x}</em>)|^2\right] \
&amp;\leq n \cdot n\epsilon^2 = n^2\epsilon^2
\end{align}}}, t_{k-1</p>
<p>æ›´ç´§çš„ç•Œå¯ä»¥é€šè¿‡å‡è®¾ç›¸é‚»æ­¥é—´çš„è¯¯å·®ç‹¬ç«‹å¾—åˆ°ï¼š
\begin{equation}
\mathbb{E}\left[|\boldsymbol{f}_{\boldsymbol{\theta}}(\boldsymbol{x}_1, 1) - \boldsymbol{x}_0|^2\right] \leq n\epsilon^2
\end{equation}
$\square$</p>
<p><strong>æ¨è®º2ï¼ˆé‡‡æ ·è´¨é‡ä¸ç¦»æ•£åŒ–æ­¥æ•°ï¼‰</strong>ï¼šä¸ºäº†è¾¾åˆ°ç›®æ ‡è¯¯å·®$\delta$ï¼Œéœ€è¦çš„ç¦»æ•£åŒ–æ­¥æ•°ä¸º
\begin{equation}
n = \Theta\left(\frac{\epsilon^2}{\delta^2}\right)
\end{equation}
è¿™è¡¨æ˜ï¼Œè®­ç»ƒæ—¶ä½¿ç”¨æ›´å¤šçš„ç¦»æ•£åŒ–æ­¥æ•°ï¼ˆæ›´å°çš„$\epsilon$ï¼‰å¯ä»¥åœ¨æ¨ç†æ—¶å®ç°æ›´å¥½çš„å•æ­¥ç”Ÿæˆè´¨é‡ã€‚</p>
<h3 id="_13">æ•°å€¼ç¨³å®šæ€§åˆ†æ</h3>
<p>æ•°å€¼ç¨³å®šæ€§æ˜¯å®é™…è®­ç»ƒä¸­çš„å…³é”®é—®é¢˜ã€‚</p>
<p><strong>é—®é¢˜1ï¼ˆæ¢¯åº¦çˆ†ç‚¸ï¼‰</strong>ï¼šå½“$t$æ¥è¿‘0æ—¶ï¼Œ$\boldsymbol{f}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) = \boldsymbol{x}_t - t\boldsymbol{v}</em>_t, t)$ä¸­çš„$1/t$é¡¹å¯èƒ½å¯¼è‡´æ•°å€¼ä¸ç¨³å®šã€‚}}(\boldsymbol{x</p>
<p><strong>è§£å†³æ–¹æ¡ˆ1ï¼ˆè·³è¿‡è¾¹ç•Œï¼‰</strong>ï¼šåœ¨è®­ç»ƒæ—¶ï¼Œé¿å…é‡‡æ ·$t$è¿‡å°çš„å€¼ï¼Œé€šå¸¸è®¾ç½®$t_{\min} &gt; 0$ï¼ˆä¾‹å¦‚$t_{\min} = 0.001$ï¼‰ã€‚</p>
<p><strong>é—®é¢˜2ï¼ˆEMAå‚æ•°çš„é€‰æ‹©ï¼‰</strong>ï¼šEMAæ›´æ–°ä¸º
\begin{equation}
\bar{\boldsymbol{\theta}}<em t_1="t+1">{t+1} = \mu \bar{\boldsymbol{\theta}}_t + (1-\mu)\boldsymbol{\theta}</em>
\end{equation}
å…¶ä¸­$\mu \in (0, 1)$æ˜¯åŠ¨é‡ç³»æ•°ã€‚</p>
<p><strong>å‘½é¢˜6ï¼ˆEMAçš„æœ‰æ•ˆæ—¶é—´çª—å£ï¼‰</strong>ï¼šEMAå‚æ•°çš„æœ‰æ•ˆæ—¶é—´çª—å£ä¸º
\begin{equation}
T_{\text{eff}} = \frac{1}{1-\mu}
\end{equation}
è¿™æ„å‘³ç€$\bar{\boldsymbol{\theta}}<em _text_eff="\text{eff">t$ä¸»è¦ç”±è¿‡å»$T</em>$æ­¥çš„å‚æ•°å†³å®šã€‚}</p>
<p><strong>è¯æ˜</strong>ï¼šè€ƒè™‘EMAå±•å¼€å¼
\begin{equation}
\bar{\boldsymbol{\theta}}<em k="0">t = (1-\mu)\sum</em>
\end{equation}
æƒé‡$\mu^k$åœ¨$k \approx 1/(1-\mu)$æ—¶è¡°å‡åˆ°$1/e$ï¼Œå®šä¹‰ä¸ºæœ‰æ•ˆæ—¶é—´çª—å£ã€‚$\square$}^{t-1} \mu^k \boldsymbol{\theta}_{t-k</p>
<p>å®è·µä¸­ï¼Œé€šå¸¸ä½¿ç”¨è‡ªé€‚åº”çš„$\mu$ï¼š
\begin{equation}
\mu(t) = \min\left{0.999, \frac{1 + t/1000}{1 + t/900}\right}
\end{equation}
åœ¨è®­ç»ƒåˆæœŸä½¿ç”¨è¾ƒå°çš„$\mu$ï¼Œéšåé€æ¸å¢å¤§ã€‚</p>
<p><strong>é—®é¢˜3ï¼ˆç¦»æ•£åŒ–æ­¥æ•°çš„é€‰æ‹©ï¼‰</strong>ï¼šè®­ç»ƒæ—¶ä½¿ç”¨$n$æ­¥ç¦»æ•£åŒ–ï¼Œæ¨ç†æ—¶å¯ä»¥ä½¿ç”¨$m$æ­¥ï¼ˆ$m \leq n$ï¼‰ã€‚</p>
<p><strong>å®šç†7ï¼ˆå¤šæ­¥æ¨ç†çš„è¯¯å·®ç•Œï¼‰</strong>ï¼šå¦‚æœè®­ç»ƒæ—¶ä½¿ç”¨$n$æ­¥ç¦»æ•£åŒ–ï¼Œæ¨ç†æ—¶ä½¿ç”¨$m$æ­¥ï¼ˆ$m &lt; n$ï¼‰ï¼Œåˆ™è¯¯å·®ç•Œä¸º
\begin{equation}
\mathbb{E}\left[|\boldsymbol{f}_{\boldsymbol{\theta}}(\boldsymbol{x}_1, 1) - \boldsymbol{x}_0|^2\right] \leq m\epsilon^2 + C\left(\frac{m}{n}\right)
\end{equation}
å…¶ä¸­ç¬¬ä¸€é¡¹æ˜¯ä¸€è‡´æ€§è¯¯å·®ï¼Œç¬¬äºŒé¡¹æ˜¯ç¦»æ•£åŒ–è¯¯å·®ã€‚</p>
<h3 id="_14">ä¸å…¶ä»–æ‰©æ•£æ¨¡å‹çš„å…³ç³»</h3>
<p><strong>å‘½é¢˜7ï¼ˆä¸€è‡´æ€§æ¨¡å‹ä¸DDIMçš„å…³ç³»ï¼‰</strong>ï¼šDDIMçš„ç¡®å®šæ€§é‡‡æ ·å¯ä»¥å†™ä¸º
\begin{equation}
\boldsymbol{x}<em k-1="k-1">{t</em>}} = \sqrt{\alpha_{t_{k-1}}}\underbrace{\frac{\boldsymbol{x<em t_k="t_k">{t_k} - \sqrt{1-\alpha</em>}}\boldsymbol{\epsilon<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>}, t_k)}{\sqrt{\alpha_{t_k}}}<em t__k-1="t_{k-1">{\hat{\boldsymbol{x}}_0} + \sqrt{1-\alpha</em>}}}\boldsymbol{\epsilon<em t_k="t_k">{\boldsymbol{\theta}}(\boldsymbol{x}</em>, t_k)
\end{equation}</p>
<p>å®šä¹‰$\boldsymbol{f}<em t_k="t_k">{\text{DDIM}}(\boldsymbol{x}</em>}, t_k) = \hat{\boldsymbol{x}<em _text_DDIM="\text{DDIM">0$ï¼Œåˆ™DDIMéšå¼åœ°æ„é€ äº†ä¸€ä¸ªä¸€è‡´æ€§å‡½æ•°ã€‚ä½†ä¸ä¸€è‡´æ€§æ¨¡å‹ä¸åŒçš„æ˜¯ï¼ŒDDIMçš„$\boldsymbol{f}</em>$æ²¡æœ‰æ˜¾å¼åœ°é€šè¿‡è‡ªæ´½æ€§æŸå¤±è®­ç»ƒã€‚}</p>
<p><strong>å‘½é¢˜8ï¼ˆä¸€è‡´æ€§æ¨¡å‹ä¸Score-basedæ¨¡å‹çš„å…³ç³»ï¼‰</strong>ï¼šScore-basedæ¨¡å‹å­¦ä¹ å¾—åˆ†å‡½æ•°$\boldsymbol{s}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) = \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t} \log p_t(\boldsymbol{x}_t)$ï¼Œé€šè¿‡Tweedieå…¬å¼ï¼Œå¯ä»¥å¾—åˆ°
\begin{equation}
\mathbb{E}[\boldsymbol{x}_0 | \boldsymbol{x}_t] = \boldsymbol{x}_t + \sigma_t^2 \boldsymbol{s}</em>_t, t)
\end{equation}}}(\boldsymbol{x</p>
<p>å¯¹äºReFlowçš„ç‰¹æ®Šæƒ…å†µï¼Œå¾—åˆ†å‡½æ•°å’Œä¸€è‡´æ€§å‡½æ•°çš„å…³ç³»ä¸º
\begin{equation}
\boldsymbol{f}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) \approx \mathbb{E}[\boldsymbol{x}_0 | \boldsymbol{x}_t] = \boldsymbol{x}_t + t^2 \boldsymbol{s}</em>_t, t)
\end{equation}}}(\boldsymbol{x</p>
<h3 id="_15">å®é™…è®­ç»ƒç®—æ³•</h3>
<p>æˆ‘ä»¬ç»™å‡ºä¸€è‡´æ€§è®­ç»ƒå’Œä¸€è‡´æ€§è’¸é¦çš„å®Œæ•´ä¼ªä»£ç ã€‚</p>
<p><strong>ç®—æ³•1ï¼šä¸€è‡´æ€§è®­ç»ƒï¼ˆCTï¼‰</strong></p>
<div class="codehilite"><pre><span></span><code>è¾“å…¥ï¼šæ•°æ®åˆ†å¸ƒ p_0ï¼Œå…ˆéªŒåˆ†å¸ƒ p_1ï¼Œç¦»æ•£åŒ–æ­¥æ•° nï¼ŒEMAåŠ¨é‡ Î¼ï¼Œå­¦ä¹ ç‡ Î·
åˆå§‹åŒ–ï¼šéšæœºåˆå§‹åŒ– Î¸ï¼Œè®¾ç½® Î¸Ì„ = Î¸
for epoch = 1, 2, ... do
    é‡‡æ · x_0 ~ p_0, x_1 ~ p_1
    å‡åŒ€é‡‡æ · k ~ Uniform{1, 2, ..., n}
    è®¡ç®— t_k = k/n, t_{k-1} = (k-1)/n
    æ„é€  x_{t_k} = (1 - t_k)x_0 + t_k x_1
    æ„é€  x_{t_{k-1}} = (1 - t_{k-1})x_0 + t_{k-1} x_1

    è®¡ç®—ä¸€è‡´æ€§æŸå¤±ï¼š
    L = w(t_k) || f_Î¸(x_{t_k}, t_k) - f_{Î¸Ì„}(x_{t_{k-1}}, t_{k-1}) ||Â²

    æ¢¯åº¦æ›´æ–°ï¼š
    Î¸ â† Î¸ - Î· âˆ‡_Î¸ L

    EMAæ›´æ–°ï¼š
    Î¸Ì„ â† Î¼Î¸Ì„ + (1-Î¼)Î¸
end for
è¾“å‡ºï¼šÎ¸
</code></pre></div>

<p><strong>ç®—æ³•2ï¼šä¸€è‡´æ€§è’¸é¦ï¼ˆCDï¼‰</strong></p>
<div class="codehilite"><pre><span></span><code>è¾“å…¥ï¼šé¢„è®­ç»ƒæ¨¡å‹ v_Ï†*ï¼Œæ•°æ®åˆ†å¸ƒ p_0ï¼Œå…ˆéªŒåˆ†å¸ƒ p_1ï¼Œ
      ç¦»æ•£åŒ–æ­¥æ•° nï¼ŒEMAåŠ¨é‡ Î¼ï¼Œå­¦ä¹ ç‡ Î·
åˆå§‹åŒ–ï¼šéšæœºåˆå§‹åŒ– Î¸ï¼ˆæˆ–ä» v_Ï†* åˆå§‹åŒ–ï¼‰ï¼Œè®¾ç½® Î¸Ì„ = Î¸
for epoch = 1, 2, ... do
    é‡‡æ · x_0 ~ p_0, x_1 ~ p_1
    å‡åŒ€é‡‡æ · k ~ Uniform{1, 2, ..., n}
    è®¡ç®— t_k = k/n, t_{k-1} = (k-1)/n
    æ„é€  x_{t_k} = (1 - t_k)x_0 + t_k x_1

    ä½¿ç”¨æ•™å¸ˆæ¨¡å‹é¢„æµ‹ï¼š
    xÌ‚_{t_{k-1}} = x_{t_k} - (t_k - t_{k-1}) v_Ï†*(x_{t_k}, t_k)

    è®¡ç®—ä¸€è‡´æ€§æŸå¤±ï¼š
    L = w(t_k) || f_Î¸(x_{t_k}, t_k) - f_{Î¸Ì„}(xÌ‚_{t_{k-1}}, t_{k-1}) ||Â²

    æ¢¯åº¦æ›´æ–°ï¼š
    Î¸ â† Î¸ - Î· âˆ‡_Î¸ L

    EMAæ›´æ–°ï¼š
    Î¸Ì„ â† Î¼Î¸Ì„ + (1-Î¼)Î¸
end for
è¾“å‡ºï¼šÎ¸
</code></pre></div>

<p><strong>ç®—æ³•3ï¼šå¤šæ­¥é‡‡æ ·</strong></p>
<div class="codehilite"><pre><span></span><code>è¾“å…¥ï¼šä¸€è‡´æ€§æ¨¡å‹ f_Î¸*ï¼Œé‡‡æ ·æ­¥æ•° mï¼Œæ—¶é—´è°ƒåº¦ {tÌƒ_1, ..., tÌƒ_m}
åˆå§‹åŒ–ï¼šé‡‡æ · x_1 ~ N(0, I)
x_0 â† f_Î¸*(x_1, 1)
for k = m-1, m-2, ..., 1 do
    é‡‡æ · z ~ N(0, I)
    æ·»åŠ å™ªå£°ï¼šx_{tÌƒ_k} â† (1 - tÌƒ_k)x_0 + tÌƒ_k z
    å»å™ªï¼šx_0 â† f_Î¸*(x_{tÌƒ_k}, tÌƒ_k)
end for
è¾“å‡ºï¼šx_0
</code></pre></div>

<p><strong>å…³é”®å®ç°ç»†èŠ‚</strong>ï¼š</p>
<ol>
<li>
<p><strong>å‚æ•°åŒ–æŠ€å·§</strong>ï¼šä¸ºäº†ç¡®ä¿è¾¹ç•Œæ¡ä»¶$\boldsymbol{f}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_0, 0) = \boldsymbol{x}_0$ï¼Œå¸¸ç”¨çš„å‚æ•°åŒ–æ–¹å¼ä¸º
\begin{equation}
\boldsymbol{f}</em>}}(\boldsymbol{x<em _text_skip="\text{skip">t, t) = c</em>}}(t)\boldsymbol{x<em _text_out="\text{out">t + c</em>}}(t)\boldsymbol{F<em _text_skip="\text{skip">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)
\end{equation}
å…¶ä¸­$c</em>(0) = 0$ã€‚ä¸€ä¸ªå¸¸ç”¨çš„é€‰æ‹©æ˜¯
\begin{equation}
c_{\text{skip}}(t) = \frac{\sigma_{\text{data}}^2}{(t-\epsilon)^2 + \sigma_{\text{data}}^2}, \quad c_{\text{out}}(t) = \frac{\sigma_{\text{data}}(t-\epsilon)}{\sqrt{\sigma_{\text{data}}^2 + t^2}}
\end{equation}
å…¶ä¸­$\sigma_{\text{data}}$æ˜¯æ•°æ®çš„æ ‡å‡†å·®ï¼Œ$\epsilon$æ˜¯å°çš„æ­£å¸¸æ•°ã€‚}}(0) = 1$ï¼Œ$c_{\text{out}</p>
</li>
<li>
<p><strong>æ—¶é—´é‡‡æ ·ç­–ç•¥</strong>ï¼šä¸ºäº†æ›´æœ‰æ•ˆåœ°è®­ç»ƒï¼Œå¯ä»¥ä½¿ç”¨éå‡åŒ€çš„æ—¶é—´é‡‡æ ·ã€‚ä¸€ä¸ªå¸¸ç”¨çš„ç­–ç•¥æ˜¯å¯¹æ•°å‡åŒ€é‡‡æ ·ï¼š
\begin{equation}
t \sim \mathcal{U}[\log t_{\min}, \log t_{\max}], \quad t = e^{\tilde{t}}
\end{equation}
è¿™æ ·å¯ä»¥åœ¨å°$t$å€¼å¤„æœ‰æ›´å¯†é›†çš„é‡‡æ ·ï¼Œå› ä¸ºé‚£é‡Œçš„å‡½æ•°å˜åŒ–æ›´å‰§çƒˆã€‚</p>
</li>
<li>
<p><strong>å­¦ä¹ ç‡è°ƒåº¦</strong>ï¼šæ¨èä½¿ç”¨warmup + cosine decayçš„å­¦ä¹ ç‡è°ƒåº¦ï¼š
\begin{equation}
\eta(t) = \begin{cases}
\eta_{\max} \frac{t}{T_{\text{warmup}}} &amp; t \leq T_{\text{warmup}} \
\eta_{\min} + \frac{1}{2}(\eta_{\max} - \eta_{\min})\left(1 + \cos\frac{\pi(t-T_{\text{warmup}})}{T_{\max}-T_{\text{warmup}}}\right) &amp; t &gt; T_{\text{warmup}}
\end{cases}
\end{equation}</p>
</li>
<li>
<p><strong>æ¢¯åº¦è£å‰ª</strong>ï¼šä¸ºäº†ç¨³å®šè®­ç»ƒï¼Œå»ºè®®ä½¿ç”¨æ¢¯åº¦è£å‰ªï¼š
\begin{equation}
\nabla_{\boldsymbol{\theta}} L \leftarrow \min\left{1, \frac{\tau}{|\nabla_{\boldsymbol{\theta}} L|}\right} \nabla_{\boldsymbol{\theta}} L
\end{equation}
å…¶ä¸­$\tau$æ˜¯è£å‰ªé˜ˆå€¼ï¼Œé€šå¸¸è®¾ä¸º1.0ã€‚</p>
</li>
</ol>
<h3 id="_16">ç†è®ºä¸å®è·µçš„å·®è·</h3>
<p>è™½ç„¶ä¸€è‡´æ€§æ¨¡å‹åœ¨ç†è®ºä¸Šå¾ˆä¼˜é›…ï¼Œä½†å®è·µä¸­ä»å­˜åœ¨ä¸€äº›æŒ‘æˆ˜ï¼š</p>
<p><strong>æŒ‘æˆ˜1ï¼ˆè®­ç»ƒç¨³å®šæ€§ï¼‰</strong>ï¼šç”±äºä½¿ç”¨EMAç›®æ ‡ï¼Œè®­ç»ƒåˆæœŸå¯èƒ½ä¸ç¨³å®šã€‚è§£å†³æ–¹æ¡ˆåŒ…æ‹¬ï¼š
- ä»é¢„è®­ç»ƒçš„æ‰©æ•£æ¨¡å‹åˆå§‹åŒ–
- ä½¿ç”¨è¾ƒå¤§çš„åˆå§‹EMAåŠ¨é‡$\mu$
- é€æ­¥å¢åŠ ç¦»æ•£åŒ–æ­¥æ•°$n$ï¼ˆcurriculum learningï¼‰</p>
<p><strong>æŒ‘æˆ˜2ï¼ˆå•æ­¥ç”Ÿæˆè´¨é‡ï¼‰</strong>ï¼šè™½ç„¶ç†è®ºä¸Šå¯ä»¥å•æ­¥ç”Ÿæˆï¼Œä½†å®è·µä¸­å•æ­¥ç”Ÿæˆçš„è´¨é‡å¾€å¾€ä¸å¦‚å¤šæ­¥é‡‡æ ·ã€‚è¿™æ˜¯å› ä¸ºï¼š
- è®­ç»ƒæ—¶çš„$\epsilon$å¯èƒ½ä¸å¤Ÿå°
- è½¨è¿¹äº¤å‰é—®é¢˜æ²¡æœ‰å®Œå…¨è§£å†³
- æ¨¡å‹å®¹é‡ä¸è¶³</p>
<p><strong>æŒ‘æˆ˜3ï¼ˆæ¨¡å¼è¦†ç›–ï¼‰</strong>ï¼šä¸€è‡´æ€§è®­ç»ƒå¯èƒ½ä¼šå¯¼è‡´æ¨¡å¼è¦†ç›–é—®é¢˜ï¼Œå³ç”Ÿæˆçš„æ ·æœ¬å¤šæ ·æ€§ä¸è¶³ã€‚è¿™å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼ç¼“è§£ï¼š
- ä½¿ç”¨æ›´å¤§çš„æ¨¡å‹
- å¢åŠ è®­ç»ƒæ•°æ®
- ä½¿ç”¨diversity-promotingçš„æŸå¤±å‡½æ•°</p>
<p><strong>æ€»ç»“</strong>ï¼šä¸€è‡´æ€§æ¨¡å‹æä¾›äº†ä¸€ç§ä¼˜é›…çš„å•æ­¥ç”Ÿæˆæ–¹æ³•ï¼Œé€šè¿‡è‡ªæ´½æ€§çº¦æŸå¼ºåˆ¶æ¨¡å‹åœ¨ODEè½¨è¿¹ä¸Šä¿æŒä¸€è‡´ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯ç”¨åˆ†æ­¥çš„ã€æ›´å®¹æ˜“å­¦ä¹ çš„ç›®æ ‡æ›¿ä»£ç›´æ¥çš„ç«¯åˆ°ç«¯ç›®æ ‡ï¼Œä»è€Œé¿å…è½¨è¿¹äº¤å‰é—®é¢˜ã€‚æ•°å­¦ä¸Šï¼Œä¸€è‡´æ€§æ¨¡å‹æœ¬è´¨ä¸Šæ˜¯åœ¨å­¦ä¹ ODEè½¨è¿¹çš„é¦–æ¬¡å‘½ä¸­æ—¶é—´å‡½æ•°ï¼Œå³ä»ä»»æ„ç‚¹$\boldsymbol{x}_t$æ‰¾åˆ°å…¶å¯¹åº”çš„èµ·ç‚¹$\boldsymbol{x}_0$ã€‚è¿™ç§ç»Ÿä¸€çš„è§†è§’å°†æ‰©æ•£æ¨¡å‹ã€æµåŒ¹é…å’Œä¸€è‡´æ€§æ¨¡å‹è¿æ¥èµ·æ¥ï¼Œä¸ºç”Ÿæˆæ¨¡å‹çš„ç†è®ºå’Œå®è·µæä¾›äº†æ–°çš„æ´å¯Ÿã€‚</p>
        </div>
    </div>
</body>
</html>