<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š1.  SGD + è¶…çƒé¢</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>æµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š1.  SGD + è¶…çƒé¢</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-25 | ğŸ“„ å¤§å°: 96.9 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11196">https://spaces.ac.cn/archives/11196</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ç±»ä¼¼â€œæ¢¯åº¦çš„åæ–¹å‘æ˜¯ä¸‹é™æœ€å¿«çš„æ–¹å‘â€çš„æè¿°ï¼Œç»å¸¸ç”¨äºä»‹ç»æ¢¯åº¦ä¸‹é™ï¼ˆSGDï¼‰çš„åŸç†ã€‚ç„¶è€Œï¼Œè¿™å¥è¯æ˜¯æœ‰æ¡ä»¶çš„ï¼Œæ¯”å¦‚â€œæ–¹å‘â€åœ¨æ•°å­¦ä¸Šæ˜¯å•ä½å‘é‡ï¼Œå®ƒä¾èµ–äºâ€œèŒƒæ•°ï¼ˆæ¨¡é•¿ï¼‰â€çš„å®šä¹‰ï¼Œä¸åŒèŒƒæ•°çš„ç»“è®ºä¹Ÿä¸åŒï¼Œ<a href="/archives/10592">Muon</a>å®é™…ä¸Šå°±æ˜¯ç»™çŸ©é˜µå‚æ•°æ¢äº†ä¸ªè°±èŒƒæ•°ï¼Œä»è€Œå¾—åˆ°äº†æ–°çš„ä¸‹é™æ–¹å‘ã€‚åˆæ¯”å¦‚ï¼Œå½“æˆ‘ä»¬ä»æ— çº¦æŸä¼˜åŒ–è½¬ç§»åˆ°çº¦æŸä¼˜åŒ–æ—¶ï¼Œä¸‹é™æœ€å¿«çš„æ–¹å‘ä¹Ÿæœªå¿…æ˜¯æ¢¯åº¦çš„åæ–¹å‘ã€‚</p>
<p>ä¸ºæ­¤ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å°†æ–°å¼€ä¸€ä¸ªç³»åˆ—ï¼Œä»¥"çº¦æŸ"ä¸ºä¸»çº¿ï¼Œé‡æ–°å®¡è§†"æœ€é€Ÿä¸‹é™"è¿™ä¸€å‘½é¢˜ï¼Œæ¢æŸ¥ä¸åŒæ¡ä»¶ä¸‹çš„"ä¸‹é™æœ€å¿«çš„æ–¹å‘"æŒ‡å‘ä½•æ–¹ã€‚</p>
<hr />
<h2 id="1">ç¬¬1éƒ¨åˆ†ï¼šç†è®ºèµ·æºã€å…¬ç†ä¸å†å²åŸºç¡€</h2>
<h3 id="11">1.1 æµå½¢ä¼˜åŒ–çš„ç†è®ºèµ·æº</h3>
<p>æµå½¢ä¸Šçš„ä¼˜åŒ–é—®é¢˜å¹¶éç°ä»£å‘æ˜ï¼Œè€Œæ˜¯æ¤æ ¹äºæ•°å­¦ã€ç‰©ç†å’Œå·¥ç¨‹çš„æ·±åšåœŸå£¤ä¹‹ä¸­ã€‚</p>
<div class="theorem-box">

#### ç†è®ºæ ¹æºçš„ä¸‰å¤§æ”¯æŸ±

**1. å¾®åˆ†å‡ ä½•ï¼ˆDifferential Geometry, 19ä¸–çºªï¼‰**
- **é«˜æ–¯ï¼ˆGauss, 1827ï¼‰**ï¼šæ›²é¢å†…è•´å‡ ä½•ç†è®ºï¼Œé¦–æ¬¡æå‡ºæ›²é¢ä¸Šçš„æµ‹åœ°çº¿æ¦‚å¿µ
- **é»æ›¼ï¼ˆRiemann, 1854ï¼‰**ï¼šå°†å‡ ä½•æ¨å¹¿åˆ°é«˜ç»´æµå½¢ï¼Œå®šä¹‰é»æ›¼åº¦é‡å’Œé»æ›¼æ›²ç‡
- **åˆ—ç»´-é½ç»´å¡”ï¼ˆLevi-Civita, 1917ï¼‰**ï¼šé»æ›¼è”ç»œç†è®ºï¼Œè§£å†³å‘é‡åœ¨å¼¯æ›²ç©ºé—´ä¸­çš„å¹³è¡Œç§»åŠ¨é—®é¢˜

**2. å˜åˆ†æ³•ä¸çº¦æŸä¼˜åŒ–ï¼ˆCalculus of Variations, 18ä¸–çºªï¼‰**
- **æ‹‰æ ¼æœ—æ—¥ï¼ˆLagrange, 1788ï¼‰**ï¼šæ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•å¤„ç†ç­‰å¼çº¦æŸä¼˜åŒ–
- **æ¬§æ‹‰ï¼ˆEuler, 1744ï¼‰**ï¼šå˜åˆ†æ³•æ±‚è§£æ³›å‡½æå€¼ï¼Œå¥ å®šæµ‹åœ°çº¿ç†è®ºåŸºç¡€
- **åºç‰¹é‡Œäºšé‡‘ï¼ˆPontryagin, 1956ï¼‰**ï¼šæœ€å¤§å€¼åŸç†ï¼Œå¤„ç†å¸¦çº¦æŸçš„åŠ¨æ€ä¼˜åŒ–

**3. çŸ©é˜µæµå½¢ä¸æ•°å€¼åˆ†æï¼ˆ20ä¸–çºªï¼‰**
- **Edelman (1998)**ï¼šçŸ©é˜µæµå½¢ä¸Šçš„å‡ ä½•ä¸ä¼˜åŒ–ï¼Œå°†æŠ½è±¡æµå½¢ç†è®ºåº”ç”¨äºå®é™…è®¡ç®—
- **Absil, Mahony & Sepulchre (2008)**ï¼šä¸“è‘—ã€ŠOptimization Algorithms on Matrix Manifoldsã€‹ï¼Œç³»ç»ŸåŒ–æµå½¢ä¼˜åŒ–ç®—æ³•
- **Boumal (2020)**ï¼šã€ŠAn Introduction to Optimization on Smooth Manifoldsã€‹ï¼Œç°ä»£æµå½¢ä¼˜åŒ–æ•™ç§‘ä¹¦

</div>

<p><strong>æ ¸å¿ƒé—®é¢˜çš„æ¼”åŒ–</strong>ï¼š</p>
<p>ä»æ— çº¦æŸä¼˜åŒ–åˆ°çº¦æŸä¼˜åŒ–ï¼Œå†åˆ°æµå½¢ä¼˜åŒ–ï¼Œè¿™ä¸€æ¼”åŒ–åæ˜ äº†å¯¹"çº¦æŸ"è®¤çŸ¥çš„æ·±åŒ–ï¼š</p>
<ol>
<li><strong>æ— çº¦æŸä¼˜åŒ–</strong>ï¼ˆ18-19ä¸–çºªï¼‰ï¼š$\min_{\boldsymbol{x} \in \mathbb{R}^n} f(\boldsymbol{x})$</li>
<li>æ¢¯åº¦ä¸‹é™ï¼šæ²¿è´Ÿæ¢¯åº¦æ–¹å‘åœ¨å¹³å¦æ¬§æ°ç©ºé—´ä¸­å‰è¿›</li>
<li>
<p>é—®é¢˜ï¼šå‚æ•°å¯èƒ½ä»»æ„å¢é•¿ï¼Œç¼ºä¹å…ˆéªŒç»“æ„</p>
</li>
<li>
<p><strong>çº¦æŸä¼˜åŒ–</strong>ï¼ˆ19-20ä¸–çºªï¼‰ï¼š$\min_{\boldsymbol{x}} f(\boldsymbol{x}) \quad \text{s.t.} \quad g(\boldsymbol{x}) = 0$</p>
</li>
<li>æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•ã€KKTæ¡ä»¶ã€æŠ•å½±æ¢¯åº¦æ³•</li>
<li>
<p>é—®é¢˜ï¼šå°†çº¦æŸè§†ä¸º"éšœç¢"ï¼Œè€Œéå†…åœ¨å‡ ä½•</p>
</li>
<li>
<p><strong>æµå½¢ä¼˜åŒ–</strong>ï¼ˆ20ä¸–çºªæœ«è‡³ä»Šï¼‰ï¼š$\min_{\boldsymbol{x} \in \mathcal{M}} f(\boldsymbol{x})$</p>
</li>
<li>çº¦æŸé›†$\mathcal{M}$æœ¬èº«æ˜¯æµå½¢ï¼Œå…·æœ‰å†…åœ¨å‡ ä½•ç»“æ„</li>
<li><strong>èŒƒå¼è½¬æ¢</strong>ï¼šä»"åœ¨æ¬§æ°ç©ºé—´ä¸­æ»¡è¶³çº¦æŸ"åˆ°"åœ¨æµå½¢ä¸Šè‡ªç„¶ç§»åŠ¨"</li>
</ol>
<h3 id="12">1.2 å†å²å‘å±•ï¼šå…³é”®é‡Œç¨‹ç¢‘</h3>
<div class="theorem-box">

#### æµå½¢ä¼˜åŒ–çš„å†å²æ—¶é—´çº¿

**é˜¶æ®µä¸€ï¼šæ•°å­¦åŸºç¡€å¥ å®šï¼ˆ19ä¸–çºª-1950å¹´ä»£ï¼‰**

1. **1827 - é«˜æ–¯ã€Šå…³äºæ›²é¢çš„ä¸€èˆ¬ç ”ç©¶ã€‹**
   - æå‡ºæ›²é¢å†…è•´å‡ ä½•æ¦‚å¿µ
   - é«˜æ–¯æ›²ç‡å®šç†ï¼šæ›²ç‡æ˜¯å†…è•´æ€§è´¨ï¼Œä¸ä¾èµ–äºåµŒå…¥ç©ºé—´
   - **æ„ä¹‰**ï¼šä¸ºåœ¨æ›²é¢ä¸Šè¿›è¡Œ"å†…åœ¨"ä¼˜åŒ–æä¾›æ•°å­¦åŸºç¡€

2. **1854 - é»æ›¼å°±èŒæ¼”è®²ã€Šå‡ ä½•åŸºç¡€çš„å‡è®¾ã€‹**
   - å°†å‡ ä½•æ¨å¹¿åˆ°ä»»æ„ç»´åº¦çš„æµå½¢
   - å®šä¹‰é»æ›¼åº¦é‡ï¼š$g_{ij}(\boldsymbol{x}) = \langle \partial_i, \partial_j \rangle$
   - **æ„ä¹‰**ï¼šè¶…çƒé¢ç­‰çº¦æŸé›†å¯ç»Ÿä¸€åœ¨é»æ›¼å‡ ä½•æ¡†æ¶ä¸‹ç ”ç©¶

3. **1917 - åˆ—ç»´-é½ç»´å¡”è”ç»œ**
   - è§£å†³å‘é‡åœ¨å¼¯æ›²ç©ºé—´ä¸­çš„å¹³è¡Œç§»åŠ¨
   - å®šä¹‰æµ‹åœ°çº¿ï¼š$\nabla_{\dot{\gamma}}\dot{\gamma} = 0$
   - **æ„ä¹‰**ï¼šæ¢¯åº¦ä¸‹é™åœ¨æµå½¢ä¸Šçš„è‡ªç„¶æ¨å¹¿

**é˜¶æ®µäºŒï¼šæ•°å€¼ç®—æ³•å‘å±•ï¼ˆ1960-1990å¹´ä»£ï¼‰**

4. **1970s - æŠ•å½±æ¢¯åº¦æ³•ï¼ˆProjected Gradient Descentï¼‰**
   - Rosen (1960), Bertsekas (1976)
   - æ ¸å¿ƒæ€æƒ³ï¼šæ¬§æ°æ¢¯åº¦æ­¥ â†’ æŠ•å½±å›çº¦æŸé›†
   - **å±€é™**ï¼šå°†çº¦æŸè§†ä¸ºå¤–åœ¨é™åˆ¶ï¼Œå¿½ç•¥å†…åœ¨å‡ ä½•

5. **1980 - Luenbergerã€Šçº¿æ€§ä¸éçº¿æ€§è§„åˆ’ã€‹**
   - ç³»ç»Ÿè®ºè¿°çº¦æŸä¼˜åŒ–çš„ä¸€é˜¶/äºŒé˜¶æ–¹æ³•
   - å¼•å…¥å¯è¡Œæ–¹å‘é”¥ï¼ˆCone of Feasible Directionsï¼‰æ¦‚å¿µ
   - **å½±å“**ï¼šä¸ºæµå½¢ä¼˜åŒ–çš„åˆ‡ç©ºé—´ç†è®ºé“ºè·¯

6. **1998 - Edelman, Arias & Smithã€ŠçŸ©é˜µæµå½¢çš„å‡ ä½•ã€‹**
   - é¦–æ¬¡ç³»ç»Ÿç ”ç©¶çŸ©é˜µæµå½¢ï¼ˆStiefelæµå½¢ã€Grassmannæµå½¢ï¼‰
   - ç»™å‡ºåˆ‡ç©ºé—´ã€é»æ›¼æ¢¯åº¦ã€retractionçš„æ˜¾å¼å…¬å¼
   - **æ„ä¹‰**ï¼šå°†æŠ½è±¡ç†è®ºè½¬åŒ–ä¸ºå¯è®¡ç®—ç®—æ³•

**é˜¶æ®µä¸‰ï¼šç°ä»£åº”ç”¨çˆ†å‘ï¼ˆ2000å¹´ä»£è‡³ä»Šï¼‰**

7. **2008 - Absil, Mahony & Sepulchreä¸“è‘—**
   - ç³»ç»ŸåŒ–æµå½¢ä¼˜åŒ–ç®—æ³•æ¡†æ¶
   - æ¶µç›–ï¼šé»æ›¼æ¢¯åº¦ã€é»æ›¼Hessianã€trust-regionæ–¹æ³•ã€å…±è½­æ¢¯åº¦
   - **å·¥å…·**ï¼šManoptå·¥å…·ç®±ï¼ˆMATLAB/Pythonï¼‰
   - **å½±å“**ï¼šæˆä¸ºæµå½¢ä¼˜åŒ–çš„æ ‡å‡†æ•™æ

8. **2016 - Salimans & Kingmaã€Šæƒé‡å½’ä¸€åŒ–ã€‹ï¼ˆNeurIPSï¼‰**
   - å°†ç¥ç»ç½‘ç»œæƒé‡åˆ†è§£ä¸ºæ–¹å‘ï¼ˆè¶…çƒé¢ï¼‰å’Œå°ºåº¦
   - $\boldsymbol{w} = g \cdot \boldsymbol{v}/\|\boldsymbol{v}\|_2$
   - **åº”ç”¨**ï¼šRNNè®­ç»ƒåŠ é€Ÿã€GANç¨³å®šæ€§æå‡
   - **æ„ä¹‰**ï¼šæµå½¢ä¼˜åŒ–è¿›å…¥æ·±åº¦å­¦ä¹ ä¸»æµ

9. **2018 - Miyato et al.ã€Šè°±å½’ä¸€åŒ–ã€‹ï¼ˆICLRï¼‰**
   - çº¦æŸæƒé‡çŸ©é˜µçš„æœ€å¤§å¥‡å¼‚å€¼ä¸º1
   - ä½¿ç”¨å¹‚è¿­ä»£æ³•åœ¨Stiefelæµå½¢ä¸Šä¼˜åŒ–
   - **åº”ç”¨**ï¼šGANåˆ¤åˆ«å™¨Lipschitzçº¦æŸ
   - **æ„ä¹‰**ï¼šå‡ ä½•çº¦æŸæ”¹å–„ç”Ÿæˆæ¨¡å‹è´¨é‡

10. **2020+ - ç°ä»£æµå½¢ä¼˜åŒ–åº“**
    - **Geoopt (PyTorch)**ï¼šæ”¯æŒè¶…çƒé¢ã€åŒæ›²ç©ºé—´ã€SPDæµå½¢
    - **JAXopt**ï¼šJAXä¸­çš„æµå½¢ä¼˜åŒ–
    - **Pymanopt**ï¼šé€šç”¨æµå½¢ä¼˜åŒ–æ¡†æ¶
    - **æ„ä¹‰**ï¼šé™ä½ä½¿ç”¨é—¨æ§›ï¼Œæ¨åŠ¨å·¥ä¸šåº”ç”¨

</div>

<h3 id="13">1.3 æ•°å­¦å…¬ç†ä¸åŸºç¡€å‡è®¾</h3>
<p>è¶…çƒé¢ä¼˜åŒ–å»ºç«‹åœ¨ä»¥ä¸‹æ•°å­¦å…¬ç†ä¹‹ä¸Šï¼š</p>
<div class="theorem-box">

#### å…¬ç†1ï¼šæµå½¢çš„å®šä¹‰

**è¶…çƒé¢æµå½¢** $\mathcal{S}^{n-1}$ æ˜¯æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„é›†åˆï¼š
$$
\mathcal{S}^{n-1} = \{\boldsymbol{w} \in \mathbb{R}^n : \|\boldsymbol{w}\|_2 = 1\}
$$

**æ€§è´¨**ï¼š
1. **ç´§è‡´æ€§**ï¼š$\mathcal{S}^{n-1}$ æ˜¯æœ‰ç•Œé—­é›†
2. **è¿é€šæ€§**ï¼š$\mathcal{S}^{n-1}$ æ˜¯è¿é€šçš„ï¼ˆ$n \geq 2$æ—¶ä¸ºé“è·¯è¿é€šï¼‰
3. **å…‰æ»‘æ€§**ï¼š$\mathcal{S}^{n-1}$ æ˜¯ $C^{\infty}$ å…‰æ»‘æµå½¢
4. **ç»´åº¦**ï¼š$\dim(\mathcal{S}^{n-1}) = n - 1$

</div>

<div class="theorem-box">

#### å…¬ç†2ï¼šé»æ›¼åº¦é‡çš„ç»§æ‰¿

è¶…çƒé¢ç»§æ‰¿æ¬§æ°ç©ºé—´ $\mathbb{R}^n$ çš„å†…ç§¯ä½œä¸ºé»æ›¼åº¦é‡ï¼š
$$
g_{\boldsymbol{w}}(\boldsymbol{\xi}, \boldsymbol{\eta}) = \langle\boldsymbol{\xi}, \boldsymbol{\eta}\rangle_{\mathbb{R}^n}, \quad \forall \boldsymbol{\xi}, \boldsymbol{\eta} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}
$$

**å«ä¹‰**ï¼šè¶…çƒé¢ä¸Šçš„"è§’åº¦"å’Œ"é•¿åº¦"ç”±åµŒå…¥ç©ºé—´çš„æ¬§æ°å‡ ä½•è¯±å¯¼ã€‚

**æ¨è®º**ï¼š
- ä¸¤ç‚¹é—´çš„æµ‹åœ°çº¿è·ç¦»ï¼š$d(\boldsymbol{w}_1, \boldsymbol{w}_2) = \arccos(\langle\boldsymbol{w}_1, \boldsymbol{w}_2\rangle)$
- æˆªé¢æ›²ç‡æ’ä¸º $K = 1$ï¼ˆæ­£æ›²ç‡ï¼‰

</div>

<div class="theorem-box">

#### å…¬ç†3ï¼šåˆ‡ç©ºé—´çš„æ­£äº¤æ€§

åœ¨ç‚¹ $\boldsymbol{w} \in \mathcal{S}^{n-1}$ å¤„çš„åˆ‡ç©ºé—´å®šä¹‰ä¸ºï¼š
$$
T_{\boldsymbol{w}}\mathcal{S}^{n-1} = \{\boldsymbol{v} \in \mathbb{R}^n : \langle\boldsymbol{v}, \boldsymbol{w}\rangle = 0\}
$$

**å‡ ä½•æ„ä¹‰**ï¼šåˆ‡ç©ºé—´æ˜¯ä¸çƒé¢åœ¨ $\boldsymbol{w}$ ç‚¹ç›¸åˆ‡çš„è¶…å¹³é¢ã€‚

**æ­£äº¤åˆ†è§£å®šç†**ï¼š
$$
\mathbb{R}^n = T_{\boldsymbol{w}}\mathcal{S}^{n-1} \oplus N_{\boldsymbol{w}}\mathcal{S}^{n-1}
$$
å…¶ä¸­æ³•ç©ºé—´ $N_{\boldsymbol{w}}\mathcal{S}^{n-1} = \text{span}\{\boldsymbol{w}\}$ã€‚

</div>

<div class="theorem-box">

#### å…¬ç†4ï¼šé»æ›¼æ¢¯åº¦çš„å­˜åœ¨æ€§ä¸å”¯ä¸€æ€§

å¯¹äºå…‰æ»‘å‡½æ•° $f: \mathcal{S}^{n-1} \to \mathbb{R}$ï¼Œåœ¨æ¯ç‚¹ $\boldsymbol{w}$ å­˜åœ¨å”¯ä¸€çš„é»æ›¼æ¢¯åº¦ $\text{grad} f(\boldsymbol{w}) \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}$ æ»¡è¶³ï¼š
$$
\langle\text{grad} f(\boldsymbol{w}), \boldsymbol{\xi}\rangle = Df(\boldsymbol{w})[\boldsymbol{\xi}], \quad \forall \boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}
$$

**æ˜¾å¼å…¬å¼**ï¼ˆæŠ•å½±å…¬å¼ï¼‰ï¼š
$$
\text{grad} f(\boldsymbol{w}) = \nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}
$$

</div>

<h3 id="14">1.4 è®¾è®¡å“²å­¦ï¼šä»æ¬§æ°åˆ°é»æ›¼çš„èŒƒå¼è½¬æ¢</h3>
<p><strong>æ ¸å¿ƒå“²å­¦ï¼šçº¦æŸå³å‡ ä½•</strong></p>
<p>ä¼ ç»Ÿè§‚ç‚¹å°†çº¦æŸè§†ä¸ºä¼˜åŒ–çš„"éšœç¢"ï¼Œéœ€è¦é€šè¿‡æŠ•å½±ã€ç½šå‡½æ•°ç­‰æ‰‹æ®µ"ç»•è¿‡"ã€‚æµå½¢ä¼˜åŒ–åˆ™è®¤ä¸ºï¼š</p>
<blockquote>
<p><strong>çº¦æŸä¸æ˜¯éšœç¢ï¼Œè€Œæ˜¯å‡ ä½•çš„æœ¬è´¨ã€‚</strong></p>
</blockquote>
<p>åœ¨è¶…çƒé¢ä¼˜åŒ–ä¸­ï¼Œè¿™ä¸€å“²å­¦ä½“ç°ä¸ºï¼š</p>
<p><strong>1. å‚æ•°ç©ºé—´çš„é‡æ–°è®¤çŸ¥</strong></p>
<table>
<thead>
<tr>
<th>ä¼ ç»Ÿè§†è§’ï¼ˆæ¬§æ°ï¼‰</th>
<th>æµå½¢è§†è§’ï¼ˆé»æ›¼ï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\boldsymbol{w} \in \mathbb{R}^n$ å—çº¦æŸ $|\boldsymbol{w}|_2 = 1$</td>
<td>$\boldsymbol{w}$ æœ¬è´¨ä¸Šå±äº $(n-1)$ ç»´æµå½¢ $\mathcal{S}^{n-1}$</td>
</tr>
<tr>
<td>çº¦æŸæ˜¯å¤–åŠ çš„é™åˆ¶</td>
<td>çº¦æŸæ˜¯å†…åœ¨çš„å‡ ä½•</td>
</tr>
<tr>
<td>ä¼˜åŒ–åœ¨ $\mathbb{R}^n$ ä¸­è¿›è¡Œï¼Œéœ€ä¸æ–­æŠ•å½±</td>
<td>ä¼˜åŒ–åœ¨ $\mathcal{S}^{n-1}$ ä¸­è¿›è¡Œï¼Œè‡ªç„¶ä¿æŒçº¦æŸ</td>
</tr>
</tbody>
</table>
<p><strong>2. æ¢¯åº¦çš„é‡æ–°å®šä¹‰</strong></p>
<ul>
<li><strong>æ¬§æ°æ¢¯åº¦</strong> $\nabla f(\boldsymbol{w})$ï¼šåœ¨åµŒå…¥ç©ºé—´ $\mathbb{R}^n$ ä¸­çš„ä¸‹é™æ–¹å‘</li>
<li>
<p>é—®é¢˜ï¼šå¯èƒ½æŒ‡å‘çƒå¤–ï¼Œè¿åçº¦æŸ</p>
</li>
<li>
<p><strong>é»æ›¼æ¢¯åº¦</strong> $\text{grad} f(\boldsymbol{w})$ï¼šåœ¨æµå½¢åˆ‡ç©ºé—´ä¸­çš„ä¸‹é™æ–¹å‘</p>
</li>
<li>ä¼˜åŠ¿ï¼šè‡ªåŠ¨ä¸çº¦æŸå…¼å®¹ï¼Œæ²¿çƒé¢ç§»åŠ¨</li>
</ul>
<p><strong>3. æ›´æ–°è§„åˆ™çš„æœ¬è´¨åŒºåˆ«</strong></p>
<ul>
<li><strong>æŠ•å½±æ–¹æ³•</strong>ï¼ˆProjected Gradientï¼‰ï¼š
  $$
  \boldsymbol{w}_{t+1} = \underbrace{\text{Proj}_{\mathcal{S}^{n-1}}}_{\text{æŠ•å½±å›çƒé¢}}\left(\boldsymbol{w}_t - \eta \nabla f(\boldsymbol{w}_t)\right)
  $$</li>
<li>é€»è¾‘ï¼šå…ˆåœ¨æ¬§æ°ç©ºé—´ç§»åŠ¨ï¼Œå†"ä¿®æ­£"å›çº¦æŸé›†</li>
<li>
<p>ç¼ºé™·ï¼šä¸¤æ­¥æ“ä½œï¼Œå¿½ç•¥æµå½¢å‡ ä½•</p>
</li>
<li>
<p><strong>æµå½¢æ–¹æ³•</strong>ï¼ˆRiemannian Gradientï¼‰ï¼š
  $$
  \boldsymbol{w}_{t+1} = \underbrace{\text{Retr}_{\boldsymbol{w}_t}}_{\text{æ²¿æµ‹åœ°çº¿ç§»åŠ¨}}\left(-\eta \cdot \text{grad} f(\boldsymbol{w}_t)\right)
  $$</p>
</li>
<li>é€»è¾‘ï¼šç›´æ¥åœ¨æµå½¢ä¸Šæ²¿æµ‹åœ°çº¿ç§»åŠ¨</li>
<li>ä¼˜åŠ¿ï¼šä¸€æ­¥åˆ°ä½ï¼Œä¿æŒå‡ ä½•ç»“æ„</li>
</ul>
<p><strong>4. æœ€é€Ÿä¸‹é™çš„å†…åœ¨æ€§</strong></p>
<div class="intuition-box">

### å“²å­¦æ€è€ƒï¼šä»€ä¹ˆæ˜¯"æœ€å¿«"ï¼Ÿ

"æœ€é€Ÿä¸‹é™"çš„å«ä¹‰å–å†³äºå¦‚ä½•åº¦é‡"é€Ÿåº¦"ï¼š

- **æ¬§æ°ç©ºé—´**ï¼šç”¨æ¬§æ°è·ç¦» $\|\Delta\boldsymbol{w}\|_2$ åº¦é‡æ­¥é•¿
  - æœ€é€Ÿæ–¹å‘ï¼šè´Ÿæ¢¯åº¦ $-\nabla f(\boldsymbol{w})$

- **è¶…çƒé¢**ï¼šç”¨æµ‹åœ°çº¿è·ç¦» $d_{\mathcal{S}}(\boldsymbol{w}, \boldsymbol{w}')$ åº¦é‡æ­¥é•¿
  - æœ€é€Ÿæ–¹å‘ï¼šè´Ÿé»æ›¼æ¢¯åº¦ $-\text{grad} f(\boldsymbol{w})$

**ç±»æ¯”**ï¼šåœ¨åœ°çƒè¡¨é¢ä»åŒ—äº¬é£å¾€çº½çº¦ï¼Œæœ€çŸ­è·¯å¾„ä¸æ˜¯æ¬§æ°ç©ºé—´çš„ç›´çº¿ï¼ˆéœ€ç©¿è¿‡åœ°å¿ƒï¼‰ï¼Œè€Œæ˜¯å¤§åœ†å¼§ï¼ˆæµ‹åœ°çº¿ï¼‰ã€‚

</div>

<p><strong>5. æ•°å­¦ä¼˜é›…æ€§</strong></p>
<p>æµå½¢ä¼˜åŒ–çš„ä¼˜é›…ä¹‹å¤„åœ¨äºï¼š<strong>å°†çº¦æŸå†…åŒ–ä¸ºå‡ ä½•ï¼Œç»Ÿä¸€å¤„ç†</strong>ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå„ç§çŸ©é˜µçº¦æŸå¯ç»Ÿä¸€ä¸ºæµå½¢ï¼š
- æ­£äº¤çŸ©é˜µï¼šStiefelæµå½¢ $\text{St}(n, p) = {\boldsymbol{X} \in \mathbb{R}^{n \times p} : \boldsymbol{X}^{\top}\boldsymbol{X} = \boldsymbol{I}_p}$
- æ­£å®šçŸ©é˜µï¼šSPDæµå½¢ $\mathcal{P}_n = {\boldsymbol{X} \in \mathbb{R}^{n \times n} : \boldsymbol{X} \succ 0}$
- ä½ç§©çŸ©é˜µï¼šGrassmannæµå½¢</p>
<p>æ¯ä¸ªæµå½¢æœ‰å…¶ç‹¬ç‰¹çš„å‡ ä½•ç»“æ„ï¼Œä½†ä¼˜åŒ–æ¡†æ¶ç»Ÿä¸€ï¼š
1. è®¡ç®—é»æ›¼æ¢¯åº¦
2. åœ¨åˆ‡ç©ºé—´æ›´æ–°
3. é€šè¿‡retractionå›åˆ°æµå½¢</p>
<hr />
<h2 id="_1">ä¼˜åŒ–åŸç†</h2>
<p>ä½œä¸ºç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬å…ˆä»SGDå‡ºå‘ï¼Œç†è§£â€œæ¢¯åº¦çš„åæ–¹å‘æ˜¯ä¸‹é™æœ€å¿«çš„æ–¹å‘â€è¿™å¥è¯èƒŒåçš„æ•°å­¦æ„ä¹‰ï¼Œç„¶ååº”ç”¨äºè¶…çƒé¢ä¸Šçš„ä¼˜åŒ–ã€‚ä¸è¿‡åœ¨æ­¤ä¹‹å‰ï¼Œç¬”è€…è¿˜æƒ³å¸¦å¤§å®¶é‡æ¸©ä¸€ä¸‹<a href="/archives/10739">ã€ŠMuonç»­é›†ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬é€‰æ‹©å°è¯•Muonï¼Ÿã€‹</a>æ‰€æçš„å…³äºä¼˜åŒ–å™¨çš„â€œ<strong>æœ€å°ä½œç”¨é‡åŸç†ï¼ˆLeast Action Principleï¼‰</strong> â€ã€‚</p>
<p>è¿™ä¸ªåŸç†å°è¯•å›ç­”â€œä»€ä¹ˆæ‰æ˜¯å¥½çš„ä¼˜åŒ–å™¨â€ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è‚¯å®šæ˜¯å¸Œæœ›æ¨¡å‹æ”¶æ•›é€Ÿåº¦è¶Šå¿«è¶Šå¥½ï¼Œä½†ç”±äºç¥ç»ç½‘ç»œæœ¬èº«çš„å¤æ‚æ€§ï¼Œå¦‚æœæ­¥å­è¿ˆå¾—å¤ªå¤§ï¼Œé‚£ä¹ˆåè€Œå®¹æ˜“è®­å´©ã€‚æ‰€ä»¥ï¼Œä¸€ä¸ªå¥½çš„ä¼˜åŒ–å™¨åº”è¯¥æ˜¯åˆ<strong>ç¨³</strong> åˆ<strong>å¿«</strong> ï¼Œæœ€å¥½æ˜¯ä¸ç”¨å¤§æ”¹æ¨¡å‹ï¼Œä½†å´å¯ä»¥æ˜æ˜¾é™ä½æŸå¤±ï¼Œå†™æˆæ•°å­¦å½¢å¼æ˜¯<br />
\begin{equation}\min_{\Delta \boldsymbol{w}} \mathcal{L}(\boldsymbol{w} +\Delta\boldsymbol{w}) \qquad \text{s.t.}\qquad \rho(\Delta\boldsymbol{w})\leq \eta\end{equation}<br />
å…¶å®$\mathcal{L}$æ˜¯æŸå¤±å‡½æ•°ï¼Œ$\boldsymbol{w}\in\mathbb{R}^n$æ˜¯å‚æ•°å‘é‡ï¼Œ$\Delta \boldsymbol{w}$æ˜¯æ›´æ–°é‡ï¼Œ$\rho(\Delta\boldsymbol{w})$æ˜¯æ›´æ–°é‡$\Delta\boldsymbol{w}$å¤§å°çš„æŸç§åº¦é‡ã€‚ä¸Šè¿°ç›®æ ‡å¾ˆç›´è§‚ï¼Œå°±æ˜¯åœ¨â€œæ­¥å­â€ä¸è¶…è¿‡$\eta$ï¼ˆ<strong>ç¨³</strong> ï¼‰çš„å‰æä¸‹ï¼Œå¯»æ‰¾è®©æŸå¤±å‡½æ•°ä¸‹é™æœ€å¤šï¼ˆ<strong>å¿«</strong> ï¼‰çš„æ›´æ–°é‡ï¼Œè¿™ä¾¿æ˜¯â€œæœ€å°ä½œç”¨é‡åŸç†â€çš„æ•°å­¦å«ä¹‰ï¼Œä¹Ÿæ˜¯â€œæœ€é€Ÿä¸‹é™â€çš„æ•°å­¦å«ä¹‰ã€‚</p>
<h2 id="_2">ç›®æ ‡è½¬åŒ–</h2>
<p>å‡è®¾$\eta$è¶³å¤Ÿå°ï¼Œé‚£ä¹ˆ$\Delta\boldsymbol{w}$ä¹Ÿè¶³å¤Ÿå°ï¼Œä»¥è‡³äºä¸€é˜¶è¿‘ä¼¼è¶³å¤Ÿå‡†ç¡®ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å°†$\mathcal{L}(\boldsymbol{w} +\Delta\boldsymbol{w})$æ›¿æ¢ä¸º$\mathcal{L}(\boldsymbol{w}) + \langle\boldsymbol{g},\Delta\boldsymbol{w}\rangle$ï¼Œå…¶ä¸­$\boldsymbol{g} = \nabla_{\boldsymbol{w}}\mathcal{L}(\boldsymbol{w})$ï¼Œå¾—åˆ°ç­‰æ•ˆç›®æ ‡<br />
\begin{equation}\min_{\Delta \boldsymbol{w}} \langle\boldsymbol{g},\Delta\boldsymbol{w}\rangle \qquad \text{s.t.}\qquad \rho(\Delta\boldsymbol{w})\leq \eta\end{equation}<br />
è¿™å°±å°†ä¼˜åŒ–ç›®æ ‡ç®€åŒ–æˆ$\Delta \boldsymbol{w}$çš„çº¿æ€§å‡½æ•°ï¼Œé™ä½äº†æ±‚è§£éš¾åº¦ã€‚è¿›ä¸€æ­¥åœ°ï¼Œæˆ‘ä»¬è®¾$\Delta \boldsymbol{w} = -\kappa \boldsymbol{\varphi}$ï¼Œå…¶ä¸­$\rho(\boldsymbol{\varphi})=1$ï¼Œé‚£ä¹ˆä¸Šè¿°ç›®æ ‡ç­‰ä»·äº<br />
\begin{equation}\max_{\kappa,\boldsymbol{\varphi}} \kappa\langle\boldsymbol{g},\boldsymbol{\varphi}\rangle \qquad \text{s.t.}\qquad \rho(\boldsymbol{\varphi}) = 1, \,\,\kappa\in[0, \eta]\end{equation}<br />
å‡è®¾æˆ‘ä»¬è‡³å°‘èƒ½æ‰¾åˆ°ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„$\boldsymbol{\varphi}$ä½¿å¾—$\langle\boldsymbol{g},\boldsymbol{\varphi}\rangle\geq 0$ï¼Œé‚£ä¹ˆæœ‰$\max\limits_{\kappa\in[0,\eta]} \kappa\langle\boldsymbol{g},\boldsymbol{\varphi}\rangle = \eta\langle\boldsymbol{g},\boldsymbol{\varphi}\rangle$ï¼Œä¹Ÿå°±æ˜¯$\kappa$çš„ä¼˜åŒ–å¯ä»¥äº‹å…ˆæ±‚å‡ºæ¥ï¼Œç»“æœæ˜¯$\kappa=\eta$ï¼Œæœ€ç»ˆç­‰æ•ˆäºåªå‰©ä¸‹$\boldsymbol{\varphi}$çš„ä¼˜åŒ–<br />
\begin{equation}\max_{\boldsymbol{\varphi}} \langle\boldsymbol{g},\boldsymbol{\varphi}\rangle \qquad \text{s.t.}\qquad \rho(\boldsymbol{\varphi}) = 1\label{eq:core}\end{equation}<br />
è¿™é‡Œçš„$\boldsymbol{\varphi}$æ»¡è¶³æŸç§â€œæ¨¡é•¿â€$\rho(\boldsymbol{\varphi})$ç­‰äº1çš„æ¡ä»¶ï¼Œæ‰€ä»¥å®ƒä»£è¡¨äº†æŸç§â€œæ–¹å‘å‘é‡â€çš„å®šä¹‰ï¼Œæœ€å¤§åŒ–å®ƒä¸æ¢¯åº¦$\boldsymbol{g}$çš„å†…ç§¯ï¼Œå°±æ„å‘³ç€å¯»æ‰¾è®©æŸå¤±ä¸‹é™æœ€å¿«çš„æ–¹å‘ï¼ˆå³$\boldsymbol{\varphi}$çš„åæ–¹å‘ï¼‰ã€‚</p>
<h2 id="_3">æ¢¯åº¦ä¸‹é™</h2>
<p>ä»å¼$\eqref{eq:core}$å¯ä»¥çœ‹å‡ºï¼Œå¯¹äºâ€œä¸‹é™æœ€å¿«çš„æ–¹å‘â€ï¼Œå”¯ä¸€ä¸ç¡®å®šçš„æ˜¯åº¦é‡$\rho$ï¼Œè¿™æ˜¯ä¼˜åŒ–å™¨é‡Œè¾¹å¾ˆæœ¬è´¨çš„ä¸€ä¸ªå…ˆéªŒï¼ˆInductive Biasï¼‰ï¼Œä¸åŒçš„åº¦é‡å°†ä¼šå¾—åˆ°ä¸åŒçš„æœ€é€Ÿä¸‹é™æ–¹å‘ã€‚æ¯”è¾ƒç®€å•çš„å°±æ˜¯L2èŒƒæ•°æˆ–è€…è¯´æ¬§å‡ é‡Œå¾—èŒƒæ•°$\rho(\boldsymbol{\varphi})=\Vert \boldsymbol{\varphi} \Vert_2$ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸æ„ä¹‰ä¸‹çš„æ¨¡é•¿ï¼Œè¿™æ—¶å€™æˆ‘ä»¬æœ‰æŸ¯è¥¿ä¸ç­‰å¼ï¼š<br />
\begin{equation}\langle\boldsymbol{g},\boldsymbol{\varphi}\rangle \leq \Vert\boldsymbol{g}\Vert_2 \Vert\boldsymbol{\varphi}\Vert_2 = \Vert\boldsymbol{g}\Vert_2\end{equation}<br />
ç­‰å·æˆç«‹çš„æ¡ä»¶æ˜¯$\boldsymbol{\varphi} \propto\boldsymbol{g}$ï¼ŒåŠ ä¸Šæ¨¡é•¿ä¸º1çš„æ¡ä»¶ï¼Œæˆ‘ä»¬å¾—åˆ°$\boldsymbol{\varphi}=\boldsymbol{g}/\Vert\boldsymbol{g}\Vert_2$ï¼Œè¿™æ­£æ˜¯æ¢¯åº¦çš„æ–¹å‘ã€‚æ‰€ä»¥è¯´ï¼Œâ€œæ¢¯åº¦çš„åæ–¹å‘æ˜¯ä¸‹é™æœ€å¿«çš„æ–¹å‘â€å‰ææ˜¯æ‰€é€‰å–çš„åº¦é‡æ˜¯æ¬§å‡ é‡Œå¾—èŒƒæ•°ã€‚æ›´ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬è€ƒè™‘$p$èŒƒæ•°<br />
\begin{equation}\rho(\boldsymbol{\varphi}) = \Vert\boldsymbol{\varphi}\Vert_p = \sqrt[\uproot{10}p]{\sum_{i=1}^n |\varphi_i|^p}\end{equation}<br />
æŸ¯è¥¿ä¸ç­‰å¼å¯ä»¥æ¨å¹¿æˆ<a href="https://en.wikipedia.org/wiki/H%C3%B6lder%27s_inequality">HÃ¶lderä¸ç­‰å¼</a>ï¼š<br />
\begin{equation}\langle\boldsymbol{g},\boldsymbol{\varphi}\rangle \leq \Vert\boldsymbol{g}\Vert_q \Vert\boldsymbol{\varphi}\Vert_p = \Vert\boldsymbol{g}\Vert_q,\qquad 1/p + 1/q=1\end{equation}<br />
ç­‰å·æˆç«‹çš„æ¡ä»¶$\boldsymbol{\varphi}^{[p]} \propto\boldsymbol{g}^{[q]}$ï¼Œæ‰€ä»¥è§£å¾—<br />
\begin{equation}\newcommand{sign}{\mathop{\text{sign}}}\boldsymbol{\varphi} = \frac{\boldsymbol{g}^{[q/p]}}{\Vert\boldsymbol{g}^{[q/p]}\Vert_p},\qquad \boldsymbol{g}^{[\alpha]} \triangleq \big[\sign(g_1) |g_1|^{\alpha},\sign(g_2) |g_2|^{\alpha},\cdots,\sign(g_n) |g_n|^{\alpha}\big]\end{equation}<br />
ä»¥å®ƒä¸ºæ–¹å‘å‘é‡çš„ä¼˜åŒ–å™¨å«åšpbSGDï¼Œå‡ºè‡ª<a href="https://www.ijcai.org/proceedings/2020/451">ã€ŠpbSGD: Powered Stochastic Gradient Descent Methods for Accelerated Non-Convex Optimizationã€‹</a>ã€‚å®ƒæœ‰ä¸¤ä¸ªç‰¹ä¾‹ï¼Œä¸€æ˜¯$p=q=2$æ˜¯é€€åŒ–ä¸ºSGDï¼ŒäºŒæ˜¯$p\to\infty$æ—¶$q\to 1$ï¼Œæ­¤æ—¶$|g_i|^{q/p}\to 1$ï¼Œæ›´æ–°æ–¹å‘ä¸ºæ¢¯åº¦çš„ç¬¦å·å‡½æ•°ï¼Œå³SignSGDã€‚</p>
<h2 id="_4">è¶…çƒé¢ä¸Š</h2>
<p>å‰é¢çš„è®¨è®ºä¸­ï¼Œæˆ‘ä»¬åªæ˜¯å¯¹å‚æ•°çš„å¢é‡$\Delta\boldsymbol{w}$æ–½åŠ äº†çº¦æŸï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å¸Œæœ›çš„æ˜¯ç»™å‚æ•°$\boldsymbol{w}$ä¹Ÿæ·»åŠ çº¦æŸã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å‡è®¾å‚æ•°$\boldsymbol{w}$ä½äºå•ä½çƒé¢ä¸Šï¼Œæˆ‘ä»¬å¸Œæœ›æ›´æ–°åçš„å‚æ•°$\boldsymbol{w}+\Delta\boldsymbol{w}$ä¾ç„¶ä½äºå•ä½çƒé¢ä¸Šï¼ˆå‚è€ƒ<a href="https://docs.modula.systems/algorithms/manifold/hypersphere/">ã€ŠHypersphereã€‹</a>ï¼‰ã€‚ä»ç›®æ ‡$\eqref{eq:core}$å‡ºå‘ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ–°ç›®æ ‡å†™æˆ<br />
\begin{equation}\max_{\boldsymbol{\varphi}} \langle\boldsymbol{g},\boldsymbol{\varphi}\rangle \qquad \text{s.t.}\qquad \Vert\boldsymbol{\varphi}\Vert_2 = 1,\,\,\Vert\boldsymbol{w}-\eta\boldsymbol{\varphi}\Vert_2 = 1,\,\,\Vert\boldsymbol{w}\Vert_2=1\end{equation}<br />
æˆ‘ä»¬ä¾ç„¶è´¯å½»â€œ$\eta$è¶³å¤Ÿå°ï¼Œä¸€é˜¶è¿‘ä¼¼å¤Ÿç”¨â€çš„åŸåˆ™ï¼Œå¾—åˆ°<br />
\begin{equation}1 = \Vert\boldsymbol{w}-\eta\boldsymbol{\varphi}\Vert_2^2 = \Vert\boldsymbol{w}\Vert_2^2 - 2\eta\langle \boldsymbol{w}, \boldsymbol{\varphi}\rangle + \eta^2 \Vert\boldsymbol{\varphi}\Vert_2^2\approx 1 - 2\eta\langle \boldsymbol{w}, \boldsymbol{\varphi}\rangle\end{equation}<br />
æ‰€ä»¥è¿™ç›¸å½“äºå°†çº¦æŸè½¬åŒ–ä¸ºçº¿æ€§å½¢å¼$\langle \boldsymbol{w}, \boldsymbol{\varphi}\rangle=0$ã€‚ä¸ºäº†æ±‚è§£æ–°çš„ç›®æ ‡ï¼Œæˆ‘ä»¬å¼•å…¥å¾…å®šç³»æ•°$\lambda$ï¼Œå†™å‡º<br />
\begin{equation}\langle\boldsymbol{g},\boldsymbol{\varphi}\rangle = \langle\boldsymbol{g},\boldsymbol{\varphi}\rangle + \lambda\langle\boldsymbol{w},\boldsymbol{\varphi}\rangle =\langle \boldsymbol{g} + \lambda\boldsymbol{w},\boldsymbol{\varphi}\rangle\leq \Vert\boldsymbol{g} + \lambda\boldsymbol{w}\Vert_2 \Vert\boldsymbol{\varphi}\Vert_2 = \Vert\boldsymbol{g} + \lambda\boldsymbol{w}\Vert_2\end{equation}<br />
ç­‰å·æˆç«‹çš„æ¡ä»¶æ˜¯$\boldsymbol{\varphi}\propto \boldsymbol{g} + \lambda\boldsymbol{w}$ï¼Œå†åŠ ä¸Š$\Vert\boldsymbol{\varphi}\Vert_2=1,\langle \boldsymbol{w}, \boldsymbol{\varphi}\rangle=0,\Vert\boldsymbol{w}\Vert_2=1$çš„æ¡ä»¶ï¼Œå¯ä»¥è§£å¾—<br />
\begin{equation}\boldsymbol{\varphi} = \frac{\boldsymbol{g} - \langle \boldsymbol{g}, \boldsymbol{w}\rangle\boldsymbol{w}}{\Vert\boldsymbol{g} - \langle \boldsymbol{g}, \boldsymbol{w}\rangle\boldsymbol{w}\Vert_2}\end{equation}<br />
æ³¨æ„ç°åœ¨æœ‰$\Vert\boldsymbol{w}\Vert_2=1,\Vert\boldsymbol{\varphi}\Vert_2=1$ï¼Œå¹¶ä¸”$\boldsymbol{w}$å’Œ$\boldsymbol{\varphi}$æ˜¯æ­£äº¤çš„ï¼Œé‚£ä¹ˆ$\boldsymbol{w} - \eta\boldsymbol{\varphi}$çš„æ¨¡é•¿æ˜¯å¹¶ä¸æ˜¯ç²¾ç¡®åœ°ç­‰äº1ï¼Œè€Œæ˜¯$\sqrt{1 + \eta^2}=1 + \eta^2/2 + \cdots$ï¼Œç²¾ç¡®åˆ°$\mathcal{O}(\eta^2)$ï¼Œè¿™è·Ÿæˆ‘ä»¬å‰é¢çš„å‡è®¾â€œ$\eta$çš„ä¸€é˜¶é¡¹å¤Ÿç”¨â€å»åˆã€‚å¦‚æœæƒ³æ›´æ–°åçš„å‚æ•°æ¨¡é•¿ä¸¥æ ¼ç­‰äº1ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨æ›´æ–°è§„åˆ™ä¸Šå¤šåŠ ä¸€æ­¥ç¼©å›æ“ä½œï¼š<br />
\begin{equation}\boldsymbol{w}\quad\leftarrow\quad \frac{\boldsymbol{w} - \eta\boldsymbol{\varphi}}{\sqrt{1 + \eta^2}}\end{equation}</p>
<h2 id="_5">å‡ ä½•æ„ä¹‰</h2>
<p>åˆšæ‰æˆ‘ä»¬é€šè¿‡â€œä¸€é˜¶è¿‘ä¼¼å¤Ÿç”¨â€åŸåˆ™ï¼Œå°†éçº¿æ€§çº¦æŸ$\Vert\boldsymbol{w}-\eta\boldsymbol{\varphi}\Vert_2 = 1$ç®€åŒ–ä¸ºçº¿æ€§çº¦æŸ$\langle \boldsymbol{w}, \boldsymbol{\varphi}\rangle=0$ï¼Œåè€…çš„å‡ ä½•æ„ä¹‰æ˜¯â€œä¸$\boldsymbol{w}$å‚ç›´â€ï¼Œè¿™è¿˜æœ‰ä¸ªæ›´ä¸“ä¸šçš„è¯´æ³•ï¼Œå«åš$\Vert\boldsymbol{w}\Vert_2=1$çš„â€œåˆ‡ç©ºé—´â€ï¼Œè€Œ$\boldsymbol{g} - \langle \boldsymbol{g}, \boldsymbol{w}\rangle\boldsymbol{w}$è¿™ä¸€è¿ç®—ï¼Œæ­£å¯¹åº”äºæŠŠæ¢¯åº¦$\boldsymbol{g}$æŠ•å½±åˆ°åˆ‡ç©ºé—´çš„æŠ•å½±è¿ç®—ã€‚</p>
<p>æ‰€ä»¥å¾ˆå¹¸è¿ï¼Œçƒé¢ä¸Šçš„SGDæœ‰éå¸¸æ¸…æ™°çš„å‡ ä½•æ„ä¹‰ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  </p>
<p><a href="/usr/uploads/2025/07/1221229703.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="çƒé¢ä¸Šçš„æœ€é€Ÿä¸‹é™-å‡ ä½•æ„ä¹‰" src="/usr/uploads/2025/07/1221229703.png" /></a></p>
<p>çƒé¢ä¸Šçš„æœ€é€Ÿä¸‹é™-å‡ ä½•æ„ä¹‰</p>
<p>ç›¸ä¿¡å¾ˆå¤šè¯»è€…éƒ½å–œæ¬¢è¿™ç§å‡ ä½•è§†è§’ï¼Œå®ƒç¡®å®è®©äººèµå¿ƒæ‚¦ç›®ã€‚ä½†è¿™æ˜¯è¿˜æ˜¯è¦æé†’å¤§å®¶ä¸€ä¸‹ï¼Œåº”å½“ä¼˜å…ˆè®¤çœŸç†è§£ä»£æ•°æ±‚è§£è¿‡ç¨‹ï¼Œå› ä¸ºæ¸…æ™°çš„å‡ ä½•æ„ä¹‰å¾ˆå¤šæ—¶å€™éƒ½åªæ˜¯ä¸€ç§å¥¢æœ›ï¼Œå±äºå¯é‡è€Œä¸å¯æ±‚çš„ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å¤æ‚çš„ä»£æ•°è¿‡ç¨‹æ‰æ˜¯æœ¬è´¨ã€‚</p>
<hr />
<h2 id="3">ç¬¬3éƒ¨åˆ†ï¼šæ•°å­¦ç›´è§‰ã€å¤šè§’åº¦è§£é‡Šä¸ç±»æ¯”</h2>
<h3 id="31">3.1 ç”Ÿæ´»åŒ–ç±»æ¯”ï¼šç†è§£è¶…çƒé¢ä¼˜åŒ–</h3>
<div class="intuition-box">

#### ç±»æ¯”1ï¼šç™»å±±è€…åœ¨çƒå½¢æ˜Ÿçƒè¡¨é¢çš„æœ€é€Ÿä¸‹é™

å‡è®¾ä½ æ˜¯ä¸€åç™»å±±è€…ï¼Œç«™åœ¨ä¸€ä¸ªå°å‹çƒå½¢æ˜Ÿçƒï¼ˆå¦‚å°ç‹å­çš„æ˜Ÿçƒï¼‰çš„è¡¨é¢ã€‚ä½ æƒ³å°½å¿«ä¸‹åˆ°æœ€ä½ç‚¹ã€‚

**çº¦æŸ**ï¼šä½ å¿…é¡»ä¸€ç›´åœ¨æ˜Ÿçƒè¡¨é¢è¡Œèµ°ï¼ˆä¸èƒ½é£å¤©æˆ–é’»åœ°ï¼‰ã€‚

**é—®é¢˜**ï¼šä»å½“å‰ä½ç½®å‡ºå‘ï¼Œå“ªä¸ªæ–¹å‘ä¸‹é™æœ€å¿«ï¼Ÿ

**ç›´è§‰å›ç­”**ï¼š
- **é”™è¯¯æƒ³æ³•**ï¼šæœç€æ˜Ÿçƒä¸­å¿ƒçš„åæ–¹å‘èµ°ï¼ˆå³è¿œç¦»ä¸­å¿ƒï¼‰
  - é—®é¢˜ï¼šè¿™ä¼šè®©ä½ ç¦»å¼€æ˜Ÿçƒè¡¨é¢ï¼Œè¿åçº¦æŸ

- **æ­£ç¡®åšæ³•**ï¼šåœ¨è¡¨é¢ä¸Šé€‰æ‹©ä¸€ä¸ªåˆ‡å‘æ–¹å‘ï¼Œä½¿å¾—æ²¿è¿™ä¸ªæ–¹å‘å‰è¿›æ—¶ï¼Œé«˜åº¦ä¸‹é™æœ€å¿«
  - è¿™æ­£æ˜¯"é»æ›¼æ¢¯åº¦"çš„å‡ ä½•æ„ä¹‰

**æ•°å­¦å¯¹åº”**ï¼š
- æ˜Ÿçƒè¡¨é¢ = è¶…çƒé¢ $\mathcal{S}^{n-1}$
- é«˜åº¦å‡½æ•° = ç›®æ ‡å‡½æ•° $f(\boldsymbol{w})$
- å¼•åŠ›æ–¹å‘ = æ¬§æ°æ¢¯åº¦ $\nabla f(\boldsymbol{w})$
- è¡¨é¢æœ€é™¡æ–¹å‘ = é»æ›¼æ¢¯åº¦ $\text{grad} f(\boldsymbol{w})$

**ä¸ºä»€ä¹ˆè¦æŠ•å½±**ï¼š
å¼•åŠ›æŒ‡å‘æ˜Ÿçƒä¸­å¿ƒï¼ˆæ³•å‘ï¼‰ï¼Œä½†ä½ ä¸èƒ½ç©¿è¿‡åœ°é¢ã€‚æ‰€ä»¥ä½ å°†å¼•åŠ›åˆ†è§£ä¸ºï¼š
- **åˆ‡å‘åˆ†é‡**ï¼šæ²¿è¡¨é¢çš„åŠ›ï¼Œè¿™æ‰æ˜¯ä½ èƒ½åˆ©ç”¨çš„
- **æ³•å‘åˆ†é‡**ï¼šå‚ç›´äºè¡¨é¢çš„åŠ›ï¼Œè¢«åœ°é¢æ”¯æ’‘åŠ›æŠµæ¶ˆ

é»æ›¼æ¢¯åº¦æ­£æ˜¯æ¬§æ°æ¢¯åº¦çš„åˆ‡å‘åˆ†é‡ï¼

</div>

<div class="intuition-box">

#### ç±»æ¯”2ï¼šåœ¨æ°”çƒè¡¨é¢ç»˜ç”»çš„ç¬”å°–è½¨è¿¹

æƒ³è±¡ä½ åœ¨ä¸€ä¸ªå……æ°”çš„æ°”çƒè¡¨é¢ç”¨ç¬”ç»˜ç”»ï¼Œç¬”å°–å§‹ç»ˆä¸æ°”çƒæ¥è§¦ã€‚

**åœºæ™¯è®¾å®š**ï¼š
- æ°”çƒè¡¨é¢æœ‰"æµ·æ‹”"ä¿¡æ¯ï¼ˆå¦‚æ¸©åº¦åˆ†å¸ƒï¼‰ï¼Œé¢œè‰²æ·±æµ…ä»£è¡¨å‡½æ•°å€¼
- ä½ çš„ç¬”åœ¨æ°”çƒè¡¨é¢æ»‘åŠ¨ï¼Œç›®æ ‡æ˜¯å°½å¿«åˆ°è¾¾æœ€å†·ï¼ˆå‡½æ•°å€¼æœ€å°ï¼‰çš„ç‚¹
- ç¬”å°–ä¸èƒ½ç¦»å¼€æ°”çƒè¡¨é¢ï¼ˆçº¦æŸï¼‰

**å…³é”®è§‚å¯Ÿ**ï¼š

1. **æ¬§æ°æ¢¯åº¦**ï¼ˆ3Dç©ºé—´ä¸­çš„æœ€é™¡æ–¹å‘ï¼‰ï¼š
   - å¯èƒ½æŒ‡å‘æ°”çƒå†…éƒ¨æˆ–å¤–éƒ¨
   - ç¬”å°–æ— æ³•æ²¿æ­¤æ–¹å‘ç§»åŠ¨

2. **é»æ›¼æ¢¯åº¦**ï¼ˆçƒé¢ä¸Šçš„æœ€é™¡æ–¹å‘ï¼‰ï¼š
   - æ˜¯æ¬§æ°æ¢¯åº¦åœ¨çƒé¢ä¸Šçš„"å½±å­"ï¼ˆæŠ•å½±ï¼‰
   - ç¬”å°–å¯ä»¥å®é™…æ²¿æ­¤æ–¹å‘æ»‘åŠ¨

**æŠ•å½±å…¬å¼çš„ç›´è§‚ç†è§£**ï¼š
$$
\text{grad} f(\boldsymbol{w}) = \underbrace{\nabla f(\boldsymbol{w})}_{\text{3Dç©ºé—´æ¢¯åº¦}} - \underbrace{\langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}}_{\text{æŒ‡å‘çƒå¿ƒçš„åˆ†é‡}}
$$

- ç¬¬ä¸€é¡¹ï¼š3Dç©ºé—´ä¸­å‡½æ•°ä¸‹é™æœ€å¿«çš„æ–¹å‘
- ç¬¬äºŒé¡¹ï¼šè¿™ä¸ªæ–¹å‘ä¸­"å‚ç›´äºçƒé¢"çš„éƒ¨åˆ†ï¼ˆä¸èƒ½ç”¨ï¼‰
- ç»“æœï¼šå»æ‰ä¸èƒ½ç”¨çš„éƒ¨åˆ†ï¼Œå‰©ä¸‹çš„å°±æ˜¯çƒé¢ä¸Šæœ€é™¡çš„æ–¹å‘

</div>

<div class="intuition-box">

#### ç±»æ¯”3ï¼šè¢«çº¦æŸçš„å¼¹ç°§å°çƒç³»ç»Ÿ

è€ƒè™‘ä¸€ä¸ªç‰©ç†ç³»ç»Ÿï¼šä¸€ä¸ªå°çƒé€šè¿‡æ— æ‘©æ“¦çš„åˆšæ€§æ†è¿æ¥åˆ°åŸç‚¹ï¼Œæ†é•¿å›ºå®šä¸º1ã€‚

**åŠ›å­¦åˆ†æ**ï¼š

- **å¤–åŠ›**ï¼š$\boldsymbol{F}_{\text{external}} = -\nabla f(\boldsymbol{w})$ï¼ˆä¾‹å¦‚é‡åŠ›ã€ç”µç£åŠ›ï¼‰
- **çº¦æŸåŠ›**ï¼šæ†å¯¹å°çƒæ–½åŠ çš„å¾„å‘åŠ› $\boldsymbol{F}_{\text{constraint}}$
- **å®é™…åŠ é€Ÿåº¦**ï¼šåªæœ‰åˆ‡å‘åˆ†é‡èƒ½å¼•èµ·å°çƒæ²¿çƒé¢è¿åŠ¨

**ç‰›é¡¿ç¬¬äºŒå®šå¾‹**ï¼š
$$
m\boldsymbol{a} = \boldsymbol{F}_{\text{external}} + \boldsymbol{F}_{\text{constraint}}
$$

ç”±äºå°çƒè¢«çº¦æŸåœ¨çƒé¢ä¸Šï¼ŒåŠ é€Ÿåº¦ $\boldsymbol{a}$ å¿…é¡»åˆ‡å‘ï¼š
$$
\boldsymbol{a} \perp \boldsymbol{w} \quad \Rightarrow \quad \langle\boldsymbol{a}, \boldsymbol{w}\rangle = 0
$$

å› æ­¤ï¼Œåªæœ‰å¤–åŠ›çš„åˆ‡å‘åˆ†é‡æœ‰æ•ˆï¼š
$$
\boldsymbol{a} = \frac{1}{m}\mathcal{P}_{\boldsymbol{w}}(\boldsymbol{F}_{\text{external}}) = \frac{1}{m}(\boldsymbol{F}_{\text{external}} - \langle\boldsymbol{F}_{\text{external}}, \boldsymbol{w}\rangle\boldsymbol{w})
$$

**å¯¹åº”åˆ°ä¼˜åŒ–**ï¼š
- å¤–åŠ› $\boldsymbol{F} \leftrightarrow$ è´Ÿæ¢¯åº¦ $-\nabla f(\boldsymbol{w})$
- åˆ‡å‘åŠ é€Ÿåº¦ $\boldsymbol{a} \leftrightarrow$ é»æ›¼æ¢¯åº¦ $-\text{grad} f(\boldsymbol{w})$
- çº¦æŸåŠ› $\boldsymbol{F}_{\text{constraint}} \leftrightarrow$ æ‹‰æ ¼æœ—æ—¥ä¹˜æ•° $\lambda\boldsymbol{w}$

ç‰©ç†ç³»ç»Ÿçš„è‡ªç„¶æ¼”åŒ–æ­£æ˜¯æ²¿é»æ›¼æ¢¯åº¦çš„æœ€é€Ÿä¸‹é™ï¼

</div>

<h3 id="32">3.2 å‡ ä½•æ„ä¹‰çš„æ·±å…¥ç†è§£</h3>
<h4 id="321">3.2.1 åˆ‡ç©ºé—´ï¼šæµå½¢çš„"å±€éƒ¨å¹³å¦åŒ–"</h4>
<p>åœ¨ç‚¹ $\boldsymbol{w}$ å¤„ï¼Œè¶…çƒé¢çœ‹èµ·æ¥åƒä¸€ä¸ªå¹³é¢ï¼ˆç±»ä¼¼åœ°çƒè¡¨é¢åœ¨å°èŒƒå›´å†…è¿‘ä¼¼å¹³å¦ï¼‰ã€‚è¿™ä¸ªå¹³é¢å°±æ˜¯åˆ‡ç©ºé—´ã€‚</p>
<p><strong>æ•°å­¦å®šä¹‰</strong>ï¼š
$$
T_{\boldsymbol{w}}\mathcal{S}^{n-1} = \{\boldsymbol{v} : \langle\boldsymbol{v}, \boldsymbol{w}\rangle = 0\}
$$</p>
<p><strong>å‡ ä½•ç›´è§‰</strong>ï¼š
- åˆ‡ç©ºé—´æ˜¯ä¸çƒé¢åœ¨ $\boldsymbol{w}$ å¤„"åˆšå¥½è´´åˆ"çš„è¶…å¹³é¢
- æ‰€æœ‰å¯è¡Œçš„ç§»åŠ¨æ–¹å‘éƒ½åœ¨è¿™ä¸ªå¹³é¢å†…
- ç»´åº¦ï¼š$(n-1)$ ç»´ï¼ˆæ¯”ç¯å¢ƒç©ºé—´å°‘ä¸€ç»´ï¼‰</p>
<div class="example-box">

#### ä¾‹å­ï¼šä¸‰ç»´ç©ºé—´ä¸­çš„å•ä½çƒé¢ $(n=3)$

è€ƒè™‘ $\mathcal{S}^2 = \{(x, y, z) : x^2 + y^2 + z^2 = 1\}$ã€‚

**ç‚¹**ï¼š$\boldsymbol{w} = (0, 0, 1)$ï¼ˆåŒ—æç‚¹ï¼‰

**åˆ‡ç©ºé—´**ï¼š
$$
T_{\boldsymbol{w}}\mathcal{S}^2 = \{(v_x, v_y, v_z) : 0 \cdot v_x + 0 \cdot v_y + 1 \cdot v_z = 0\}
$$
$$
= \{(v_x, v_y, 0) : v_x, v_y \in \mathbb{R}\}
$$

è¿™æ˜¯ $xy$ å¹³é¢ï¼Œæ­£æ˜¯åœ°çƒåŒ—æç‚¹å¤„çš„"æ°´å¹³é¢"ã€‚

**ç‰©ç†æ„ä¹‰**ï¼šç«™åœ¨åŒ—æï¼Œä½ åªèƒ½å‘å—ï¼ˆä»»æ„æ–¹å‘ï¼‰ç§»åŠ¨ï¼Œä¸èƒ½å‘ä¸Šé£æˆ–å‘ä¸‹é’»ã€‚

</div>

<h4 id="322">3.2.2 æŠ•å½±ï¼šä»ç¯å¢ƒç©ºé—´åˆ°æµå½¢</h4>
<p>æŠ•å½±ç®—å­ $\mathcal{P}_{\boldsymbol{w}}$ å°†ä»»æ„å‘é‡"å‹å¹³"åˆ°åˆ‡ç©ºé—´ï¼š
$$
\mathcal{P}_{\boldsymbol{w}}(\boldsymbol{v}) = \boldsymbol{v} - \langle\boldsymbol{v}, \boldsymbol{w}\rangle\boldsymbol{w}
$$</p>
<p><strong>å‡ ä½•è¿‡ç¨‹</strong>ï¼š
1. è®¡ç®— $\boldsymbol{v}$ åœ¨æ³•å‘ï¼ˆå³ $\boldsymbol{w}$ æ–¹å‘ï¼‰ä¸Šçš„åˆ†é‡ï¼š$\langle\boldsymbol{v}, \boldsymbol{w}\rangle$
2. æ²¿æ³•å‘å‡å»è¿™ä¸ªåˆ†é‡ï¼š$\langle\boldsymbol{v}, \boldsymbol{w}\rangle\boldsymbol{w}$
3. å‰©ä¸‹çš„éƒ¨åˆ†å®Œå…¨åœ¨åˆ‡ç©ºé—´å†…</p>
<div class="example-box">

#### å¯è§†åŒ–ï¼šæŠ•å½±çš„å‡ ä½•å›¾æ™¯


<div class="codehilite"><pre><span></span><code>     â†‘ \boldsymbol{v} (åŸå‘é‡)
     |  /
     | / â† \langle\boldsymbol{v}, \boldsymbol{w}\rangle\boldsymbol{w} (æ³•å‘åˆ†é‡)
     |/
     â—------------â†’ \mathcal{P}_{\boldsymbol{w}}(\boldsymbol{v}) (åˆ‡å‘æŠ•å½±)
    \boldsymbol{w}
    (çƒé¢ä¸Šçš„ç‚¹)
</code></pre></div>



- å‚ç›´ç®­å¤´ï¼šæ³•å‘åˆ†é‡ï¼ˆå‚ç›´äºçƒé¢ï¼‰
- æ°´å¹³ç®­å¤´ï¼šåˆ‡å‘åˆ†é‡ï¼ˆæ²¿çƒé¢æ–¹å‘ï¼‰
- åŸå‘é‡ = æ³•å‘åˆ†é‡ + åˆ‡å‘åˆ†é‡

</div>

<h3 id="33">3.3 å¤šè§’åº¦ç†è§£è¶…çƒé¢ä¼˜åŒ–</h3>
<h4 id="1_1">è§’åº¦1ï¼šå¾®åˆ†å‡ ä½•è§†è§’</h4>
<p><strong>æ ¸å¿ƒæ¦‚å¿µ</strong>ï¼šè¶…çƒé¢æ˜¯é»æ›¼æµå½¢ï¼Œå…·æœ‰å†…åœ¨å‡ ä½•ç»“æ„ã€‚</p>
<p><strong>å…³é”®è¦ç´ </strong>ï¼š
1. <strong>åº¦é‡</strong>ï¼šå¦‚ä½•æµ‹é‡åˆ‡å‘é‡çš„é•¿åº¦å’Œè§’åº¦
   - è¶…çƒé¢ç»§æ‰¿æ¬§æ°å†…ç§¯ï¼š$g_{\boldsymbol{w}}(\boldsymbol{\xi}, \boldsymbol{\eta}) = \langle\boldsymbol{\xi}, \boldsymbol{\eta}\rangle$</p>
<ol>
<li><strong>æµ‹åœ°çº¿</strong>ï¼šæµå½¢ä¸Šçš„"æœ€çŸ­è·¯å¾„"</li>
<li>è¶…çƒé¢ä¸Šçš„æµ‹åœ°çº¿æ˜¯å¤§åœ†å¼§</li>
<li>
<p>ä» $\boldsymbol{w}$ å‡ºå‘æ²¿æ–¹å‘ $\boldsymbol{\xi}$ çš„æµ‹åœ°çº¿ï¼š
     $$
     \gamma(t) = \cos(t\|\boldsymbol{\xi}\|_2)\boldsymbol{w} + \sin(t\|\boldsymbol{\xi}\|_2)\frac{\boldsymbol{\xi}}{\|\boldsymbol{\xi}\|_2}
     $$</p>
</li>
<li>
<p><strong>æ›²ç‡</strong>ï¼šæµå½¢çš„"å¼¯æ›²ç¨‹åº¦"</p>
</li>
<li>è¶…çƒé¢çš„æˆªé¢æ›²ç‡æ’ä¸º $K = 1$ï¼ˆæ­£æ›²ç‡ï¼‰</li>
<li>å¯¹æ¯”ï¼šæ¬§æ°ç©ºé—´ $K = 0$ï¼ŒåŒæ›²ç©ºé—´ $K &lt; 0$</li>
</ol>
<p><strong>ä¼˜åŒ–è§£é‡Š</strong>ï¼š
é»æ›¼æ¢¯åº¦ä¸‹é™ = æ²¿æµ‹åœ°çº¿åœ¨å¼¯æ›²ç©ºé—´ä¸­ç§»åŠ¨ï¼Œè‡ªåŠ¨é€‚åº”æµå½¢å‡ ä½•ã€‚</p>
<h4 id="2">è§’åº¦2ï¼šçº¦æŸä¼˜åŒ–è§†è§’</h4>
<p><strong>é—®é¢˜è®¾å®š</strong>ï¼š
$$
\min_{\boldsymbol{w}} f(\boldsymbol{w}) \quad \text{s.t.} \quad \|\boldsymbol{w}\|_2 = 1
$$</p>
<p><strong>æ‹‰æ ¼æœ—æ—¥æ–¹æ³•</strong>ï¼š
$$
\mathcal{L}(\boldsymbol{w}, \lambda) = f(\boldsymbol{w}) + \lambda(\|\boldsymbol{w}\|_2^2 - 1)
$$</p>
<p><strong>KKTæ¡ä»¶</strong>ï¼š
$$
\nabla_{\boldsymbol{w}}\mathcal{L} = \nabla f(\boldsymbol{w}) + 2\lambda\boldsymbol{w} = \boldsymbol{0}
$$</p>
<p><strong>è§£é‡Š</strong>ï¼š
- æœ€ä¼˜ç‚¹å¤„ï¼Œæ¬§æ°æ¢¯åº¦ $\nabla f(\boldsymbol{w})$ ä¸ä½ç½®å‘é‡ $\boldsymbol{w}$ å¹³è¡Œï¼ˆéƒ½åœ¨æ³•ç©ºé—´ä¸­ï¼‰
- ç­‰ä»·äºï¼šé»æ›¼æ¢¯åº¦ä¸ºé›¶ $\text{grad} f(\boldsymbol{w}) = \boldsymbol{0}$</p>
<p><strong>æŠ•å½±æ¢¯åº¦çš„åˆç†æ€§</strong>ï¼š
æŠ•å½±æ¢¯åº¦æ³• $\boldsymbol{w}<em _mathcal_S="\mathcal{S">{t+1} = \text{Proj}</em>_t))$ å¯ä»¥çœ‹ä½œï¼š
1. åœ¨æ¬§æ°ç©ºé—´ä¸‹é™ä¸€æ­¥
2. æŠ•å½±å›çº¦æŸé›†}}(\boldsymbol{w}_t - \eta\nabla f(\boldsymbol{w</p>
<p>è€Œé»æ›¼æ¢¯åº¦æ³•ç›´æ¥åœ¨çº¦æŸé›†ä¸Šç§»åŠ¨ï¼Œæ›´ç¬¦åˆå‡ ä½•æœ¬è´¨ã€‚</p>
<h4 id="3_1">è§’åº¦3ï¼šä¿¡æ¯å‡ ä½•è§†è§’</h4>
<p><strong>è¶…çƒé¢ä½œä¸ºæ¦‚ç‡åˆ†å¸ƒç©ºé—´</strong>ï¼š</p>
<p>å•ä½å‘é‡ $\boldsymbol{w} \in \mathcal{S}^{n-1}$ å¯ä»¥è§£é‡Šä¸ºï¼š
- ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒçš„å‚æ•°ï¼ˆç»è¿‡é€‚å½“å½’ä¸€åŒ–ï¼‰
- æ–¹å‘ç»Ÿè®¡ä¸­çš„æ–¹å‘å‘é‡</p>
<p><strong>Fisherä¿¡æ¯åº¦é‡</strong>ï¼š
åœ¨æŸäº›å‚æ•°åŒ–ä¸‹ï¼Œè¶…çƒé¢çš„é»æ›¼åº¦é‡å¯¹åº”Fisherä¿¡æ¯çŸ©é˜µï¼Œè¿™è¿æ¥äº†å‡ ä½•ä¸ç»Ÿè®¡ã€‚</p>
<p><strong>è‡ªç„¶æ¢¯åº¦çš„è”ç³»</strong>ï¼š
é»æ›¼æ¢¯åº¦å¯ä»¥çœ‹ä½œè‡ªç„¶æ¢¯åº¦çš„ç‰¹ä¾‹ï¼Œéƒ½ä½“ç°äº†"å‚æ•°ç©ºé—´çš„å†…åœ¨å‡ ä½•"ã€‚</p>
<h4 id="4">è§’åº¦4ï¼šä¼˜åŒ–ç®—æ³•è§†è§’</h4>
<p><strong>ä¼ ç»ŸSGDçš„å±€é™</strong>ï¼š</p>
<p>å‡è®¾ç”¨æ™®é€šSGDä¼˜åŒ– $\boldsymbol{w} \in \mathbb{R}^n$ ä½†å¸Œæœ›æ»¡è¶³ $|\boldsymbol{w}|_2 = 1$ï¼š</p>
<p><strong>æ–¹æ³•1ï¼šåå¤„ç†å½’ä¸€åŒ–</strong>
$$
\boldsymbol{w}_{t+1} = \frac{\boldsymbol{w}_t - \eta\nabla f(\boldsymbol{w}_t)}{\|\boldsymbol{w}_t - \eta\nabla f(\boldsymbol{w}_t)\|_2}
$$
- é—®é¢˜ï¼šæ›´æ–°æ–¹å‘å¯èƒ½åç¦»æœ€ä¼˜</p>
<p><strong>æ–¹æ³•2ï¼šç½šå‡½æ•°æ³•</strong>
$$
\min_{\boldsymbol{w}} f(\boldsymbol{w}) + \mu(\|\boldsymbol{w}\|_2^2 - 1)^2
$$
- é—®é¢˜ï¼šå¼•å…¥é¢å¤–è¶…å‚æ•° $\mu$ï¼Œçº¦æŸå¯èƒ½ä¸ä¸¥æ ¼æ»¡è¶³</p>
<p><strong>æ–¹æ³•3ï¼šæµå½¢æ–¹æ³•</strong>ï¼ˆæœ¬æ–‡ï¼‰
$$
\boldsymbol{w}_{t+1} = \text{Retr}_{\boldsymbol{w}_t}(-\eta \cdot \text{grad} f(\boldsymbol{w}_t))
$$
- ä¼˜åŠ¿ï¼šçº¦æŸä¸¥æ ¼æ»¡è¶³ï¼Œæ›´æ–°æ–¹å‘æœ€ä¼˜</p>
<div class="intuition-box">

### ä¸ºä»€ä¹ˆæŠ•å½±æ¢¯åº¦æ˜¯"æœ€é€Ÿ"çš„ï¼Ÿ

ä»ä¸‰ä¸ªå±‚é¢ç†è§£"æœ€é€Ÿä¸‹é™"ï¼š

**å±‚é¢1ï¼šå±€éƒ¨æœ€ä¼˜æ€§**

åœ¨æ‰€æœ‰æ»¡è¶³ $\|\boldsymbol{\xi}\|_2 \leq \eta$ ä¸” $\langle\boldsymbol{\xi}, \boldsymbol{w}\rangle = 0$ çš„åˆ‡å‘é‡ä¸­ï¼Œ
$$
\boldsymbol{\xi}^* = -\eta \frac{\text{grad} f(\boldsymbol{w})}{\|\text{grad} f(\boldsymbol{w})\|_2}
$$
ä½¿å¾— $f(\boldsymbol{w} + \boldsymbol{\xi})$ ä¸‹é™æœ€å¤šï¼ˆä¸€é˜¶è¿‘ä¼¼ä¸‹ï¼‰ã€‚

**å±‚é¢2ï¼šå‡ ä½•æœ€çŸ­**

è´Ÿé»æ›¼æ¢¯åº¦æŒ‡å‘å‡½æ•°å€¼ç­‰é«˜çº¿æ³•å‘ï¼Œæ²¿æ­¤æ–¹å‘æ˜¯ç¦»å¼€å½“å‰ç­‰é«˜çº¿çš„æœ€çŸ­è·¯å¾„ã€‚

**å±‚é¢3ï¼šä¿¡æ¯å‡ ä½•æ„ä¹‰**

é»æ›¼æ¢¯åº¦è€ƒè™‘äº†å‚æ•°ç©ºé—´çš„"è·ç¦»"ï¼ˆç”±é»æ›¼åº¦é‡å®šä¹‰ï¼‰ï¼Œå› æ­¤æ˜¯ä¿¡æ¯å‡ ä½•æ„ä¹‰ä¸‹çš„æœ€é€Ÿä¸‹é™ã€‚

</div>

<hr />
<h2 id="_6">ä¸€èˆ¬ç»“æœ</h2>
<p>æ¥ä¸‹æ¥æ˜¯ä¸æ˜¯æœ‰è¯»è€…æƒ³è¦å°†å®ƒæ¨å¹¿åˆ°ä¸€èˆ¬çš„$p$èŒƒæ•°ï¼Ÿè®©æˆ‘ä»¬ä¸€èµ·æ¥å°è¯•ä¸‹ï¼Œçœ‹çœ‹ä¼šé‡åˆ°ä»€ä¹ˆå›°éš¾ã€‚è¿™æ—¶å€™é—®é¢˜æ˜¯ï¼š<br />
\begin{equation}\max_{\boldsymbol{\varphi}} \langle\boldsymbol{g},\boldsymbol{\varphi}\rangle \qquad \text{s.t.}\qquad \Vert\boldsymbol{\varphi}\Vert_p = 1,\,\,\Vert\boldsymbol{w}-\eta\boldsymbol{\varphi}\Vert_p = 1,\,\,\Vert\boldsymbol{w}\Vert_p=1\end{equation}<br />
ä¸€é˜¶è¿‘ä¼¼å°†$\Vert\boldsymbol{w}-\eta\boldsymbol{\varphi}\Vert_p = 1$è½¬æ¢æˆ$\langle\boldsymbol{w}^{[p-1]},\boldsymbol{\varphi}\rangle = 0$ï¼Œç„¶åå¼•å…¥å¾…å®šç³»æ•°$\lambda$ï¼š<br />
\begin{equation}\langle\boldsymbol{g},\boldsymbol{\varphi}\rangle = \langle\boldsymbol{g},\boldsymbol{\varphi}\rangle + \lambda\langle\boldsymbol{w}^{[p-1]},\boldsymbol{\varphi}\rangle = \langle \boldsymbol{g} + \lambda\boldsymbol{w}^{[p-1]},\boldsymbol{\varphi}\rangle \leq \Vert\boldsymbol{g} + \lambda\boldsymbol{w}^{[p-1]}\Vert_q \Vert\boldsymbol{\varphi}\Vert_p = \Vert\boldsymbol{g} + \lambda\boldsymbol{w}^{[p-1]}\Vert_q<br />
\end{equation}<br />
å–ç­‰å·çš„æ¡ä»¶æ˜¯<br />
\begin{equation}\boldsymbol{\varphi} = \frac{(\boldsymbol{g} + \lambda\boldsymbol{w}^{[p-1]})^{[q/p]}}{\Vert(\boldsymbol{g} + \lambda\boldsymbol{w}^{[p-1]})^{[q/p]}\Vert_p}\end{equation}<br />
åˆ°ç›®å‰ä¸ºæ­¢ï¼Œéƒ½æ²¡æœ‰å®è´¨å›°éš¾ã€‚ç„¶è€Œï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦å¯»æ‰¾$\lambda$ï¼Œä½¿å¾—$\langle\boldsymbol{w}^{[p-1]},\boldsymbol{\varphi}\rangle = 0$ï¼Œå½“$p \neq 2$æ—¶è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„éçº¿æ€§æ–¹ç¨‹ï¼Œå¹¶æ²¡æœ‰å¾ˆå¥½çš„æ±‚è§£åŠæ³•ï¼ˆå½“ç„¶ï¼Œä¸€æ—¦æ±‚è§£å‡ºæ¥ï¼Œæˆ‘ä»¬å°±è‚¯å®šèƒ½å¾—åˆ°æœ€ä¼˜è§£ï¼Œè¿™æ˜¯HÃ¶lderä¸ç­‰å¼ä¿è¯çš„ï¼‰ã€‚æ‰€ä»¥ï¼Œä¸€èˆ¬$p$çš„æ±‚è§£æˆ‘ä»¬åªèƒ½æ­¢æ­¥äºæ­¤ï¼Œç­‰é‡åˆ°$p\neq 2$çš„å®ä¾‹æ—¶æˆ‘ä»¬å†å…·ä½“æ¢å¯»æ•°å€¼æ±‚è§£æ–¹æ³•ã€‚</p>
<p>ä¸è¿‡é™¤äº†$p=2$ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°è¯•æ±‚è§£$p\to\infty$ï¼Œæ­¤æ—¶$\boldsymbol{\varphi}=\sign(\boldsymbol{g} + \lambda\boldsymbol{w}^{[p-1]})$ï¼Œæ¡ä»¶$\Vert\boldsymbol{w}\Vert_p=1$ç»™å‡º$|w_1|,|w_2|,\cdots,|w_n|$çš„æœ€å¤§å€¼ç­‰äº1ã€‚å¦‚æœè¿›ä¸€æ­¥å‡è®¾æœ€å¤§å€¼åªæœ‰ä¸€ä¸ªï¼Œé‚£ä¹ˆ$\boldsymbol{w}^{[p-1]}$æ˜¯ä¸€ä¸ªone hotå‘é‡ï¼Œç»å¯¹å€¼æœ€å¤§å€¼çš„ä½ç½®ä¸º$\pm 1$ï¼Œå…¶ä½™æ˜¯é›¶ï¼Œè¿™æ—¶å€™å°±å¯ä»¥è§£å‡º$\lambda$ï¼Œç»“æœæ˜¯æŠŠæœ€å¤§å€¼ä½ç½®çš„æ¢¯åº¦è£å‰ªæˆé›¶ã€‚</p>
<hr />
<h2 id="4_1">ç¬¬4éƒ¨åˆ†ï¼šæ–¹æ³•è®ºå˜ä½“ã€æ‰¹åˆ¤æ€§æ¯”è¾ƒä¸ä¼˜åŒ–</h2>
<h3 id="41">4.1 æ–¹æ³•å¯¹æ¯”è¡¨</h3>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æ ¸å¿ƒæ€æƒ³</th>
<th>ä¼˜ç‚¹</th>
<th>ç¼ºé™·</th>
<th>ä¼˜åŒ–æ–¹å‘</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æ— çº¦æŸSGD</strong></td>
<td>ç›´æ¥æ¢¯åº¦ä¸‹é™ $\boldsymbol{w}_{t+1} = \boldsymbol{w}_t - \eta\nabla f$</td>
<td>âœ… å®ç°ç®€å•<br>âœ… ç†è®ºæˆç†Ÿ<br>âœ… æ— é¢å¤–è®¡ç®—</td>
<td>âŒ <strong>å‚æ•°èŒƒæ•°æ— ç•Œå¢é•¿</strong><br>âŒ ä¸ä¿è¯çº¦æŸæ»¡è¶³<br>âŒ å¿½ç•¥å…ˆéªŒå‡ ä½•ç»“æ„</td>
<td>âœ… æ·»åŠ æƒé‡è¡°å‡<br>âœ… å®šæœŸå½’ä¸€åŒ–<br>âœ… åˆ‡æ¢åˆ°æµå½¢æ–¹æ³•</td>
</tr>
<tr>
<td><strong>æŠ•å½±æ¢¯åº¦æ³•</strong><br>(Projected GD)</td>
<td>æ¬§æ°æ­¥+æŠ•å½±<br>$\boldsymbol{w}<em _mathcal_S="\mathcal{S">{t+1} = \text{Proj}</em>_t - \eta\nabla f)$}}(\boldsymbol{w</td>
<td>âœ… çº¦æŸä¸¥æ ¼æ»¡è¶³<br>âœ… æ˜“äºç†è§£<br>âœ… é€‚ç”¨èŒƒå›´å¹¿</td>
<td>âŒ <strong>ä¸¤æ­¥æ“ä½œæ•ˆç‡ä½</strong><br>âŒ æ›´æ–°æ–¹å‘æ¬¡ä¼˜<br>âŒ å¤§æ­¥é•¿æ—¶æŠ•å½±æ‰­æ›²ä¸¥é‡</td>
<td>âœ… å‡å°æ­¥é•¿<br>âœ… ä½¿ç”¨è‡ªé€‚åº”å­¦ä¹ ç‡<br>âœ… æ”¹ç”¨é»æ›¼æ¢¯åº¦</td>
</tr>
<tr>
<td><strong>é»æ›¼æ¢¯åº¦æ³•</strong><br>(æœ¬æ–‡æ–¹æ³•)</td>
<td>åˆ‡ç©ºé—´æ¢¯åº¦<br>$\boldsymbol{w}_{t+1} = \text{Retr}(\boldsymbol{w}_t - \eta\text{grad}f)$</td>
<td>âœ… ç†è®ºæœ€ä¼˜<br>âœ… ä¸€æ­¥åˆ°ä½<br>âœ… å‡ ä½•æ„ä¹‰æ¸…æ™°</td>
<td>âŒ <strong>éœ€è¦é¢å¤–æŠ•å½±è®¡ç®—</strong><br>âŒ å®ç°å¤æ‚åº¦ç¨é«˜<br>âŒ é€šç”¨æ€§ä¸å¦‚æŠ•å½±æ³•</td>
<td>âœ… å¤ç”¨è®¡ç®—ç»“æœ<br>âœ… å‘é‡åŒ–å®ç°<br>âœ… ä¸åŠ¨é‡/Adamç»“åˆ</td>
</tr>
<tr>
<td><strong>è‡ªç„¶æ¢¯åº¦æ³•</strong><br>(Natural Gradient)</td>
<td>Fisheråº¦é‡<br>$\boldsymbol{w}_{t+1} = \boldsymbol{w}_t - \eta F^{-1}\nabla f$</td>
<td>âœ… å‚æ•°åŒ–ä¸å˜æ€§<br>âœ… ä¿¡æ¯å‡ ä½•æœ€ä¼˜<br>âœ… æ”¶æ•›å¿«ï¼ˆå¼ºå‡¸æ—¶ï¼‰</td>
<td>âŒ <strong>è®¡ç®—FisherçŸ©é˜µæ˜‚è´µ</strong><br>âŒ $O(n^3)$ å¤æ‚åº¦<br>âŒ æ•°å€¼ä¸ç¨³å®š</td>
<td>âœ… K-FACè¿‘ä¼¼<br>âœ… å¯¹è§’è¿‘ä¼¼<br>âœ… Kroneckeråˆ†è§£</td>
</tr>
<tr>
<td><strong>ç½šå‡½æ•°æ³•</strong><br>(Penalty Method)</td>
<td>è½¯çº¦æŸ<br>$\min f(\boldsymbol{w}) + \mu(|\boldsymbol{w}|_2^2 - 1)^2$</td>
<td>âœ… æ— çº¦æŸä¼˜åŒ–æ¡†æ¶<br>âœ… çµæ´»æ€§é«˜<br>âœ… æ”¯æŒä¸ç­‰å¼çº¦æŸ</td>
<td>âŒ <strong>çº¦æŸä¸ç²¾ç¡®æ»¡è¶³</strong><br>âŒ è¶…å‚æ•°æ•æ„Ÿ<br>âŒ æ¡ä»¶æ•°æ¶åŒ–</td>
<td>âœ… å¢å¼ºæ‹‰æ ¼æœ—æ—¥æ³•<br>âœ… è‡ªé€‚åº”$\mu$<br>âœ… äº¤æ›¿æ–¹å‘ä¹˜å­æ³•</td>
</tr>
</tbody>
</table>
<h3 id="42-">4.2 æŠ•å½±æ¢¯åº¦æ³• - æ‰¹åˆ¤æ€§åˆ†æ</h3>
<h4 id="_7">æ ¸å¿ƒç¼ºé™·</h4>
<p><strong>ç¼ºé™·1ï¼šæ›´æ–°æ–¹å‘æ¬¡ä¼˜</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šæŠ•å½±æ¢¯åº¦æ³•çš„æ›´æ–° $\boldsymbol{w}_{t+1} = \text{Proj}(\boldsymbol{w}_t - \eta\nabla f)$ å¹¶éçƒé¢ä¸Šçš„æœ€é€Ÿä¸‹é™æ–¹å‘</li>
<li><strong>æ ¹æœ¬åŸå› </strong>ï¼šå…ˆåœ¨æ¬§æ°ç©ºé—´ç§»åŠ¨ï¼Œå†æŠ•å½±å›çº¦æŸé›†ï¼Œè¿™ä¸¤æ­¥åˆ†ç¦»å¯¼è‡´æ–¹å‘æ‰­æ›²</li>
<li><strong>å®šé‡å½±å“</strong>ï¼šå½“ $\eta$ è¾ƒå¤§æ—¶ï¼ŒæŠ•å½±åçš„æ–¹å‘ä¸é»æ›¼æ¢¯åº¦å¤¹è§’å¯è¾¾ $O(\eta^2)$</li>
</ul>
<div class="derivation-box">

#### æ¨å¯¼ï¼šæŠ•å½±æ¢¯åº¦æ³•çš„æ–¹å‘è¯¯å·®

è®¾ $\boldsymbol{w}$ æ»¡è¶³ $\|\boldsymbol{w}\|_2 = 1$ï¼Œæ¬§æ°æ¢¯åº¦ä¸º $\boldsymbol{g} = \nabla f(\boldsymbol{w})$ã€‚

**æŠ•å½±æ¢¯åº¦æ³•**ï¼š
$$
\boldsymbol{w}_{\text{proj}} = \frac{\boldsymbol{w} - \eta\boldsymbol{g}}{\|\boldsymbol{w} - \eta\boldsymbol{g}\|_2}
$$

**é»æ›¼æ¢¯åº¦æ³•**ï¼š
$$
\boldsymbol{w}_{\text{Riem}} = \frac{\boldsymbol{w} - \eta(\boldsymbol{g} - \langle\boldsymbol{g}, \boldsymbol{w}\rangle\boldsymbol{w})}{\|\boldsymbol{w} - \eta(\boldsymbol{g} - \langle\boldsymbol{g}, \boldsymbol{w}\rangle\boldsymbol{w})\|_2}
$$

**è®¡ç®—åˆ†æ¯çš„æ³°å‹’å±•å¼€**ï¼ˆæŠ•å½±æ³•ï¼‰ï¼š
$$
\|\boldsymbol{w} - \eta\boldsymbol{g}\|_2^2 = 1 - 2\eta\langle\boldsymbol{w}, \boldsymbol{g}\rangle + \eta^2\|\boldsymbol{g}\|_2^2
$$
$$
= 1 - 2\eta\langle\boldsymbol{w}, \boldsymbol{g}\rangle + \eta^2\|\boldsymbol{g}\|_2^2
$$

**è®¡ç®—åˆ†æ¯çš„æ³°å‹’å±•å¼€**ï¼ˆé»æ›¼æ³•ï¼‰ï¼š
è®¾ $\boldsymbol{g}_{\perp} = \boldsymbol{g} - \langle\boldsymbol{g}, \boldsymbol{w}\rangle\boldsymbol{w}$ï¼ˆé»æ›¼æ¢¯åº¦ï¼‰
$$
\|\boldsymbol{w} - \eta\boldsymbol{g}_{\perp}\|_2^2 = 1 + \eta^2\|\boldsymbol{g}_{\perp}\|_2^2
$$

**æ–¹å‘å·®å¼‚**ï¼š
æŠ•å½±æ³•çš„å½’ä¸€åŒ–ç³»æ•°ï¼š
$$
\frac{1}{\sqrt{1 - 2\eta\langle\boldsymbol{w}, \boldsymbol{g}\rangle + \eta^2\|\boldsymbol{g}\|_2^2}} \approx 1 + \eta\langle\boldsymbol{w}, \boldsymbol{g}\rangle + O(\eta^2)
$$

é»æ›¼æ³•çš„å½’ä¸€åŒ–ç³»æ•°ï¼š
$$
\frac{1}{\sqrt{1 + \eta^2\|\boldsymbol{g}_{\perp}\|_2^2}} \approx 1 - \frac{\eta^2\|\boldsymbol{g}_{\perp}\|_2^2}{2} + O(\eta^4)
$$

**ç»“è®º**ï¼šä¸¤ç§æ–¹æ³•åœ¨ $O(\eta)$ é¡¹ä¸Šæœ‰å·®å¼‚ $\eta\langle\boldsymbol{w}, \boldsymbol{g}\rangle$ï¼Œè¿™å¯¼è‡´ï¼š
$$
\|\boldsymbol{w}_{\text{proj}} - \boldsymbol{w}_{\text{Riem}}\|_2 = O(\eta^2)
$$

</div>

<p><strong>ç¼ºé™·2ï¼šè®¡ç®—æ•ˆç‡é—®é¢˜</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šéœ€è¦ä¸¤æ¬¡å®Œæ•´çš„å‘é‡æ“ä½œï¼ˆæ¢¯åº¦æ­¥+å½’ä¸€åŒ–ï¼‰ï¼Œæ— æ³•èåˆè®¡ç®—</li>
<li><strong>å½±å“</strong>ï¼šå†…å­˜è®¿é—®æ¬¡æ•°å¢åŠ ï¼Œç¼“å­˜å‘½ä¸­ç‡é™ä½</li>
<li><strong>å®šé‡åˆ†æ</strong>ï¼š</li>
<li>æ¢¯åº¦æ­¥ï¼š$n$ æ¬¡ä¹˜åŠ  + $n$ æ¬¡å‡æ³•</li>
<li>å½’ä¸€åŒ–ï¼š$n$ æ¬¡å¹³æ–¹ + 1æ¬¡å¼€æ–¹ + $n$ æ¬¡é™¤æ³•</li>
<li>æ€»è®¡ï¼šçº¦ $4n$ æ¬¡è®¿å­˜æ“ä½œ</li>
</ul>
<p><strong>ç¼ºé™·3ï¼šå¤§æ­¥é•¿æ—¶çš„å‡ ä½•æ‰­æ›²</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šå½“ $\eta$ å¾ˆå¤§æ—¶ï¼Œ$\boldsymbol{w} - \eta\nabla f$ å¯èƒ½è¿œç¦»çƒé¢ï¼ŒæŠ•å½±ä¼šä¸¥é‡æ”¹å˜æ–¹å‘</li>
<li><strong>ç†è®ºåˆ†æ</strong>ï¼šæ¬§æ°æ­¥é•¿ä¸º $\eta$ï¼Œä½†æŠ•å½±åçƒé¢å¼§é•¿å¯èƒ½è¿œå°äº $\eta$ï¼ˆç”šè‡³æ¥è¿‘0ï¼‰</li>
<li><strong>æ•°å€¼å®éªŒ</strong>ï¼šåœ¨é«˜æ›²ç‡åŒºåŸŸï¼ŒæŠ•å½±å¯èƒ½å¯¼è‡´ $&gt;90Â°$ çš„æ–¹å‘å˜åŒ–</li>
</ul>
<h4 id="_8">ä¼˜åŒ–æ–¹å‘</h4>
<p><strong>ä¼˜åŒ–1ï¼šè‡ªé€‚åº”æŠ•å½±ï¼ˆAdaptive Projectionï¼‰</strong></p>
<ul>
<li><strong>ç­–ç•¥</strong>ï¼šæ ¹æ®æ¢¯åº¦ä¸ä½ç½®å‘é‡çš„å¤¹è§’è°ƒæ•´æ­¥é•¿
  $$
  \eta_{\text{eff}} = \eta \cdot \frac{\|\boldsymbol{g}_{\perp}\|_2}{\|\boldsymbol{g}\|_2}
  $$</li>
<li><strong>æ•ˆæœ</strong>ï¼šå‡å°‘æ–¹å‘æ‰­æ›²ï¼Œä¿æŒæœ‰æ•ˆæ­¥é•¿ç¨³å®š</li>
</ul>
<p><strong>ä¼˜åŒ–2ï¼šæ··åˆæ–¹æ³•ï¼ˆHybrid Approachï¼‰</strong></p>
<ul>
<li><strong>ç­–ç•¥</strong>ï¼šå°æ­¥é•¿ç”¨æŠ•å½±æ³•ï¼ˆç®€å•ï¼‰ï¼Œå¤§æ­¥é•¿ç”¨é»æ›¼æ³•ï¼ˆç²¾ç¡®ï¼‰
  $$
  \boldsymbol{w}_{t+1} = \begin{cases}
  \text{Proj}(\boldsymbol{w}_t - \eta\nabla f) & \text{if } \eta < \epsilon \\
  \text{Retr}(\boldsymbol{w}_t - \eta\text{grad}f) & \text{otherwise}
  \end{cases}
  $$</li>
<li><strong>æ•ˆæœ</strong>ï¼šå…¼é¡¾æ•ˆç‡ä¸ç²¾åº¦</li>
</ul>
<p><strong>ä¼˜åŒ–3ï¼šé¢„æ¡ä»¶æŠ•å½±ï¼ˆPreconditioned Projectionï¼‰</strong></p>
<ul>
<li><strong>ç­–ç•¥</strong>ï¼šä½¿ç”¨é¢„æ¡ä»¶çŸ©é˜µ $\boldsymbol{P}$ æ”¹å–„æ¡ä»¶æ•°
  $$
  \boldsymbol{w}_{t+1} = \text{Proj}(\boldsymbol{w}_t - \eta\boldsymbol{P}^{-1}\nabla f)
  $$
  å…¶ä¸­ $\boldsymbol{P}$ å¯ä»¥æ˜¯å¯¹è§’ä¼°è®¡æˆ–åŠ¨é‡ç§¯ç´¯</li>
<li><strong>æ•ˆæœ</strong>ï¼šåŠ é€Ÿæ”¶æ•›ï¼Œç±»ä¼¼Adamåœ¨çƒé¢ä¸Šçš„æ‰©å±•</li>
</ul>
<h3 id="43-">4.3 é»æ›¼æ¢¯åº¦æ³• - æ‰¹åˆ¤æ€§åˆ†æ</h3>
<h4 id="_9">æ ¸å¿ƒç¼ºé™·</h4>
<p><strong>ç¼ºé™·1ï¼šé¢å¤–çš„æŠ•å½±è®¡ç®—å¼€é”€</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šæ¯æ­¥éœ€è¦è®¡ç®— $\langle\nabla f, \boldsymbol{w}\rangle$ å’Œ $\langle\nabla f, \boldsymbol{w}\rangle\boldsymbol{w}$</li>
<li><strong>æ ¹æœ¬åŸå› </strong>ï¼šå°†æ¬§æ°æ¢¯åº¦æŠ•å½±åˆ°åˆ‡ç©ºé—´çš„å¿…è¦ä»£ä»·</li>
<li><strong>å®šé‡å½±å“</strong>ï¼š</li>
<li>å†…ç§¯è®¡ç®—ï¼š$O(n)$</li>
<li>æ ‡é‡ä¹˜å‘é‡ï¼š$O(n)$</li>
<li>å‘é‡å‡æ³•ï¼š$O(n)$</li>
<li>æ€»é¢å¤–å¼€é”€ï¼šçº¦ $3n$ æ¬¡æµ®ç‚¹è¿ç®—ï¼ˆç›¸æ¯”æ— çº¦æŸSGDï¼‰</li>
</ul>
<div class="formula-explanation">

<div class="formula-step">
<div class="step-label">å¤æ‚åº¦åˆ†è§£</div>

**æ— çº¦æŸSGD**ï¼š
$$
\boldsymbol{w}_{t+1} = \boldsymbol{w}_t - \eta\nabla f(\boldsymbol{w}_t)
$$
- å‘é‡åŠ æ³•ï¼š$n$ æ¬¡è¿ç®—
- **æ€»è®¡**ï¼š$n$ FLOPs

**é»æ›¼æ¢¯åº¦SGD**ï¼š
$$
\boldsymbol{w}_{t+1} = \frac{\boldsymbol{w}_t - \eta(\nabla f - \langle\nabla f, \boldsymbol{w}_t\rangle\boldsymbol{w}_t)}{\|\cdots\|_2}
$$
- å†…ç§¯ $\langle\nabla f, \boldsymbol{w}_t\rangle$ï¼š$n$ æ¬¡ä¹˜åŠ 
- æ ‡é‡ä¹˜å‘é‡ $\langle\nabla f, \boldsymbol{w}_t\rangle\boldsymbol{w}_t$ï¼š$n$ æ¬¡ä¹˜æ³•
- ä¸¤æ¬¡å‘é‡å‡æ³•ï¼š$2n$ æ¬¡å‡æ³•
- èŒƒæ•°è®¡ç®—ï¼š$n$ æ¬¡å¹³æ–¹ + 1æ¬¡å¼€æ–¹
- å½’ä¸€åŒ–ï¼š$n$ æ¬¡é™¤æ³•
- **æ€»è®¡**ï¼šçº¦ $6n$ FLOPs

<div class="step-explanation">
é¢å¤–å¼€é”€çº¦ä¸º **5å€**ï¼Œä½†ç›¸æ¯”æ¢¯åº¦è®¡ç®—æœ¬èº«ï¼ˆé€šå¸¸ $O(nd)$ æˆ–æ›´é«˜ï¼‰ï¼Œè¿™æ˜¯å¯æ¥å—çš„ã€‚
</div>
</div>

</div>

<p><strong>ç¼ºé™·2ï¼šä¸ç°ä»£ä¼˜åŒ–å™¨ï¼ˆAdamç­‰ï¼‰çš„ç»“åˆä¸ç›´æ¥</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šAdamä½¿ç”¨ä¸€é˜¶å’ŒäºŒé˜¶çŸ©ä¼°è®¡ï¼Œä½†åœ¨æµå½¢ä¸Šéœ€è¦é‡æ–°å®šä¹‰"çŸ©"</li>
<li><strong>æŒ‘æˆ˜</strong>ï¼š</li>
<li>åŠ¨é‡ $\boldsymbol{m}_t$ åº”è¯¥åœ¨å“ªä¸ªåˆ‡ç©ºé—´ç´¯ç§¯ï¼Ÿ</li>
<li>ä¸åŒç‚¹çš„åˆ‡ç©ºé—´ä¸åŒï¼Œå¦‚ä½•ä¼ è¾“å‘é‡ï¼Ÿ</li>
<li><strong>ç°çŠ¶</strong>ï¼šç¼ºä¹ç†è®ºå®Œå¤‡çš„RiemannianAdam</li>
</ul>
<p><strong>ç¼ºé™·3ï¼šé«˜ç»´å‚æ•°ç©ºé—´çš„æ•°å€¼ç¨³å®šæ€§</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šå½“ $|\nabla f|_2 \gg |\langle\nabla f, \boldsymbol{w}\rangle|$ æ—¶ï¼ŒæŠ•å½±å¯èƒ½å¯¼è‡´æ•°å€¼è¯¯å·®æ”¾å¤§</li>
<li><strong>å½±å“</strong>ï¼šåœ¨æ¥è¿‘æœ€ä¼˜è§£æ—¶ï¼Œæ¢¯åº¦çš„æ³•å‘åˆ†é‡å¾ˆå°ï¼Œåˆ‡å‘åˆ†é‡ä¸»å¯¼ï¼Œæµ®ç‚¹ç²¾åº¦æŸå¤±</li>
<li><strong>å®šé‡åˆ†æ</strong>ï¼šè‹¥ $\langle\nabla f, \boldsymbol{w}\rangle / |\nabla f|_2 &lt; 10^{-8}$ï¼Œå•ç²¾åº¦æµ®ç‚¹æ•°å¯èƒ½å¤±å»ç²¾åº¦</li>
</ul>
<h4 id="_10">ä¼˜åŒ–æ–¹å‘</h4>
<p><strong>ä¼˜åŒ–1ï¼šå‘é‡åŒ–ä¸ç¼“å­˜å¤ç”¨ï¼ˆVectorization &amp; Cache Reuseï¼‰</strong></p>
<ul>
<li><strong>ç­–ç•¥</strong>ï¼šå°†æŠ•å½±ã€å½’ä¸€åŒ–èåˆä¸ºå•ä¸ªkernelï¼Œå‡å°‘å†…å­˜è®¿é—®
  ```python
  # ä½æ•ˆç‰ˆæœ¬ï¼ˆ3æ¬¡è®¿å­˜ï¼‰
  dot_product = np.dot(grad, w)
  projected = grad - dot_product * w
  w_new = projected / np.linalg.norm(projected)</li>
</ul>
<p># é«˜æ•ˆç‰ˆæœ¬ï¼ˆèåˆkernelï¼Œ1æ¬¡è®¿å­˜ï¼‰
  @jit
  def fused_riemannian_step(w, grad, eta):
      dot_prod = 0.0
      norm_sq = 0.0
      for i in range(n):
          grad_proj_i = grad[i] - dot_prod * w[i]
          norm_sq += grad_proj_i ** 2
      norm = sqrt(norm_sq)
      for i in range(n):
          w[i] = (w[i] - eta * grad_proj_i) / norm
  ```
- <strong>æ•ˆæœ</strong>ï¼šå†…å­˜å¸¦å®½éœ€æ±‚é™ä½ $2-3$ å€</p>
<p><strong>ä¼˜åŒ–2ï¼šé»æ›¼Adamï¼ˆRAdamï¼‰- ç†è®ºæ‰©å±•</strong></p>
<ul>
<li><strong>ç­–ç•¥</strong>ï¼šåœ¨åˆ‡ç©ºé—´å®šä¹‰åŠ¨é‡å’ŒäºŒé˜¶çŸ©ï¼Œä½¿ç”¨å¹³è¡Œç§»åŠ¨ä¼ è¾“
  $$
  \boldsymbol{m}_t = \beta_1 \mathcal{T}_{t-1\to t}(\boldsymbol{m}_{t-1}) + (1-\beta_1)\text{grad} f(\boldsymbol{w}_t)
  $$
  å…¶ä¸­ $\mathcal{T}<em _boldsymbol_w="\boldsymbol{w">{t-1\to t}$ æ˜¯ä» $T</em><em _boldsymbol_w="\boldsymbol{w">{t-1}}$ åˆ° $T</em>$ çš„å¹³è¡Œç§»åŠ¨ç®—å­}_t</li>
<li><strong>è¿‘ä¼¼</strong>ï¼šå¯¹äºè¶…çƒé¢ï¼Œå¹³è¡Œç§»åŠ¨å¯ä»¥è¿‘ä¼¼ä¸ºæŠ•å½±ï¼š
  $$
  \mathcal{T}_{t-1\to t}(\boldsymbol{v}) \approx \boldsymbol{v} - \langle\boldsymbol{v}, \boldsymbol{w}_t\rangle\boldsymbol{w}_t
  $$</li>
<li><strong>æ•ˆæœ</strong>ï¼šä¿ç•™Adamçš„è‡ªé€‚åº”æ€§ï¼ŒåŒæ—¶å°Šé‡å‡ ä½•ç»“æ„</li>
</ul>
<p><strong>ä¼˜åŒ–3ï¼šæ•°å€¼ç¨³å®šåŒ–æŠ€å·§</strong></p>
<ul>
<li><strong>ç­–ç•¥1</strong>ï¼šä½¿ç”¨Kahanæ±‚å’Œè®¡ç®—å†…ç§¯ï¼Œå‡å°‘æµ®ç‚¹è¯¯å·®ç´¯ç§¯</li>
<li><strong>ç­–ç•¥2</strong>ï¼šå½“ $|\text{grad} f|_2 &lt; \epsilon$ æ—¶ï¼Œè·³è¿‡å½’ä¸€åŒ–ï¼ˆå·²è¿‘ä¼¼åœ¨çƒé¢ï¼‰</li>
<li><strong>ç­–ç•¥3</strong>ï¼šå®šæœŸï¼ˆæ¯ $K$ æ­¥ï¼‰ç²¾ç¡®é‡æŠ•å½±ï¼š$\boldsymbol{w} \leftarrow \boldsymbol{w}/|\boldsymbol{w}|_2$</li>
<li><strong>æ•ˆæœ</strong>ï¼šé•¿æ—¶é—´è®­ç»ƒæ—¶çº¦æŸè¯¯å·® $&lt;10^{-12}$</li>
</ul>
<h3 id="44-">4.4 è‡ªç„¶æ¢¯åº¦æ³• - æ‰¹åˆ¤æ€§åˆ†æ</h3>
<h4 id="_11">æ ¸å¿ƒç¼ºé™·</h4>
<p><strong>ç¼ºé™·1ï¼šè®¡ç®—Fisherä¿¡æ¯çŸ©é˜µçš„æ˜‚è´µæˆæœ¬</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šFisherçŸ©é˜µ $\boldsymbol{F} = \mathbb{E}[\nabla\log p \nabla\log p^{\top}]$ æ˜¯ $n \times n$ ç¨ å¯†çŸ©é˜µ</li>
<li><strong>å¤æ‚åº¦</strong>ï¼š</li>
<li>è®¡ç®—ï¼š$O(n^2)$ å­˜å‚¨ï¼Œ$O(n^3)$ æ±‚é€†</li>
<li>å¯¹æ¯”ï¼šé»æ›¼æ¢¯åº¦ä»…éœ€ $O(n)$</li>
<li><strong>å®šé‡å½±å“</strong>ï¼š$n=10^6$ æ—¶ï¼ŒFisherçŸ©é˜µéœ€è¦ $\sim 4$ TBå†…å­˜ï¼ˆä¸å¯è¡Œï¼‰</li>
</ul>
<p><strong>ç¼ºé™·2ï¼šè¶…çƒé¢ä¸ŠFisheråº¦é‡ä¸æ¬§æ°åº¦é‡çš„å…³ç³»å¤æ‚</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šåœ¨ä¸€èˆ¬å‚æ•°åŒ–ä¸‹ï¼ŒFisheråº¦é‡ä¸ç®€åŒ–ä¸ºé»æ›¼åº¦é‡</li>
<li><strong>ç†è®ºåˆ†æ</strong>ï¼šåªæœ‰åœ¨ç‰¹å®šå‚æ•°åŒ–ï¼ˆå¦‚æŒ‡æ•°æ—ï¼‰ä¸‹ï¼Œä¸¤è€…æ‰ç­‰ä»·</li>
<li><strong>å½±å“</strong>ï¼šè‡ªç„¶æ¢¯åº¦ä¸ç›´æ¥ç­‰åŒäºé»æ›¼æ¢¯åº¦</li>
</ul>
<p><strong>ç¼ºé™·3ï¼šæ¡ä»¶æ•°æ¶åŒ–ä¸æ•°å€¼ä¸ç¨³å®š</strong></p>
<ul>
<li><strong>é—®é¢˜</strong>ï¼šFisherçŸ©é˜µå¾€å¾€ç—…æ€ï¼ˆæ¡ä»¶æ•° $&gt;10^6$ï¼‰ï¼Œæ±‚é€†ä¸ç¨³å®š</li>
<li><strong>æ ¹æœ¬åŸå› </strong>ï¼šå‚æ•°å†—ä½™ã€å¹³å¦æ–¹å‘</li>
<li><strong>å½±å“</strong>ï¼šéœ€è¦æ­£åˆ™åŒ– $\boldsymbol{F} + \lambda\boldsymbol{I}$ï¼Œå¼•å…¥æ–°è¶…å‚æ•°</li>
</ul>
<h4 id="_12">ä¼˜åŒ–æ–¹å‘</h4>
<p><strong>ä¼˜åŒ–1ï¼šK-FACï¼ˆKronecker-Factored Approximate Curvatureï¼‰</strong></p>
<ul>
<li><strong>ç­–ç•¥</strong>ï¼šå°†FisherçŸ©é˜µåˆ†è§£ä¸ºKroneckerç§¯
  $$
  \boldsymbol{F} \approx \boldsymbol{A} \otimes \boldsymbol{B}
  $$
  å…¶ä¸­ $\boldsymbol{A}$ å’Œ $\boldsymbol{B}$ ç»´åº¦è¾ƒå°</li>
<li><strong>å¤æ‚åº¦</strong>ï¼šä» $O(n^3)$ é™è‡³ $O(n^{1.5})$</li>
<li><strong>æ•ˆæœ</strong>ï¼šåœ¨å¤§è§„æ¨¡ç½‘ç»œä¸Šå¯è¡Œï¼ŒImageNetè®­ç»ƒåŠ é€Ÿ $2-3$ å€</li>
</ul>
<p><strong>ä¼˜åŒ–2ï¼šå¯¹è§’Fisherè¿‘ä¼¼</strong></p>
<ul>
<li><strong>ç­–ç•¥</strong>ï¼šåªè®¡ç®—FisherçŸ©é˜µå¯¹è§’å…ƒç´ 
  $$
  \text{grad}_{\text{nat}} f \approx \text{diag}(\boldsymbol{F})^{-1} \nabla f
  $$</li>
<li><strong>å¤æ‚åº¦</strong>ï¼š$O(n)$ å­˜å‚¨å’Œè®¡ç®—</li>
<li><strong>æ•ˆæœ</strong>ï¼šæ¥è¿‘Adamçš„è®¡ç®—æˆæœ¬ï¼Œæ”¶æ•›é€Ÿåº¦ä»‹äºSGDå’Œå®Œå…¨è‡ªç„¶æ¢¯åº¦ä¹‹é—´</li>
</ul>
<p><strong>ä¼˜åŒ–3ï¼šåœ¨çº¿Fisherä¼°è®¡</strong></p>
<ul>
<li><strong>ç­–ç•¥</strong>ï¼šä½¿ç”¨æŒ‡æ•°ç§»åŠ¨å¹³å‡åœ¨çº¿ä¼°è®¡FisherçŸ©é˜µ
  $$
  \boldsymbol{F}_t = \beta \boldsymbol{F}_{t-1} + (1-\beta)\nabla\log p_t \nabla\log p_t^{\top}
  $$</li>
<li><strong>ä¼˜åŠ¿</strong>ï¼šæ— éœ€å­˜å‚¨æ‰€æœ‰æ ·æœ¬</li>
<li><strong>æ•ˆæœ</strong>ï¼šé€‚ç”¨äºæµæ•°æ®å’Œåœ¨çº¿å­¦ä¹ </li>
</ul>
<h3 id="45">4.5 ç»¼åˆè¯„ä»·ä¸é€‰æ‹©å»ºè®®</h3>
<div class="example-box">

#### ä¸åŒåœºæ™¯ä¸‹çš„æ–¹æ³•é€‰æ‹©

**åœºæ™¯1ï¼šå°è§„æ¨¡é—®é¢˜ï¼ˆ$n < 10^4$ï¼‰**
- **æ¨è**ï¼šé»æ›¼æ¢¯åº¦æ³•
- **ç†ç”±**ï¼šè®¡ç®—å¼€é”€å¯å¿½ç•¥ï¼Œç†è®ºæœ€ä¼˜

**åœºæ™¯2ï¼šå¤§è§„æ¨¡æ·±åº¦å­¦ä¹ ï¼ˆ$n > 10^7$ï¼‰**
- **æ¨è**ï¼šæŠ•å½±æ¢¯åº¦æ³• + è‡ªé€‚åº”æ­¥é•¿
- **ç†ç”±**ï¼šå®ç°ç®€å•ï¼Œä¸ç°æœ‰æ¡†æ¶å…¼å®¹

**åœºæ™¯3ï¼šæƒé‡å½’ä¸€åŒ–å±‚**
- **æ¨è**ï¼šé»æ›¼æ¢¯åº¦æ³•ï¼ˆé’ˆå¯¹å½’ä¸€åŒ–ç»´åº¦ï¼‰
- **ç†ç”±**ï¼šçº¦æŸå¤©ç„¶å­˜åœ¨ï¼Œé¢å¤–æˆæœ¬åˆ†æ‘Š

**åœºæ™¯4ï¼šéœ€è¦æœ€å¿«æ”¶æ•›**
- **æ¨è**ï¼šK-FACè‡ªç„¶æ¢¯åº¦ + é»æ›¼å‡ ä½•
- **ç†ç”±**ï¼šç»“åˆäºŒé˜¶ä¿¡æ¯ä¸æµå½¢ç»“æ„

**åœºæ™¯5ï¼šå¼ºåŒ–å­¦ä¹ ç­–ç•¥æ¢¯åº¦**
- **æ¨è**ï¼šè‡ªç„¶ç­–ç•¥æ¢¯åº¦ï¼ˆNPGï¼‰
- **ç†ç”±**ï¼šFisheråº¦é‡å¤©ç„¶å‡ºç°ï¼Œç†è®ºä¿è¯å•è°ƒæ”¹è¿›

</div>

<hr />
<h2 id="_13">æ–‡ç« å°ç»“</h2>
<p>è¿™ç¯‡æ–‡ç« æ–°å¼€ä¸€ä¸ªç³»åˆ—ï¼Œä¸»è¦å›´ç»•â€œç­‰å¼çº¦æŸâ€æ¥è®¨è®ºä¼˜åŒ–é—®é¢˜ï¼Œè¯•å›¾ç»™ä¸€äº›å¸¸è§çš„çº¦æŸæ¡ä»¶å¯»æ‰¾â€œä¸‹é™æœ€å¿«çš„æ–¹å‘â€ã€‚ä½œä¸ºç¬¬ä¸€ç¯‡æ–‡ç« ï¼Œæœ¬æ–‡è®¨è®ºäº†â€œè¶…çƒé¢â€çº¦æŸä¸‹çš„SGDå˜ä½“ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11196">https://spaces.ac.cn/archives/11196</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Aug. 01, 2025). ã€Šæµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š1. SGD + è¶…çƒé¢ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11196">https://spaces.ac.cn/archives/11196</a></p>
<p>@online{kexuefm-11196,
title={æµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š1. SGD + è¶…çƒé¢},
author={è‹å‰‘æ—},
year={2025},
month={Aug},
url={\url{https://spaces.ac.cn/archives/11196}},
}</p>
<hr />
<h2 id="5">ç¬¬5éƒ¨åˆ†ï¼šå­¦ä¹ è·¯çº¿å›¾ä¸æœªæ¥å±•æœ›</h2>
<h3 id="51">5.1 å­¦ä¹ è·¯çº¿å›¾</h3>
<h4 id="_14">å¿…å¤‡å‰ç½®çŸ¥è¯†</h4>
<p>è¦æ·±å…¥ç†è§£è¶…çƒé¢ä¼˜åŒ–ï¼Œéœ€è¦ä»¥ä¸‹æ•°å­¦å’Œæœºå™¨å­¦ä¹ åŸºç¡€ï¼š</p>
<p><strong>æ•°å­¦åŸºç¡€ï¼ˆæŒ‰é‡è¦æ€§æ’åºï¼‰</strong>ï¼š</p>
<ol>
<li><strong>çº¿æ€§ä»£æ•°</strong>ï¼ˆå¿…éœ€ï¼‰</li>
<li>å‘é‡ç©ºé—´ã€å†…ç§¯ã€æ­£äº¤æ€§</li>
<li>æŠ•å½±ã€æ­£äº¤åˆ†è§£</li>
<li>çŸ©é˜µèŒƒæ•°ã€å¥‡å¼‚å€¼åˆ†è§£</li>
<li>
<p><strong>æ¨èæ•™æ</strong>ï¼šGilbert Strangã€ŠLinear Algebra and Its Applicationsã€‹</p>
</li>
<li>
<p><strong>å¾®ç§¯åˆ†ä¸ä¼˜åŒ–</strong>ï¼ˆå¿…éœ€ï¼‰</p>
</li>
<li>å¤šå…ƒå¾®åˆ†ã€æ¢¯åº¦ã€æ–¹å‘å¯¼æ•°</li>
<li>é“¾å¼æ³•åˆ™ã€æ³°å‹’å±•å¼€</li>
<li>çº¦æŸä¼˜åŒ–ã€æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•</li>
<li>
<p><strong>æ¨èæ•™æ</strong>ï¼šBoyd &amp; Vandenbergheã€ŠConvex Optimizationã€‹</p>
</li>
<li>
<p><strong>å¾®åˆ†å‡ ä½•</strong>ï¼ˆè¿›é˜¶ï¼‰</p>
</li>
<li>æ›²çº¿ä¸æ›²é¢ã€åˆ‡ç©ºé—´ã€æ³•å‘é‡</li>
<li>é»æ›¼åº¦é‡ã€æµ‹åœ°çº¿</li>
<li>æµå½¢ã€åµŒå…¥ã€æŠ•å½±</li>
<li>
<p><strong>æ¨èæ•™æ</strong>ï¼šJohn M. Leeã€ŠIntroduction to Smooth Manifoldsã€‹ï¼ˆç¬¬1-3ç« ï¼‰</p>
</li>
<li>
<p><strong>æ•°å€¼åˆ†æ</strong>ï¼ˆé€‰ä¿®ï¼‰</p>
</li>
<li>æµ®ç‚¹è¿ç®—ã€è¯¯å·®åˆ†æ</li>
<li>è¿­ä»£ç®—æ³•ã€æ”¶æ•›æ€§åˆ†æ</li>
<li><strong>æ¨èæ•™æ</strong>ï¼šNocedal &amp; Wrightã€ŠNumerical Optimizationã€‹</li>
</ol>
<p><strong>æœºå™¨å­¦ä¹ åŸºç¡€</strong>ï¼š</p>
<ol>
<li><strong>ä¼˜åŒ–ç®—æ³•</strong></li>
<li>SGDåŠå…¶å˜ä½“ï¼ˆMomentum, Adam, RMSpropï¼‰</li>
<li>å­¦ä¹ ç‡è°ƒåº¦ã€æ¢¯åº¦è£å‰ª</li>
<li>æ‰¹é‡å½’ä¸€åŒ–ã€æƒé‡å½’ä¸€åŒ–</li>
<li>
<p><strong>æ¨èè¯¾ç¨‹</strong>ï¼šStanford CS231n</p>
</li>
<li>
<p><strong>æ·±åº¦å­¦ä¹ æ¡†æ¶</strong></p>
</li>
<li>PyTorchæˆ–JAXçš„è‡ªåŠ¨å¾®åˆ†æœºåˆ¶</li>
<li>è‡ªå®šä¹‰ä¼˜åŒ–å™¨å®ç°</li>
<li><strong>æ¨èèµ„æº</strong>ï¼šPyTorchå®˜æ–¹æ•™ç¨‹</li>
</ol>
<h4 id="_15">æ ¸å¿ƒè®ºæ–‡å­¦ä¹ è·¯å¾„</h4>
<p><strong>é˜¶æ®µ1ï¼šæµå½¢ä¼˜åŒ–åŸºç¡€ï¼ˆ2-3ä¸ªæœˆï¼‰</strong></p>
<ol>
<li><strong>Absil, Mahony &amp; Sepulchre (2008)</strong></li>
<li>ã€ŠOptimization Algorithms on Matrix Manifoldsã€‹</li>
<li><strong>é‡ç‚¹ç« èŠ‚</strong>ï¼šç¬¬3ç« ï¼ˆå¾®åˆ†å‡ ä½•ï¼‰ã€ç¬¬4ç« ï¼ˆä¼˜åŒ–ç®—æ³•ï¼‰</li>
<li>
<p><strong>é…å¥—ä»£ç </strong>ï¼šManoptå·¥å…·ç®±</p>
</li>
<li>
<p><strong>Edelman, Arias &amp; Smith (1998)</strong></p>
</li>
<li>"The Geometry of Algorithms with Orthogonality Constraints"</li>
<li><strong>é‡ç‚¹</strong>ï¼šStiefelæµå½¢ã€Grassmannæµå½¢çš„å‡ ä½•</li>
<li>
<p><strong>åº”ç”¨</strong>ï¼šPCAã€ICAã€ä½ç§©åˆ†è§£</p>
</li>
<li>
<p><strong>Boumal (2020)</strong></p>
</li>
<li>ã€ŠAn Introduction to Optimization on Smooth Manifoldsã€‹</li>
<li><strong>ç°ä»£è§†è§’</strong>ï¼šæ›´æ³¨é‡è®¡ç®—å®ç°å’Œæœºå™¨å­¦ä¹ åº”ç”¨</li>
<li><strong>å…è´¹èµ„æº</strong>ï¼š<a href="https://www.nicolasboumal.net/book/">åœ¨çº¿ç‰ˆæœ¬</a></li>
</ol>
<p><strong>é˜¶æ®µ2ï¼šç¥ç»ç½‘ç»œä¸­çš„æµå½¢ä¼˜åŒ–ï¼ˆ1-2ä¸ªæœˆï¼‰</strong></p>
<ol>
<li><strong>Salimans &amp; Kingma (2016)</strong> - NeurIPS</li>
<li>"Weight Normalization: A Simple Reparameterization to Accelerate Training"</li>
<li><strong>è´¡çŒ®</strong>ï¼š$\boldsymbol{w} = g\boldsymbol{v}/|\boldsymbol{v}|_2$ åˆ†è§£</li>
<li><strong>åº”ç”¨</strong>ï¼šRNNã€GANè®­ç»ƒç¨³å®šæ€§</li>
<li>
<p><strong>ä»£ç </strong>ï¼š<a href="https://pytorch.org/docs/stable/generated/torch.nn.utils.weight_norm.html">PyTorchå®ç°</a></p>
</li>
<li>
<p><strong>Miyato et al. (2018)</strong> - ICLR</p>
</li>
<li>"Spectral Normalization for Generative Adversarial Networks"</li>
<li><strong>è´¡çŒ®</strong>ï¼šçº¦æŸåˆ¤åˆ«å™¨Lipschitzå¸¸æ•°</li>
<li><strong>ç†è®º</strong>ï¼šå¹‚è¿­ä»£æ³•åœ¨Stiefelæµå½¢ä¸Šçš„æ”¶æ•›æ€§</li>
<li>
<p><strong>å½±å“</strong>ï¼šæˆä¸ºGANè®­ç»ƒçš„æ ‡å‡†æŠ€æœ¯</p>
</li>
<li>
<p><strong>Cho &amp; Lee (2017)</strong> - NeurIPS</p>
</li>
<li>"Riemannian Approach to Batch Normalization"</li>
<li><strong>åˆ›æ–°</strong>ï¼šå°†æ‰¹é‡å½’ä¸€åŒ–è§£é‡Šä¸ºSPDæµå½¢ä¸Šçš„ä¼˜åŒ–</li>
<li><strong>ç†è®ºè´¡çŒ®</strong>ï¼šé»æ›¼æ‰¹é‡å½’ä¸€åŒ–çš„æ”¶æ•›æ€§åˆ†æ</li>
</ol>
<p><strong>é˜¶æ®µ3ï¼šé«˜çº§ä¸»é¢˜ä¸å‰æ²¿ç ”ç©¶ï¼ˆæŒç»­å­¦ä¹ ï¼‰</strong></p>
<ol>
<li><strong>Becigneul &amp; Ganea (2019)</strong> - ICML</li>
<li>"Riemannian Adaptive Optimization Methods"</li>
<li><strong>è´¡çŒ®</strong>ï¼šæå‡ºRAdamã€RSGDmï¼ˆæµå½¢ä¸Šçš„Adamå’ŒMomentumï¼‰</li>
<li>
<p><strong>ç†è®º</strong>ï¼šå¹³è¡Œç§»åŠ¨ã€å‘é‡ä¼ è¾“çš„å®ç”¨è¿‘ä¼¼</p>
</li>
<li>
<p><strong>Gao et al. (2021)</strong> - ICLR</p>
</li>
<li>"Riemannian Optimization for Deep Learning"</li>
<li><strong>ç»¼è¿°</strong>ï¼šæ€»ç»“æµå½¢ä¼˜åŒ–åœ¨æ·±åº¦å­¦ä¹ ä¸­çš„åº”ç”¨</li>
<li>
<p><strong>ä»£ç </strong>ï¼šGeooptåº“ï¼ˆPyTorchï¼‰</p>
</li>
<li>
<p><strong>Liu et al. (2022)</strong> - NeurIPS</p>
</li>
<li>"Optimization on Multiple Manifolds"</li>
<li><strong>å‰æ²¿</strong>ï¼šå¤šä¸ªæµå½¢çº¦æŸçš„åŒæ—¶ä¼˜åŒ–</li>
<li><strong>åº”ç”¨</strong>ï¼šç¥ç»æ¶æ„æœç´¢ã€å¤šä»»åŠ¡å­¦ä¹ </li>
</ol>
<h4 id="_16">å®è·µå­¦ä¹ è·¯å¾„</h4>
<p><strong>åˆçº§å®è·µï¼ˆ1-2å‘¨ï¼‰</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># é¡¹ç›®1ï¼šæ‰‹å†™è¶…çƒé¢SGD</span>
<span class="c1"># - å®ç°æŠ•å½±æ¢¯åº¦æ³•</span>
<span class="c1"># - å®ç°é»æ›¼æ¢¯åº¦æ³•</span>
<span class="c1"># - å¯¹æ¯”æ”¶æ•›æ›²çº¿</span>

<span class="c1"># é¡¹ç›®2ï¼šæƒé‡å½’ä¸€åŒ–å±‚</span>
<span class="c1"># - ä»é›¶å®ç°weight normalization</span>
<span class="c1"># - åœ¨MNISTä¸Šè®­ç»ƒCNN</span>
<span class="c1"># - å¯¹æ¯”æ ‡å‡†å·ç§¯å±‚</span>

<span class="c1"># é¡¹ç›®3ï¼šå¯è§†åŒ–è¶…çƒé¢ä¼˜åŒ–è½¨è¿¹</span>
<span class="c1"># - åœ¨S^2ä¸Šå®šä¹‰ç®€å•ç›®æ ‡å‡½æ•°</span>
<span class="c1"># - ç»˜åˆ¶æ¢¯åº¦ä¸‹é™è½¨è¿¹</span>
<span class="c1"># - å¯¹æ¯”æ¬§æ°vsé»æ›¼æ¢¯åº¦</span>
</code></pre></div>

<p><strong>ä¸­çº§å®è·µï¼ˆ2-4å‘¨ï¼‰</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># é¡¹ç›®4ï¼šå®ç°Manoptæ ¸å¿ƒåŠŸèƒ½</span>
<span class="c1"># - è¶…çƒé¢ã€Stiefelæµå½¢çš„åŸºæœ¬æ“ä½œ</span>
<span class="c1"># - retractionã€å‘é‡ä¼ è¾“</span>
<span class="c1"># - ä¸PyTorché›†æˆ</span>

<span class="c1"># é¡¹ç›®5ï¼šè°±å½’ä¸€åŒ–GAN</span>
<span class="c1"># - åœ¨CIFAR-10ä¸Šè®­ç»ƒSNGAN</span>
<span class="c1"># - åˆ†æLipschitzçº¦æŸçš„æ•ˆæœ</span>
<span class="c1"># - å¯è§†åŒ–åˆ¤åˆ«å™¨è°±èŒƒæ•°å˜åŒ–</span>

<span class="c1"># é¡¹ç›®6ï¼šè‡ªç„¶æ¢¯åº¦è¿‘ä¼¼</span>
<span class="c1"># - å®ç°K-FAC</span>
<span class="c1"># - å¯¹æ¯”SGDã€Adamã€K-FACæ”¶æ•›é€Ÿåº¦</span>
<span class="c1"># - åˆ†æè®¡ç®—å¼€é”€</span>
</code></pre></div>

<p><strong>é«˜çº§å®è·µï¼ˆ1-2ä¸ªæœˆï¼‰</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># é¡¹ç›®7ï¼šRiemannian Adam</span>
<span class="c1"># - è®¾è®¡å¹¶å®ç°RAdamä¼˜åŒ–å™¨</span>
<span class="c1"># - åœ¨å¤§è§„æ¨¡ä»»åŠ¡ï¼ˆImageNetï¼‰ä¸ŠéªŒè¯</span>
<span class="c1"># - å‘è¡¨æŠ€æœ¯æŠ¥å‘Š</span>

<span class="c1"># é¡¹ç›®8ï¼šå¤šæµå½¢ä¼˜åŒ–</span>
<span class="c1"># - ç»“åˆè¶…çƒé¢+SPDæµå½¢çº¦æŸ</span>
<span class="c1"># - åº”ç”¨äºå…ƒå­¦ä¹ æˆ–è¿ç§»å­¦ä¹ </span>
<span class="c1"># - ç†è®ºåˆ†æä¸å®éªŒéªŒè¯</span>
</code></pre></div>

<h3 id="52">5.2 ç ”ç©¶ç©ºç™½ä¸æœªæ¥æ–¹å‘</h3>
<h4 id="1-">æ–¹å‘1ï¼šç†è®ºå±‚é¢ - éå‡¸æµå½¢ä¼˜åŒ–çš„æ”¶æ•›æ€§ä¿è¯</h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- è¶…çƒé¢ä¼˜åŒ–çš„å…¨å±€æ”¶æ•›æ€§ç†è®ºä¸å®Œå–„ï¼Œå°¤å…¶æ˜¯éå‡¸ç›®æ ‡å‡½æ•°
- é»æ›¼æ¢¯åº¦ä¸‹é™çš„æ ·æœ¬å¤æ‚åº¦æœªçŸ¥ï¼šéœ€è¦å¤šå°‘æ ·æœ¬æ‰èƒ½è¾¾åˆ° $\epsilon$-æ¬¡ä¼˜è§£ï¼Ÿ
- æµå½¢æ›²ç‡ä¸æ”¶æ•›é€Ÿç‡çš„å®šé‡å…³ç³»ä¸æ˜ç¡®</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<p><strong>é—®é¢˜1</strong>ï¼šè¶…çƒé¢ä¸Šéå‡¸ä¼˜åŒ–çš„é€ƒé€¸éç‚¹æœºåˆ¶ï¼Ÿ</p>
<ul>
<li><strong>æŒ‘æˆ˜</strong>ï¼šæ¬§æ°ç©ºé—´çš„é€ƒé€¸éç‚¹ç†è®ºï¼ˆå¦‚Perturbed GDï¼‰ä¸ç›´æ¥æ¨å¹¿åˆ°æµå½¢</li>
<li>æµå½¢ä¸Šçš„Hessianï¼ˆé»æ›¼Hessianï¼‰å®šä¹‰æ›´å¤æ‚</li>
<li>éç‚¹é™„è¿‘çš„ç¨³å®š/ä¸ç¨³å®šæµå½¢å‡ ä½•ä¸æ˜ç¡®</li>
<li><strong>æ½œåœ¨æ–¹æ³•</strong>ï¼š</li>
<li>åˆ©ç”¨Morseç†è®ºåˆ†æä¸´ç•Œç‚¹ç»“æ„</li>
<li>ç ”ç©¶é»æ›¼Hessiançš„è°±æ€§è´¨</li>
<li>è®¾è®¡æµå½¢ä¸Šçš„å™ªå£°æ³¨å…¥ç­–ç•¥</li>
<li><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼š</li>
<li>ç†è®ºä¿è¯ç¥ç»ç½‘ç»œè®­ç»ƒæ”¶æ•›åˆ°"å¥½"çš„å±€éƒ¨æœ€ä¼˜</li>
<li>æŒ‡å¯¼å­¦ä¹ ç‡å’ŒåŠ¨é‡çš„é€‰æ‹©</li>
</ul>
<p><strong>é—®é¢˜2</strong>ï¼šé»æ›¼æ¢¯åº¦ä¸‹é™çš„æ ·æœ¬å¤æ‚åº¦ä¸‹ç•Œï¼Ÿ</p>
<ul>
<li><strong>å·²çŸ¥</strong>ï¼šæ¬§æ°SGDåœ¨å¼ºå‡¸æƒ…å†µä¸‹éœ€è¦ $O(\epsilon^{-1})$ æ ·æœ¬è¾¾åˆ° $\epsilon$ è¯¯å·®</li>
<li><strong>æœªçŸ¥</strong>ï¼šè¶…çƒé¢çº¦æŸæ˜¯å¦æ”¹å˜æ ·æœ¬å¤æ‚åº¦ï¼Ÿ</li>
<li>çº¦æŸæ˜¯å¦æä¾›äº†"éšå¼æ­£åˆ™åŒ–"ï¼Ÿ</li>
<li>æ˜¯å¦å­˜åœ¨æµå½¢ç‰¹å®šçš„ä¸‹ç•Œï¼Ÿ</li>
<li><strong>æ½œåœ¨æ–¹æ³•</strong>ï¼š</li>
<li>ä¿¡æ¯è®ºä¸‹ç•Œï¼šåŸºäºæµå½¢æµ‹åœ°çº¿çš„äº’ä¿¡æ¯</li>
<li>PACå­¦ä¹ æ¡†æ¶æ‰©å±•åˆ°æµå½¢</li>
<li><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼š</li>
<li>ç†è®ºæŒ‡å¯¼å°æ ·æœ¬å­¦ä¹ </li>
<li>è®¾è®¡æ ·æœ¬é«˜æ•ˆçš„æµå½¢ä¼˜åŒ–ç®—æ³•</li>
</ul>
<p><strong>é—®é¢˜3</strong>ï¼šæ›²ç‡å¯¹æ”¶æ•›é€Ÿåº¦çš„å½±å“ï¼Ÿ</p>
<ul>
<li><strong>ç°çŠ¶</strong>ï¼šæ­£æ›²ç‡æµå½¢ï¼ˆå¦‚è¶…çƒé¢ï¼‰çš„æ”¶æ•›æ€§åˆ†æå°‘äºè´Ÿæ›²ç‡ï¼ˆåŒæ›²ç©ºé—´ï¼‰</li>
<li><strong>æ¢ç´¢æ–¹å‘</strong>ï¼š</li>
<li>æ¨å¯¼æ›²ç‡ä¾èµ–çš„æ”¶æ•›ç‡ï¼š$O(1/\sqrt{KT})$ å…¶ä¸­ $K$ æ˜¯æ›²ç‡</li>
<li>åˆ†æé«˜æ›²ç‡åŒºåŸŸçš„ä¼˜åŒ–è¡Œä¸º</li>
<li>è®¾è®¡æ›²ç‡è‡ªé€‚åº”å­¦ä¹ ç‡</li>
<li><strong>ç†è®ºå·¥å…·</strong>ï¼šæ¯”è¾ƒå®šç†ï¼ˆRauchæ¯”è¾ƒå®šç†ï¼‰ã€Jacobiåœºåˆ†æ</li>
</ul>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å»ºç«‹æµå½¢ä¸Šçš„"é€ƒé€¸æ—¶é—´"ç†è®º
- æ¨å¯¼æ›²ç‡æ•æ„Ÿçš„æ”¶æ•›ç•Œ
- å‘å±•æµå½¢ä¸Šçš„åŠ é€Ÿæ–¹æ³•ï¼ˆç±»ä¼¼NesterovåŠ¨é‡ï¼‰</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- è¯æ˜è¶…çƒé¢SGDåœ¨å‡è®¾ä¸‹çš„ $O(1/\sqrt{T})$ æ”¶æ•›ç‡ï¼ˆéå‡¸æƒ…å†µï¼‰
- å»ºç«‹æ ·æœ¬å¤æ‚åº¦ä¸‹ç•Œï¼š$\Omega(d/\epsilon^2)$ï¼ˆ$d$ æ˜¯æµå½¢ç»´åº¦ï¼‰
- æ¨å¯¼æ›²ç‡ä¾èµ–ç•Œï¼šæ”¶æ•›å¸¸æ•° $\leq C(K) \cdot \text{poly}(d, \epsilon^{-1})$</p>
<hr />
<h4 id="2-">æ–¹å‘2ï¼šç®—æ³•å±‚é¢ - æµå½¢ä¸Šçš„è‡ªé€‚åº”ä¸äºŒé˜¶æ–¹æ³•</h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- ç¼ºä¹ç†è®ºå®Œå¤‡çš„æµå½¢Adam/AdaGrad
- æµå½¢ä¸Šçš„äºŒé˜¶æ–¹æ³•ï¼ˆç‰›é¡¿æ³•ã€æ‹Ÿç‰›é¡¿æ³•ï¼‰è®¡ç®—æˆæœ¬é«˜æ˜‚
- å¤šæµå½¢è€¦åˆä¼˜åŒ–ç¼ºä¹ç»Ÿä¸€æ¡†æ¶</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<p><strong>é—®é¢˜1</strong>ï¼šå¦‚ä½•è®¾è®¡ç†è®ºä¸¥è°¨çš„Riemannian Adamï¼Ÿ</p>
<ul>
<li><strong>æŒ‘æˆ˜</strong>ï¼š</li>
<li>ä¸€é˜¶çŸ© $\boldsymbol{m}_t$ å’ŒäºŒé˜¶çŸ© $\boldsymbol{v}_t$ åœ¨ä¸åŒåˆ‡ç©ºé—´ï¼Œå¦‚ä½•ä¼ è¾“ï¼Ÿ</li>
<li>ç°æœ‰æ–¹æ³•ï¼ˆç®€å•æŠ•å½±ï¼‰ç¼ºä¹ç†è®ºä¿è¯</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</li>
<li><strong>å¹³è¡Œç§»åŠ¨</strong>ï¼šä½¿ç”¨æµå½¢çš„è”ç»œç²¾ç¡®ä¼ è¾“åŠ¨é‡
    $$
    \boldsymbol{m}_t = \mathcal{T}_{t-1\to t}(\beta_1 \boldsymbol{m}_{t-1}) + (1-\beta_1)\text{grad} f(\boldsymbol{w}_t)
    $$</li>
<li><strong>å‘é‡ä¼ è¾“</strong>ï¼šè®¾è®¡è®¡ç®—é«˜æ•ˆçš„è¿‘ä¼¼ä¼ è¾“ç®—å­</li>
<li><strong>è‡ªé€‚åº”åº¦é‡</strong>ï¼šæ ¹æ®äºŒé˜¶çŸ©è°ƒæ•´é»æ›¼åº¦é‡</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š</li>
<li>è¯æ˜RAdamçš„æ”¶æ•›ç‡ $O(1/\sqrt{T})$ï¼ˆåŒ¹é…Adamï¼‰</li>
<li>å®éªŒéªŒè¯ï¼šåœ¨ImageNetä¸Šæ¯”SGDå¿« $30\%$ï¼Œæ¯”Adamç¨³å®š</li>
</ul>
<p><strong>é—®é¢˜2</strong>ï¼šæµå½¢ä¸Šçš„æ‹Ÿç‰›é¡¿æ³•èƒ½å¦å®ç”¨åŒ–ï¼Ÿ</p>
<ul>
<li><strong>ç°æœ‰æ–¹æ¡ˆ</strong>ï¼šL-BFGSåœ¨æ¬§æ°ç©ºé—´æˆåŠŸï¼Œä½†æµå½¢ç‰ˆæœ¬ï¼ˆR-LBFGSï¼‰è®¡ç®—æ˜‚è´µ</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</li>
<li><strong>ä½ç§©Hessianè¿‘ä¼¼</strong>ï¼šåˆ©ç”¨æµå½¢ç»“æ„ç¨€ç–æ€§</li>
<li><strong>å¯¹è§’è¿‘ä¼¼</strong>ï¼šåªå­˜å‚¨ä¸»å¯¹è§’çº¿ï¼ˆ$O(n)$ å­˜å‚¨ï¼‰</li>
<li><strong>åˆ†å—æ›´æ–°</strong>ï¼šå¯¹ç¥ç»ç½‘ç»œçš„ä¸åŒå±‚ä½¿ç”¨ä¸åŒæ›²ç‡ä¼°è®¡</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š</li>
<li>å­˜å‚¨é™è‡³ $O(n\log T)$ï¼ˆå½“å‰ $O(nT)$ï¼‰</li>
<li>æ¯æ­¥è®¡ç®—ä» $O(n^2)$ é™è‡³ $O(n\log n)$</li>
</ul>
<p><strong>é—®é¢˜3</strong>ï¼šå¤šæµå½¢äº§å“ä¼˜åŒ–ï¼Ÿ</p>
<ul>
<li><strong>åœºæ™¯</strong>ï¼šç¥ç»ç½‘ç»œä¸åŒå±‚æœ‰ä¸åŒçº¦æŸ</li>
<li>ç¬¬1å±‚ï¼šè¶…çƒé¢çº¦æŸï¼ˆæƒé‡å½’ä¸€åŒ–ï¼‰</li>
<li>ç¬¬2å±‚ï¼šStiefelæµå½¢çº¦æŸï¼ˆæ­£äº¤æƒé‡ï¼‰</li>
<li>ç¬¬3å±‚ï¼šSPDæµå½¢çº¦æŸï¼ˆåæ–¹å·®çŸ©é˜µï¼‰</li>
<li><strong>æŒ‘æˆ˜</strong>ï¼š</li>
<li>ä¸åŒæµå½¢çš„retractionä¸å…¼å®¹</li>
<li>å¦‚ä½•åè°ƒä¸åŒæµå½¢çš„æ­¥é•¿ï¼Ÿ</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</li>
<li>ç§¯æµå½¢ï¼ˆProduct Manifoldï¼‰ç†è®º</li>
<li>äº¤æ›¿ä¼˜åŒ– vs è”åˆä¼˜åŒ–</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š</li>
<li>è®¾è®¡ç»Ÿä¸€æ¡†æ¶ï¼Œæ”¯æŒ $\geq 3$ ç§å¸¸è§æµå½¢</li>
<li>æ”¶æ•›é€Ÿåº¦ä¸åŠ£äºå•ç‹¬ä¼˜åŒ–</li>
</ul>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å‘å±•å¹³è¡Œç§»åŠ¨çš„å¿«é€Ÿè¿‘ä¼¼ç®—æ³•
- è®¾è®¡æµå½¢æ„ŸçŸ¥çš„å­¦ä¹ ç‡è°ƒåº¦
- æ„å»ºå¤šæµå½¢ä¼˜åŒ–å·¥å…·ç®±</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- RAdamåœ¨BERTé¢„è®­ç»ƒä¸Šæ¯”Adamå¿« $20\%$
- R-LBFGSåœ¨å°æ‰¹é‡è®¾ç½®ä¸‹å¯è¡Œï¼ˆæ‰¹é‡ $\geq 1024$ï¼‰
- å¤šæµå½¢æ¡†æ¶åœ¨å¤šä»»åŠ¡å­¦ä¹ ä¸Šæå‡ $10\%$ æ€§èƒ½</p>
<hr />
<h4 id="3-">æ–¹å‘3ï¼šåº”ç”¨å±‚é¢ - æ·±åº¦å­¦ä¹ ä¸ç”Ÿæˆæ¨¡å‹</h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- çƒé¢åµŒå…¥åœ¨å¤§è§„æ¨¡æ¨¡å‹ï¼ˆå¦‚LLMï¼‰ä¸­çš„åº”ç”¨ä¸è¶³
- æµå½¢çº¦æŸå¯¹æŠ—è®­ç»ƒï¼ˆGANï¼‰çš„ç†è®ºåŸºç¡€è–„å¼±
- æ‰©æ•£æ¨¡å‹åœ¨éæ¬§ç©ºé—´ï¼ˆè¶…çƒé¢ã€åŒæ›²ç©ºé—´ï¼‰çš„æ‰©å±•ä¸æˆç†Ÿ</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<p><strong>é—®é¢˜1</strong>ï¼šçƒé¢åµŒå…¥èƒ½å¦æ”¹å–„å¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ï¼Ÿ</p>
<ul>
<li><strong>åŠ¨æœº</strong>ï¼š</li>
<li>TokenåµŒå…¥ã€ä½ç½®ç¼–ç å¯ä»¥å½’ä¸€åŒ–åˆ°è¶…çƒé¢</li>
<li>è§’åº¦è·ç¦»å¯èƒ½æ¯”æ¬§æ°è·ç¦»æ›´é€‚åˆè¯­ä¹‰ç›¸ä¼¼æ€§</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</li>
<li>è®¾è®¡çƒé¢æ³¨æ„åŠ›æœºåˆ¶ï¼š
    $$
    \text{Attention}(\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}) = \text{softmax}(\langle\boldsymbol{Q}, \boldsymbol{K}\rangle)\boldsymbol{V}
    $$
    å…¶ä¸­ $\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V} \in \mathcal{S}^{d-1}$</li>
<li>çƒé¢Transformerï¼šæ‰€æœ‰æƒé‡çŸ©é˜µåˆ—å½’ä¸€åŒ–</li>
<li>ç†è®ºåˆ†æï¼šçƒé¢åµŒå…¥çš„è¡¨è¾¾èƒ½åŠ›</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š</li>
<li>åœ¨é—®ç­”ä»»åŠ¡ä¸Šè¶…è¶Šæ ‡å‡†Transformer $2\%$</li>
<li>å‚æ•°æ•ˆç‡æå‡ï¼šç›¸åŒæ€§èƒ½ä¸‹å‚æ•°å‡å°‘ $20\%$</li>
</ul>
<p><strong>é—®é¢˜2</strong>ï¼šæµå½¢GANçš„ç¨³å®šæ€§ç†è®ºï¼Ÿ</p>
<ul>
<li><strong>ç°æœ‰é—®é¢˜</strong>ï¼šGANè®­ç»ƒä¸ç¨³å®šï¼Œæ¨¡å¼å´©æºƒ</li>
<li><strong>æµå½¢è§†è§’</strong>ï¼š</li>
<li>åˆ¤åˆ«å™¨Lipschitzçº¦æŸ = Stiefelæµå½¢çº¦æŸ</li>
<li>ç”Ÿæˆå™¨å¯ä»¥åœ¨éšç©ºé—´æµå½¢ä¸Šä¼˜åŒ–</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</li>
<li>æ¨å¯¼æµå½¢GANçš„Nashå‡è¡¡å­˜åœ¨æ€§</li>
<li>åˆ†æWassersteinè·ç¦»åœ¨æµå½¢ä¸Šçš„æ€§è´¨</li>
<li>è®¾è®¡æµå½¢æ­£åˆ™åŒ–æŸå¤±</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š</li>
<li>è®­ç»ƒå´©æºƒç‡é™ä½ $50\%$</li>
<li>FIDåˆ†æ•°æå‡ $15\%$ï¼ˆCIFAR-10/ImageNetï¼‰</li>
</ul>
<p><strong>é—®é¢˜3</strong>ï¼šè¶…çƒé¢ä¸Šçš„æ‰©æ•£æ¨¡å‹ï¼Ÿ</p>
<ul>
<li><strong>åŠ¨æœº</strong>ï¼š</li>
<li>æ–¹å‘æ•°æ®ï¼ˆ3Dæ—‹è½¬ã€çƒé¢å›¾åƒï¼‰å¤©ç„¶åœ¨è¶…çƒé¢ä¸Š</li>
<li>æ¬§æ°æ‰©æ•£æ¨¡å‹åº”ç”¨äºçƒé¢æ•°æ®æ—¶è¿åå‡ ä½•</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</li>
<li><strong>çƒé¢æ‰©æ•£è¿‡ç¨‹</strong>ï¼š
    $$
    d\boldsymbol{x}_t = -\frac{1}{2}\|\nabla\log p_t(\boldsymbol{x}_t)\|^2 \boldsymbol{x}_t dt + \text{Brownian motion on } \mathcal{S}^{n-1}
    $$</li>
<li><strong>å¾—åˆ†å‡½æ•°çš„é»æ›¼ç‰ˆæœ¬</strong>ï¼š
    $$
    \boldsymbol{s}_{\theta}(\boldsymbol{x}_t, t) = \text{grad}\log p_t(\boldsymbol{x}_t)
    $$</li>
<li><strong>é€†å‘é‡‡æ ·</strong>ï¼šæ²¿æµ‹åœ°çº¿ç§»åŠ¨è€Œéæ¬§æ°ç›´çº¿</li>
<li><strong>ç†è®ºæŒ‘æˆ˜</strong>ï¼š</li>
<li>è¶…çƒé¢ä¸Šçš„å¸ƒæœ—è¿åŠ¨å®šä¹‰</li>
<li>å¾—åˆ†åŒ¹é…æŸå¤±çš„é»æ›¼æ¨å¹¿</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š</li>
<li>åœ¨æ–¹å‘æ•°æ®ä¸Šç”Ÿæˆè´¨é‡æå‡ $20\%$</li>
<li>æ”¯æŒ $SO(3)$ã€$\mathcal{S}^{1023}$ï¼ˆé«˜ç»´çƒé¢ï¼‰ç­‰æµå½¢</li>
</ul>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å‘å±•çƒé¢Transformeræ¶æ„
- å»ºç«‹æµå½¢GANçš„åšå¼ˆè®ºåŸºç¡€
- å®ç°é«˜ç»´æµå½¢ä¸Šçš„æ‰©æ•£æ¨¡å‹</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- çƒé¢BERTåœ¨GLUEä¸Šè¶…è¶Šæ ‡å‡†BERT $1.5$ åˆ†
- æµå½¢GANåœ¨CelebA-HQä¸ŠFID &lt; 5.0
- çƒé¢æ‰©æ•£æ¨¡å‹åœ¨å…¨æ™¯å›¾åƒç”Ÿæˆä¸Šè¶…è¶Šå¹³é¢æ¨¡å‹ $10\%$ï¼ˆLPIPSæŒ‡æ ‡ï¼‰</p>
<p><strong>æ½œåœ¨åº”ç”¨åœºæ™¯</strong>ï¼š
- <strong>è‡ªç„¶è¯­è¨€å¤„ç†</strong>ï¼šè¯åµŒå…¥ã€è·¨è¯­è¨€å¯¹é½
- <strong>è®¡ç®—æœºè§†è§‰</strong>ï¼šå…¨æ™¯è§†è§‰ã€3Dæ—‹è½¬ä¼°è®¡
- <strong>æ¨èç³»ç»Ÿ</strong>ï¼šç”¨æˆ·-ç‰©å“åµŒå…¥åœ¨è¶…çƒé¢
- <strong>ç”Ÿç‰©ä¿¡æ¯å­¦</strong>ï¼šè›‹ç™½è´¨æ„è±¡ç©ºé—´ï¼ˆSO(3)æµå½¢ï¼‰
- <strong>å¤©æ–‡å­¦</strong>ï¼šå¤©çƒæ•°æ®åˆ†æï¼ˆ$\mathcal{S}^2$ï¼‰</p>
<hr />
<h3 id="53">5.3 å¼€æºå·¥å…·ä¸ç¤¾åŒºèµ„æº</h3>
<p><strong>ä¸»æµæµå½¢ä¼˜åŒ–åº“</strong>ï¼š</p>
<ol>
<li><strong>Geoopt</strong> (PyTorch)</li>
<li>é“¾æ¥ï¼š<a href="https://github.com/geoopt/geoopt">https://github.com/geoopt/geoopt</a></li>
<li>æ”¯æŒæµå½¢ï¼šè¶…çƒé¢ã€åŒæ›²ç©ºé—´ã€Stiefelã€Grassmannã€SPD</li>
<li>ä¸PyTorchæ— ç¼é›†æˆ</li>
<li>
<p><strong>æ¨èåº¦</strong>ï¼šâ­â­â­â­â­</p>
</li>
<li>
<p><strong>Manopt</strong> (MATLAB/Python)</p>
</li>
<li>é“¾æ¥ï¼š<a href="https://www.manopt.org/">https://www.manopt.org/</a></li>
<li>æœ€æˆç†Ÿçš„æµå½¢ä¼˜åŒ–å·¥å…·ç®±</li>
<li>Pythonç‰ˆæœ¬ï¼šPymanopt</li>
<li>
<p><strong>æ¨èåº¦</strong>ï¼šâ­â­â­â­</p>
</li>
<li>
<p><strong>JAXopt</strong></p>
</li>
<li>é“¾æ¥ï¼š<a href="https://github.com/google/jaxopt">https://github.com/google/jaxopt</a></li>
<li>JAXç”Ÿæ€ï¼Œæ”¯æŒJITç¼–è¯‘</li>
<li>æµå½¢ä¼˜åŒ–æ¨¡å—è¾ƒæ–°</li>
<li><strong>æ¨èåº¦</strong>ï¼šâ­â­â­</li>
</ol>
<p><strong>å­¦ä¹ èµ„æº</strong>ï¼š</p>
<ul>
<li><strong>åœ¨çº¿è¯¾ç¨‹</strong>ï¼š</li>
<li>Boumalçš„æµå½¢ä¼˜åŒ–è¯¾ç¨‹ï¼ˆå…è´¹è§†é¢‘ï¼‰</li>
<li>
<p>Stanford EE364bï¼ˆå‡¸ä¼˜åŒ–è¿›é˜¶ï¼‰</p>
</li>
<li>
<p><strong>åšå®¢ä¸æ•™ç¨‹</strong>ï¼š</p>
</li>
<li><a href="https://geoopt.readthedocs.io/">Riemannian Optimization in PyTorch</a></li>
<li>
<p><a href="https://www.nicolasboumal.net/book/">æµå½¢ä¼˜åŒ–å¯¼è®º</a></p>
</li>
<li>
<p><strong>è®ºæ–‡é˜…è¯»ç»„</strong>ï¼š</p>
</li>
<li>Manifold Learning Study Groupï¼ˆæ¯æœˆè®¨è®ºä¼šï¼‰</li>
</ul>
<hr />
<h2 id="_17">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚å°†ä»å¾®åˆ†å‡ ä½•ã€é»æ›¼ä¼˜åŒ–å’Œæ·±åº¦å­¦ä¹ ä¸‰ä¸ªè§’åº¦ï¼Œä¸ºè¶…çƒé¢ä¸Šçš„æœ€é€Ÿä¸‹é™æä¾›æè¯¦ç»†çš„æ•°å­¦æ¨å¯¼ã€‚</p>
<h3 id="1_2">1. è¶…çƒé¢çš„å¾®åˆ†å‡ ä½•åŸºç¡€</h3>
<h4 id="11_1">1.1 è¶…çƒé¢çš„å®šä¹‰</h4>
<p><strong>å®šä¹‰ 1.1ï¼ˆè¶…çƒé¢æµå½¢ï¼‰</strong>ï¼š$n$ç»´å•ä½è¶…çƒé¢å®šä¹‰ä¸ºï¼š
$$
\mathcal{S}^{n-1} = \{\boldsymbol{w} \in \mathbb{R}^n : \|\boldsymbol{w}\|_2 = 1\} = \{\boldsymbol{w} \in \mathbb{R}^n : \langle\boldsymbol{w}, \boldsymbol{w}\rangle = 1\}
$$</p>
<p>è¿™æ˜¯ä¸€ä¸ª$(n-1)$ç»´çš„åµŒå…¥å­æµå½¢ï¼ŒåµŒå…¥åœ¨$n$ç»´æ¬§æ°ç©ºé—´$\mathbb{R}^n$ä¸­ã€‚</p>
<p><strong>æ€§è´¨</strong>ï¼š
- $\mathcal{S}^{n-1}$æ˜¯ç´§è‡´çš„ï¼ˆæœ‰ç•Œä¸”é—­åˆï¼‰
- $\mathcal{S}^{n-1}$æ˜¯å…‰æ»‘çš„ï¼ˆæ— å¤„ä¸å¯å¾®ï¼‰
- $\mathcal{S}^{n-1}$å…·æœ‰æ’å®šçš„æ­£æ›²ç‡$K = 1$</p>
<p><strong>ä¾‹å­</strong>ï¼š
- $\mathcal{S}^1$ï¼šå•ä½åœ†ï¼ˆ1ç»´æµå½¢åœ¨$\mathbb{R}^2$ä¸­ï¼‰
- $\mathcal{S}^2$ï¼šå•ä½çƒé¢ï¼ˆ2ç»´æµå½¢åœ¨$\mathbb{R}^3$ä¸­ï¼‰
- ç¥ç»ç½‘ç»œä¸­ï¼šæƒé‡å½’ä¸€åŒ–å±‚çš„å‚æ•°ç©ºé—´</p>
<h4 id="12-tangent-space">1.2 åˆ‡ç©ºé—´ï¼ˆTangent Spaceï¼‰</h4>
<p><strong>å®šä¹‰ 1.2ï¼ˆåˆ‡ç©ºé—´ï¼‰</strong>ï¼šåœ¨ç‚¹$\boldsymbol{w} \in \mathcal{S}^{n-1}$å¤„çš„åˆ‡ç©ºé—´$T_{\boldsymbol{w}}\mathcal{S}^{n-1}$å®šä¹‰ä¸ºï¼š
$$
T_{\boldsymbol{w}}\mathcal{S}^{n-1} = \{\boldsymbol{v} \in \mathbb{R}^n : \langle\boldsymbol{v}, \boldsymbol{w}\rangle = 0\}
$$</p>
<p><strong>æ¨å¯¼</strong>ï¼šè®¾$\gamma(t)$æ˜¯$\mathcal{S}^{n-1}$ä¸Šç»è¿‡$\boldsymbol{w}$çš„ä»»æ„å…‰æ»‘æ›²çº¿ï¼Œæ»¡è¶³$\gamma(0) = \boldsymbol{w}$ã€‚ç”±äºæ›²çº¿å§‹ç»ˆåœ¨çƒé¢ä¸Šï¼Œæœ‰ï¼š
$$
\|\gamma(t)\|_2^2 = \langle\gamma(t), \gamma(t)\rangle = 1, \quad \forall t
$$</p>
<p>å¯¹$t$æ±‚å¯¼ï¼š
$$
\frac{d}{dt}\langle\gamma(t), \gamma(t)\rangle = 2\langle\gamma'(t), \gamma(t)\rangle = 0
$$</p>
<p>åœ¨$t=0$å¤„å–å€¼ï¼š
$$
\langle\gamma'(0), \gamma(0)\rangle = \langle\gamma'(0), \boldsymbol{w}\rangle = 0
$$</p>
<p>è¿™è¡¨æ˜æ›²çº¿çš„åˆ‡å‘é‡$\gamma'(0)$ä¸ä½ç½®å‘é‡$\boldsymbol{w}$æ­£äº¤ã€‚æ‰€æœ‰è¿™æ ·çš„åˆ‡å‘é‡æ„æˆåˆ‡ç©ºé—´ã€‚</p>
<p><strong>å‡ ä½•æ„ä¹‰</strong>ï¼šåˆ‡ç©ºé—´æ˜¯ä¸çƒé¢åœ¨$\boldsymbol{w}$ç‚¹ç›¸åˆ‡çš„$(n-1)$ç»´è¶…å¹³é¢ã€‚</p>
<p><strong>ç»´åº¦éªŒè¯</strong>ï¼š
$$
\dim(T_{\boldsymbol{w}}\mathcal{S}^{n-1}) = \dim(\{\boldsymbol{v} : \langle\boldsymbol{v}, \boldsymbol{w}\rangle = 0\}) = n - 1
$$
è¿™ä¸æµå½¢çš„ç»´åº¦ä¸€è‡´ã€‚</p>
<h4 id="13-normal-space">1.3 æ³•ç©ºé—´ï¼ˆNormal Spaceï¼‰</h4>
<p><strong>å®šä¹‰ 1.3ï¼ˆæ³•ç©ºé—´ï¼‰</strong>ï¼šåœ¨ç‚¹$\boldsymbol{w} \in \mathcal{S}^{n-1}$å¤„çš„æ³•ç©ºé—´$N_{\boldsymbol{w}}\mathcal{S}^{n-1}$å®šä¹‰ä¸ºï¼š
$$
N_{\boldsymbol{w}}\mathcal{S}^{n-1} = \{\alpha\boldsymbol{w} : \alpha \in \mathbb{R}\} = \text{span}\{\boldsymbol{w}\}
$$</p>
<p><strong>æ­£äº¤åˆ†è§£å®šç†</strong>ï¼šç¯å¢ƒç©ºé—´$\mathbb{R}^n$å¯ä»¥æ­£äº¤åˆ†è§£ä¸ºåˆ‡ç©ºé—´å’Œæ³•ç©ºé—´ï¼š
$$
\mathbb{R}^n = T_{\boldsymbol{w}}\mathcal{S}^{n-1} \oplus N_{\boldsymbol{w}}\mathcal{S}^{n-1}
$$</p>
<p>ä»»æ„å‘é‡$\boldsymbol{v} \in \mathbb{R}^n$å¯å”¯ä¸€åˆ†è§£ä¸ºï¼š
$$
\boldsymbol{v} = \boldsymbol{v}_{\text{tan}} + \boldsymbol{v}_{\text{nor}}
$$
å…¶ä¸­ï¼š
- åˆ‡å‘åˆ†é‡ï¼š$\boldsymbol{v}<em _boldsymbol_w="\boldsymbol{w">{\text{tan}} = \boldsymbol{v} - \langle\boldsymbol{v}, \boldsymbol{w}\rangle\boldsymbol{w} \in T</em>$
- æ³•å‘åˆ†é‡ï¼š$\boldsymbol{v}}}\mathcal{S}^{n-1<em _boldsymbol_w="\boldsymbol{w">{\text{nor}} = \langle\boldsymbol{v}, \boldsymbol{w}\rangle\boldsymbol{w} \in N</em>$}}\mathcal{S}^{n-1</p>
<p><strong>éªŒè¯æ­£äº¤æ€§</strong>ï¼š
$$
\langle\boldsymbol{v}_{\text{tan}}, \boldsymbol{v}_{\text{nor}}\rangle = \langle\boldsymbol{v} - \langle\boldsymbol{v}, \boldsymbol{w}\rangle\boldsymbol{w}, \langle\boldsymbol{v}, \boldsymbol{w}\rangle\boldsymbol{w}\rangle = \langle\boldsymbol{v}, \boldsymbol{w}\rangle\langle\boldsymbol{v}, \boldsymbol{w}\rangle - \langle\boldsymbol{v}, \boldsymbol{w}\rangle^2\langle\boldsymbol{w}, \boldsymbol{w}\rangle = 0
$$</p>
<h4 id="14-projection-operator">1.4 æŠ•å½±ç®—å­ï¼ˆProjection Operatorï¼‰</h4>
<p><strong>å®šä¹‰ 1.4ï¼ˆåˆ‡ç©ºé—´æŠ•å½±ï¼‰</strong>ï¼šæŠ•å½±åˆ°åˆ‡ç©ºé—´çš„ç®—å­$\mathcal{P}<em _boldsymbol_w="\boldsymbol{w">{\boldsymbol{w}}: \mathbb{R}^n \to T</em>$å®šä¹‰ä¸ºï¼š
$$
\mathcal{P}_{\boldsymbol{w}}(\boldsymbol{v}) = \boldsymbol{v} - \langle\boldsymbol{v}, \boldsymbol{w}\rangle\boldsymbol{w} = (\boldsymbol{I} - \boldsymbol{w}\boldsymbol{w}^{\top})\boldsymbol{v}
$$}}\mathcal{S}^{n-1</p>
<p>å…¶ä¸­$\boldsymbol{I}$æ˜¯$n \times n$å•ä½çŸ©é˜µï¼Œ$\boldsymbol{w}\boldsymbol{w}^{\top}$æ˜¯ç§©1æŠ•å½±çŸ©é˜µã€‚</p>
<p><strong>æŠ•å½±çŸ©é˜µæ€§è´¨</strong>ï¼šè®¾$\boldsymbol{P}_{\boldsymbol{w}} = \boldsymbol{I} - \boldsymbol{w}\boldsymbol{w}^{\top}$ï¼Œåˆ™ï¼š</p>
<ol>
<li>
<p><strong>å¹‚ç­‰æ€§</strong>ï¼ˆæŠ•å½±ä¸¤æ¬¡ç­‰äºæŠ•å½±ä¸€æ¬¡ï¼‰ï¼š
$$
\boldsymbol{P}_{\boldsymbol{w}}^2 = (\boldsymbol{I} - \boldsymbol{w}\boldsymbol{w}^{\top})^2 = \boldsymbol{I} - 2\boldsymbol{w}\boldsymbol{w}^{\top} + \boldsymbol{w}\boldsymbol{w}^{\top}\boldsymbol{w}\boldsymbol{w}^{\top} = \boldsymbol{I} - 2\boldsymbol{w}\boldsymbol{w}^{\top} + \boldsymbol{w}\boldsymbol{w}^{\top} = \boldsymbol{P}_{\boldsymbol{w}}
$$</p>
</li>
<li>
<p><strong>å¯¹ç§°æ€§</strong>ï¼š
$$
\boldsymbol{P}_{\boldsymbol{w}}^{\top} = (\boldsymbol{I} - \boldsymbol{w}\boldsymbol{w}^{\top})^{\top} = \boldsymbol{I} - \boldsymbol{w}\boldsymbol{w}^{\top} = \boldsymbol{P}_{\boldsymbol{w}}
$$</p>
</li>
<li>
<p><strong>æ­£äº¤æŠ•å½±</strong>ï¼š
$$
\langle\mathcal{P}_{\boldsymbol{w}}(\boldsymbol{v}), \boldsymbol{w}\rangle = \langle\boldsymbol{v} - \langle\boldsymbol{v}, \boldsymbol{w}\rangle\boldsymbol{w}, \boldsymbol{w}\rangle = \langle\boldsymbol{v}, \boldsymbol{w}\rangle - \langle\boldsymbol{v}, \boldsymbol{w}\rangle = 0
$$</p>
</li>
</ol>
<h3 id="2_1">2. é»æ›¼æ¢¯åº¦ä¸æŠ•å½±å…¬å¼</h3>
<h4 id="21">2.1 çº¦æŸä¼˜åŒ–é—®é¢˜çš„è®¾å®š</h4>
<p>è€ƒè™‘è¶…çƒé¢ä¸Šçš„çº¦æŸä¼˜åŒ–é—®é¢˜ï¼š
$$
\min_{\boldsymbol{w} \in \mathcal{S}^{n-1}} f(\boldsymbol{w})
$$</p>
<p>å…¶ä¸­$f: \mathbb{R}^n \to \mathbb{R}$æ˜¯å®šä¹‰åœ¨ç¯å¢ƒç©ºé—´ä¸Šçš„å…‰æ»‘ç›®æ ‡å‡½æ•°ã€‚</p>
<p><strong>æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•æ¨å¯¼</strong>ï¼šå¼•å…¥çº¦æŸ$g(\boldsymbol{w}) = |\boldsymbol{w}|^2 - 1 = 0$ï¼Œæ„é€ æ‹‰æ ¼æœ—æ—¥å‡½æ•°ï¼š
$$
\mathcal{L}(\boldsymbol{w}, \lambda) = f(\boldsymbol{w}) + \lambda(\|\boldsymbol{w}\|^2 - 1)
$$</p>
<p>æœ€ä¼˜æ€§æ¡ä»¶ï¼ˆKKTæ¡ä»¶ï¼‰ï¼š
$$
\nabla_{\boldsymbol{w}}\mathcal{L} = \nabla f(\boldsymbol{w}) + 2\lambda\boldsymbol{w} = \boldsymbol{0}
$$</p>
<p>è¿™è¡¨æ˜æ¬§æ°æ¢¯åº¦$\nabla f(\boldsymbol{w})$ä¸ä½ç½®å‘é‡$\boldsymbol{w}$å¹³è¡Œï¼Œå³æ¢¯åº¦åœ¨æ³•ç©ºé—´ä¸­ã€‚ä½†æˆ‘ä»¬éœ€è¦çš„æ˜¯åˆ‡ç©ºé—´ä¸­çš„æ¢¯åº¦æ–¹å‘ã€‚</p>
<h4 id="22">2.2 é»æ›¼æ¢¯åº¦çš„å®šä¹‰</h4>
<p><strong>å®šä¹‰ 2.1ï¼ˆé»æ›¼æ¢¯åº¦ï¼‰</strong>ï¼šåœ¨é»æ›¼æµå½¢$(\mathcal{M}, g)$ä¸Šï¼Œå‡½æ•°$f$åœ¨ç‚¹$\boldsymbol{w}$å¤„çš„é»æ›¼æ¢¯åº¦$\text{grad} f(\boldsymbol{w})$å®šä¹‰ä¸ºåˆ‡ç©ºé—´ä¸­å”¯ä¸€æ»¡è¶³ä»¥ä¸‹æ¡ä»¶çš„å‘é‡ï¼š
$$
g_{\boldsymbol{w}}(\text{grad} f(\boldsymbol{w}), \boldsymbol{\xi}) = Df(\boldsymbol{w})[\boldsymbol{\xi}], \quad \forall \boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{M}
$$</p>
<p>å…¶ä¸­$Df(\boldsymbol{w})[\boldsymbol{\xi}] = \langle\nabla f(\boldsymbol{w}), \boldsymbol{\xi}\rangle$æ˜¯$f$åœ¨$\boldsymbol{w}$å¤„æ²¿$\boldsymbol{\xi}$æ–¹å‘çš„æ–¹å‘å¯¼æ•°ã€‚</p>
<p><strong>å¯¹äºè¶…çƒé¢</strong>ï¼šè¶…çƒé¢ç»§æ‰¿äº†æ¬§æ°ç©ºé—´çš„é»æ›¼åº¦é‡ï¼Œå³$g_{\boldsymbol{w}}(\boldsymbol{\xi}, \boldsymbol{\eta}) = \langle\boldsymbol{\xi}, \boldsymbol{\eta}\rangle$ã€‚å› æ­¤ï¼š
$$
\langle\text{grad} f(\boldsymbol{w}), \boldsymbol{\xi}\rangle = \langle\nabla f(\boldsymbol{w}), \boldsymbol{\xi}\rangle, \quad \forall \boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}
$$</p>
<h4 id="23">2.3 é»æ›¼æ¢¯åº¦çš„æŠ•å½±å…¬å¼æ¨å¯¼</h4>
<p><strong>å®šç† 2.1</strong>ï¼šè¶…çƒé¢ä¸Šçš„é»æ›¼æ¢¯åº¦ä¸ºæ¬§æ°æ¢¯åº¦åœ¨åˆ‡ç©ºé—´ä¸Šçš„æŠ•å½±ï¼š
$$
\text{grad} f(\boldsymbol{w}) = \mathcal{P}_{\boldsymbol{w}}(\nabla f(\boldsymbol{w})) = \nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}
$$</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p><strong>æ­¥éª¤1</strong>ï¼šåˆ©ç”¨æ­£äº¤åˆ†è§£ï¼Œå°†æ¬§æ°æ¢¯åº¦åˆ†è§£ä¸ºï¼š
$$
\nabla f(\boldsymbol{w}) = \nabla f(\boldsymbol{w})_{\text{tan}} + \nabla f(\boldsymbol{w})_{\text{nor}}
$$
å…¶ä¸­ï¼š
$$
\nabla f(\boldsymbol{w})_{\text{tan}} = \nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}
$$
$$
\nabla f(\boldsymbol{w})_{\text{nor}} = \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w} \in N_{\boldsymbol{w}}\mathcal{S}^{n-1}
$$</p>
<p><strong>æ­¥éª¤2</strong>ï¼šå¯¹äºä»»æ„$\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}$ï¼Œè®¡ç®—å†…ç§¯ï¼š
$$
\langle\nabla f(\boldsymbol{w})_{\text{tan}}, \boldsymbol{\xi}\rangle = \langle\nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}, \boldsymbol{\xi}\rangle
$$
$$
= \langle\nabla f(\boldsymbol{w}), \boldsymbol{\xi}\rangle - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\langle\boldsymbol{w}, \boldsymbol{\xi}\rangle
$$</p>
<p>ç”±äº$\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}$ï¼Œæœ‰$\langle\boldsymbol{w}, \boldsymbol{\xi}\rangle = 0$ï¼Œå› æ­¤ï¼š
$$
\langle\nabla f(\boldsymbol{w})_{\text{tan}}, \boldsymbol{\xi}\rangle = \langle\nabla f(\boldsymbol{w}), \boldsymbol{\xi}\rangle = Df(\boldsymbol{w})[\boldsymbol{\xi}]
$$</p>
<p><strong>æ­¥éª¤3</strong>ï¼šç”±é»æ›¼æ¢¯åº¦çš„å®šä¹‰å’Œå”¯ä¸€æ€§ï¼Œå¾—ï¼š
$$
\text{grad} f(\boldsymbol{w}) = \nabla f(\boldsymbol{w})_{\text{tan}} = \nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}
$$</p>
<p><strong>å‡ ä½•è§£é‡Š</strong>ï¼šæ³•å‘åˆ†é‡$\langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}$å¯¹åº”äºçº¦æŸåŠ›ï¼ˆç¦»å¼€æˆ–é è¿‘çƒå¿ƒçš„åŠ›ï¼‰ï¼Œä¸å½±å“æ²¿çƒé¢çš„è¿åŠ¨ã€‚åªæœ‰åˆ‡å‘åˆ†é‡æ‰å¯¹çƒé¢ä¸Šçš„ä¼˜åŒ–æœ‰è´¡çŒ®ã€‚</p>
<p><strong>è®¡ç®—å¤æ‚åº¦åˆ†æ</strong>ï¼š
- è®¡ç®—$\langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle$ï¼š$O(n)$æ¬¡ä¹˜åŠ 
- è®¡ç®—$\langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}$ï¼š$O(n)$æ¬¡æ ‡é‡ä¹˜æ³•
- è®¡ç®—æœ€ç»ˆæŠ•å½±ï¼š$O(n)$æ¬¡å‡æ³•
- <strong>æ€»å¤æ‚åº¦</strong>ï¼š$O(n)$ï¼Œä¸è®¡ç®—æ¢¯åº¦æœ¬èº«çš„å¤æ‚åº¦ç›¸åŒ</p>
<h3 id="3_2">3. è¶…çƒé¢ä¸Šçš„æœ€é€Ÿä¸‹é™æ–¹å‘</h3>
<h4 id="31_1">3.1 æœ€é€Ÿä¸‹é™é—®é¢˜çš„ç²¾ç¡®è¡¨è¿°</h4>
<p><strong>é—®é¢˜ 3.1</strong>ï¼šç»™å®šå½“å‰ç‚¹$\boldsymbol{w} \in \mathcal{S}^{n-1}$ï¼Œå¯»æ‰¾åˆ‡å‘é‡$\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}$ä½¿å¾—ï¼š
$$
\boldsymbol{\xi}^* = \arg\min_{\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}, \|\boldsymbol{\xi}\|_2 = 1} Df(\boldsymbol{w})[\boldsymbol{\xi}]
$$</p>
<p>ç­‰ä»·äºæœ€å¤§åŒ–é—®é¢˜ï¼š
$$
\boldsymbol{\xi}^* = \arg\max_{\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}, \|\boldsymbol{\xi}\|_2 = 1} -Df(\boldsymbol{w})[\boldsymbol{\xi}] = \arg\max_{\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}, \|\boldsymbol{\xi}\|_2 = 1} \langle-\nabla f(\boldsymbol{w}), \boldsymbol{\xi}\rangle
$$</p>
<p>è¿™æ­£æ˜¯æ–‡ä¸­å¼$\eqref{eq:core}$åœ¨è¶…çƒé¢çº¦æŸä¸‹çš„å½¢å¼ã€‚</p>
<h4 id="32_1">3.2 æœ€é€Ÿä¸‹é™æ–¹å‘çš„æ±‚è§£</h4>
<p><strong>å®šç† 3.1</strong>ï¼šè¶…çƒé¢ä¸Šçš„æœ€é€Ÿä¸‹é™æ–¹å‘ä¸ºï¼š
$$
\boldsymbol{\xi}^* = -\frac{\text{grad} f(\boldsymbol{w})}{\|\text{grad} f(\boldsymbol{w})\|_2} = -\frac{\nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}}{\|\nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}\|_2}
$$</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>è®¾$\boldsymbol{g} = \nabla f(\boldsymbol{w})$ï¼Œ$\boldsymbol{g}_{\text{tan}} = \text{grad} f(\boldsymbol{w}) = \boldsymbol{g} - \langle\boldsymbol{g}, \boldsymbol{w}\rangle\boldsymbol{w}$ã€‚</p>
<p>è¦æœ€å¤§åŒ–$\langle-\boldsymbol{g}, \boldsymbol{\xi}\rangle$ï¼Œçº¦æŸæ¡ä»¶ä¸º$\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}$ä¸”$|\boldsymbol{\xi}|_2 = 1$ã€‚</p>
<p>ç”±äº$\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}$ï¼Œæœ‰$\langle\boldsymbol{\xi}, \boldsymbol{w}\rangle = 0$ï¼Œå› æ­¤ï¼š
$$
\langle-\boldsymbol{g}, \boldsymbol{\xi}\rangle = \langle-\boldsymbol{g} + \langle\boldsymbol{g}, \boldsymbol{w}\rangle\boldsymbol{w}, \boldsymbol{\xi}\rangle = \langle-\boldsymbol{g}_{\text{tan}}, \boldsymbol{\xi}\rangle
$$</p>
<p>åº”ç”¨æŸ¯è¥¿-æ–½ç“¦èŒ¨ä¸ç­‰å¼ï¼š
$$
\langle-\boldsymbol{g}_{\text{tan}}, \boldsymbol{\xi}\rangle \leq \|\boldsymbol{g}_{\text{tan}}\|_2 \|\boldsymbol{\xi}\|_2 = \|\boldsymbol{g}_{\text{tan}}\|_2
$$</p>
<p>ç­‰å·æˆç«‹å½“ä¸”ä»…å½“$\boldsymbol{\xi} = -\boldsymbol{g}<em _text_tan="\text{tan">{\text{tan}}/|\boldsymbol{g}</em>|_2$ã€‚}</p>
<p><strong>å½’ä¸€åŒ–éªŒè¯</strong>ï¼š
$$
\left\|-\frac{\boldsymbol{g}_{\text{tan}}}{\|\boldsymbol{g}_{\text{tan}}\|_2}\right\|_2 = 1 \quad \checkmark
$$</p>
<p><strong>åˆ‡ç©ºé—´éªŒè¯</strong>ï¼š
$$
\left\langle-\frac{\boldsymbol{g}_{\text{tan}}}{\|\boldsymbol{g}_{\text{tan}}\|_2}, \boldsymbol{w}\right\rangle = -\frac{1}{\|\boldsymbol{g}_{\text{tan}}\|_2}\langle\boldsymbol{g}_{\text{tan}}, \boldsymbol{w}\rangle = -\frac{1}{\|\boldsymbol{g}_{\text{tan}}\|_2}\langle\boldsymbol{g} - \langle\boldsymbol{g}, \boldsymbol{w}\rangle\boldsymbol{w}, \boldsymbol{w}\rangle = 0 \quad \checkmark
$$</p>
<h4 id="33_1">3.3 é€€åŒ–æƒ…å†µåˆ†æ</h4>
<p><strong>é€€åŒ–æƒ…å†µ</strong>ï¼šå½“$\text{grad} f(\boldsymbol{w}) = \boldsymbol{0}$æ—¶ï¼Œå³$\nabla f(\boldsymbol{w}) = \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}$æ—¶ï¼Œé»æ›¼æ¢¯åº¦æ¶ˆå¤±ã€‚</p>
<p><strong>å‡ ä½•æ„ä¹‰</strong>ï¼šæ­¤æ—¶æ¬§æ°æ¢¯åº¦å®Œå…¨åœ¨æ³•ç©ºé—´ä¸­ï¼Œæ²¿çƒé¢çš„ä»»æ„åˆ‡æ–¹å‘å‡½æ•°å€¼éƒ½ä¸å˜ï¼ˆä¸€é˜¶è¿‘ä¼¼ï¼‰ï¼Œ$\boldsymbol{w}$æ˜¯çº¦æŸä¼˜åŒ–é—®é¢˜çš„ä¸´ç•Œç‚¹ã€‚</p>
<p><strong>åˆ¤å®šæ¡ä»¶</strong>ï¼š
$$
\|\boldsymbol{g}_{\text{tan}}\|_2 = 0 \Leftrightarrow \nabla f(\boldsymbol{w}) \parallel \boldsymbol{w}
$$</p>
<h3 id="4_2">4. æµ‹åœ°çº¿ä¸æŒ‡æ•°æ˜ å°„</h3>
<h4 id="41_1">4.1 æµ‹åœ°çº¿çš„å®šä¹‰ä¸æ€§è´¨</h4>
<p><strong>å®šä¹‰ 4.1ï¼ˆæµ‹åœ°çº¿ï¼‰</strong>ï¼šé»æ›¼æµå½¢ä¸Šçš„æµ‹åœ°çº¿$\gamma(t)$æ˜¯æ»¡è¶³ä»¥ä¸‹å¾®åˆ†æ–¹ç¨‹çš„æ›²çº¿ï¼š
$$
\nabla_{\dot{\gamma}(t)}\dot{\gamma}(t) = \boldsymbol{0}
$$</p>
<p>å…¶ä¸­$\nabla$æ˜¯é»æ›¼è”ç»œï¼Œ$\dot{\gamma}(t) = d\gamma/dt$æ˜¯åˆ‡å‘é‡ã€‚</p>
<p><strong>ç‰©ç†æ„ä¹‰</strong>ï¼šæµ‹åœ°çº¿æ˜¯æµå½¢ä¸Šçš„"ç›´çº¿"ï¼Œå…·æœ‰å±€éƒ¨æœ€çŸ­è·¯å¾„æ€§è´¨ã€‚</p>
<p><strong>è¶…çƒé¢ä¸Šçš„æµ‹åœ°çº¿</strong>ï¼šä»$\boldsymbol{w} \in \mathcal{S}^{n-1}$å‡ºå‘ï¼Œæ²¿åˆå§‹æ–¹å‘$\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}$çš„æµ‹åœ°çº¿ä¸ºå¤§åœ†å¼§ï¼š
$$
\gamma(t) = \cos(t\|\boldsymbol{\xi}\|_2)\boldsymbol{w} + \sin(t\|\boldsymbol{\xi}\|_2)\frac{\boldsymbol{\xi}}{\|\boldsymbol{\xi}\|_2}
$$</p>
<p><strong>æ¨å¯¼</strong>ï¼š</p>
<p><strong>æ­¥éª¤1</strong>ï¼šæµ‹åœ°çº¿æ»¡è¶³äºŒé˜¶å¾®åˆ†æ–¹ç¨‹ï¼Œè®¾$\gamma(t) \in \mathcal{S}^{n-1}$ï¼Œåˆ™$|\gamma(t)|_2 = 1$ã€‚</p>
<p>å¯¹æ—¶é—´æ±‚äºŒé˜¶å¯¼æ•°ï¼š
$$
\frac{d^2}{dt^2}\langle\gamma(t), \gamma(t)\rangle = 2\langle\ddot{\gamma}(t), \gamma(t)\rangle + 2\|\dot{\gamma}(t)\|_2^2 = 0
$$</p>
<p>å› æ­¤ï¼š
$$
\langle\ddot{\gamma}(t), \gamma(t)\rangle = -\|\dot{\gamma}(t)\|_2^2
$$</p>
<p><strong>æ­¥éª¤2</strong>ï¼šæµ‹åœ°çº¿æ–¹ç¨‹è¦æ±‚åŠ é€Ÿåº¦å‚ç›´äºæµå½¢ï¼Œå³$\ddot{\gamma}(t)$åœ¨åˆ‡ç©ºé—´çš„æŠ•å½±ä¸º0ï¼š
$$
\mathcal{P}_{\gamma(t)}(\ddot{\gamma}(t)) = \ddot{\gamma}(t) - \langle\ddot{\gamma}(t), \gamma(t)\rangle\gamma(t) = \boldsymbol{0}
$$</p>
<p>å› æ­¤ï¼š
$$
\ddot{\gamma}(t) = \langle\ddot{\gamma}(t), \gamma(t)\rangle\gamma(t) = -\|\dot{\gamma}(t)\|_2^2 \gamma(t)
$$</p>
<p><strong>æ­¥éª¤3</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªäºŒé˜¶å¸¸ç³»æ•°å¾®åˆ†æ–¹ç¨‹ã€‚è®¾åˆå§‹æ¡ä»¶$\gamma(0) = \boldsymbol{w}$ï¼Œ$\dot{\gamma}(0) = \boldsymbol{\xi}$ï¼Œä¸”$\langle\boldsymbol{\xi}, \boldsymbol{w}\rangle = 0$ï¼Œ$|\boldsymbol{w}|_2 = 1$ã€‚</p>
<p>ä»¤$s = |\boldsymbol{\xi}|_2$ï¼Œ$\boldsymbol{v} = \boldsymbol{\xi}/s$ï¼ˆå•ä½åˆ‡å‘é‡ï¼‰ï¼Œåˆ™è§£ä¸ºï¼š
$$
\gamma(t) = \cos(st)\boldsymbol{w} + \sin(st)\boldsymbol{v}
$$</p>
<p><strong>éªŒè¯</strong>ï¼š
$$
\|\gamma(t)\|_2^2 = \cos^2(st) + \sin^2(st) = 1 \quad \checkmark
$$
$$
\dot{\gamma}(t) = -s\sin(st)\boldsymbol{w} + s\cos(st)\boldsymbol{v}
$$
$$
\|\dot{\gamma}(t)\|_2 = s \quad \text{(å¸¸æ•°é€Ÿåº¦)}
$$</p>
<h4 id="42-exponential-map">4.2 æŒ‡æ•°æ˜ å°„ï¼ˆExponential Mapï¼‰</h4>
<p><strong>å®šä¹‰ 4.2ï¼ˆæŒ‡æ•°æ˜ å°„ï¼‰</strong>ï¼šæŒ‡æ•°æ˜ å°„$\text{Exp}<em _boldsymbol_w="\boldsymbol{w">{\boldsymbol{w}}: T</em>$å®šä¹‰ä¸ºï¼š
$$
\text{Exp}_{\boldsymbol{w}}(\boldsymbol{\xi}) = \gamma_{\boldsymbol{\xi}}(1)
$$}}\mathcal{S}^{n-1} \to \mathcal{S}^{n-1</p>
<p>å…¶ä¸­$\gamma_{\boldsymbol{\xi}}(t)$æ˜¯ä»$\boldsymbol{w}$å‡ºå‘ã€åˆé€Ÿåº¦ä¸º$\boldsymbol{\xi}$çš„æµ‹åœ°çº¿ã€‚</p>
<p><strong>è¶…çƒé¢çš„æŒ‡æ•°æ˜ å°„å…¬å¼</strong>ï¼š
$$
\text{Exp}_{\boldsymbol{w}}(\boldsymbol{\xi}) = \cos(\|\boldsymbol{\xi}\|_2)\boldsymbol{w} + \sin(\|\boldsymbol{\xi}\|_2)\frac{\boldsymbol{\xi}}{\|\boldsymbol{\xi}\|_2}
$$</p>
<p><strong>æ€§è´¨</strong>ï¼š
1. $\text{Exp}<em _boldsymbol_w="\boldsymbol{w">{\boldsymbol{w}}(\boldsymbol{0}) = \boldsymbol{w}$
2. $\frac{d}{dt}\text{Exp}</em>$
3. æŒ‡æ•°æ˜ å°„æ˜¯å±€éƒ¨å¾®åˆ†åŒèƒšï¼ˆåœ¨å°é‚»åŸŸå†…ä¸€ä¸€å¯¹åº”ï¼‰}}(t\boldsymbol{\xi})\Big|_{t=0} = \boldsymbol{\xi</p>
<p><strong>å°æ­¥é•¿è¿‘ä¼¼</strong>ï¼šå½“$|\boldsymbol{\xi}|_2 \ll 1$æ—¶ï¼Œåˆ©ç”¨æ³°å‹’å±•å¼€ï¼š
$$
\cos(\|\boldsymbol{\xi}\|_2) \approx 1 - \frac{\|\boldsymbol{\xi}\|_2^2}{2} + O(\|\boldsymbol{\xi}\|_2^4)
$$
$$
\sin(\|\boldsymbol{\xi}\|_2) \approx \|\boldsymbol{\xi}\|_2 - \frac{\|\boldsymbol{\xi}\|_2^3}{6} + O(\|\boldsymbol{\xi}\|_2^5)
$$</p>
<p>å› æ­¤ï¼š
$$
\text{Exp}_{\boldsymbol{w}}(\boldsymbol{\xi}) \approx \left(1 - \frac{\|\boldsymbol{\xi}\|_2^2}{2}\right)\boldsymbol{w} + \boldsymbol{\xi} + O(\|\boldsymbol{\xi}\|_2^3)
$$</p>
<p>å½’ä¸€åŒ–åˆ°å•ä½é•¿åº¦ï¼š
$$
\text{Exp}_{\boldsymbol{w}}(\boldsymbol{\xi}) \approx \frac{\boldsymbol{w} + \boldsymbol{\xi}}{\|\boldsymbol{w} + \boldsymbol{\xi}\|_2} + O(\|\boldsymbol{\xi}\|_2^3)
$$</p>
<h3 id="5-retraction">5. Retractionç®—å­</h3>
<h4 id="51-retraction">5.1 Retractionçš„å®šä¹‰</h4>
<p><strong>å®šä¹‰ 5.1ï¼ˆRetractionï¼‰</strong>ï¼šä»ç‚¹$\boldsymbol{w} \in \mathcal{M}$å¤„çš„retractionæ˜¯æ˜ å°„$R_{\boldsymbol{w}}: T_{\boldsymbol{w}}\mathcal{M} \to \mathcal{M}$ï¼Œæ»¡è¶³ï¼š
1. $R_{\boldsymbol{w}}(\boldsymbol{0}) = \boldsymbol{w}$
2. $\frac{d}{dt}R_{\boldsymbol{w}}(t\boldsymbol{\xi})\Big|<em _boldsymbol_w="\boldsymbol{w">{t=0} = \boldsymbol{\xi}$ï¼Œ$\forall \boldsymbol{\xi} \in T</em>$
3. å±€éƒ¨åˆšæ€§ï¼š$R_{\boldsymbol{w}}$æ˜¯å±€éƒ¨å¾®åˆ†åŒèƒš}}\mathcal{M</p>
<p><strong>ä½œç”¨</strong>ï¼šRetractionæä¾›äº†ä¸€ç§ä»åˆ‡ç©ºé—´"å›åˆ°"æµå½¢çš„æ–¹æ³•ï¼Œæ˜¯æŒ‡æ•°æ˜ å°„çš„è®¡ç®—å‹å¥½æ›¿ä»£ã€‚</p>
<h4 id="52-retraction">5.2 è¶…çƒé¢çš„å¸¸ç”¨Retraction</h4>
<p><strong>1. å½’ä¸€åŒ–Retractionï¼ˆæœ€å¸¸ç”¨ï¼‰</strong>ï¼š
$$
R_{\boldsymbol{w}}^{\text{norm}}(\boldsymbol{\xi}) = \frac{\boldsymbol{w} + \boldsymbol{\xi}}{\|\boldsymbol{w} + \boldsymbol{\xi}\|_2}
$$</p>
<p><strong>éªŒè¯æ¡ä»¶</strong>ï¼š
- æ¡ä»¶1ï¼š$R_{\boldsymbol{w}}^{\text{norm}}(\boldsymbol{0}) = \boldsymbol{w}/|\boldsymbol{w}|<em _boldsymbol_w="\boldsymbol{w">2 = \boldsymbol{w}$ âœ“
- æ¡ä»¶2ï¼šè®¾$\phi(t) = R</em>)$ï¼Œåˆ™
$$
\phi(t) = \frac{\boldsymbol{w} + t\boldsymbol{\xi}}{\|\boldsymbol{w} + t\boldsymbol{\xi}\|_2}
$$
$$
\frac{d\phi}{dt}\Big|_{t=0} = \frac{\boldsymbol{\xi}\|\boldsymbol{w}\|_2 - \boldsymbol{w}\langle\boldsymbol{w}, \boldsymbol{\xi}\rangle/\|\boldsymbol{w}\|_2}{\|\boldsymbol{w}\|_2^2} = \boldsymbol{\xi} - \langle\boldsymbol{w}, \boldsymbol{\xi}\rangle\boldsymbol{w} = \boldsymbol{\xi}
$$
ï¼ˆæœ€åä¸€æ­¥åˆ©ç”¨äº†$\langle\boldsymbol{w}, \boldsymbol{\xi}\rangle = 0$ï¼‰âœ“}}^{\text{norm}}(t\boldsymbol{\xi</p>
<p><strong>è®¡ç®—æˆæœ¬</strong>ï¼š
- å‘é‡åŠ æ³•ï¼š$O(n)$
- èŒƒæ•°è®¡ç®—ï¼š$O(n)$
- æ ‡é‡é™¤æ³•ï¼š$O(n)$
- <strong>æ€»æˆæœ¬</strong>ï¼š$O(n)$</p>
<p><strong>2. æŒ‡æ•°æ˜ å°„Retractionï¼ˆç²¾ç¡®ä½†æ˜‚è´µï¼‰</strong>ï¼š
$$
R_{\boldsymbol{w}}^{\text{exp}}(\boldsymbol{\xi}) = \text{Exp}_{\boldsymbol{w}}(\boldsymbol{\xi}) = \cos(\|\boldsymbol{\xi}\|_2)\boldsymbol{w} + \sin(\|\boldsymbol{\xi}\|_2)\frac{\boldsymbol{\xi}}{\|\boldsymbol{\xi}\|_2}
$$</p>
<p><strong>è®¡ç®—æˆæœ¬</strong>ï¼šéœ€è¦è®¡ç®—ä¸‰è§’å‡½æ•°ï¼Œçº¦$O(n) + O(\log(1/\epsilon))$ï¼ˆ$\epsilon$æ˜¯ç²¾åº¦ï¼‰ã€‚</p>
<h4 id="53-retraction">5.3 å½’ä¸€åŒ–Retractionçš„è¯¯å·®åˆ†æ</h4>
<p><strong>å®šç† 5.1</strong>ï¼šå½’ä¸€åŒ–retractionä¸æŒ‡æ•°æ˜ å°„çš„è¯¯å·®ä¸º$O(|\boldsymbol{\xi}|_2^3)$ï¼š
$$
\left\|R_{\boldsymbol{w}}^{\text{norm}}(\boldsymbol{\xi}) - \text{Exp}_{\boldsymbol{w}}(\boldsymbol{\xi})\right\|_2 = O(\|\boldsymbol{\xi}\|_2^3)
$$</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>è®¾$s = |\boldsymbol{\xi}|_2$ï¼Œ$\boldsymbol{v} = \boldsymbol{\xi}/s$ï¼ˆå•ä½åˆ‡å‘é‡ï¼‰ã€‚</p>
<p><strong>æŒ‡æ•°æ˜ å°„</strong>ï¼š
$$
\text{Exp}_{\boldsymbol{w}}(\boldsymbol{\xi}) = \cos(s)\boldsymbol{w} + \sin(s)\boldsymbol{v}
$$</p>
<p><strong>å½’ä¸€åŒ–retraction</strong>ï¼š
$$
R_{\boldsymbol{w}}^{\text{norm}}(\boldsymbol{\xi}) = \frac{\boldsymbol{w} + s\boldsymbol{v}}{\|\boldsymbol{w} + s\boldsymbol{v}\|_2}
$$</p>
<p>è®¡ç®—åˆ†æ¯ï¼š
$$
\|\boldsymbol{w} + s\boldsymbol{v}\|_2^2 = 1 + s^2 = 1 + s^2
$$
$$
\|\boldsymbol{w} + s\boldsymbol{v}\|_2 = \sqrt{1 + s^2} = 1 + \frac{s^2}{2} - \frac{s^4}{8} + O(s^6)
$$</p>
<p>å› æ­¤ï¼š
$$
R_{\boldsymbol{w}}^{\text{norm}}(\boldsymbol{\xi}) = \frac{\boldsymbol{w} + s\boldsymbol{v}}{1 + s^2/2 + O(s^4)} = (\boldsymbol{w} + s\boldsymbol{v})(1 - s^2/2 + O(s^4))
$$
$$
= \boldsymbol{w} + s\boldsymbol{v} - \frac{s^2}{2}\boldsymbol{w} + O(s^3) = (1 - s^2/2)\boldsymbol{w} + s\boldsymbol{v} + O(s^3)
$$</p>
<p>å¯¹æ¯”æ³°å‹’å±•å¼€ï¼š
$$
\cos(s) = 1 - \frac{s^2}{2} + \frac{s^4}{24} + O(s^6)
$$
$$
\sin(s) = s - \frac{s^3}{6} + O(s^5)
$$</p>
<p>è¯¯å·®ä¸ºï¼š
$$
\text{Exp}_{\boldsymbol{w}}(\boldsymbol{\xi}) - R_{\boldsymbol{w}}^{\text{norm}}(\boldsymbol{\xi}) = \left(\frac{s^4}{24}\boldsymbol{w} - \frac{s^3}{6}\boldsymbol{v}\right) + O(s^5) = O(s^3)
$$</p>
<p><strong>ç»“è®º</strong>ï¼šå¯¹äºå°æ­¥é•¿ä¼˜åŒ–ï¼ˆ$s \approx \eta \ll 1$ï¼‰ï¼Œå½’ä¸€åŒ–retractionæ˜¯è¶³å¤Ÿç²¾ç¡®ä¸”é«˜æ•ˆçš„é€‰æ‹©ã€‚</p>
<h3 id="6-sgd">6. è¶…çƒé¢ä¸Šçš„SGDæ›´æ–°è§„åˆ™</h3>
<h4 id="61">6.1 å®Œæ•´çš„æ›´æ–°ç®—æ³•</h4>
<p><strong>ç®—æ³• 6.1ï¼ˆè¶…çƒé¢ä¸Šçš„éšæœºæ¢¯åº¦ä¸‹é™ï¼‰</strong>ï¼š</p>
<p><strong>è¾“å…¥</strong>ï¼šåˆå§‹ç‚¹$\boldsymbol{w}_0 \in \mathcal{S}^{n-1}$ï¼Œå­¦ä¹ ç‡$\eta_t$ï¼Œç›®æ ‡å‡½æ•°$f$</p>
<p><strong>For</strong> $t = 0, 1, 2, \ldots$ <strong>do</strong>:</p>
<ol>
<li>
<p><strong>è®¡ç®—éšæœºæ¢¯åº¦</strong>ï¼š$\boldsymbol{g}_t = \nabla f(\boldsymbol{w}_t; \mathcal{B}_t)$ï¼ˆ$\mathcal{B}_t$æ˜¯å°æ‰¹é‡æ•°æ®ï¼‰</p>
</li>
<li>
<p><strong>æŠ•å½±åˆ°åˆ‡ç©ºé—´</strong>ï¼ˆè®¡ç®—é»æ›¼æ¢¯åº¦ï¼‰ï¼š
   $$
   \boldsymbol{g}_t^{\text{Riem}} = \boldsymbol{g}_t - \langle\boldsymbol{g}_t, \boldsymbol{w}_t\rangle\boldsymbol{w}_t
   $$</p>
</li>
<li>
<p><strong>ç¡®å®šä¸‹é™æ–¹å‘</strong>ï¼š
   $$
   \boldsymbol{\xi}_t = -\eta_t \frac{\boldsymbol{g}_t^{\text{Riem}}}{\|\boldsymbol{g}_t^{\text{Riem}}\|_2}
   $$
   æˆ–è€…ï¼ˆä¸å½’ä¸€åŒ–ç‰ˆæœ¬ï¼‰ï¼š
   $$
   \boldsymbol{\xi}_t = -\eta_t \boldsymbol{g}_t^{\text{Riem}}
   $$</p>
</li>
<li>
<p><strong>Retractionå›æµå½¢</strong>ï¼š
   $$
   \boldsymbol{w}_{t+1} = \frac{\boldsymbol{w}_t + \boldsymbol{\xi}_t}{\|\boldsymbol{w}_t + \boldsymbol{\xi}_t\|_2}
   $$</p>
</li>
</ol>
<p><strong>Output</strong>ï¼š$\boldsymbol{w}_T$</p>
<h4 id="62">6.2 æ›´æ–°è§„åˆ™çš„ç®€åŒ–å½¢å¼</h4>
<p>å½“ä½¿ç”¨éå½’ä¸€åŒ–çš„é»æ›¼æ¢¯åº¦æ—¶ï¼Œæ›´æ–°å¯ä»¥å†™æˆï¼š
$$
\boldsymbol{w}_{t+1} = \frac{\boldsymbol{w}_t - \eta_t(\boldsymbol{g}_t - \langle\boldsymbol{g}_t, \boldsymbol{w}_t\rangle\boldsymbol{w}_t)}{\|\boldsymbol{w}_t - \eta_t(\boldsymbol{g}_t - \langle\boldsymbol{g}_t, \boldsymbol{w}_t\rangle\boldsymbol{w}_t)\|_2}
$$</p>
<p>è¿›ä¸€æ­¥ç®€åŒ–ï¼ˆå‡è®¾$|\boldsymbol{w}_t|_2 = 1$ï¼‰ï¼š
$$
\boldsymbol{w}_{t+1} = \frac{(1 + \eta_t\langle\boldsymbol{g}_t, \boldsymbol{w}_t\rangle)\boldsymbol{w}_t - \eta_t\boldsymbol{g}_t}{\|(1 + \eta_t\langle\boldsymbol{g}_t, \boldsymbol{w}_t\rangle)\boldsymbol{w}_t - \eta_t\boldsymbol{g}_t\|_2}
$$</p>
<h4 id="63">6.3 å°æ­¥é•¿è¿‘ä¼¼</h4>
<p>å½“$\eta_t \ll 1$æ—¶ï¼Œ$\boldsymbol{\xi}_t$å¾ˆå°ï¼Œåˆ©ç”¨ä¸€é˜¶è¿‘ä¼¼ï¼š
$$
\|\boldsymbol{w}_t + \boldsymbol{\xi}_t\|_2 \approx \sqrt{1 + \eta_t^2\|\boldsymbol{g}_t^{\text{Riem}}\|_2^2} \approx 1 + \frac{\eta_t^2\|\boldsymbol{g}_t^{\text{Riem}}\|_2^2}{2}
$$</p>
<p>å› æ­¤ï¼š
$$
\boldsymbol{w}_{t+1} \approx \left(1 - \frac{\eta_t^2\|\boldsymbol{g}_t^{\text{Riem}}\|_2^2}{2}\right)(\boldsymbol{w}_t - \eta_t\boldsymbol{g}_t^{\text{Riem}}) + O(\eta_t^3)
$$</p>
<p><strong>éªŒè¯çº¦æŸä¿æŒ</strong>ï¼š
$$
\|\boldsymbol{w}_{t+1}\|_2^2 = \frac{\|\boldsymbol{w}_t + \boldsymbol{\xi}_t\|_2^2}{\|\boldsymbol{w}_t + \boldsymbol{\xi}_t\|_2^2} = 1 \quad \checkmark
$$</p>
<h3 id="7">7. æ”¶æ•›æ€§åˆ†æ</h3>
<h4 id="71-descent-lemma">7.1 ä¸‹é™å¼•ç†ï¼ˆDescent Lemmaï¼‰</h4>
<p><strong>å¼•ç† 7.1ï¼ˆé»æ›¼æµå½¢ä¸Šçš„ä¸‹é™å¼•ç†ï¼‰</strong>ï¼šå‡è®¾$f$æ˜¯$L$-å…‰æ»‘çš„ï¼ˆé»æ›¼Hessianæœ‰ç•Œï¼‰ï¼Œå³ï¼š
$$
\|\nabla^2 f(\boldsymbol{w})\| \leq L, \quad \forall \boldsymbol{w} \in \mathcal{S}^{n-1}
$$</p>
<p>åˆ™å¯¹äºä»»æ„$\boldsymbol{w}, \boldsymbol{w}' \in \mathcal{S}^{n-1}$ï¼Œæœ‰ï¼š
$$
f(\boldsymbol{w}') \leq f(\boldsymbol{w}) + \langle\text{grad} f(\boldsymbol{w}), \boldsymbol{\xi}\rangle + \frac{L}{2}\|\boldsymbol{\xi}\|_2^2
$$</p>
<p>å…¶ä¸­$\boldsymbol{w}' = R_{\boldsymbol{w}}(\boldsymbol{\xi})$ï¼Œ$\boldsymbol{\xi} \in T_{\boldsymbol{w}}\mathcal{S}^{n-1}$ã€‚</p>
<h4 id="72">7.2 å•æ­¥ä¸‹é™é‡ä¼°è®¡</h4>
<p><strong>å®šç† 7.1ï¼ˆå•æ­¥ä¸‹é™ï¼‰</strong>ï¼šä½¿ç”¨å­¦ä¹ ç‡$\eta_t \leq 1/L$ï¼Œè¶…çƒé¢SGDæ»¡è¶³ï¼š
$$
\mathbb{E}[f(\boldsymbol{w}_{t+1})] \leq f(\boldsymbol{w}_t) - \frac{\eta_t}{2}\|\text{grad} f(\boldsymbol{w}_t)\|_2^2 + \frac{L\eta_t^2}{2}\mathbb{E}[\|\boldsymbol{g}_t - \nabla f(\boldsymbol{w}_t)\|_2^2]
$$</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>åº”ç”¨ä¸‹é™å¼•ç†ï¼Œè®¾$\boldsymbol{\xi}_t = -\eta_t\boldsymbol{g}_t^{\text{Riem}}$ï¼š
$$
f(\boldsymbol{w}_{t+1}) \leq f(\boldsymbol{w}_t) + \langle\text{grad} f(\boldsymbol{w}_t), -\eta_t\boldsymbol{g}_t^{\text{Riem}}\rangle + \frac{L\eta_t^2}{2}\|\boldsymbol{g}_t^{\text{Riem}}\|_2^2
$$</p>
<p>ç¬¬äºŒé¡¹ï¼š
$$
\langle\text{grad} f(\boldsymbol{w}_t), -\eta_t\boldsymbol{g}_t^{\text{Riem}}\rangle = -\eta_t\langle\text{grad} f(\boldsymbol{w}_t), \mathcal{P}_{\boldsymbol{w}_t}(\boldsymbol{g}_t)\rangle
$$</p>
<p>ç”±äº$\text{grad} f(\boldsymbol{w}<em _boldsymbol_w="\boldsymbol{w">t) \in T</em>$ï¼ŒæŠ•å½±ä¸æ”¹å˜ï¼š
$$
= -\eta_t\langle\text{grad} f(\boldsymbol{w}_t), \mathcal{P}_{\boldsymbol{w}_t}(\nabla f(\boldsymbol{w}_t))\rangle - \eta_t\langle\text{grad} f(\boldsymbol{w}_t), \mathcal{P}_{\boldsymbol{w}_t}(\boldsymbol{g}_t - \nabla f(\boldsymbol{w}_t))\rangle
$$
$$
= -\eta_t\|\text{grad} f(\boldsymbol{w}_t)\|_2^2 - \eta_t\langle\text{grad} f(\boldsymbol{w}_t), \mathcal{P}_{\boldsymbol{w}_t}(\boldsymbol{g}_t - \nabla f(\boldsymbol{w}_t))\rangle
$$}_t}\mathcal{S}^{n-1</p>
<p>å–æœŸæœ›ï¼ˆ$\mathbb{E}[\boldsymbol{g}_t | \boldsymbol{w}_t] = \nabla f(\boldsymbol{w}_t)$ï¼‰ï¼š
$$
\mathbb{E}\langle\text{grad} f(\boldsymbol{w}_t), \mathcal{P}_{\boldsymbol{w}_t}(\boldsymbol{g}_t - \nabla f(\boldsymbol{w}_t))\rangle = 0
$$</p>
<p>å¯¹ç¬¬ä¸‰é¡¹ï¼Œæ³¨æ„$|\mathcal{P}_{\boldsymbol{w}_t}(\boldsymbol{v})|_2 \leq |\boldsymbol{v}|_2$ï¼ˆæŠ•å½±ç¼©çŸ­é•¿åº¦ï¼‰ï¼Œå› æ­¤ï¼š
$$
\mathbb{E}[\|\boldsymbol{g}_t^{\text{Riem}}\|_2^2] \leq \mathbb{E}[\|\boldsymbol{g}_t\|_2^2] = \|\nabla f(\boldsymbol{w}_t)\|_2^2 + \mathbb{E}[\|\boldsymbol{g}_t - \nabla f(\boldsymbol{w}_t)\|_2^2]
$$</p>
<p>ç»¼åˆï¼Œå½“$\eta_t \leq 1/L$æ—¶ï¼š
$$
\mathbb{E}[f(\boldsymbol{w}_{t+1})] \leq f(\boldsymbol{w}_t) - \eta_t\|\text{grad} f(\boldsymbol{w}_t)\|_2^2 + \frac{L\eta_t^2}{2}(\|\text{grad} f(\boldsymbol{w}_t)\|_2^2 + \sigma^2)
$$
$$
\leq f(\boldsymbol{w}_t) - \frac{\eta_t}{2}\|\text{grad} f(\boldsymbol{w}_t)\|_2^2 + \frac{L\eta_t^2\sigma^2}{2}
$$</p>
<p>å…¶ä¸­$\sigma^2 = \mathbb{E}[|\boldsymbol{g}_t - \nabla f(\boldsymbol{w}_t)|_2^2]$æ˜¯æ¢¯åº¦ä¼°è®¡çš„æ–¹å·®ã€‚</p>
<h4 id="73">7.3 æ”¶æ•›é€Ÿç‡</h4>
<p><strong>å®šç† 7.2ï¼ˆæ”¶æ•›é€Ÿç‡ï¼‰</strong>ï¼šå¯¹äºéå‡¸ç›®æ ‡å‡½æ•°ï¼Œä½¿ç”¨å¸¸å­¦ä¹ ç‡$\eta_t = \eta = \min{1/L, \sqrt{T}/\sigma}$ï¼Œç»è¿‡$T$æ¬¡è¿­ä»£ï¼š
$$
\min_{t=0,\ldots,T-1}\mathbb{E}[\|\text{grad} f(\boldsymbol{w}_t)\|_2^2] \leq \frac{2(f(\boldsymbol{w}_0) - f^*)}{\eta T} + L\eta\sigma^2 = O\left(\frac{1}{\sqrt{T}}\right)
$$</p>
<p>å…¶ä¸­$f^* = \inf_{\boldsymbol{w} \in \mathcal{S}^{n-1}} f(\boldsymbol{w})$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šç´¯åŠ å•æ­¥ä¸‹é™ä¸ç­‰å¼ï¼š
$$
\sum_{t=0}^{T-1}\mathbb{E}[\|\text{grad} f(\boldsymbol{w}_t)\|_2^2] \leq \frac{2}{\eta}(f(\boldsymbol{w}_0) - f^*) + L\eta T\sigma^2
$$</p>
<p>å–$\eta = \sqrt{(f(\boldsymbol{w}_0) - f^*)/(LT\sigma^2)}$å³å¾—ã€‚</p>
<p><strong>ä¸æ¬§æ°SGDçš„å¯¹æ¯”</strong>ï¼šæ”¶æ•›ç‡ç›¸åŒï¼Œå‡ä¸º$O(1/\sqrt{T})$ï¼Œè¡¨æ˜çº¦æŸä¸å½±å“æ¸è¿‘æ”¶æ•›é€Ÿåº¦ã€‚</p>
<h3 id="8-sgd">8. ä¸æ¬§æ°ç©ºé—´SGDçš„å¯¹æ¯”</h3>
<h4 id="81">8.1 æ›´æ–°è§„åˆ™å¯¹æ¯”</h4>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>æ¬§æ°SGD</th>
<th>è¶…çƒé¢SGD</th>
</tr>
</thead>
<tbody>
<tr>
<td>å‚æ•°ç©ºé—´</td>
<td>$\mathbb{R}^n$</td>
<td>$\mathcal{S}^{n-1}$</td>
</tr>
<tr>
<td>æ¢¯åº¦</td>
<td>$\nabla f(\boldsymbol{w})$</td>
<td>$\text{grad} f(\boldsymbol{w}) = \nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}$</td>
</tr>
<tr>
<td>æ›´æ–°æ–¹å‘</td>
<td>$-\nabla f(\boldsymbol{w})$</td>
<td>$-\text{grad} f(\boldsymbol{w})$</td>
</tr>
<tr>
<td>æ›´æ–°è§„åˆ™</td>
<td>$\boldsymbol{w}_{t+1} = \boldsymbol{w}_t - \eta_t\nabla f(\boldsymbol{w}_t)$</td>
<td>$\boldsymbol{w}_{t+1} = \frac{\boldsymbol{w}_t - \eta_t\text{grad} f(\boldsymbol{w}_t)}{|\cdots|_2}$</td>
</tr>
<tr>
<td>çº¦æŸä¿æŒ</td>
<td>æ— </td>
<td>$|\boldsymbol{w}_t|_2 = 1$ è‡ªåŠ¨æ»¡è¶³</td>
</tr>
<tr>
<td>è®¡ç®—å¤æ‚åº¦</td>
<td>$O(n)$</td>
<td>$O(n)$ ï¼ˆé¢å¤–ä¸€æ¬¡å†…ç§¯å’Œå½’ä¸€åŒ–ï¼‰</td>
</tr>
</tbody>
</table>
<h4 id="82">8.2 å‡ ä½•å¯¹æ¯”</h4>
<p><strong>æ¬§æ°SGD</strong>ï¼š
- æ²¿ç€è´Ÿæ¢¯åº¦æ–¹å‘åœ¨å¹³å¦çš„æ¬§æ°ç©ºé—´ä¸­å‰è¿›
- æ­¥é•¿$\eta_t$ç›´æ¥æ§åˆ¶å‚æ•°æ”¹å˜é‡çš„æ¬§æ°è·ç¦»
- å¯èƒ½åç¦»çº¦æŸé›†ï¼ˆéœ€è¦æŠ•å½±ï¼‰</p>
<p><strong>è¶…çƒé¢SGD</strong>ï¼š
- æ²¿ç€çƒé¢ä¸Šçš„æµ‹åœ°çº¿ï¼ˆå¤§åœ†å¼§ï¼‰å‰è¿›
- æ­¥é•¿$\eta_t$æ§åˆ¶åœ¨åˆ‡ç©ºé—´ä¸­çš„ç§»åŠ¨é‡
- è‡ªåŠ¨ä¿æŒåœ¨çƒé¢ä¸Šï¼ˆé€šè¿‡retractionï¼‰</p>
<h4 id="83">8.3 æœ‰æ•ˆç»´åº¦åˆ†æ</h4>
<p><strong>æ¬§æ°ç©ºé—´</strong>ï¼š$n$ä¸ªè‡ªç”±åº¦</p>
<p><strong>è¶…çƒé¢</strong>ï¼š$n-1$ä¸ªè‡ªç”±åº¦ï¼ˆä¸€ä¸ªçº¦æŸ$|\boldsymbol{w}|_2 = 1$ï¼‰</p>
<p><strong>å½±å“</strong>ï¼š
- è¶…çƒé¢SGDå®é™…ä¸Šåœ¨$(n-1)$ç»´ç©ºé—´ä¸­ä¼˜åŒ–
- çº¦æŸæ¶ˆé™¤äº†"å¾„å‘"è‡ªç”±åº¦ï¼Œåªä¿ç•™"åˆ‡å‘"è‡ªç”±åº¦
- è¿™å¯ä»¥çœ‹ä½œæ˜¯ä¸€ç§æ­£åˆ™åŒ–ï¼Œé˜²æ­¢å‚æ•°èŒƒæ•°æ— é™å¢é•¿</p>
<h4 id="84">8.4 æ¢¯åº¦èŒƒæ•°å¯¹æ¯”</h4>
<p><strong>å¼•ç† 8.1</strong>ï¼šè¶…çƒé¢é»æ›¼æ¢¯åº¦èŒƒæ•°ä¸è¶…è¿‡æ¬§æ°æ¢¯åº¦èŒƒæ•°ï¼š
$$
\|\text{grad} f(\boldsymbol{w})\|_2 \leq \|\nabla f(\boldsymbol{w})\|_2
$$</p>
<p><strong>è¯æ˜</strong>ï¼š
$$
\|\text{grad} f(\boldsymbol{w})\|_2^2 = \|\nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}\|_2^2
$$
$$
= \|\nabla f(\boldsymbol{w})\|_2^2 - 2\langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle^2 + \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle^2\|\boldsymbol{w}\|_2^2
$$
$$
= \|\nabla f(\boldsymbol{w})\|_2^2 - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle^2 \leq \|\nabla f(\boldsymbol{w})\|_2^2
$$</p>
<p><strong>å‡ ä½•æ„ä¹‰</strong>ï¼šæŠ•å½±åˆ°åˆ‡ç©ºé—´ä¼šä¸¢å¤±æ³•å‘åˆ†é‡ï¼Œå› æ­¤é»æ›¼æ¢¯åº¦æ›´å°æˆ–ç›¸ç­‰ã€‚</p>
<h3 id="9">9. åœ¨ç¥ç»ç½‘ç»œä¸­çš„åº”ç”¨</h3>
<h4 id="91-weight-normalization">9.1 æƒé‡å½’ä¸€åŒ–ï¼ˆWeight Normalizationï¼‰</h4>
<p><strong>èƒŒæ™¯</strong>ï¼šæƒé‡å½’ä¸€åŒ–æ˜¯ä¸€ç§é‡å‚æ•°åŒ–æŠ€å·§ï¼Œå°†æƒé‡åˆ†è§£ä¸ºæ–¹å‘å’Œå°ºåº¦ï¼š
$$
\boldsymbol{w} = g\frac{\boldsymbol{v}}{\|\boldsymbol{v}\|_2}
$$</p>
<p>å…¶ä¸­$g \in \mathbb{R}$æ˜¯æ ‡é‡å¢ç›Šï¼Œ$\boldsymbol{v}/|\boldsymbol{v}|_2 \in \mathcal{S}^{n-1}$æ˜¯æ–¹å‘å‘é‡ã€‚</p>
<p><strong>ä¼˜åŒ–é—®é¢˜</strong>ï¼šç»™å®šæŸå¤±$L(g, \boldsymbol{v})$ï¼Œåˆ†åˆ«å¯¹$g$å’Œ$\boldsymbol{v}$ä¼˜åŒ–ï¼š
$$
\frac{\partial L}{\partial g} = \frac{\partial L}{\partial \boldsymbol{w}}\frac{\partial \boldsymbol{w}}{\partial g} = \frac{\partial L}{\partial \boldsymbol{w}}\frac{\boldsymbol{v}}{\|\boldsymbol{v}\|_2}
$$</p>
<p>å¯¹$\boldsymbol{v}$çš„æ¢¯åº¦ï¼š
$$
\frac{\partial L}{\partial \boldsymbol{v}} = \frac{\partial L}{\partial \boldsymbol{w}}\frac{\partial \boldsymbol{w}}{\partial \boldsymbol{v}} = g\frac{\partial L}{\partial \boldsymbol{w}}\left(\frac{\boldsymbol{I}}{\|\boldsymbol{v}\|_2} - \frac{\boldsymbol{v}\boldsymbol{v}^{\top}}{\|\boldsymbol{v}\|_2^3}\right)
$$</p>
<p>ç®€åŒ–ï¼š
$$
\frac{\partial L}{\partial \boldsymbol{v}} = \frac{g}{\|\boldsymbol{v}\|_2}\left(\frac{\partial L}{\partial \boldsymbol{w}} - \frac{\langle\partial L/\partial \boldsymbol{w}, \boldsymbol{v}\rangle}{\|\boldsymbol{v}\|_2^2}\boldsymbol{v}\right)
$$</p>
<p>è®¾$\boldsymbol{u} = \boldsymbol{v}/|\boldsymbol{v}|_2 \in \mathcal{S}^{n-1}$ï¼ˆå•ä½åŒ–ï¼‰ï¼Œ$\partial L/\partial \boldsymbol{w} = \boldsymbol{g}_w$ï¼š
$$
\frac{\partial L}{\partial \boldsymbol{u}} = g\left(\boldsymbol{g}_w - \langle\boldsymbol{g}_w, \boldsymbol{u}\rangle\boldsymbol{u}\right) = g \cdot \text{grad}_{\boldsymbol{u}} L
$$</p>
<p><strong>æ›´æ–°è§„åˆ™</strong>ï¼š
$$
g_{t+1} = g_t - \eta_g\frac{\partial L}{\partial g}
$$
$$
\boldsymbol{u}_{t+1} = \frac{\boldsymbol{u}_t - \eta_u \cdot \text{grad}_{\boldsymbol{u}} L}{\|\boldsymbol{u}_t - \eta_u \cdot \text{grad}_{\boldsymbol{u}} L\|_2}
$$</p>
<p><strong>å¥½å¤„</strong>ï¼š
- è§£è€¦æ–¹å‘å’Œå°ºåº¦çš„å­¦ä¹ 
- ç¨³å®šè®­ç»ƒï¼ˆæ–¹å‘å˜åŒ–è¢«çº¦æŸåœ¨çƒé¢ä¸Šï¼‰
- åŠ é€Ÿæ”¶æ•›ï¼ˆç‰¹åˆ«æ˜¯å¯¹RNNå’ŒGANï¼‰</p>
<h4 id="92-spectral-normalization">9.2 è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰</h4>
<p><strong>åº”ç”¨</strong>ï¼šGANåˆ¤åˆ«å™¨çš„Lipschitzçº¦æŸã€‚</p>
<p><strong>ç›®æ ‡</strong>ï¼šå°†æƒé‡çŸ©é˜µ$\boldsymbol{W}$çš„æœ€å¤§å¥‡å¼‚å€¼é™åˆ¶ä¸º1ï¼š
$$
\boldsymbol{W}_{\text{SN}} = \frac{\boldsymbol{W}}{\sigma_1(\boldsymbol{W})}
$$</p>
<p>å…¶ä¸­$\sigma_1(\boldsymbol{W}) = \max_{|\boldsymbol{v}|_2=1} |\boldsymbol{W}\boldsymbol{v}|_2$ã€‚</p>
<p><strong>è®¡ç®—</strong>ï¼šä½¿ç”¨å¹‚è¿­ä»£æ³•ï¼Œè¿­ä»£æ±‚è§£ï¼š
$$
\boldsymbol{u}_{t+1} = \frac{\boldsymbol{W}\boldsymbol{v}_t}{\|\boldsymbol{W}\boldsymbol{v}_t\|_2}, \quad \boldsymbol{v}_{t+1} = \frac{\boldsymbol{W}^{\top}\boldsymbol{u}_{t+1}}{\|\boldsymbol{W}^{\top}\boldsymbol{u}_{t+1}\|_2}
$$</p>
<p>è¿™æ­£æ˜¯åœ¨ä¸¤ä¸ªè¶…çƒé¢$\mathcal{S}^{m-1}$å’Œ$\mathcal{S}^{n-1}$ä¸Šäº¤æ›¿ä¼˜åŒ–ï¼</p>
<p><strong>æ¢¯åº¦è®¡ç®—</strong>ï¼š
$$
\frac{\partial L}{\partial \boldsymbol{W}} = \frac{1}{\sigma_1}\left(\frac{\partial L}{\partial \boldsymbol{W}_{\text{SN}}} - \left\langle\frac{\partial L}{\partial \boldsymbol{W}_{\text{SN}}}, \boldsymbol{u}\boldsymbol{v}^{\top}\right\rangle\boldsymbol{u}\boldsymbol{v}^{\top}\right)
$$</p>
<h4 id="93">9.3 çƒé¢å·ç§¯ç¥ç»ç½‘ç»œ</h4>
<p><strong>åº”ç”¨</strong>ï¼šå¤„ç†çƒé¢æ•°æ®ï¼ˆåœ°çƒè¡¨é¢ã€å…¨æ™¯å›¾åƒã€åˆ†å­æ„è±¡ï¼‰ã€‚</p>
<p><strong>æŒ‘æˆ˜</strong>ï¼šæ ‡å‡†å·ç§¯åœ¨å¹³é¢ç½‘æ ¼å®šä¹‰ï¼Œä¸é€‚ç”¨äºçƒé¢ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
1. ä½¿ç”¨çƒè°å‡½æ•°ï¼ˆspherical harmonicsï¼‰ä½œä¸ºç‰¹å¾
2. åœ¨åˆ‡ç©ºé—´å®šä¹‰å±€éƒ¨å·ç§¯
3. ä½¿ç”¨æŒ‡æ•°æ˜ å°„åœ¨ä¸åŒåˆ‡ç©ºé—´ä¹‹é—´ä¼ è¾“</p>
<p><strong>è¶…çƒé¢SGDçš„è§’è‰²</strong>ï¼šä¼˜åŒ–å®šä¹‰åœ¨çƒé¢ä¸Šçš„ç¥ç»ç½‘ç»œå‚æ•°ï¼Œè‡ªç„¶ä¿æŒå‡ ä½•ç»“æ„ã€‚</p>
<h4 id="94-metric-learning">9.4 åº¦é‡å­¦ä¹ ï¼ˆMetric Learningï¼‰</h4>
<p><strong>ç›®æ ‡</strong>ï¼šå­¦ä¹ åµŒå…¥$\phi: \mathcal{X} \to \mathcal{S}^{n-1}$ï¼Œä½¿å¾—ç›¸ä¼¼æ ·æœ¬åœ¨çƒé¢ä¸Šæ¥è¿‘ã€‚</p>
<p><strong>æŸå¤±å‡½æ•°</strong>ï¼šçƒé¢softmax
$$
L = -\log\frac{\exp(s\cos\theta_{y_i})}{\sum_{j=1}^C\exp(s\cos\theta_j)}
$$</p>
<p>å…¶ä¸­$\theta_j = \arccos(\langle\boldsymbol{w}_j, \boldsymbol{x}_i\rangle)$æ˜¯ç‰¹å¾$\boldsymbol{x}_i$ä¸ç±»ä¸­å¿ƒ$\boldsymbol{w}_j$çš„å¤¹è§’ï¼Œ$\boldsymbol{w}_j \in \mathcal{S}^{n-1}$ã€‚</p>
<p><strong>ä¼˜åŒ–</strong>ï¼š
- ç‰¹å¾å½’ä¸€åŒ–ï¼š$\boldsymbol{x}_i \leftarrow \boldsymbol{x}_i/|\boldsymbol{x}_i|_2$
- ç±»ä¸­å¿ƒ$\boldsymbol{w}_j$ä½¿ç”¨è¶…çƒé¢SGDæ›´æ–°</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š
- å‡ ä½•è§£é‡Šæ¸…æ™°ï¼ˆè§’åº¦è·ç¦»ï¼‰
- é¿å…èŒƒæ•°è†¨èƒ€
- æ”¹å–„ç±»åˆ«é—´å¯åˆ†æ€§</p>
<h3 id="10">10. æ•°å€¼å®éªŒä¸å®ç°ç»†èŠ‚</h3>
<h4 id="101">10.1 ç®—æ³•ä¼ªä»£ç </h4>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">spherical_sgd</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">eta</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    è¶…çƒé¢ä¸Šçš„éšæœºæ¢¯åº¦ä¸‹é™</span>

<span class="sd">    å‚æ•°:</span>
<span class="sd">        f: ç›®æ ‡å‡½æ•°ï¼ˆè¿”å›æŸå¤±å’Œæ¢¯åº¦ï¼‰</span>
<span class="sd">        w0: åˆå§‹å‚æ•°ï¼ˆåº”æ»¡è¶³ ||w0||_2 = 1ï¼‰</span>
<span class="sd">        T: è¿­ä»£æ¬¡æ•°</span>
<span class="sd">        eta: å­¦ä¹ ç‡</span>
<span class="sd">        batch_size: æ‰¹é‡å¤§å°</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">w0</span><span class="p">)</span>  <span class="c1"># ç¡®ä¿åˆå§‹åŒ–åœ¨çƒé¢ä¸Š</span>

    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
        <span class="c1"># 1. é‡‡æ ·å°æ‰¹é‡å¹¶è®¡ç®—æ¢¯åº¦</span>
        <span class="n">batch</span> <span class="o">=</span> <span class="n">sample_batch</span><span class="p">(</span><span class="n">batch_size</span><span class="p">)</span>
        <span class="n">loss</span><span class="p">,</span> <span class="n">grad</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">batch</span><span class="p">)</span>

        <span class="c1"># 2. æŠ•å½±åˆ°åˆ‡ç©ºé—´ï¼ˆé»æ›¼æ¢¯åº¦ï¼‰</span>
        <span class="n">grad_riem</span> <span class="o">=</span> <span class="n">grad</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="n">w</span>

        <span class="c1"># 3. åˆ‡ç©ºé—´ä¸­çš„æ›´æ–°</span>
        <span class="n">xi</span> <span class="o">=</span> <span class="o">-</span><span class="n">eta</span> <span class="o">*</span> <span class="n">grad_riem</span>

        <span class="c1"># 4. Retractionï¼ˆå½’ä¸€åŒ–ï¼‰</span>
        <span class="n">w_new</span> <span class="o">=</span> <span class="n">w</span> <span class="o">+</span> <span class="n">xi</span>
        <span class="n">w</span> <span class="o">=</span> <span class="n">w_new</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">w_new</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">w</span>
</code></pre></div>

<h4 id="102">10.2 æ•°å€¼ç¨³å®šæ€§æŠ€å·§</h4>
<p><strong>1. é¿å…é›¶é™¤</strong>ï¼šå½“$|\boldsymbol{g}_t^{\text{Riem}}|_2 \approx 0$æ—¶ï¼š
$$
\boldsymbol{w}_{t+1} = \boldsymbol{w}_t \quad \text{(è·³è¿‡æ›´æ–°)}
$$</p>
<p><strong>2. æ¢¯åº¦è£å‰ª</strong>ï¼š
$$
\boldsymbol{g}_t^{\text{Riem}} \leftarrow \min\left(1, \frac{\tau}{\|\boldsymbol{g}_t^{\text{Riem}}\|_2}\right)\boldsymbol{g}_t^{\text{Riem}}
$$</p>
<p><strong>3. å‘¨æœŸæ€§é‡å½’ä¸€åŒ–</strong>ï¼ˆé˜²æ­¢æ•°å€¼æ¼‚ç§»ï¼‰ï¼š
$$
\boldsymbol{w}_t \leftarrow \frac{\boldsymbol{w}_t}{\|\boldsymbol{w}_t\|_2} \quad \text{æ¯}K\text{æ­¥}
$$</p>
<h4 id="103">10.3 å¤æ‚åº¦æ€»ç»“</h4>
<p><strong>æ¯æ­¥æ—¶é—´å¤æ‚åº¦</strong>ï¼š
- æ¢¯åº¦è®¡ç®—ï¼š$O(C_f)$ï¼ˆä¾èµ–äº$f$ï¼‰
- å†…ç§¯$\langle\boldsymbol{g}_t, \boldsymbol{w}_t\rangle$ï¼š$O(n)$
- æŠ•å½±ï¼š$O(n)$
- å½’ä¸€åŒ–ï¼š$O(n)$ï¼ˆè®¡ç®—èŒƒæ•°+æ ‡é‡é™¤æ³•ï¼‰
- <strong>æ€»è®¡</strong>ï¼š$O(C_f + n)$</p>
<p><strong>ç©ºé—´å¤æ‚åº¦</strong>ï¼š$O(n)$ï¼ˆå­˜å‚¨$\boldsymbol{w}_t, \boldsymbol{g}_t$ï¼‰</p>
<p><strong>ä¸æ¬§æ°SGDçš„é¢å¤–å¼€é”€</strong>ï¼šçº¦2-3å€çš„å‘é‡æ“ä½œï¼ˆå†…ç§¯+æŠ•å½±+å½’ä¸€åŒ–ï¼‰ï¼Œåœ¨ç°ä»£ç¡¬ä»¶ä¸Šå¯å¿½ç•¥ã€‚</p>
<h3 id="11_2">11. ç†è®ºæ·±åŒ–ï¼šæ›²ç‡çš„å½±å“</h3>
<h4 id="111">11.1 é»æ›¼æ›²ç‡å¼ é‡</h4>
<p>è¶…çƒé¢çš„æ›²ç‡å¼ é‡ä¸ºï¼š
$$
R(X, Y)Z = \langle Y, Z\rangle X - \langle X, Z\rangle Y
$$</p>
<p><strong>æˆªé¢æ›²ç‡</strong>ï¼šæ’ä¸º$K = 1$ï¼ˆæ­£æ›²ç‡ï¼‰ã€‚</p>
<p><strong>å½±å“</strong>ï¼š
- æ­£æ›²ç‡å¯¼è‡´æµ‹åœ°çº¿ç›¸äº’æ±‡èš
- ä¼˜åŒ–è½¨è¿¹è¶‹å‘äºæ”¶æ•›åˆ°å±€éƒ¨åŒºåŸŸ
- ä¸è´Ÿæ›²ç‡æµå½¢ï¼ˆå¦‚åŒæ›²ç©ºé—´ï¼‰å½¢æˆå¯¹æ¯”</p>
<h4 id="112-jacobi">11.2 Jacobiåœºä¸æµ‹åœ°çº¿ç¨³å®šæ€§</h4>
<p><strong>Jacobiæ–¹ç¨‹</strong>ï¼š
$$
\nabla_t^2 J + R(\dot{\gamma}, J)\dot{\gamma} = 0
$$</p>
<p>å¯¹äºè¶…çƒé¢ï¼š
$$
\nabla_t^2 J + J = 0
$$</p>
<p><strong>è§£</strong>ï¼š$J(t) = A\cos(t) + B\sin(t)$ï¼ˆå‘¨æœŸæ€§æŒ¯è¡ï¼‰</p>
<p><strong>å‡ ä½•æ„ä¹‰</strong>ï¼šä»å¯¹è·–ç‚¹å‡ºå‘çš„æµ‹åœ°çº¿ä¼šåœ¨è·ç¦»$\pi$å¤„å†æ¬¡ç›¸äº¤ï¼Œå¯¼è‡´æŒ‡æ•°æ˜ å°„åœ¨å¤§æ­¥é•¿æ—¶å¤±å»å•å°„æ€§ã€‚</p>
<p><strong>ä¼˜åŒ–å¯ç¤º</strong>ï¼šå­¦ä¹ ç‡ä¸åº”è¿‡å¤§ï¼Œå¦åˆ™å¯èƒ½"è¶Šè¿‡"æœ€ä¼˜ç‚¹ã€‚</p>
<h3 id="12_1">12. å°ç»“ä¸å±•æœ›</h3>
<h4 id="121">12.1 æ ¸å¿ƒè¦ç‚¹å›é¡¾</h4>
<ol>
<li>
<p><strong>è¶…çƒé¢æ˜¯$(n-1)$ç»´é»æ›¼æµå½¢</strong>ï¼ŒåµŒå…¥åœ¨$\mathbb{R}^n$ä¸­ï¼Œçº¦æŸä¸º$|\boldsymbol{w}|_2 = 1$ã€‚</p>
</li>
<li>
<p><strong>åˆ‡ç©ºé—´$T_{\boldsymbol{w}}\mathcal{S}^{n-1} = {\boldsymbol{v} : \langle\boldsymbol{v}, \boldsymbol{w}\rangle = 0}$</strong>ï¼Œç”±ä¸$\boldsymbol{w}$æ­£äº¤çš„å‘é‡ç»„æˆã€‚</p>
</li>
<li>
<p><strong>é»æ›¼æ¢¯åº¦</strong>æ˜¯æ¬§æ°æ¢¯åº¦åœ¨åˆ‡ç©ºé—´çš„æŠ•å½±ï¼š
   $$
   \text{grad} f(\boldsymbol{w}) = \nabla f(\boldsymbol{w}) - \langle\nabla f(\boldsymbol{w}), \boldsymbol{w}\rangle\boldsymbol{w}
   $$</p>
</li>
<li>
<p><strong>æœ€é€Ÿä¸‹é™æ–¹å‘</strong>æ˜¯è´Ÿé»æ›¼æ¢¯åº¦æ–¹å‘ï¼š
   $$
   \boldsymbol{\xi}^* = -\frac{\text{grad} f(\boldsymbol{w})}{\|\text{grad} f(\boldsymbol{w})\|_2}
   $$</p>
</li>
<li>
<p><strong>Retractionï¼ˆå½’ä¸€åŒ–ï¼‰</strong>å°†åˆ‡ç©ºé—´æ›´æ–°æ˜ å°„å›æµå½¢ï¼š
   $$
   \boldsymbol{w}_{t+1} = \frac{\boldsymbol{w}_t - \eta_t\text{grad} f(\boldsymbol{w}_t)}{\|\boldsymbol{w}_t - \eta_t\text{grad} f(\boldsymbol{w}_t)\|_2}
   $$</p>
</li>
<li>
<p><strong>æ”¶æ•›é€Ÿç‡$O(1/\sqrt{T})$</strong>ï¼Œä¸æ— çº¦æŸSGDç›¸åŒã€‚</p>
</li>
<li>
<p><strong>åº”ç”¨å¹¿æ³›</strong>ï¼šæƒé‡å½’ä¸€åŒ–ã€è°±å½’ä¸€åŒ–ã€åº¦é‡å­¦ä¹ ã€çƒé¢ç¥ç»ç½‘ç»œã€‚</p>
</li>
</ol>
<h4 id="122">12.2 ä¸åŸæ–‡çš„è”ç³»</h4>
<p>æœ¬æ¨å¯¼è¯¦ç»†å±•å¼€äº†åŸæ–‡ç¬¬5èŠ‚"è¶…çƒé¢ä¸Š"çš„æ•°å­¦ç»†èŠ‚ï¼š
- <strong>æ–¹ç¨‹(9)</strong>çš„å‡ ä½•æ„ä¹‰ï¼šæœ€é€Ÿä¸‹é™æ–¹å‘çš„ä¼˜åŒ–é—®é¢˜
- <strong>æ–¹ç¨‹(10)</strong>çš„æ¨å¯¼ï¼šçƒé¢çº¦æŸçš„ä¸€é˜¶è¿‘ä¼¼
- <strong>æ–¹ç¨‹(11-12)</strong>çš„æ±‚è§£ï¼šæ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•
- <strong>æ–¹ç¨‹(13)</strong>çš„å½’ä¸€åŒ–ï¼šç²¾ç¡®ä¿æŒçº¦æŸ</p>
<p>åŒæ—¶è¡¥å……äº†åŸæ–‡æœªæ¶‰åŠçš„ï¼š
- å¾®åˆ†å‡ ä½•åŸºç¡€ï¼ˆåˆ‡ç©ºé—´ã€æ³•ç©ºé—´ã€æŠ•å½±ï¼‰
- é»æ›¼æ¢¯åº¦çš„ä¸¥æ ¼å®šä¹‰
- æµ‹åœ°çº¿ä¸æŒ‡æ•°æ˜ å°„
- æ”¶æ•›æ€§ç†è®ºåˆ†æ
- ç¥ç»ç½‘ç»œåº”ç”¨å®ä¾‹</p>
<h4 id="123">12.3 è¿›ä¸€æ­¥é˜…è¯»</h4>
<ul>
<li><strong>é»æ›¼ä¼˜åŒ–</strong>ï¼šAbsil et al., "Optimization Algorithms on Matrix Manifolds" (2008)</li>
<li><strong>æµå½¢å­¦ä¹ </strong>ï¼šBoumal, "An Introduction to Optimization on Smooth Manifolds" (2020)</li>
<li><strong>ç¥ç»ç½‘ç»œåº”ç”¨</strong>ï¼šSalimans &amp; Kingma, "Weight Normalization" (2016)</li>
<li><strong>è°±å½’ä¸€åŒ–</strong>ï¼šMiyato et al., "Spectral Normalization for GANs" (2018)</li>
</ul>
        </div>
    </div>
</body>
</html>