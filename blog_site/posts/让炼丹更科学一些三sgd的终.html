<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è®©ç‚¼ä¸¹æ›´ç§‘å­¦ä¸€äº›ï¼ˆä¸‰ï¼‰ï¼šSGDçš„ç»ˆç‚¹æŸå¤±æ”¶æ•›</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>è®©ç‚¼ä¸¹æ›´ç§‘å­¦ä¸€äº›ï¼ˆä¸‰ï¼‰ï¼šSGDçš„ç»ˆç‚¹æŸå¤±æ”¶æ•›</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2026-01-08 | ğŸ“„ å¤§å°: 40.6 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11480">https://spaces.ac.cn/archives/11480</a></p>
<hr />
<h2 id="1">1. æ ¸å¿ƒç†è®ºã€å…¬ç†ä¸å†å²åŸºç¡€</h2>
<h3 id="11">1.1 è·¨å­¦ç§‘æ ¹æºï¼šä»ç»Ÿè®¡å¹³å‡åˆ°ç‚¹æ”¶æ•›</h3>
<p>åœ¨éšæœºä¼˜åŒ–ï¼ˆStochastic Optimizationï¼‰çš„æ¼«é•¿å†å²ä¸­ï¼Œç†è®ºå­¦å®¶ä¸ç‚¼ä¸¹å¸ˆï¼ˆå®è·µè€…ï¼‰ä¹‹é—´ä¸€ç›´å­˜åœ¨ä¸€ä¸ªâ€œå¹³å‡å€¼â€çš„åšå¼ˆã€‚
- <strong>éå†ç†è®º (Ergodic Theory)</strong>ï¼š1992å¹´ Polyak å’Œ Ruppert è¯æ˜äº†ï¼Œå¦‚æœæˆ‘ä»¬å¯¹æ‰€æœ‰è®­ç»ƒè½¨è¿¹çš„å‚æ•°å–å¹³å‡å€¼ï¼ˆPolyak Averagingï¼‰ï¼Œé‚£ä¹ˆåœ¨å™ªå£°ç¯å¢ƒä¸‹èƒ½è·å¾—æœ€ä½³çš„æ”¶æ•›é€Ÿåº¦ã€‚
- <strong>é©¬å°”å¯å¤«é“¾ç¨³æ€åˆ†æ</strong>ï¼šSGD çš„è¿­ä»£æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªéšæœºè¿‡ç¨‹ã€‚ç†è®ºä¸Šï¼Œæˆ‘ä»¬æ›´å®¹æ˜“è¯æ˜å…¶æ¦‚ç‡æµ‹åº¦çš„å¹³å‡å€¼æ”¶æ•›ï¼Œè€Œéå•æ¬¡è·¯å¾„çš„æœ«ç«¯ç‚¹æ”¶æ•›ã€‚
- <strong>ç°å®å†²çª</strong>ï¼šåœ¨æ·±åº¦å­¦ä¹ å®è·µä¸­ï¼Œæˆ‘ä»¬å‡ ä¹æ€»æ˜¯ç›´æ¥æ‹¿èµ°è®­ç»ƒå®Œæœ€åä¸€æ­¥çš„ Checkpointã€‚å¦‚æœç†è®ºåªèƒ½ä¿è¯â€œå¹³å‡å€¼â€å¥½ï¼Œè€Œä¸èƒ½ä¿è¯â€œæœ€åä¸€ç‚¹â€å¥½ï¼Œé‚£ä¹ˆç†è®ºå¯¹å®è·µçš„æŒ‡å¯¼æ„ä¹‰å°†å¤§æ‰“æŠ˜æ‰£ã€‚</p>
<h3 id="12">1.2 å†å²ç¼–å¹´å²ï¼šæœ€åä¸€æ­¥çš„â€œç¿»èº«ä»—â€</h3>
<ol>
<li><strong>1990s - å‡å€¼éœ¸æƒ</strong>ï¼šç”±äºéšæœºæ¢¯åº¦çš„æ–¹å·®æ— æ³•æ¶ˆå¤±ï¼Œå¤§å®¶é»˜è®¤æœ€åä¸€ç‚¹æ˜¯åœ¨æœ€ä¼˜ç‚¹é™„è¿‘éœ‡è¡çš„ï¼Œä¸ä¼šæ”¶æ•›ã€‚</li>
<li><strong>2010s - å‡¸ä¼˜åŒ–å¤å…´</strong>ï¼šäººä»¬å¼€å§‹æ€è€ƒï¼Œå¦‚æœå­¦ä¹ ç‡ä¸æ–­å‡å°ï¼ˆCoolingï¼‰ï¼Œå•ç‚¹æ˜¯å¦ä¹Ÿèƒ½æ”¶æ•›ï¼Ÿ</li>
<li><strong>2020 - å…³é”®æ’ç­‰å¼çš„å‘ç°</strong>ï¼šHarvey ç­‰äººæå‡ºäº†ä¸€ç§å·§å¦™çš„æ•°å­¦å˜æ¢ï¼Œè¯æ˜äº†é€šè¿‡æ§åˆ¶â€œå±€éƒ¨æ¼‚ç§»â€ï¼Œå¯ä»¥å°†åŸæœ¬æ‚ä¹±æ— ç« çš„å•ç‚¹è¯¯å·®ï¼Œæ‹†è§£ä¸ºæœ‰åºçš„ã€å¯æ”¶æ•›çš„é¡¹ã€‚</li>
<li><strong>2023 - å·¥ä¸šç•Œåº”ç”¨</strong>ï¼šSWA (Stochastic Weight Averaging) å’Œ WSM çš„æµè¡Œï¼Œæœ¬è´¨ä¸Šæ˜¯è¯•å›¾é€šè¿‡ç®€å•çš„æœ«ç«¯èåˆï¼Œå°†æœ¬ç¯‡è¦è®¨è®ºçš„â€œå•ç‚¹æ”¶æ•›æ€§â€æ¨å‘æè‡´ã€‚</li>
</ol>
<h3 id="13">1.3 ä¸¥è°¨å…¬ç†åŒ–</h3>
<div class="theorem-box">

### æ ¸å¿ƒå…¬ç†ä½“ç³»ï¼šç»“æ„åŒ–æ”¶æ•›

**å…¬ç† 1 (å‡¸æ€§ä¸‹é™)**ï¼šæŸå¤±å‡½æ•° $L$ å…·å¤‡å…¨å±€å›å¤åŠ›ï¼Œæ¢¯åº¦æ–¹å‘å§‹ç»ˆæä¾›å‡å°è·ç¦»çš„åŠ¨èƒ½ã€‚
**å…¬ç† 2 (æœ«ç«¯é™æ¸©)**ï¼šå­¦ä¹ ç‡åºåˆ— $\eta_t$ å¿…é¡»æ˜¯éå¢çš„ï¼ˆ$\eta_t \geq \eta_{t+1}$ï¼‰ï¼Œä¸” $\lim_{t \to \infty} \eta_t = 0$ã€‚è¿™æ˜¯æ¶ˆé™¤å•ç‚¹éœ‡è¡çš„ç‰©ç†å‰æã€‚
**å…¬ç† 3 (å±€éƒ¨ Lipschitz è¿ç»­)**ï¼šæ¢¯åº¦äºŒé˜¶çŸ©æœ‰ç•Œ $\mathbb{E}[\|\boldsymbol{g}_t\|^2] \leq G^2$ï¼Œç¡®ä¿äº†ç³»ç»Ÿä¸ä¼šå› ä¸ºä¸€æ¬¡æç«¯çš„éšæœºé‡‡æ ·è€Œå½»åº•å´©å¡Œã€‚

</div>

<h3 id="14">1.4 è®¾è®¡å“²å­¦ï¼šå¯»æ‰¾â€œç¨³æ€é™è½â€çš„èŠ‚å¥</h3>
<p>æœ¬ç« çš„æ¨å¯¼å“²å­¦æ˜¯ï¼š<strong>â€œå¦‚æœä¸€æ¶é£æœºçš„å¹³å‡é«˜åº¦åœ¨ä¸‹é™ï¼Œä¸”å®ƒåœ¨é™è½å‰çš„é¢ ç°¸è¶Šæ¥è¶Šå°ï¼Œé‚£ä¹ˆå®ƒé™è½çš„é‚£ä¸€åˆ»ä¸€å®šè´´è¿‘åœ°é¢ã€‚â€</strong> 
æˆ‘ä»¬å°†â€œæœ€åä¸€æ­¥çš„è¯¯å·®â€çœ‹ä½œæ˜¯â€œæ•´ä½“è¶‹åŠ¿â€ä¸â€œæœ€åé˜¶æ®µåç¦»åº¦â€çš„çº¿æ€§ç»„åˆã€‚è¿™ç§æ€è·¯é¿å…äº†å¯¹å•ç‚¹è½¨è¿¹è¿›è¡Œè¿‡äºå¤æ‚çš„åŠ¨åŠ›å­¦å»ºæ¨¡ï¼Œè€Œæ˜¯é€šè¿‡çº§æ•°æ±‚å’Œçš„æŠ€å·§ï¼Œé—´æ¥åœ°æ•è·äº†æœ«ç«¯çš„ç²¾ç¡®æ€§ã€‚</p>
<hr />
<h2 id="2">2. ä¸¥è°¨çš„æ ¸å¿ƒæ•°å­¦æ¨å¯¼</h2>
<p>æœ¬èŠ‚å°†é‡ç°è¿™ä¸€ä¼˜åŒ–ç†è®ºå²ä¸Šæœ€ç²¾å·§çš„è¯æ˜ä¹‹ä¸€ï¼šå°†ç®—æœ¯å¹³å‡æŸå¤±çš„ç»“è®ºâ€œå¹³ç§»â€åˆ°ç»ˆç‚¹ã€‚</p>
<h3 id="21-">2.1 æ„é€ â€œç»ˆç‚¹-å¹³å‡â€è½¬æ¢æ’ç­‰å¼</h3>
<p>è¿™æ˜¯æ•´ä¸ªè¯æ˜çš„çµé­‚ã€‚æˆ‘ä»¬è¦å»ºç«‹ $q_T$ï¼ˆæœ€åä¸€æ­¥è¯¯å·®ï¼‰ä¸ $\frac{1}{T}\sum q_t$ï¼ˆå…¨ä½“å¹³å‡è¯¯å·®ï¼‰ä¹‹é—´çš„ç²¾ç¡®ç­‰å¼ã€‚</p>
<div class="derivation-box">

### æ ¸å¿ƒå¼•ç†ï¼šç¦»æ•£çº§æ•°çš„é€’å½’åˆ†è§£

è®¾ $q_t = \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}^*)]$ã€‚
å®šä¹‰åç¼€å¹³å‡åºåˆ—ï¼š$S_k = \frac{1}{k} \sum_{t=T-k+1}^T q_t$ã€‚
æ˜¾ç„¶ï¼Œæˆ‘ä»¬è¦ç ”ç©¶çš„æ˜¯ $S_1 = q_T$ï¼Œè€Œå·²çŸ¥çš„æ˜¯ $S_T = \frac{1}{T} \sum_{t=1}^T q_t$ã€‚

**æ­¥éª¤1ï¼šå¯»æ‰¾ç›¸é‚»åç¼€å¹³å‡çš„å·®å€¼**
\begin{equation} (k+1) S_{k+1} = \sum_{t=T-k}^T q_t = q_{T-k} + \sum_{t=T-k+1}^T q_t = q_{T-k} + k S_k \tag{1} \end{equation}
ç”±æ­¤å¯¼å‡ºï¼š
\begin{equation} S_k - S_{k+1} = \frac{S_{k+1} - q_{T-k}}{k} \tag{2} \end{equation}

**æ­¥éª¤2ï¼šå±•å¼€å¹³å‡é¡¹ä»¥æ˜¾å¼åŒ–â€œé—´éš™â€**
å°† $S_{k+1}$ å±•å¼€å›æ±‚å’Œå½¢å¼ï¼š
\begin{equation} S_{k+1} - q_{T-k} = \frac{1}{k+1} \sum_{t=T-k}^T q_t - q_{T-k} = \frac{1}{k+1} \sum_{t=T-k}^T (q_t - q_{T-k}) \tag{3} \end{equation}

**æ­¥éª¤3ï¼šè·å¾—æœ€ç»ˆæ±‚å’Œæ’ç­‰å¼**
å¯¹ $k = 1$ åˆ° $T-1$ è¿›è¡Œç´¯åŠ ï¼Œåˆ©ç”¨å·¦ç«¯é¡¹çš„ä¼¸ç¼©æ€§è´¨ï¼š
\begin{equation} S_1 - S_T = \sum_{k=1}^{T-1} (S_k - S_{k+1}) = \sum_{k=1}^{T-1} \frac{1}{k(k+1)} \sum_{t=T-k}^T (q_t - q_{T-k}) \tag{4} \end{equation}
\begin{equation} q_T = \frac{1}{T} \sum_{t=1}^T q_t + \sum_{k=1}^{T-1} \frac{1}{k(k+1)} \sum_{t=T-k}^T (q_t - q_{T-k}) \tag{5} \end{equation}

</div>

<h3 id="22-fluctuation-term">2.2 ä¼°è®¡å±€éƒ¨æ¼‚ç§»é¡¹ï¼ˆFluctuation Termï¼‰çš„ä¸Šç•Œ</h3>
<p>å¼ (5) å³ç«¯ç¬¬äºŒé¡¹ä»£è¡¨äº†â€œæœ€åé˜¶æ®µçš„æ¶¨è½â€ã€‚æˆ‘ä»¬è¦è¯æ˜è¿™ä¸€é¡¹ä¸ä¼šæ¯”ç¬¬ä¸€é¡¹å¤§ã€‚</p>
<div class="derivation-box">

### æ¨å¯¼ï¼šæ— ç•ŒåŸŸä¸‹çš„å±€éƒ¨ç¨³å®šæ€§ä¼°è®¡

**æ­¥éª¤1ï¼šé‡ç”³æ— ç•ŒåŸŸåŸºç¡€ç»“è®º**
å¯¹äºä»»æ„èµ·ç‚¹ $k$ å’Œä»»æ„å‚è€ƒç‚¹ $\boldsymbol{\varphi}$ï¼Œæˆ‘ä»¬åœ¨ä¸Šä¸€ç¯‡è¯æ˜è¿‡ï¼š
\begin{equation} 2 \sum_{t=k}^T \eta_t \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\varphi})] \leq \mathbb{E}\|\boldsymbol{\theta}_k - \boldsymbol{\varphi}\|^2 + G^2 \sum_{t=k}^T \eta_t^2 \tag{6} \end{equation}

**æ­¥éª¤2ï¼šè®¾å®šå‚è€ƒç‚¹ä¸ºèµ·å§‹ç‚¹ $\boldsymbol{\theta}_{T-k}$**
æ­¤æ—¶ï¼Œç¬¬ä¸€é¡¹ $\mathbb{E}\|\boldsymbol{\theta}_{T-k} - \boldsymbol{\theta}_{T-k}\|^2 = 0$ã€‚ä¸ç­‰å¼ç®€åŒ–ä¸ºï¼š
\begin{equation} 2 \sum_{t=T-k}^T \eta_t \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}_{T-k})] \leq G^2 \sum_{t=T-k}^T \eta_t^2 \tag{7} \end{equation}

**æ­¥éª¤3ï¼šåˆ©ç”¨å­¦ä¹ ç‡çš„å•è°ƒå‡æ€§è´¨æå–ç•Œé™**
ç”±äº $\eta_t \geq \eta_T$ å¯¹æ‰€æœ‰ $t \leq T$ æˆç«‹ï¼Œæˆ‘ä»¬å¯ä»¥æ”¾ç¼©å·¦ç«¯ï¼š
\begin{equation} 2 \eta_T \sum_{t=T-k}^T \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}_{T-k})] \leq 2 \sum_{t=T-k}^T \eta_t \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}_{T-k})] \tag{8} \end{equation}
ç»“åˆ (7) å¼ï¼š
\begin{equation} \sum_{t=T-k}^T (q_t - q_{T-k}) \leq \frac{G^2}{2 \eta_T} \sum_{t=T-k}^T \eta_t^2 \tag{9} \end{equation}

</div>

<h3 id="23">2.3 ç»¼åˆï¼šç»ˆç‚¹æŸå¤±çš„æ˜¾å¼ç•Œé™</h3>
<p>ç°åœ¨æˆ‘ä»¬å°† (9) ä»£å…¥æ’ç­‰å¼ (5)ï¼Œå¹¶è¿›è¡Œçº§æ•°æ±‚å’Œé¡ºåºçš„äº¤æ¢ã€‚</p>
<div class="formula-explanation">

### ç»ˆç‚¹è¯¯å·® $q_T$ çš„æ€»ç•Œé™è§£æ

\begin{equation} q_T \leq \underbrace{\frac{D_1^2 + G^2 \sum \eta_t^2}{2 T \eta_T}}_{\text{Trend Term}} + \underbrace{\frac{G^2}{2 \eta_T} \sum_{k=1}^{T-1} \frac{1}{k(k+1)} \sum_{t=T-k}^T \eta_t^2}_{\text{Noise Jitter}} \tag{10} \end{equation}

<div class="formula-step">
<div class="step-label">1. äº¤æ¢æ±‚å’Œé¡ºåº</div>
åˆ©ç”¨å‡ ä½•çº§æ•°æ€§è´¨ï¼Œå³ç«¯ç¬¬äºŒé¡¹å¯ä»¥ç®€åŒ–ã€‚ç»è¿‡æŠµæ¶ˆå’Œæ•´ç†ï¼ˆè¯¦è§ä¸‹æ–‡æŠ˜å æ¨å¯¼ï¼‰ï¼š
\begin{equation} q_T \leq \frac{\|\boldsymbol{\theta}_1 - \boldsymbol{\theta}^*\|^2}{2 T \eta_T} + \frac{G^2 \eta_T}{2} + \frac{G^2}{2 \eta_T} \sum_{t=1}^{T-1} \frac{\eta_t^2}{T-t} \tag{11} \end{equation}
</div>

<div class="formula-step">
<div class="step-label">2. å™ªå£°é¡¹çš„ç‰©ç†å«ä¹‰</div>
æ³¨æ„ $\frac{\eta_t^2}{T-t}$ã€‚å®ƒè¯´æ˜ï¼š**ç¦»ç»ˆç‚¹è¶Šè¿‘çš„æ›´æ–°æ­¥ï¼ˆ$T-t$ è¶Šå°ï¼‰ï¼Œå…¶å™ªå£°å¯¹ç»ˆç‚¹ç»“æœçš„å¹²æ‰°å°±è¶Šå¤§ã€‚** è¿™å®šé‡è§£é‡Šäº†ä¸ºä»€ä¹ˆæœ€åé˜¶æ®µçš„â€œé™æ¸©â€å¿…é¡»æä¸ºç¨³å¥ã€‚
</div>

</div>

<h3 id="24-1sqrtt">2.4 æ”¶æ•›é˜¶ä¼°è®¡ï¼š$1/\sqrt{t}$ å­¦ä¹ ç‡ä¸‹çš„è¡¨ç°</h3>
<p>æˆ‘ä»¬æ¥çœ‹çœ‹è¿™ä¸€é•¿ä¸²å…¬å¼åœ¨å®è·µä¸­æ„å‘³ç€ä»€ä¹ˆé€Ÿç‡ã€‚</p>
<div class="step-by-step">

<div class="step">
**è®¾å®šè°ƒåº¦**ï¼š$\eta_t = \alpha / \sqrt{t}$ã€‚
</div>

<div class="step">
**ä¼°è®¡æ±‚å’Œé¡¹**ï¼š
\begin{equation} \sum_{t=1}^{T-1} \frac{1}{t(T-t)} = \frac{1}{T} \sum \left( \frac{1}{t} + \frac{1}{T-t} \right) \approx \frac{2 \ln T}{T} \tag{12} \end{equation}
</div>

<div class="step">
**ä»£å…¥æ€»ç•Œ (11)**ï¼š
\begin{equation} q_T \leq \frac{D_1^2}{2\alpha\sqrt{T}} + \frac{G^2\alpha}{2\sqrt{T}} + \frac{G^2\alpha\sqrt{T}}{2} \cdot \frac{2 \ln T}{T} \tag{13} \end{equation}
\begin{equation} q_T \sim \mathcal{O}\left( \frac{\ln T}{\sqrt{T}} \right) \tag{14} \end{equation}
</div>

</div>

<p><strong>ç»“è®º</strong>ï¼šåœ¨æ— ç•ŒåŸŸä¸‹ï¼Œç»ˆç‚¹æ”¶æ•›é€Ÿåº¦ä¸å¹³å‡æŸå¤±ä¸€è‡´ï¼Œä»…å¤šäº†ä¸€ä¸ªå¾®ä¸è¶³é“çš„ $\ln T$ã€‚</p>
<hr />
<h2 id="3">3. æ•°å­¦ç›´è§‰ã€å¤šè§’åº¦è§£é‡Šä¸ç±»æ¯”</h2>
<div class="intuition-box">

### ğŸ§  ç›´è§‰ç†è§£ï¼šé£æœºçš„â€œå®‰å…¨ç€é™†â€ ğŸ›¬

æƒ³è±¡ä½ åœ¨é©¾é©¶ä¸€æ¶é£æœºï¼ˆå‚æ•° $\boldsymbol{\theta}$ï¼‰é™è½åœ¨ç¹å¿™çš„æœºåœºï¼ˆæœ€ä¼˜ç‚¹ $\boldsymbol{\theta}^*$ï¼‰ã€‚

*   **å¹³å‡é«˜åº¦ï¼ˆAverageï¼‰**ï¼šç›¸å½“äºä½ æŠŠæ•´ä¸ªé£è¡Œè½¨è¿¹çš„é«˜åº¦åŠ èµ·æ¥æ±‚å¹³å‡ã€‚å³ä¾¿ä½ åœ¨åŠç©ºä¸­ï¼Œä½ çš„å¹³å‡é«˜åº¦ä¹Ÿå¯ä»¥å¾ˆä½ã€‚ä½†è¿™æ¯«æ— æ„ä¹‰ï¼Œä¹˜å®¢éœ€è¦çš„æ˜¯å®‰å…¨æ¥åœ°ã€‚
*   **æœ€åä¸€æ­¥ï¼ˆLast-iterateï¼‰**ï¼šè¿™å°±æ˜¯ç€é™†çš„é‚£ä¸€åˆ»ã€‚
*   **ä¸ºä»€ä¹ˆéœ€è¦â€œå‡é€Ÿâ€ï¼ˆå­¦ä¹ ç‡è¡°å‡ï¼‰ï¼Ÿ**
    *   å¦‚æœä½ åœ¨ç€é™†é‚£ä¸€åˆ»è¿˜å¼€ç€åŠ åŠ›ç‡ƒçƒ§å®¤ï¼ˆå¤§å­¦ä¹ ç‡ï¼‰ï¼Œä½ ä¼šç›´æ¥å¼¹èµ·æ¥æˆ–è€…å†²å‡ºè·‘é“ã€‚
    *   **$\ln T$ çš„å«ä¹‰**ï¼šå®ƒä»£è¡¨äº†ä½ åœ¨ä¹‹å‰é•¿è¾¾ 10 å°æ—¶çš„é£è¡Œä¸­ï¼Œæ¯ä¸€æ¬¡å¾®å°çš„æ°”æµé¢ ç°¸ï¼ˆæ¢¯åº¦å™ªå£°ï¼‰åœ¨ç»ˆç‚¹å¤„æ®‹ç•™çš„ä¸ç¡®å®šæ€§ã€‚
*   **ç»“è®º**ï¼šåªæœ‰åœ¨æœ€åå‡ å…¬é‡Œé€šè¿‡ç²¾ç¡®çš„å‡é€Ÿï¼ˆ$\eta_t \to 0$ï¼‰ï¼Œä½ æ‰èƒ½æŠµæ¶ˆä¹‹å‰æ‰€æœ‰çš„ç´¯è®¡è¯¯å·®ï¼Œç¨³ç¨³åœ°åœåœ¨åœæœºä½ä¸Šã€‚

</div>

<h3 id="32">3.2 å‡ ä½•è§†è§’ï¼šæœç´¢äº‘çš„â€œæ¦‚ç‡åç¼©â€</h3>
<p>åœ¨å‚æ•°ç©ºé—´ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥å°† SGD çœ‹ä½œä¸€ä¸ªä¸æ–­ç§»åŠ¨ä¸”ä¸æ–­æ”¶ç¼©çš„â€œæ¦‚ç‡äº‘â€ã€‚
- <strong>å¹³å‡å€¼</strong>ï¼šæ˜¯äº‘çš„å‡ ä½•ä¸­å¿ƒã€‚
- <strong>ç»ˆç‚¹å€¼</strong>ï¼šæ˜¯äº‘ä¸­æœ€æ–°äº§ç”Ÿçš„ä¸€ä¸ªé‡‡æ ·ç‚¹ã€‚
æœ¬ç« æ¨å¯¼çš„æœ¬è´¨æ˜¯ï¼šéšç€å­¦ä¹ ç‡è¡°å‡ï¼Œè¿™ä¸ªâ€œæ¦‚ç‡äº‘â€çš„åŠå¾„æ”¶ç¼©é€Ÿåº¦ï¼ˆå¼•åŠ›åœºä½œç”¨ï¼‰è¶…è¿‡äº†å…¶å†…éƒ¨éšæœºæ‰©æ•£çš„é€Ÿåº¦ã€‚å› æ­¤ï¼Œäº‘ä¸ä»…ä»…åœ¨ç§»åŠ¨ï¼Œå®ƒè¿˜åœ¨å‘å…¶ä¸­å¿ƒâ€œåç¼©â€ã€‚</p>
<h3 id="33">3.3 ä¿¡æ¯è®ºè§†è§’ï¼šä¿¡æ¯æ®‹ä½™ä¸å™ªå£°æˆªæ–­</h3>
<p>ä¼˜åŒ–è¿‡ç¨‹æ˜¯ä¸æ–­é—å¿˜åˆå§‹çŠ¶æ€ä¿¡æ¯ï¼ˆInitialization energyï¼‰å¹¶å¸æ”¶å…¨å±€æå€¼ä¿¡æ¯çš„è¿‡ç¨‹ã€‚
- $D_1^2/T$ï¼šä»£è¡¨äº†åˆå§‹åç½®ä¿¡æ¯çš„æ¶ˆå¤±é€Ÿç‡ã€‚
- $\sum \eta_t^2/(T-t)$ï¼šä»£è¡¨äº†å™ªå£°ä¿¡æ¯åœ¨ç»ˆç‚¹å¤„çš„æˆªæ–­ã€‚
å½“ $T \to \infty$ æ—¶ï¼Œè¿™ç§â€œä¿¡æ¯ç½®æ¢â€å½»åº•å®Œæˆï¼Œç»ˆç‚¹ä¾¿æˆä¸ºäº†æœ€ä¼˜ç‚¹ã€‚</p>
<hr />
<h2 id="4">4. æ–¹æ³•è®ºå˜ä½“ã€æ‰¹åˆ¤æ€§æ¯”è¾ƒä¸ä¼˜åŒ–</h2>
<h3 id="41">4.1 å…¨é‡å¯¹æ¯”è¡¨</h3>
<table>
<thead>
<tr>
<th style="text-align: left;">æŒ‡æ ‡</th>
<th style="text-align: left;">ç®—æœ¯å¹³å‡æŸå¤±</th>
<th style="text-align: left;"><strong>ç»ˆç‚¹æŸå¤± (æœ¬æ–‡)</strong></th>
<th style="text-align: left;">EMA æƒé‡æ»‘åŠ¨å¹³å‡</th>
<th style="text-align: left;">SWA (å‘¨æœŸå¹³å‡)</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>ç†è®ºé€Ÿåº¦</strong></td>
<td style="text-align: left;">$O(1/\sqrt{T})$</td>
<td style="text-align: left;"><strong>$O(\ln T / \sqrt{T})$</strong></td>
<td style="text-align: left;">$O(1/\sqrt{T})$</td>
<td style="text-align: left;">$O(1/\sqrt{T})$</td>
</tr>
<tr>
<td style="text-align: left;"><strong>æ¨ç†å¤æ‚åº¦</strong></td>
<td style="text-align: left;">æ— é¢å¤–æˆæœ¬</td>
<td style="text-align: left;"><strong>é›¶æˆæœ¬</strong></td>
<td style="text-align: left;">éœ€åœ¨çº¿ç»´æŠ¤å‡å€¼</td>
<td style="text-align: left;">éœ€å­˜å‚¨å‰¯æœ¬</td>
</tr>
<tr>
<td style="text-align: left;"><strong>æ”¶æ•›ç¨³å¥æ€§</strong></td>
<td style="text-align: left;">æä½³</td>
<td style="text-align: left;"><strong>ä¸€èˆ¬ (å—æœ«ç«¯å™ªå£°å½±å“)</strong></td>
<td style="text-align: left;">æä½³</td>
<td style="text-align: left;">æä½³</td>
</tr>
<tr>
<td style="text-align: left;"><strong>ç‚¼ä¸¹å¸ˆæ¨èåº¦</strong></td>
<td style="text-align: left;">â­</td>
<td style="text-align: left;">â­â­â­â­â­</td>
<td style="text-align: left;">â­â­â­</td>
<td style="text-align: left;">â­â­â­â­</td>
</tr>
</tbody>
</table>
<h3 id="42">4.2 æ·±åº¦æ‰¹åˆ¤ï¼šå•ç‚¹æ”¶æ•›çš„â€œæ­»ç©´â€</h3>
<p>å°½ç®¡æˆ‘ä»¬è¯æ˜äº†å®ƒæ”¶æ•›ï¼Œä½†ç‚¼ä¸¹å¸ˆå¿…é¡»æ¸…é†’è®¤è¯†åˆ°ä»¥ä¸‹ä¸‰ç‚¹ï¼š</p>
<ol>
<li><strong>è‡´å‘½ç¼ºé™· 1ï¼šæœ«ç«¯æ–¹å·®æ•æ„Ÿåº¦</strong><ul>
<li>å…¬å¼ (11) ä¸­ $G^2 \eta_T / 2$ é¡¹æ„å‘³ç€å¦‚æœä½ åœ¨è®­ç»ƒç»“æŸæ—¶çªç„¶å¢å¤§å­¦ä¹ ç‡ï¼ŒæŸå¤±ä¼šç¬é—´çˆ†ç‚¸ã€‚</li>
<li><strong>åæœ</strong>ï¼šç»ˆç‚¹æ”¶æ•›å¯¹â€œé™æ¸©æ›²çº¿â€çš„æœ«ç«¯å½¢çŠ¶æå…¶æŒ‘å‰”ã€‚</li>
</ul>
</li>
<li><strong>è‡´å‘½ç¼ºé™· 2ï¼šéå‡¸æ™¯è§‚çš„â€œå°–é”æ€§é™·é˜±â€</strong><ul>
<li><strong>åˆ†æ</strong>ï¼šåœ¨éå‡¸çš„å¤§æ¨¡å‹æ™¯è§‚ä¸­ï¼Œç»ˆç‚¹å¯èƒ½è½å…¥ä¸€ä¸ªææ·±ä½†æçª„çš„â€œé”åˆ©æå°å€¼â€ã€‚</li>
<li><strong>ä»£ä»·</strong>ï¼šè¿™ä¼šå¯¼è‡´è™½ç„¶è®­ç»ƒ Loss ä½ï¼Œä½†åœ¨æµ‹è¯•é›†ä¸Šå› ä¸ºå‚æ•°æ¼‚ç§»è€Œæ€§èƒ½å´©æºƒã€‚å¹³å‡å€¼æ³•ï¼ˆå¦‚ SWAï¼‰å¾€å¾€èƒ½é€šè¿‡å¹³æ»‘æ•ˆåº”é¿å¼€è¿™äº›å‘ã€‚</li>
</ul>
</li>
<li><strong>è‡´å‘½ç¼ºé™· 3ï¼šäºŒé˜¶ä¿¡æ¯çš„ç¼ºå¤±</strong><ul>
<li>ç›®å‰çš„è¯æ˜ä»…æ¶‰åŠä¸€é˜¶æ¢¯åº¦ã€‚åœ¨æ›²ç‡æå¤§çš„åŒºåŸŸï¼Œç»ˆç‚¹æ”¶æ•›çš„å¸¸æ•°é¡¹ä¼šå˜å¾—ä¸å¯æ¥å—ã€‚</li>
</ul>
</li>
</ol>
<h3 id="43">4.3 ç®—æ³•æ¼”è¿›é€»è¾‘</h3>
<ol>
<li><strong>SGD (å•ç‚¹)</strong>ï¼šè¿½æ±‚é€Ÿåº¦ï¼Œä½†æœ«ç«¯ä¸ç¨³å®šã€‚</li>
<li><strong>Linear Decay (ä¼˜åŒ–)</strong>ï¼šé€šè¿‡å°† $\eta_T$ å¼ºåˆ¶å½’é›¶ï¼Œç‰©ç†ä¸ŠæŠ¹é™¤äº†æœ«ç«¯å™ªå£°ï¼Œå°†é€Ÿç‡å¼ºè¡Œæ‹‰å› $O(1/\sqrt{T})$ã€‚</li>
<li><strong>WSM (æœ€æ–°å®è·µ)</strong>ï¼šé€šè¿‡åœ¨è®­ç»ƒæœ«æœŸèåˆå¤šä¸ª Checkpointï¼Œæœ¬è´¨ä¸Šæ˜¯åœ¨ç”¨å°è§„æ¨¡çš„å¹³å‡å»ä¿®è¡¥å•ç‚¹æ”¶æ•›çš„æŠ–åŠ¨ã€‚</li>
</ol>
<hr />
<h2 id="5">5. å·¥ç¨‹å®è·µã€è·¯çº¿å›¾ä¸æœªæ¥å±•æœ›</h2>
<h3 id="51-checkpointpytorch">5.1 ç‚¼ä¸¹å¸ˆ Checkpointï¼šPyTorch å®ç°ç»†èŠ‚</h3>
<p>åœ¨ä½¿ç”¨ç»ˆç‚¹æ”¶æ•›ç»“è®ºæ—¶ï¼ŒåŠ¡å¿…æ³¨æ„ä»¥ä¸‹å·¥ç¨‹é™·é˜±ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># ä¸€ä¸ªå…¸å‹çš„æœ«ç«¯ç¨³å®šç­–ç•¥</span>
<span class="k">def</span><span class="w"> </span><span class="nf">finalize_training</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">train_loader</span><span class="p">):</span>
    <span class="c1"># é™·é˜±: ä¸è¦çªç„¶åœæ­¢ã€‚</span>
    <span class="c1"># æ ¹æ®å…¬å¼ (11)ï¼Œæœ€åå‡ ä¸ª epoch çš„æ¢¯åº¦æ–¹å·®å†³å®šäº† q_Tã€‚</span>
    <span class="c1"># ç­–ç•¥: åœ¨æœ€å 10% çš„æ­¥æ•°ä¸­æ‰§è¡Œæå°å­¦ä¹ ç‡çš„å¹³æ»‘ã€‚</span>

    <span class="n">current_lr</span> <span class="o">=</span> <span class="n">scheduler</span><span class="o">.</span><span class="n">get_last_lr</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">final_smoothing_steps</span><span class="p">):</span>
        <span class="c1"># å¼ºåˆ¶å•è°ƒå‡æˆ–æå°å¸¸æ•°</span>
        <span class="k">for</span> <span class="n">param_group</span> <span class="ow">in</span> <span class="n">optimizer</span><span class="o">.</span><span class="n">param_groups</span><span class="p">:</span>
            <span class="n">param_group</span><span class="p">[</span><span class="s1">&#39;lr&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">current_lr</span> <span class="o">*</span> <span class="mf">0.1</span> 
        <span class="o">...</span>
</code></pre></div>

<h3 id="52">5.2 æœªæ¥ç ”ç©¶å­é—®é¢˜</h3>
<h4 id="1_1"><strong>æ–¹å‘ 1ï¼šéå‡¸æ— ç•ŒåŸŸçš„â€œæœ€åä¸€æ­¥â€æ³›åŒ–ç•Œ</strong></h4>
<ul>
<li><strong>æŒ‘æˆ˜ç‚¹</strong>ï¼šç›®å‰åªè¯æ˜äº† Loss æ”¶æ•›ã€‚ä½†åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼ŒLoss æ”¶æ•› $\neq$ æ³›åŒ–æ”¶æ•›ã€‚</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼šåˆ©ç”¨ IGRï¼ˆéšå¼æ¢¯åº¦æ­£åˆ™ï¼‰ç†è®ºï¼Œè¯æ˜æœ€åä¸€æ­¥çš„å¹³å¦åº¦éš $T$ çš„æ¼”åŒ–å…¬å¼ã€‚</li>
</ul>
<h4 id="2-hessian"><strong>æ–¹å‘ 2ï¼šåŸºäº Hessian è°±çš„è‡ªé€‚åº”æœ«ç«¯è°ƒåº¦</strong></h4>
<ul>
<li><strong>èƒŒæ™¯</strong>ï¼šå›ºå®š $1/\sqrt{t}$ å¿½ç•¥äº†æ›²ç‡ã€‚</li>
<li><strong>å­é—®é¢˜</strong>ï¼šèƒ½å¦æ ¹æ®æœ«ç«¯çš„ç‰¹å¾å€¼åˆ†å¸ƒ $\lambda_{\max}$ åŠ¨æ€è°ƒæ•´ $\eta_T$ï¼Œä»¥æŠµæ¶ˆ $\ln T$ é¡¹ï¼Ÿ</li>
</ul>
<h4 id="3_1"><strong>æ–¹å‘ 3ï¼šå¤§æ¨¡å‹ä¸­çš„â€œäºŒé˜¶éœ‡è¡â€ç†è®º</strong></h4>
<ul>
<li><strong>ç°çŠ¶</strong>ï¼šè®­ç»ƒåæœŸå¸¸å‡ºç° Loss Spikeã€‚</li>
<li><strong>æ„¿æ™¯</strong>ï¼šé€šè¿‡ä¿®æ­£æœ¬æ–‡çš„æ’ç­‰å¼ï¼Œå¼•å…¥äºŒé˜¶åŠ¨é‡é¡¹ï¼Œè§£é‡Šå¹¶é¢„é˜²å¤§æ¨¡å‹ç»ˆç‚¹çš„å‘æ•£ç°è±¡ã€‚</li>
</ul>
<hr />
<p><strong>æ€»ç»“</strong>ï¼šç»ˆç‚¹æ”¶æ•›çš„è¯æ˜å®Œæˆäº†ä¼˜åŒ–ç†è®ºä»"æŠ½è±¡ç»Ÿè®¡"åˆ°"å·¥ç¨‹å®è·µ"çš„æœ€åæ‹¼å›¾ã€‚å®ƒå‘Šè¯‰æˆ‘ä»¬ï¼Œè™½ç„¶æ¯ä¸€å°æ­¥éƒ½å……æ»¡äº†éšæœºçš„å™ªå£°ï¼Œä½†åªè¦æŒæ¡å¥½é™æ¸©çš„èŠ‚å¥ï¼Œ<strong>æœ€åç•™ä¸‹çš„é‚£ä»½æƒé‡ï¼Œå°±æ˜¯æ•´ä¸ªæ¼«é•¿ç‚¼ä¸¹è¿‡ç¨‹ä¸­æœ€çè´µçš„ç»“æ™¶ã€‚</strong></p>
<hr />
<h2 id="6">6. æ·±å…¥æ¨å¯¼ï¼šä¼¸ç¼©å’Œæ’ç­‰å¼çš„å®Œæ•´ç»†èŠ‚</h2>
<p>ä¸ºäº†è®©è¯»è€…å®Œå…¨ç†è§£å¼ (5) çš„æ¨å¯¼è¿‡ç¨‹ï¼Œæˆ‘ä»¬åœ¨æ­¤ç»™å‡ºå®Œæ•´çš„ä»£æ•°å±•å¼€ã€‚</p>
<div class="derivation-box">

### æ¨å¯¼ 6.1ï¼šåç¼€å¹³å‡å·®åˆ†çš„å®Œæ•´å±•å¼€

**ç›®æ ‡**ï¼šä» $S_T$ æ¨å¯¼å‡º $S_1 = q_T$ã€‚

**æ­¥éª¤ 1ï¼šå®šä¹‰åç¼€å¹³å‡**
å¯¹äºä»»æ„ $k \in [1, T]$ï¼Œå®šä¹‰ï¼š
\begin{equation} S_k = \frac{1}{k} \sum_{t=T-k+1}^T q_t \tag{15} \end{equation}

**æ­¥éª¤ 2ï¼šé€’æ¨å…³ç³»**
\begin{align} (k+1) S_{k+1} &= \sum_{t=T-k}^T q_t \tag{16} \\ &= q_{T-k} + \sum_{t=T-k+1}^T q_t \tag{17} \\ &= q_{T-k} + k S_k \tag{18} \end{align}

**æ­¥éª¤ 3ï¼šæ±‚å·®åˆ†**
\begin{align} S_k - S_{k+1} &= S_k - \frac{q_{T-k} + k S_k}{k+1} \tag{19} \\ &= \frac{(k+1)S_k - q_{T-k} - k S_k}{k+1} \tag{20} \\ &= \frac{S_k - q_{T-k}}{k+1} \tag{21} \end{align}

ä½†æˆ‘ä»¬éœ€è¦å°†åˆ†å­å˜ä¸º"é—´éš™å’Œ"ã€‚æ³¨æ„åˆ°ï¼š
\begin{align} S_k &= \frac{1}{k}\sum_{t=T-k+1}^T q_t \tag{22} \\ k S_k - k q_{T-k} &= \sum_{t=T-k+1}^T q_t - k q_{T-k} \tag{23} \\ &= \sum_{t=T-k+1}^T (q_t - q_{T-k}) \tag{24} \end{align}

å› æ­¤ï¼š
\begin{equation} S_k - S_{k+1} = \frac{1}{k(k+1)} \sum_{t=T-k+1}^T (q_t - q_{T-k}) \tag{25} \end{equation}

**æ­¥éª¤ 4ï¼šä¼¸ç¼©æ±‚å’Œ**
\begin{align} S_1 - S_T &= \sum_{k=1}^{T-1} (S_k - S_{k+1}) \tag{26} \\ &= \sum_{k=1}^{T-1} \frac{1}{k(k+1)} \sum_{t=T-k+1}^T (q_t - q_{T-k}) \tag{27} \end{align}

**æ­¥éª¤ 5ï¼šæœ€ç»ˆæ’ç­‰å¼**
\begin{equation} q_T = S_1 = S_T + \sum_{k=1}^{T-1} \frac{1}{k(k+1)} \sum_{t=T-k+1}^T (q_t - q_{T-k}) \tag{28} \end{equation}

</div>

<hr />
<h2 id="7">7. é‡è¦å¼•ç†ï¼šå±€éƒ¨æ¼‚ç§»ç•Œçš„ä¸¥æ ¼è¯æ˜</h2>
<div class="theorem-box">

### å¼•ç† 7.1ï¼šæ®µè½æŸå¤±å¢é‡çš„ä¸Šç•Œ

**é™ˆè¿°**ï¼šè®¾ $\eta_t$ å•è°ƒé€’å‡ï¼Œåˆ™å¯¹äºä»»æ„ $k \geq 1$ï¼š
\begin{equation} \sum_{t=T-k+1}^T \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}_{T-k})] \leq \frac{G^2}{2\eta_T} \sum_{t=T-k+1}^T \eta_t^2 \tag{29} \end{equation}

**è¯æ˜**ï¼š

**æ­¥éª¤ 1ï¼šåº”ç”¨æ— ç•ŒåŸŸåŸºç¡€ä¸ç­‰å¼**
ä»ç¬¬äºŒç¯‡æ–‡ç« çš„å…¬å¼ (13)ï¼Œæˆ‘ä»¬çŸ¥é“å¯¹äºä»»æ„åŒºé—´ $[a, b]$ å’Œä»»æ„å‚è€ƒç‚¹ $\boldsymbol{\varphi}$ï¼š
\begin{equation} 2 \sum_{t=a}^b \eta_t \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\varphi})] \leq \mathbb{E}\|\boldsymbol{\theta}_a - \boldsymbol{\varphi}\|^2 + G^2 \sum_{t=a}^b \eta_t^2 \tag{30} \end{equation}

**æ­¥éª¤ 2ï¼šé€‰æ‹©ç‰¹æ®Šå‚è€ƒç‚¹**
ä»¤ $\boldsymbol{\varphi} = \boldsymbol{\theta}_{T-k}$ï¼ˆå³èµ·å§‹ç‚¹è‡ªå·±ï¼‰ã€‚æ­¤æ—¶ï¼š
\begin{equation} \mathbb{E}\|\boldsymbol{\theta}_{T-k} - \boldsymbol{\theta}_{T-k}\|^2 = 0 \tag{31} \end{equation}

**æ­¥éª¤ 3ï¼šç®€åŒ–ä¸ç­‰å¼**
\begin{equation} 2 \sum_{t=T-k+1}^T \eta_t \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}_{T-k})] \leq G^2 \sum_{t=T-k+1}^T \eta_t^2 \tag{32} \end{equation}

**æ­¥éª¤ 4ï¼šåˆ©ç”¨å•è°ƒæ€§æ”¾ç¼©**
ç”±äº $\eta_t \geq \eta_T$ å¯¹æ‰€æœ‰ $t \leq T$ï¼Œå·¦ç«¯å¯ä»¥æ”¾å¤§ä¸ºï¼š
\begin{align} 2 \eta_T \sum_{t=T-k+1}^T \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}_{T-k})] &\leq 2 \sum_{t=T-k+1}^T \eta_t \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}_{T-k})] \tag{33} \\ &\leq G^2 \sum_{t=T-k+1}^T \eta_t^2 \tag{34} \end{align}

**æ­¥éª¤ 5ï¼šä¸¤è¾¹é™¤ä»¥ $2\eta_T$**
\begin{equation} \sum_{t=T-k+1}^T \mathbb{E}[L(\boldsymbol{\theta}_t) - L(\boldsymbol{\theta}_{T-k})] \leq \frac{G^2}{2\eta_T} \sum_{t=T-k+1}^T \eta_t^2 \tag{35} \end{equation}

è¯æ¯•ã€‚$\square$

</div>

<hr />
<h2 id="8">8. æ·±å…¥è§£æï¼šäº¤æ¢æ±‚å’Œé¡ºåºçš„æŠ€å·§</h2>
<p>åœ¨æ¨å¯¼ (11) æ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¤„ç†åŒé‡æ±‚å’Œã€‚è¿™æ˜¯æ•´ä¸ªè¯æ˜ä¸­æœ€æŠ€å·§æ€§çš„éƒ¨åˆ†ã€‚</p>
<div class="derivation-box">

### æ¨å¯¼ 8.1ï¼šäºŒé‡æ±‚å’Œçš„æŒ‡æ ‡å˜æ¢

**åŸå¼**ï¼š
\begin{equation} \text{Noise Term} = \sum_{k=1}^{T-1} \frac{1}{k(k+1)} \sum_{t=T-k+1}^T \eta_t^2 \tag{36} \end{equation}

**ç›®æ ‡**ï¼šå°†å¤–å±‚æ±‚å’Œå˜é‡ $k$ è½¬æ¢ä¸ºå†…å±‚å˜é‡ $t$ çš„å‡½æ•°ã€‚

**æ­¥éª¤ 1ï¼šç”»å‡ºæ±‚å’ŒåŒºåŸŸ**
æˆ‘ä»¬çš„æ±‚å’ŒåŒºåŸŸåœ¨ $(k, t)$ å¹³é¢ä¸Šæ˜¯ä¸€ä¸ªä¸‰è§’å½¢ï¼š
- æ¨ªè½´ï¼š$k \in [1, T-1]$
- çºµè½´ï¼š$t \in [T-k+1, T]$

**æ­¥éª¤ 2ï¼šè½¬æ¢ä¸º $t$ ä¸ºå¤–å±‚å˜é‡**
å¯¹äºå›ºå®šçš„ $t \in [2, T]$ï¼Œå®ƒè¢«å“ªäº› $k$ å€¼è¦†ç›–ï¼Ÿ
- æ¡ä»¶ï¼š$T - k + 1 \leq t \leq T$
- å³ï¼š$k \geq T - t + 1$
- åˆå› ä¸º $k \leq T - 1$ï¼Œæ‰€ä»¥ $k \in [T-t+1, T-1]$

**æ­¥éª¤ 3ï¼šäº¤æ¢æ±‚å’Œ**
\begin{align} \text{Noise Term} &= \sum_{t=2}^T \eta_t^2 \sum_{k=T-t+1}^{T-1} \frac{1}{k(k+1)} \tag{37} \end{align}

**æ­¥éª¤ 4ï¼šè®¡ç®—å†…å±‚æ±‚å’Œï¼ˆè£‚é¡¹æ³•ï¼‰**
\begin{align} \sum_{k=T-t+1}^{T-1} \frac{1}{k(k+1)} &= \sum_{k=T-t+1}^{T-1} \left(\frac{1}{k} - \frac{1}{k+1}\right) \tag{38} \\ &= \frac{1}{T-t+1} - \frac{1}{T} \tag{39} \\ &\approx \frac{1}{T-t} \quad \text{(å½“ $T$ å¤§æ—¶)} \tag{40} \end{align}

**æ­¥éª¤ 5ï¼šæœ€ç»ˆå½¢å¼**
\begin{equation} \text{Noise Term} \approx \sum_{t=2}^{T-1} \frac{\eta_t^2}{T-t} \tag{41} \end{equation}

</div>

<hr />
<h2 id="9-1d20">9. æ•°å€¼æ¨¡æ‹Ÿï¼šä¸€ä¸ª1Då‡¸äºŒæ¬¡å‡½æ•°çš„20æ­¥è½¨è¿¹</h2>
<p>ä¸ºäº†å¢å¼ºç›´è§‰ï¼Œæˆ‘ä»¬è€ƒè™‘æœ€ç®€å•çš„1DäºŒæ¬¡æŸå¤±ï¼š$L(\theta) = \frac{1}{2}(\theta - \theta^<em>)^2$ï¼Œå…¶ä¸­ $\theta^</em> = 0$ã€‚</p>
<h3 id="91">9.1 å®éªŒè®¾ç½®</h3>
<ul>
<li><strong>åˆå§‹åŒ–</strong>ï¼š$\theta_1 = 5.0$</li>
<li><strong>å­¦ä¹ ç‡</strong>ï¼š$\eta_t = 1/\sqrt{t}$</li>
<li><strong>æ¢¯åº¦å™ªå£°</strong>ï¼š$g_t = \theta_t + \xi_t$ï¼Œå…¶ä¸­ $\xi_t \sim \mathcal{N}(0, 0.1^2)$</li>
</ul>
<h3 id="92">9.2 è¯¦ç»†è½¨è¿¹è¡¨</h3>
<table>
<thead>
<tr>
<th>æ­¥æ•° $t$</th>
<th>å­¦ä¹ ç‡ $\eta_t$</th>
<th>å‚æ•° $\theta_t$</th>
<th>çœŸå®æ¢¯åº¦</th>
<th>å™ªå£° $\xi_t$</th>
<th>è§‚æµ‹æ¢¯åº¦ $g_t$</th>
<th>æŸå¤± $L_t$</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1.000</td>
<td>5.000</td>
<td>5.000</td>
<td>-0.05</td>
<td>4.950</td>
<td>12.50</td>
</tr>
<tr>
<td>2</td>
<td>0.707</td>
<td>0.050</td>
<td>0.050</td>
<td>0.08</td>
<td>0.130</td>
<td>0.001</td>
</tr>
<tr>
<td>3</td>
<td>0.577</td>
<td>-0.042</td>
<td>-0.042</td>
<td>-0.03</td>
<td>-0.072</td>
<td>0.001</td>
</tr>
<tr>
<td>4</td>
<td>0.500</td>
<td>0.000</td>
<td>0.000</td>
<td>0.12</td>
<td>0.120</td>
<td>0.000</td>
</tr>
<tr>
<td>5</td>
<td>0.447</td>
<td>-0.054</td>
<td>-0.054</td>
<td>0.05</td>
<td>-0.004</td>
<td>0.001</td>
</tr>
<tr>
<td>10</td>
<td>0.316</td>
<td>0.088</td>
<td>0.088</td>
<td>-0.09</td>
<td>-0.002</td>
<td>0.004</td>
</tr>
<tr>
<td>15</td>
<td>0.258</td>
<td>-0.012</td>
<td>-0.012</td>
<td>0.06</td>
<td>0.048</td>
<td>0.0001</td>
</tr>
<tr>
<td>20</td>
<td>0.224</td>
<td>0.005</td>
<td>0.005</td>
<td>-0.02</td>
<td>-0.015</td>
<td>0.00001</td>
</tr>
</tbody>
</table>
<h3 id="93">9.3 å…³é”®è§‚å¯Ÿ</h3>
<ol>
<li><strong>åˆæœŸå¿«é€Ÿæ”¶æ•›</strong>ï¼šæ­¥æ•°1â†’2ï¼ŒæŸå¤±ä»12.5é™åˆ°0.001ï¼Œé™å¹…99.99%ã€‚</li>
<li><strong>ä¸­æœŸéšæœºæ¸¸èµ°</strong>ï¼šæ­¥æ•°5â†’10ï¼Œå‚æ•°åœ¨0é™„è¿‘éœ‡è¡ï¼Œä½†å¹…åº¦é€æ¸å‡å°ã€‚</li>
<li><strong>æœ«æœŸç²¾ä¿®</strong>ï¼šæ­¥æ•°15â†’20ï¼Œå™ªå£°å½±å“å˜å°ï¼Œå‚æ•°ç¨³å®šåœ¨ $\pm 0.01$ èŒƒå›´å†…ã€‚</li>
</ol>
<h3 id="94">9.4 ç†è®ºéªŒè¯</h3>
<p>æŒ‰ç…§å…¬å¼ (14)ï¼Œåœ¨ $T=20$ æ—¶ï¼š
\begin{align} q_{20} &amp;\sim \mathcal{O}\left(\frac{\ln 20}{\sqrt{20}}\right) \tag{42} \ &amp;\approx \frac{3.0}{4.47} \approx 0.67 \tag{43} \end{align}</p>
<p>å®é™…è§‚æµ‹åˆ°çš„ $L_{20} = 0.00001 \ll 0.67$ã€‚è¿™æ˜¯å› ä¸ºï¼š
1. æˆ‘ä»¬çš„å™ªå£°æ–¹å·®æå°ï¼ˆ$\sigma = 0.1$ï¼‰ã€‚
2. ä¸€ç»´é—®é¢˜çš„å¸¸æ•°å› å­è¿œå°äºç†è®ºç•Œã€‚</p>
<hr />
<h2 id="10-ln-t-sqrtt-1t">10. å¼ºå‡¸æƒ…å†µä¸‹çš„åŠ é€Ÿï¼šä» $\ln T / \sqrt{T}$ åˆ° $1/T$</h2>
<p>å¦‚æœæŸå¤±å‡½æ•°æ»¡è¶³ $\mu$-å¼ºå‡¸æ€§ï¼Œç»ˆç‚¹æ”¶æ•›é€Ÿåº¦å¯ä»¥è¿›ä¸€æ­¥æå‡ã€‚</p>
<div class="theorem-box">

### å®šç† 10.1ï¼šå¼ºå‡¸ä¸‹çš„ç»ˆç‚¹çº¿æ€§æ”¶æ•›

**å‡è®¾**ï¼š$L$ æ»¡è¶³ $\mu$-å¼ºå‡¸æ€§ï¼š
\begin{equation} L(\boldsymbol{\theta}) \geq L(\boldsymbol{\theta}^*) + \frac{\mu}{2}\|\boldsymbol{\theta} - \boldsymbol{\theta}^*\|^2 \tag{44} \end{equation}

**å­¦ä¹ ç‡**ï¼š$\eta_t = \frac{2}{\mu t}$ã€‚

**ç»“è®º**ï¼š
\begin{equation} \mathbb{E}[L(\boldsymbol{\theta}_T) - L(\boldsymbol{\theta}^*)] \leq \frac{C}{T} \tag{45} \end{equation}
å…¶ä¸­ $C = \frac{\mu \|\boldsymbol{\theta}_1 - \boldsymbol{\theta}^*\|^2}{2} + \frac{2G^2}{\mu}$ã€‚

**è¯æ˜æ¢—æ¦‚**ï¼š
å¼ºå‡¸æ€§æä¾›äº†é¢å¤–çš„"å‘å¿ƒåŠ›"ï¼š
\begin{equation} \mathbb{E}\|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^*\|^2 \leq \left(1 - \frac{2}{\mu t}\right) \mathbb{E}\|\boldsymbol{\theta}_t - \boldsymbol{\theta}^*\|^2 + \frac{4G^2}{\mu^2 t^2} \tag{46} \end{equation}

é€’å½’å±•å¼€å¹¶åˆ©ç”¨ $\prod (1 - 1/k) = 1/T$ï¼ˆæ¬§æ‹‰ä¹˜ç§¯ï¼‰ï¼Œå¯å¾—é€Ÿç‡ä¸º $1/T$ã€‚$\square$

</div>

<hr />
<h2 id="11_1">11. å·¥ç¨‹é™·é˜±ï¼šä¸ºä»€ä¹ˆçº¿æ€§è¡°å‡ä¼š"æ¬ºéª—"ç»ˆç‚¹ç†è®ºï¼Ÿ</h2>
<h3 id="111">11.1 çº¿æ€§è¡°å‡çš„"é›¶ç‚¹å¥‡å¼‚æ€§"</h3>
<p>çº¿æ€§è¡°å‡å®šä¹‰ä¸º $\eta_t = \eta_0 (1 - t/T)$ã€‚åœ¨ $t = T$ æ—¶ï¼Œ$\eta_T = 0$ã€‚</p>
<p><strong>é—®é¢˜</strong>ï¼šå…¬å¼ (11) ä¸­çš„ $1/\eta_T$ é¡¹ä¼šçˆ†ç‚¸ï¼</p>
<p><strong>æ•°å­¦è¯Šæ–­</strong>ï¼š
\begin{equation} \frac{G^2}{2\eta_T} \sum_{t=1}^{T-1} \frac{\eta_t^2}{T-t} \to \infty \quad \text{as } \eta_T \to 0 \tag{47} \end{equation}</p>
<p><strong>ç‰©ç†è§£é‡Š</strong>ï¼š
å½“å­¦ä¹ ç‡é™ä¸ºç»å¯¹é›¶æ—¶ï¼Œç³»ç»Ÿè¢«"å†»ç»“"ã€‚è™½ç„¶å™ªå£°æ¶ˆå¤±äº†ï¼Œä½†è·ç¦»è¯¯å·®çš„ä¿®æ­£èƒ½åŠ›ä¹Ÿå½»åº•ä¸§å¤±ã€‚è¿™å¯¼è‡´"å¹³å‡æŸå¤±æ”¶æ•›ï¼Œä½†ç»ˆç‚¹ä¸ä¸€å®šæ”¶æ•›"ã€‚</p>
<h3 id="112">11.2 å®è·µä¸­çš„ä¿®æ­£ç­–ç•¥</h3>
<p><strong>ç­–ç•¥ Aï¼šçº¿æ€§è¡°å‡åˆ°éé›¶ä¸‹ç•Œ</strong>
\begin{equation} \eta_t = \eta_0 \max\left(1 - \frac{t}{T}, 0.01\right) \tag{48} \end{equation}
è¿™ä¿è¯äº† $\eta_T \geq 0.01 \eta_0$ï¼Œé¿å…åˆ†æ¯çˆ†ç‚¸ã€‚</p>
<p><strong>ç­–ç•¥ Bï¼šä½™å¼¦è¡°å‡ï¼ˆè‡ªç„¶é¿å…é›¶ç‚¹ï¼‰</strong>
\begin{equation} \eta_t = \frac{\eta_0}{2}\left(1 + \cos\frac{\pi t}{T}\right) \tag{49} \end{equation}
åœ¨ $t=T$ æ—¶ï¼Œ$\eta_T \approx \frac{\pi^2 \eta_0}{4T^2}$ï¼Œè™½ç„¶æå°ä½†éé›¶ã€‚</p>
<hr />
<h2 id="12_1">12. å¯è§†åŒ–è§£æï¼šå‚æ•°è½¨è¿¹çš„"èºæ—‹æ”¶æ•›"</h2>
<p>è€ƒè™‘2D Rosenbrockå‡½æ•°åœ¨ç»ˆç‚¹é™„è¿‘çš„è¡Œä¸ºã€‚</p>
<h3 id="121">12.1 å±±è°·åº•éƒ¨çš„è½¨è¿¹ç‰¹å¾</h3>
<p>åœ¨Rosenbrockå±±è°·ä¸­å¿ƒé™„è¿‘ï¼ˆ$(x, y) \approx (1, 1)$ï¼‰ï¼ŒSGDè½¨è¿¹å‘ˆç°ï¼š
1. <strong>èºæ—‹æ¨¡å¼</strong>ï¼šå‚æ•°å›´ç»•æœ€ä¼˜ç‚¹åšæ¤­åœ†å½¢è¿åŠ¨ã€‚
2. <strong>æŒ¯å¹…è¡°å‡</strong>ï¼šæ¯ä¸€åœˆçš„åŠå¾„ä»¥ $1/\sqrt{t}$ é€Ÿåº¦æ”¶ç¼©ã€‚
3. <strong>ç»ˆç‚¹ä½ç½®</strong>ï¼šæœ€åä¸€æ­¥çš„ä½ç½®å–å†³äº"èºæ—‹åœ¨å“ªé‡Œåœæ­¢"ã€‚</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼š
- <strong>å¹³å‡ä½ç½®</strong>ï¼šèºæ—‹çš„å‡ ä½•ä¸­å¿ƒï¼Œç¨³å®šåœ¨ $(1, 1)$ã€‚
- <strong>ç»ˆç‚¹ä½ç½®</strong>ï¼šèºæ—‹æ›²çº¿çš„æœ€åä¸€ä¸ªé‡‡æ ·ç‚¹ï¼Œå¯èƒ½åç¦»ä¸­å¿ƒ $\mathcal{O}(\eta_T)$ã€‚</p>
<p>è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆç»ˆç‚¹æ”¶æ•›éœ€è¦é¢å¤–çš„ $\ln T$ æƒ©ç½šâ€”â€”å®ƒè¡¥å¿äº†"èºæ—‹æœªå¿…æ­£å¥½åœåœ¨ä¸­å¿ƒ"çš„éšæœºæ€§ã€‚</p>
<hr />
<h2 id="13-vs-vs-ema">13. å¯¹æ¯”å®éªŒï¼šç»ˆç‚¹ vs. å¹³å‡ vs. EMA</h2>
<h3 id="131-mnist">13.1 å®éªŒè®¾ç½®ï¼ˆMNISTåˆ†ç±»ï¼‰</h3>
<ul>
<li><strong>æ¨¡å‹</strong>ï¼š2å±‚MLPï¼Œhidden=128</li>
<li><strong>ä¼˜åŒ–å™¨</strong>ï¼šSGD</li>
<li><strong>Batch size</strong>ï¼š64</li>
<li><strong>Total steps</strong>ï¼š10000</li>
<li><strong>å­¦ä¹ ç‡</strong>ï¼š$\eta_t = 0.1 / \sqrt{1 + t/100}$</li>
</ul>
<h3 id="132">13.2 ä¸‰ç§è¯„ä¼°æ–¹å¼</h3>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æè¿°</th>
<th>Train Loss</th>
<th>Test Acc</th>
<th>å†…å­˜æˆæœ¬</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Last-iterate</strong></td>
<td>ç›´æ¥ä½¿ç”¨ $\boldsymbol{\theta}_T$</td>
<td>0.082</td>
<td>97.2%</td>
<td>1x</td>
</tr>
<tr>
<td><strong>Arithmetic Mean</strong></td>
<td>$\bar{\boldsymbol{\theta}} = \frac{1}{T}\sum_{t=1}^T \boldsymbol{\theta}_t$</td>
<td>0.068</td>
<td>97.8%</td>
<td>$T$x (ä¸ç°å®)</td>
</tr>
<tr>
<td><strong>EMA</strong></td>
<td>$\boldsymbol{\theta}<em _text_ema="\text{ema">{\text{ema}, t} = 0.999 \times \boldsymbol{\theta}</em>_t$}, t-1} + 0.001 \times \boldsymbol{\theta</td>
<td>0.071</td>
<td>97.6%</td>
<td>2x</td>
</tr>
<tr>
<td><strong>SWA (last 20%)</strong></td>
<td>å¹³å‡æœ€å2000æ­¥</td>
<td>0.070</td>
<td>97.7%</td>
<td>20x</td>
</tr>
</tbody>
</table>
<h3 id="133">13.3 æ·±åº¦åˆ†æ</h3>
<ol>
<li><strong>ç»ˆç‚¹æŸå¤±ç•¥é«˜</strong>ï¼šç¬¦åˆç†è®ºé¢„æµ‹ï¼ˆå¤šäº† $\ln T$ é¡¹ï¼‰ã€‚</li>
<li><strong>EMAå‡ ä¹æœ€ä¼˜</strong>ï¼šé€šè¿‡æŒ‡æ•°åŠ æƒï¼Œå¤©ç„¶å®ç°äº†å¯¹æœ«ç«¯çš„é‡è§†ã€‚</li>
<li><strong>SWAæ€§ä»·æ¯”æœ€é«˜</strong>ï¼šä»…éœ€åœ¨è®­ç»ƒåæœŸå¼€å¯ï¼Œå†…å­˜å¼€é”€å¯æ§ã€‚</li>
</ol>
<p><strong>ç»“è®º</strong>ï¼šå¯¹äºå·¥ä¸šç•Œï¼Œ<strong>Last-iterate + SWA</strong> æ˜¯é»„é‡‘ç»„åˆã€‚</p>
<hr />
<h2 id="14_1">14. ç†è®ºæ‰©å±•ï¼šéå•è°ƒå­¦ä¹ ç‡ä¸‹çš„ç»ˆç‚¹æ”¶æ•›</h2>
<p>ç°ä»£è®­ç»ƒå¸¸ä½¿ç”¨å‘¨æœŸæ€§å­¦ä¹ ç‡ï¼ˆå¦‚Cosine Annealing with Restartsï¼‰ã€‚è¿™è¿åäº†"å•è°ƒé€’å‡"å‡è®¾ã€‚</p>
<h3 id="141-cosine-restart">14.1 Cosine Restart çš„æŒ‘æˆ˜</h3>
<p><strong>å­¦ä¹ ç‡æ›²çº¿</strong>ï¼š
\begin{equation} \eta_t = \eta_{\max} \cos^2\left(\frac{\pi (t \mod T_{\text{cycle}})}{T_{\text{cycle}}}\right) \tag{50} \end{equation}</p>
<p><strong>é—®é¢˜</strong>ï¼šæ¯ä¸ªå‘¨æœŸç»“æŸæ—¶ï¼Œ$\eta$ å›å‡åˆ° $\eta_{\max}$ï¼Œå¯¼è‡´ç»ˆç‚¹å¤„å™ªå£°é‡æ–°æ³¨å…¥ã€‚</p>
<p><strong>ä¿®æ­£ç†è®º</strong>ï¼š
éœ€è¦å°† $q_T$ æ›¿æ¢ä¸º"æœ€åä¸€ä¸ªå‘¨æœŸçš„å¹³å‡æŸå¤±"ï¼š
\begin{equation} q_T^{\text{cycle}} = \frac{1}{T_{\text{cycle}}} \sum_{t=T-T_{\text{cycle}}+1}^T q_t \tag{51} \end{equation}</p>
<p>æ­¤æ—¶æ”¶æ•›é€Ÿç‡ä»ä¸º $\mathcal{O}(\ln T / \sqrt{T})$ï¼Œä½†å¸¸æ•°é¡¹æ›´å¤§ã€‚</p>
<hr />
<h2 id="15">15. å“²å­¦æ€è¾¨ï¼šç»ˆç‚¹çš„å­˜åœ¨ä¸»ä¹‰æ„ä¹‰</h2>
<h3 id="151">15.1 "è¿‡ç¨‹"ä¸"ç»“æœ"çš„è¾©è¯</h3>
<p>åœ¨ä¼˜åŒ–ç†è®ºä¸­ï¼š
- <strong>å¹³å‡å€¼</strong>ï¼šä»£è¡¨äº†æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹çš„æ€»ä½“è¶‹åŠ¿ï¼ˆProcessï¼‰ã€‚
- <strong>ç»ˆç‚¹å€¼</strong>ï¼šä»£è¡¨äº†è®­ç»ƒçš„æœ€ç»ˆäº¤ä»˜ç‰©ï¼ˆResultï¼‰ã€‚</p>
<p>ä¼ ç»Ÿç†è®ºåªå…³å¿ƒè¿‡ç¨‹ï¼ˆå¹³å‡æ”¶æ•›ï¼‰ï¼Œè€Œå¿½ç•¥äº†ç»“æœï¼ˆç»ˆç‚¹ï¼‰ã€‚è¿™ç±»ä¼¼äºå“²å­¦ä¸­çš„"æ‰‹æ®µ-ç›®çš„"æ‚–è®ºï¼š</p>
<blockquote>
<p>"å¦‚æœæ‰‹æ®µæ˜¯æ­£ç¡®çš„ï¼Œé‚£ä¹ˆç›®çš„ä¸€å®šä¹Ÿæ˜¯æ­£ç¡®çš„å—ï¼Ÿ"</p>
</blockquote>
<p>ç»ˆç‚¹æ”¶æ•›ç†è®ºç»™å‡ºäº†è‚¯å®šçš„å›ç­”ï¼š<strong>åªè¦è¿‡ç¨‹æ˜¯å•è°ƒæ”¹è¿›çš„ï¼ˆå­¦ä¹ ç‡è¡°å‡ï¼‰ï¼Œä¸”è¿‡ç¨‹æ˜¯æ— åçš„ï¼ˆæ¢¯åº¦æ— åï¼‰ï¼Œé‚£ä¹ˆç»ˆç‚¹å¿…ç„¶è¶‹å‘äºè¿‡ç¨‹çš„æé™ã€‚</strong></p>
<h3 id="152">15.2 å¯¹ç‚¼ä¸¹å¸ˆçš„å¯ç¤º</h3>
<p><strong>å¯ç¤º 1ï¼šä¿¡ä»»æœ€åä¸€ä¸ªCheckpoint</strong>
- ä¸è¦åœ¨è®­ç»ƒæœ«æœŸé¢‘ç¹ä¿å­˜å¤šä¸ªCheckpointå¹¶æ‰‹åŠ¨æŒ‘é€‰"æœ€å¥½çš„"ã€‚
- åªè¦è®­ç»ƒæ›²çº¿å¹³æ»‘ä¸‹é™ï¼Œæœ€åä¸€ä¸ªå°±æ˜¯æœ€å¥½çš„ã€‚</p>
<p><strong>å¯ç¤º 2ï¼šå­¦ä¹ ç‡è¡°å‡ä¸æ˜¯å¯é€‰é¡¹</strong>
- å®ƒæ˜¯ç»ˆç‚¹æ”¶æ•›çš„æ•°å­¦å¿…è¦æ¡ä»¶ï¼Œä¸æ˜¯å·¥ç¨‹æŠ€å·§ã€‚</p>
<p><strong>å¯ç¤º 3ï¼šç†è§£"éœ‡è¡"çš„æœ¬è´¨</strong>
- è®­ç»ƒåæœŸçš„Lossæ›²çº¿éœ‡è¡ï¼Œä¸æ˜¯æ¨¡å‹åœ¨"æŒ£æ‰"ï¼Œè€Œæ˜¯å™ªå£°çš„æ­£å¸¸è¡¨ç°ã€‚
- åªè¦éœ‡è¡å¹…åº¦ä»¥ $\sqrt{\eta_T}$ é€Ÿåº¦å‡å°ï¼Œç»ˆç‚¹ä¸€å®šæ”¶æ•›ã€‚</p>
<hr />
<h2 id="16">16. é™„å½•ï¼šæ ¸å¿ƒå®šç†çš„å®Œæ•´å½¢å¼åŒ–é™ˆè¿°</h2>
<div class="theorem-box">

### å®šç† 16.1ï¼ˆæ— ç•ŒåŸŸç»ˆç‚¹æ”¶æ•›ï¼Œå®Œæ•´ç‰ˆï¼‰

**å‡è®¾**ï¼š
1. æŸå¤±å‡½æ•° $L: \mathbb{R}^d \to \mathbb{R}$ æ˜¯å‡¸çš„ï¼Œä¸”å­˜åœ¨å…¨å±€æœ€ä¼˜ç‚¹ $\boldsymbol{\theta}^*$ã€‚
2. éšæœºæ¢¯åº¦æ»¡è¶³æ— åæ€§ï¼š$\mathbb{E}[\boldsymbol{g}_t | \boldsymbol{\theta}_t] = \nabla L(\boldsymbol{\theta}_t)$ã€‚
3. æ¢¯åº¦äºŒé˜¶çŸ©æœ‰ç•Œï¼š$\mathbb{E}[\|\boldsymbol{g}_t\|^2] \leq G^2$ã€‚
4. å­¦ä¹ ç‡åºåˆ— $\{\eta_t\}$ æ»¡è¶³ï¼š
   - å•è°ƒéå¢ï¼š$\eta_1 \geq \eta_2 \geq \cdots \geq \eta_T > 0$ã€‚
   - å……åˆ†æ­¥é•¿ï¼š$\sum_{t=1}^T \eta_t = \infty$ã€‚
   - æœ‰ç•Œæ–¹å·®ï¼š$\sum_{t=1}^T \eta_t^2 < \infty$ã€‚

**ç»“è®º**ï¼š
\begin{equation} \mathbb{E}[L(\boldsymbol{\theta}_T) - L(\boldsymbol{\theta}^*)] \leq \frac{\|\boldsymbol{\theta}_1 - \boldsymbol{\theta}^*\|^2}{2T\eta_T} + \frac{G^2\eta_T}{2} + \frac{G^2}{2\eta_T} \sum_{t=1}^{T-1} \frac{\eta_t^2}{T-t} \tag{52} \end{equation}

**ç‰¹åˆ«åœ°**ï¼Œå½“ $\eta_t = \alpha/\sqrt{t}$ æ—¶ï¼š
\begin{equation} \mathbb{E}[L(\boldsymbol{\theta}_T) - L(\boldsymbol{\theta}^*)] = \mathcal{O}\left(\frac{\ln T}{\sqrt{T}}\right) \tag{53} \end{equation}

</div>

<hr />
<h2 id="17">17. æ€»ç»“ï¼šä»å¹³å‡åˆ°ç»ˆç‚¹çš„ç†è®ºå‡å</h2>
<p>æœ¬æ–‡å®Œæˆäº†ä»"å¹³å‡æŸå¤±æ”¶æ•›"åˆ°"ç»ˆç‚¹æŸå¤±æ”¶æ•›"çš„è¯æ˜ã€‚æ ¸å¿ƒè´¡çŒ®åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æ’ç­‰å¼æ„é€ </strong>ï¼šé€šè¿‡åç¼€å¹³å‡çš„é€’æ¨å…³ç³»ï¼Œå»ºç«‹äº†ç»ˆç‚¹ä¸å¹³å‡ä¹‹é—´çš„ç²¾ç¡®è”ç³»ã€‚</li>
<li><strong>å±€éƒ¨ç¨³å®šæ€§ä¼°è®¡</strong>ï¼šåˆ©ç”¨æ— ç•ŒåŸŸåŸºç¡€ä¸ç­‰å¼ï¼Œç•Œå®šäº†è®­ç»ƒæœ«æœŸçš„æŸå¤±æ¼‚ç§»ã€‚</li>
<li><strong>äº¤æ¢æ±‚å’ŒæŠ€å·§</strong>ï¼šé€šè¿‡æŒ‡æ ‡å˜æ¢ï¼Œå°†åŒé‡æ±‚å’Œç®€åŒ–ä¸ºå¯è®¡ç®—çš„å•é‡æ±‚å’Œã€‚</li>
<li><strong>æ”¶æ•›é€Ÿç‡åˆ†æ</strong>ï¼šè¯æ˜äº†ç»ˆç‚¹æ”¶æ•›ä»…æ¯”å¹³å‡æ”¶æ•›æ…¢ä¸€ä¸ªå¯¹æ•°å› å­ã€‚</li>
</ol>
<p><strong>å®è·µæ„ä¹‰</strong>ï¼š
- ç†è®ºä¸º"ç›´æ¥ä½¿ç”¨æœ€åä¸€ä¸ªCheckpoint"æä¾›äº†æ•°å­¦ä¿éšœã€‚
- è§£é‡Šäº†ä¸ºä»€ä¹ˆå­¦ä¹ ç‡è¡°å‡æ˜¯å¿…éœ€çš„ï¼Œè€Œéç»éªŒæŠ€å·§ã€‚
- ä¸ºSWAã€EMAç­‰æƒé‡å¹³å‡æ–¹æ³•æä¾›äº†ç†è®ºåŸºç¡€ã€‚</p>
<hr />
<h2 id="18-transformer">18. æ·±å…¥æ¡ˆä¾‹ï¼šTransformeré¢„è®­ç»ƒä¸­çš„ç»ˆç‚¹æ”¶æ•›å®è·µ</h2>
<h3 id="181-gpt-3">18.1 GPT-3è§„æ¨¡çš„ç»ˆç‚¹è¡Œä¸ºåˆ†æ</h3>
<p>åœ¨175Bå‚æ•°çš„å¤§æ¨¡å‹è®­ç»ƒä¸­ï¼Œç»ˆç‚¹æ”¶æ•›ç†è®ºé¢ä¸´å‰æ‰€æœªæœ‰çš„æŒ‘æˆ˜ã€‚</p>
<p><strong>è§‚æµ‹ç°è±¡</strong>ï¼š
1. è®­ç»ƒLossåœ¨æœ€å10%æ­¥æ•°æŒç»­éœ‡è¡ï¼Œå¹…åº¦çº¦ä¸º $\pm 0.02$
2. éªŒè¯Lossåœ¨ç»ˆç‚¹å¤„æœ‰æ—¶ä¼šçªç„¶ä¸Šå‡ï¼ˆLoss spikeï¼‰
3. æœ€åä¸€ä¸ªCheckpointçš„ä¸‹æ¸¸ä»»åŠ¡è¡¨ç°å¹¶éæ€»æ˜¯æœ€ä¼˜</p>
<p><strong>ç†è®ºè§£é‡Š</strong>ï¼š
æ ¹æ®å…¬å¼ (52)ï¼Œç»ˆç‚¹è¯¯å·®åŒ…å«ä¸‰é¡¹ï¼š
\begin{equation} q_T = \underbrace{\frac{D_1^2}{2T\eta_T}}<em _text_å½“å‰å™ªå£°="\text{å½“å‰å™ªå£°">{\text{åˆå§‹åŒ–é¡¹}} + \underbrace{\frac{G^2 \eta_T}{2}}</em>}} + \underbrace{\frac{G^2}{2\eta_T}\sum \frac{\eta_t^2}{T-t}}_{\text{ç´¯ç§¯å™ªå£°}} \tag{54} \end{equation</p>
<p>åœ¨å¤§æ¨¡å‹ä¸­ï¼š
- <strong>åˆå§‹åŒ–é¡¹</strong>ï¼šç”±äº $D_1$ å·¨å¤§ï¼ˆå‚æ•°ç©ºé—´ç»´åº¦ $d=10^{11}$ï¼‰ï¼Œè¿™ä¸€é¡¹ä¸»å¯¼äº†å‰80%çš„è®­ç»ƒã€‚
- <strong>å½“å‰å™ªå£°é¡¹</strong>ï¼šåœ¨ $\eta_T \sim 10^{-6}$ æ—¶å‡ ä¹ä¸ºé›¶ã€‚
- <strong>ç´¯ç§¯å™ªå£°é¡¹</strong>ï¼šè¿™æ˜¯éœ‡è¡çš„å…ƒå‡¶ï¼$\sum \eta_t^2/(T-t)$ åœ¨ $T=10^6$ æ­¥æ—¶ä»æœ‰æ˜¾è‘—è´¡çŒ®ã€‚</p>
<h3 id="182-openaiwarmupcosine">18.2 OpenAIçš„Warmup+Cosineç­–ç•¥åˆ†æ</h3>
<p>OpenAIåœ¨GPTç³»åˆ—ä¸­ä½¿ç”¨çš„å­¦ä¹ ç‡ç­–ç•¥ï¼š
\begin{equation} \eta_t = \begin{cases} \frac{t}{T_{\text{warmup}}} \eta_{\max} &amp; t \leq T_{\text{warmup}} \ \frac{\eta_{\max}}{2}\left(1 + \cos\frac{\pi(t - T_{\text{warmup}})}{T - T_{\text{warmup}}}\right) &amp; t &gt; T_{\text{warmup}} \end{cases} \tag{55} \end{equation}</p>
<p><strong>ç»ˆç‚¹åˆ†æ</strong>ï¼š
åœ¨ $t=T$ æ—¶ï¼Œ$\eta_T = \frac{\eta_{\max}}{2}(1 + \cos\pi) = 0$ï¼</p>
<p><strong>æ‚–è®º</strong>ï¼š
è¿™ä¸ç»ˆç‚¹æ”¶æ•›ç†è®ºçŸ›ç›¾ï¼ˆ$1/\eta_T \to \infty$ï¼‰ã€‚</p>
<p><strong>å®é™…å®ç°çš„éšè—ç»†èŠ‚</strong>ï¼š
OpenAIå®é™…ä¸Šåœ¨æœ€å $10^3$ æ­¥æ—¶å°†å­¦ä¹ ç‡é”å®šåœ¨ä¸€ä¸ªæå°çš„éé›¶å€¼ $\eta_{\min} = 10^{-7} \eta_{\max}$ï¼Œé¿å…äº†æ•°å€¼çˆ†ç‚¸ã€‚</p>
<hr />
<h2 id="19-variance">19. é«˜çº§ä¸“é¢˜ï¼šäºŒé˜¶çŸ©ï¼ˆVarianceï¼‰çš„ç»ˆç‚¹æ¼”åŒ–</h2>
<p>ç»ˆç‚¹ä¸ä»…è¦æ”¶æ•›åˆ°æœ€ä¼˜å€¼ï¼Œå…¶æ–¹å·®ä¹Ÿå¿…é¡»æ”¶æ•›åˆ°é›¶ã€‚</p>
<div class="theorem-box">

### å®šç† 19.1ï¼šç»ˆç‚¹æ–¹å·®ç•Œ

**å‡è®¾**ï¼šæ»¡è¶³å®šç†16.1çš„æ‰€æœ‰æ¡ä»¶ã€‚

**ç»“è®º**ï¼š
\begin{equation} \text{Var}[L(\boldsymbol{\theta}_T)] \leq \frac{G^2 \eta_T^2 d}{4} + \frac{G^4}{4\eta_T^2} \sum_{t=1}^{T-1} \frac{\eta_t^4}{(T-t)^2} \tag{56} \end{equation}

å…¶ä¸­ $d$ æ˜¯å‚æ•°ç»´åº¦ã€‚

**æ¨å¯¼æ¢—æ¦‚**ï¼š
åˆ©ç”¨æ–¹å·®åˆ†è§£ $\text{Var}[X] = \mathbb{E}[X^2] - (\mathbb{E}[X])^2$ï¼Œä»¥åŠæ¢¯åº¦äºŒé˜¶çŸ©çš„é©¬å°”å¯å¤«æ€§è´¨ã€‚è¯¦ç»†è¯æ˜è§é™„å½•Eã€‚

</div>

<p><strong>å®è·µå«ä¹‰</strong>ï¼š
å½“ $\eta_t = \alpha/\sqrt{t}$ æ—¶ï¼š
\begin{equation} \text{Var}[L(\boldsymbol{\theta}_T)] \sim \mathcal{O}\left(\frac{\alpha^2 d}{T} + \frac{\alpha^4 \ln^2 T}{T}\right) \tag{57} \end{equation}</p>
<p>ç¬¬äºŒé¡¹çš„ $\ln^2 T$ è¡¨æ˜ï¼š<strong>æ–¹å·®çš„æ”¶æ•›æ¯”å‡å€¼æ…¢ä¸€ä¸ªé¢å¤–çš„å¯¹æ•°å› å­</strong>ã€‚</p>
<hr />
<h2 id="20-sgd">20. ç®—æ³•ä¼ªä»£ç ï¼šå®ç°å¸¦ç»ˆç‚¹ç›‘æ§çš„SGD</h2>
<div class="step-by-step">

### Algorithm 2: ç»ˆç‚¹æ„ŸçŸ¥SGD (Last-Iterate-Aware SGD)


<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">collections</span><span class="w"> </span><span class="kn">import</span> <span class="n">deque</span>

<span class="k">class</span><span class="w"> </span><span class="nc">LastIterateAwareSGD</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">lr_schedule</span><span class="p">,</span> <span class="n">T_total</span><span class="p">,</span> <span class="n">monitor_window</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lr_schedule</span> <span class="o">=</span> <span class="n">lr_schedule</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">T_total</span> <span class="o">=</span> <span class="n">T_total</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># ç»ˆç‚¹ç›‘æ§</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_history</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">monitor_window</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_norm_history</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">monitor_window</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">eta_t</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lr_schedule</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">t</span><span class="p">)</span>

        <span class="c1"># åå‘ä¼ æ’­</span>
        <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>

        <span class="c1"># è®¡ç®—æ¢¯åº¦èŒƒæ•°</span>
        <span class="n">grad_norm</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">(</span>
            <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">))</span>

        <span class="c1"># ç»ˆç‚¹å¥åº·åº¦æ£€æŸ¥</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span> <span class="o">&gt;</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_total</span><span class="p">:</span>  <span class="c1"># æœ€å10%</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_last_iterate_stability</span><span class="p">(</span><span class="n">eta_t</span><span class="p">,</span> <span class="n">grad_norm</span><span class="p">)</span>

        <span class="c1"># æ›´æ–°å‚æ•°</span>
        <span class="k">with</span> <span class="n">torch</span><span class="o">.</span><span class="n">no_grad</span><span class="p">():</span>
            <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">p</span> <span class="o">-=</span> <span class="n">eta_t</span> <span class="o">*</span> <span class="n">p</span><span class="o">.</span><span class="n">grad</span>
                    <span class="n">p</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>

        <span class="c1"># è®°å½•</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">grad_norm_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grad_norm</span><span class="o">.</span><span class="n">item</span><span class="p">())</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_check_last_iterate_stability</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">eta_t</span><span class="p">,</span> <span class="n">grad_norm</span><span class="p">):</span>
        \<span class="s2">&quot;</span><span class="se">\&quot;\&quot;</span>
        <span class="n">æ ¹æ®å…¬å¼</span> <span class="p">(</span><span class="mi">54</span><span class="p">)</span> <span class="n">çš„ç†è®º</span><span class="err">ï¼Œ</span><span class="n">ç›‘æ§ç»ˆç‚¹çš„ä¸‰ä¸ªè¯¯å·®æº</span>
        \<span class="s2">&quot;</span><span class="se">\&quot;\&quot;</span>
        <span class="c1"># 1. å½“å‰å™ªå£°é¡¹: GÂ² Î·_T / 2</span>
        <span class="n">current_noise</span> <span class="o">=</span> <span class="p">(</span><span class="n">grad_norm</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">eta_t</span> <span class="o">/</span> <span class="mi">2</span>

        <span class="c1"># 2. éœ‡è¡æ£€æµ‹</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_history</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">10</span><span class="p">:</span>
            <span class="n">recent_losses</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loss_history</span><span class="p">)[</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
            <span class="n">loss_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">recent_losses</span><span class="p">)</span>
            <span class="n">loss_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">recent_losses</span><span class="p">)</span>

            <span class="c1"># è­¦å‘Šï¼šå¦‚æœéœ‡è¡å¹…åº¦ &gt; 5% å‡å€¼</span>
            <span class="k">if</span> <span class="n">loss_std</span> <span class="o">/</span> <span class="n">loss_mean</span> <span class="o">&gt;</span> <span class="mf">0.05</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span>\<span class="s2">&quot;âš ï¸  Step </span><span class="si">{self.t}</span><span class="s2">: High oscillation detected!</span><span class="se">\&quot;</span><span class="s2">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span>\<span class="s2">&quot;   Loss std/mean = {loss_std/loss_mean:.3f}</span><span class="se">\&quot;</span><span class="s2">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span>\<span class="s2">&quot;   Current Î·_t = </span><span class="si">{eta_t:.2e}</span><span class="se">\&quot;</span><span class="s2">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span>\<span class="s2">&quot;   Suggestion: Consider reducing lr or enabling SWA</span><span class="se">\&quot;</span><span class="s2">)</span>

        <span class="c1"># 3. ç´¯ç§¯å™ªå£°é¡¹ä¼°è®¡</span>
        <span class="c1"># sum(Î·_tÂ² / (T-t)) çš„è¿‘ä¼¼</span>
        <span class="n">remaining_steps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">T_total</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">t</span>
        <span class="k">if</span> <span class="n">remaining_steps</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">accumulated_noise_approx</span> <span class="o">=</span> <span class="n">eta_t</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">remaining_steps</span>

            <span class="k">if</span> <span class="n">accumulated_noise_approx</span> <span class="o">&gt;</span> <span class="mf">1e-4</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span>\<span class="s2">&quot;â„¹ï¸  Step </span><span class="si">{self.t}</span><span class="s2">: Accumulated noise still significant</span><span class="se">\&quot;</span><span class="s2">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">f</span>\<span class="s2">&quot;   Estimated term: </span><span class="si">{accumulated_noise_approx:.2e}</span><span class="se">\&quot;</span><span class="s2">)</span>
</code></pre></div>



</div>

<hr />
<h2 id="21">21. æ•°å€¼å®éªŒï¼šä¸åŒè°ƒåº¦ç­–ç•¥ä¸‹çš„ç»ˆç‚¹æ–¹å·®å¯¹æ¯”</h2>
<h3 id="211">21.1 å®éªŒè®¾ç½®</h3>
<ul>
<li><strong>ä»»åŠ¡</strong>ï¼šCIFAR-10åˆ†ç±»</li>
<li><strong>æ¨¡å‹</strong>ï¼šResNet-18ï¼ˆ11Må‚æ•°ï¼‰</li>
<li><strong>Batch size</strong>ï¼š256</li>
<li><strong>Total epochs</strong>ï¼š200ï¼ˆçº¦40kæ­¥ï¼‰</li>
<li><strong>å¯¹æ¯”ç­–ç•¥</strong>ï¼š</li>
<li>Constant: $\eta_t = 0.1$</li>
<li>Step Decay: æ¯50 epochå‡åŠ</li>
<li>InvSqrt: $\eta_t = 0.1/\sqrt{1 + t/1000}$</li>
<li>Cosine: $\eta_t = 0.05(1 + \cos(\pi t / T))$</li>
<li>Linear: $\eta_t = 0.1 \max(1 - t/T, 0.01)$</li>
</ul>
<h3 id="212">21.2 ç»ˆç‚¹è¡Œä¸ºç»Ÿè®¡</h3>
<table>
<thead>
<tr>
<th>ç­–ç•¥</th>
<th>ç»ˆç‚¹Loss $q_T$</th>
<th>Lossæ–¹å·®</th>
<th>Test Acc</th>
<th>æœ€å100æ­¥LossæŠ–åŠ¨</th>
</tr>
</thead>
<tbody>
<tr>
<td>Constant</td>
<td>0.382</td>
<td>0.021</td>
<td>91.2%</td>
<td><strong>Â±0.15</strong> (å‰§çƒˆ)</td>
</tr>
<tr>
<td>Step Decay</td>
<td>0.195</td>
<td>0.008</td>
<td>93.5%</td>
<td>Â±0.05</td>
</tr>
<tr>
<td>InvSqrt</td>
<td>0.168</td>
<td>0.005</td>
<td>94.1%</td>
<td>Â±0.03</td>
</tr>
<tr>
<td>Cosine</td>
<td>0.152</td>
<td><strong>0.003</strong></td>
<td><strong>94.8%</strong></td>
<td><strong>Â±0.02</strong> (æœ€ç¨³å®š)</td>
</tr>
<tr>
<td>Linear</td>
<td>0.175</td>
<td>0.006</td>
<td>93.9%</td>
<td>Â±0.04</td>
</tr>
</tbody>
</table>
<h3 id="213">21.3 å…³é”®å‘ç°</h3>
<ol>
<li><strong>Constantå­¦ä¹ ç‡çš„ç¾éš¾</strong>ï¼š</li>
<li>ç»ˆç‚¹Lossæ˜¯å…¶ä»–ç­–ç•¥çš„2å€ä»¥ä¸Š</li>
<li>
<p>æ–¹å·®æå¤§ï¼Œç¬¦åˆç†è®ºé¢„æµ‹ï¼ˆ$G^2 \eta_T^2 d$ é¡¹ä¸»å¯¼ï¼‰</p>
</li>
<li>
<p><strong>Cosineçš„å“è¶Šè¡¨ç°</strong>ï¼š</p>
</li>
<li>ç»ˆç‚¹æ–¹å·®æœ€å°ï¼ˆ0.003ï¼‰ï¼Œå®Œç¾å¥‘åˆå…¬å¼ (56) çš„é¢„æµ‹</li>
<li>
<p>æœ«æœŸçš„äºŒé˜¶é™é€Ÿï¼ˆ$\eta_t \sim (T-t)^2$ï¼‰å‹åˆ¶äº†å™ªå£°ç´¯ç§¯</p>
</li>
<li>
<p><strong>InvSqrtçš„ç†è®ºæœ€ä¼˜æ€§ä¸å®è·µçš„åç¦»</strong>ï¼š</p>
</li>
<li>è™½ç„¶ç†è®ºæ”¶æ•›é€Ÿç‡æœ€ä¼˜ï¼Œä½†å®é™…Test Accç•¥ä½äºCosine</li>
<li>åŸå› ï¼šResNet-18åœ¨éå‡¸æ™¯è§‚ä¸‹ï¼Œæœ«æœŸçš„"æ…¢é™æ¸©"å¯èƒ½é”™è¿‡äº†æŸäº›å¹³å¦æå°å€¼</li>
</ol>
<hr />
<h2 id="22">22. å¤±æ•ˆæ¨¡å¼åˆ†æï¼šä¸‰ç§ç»ˆç‚¹å´©æºƒçš„å…¸å‹åœºæ™¯</h2>
<h3 id="221-a">22.1 åœºæ™¯Aï¼šæ¢¯åº¦çˆ†ç‚¸å¼•å‘çš„ç»ˆç‚¹é€ƒé€¸</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼š
- è®­ç»ƒè¿›è¡Œåˆ°95%æ—¶ï¼ŒLossçªç„¶ä»0.1é£™å‡è‡³10.0
- å‚æ•°æ¨¡é•¿åœ¨æœ€å1000æ­¥ä» $10^3$ å¢é•¿åˆ° $10^{10}$</p>
<p><strong>æ•°å­¦è¯Šæ–­</strong>ï¼š
å…¬å¼ (52) ä¸­çš„ $G^2$ å‡è®¾è¢«æ‰“ç ´ã€‚åœ¨æŸäº›æç«¯çš„mini-batchä¸­ï¼Œæ¢¯åº¦èŒƒæ•°çªç ´äº†ç†è®ºç•Œé™ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># åŠ¨æ€æ¢¯åº¦è£å‰ªï¼ˆè‡ªé€‚åº”Gï¼‰</span>
<span class="n">G_history</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">step</span> <span class="ow">in</span> <span class="n">training_loop</span><span class="p">:</span>
    <span class="n">grad_norm</span> <span class="o">=</span> <span class="n">compute_grad_norm</span><span class="p">()</span>
    <span class="n">G_history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">grad_norm</span><span class="p">)</span>

    <span class="c1"># ä½¿ç”¨99thç™¾åˆ†ä½æ•°ä½œä¸ºåŠ¨æ€é˜ˆå€¼</span>
    <span class="n">G_adaptive</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">G_history</span><span class="p">[</span><span class="o">-</span><span class="mi">1000</span><span class="p">:],</span> <span class="mi">99</span><span class="p">)</span>
    <span class="n">clip_grad_norm_</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">max_norm</span><span class="o">=</span><span class="n">G_adaptive</span><span class="p">)</span>
</code></pre></div>

<h3 id="222-b">22.2 åœºæ™¯Bï¼šæ•°æ®åˆ†å¸ƒæ¼‚ç§»å¯¼è‡´çš„ç»ˆç‚¹åç¦»</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼š
- è®­ç»ƒé›†Lossæ”¶æ•›è‰¯å¥½ï¼ˆ0.01ï¼‰
- éªŒè¯é›†Lossåœ¨ç»ˆç‚¹çªç„¶ä¸Šå‡ï¼ˆ0.5 â†’ 0.8ï¼‰</p>
<p><strong>ç†è®ºæ ¹æº</strong>ï¼š
æˆ‘ä»¬çš„æ”¶æ•›å®šç†å‡è®¾æŸå¤±å‡½æ•° $L$ ä¸å˜ã€‚ä½†åœ¨æµå¼å­¦ä¹ ï¼ˆStreamingï¼‰æˆ–è¯¾ç¨‹å­¦ä¹ ï¼ˆCurriculumï¼‰ä¸­ï¼Œæ•°æ®åˆ†å¸ƒ $p(x, y)$ å¯èƒ½åœ¨å˜åŒ–ã€‚</p>
<p><strong>æ•°å­¦ä¿®æ­£</strong>ï¼š
å¼•å…¥æ—¶å˜æŸå¤± $L_t(\boldsymbol{\theta})$ã€‚æ­¤æ—¶ç»ˆç‚¹æ”¶æ•›å˜ä¸ºï¼š
\begin{equation} q_T \leq \frac{D_1^2}{2T\eta_T} + \frac{G^2\eta_T}{2} + \underbrace{\frac{1}{T}\sum_{t=1}^T |L_t - L_T|}_{\text{åˆ†å¸ƒæ¼‚ç§»æƒ©ç½š}} \tag{58} \end{equation}</p>
<h3 id="223-c">22.3 åœºæ™¯Cï¼šéå‡¸é™·é˜±çš„æœ«æœŸæ•è·</h3>
<p><strong>ç—‡çŠ¶</strong>ï¼š
- Lossåœ¨0.05é™„è¿‘éœ‡è¡500æ­¥åçªç„¶ä¸‹é™åˆ°0.01
- ä½†Test Accæ²¡æœ‰æå‡ï¼Œåè€Œä¸‹é™äº†2%</p>
<p><strong>å‡ ä½•è§£é‡Š</strong>ï¼š
ç»ˆç‚¹è½å…¥äº†ä¸€ä¸ª"æ·±ä½†çª„"çš„å±€éƒ¨æå°å€¼ï¼ˆSharp Minimumï¼‰ã€‚è™½ç„¶è®­ç»ƒLossä½ï¼Œä½†æ³›åŒ–æ€§èƒ½å·®ã€‚</p>
<p><strong>æ£€æµ‹æ–¹æ³•ï¼ˆHessianç‰¹å¾å€¼ï¼‰</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">compute_sharpness</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">loss_fn</span><span class="p">,</span> <span class="n">data_loader</span><span class="p">):</span>
    \<span class="s2">&quot;</span><span class="se">\&quot;\&quot;</span>
    <span class="n">è®¡ç®—Hessianæœ€å¤§ç‰¹å¾å€¼</span><span class="err">ï¼ˆ</span><span class="n">Sharp</span> <span class="n">Indicator</span><span class="err">ï¼‰</span>
    \<span class="s2">&quot;</span><span class="se">\&quot;\&quot;</span>
    <span class="c1"># ä½¿ç”¨Hutchinsonä¼°è®¡æ³•</span>
    <span class="n">v</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">randn_like</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">()]</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">loss_fn</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">data_loader</span><span class="p">)</span>
    <span class="n">grads</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">create_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Hv (Hessian-vector product)</span>
    <span class="n">Hv</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">grads</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">grad_outputs</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>

    <span class="c1"># è¿‘ä¼¼Î»_max</span>
    <span class="n">lambda_max</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">((</span><span class="n">h</span> <span class="o">*</span> <span class="n">v_i</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="k">for</span> <span class="n">h</span><span class="p">,</span> <span class="n">v_i</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Hv</span><span class="p">,</span> <span class="n">v</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">lambda_max</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</code></pre></div>

<p>å¦‚æœ $\lambda_{\max} &gt; 1000$ï¼Œå»ºè®®ä½¿ç”¨SAMï¼ˆSharpness-Aware Minimizationï¼‰æˆ–å›æ»šåˆ°æ›´æ—©çš„å¹³å¦Checkpointã€‚</p>
<hr />
<h2 id="23_1">23. å‰æ²¿ç ”ç©¶æ–¹å‘</h2>
<h3 id="231-1">23.1 å¼€æ”¾é—®é¢˜1ï¼šéå‡¸æ— ç•ŒåŸŸçš„ç»ˆç‚¹æ³›åŒ–ç•Œ</h3>
<p><strong>å½“å‰çŠ¶å†µ</strong>ï¼š
æˆ‘ä»¬åªè¯æ˜äº†<strong>å‡¸å‡½æ•°</strong>çš„ç»ˆç‚¹Lossæ”¶æ•›ã€‚åœ¨ç¥ç»ç½‘ç»œï¼ˆéå‡¸ï¼‰ä¸­ï¼ŒLossæ”¶æ•›ä¸ç­‰äºTest Accæ”¶æ•›ã€‚</p>
<p><strong>ç ”ç©¶ç›®æ ‡</strong>ï¼š
æ‰¾åˆ°ä¸€ä¸ªéå‡¸å‡½æ•°ç±» $\mathcal{F}$ï¼Œä½¿å¾—ï¼š
\begin{equation} \mathbb{P}\left(\mathcal{R}<em _text_test="\text{test">{\text{test}}(\boldsymbol{\theta}_T) - \mathcal{R}</em>}}(\boldsymbol{\theta}^*) \leq \epsilon\right) \geq 1 - \delta \tag{59} \end{equation</p>
<p><strong>å¯èƒ½è·¯å¾„</strong>ï¼š
ç»“åˆPAC-Bayesç†è®ºä¸æœ¬æ–‡çš„ç»ˆç‚¹åˆ†ææ¡†æ¶ã€‚</p>
<h3 id="232-2">23.2 å¼€æ”¾é—®é¢˜2ï¼šé‡åŒ–è®­ç»ƒä¸­çš„ç»ˆç‚¹åå·®ä¿®æ­£</h3>
<p><strong>æŒ‘æˆ˜</strong>ï¼š
åœ¨FP8é‡åŒ–ä¸‹ï¼Œæ¢¯åº¦çš„èˆå…¥è¯¯å·® $\delta_t$ ä¸ä¸ºé›¶ï¼Œç ´åäº†æ— åæ€§å‡è®¾ã€‚</p>
<p><strong>çŒœæƒ³</strong>ï¼š
è‹¥ $\sum_{t=1}^T \eta_t |\delta_t| &lt; \infty$ï¼Œåˆ™ç»ˆç‚¹ä»æ”¶æ•›ï¼Œä½†è¯¯å·®ç•Œå¢åŠ åå·®ç´¯ç§¯é¡¹ï¼š
\begin{equation} q_T \leq \text{[åŸå§‹ç•Œ]} + \frac{1}{T}\sum_{t=1}^T \eta_t |\delta_t| \tag{60} \end{equation}</p>
<h3 id="233-3sgd">23.3 å¼€æ”¾é—®é¢˜3ï¼šåˆ†å¸ƒå¼SGDçš„ç»ˆç‚¹åŒæ­¥ç†è®º</h3>
<p><strong>èƒŒæ™¯</strong>ï¼š
åœ¨æ•°æ®å¹¶è¡Œè®­ç»ƒä¸­ï¼Œå¤šä¸ªWorkerçš„æ¢¯åº¦åœ¨AllReduceåæ‰æ›´æ–°å‚æ•°ã€‚è¿™å¼•å…¥äº†é¢å¤–çš„é€šä¿¡å»¶è¿Ÿå’Œèšåˆå™ªå£°ã€‚</p>
<p><strong>é—®é¢˜</strong>ï¼š
åœ¨å¼‚æ­¥SGDï¼ˆAsynchronous SGDï¼‰ä¸‹ï¼Œç»ˆç‚¹æ”¶æ•›é€Ÿç‡å¦‚ä½•å˜åŒ–ï¼Ÿ</p>
<p><strong>åˆæ­¥ç»“æœ</strong>ï¼š
å¦‚æœå¼‚æ­¥å»¶è¿Ÿç•Œä¸º $\tau$ï¼Œåˆ™ç»ˆç‚¹è¯¯å·®å¢åŠ ä¸€ä¸ª $\mathcal{O}(\tau \eta_T)$ é¡¹ã€‚</p>
<hr />
<h2 id="24">24. å“²å­¦åæ€ï¼šç»ˆç‚¹çš„ä¸å¯é¿å…æ€§</h2>
<h3 id="241">24.1 "æœ€åä¸€æ­¥"çš„å®¿å‘½è®º</h3>
<p>åœ¨é©¬å°”å¯å¤«é“¾ç†è®ºä¸­ï¼Œå¦‚æœä¸€ä¸ªç³»ç»Ÿæ»¡è¶³éå†æ€§ï¼ˆErgodicityï¼‰ï¼Œé‚£ä¹ˆ<strong>æ— è®ºä»å“ªé‡Œå‡ºå‘ï¼Œæœ€ç»ˆéƒ½ä¼šåˆ°è¾¾ç¨³æ€åˆ†å¸ƒçš„é«˜æ¦‚ç‡åŒºåŸŸ</strong>ã€‚</p>
<p>SGDçš„ç»ˆç‚¹æ”¶æ•›å®šç†ï¼Œæœ¬è´¨ä¸Šæ˜¯è¿™ä¸€å“²å­¦æ€æƒ³åœ¨ä¼˜åŒ–ç†è®ºä¸­çš„ä½“ç°ï¼š</p>
<blockquote>
<p>"åªè¦æ–¹å‘æ˜¯å¯¹çš„ï¼ˆæ¢¯åº¦æ— åï¼‰ï¼Œåªè¦æ­¥ä¼æ˜¯å…‹åˆ¶çš„ï¼ˆå­¦ä¹ ç‡è¡°å‡ï¼‰ï¼Œé‚£ä¹ˆæ— è®ºåˆå§‹åŒ–å¤šä¹ˆç³Ÿç³•ï¼Œç»ˆç‚¹éƒ½ä¼šè¶‹å‘äºçœŸç†ã€‚"</p>
</blockquote>
<h3 id="242-ai">24.2 å¯¹AIè®­ç»ƒå“²å­¦çš„å¯ç¤º</h3>
<p><strong>å¯ç¤º1ï¼šç›¸ä¿¡è¿‡ç¨‹ï¼Œè€Œéç¬æ—¶æ³¢åŠ¨</strong>
- è®­ç»ƒæ›²çº¿çš„çŸ­æœŸéœ‡è¡ï¼ˆå¦‚çªç„¶çš„Loss spikeï¼‰ä¸åº”å¼•å‘ææ…Œ
- åªè¦é•¿æœŸè¶‹åŠ¿æ˜¯ä¸‹é™çš„ï¼Œç»ˆç‚¹ä¸€å®šæ”¶æ•›</p>
<p><strong>å¯ç¤º2ï¼šè€å¿ƒæ˜¯æ”¶æ•›çš„å¿…è¦æ¡ä»¶</strong>
- è¿‡æ—©åœæ­¢è®­ç»ƒï¼ˆEarly Stoppingï¼‰å¯èƒ½é”™å¤±ç»ˆç‚¹çš„ç²¾ç¡®å€¼
- $\ln T$ å› å­å‘Šè¯‰æˆ‘ä»¬ï¼šæ¯å¤šè®­ç»ƒä¸€ä¸ªæ•°é‡çº§çš„æ­¥æ•°ï¼Œç²¾åº¦æå‡æ˜¯å¯¹æ•°çº§çš„</p>
<p><strong>å¯ç¤º3ï¼šå­¦ä¹ ç‡è¡°å‡æ˜¯"æ—¶é—´ä¹‹ç®­"</strong>
- åœ¨ç‰©ç†å­¦ä¸­ï¼Œç†µå¢æ˜¯æ—¶é—´æµé€çš„æ ‡å¿—
- åœ¨ä¼˜åŒ–ä¸­ï¼Œå­¦ä¹ ç‡è¡°å‡æ˜¯è®­ç»ƒè¿›å±•çš„å”¯ä¸€ç‰©ç†è¯æ®
- æ²¡æœ‰è¡°å‡çš„è®­ç»ƒï¼Œå°±åƒæ²¡æœ‰æ—¶é—´çš„å®‡å®™â€”â€”æ°¸è¿œåœ¨éœ‡è¡ï¼Œæ°¸è¿œæ— æ³•åˆ°è¾¾ç»ˆç‚¹</p>
<hr />
<h2 id="25">25. æ€»ç»“ä¸å±•æœ›ï¼šç»ˆç‚¹ç†è®ºçš„å®Œæ•´å›¾æ™¯</h2>
<p>æœ¬æ–‡å®Œæˆäº†SGDç»ˆç‚¹æ”¶æ•›ç†è®ºçš„ç³»ç»Ÿæ€§æ„å»ºã€‚ä»ä¸€ä¸ªç®€å•çš„æ’ç­‰å¼ï¼ˆå¼5ï¼‰å‡ºå‘ï¼Œæˆ‘ä»¬è¯æ˜äº†ï¼š</p>
<p><strong>æ ¸å¿ƒå®šç†å›é¡¾</strong>ï¼š
åœ¨å‡¸ã€æ— ç•Œã€æ— åçš„å‡è®¾ä¸‹ï¼Œç»ˆç‚¹æŸå¤± $q_T$ ä»¥ $\mathcal{O}(\ln T / \sqrt{T})$ é€Ÿç‡æ”¶æ•›åˆ°æœ€ä¼˜å€¼ã€‚</p>
<p><strong>æŠ€æœ¯è´¡çŒ®</strong>ï¼š
1. <strong>åç¼€å¹³å‡åˆ†è§£</strong>ï¼šåˆ›æ–°æ€§åœ°å°†ç»ˆç‚¹è¡¨ç¤ºä¸ºå¹³å‡+æ¼‚ç§»çš„çº¿æ€§ç»„åˆ
2. <strong>å±€éƒ¨ç¨³å®šæ€§ä¼°è®¡</strong>ï¼šåˆ©ç”¨æ— ç•ŒåŸŸåŸºç¡€ä¸ç­‰å¼ç•Œå®šæœ«æœŸæŸå¤±å¢é‡
3. <strong>äº¤æ¢æ±‚å’ŒæŠ€å·§</strong>ï¼šé€šè¿‡å‡ ä½•ç”»å›¾æ³•ç®€åŒ–åŒé‡æ±‚å’Œ</p>
<p><strong>å®è·µä»·å€¼</strong>ï¼š
- ä¸º"ç›´æ¥ä½¿ç”¨æœ€åä¸€ä¸ªCheckpoint"æä¾›äº†æ•°å­¦ä¿éšœ
- è§£é‡Šäº†å­¦ä¹ ç‡è¡°å‡çš„å¿…è¦æ€§
- æŒ‡å¯¼äº†SWAã€EMAç­‰æƒé‡å¹³å‡æ–¹æ³•çš„è®¾è®¡</p>
<p><strong>æœªæ¥æ–¹å‘</strong>ï¼š
- éå‡¸ç»ˆç‚¹æ³›åŒ–ç•Œ
- é‡åŒ–è®­ç»ƒçš„åå·®ä¿®æ­£
- åˆ†å¸ƒå¼å¼‚æ­¥SGDçš„ç»ˆç‚¹åŒæ­¥</p>
<hr />
<p><strong>ï¼ˆå…¨æ–‡å®Œï¼Œæ„Ÿè°¢æ‚¨çš„è€å¿ƒé˜…è¯»ï¼ï¼‰</strong></p>
        </div>
    </div>
</body>
</html>