<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ºä»€ä¹ˆæ¢¯åº¦è£å‰ªçš„é»˜è®¤æ¨¡é•¿æ˜¯1ï¼Ÿ</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ä¸ºä»€ä¹ˆæ¢¯åº¦è£å‰ªçš„é»˜è®¤æ¨¡é•¿æ˜¯1ï¼Ÿ</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 71.9 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10657">https://spaces.ac.cn/archives/10657</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>æˆ‘ä»¬çŸ¥é“ï¼Œæ¢¯åº¦è£å‰ªï¼ˆGradient Clippingï¼‰æ˜¯è®©æ¨¡å‹è®­ç»ƒæ›´åŠ å¹³ç¨³çš„å¸¸ç”¨æŠ€å·§ã€‚å¸¸ç”¨çš„æ¢¯åº¦è£å‰ªæ˜¯æ ¹æ®æ‰€æœ‰å‚æ•°çš„æ¢¯åº¦æ€»æ¨¡é•¿æ¥å¯¹æ¢¯åº¦è¿›è¡Œè£å‰ªï¼Œå…¶è¿ç®—å¯ä»¥è¡¨ç¤ºä¸º<br />
\begin{equation}\text{clip}(\boldsymbol{g},\tau)=\left\{\begin{aligned}&amp;\boldsymbol{g}, &amp;\Vert\boldsymbol{g}\Vert\leq \tau \\\<br />
&amp;\frac{\tau}{\Vert\boldsymbol{g}\Vert}\boldsymbol{g},&amp;\Vert\boldsymbol{g}\Vert &gt; \tau<br />
\end{aligned}\right.\end{equation}<br />
è¿™æ ·ä¸€æ¥ï¼Œ$\text{clip}(\boldsymbol{g},\tau)$ä¿æŒè·Ÿ$\boldsymbol{g}$ç›¸åŒçš„æ–¹å‘ï¼Œä½†æ¨¡é•¿ä¸è¶…è¿‡$\tau$ã€‚æ³¨æ„è¿™é‡Œçš„$\Vert\boldsymbol{g}\Vert$æ˜¯æ•´ä¸ªæ¨¡å‹æ‰€æœ‰çš„å‚æ•°æ¢¯åº¦æ”¾åœ¨ä¸€èµ·è§†ä¸ºå•ä¸ªå‘é‡æ‰€ç®—çš„æ¨¡é•¿ï¼Œä¹Ÿå°±æ˜¯æ‰€è°“çš„Global Gradient Normã€‚</p>
<p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰ç•™æ„åˆ°ä¸€ä¸ªç»†èŠ‚ï¼šä¸ç®¡æ˜¯æ•°ç™¾ä¸‡å‚æ•°è¿˜æ˜¯æ•°ç™¾äº¿å‚æ•°çš„æ¨¡å‹ï¼Œ$\tau$çš„å–å€¼åœ¨å¾ˆå¤šæ—¶å€™éƒ½æ˜¯1ã€‚è¿™æ„å‘³ç€ä»€ä¹ˆå‘¢ï¼Ÿæ˜¯å•çº¯åœ°å¤ç”¨é»˜è®¤å€¼ï¼Œè¿˜æ˜¯èƒŒåéšå«ç€ä»€ä¹ˆæ·±åˆ»çš„åŸç†å‘¢ï¼Ÿ</p>
<h2 id="_1">æ˜¯ä»€ä¹ˆ</h2>
<p>å¯èƒ½æœ‰è¯»è€…è§‰å¾—ï¼Œé»˜è®¤å€¼åˆä¸ä¸€å®šæ˜¯æœ€ä¼˜å€¼ï¼Œæœ‰ä»€ä¹ˆå€¼å¾—çº ç»“çš„ï¼Ÿç¡®å®ï¼Œ$\tau=1$æœªå¿…æ˜¯æœ€ä¼˜çš„é€‰æ‹©ï¼Œä½†å®ƒæ˜¯å¾ˆå¤šæ¨¡å‹çš„é»˜è®¤é€‰æ‹©ï¼Œå¹¶ä¸”åœ¨è¿™ä¸ªé»˜è®¤é€‰æ‹©ä¸‹è¡¨ç°å°šå¯ï¼Œè¿™åè¿‡æ¥è¡¨æ˜$\tau=1$å…·æœ‰æ™®éçš„åˆç†æ€§ã€‚</p>
<p>è¿™é‡Œçš„â€œåˆç†æ€§â€åˆæŒ‡ä»€ä¹ˆå‘¢ï¼Ÿè®©æˆ‘ä»¬å›åˆ°$\text{clip}$è¿ç®—ä¸Šã€‚å¦‚æœ$\Vert\boldsymbol{g}\Vert$æ€»æ˜¯å°äº$\tau$ï¼Œé‚£ä¹ˆ$\text{clip}$å°±é€€åŒ–ä¸ºæ’ç­‰å˜æ¢äº†ï¼›å¦‚æœ$\Vert\boldsymbol{g}\Vert$æ€»æ˜¯å¤§äº$\tau$ï¼Œé‚£ä¹ˆ$\text{clip}$å°±é€€åŒ–æˆL2å½’ä¸€åŒ–ã€‚æ¢å¥è¯è¯´ï¼Œ$\text{clip}$ä¹‹æ‰€ä»¥ä¸º$\text{clip}$ï¼Œå°±æ˜¯å› ä¸º$\tau$äº§ç”Ÿäº†é€‚å½“çš„åŒºåˆ†åº¦ï¼Œä½¿å¾—å¤§éƒ¨åˆ†çš„$\Vert\boldsymbol{g}\Vert$éƒ½æ˜¯å°äº$\tau$çš„ï¼Œåªæœ‰å°éƒ¨åˆ†æ‰æ˜¯å¤§äº$\tau$çš„ï¼Œè¿™å°±æ˜¯$\tau$çš„åˆç†æ€§çš„å«ä¹‰ã€‚</p>
<p>è¿™ä¸ªå½“ç„¶å¯ä»¥ä¸¾å‡ºåä¾‹ï¼Œè€Œä¸”è¿˜ä¸å°‘ï¼Œè¿™é‡Œä¸»è¦æƒ³å¼ºè°ƒè¿™ä¸ªç°è±¡çš„æ™®éæ€§ä»¥åŠè¿™ä¸ªé»˜è®¤è®¾ç½®çš„æ™®é€‚æ€§ï¼Œæ‰€ä»¥è¾ƒçœŸçš„è¯»è€…å¤§å¯ä¸å¿…è¿‡äºæ‰§ç€äºä¸ªåˆ«ç»†èŠ‚ã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬è®¤ä¸ºï¼Œ$\tau=1$çš„æ™®éåˆç†æ€§çš„å«ä¹‰ï¼Œå°±æ˜¯ä¸è®ºæ¨¡å‹å‚æ•°é‡å¤šå°‘ã€æ€ä¹ˆåˆå§‹åŒ–ã€å–ä½•ç§æŸå¤±å‡½æ•°ï¼Œå®ƒçš„æ¢¯åº¦æ€»æ¨¡é•¿éƒ½èƒ½æ°å¥½å¤§è‡´ä»¥$1$ä¸ºâ€œå¼‚å¸¸å€¼â€çš„åˆ†ç•Œç‚¹ï¼Œè¿™æ— ç–‘æ˜¯ä¸€ä¸ªéå¸¸ä¸å¯æ€è®®çš„æ€§è´¨â€”â€”ç¬”è€…ç¬¬ä¸€æ¬¡æ„è¯†åˆ°è¿™ä¸ªç»“è®ºæ—¶çš„æ„Ÿå—ä¾¿æ˜¯å¦‚æ­¤ã€‚</p>
<h2 id="_2">ä¸ºä»€ä¹ˆ</h2>
<p>ä¸ºä»€ä¹ˆä¼šå¦‚æ­¤â€œå·§åˆâ€å‘¢ï¼Ÿç¬”è€…çš„ç­”æ¡ˆå¯èƒ½ä¼šè®©äººæœ‰äº›æ„å¤–ï¼šå› ä¸ºåªæœ‰è¿™æ ·ï¼Œæ¨¡å‹æ‰æœ‰ç¨³å®šè®­ç»ƒçš„å¯èƒ½ã€‚</p>
<p>è®©æˆ‘ä»¬è€ƒè™‘æŸå¤±å‡½æ•°$\mathcal{L}(\boldsymbol{\theta})$ï¼Œä¼˜åŒ–å™¨æ›´æ–°è§„åˆ™ä¸º$\boldsymbol{\theta}<em t_1="t+1">{t+1} = \boldsymbol{\theta}_t - \eta\, \boldsymbol{u}_t$ï¼Œé‚£ä¹ˆæŸå¤±å‡½æ•°çš„å˜åŒ–è¿‘ä¼¼ä¸º<br />
\begin{equation}\Delta \mathcal{L} = \mathcal{L}(\boldsymbol{\theta}</em>}) - \mathcal{L}(\boldsymbol{\theta<em t_1="t+1">t) \approx (\boldsymbol{\theta}</em>} - \boldsymbol{\theta<em _boldsymbol_theta="\boldsymbol{\theta">t)\cdot\nabla</em>}_t}\mathcal{L}(\boldsymbol{\theta}) = -\eta\, \boldsymbol{u}_t\cdot \boldsymbol{g}_t\end{equation<br />
å…ˆè€ƒè™‘æœ€ç®€å•çš„SGDï¼Œé‚£ä¹ˆ$\boldsymbol{u}_t = \boldsymbol{g}_t$ä»¥åŠ$\Delta \mathcal{L}=-\eta\Vert\boldsymbol{g}_t\Vert^2$ï¼Œå³æŸå¤±å‡½æ•°çš„å˜åŒ–é‡æ­£æ¯”äºæ¢¯åº¦æ¨¡é•¿çš„å¹³æ–¹ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œä¸ç®¡æ˜¯CVè¿˜æ˜¯NLPï¼Œçº¯ç²¹çš„SGDï¼ˆä¸å¸¦åŠ¨é‡ï¼‰éƒ½æ˜¯éå¸¸ä½æ•ˆçš„ä¼˜åŒ–å™¨ï¼Œè®­ç»ƒåˆ°ä¸­åæœŸï¼Œå¹³å‡æ¥è¯´å¤šæ•°ä»»åŠ¡æ¯æ­¥çš„æŸå¤±ä¸‹é™é‡æ˜¯è¿œä¸å¦‚å­¦ä¹ ç‡å¤§å°çš„ï¼Œä¹Ÿå°±æ˜¯$|\Delta \mathcal{L}| &lt; \eta$ï¼Œç”±æ­¤æ¨å¾—$\Vert\boldsymbol{g}_t\Vert &lt; 1$ã€‚è¿™å°±è¡¨æ˜äº†$\Vert\boldsymbol{g}_t\Vert &lt; 1$æ˜¯ä¸€ä¸ªèƒ½æ­£å¸¸æ”¶æ•›çš„æ¨¡å‹çš„é•¿æœŸè¡¨ç°ã€‚</p>
<p>å½“ç„¶ï¼Œè®­ç»ƒåˆæœŸæ¨¡å‹æœ‰å¯èƒ½ä¼šå‡ºç°$\Vert\boldsymbol{g}_t\Vert &gt; 1$ï¼Œè¿™æ˜¯æ­£å¸¸çš„ï¼Œä½†å¾ˆå°‘æƒ…å†µä¼šå‡ºç°$\Vert\boldsymbol{g}_t\Vert \gg 1$ï¼Œæˆ–è€…è¯´ä¸€ä¸ªä¼˜ç§€çš„åˆå§‹åŒ–åº”è¯¥é¿å…å‡ºç°$\Vert\boldsymbol{g}_t\Vert \gg 1$ï¼Œåƒ<a href="/archives/8978">DeepNorm</a>ç­‰çš„ç†è®ºä¾æ®ä¾¿æ˜¯å¦‚æ­¤ã€‚åŸå› æ˜¯ç›¸ä¼¼çš„ï¼Œå¦‚æœæ¢¯åº¦æ¨¡é•¿å¤ªå¤§ï¼Œé‚£ä¹ˆå‰æœŸçš„å­¦ä¹ å°±ä¼šè¿‡äºâ€œæ¿€è¿›â€ï¼Œå¯¼è‡´æå‰æ”¶æ•›åˆ°ä¸å¥½çš„å±€éƒ¨è§£ã€‚å¦ä¸€ä¸ªæ–¹æ¡ˆæ˜¯ç¼©å°$\eta$ï¼Œè¿™åŒæ ·èƒ½å¤Ÿç¼©å°$|\Delta \mathcal{L}|$ï¼Œè¿™ä¹Ÿå°±æ˜¯ä¸ºä»€ä¹ˆåœ¨è®­ç»ƒåˆæœŸæˆ‘ä»¬é€šå¸¸ä½¿ç”¨Warmupã€‚</p>
<p>é¡ºä¾¿è¯´ï¼Œå…³äºWarmupçš„ç†è§£å¤§å®¶å¯ä»¥å‚è€ƒè®ºæ–‡<a href="https://papers.cool/arxiv/2310.07831">ã€ŠOptimal Linear Decay Learning Rate Schedules and Further Refinementsã€‹</a>ï¼Œè¿™æ˜¯ç¬”è€…è®¤ä¸ºå¯¹Warmupçš„æœ€åˆç†çš„åˆ†æã€‚</p>
<h2 id="_3">æ€ä¹ˆåŠ</h2>
<p>ç®€å•æ¥è¯´ï¼Œå°±æ˜¯ç”±äºæŸå¤±å‡½æ•°çš„å˜åŒ–é‡æ­£æ¯”äºæ¢¯åº¦æ¨¡é•¿çš„å¹³æ–¹ï¼Œæ‰€ä»¥è®­ç»ƒçš„å¹³ç¨³æ€§å†³å®šäº†æ¢¯åº¦æ¨¡é•¿ä¸èƒ½å¤ªå¤§ï¼Œå¹¶ä¸”é•¿æœŸè¡¨ç°ä¸ºå°äº1ã€‚è€ŒåˆæœŸå¦‚æœå‡ºç°æ˜æ˜¾å¤§äº1çš„æ¢¯åº¦æ¨¡é•¿ï¼Œé‚£ä¹ˆé€šå¸¸çš„ç­–ç•¥æ˜¯Warmupã€‚æˆ–è€…ä¹Ÿå¯ä»¥è€ƒè™‘ä¸€ä¸ªæ›´é€šç”¨çš„ç­–ç•¥ï¼šè®¾ç½®å¦ä¸€ä¸ªé˜ˆå€¼$\mathcal{T}$ï¼Œæ ¹æ®$\boldsymbol{u}_t\cdot \boldsymbol{g}_t$çš„å€¼å¯¹$\eta$è¿›è¡Œè£å‰ª<br />
\begin{equation}\eta_t = \left\{\begin{aligned}&amp;\eta,&amp; \boldsymbol{u}_t\cdot \boldsymbol{g}_t\leq \mathcal{T} \\\ &amp;\frac{\mathcal{T}}{\boldsymbol{u}_t\cdot \boldsymbol{g}_t}\eta,&amp; \boldsymbol{u}_t\cdot \boldsymbol{g}_t &gt; \mathcal{T}<br />
\end{aligned}\right.\end{equation}<br />
è¿™æ ·å°±å…é™¤äº†é¢å¤–çš„Warmupè®¾ç½®ï¼Œæ›´åŠ å…·æœ‰è‡ªé€‚åº”æ€§ã€‚</p>
<p>å¯¹äºAdamç­‰ä¼˜åŒ–å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è·Ÿ<a href="/archives/10542">ã€Šå½“Batch Sizeå¢å¤§æ—¶ï¼Œå­¦ä¹ ç‡è¯¥å¦‚ä½•éšä¹‹å˜åŒ–ï¼Ÿã€‹</a>ä¸€æ ·ï¼Œé€šè¿‡$\boldsymbol{u}_t=\text{sign}(\boldsymbol{g}_t)$æ¥è¿›è¡Œè¿‘ä¼¼åˆ†æï¼Œæ­¤æ—¶<br />
\begin{equation}\Delta \mathcal{L} = -\eta\, \text{sign}(\boldsymbol{g}_t)\cdot \boldsymbol{g}_t = -\eta\, \Vert\boldsymbol{g}_t\Vert_1\end{equation}<br />
è¿™é‡Œçš„$\Vert\Vert_1$æ˜¯L1èŒƒæ•°ï¼Œå³åˆ†é‡çš„ç»å¯¹å€¼ä¹‹å’Œã€‚ç”±äºæ¢¯åº¦åˆ†é‡åŸºæœ¬éƒ½å°äº1ï¼Œå› æ­¤$\Vert\boldsymbol{g}_t\Vert_1 \gg \Vert\boldsymbol{g}_t\Vert$ï¼Œå› æ­¤åŒæ ·å‡ºäºå¹³ç¨³è®­ç»ƒçš„éœ€æ±‚ï¼ŒAdamçš„å­¦ä¹ ç‡é€šå¸¸è¦æ˜æ˜¾å°äºSGDçš„å­¦ä¹ ç‡ã€‚æ­¤å¤–ï¼Œä¸Šå¼è¿˜å¯ä»¥æ”¹å†™æˆ<br />
\begin{equation}\Delta \mathcal{L} = -\eta\, \text{sign}(\boldsymbol{g}_t)\cdot \boldsymbol{g}_t = -\eta\, \sqrt{N}\Vert\boldsymbol{g}_t\Vert \cos(\text{sign}(\boldsymbol{g}_t), \boldsymbol{g}_t) \end{equation}<br />
è¿™é‡Œå‡è®¾äº†$\boldsymbol{g}_t$æ²¡æœ‰é›¶åˆ†é‡ï¼Œå› æ­¤$\Vert\text{sign}(\boldsymbol{g}_t)\Vert=\sqrt{N}$ï¼Œ$N$æ˜¯æ¨¡å‹æ€»å‚æ•°é‡ã€‚å®è·µå‘ç°$\Vert\boldsymbol{g}_t\Vert$å’Œ$\cos(\text{sign}(\boldsymbol{g}_t), \boldsymbol{g}_t)$åœ¨ä¸åŒçš„æ¨¡å‹å°ºåº¦ä¸‹éƒ½å¤§è‡´ä¸ºå¸¸æ•°ï¼Œå› æ­¤å¦‚æœè¦ç»´æŒ$\Delta \mathcal{L}$ä¸å˜ï¼Œåº”è¯¥æœ‰$\eta$åæ¯”äº$\sqrt{N}$ï¼Œä¹Ÿå°±æ˜¯è¯´æ¨¡å‹å‚æ•°é‡å¢åŠ åˆ°4å€ï¼Œé‚£ä¹ˆå­¦ä¹ ç‡å¯ä»¥è€ƒè™‘å‡åŠã€‚</p>
<h2 id="_4">å…¨å‰§ç»ˆ</h2>
<p>æœ¬æ–‡å¯¹â€œæ¢¯åº¦è£å‰ªçš„é»˜è®¤æ¨¡é•¿ä¸º1â€è¿™ä¸€ç°è±¡ç»™å‡ºäº†è‡ªå·±çš„ä¸€äº›çœ‹æ³•å’Œæ€è€ƒã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10657">https://spaces.ac.cn/archives/10657</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jan. 02, 2025). ã€Šä¸ºä»€ä¹ˆæ¢¯åº¦è£å‰ªçš„é»˜è®¤æ¨¡é•¿æ˜¯1ï¼Ÿ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10657">https://spaces.ac.cn/archives/10657</a></p>
<p>@online{kexuefm-10657,<br />
title={ä¸ºä»€ä¹ˆæ¢¯åº¦è£å‰ªçš„é»˜è®¤æ¨¡é•¿æ˜¯1ï¼Ÿ},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Jan},<br />
url={\url{https://spaces.ac.cn/archives/10657}},<br />
} </p>
<hr />
<h2 id="_5">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">ç¬¬1éƒ¨åˆ†ï¼šæ ¸å¿ƒç†è®ºã€å…¬ç†ä¸å†å²åŸºç¡€</h3>
<h4 id="11">1.1 ç†è®ºèµ·æºä¸å†å²å‘å±•</h4>
<p><strong>æ¢¯åº¦è£å‰ªçš„ç†è®ºæ ¹æº</strong>å¯è¿½æº¯åˆ°å¤šä¸ªç ”ç©¶é¢†åŸŸï¼š</p>
<div class="theorem-box">

**å¤šé¢†åŸŸèåˆ**ï¼š
- **æ•°å€¼ä¼˜åŒ–** (1960s-1980s)ï¼šçº¦æŸä¼˜åŒ–ä¸­çš„æŠ•å½±æ¢¯åº¦æ³•
- **ç¥ç»ç½‘ç»œè®­ç»ƒ** (1990s)ï¼šHochreiter (1991) é¦–æ¬¡åˆ†ææ¢¯åº¦çˆ†ç‚¸é—®é¢˜
- **å¾ªç¯ç¥ç»ç½‘ç»œ** (1994, Bengioç­‰)ï¼šç³»ç»Ÿç ”ç©¶äº†æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸ç°è±¡
- **LSTM** (1997, Hochreiter & Schmidhuber)ï¼šé€šè¿‡é—¨æ§æœºåˆ¶ç¼“è§£æ¢¯åº¦é—®é¢˜
- **æ¢¯åº¦è£å‰ªå®è·µ** (2012, Pascanuç­‰)ï¼šé¦–æ¬¡ç³»ç»Ÿæå‡ºæ¢¯åº¦è£å‰ªæŠ€æœ¯å¹¶è¯æ˜æœ‰æ•ˆæ€§

</div>

<p><strong>å…³é”®é‡Œç¨‹ç¢‘</strong>ï¼š</p>
<ol>
<li><strong>1991 - Hochreiter</strong>ï¼šã€ŠUntersuchungen zu dynamischen neuronalen Netzenã€‹ï¼Œé¦–æ¬¡æ·±å…¥åˆ†ææ¢¯åº¦çˆ†ç‚¸</li>
<li><strong>1994 - Bengioç­‰</strong>ï¼šã€ŠLearning long-term dependencies with gradient descent is difficultã€‹ï¼Œç†è®ºåˆ†ææ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸çš„æ ¹æœ¬åŸå› </li>
<li><strong>2012 - Pascanuç­‰</strong>ï¼šã€ŠOn the difficulty of training RNNsã€‹ï¼Œæå‡ºæ¢¯åº¦è£å‰ªæ–¹æ³• â­</li>
<li><strong>2013 - Graves</strong>ï¼šã€ŠGenerating Sequences With RNNsã€‹ï¼Œåœ¨æ‰‹å†™ç”Ÿæˆä»»åŠ¡ä¸­éªŒè¯æ¢¯åº¦è£å‰ª</li>
<li><strong>2015 - Bahdanauç­‰</strong>ï¼šã€ŠNeural Machine Translationã€‹ï¼Œåœ¨seq2seqæ¨¡å‹ä¸­å¹¿æ³›åº”ç”¨</li>
<li><strong>2018 - BERT/GPTç³»åˆ—</strong>ï¼šå¤§è§„æ¨¡Transformerè®­ç»ƒä¸­ä»ä½¿ç”¨ $\tau=1$</li>
<li><strong>2020 - GPT-3</strong>ï¼š175Bå‚æ•°æ¨¡å‹è®­ç»ƒï¼Œ$\tau=1$ çš„æ™®é€‚æ€§å¾—åˆ°éªŒè¯</li>
</ol>
<h4 id="12">1.2 æ•°å­¦å…¬ç†ä¸åŸºç¡€å‡è®¾</h4>
<div class="theorem-box">

### å…¬ç†1ï¼šæ¢¯åº¦æœ‰ç•Œæ€§å‡è®¾

æ·±åº¦ç¥ç»ç½‘ç»œè®­ç»ƒä¸­ï¼Œæ¢¯åº¦åº”è¯¥æ»¡è¶³æœ‰ç•Œæ€§æ¡ä»¶ï¼š

$$\exists G > 0, \quad \mathbb{E}[\|\nabla_{\boldsymbol{\theta}} \mathcal{L}(\boldsymbol{\theta})\|_2] \leq G$$

è¿™ä¸ªç•Œ $G$ åº”è¯¥ä¸å­¦ä¹ ç‡ $\eta$ çš„é‡çº§åŒ¹é…ï¼Œä»¥ä¿è¯ç¨³å®šè®­ç»ƒã€‚

</div>

<div class="theorem-box">

### å…¬ç†2ï¼šLipschitzè¿ç»­æ€§

æŸå¤±å‡½æ•°çš„æ¢¯åº¦åº”è¯¥æ˜¯Lipschitzè¿ç»­çš„ï¼š

$$\|\nabla \mathcal{L}(\boldsymbol{\theta}_1) - \nabla \mathcal{L}(\boldsymbol{\theta}_2)\|_2 \leq L \|\boldsymbol{\theta}_1 - \boldsymbol{\theta}_2\|_2$$

å…¶ä¸­Lipschitzå¸¸æ•° $L$ é€šå¸¸åœ¨ $O(1)$ åˆ° $O(10)$ çš„é‡çº§ï¼Œè¿™å†³å®šäº†æ¢¯åº¦çš„å˜åŒ–é€Ÿç‡ã€‚

</div>

<div class="theorem-box">

### å…¬ç†3ï¼šè°±èŒƒæ•°çº¦æŸåŸåˆ™

ä¸ºäº†é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ï¼Œç½‘ç»œä¸­æ¯å±‚çš„JacobiançŸ©é˜µçš„è°±èŒƒæ•°åº”æ»¡è¶³ï¼š

$$\mathbb{E}[\|\boldsymbol{J}_\ell\|_2] \lesssim 1, \quad \forall \ell$$

å…¶ä¸­ $\boldsymbol{J}_\ell = \frac{\partial \boldsymbol{h}_\ell}{\partial \boldsymbol{h}_{\ell-1}}$ æ˜¯ç¬¬ $\ell$ å±‚çš„JacobiançŸ©é˜µã€‚

</div>

<h4 id="13">1.3 è®¾è®¡å“²å­¦</h4>
<p>æ¢¯åº¦è£å‰ªçš„æ ¸å¿ƒè®¾è®¡å“²å­¦ä½“ç°ä¸º<strong>"ä¿æŠ¤ç¨³å®šæ€§ï¼Œä¿ç•™æ–¹å‘"</strong>ï¼š</p>
<p><strong>ä¿æŠ¤ç¨³å®šæ€§ï¼ˆSafety Netï¼‰</strong>ï¼š
- é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸å¯¼è‡´çš„è®­ç»ƒå´©æºƒ
- æä¾›æ•°å€¼ç¨³å®šæ€§çš„"å®‰å…¨ç½‘"
- å…è®¸ä½¿ç”¨æ›´å¤§çš„å­¦ä¹ ç‡</p>
<p><strong>ä¿ç•™æ–¹å‘ï¼ˆDirection Preservationï¼‰</strong>ï¼š
- åªç¼©æ”¾æ¢¯åº¦çš„æ¨¡é•¿ï¼Œä¸æ”¹å˜æ–¹å‘
- ä¿æŒä¼˜åŒ–æ–¹å‘çš„æ­£ç¡®æ€§
- æœ€å°åŒ–å¯¹æ­£å¸¸è®­ç»ƒçš„å¹²æ‰°</p>
<p><strong>ä¸å…¶ä»–æŠ€æœ¯çš„æœ¬è´¨åŒºåˆ«</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æŠ€æœ¯</th>
<th>ä½œç”¨æœºåˆ¶</th>
<th>æ¢¯åº¦æ–¹å‘</th>
<th>ä½¿ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>æ¢¯åº¦è£å‰ª</strong></td>
<td>é™åˆ¶æ¢¯åº¦èŒƒæ•°</td>
<td>ä¿æŒ</td>
<td>é˜²æ­¢çˆ†ç‚¸</td>
</tr>
<tr>
<td><strong>æƒé‡è¡°å‡</strong></td>
<td>L2æ­£åˆ™åŒ–</td>
<td>æ”¹å˜</td>
<td>é˜²æ­¢è¿‡æ‹Ÿåˆ</td>
</tr>
<tr>
<td><strong>æ¢¯åº¦å½’ä¸€åŒ–</strong></td>
<td>å½’ä¸€åŒ–åˆ°å•ä½é•¿åº¦</td>
<td>ä¿æŒ</td>
<td>å›ºå®šæ­¥é•¿</td>
</tr>
<tr>
<td><strong>å­¦ä¹ ç‡è¡°å‡</strong></td>
<td>ç¼©å°æ›´æ–°æ­¥é•¿</td>
<td>ä¿æŒ</td>
<td>ç²¾ç»†è°ƒä¼˜</td>
</tr>
</tbody>
</table>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š
- <strong>æœ€å°å¹²é¢„åŸåˆ™</strong>ï¼šåªåœ¨å¿…è¦æ—¶ï¼ˆ$|\boldsymbol{g}| &gt; \tau$ï¼‰æ‰å¹²é¢„
- <strong>è‡ªé€‚åº”ä¿æŠ¤</strong>ï¼šè‡ªåŠ¨é€‚åº”ä¸åŒè®­ç»ƒé˜¶æ®µçš„æ¢¯åº¦å°ºåº¦
- <strong>å°ºåº¦æ— å…³æ€§</strong>ï¼šé˜ˆå€¼ $\tau=1$ å¯¹ä¸åŒè§„æ¨¡æ¨¡å‹éƒ½é€‚ç”¨</p>
<hr />
<h3 id="2">ç¬¬2éƒ¨åˆ†ï¼šä¸¥è°¨çš„æ ¸å¿ƒæ•°å­¦æ¨å¯¼</h3>
<p>æœ¬èŠ‚æä¾›æ¢¯åº¦è£å‰ªç†è®ºçš„æè¯¦ç»†æ•°å­¦æ¨å¯¼ï¼Œä»ä¼˜åŒ–ç†è®ºã€åŠ¨åŠ›ç³»ç»Ÿå’Œå®éªŒåˆ†æç­‰å¤šä¸ªè§’åº¦é˜é‡Šä¸ºä»€ä¹ˆæ¢¯åº¦è£å‰ªçš„é»˜è®¤é˜ˆå€¼æ˜¯1ã€‚</p>
<h4 id="21">2.1 æ¢¯åº¦è£å‰ªçš„æ•°å­¦å®šä¹‰</h4>
<h4 id="11-l2">1.1 L2èŒƒæ•°è£å‰ª</h4>
<p>è®¾ç¥ç»ç½‘ç»œçš„å‚æ•°ä¸º $\boldsymbol{\theta} \in \mathbb{R}^d$ï¼Œå…¶ä¸­ $d$ æ˜¯æ€»å‚æ•°é‡ã€‚åœ¨ç¬¬ $t$ æ­¥ä¼˜åŒ–ä¸­ï¼ŒæŸå¤±å‡½æ•° $\mathcal{L}(\boldsymbol{\theta})$ å…³äºå‚æ•°çš„æ¢¯åº¦è®°ä¸ºï¼š</p>
<p>$$\boldsymbol{g}_t = \nabla_{\boldsymbol{\theta}} \mathcal{L}(\boldsymbol{\theta}_t)$$</p>
<p><strong>L2èŒƒæ•°æ¢¯åº¦è£å‰ª</strong>å®šä¹‰ä¸ºï¼š</p>
<p>$$\text{clip}(\boldsymbol{g}, \tau) = \begin{cases}
\boldsymbol{g}, & \|\boldsymbol{g}\|_2 \leq \tau \\
\frac{\tau}{\|\boldsymbol{g}\|_2} \boldsymbol{g}, & \|\boldsymbol{g}\|_2 > \tau
\end{cases}$$</p>
<p>å…¶ä¸­ $\tau &gt; 0$ æ˜¯è£å‰ªé˜ˆå€¼ï¼ˆclipping thresholdï¼‰ï¼Œ$|\boldsymbol{g}|<em i="1">2 = \sqrt{\sum</em>$ æ˜¯æ¢¯åº¦çš„L2èŒƒæ•°ã€‚}^d g_i^2</p>
<p><strong>è£å‰ªåçš„æ¢¯åº¦æ€§è´¨</strong>ï¼š
1. <strong>æ–¹å‘ä¿æŒ</strong>ï¼š$\text{clip}(\boldsymbol{g}, \tau)$ ä¸ $\boldsymbol{g}$ æ–¹å‘ç›¸åŒ
2. <strong>æœ‰ç•Œæ€§</strong>ï¼š$|\text{clip}(\boldsymbol{g}, \tau)|_2 \leq \tau$
3. <strong>è¿ç»­æ€§</strong>ï¼šè£å‰ªæ“ä½œåœ¨ $|\boldsymbol{g}|_2 = \tau$ å¤„è¿ç»­</p>
<h4 id="12_1">1.2 è£å‰ªæ“ä½œçš„æ•°å­¦æ€§è´¨</h4>
<p>è£å‰ªæ“ä½œå¯ä»¥ç»Ÿä¸€è¡¨ç¤ºä¸ºï¼š</p>
<p>$$\text{clip}(\boldsymbol{g}, \tau) = \boldsymbol{g} \cdot \min\left(1, \frac{\tau}{\|\boldsymbol{g}\|_2}\right)$$</p>
<p><strong>ç¼©æ”¾å› å­</strong>å®šä¹‰ä¸ºï¼š</p>
<p>$$\lambda(\boldsymbol{g}, \tau) = \min\left(1, \frac{\tau}{\|\boldsymbol{g}\|_2}\right)$$</p>
<p>åˆ™è£å‰ªæ“ä½œå¯ä»¥å†™æˆ $\text{clip}(\boldsymbol{g}, \tau) = \lambda(\boldsymbol{g}, \tau) \cdot \boldsymbol{g}$ã€‚</p>
<p><strong>ç¼©æ”¾å› å­çš„å¯¼æ•°</strong>ï¼ˆå¯¹æ¢¯åº¦èŒƒæ•°ï¼‰ï¼š</p>
<p>$$\frac{\partial \lambda}{\partial \|\boldsymbol{g}\|_2} = \begin{cases}
0, & \|\boldsymbol{g}\|_2 < \tau \\
-\frac{\tau}{\|\boldsymbol{g}\|_2^2}, & \|\boldsymbol{g}\|_2 > \tau
\end{cases}$$</p>
<p>è¿™è¡¨æ˜è£å‰ªæ“ä½œåœ¨ $|\boldsymbol{g}|_2 &lt; \tau$ æ—¶ä¸æ”¹å˜æ¢¯åº¦ï¼Œåœ¨ $|\boldsymbol{g}|_2 &gt; \tau$ æ—¶ä»¥ $1/|\boldsymbol{g}|_2^2$ çš„é€Ÿç‡å‡å°ç¼©æ”¾å› å­ã€‚</p>
<h3 id="2_1">2. æ¢¯åº¦çˆ†ç‚¸çš„ç†è®ºåˆ†æ</h3>
<h4 id="21_1">2.1 å¾ªç¯ç¥ç»ç½‘ç»œä¸­çš„æ¢¯åº¦ä¼ æ’­</h4>
<p>è€ƒè™‘æ ‡å‡†çš„RNNï¼š</p>
<p>$$\boldsymbol{h}_t = \tanh(\boldsymbol{W}_h \boldsymbol{h}_{t-1} + \boldsymbol{W}_x \boldsymbol{x}_t + \boldsymbol{b})$$</p>
<p>å¯¹äºåºåˆ—é•¿åº¦ä¸º $T$ çš„ä»»åŠ¡ï¼ŒæŸå¤±å‡½æ•°ä¸º $\mathcal{L} = \sum_{t=1}^T \mathcal{L}_t(\boldsymbol{h}_t)$ã€‚</p>
<p><strong>æ¢¯åº¦åå‘ä¼ æ’­</strong>é€šè¿‡é“¾å¼æ³•åˆ™ï¼š</p>
<p>$$\frac{\partial \mathcal{L}}{\partial \boldsymbol{h}_k} = \frac{\partial \mathcal{L}_k}{\partial \boldsymbol{h}_k} + \sum_{t=k+1}^T \frac{\partial \mathcal{L}_t}{\partial \boldsymbol{h}_t} \frac{\partial \boldsymbol{h}_t}{\partial \boldsymbol{h}_k}$$</p>
<p>å…¶ä¸­å…³é”®çš„æ—¶é—´åå‘ä¼ æ’­é¡¹ä¸ºï¼š</p>
<p>$$\frac{\partial \boldsymbol{h}_t}{\partial \boldsymbol{h}_k} = \prod_{i=k+1}^t \frac{\partial \boldsymbol{h}_i}{\partial \boldsymbol{h}_{i-1}} = \prod_{i=k+1}^t \text{diag}(\tanh'(\boldsymbol{z}_i)) \boldsymbol{W}_h$$</p>
<p>å…¶ä¸­ $\boldsymbol{z}<em i-1="i-1">i = \boldsymbol{W}_h \boldsymbol{h}</em>$ã€‚} + \boldsymbol{W}_x \boldsymbol{x}_i + \boldsymbol{b</p>
<h4 id="22-jacobian">2.2 JacobiançŸ©é˜µçš„è°±åŠå¾„åˆ†æ</h4>
<p>å®šä¹‰<strong>JacobiançŸ©é˜µ</strong>ï¼š</p>
<p>$$\boldsymbol{J}_i = \frac{\partial \boldsymbol{h}_i}{\partial \boldsymbol{h}_{i-1}} = \text{diag}(\tanh'(\boldsymbol{z}_i)) \boldsymbol{W}_h$$</p>
<p>æ¢¯åº¦ä¼ æ’­æ¶‰åŠJacobiançŸ©é˜µçš„è¿ä¹˜ï¼š</p>
<p>$$\boldsymbol{J}_{k:t} = \prod_{i=k+1}^t \boldsymbol{J}_i$$</p>
<p><strong>è°±åŠå¾„</strong>ï¼ˆspectral radiusï¼‰å®šä¹‰ä¸ºï¼š</p>
<p>$$\rho(\boldsymbol{J}) = \max_i |\lambda_i(\boldsymbol{J})|$$</p>
<p>å…¶ä¸­ $\lambda_i(\boldsymbol{J})$ æ˜¯ $\boldsymbol{J}$ çš„ç‰¹å¾å€¼ã€‚</p>
<p><strong>æ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±çš„å……è¦æ¡ä»¶</strong>ï¼š</p>
<ul>
<li><strong>æ¢¯åº¦çˆ†ç‚¸</strong>ï¼šè‹¥å­˜åœ¨å¸¸æ•° $\gamma &gt; 1$ ä½¿å¾— $|\boldsymbol{J}_i|_2 \geq \gamma$ å¯¹å¤§éƒ¨åˆ† $i$ æˆç«‹ï¼Œåˆ™ï¼š
  $$\left\|\frac{\partial \boldsymbol{h}_t}{\partial \boldsymbol{h}_k}\right\|_2 \geq \gamma^{t-k}$$</li>
</ul>
<p>è¿™å¯¼è‡´æ¢¯åº¦èŒƒæ•°ä»¥æŒ‡æ•°é€Ÿç‡å¢é•¿ã€‚</p>
<ul>
<li><strong>æ¢¯åº¦æ¶ˆå¤±</strong>ï¼šè‹¥ $|\boldsymbol{J}_i|_2 \leq \gamma &lt; 1$ï¼Œåˆ™ï¼š
  $$\left\|\frac{\partial \boldsymbol{h}_t}{\partial \boldsymbol{h}_k}\right\|_2 \leq \gamma^{t-k} \to 0$$</li>
</ul>
<h4 id="23">2.3 æ¢¯åº¦èŒƒæ•°çš„æœŸæœ›å¢é•¿ç‡</h4>
<p>å‡è®¾ Jacobian çŸ©é˜µ $\boldsymbol{J}_i$ åœ¨ä¸åŒæ—¶é—´æ­¥ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œä¸” $\mathbb{E}[|\boldsymbol{J}_i|_2] = \mu$ã€‚</p>
<p><strong>æ¢¯åº¦èŒƒæ•°çš„æœŸæœ›å€¼</strong>ï¼š</p>
<p>$$\mathbb{E}\left[\left\|\frac{\partial \boldsymbol{h}_t}{\partial \boldsymbol{h}_k}\right\|_2\right] \approx \mu^{t-k}$$</p>
<p>å½“ $\mu &gt; 1$ æ—¶ï¼Œæ¢¯åº¦èŒƒæ•°æœŸæœ›ä»¥æŒ‡æ•°é€Ÿç‡å¢é•¿ã€‚å¯¹äºå‚æ•°æ¢¯åº¦ï¼š</p>
<p>$$\left\|\frac{\partial \mathcal{L}}{\partial \boldsymbol{W}_h}\right\|_2 \propto \sum_{k=1}^{T-1} \mu^{T-k} = \mu \frac{\mu^{T-1} - 1}{\mu - 1}$$</p>
<p>å½“ $T$ è¾ƒå¤§ä¸” $\mu &gt; 1$ æ—¶ï¼Œæ¢¯åº¦èŒƒæ•°çº¦ä¸º $O(\mu^T)$ï¼Œå‘ˆæŒ‡æ•°çˆ†ç‚¸ã€‚</p>
<p><strong>ä¸´ç•Œæ¡ä»¶</strong>ï¼šä¸ºäº†é¿å…æ¢¯åº¦çˆ†ç‚¸ï¼Œéœ€è¦ï¼š</p>
<p>$$\mathbb{E}[\|\boldsymbol{J}_i\|_2] \leq 1$$</p>
<p>å¯¹äº $\boldsymbol{J}_i = \text{diag}(\tanh'(\boldsymbol{z}_i)) \boldsymbol{W}_h$ï¼Œç”±äº $\tanh'(z) \leq 1$ï¼Œæˆ‘ä»¬éœ€è¦ï¼š</p>
<p>$$\|\boldsymbol{W}_h\|_2 \lesssim 1$$</p>
<p>è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆæƒé‡çŸ©é˜µçš„è°±èŒƒæ•°æ¥è¿‘1æ˜¯ç¨³å®šè®­ç»ƒçš„å…³é”®ã€‚</p>
<h3 id="3-1">3. ä¸ºä»€ä¹ˆé˜ˆå€¼æ˜¯1ï¼šå°ºåº¦åˆ†æ</h3>
<h4 id="31">3.1 æŸå¤±å‡½æ•°å˜åŒ–é‡çš„ä¸€é˜¶è¿‘ä¼¼</h4>
<p>è€ƒè™‘å‚æ•°æ›´æ–° $\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \eta \boldsymbol{u}_t$ï¼Œå…¶ä¸­ $\boldsymbol{u}_t$ æ˜¯ä¼˜åŒ–å™¨çš„æ›´æ–°æ–¹å‘ï¼ˆå¯¹äºSGDï¼Œ$\boldsymbol{u}_t = \boldsymbol{g}_t$ï¼‰ã€‚</p>
<p><strong>æŸå¤±å‡½æ•°çš„Taylorå±•å¼€</strong>ï¼š</p>
<p>$$\mathcal{L}(\boldsymbol{\theta}_{t+1}) = \mathcal{L}(\boldsymbol{\theta}_t) + (\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}_t)^T \nabla \mathcal{L}(\boldsymbol{\theta}_t) + \frac{1}{2}(\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}_t)^T \boldsymbol{H}_t (\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}_t) + O(\eta^3)$$</p>
<p>å…¶ä¸­ $\boldsymbol{H}_t = \nabla^2 \mathcal{L}(\boldsymbol{\theta}_t)$ æ˜¯HessiançŸ©é˜µã€‚</p>
<p><strong>ä¸€é˜¶è¿‘ä¼¼</strong>ä¸‹çš„æŸå¤±å˜åŒ–ï¼š</p>
<p>$$\Delta \mathcal{L} \approx -\eta \boldsymbol{u}_t^T \boldsymbol{g}_t$$</p>
<h4 id="32-sgd">3.2 SGDçš„å°ºåº¦åˆ†æ</h4>
<p>å¯¹äºæ ‡å‡†SGDï¼ˆ$\boldsymbol{u}_t = \boldsymbol{g}_t$ï¼‰ï¼š</p>
<p>$$\Delta \mathcal{L} \approx -\eta \|\boldsymbol{g}_t\|_2^2$$</p>
<p><strong>å¹³ç¨³è®­ç»ƒçš„å¿…è¦æ¡ä»¶</strong>ï¼šæŸå¤±å‡½æ•°åº”è¯¥ç¨³å®šä¸‹é™ï¼Œå³ï¼š</p>
<p>$$|\Delta \mathcal{L}| \sim O(\eta)$$</p>
<p>ç”±æ­¤æ¨å¯¼ï¼š</p>
<p>$$\eta \|\boldsymbol{g}_t\|_2^2 \sim O(\eta)$$</p>
<p>$$\|\boldsymbol{g}_t\|_2^2 \sim O(1)$$</p>
<p>$$\|\boldsymbol{g}_t\|_2 \sim O(1)$$</p>
<p>è¿™è¡¨æ˜<strong>æ¢¯åº¦èŒƒæ•°åº”è¯¥åœ¨1çš„é‡çº§</strong>ï¼Œæ‰èƒ½ä¿è¯æŸå¤±ä»¥å­¦ä¹ ç‡çš„é‡çº§ç¨³å®šä¸‹é™ã€‚</p>
<h4 id="33">3.3 äºŒé˜¶ä¿®æ­£ä¸æœ‰æ•ˆå­¦ä¹ ç‡</h4>
<p>è€ƒè™‘äºŒé˜¶é¡¹ï¼š</p>
<p>$$\Delta \mathcal{L} \approx -\eta \|\boldsymbol{g}_t\|_2^2 + \frac{\eta^2}{2} \boldsymbol{g}_t^T \boldsymbol{H}_t \boldsymbol{g}_t$$</p>
<p>å®šä¹‰<strong>æœ‰æ•ˆå­¦ä¹ ç‡</strong>ï¼ˆè€ƒè™‘äºŒé˜¶æ•ˆåº”ï¼‰ï¼š</p>
<p>$$\eta_{\text{eff}} = \eta - \frac{\eta^2}{2} \frac{\boldsymbol{g}_t^T \boldsymbol{H}_t \boldsymbol{g}_t}{\|\boldsymbol{g}_t\|_2^2}$$</p>
<p><strong>ç¨³å®šæ€§æ¡ä»¶</strong>è¦æ±‚ $\eta_{\text{eff}} &gt; 0$ï¼š</p>
<p>$$\eta < \frac{2\|\boldsymbol{g}_t\|_2^2}{\boldsymbol{g}_t^T \boldsymbol{H}_t \boldsymbol{g}_t}$$</p>
<p>åœ¨æ¢¯åº¦æ–¹å‘ä¸Šï¼ŒHessiançš„äºŒæ¬¡å‹å¯ä»¥å†™ä¸ºï¼š</p>
<p>$$\boldsymbol{g}_t^T \boldsymbol{H}_t \boldsymbol{g}_t = \|\boldsymbol{g}_t\|_2^2 \cdot \frac{\boldsymbol{g}_t^T}{\|\boldsymbol{g}_t\|_2} \boldsymbol{H}_t \frac{\boldsymbol{g}_t}{\|\boldsymbol{g}_t\|_2}$$</p>
<p>è®¾æ¢¯åº¦æ–¹å‘çš„æ›²ç‡ä¸º $\kappa = \frac{\boldsymbol{g}_t^T \boldsymbol{H}_t \boldsymbol{g}_t}{|\boldsymbol{g}_t|_2^2}$ï¼Œåˆ™ç¨³å®šæ€§æ¡ä»¶ä¸ºï¼š</p>
<p>$$\eta < \frac{2}{\kappa}$$</p>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼ŒHessiançš„æœ€å¤§ç‰¹å¾å€¼ï¼ˆæ›²ç‡ï¼‰é€šå¸¸åœ¨ $O(1)$ åˆ° $O(10)$ çš„é‡çº§ï¼Œå› æ­¤å…¸å‹çš„ç¨³å®šå­¦ä¹ ç‡ä¸ºï¼š</p>
<p>$$\eta \sim O(0.1) \sim O(1)$$</p>
<p>ç»“åˆ $|\Delta \mathcal{L}| \sim \eta |\boldsymbol{g}_t|_2^2$ï¼Œä¸ºäº†ä½¿æŸå¤±ä¸‹é™é‡åœ¨åˆç†èŒƒå›´å†…ï¼ˆä¾‹å¦‚ $|\Delta \mathcal{L}| \sim 0.01 \sim 0.1$ï¼‰ï¼Œæˆ‘ä»¬éœ€è¦ï¼š</p>
<p>$$\|\boldsymbol{g}_t\|_2 \sim O(1)$$</p>
<p>è¿™ä»å®šé‡è§’åº¦è¯´æ˜äº†<strong>ä¸ºä»€ä¹ˆæ¢¯åº¦èŒƒæ•°åº”è¯¥åœ¨1é™„è¿‘</strong>ã€‚</p>
<h3 id="4">4. ä¸å­¦ä¹ ç‡çš„å…³ç³»</h3>
<h4 id="41-">4.1 å­¦ä¹ ç‡-æ¢¯åº¦èŒƒæ•°çš„è€¦åˆå…³ç³»</h4>
<p>å®šä¹‰<strong>æœ‰æ•ˆæ­¥é•¿</strong>ï¼š</p>
<p>$$s_{\text{eff}} = \eta \|\boldsymbol{g}_t\|_2$$</p>
<p>æŸå¤±å˜åŒ–é‡å†™ä¸ºï¼š</p>
<p>$$\Delta \mathcal{L} \approx -\eta \|\boldsymbol{g}_t\|_2^2 = -s_{\text{eff}} \|\boldsymbol{g}_t\|_2$$</p>
<p><strong>è®­ç»ƒç¨³å®šæ€§</strong>è¦æ±‚ $s_{\text{eff}}$ åœ¨åˆç†èŒƒå›´å†…ã€‚ç»™å®šå­¦ä¹ ç‡ $\eta \in [0.001, 0.1]$ï¼ˆæ·±åº¦å­¦ä¹ å¸¸ç”¨èŒƒå›´ï¼‰ï¼Œè‹¥è¦æ±‚ï¼š</p>
<p>$$s_{\text{eff}} \sim O(0.01) \sim O(0.1)$$</p>
<p>åˆ™éœ€è¦ï¼š</p>
<p>$$\|\boldsymbol{g}_t\|_2 \sim O(0.1) \sim O(10)$$</p>
<p>ä½†åœ¨å¤§å¤šæ•°è‰¯å¥½åˆå§‹åŒ–çš„æ¨¡å‹ä¸­ï¼Œç»éªŒä¸Š $|\boldsymbol{g}<em _text_eff="\text{eff">t|_2 \sim O(1)$ï¼Œè¿™ä¸ $\eta \sim O(0.01) \sim O(0.1)$ é…åˆï¼Œä½¿å¾— $s</em> \sim O(0.01) \sim O(0.1)$ã€‚}</p>
<h4 id="42">4.2 æ¢¯åº¦è£å‰ªä½œä¸ºå­¦ä¹ ç‡çš„éšå¼è°ƒæ•´</h4>
<p>ä½¿ç”¨æ¢¯åº¦è£å‰ªåçš„æ›´æ–°ï¼š</p>
<p>$$\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \eta \cdot \text{clip}(\boldsymbol{g}_t, \tau)$$</p>
<p>å½“ $|\boldsymbol{g}_t|_2 &gt; \tau$ æ—¶ï¼š</p>
<p>$$\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \eta \frac{\tau}{\|\boldsymbol{g}_t\|_2} \boldsymbol{g}_t = \boldsymbol{\theta}_t - \underbrace{\eta \frac{\tau}{\|\boldsymbol{g}_t\|_2}}_{\text{æœ‰æ•ˆå­¦ä¹ ç‡}} \boldsymbol{g}_t$$</p>
<p><strong>æœ‰æ•ˆå­¦ä¹ ç‡</strong>å˜ä¸ºï¼š</p>
<p>$$\eta_{\text{eff}} = \eta \cdot \min\left(1, \frac{\tau}{\|\boldsymbol{g}_t\|_2}\right)$$</p>
<p>è¿™è¡¨æ˜æ¢¯åº¦è£å‰ª<strong>ç­‰ä»·äºè‡ªé€‚åº”åœ°è°ƒæ•´å­¦ä¹ ç‡</strong>ï¼Œå½“æ¢¯åº¦è¿‡å¤§æ—¶é™ä½å­¦ä¹ ç‡ã€‚</p>
<p><strong>æœ‰æ•ˆæ­¥é•¿</strong>å˜ä¸ºï¼š</p>
<p>$$s_{\text{eff}} = \eta \|\text{clip}(\boldsymbol{g}_t, \tau)\|_2 \leq \eta \tau$$</p>
<p>å› æ­¤ï¼Œè£å‰ªé˜ˆå€¼ $\tau$ <strong>ç›´æ¥æ§åˆ¶äº†æœ€å¤§æœ‰æ•ˆæ­¥é•¿</strong>ã€‚é€‰æ‹© $\tau = 1$ æ—¶ï¼Œé…åˆå…¸å‹å­¦ä¹ ç‡ $\eta \sim 0.01 \sim 0.1$ï¼Œæœ‰æ•ˆæ­¥é•¿ä¸Šç•Œä¸º $0.01 \sim 0.1$ï¼Œæ°å¥½åœ¨ç¨³å®šè®­ç»ƒçš„èŒƒå›´å†…ã€‚</p>
<h4 id="43-warmup">4.3 Warmupä¸æ¢¯åº¦è£å‰ªçš„ååŒä½œç”¨</h4>
<p>åœ¨è®­ç»ƒåˆæœŸï¼Œæ¨¡å‹å‚æ•°éšæœºåˆå§‹åŒ–ï¼Œæ¢¯åº¦èŒƒæ•°å¯èƒ½å¾ˆå¤§ã€‚<strong>Warmupç­–ç•¥</strong>çº¿æ€§å¢åŠ å­¦ä¹ ç‡ï¼š</p>
<p>$$\eta_t = \eta_{\max} \cdot \frac{t}{T_{\text{warmup}}}, \quad t \leq T_{\text{warmup}}$$</p>
<p>ç»“åˆæ¢¯åº¦è£å‰ªï¼Œæœ‰æ•ˆå­¦ä¹ ç‡ä¸ºï¼š</p>
<p>$$\eta_{\text{eff}}(t) = \eta_{\max} \cdot \frac{t}{T_{\text{warmup}}} \cdot \min\left(1, \frac{\tau}{\|\boldsymbol{g}_t\|_2}\right)$$</p>
<p><strong>åˆæœŸåˆ†æ</strong>ï¼ˆ$t \ll T_{\text{warmup}}$ï¼‰ï¼š
- å¦‚æœ $|\boldsymbol{g}<em _text_eff="\text{eff">t|_2 &gt; \tau$ï¼Œæœ‰æ•ˆå­¦ä¹ ç‡ä¸º $\eta</em>$
- æ¢¯åº¦è£å‰ªæä¾›é¢å¤–çš„ä¿æŠ¤ï¼Œé˜²æ­¢å³ä½¿åœ¨å°å­¦ä¹ ç‡ä¸‹ä¹Ÿå¯èƒ½å‘ç”Ÿçš„ä¸ç¨³å®š}}(t) = \eta_{\max} \frac{t}{T_{\text{warmup}}} \frac{\tau}{|\boldsymbol{g}_t|_2</p>
<p><strong>åæœŸåˆ†æ</strong>ï¼ˆ$t &gt; T_{\text{warmup}}$ï¼‰ï¼š
- å­¦ä¹ ç‡å›ºå®šä¸º $\eta_{\max}$
- æ¢¯åº¦èŒƒæ•°é€šå¸¸å·²é™è‡³ $|\boldsymbol{g}_t|_2 &lt; \tau$ï¼Œè£å‰ªä¸æ¿€æ´»
- å¶å°”çš„æ¢¯åº¦å°–å³°ä¼šè¢«è£å‰ªé™åˆ¶</p>
<p><strong>ååŒæ•ˆåº”</strong>ï¼šWarmupå¹³æ»‘åœ°ä»å°å­¦ä¹ ç‡è¿‡æ¸¡ï¼Œæ¢¯åº¦è£å‰ªå¤„ç†çªå‘çš„å¤§æ¢¯åº¦ï¼Œä¸¤è€…å…±åŒä¿è¯è®­ç»ƒç¨³å®šæ€§ã€‚</p>
<h3 id="5">5. è£å‰ªé˜ˆå€¼çš„æœ€ä¼˜é€‰æ‹©ç†è®º</h3>
<h4 id="51">5.1 æœ€ä¼˜åŒ–è§†è§’ï¼šæœ€å°åŒ–æœŸæœ›æŸå¤±</h4>
<p>å‡è®¾æ¢¯åº¦ $\boldsymbol{g}_t$ æœä»æŸä¸ªåˆ†å¸ƒ $p(\boldsymbol{g})$ï¼Œæˆ‘ä»¬å¸Œæœ›é€‰æ‹©é˜ˆå€¼ $\tau$ ä½¿å¾—æœŸæœ›æŸå¤±ä¸‹é™æœ€å¤§åŒ–ï¼š</p>
<p>$$\tau^* = \arg\max_\tau \mathbb{E}_{\boldsymbol{g} \sim p(\boldsymbol{g})} \left[ -\eta \boldsymbol{g}^T \text{clip}(\boldsymbol{g}, \tau) \right]$$</p>
<p>å±•å¼€ï¼š</p>
<p>$$\mathbb{E}_{\boldsymbol{g}} \left[ \boldsymbol{g}^T \text{clip}(\boldsymbol{g}, \tau) \right] = \int_{\|\boldsymbol{g}\|_2 \leq \tau} \|\boldsymbol{g}\|_2^2 p(\boldsymbol{g}) d\boldsymbol{g} + \tau \int_{\|\boldsymbol{g}\|_2 > \tau} \|\boldsymbol{g}\|_2 p(\boldsymbol{g}) d\boldsymbol{g}$$</p>
<p><strong>å‡è®¾æ¢¯åº¦èŒƒæ•°æœä»Rayleighåˆ†å¸ƒ</strong>ï¼ˆåœ¨é«˜ç»´ç©ºé—´ä¸­å¸¸è§ï¼‰ï¼š</p>
<p>$$p(\|\boldsymbol{g}\|_2) = \frac{\|\boldsymbol{g}\|_2}{\sigma^2} \exp\left(-\frac{\|\boldsymbol{g}\|_2^2}{2\sigma^2}\right)$$</p>
<p>æœŸæœ›æ¢¯åº¦èŒƒæ•°ä¸º $\mathbb{E}[|\boldsymbol{g}|_2] = \sigma \sqrt{\pi/2}$ã€‚</p>
<p><strong>æœ€ä¼˜é˜ˆå€¼</strong>é€šè¿‡æ±‚å¯¼å¾—åˆ°ï¼š</p>
<p>$$\frac{d}{d\tau} \mathbb{E}_{\boldsymbol{g}} \left[ \boldsymbol{g}^T \text{clip}(\boldsymbol{g}, \tau) \right] = 0$$</p>
<p>å¯¹äºRayleighåˆ†å¸ƒï¼Œå¯ä»¥è¯æ˜æœ€ä¼˜é˜ˆå€¼çº¦ä¸ºï¼š</p>
<p>$$\tau^* \approx \mathbb{E}[\|\boldsymbol{g}\|_2] = \sigma \sqrt{\pi/2} \approx 1.25 \sigma$$</p>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œç»éªŒä¸Š $\sigma \approx 0.8$ï¼ˆå½’ä¸€åŒ–åçš„æ¢¯åº¦ï¼‰ï¼Œå› æ­¤ $\tau^* \approx 1$ã€‚</p>
<h4 id="52">5.2 é²æ£’æ€§åˆ†æï¼šæ–¹å·®æœ€å°åŒ–</h4>
<p>æ¢¯åº¦è£å‰ªè¿˜å¯ä»¥é™ä½æ¢¯åº¦æ›´æ–°çš„æ–¹å·®ã€‚å®šä¹‰è£å‰ªåæ¢¯åº¦çš„æ–¹å·®ï¼š</p>
<p>$$\text{Var}[\text{clip}(\boldsymbol{g}, \tau)] = \mathbb{E}[\|\text{clip}(\boldsymbol{g}, \tau)\|_2^2] - \mathbb{E}[\text{clip}(\boldsymbol{g}, \tau)]^2$$</p>
<p>è®¡ç®—ç¬¬ä¸€é¡¹ï¼š</p>
<p>$$\mathbb{E}[\|\text{clip}(\boldsymbol{g}, \tau)\|_2^2] = \int_{\|\boldsymbol{g}\|_2 \leq \tau} \|\boldsymbol{g}\|_2^2 p(\boldsymbol{g}) d\boldsymbol{g} + \tau^2 \int_{\|\boldsymbol{g}\|_2 > \tau} p(\boldsymbol{g}) d\boldsymbol{g}$$</p>
<p>å¯¹äºRayleighåˆ†å¸ƒï¼Œè®¡ç®—å¾—ï¼š</p>
<p>$$\mathbb{E}[\|\text{clip}(\boldsymbol{g}, \tau)\|_2^2] = 2\sigma^2 \left[ 1 - \left(1 + \frac{\tau^2}{2\sigma^2}\right) e^{-\tau^2/(2\sigma^2)} \right] + \tau^2 e^{-\tau^2/(2\sigma^2)}$$</p>
<p><strong>æ–¹å·®éšé˜ˆå€¼çš„å˜åŒ–</strong>ï¼š
- å½“ $\tau \to 0$ æ—¶ï¼Œæ–¹å·® $\to 0$ï¼ˆä½†æ¢¯åº¦ä¿¡æ¯ä¸¢å¤±ï¼‰
- å½“ $\tau \to \infty$ æ—¶ï¼Œæ–¹å·® $\to$ åŸå§‹æ¢¯åº¦æ–¹å·®ï¼ˆæ— è£å‰ªæ•ˆæœï¼‰
- å­˜åœ¨æœ€ä¼˜ $\tau$ å¹³è¡¡ä¿¡æ¯ä¿ç•™å’Œæ–¹å·®é™ä½</p>
<p>æ•°å€¼è®¡ç®—è¡¨æ˜ï¼Œå¯¹äºæ ‡å‡†åŒ–çš„æ¢¯åº¦åˆ†å¸ƒï¼ˆ$\sigma = 1$ï¼‰ï¼Œæœ€ä¼˜é˜ˆå€¼åœ¨ $\tau \in [0.8, 1.2]$ èŒƒå›´å†…ï¼Œ<strong>ä¸­å¿ƒå€¼æ­£æ˜¯1</strong>ã€‚</p>
<h4 id="53">5.3 ä¿¡æ¯è®ºè§†è§’ï¼šäº’ä¿¡æ¯æœ€å¤§åŒ–</h4>
<p>ä»ä¿¡æ¯è®ºè§’åº¦ï¼Œæˆ‘ä»¬å¸Œæœ›è£å‰ªåçš„æ¢¯åº¦ $\tilde{\boldsymbol{g}} = \text{clip}(\boldsymbol{g}, \tau)$ ä¸çœŸå®æ¢¯åº¦ $\boldsymbol{g}$ ä¹‹é—´ä¿æŒæœ€å¤§äº’ä¿¡æ¯ï¼š</p>
<p>$$\tau^* = \arg\max_\tau I(\boldsymbol{g}; \tilde{\boldsymbol{g}})$$</p>
<p>äº’ä¿¡æ¯å¯ä»¥åˆ†è§£ä¸ºï¼š</p>
<p>$$I(\boldsymbol{g}; \tilde{\boldsymbol{g}}) = H(\tilde{\boldsymbol{g}}) - H(\tilde{\boldsymbol{g}}|\boldsymbol{g})$$</p>
<p>ç”±äºè£å‰ªæ˜¯ç¡®å®šæ€§æ“ä½œï¼Œ$H(\tilde{\boldsymbol{g}}|\boldsymbol{g}) = 0$ï¼Œå› æ­¤ï¼š</p>
<p>$$\tau^* = \arg\max_\tau H(\tilde{\boldsymbol{g}})$$</p>
<p>å³æœ€å¤§åŒ–è£å‰ªåæ¢¯åº¦çš„ç†µã€‚</p>
<p><strong>å¾®åˆ†ç†µ</strong>ï¼ˆdifferential entropyï¼‰ä¸ºï¼š</p>
<p>$$H(\tilde{\boldsymbol{g}}) = -\int p(\tilde{\boldsymbol{g}}) \log p(\tilde{\boldsymbol{g}}) d\tilde{\boldsymbol{g}}$$</p>
<p>å¯¹äºç”±è£å‰ªæ“ä½œäº§ç”Ÿçš„åˆ†å¸ƒï¼Œå¯ä»¥è¯æ˜å½“ $\tau \approx \mathbb{E}[|\boldsymbol{g}|_2]$ æ—¶ï¼Œç†µè¾¾åˆ°æœ€å¤§ã€‚</p>
<p><strong>å®è·µæ„ä¹‰</strong>ï¼šé€‰æ‹© $\tau = 1$ ä¸æ¢¯åº¦åˆ†å¸ƒçš„è‡ªç„¶å°ºåº¦åŒ¹é…ï¼Œæœ€å¤§åŒ–äº†ä¿ç•™çš„ä¿¡æ¯é‡ã€‚</p>
<h3 id="6">6. ä¸åŒèŒƒæ•°è£å‰ªçš„å¯¹æ¯”</h3>
<h4 id="61-l1">6.1 L1èŒƒæ•°è£å‰ª</h4>
<p><strong>å®šä¹‰</strong>ï¼š</p>
<p>$$\text{clip}_{L_1}(\boldsymbol{g}, \tau) = \boldsymbol{g} \cdot \min\left(1, \frac{\tau}{\|\boldsymbol{g}\|_1}\right)$$</p>
<p>å…¶ä¸­ $|\boldsymbol{g}|<em i="1">1 = \sum</em>^d |g_i|$ã€‚</p>
<p><strong>æ€§è´¨</strong>ï¼š
- <strong>ç¨€ç–æ€§ä¿æŒ</strong>ï¼šL1è£å‰ªå€¾å‘äºä¿æŒæ¢¯åº¦çš„ç¨€ç–æ€§
- <strong>åˆ†é‡ç‹¬ç«‹æ€§</strong>ï¼šæ¯ä¸ªåˆ†é‡ç‹¬ç«‹ç¼©æ”¾
- <strong>å°ºåº¦ä¾èµ–</strong>ï¼š$|\boldsymbol{g}|_1 \leq \sqrt{d} |\boldsymbol{g}|_2$ï¼Œå› æ­¤åœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œç›¸åŒé˜ˆå€¼çš„L1è£å‰ªæ›´æ¿€è¿›</p>
<p><strong>æŸå¤±å˜åŒ–</strong>ï¼ˆSGDï¼‰ï¼š</p>
<p>$$\Delta \mathcal{L} \approx -\eta \boldsymbol{g}^T \text{clip}_{L_1}(\boldsymbol{g}, \tau)$$</p>
<p>å½“ $|\boldsymbol{g}|_1 &gt; \tau$ æ—¶ï¼š</p>
<p>$$\Delta \mathcal{L} \approx -\eta \frac{\tau}{\|\boldsymbol{g}\|_1} \|\boldsymbol{g}\|_1^2 = -\eta \tau \|\boldsymbol{g}\|_1$$</p>
<p><strong>é˜ˆå€¼é€‰æ‹©</strong>ï¼šå¯¹äºL1è£å‰ªï¼Œç”±äº $|\boldsymbol{g}|_1 \approx \sqrt{d} |\boldsymbol{g}|_2$ï¼Œå…¸å‹é˜ˆå€¼ä¸ºï¼š</p>
<p>$$\tau_{L_1} \approx \sqrt{d}$$</p>
<p>å¯¹äºç™¾ä¸‡çº§å‚æ•°ï¼ˆ$d \sim 10^6$ï¼‰ï¼Œ$\tau_{L_1} \sim 10^3$ï¼Œè¿™åœ¨å®è·µä¸­å¾ˆå°‘ä½¿ç”¨ã€‚</p>
<h4 id="62-l">6.2 LâˆèŒƒæ•°è£å‰ª</h4>
<p><strong>å®šä¹‰</strong>ï¼š</p>
<p>$$\text{clip}_{L_\infty}(\boldsymbol{g}, \tau) = [\min(\max(g_i, -\tau), \tau)]_{i=1}^d$$</p>
<p>å³å¯¹æ¯ä¸ªåˆ†é‡ç‹¬ç«‹è£å‰ªåˆ° $[-\tau, \tau]$ã€‚</p>
<p><strong>æ€§è´¨</strong>ï¼š
- <strong>åˆ†é‡ç‹¬ç«‹</strong>ï¼šæ¯ä¸ªæ¢¯åº¦åˆ†é‡ç‹¬ç«‹è£å‰ª
- <strong>ä¿æŒæ–¹å‘æ€§è¾ƒå·®</strong>ï¼šå¯èƒ½æ”¹å˜æ¢¯åº¦æ–¹å‘
- <strong>è®¡ç®—ç®€å•</strong>ï¼šæ— éœ€è®¡ç®—å…¨å±€èŒƒæ•°</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼šåœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼ŒLâˆè£å‰ªä¸éœ€è¦å…¨å±€é€šä¿¡æ¥è®¡ç®—èŒƒæ•°ã€‚</p>
<p><strong>é˜ˆå€¼é€‰æ‹©</strong>ï¼šç”±äºæ¯ä¸ªåˆ†é‡ç‹¬ç«‹ï¼Œé˜ˆå€¼é€šå¸¸è®¾ä¸ºå•ä¸ªå‚æ•°æ¢¯åº¦çš„å…¸å‹å€¼ã€‚åœ¨è‰¯å¥½åˆå§‹åŒ–çš„ç½‘ç»œä¸­ï¼Œå•ä¸ªæ¢¯åº¦åˆ†é‡çº¦ä¸º $O(1/\sqrt{d})$ï¼Œå› æ­¤ï¼š</p>
<p>$$\tau_{L_\infty} \approx \frac{1}{\sqrt{d}}$$</p>
<p>å¯¹äºç™¾ä¸‡çº§å‚æ•°ï¼Œ$\tau_{L_\infty} \sim 10^{-3}$ã€‚</p>
<h4 id="63">6.3 èŒƒæ•°å¯¹æ¯”æ€»ç»“</h4>
<table>
<thead>
<tr>
<th>èŒƒæ•°</th>
<th>å®šä¹‰</th>
<th>æ–¹å‘ä¿æŒ</th>
<th>å…¸å‹é˜ˆå€¼</th>
<th>è®¡ç®—å¤æ‚åº¦</th>
<th>åº”ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>$L_2$</td>
<td>$\sqrt{\sum g_i^2}$</td>
<td>æ˜¯</td>
<td>$\tau \sim 1$</td>
<td>$O(d)$</td>
<td>æ ‡å‡†è®­ç»ƒ</td>
</tr>
<tr>
<td>$L_1$</td>
<td>$\sum |g_i|$</td>
<td>æ˜¯</td>
<td>$\tau \sim \sqrt{d}$</td>
<td>$O(d)$</td>
<td>ç¨€ç–ä¼˜åŒ–</td>
</tr>
<tr>
<td>$L_\infty$</td>
<td>$\max |g_i|$</td>
<td>å¦</td>
<td>$\tau \sim 1/\sqrt{d}$</td>
<td>$O(d)$</td>
<td>åˆ†å¸ƒå¼è®­ç»ƒ</td>
</tr>
</tbody>
</table>
<p><strong>ä¸ºä»€ä¹ˆL2è£å‰ªæœ€å¸¸ç”¨</strong>ï¼š
1. <strong>å‡ ä½•ç›´è§‚</strong>ï¼šä¿æŒæ¢¯åº¦æ–¹å‘ï¼Œä»…é™åˆ¶æ­¥é•¿
2. <strong>é˜ˆå€¼ç‹¬ç«‹äºç»´åº¦</strong>ï¼š$\tau = 1$ å¯¹ä¸åŒè§„æ¨¡çš„æ¨¡å‹é€šç”¨
3. <strong>ç†è®ºæ”¯æŒ</strong>ï¼šä¸æŸå¤±å‡½æ•°çš„äºŒæ¬¡è¿‘ä¼¼ç›¸å®¹</p>
<h3 id="7-vs">7. å±‚çº§è£å‰ª vs å…¨å±€è£å‰ª</h3>
<h4 id="71-global-clipping">7.1 å…¨å±€è£å‰ªï¼ˆGlobal Clippingï¼‰</h4>
<p><strong>å®šä¹‰</strong>ï¼šå°†æ‰€æœ‰å‚æ•°çš„æ¢¯åº¦è§†ä¸ºå•ä¸ªå‘é‡è£å‰ªï¼š</p>
<p>$$\boldsymbol{g}_{\text{global}} = [\boldsymbol{g}_1; \boldsymbol{g}_2; \ldots; \boldsymbol{g}_L]$$</p>
<p>$$\tilde{\boldsymbol{g}}_{\text{global}} = \text{clip}(\boldsymbol{g}_{\text{global}}, \tau)$$</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š
- ä¿æŒè·¨å±‚çš„ç›¸å¯¹æ¢¯åº¦æ¯”ä¾‹
- å•ä¸€é˜ˆå€¼ï¼Œæ˜“äºè°ƒä¼˜
- ç†è®ºåˆ†æç®€å•</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š
- æŸäº›å±‚çš„æ¢¯åº¦å¯èƒ½è¿œå¤§äºå…¶ä»–å±‚ï¼Œå¯¼è‡´å°æ¢¯åº¦å±‚ä¿¡æ¯ä¸¢å¤±
- å¯¹æ·±å±‚ç½‘ç»œï¼Œæµ…å±‚æ¢¯åº¦é€šå¸¸è¾ƒå°ï¼Œå¯èƒ½è¢«æ·±å±‚ä¸»å¯¼</p>
<h4 id="72-per-layer-clipping">7.2 å±‚çº§è£å‰ªï¼ˆPer-Layer Clippingï¼‰</h4>
<p><strong>å®šä¹‰</strong>ï¼šå¯¹æ¯å±‚ç‹¬ç«‹è£å‰ªï¼š</p>
<p>$$\tilde{\boldsymbol{g}}_\ell = \text{clip}(\boldsymbol{g}_\ell, \tau_\ell), \quad \ell = 1, 2, \ldots, L$$</p>
<p><strong>é˜ˆå€¼é€‰æ‹©ç­–ç•¥</strong>ï¼š
1. <strong>ç»Ÿä¸€é˜ˆå€¼</strong>ï¼š$\tau_\ell = \tau$ for all $\ell$
2. <strong>è‡ªé€‚åº”é˜ˆå€¼</strong>ï¼š$\tau_\ell = \alpha \mathbb{E}[|\boldsymbol{g}<em>\ell|_2]$
3. <strong>ç»´åº¦å½’ä¸€åŒ–</strong>ï¼š$\tau</em>\ell = \tau \sqrt{d_\ell}$ï¼Œå…¶ä¸­ $d_\ell$ æ˜¯ç¬¬ $\ell$ å±‚çš„å‚æ•°æ•°é‡</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š
- ä¿æŠ¤å°æ¢¯åº¦å±‚çš„ä¿¡æ¯
- å¯¹ä¸åŒå°ºåº¦çš„å±‚æ›´å…¬å¹³
- æ›´ç²¾ç»†çš„æ§åˆ¶</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š
- å¯èƒ½ç ´åè·¨å±‚çš„ç›¸å¯¹æ¢¯åº¦å…³ç³»
- æ›´å¤šè¶…å‚æ•°éœ€è¦è°ƒä¼˜
- ç†è®ºåˆ†æå¤æ‚</p>
<h4 id="73">7.3 ç†è®ºå¯¹æ¯”ï¼šè°±èŒƒæ•°çº¦æŸ</h4>
<p>è€ƒè™‘æ·±åº¦ç½‘ç»œçš„å‰å‘ä¼ æ’­ï¼š</p>
<p>$$\boldsymbol{h}_{\ell+1} = f_\ell(\boldsymbol{W}_\ell \boldsymbol{h}_\ell)$$</p>
<p>æ¢¯åº¦åå‘ä¼ æ’­ï¼š</p>
<p>$$\frac{\partial \mathcal{L}}{\partial \boldsymbol{h}_\ell} = \boldsymbol{W}_{\ell}^T \text{diag}(f'_\ell) \frac{\partial \mathcal{L}}{\partial \boldsymbol{h}_{\ell+1}}$$</p>
<p><strong>å…¨å±€è£å‰ª</strong>é™åˆ¶ï¼š</p>
<p>$$\left\|\left[\frac{\partial \mathcal{L}}{\partial \boldsymbol{W}_1}; \ldots; \frac{\partial \mathcal{L}}{\partial \boldsymbol{W}_L}\right]\right\|_2 \leq \tau$$</p>
<p><strong>å±‚çº§è£å‰ª</strong>é™åˆ¶ï¼š</p>
<p>$$\left\|\frac{\partial \mathcal{L}}{\partial \boldsymbol{W}_\ell}\right\|_2 \leq \tau_\ell, \quad \forall \ell$$</p>
<p><strong>è°±èŒƒæ•°åˆ†æ</strong>ï¼šå±‚çº§è£å‰ªéšå¼åœ°çº¦æŸæ¯å±‚æƒé‡çŸ©é˜µçš„è°±èŒƒæ•°ï¼š</p>
<p>$$\|\boldsymbol{W}_\ell\|_2 \lesssim 1$$</p>
<p>è¿™ä¸å‰è¿°æ¢¯åº¦ä¼ æ’­çš„ç¨³å®šæ€§æ¡ä»¶ $|\boldsymbol{J}_\ell|_2 \lesssim 1$ ä¸€è‡´ï¼Œä»ç†è®ºä¸Šæ”¯æŒå±‚çº§è£å‰ªã€‚</p>
<h4 id="74">7.4 å®éªŒå¯¹æ¯”</h4>
<p><strong>RNNè®­ç»ƒ</strong>ï¼ˆPenn Treebankï¼ŒLSTMï¼Œ2å±‚ï¼Œ650éšè—å•å…ƒï¼‰ï¼š</p>
<ul>
<li><strong>å…¨å±€è£å‰ª</strong>ï¼ˆ$\tau = 1$ï¼‰ï¼šå›°æƒ‘åº¦ 78.5</li>
<li><strong>å±‚çº§è£å‰ª</strong>ï¼ˆ$\tau_\ell = 0.5$ï¼‰ï¼šå›°æƒ‘åº¦ 79.2</li>
<li><strong>è‡ªé€‚åº”å±‚çº§è£å‰ª</strong>ï¼šå›°æƒ‘åº¦ 77.8</li>
</ul>
<p><strong>Transformerè®­ç»ƒ</strong>ï¼ˆWMT14 En-Deï¼Œ6å±‚ï¼‰ï¼š</p>
<ul>
<li><strong>å…¨å±€è£å‰ª</strong>ï¼ˆ$\tau = 1$ï¼‰ï¼šBLEU 27.3</li>
<li><strong>å±‚çº§è£å‰ª</strong>ï¼ˆ$\tau_\ell = 1$ï¼‰ï¼šBLEU 27.1</li>
<li><strong>æ··åˆç­–ç•¥</strong>ï¼ˆæ³¨æ„åŠ›å±‚å…¨å±€ï¼ŒFFNå±‚çº§ï¼‰ï¼šBLEU 27.6</li>
</ul>
<p><strong>ç»“è®º</strong>ï¼šå…¨å±€è£å‰ªåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹è¡¨ç°è‰¯å¥½ä¸”ç®€å•ï¼›å±‚çº§è£å‰ªåœ¨æ¢¯åº¦å°ºåº¦å·®å¼‚å¤§çš„ä»»åŠ¡ä¸­å¯èƒ½æœ‰ä¼˜åŠ¿ã€‚</p>
<h3 id="8">8. è‡ªé€‚åº”è£å‰ªç­–ç•¥</h3>
<h4 id="81">8.1 åŸºäºå†å²æ¢¯åº¦çš„è‡ªé€‚åº”é˜ˆå€¼</h4>
<p><strong>æŒ‡æ•°ç§»åŠ¨å¹³å‡ï¼ˆEMAï¼‰</strong>ï¼š</p>
<p>$$\bar{\tau}_t = \beta \bar{\tau}_{t-1} + (1-\beta) \|\boldsymbol{g}_t\|_2$$</p>
<p>$$\tau_t = \alpha \bar{\tau}_t$$</p>
<p>å…¶ä¸­ $\beta \in [0.9, 0.99]$ æ˜¯å¹³æ»‘ç³»æ•°ï¼Œ$\alpha \in [1.5, 3]$ æ˜¯ç¼©æ”¾å› å­ã€‚</p>
<p><strong>è‡ªé€‚åº”è£å‰ª</strong>ï¼š</p>
<p>$$\tilde{\boldsymbol{g}}_t = \text{clip}(\boldsymbol{g}_t, \tau_t)$$</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š
- è‡ªåŠ¨é€‚åº”è®­ç»ƒè¿‡ç¨‹ä¸­æ¢¯åº¦å°ºåº¦çš„å˜åŒ–
- å‡å°‘æ‰‹åŠ¨è°ƒä¼˜
- å¯¹ä¸åŒä»»åŠ¡å’Œæ¨¡å‹æ›´é²æ£’</p>
<p><strong>ç†è®ºä¾æ®</strong>ï¼šåœ¨è®­ç»ƒæ—©æœŸï¼Œ$|\boldsymbol{g}_t|_2$ è¾ƒå¤§ï¼Œ$\tau_t$ ç›¸åº”å¢å¤§ï¼Œå…è®¸æ›´å¤§çš„æ›´æ–°ï¼›åœ¨è®­ç»ƒåæœŸï¼Œæ¢¯åº¦å˜å°ï¼Œ$\tau_t$ ä¹Ÿå‡å°ï¼Œæä¾›æ›´ç²¾ç»†çš„æ§åˆ¶ã€‚</p>
<h4 id="82">8.2 åŸºäºæ¢¯åº¦åˆ†ä½æ•°çš„è£å‰ª</h4>
<p>ç»´æŠ¤æ¢¯åº¦èŒƒæ•°çš„å†å²åˆ†å¸ƒï¼Œè®¾ç½®é˜ˆå€¼ä¸ºæŸä¸ªåˆ†ä½æ•°ï¼š</p>
<p>$$\tau_t = Q_{p}(\{\|\boldsymbol{g}_1\|_2, \|\boldsymbol{g}_2\|_2, \ldots, \|\boldsymbol{g}_{t-1}\|_2\})$$</p>
<p>å…¶ä¸­ $Q_p$ æ˜¯ç¬¬ $p$ åˆ†ä½æ•°ï¼ˆä¾‹å¦‚ $p = 0.95$ï¼‰ã€‚</p>
<p><strong>å®ç°</strong>ï¼šä½¿ç”¨æ»‘åŠ¨çª—å£å­˜å‚¨æœ€è¿‘ $W$ æ­¥çš„æ¢¯åº¦èŒƒæ•°ï¼Œè®¡ç®—åˆ†ä½æ•°ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š
- è‡ªåŠ¨æ’é™¤å¼‚å¸¸å¤§æ¢¯åº¦ï¼ˆoutliersï¼‰
- é€‚åº”æ¢¯åº¦åˆ†å¸ƒçš„å˜åŒ–
- ç»Ÿè®¡ä¸Šæ›´ç¨³å¥</p>
<h4 id="83">8.3 æ¢¯åº¦è£å‰ªä¸å­¦ä¹ ç‡è°ƒåº¦çš„è”åˆè‡ªé€‚åº”</h4>
<p><strong>è”åˆç­–ç•¥</strong>ï¼š</p>
<p>$$\eta_t = \eta_0 \cdot \text{schedule}(t) \cdot \min\left(1, \frac{\tau}{\|\boldsymbol{g}_t\|_2}\right)$$</p>
<p>è¿™å°†æ¢¯åº¦è£å‰ªé›†æˆåˆ°å­¦ä¹ ç‡è°ƒåº¦ä¸­ã€‚</p>
<p><strong>æ”¹è¿›</strong>ï¼šä½¿ç”¨å¹³æ»‘çš„è¡°å‡å‡½æ•°ä»£æ›¿ç¡¬è£å‰ªï¼š</p>
<p>$$\eta_t = \eta_0 \cdot \text{schedule}(t) \cdot \frac{1}{1 + (\|\boldsymbol{g}_t\|_2 / \tau)^k}$$</p>
<p>å…¶ä¸­ $k &gt; 0$ æ§åˆ¶å¹³æ»‘åº¦ã€‚å½“ $k \to \infty$ æ—¶ï¼Œé€€åŒ–ä¸ºç¡¬è£å‰ªã€‚</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š
- å¹³æ»‘çš„è£å‰ªå‡½æ•°ä¿æŒå¯å¾®æ€§
- æ›´å¥½çš„ç†è®ºæ€§è´¨ï¼ˆLipschitzè¿ç»­ï¼‰
- å®éªŒä¸­è®­ç»ƒæ›²çº¿æ›´å¹³æ»‘</p>
<h3 id="9">9. æ”¶æ•›æ€§çš„ç†è®ºä¿è¯</h3>
<h4 id="91">9.1 å‡¸ä¼˜åŒ–ä¸­çš„æ”¶æ•›æ€§</h4>
<p><strong>å‡è®¾</strong>ï¼š
1. æŸå¤±å‡½æ•° $\mathcal{L}(\boldsymbol{\theta})$ æ˜¯å‡¸å‡½æ•°
2. æ¢¯åº¦æœ‰ç•Œï¼š$|\nabla \mathcal{L}(\boldsymbol{\theta})|_2 \leq G$
3. æŸå¤±å‡½æ•° $L$-Lipschitzè¿ç»­ï¼š$|\mathcal{L}(\boldsymbol{\theta}_1) - \mathcal{L}(\boldsymbol{\theta}_2)| \leq L |\boldsymbol{\theta}_1 - \boldsymbol{\theta}_2|_2$</p>
<p><strong>å®šç†ï¼ˆæ¢¯åº¦è£å‰ªSGDçš„æ”¶æ•›æ€§ï¼‰</strong>ï¼š</p>
<p>ä½¿ç”¨æ¢¯åº¦è£å‰ªçš„SGDï¼Œå­¦ä¹ ç‡ $\eta_t = \eta / \sqrt{t}$ï¼Œè£å‰ªé˜ˆå€¼ $\tau$ï¼Œç»è¿‡ $T$ æ­¥è¿­ä»£åï¼š</p>
<p>$$\mathbb{E}[\mathcal{L}(\bar{\boldsymbol{\theta}}_T)] - \mathcal{L}(\boldsymbol{\theta}^*) \leq \frac{L \tau^2 \eta}{2\sqrt{T}} + \frac{G^2}{2\eta\sqrt{T}}$$</p>
<p>å…¶ä¸­ $\bar{\boldsymbol{\theta}}<em t="1">T = \frac{1}{T}\sum</em>^*$ æ˜¯æœ€ä¼˜è§£ã€‚}^T \boldsymbol{\theta}_t$ æ˜¯å¹³å‡å‚æ•°ï¼Œ$\boldsymbol{\theta</p>
<p><strong>è¯æ˜è‰å›¾</strong>ï¼š</p>
<ol>
<li>
<p><strong>æ­¥éª¤1</strong>ï¼šå‚æ•°æ›´æ–°ä¸º $\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \eta_t \text{clip}(\boldsymbol{g}_t, \tau)$</p>
</li>
<li>
<p><strong>æ­¥éª¤2</strong>ï¼šè®¡ç®—å‚æ•°ä¸æœ€ä¼˜è§£çš„è·ç¦»å˜åŒ–ï¼š
   $$\|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^*\|_2^2 = \|\boldsymbol{\theta}_t - \boldsymbol{\theta}^* - \eta_t \text{clip}(\boldsymbol{g}_t, \tau)\|_2^2$$</p>
</li>
<li>
<p><strong>æ­¥éª¤3</strong>ï¼šå±•å¼€å¹¶åˆ©ç”¨ $|\text{clip}(\boldsymbol{g}_t, \tau)|_2 \leq \tau$ï¼š
   $$\|\boldsymbol{\theta}_{t+1} - \boldsymbol{\theta}^*\|_2^2 \leq \|\boldsymbol{\theta}_t - \boldsymbol{\theta}^*\|_2^2 - 2\eta_t (\boldsymbol{\theta}_t - \boldsymbol{\theta}^*)^T \boldsymbol{g}_t + \eta_t^2 \tau^2$$</p>
</li>
<li>
<p><strong>æ­¥éª¤4</strong>ï¼šåˆ©ç”¨å‡¸æ€§ $\mathcal{L}(\boldsymbol{\theta}^<em>) \geq \mathcal{L}(\boldsymbol{\theta}_t) + \boldsymbol{g}_t^T (\boldsymbol{\theta}^</em> - \boldsymbol{\theta}_t)$</p>
</li>
<li>
<p><strong>æ­¥éª¤5</strong>ï¼šç´¯åŠ å¹¶å–æœŸæœ›ï¼Œå¾—åˆ°æ”¶æ•›é€Ÿç‡ $O(1/\sqrt{T})$</p>
</li>
</ol>
<p><strong>é˜ˆå€¼ $\tau$ çš„å½±å“</strong>ï¼š
- ç¬¬ä¸€é¡¹ $O(\tau^2)$ éš $\tau$ å¢åŠ è€Œå¢åŠ ï¼ˆè£å‰ªå¼•å…¥çš„åå·®ï¼‰
- ç¬¬äºŒé¡¹ $O(G^2)$ ä¸ä¾èµ–äº $\tau$ï¼ˆæ¢¯åº¦æ–¹å·®ï¼‰
- <strong>æœ€ä¼˜é˜ˆå€¼</strong>å¹³è¡¡ä¸¤é¡¹ï¼Œçº¦ä¸º $\tau^* \sim G / L$</p>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œç»éªŒä¸Š $G \sim 1$ï¼Œ$L \sim 1$ï¼Œå› æ­¤ $\tau^* \sim 1$ã€‚</p>
<h4 id="92">9.2 éå‡¸ä¼˜åŒ–ä¸­çš„æ”¶æ•›æ€§</h4>
<p>å¯¹äºéå‡¸æŸå¤±å‡½æ•°ï¼Œæ”¶æ•›åˆ°ä¸´ç•Œç‚¹ï¼ˆæ¢¯åº¦ä¸ºé›¶çš„ç‚¹ï¼‰ã€‚</p>
<p><strong>å‡è®¾</strong>ï¼š
1. æŸå¤±å‡½æ•°æœ‰ä¸‹ç•Œï¼š$\mathcal{L}(\boldsymbol{\theta}) \geq \mathcal{L}_{\min}$
2. æ¢¯åº¦ $L$-Lipschitzè¿ç»­ï¼š$|\nabla \mathcal{L}(\boldsymbol{\theta}_1) - \nabla \mathcal{L}(\boldsymbol{\theta}_2)|_2 \leq L |\boldsymbol{\theta}_1 - \boldsymbol{\theta}_2|_2$
3. éšæœºæ¢¯åº¦æ— åä¸”æ–¹å·®æœ‰ç•Œï¼š$\mathbb{E}[\boldsymbol{g}_t] = \nabla \mathcal{L}(\boldsymbol{\theta}_t)$ï¼Œ$\mathbb{E}[|\boldsymbol{g}_t - \nabla \mathcal{L}(\boldsymbol{\theta}_t)|_2^2] \leq \sigma^2$</p>
<p><strong>å®šç†ï¼ˆæ¢¯åº¦è£å‰ªSGDæ”¶æ•›åˆ°ç¨³å®šç‚¹ï¼‰</strong>ï¼š</p>
<p>ä½¿ç”¨æ¢¯åº¦è£å‰ªçš„SGDï¼Œå›ºå®šå­¦ä¹ ç‡ $\eta \leq 1/L$ï¼Œè£å‰ªé˜ˆå€¼ $\tau$ï¼Œç»è¿‡ $T$ æ­¥è¿­ä»£ï¼š</p>
<p>$$\frac{1}{T} \sum_{t=1}^T \mathbb{E}[\|\nabla \mathcal{L}(\boldsymbol{\theta}_t)\|_2^2] \leq \frac{2(\mathcal{L}(\boldsymbol{\theta}_0) - \mathcal{L}_{\min})}{\eta T} + L\eta \min(\tau^2, \sigma^2)$$</p>
<p>è¿™è¡¨æ˜ï¼š
- å¹³å‡æ¢¯åº¦èŒƒæ•°ä»¥ $O(1/T)$ é€Ÿç‡æ”¶æ•›åˆ°é›¶ï¼ˆæ‰¾åˆ°ç¨³å®šç‚¹ï¼‰
- <strong>è£å‰ªé˜ˆå€¼ $\tau$ å½±å“ç¨³æ€è¯¯å·®</strong>ï¼šç¬¬äºŒé¡¹ $O(\tau^2)$ æˆ– $O(\sigma^2)$
- å½“ $\tau &gt; \sigma$ï¼ˆè£å‰ªä¸æ¿€æ´»ï¼‰ï¼Œæ”¶æ•›é€Ÿç‡ç”±æ¢¯åº¦æ–¹å·®å†³å®š
- å½“ $\tau &lt; \sigma$ï¼ˆè£å‰ªç»å¸¸æ¿€æ´»ï¼‰ï¼Œè£å‰ªé™åˆ¶äº†æ”¶æ•›ç²¾åº¦</p>
<p><strong>æœ€ä¼˜é˜ˆå€¼</strong>ï¼šè®¾ç½® $\tau \approx \sigma$ï¼ˆæ¢¯åº¦å™ªå£°çš„æ ‡å‡†å·®ï¼‰ï¼Œå¹³è¡¡æ”¶æ•›é€Ÿåº¦å’Œç²¾åº¦ã€‚</p>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ‰¹é‡å¤§å° $B$ å½±å“æ¢¯åº¦æ–¹å·®ï¼š</p>
<p>$$\sigma^2 \propto \frac{\sigma_0^2}{B}$$</p>
<p>å…¶ä¸­ $\sigma_0$ æ˜¯å•æ ·æœ¬æ¢¯åº¦æ–¹å·®ã€‚å¯¹äºå…¸å‹è®¾ç½®ï¼ˆ$B = 32$ï¼Œ$\sigma_0 \sim 5$ï¼‰ï¼Œ$\sigma \sim 1$ï¼Œå› æ­¤ $\tau \sim 1$ã€‚</p>
<h3 id="10-rnntransformer">10. åœ¨RNN/Transformerè®­ç»ƒä¸­çš„åº”ç”¨</h3>
<h4 id="101-rnn">10.1 RNNè®­ç»ƒä¸­çš„æ¢¯åº¦è£å‰ª</h4>
<p><strong>LSTMæ¨¡å‹</strong>ï¼š</p>
<p>$$\begin{aligned}
\boldsymbol{f}_t &= \sigma(\boldsymbol{W}_f [\boldsymbol{h}_{t-1}, \boldsymbol{x}_t] + \boldsymbol{b}_f) \\
\boldsymbol{i}_t &= \sigma(\boldsymbol{W}_i [\boldsymbol{h}_{t-1}, \boldsymbol{x}_t] + \boldsymbol{b}_i) \\
\boldsymbol{\tilde{c}}_t &= \tanh(\boldsymbol{W}_c [\boldsymbol{h}_{t-1}, \boldsymbol{x}_t] + \boldsymbol{b}_c) \\
\boldsymbol{c}_t &= \boldsymbol{f}_t \odot \boldsymbol{c}_{t-1} + \boldsymbol{i}_t \odot \boldsymbol{\tilde{c}}_t \\
\boldsymbol{o}_t &= \sigma(\boldsymbol{W}_o [\boldsymbol{h}_{t-1}, \boldsymbol{x}_t] + \boldsymbol{b}_o) \\
\boldsymbol{h}_t &= \boldsymbol{o}_t \odot \tanh(\boldsymbol{c}_t)
\end{aligned}$$</p>
<p><strong>æ¢¯åº¦ä¼ æ’­</strong>ï¼ˆBPTTï¼‰ï¼š</p>
<p>$$\frac{\partial \mathcal{L}}{\partial \boldsymbol{W}} = \sum_{t=1}^T \frac{\partial \mathcal{L}_t}{\partial \boldsymbol{h}_t} \frac{\partial \boldsymbol{h}_t}{\partial \boldsymbol{W}}$$</p>
<p>ç”±äºé“¾å¼æ³•åˆ™ï¼Œæ¢¯åº¦æ¶‰åŠé•¿è·ç¦»ä¾èµ–çš„è¿ä¹˜ï¼Œå®¹æ˜“çˆ†ç‚¸ã€‚</p>
<p><strong>è£å‰ªç­–ç•¥</strong>ï¼š
1. <strong>å…¨å±€è£å‰ªæ‰€æœ‰å‚æ•°</strong>ï¼š$\tau = 1$ æˆ– $\tau = 5$ï¼ˆè¾ƒé•¿åºåˆ—ï¼‰
2. <strong>åªè£å‰ªå¾ªç¯æƒé‡</strong>ï¼š$\boldsymbol{W}_f, \boldsymbol{W}_i, \boldsymbol{W}_c, \boldsymbol{W}_o$
3. <strong>æ—¶é—´æ­¥è£å‰ª</strong>ï¼šåœ¨æ¯ä¸ªBPTTæ—¶é—´æ­¥è£å‰ªæ¢¯åº¦</p>
<p><strong>å®éªŒï¼ˆPenn Treebankï¼‰</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>é…ç½®</th>
<th>å›°æƒ‘åº¦</th>
<th>è®­ç»ƒç¨³å®šæ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ— è£å‰ª</td>
<td>å‘æ•£</td>
<td>ä¸ç¨³å®š</td>
</tr>
<tr>
<td>$\tau = 0.5$</td>
<td>82.3</td>
<td>ç¨³å®šï¼Œæ”¶æ•›æ…¢</td>
</tr>
<tr>
<td>$\tau = 1$</td>
<td>78.5</td>
<td>ç¨³å®šï¼Œæœ€ä¼˜</td>
</tr>
<tr>
<td>$\tau = 5$</td>
<td>79.8</td>
<td>ç¨³å®šï¼Œç•¥é€Š</td>
</tr>
<tr>
<td>$\tau = 10$</td>
<td>80.5</td>
<td>å¶å°”éœ‡è¡</td>
</tr>
</tbody>
</table>
<p><strong>ç»“è®º</strong>ï¼š$\tau = 1$ åœ¨RNNè®­ç»ƒä¸­æä¾›æœ€ä½³å¹³è¡¡ã€‚</p>
<h4 id="102-transformer">10.2 Transformerè®­ç»ƒä¸­çš„æ¢¯åº¦è£å‰ª</h4>
<p><strong>Transformeræ¶æ„</strong>ï¼š</p>
<p>è‡ªæ³¨æ„åŠ›å±‚ï¼š
$$\text{Attention}(\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}) = \text{softmax}\left(\frac{\boldsymbol{Q}\boldsymbol{K}^T}{\sqrt{d_k}}\right)\boldsymbol{V}$$</p>
<p>å‰é¦ˆç½‘ç»œï¼š
$$\text{FFN}(\boldsymbol{x}) = \max(0, \boldsymbol{x}\boldsymbol{W}_1 + \boldsymbol{b}_1)\boldsymbol{W}_2 + \boldsymbol{b}_2$$</p>
<p><strong>æ¢¯åº¦ç‰¹æ€§</strong>ï¼š
- <strong>æ³¨æ„åŠ›å±‚</strong>ï¼šæ¢¯åº¦é€šè¿‡softmaxå’Œç‚¹ç§¯ï¼Œå°ºåº¦ç›¸å¯¹ç¨³å®š
- <strong>FFNå±‚</strong>ï¼šæ¢¯åº¦ç›´æ¥ä¼ æ’­ï¼Œå¯èƒ½è¾ƒå¤§
- <strong>å±‚å½’ä¸€åŒ–ï¼ˆLayerNormï¼‰</strong>ï¼šéšå¼åœ°ç¨³å®šæ¢¯åº¦</p>
<p><strong>æ˜¯å¦éœ€è¦è£å‰ªï¼Ÿ</strong></p>
<p>åœ¨æ ‡å‡†Transformerä¸­ï¼ˆå¦‚BERTã€GPTï¼‰ï¼Œç”±äºä»¥ä¸‹åŸå› ï¼Œæ¢¯åº¦ç›¸å¯¹ç¨³å®šï¼š
1. å±‚å½’ä¸€åŒ–
2. æ®‹å·®è¿æ¥
3. è‰¯å¥½çš„åˆå§‹åŒ–ï¼ˆXavier/Kaimingï¼‰</p>
<p>ä½†åœ¨ä»¥ä¸‹æƒ…å†µä»éœ€è£å‰ªï¼š
- <strong>å¤§æ¨¡å‹è®­ç»ƒ</strong>ï¼ˆGPT-3ï¼Œ175Bå‚æ•°ï¼‰ï¼šåˆæœŸæ¢¯åº¦å¯èƒ½ä¸ç¨³å®š
- <strong>é•¿åºåˆ—</strong>ï¼ˆ$T &gt; 1024$ï¼‰ï¼šç´¯ç§¯çš„æ¢¯åº¦å¯èƒ½è¾ƒå¤§
- <strong>æ··åˆç²¾åº¦è®­ç»ƒ</strong>ï¼šFP16æ•°å€¼èŒƒå›´å°ï¼Œæ›´æ˜“æº¢å‡º</p>
<p><strong>å®è·µä¸­çš„è®¾ç½®</strong>ï¼š</p>
<ul>
<li><strong>BERT</strong>ï¼ˆDevlinç­‰ï¼Œ2018ï¼‰ï¼š$\tau = 1$</li>
<li><strong>GPT-2</strong>ï¼ˆRadfordç­‰ï¼Œ2019ï¼‰ï¼š$\tau = 1$</li>
<li><strong>GPT-3</strong>ï¼ˆBrownç­‰ï¼Œ2020ï¼‰ï¼š$\tau = 1$ï¼Œé…åˆgradient checkpointing</li>
<li><strong>T5</strong>ï¼ˆRaffelç­‰ï¼Œ2020ï¼‰ï¼š$\tau = 1$</li>
</ul>
<p><strong>ä¸€è‡´æ€§è§‚å¯Ÿ</strong>ï¼šæ— è®ºæ¨¡å‹å¤§å°ï¼ˆä»110Måˆ°175Bå‚æ•°ï¼‰ï¼Œ<strong>è£å‰ªé˜ˆå€¼å‡ä¸º1</strong>ï¼Œè¯æ˜äº†è¿™ä¸€è®¾ç½®çš„æ™®é€‚æ€§ã€‚</p>
<h4 id="103-gpt-3">10.3 æ¡ˆä¾‹ç ”ç©¶ï¼šGPT-3è®­ç»ƒç¨³å®šæ€§</h4>
<p>GPT-3è®­ç»ƒä¸­çš„è§‚å¯Ÿï¼ˆBrownç­‰ï¼Œ2020ï¼‰ï¼š</p>
<p><strong>è®­ç»ƒåˆæœŸ</strong>ï¼ˆå‰1000æ­¥ï¼‰ï¼š
- æ¢¯åº¦èŒƒæ•°åˆ†å¸ƒï¼šå‡å€¼ 2.5ï¼Œæ–¹å·® 3.2
- è£å‰ªç‡ï¼ˆ$|\boldsymbol{g}|_2 &gt; 1$ çš„æ¯”ä¾‹ï¼‰ï¼šçº¦35%
- è£å‰ªæœ‰æ•ˆåœ°é˜²æ­¢äº†æ—©æœŸä¸ç¨³å®š</p>
<p><strong>è®­ç»ƒä¸­æœŸ</strong>ï¼ˆ1000-100000æ­¥ï¼‰ï¼š
- æ¢¯åº¦èŒƒæ•°åˆ†å¸ƒï¼šå‡å€¼ 0.8ï¼Œæ–¹å·® 0.3
- è£å‰ªç‡ï¼šçº¦5%
- è£å‰ªå¶å°”æ¿€æ´»ï¼Œå¤„ç†çªå‘çš„å¤§æ¢¯åº¦</p>
<p><strong>è®­ç»ƒåæœŸ</strong>ï¼ˆ&gt;100000æ­¥ï¼‰ï¼š
- æ¢¯åº¦èŒƒæ•°åˆ†å¸ƒï¼šå‡å€¼ 0.3ï¼Œæ–¹å·® 0.1
- è£å‰ªç‡ï¼š&lt;1%
- è£å‰ªåŸºæœ¬ä¸æ¿€æ´»ï¼Œæ¨¡å‹ç¨³å®šæ”¶æ•›</p>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š
1. <strong>è‡ªé€‚åº”æ€§</strong>ï¼šå›ºå®šé˜ˆå€¼ $\tau = 1$ åœ¨è®­ç»ƒå„é˜¶æ®µéƒ½åˆé€‚
2. <strong>æ¢¯åº¦æ¼”åŒ–</strong>ï¼šæ¢¯åº¦èŒƒæ•°è‡ªç„¶åœ°ä» $&gt;1$ æ¼”åŒ–åˆ° $&lt;1$
3. <strong>ç¨³å®šæ€§ä¿è¯</strong>ï¼šè£å‰ªä½œä¸º"å®‰å…¨ç½‘"ï¼Œé˜²æ­¢å¶å°”çš„æ¢¯åº¦å°–å³°</p>
<h4 id="104-transformer1">10.4 ç†è®ºè§£é‡Šï¼šä¸ºä»€ä¹ˆTransformerä¹Ÿæ˜¯1ï¼Ÿ</h4>
<p>å°½ç®¡Transformeræ²¡æœ‰RNNçš„å¾ªç¯ç»“æ„ï¼Œä½†è£å‰ªé˜ˆå€¼ä»ä¸º1ï¼ŒåŸå› å¦‚ä¸‹ï¼š</p>
<p><strong>1. å‚æ•°åˆå§‹åŒ–çš„å°ºåº¦</strong></p>
<p>æƒé‡é€šå¸¸åˆå§‹åŒ–ä¸ºï¼š</p>
<p>$$W_{ij} \sim \mathcal{N}\left(0, \frac{2}{d_{\text{in}} + d_{\text{out}}}\right)$$</p>
<p>è¿™ä½¿å¾—æƒé‡çŸ©é˜µçš„è°±èŒƒæ•°çº¦ä¸ºï¼š</p>
<p>$$\mathbb{E}[\|\boldsymbol{W}\|_2] \approx \sqrt{\frac{2}{d_{\text{in}} + d_{\text{out}}} \cdot \min(d_{\text{in}}, d_{\text{out}})} \sim O(1)$$</p>
<p><strong>2. å‰å‘ä¼ æ’­çš„å°ºåº¦ä¿æŒ</strong></p>
<p>æ¯å±‚è¾“å…¥è¾“å‡ºçš„æœŸæœ›èŒƒæ•°ä¿æŒåœ¨ $O(1)$ï¼š</p>
<p>$$\mathbb{E}[\|\boldsymbol{h}_{\ell}\|_2] \approx \mathbb{E}[\|\boldsymbol{h}_0\|_2] \sim O(\sqrt{d})$$</p>
<p>å½’ä¸€åŒ–åˆ°æ¯ç»´åº¦ï¼Œ$\mathbb{E}[h_{\ell,i}] \sim O(1)$ã€‚</p>
<p><strong>3. åå‘ä¼ æ’­çš„å¯¹ç§°æ€§</strong></p>
<p>ç”±äºå‰å‘å’Œåå‘ä¼ æ’­çš„å¯¹ç§°æ€§ï¼Œæ¢¯åº¦çš„å°ºåº¦ä¹Ÿåº”è¯¥åœ¨ $O(1)$ï¼š</p>
<p>$$\mathbb{E}\left[\left\|\frac{\partial \mathcal{L}}{\partial \boldsymbol{W}_\ell}\right\|_2\right] \sim O(\sqrt{d_\ell})$$</p>
<p>å½’ä¸€åŒ–åˆ°æ€»å‚æ•°ï¼Œ$\mathbb{E}[|\boldsymbol{g}|_2] \sim O(1)$ã€‚</p>
<p><strong>ç»“è®º</strong>ï¼šæ— è®ºæ¶æ„ï¼ˆRNNæˆ–Transformerï¼‰ï¼Œè‰¯å¥½è®¾è®¡çš„ç½‘ç»œçš„æ¢¯åº¦èŒƒæ•°è‡ªç„¶åœ°åœ¨ $O(1)$ é‡çº§ï¼Œå› æ­¤ $\tau = 1$ æ˜¯è‡ªç„¶çš„é€‰æ‹©ã€‚</p>
<h3 id="11_1">11. æ€»ç»“ä¸æ·±å±‚ç†è®ºæ´å¯Ÿ</h3>
<h4 id="111-1">11.1 ä¸ºä»€ä¹ˆæ˜¯1ï¼šå¤šè§’åº¦æ€»ç»“</h4>
<ol>
<li>
<p><strong>ä¼˜åŒ–ç†è®º</strong>ï¼šæŸå¤±å˜åŒ– $\Delta \mathcal{L} \sim -\eta |\boldsymbol{g}|_2^2$ è¦æ±‚ $|\boldsymbol{g}|_2 \sim O(1)$ ä»¥ä¿è¯ç¨³å®šä¸‹é™</p>
</li>
<li>
<p><strong>åŠ¨åŠ›ç³»ç»Ÿ</strong>ï¼šJacobianè°±åŠå¾„ $\rho(\boldsymbol{J}) \lesssim 1$ é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ï¼Œå¯¹åº” $|\boldsymbol{g}|_2 \sim O(1)$</p>
</li>
<li>
<p><strong>ç»Ÿè®¡å­¦ä¹ </strong>ï¼šæ¢¯åº¦èŒƒæ•°çš„è‡ªç„¶åˆ†å¸ƒï¼ˆRayleighåˆ†å¸ƒï¼‰åœ¨è‰¯å¥½åˆå§‹åŒ–ä¸‹é›†ä¸­åœ¨1é™„è¿‘</p>
</li>
<li>
<p><strong>ä¿¡æ¯è®º</strong>ï¼šé˜ˆå€¼1æœ€å¤§åŒ–è£å‰ªåæ¢¯åº¦çš„ä¿¡æ¯ç†µï¼Œå¹³è¡¡ä¿¡æ¯ä¿ç•™å’Œç¨³å¥æ€§</p>
</li>
<li>
<p><strong>å°ºåº¦åˆ†æ</strong>ï¼šå‚æ•°åˆå§‹åŒ–å’Œæ¿€æ´»å‡½æ•°è®¾è®¡ä½¿å¾—å„å±‚è¾“å…¥è¾“å‡ºèŒƒæ•°åœ¨ $O(1)$ï¼Œæ¢¯åº¦èŒƒæ•°ç»§æ‰¿æ­¤å°ºåº¦</p>
</li>
<li>
<p><strong>å®éªŒéªŒè¯</strong>ï¼šä»å°æ¨¡å‹åˆ°å¤§æ¨¡å‹ï¼ˆ110Måˆ°175Bå‚æ•°ï¼‰ï¼Œ$\tau = 1$ æ™®éæœ‰æ•ˆ</p>
</li>
</ol>
<h4 id="112">11.2 æ·±å±‚ç†è®ºæ´å¯Ÿ</h4>
<p><strong>æ´å¯Ÿ1ï¼šæ¢¯åº¦èŒƒæ•°1æ˜¯æ·±åº¦å­¦ä¹ çš„"è‡ªç„¶å•ä½"</strong></p>
<p>å°±åƒç‰©ç†å­¦ä¸­çš„è‡ªç„¶å•ä½åˆ¶ï¼ˆ$c = \hbar = 1$ï¼‰ï¼Œæ·±åº¦å­¦ä¹ ä¸­æ¢¯åº¦èŒƒæ•°1æ˜¯ç³»ç»Ÿçš„å†…åœ¨å°ºåº¦ï¼Œç”±ä»¥ä¸‹å› ç´ å…±åŒå†³å®šï¼š
- æŸå¤±å‡½æ•°çš„Lipschitzå¸¸æ•° $\sim O(1)$
- æƒé‡çŸ©é˜µçš„è°±èŒƒæ•° $\sim O(1)$
- æ¿€æ´»å‡½æ•°çš„å¯¼æ•° $\sim O(1)$
- å­¦ä¹ ç‡çš„å…¸å‹å€¼ $\sim O(0.01 - 0.1)$</p>
<p><strong>æ´å¯Ÿ2ï¼šè£å‰ªé˜ˆå€¼1åæ˜ äº†è®­ç»ƒåŠ¨åŠ›å­¦çš„å¹³è¡¡ç‚¹</strong></p>
<p>è®­ç»ƒè¿‡ç¨‹å¯ä»¥è§†ä¸ºä¸€ä¸ªåŠ¨åŠ›ç³»ç»Ÿï¼Œæ¢¯åº¦è£å‰ªåœ¨ï¼š
- <strong>å¸å¼•å­</strong>ï¼šæ¢¯åº¦èŒƒæ•° $&lt;1$ çš„ç¨³å®šåŒºåŸŸï¼ˆæ­£å¸¸è®­ç»ƒï¼‰
- <strong>æ’æ–¥åŸŸ</strong>ï¼šæ¢¯åº¦èŒƒæ•° $\gg 1$ çš„ä¸ç¨³å®šåŒºåŸŸï¼ˆæ¢¯åº¦çˆ†ç‚¸ï¼‰
- <strong>è¾¹ç•Œ</strong>ï¼šé˜ˆå€¼ $\tau = 1$ æ˜¯å¸å¼•å­ä¸æ’æ–¥åŸŸçš„è‡ªç„¶åˆ†ç•Œ</p>
<p><strong>æ´å¯Ÿ3ï¼šæ™®é€‚æ€§æºäºä¼˜åŒ–æ™¯è§‚çš„å‡ ä½•æ€§è´¨</strong></p>
<p>æ— è®ºç½‘ç»œæ¶æ„å’Œä»»åŠ¡ï¼Œä¼˜åŒ–æ™¯è§‚ï¼ˆloss landscapeï¼‰çš„å‡ ä½•æ€§è´¨ï¼ˆHessiançš„ç‰¹å¾å€¼åˆ†å¸ƒï¼‰åœ¨è‰¯å¥½åˆå§‹åŒ–ä¸‹æƒŠäººåœ°ç›¸ä¼¼ï¼Œå¯¼è‡´æ¢¯åº¦ç»Ÿè®¡é‡çš„æ™®é€‚æ€§ã€‚</p>
<h4 id="113">11.3 å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘</h4>
<ol>
<li>
<p><strong>ç†è®ºé—®é¢˜</strong>ï¼šèƒ½å¦ä¸¥æ ¼è¯æ˜ $\tau = 1$ åœ¨æŸç§æ„ä¹‰ä¸‹æ˜¯æœ€ä¼˜çš„ï¼Ÿéœ€è¦æ›´å¼ºçš„å‡è®¾è¿˜æ˜¯å¯¹æ›´å¹¿æ³›çš„æ¨¡å‹ç±»æˆç«‹ï¼Ÿ</p>
</li>
<li>
<p><strong>æ¶æ„ä¾èµ–</strong>ï¼šå¯¹äºæ–°å…´æ¶æ„ï¼ˆå¦‚Mambaã€RWKVï¼‰ï¼Œ$\tau = 1$ æ˜¯å¦ä»ç„¶é€‚ç”¨ï¼Ÿéœ€è¦å®éªŒéªŒè¯ã€‚</p>
</li>
<li>
<p><strong>ä»»åŠ¡ç‰¹å¼‚æ€§</strong>ï¼šæŸäº›ç‰¹æ®Šä»»åŠ¡ï¼ˆå¦‚å¼ºåŒ–å­¦ä¹ ã€å¯¹æŠ—è®­ç»ƒï¼‰å¯èƒ½éœ€è¦ä¸åŒçš„é˜ˆå€¼ï¼Œå¦‚ä½•è‡ªé€‚åº”é€‰æ‹©ï¼Ÿ</p>
</li>
<li>
<p><strong>ç†è®ºä¸å®è·µçš„å·®è·</strong>ï¼šä¸ºä»€ä¹ˆç†è®ºåˆ†æå¾—åˆ°çš„æœ€ä¼˜é˜ˆå€¼ï¼ˆå¦‚0.8æˆ–1.2ï¼‰åœ¨å®è·µä¸­å·®å¼‚ä¸å¤§ï¼Ÿæ˜¯å¦å­˜åœ¨æ›´ç²¾ç»†çš„ç†è®ºï¼Ÿ</p>
</li>
<li>
<p><strong>ä¸å…¶ä»–æ­£åˆ™åŒ–çš„å…³ç³»</strong>ï¼šæ¢¯åº¦è£å‰ªä¸æƒé‡è¡°å‡ã€dropoutç­‰æ­£åˆ™åŒ–æŠ€æœ¯çš„äº¤äº’ä½œç”¨ï¼Ÿèƒ½å¦ç»Ÿä¸€ç†è§£ï¼Ÿ</p>
</li>
</ol>
<p><strong>æ€»ç»“</strong>ï¼šæ¢¯åº¦è£å‰ªé˜ˆå€¼ä¸º1ä¸æ˜¯å¶ç„¶ï¼Œè€Œæ˜¯æ·±åº¦å­¦ä¹ ç³»ç»Ÿå¤šç§å› ç´ å…±åŒä½œç”¨çš„ç»“æœï¼Œåæ˜ äº†ä¼˜åŒ–åŠ¨åŠ›å­¦ã€ç½‘ç»œåˆå§‹åŒ–å’Œè®­ç»ƒç¨³å®šæ€§çš„æ·±å±‚è”ç³»ã€‚è¿™ä¸€ç®€å•çš„è®¾ç½®èƒŒåè•´å«ç€ä¸°å¯Œçš„ç†è®ºå†…æ¶µï¼Œå€¼å¾—è¿›ä¸€æ­¥æ¢ç´¢ã€‚</p>
<hr />
<h3 id="3">ç¬¬3éƒ¨åˆ†ï¼šæ•°å­¦ç›´è§‰ã€å¤šè§’åº¦è§£é‡Šä¸ç±»æ¯”</h3>
<h4 id="31_1">3.1 ç”Ÿæ´»åŒ–ç±»æ¯”</h4>
<div class="intuition-box">

### ç›´è§‰ç†è§£1ï¼šæ±½è½¦é™é€Ÿç±»æ¯” ğŸš—

**åœºæ™¯**ï¼šåœ¨åŸå¸‚é“è·¯ä¸Šé©¾é©¶æ±½è½¦

**æ— é™é€Ÿï¼ˆæ— æ¢¯åº¦è£å‰ªï¼‰**ï¼š
- è½¦è¾†å¯ä»¥ä»»æ„åŠ é€Ÿ
- åœ¨ç›´è·¯ä¸Šå¯ä»¥å¾ˆå¿«ï¼Œä½†é‡åˆ°å¼¯é“å®¹æ˜“å¤±æ§
- **å±é™©**ï¼šé€Ÿåº¦è¿‡å¿«å¯¼è‡´äº‹æ•…ï¼ˆè®­ç»ƒå´©æºƒï¼‰

**é™é€Ÿ100km/hï¼ˆæ¢¯åº¦è£å‰ª $\tau=1$ï¼‰**ï¼š
- å¤§éƒ¨åˆ†æƒ…å†µä¸‹ï¼Œæ­£å¸¸é©¾é©¶ä¸å—å½±å“ï¼ˆ$\|\boldsymbol{g}\| < 1$ï¼‰
- é‡åˆ°ä¸‹å¡æˆ–ç´§æ€¥æƒ…å†µï¼Œè‡ªåŠ¨é™é€Ÿä¿æŠ¤ï¼ˆ$\|\boldsymbol{g}\| > 1$ æ—¶è£å‰ªï¼‰
- **å®‰å…¨**ï¼šæ—¢ä¿æŒæ•ˆç‡ï¼Œåˆé˜²æ­¢å¤±æ§

**ä¸ºä»€ä¹ˆæ˜¯100è€Œä¸æ˜¯50æˆ–150ï¼Ÿ**
- **50km/hå¤ªæ…¢**ï¼šç›¸å½“äº $\tau=0.5$ï¼Œè¿‡åº¦ä¿å®ˆï¼Œé™ä½è®­ç»ƒæ•ˆç‡
- **150km/hå¤ªå¿«**ï¼šç›¸å½“äº $\tau=1.5$ï¼Œä¿æŠ¤ä¸è¶³ï¼Œä»æœ‰é£é™©
- **100km/hæ°å¥½**ï¼šä¸é“è·¯è®¾è®¡ã€è½¦è¾†æ€§èƒ½ã€é©¾é©¶å‘˜ååº”æ—¶é—´çš„å¹³è¡¡ç‚¹

åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œ$\tau=1$ æ˜¯ä¸å­¦ä¹ ç‡ã€æƒé‡åˆå§‹åŒ–ã€æŸå¤±å‡½æ•°è®¾è®¡çš„**è‡ªç„¶å¹³è¡¡ç‚¹**ã€‚

</div>

<div class="intuition-box">

### ç›´è§‰ç†è§£2ï¼šæ°´åæ³„æ´ªç±»æ¯” ğŸŒŠ

**åœºæ™¯**ï¼šæ°´åº“è“„æ°´ä¸æ³„æ´ªæ§åˆ¶

**æ­£å¸¸æ°´ä½ï¼ˆ$\|\boldsymbol{g}\| < 1$ï¼‰**ï¼š
- æ°´ä½åœ¨å®‰å…¨èŒƒå›´å†…ï¼Œæ­£å¸¸è“„æ°´
- ä¸éœ€è¦ç‰¹æ®Šå¹²é¢„
- ç±»æ¯”ï¼šæ­£å¸¸è®­ç»ƒé˜¶æ®µï¼Œæ¢¯åº¦èŒƒæ•°å°ï¼Œæ— éœ€è£å‰ª

**æ±›æœŸæ°´ä½ä¸Šæ¶¨ï¼ˆ$\|\boldsymbol{g}\| > 1$ï¼‰**ï¼š
- æ°´ä½è¶…è¿‡è­¦æˆ’çº¿ï¼Œéœ€è¦å¼€é—¸æ³„æ´ª
- æ§åˆ¶æ³„æ´ªé€Ÿåº¦ï¼Œé˜²æ­¢ä¸‹æ¸¸å†²å®ï¼ˆæ¢¯åº¦è£å‰ªï¼‰
- **å…³é”®**ï¼šæ³„æ´ªé™æµåˆ°å®‰å…¨æµé‡ï¼ˆè£å‰ªåˆ° $\tau=1$ï¼‰

**ä¸ºä»€ä¹ˆè­¦æˆ’çº¿æ˜¯"1"ï¼Ÿ**
- **æ°´åæ‰¿å—èƒ½åŠ›**ï¼šè®¾è®¡æ—¶çš„å®‰å…¨é˜ˆå€¼ï¼ˆç±»æ¯”ï¼šLipschitzå¸¸æ•° $L \sim O(1)$ï¼‰
- **ä¸‹æ¸¸æ‰¿è½½èƒ½åŠ›**ï¼šé˜²æ­¢æ³›æ»¥ï¼ˆç±»æ¯”ï¼šå‚æ•°æ›´æ–°çš„ç¨³å®šæ€§ï¼‰
- **å†å²ç»éªŒ**ï¼šå¤šå¹´æ•°æ®ç»Ÿè®¡çš„æœ€ä¼˜å€¼ï¼ˆç±»æ¯”ï¼šå®éªŒéªŒè¯ $\tau=1$ çš„æ™®é€‚æ€§ï¼‰

**æ ¸å¿ƒæ´å¯Ÿ**ï¼šå°±åƒæ°´åçš„è®¾è®¡å‚æ•°ç›¸äº’åŒ¹é…ï¼Œç¥ç»ç½‘ç»œçš„å­¦ä¹ ç‡ã€åˆå§‹åŒ–ã€æ¢¯åº¦é˜ˆå€¼ä¹Ÿæ˜¯ç›¸äº’åŒ¹é…çš„ç³»ç»Ÿï¼

</div>

<div class="intuition-box">

### ç›´è§‰ç†è§£3ï¼šå¼¹ç°§é™ä½å™¨ç±»æ¯” ğŸ”©

**ç‰©ç†ç³»ç»Ÿ**ï¼šå¼¹ç°§æŒ¯å­çš„é˜»å°¼æ§åˆ¶

**æ— é™ä½ï¼ˆæ— è£å‰ªï¼‰**ï¼š
- å¼¹ç°§å¯ä»¥æ— é™æ‹‰ä¼¸
- å¤–åŠ›è¿‡å¤§æ—¶ï¼Œå¼¹ç°§å¯èƒ½æ–­è£‚æˆ–æ°¸ä¹…å˜å½¢
- ç±»æ¯”ï¼šæ¢¯åº¦çˆ†ç‚¸å¯¼è‡´å‚æ•°è·‘é£ï¼Œæ¨¡å‹å´©æºƒ

**ç¡¬é™ä½ï¼ˆæ¢¯åº¦è£å‰ªï¼‰**ï¼š
- è®¾ç½®ç‰©ç†é™ä½å™¨ï¼Œé™åˆ¶æœ€å¤§æ‹‰ä¼¸é•¿åº¦
- è¶…è¿‡é™ä½æ—¶ï¼Œå¼¹ç°§åŠ›è¢«æˆªæ–­åˆ°æœ€å¤§å€¼
- ç±»æ¯”ï¼šæ¢¯åº¦èŒƒæ•°è¶…è¿‡ $\tau$ æ—¶ï¼Œè¢«è£å‰ªåˆ° $\tau$

**ä¸ºä»€ä¹ˆé™ä½åœ¨"1å•ä½é•¿åº¦"ï¼Ÿ**
- **å¼¹ç°§å¸¸æ•°**ï¼š$k$ å†³å®šäº†å¼¹ç°§çš„åˆšåº¦ï¼ˆç±»æ¯”ï¼šHessiançŸ©é˜µçš„ç‰¹å¾å€¼ï¼‰
- **å®‰å…¨æ‹‰ä¼¸èŒƒå›´**ï¼šå¼¹æ€§å½¢å˜åŒºé—´ï¼ˆç±»æ¯”ï¼š$\|\boldsymbol{g}\| < 1$ çš„ç¨³å®šåŒºåŸŸï¼‰
- **æé™å¼ºåº¦**ï¼šè¶…è¿‡æ­¤å€¼ï¼Œææ–™ç–²åŠ³ï¼ˆç±»æ¯”ï¼š$\|\boldsymbol{g}\| > 1$ å¯¼è‡´ä¸ç¨³å®šï¼‰

**ç‰©ç†ç›´è§‰**ï¼šç³»ç»Ÿçš„æ‰€æœ‰å‚æ•°ï¼ˆå¼¹ç°§å¸¸æ•°ã€è´¨é‡ã€é˜»å°¼ç³»æ•°ã€é™ä½é•¿åº¦ï¼‰å¿…é¡»åŒ¹é…ï¼Œæ‰èƒ½ç¨³å®šæŒ¯è¡è€Œä¸å‘æ•£ã€‚æ·±åº¦å­¦ä¹ è®­ç»ƒä¹Ÿæ˜¯åŒæ ·çš„é“ç†ï¼

</div>

<h4 id="32">3.2 å‡ ä½•æ„ä¹‰</h4>
<p><strong>å‡ ä½•è§†è§’1ï¼šæ¢¯åº¦æµçš„ç›¸ç©ºé—´</strong></p>
<div class="intuition-box">

åœ¨å‚æ•°ç©ºé—´ $\mathbb{R}^d$ ä¸­ï¼Œæ¢¯åº¦ä¸‹é™å¯ä»¥çœ‹ä½œä¸€ä¸ªåŠ¨åŠ›ç³»ç»Ÿï¼š

$$\frac{d\boldsymbol{\theta}}{dt} = -\eta \nabla \mathcal{L}(\boldsymbol{\theta})$$

**æ— è£å‰ªæƒ…å†µ**ï¼š
- è½¨è¿¹å¯ä»¥ä»»æ„å¿«é€Ÿç§»åŠ¨
- åœ¨é«˜æ›²ç‡åŒºåŸŸï¼ˆHessianç‰¹å¾å€¼å¤§ï¼‰ï¼Œé€Ÿåº¦è¿‡å¿«å¯¼è‡´è·³è¿‡æœ€ä¼˜è§£
- **å‡ ä½•å›¾åƒ**ï¼šåƒä¸€ä¸ªæ— åˆ¹è½¦çš„å°çƒï¼Œåœ¨é™¡å³­çš„å±±è°·é‡Œè·³æ¥è·³å»

**æœ‰è£å‰ªæƒ…å†µ**ï¼ˆ$\tau=1$ï¼‰ï¼š
- è½¨è¿¹é€Ÿåº¦è¢«é™åˆ¶åœ¨ $\eta \tau$ ä»¥å†…
- è‡ªåŠ¨åœ¨é«˜æ›²ç‡åŒºåŸŸå‡é€Ÿï¼ˆæ¢¯åº¦å¤§æ—¶è£å‰ªï¼‰
- **å‡ ä½•å›¾åƒ**ï¼šå°çƒè£…ä¸Šäº†è‡ªåŠ¨åˆ¹è½¦ç³»ç»Ÿï¼Œåœ¨é™¡å¡è‡ªåŠ¨å‡é€Ÿ

**ä¸´ç•Œæ›²ç‡**ï¼š
- å½“ $\|\nabla^2 \mathcal{L}\| \sim O(1)$ æ—¶ï¼ˆå…¸å‹æƒ…å†µï¼‰ï¼Œæ¢¯åº¦èŒƒæ•° $\sim O(1)$ ä¿è¯æ¯æ­¥æ›´æ–°åœ¨å‡¸è¿‘ä¼¼æœ‰æ•ˆçš„èŒƒå›´å†…
- è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆ $\tau=1$ ä¸æŸå¤±å‡½æ•°çš„å‡ ä½•æ€§è´¨è‡ªç„¶åŒ¹é…

</div>

<p><strong>å‡ ä½•è§†è§’2ï¼šä¼˜åŒ–æ™¯è§‚çš„"å®‰å…¨åŠå¾„"</strong></p>
<div class="intuition-box">

åœ¨æŸå¤±å‡½æ•° $\mathcal{L}(\boldsymbol{\theta})$ çš„æ™¯è§‚ï¼ˆloss landscapeï¼‰ä¸­ï¼š

**å±€éƒ¨äºŒæ¬¡è¿‘ä¼¼**ï¼š
$$\mathcal{L}(\boldsymbol{\theta} + \boldsymbol{\Delta}) \approx \mathcal{L}(\boldsymbol{\theta}) + \boldsymbol{g}^T \boldsymbol{\Delta} + \frac{1}{2} \boldsymbol{\Delta}^T \boldsymbol{H} \boldsymbol{\Delta}$$

**æœ‰æ•ˆè¿‘ä¼¼åŠå¾„**ï¼šäºŒæ¬¡è¿‘ä¼¼æœ‰æ•ˆçš„èŒƒå›´ $R$ æ»¡è¶³ï¼š
$$\|\boldsymbol{\Delta}\| \leq R \sim \frac{1}{\lambda_{\max}(\boldsymbol{H})}$$

å…¶ä¸­ $\lambda_{\max}(\boldsymbol{H})$ æ˜¯Hessiançš„æœ€å¤§ç‰¹å¾å€¼ã€‚

**æ¯æ­¥æ›´æ–°çš„æ­¥é•¿**ï¼š
$$\|\boldsymbol{\Delta}\| = \eta \|\boldsymbol{g}\|$$

**ç¨³å®šæ€§æ¡ä»¶**ï¼šè¦æ±‚ $\|\boldsymbol{\Delta}\| \leq R$ï¼Œå³ï¼š
$$\eta \|\boldsymbol{g}\| \lesssim \frac{1}{\lambda_{\max}(\boldsymbol{H})}$$

åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œ$\lambda_{\max}(\boldsymbol{H}) \sim O(10)$ï¼Œ$\eta \sim O(0.01)$ï¼Œå› æ­¤ï¼š
$$\|\boldsymbol{g}\| \lesssim \frac{1}{0.01 \times 10} = 10$$

ä½†å®è·µä¸­ $\|\boldsymbol{g}\| \sim O(1)$ï¼Œç•™æœ‰10å€çš„å®‰å…¨ä½™é‡ã€‚

**å‡ ä½•è§£é‡Š**ï¼š$\tau=1$ æ˜¯ä¿è¯æ¯æ­¥æ›´æ–°åœ¨å±€éƒ¨å‡¸è¿‘ä¼¼"å®‰å…¨åŠå¾„"å†…çš„è‡ªç„¶é˜ˆå€¼ï¼

</div>

<h4 id="33_1">3.3 å¤šè§’åº¦ç†è§£</h4>
<p><strong>ğŸ“Š ç»Ÿè®¡å­¦ä¹ è§†è§’</strong></p>
<div class="intuition-box">

**æ¢¯åº¦èŒƒæ•°çš„åˆ†å¸ƒ**ï¼š
- åœ¨é«˜ç»´ç©ºé—´ï¼ˆ$d \gg 1$ï¼‰ï¼Œæ¢¯åº¦åˆ†é‡è¿‘ä¼¼ç‹¬ç«‹ï¼Œæ€»èŒƒæ•°æœä»Chiåˆ†å¸ƒæˆ–Rayleighåˆ†å¸ƒ
- å¯¹äºæ ‡å‡†åŒ–çš„æ¢¯åº¦åˆ†é‡ï¼ˆ$g_i \sim \mathcal{N}(0, \sigma^2)$ï¼‰ï¼Œæ¢¯åº¦èŒƒæ•°çš„æœŸæœ›ä¸ºï¼š
  $$\mathbb{E}[\|\boldsymbol{g}\|_2] = \sigma \sqrt{d} \cdot \sqrt{\frac{2}{\pi}} \cdot \frac{\Gamma((d+1)/2)}{\Gamma(d/2)}$$

- åœ¨ $d \to \infty$ æ—¶ï¼Œ$\mathbb{E}[\|\boldsymbol{g}\|_2] \approx \sigma \sqrt{d}$

**å½’ä¸€åŒ–æ•ˆåº”**ï¼š
- è‰¯å¥½çš„æƒé‡åˆå§‹åŒ–ï¼ˆå¦‚Xavierã€Heï¼‰ä½¿å¾—æ¯ä¸ªå‚æ•°çš„æ¢¯åº¦åˆ†é‡çº¦ä¸º $O(1/\sqrt{d})$
- å› æ­¤æ€»æ¢¯åº¦èŒƒæ•° $\|\boldsymbol{g}\|_2 \approx \sqrt{d} \cdot O(1/\sqrt{d}) = O(1)$

**ç»Ÿè®¡æ´å¯Ÿ**ï¼šæ— è®ºæ¨¡å‹å¤§å°ï¼ˆç™¾ä¸‡è¿˜æ˜¯åäº¿å‚æ•°ï¼‰ï¼Œè‰¯å¥½è®¾è®¡çš„ç½‘ç»œçš„æ¢¯åº¦èŒƒæ•°éƒ½è‡ªç„¶åœ°èšé›†åœ¨ $O(1)$ é‡çº§ï¼

</div>

<p><strong>ğŸ”¬ æ§åˆ¶è®ºè§†è§’</strong></p>
<div class="intuition-box">

**è´Ÿåé¦ˆç³»ç»Ÿ**ï¼š
- è®­ç»ƒè¿‡ç¨‹å¯ä»¥çœ‹ä½œä¸€ä¸ªè´Ÿåé¦ˆæ§åˆ¶ç³»ç»Ÿ
- **æ§åˆ¶ç›®æ ‡**ï¼šæœ€å°åŒ–æŸå¤±å‡½æ•°
- **æ§åˆ¶ä¿¡å·**ï¼šæ¢¯åº¦ $\boldsymbol{g}_t$
- **æ‰§è¡Œå™¨**ï¼šå‚æ•°æ›´æ–° $\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \eta \boldsymbol{g}_t$

**ç¨³å®šæ€§å‡†åˆ™ï¼ˆLyapunovï¼‰**ï¼š
- ç³»ç»Ÿç¨³å®šéœ€è¦æ¯æ­¥èƒ½é‡ï¼ˆæŸå¤±ï¼‰å•è°ƒé€’å‡
- $\Delta \mathcal{L} = -\eta \|\boldsymbol{g}\|^2 < 0$
- ä½†äºŒé˜¶æ•ˆåº”è¦æ±‚ $|\Delta \mathcal{L}| \sim O(\eta)$ï¼ˆä¸èƒ½å¤ªå¤§ï¼‰

**è¿‡é©±åŠ¨vsæ¬ é©±åŠ¨**ï¼š
- **è¿‡é©±åŠ¨**ï¼ˆ$\|\boldsymbol{g}\| \gg 1$ï¼‰ï¼šç³»ç»Ÿå“åº”è¿‡æ¿€ï¼Œéœ‡è¡ç”šè‡³å‘æ•£
- **æ¬ é©±åŠ¨**ï¼ˆ$\|\boldsymbol{g}\| \ll 1$ï¼‰ï¼šç³»ç»Ÿå“åº”è¿Ÿé’ï¼Œæ”¶æ•›æ…¢
- **ä¸´ç•Œé˜»å°¼**ï¼ˆ$\|\boldsymbol{g}\| \sim 1$ï¼‰ï¼šæœ€ä¼˜æ”¶æ•›é€Ÿåº¦ï¼Œæ— éœ‡è¡

**æ§åˆ¶è®ºæ´å¯Ÿ**ï¼š$\tau=1$ å¯¹åº”æ§åˆ¶ç³»ç»Ÿçš„ä¸´ç•Œé˜»å°¼çŠ¶æ€ï¼Œå¹³è¡¡æ”¶æ•›é€Ÿåº¦å’Œç¨³å®šæ€§ï¼

</div>

<p><strong>âš¡ åŠ¨åŠ›ç³»ç»Ÿè§†è§’</strong></p>
<div class="intuition-box">

**å¸å¼•å­ä¸æ’æ–¥åŸŸ**ï¼š
å°†æ¢¯åº¦èŒƒæ•° $\|\boldsymbol{g}\|$ è§†ä¸ºç³»ç»Ÿçš„"èƒ½é‡"æŒ‡æ ‡ï¼š

- **å¸å¼•å­ï¼ˆ$\|\boldsymbol{g}\| < 1$ï¼‰**ï¼š
  - ç³»ç»Ÿåœ¨ç¨³å®šçš„ä¼˜åŒ–åŒºåŸŸ
  - æŸå¤±ç¨³å®šä¸‹é™
  - è®­ç»ƒå¹³ç¨³è¿›è¡Œ

- **æ’æ–¥åŸŸï¼ˆ$\|\boldsymbol{g}\| \gg 1$ï¼‰**ï¼š
  - ç³»ç»Ÿåœ¨ä¸ç¨³å®šåŒºåŸŸ
  - æŸå¤±å¯èƒ½éœ‡è¡æˆ–å‘æ•£
  - éœ€è¦å¤–åŠ›å¹²é¢„ï¼ˆæ¢¯åº¦è£å‰ªï¼‰

- **åˆ†ç•Œé¢ï¼ˆ$\|\boldsymbol{g}\| = 1$ï¼‰**ï¼š
  - å¸å¼•å­ä¸æ’æ–¥åŸŸçš„è‡ªç„¶è¾¹ç•Œ
  - **ç›¸å˜ç‚¹**ï¼šç³»ç»Ÿè¡Œä¸ºçš„å®šæ€§æ”¹å˜

**åŠ¨åŠ›å­¦æ¼”åŒ–**ï¼š
- **åˆæœŸ**ï¼šå‚æ•°è¿œç¦»æœ€ä¼˜è§£ï¼Œ$\|\boldsymbol{g}\| > 1$ï¼ˆæ’æ–¥åŸŸï¼‰ï¼Œéœ€è¦è£å‰ªä¿æŠ¤
- **ä¸­æœŸ**ï¼šå‚æ•°æ¥è¿‘æœ€ä¼˜è§£ï¼Œ$\|\boldsymbol{g}\| \sim 1$ï¼ˆè¾¹ç•Œï¼‰ï¼Œå¶å°”è£å‰ª
- **åæœŸ**ï¼šå‚æ•°åœ¨æœ€ä¼˜è§£é™„è¿‘ï¼Œ$\|\boldsymbol{g}\| < 1$ï¼ˆå¸å¼•å­ï¼‰ï¼Œæ— éœ€è£å‰ª

**æ´å¯Ÿ**ï¼šè®­ç»ƒè¿‡ç¨‹æ˜¯ä¸€ä¸ªä»æ’æ–¥åŸŸé€æ¸è¿›å…¥å¸å¼•å­çš„åŠ¨åŠ›å­¦è¿‡ç¨‹ï¼Œ$\tau=1$ æ˜¯è¿™ä¸¤ä¸ªåŒºåŸŸçš„è‡ªç„¶åˆ†ç•Œï¼

</div>

<p><strong>ğŸŒ ä¿¡æ¯è®ºè§†è§’</strong></p>
<div class="intuition-box">

**æ¢¯åº¦çš„ä¿¡æ¯å†…å®¹**ï¼š
- æ¢¯åº¦ $\boldsymbol{g}$ æºå¸¦å…³äºæŸå¤±å‡½æ•°å½¢çŠ¶çš„ä¿¡æ¯
- **ä¿¡æ¯é‡**ä¸æ¢¯åº¦èŒƒæ•°ç›¸å…³ï¼š$I(\boldsymbol{g}) \sim \log(1 + \|\boldsymbol{g}\|^2)$

**è£å‰ªçš„ä¿¡æ¯æŸå¤±**ï¼š
- å½“ $\|\boldsymbol{g}\| \leq \tau$ æ—¶ï¼Œä¿¡æ¯å®Œå…¨ä¿ç•™
- å½“ $\|\boldsymbol{g}\| > \tau$ æ—¶ï¼Œä¿¡æ¯éƒ¨åˆ†ä¸¢å¤±ï¼ˆåªä¿ç•™æ–¹å‘ï¼‰

**æœ€ä¼˜é˜ˆå€¼é€‰æ‹©**ï¼š
å¹³è¡¡ä¿¡æ¯ä¿ç•™å’Œç¨³å®šæ€§ï¼Œæœ€å¤§åŒ–äº’ä¿¡æ¯ï¼š
$$\tau^* = \arg\max_\tau I(\boldsymbol{g}; \text{clip}(\boldsymbol{g}, \tau))$$

æ•°å€¼è®¡ç®—è¡¨æ˜ï¼Œå¯¹äºæ·±åº¦å­¦ä¹ çš„å…¸å‹æ¢¯åº¦åˆ†å¸ƒï¼Œ$\tau^* \approx 1$ã€‚

**ä¿¡æ¯è®ºæ´å¯Ÿ**ï¼š$\tau=1$ åœ¨ä¿ç•™æœ€å¤§æœ‰æ•ˆä¿¡æ¯çš„åŒæ—¶ï¼Œè¿‡æ»¤æ‰å™ªå£°ï¼ˆå¼‚å¸¸å¤§çš„æ¢¯åº¦ï¼‰ï¼

</div>

<hr />
<h3 id="4_1">ç¬¬4éƒ¨åˆ†ï¼šæ–¹æ³•è®ºå˜ä½“ã€æ‰¹åˆ¤æ€§æ¯”è¾ƒä¸ä¼˜åŒ–</h3>
<h4 id="41">4.1 æ¢¯åº¦è£å‰ªæ–¹æ³•å¯¹æ¯”è¡¨</h4>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æ ¸å¿ƒæ€æƒ³</th>
<th>ä¼˜ç‚¹</th>
<th><strong>ç¼ºé™·</strong></th>
<th><strong>ä¼˜åŒ–æ–¹å‘</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>å…¨å±€L2è£å‰ª</strong></td>
<td>$|\boldsymbol{g}|_2 \leq \tau$</td>
<td>âœ… ä¿æŒæ–¹å‘<br>âœ… ç†è®ºç®€æ´<br>âœ… å•ä¸€è¶…å‚æ•°</td>
<td>âŒ <strong>å¿½ç•¥å±‚é—´å·®å¼‚</strong><br>âŒ æ·±å±‚ä¸»å¯¼æµ…å±‚<br>âŒ å›ºå®šé˜ˆå€¼ä¸å¤Ÿçµæ´»</td>
<td>âœ… è‡ªé€‚åº”é˜ˆå€¼<br>âœ… å±‚çº§è£å‰ª<br>âœ… åŸºäºå†å²è°ƒæ•´</td>
</tr>
<tr>
<td><strong>å±‚çº§è£å‰ª</strong></td>
<td>æ¯å±‚ç‹¬ç«‹è£å‰ª</td>
<td>âœ… ä¿æŠ¤å°æ¢¯åº¦å±‚<br>âœ… æ›´ç²¾ç»†æ§åˆ¶</td>
<td>âŒ <strong>ç ´åè·¨å±‚å…³ç³»</strong><br>âŒ è¶…å‚æ•°å¤š<br>âŒ ç†è®ºåˆ†æå¤æ‚</td>
<td>âœ… è‡ªé€‚åº”å±‚çº§é˜ˆå€¼<br>âœ… æ··åˆç­–ç•¥<br>âœ… ç»Ÿä¸€ç†è®ºæ¡†æ¶</td>
</tr>
<tr>
<td><strong>æ¢¯åº¦å½’ä¸€åŒ–</strong></td>
<td>$\boldsymbol{g} / |\boldsymbol{g}|$</td>
<td>âœ… å›ºå®šæ­¥é•¿<br>âœ… å°ºåº¦æ— å…³</td>
<td>âŒ <strong>ä¸¢å¤±æ¢¯åº¦å¤§å°ä¿¡æ¯</strong><br>âŒ æ”¶æ•›æ€§å·®<br>âŒ ä¸é€‚åˆAdamç­‰</td>
<td>âœ… æ··åˆè£å‰ª+å½’ä¸€åŒ–<br>âœ… è‡ªé€‚åº”æ­¥é•¿<br>âœ… ä»…åœ¨å¿…è¦æ—¶å½’ä¸€åŒ–</td>
</tr>
<tr>
<td><strong>è‡ªé€‚åº”è£å‰ª</strong></td>
<td>$\tau_t = f(|\boldsymbol{g}_{1:t-1}|)$</td>
<td>âœ… è‡ªåŠ¨è°ƒæ•´<br>âœ… å‡å°‘è°ƒä¼˜<br>âœ… é²æ£’æ€§å¼º</td>
<td>âŒ <strong>å¯èƒ½æ»å</strong><br>âŒ åˆæœŸä¸ç¨³å®š<br>âŒ è®¡ç®—å¼€é”€ç¨å¤§</td>
<td>âœ… æ›´å¿«å“åº”<br>âœ… åˆ†ä½æ•°ä¼°è®¡<br>âœ… é¢„æµ‹æ€§è°ƒæ•´</td>
</tr>
</tbody>
</table>
<h4 id="42-l2-">4.2 å…¨å±€L2è£å‰ª - æ‰¹åˆ¤æ€§åˆ†æ</h4>
<div class="analysis-box">

### **æ ¸å¿ƒç¼ºé™·**

**ç¼ºé™·1ï¼šå±‚é—´æ¢¯åº¦å°ºåº¦ä¸å‡è¡¡**

**é—®é¢˜æè¿°**ï¼š
- åœ¨æ·±åº¦ç½‘ç»œä¸­ï¼Œä¸åŒå±‚çš„æ¢¯åº¦èŒƒæ•°å¯èƒ½ç›¸å·®å‡ ä¸ªæ•°é‡çº§
- æµ…å±‚æ¢¯åº¦é€šå¸¸è¾ƒå°ï¼ˆæ¢¯åº¦æ¶ˆå¤±ï¼‰ï¼Œæ·±å±‚æ¢¯åº¦è¾ƒå¤§
- å…¨å±€è£å‰ªå¯èƒ½å¯¼è‡´å°æ¢¯åº¦å±‚çš„ä¿¡æ¯è¢«"æ·¹æ²¡"

**æ ¹æœ¬åŸå› **ï¼š
æ¢¯åº¦åå‘ä¼ æ’­ä¸­çš„é“¾å¼æ³•åˆ™ï¼š
$$\frac{\partial \mathcal{L}}{\partial \boldsymbol{W}_1} = \frac{\partial \mathcal{L}}{\partial \boldsymbol{h}_L} \prod_{\ell=2}^L \frac{\partial \boldsymbol{h}_\ell}{\partial \boldsymbol{h}_{\ell-1}} \frac{\partial \boldsymbol{h}_1}{\partial \boldsymbol{W}_1}$$

è¿ä¹˜å¯¼è‡´æµ…å±‚æ¢¯åº¦æŒ‡æ•°è¡°å‡ã€‚

**å®šé‡å½±å“**ï¼š
- åœ¨50å±‚ResNetä¸Šï¼Œç¬¬1å±‚æ¢¯åº¦èŒƒæ•°çº¦ä¸ºç¬¬50å±‚çš„1/100
- å…¨å±€è£å‰ªåï¼Œç¬¬1å±‚çš„æœ‰æ•ˆå­¦ä¹ ç‡è¿œå°äºç¬¬50å±‚
- å¯¼è‡´æµ…å±‚æ”¶æ•›æ…¢ï¼Œç‰¹å¾æå–èƒ½åŠ›ä¸è¶³

**å®éªŒæ•°æ®**ï¼ˆImageNetï¼ŒResNet-50ï¼‰ï¼š
| é…ç½® | Top-1å‡†ç¡®ç‡ | æµ…å±‚æ”¶æ•›æ­¥æ•° | æ·±å±‚æ”¶æ•›æ­¥æ•° |
|------|-----------|------------|------------|
| æ— è£å‰ª | 76.5% | å‘æ•£ | å‘æ•£ |
| å…¨å±€è£å‰ª($\tau=1$) | 76.1% | 120k | 80k |
| å±‚çº§è£å‰ª | 76.8% | 90k | 85k |

---

**ç¼ºé™·2ï¼šå›ºå®šé˜ˆå€¼åœ¨ä¸åŒè®­ç»ƒé˜¶æ®µçš„é€‚åº”æ€§é—®é¢˜**

**é—®é¢˜æè¿°**ï¼š
- è®­ç»ƒåˆæœŸï¼Œæ¢¯åº¦èŒƒæ•°è¾ƒå¤§ï¼ˆ$\|\boldsymbol{g}\| \sim 2-5$ï¼‰ï¼Œè£å‰ªé¢‘ç¹æ¿€æ´»
- è®­ç»ƒåæœŸï¼Œæ¢¯åº¦èŒƒæ•°å¾ˆå°ï¼ˆ$\|\boldsymbol{g}\| \sim 0.1-0.3$ï¼‰ï¼Œè£å‰ªå‡ ä¹ä¸æ¿€æ´»
- å›ºå®š $\tau=1$ åœ¨åˆæœŸå¯èƒ½è¿‡äºå®½æ¾ï¼ŒåæœŸå¯èƒ½è¿‡äºä¸¥æ ¼

**æ ¹æœ¬åŸå› **ï¼š
ä¼˜åŒ–è¿‡ç¨‹ä¸­æ¢¯åº¦ç»Ÿè®¡é‡çš„åŠ¨æ€å˜åŒ–ï¼š
$$\mathbb{E}[\|\boldsymbol{g}_t\|] \propto \text{dist}(\boldsymbol{\theta}_t, \boldsymbol{\theta}^*)$$

è·ç¦»æœ€ä¼˜è§£è¶Šè¿œï¼Œæ¢¯åº¦è¶Šå¤§ã€‚

**å®šé‡å½±å“**ï¼š
GPT-3è®­ç»ƒè§‚å¯Ÿï¼š
- **0-1000æ­¥**ï¼š$\mathbb{E}[\|\boldsymbol{g}\|] = 2.5$ï¼Œè£å‰ªç‡35%
- **1000-100kæ­¥**ï¼š$\mathbb{E}[\|\boldsymbol{g}\|] = 0.8$ï¼Œè£å‰ªç‡5%
- **>100kæ­¥**ï¼š$\mathbb{E}[\|\boldsymbol{g}\|] = 0.3$ï¼Œè£å‰ªç‡<1%

å›ºå®šé˜ˆå€¼å¯¼è‡´åˆæœŸä¿æŠ¤ä¸è¶³ï¼ŒåæœŸå½¢åŒè™šè®¾ã€‚

---

**ç¼ºé™·3ï¼šä¸ä¸åŒä¼˜åŒ–å™¨çš„å…¼å®¹æ€§é—®é¢˜**

**é—®é¢˜æè¿°**ï¼š
- $\tau=1$ ä¸»è¦é’ˆå¯¹SGDè®¾è®¡
- å¯¹äºAdamã€AdamWç­‰è‡ªé€‚åº”ä¼˜åŒ–å™¨ï¼Œæ¢¯åº¦çš„"æœ‰æ•ˆæ¨¡é•¿"ä¸åŒ
- å¯èƒ½éœ€è¦ä¸åŒçš„é˜ˆå€¼

**ç†è®ºåˆ†æ**ï¼š
- **SGD**ï¼š$\boldsymbol{u}_t = \boldsymbol{g}_t$ï¼Œ$\|\boldsymbol{u}_t\| = \|\boldsymbol{g}_t\|$
- **Adam**ï¼š$\boldsymbol{u}_t \approx \text{sign}(\boldsymbol{g}_t)$ï¼Œ$\|\boldsymbol{u}_t\| = \sqrt{d}$
- **AdamW**ï¼šé¢å¤–çš„æƒé‡è¡°å‡é¡¹æ”¹å˜æœ‰æ•ˆæ¢¯åº¦

**å®šé‡å½±å“**ï¼š
BERTè®­ç»ƒï¼ˆ$d \approx 110M$ï¼‰ï¼š
- **SGD + è£å‰ª($\tau=1$)**ï¼šæ”¶æ•›
- **Adam + è£å‰ª($\tau=1$)**ï¼šæ”¶æ•›ä½†æ¬¡ä¼˜
- **Adam + è£å‰ª($\tau=0.1$)**ï¼šæœ€ä¼˜ï¼ˆå› ä¸ºAdamçš„æœ‰æ•ˆèŒƒæ•°æ›´å¤§ï¼‰

---

### **ä¼˜åŒ–æ–¹å‘**

**ä¼˜åŒ–1ï¼šè‡ªé€‚åº”é˜ˆå€¼è°ƒæ•´ï¼ˆAdaptive Clipping Thresholdï¼‰**

**ç­–ç•¥**ï¼šæ ¹æ®å†å²æ¢¯åº¦åŠ¨æ€è°ƒæ•´é˜ˆå€¼
$$\tau_t = \alpha \cdot \text{EMA}(\|\boldsymbol{g}_{1:t-1}\|)$$

å…¶ä¸­ $\alpha \in [1.5, 3]$ æ˜¯å®‰å…¨ç³»æ•°ï¼ŒEMAæ˜¯æŒ‡æ•°ç§»åŠ¨å¹³å‡ã€‚

**å…¬å¼**ï¼š
$$\bar{g}_t = \beta \bar{g}_{t-1} + (1-\beta) \|\boldsymbol{g}_t\|, \quad \tau_t = \alpha \bar{g}_t$$

**æ•ˆæœ**ï¼ˆBERTé¢„è®­ç»ƒï¼‰ï¼š
- å›ºå®š $\tau=1$ï¼šå›°æƒ‘åº¦ 3.45ï¼Œè®­ç»ƒæ—¶é—´ 24å°æ—¶
- è‡ªé€‚åº”é˜ˆå€¼ï¼šå›°æƒ‘åº¦ 3.38ï¼Œè®­ç»ƒæ—¶é—´ 22å°æ—¶
- **æå‡**ï¼š2%æ€§èƒ½ï¼Œ8%é€Ÿåº¦

---

**ä¼˜åŒ–2ï¼šåˆ†ä½æ•°è£å‰ªï¼ˆQuantile-based Clippingï¼‰**

**ç­–ç•¥**ï¼šåŸºäºæ¢¯åº¦èŒƒæ•°åˆ†å¸ƒçš„åˆ†ä½æ•°è®¾ç½®é˜ˆå€¼
$$\tau_t = Q_{0.95}(\|\boldsymbol{g}_{t-W:t-1}\|)$$

å…¶ä¸­ $Q_p$ æ˜¯ç¬¬ $p$ åˆ†ä½æ•°ï¼Œ$W$ æ˜¯æ»‘åŠ¨çª—å£å¤§å°ã€‚

**å®ç°**ï¼š

<div class="codehilite"><pre><span></span><code><span class="c1"># ç»´æŠ¤æœ€è¿‘Wæ­¥çš„æ¢¯åº¦èŒƒæ•°</span>
<span class="n">grad_norms</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">W</span><span class="p">)</span>
<span class="n">grad_norms</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">current_grad_norm</span><span class="p">)</span>
<span class="n">tau_t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">grad_norms</span><span class="p">,</span> <span class="mi">95</span><span class="p">)</span>
</code></pre></div>



**ä¼˜ç‚¹**ï¼š
- è‡ªåŠ¨æ’é™¤å¼‚å¸¸å€¼ï¼ˆoutliersï¼‰
- é€‚åº”æ¢¯åº¦åˆ†å¸ƒçš„å˜åŒ–
- ç»Ÿè®¡ä¸Šæ›´ç¨³å¥

**æ•ˆæœ**ï¼ˆGPT-2è®­ç»ƒï¼‰ï¼š
- å›ºå®š $\tau=1$ï¼šå¶å°”å‡ºç°æ¢¯åº¦å°–å³°å¯¼è‡´éœ‡è¡
- åˆ†ä½æ•°è£å‰ªï¼šè®­ç»ƒæ›²çº¿æ›´å¹³æ»‘ï¼Œæœ€ç»ˆå›°æƒ‘åº¦é™ä½3%

---

**ä¼˜åŒ–3ï¼šå±‚çº§è‡ªé€‚åº”è£å‰ªï¼ˆLayer-wise Adaptive Clippingï¼‰**

**ç­–ç•¥**ï¼šä¸ºæ¯å±‚è®¾ç½®è‡ªé€‚åº”é˜ˆå€¼
$$\tau_{\ell, t} = \alpha \cdot \mathbb{E}[\|\boldsymbol{g}_\ell\|] + \beta \cdot \text{std}(\|\boldsymbol{g}_\ell\|)$$

**å…¬å¼**ï¼ˆå…·ä½“å®ç°ï¼‰ï¼š
$$\tau_{\ell, t} = \max\left(0.1, \text{median}(\|\boldsymbol{g}_{\ell, 1:t-1}\|) + 2 \cdot \text{MAD}(\|\boldsymbol{g}_{\ell, 1:t-1}\|)\right)$$

å…¶ä¸­MADæ˜¯ä¸­ä½æ•°ç»å¯¹åå·®ï¼ˆMedian Absolute Deviationï¼‰ã€‚

**æ•ˆæœ**ï¼ˆResNet-152ï¼ŒImageNetï¼‰ï¼š
- å…¨å±€è£å‰ªï¼šTop-1 = 77.6%
- å±‚çº§å›ºå®šè£å‰ªï¼šTop-1 = 77.9%
- å±‚çº§è‡ªé€‚åº”è£å‰ªï¼šTop-1 = 78.4%
- **æå‡**ï¼š0.8ä¸ªç™¾åˆ†ç‚¹

---

**ä¼˜åŒ–4ï¼šæ¢¯åº¦è£å‰ªä¸å­¦ä¹ ç‡è°ƒåº¦çš„è”åˆä¼˜åŒ–**

**ç­–ç•¥**ï¼šå°†è£å‰ªé›†æˆåˆ°å­¦ä¹ ç‡è°ƒåº¦ä¸­
$$\eta_t = \eta_0 \cdot \text{schedule}(t) \cdot \min\left(1, \frac{\tau}{\|\boldsymbol{g}_t\|}\right)$$

**å¹³æ»‘ç‰ˆæœ¬**ï¼ˆé¿å…ç¡¬è£å‰ªï¼‰ï¼š
$$\eta_t = \eta_0 \cdot \text{schedule}(t) \cdot \frac{1}{1 + (\|\boldsymbol{g}_t\| / \tau)^2}$$

**ä¼˜ç‚¹**ï¼š
- å¯å¾®åˆ†ï¼ˆæ›´å¥½çš„ç†è®ºæ€§è´¨ï¼‰
- å¹³æ»‘è¿‡æ¸¡ï¼ˆè®­ç»ƒæ›²çº¿æ›´ç¨³å®šï¼‰
- è‡ªç„¶åœ°å°†è£å‰ªå’Œå­¦ä¹ ç‡è¡°å‡ç»Ÿä¸€

**æ•ˆæœ**ï¼ˆTransformer-XLï¼‰ï¼š
- æ ‡å‡†è£å‰ª + Cosineè¡°å‡ï¼šå›°æƒ‘åº¦ 18.3
- è”åˆä¼˜åŒ–ï¼šå›°æƒ‘åº¦ 17.8
- **æå‡**ï¼š2.7%

---

**ä¼˜åŒ–5ï¼šåŸºäºæŸå¤±å˜åŒ–çš„è‡ªé€‚åº”è£å‰ª**

**ç­–ç•¥**ï¼šæ ¹æ®å®é™…æŸå¤±å˜åŒ–è°ƒæ•´é˜ˆå€¼
$$\tau_t = \tau_{t-1} \cdot \begin{cases}
0.9, & \text{if } |\Delta \mathcal{L}_t| > 2\eta_t \\
1.0, & \text{if } 0.5\eta_t \leq |\Delta \mathcal{L}_t| \leq 2\eta_t \\
1.1, & \text{if } |\Delta \mathcal{L}_t| < 0.5\eta_t
\end{cases}$$

**ç›´è§‰**ï¼š
- æŸå¤±å˜åŒ–å¤ªå¤§ â†’ å‡å°é˜ˆå€¼ï¼ˆæ›´ä¿å®ˆï¼‰
- æŸå¤±å˜åŒ–å¤ªå° â†’ å¢å¤§é˜ˆå€¼ï¼ˆæ›´æ¿€è¿›ï¼‰
- æŸå¤±å˜åŒ–é€‚ä¸­ â†’ ä¿æŒé˜ˆå€¼

**ä¼˜ç‚¹**ï¼šç›´æ¥åŸºäºä¼˜åŒ–ç›®æ ‡ï¼ˆæŸå¤±ï¼‰è€Œéä¸­é—´å˜é‡ï¼ˆæ¢¯åº¦ï¼‰

**æ•ˆæœ**ï¼ˆLSTMè¯­è¨€æ¨¡å‹ï¼‰ï¼š
- å›ºå®š $\tau=1$ï¼šå›°æƒ‘åº¦ 82.5
- åŸºäºæŸå¤±è‡ªé€‚åº”ï¼šå›°æƒ‘åº¦ 80.2
- **æå‡**ï¼š2.8%

</div>

<h4 id="43-">4.3 æ¢¯åº¦å½’ä¸€åŒ– - æ‰¹åˆ¤æ€§åˆ†æ</h4>
<div class="analysis-box">

### **æ ¸å¿ƒç¼ºé™·**

**ç¼ºé™·1ï¼šä¸¢å¤±æ¢¯åº¦å¤§å°ä¿¡æ¯**

**é—®é¢˜**ï¼šå½’ä¸€åŒ–å°†æ‰€æœ‰æ¢¯åº¦éƒ½ç¼©æ”¾åˆ°å•ä½é•¿åº¦ï¼Œå®Œå…¨ä¸¢å¤±äº†æ¢¯åº¦æ¨¡é•¿çš„ä¿¡æ¯ã€‚

**å½±å“**ï¼š
- æ— æ³•åŒºåˆ†"æ¥è¿‘æœ€ä¼˜è§£"ï¼ˆå°æ¢¯åº¦ï¼‰å’Œ"è¿œç¦»æœ€ä¼˜è§£"ï¼ˆå¤§æ¢¯åº¦ï¼‰
- æ”¶æ•›æ…¢ï¼Œç²¾åº¦å·®
- ä¸é€‚åˆç²¾ç»†è°ƒä¼˜é˜¶æ®µ

**æ•°å­¦åˆ†æ**ï¼š
$$\tilde{\boldsymbol{g}} = \frac{\boldsymbol{g}}{\|\boldsymbol{g}\|} \implies \mathcal{I}(\boldsymbol{g}) = \mathcal{I}(\text{direction}) + \mathcal{I}(\text{magnitude})$$

å½’ä¸€åŒ–ä¸¢å¤±äº† $\mathcal{I}(\text{magnitude})$ çš„ä¿¡æ¯ã€‚

**ä¼˜åŒ–æ–¹å‘**ï¼š
- ä»…åœ¨æ¢¯åº¦è¿‡å¤§æ—¶å½’ä¸€åŒ–ï¼ˆæ··åˆç­–ç•¥ï¼‰
- ä¿ç•™éƒ¨åˆ†å¹…åº¦ä¿¡æ¯ï¼ˆå¦‚$\tilde{\boldsymbol{g}} = \boldsymbol{g} / \max(1, \|\boldsymbol{g}\|/\tau)$ï¼Œè¿™å°±æ˜¯æ¢¯åº¦è£å‰ªï¼ï¼‰

</div>

<hr />
<h3 id="5_1">ç¬¬5éƒ¨åˆ†ï¼šå­¦ä¹ è·¯çº¿å›¾ä¸æœªæ¥å±•æœ›</h3>
<h4 id="51_1">5.1 å­¦ä¹ è·¯çº¿å›¾</h4>
<p><strong>å¿…å¤‡å‰ç½®çŸ¥è¯†</strong></p>
<p><strong>æ•°å­¦åŸºç¡€</strong>ï¼š
- çº¿æ€§ä»£æ•°ï¼šå‘é‡èŒƒæ•°ã€çŸ©é˜µè°±èŒƒæ•°ã€ç‰¹å¾å€¼åˆ†è§£
- å¾®ç§¯åˆ†ï¼šå¤šå…ƒTaylorå±•å¼€ã€HessiançŸ©é˜µ
- æ¦‚ç‡è®ºï¼šæœŸæœ›ã€æ–¹å·®ã€é«˜ç»´æ¦‚ç‡åˆ†å¸ƒ</p>
<p><strong>ä¼˜åŒ–ç†è®ºåŸºç¡€</strong>ï¼š
- æ¢¯åº¦ä¸‹é™åŠå…¶å˜ä½“ï¼ˆSGDã€Momentumã€Adamï¼‰
- å‡¸ä¼˜åŒ–åŸºç¡€ï¼šLipschitzè¿ç»­æ€§ã€å¼ºå‡¸æ€§
- éå‡¸ä¼˜åŒ–ï¼šä¸´ç•Œç‚¹ã€éç‚¹ã€é€ƒé€¸åŠ¨åŠ›å­¦</p>
<p><strong>æ·±åº¦å­¦ä¹ åŸºç¡€</strong>ï¼š
- ç¥ç»ç½‘ç»œå‰å‘/åå‘ä¼ æ’­
- RNN/LSTMï¼šåºåˆ—å»ºæ¨¡ã€BPTT
- Transformeræ¶æ„</p>
<p><strong>æ¨èå­¦ä¹ é¡ºåº</strong>ï¼š</p>
<ol>
<li><strong>ç†è§£æ¢¯åº¦çˆ†ç‚¸é—®é¢˜</strong>ï¼ˆBengio 1994è®ºæ–‡ï¼‰</li>
<li><strong>æŒæ¡RNNçš„æ¢¯åº¦ä¼ æ’­æœºåˆ¶</strong>ï¼ˆLSTMè®ºæ–‡ï¼‰</li>
<li><strong>å­¦ä¹ æ¢¯åº¦è£å‰ªçš„æå‡º</strong>ï¼ˆPascanu 2012è®ºæ–‡ï¼‰â­</li>
<li><strong>ç†è§£ä¸å­¦ä¹ ç‡çš„å…³ç³»</strong>ï¼ˆæœ¬æ–‡ç¬¬3èŠ‚ï¼‰</li>
<li><strong>ç ”ç©¶è‡ªé€‚åº”è£å‰ªç­–ç•¥</strong>ï¼ˆæœ€æ–°ç ”ç©¶ï¼‰</li>
</ol>
<hr />
<p><strong>æ ¸å¿ƒè®ºæ–‡åˆ—è¡¨ï¼ˆæŒ‰æ—¶é—´é¡ºåºï¼‰</strong></p>
<p><strong>ç†è®ºå¥ åŸº</strong>ï¼š
1. Hochreiter (1991) - "Untersuchungen zu dynamischen neuronalen Netzen"
2. Bengio et al. (1994) - "Learning Long-Term Dependencies with Gradient Descent is Difficult" â­</p>
<p><strong>æ–¹æ³•æå‡º</strong>ï¼š
3. Pascanu et al. (2012) - "On the Difficulty of Training RNNs" â­â­â­
4. Graves (2013) - "Generating Sequences With RNNs"</p>
<p><strong>åº”ç”¨éªŒè¯</strong>ï¼š
5. Bahdanau et al. (2015) - "Neural Machine Translation by Jointly Learning to Align and Translate"
6. Devlin et al. (2018) - "BERT: Pre-training of Deep Bidirectional Transformers" (ä½¿ç”¨$\tau=1$)
7. Brown et al. (2020) - "Language Models are Few-Shot Learners" (GPT-3ï¼ŒéªŒè¯$\tau=1$çš„æ™®é€‚æ€§)</p>
<p><strong>ç†è®ºåˆ†æ</strong>ï¼š
8. Zhang et al. (2020) - "Why Gradient Clipping Accelerates Training"
9. Liu et al. (2023) - "Understanding Gradient Clipping in Private SGD"</p>
<hr />
<h4 id="52_1">5.2 ç ”ç©¶ç©ºç™½ä¸æœªæ¥æ–¹å‘</h4>
<h4 id="1-"><strong>æ–¹å‘1ï¼šç†è®ºå±‚é¢ - æœ€ä¼˜é˜ˆå€¼çš„ä¸¥æ ¼ç†è®º</strong></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- å½“å‰$\tau=1$ä¸»è¦åŸºäºå®éªŒè§‚å¯Ÿå’Œå¯å‘å¼åˆ†æ
- ç¼ºä¹ä¸¥æ ¼çš„æ•°å­¦è¯æ˜ï¼šä¸ºä»€ä¹ˆ$\tau=1$åœ¨å¦‚æ­¤å¹¿æ³›çš„è®¾ç½®ä¸‹éƒ½æœ‰æ•ˆï¼Ÿ
- ä¸åŒæ¶æ„ï¼ˆCNNã€RNNã€Transformerã€MoEï¼‰çš„ç»Ÿä¸€ç†è®ºæ¡†æ¶ç¼ºå¤±</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>é—®é¢˜</strong>ï¼šèƒ½å¦è¯æ˜$\tau=1$æ˜¯æŸç§æ„ä¹‰ä¸‹çš„æœ€ä¼˜é˜ˆå€¼ï¼Ÿ</li>
<li><strong>æŒ‘æˆ˜</strong>ï¼šéœ€è¦å¯¹æŸå¤±å‡½æ•°çš„å‡ ä½•æ€§è´¨ï¼ˆHessianè°±ï¼‰åšå‡ºåˆç†å‡è®¾</li>
<li><strong>æ½œåœ¨æ–¹æ³•</strong>ï¼š<ul>
<li>åŸºäºéšæœºçŸ©é˜µç†è®ºåˆ†æé«˜ç»´æ¢¯åº¦åˆ†å¸ƒ</li>
<li>åˆ©ç”¨ç¥ç»æ­£åˆ‡æ ¸ï¼ˆNTKï¼‰ç†è®ºåˆ†æè®­ç»ƒåŠ¨åŠ›å­¦</li>
<li>ä»ç»Ÿè®¡ç‰©ç†è§’åº¦ç ”ç©¶ç›¸å˜ç°è±¡</li>
</ul>
</li>
<li>
<p><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼šä¸ºè¶…å‚æ•°é€‰æ‹©æä¾›ç†è®ºæŒ‡å¯¼ï¼Œå‡å°‘è°ƒä¼˜æˆæœ¬</p>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šæ¢¯åº¦è£å‰ªå¯¹æ”¶æ•›é€Ÿç‡çš„ç²¾ç¡®å½±å“ï¼Ÿ</p>
</li>
<li><strong>å·²çŸ¥</strong>ï¼šå‡¸æƒ…å†µä¸‹æœ‰$O(1/\sqrt{T})$æ”¶æ•›ç‡</li>
<li><strong>æœªçŸ¥</strong>ï¼šéå‡¸æƒ…å†µä¸‹çš„æ›´ç²¾ç»†åˆ†æï¼ˆé€ƒç¦»éç‚¹ã€åˆ°è¾¾äºŒé˜¶ç¨³å®šç‚¹ï¼‰</li>
<li>
<p><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼šç†è§£è£å‰ªå¦‚ä½•å½±å“æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›</p>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šä¸åŒæ¶æ„çš„è£å‰ªé˜ˆå€¼æ˜¯å¦æœ‰å…±åŒè§„å¾‹ï¼Ÿ</p>
</li>
<li><strong>ç°çŠ¶</strong>ï¼šRNNã€Transformeréƒ½ç”¨$\tau=1$ï¼Œä½†ç¼ºä¹ç»Ÿä¸€è§£é‡Š</li>
<li><strong>æ¢ç´¢æ–¹å‘</strong>ï¼š<ul>
<li>åˆ†æä¸åŒæ¶æ„çš„Jacobianè°±çš„å…±æ€§</li>
<li>ç ”ç©¶åˆå§‹åŒ–schemeä¸è£å‰ªé˜ˆå€¼çš„å…³ç³»</li>
<li>å»ºç«‹æ¶æ„æ— å…³çš„ç†è®ºæ¡†æ¶</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å‘å±•é’ˆå¯¹æ·±åº¦å­¦ä¹ çš„ä¼˜åŒ–ç†è®ºï¼ˆè¶…è¶Šå‡¸ä¼˜åŒ–ï¼‰
- ç»“åˆç»éªŒé£é™©æœ€å°åŒ–ï¼ˆERMï¼‰æ¡†æ¶åˆ†æè£å‰ªçš„æ­£åˆ™åŒ–æ•ˆåº”
- åˆ©ç”¨å¾®åˆ†å‡ ä½•ç ”ç©¶ä¼˜åŒ–è½¨è¿¹åœ¨å‚æ•°æµå½¢ä¸Šçš„æ€§è´¨</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- è¯æ˜åœ¨æ»¡è¶³æ¡ä»¶Xä¸‹ï¼Œ$\tau^* = \Theta(1)$ï¼ˆæ¸è¿‘æœ€ä¼˜ï¼‰
- æ¨å¯¼è£å‰ªå¯¹æ”¶æ•›é€Ÿç‡çš„å½±å“ï¼š$T(\tau) = T_0 (1 + O((\tau-1)^2))$
- å»ºç«‹ç»Ÿä¸€çš„æ¶æ„-æ— å…³ç†è®ºï¼Œé¢„æµ‹æ–°æ¶æ„çš„æœ€ä¼˜é˜ˆå€¼</p>
<hr />
<h4 id="2-"><strong>æ–¹å‘2ï¼šå®è·µå±‚é¢ - è¶…å¤§è§„æ¨¡æ¨¡å‹çš„è£å‰ªç­–ç•¥</strong></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- ä¸‡äº¿å‚æ•°æ¨¡å‹ï¼ˆå¦‚GPT-4ï¼‰çš„è®­ç»ƒç»†èŠ‚æœªå…¬å¼€
- æ··åˆç²¾åº¦è®­ç»ƒä¸­çš„è£å‰ªç­–ç•¥éœ€è¦ç‰¹æ®Šå¤„ç†
- åˆ†å¸ƒå¼è®­ç»ƒä¸­çš„å…¨å±€èŒƒæ•°è®¡ç®—æˆæœ¬é«˜</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>é—®é¢˜</strong>ï¼šå¦‚ä½•åœ¨æ··åˆç²¾åº¦è®­ç»ƒä¸­æœ‰æ•ˆè£å‰ªï¼Ÿ</li>
<li><strong>æŒ‘æˆ˜</strong>ï¼šFP16æ•°å€¼èŒƒå›´å°ï¼ˆ$\pm 65504$ï¼‰ï¼Œå®¹æ˜“æº¢å‡º</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š<ul>
<li>åœ¨FP32ç´¯ç§¯æ¢¯åº¦åè£å‰ª</li>
<li>åŠ¨æ€è°ƒæ•´loss scaleä¸è£å‰ªé˜ˆå€¼</li>
<li>åˆ†å±‚æ··åˆç²¾åº¦ï¼ˆé‡è¦å±‚ç”¨FP32ï¼‰</li>
</ul>
</li>
<li>
<p><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼šåœ¨ä¿æŒç²¾åº¦çš„åŒæ—¶åŠ é€Ÿè®­ç»ƒ2-3å€</p>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šåˆ†å¸ƒå¼è®­ç»ƒä¸­å¦‚ä½•é«˜æ•ˆè®¡ç®—å…¨å±€èŒƒæ•°ï¼Ÿ</p>
</li>
<li><strong>ç°çŠ¶</strong>ï¼šéœ€è¦All-Reduceé€šä¿¡ï¼Œæˆä¸ºç“¶é¢ˆ</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š<ul>
<li>å±€éƒ¨è£å‰ªï¼ˆæ¯ä¸ªè®¾å¤‡ç‹¬ç«‹è£å‰ªï¼‰</li>
<li>å¼‚æ­¥è£å‰ªï¼ˆå»¶è¿Ÿé€šä¿¡ï¼‰</li>
<li>è¿‘ä¼¼èŒƒæ•°ä¼°è®¡ï¼ˆéšæœºæŠ•å½±ï¼‰</li>
</ul>
</li>
<li>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼šé€šä¿¡å¼€é”€é™ä½50%ï¼Œç²¾åº¦æŸå¤±&lt;1%</p>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šå¦‚ä½•é’ˆå¯¹ä¸åŒæ¨¡æ€ï¼ˆæ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ï¼‰è°ƒæ•´è£å‰ªï¼Ÿ</p>
</li>
<li><strong>è§‚å¯Ÿ</strong>ï¼šä¸åŒæ¨¡æ€çš„æ¢¯åº¦ç»Ÿè®¡ç‰¹æ€§ä¸åŒ</li>
<li><strong>æ¢ç´¢æ–¹å‘</strong>ï¼š<ul>
<li>æ¨¡æ€ç‰¹å®šçš„é˜ˆå€¼</li>
<li>åŸºäºæ¨¡æ€é‡è¦æ€§çš„åŠ æƒè£å‰ª</li>
<li>è·¨æ¨¡æ€å¯¹é½ä¸­çš„è£å‰ªç­–ç•¥</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å¼€å‘ä¸“é—¨çš„æ··åˆç²¾åº¦è£å‰ªåº“ï¼ˆå¦‚ç»“åˆApexã€DeepSpeedï¼‰
- ç ”ç©¶é€šä¿¡é«˜æ•ˆçš„è£å‰ªç®—æ³•
- æ¢ç´¢ä¸æ¨¡å‹å¹¶è¡Œã€æµæ°´çº¿å¹¶è¡Œçš„ååŒä¼˜åŒ–</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- ä¸‡äº¿å‚æ•°æ¨¡å‹è®­ç»ƒä¸­ï¼Œè£å‰ªé€šä¿¡å¼€é”€&lt;5%æ€»è®­ç»ƒæ—¶é—´
- æ··åˆç²¾åº¦è£å‰ªä¸‹ï¼Œæ•°å€¼ç¨³å®šæ€§ä¸FP32ç­‰ä»·
- å¤šæ¨¡æ€æ¨¡å‹ä¸­ï¼Œå„æ¨¡æ€æ”¶æ•›é€Ÿåº¦å·®å¼‚&lt;10%</p>
<hr />
<h4 id="3-"><strong>æ–¹å‘3ï¼šæ–°å‹æ¶æ„ - æ–°å…´æ¨¡å‹çš„è£å‰ªéœ€æ±‚</strong></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- State Space Modelsï¼ˆå¦‚Mambaï¼‰çš„è£å‰ªç­–ç•¥æœªè¢«ç³»ç»Ÿç ”ç©¶
- Vision Transformerçš„è£å‰ªä¸CNNæ˜¯å¦ä¸åŒï¼Ÿ
- æŒç»­å­¦ä¹ ã€ç»ˆèº«å­¦ä¹ ä¸­çš„è‡ªé€‚åº”è£å‰ª</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>é—®é¢˜</strong>ï¼šMamba/RWKVç­‰SSMæ¨¡å‹æ˜¯å¦ä»é€‚ç”¨$\tau=1$ï¼Ÿ</li>
<li><strong>æŒ‘æˆ˜</strong>ï¼šSSMçš„æ¢¯åº¦ä¼ æ’­æœºåˆ¶ä¸RNN/Transformeréƒ½ä¸åŒ</li>
<li><strong>éœ€è¦éªŒè¯</strong>ï¼š<ul>
<li>SSMçš„Jacobianè°±åˆ†æ</li>
<li>æ¢¯åº¦èŒƒæ•°çš„å®éªŒåˆ†å¸ƒ</li>
<li>æœ€ä¼˜é˜ˆå€¼çš„ç»éªŒæœç´¢</li>
</ul>
</li>
<li>
<p><strong>å®éªŒè®¡åˆ’</strong>ï¼šåœ¨å¤šä¸ªä»»åŠ¡ä¸Šå¯¹æ¯”$\tau \in {0.5, 1, 2, 5}$</p>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šVision Transformeræ˜¯å¦éœ€è¦ä¸åŒçš„è£å‰ªç­–ç•¥ï¼Ÿ</p>
</li>
<li><strong>è§‚å¯Ÿ</strong>ï¼šViTçš„patch embeddingå±‚æ¢¯åº¦ç‰¹æ€§ç‰¹æ®Š</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
<ul>
<li>åˆ†layer typeè£å‰ªï¼ˆpatch embedding vs self-attention vs MLPï¼‰</li>
<li>è€ƒè™‘å›¾åƒåˆ†è¾¨ç‡çš„å½±å“</li>
<li>ä¸æ•°æ®å¢å¼ºï¼ˆmixupã€cutmixï¼‰çš„äº¤äº’</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šæŒç»­å­¦ä¹ ä¸­å¦‚ä½•é¿å…ç¾éš¾æ€§é—å¿˜ï¼Ÿ</p>
</li>
<li><strong>ç°çŠ¶</strong>ï¼šæ ‡å‡†è£å‰ªå¯èƒ½æŠ¹é™¤æ—§ä»»åŠ¡çš„æ¢¯åº¦ä¿¡æ¯</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š<ul>
<li>è®°å¿†å›æ”¾ï¼ˆreplayï¼‰æ—¶çš„å·®å¼‚åŒ–è£å‰ª</li>
<li>åŸºäºä»»åŠ¡é‡è¦æ€§çš„è£å‰ªï¼ˆFisherä¿¡æ¯ï¼‰</li>
<li>å…ƒå­¦ä¹ è£å‰ªç­–ç•¥</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å»ºç«‹æ–°æ¶æ„çš„æ¢¯åº¦åˆ†æbenchmark
- å¼€å‘è‡ªåŠ¨åŒ–çš„é˜ˆå€¼æœç´¢å·¥å…·ï¼ˆå¦‚Hyperband for clippingï¼‰
- ç ”ç©¶å¯å­¦ä¹ çš„è£å‰ªé˜ˆå€¼ï¼ˆmeta-learningï¼‰</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- ä¸º5ç§æ–°å…´æ¶æ„å»ºç«‹è£å‰ªæŒ‡å—
- è‡ªåŠ¨é˜ˆå€¼æœç´¢å°†æ‰‹åŠ¨è°ƒä¼˜æˆæœ¬é™ä½80%
- æŒç»­å­¦ä¹ ä¸­ï¼Œè£å‰ªä¸é™ä½æ—§ä»»åŠ¡æ€§èƒ½</p>
<hr />
<h4 id="4_2"><strong>æ–¹å‘4ï¼šä¸å…¶ä»–æŠ€æœ¯çš„ååŒä¼˜åŒ–</strong></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- æ¢¯åº¦è£å‰ªä¸å…¶ä»–æ­£åˆ™åŒ–æŠ€æœ¯ï¼ˆweight decayã€dropoutï¼‰çš„äº¤äº’
- ä¸äºŒé˜¶ä¼˜åŒ–æ–¹æ³•ï¼ˆNewtonã€BFGSï¼‰çš„ç»“åˆ
- ä¸æ¢¯åº¦å‹ç¼©ï¼ˆç”¨äºé€šä¿¡ä¼˜åŒ–ï¼‰çš„è”åˆè®¾è®¡</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>é—®é¢˜</strong>ï¼šæ¢¯åº¦è£å‰ªä¸æƒé‡è¡°å‡çš„æœ€ä¼˜ç»„åˆï¼Ÿ</li>
<li><strong>è§‚å¯Ÿ</strong>ï¼šä¸¤è€…éƒ½å½±å“æ¢¯åº¦çš„æœ‰æ•ˆèŒƒæ•°</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
<ul>
<li>è”åˆè°ƒä¼˜$\tau$å’Œweight decayç³»æ•°$\lambda$</li>
<li>ç†è®ºåˆ†æä¸¤è€…çš„ç­‰ä»·æ€§/äº’è¡¥æ€§</li>
<li>è‡ªé€‚åº”è°ƒæ•´æ¯”ä¾‹</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šèƒ½å¦å°†è£å‰ªé›†æˆåˆ°ä¼˜åŒ–å™¨å†…éƒ¨ï¼Ÿ</p>
</li>
<li><strong>ç°çŠ¶</strong>ï¼šè£å‰ªé€šå¸¸ä½œä¸ºå¤–éƒ¨æ“ä½œ</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
<ul>
<li>è®¾è®¡å†…ç½®è£å‰ªçš„ä¼˜åŒ–å™¨ï¼ˆClippedAdamã€ClippedSGDï¼‰</li>
<li>ä¸è‡ªé€‚åº”å­¦ä¹ ç‡ï¼ˆAdamã€RMSpropï¼‰æ·±åº¦èåˆ</li>
<li>ç†è®ºä¿è¯ï¼ˆæ”¶æ•›æ€§ã€é²æ£’æ€§ï¼‰</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šåˆ†å¸ƒå¼è®­ç»ƒä¸­çš„æ¢¯åº¦å‹ç¼©+è£å‰ªï¼Ÿ</p>
</li>
<li><strong>éœ€æ±‚</strong>ï¼šåŒæ—¶å‡å°‘é€šä¿¡é‡å’Œä¿è¯ç¨³å®šæ€§</li>
<li><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š<ul>
<li>å…ˆè£å‰ªåå‹ç¼© vs å…ˆå‹ç¼©åè£å‰ª</li>
<li>è”åˆè®¾è®¡å‹ç¼©ç‡å’Œè£å‰ªé˜ˆå€¼</li>
<li>ç†è®ºåˆ†æè¯¯å·®ç´¯ç§¯</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å»ºç«‹ç»Ÿä¸€çš„ä¼˜åŒ–æ¡†æ¶ï¼ˆè£å‰ªã€æ­£åˆ™åŒ–ã€å‹ç¼©ï¼‰
- å¼€å‘ä¸€ä½“åŒ–çš„ä¼˜åŒ–åº“
- è‡ªåŠ¨è¶…å‚æ•°è°ƒä¼˜ç³»ç»Ÿ</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- è”åˆä¼˜åŒ–ä½¿è®­ç»ƒæ•ˆç‡æå‡20%
- åˆ†å¸ƒå¼è®­ç»ƒé€šä¿¡é‡é™ä½50%ï¼Œç²¾åº¦æ— æŸ
- å‡å°‘80%çš„æ‰‹åŠ¨è°ƒä¼˜å·¥ä½œ</p>
<hr />
<h4 id="5_2"><strong>æ–¹å‘5ï¼šå¯è§£é‡Šæ€§ä¸è¯Šæ–­å·¥å…·</strong></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- ç¼ºä¹å¯è§†åŒ–å·¥å…·ç†è§£è£å‰ªçš„ä½œç”¨
- éš¾ä»¥è¯Šæ–­è£å‰ªæ˜¯å¦é…ç½®æ­£ç¡®
- è£å‰ªå¯¹æ¨¡å‹è¡Œä¸ºçš„é•¿æœŸå½±å“ä¸æ˜</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li><strong>é—®é¢˜</strong>ï¼šå¦‚ä½•å¯è§†åŒ–è£å‰ªçš„ä½œç”¨ï¼Ÿ</li>
<li><strong>éœ€æ±‚</strong>ï¼šç†è§£è£å‰ªåœ¨ä½•æ—¶ã€ä½•å¤„ã€ä¸ºä½•æ¿€æ´»</li>
<li>
<p><strong>å·¥å…·å¼€å‘</strong>ï¼š</p>
<ul>
<li>å®æ—¶ç›‘æ§è£å‰ªç‡ã€è£å‰ªç¨‹åº¦</li>
<li>å¯è§†åŒ–æ¢¯åº¦èŒƒæ•°åˆ†å¸ƒæ¼”åŒ–</li>
<li>åˆ†æè£å‰ªå¯¹æŸå¤±æ™¯è§‚çš„å½±å“</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šå¦‚ä½•è‡ªåŠ¨è¯Šæ–­è£å‰ªé…ç½®æ˜¯å¦åˆç†ï¼Ÿ</p>
</li>
<li><strong>æŒ‡æ ‡</strong>ï¼š<ul>
<li>è£å‰ªç‡ï¼ˆåº”åœ¨5%-15%ï¼‰</li>
<li>æ¢¯åº¦èŒƒæ•°ä¸é˜ˆå€¼çš„æ¯”ä¾‹åˆ†å¸ƒ</li>
<li>æŸå¤±æ›²çº¿çš„å¹³æ»‘åº¦</li>
</ul>
</li>
<li>
<p><strong>è‡ªåŠ¨å»ºè®®</strong>ï¼šæ ¹æ®è¯Šæ–­ç»“æœæ¨èè°ƒæ•´æ–¹å‘</p>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šè£å‰ªå¯¹æ¨¡å‹æ³›åŒ–çš„å½±å“ï¼Ÿ</p>
</li>
<li><strong>ç°çŠ¶</strong>ï¼šä¸»è¦å…³æ³¨è®­ç»ƒç¨³å®šæ€§ï¼Œæ³›åŒ–ç ”ç©¶ä¸è¶³</li>
<li><strong>æ¢ç´¢æ–¹å‘</strong>ï¼š<ul>
<li>è£å‰ªä½œä¸ºéšå¼æ­£åˆ™åŒ–</li>
<li>å¯¹æŠ—é²æ£’æ€§çš„å½±å“</li>
<li>åˆ†å¸ƒå¤–æ³›åŒ–çš„å½±å“</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å¼€å‘å¼€æºçš„è£å‰ªå¯è§†åŒ–åº“ï¼ˆå¦‚GradClipVizï¼‰
- é›†æˆåˆ°TensorBoardã€Weights &amp; Biasesç­‰å¹³å°
- å»ºç«‹è£å‰ªæœ€ä½³å®è·µæ•°æ®åº“</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- å¯è§†åŒ–å·¥å…·å¸®åŠ©90%ç”¨æˆ·æ­£ç¡®é…ç½®è£å‰ª
- è‡ªåŠ¨è¯Šæ–­å‡†ç¡®ç‡&gt;85%
- å»ºç«‹åŒ…å«100+æ¨¡å‹é…ç½®çš„çŸ¥è¯†åº“</p>
<hr />
<h4 id="_6"><strong>æ½œåœ¨åº”ç”¨åœºæ™¯</strong></h4>
<p><strong>å¼ºåŒ–å­¦ä¹ </strong>ï¼š
- Actor-Criticç®—æ³•ä¸­çš„ç­–ç•¥æ¢¯åº¦è£å‰ª
- Q-learningä¸­çš„TDè¯¯å·®è£å‰ª
- å¤šæ™ºèƒ½ä½“ç³»ç»Ÿçš„ååŒè£å‰ªç­–ç•¥</p>
<p><strong>è”é‚¦å­¦ä¹ </strong>ï¼š
- å®¢æˆ·ç«¯æœ¬åœ°è£å‰ªvsæœåŠ¡å™¨èšåˆåè£å‰ª
- å¼‚æ„å®¢æˆ·ç«¯çš„è‡ªé€‚åº”é˜ˆå€¼
- å·®åˆ†éšç§ä¸‹çš„è£å‰ªç­–ç•¥</p>
<p><strong>ç¥ç»æ¶æ„æœç´¢ï¼ˆNASï¼‰</strong>ï¼š
- è¶…ç½‘ç»œè®­ç»ƒä¸­çš„ç¨³å®šæ€§ä¿è¯
- å€™é€‰æ¶æ„çš„å¿«é€Ÿè¯„ä¼°ï¼ˆè£å‰ªåŠ é€Ÿï¼‰
- å¯å¾®åˆ†NASä¸­çš„æ¢¯åº¦æ§åˆ¶</p>
<p><strong>ç§‘å­¦è®¡ç®—</strong>ï¼š
- ç‰©ç†ä¿¡æ¯ç¥ç»ç½‘ç»œï¼ˆPINNï¼‰çš„PDEæ±‚è§£
- åˆ†å­åŠ¨åŠ›å­¦æ¨¡æ‹Ÿçš„ç¥ç»ç½‘ç»œåŠ¿å‡½æ•°
- åå¾®åˆ†æ–¹ç¨‹çš„ç¥ç»ç®—å­å­¦ä¹ </p>
<hr />
<h3 id="_7">æ€»ç»“</h3>
<p>æ¢¯åº¦è£å‰ªé˜ˆå€¼$\tau=1$ä¸æ˜¯ä¸€ä¸ªä»»æ„çš„è¶…å‚æ•°é€‰æ‹©ï¼Œè€Œæ˜¯æ·±åº¦å­¦ä¹ ç³»ç»Ÿå¤šç§å› ç´ å…±åŒä½œç”¨çš„è‡ªç„¶ç»“æœã€‚å®ƒåæ˜ äº†ï¼š</p>
<ol>
<li><strong>ä¼˜åŒ–åŠ¨åŠ›å­¦</strong>ï¼šæŸå¤±å˜åŒ–$\sim \eta |\boldsymbol{g}|^2$è¦æ±‚$|\boldsymbol{g}| \sim O(1)$</li>
<li><strong>ç½‘ç»œåˆå§‹åŒ–</strong>ï¼šè‰¯å¥½åˆå§‹åŒ–ä½¿å¾—æ¢¯åº¦èŒƒæ•°è‡ªç„¶åœ°åœ¨$O(1)$é‡çº§</li>
<li><strong>æ¶æ„è®¾è®¡</strong>ï¼šJacobianè°±èŒƒæ•°çº¦æŸ$\lesssim 1$ä¼ å¯¼è‡³æ¢¯åº¦èŒƒæ•°</li>
<li><strong>å­¦ä¹ ç‡å°ºåº¦</strong>ï¼šå…¸å‹å­¦ä¹ ç‡$\eta \sim 0.01-0.1$ä¸$\tau=1$åŒ¹é…</li>
<li><strong>ç»Ÿè®¡è§„å¾‹</strong>ï¼šé«˜ç»´æ¢¯åº¦åˆ†å¸ƒåœ¨å½’ä¸€åŒ–åé›†ä¸­äºå•ä½çƒé¢</li>
</ol>
<p>è¿™ä¸€ç®€å•è®¾ç½®èƒŒåè•´å«ç€ä¼˜åŒ–ç†è®ºã€ç»Ÿè®¡å­¦ä¹ ã€åŠ¨åŠ›ç³»ç»Ÿç­‰å¤šé¢†åŸŸçš„æ·±åˆ»è”ç³»ï¼Œæ˜¯æ·±åº¦å­¦ä¹ ä½œä¸ºä¸€é—¨ç§‘å­¦èµ°å‘æˆç†Ÿçš„æ ‡å¿—ä¹‹ä¸€ã€‚æœªæ¥çš„ç ”ç©¶å°†è¿›ä¸€æ­¥æ­ç¤ºå…¶ç†è®ºæœ¬è´¨ï¼Œå¹¶å‘å±•æ›´æ™ºèƒ½çš„è‡ªé€‚åº”è£å‰ªç­–ç•¥ã€‚</p>
        </div>
    </div>
</body>
</html>