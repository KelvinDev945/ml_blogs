<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¾“å…¥æ¢¯åº¦æƒ©ç½šä¸å‚æ•°æ¢¯åº¦æƒ©ç½šçš„ä¸€ä¸ªä¸ç­‰å¼</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>è¾“å…¥æ¢¯åº¦æƒ©ç½šä¸å‚æ•°æ¢¯åº¦æƒ©ç½šçš„ä¸€ä¸ªä¸ç­‰å¼</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 37.9 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8796">https://spaces.ac.cn/archives/8796</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨æœ¬åšå®¢ä¸­ï¼Œå·²ç»å¤šæ¬¡è®¨è®ºè¿‡æ¢¯åº¦æƒ©ç½šç›¸å…³å†…å®¹äº†ã€‚ä»å½¢å¼ä¸Šæ¥çœ‹ï¼Œæ¢¯åº¦æƒ©ç½šé¡¹åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯å…³äºè¾“å…¥çš„æ¢¯åº¦æƒ©ç½š$\Vert\nabla_{\boldsymbol{x}} f(\boldsymbol{x};\boldsymbol{\theta})\Vert^2$ï¼Œåœ¨<a href="/archives/7234">ã€Šå¯¹æŠ—è®­ç»ƒæµ…è°ˆï¼šæ„ä¹‰ã€æ–¹æ³•å’Œæ€è€ƒï¼ˆé™„Keraså®ç°ï¼‰ã€‹</a>ã€<a href="/archives/7466">ã€Šæ³›åŒ–æ€§ä¹±å¼¹ï¼šä»éšæœºå™ªå£°ã€æ¢¯åº¦æƒ©ç½šåˆ°è™šæ‹Ÿå¯¹æŠ—è®­ç»ƒã€‹</a>ç­‰æ–‡ç« ä¸­æˆ‘ä»¬è®¨è®ºè¿‡ï¼Œå¦ä¸€ç§åˆ™æ˜¯å…³äºå‚æ•°çš„æ¢¯åº¦æƒ©ç½š$\Vert\nabla_{\boldsymbol{\theta}} f(\boldsymbol{x};\boldsymbol{\theta})\Vert^2$ï¼Œåœ¨<a href="/archives/7787">ã€Šä»åŠ¨åŠ›å­¦è§’åº¦çœ‹ä¼˜åŒ–ç®—æ³•ï¼ˆäº”ï¼‰ï¼šä¸ºä»€ä¹ˆå­¦ä¹ ç‡ä¸å®œè¿‡å°ï¼Ÿã€‹</a>ã€<a href="/archives/7643">ã€Šæˆ‘ä»¬çœŸçš„éœ€è¦æŠŠè®­ç»ƒé›†çš„æŸå¤±é™ä½åˆ°é›¶å—ï¼Ÿã€‹</a>ç­‰æ–‡ç« æˆ‘ä»¬è®¨è®ºè¿‡ã€‚</p>
<p>åœ¨ç›¸å…³æ–‡ç« ä¸­ï¼Œä¸¤ç§æ¢¯åº¦æƒ©ç½šéƒ½å£°ç§°æœ‰ç€æé«˜æ¨¡å‹æ³›åŒ–æ€§èƒ½çš„èƒ½åŠ›ï¼Œé‚£ä¹ˆä¸¤è€…æœ‰æ²¡æœ‰ä»€ä¹ˆè”ç³»å‘¢ï¼Ÿç¬”è€…ä»Googleæœ€è¿‘çš„ä¸€ç¯‡è®ºæ–‡<a href="https://papers.cool/arxiv/2111.15090">ã€ŠThe Geometric Occam's Razor Implicit in Deep Learningã€‹</a>å­¦ä¹ åˆ°äº†ä¸¤è€…çš„ä¸€ä¸ªä¸ç­‰å¼ï¼Œç®—æ˜¯éƒ¨åˆ†åœ°å›ç­”äº†è¿™ä¸ªé—®é¢˜ï¼Œå¹¶ä¸”æ„Ÿè§‰ä»¥åå¯èƒ½ç”¨å¾—ä¸Šï¼Œåœ¨æ­¤åšä¸ªç¬”è®°ã€‚</p>
<h2 id="_1">æœ€ç»ˆç»“æœ</h2>
<p>å‡è®¾æœ‰ä¸€ä¸ª$l$å±‚çš„MLPæ¨¡å‹ï¼Œè®°ä¸º<br />
\begin{equation}\boldsymbol{h}^{(t+1)} = g^{(t)}(\boldsymbol{W}^{(t)}\boldsymbol{h}^{(t)}+\boldsymbol{b}^{(t)})\end{equation}<br />
å…¶ä¸­$g^{(t)}$æ˜¯å½“å‰å±‚çš„æ¿€æ´»å‡½æ•°ï¼Œ$t\in\{1,2,\cdots,l\}$ï¼Œå¹¶è®°$\boldsymbol{h}^{(1)}$ä¸º$\boldsymbol{x}$ï¼Œå³æ¨¡å‹çš„åŸå§‹è¾“å…¥ï¼Œä¸ºäº†æ–¹ä¾¿åé¢çš„æ¨å¯¼ï¼Œæˆ‘ä»¬è®°$\boldsymbol{z}^{(t+1)}=\boldsymbol{W}^{(t)}\boldsymbol{h}^{(t)}+\boldsymbol{b}^{(t)}$ï¼›å‚æ•°å…¨ä½“ä¸º$\boldsymbol{\theta}=\{\boldsymbol{W}^{(1)},\boldsymbol{b}^{(1)},\boldsymbol{W}^{(2)},\boldsymbol{b}^{(2)},\cdots,\boldsymbol{W}^{(l)},\boldsymbol{b}^{(l)}\}$ã€‚è®¾$f$æ˜¯$\boldsymbol{h}^{(l+1)}$çš„ä»»æ„æ ‡é‡å‡½æ•°ï¼Œé‚£ä¹ˆæˆç«‹ä¸ç­‰å¼<br />
\begin{equation}\Vert\nabla_{\boldsymbol{x}} f\Vert^2\left(\frac{1 + \Vert \boldsymbol{h}^{(1)}\Vert^2}{\Vert\boldsymbol{W}^{(1)}\Vert^2 \Vert\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(1)}\Vert^2}+\cdots+\frac{1 + \Vert \boldsymbol{h}^{(l)}\Vert^2}{\Vert\boldsymbol{W}^{(l)}\Vert^2 \Vert\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(l)}\Vert^2}\right)\leq \Vert\nabla_{\boldsymbol{\theta}} f\Vert^2\label{eq:f}\end{equation}<br />
å…¶ä¸­ä¸Šå¼ä¸­$\Vert\nabla_{\boldsymbol{x}} f\Vert$ã€$\Vert\nabla_{\boldsymbol{\theta}} f\Vert^2$å’Œ$\Vert \boldsymbol{h}^{(i)}\Vert$ç”¨çš„æ˜¯æ™®é€šçš„$l_2$èŒƒæ•°ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªå…ƒç´ çš„å¹³æ–¹å’Œå†å¼€å¹³æ–¹ï¼Œè€Œ$\Vert\boldsymbol{W}^{(1)}\Vert$å’Œ$\Vert\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(1)}\Vert$ç”¨çš„åˆ™æ˜¯çŸ©é˜µçš„â€œè°±èŒƒæ•°â€ï¼ˆå‚è€ƒ<a href="/archives/6051">ã€Šæ·±åº¦å­¦ä¹ ä¸­çš„Lipschitzçº¦æŸï¼šæ³›åŒ–ä¸ç”Ÿæˆæ¨¡å‹ã€‹</a>ï¼‰ã€‚è¯¥ä¸ç­‰å¼æ˜¾ç¤ºï¼Œå‚æ•°çš„æ¢¯åº¦æƒ©ç½šä¸€å®šç¨‹åº¦ä¸ŠåŒ…å«äº†è¾“å…¥çš„æ¢¯åº¦æƒ©ç½šã€‚</p>
<h2 id="_2">æ¨å¯¼è¿‡ç¨‹</h2>
<p>æ˜¾ç„¶ï¼Œä¸ºäº†ä¸ç­‰å¼$\eqref{eq:f}$ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹æ¯ä¸€ä¸ªå‚æ•°è¯æ˜ï¼š<br />
\begin{align}\Vert\nabla_{\boldsymbol{x}} f\Vert^2\left(\frac{\Vert \boldsymbol{h}^{(t)}\Vert^2}{\Vert\boldsymbol{W}^{(t)}\Vert^2 \Vert\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(t)}\Vert^2}\right)\leq&amp;\, \Vert\nabla_{\boldsymbol{W}^{(t)}} f\Vert^2 \label{eq:w}\\\<br />
\Vert\nabla_{\boldsymbol{x}} f\Vert^2\left(\frac{1}{\Vert\boldsymbol{W}^{(t)}\Vert^2 \Vert\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(t)}\Vert^2}\right)\leq&amp;\, \Vert\nabla_{\boldsymbol{b}^{(t)}} f\Vert^2 \label{eq:b}<br />
\end{align}<br />
ç„¶åéå†æ‰€æœ‰$t$ï¼Œå°†æ¯ä¸€å¼å·¦å³ä¸¤ç«¯ç›¸åŠ å³å¯ã€‚è¿™ä¸¤ä¸ªä¸ç­‰å¼çš„è¯æ˜æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªçŸ©é˜µæ±‚å¯¼é—®é¢˜ï¼Œä½†å¤šæ•°è¯»è€…å¯èƒ½è·Ÿç¬”è€…ä¸€æ ·ï¼Œéƒ½ä¸ç†Ÿæ‚‰çŸ©é˜µæ±‚å¯¼ï¼Œè¿™æ—¶å€™æœ€ä½³çš„åŠæ³•å°±æ˜¯å†™å‡ºåˆ†é‡å½¢å¼ï¼Œç„¶åå°±å˜æˆæ ‡é‡çš„æ±‚å¯¼é—®é¢˜ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œ$\boldsymbol{z}^{(t+1)}=\boldsymbol{W}^{(t)}\boldsymbol{h}^{(t)}+\boldsymbol{b}^{(t)}$å†™æˆåˆ†é‡å½¢å¼ï¼š<br />
\begin{equation}z^{(t+1)}<em i_j="i,j">i = \sum_j w^{(t)}</em>} h_j^{(t)} + b^{(t)<em j_k="j,k">i\end{equation}<br />
ç„¶åç”±é“¾å¼æ³•åˆ™ï¼š<br />
\begin{equation}\frac{\partial f}{\partial x_i} = \sum</em>} \frac{\partial f}{\partial z^{(t+1)<em j_k="j,k">j} \frac{\partial z^{(t+1)}_j}{\partial h^{(t)}_k} \frac{\partial h^{(t)}_k}{\partial x_i} = \sum</em>} \frac{\partial f}{\partial z^{(t+1)<em j_k="j,k">j} w^{(t)}</em>} \frac{\partial h^{(t)<em m_n="m,n">k}{\partial x_i}\label{eq:l}\end{equation}<br />
ç„¶å<br />
\begin{equation}\frac{\partial z^{(t+1)}_j}{\partial w^{(t)}</em>}} = \delta_{j,m}h^{(t)<em j_m="j,m">n\end{equation}<br />
è¿™é‡Œ$\delta</em>$æ˜¯å…‹ç½—å†…å…‹ç¬¦å·ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å†™å‡º<br />
\begin{equation}w^{(t)}<em j_m="j,m">{j,k} = \sum_m \delta</em>}w^{(t)<em m_n="m,n">{m,k} = \sum_m \frac{\partial z^{(t+1)}_j}{\partial w^{(t)}</em>}} (h^{(t)<em m_k="m,k">n)^{-1} w^{(t)}</em>}\end{equation<br />
ä»£å…¥$\eqref{eq:l}$å¾—åˆ°<br />
\begin{equation}\frac{\partial f}{\partial x_i} = \sum_{j,k,m} \frac{\partial f}{\partial z^{(t+1)}<em m_n="m,n">j} \frac{\partial z^{(t+1)}_j}{\partial w^{(t)}</em>}} (h^{(t)<em m_k="m,k">n)^{-1} w^{(t)}</em>} \frac{\partial h^{(t)<em k_m="k,m">k}{\partial x_i}=\sum</em>} \frac{\partial f}{\partial w^{(t)<em m_k="m,k">{m,n}} (h^{(t)}_n)^{-1} w^{(t)}</em>} \frac{\partial h^{(t)<em k_m="k,m">k}{\partial x_i}\end{equation}<br />
ä¸¤è¾¹ä¹˜ä»¥$h^{(t)}_n$å¾—<br />
\begin{equation}h^{(t)}_n\frac{\partial f}{\partial x_i} = \sum</em>} \frac{\partial f}{\partial w^{(t)<em m_k="m,k">{m,n}} w^{(t)}</em>} \frac{\partial h^{(t)<em _boldsymbol_x="\boldsymbol{x">k}{\partial x_i}\end{equation}<br />
çº¦å®šåŸå§‹å‘é‡ä¸ºåˆ—å‘é‡ï¼Œæ±‚æ¢¯åº¦åçŸ©é˜µçš„å½¢çŠ¶åè½¬ï¼Œé‚£ä¹ˆä¸Šè¿°å¯ä»¥å†™æˆçŸ©é˜µå½¢å¼ï¼š<br />
\begin{equation}\boldsymbol{h}^{(t)}(\nabla</em>}} f) = (\nabla_{\boldsymbol{W}^{(t)}} f )\boldsymbol{W}^{(t)}(\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(t)})\end{equation<br />
ä¸¤è¾¹å·¦ä¹˜$(\boldsymbol{h}^{(t)})^{\top}$å¾—<br />
\begin{equation}\Vert\boldsymbol{h}^{(t)}\Vert^2(\nabla_{\boldsymbol{x}} f) = (\boldsymbol{h}^{(t)})^{\top}(\nabla_{\boldsymbol{W}^{(t)}} f )\boldsymbol{W}^{(t)}(\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(t)})\end{equation}<br />
ä¸¤è¾¹å–èŒƒæ•°å¾—<br />
\begin{equation}\Vert\boldsymbol{h}^{(t)}\Vert^2 \Vert\nabla_{\boldsymbol{x}} f\Vert = \Vert (\boldsymbol{h}^{(t)})^{\top}(\nabla_{\boldsymbol{W}^{(t)}} f )\boldsymbol{W}^{(t)}(\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(t)})\Vert \leq \Vert\boldsymbol{h}^{(t)}\Vert \Vert\nabla_{\boldsymbol{W}^{(t)}} f \Vert \Vert \boldsymbol{W}^{(t)}\Vert \Vert\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(t)}\Vert\end{equation}<br />
ç­‰äºç¬¬äºŒä¸ªä¸ç­‰å·æ¥è¯´ï¼ŒçŸ©é˜µçš„èŒƒæ•°ç”¨$l_2$èŒƒæ•°æˆ–è€…è°±èŒƒæ•°éƒ½æ˜¯æˆç«‹çš„ã€‚äºæ˜¯é€‰æ‹©æ‰€éœ€è¦çš„èŒƒæ•°åï¼Œæ•´ç†å¯å¾—å¼$\eqref{eq:w}$ï¼›è‡³äºå¼$\eqref{eq:b}$çš„è¯æ˜ç±»ä¼¼ï¼Œè¿™é‡Œä¸å†é‡å¤ã€‚</p>
<h2 id="_3">ç®€å•è¯„æ</h2>
<p>å¯èƒ½æœ‰è¯»è€…ä¼šæƒ³é—®å…·ä½“è¯¥å¦‚ä½•ç†è§£å¼$\eqref{eq:f}$ï¼Ÿäº‹å®ä¸Šï¼Œç¬”è€…ä¸»è¦è§‰å¾—å¼$\eqref{eq:f}$æœ¬èº«æœ‰ç‚¹æ„æ€ï¼Œä»¥åè¯´ä¸å‡†åœ¨æŸä¸ªåœºæ™¯ç”¨å¾—ä¸Šï¼Œæ‰€ä»¥æœ¬æ–‡ä¸»è¦æ˜¯å¯¹æ­¤åšä¸ªâ€œç¬”è®°â€ï¼Œä½†å¯¹å®ƒå¹¶æ²¡æœ‰å¾ˆå¥½çš„è§£è¯»ç»“æœã€‚</p>
<p>è‡³äºåŸè®ºæ–‡çš„é€»è¾‘é¡ºåºæ˜¯è¿™æ ·çš„ï¼šåœ¨<a href="/archives/7787">ã€Šä»åŠ¨åŠ›å­¦è§’åº¦çœ‹ä¼˜åŒ–ç®—æ³•ï¼ˆäº”ï¼‰ï¼šä¸ºä»€ä¹ˆå­¦ä¹ ç‡ä¸å®œè¿‡å°ï¼Ÿã€‹</a>ä¸­æˆ‘ä»¬ä»‹ç»äº†<a href="/archives/7787">ã€ŠImplicit Gradient Regularizationã€‹</a>ï¼ˆè·Ÿæœ¬ç¯‡è®ºæ–‡åŒä¸€ä½œè€…ï¼‰ï¼Œé‡Œè¾¹æŒ‡å‡ºSGDéšå¼åœ°åŒ…å«äº†å¯¹å‚æ•°çš„æ¢¯åº¦æƒ©ç½šé¡¹ï¼Œè€Œå¼$\eqref{eq:f}$åˆ™è¯´æ˜å¯¹å‚æ•°çš„æ¢¯åº¦æƒ©ç½šéšå¼åœ°åŒ…å«äº†å¯¹è¾“å…¥çš„æ¢¯åº¦æƒ©ç½šï¼Œè€Œå¯¹è¾“å…¥çš„æ¢¯åº¦æƒ©ç½šåˆè·ŸDirichletèƒ½é‡æœ‰å…³ï¼ŒDirichletèƒ½é‡åˆ™å¯ä»¥ä½œä¸ºæ¨¡å‹å¤æ‚åº¦çš„è¡¨å¾ã€‚æ‰€ä»¥æ€»çš„ä¸€ä¸²æ¨ç†ä¸‹æ¥ï¼Œç»“è®ºå°±æ˜¯ï¼šSGDæœ¬èº«ä¼šå€¾å‘äºé€‰æ‹©å¤æ‚åº¦æ¯”è¾ƒå°çš„æ¨¡å‹ã€‚</p>
<p>ä¸è¿‡ï¼ŒåŸè®ºæ–‡åœ¨è§£è¯»å¼$\eqref{eq:f}$æ—¶ï¼ŒçŠ¯äº†ä¸€ä¸ªå°é”™è¯¯ã€‚å®ƒè¯´åˆå§‹é˜¶æ®µçš„$\Vert \boldsymbol{W}^{(t)}\Vert$ä¼šå¾ˆæ¥è¿‘äº0ï¼Œæ‰€ä»¥å¼$\eqref{eq:f}$ä¸­æ‹¬å·çš„é¡¹ä¼šå¾ˆå¤§ï¼Œå› æ­¤å¦‚æœè¦é™ä½å¼$\eqref{eq:f}$å³è¾¹çš„å‚æ•°æ¢¯åº¦æƒ©ç½šï¼Œé‚£ä¹ˆå¿…é¡»è¦ä½¿å¾—å¼$\eqref{eq:f}$å·¦è¾¹çš„è¾“å…¥æ¢¯åº¦æƒ©ç½šè¶³å¤Ÿå°ã€‚ç„¶è€Œä»<a href="/archives/7180">ã€Šä»å‡ ä½•è§†è§’æ¥ç†è§£æ¨¡å‹å‚æ•°çš„åˆå§‹åŒ–ç­–ç•¥ã€‹</a>æˆ‘ä»¬çŸ¥é“ï¼Œå¸¸ç”¨çš„åˆå§‹åŒ–æ–¹æ³•å…¶å®æ¥è¿‘äºæ­£äº¤åˆå§‹åŒ–ï¼Œè€Œæ­£äº¤çŸ©é˜µçš„è°±èŒƒæ•°å…¶å®ä¸º1ï¼Œå¦‚æœè€ƒè™‘æ¿€æ´»å‡½æ•°ï¼Œé‚£ä¹ˆåˆå§‹åŒ–çš„è°±èŒƒæ•°å…¶å®è¿˜å¤§äº1ï¼Œæ‰€ä»¥åˆå§‹åŒ–é˜¶æ®µ$\Vert \boldsymbol{W}^{(t)}\Vert$ä¼šå¾ˆæ¥è¿‘äº0æ˜¯ä¸æˆç«‹çš„ã€‚</p>
<p>äº‹å®ä¸Šï¼Œå¯¹äºä¸€ä¸ªæ²¡æœ‰è®­ç»ƒå´©çš„ç½‘ç»œï¼Œæ¨¡å‹çš„å‚æ•°å’Œæ¯ä¸€å±‚çš„è¾“å…¥è¾“å‡ºåŸºæœ¬ä¸Šéƒ½ä¼šä¿æŒä¸€ç§ç¨³å®šçš„çŠ¶æ€ï¼Œæ‰€ä»¥å…¶å®æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹ä¸­$\Vert \boldsymbol{h}^{(t)}\Vert$ã€$\Vert\boldsymbol{W}^{(t)}\Vert$ã€$\Vert\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(t)}\Vert$å…¶å®æ³¢åŠ¨éƒ½ä¸å¤§ï¼Œå› æ­¤å³ç«¯å¯¹å‚æ•°çš„æ¢¯åº¦æƒ©ç½šè¿‘ä¼¼ç­‰ä»·äºå·¦ç«¯å¯¹è¾“å…¥çš„ä¹˜æ³•æƒ©ç½šã€‚è¿™æ˜¯ç¬”è€…çš„ç†è§£ï¼Œä¸éœ€è¦â€œ$\Vert \boldsymbol{W}^{(t)}\Vert$ä¼šå¾ˆæ¥è¿‘äº0â€çš„å‡è®¾ã€‚</p>
<h2 id="_4">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†ä¸¤ç§æ¢¯åº¦æƒ©ç½šé¡¹ä¹‹é—´çš„ä¸€ä¸ªä¸ç­‰å¼ï¼Œå¹¶ç»™å‡ºäº†è‡ªå·±çš„è¯æ˜ä»¥åŠä¸€ä¸ªç®€å•çš„è¯„æã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8796">https://spaces.ac.cn/archives/8796</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Dec. 11, 2021). ã€Šè¾“å…¥æ¢¯åº¦æƒ©ç½šä¸å‚æ•°æ¢¯åº¦æƒ©ç½šçš„ä¸€ä¸ªä¸ç­‰å¼ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8796">https://spaces.ac.cn/archives/8796</a></p>
<p>@online{kexuefm-8796,<br />
title={è¾“å…¥æ¢¯åº¦æƒ©ç½šä¸å‚æ•°æ¢¯åº¦æƒ©ç½šçš„ä¸€ä¸ªä¸ç­‰å¼},<br />
author={è‹å‰‘æ—},<br />
year={2021},<br />
month={Dec},<br />
url={\url{https://spaces.ac.cn/archives/8796}},<br />
} </p>
<hr />
<h2 id="_5">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">1. å¤šå±‚æ„ŸçŸ¥æœºçš„æ¢¯åº¦ä¼ æ’­åŸºç¡€</h3>
<h4 id="11-mlp">1.1 MLPçš„å‰å‘ä¼ æ’­</h4>
<p>è€ƒè™‘ä¸€ä¸ªæ ‡å‡†çš„$l$å±‚MLP,ç¬¬$t$å±‚çš„å‰å‘ä¼ æ’­å®šä¹‰ä¸º:
\begin{equation}\boldsymbol{h}^{(t+1)} = g^{(t)}(\boldsymbol{z}^{(t+1)}), \quad \boldsymbol{z}^{(t+1)} = \boldsymbol{W}^{(t)}\boldsymbol{h}^{(t)} + \boldsymbol{b}^{(t)}\tag{1}\end{equation}</p>
<p>å…¶ä¸­:
- $\boldsymbol{h}^{(t)} \in \mathbb{R}^{n_t}$æ˜¯ç¬¬$t$å±‚çš„æ¿€æ´»å€¼
- $\boldsymbol{W}^{(t)} \in \mathbb{R}^{n_{t+1} \times n_t}$æ˜¯æƒé‡çŸ©é˜µ
- $\boldsymbol{b}^{(t)} \in \mathbb{R}^{n_{t+1}}$æ˜¯åç½®å‘é‡
- $g^{(t)}: \mathbb{R}^{n_{t+1}} \to \mathbb{R}^{n_{t+1}}$æ˜¯æ¿€æ´»å‡½æ•°(é€å…ƒç´ åº”ç”¨)
- $\boldsymbol{h}^{(1)} = \boldsymbol{x}$æ˜¯è¾“å…¥</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: MLPé€šè¿‡äº¤æ›¿è¿›è¡Œçº¿æ€§å˜æ¢å’Œéçº¿æ€§æ¿€æ´»,é€å±‚æå–ç‰¹å¾ã€‚</p>
<h4 id="12">1.2 åå‘ä¼ æ’­ä¸é“¾å¼æ³•åˆ™</h4>
<p>å¯¹äºæ ‡é‡æŸå¤±å‡½æ•°$f(\boldsymbol{h}^{(l+1)})$,æ ¹æ®é“¾å¼æ³•åˆ™:
\begin{equation}\frac{\partial f}{\partial \boldsymbol{h}^{(t)}} = \left(\frac{\partial \boldsymbol{z}^{(t+1)}}{\partial \boldsymbol{h}^{(t)}}\right)^{\top} \frac{\partial \boldsymbol{h}^{(t+1)}}{\partial \boldsymbol{z}^{(t+1)}} \frac{\partial f}{\partial \boldsymbol{h}^{(t+1)}}\tag{2}\end{equation}</p>
<p>å±•å¼€å„é¡¹:
- $\frac{\partial \boldsymbol{z}^{(t+1)}}{\partial \boldsymbol{h}^{(t)}} = \boldsymbol{W}^{(t)}$
- $\frac{\partial \boldsymbol{h}^{(t+1)}}{\partial \boldsymbol{z}^{(t+1)}} = \text{diag}(g'^{(t)}(\boldsymbol{z}^{(t+1)}))$,è®°ä¸º$\boldsymbol{D}^{(t+1)}$</p>
<p>å› æ­¤:
\begin{equation}\frac{\partial f}{\partial \boldsymbol{h}^{(t)}} = (\boldsymbol{W}^{(t)})^{\top}\boldsymbol{D}^{(t+1)}\frac{\partial f}{\partial \boldsymbol{h}^{(t+1)}}\tag{3}\end{equation}</p>
<p>é€’æ¨åœ°,ä»è¾“å‡ºå±‚åˆ°è¾“å…¥å±‚:
\begin{equation}\frac{\partial f}{\partial \boldsymbol{x}} = \frac{\partial f}{\partial \boldsymbol{h}^{(1)}} = (\boldsymbol{W}^{(1)})^{\top}\boldsymbol{D}^{(2)}(\boldsymbol{W}^{(2)})^{\top}\boldsymbol{D}^{(3)}\cdots(\boldsymbol{W}^{(l)})^{\top}\boldsymbol{D}^{(l+1)}\frac{\partial f}{\partial \boldsymbol{h}^{(l+1)}}\tag{4}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: æ¢¯åº¦åå‘ä¼ æ’­æ˜¯æƒé‡çŸ©é˜µè½¬ç½®å’Œæ¿€æ´»å‡½æ•°å¯¼æ•°çš„äº¤æ›¿ä¹˜ç§¯ã€‚</p>
<h4 id="13-jacobian">1.3 JacobiançŸ©é˜µè¡¨ç¤º</h4>
<p>å®šä¹‰è¾“å…¥åˆ°ç¬¬$t$å±‚æ¿€æ´»çš„JacobiançŸ©é˜µ:
\begin{equation}\boldsymbol{J}_{\boldsymbol{x}}^{(t)} = \frac{\partial \boldsymbol{h}^{(t)}}{\partial \boldsymbol{x}} \in \mathbb{R}^{n_t \times n_1}\tag{5}\end{equation}</p>
<p>é€’æ¨å…³ç³»:
\begin{equation}\boldsymbol{J}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{x}}^{(t+1)} = \boldsymbol{D}^{(t+1)}\boldsymbol{W}^{(t)}\boldsymbol{J}</em>}}^{(t)}\tag{6}\end{equation</p>
<p>åˆå§‹æ¡ä»¶:$\boldsymbol{J}_{\boldsymbol{x}}^{(1)} = \boldsymbol{I}$(å•ä½çŸ©é˜µ)ã€‚</p>
<p>ä»è¾“å…¥åˆ°è¾“å‡ºçš„å®Œæ•´Jacobian:
\begin{equation}\boldsymbol{J}_{\boldsymbol{x}}^{(l+1)} = \boldsymbol{D}^{(l+1)}\boldsymbol{W}^{(l)}\boldsymbol{D}^{(l)}\boldsymbol{W}^{(l-1)}\cdots\boldsymbol{D}^{(2)}\boldsymbol{W}^{(1)}\tag{7}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: JacobiançŸ©é˜µæ•æ‰äº†è¾“å…¥æ‰°åŠ¨å¦‚ä½•ä¼ æ’­åˆ°è¾“å‡º,æ˜¯ç†è§£ç½‘ç»œæ•æ„Ÿæ€§çš„å…³é”®ã€‚</p>
<h3 id="2">2. çŸ©é˜µèŒƒæ•°ç†è®º</h3>
<h4 id="21">2.1 å‘é‡èŒƒæ•°å›é¡¾</h4>
<p>å¸¸ç”¨å‘é‡èŒƒæ•°:
- $\ell_1$èŒƒæ•°: $|\boldsymbol{x}|<em i="i">1 = \sum</em>|x_i|$
- $\ell_2$èŒƒæ•°(æ¬§å‡ é‡Œå¾—èŒƒæ•°): $|\boldsymbol{x}|<em i="i">2 = \sqrt{\sum</em>$
- $\ell_\infty$èŒƒæ•°: $|\boldsymbol{x}|_\infty = \max_i |x_i|$}x_i^2</p>
<p>å®ƒä»¬æ»¡è¶³ä¸‰è§’ä¸ç­‰å¼å’Œæ¬¡å¯ä¹˜æ€§ã€‚</p>
<h4 id="22">2.2 çŸ©é˜µèŒƒæ•°å®šä¹‰</h4>
<p><strong>è¯±å¯¼èŒƒæ•°</strong>(ç®—å­èŒƒæ•°): å¯¹äºå‘é‡èŒƒæ•°$|\cdot|$,å®šä¹‰çŸ©é˜µèŒƒæ•°
\begin{equation}|\boldsymbol{A}| = \max_{\boldsymbol{x}\neq 0}\frac{|\boldsymbol{A}\boldsymbol{x}|}{|\boldsymbol{x}|} = \max_{|\boldsymbol{x}|=1}|\boldsymbol{A}\boldsymbol{x}|\tag{8}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: çŸ©é˜µèŒƒæ•°åº¦é‡çŸ©é˜µå¯¹å‘é‡çš„æœ€å¤§æ”¾å¤§å€æ•°ã€‚</p>
<h4 id="23">2.3 è°±èŒƒæ•°</h4>
<p><strong>å®šä¹‰</strong>: è°±èŒƒæ•°æ˜¯$\ell_2$è¯±å¯¼èŒƒæ•°,è®°ä¸º$|\boldsymbol{A}|<em _124_boldsymbol_x="|\boldsymbol{x">2$:
\begin{equation}|\boldsymbol{A}|_2 = \max</em>|<em _max="\max">2=1}|\boldsymbol{A}\boldsymbol{x}|_2 = \sigma</em>}(\boldsymbol{A})\tag{9}\end{equation</p>
<p>å…¶ä¸­$\sigma_{\max}(\boldsymbol{A})$æ˜¯$\boldsymbol{A}$çš„æœ€å¤§å¥‡å¼‚å€¼ã€‚</p>
<p><strong>æ€§è´¨</strong>:
1. æ¬¡å¯ä¹˜æ€§: $|\boldsymbol{AB}|_2 \leq |\boldsymbol{A}|_2|\boldsymbol{B}|_2$
2. é…‰ä¸å˜æ€§: $|\boldsymbol{UAV}|_2 = |\boldsymbol{A}|_2$,è‹¥$\boldsymbol{U},\boldsymbol{V}$æ˜¯é…‰çŸ©é˜µ
3. å¯¹äºå‘é‡(è§†ä¸º$n\times 1$çŸ©é˜µ): $|\boldsymbol{x}|_2 = |\boldsymbol{x}|_2$(ä¸€è‡´)</p>
<p><strong>è®¡ç®—</strong>: é€šè¿‡å¥‡å¼‚å€¼åˆ†è§£(SVD)
\begin{equation}\boldsymbol{A} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}, \quad |\boldsymbol{A}|_2 = \sigma_1\tag{10}\end{equation}</p>
<p>å…¶ä¸­$\sigma_1 \geq \sigma_2 \geq \cdots \geq \sigma_r &gt; 0$æ˜¯å¥‡å¼‚å€¼ã€‚</p>
<h4 id="24-frobenius">2.4 FrobeniusèŒƒæ•°</h4>
<p><strong>å®šä¹‰</strong>:
\begin{equation}|\boldsymbol{A}|<em i_j="i,j">F = \sqrt{\sum</em>}a_{ij}^2} = \sqrt{\text{tr}(\boldsymbol{A}^{\top}\boldsymbol{A})} = \sqrt{\sum_{i}\sigma_i^2}\tag{11}\end{equation</p>
<p><strong>ä¸è°±èŒƒæ•°çš„å…³ç³»</strong>:
\begin{equation}|\boldsymbol{A}|_2 \leq |\boldsymbol{A}|_F \leq \sqrt{\text{rank}(\boldsymbol{A})}|\boldsymbol{A}|_2\tag{12}\end{equation}</p>
<p>å¯¹äºç§©1çŸ©é˜µ,ä¸¤è€…ç›¸ç­‰ã€‚</p>
<h4 id="25">2.5 èŒƒæ•°ä¸ç­‰å¼</h4>
<p><strong>Cauchy-Schwarzä¸ç­‰å¼</strong>(å‘é‡ç‰ˆ):
\begin{equation}|\boldsymbol{a}^{\top}\boldsymbol{b}| \leq |\boldsymbol{a}|_2|\boldsymbol{b}|_2\tag{13}\end{equation}</p>
<p><strong>HÃ¶lderä¸ç­‰å¼</strong>(çŸ©é˜µç‰ˆ):
\begin{equation}|\boldsymbol{AB}|_2 \leq |\boldsymbol{A}|_2|\boldsymbol{B}|_2\tag{14}\end{equation}</p>
<p>è¿™æ˜¯æ¬¡å¯ä¹˜æ€§çš„æ ¸å¿ƒã€‚</p>
<h3 id="3">3. æ ¸å¿ƒä¸ç­‰å¼çš„è¯¦ç»†è¯æ˜</h3>
<h4 id="31">3.1 å‚æ•°æ¢¯åº¦çš„åˆ†é‡å½¢å¼</h4>
<p>å¯¹äºæƒé‡$\boldsymbol{W}^{(t)}$,æŸå¤±$f$å…³äº$w_{i,j}^{(t)}$çš„æ¢¯åº¦:
\begin{equation}\frac{\partial f}{\partial w_{i,j}^{(t)}} = \frac{\partial f}{\partial z_i^{(t+1)}}\frac{\partial z_i^{(t+1)}}{\partial w_{i,j}^{(t)}} = \frac{\partial f}{\partial z_i^{(t+1)}}h_j^{(t)}\tag{15}\end{equation}</p>
<p>è®°$\boldsymbol{\delta}^{(t+1)} = \frac{\partial f}{\partial \boldsymbol{z}^{(t+1)}}$,åˆ™:
\begin{equation}\nabla_{\boldsymbol{W}^{(t)}}f = \boldsymbol{\delta}^{(t+1)}(\boldsymbol{h}^{(t)})^{\top}\tag{16}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: æƒé‡æ¢¯åº¦æ˜¯è¯¯å·®ä¿¡å·ä¸æ¿€æ´»å€¼çš„å¤–ç§¯ã€‚</p>
<h4 id="32">3.2 è¾“å…¥æ¢¯åº¦çš„é‡æ–°è¡¨è¾¾</h4>
<p>ä»å¼(4),æˆ‘ä»¬æœ‰:
\begin{equation}\nabla_{\boldsymbol{x}}f = (\boldsymbol{J}_{\boldsymbol{x}}^{(l+1)})^{\top}\frac{\partial f}{\partial \boldsymbol{h}^{(l+1)}}\tag{17}\end{equation}</p>
<p>ç°åœ¨çš„ç›®æ ‡æ˜¯å»ºç«‹$|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_W="\boldsymbol{W">2$å’Œ$|\nabla</em>f|_2$ä¹‹é—´çš„å…³ç³»ã€‚}^{(t)}</p>
<h4 id="33">3.3 å•å±‚æƒ…å†µçš„æ¨å¯¼</h4>
<p>å…ˆè€ƒè™‘å•å±‚($l=1$)çš„ç®€åŒ–æƒ…å†µ:$\boldsymbol{h}^{(2)} = g^{(1)}(\boldsymbol{W}^{(1)}\boldsymbol{x} + \boldsymbol{b}^{(1)})$ã€‚</p>
<p>è¾“å…¥æ¢¯åº¦:
\begin{equation}\nabla_{\boldsymbol{x}}f = (\boldsymbol{W}^{(1)})^{\top}\boldsymbol{D}^{(2)}\frac{\partial f}{\partial \boldsymbol{h}^{(2)}}\tag{18}\end{equation}</p>
<p>æƒé‡æ¢¯åº¦(å¼16):
\begin{equation}\nabla_{\boldsymbol{W}^{(1)}}f = \boldsymbol{\delta}^{(2)}\boldsymbol{x}^{\top}, \quad \boldsymbol{\delta}^{(2)} = \boldsymbol{D}^{(2)}\frac{\partial f}{\partial \boldsymbol{h}^{(2)}}\tag{19}\end{equation}</p>
<p>ä»å¼(18)å¯ä»¥å†™æˆ:
\begin{equation}\nabla_{\boldsymbol{x}}f = (\boldsymbol{W}^{(1)})^{\top}\boldsymbol{\delta}^{(2)}\tag{20}\end{equation}</p>
<p>ç»“åˆå¼(19):
\begin{equation}\boldsymbol{x}^{\top}\nabla_{\boldsymbol{x}}f = \boldsymbol{x}^{\top}(\boldsymbol{W}^{(1)})^{\top}\boldsymbol{\delta}^{(2)} = \text{tr}(\boldsymbol{\delta}^{(2)}\boldsymbol{x}^{\top}(\boldsymbol{W}^{(1)})^{\top}) = \text{tr}((\boldsymbol{W}^{(1)})^{\top}\boldsymbol{\delta}^{(2)}\boldsymbol{x}^{\top})\tag{21}\end{equation}</p>
<p>åˆ©ç”¨è¿¹çš„å¾ªç¯æ€§è´¨:$\text{tr}(\boldsymbol{ABC}) = \text{tr}(\boldsymbol{CAB})$ã€‚</p>
<p>è§‚å¯Ÿåˆ°$\nabla_{\boldsymbol{W}^{(1)}}f = \boldsymbol{\delta}^{(2)}\boldsymbol{x}^{\top}$,æ‰€ä»¥:
\begin{equation}\boldsymbol{x}^{\top}\nabla_{\boldsymbol{x}}f = \text{tr}((\boldsymbol{W}^{(1)})^{\top}\nabla_{\boldsymbol{W}^{(1)}}f)\tag{22}\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: è¾“å…¥æ¢¯åº¦å’Œæƒé‡æ¢¯åº¦é€šè¿‡æƒé‡çŸ©é˜µçº¿æ€§ç›¸å…³ã€‚</p>
<h4 id="34">3.4 èŒƒæ•°ç•Œæ¨å¯¼</h4>
<p>ä»å¼(20),åº”ç”¨Cauchy-Schwarzä¸ç­‰å¼:
\begin{equation}|\nabla_{\boldsymbol{x}}f|_2 = |(\boldsymbol{W}^{(1)})^{\top}\boldsymbol{\delta}^{(2)}|_2 \leq |(\boldsymbol{W}^{(1)})^{\top}|_2|\boldsymbol{\delta}^{(2)}|_2 = |\boldsymbol{W}^{(1)}|_2|\boldsymbol{\delta}^{(2)}|_2\tag{23}\end{equation}</p>
<p>å…¶ä¸­ç”¨äº†$|(\boldsymbol{W}^{(1)})^{\top}|_2 = |\boldsymbol{W}^{(1)}|_2$(è°±èŒƒæ•°çš„æ€§è´¨)ã€‚</p>
<p>ä»å¼(19):
\begin{equation}|\nabla_{\boldsymbol{W}^{(1)}}f|_F = |\boldsymbol{\delta}^{(2)}\boldsymbol{x}^{\top}|_F = |\boldsymbol{\delta}^{(2)}|_2|\boldsymbol{x}|_2\tag{24}\end{equation}</p>
<p>åˆ©ç”¨ç§©1çŸ©é˜µçš„æ€§è´¨:$|\boldsymbol{uv}^{\top}|_F = |\boldsymbol{u}|_2|\boldsymbol{v}|_2$ã€‚</p>
<p>ç”±äº$|\boldsymbol{uv}^{\top}|<em _boldsymbol_W="\boldsymbol{W">2 = |\boldsymbol{u}|_2|\boldsymbol{v}|_2$(ç§©1çŸ©é˜µ),æˆ‘ä»¬æœ‰:
\begin{equation}|\nabla</em>}^{(1)}}f|_2 = |\boldsymbol{\delta}^{(2)}|_2|\boldsymbol{x}|_2\tag{25}\end{equation</p>
<p>ç»“åˆå¼(23)å’Œ(25):
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_W="\boldsymbol{W">2 \leq |\boldsymbol{W}^{(1)}|_2\frac{|\nabla</em>}^{(1)}}f|_2}{|\boldsymbol{x}|_2}\tag{26}\end{equation</p>
<p>æ”¹å†™ä¸º:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_W="\boldsymbol{W">2 |\boldsymbol{x}|_2 \leq |\boldsymbol{W}^{(1)}|_2|\nabla</em>}^{(1)}}f|_2\tag{27}\end{equation</p>
<p>è¿›ä¸€æ­¥:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_W="\boldsymbol{W">2^2 \frac{|\boldsymbol{x}|_2^2}{|\boldsymbol{W}^{(1)}|_2^2} \leq |\nabla</em>}^{(1)}}f|_2^2\tag{28}\end{equation</p>
<h4 id="35">3.5 åŠ å…¥åç½®é¡¹</h4>
<p>å¯¹äºåç½®$\boldsymbol{b}^{(1)}$:
\begin{equation}\nabla_{\boldsymbol{b}^{(1)}}f = \boldsymbol{\delta}^{(2)}\tag{29}\end{equation}</p>
<p>å› æ­¤:
\begin{equation}|\nabla_{\boldsymbol{b}^{(1)}}f|_2 = |\boldsymbol{\delta}^{(2)}|_2\tag{30}\end{equation}</p>
<p>ä»å¼(23):
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_b="\boldsymbol{b">2 \leq |\boldsymbol{W}^{(1)}|_2|\nabla</em>}^{(1)}}f|_2\tag{31}\end{equation</p>
<p>æ”¹å†™ä¸º:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_b="\boldsymbol{b">2^2 \frac{1}{|\boldsymbol{W}^{(1)}|_2^2} \leq |\nabla</em>}^{(1)}}f|_2^2\tag{32}\end{equation</p>
<h4 id="36-jacobian">3.6 JacobianèŒƒæ•°çš„åˆ©ç”¨</h4>
<p>å®šä¹‰:
\begin{equation}|\nabla_{\boldsymbol{x}}\boldsymbol{h}^{(t)}|<em _boldsymbol_x="\boldsymbol{x">2 = |\boldsymbol{J}</em>}}^{(t)}|_2\tag{33}\end{equation</p>
<p>å¯¹äºå•å±‚:
\begin{equation}\boldsymbol{J}_{\boldsymbol{x}}^{(2)} = \boldsymbol{D}^{(2)}\boldsymbol{W}^{(1)}\tag{34}\end{equation}</p>
<p>è°±èŒƒæ•°:
\begin{equation}|\boldsymbol{J}_{\boldsymbol{x}}^{(2)}|_2 = |\boldsymbol{D}^{(2)}\boldsymbol{W}^{(1)}|_2 \leq |\boldsymbol{D}^{(2)}|_2|\boldsymbol{W}^{(1)}|_2\tag{35}\end{equation}</p>
<p>å¯¹äºReLUç­‰1-Lipschitzæ¿€æ´»å‡½æ•°,$|\boldsymbol{D}^{(2)}|<em _boldsymbol_x="\boldsymbol{x">2 \leq 1$,å› æ­¤:
\begin{equation}|\boldsymbol{J}</em>}}^{(2)}|_2 \leq |\boldsymbol{W}^{(1)}|_2\tag{36}\end{equation</p>
<p>è¿™ç»™å‡ºäº†JacobianèŒƒæ•°çš„ä¸Šç•Œã€‚</p>
<h3 id="4">4. å¤šå±‚ç½‘ç»œçš„å®Œæ•´æ¨å¯¼</h3>
<h4 id="41">4.1 å¤šå±‚é€’æ¨</h4>
<p>å¯¹äº$l$å±‚ç½‘ç»œ,è€ƒè™‘ç¬¬$t$å±‚ã€‚ä»å¼(3)çš„é€’æ¨:
\begin{equation}\nabla_{\boldsymbol{h}^{(t)}}f = (\boldsymbol{W}^{(t)})^{\top}\boldsymbol{D}^{(t+1)}\nabla_{\boldsymbol{h}^{(t+1)}}f\tag{37}\end{equation}</p>
<p>æƒé‡æ¢¯åº¦:
\begin{equation}\nabla_{\boldsymbol{W}^{(t)}}f = (\boldsymbol{D}^{(t+1)}\nabla_{\boldsymbol{h}^{(t+1)}}f)(\boldsymbol{h}^{(t)})^{\top}\tag{38}\end{equation}</p>
<p>è®°$\boldsymbol{\delta}^{(t+1)} = \boldsymbol{D}^{(t+1)}\nabla_{\boldsymbol{h}^{(t+1)}}f$,åˆ™:
\begin{equation}\nabla_{\boldsymbol{h}^{(t)}}f = (\boldsymbol{W}^{(t)})^{\top}\boldsymbol{\delta}^{(t+1)}, \quad \nabla_{\boldsymbol{W}^{(t)}}f = \boldsymbol{\delta}^{(t+1)}(\boldsymbol{h}^{(t)})^{\top}\tag{39}\end{equation}</p>
<p>ç±»ä¼¼äºå•å±‚æƒ…å†µçš„æ¨å¯¼:
\begin{equation}|\nabla_{\boldsymbol{h}^{(t)}}f|<em _boldsymbol_W="\boldsymbol{W">2^2\frac{|\boldsymbol{h}^{(t)}|_2^2}{|\boldsymbol{W}^{(t)}|_2^2} \leq |\nabla</em>}^{(t)}}f|_2^2\tag{40}\end{equation</p>
<h4 id="42">4.2 é“¾å¼ä¼ æ’­</h4>
<p>ä»è¾“å…¥åˆ°ç¬¬$t$å±‚:
\begin{equation}\nabla_{\boldsymbol{x}}f = (\boldsymbol{J}<em _boldsymbol_h="\boldsymbol{h">{\boldsymbol{x}}^{(t)})^{\top}\nabla</em>}^{(t)}}f\tag{41}\end{equation</p>
<p>åº”ç”¨Cauchy-Schwarz:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_x="\boldsymbol{x">2 \leq |\boldsymbol{J}</em>|}}^{(t)<em _boldsymbol_h="\boldsymbol{h">2|\nabla</em>}^{(t)}}f|_2\tag{42}\end{equation</p>
<p>ç»“åˆå¼(40):
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_x="\boldsymbol{x">2^2 \leq |\boldsymbol{J}</em>|}}^{(t)<em _boldsymbol_h="\boldsymbol{h">2^2|\nabla</em>f|}^{(t)}<em _boldsymbol_x="\boldsymbol{x">2^2 \leq |\boldsymbol{J}</em>|}}^{(t)<em _boldsymbol_W="\boldsymbol{W">2^2\frac{|\boldsymbol{W}^{(t)}|_2^2}{|\boldsymbol{h}^{(t)}|_2^2}|\nabla</em>}^{(t)}}f|_2^2\tag{43}\end{equation</p>
<p>æ”¹å†™ä¸º:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_x="\boldsymbol{x">2^2\frac{|\boldsymbol{h}^{(t)}|_2^2}{|\boldsymbol{W}^{(t)}|_2^2|\boldsymbol{J}</em>|}}^{(t)<em _boldsymbol_W="\boldsymbol{W">2^2} \leq |\nabla</em>}^{(t)}}f|_2^2\tag{44}\end{equation</p>
<h4 id="43-1-boldsymbolht2">4.3 å¼•å…¥$1 + |\boldsymbol{h}^{(t)}|^2$é¡¹</h4>
<p>ä¸ºäº†å¾—åˆ°åŸè®ºæ–‡çš„å½¢å¼,æˆ‘ä»¬åˆ©ç”¨:
\begin{equation}1 + |\boldsymbol{h}^{(t)}|_2^2 \geq |\boldsymbol{h}^{(t)}|_2^2\tag{45}\end{equation}</p>
<p>å› æ­¤:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_x="\boldsymbol{x">2^2\frac{1 + |\boldsymbol{h}^{(t)}|_2^2}{|\boldsymbol{W}^{(t)}|_2^2|\boldsymbol{J}</em>|}}^{(t)<em _boldsymbol_x="\boldsymbol{x">2^2} \geq |\nabla</em>f|}<em _boldsymbol_x="\boldsymbol{x">2^2\frac{|\boldsymbol{h}^{(t)}|_2^2}{|\boldsymbol{W}^{(t)}|_2^2|\boldsymbol{J}</em>}}^{(t)}|_2^2}\tag{46}\end{equation</p>
<p>è™½ç„¶è¿™çœ‹ä¼¼æ˜¯åå‘çš„ä¸ç­‰å¼,ä½†$1 + |\boldsymbol{h}^{(t)}|_2^2$é¡¹å®é™…ä¸ŠåŒæ—¶åŒ…å«äº†å¯¹$\boldsymbol{W}^{(t)}$å’Œ$\boldsymbol{b}^{(t)}$çš„è´¡çŒ®ã€‚</p>
<p>æ›´ç²¾ç¡®åœ°,è€ƒè™‘åˆ°åç½®é¡¹çš„è´¡çŒ®:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_x="\boldsymbol{x">2^2\left(\frac{|\boldsymbol{h}^{(t)}|_2^2}{|\boldsymbol{W}^{(t)}|_2^2|\boldsymbol{J}</em>|}}^{(t)<em _boldsymbol_x="\boldsymbol{x">2^2} + \frac{1}{|\boldsymbol{W}^{(t)}|_2^2|\boldsymbol{J}</em>|}}^{(t)<em _boldsymbol_W="\boldsymbol{W">2^2}\right) \leq |\nabla</em>f|}^{(t)}<em _boldsymbol_b="\boldsymbol{b">2^2 + |\nabla</em>}^{(t)}}f|_2^2\tag{47}\end{equation</p>
<p>ç®€åŒ–ä¸º:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_x="\boldsymbol{x">2^2\frac{1 + |\boldsymbol{h}^{(t)}|_2^2}{|\boldsymbol{W}^{(t)}|_2^2|\nabla</em>|}}\boldsymbol{h}^{(t)<em _boldsymbol_theta="\boldsymbol{\theta">2^2} \leq |\nabla</em>}^{(t)}}f|_2^2\tag{48}\end{equation</p>
<p>å…¶ä¸­$\boldsymbol{\theta}^{(t)} = (\boldsymbol{W}^{(t)}, \boldsymbol{b}^{(t)})$æ˜¯ç¬¬$t$å±‚çš„æ‰€æœ‰å‚æ•°ã€‚</p>
<h4 id="44">4.4 æ±‚å’Œå¾—åˆ°æœ€ç»ˆä¸ç­‰å¼</h4>
<p>å¯¹æ‰€æœ‰å±‚$t=1,\ldots,l$æ±‚å’Œ:
\begin{equation}\sum_{t=1}^l |\nabla_{\boldsymbol{x}}f|<em _boldsymbol_x="\boldsymbol{x">2^2\frac{1 + |\boldsymbol{h}^{(t)}|_2^2}{|\boldsymbol{W}^{(t)}|_2^2|\nabla</em>|}}\boldsymbol{h}^{(t)<em t="1">2^2} \leq \sum</em>f|}^l |\nabla_{\boldsymbol{\theta}^{(t)}<em _boldsymbol_theta="\boldsymbol{\theta">2^2 = |\nabla</em>}}f|_2^2\tag{49}\end{equation</p>
<p>è¿™å°±æ˜¯åŸè®ºæ–‡ä¸­çš„æ ¸å¿ƒä¸ç­‰å¼ã€‚</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: å‚æ•°æ¢¯åº¦æƒ©ç½š$|\nabla_{\boldsymbol{\theta}}f|<em _boldsymbol_x="\boldsymbol{x">2^2$éšå¼åœ°åŒ…å«äº†è¾“å…¥æ¢¯åº¦æƒ©ç½š$|\nabla</em>f|_2^2$,æƒé‡ç³»æ•°å–å†³äºç½‘ç»œç»“æ„(æƒé‡è°±èŒƒæ•°ã€æ¿€æ´»å€¼ã€JacobianèŒƒæ•°)ã€‚}</p>
<h3 id="5-jacobian">5. JacobianèŒƒæ•°çš„æ·±å…¥åˆ†æ</h3>
<h4 id="51-jacobian">5.1 JacobianèŒƒæ•°çš„ä¹˜ç§¯å½¢å¼</h4>
<p>ä»å¼(7):
\begin{equation}\boldsymbol{J}<em t="1">{\boldsymbol{x}}^{(l+1)} = \prod</em>}^l \boldsymbol{D}^{(t+1)}\boldsymbol{W}^{(t)}\tag{50}\end{equation</p>
<p>è°±èŒƒæ•°:
\begin{equation}|\boldsymbol{J}<em t="1">{\boldsymbol{x}}^{(l+1)}|_2 \leq \prod</em>}^l |\boldsymbol{D}^{(t+1)}|_2|\boldsymbol{W}^{(t)}|_2\tag{51}\end{equation</p>
<p>å¯¹äº1-Lipschitzæ¿€æ´»å‡½æ•°(å¦‚ReLU):
\begin{equation}|\boldsymbol{J}<em t="1">{\boldsymbol{x}}^{(l+1)}|_2 \leq \prod</em>}^l |\boldsymbol{W}^{(t)}|_2\tag{52}\end{equation</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: JacobianèŒƒæ•°æ˜¯æ‰€æœ‰å±‚æƒé‡è°±èŒƒæ•°çš„ä¹˜ç§¯ä¸Šç•Œã€‚æ·±åº¦ç½‘ç»œå®¹æ˜“å‡ºç°æ¢¯åº¦çˆ†ç‚¸(è°±èŒƒæ•°&gt;1)æˆ–æ¶ˆå¤±(è°±èŒƒæ•°&lt;1)ã€‚</p>
<h4 id="52">5.2 æ¢¯åº¦æ¶ˆå¤±ä¸çˆ†ç‚¸</h4>
<p><strong>æ¢¯åº¦æ¶ˆå¤±</strong>: è‹¥æ‰€æœ‰$|\boldsymbol{W}^{(t)}|<em _boldsymbol_x="\boldsymbol{x">2 &lt; 1$,åˆ™:
\begin{equation}|\boldsymbol{J}</em>|}}^{(l+1)<em t="1">2 \leq \prod</em>}^l |\boldsymbol{W}^{(t)}|_2 &lt; 1^l = 1\tag{53}\end{equation</p>
<p>éšç€$l$å¢å¤§,JacobianèŒƒæ•°æŒ‡æ•°è¡°å‡,$|\nabla_{\boldsymbol{x}}f|_2 \to 0$ã€‚</p>
<p><strong>æ¢¯åº¦çˆ†ç‚¸</strong>: è‹¥æ‰€æœ‰$|\boldsymbol{W}^{(t)}|<em _boldsymbol_x="\boldsymbol{x">2 &gt; 1$,åˆ™:
\begin{equation}|\boldsymbol{J}</em>|}}^{(l+1)<em t="1">2 \geq \prod</em>}^l |\boldsymbol{W}^{(t)}|_2 &gt; 1^l = 1\tag{54}\end{equation</p>
<p>JacobianèŒƒæ•°æŒ‡æ•°å¢é•¿,$|\nabla_{\boldsymbol{x}}f|_2 \to \infty$ã€‚</p>
<p><strong>ç†æƒ³æƒ…å†µ</strong>: $|\boldsymbol{W}^{(t)}|_2 \approx 1$,ä¿æŒJacobianèŒƒæ•°ç¨³å®šã€‚</p>
<h4 id="53">5.3 è°±å½’ä¸€åŒ–</h4>
<p><strong>è°±å½’ä¸€åŒ–</strong>(Spectral Normalization)å¼ºåˆ¶çº¦æŸ:
\begin{equation}\bar{\boldsymbol{W}}^{(t)} = \frac{\boldsymbol{W}^{(t)}}{|\boldsymbol{W}^{(t)}|_2}\tag{55}\end{equation}</p>
<p>ä½¿å¾—$|\bar{\boldsymbol{W}}^{(t)}|<em _boldsymbol_x="\boldsymbol{x">2 = 1$,ä»è€Œ:
\begin{equation}|\boldsymbol{J}</em>}}^{(l+1)}|_2 \leq 1\tag{56}\end{equation</p>
<p>ä¿è¯Lipschitzå¸¸æ•°$\leq 1$,é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ã€‚</p>
<p><strong>è®¡ç®—</strong>: é€šè¿‡å¹‚è¿­ä»£æ³•è¿‘ä¼¼è®¡ç®—$\sigma_{\max}(\boldsymbol{W}^{(t)})$:
\begin{equation}\boldsymbol{v}<em k_1="k+1">{k+1} = \frac{\boldsymbol{W}^{\top}\boldsymbol{u}_k}{|\boldsymbol{W}^{\top}\boldsymbol{u}_k|_2}, \quad \boldsymbol{u}</em>} = \frac{\boldsymbol{W}\boldsymbol{v<em k_1="k+1">{k+1}}{|\boldsymbol{W}\boldsymbol{v}</em>}|_2}\tag{57}\end{equation</p>
<p>æ”¶æ•›å,$|\boldsymbol{W}|_2 \approx |\boldsymbol{W}\boldsymbol{v}_k|_2$ã€‚</p>
<h3 id="6">6. æ³›åŒ–æ€§ä¸æ­£åˆ™åŒ–çš„è”ç³»</h3>
<h4 id="61">6.1 è¾“å…¥æ¢¯åº¦æƒ©ç½šä¸å¹³æ»‘æ€§</h4>
<p><strong>å®šä¹‰</strong>: å‡½æ•°$f(\boldsymbol{x};\boldsymbol{\theta})$çš„Lipschitzå¸¸æ•°:
\begin{equation}L_f = \max_{\boldsymbol{x}}|\nabla_{\boldsymbol{x}}f(\boldsymbol{x};\boldsymbol{\theta})|_2\tag{58}\end{equation}</p>
<p>æ»¡è¶³:
\begin{equation}|f(\boldsymbol{x}_1;\boldsymbol{\theta}) - f(\boldsymbol{x}_2;\boldsymbol{\theta})| \leq L_f|\boldsymbol{x}_1 - \boldsymbol{x}_2|_2\tag{59}\end{equation}</p>
<p><strong>å¹³æ»‘æ€§</strong>: å°çš„$|\nabla_{\boldsymbol{x}}f|_2$æ„å‘³ç€å‡½æ•°å¯¹è¾“å…¥æ‰°åŠ¨ä¸æ•æ„Ÿ,æœ‰åŠ©äºæ³›åŒ–ã€‚</p>
<p><strong>è¾“å…¥æ¢¯åº¦æƒ©ç½š</strong>:
\begin{equation}\mathcal{L}<em task="task">{GP} = \mathcal{L}</em>} + \lambda\mathbb{E<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{x}}[|\nabla</em>}}f(\boldsymbol{x};\boldsymbol{\theta})|_2^2]\tag{60}\end{equation</p>
<p>é¼“åŠ±å­¦ä¹ å¹³æ»‘å‡½æ•°,æé«˜é²æ£’æ€§ã€‚</p>
<h4 id="62-sgd">6.2 å‚æ•°æ¢¯åº¦æƒ©ç½šä¸SGDéšå¼æ­£åˆ™</h4>
<p>åœ¨<a href="https://arxiv.org/abs/1905.13361">ã€ŠImplicit Gradient Regularizationã€‹</a>ä¸­è¯æ˜,SGDéšå¼åœ°æœ€å°åŒ–:
\begin{equation}\mathcal{L}<em task="task">{impl} = \mathcal{L}</em>} + \frac{\eta}{4}\mathbb{E}[|\nabla_{\boldsymbol{\theta}}\mathcal{L}|_2^2]\tag{61}\end{equation</p>
<p>å…¶ä¸­$\eta$æ˜¯å­¦ä¹ ç‡ã€‚</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>: SGDçš„éšæœºæ€§å¼•å…¥çš„å™ªå£°ç­‰ä»·äºå¯¹å‚æ•°æ¢¯åº¦çš„æƒ©ç½š,åå¥½å¹³å¦çš„æœ€å°å€¼ã€‚</p>
<h4 id="63">6.3 æ ¸å¿ƒä¸ç­‰å¼çš„æ„ä¹‰</h4>
<p>ç»“åˆå¼(49):
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_theta="\boldsymbol{\theta">2^2 \lesssim |\nabla</em>}}f|_2^2\tag{62}\end{equation</p>
<p>(å¿½ç•¥ç»“æ„ç›¸å…³çš„ç³»æ•°)ã€‚</p>
<p>è¿™æ„å‘³ç€:
- SGDéšå¼åœ°æƒ©ç½š$|\nabla_{\boldsymbol{\theta}}f|<em _boldsymbol_x="\boldsymbol{x">2^2$(å¼61)
- é€šè¿‡ä¸ç­‰å¼(62),è¿™éšå¼åœ°æƒ©ç½š$|\nabla</em>f|_2^2$
- å› æ­¤SGDéšå¼åœ°é¼“åŠ±å­¦ä¹ å¹³æ»‘å‡½æ•°,æé«˜æ³›åŒ–æ€§}</p>
<p><strong>ç†è®ºé“¾æ¡</strong>:
\begin{equation}\text{SGD} \xrightarrow{\text{éšå¼æ­£åˆ™}} |\nabla_{\boldsymbol{\theta}}f|<em _boldsymbol_x="\boldsymbol{x">2^2\text{å°} \xrightarrow{\text{æ ¸å¿ƒä¸ç­‰å¼}} |\nabla</em>}}f|_2^2\text{å°} \xrightarrow{\text{Lipschitz}} \text{æ³›åŒ–æ€§å¥½}\tag{63}\end{equation</p>
<h3 id="7">7. åº”ç”¨åœºæ™¯</h3>
<h4 id="71">7.1 å¯¹æŠ—è®­ç»ƒ</h4>
<p><strong>FGSMæ”»å‡»</strong>:
\begin{equation}\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">{adv} = \boldsymbol{x} + \epsilon\cdot\text{sign}(\nabla</em>}}\mathcal{L}(f(\boldsymbol{x}), y))\tag{64}\end{equation</p>
<p>æ”»å‡»å¼ºåº¦å–å†³äº$|\nabla_{\boldsymbol{x}}\mathcal{L}|_2$ã€‚</p>
<p><strong>æ¢¯åº¦æƒ©ç½šé˜²å¾¡</strong>: æœ€å°åŒ–
\begin{equation}\mathcal{L}<em task="task">{robust} = \mathcal{L}</em>} + \lambda|\nabla_{\boldsymbol{x}}\mathcal{L}|_2^2\tag{65}\end{equation</p>
<p>ç›´æ¥å‡å°è¾“å…¥æ¢¯åº¦,é™ä½å¯¹æŠ—æ ·æœ¬çš„æœ‰æ•ˆæ€§ã€‚</p>
<p>æ ¹æ®æ ¸å¿ƒä¸ç­‰å¼,ä¹Ÿå¯ä»¥é€šè¿‡å‚æ•°æ¢¯åº¦æƒ©ç½šé—´æ¥å®ç°:
\begin{equation}\mathcal{L}<em task="task">{robust}' = \mathcal{L}</em>} + \mu|\nabla_{\boldsymbol{\theta}}\mathcal{L}|_2^2\tag{66}\end{equation</p>
<h4 id="72-gan">7.2 ç”Ÿæˆå¯¹æŠ—ç½‘ç»œ(GAN)</h4>
<p><strong>åˆ¤åˆ«å™¨Lipschitzçº¦æŸ</strong>: WGAN-GPè¦æ±‚åˆ¤åˆ«å™¨$D$æ˜¯1-Lipschitz:
\begin{equation}|D(\boldsymbol{x}_1) - D(\boldsymbol{x}_2)| \leq |\boldsymbol{x}_1 - \boldsymbol{x}_2|_2\tag{67}\end{equation}</p>
<p><strong>æ¢¯åº¦æƒ©ç½šå®ç°</strong>:
\begin{equation}\mathcal{L}<em _hat_boldsymbol_x="\hat{\boldsymbol{x">{GP} = \mathbb{E}</em>}}}[(|\nabla_{\boldsymbol{x}}D(\hat{\boldsymbol{x}})|_2 - 1)^2]\tag{68}\end{equation</p>
<p>å…¶ä¸­$\hat{\boldsymbol{x}} = \alpha\boldsymbol{x}<em fake="fake">{real} + (1-\alpha)\boldsymbol{x}</em>$ã€‚</p>
<p><strong>è°±å½’ä¸€åŒ–æ›¿ä»£</strong>: é€šè¿‡çº¦æŸ$|\boldsymbol{W}^{(t)}|<em _boldsymbol_x="\boldsymbol{x">2 = 1$,åˆ©ç”¨å¼(52)ä¿è¯:
\begin{equation}|\nabla</em>}}D(\boldsymbol{x})|_2 \leq 1\tag{69}\end{equation</p>
<p>è®¡ç®—æ•ˆç‡æ›´é«˜,ä¸éœ€è¦åå‘ä¼ æ’­è®¡ç®—è¾“å…¥æ¢¯åº¦ã€‚</p>
<h4 id="73-ode">7.3 ç¥ç»ODE</h4>
<p><strong>ç¥ç»ODEå®šä¹‰</strong>:
\begin{equation}\frac{d\boldsymbol{h}(t)}{dt} = f(\boldsymbol{h}(t), t; \boldsymbol{\theta})\tag{70}\end{equation}</p>
<p><strong>Lipschitzæ¡ä»¶ä¿è¯å­˜åœ¨å”¯ä¸€è§£</strong>:
\begin{equation}|\nabla_{\boldsymbol{h}}f(\boldsymbol{h}, t; \boldsymbol{\theta})|_2 \leq L\tag{71}\end{equation}</p>
<p>é€šè¿‡æ ¸å¿ƒä¸ç­‰å¼,å¯ä»¥ç”¨å‚æ•°æ¢¯åº¦æƒ©ç½šé—´æ¥æ§åˆ¶:
\begin{equation}|\nabla_{\boldsymbol{\theta}}f|<em _boldsymbol_h="\boldsymbol{h">2^2 \text{å°} \Rightarrow |\nabla</em>}}f|_2^2 \text{å°}\tag{72}\end{equation</p>
<h3 id="8">8. æ•°å€¼éªŒè¯</h3>
<h4 id="81-mlp">8.1 ç®€å•MLPå®éªŒ</h4>
<p><strong>è®¾ç½®</strong>: 2å±‚MLP,$\boldsymbol{h}^{(2)} = \text{ReLU}(\boldsymbol{W}^{(1)}\boldsymbol{x})$,$f = \boldsymbol{w}^{\top}\boldsymbol{h}^{(2)}$ã€‚</p>
<p><strong>å‚æ•°</strong>:
- $\boldsymbol{x} \in \mathbb{R}^{10}$,ä»$\mathcal{N}(0, \boldsymbol{I})$é‡‡æ ·
- $\boldsymbol{W}^{(1)} \in \mathbb{R}^{20 \times 10}$,è°±èŒƒæ•°$\sigma_1 = 2$
- $\boldsymbol{w} \in \mathbb{R}^{20}$</p>
<p><strong>æµ‹é‡</strong>:
1. $|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_W="\boldsymbol{W">2 = 0.85$
2. $|\nabla</em>f|}^{(1)}<em _boldsymbol_x="\boldsymbol{x">2 = 1.42$
3. $|\boldsymbol{x}|_2 = 3.16$
4. $|\boldsymbol{h}^{(1)}|_2 = 3.16$(=$|\boldsymbol{x}|_2$)
5. $|\nabla</em>|_2 = 1$(è¾“å…¥å±‚Jacobian)}}\boldsymbol{h}^{(1)</p>
<p><strong>éªŒè¯ä¸ç­‰å¼</strong>(å¼48,å•å±‚):
\begin{equation}LHS = 0.85^2 \cdot \frac{1 + 3.16^2}{2^2 \cdot 1^2} = 0.72 \cdot \frac{11}{4} = 1.98\tag{73}\end{equation}
\begin{equation}RHS = 1.42^2 = 2.02\tag{74}\end{equation}</p>
<p>$LHS \approx RHS$,ä¸ç­‰å¼æˆç«‹(è€ƒè™‘æ•°å€¼è¯¯å·®)ã€‚</p>
<h4 id="82">8.2 æ·±åº¦ç½‘ç»œå®éªŒ</h4>
<p><strong>è®¾ç½®</strong>: 5å±‚å…¨è¿æ¥ç½‘ç»œ,æ¯å±‚128ç»´,ReLUæ¿€æ´»ã€‚</p>
<p><strong>æƒé‡åˆå§‹åŒ–</strong>: Xavieråˆå§‹åŒ–,ä½¿$|\boldsymbol{W}^{(t)}|_2 \approx 1$ã€‚</p>
<p><strong>æµ‹é‡</strong>:
| å±‚ | $|\nabla_{\boldsymbol{W}^{(t)}}f|<em _boldsymbol_x="\boldsymbol{x">2$ | $|\nabla</em>|_2$ |
|----|-------|----------|
| 1 | 0.52 | 1.00 |
| 2 | 0.48 | 0.98 |
| 3 | 0.51 | 0.95 |
| 4 | 0.47 | 0.93 |
| 5 | 0.50 | 0.91 |}}\boldsymbol{h}^{(t)</p>
<p><strong>æ€»æ¢¯åº¦</strong>: $|\nabla_{\boldsymbol{\theta}}f|<em _boldsymbol_W="\boldsymbol{W">2 = \sqrt{\sum_t |\nabla</em> = 1.12$}^{(t)}}f|_2^2</p>
<p><strong>è¾“å…¥æ¢¯åº¦</strong>: $|\nabla_{\boldsymbol{x}}f|_2 = 0.34$</p>
<p><strong>ä¸ç­‰å¼éªŒè¯</strong>(ç®€åŒ–ç‰ˆ,å¿½ç•¥ç³»æ•°):
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em _boldsymbol_theta="\boldsymbol{\theta">2 = 0.34 \ll |\nabla</em>}}f|_2 = 1.12\tag{75}\end{equation</p>
<p>ä¸ç­‰å¼æˆç«‹,å‚æ•°æ¢¯åº¦æ˜¾è‘—å¤§äºè¾“å…¥æ¢¯åº¦ã€‚</p>
<h3 id="9">9. ç†è®ºæ‰©å±•ä¸æ¨å¹¿</h3>
<h4 id="91">9.1 ä¸åŒç½‘ç»œæ¶æ„</h4>
<p><strong>å·ç§¯ç¥ç»ç½‘ç»œ</strong>: æƒé‡å…±äº«,ä¸ç­‰å¼éœ€è¦è°ƒæ•´:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em params="params">2^2\frac{1}{|\boldsymbol{W}|_2^2} \lesssim n</em>}|\nabla_{\boldsymbol{W}}f|_2^2\tag{76}\end{equation</p>
<p>å…¶ä¸­$n_{params}$æ˜¯å‚æ•°å…±äº«å¯¼è‡´çš„å€å¢å› å­ã€‚</p>
<p><strong>æ®‹å·®ç½‘ç»œ</strong>: è·³è·ƒè¿æ¥æ”¹å˜Jacobian:
\begin{equation}\boldsymbol{J}<em standard="standard">{residual} = \boldsymbol{I} + \boldsymbol{J}</em>}\tag{77}\end{equation</p>
<p>è°±èŒƒæ•°:
\begin{equation}|\boldsymbol{J}_{residual}|_2 \geq 1\tag{78}\end{equation}</p>
<p>å³ä½¿$|\boldsymbol{W}|_2 &lt; 1$,æ®‹å·®è¿æ¥ä¹Ÿèƒ½ä¿æŒæ¢¯åº¦æµåŠ¨ã€‚</p>
<p><strong>Transformer</strong>: æ³¨æ„åŠ›æœºåˆ¶å¼•å…¥æ•°æ®ä¾èµ–çš„Jacobian:
\begin{equation}\boldsymbol{J}<em _boldsymbol_x="\boldsymbol{x">{attn}(\boldsymbol{x}) = \nabla</em>}}[\text{softmax}(\boldsymbol{QK}^{\top})\boldsymbol{V}]\tag{79}\end{equation</p>
<p>ä¸ç­‰å¼ä»æˆç«‹,ä½†ç³»æ•°ä¸è¾“å…¥ç›¸å…³ã€‚</p>
<h4 id="92">9.2 éšæœºæ¢¯åº¦æƒ…å†µ</h4>
<p>å¯¹äºmini-batchè®­ç»ƒ,æ¢¯åº¦æ˜¯éšæœºå˜é‡:
\begin{equation}\mathbb{E}[|\tilde{\nabla}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{x}}f|_2^2] \leq C\cdot\mathbb{E}[|\tilde{\nabla}</em>}}f|_2^2]\tag{80}\end{equation</p>
<p>å…¶ä¸­$\tilde{\nabla}$è¡¨ç¤ºåŸºäºmini-batchçš„æ¢¯åº¦ä¼°è®¡ã€‚</p>
<p><strong>æ–¹å·®å…³ç³»</strong>:
\begin{equation}\text{Var}[\tilde{\nabla}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{x}}f] \lesssim \text{Var}[\tilde{\nabla}</em>}}f]\tag{81}\end{equation</p>
<p>å‚æ•°æ¢¯åº¦æ–¹å·®ä¹Ÿæ§åˆ¶è¾“å…¥æ¢¯åº¦æ–¹å·®ã€‚</p>
<h4 id="93">9.3 é«˜é˜¶æ¢¯åº¦</h4>
<p><strong>Hessian-å‘é‡ç§¯</strong>:
\begin{equation}\nabla_{\boldsymbol{x}}^2 f \cdot \boldsymbol{v} = \nabla_{\boldsymbol{x}}(\nabla_{\boldsymbol{x}}f \cdot \boldsymbol{v})\tag{82}\end{equation}</p>
<p>ç±»ä¼¼çš„ä¸ç­‰å¼:
\begin{equation}|\nabla_{\boldsymbol{x}}^2 f|<em _boldsymbol_theta="\boldsymbol{\theta">2^2 \lesssim |\nabla</em>}}^2 f|_2^2\tag{83}\end{equation</p>
<p>äºŒé˜¶å¹³æ»‘æ€§ä¹Ÿå—å‚æ•°æ¢¯åº¦å½±å“ã€‚</p>
<h3 id="10">10. å®è·µå»ºè®®</h3>
<h4 id="101">10.1 ç›‘æ§æŒ‡æ ‡</h4>
<p><strong>è®­ç»ƒæ—¶åº”ç›‘æ§</strong>:
1. å‚æ•°æ¢¯åº¦èŒƒæ•°: $|\nabla_{\boldsymbol{\theta}}\mathcal{L}|<em _boldsymbol_x="\boldsymbol{x">2$
2. è¾“å…¥æ¢¯åº¦èŒƒæ•°: $|\nabla</em>|}}\mathcal{L<em _boldsymbol_x="\boldsymbol{x">2$
3. æƒé‡è°±èŒƒæ•°: $|\boldsymbol{W}^{(t)}|_2$
4. JacobianèŒƒæ•°ä¼°è®¡: $|\boldsymbol{J}</em>|_2$}}^{(t)</p>
<p><strong>å¼‚å¸¸è¯Šæ–­</strong>:
- $|\nabla_{\boldsymbol{\theta}}\mathcal{L}|<em _boldsymbol_x="\boldsymbol{x">2$è¿‡å¤§: é™ä½å­¦ä¹ ç‡æˆ–æ¢¯åº¦è£å‰ª
- $|\nabla</em>|_2$è¿‡å¤§: æ¨¡å‹å¯¹è¾“å…¥è¿‡æ•,è€ƒè™‘æ­£åˆ™åŒ–
- $|\boldsymbol{W}^{(t)}|_2$ä¸ç¨³å®š: ä½¿ç”¨è°±å½’ä¸€åŒ–æˆ–æƒé‡è¡°å‡}}\mathcal{L</p>
<h4 id="102">10.2 æ­£åˆ™åŒ–ç­–ç•¥</h4>
<p><strong>æ˜¾å¼è¾“å…¥æ¢¯åº¦æƒ©ç½š</strong>:
\begin{equation}\mathcal{L} = \mathcal{L}<em _boldsymbol_x="\boldsymbol{x">{task} + \lambda|\nabla</em>}}\mathcal{L}_{task}|_2^2\tag{84}\end{equation</p>
<p><strong>ä¼˜ç‚¹</strong>: ç›´æ¥æ§åˆ¶å¹³æ»‘æ€§
<strong>ç¼ºç‚¹</strong>: è®¡ç®—æˆæœ¬é«˜(éœ€è¦äºŒé˜¶å¯¼æ•°)</p>
<p><strong>æ˜¾å¼å‚æ•°æ¢¯åº¦æƒ©ç½š</strong>:
\begin{equation}\mathcal{L} = \mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">{task} + \mu|\nabla</em>}}\mathcal{L}_{task}|_2^2\tag{85}\end{equation</p>
<p><strong>ä¼˜ç‚¹</strong>: è®¡ç®—ç®€å•,é€šè¿‡æ ¸å¿ƒä¸ç­‰å¼é—´æ¥æ§åˆ¶è¾“å…¥æ¢¯åº¦
<strong>ç¼ºç‚¹</strong>: æ•ˆæœé—´æ¥,éœ€è¦è°ƒèŠ‚æƒé‡ç³»æ•°</p>
<p><strong>éšå¼æ­£åˆ™(SGD)</strong>:
- ä½¿ç”¨å°batch sizeå¢åŠ æ¢¯åº¦å™ªå£°
- é€‰æ‹©åˆé€‚å­¦ä¹ ç‡,åˆ©ç”¨å¼(61)çš„éšå¼æ­£åˆ™æ•ˆåº”</p>
<h4 id="103">10.3 è°±å½’ä¸€åŒ–å®è·µ</h4>
<p><strong>å®ç°æ­¥éª¤</strong>:
1. æ¯å±‚ç»´æŠ¤å·¦å³å¥‡å¼‚å‘é‡ä¼°è®¡$\boldsymbol{u}, \boldsymbol{v}$
2. æ¯æ¬¡å‰å‘ä¼ æ’­å‰,æ‰§è¡Œ1-3æ¬¡å¹‚è¿­ä»£æ›´æ–°$\boldsymbol{u}, \boldsymbol{v}$
3. è®¡ç®—$\sigma = \boldsymbol{u}^{\top}\boldsymbol{W}\boldsymbol{v}$
4. å½’ä¸€åŒ–:$\bar{\boldsymbol{W}} = \boldsymbol{W}/\sigma$</p>
<p><strong>ä»£ç ç¤ºä¾‹</strong>(PyTorch):</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">spectral_norm</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">num_iters</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_iters</span><span class="p">):</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">W</span><span class="o">.</span><span class="n">t</span><span class="p">()</span> <span class="o">@</span> <span class="n">u</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">W</span> <span class="o">@</span> <span class="n">v</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">sigma</span> <span class="o">=</span> <span class="n">u</span> <span class="o">@</span> <span class="n">W</span> <span class="o">@</span> <span class="n">v</span>
    <span class="k">return</span> <span class="n">W</span> <span class="o">/</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">u</span>
</code></pre></div>

<p><strong>åº”ç”¨åœºæ™¯</strong>:
- GANåˆ¤åˆ«å™¨: ä¿è¯Lipschitzçº¦æŸ
- æ·±åº¦ResNet: é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸
- å¯¹æŠ—è®­ç»ƒ: å¢å¼ºé²æ£’æ€§</p>
<h3 id="11">11. æ€»ç»“ä¸å±•æœ›</h3>
<h4 id="111">11.1 æ ¸å¿ƒç»“è®º</h4>
<p>æœ¬æ–‡æ·±å…¥æ¨å¯¼äº†è¾“å…¥æ¢¯åº¦æƒ©ç½šä¸å‚æ•°æ¢¯åº¦æƒ©ç½šçš„ä¸ç­‰å¼å…³ç³»:
\begin{equation}|\nabla_{\boldsymbol{x}}f|<em t="1">2^2\sum</em>|}^l\frac{1 + |\boldsymbol{h}^{(t)<em _boldsymbol_x="\boldsymbol{x">2^2}{|\boldsymbol{W}^{(t)}|_2^2|\nabla</em>|}}\boldsymbol{h}^{(t)<em _boldsymbol_theta="\boldsymbol{\theta">2^2} \leq |\nabla</em>}}f|_2^2\tag{86}\end{equation</p>
<p><strong>å…³é”®æ´å¯Ÿ</strong>:
1. å‚æ•°æ¢¯åº¦æƒ©ç½šéšå¼åŒ…å«è¾“å…¥æ¢¯åº¦æƒ©ç½š
2. SGDçš„éšå¼æ­£åˆ™åŒ–é€šè¿‡è¿™ä¸ªä¸ç­‰å¼æå‡æ³›åŒ–æ€§
3. è°±å½’ä¸€åŒ–ç­‰æŠ€æœ¯å¯ä»¥ä»å‚æ•°å±‚é¢æ§åˆ¶è¾“å…¥æ•æ„Ÿæ€§</p>
<h4 id="112">11.2 ç†è®ºæ„ä¹‰</h4>
<p><strong>è¿æ¥ä¸åŒè§†è§’</strong>:
- ä¼˜åŒ–è§†è§’: å‚æ•°ç©ºé—´çš„æ¢¯åº¦
- æ³›åŒ–è§†è§’: è¾“å…¥ç©ºé—´çš„å¹³æ»‘æ€§
- é²æ£’æ€§è§†è§’: å¯¹æŠ—æ‰°åŠ¨çš„æŠµæŠ—</p>
<p><strong>ç»Ÿä¸€æ¡†æ¶</strong>: æ ¸å¿ƒä¸ç­‰å¼æä¾›äº†è¿æ¥è¿™äº›è§†è§’çš„æ•°å­¦æ¡¥æ¢ã€‚</p>
<h4 id="113">11.3 æœªæ¥æ–¹å‘</h4>
<p><strong>ç†è®ºæ‰©å±•</strong>:
1. éå…¨è¿æ¥æ¶æ„(CNN, Transformer)çš„ç²¾ç¡®ç³»æ•°
2. éšæœºæ¢¯åº¦æƒ…å†µä¸‹çš„æ¦‚ç‡ä¸ç­‰å¼
3. é«˜é˜¶æ¢¯åº¦(Hessian)çš„ç±»ä¼¼å…³ç³»</p>
<p><strong>å®è·µåº”ç”¨</strong>:
1. è‡ªé€‚åº”æ­£åˆ™åŒ–: æ ¹æ®ä¸ç­‰å¼åŠ¨æ€è°ƒæ•´æƒ©ç½šç³»æ•°
2. é«˜æ•ˆé²æ£’è®­ç»ƒ: ç”¨å‚æ•°æ¢¯åº¦æƒ©ç½šæ›¿ä»£æ˜‚è´µçš„è¾“å…¥æ¢¯åº¦æƒ©ç½š
3. å¯è§£é‡Šæ€§: é€šè¿‡æ¢¯åº¦åˆ†æç†è§£æ¨¡å‹å†³ç­–</p>
<p><strong>å¼€æ”¾é—®é¢˜</strong>:
1. ä¸ç­‰å¼çš„ç´§æ€§: åœ¨ä»€ä¹ˆæ¡ä»¶ä¸‹ç­‰å·æˆç«‹?
2. åå‘ä¸ç­‰å¼: è¾“å…¥æ¢¯åº¦æƒ©ç½šèƒ½æ§åˆ¶å‚æ•°æ¢¯åº¦å—?
3. æ³›åŒ–ç•Œ: èƒ½å¦ä»ä¸ç­‰å¼æ¨å¯¼å‡ºPAC-Bayesç•Œ?</p>
        </div>
    </div>
</body>
</html>