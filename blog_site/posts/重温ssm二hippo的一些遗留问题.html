<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é‡æ¸©SSMï¼ˆäºŒï¼‰ï¼šHiPPOçš„ä¸€äº›é—ç•™é—®é¢˜</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>é‡æ¸©SSMï¼ˆäºŒï¼‰ï¼šHiPPOçš„ä¸€äº›é—ç•™é—®é¢˜</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2026-01-05 | ğŸ“„ å¤§å°: 66.7 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10137">https://spaces.ac.cn/archives/10137</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ä¹¦æ¥ä¸Šæ–‡ï¼Œåœ¨ä¸Šä¸€ç¯‡æ–‡ç« <a href="/archives/10114">ã€Šé‡æ¸©SSMï¼ˆä¸€ï¼‰ï¼šçº¿æ€§ç³»ç»Ÿå’ŒHiPPOçŸ©é˜µã€‹</a>ä¸­ï¼Œæˆ‘ä»¬è¯¦ç»†è®¨è®ºäº†HiPPOé€¼è¿‘æ¡†æ¶å…¶HiPPOçŸ©é˜µçš„æ¨å¯¼ï¼Œå…¶åŸç†æ˜¯é€šè¿‡æ­£äº¤å‡½æ•°åŸºæ¥åŠ¨æ€åœ°é€¼è¿‘ä¸€ä¸ªå®æ—¶æ›´æ–°çš„å‡½æ•°ï¼Œå…¶æŠ•å½±ç³»æ•°çš„åŠ¨åŠ›å­¦æ­£å¥½æ˜¯ä¸€ä¸ªçº¿æ€§ç³»ç»Ÿï¼Œè€Œå¦‚æœä»¥æ­£äº¤å¤šé¡¹å¼ä¸ºåŸºï¼Œé‚£ä¹ˆçº¿æ€§ç³»ç»Ÿçš„æ ¸å¿ƒçŸ©é˜µæˆ‘ä»¬å¯ä»¥è§£æåœ°æ±‚è§£å‡ºæ¥ï¼Œè¯¥çŸ©é˜µå°±ç§°ä¸ºHiPPOçŸ©é˜µã€‚</p>
<p>å½“ç„¶ï¼Œä¸Šä¸€ç¯‡æ–‡ç« ä¾§é‡äºHiPPOçŸ©é˜µçš„æ¨å¯¼ï¼Œå¹¶æ²¡æœ‰å¯¹å®ƒçš„æ€§è´¨åšè¿›ä¸€æ­¥åˆ†æï¼Œæ­¤å¤–è¯¸å¦‚â€œå¦‚ä½•ç¦»æ•£åŒ–ä»¥åº”ç”¨äºå®é™…æ•°æ®â€ã€â€œé™¤äº†å¤šé¡¹å¼åŸºå¤–å…¶ä»–åŸºæ˜¯å¦ä¹Ÿå¯ä»¥è§£ææ±‚è§£â€ç­‰é—®é¢˜ä¹Ÿæ²¡æœ‰è¯¦ç»†è®¨è®ºåˆ°ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†è¡¥å……æ¢è®¨ç›¸å…³é—®é¢˜ã€‚</p>
<h2 id="_1">ç¦»æ•£æ ¼å¼</h2>
<p>å‡è®¾è¯»è€…å·²ç»é˜…è¯»å¹¶ç†è§£ä¸Šä¸€ç¯‡æ–‡ç« çš„å†…å®¹ï¼Œé‚£ä¹ˆè¿™é‡Œæˆ‘ä»¬å°±ä¸å†è¿›è¡Œè¿‡å¤šçš„é“ºå«ã€‚åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¨å¯¼å‡ºäº†ä¸¤ç±»çº¿æ€§ODEç³»ç»Ÿï¼Œåˆ†åˆ«æ˜¯ï¼š<br />
\begin{align}<br />
&amp;\text{HiPPO-LegT:}\quad x'(t) = Ax(t) + Bu(t) \label{eq:legt-ode}\\\[5pt]<br />
&amp;\text{HiPPO-LegS:}\quad x'(t) = \frac{A}{t}x(t) + \frac{B}{t}u(t) \label{eq:legs-ode}\end{align}<br />
å…¶ä¸­$A,B$æ˜¯ä¸æ—¶é—´$t$æ— å…³çš„å¸¸æ•°çŸ©é˜µï¼ŒHiPPOçŸ©é˜µä¸»è¦æŒ‡çŸ©é˜µ$A$ã€‚åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬è®¨è®ºè¿™ä¸¤ä¸ªODEçš„ç¦»æ•£åŒ–ã€‚</p>
<h3 id="_2">è¾“å…¥è½¬æ¢</h3>
<p>åœ¨å®é™…åœºæ™¯ä¸­ï¼Œè¾“å…¥çš„æ•°æ®ç‚¹æ˜¯ç¦»æ•£çš„åºåˆ—$u_0,u_1,u_2,\cdots,u_k,\cdots$ï¼Œæ¯”å¦‚æµå¼è¾“å…¥çš„éŸ³é¢‘ä¿¡å·ã€æ–‡æœ¬å‘é‡ç­‰ï¼Œæˆ‘ä»¬å¸Œæœ›ç”¨å¦‚ä¸Šçš„ODEç³»ç»Ÿæ¥å®æ—¶è®°å¿†è¿™äº›ç¦»æ•£ç‚¹ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å…ˆå®šä¹‰<br />
\begin{equation}u(t) = u_k,\quad \text{å¦‚æœ} t\in[k\epsilon, (k + 1)\epsilon)\end{equation}<br />
å…¶ä¸­$\epsilon$å°±æ˜¯ç¦»æ•£åŒ–çš„æ­¥é•¿ã€‚è¯¥å®šä¹‰ä¹Ÿå°±æ˜¯è¯´åœ¨åŒºé—´$[k\epsilon, (k + 1)\epsilon)$å†…ï¼Œ$u(t)$æ˜¯ä¸€ä¸ªå¸¸æ•°å‡½æ•°ï¼Œå…¶å€¼ç­‰äº$u_k$ã€‚å¾ˆæ˜æ˜¾è¿™æ ·å®šä¹‰å‡ºæ¥çš„$u(t)$æ— æŸåŸæœ¬$u_k$åºåˆ—çš„ä¿¡æ¯ï¼Œå› æ­¤è®°å¿†$u(t)$å°±ç›¸å½“äºè®°å¿†$u_k$åºåˆ—ã€‚</p>
<p>ä»$u_k$å˜æ¢åˆ°$u(t)$ï¼Œå¯ä»¥ä½¿å¾—è¾“å…¥ä¿¡å·é‡æ–°å˜å›è¿ç»­åŒºé—´ä¸Šçš„å‡½æ•°ï¼Œæ–¹ä¾¿åé¢è¿›è¡Œç§¯åˆ†ç­‰è¿ç®—ï¼Œæ­¤å¤–åœ¨ç¦»æ•£åŒ–çš„åŒºé—´å†…ä¿æŒä¸ºå¸¸æ•°ï¼Œä¹Ÿèƒ½å¤Ÿç®€åŒ–ç¦»æ•£åŒ–åçš„æ ¼å¼ã€‚</p>
<h3 id="legt">LegTç‰ˆæœ¬</h3>
<p>æˆ‘ä»¬å…ˆä»¥LegTå‹ODE$\eqref{eq:legt-ode}$ä¸ºä¾‹ï¼Œå°†å®ƒä¸¤ç«¯ç§¯åˆ†<br />
\begin{equation}x(t+\epsilon) - x(t) = A\int_t^{t+\epsilon} x(s)ds + B\int_t^{t+\epsilon}u(s)ds\end{equation}<br />
å…¶ä¸­$t=k\epsilon$ã€‚æ ¹æ®$u(t)$çš„å®šä¹‰ï¼Œå®ƒåœ¨$[t, t + \epsilon)$åŒºé—´å†…æ’ä¸º$u_k$ï¼Œäºæ˜¯$u(s)$çš„ç§¯åˆ†å¯ä»¥ç›´æ¥ç®—å‡ºæ¥ï¼š<br />
\begin{equation}x(t+\epsilon) - x(t) = A\int_t^{t+\epsilon} x(s)ds + \epsilon B u_k\end{equation}<br />
æ¥ä¸‹æ¥çš„ç»“æœï¼Œå°±å–å†³äºæˆ‘ä»¬å¦‚ä½•è¿‘ä¼¼$x(s)$çš„ç§¯åˆ†äº†ã€‚å‡å¦‚æˆ‘ä»¬è®¤ä¸ºåœ¨$[t, t + \epsilon)$åŒºé—´å†…$x(s)$è¿‘ä¼¼æ’ç­‰äº$x(t)$ï¼Œé‚£ä¹ˆå°±å¾—åˆ°å‰å‘æ¬§æ‹‰æ ¼å¼<br />
\begin{equation}x(t+\epsilon) - x(t) = \epsilon A x(t) + \epsilon B u_k \quad\Rightarrow\quad x(t+\epsilon) = (I + \epsilon A)x(t) + \epsilon B u_k\end{equation}<br />
æˆ‘ä»¬è®¤ä¸ºåœ¨$[t, t + \epsilon)$åŒºé—´å†…$x(s)$è¿‘ä¼¼æ’ç­‰äº$x(t+\epsilon)$ï¼Œé‚£ä¹ˆå°±å¾—åˆ°åå‘æ¬§æ‹‰æ ¼å¼<br />
\begin{equation}x(t+\epsilon) - x(t) = \epsilon A x(t+\epsilon) + \epsilon B u_k \quad\Rightarrow\quad x(t+\epsilon) = (I - \epsilon A)^{-1}(x(t) + \epsilon B u_k)\end{equation}<br />
å‰åå‘æ¬§æ‹‰éƒ½å…·æœ‰ç›¸åŒçš„ç†è®ºç²¾åº¦ï¼Œä½†åå‘é€šå¸¸ä¼šæœ‰æ›´å¥½çš„æ•°å€¼ç¨³å®šæ€§ã€‚å¦‚æœè¦æ›´å‡†ç¡®ä¸€äº›ï¼Œé‚£ä¹ˆè®¤ä¸ºåœ¨$[t, t + \epsilon)$åŒºé—´å†…$x(s)$è¿‘ä¼¼æ’ç­‰äº$\frac{1}{2}[x(t) + x(t+\epsilon)]$ï¼Œé‚£ä¹ˆå¾—åˆ°åŒçº¿æ€§å½¢å¼ï¼š<br />
\begin{equation}\begin{gathered}<br />
x(t+\epsilon) - x(t) = \frac{1}{2}\epsilon A [x(t) + x(t+\epsilon)] + \epsilon B u_k \\\<br />
\Downarrow \\\<br />
x(t+\epsilon) = (I - \epsilon A/2)^{-1}[(I + \epsilon A/2) x(t) + \epsilon B u_k]<br />
\end{gathered}\end{equation}<br />
è¿™ä¹Ÿç­‰ä»·äºå…ˆç”¨å‰å‘æ¬§æ‹‰èµ°åŠæ­¥ï¼Œå†ç”¨åå‘æ¬§æ‹‰èµ°åŠæ­¥ã€‚æ›´ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è®¤ä¸ºåœ¨$[t, t + \epsilon)$åŒºé—´å†…$x(s)$è¿‘ä¼¼æ’ç­‰äº$\alpha x(t) + (1 - \alpha) x(t+\epsilon)$ï¼Œå…¶ä¸­$\alpha\in[0,1]$ï¼Œè¿™å°±ä¸è¿›ä¸€æ­¥å±•å¼€äº†ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å®Œå…¨ä¸åšè¿‘ä¼¼ï¼Œå› ä¸ºç»“åˆå¼$\eqref{eq:legt-ode}$ä»¥åŠåœ¨åŒºé—´$[t,t+\epsilon)$ä¸­$u(s)$æ˜¯å¸¸æ•°$u_k$ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç”¨â€œ<a href="https://en.wikipedia.org/wiki/Variation_ou_parameters">å¸¸æ•°å˜æ˜“æ³•</a>â€æ¥ç²¾ç¡®æ±‚è§£å‡ºæ¥ï¼Œç»“æœæ˜¯<br />
\begin{equation}x(t+\epsilon) = e^{\epsilon A} x(t) + A^{-1} (e^{\epsilon A} - I) B u_k\label{eq:legt-ode-sol}\end{equation}<br />
è¿™é‡Œçš„çŸ©é˜µæŒ‡æ•°æŒ‰ç…§çº§æ•°æ¥å®šä¹‰ï¼Œå¯ä»¥å‚è€ƒ<a href="/archives/6377#%E7%9F%A9%E9%98%B5%E6%8C%87%E6%95%B0">ã€Šæ’ç­‰å¼ det(exp(A)) = exp(Tr(A)) èµæã€‹</a>ã€‚</p>
<h3 id="legs">LegSç‰ˆæœ¬</h3>
<p>ç°åœ¨è½®åˆ°LegSå‹ODEäº†ï¼Œå®ƒçš„æ€è·¯è·ŸLegTå‹åŸºæœ¬ä¸€è‡´ï¼Œç»“æœä¹Ÿå¤§åŒå°å¼‚ã€‚é¦–å…ˆå°†å¼$\eqref{eq:legs-ode}$ä¸¤ç«¯ç§¯åˆ†å¾—åˆ°<br />
\begin{equation}x(t+\epsilon) - x(t) = A\int_t^{t+\epsilon} \frac{x(s)}{s}ds + B\int_t^{t+\epsilon}\frac{u(s)}{s}ds\end{equation}<br />
æ ¹æ®$u(t)$å®šä¹‰ï¼Œç¬¬äºŒé¡¹ç§¯åˆ†çš„$u(s)$åœ¨$[t,t+\epsilon)$æ’ä¸º$u_k$ï¼Œæ‰€ä»¥å®ƒç›¸å½“äº$1/s$çš„ç§¯åˆ†ï¼Œå¯ä»¥ç›´æ¥ç§¯åˆ†å‡ºæ¥å¾—$\ln\frac{t+\epsilon}{t}$ï¼Œå½“ç„¶ç›´æ¥æ¢ä¸ºä¸€é˜¶è¿‘ä¼¼$\frac{\epsilon}{t}$ä¹Ÿæ— å¦¨ï¼Œå› ä¸ºæœ¬èº«$u_k$åˆ°$u(t)$çš„å˜æ¢æœ‰å¾ˆå¤§è‡ªç”±åº¦ï¼Œè¿™ç‚¹è¯¯å·®æ— æ‰€è°“ã€‚è‡³äºç¬¬ä¸€é¡¹ç§¯åˆ†ï¼Œæˆ‘ä»¬ç›´æ¥é‡‡ç”¨ç²¾åº¦æ›´é«˜çš„ä¸­ç‚¹è¿‘ä¼¼ï¼Œå¾—åˆ°<br />
\begin{equation}\begin{gathered}<br />
x(t+\epsilon) - x(t) = \frac{1}{2}\epsilon A\left(\frac{x(t)}{t}+\frac{x(t+\epsilon)}{t+\epsilon}\right) + \frac{\epsilon}{t} B u_k \\\[5pt]<br />
\Downarrow \\\[5pt]<br />
x(t+\epsilon) = \left(I - \frac{\epsilon A}{2(t+\epsilon)}\right)^{-1}\left[\left(I + \frac{\epsilon A}{2t}\right)x(t) + \frac{\epsilon}{t} B u_k\right]<br />
\end{gathered}\label{eq:legs-ode-bilinear}\end{equation}<br />
äº‹å®ä¸Šï¼Œå¼$\eqref{eq:legs-ode}$ä¹Ÿå¯ä»¥ç²¾ç¡®æ±‚è§£ï¼Œåªéœ€è¦ç•™æ„åˆ°å®ƒç­‰ä»·äº<br />
\begin{equation}Ax(t) + Bu(t) = t x'(t) = \frac{d}{d\ln t} x(t)\end{equation}<br />
è¿™æ„å‘³ç€åªéœ€è¦åšå˜é‡ä»£æ¢$\tau = \ln t$ï¼Œé‚£ä¹ˆLegSå‹ODEå°±å¯ä»¥è½¬åŒ–ä¸ºLegTå‹ODEï¼š<br />
\begin{equation}\frac{d}{d\tau} x(e^{\tau}) = Ax(e^{\tau}) + Bu(e^{\tau})\end{equation}<br />
åˆ©ç”¨å¼$\eqref{eq:legt-ode-sol}$å¾—åˆ°ï¼ˆç”±äºå˜é‡ä»£æ¢ï¼Œæ—¶é—´é—´éš”ç”±$\epsilon$å˜æˆ$\ln(t+\epsilon) - \ln t$ï¼‰<br />
\begin{equation}x(t+\epsilon) = e^{(\ln(t+\epsilon) - \ln t) A} x(t) + A^{-1} \big(e^{(\ln(t+\epsilon) - \ln t) A} - I\big) B u_k\label{eq:legs-ode-sol}\end{equation}<br />
ç„¶è€Œï¼Œä¸Šå¼è™½ç„¶æ˜¯ç²¾ç¡®è§£ï¼Œä½†ä¸å¦‚åŒä¸ºç²¾ç¡®è§£çš„å¼$\eqref{eq:legt-ode-sol}$å¥½ç”¨ï¼Œå› ä¸ºå¼$\eqref{eq:legt-ode-sol}$çš„æŒ‡æ•°çŸ©é˜µéƒ¨åˆ†æ˜¯$e^{\epsilon A}$ï¼Œè·Ÿæ—¶é—´$t$æ— å…³ï¼Œæ‰€ä»¥ä¸€æ¬¡æ€§è®¡ç®—å®Œå°±å¯ä»¥äº†ã€‚ä½†ä¸Šå¼ä¸­$t$åœ¨çŸ©é˜µæŒ‡æ•°é‡Œè¾¹ï¼Œæ„å‘³ç€åœ¨è¿­ä»£è¿‡ç¨‹ä¸­éœ€è¦åå¤è®¡ç®—çŸ©é˜µæŒ‡æ•°ï¼Œå¯¹è®¡ç®—å¹¶ä¸å‹å¥½ï¼Œæ‰€ä»¥LegSå‹ODEæˆ‘ä»¬ä¸€èˆ¬åªä¼šç”¨å¼$\eqref{eq:legs-ode-bilinear}$æ¥ç¦»æ•£åŒ–ã€‚</p>
<h2 id="_3">ä¼˜è‰¯æ€§è´¨</h2>
<p>æ¥ä¸‹æ¥ï¼ŒLegSæ˜¯æˆ‘ä»¬çš„é‡ç‚¹å…³æ³¨å¯¹è±¡ã€‚é‡ç‚¹å…³æ³¨LegSçš„åŸå› å¹¶ä¸éš¾çŒœï¼Œå› ä¸ºä»æ¨å¯¼çš„å‡è®¾æ¥çœ‹ï¼Œå®ƒæ˜¯ç›®å‰æ±‚è§£å‡ºæ¥çš„å”¯ä¸€ä¸€ä¸ªèƒ½å¤Ÿè®°å¿†æ•´ä¸ªå†å²çš„ODEç³»ç»Ÿï¼Œè¿™å¯¹äºå¾ˆå¤šåœºæ™¯å¦‚å¤šè½®å¯¹è¯æ¥è¯´è‡³å…³é‡è¦ã€‚æ­¤å¤–ï¼Œå®ƒè¿˜æœ‰å…¶ä»–çš„ä¸€äº›æ¯”è¾ƒè‰¯å¥½ä¸”å®ç”¨çš„æ€§è´¨ã€‚</p>
<h3 id="_4">å°ºåº¦ç­‰å˜</h3>
<p>æ¯”å¦‚ï¼ŒLegSçš„ç¦»æ•£åŒ–æ ¼å¼$\eqref{eq:legs-ode-bilinear}$æ˜¯æ­¥é•¿æ— å…³çš„ï¼Œæˆ‘ä»¬åªéœ€è¦å°†$t=k\epsilon$ä»£å…¥é‡Œè¾¹ï¼Œå¹¶è®°$x(k\epsilon)=x_k$ï¼Œå°±å¯ä»¥å‘ç°<br />
\begin{equation}<br />
x_{k+1} = \left(I - \frac{A}{2(k + 1)}\right)^{-1}\left[\left(I + \frac{A}{2k}\right)x_k + \frac{1}{k} B u_k\right]\end{equation}<br />
æ­¥é•¿$\epsilon$è¢«è‡ªåŠ¨åœ°æ¶ˆå»äº†ï¼Œä»è€Œè‡ªç„¶åœ°å‡å°‘äº†ä¸€ä¸ªéœ€è¦è°ƒçš„è¶…å‚æ•°ï¼Œè¿™å¯¹äºç‚¼ä¸¹äººå£«æ˜¾ç„¶æ˜¯ä¸€ä¸ªå¥½æ¶ˆæ¯ã€‚æ³¨æ„æ­¥é•¿æ— å…³æ˜¯LegSå‹ODEçš„ä¸€ä¸ªå›ºæœ‰æ€§è´¨ï¼Œå®ƒè·Ÿå…·ä½“çš„ç¦»æ•£åŒ–æ–¹å¼å¹¶æ— ç›´æ¥å…³ç³»ï¼Œæ¯”å¦‚ç²¾ç¡®è§£$\eqref{eq:legs-ode-sol}$åŒæ ·æ˜¯æ­¥é•¿æ— å…³çš„ï¼š<br />
\begin{equation}x_{k+1} = e^{(\ln(k+1) - \ln k) A} x_k + A^{-1} \big(e^{(\ln(k+1) - \ln k) A} - I\big) B u_k\label{eq:legs-ode-sol-2}\end{equation}<br />
å…¶èƒŒåçš„åŸå› ï¼Œåœ¨äºLegSå‹ODEæ»¡è¶³â€œ<strong>æ—¶é—´å°ºåº¦ç­‰å˜æ€§ï¼ˆTimescale equivarianceï¼‰</strong> â€â€”â€”å¦‚æœæˆ‘ä»¬è®¾$t=\lambda\tau$ä»£å…¥LegSå‹ODEï¼Œå°†å¾—åˆ°<br />
\begin{equation}Ax(\alpha\tau) + Bu(\alpha\tau) = (\alpha\tau)\times \frac{d}{d(\alpha\tau)} x(\alpha\tau) = \tau \frac{d}{d\tau}x(\alpha\tau)\end{equation}<br />
è¿™æ„å‘³ç€ï¼Œå½“æˆ‘ä»¬å°†$u(t)$æ¢æˆ$u(\alpha t)$æ—¶ï¼ŒLegSçš„ODEå½¢å¼å¹¶æ²¡æœ‰å˜åŒ–ï¼Œè€Œå¯¹åº”çš„è§£åˆ™æ˜¯$x(t)$æ¢æˆäº†$x(\alpha t)$ã€‚è¿™ä¸ªæ€§è´¨çš„ç›´æ¥åæœå°±æ˜¯ï¼šå½“æˆ‘ä»¬é€‰æ‹©æ›´å¤§çš„æ­¥é•¿æ—¶ï¼Œé€’å½’æ ¼å¼ä¸éœ€è¦å‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºç»“æœ$x_k$çš„æ­¥é•¿ä¹Ÿä¼šè‡ªåŠ¨æ”¾å¤§ï¼Œè¿™å°±æ˜¯LegSå‹ODEç¦»æ•£åŒ–ä¸æ­¥é•¿æ— å…³çš„æœ¬è´¨åŸå› ã€‚</p>
<h3 id="_5">é•¿å°¾è¡°å‡</h3>
<p>LegSå‹ODEçš„å¦ä¸€ä¸ªä¼˜è‰¯æ€§è´¨æ˜¯ï¼Œå®ƒå…³äºå†å²ä¿¡å·çš„è®°å¿†æ˜¯<strong>å¤šé¡¹å¼è¡°å‡ï¼ˆPolynomial decayï¼‰</strong> çš„ï¼Œè¿™æ¯”å¸¸è§„RNNçš„æŒ‡æ•°è¡°å‡æ›´ç¼“æ…¢ï¼Œä»è€Œç†è®ºä¸Šèƒ½è®°å¿†æ›´é•¿çš„å†å²ï¼Œæ›´ä¸å®¹æ˜“æ¢¯åº¦æ¶ˆå¤±ã€‚ä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ä»ç²¾ç¡®è§£$\eqref{eq:legs-ode-sol-2}$å‡ºå‘ï¼Œä»å¼$\eqref{eq:legs-ode-sol-2}$å¯ä»¥çœ‹åˆ°ï¼Œæ¯é€’å½’ä¸€æ­¥ï¼Œå†å²ä¿¡æ¯çš„è¡°å‡æ•ˆåº”å¯ä»¥ç”¨çŸ©é˜µæŒ‡æ•°$e^{(\ln(k+1) - \ln k) A}$æ¥æè¿°ï¼Œé‚£ä¹ˆä»ç¬¬$m$æ­¥é€’å½’åˆ°ç¬¬$n$æ­¥ï¼Œæ€»çš„è¡°å‡æ•ˆåº”æ˜¯<br />
\begin{equation}\prod_{k=m}^{n-1} e^{(\ln(k+1) - \ln k) A} = e^{(\ln n - \ln m) A}\end{equation}<br />
å›é¡¾HiPPO-LegSä¸­$A$çš„å½¢å¼ï¼š<br />
\begin{equation}A_{n,k} = -\left\{\begin{array}{l}\sqrt{(2n+1)(2k+1)}, &amp;k &lt; n \\\ n+1, &amp;k = n \\\<br />
0, &amp;k &gt; n\end{array}\right.\end{equation}<br />
ä»å®šä¹‰å¯ä»¥çœ‹å‡ºï¼Œ$A$æ˜¯ä¸€ä¸ªä¸‹ä¸‰è§’é˜µï¼Œå…¶å¯¹è§’çº¿å…ƒç´ ä¸º$-1,-2,-3,\cdots$ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œä¸‰è§’é˜µçš„å¯¹è§’çº¿å…ƒç´ æ­£å¥½æ˜¯å®ƒçš„ç‰¹å¾å€¼ï¼ˆå‚è€ƒ<a href="https://en.wikipedia.org/wiki/Triangular_matrix">Triangular matrix</a>ï¼‰ï¼Œç”±æ­¤å¯ä»¥çœ‹åˆ°ä¸€ä¸ª$d\times d$å¤§å°çš„$A$çŸ©é˜µï¼Œæœ‰$d$ä¸ªä¸åŒçš„ç‰¹å¾å€¼$-1,-2,\cdots,-d$ï¼Œè¿™è¯´æ˜$A$çŸ©é˜µæ˜¯å¯å¯¹è§’åŒ–çš„ï¼Œå³å­˜åœ¨å¯é€†çŸ©é˜µ$P$ï¼Œä½¿å¾—$A = P^{-1}\Lambda P$ï¼Œå…¶ä¸­$\Lambda = \text{diag}(-1,-2,\cdots,-d)$ï¼Œäºæ˜¯æˆ‘ä»¬æœ‰<br />
\begin{equation}\begin{aligned}<br />
e^{(\ln n - \ln m) A} =&amp;\, e^{(\ln n - \ln m) P^{-1}\Lambda P} \\\<br />
=&amp;\, P^{-1} e^{(\ln n - \ln m) \Lambda}P \\\<br />
=&amp;\, P^{-1}\,\text{diag}(e^{-(\ln n - \ln m)},e^{-2(\ln n - \ln m)},\cdots,e^{-d(\ln n - \ln m)})\,P \\\<br />
=&amp;\, P^{-1}\,\text{diag}\Big(\frac{m}{n},\frac{m^2}{n^2},\cdots,\frac{m^d}{n^d}\Big)\,P \\\<br />
\end{aligned}\end{equation}<br />
å¯è§ï¼Œæœ€ç»ˆçš„è¡°å‡å‡½æ•°æ˜¯$1/n$çš„$1,2,\cdots,d$æ¬¡å‡½æ•°çš„çº¿æ€§ç»„åˆï¼Œæ‰€ä»¥LegSå‹ODEå…³äºå†å²è®°å¿†è‡³å¤šæ˜¯å¤šé¡¹å¼è¡°å‡çš„ï¼Œæ¯”æŒ‡æ•°è¡°å‡æ›´åŠ é•¿å°¾ï¼Œå› æ­¤ç†è®ºä¸Šæœ‰æ›´å¥½çš„è®°å¿†åŠ›ã€‚</p>
<h3 id="_6">è®¡ç®—é«˜æ•ˆ</h3>
<p>æœ€åï¼Œæˆ‘ä»¬æŒ‡å‡ºHiPPO-LegSçš„$A$çŸ©é˜µæ˜¯<strong>è®¡ç®—é«˜æ•ˆï¼ˆComputational efficiencyï¼‰</strong> çš„ã€‚å…·ä½“æ¥è¯´ï¼Œç›´æ¥æŒ‰ç…§çŸ©é˜µä¹˜æ³•çš„æœ´ç´ å®ç°çš„è¯ï¼Œä¸€ä¸ª$d\times d$çš„çŸ©é˜µä¹˜ä»¥$d\times 1$çš„åˆ—å‘é‡ï¼Œéœ€è¦åš$d^2$æ¬¡ä¹˜æ³•ï¼Œä½†LegSçš„$A$çŸ©é˜µä¸å‘é‡ç›¸ä¹˜åˆ™å¯ä»¥é™ä½åˆ°$\mathcal{O}(d)$æ¬¡ï¼Œæ›´è¿›ä¸€æ­¥åœ°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è¯æ˜ç¦»æ•£åŒ–åçš„$\eqref{eq:legs-ode-bilinear}$ä¹Ÿå¯ä»¥åœ¨$\mathcal{O}(d)$å®Œæˆã€‚</p>
<p>ä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬é¦–å…ˆå°†HiPPO-LegSçš„$A$çŸ©é˜µç­‰ä»·åœ°æ”¹å†™æˆ<br />
\begin{equation}A_{n,k} = \left\{\begin{array}{l}n\delta_{n,k} - \sqrt{2n+1}\sqrt{2k+1}, &amp;k \leq n \\\ 0, &amp;k &gt; n\end{array}\right.\end{equation}<br />
å¯¹äºå‘é‡$v = [v_0,v_1,\cdots,v_{d-1}]$ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\begin{aligned}<br />
(Av)<em k="0">n = \sum</em>\right)v_k \\\}^n A_{n,k}v_k =&amp;\, \sum_{k=0}^n \left(n\delta_{n,k} - \sqrt{2n+1}\sqrt{2k+1<br />
=&amp;\, n v_n -\sqrt{2n+1}\sum_{k=0}^n \sqrt{2k+1}v_k<br />
\end{aligned}\end{equation}<br />
è¿™åŒ…å«ä¸‰ç§è¿ç®—ï¼Œç¬¬ä¸€é¡¹çš„$n v_n$æ˜¯å‘é‡$[0,1,2,\cdots,d-1]$ä¸$v$åšé€ä½ç›¸ä¹˜è¿ç®—ï¼Œç¬¬äºŒé¡¹çš„$\sqrt{2k+1}v_k$åˆ™æ˜¯å‘é‡$[1,\sqrt{3},\sqrt{5},\cdots,\sqrt{2d-1}]$ä¸$v$åšé€ä½ç›¸ä¹˜ï¼Œç„¶å$\sum\limits_{k=0}^n$å°±æ˜¯$\text{cumsum}$è¿ç®—ï¼Œæœ€åä¹˜ä»¥$\sqrt{2n+1}$å°±æ˜¯å†é€ä½ç›¸ä¹˜å‘é‡$[1,\sqrt{3},\sqrt{5},\cdots,\sqrt{2d-1}]$ï¼Œæ¯ä¸€æ­¥éƒ½å¯ä»¥åœ¨$\mathcal{O}(d)$å†…å®Œæˆï¼Œå› æ­¤æ€»çš„å¤æ‚åº¦æ˜¯$\mathcal{O}(d)$çš„ã€‚</p>
<p>æˆ‘ä»¬å†æ¥çœ‹$\eqref{eq:legs-ode-bilinear}$ï¼Œå®ƒåŒ…å«ä¸¤æ­¥â€œçŸ©é˜µ-å‘é‡â€ä¹˜æ³•è¿ç®—ï¼Œä¸€æ˜¯$(I+\lambda A)v$ï¼Œ$\lambda$æ˜¯ä»»æ„å®æ•°ï¼Œåˆšæ‰æˆ‘ä»¬å·²ç»è¯æ˜äº†$Av$æ˜¯è®¡ç®—é«˜æ•ˆçš„ï¼Œè‡ªç„¶$(I+\lambda A)v$ä¹Ÿæ˜¯ï¼›äºŒæ˜¯$(I-\lambda A)^{-1}v$ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°†è¯æ˜å®ƒä¹Ÿæ˜¯è®¡ç®—é«˜æ•ˆçš„ã€‚è¿™åªéœ€è¦ç•™æ„åˆ°æ±‚$z=(I-\lambda A)^{-1}v$ç­‰ä»·äºè§£æ–¹ç¨‹$v = (I-\lambda A)z$ï¼Œåˆ©ç”¨ä¸Šé¢ç»™å‡ºçš„$Av$è¡¨è¾¾å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<br />
\begin{equation}v_n = z_n - \lambda \left(n z_n - \sqrt{2n+1}\sum_{k=0}^n \sqrt{2k+1}z_k\right)\end{equation}<br />
è®°$S_n = \sum\limits_{k=0}^n \sqrt{2k+1}z_k$ï¼Œé‚£ä¹ˆ$z_n = \frac{S_n - S_{n-1}}{\sqrt{2n+1}}$ï¼Œä»£å…¥ä¸Šå¼å¾—<br />
\begin{equation}v_n = \frac{S_n - S_{n-1}}{\sqrt{2n+1}} - \lambda \left(n \frac{S_n - S_{n-1}}{\sqrt{2n+1}} - \sqrt{2n+1}S_n\right)\end{equation}<br />
æ•´ç†å¾—<br />
\begin{equation}S_n = \frac{1 - \lambda n}{1+\lambda n + \lambda}S_{n-1} + \frac{\sqrt{2n+1}}{1+\lambda n + \lambda}v_n\end{equation}<br />
è¿™æ˜¯ä¸€ä¸ªæ ‡é‡çš„é€’å½’å¼ï¼Œå¯ä»¥å®Œå…¨ä¸²è¡Œåœ°è®¡ç®—ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨Prefix Sumçš„ç›¸å…³ç®—æ³•å¹¶è¡Œè®¡ç®—ï¼ˆå‚è€ƒ<a href="/archives/9554#%E5%B9%B6%E8%A1%8C%E5%8C%96">è¿™é‡Œ</a>ï¼‰ï¼Œè®¡ç®—å¤æ‚åº¦ä¸º$\mathcal{O}(d)$æˆ–è€…$\mathcal{O}(d\log d)$ï¼Œæ€»ä¹‹ç›¸æ¯”$\mathcal{O}(d^2)$éƒ½ä¼šæ›´åŠ é«˜æ•ˆã€‚</p>
<h2 id="_7">å‚…ç«‹å¶åŸº</h2>
<p>æœ€åï¼Œæˆ‘ä»¬ä»¥å‚…ç«‹å¶åŸºçš„ä¸€ä¸ªæ¨å¯¼æ”¶å°¾ã€‚åœ¨ä¸Šä¸€ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬ä»¥å‚…ç«‹å¶çº§æ•°æ¥å¼•å‡ºäº†çº¿æ€§ç³»ç»Ÿï¼Œä½†åªæ¨å¯¼äº†é‚»è¿‘çª—å£å½¢å¼çš„ç»“æœï¼Œè€Œåé¢çš„å‹’è®©å¾·å¤šé¡¹å¼åŸºæˆ‘ä»¬åˆ™æ¨å¯¼äº†é‚»è¿‘çª—å£å’Œå®Œæ•´åŒºé—´ä¸¤ä¸ªç‰ˆæœ¬ï¼ˆå³LegTå’ŒLegSï¼‰ã€‚é‚£ä¹ˆå‚…ç«‹å¶åŸºç©¶ç«Ÿèƒ½ä¸èƒ½æ¨å¯¼ä¸€ä¸ªè·ŸLegSç›¸å½“çš„ç‰ˆæœ¬å‘¢ï¼Ÿå…¶ä¸­ä¼šé¢ä¸´ä»€ä¹ˆå›°éš¾å‘¢ï¼Ÿä¸‹é¢æˆ‘ä»¬å¯¹æ­¤è¿›è¡Œæ¢è®¨ã€‚</p>
<p>åŒæ ·åœ°ï¼Œç›¸å…³é“ºå«æˆ‘ä»¬ä¸å†é‡å¤ï¼ŒæŒ‰ç…§ä¸Šä¸€èŠ‚çš„è®°å·ï¼Œå‚…ç«‹å¶åŸºçš„ç³»æ•°ä¸º<br />
\begin{equation}c_n(T) = \int_0^1 u(t_{\leq T}(s)) e^{-2i\pi n s}ds\end{equation}<br />
è·ŸLegSä¸€æ ·ï¼Œä¸ºäº†è®°å¿†æ•´ä¸ª$[0,T]$åŒºé—´çš„ä¿¡å·ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ª$[0,1]\mapsto [0,T]$çš„æ˜ å°„ï¼Œä¸ºæ­¤é€‰å–æœ€ç®€å•çš„$t_{\leq T}(s)=sT$ï¼Œä»£å…¥åä¸¤è¾¹æ±‚å¯¼å¾—åˆ°<br />
\begin{equation}\frac{d}{dT}c_n(T) = \int_0^1 u'(sT) s e^{-2i\pi n s}ds\end{equation}<br />
åˆ†éƒ¨ç§¯åˆ†å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
\frac{d}{dT}c_n(T) =&amp;\, \frac{1}{T}\int_0^1 s e^{-2i\pi n s}d u(sT) \\\<br />
=&amp;\, \frac{1}{T} u(sT) s e^{-2i\pi n s}\big|<em 0="0" k_neq="k\neq">{s=0}^{s=1} - \frac{1}{T}\int_0^1 u(sT) d(s e^{-2i\pi n s})\\\<br />
=&amp;\, \frac{1}{T} u(T) - \frac{1}{T}\int_0^1 u(sT) e^{-2i\pi n s} ds + \frac{2i\pi n}{T}\int_0^1 u(sT) s e^{-2i\pi n s} ds\\\<br />
=&amp;\, \frac{1}{T} u(T) - \frac{1}{T}c_n(T) + \frac{2i\pi n}{T}\int_0^1 u(sT) s e^{-2i\pi n s} ds\\\<br />
\end{aligned}\end{equation}<br />
ä¸Šä¸€ç¯‡æ–‡ç« æˆ‘ä»¬æåˆ°ï¼ŒHiPPOé€‰å–å‹’è®©å¾·å¤šé¡¹å¼ä¸ºåŸºçš„é‡è¦åŸå› ä¹‹ä¸€æ˜¯$(s+1)p_n'(t)$å¯ä»¥åˆ†è§£ä¸º$p_0(t),p_1(t),\cdots,p_n(t)$çš„çº¿æ€§ç»„åˆï¼Œè€Œå‚…é‡Œå¶åŸºçš„$s e^{-2i\pi n s}$åˆ™ä¸èƒ½åšåˆ°è¿™ä¸€ç‚¹ã€‚ä½†äº‹å®ä¸Šï¼Œå¦‚æœå…è®¸è¯¯å·®çš„è¯ï¼Œè¿™ä¸ªæ–­è®ºæ˜¯ä¸æˆç«‹çš„ï¼Œå› ä¸ºæˆ‘ä»¬åŒæ ·å¯ä»¥å°†$s$åˆ†è§£ä¸ºå‚…é‡Œå¶çº§æ•°ï¼š<br />
\begin{equation}s = \frac{1}{2} + \frac{i}{2\pi}\sum</em>} \frac{1}{k} e^{2i\pi k s}\end{equation<br />
è¿™é‡Œçš„æ±‚å’Œæœ‰æ— é™é¡¹ï¼Œå¦‚æœè¦æˆªæ–­ä¸ºæœ‰é™é¡¹çš„è¯ï¼Œå°±ä¼šäº§ç”Ÿè¯¯å·®ï¼Œä½†æˆ‘ä»¬å¯ä»¥å…ˆä¸çº ç»“è¿™ä¸€ç‚¹ï¼Œç›´æ¥å¾€ä¸Šä»£å…¥å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\frac{2i\pi n}{T}\int_0^1 u(sT) s e^{-2i\pi n s} ds \\\<br />
=&amp;\, \frac{2i\pi n}{T}\int_0^1 u(sT) \left(\frac{1}{2} + \frac{i}{2\pi}\sum_{k\neq 0} \frac{1}{k} e^{2i\pi k s}\right) e^{-2i\pi n s} ds \\\<br />
=&amp;\, \frac{i\pi n}{T}\int_0^1 u(sT) e^{-2i\pi n s} ds - \frac{1}{T}\sum_{k\neq 0} \frac{n}{k}\int_0^1 u(sT) e^{-2i\pi (n - k) s} ds \\\<br />
=&amp;\, \frac{i\pi n}{T}c_n(T) - \frac{1}{T}\sum_{k\neq 0} \frac{n}{k}c_{n-k}(T) \\\<br />
=&amp;\, \frac{i\pi n}{T}c_n(T) - \frac{1}{T}\sum_{k\neq n} \frac{n}{n - k}c_k(T) \\\<br />
\end{aligned}\end{equation}<br />
è¿™æ ·ä¸€æ¥<br />
\begin{equation}<br />
\frac{d}{dT}c_n(T) = \frac{1}{T} u(T) + \frac{i\pi n - 1}{T}c_n(T) - \frac{1}{T}\sum_{k\neq n} \frac{n}{n - k}c_k(T)\end{equation}<br />
æ‰€ä»¥å¯ä»¥å†™å‡º<br />
\begin{equation}\begin{aligned}<br />
x'(t) =&amp;\, \frac{A}{t}x(t) + \frac{B}{t}u(t)\\\[8pt]<br />
\quad A_{n,k} =&amp;\, \left\{\begin{array}{l}-\frac{n}{n-k}, &amp;k \neq n \\\ i\pi n - 1, &amp;k = n\end{array}\right.\\\[8pt]<br />
B_n =&amp;\, 1<br />
\end{aligned}\end{equation}<br />
å®é™…ä½¿ç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦æˆªæ–­$|n|,|k|\leq N$ï¼Œå°±å¯ä»¥å¾—åˆ°ä¸€ä¸ª$(2N+1)\times (2N+1)$çš„çŸ©é˜µã€‚æˆªæ–­å¸¦æ¥çš„è¯¯å·®å…¶å®æ˜¯æ— æ‰€è°“çš„ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ¨å¯¼HiPPO-LegTçš„æ—¶å€™åŒæ ·å¼•å…¥äº†æœ‰é™çº§æ•°è¿‘ä¼¼ï¼Œé‚£ä¼šæˆ‘ä»¬åŒæ ·ä¹Ÿæ²¡è€ƒè™‘è¯¯å·®ï¼Œæˆ–è€…åè¿‡æ¥è®²ï¼Œå¯¹äºç‰¹å®šçš„ä»»åŠ¡ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©é€‚å½“çš„è§„æ¨¡ï¼ˆå³$N$çš„å¤§å°ï¼‰ï¼Œè€Œè¿™ä¸ªâ€œé€‚å½“â€çš„å«ä¹‰ä¹‹ä¸€ï¼Œå°±æ˜¯æˆªæ–­å¸¦æ¥è¯¯å·®å¯¹äºè¯¥ä»»åŠ¡æ˜¯å¯ä»¥å¿½ç•¥çš„ã€‚</p>
<p>å¯¹å¤§å¤šæ•°äººæ¥è¯´ï¼Œå‚…ç«‹å¶åŸºçš„è¿™ä¸ªæ¨å¯¼å¯èƒ½è¿˜æ›´å®¹æ˜“ç†è§£ä¸€äº›ï¼Œå› ä¸ºå‹’è®©å¾·å¤šé¡¹å¼å¯¹å¾ˆå¤šè¯»è€…æ¥è¯´éƒ½æ¯”è¾ƒé™Œç”Ÿï¼Œå°¤å…¶æ˜¯LegTã€LegSæ¨å¯¼è¿‡ç¨‹ä¸­ç”¨åˆ°çš„å‡ ä¸ªæ’ç­‰å¼ï¼Œè€Œå¯¹äºå‚…ç«‹å¶çº§æ•°å¤§å¤šæ•°è¯»è€…åº”è¯¥æˆ–å¤šæˆ–å°‘éƒ½æœ‰æ‰€äº†è§£ã€‚ä¸è¿‡ï¼Œä»ç»“æœä¸Šæ¥çœ‹ï¼Œå‚…ç«‹å¶åŸºçš„è¿™ä¸ªç»“æœå¯èƒ½ä¸å¦‚LegSå®ç”¨ï¼Œä¸€æ¥å®ƒå¼•å…¥äº†å¤æ•°ï¼Œè¿™å¢åŠ äº†å®ç°çš„å¤æ‚åº¦ï¼ŒäºŒæ¥å®ƒæ¨å¯¼å‡ºçš„$A$çŸ©é˜µä¸åƒLegSé‚£æ ·æ˜¯ä¸ªç›¸å¯¹è¾ƒæ·¡çš„ä¸‹ä¸‰è§’é˜µï¼Œå› æ­¤ç†è®ºåˆ†æèµ·æ¥ä¹Ÿæ›´ä¸ºå¤æ‚ã€‚æ‰€ä»¥ï¼Œå¤§å®¶æƒå½“å®ƒæ˜¯ä¸€é“æ·±åŒ–å¯¹HiPPOçš„ç†è§£çš„ç»ƒä¹ é¢˜å°±å¥½ã€‚</p>
<h2 id="_8">æ–‡ç« å°ç»“</h2>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è¡¥å……æ¢è®¨äº†ä¸Šä¸€ç¯‡æ–‡ç« ä»‹ç»çš„HiPPOçš„ä¸€äº›é—ç•™é—®é¢˜ï¼Œå…¶ä¸­åŒ…æ‹¬å¦‚ä½•å¯¹ODEè¿›è¡Œç¦»æ•£åŒ–ã€LegSå‹ODEçš„ä¸€äº›ä¼˜è‰¯æ€§è´¨ï¼Œä»¥åŠåˆ©ç”¨å‚…ç«‹å¶åŸºè®°å¿†æ•´ä¸ªå†å²åŒºé—´çš„ç»“æœæ¨å¯¼ï¼ˆå³LegSçš„å‚…ç«‹å¶ç‰ˆæœ¬ï¼‰ï¼Œä»¥æ±‚è·å¾—å¯¹HiPPOçš„æ›´å…¨é¢ç†è§£ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10137">https://spaces.ac.cn/archives/10137</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jun. 05, 2024). ã€Šé‡æ¸©SSMï¼ˆäºŒï¼‰ï¼šHiPPOçš„ä¸€äº›é—ç•™é—®é¢˜ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10137">https://spaces.ac.cn/archives/10137</a></p>
<p>@online{kexuefm-10137,<br />
title={é‡æ¸©SSMï¼ˆäºŒï¼‰ï¼šHiPPOçš„ä¸€äº›é—ç•™é—®é¢˜},<br />
author={è‹å‰‘æ—},<br />
year={2024},<br />
month={Jun},<br />
url={\url{https://spaces.ac.cn/archives/10137}},<br />
} </p>
<hr />
<h2 id="_9">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚æä¾›HiPPOé—ç•™é—®é¢˜çš„è¯¦ç»†æ•°å­¦æ¨å¯¼,åŒ…æ‹¬å„ç§ç¦»æ•£åŒ–æ–¹æ³•ã€å¤šé¡¹å¼è¡°å‡è¯æ˜ã€å‚…ç«‹å¶åŸºæ¨å¯¼ç­‰æ ¸å¿ƒç†è®ºçš„å®Œæ•´è¯æ˜ã€‚</p>
<h3 id="_10">ä¸€ã€ç¦»æ•£åŒ–æ–¹æ³•çš„å®Œæ•´ç†è®º</h3>
<h4 id="11-zero-order-hold-zoh">1.1 Zero-Order Hold (ZOH) ç¦»æ•£åŒ–</h4>
<p><strong>å®šä¹‰1.1 (Zero-Order Hold)</strong>: å¯¹äºè¿ç»­ODE $x'(t) = Ax(t) + Bu(t)$,åœ¨åŒºé—´$[k\Delta t, (k+1)\Delta t)$å†…,è¾“å…¥ä¿æŒå¸¸æ•°$u(t) = u_k$ã€‚</p>
<p><strong>å®šç†1.1 (ZOHç²¾ç¡®è§£)</strong>: ZOHç¦»æ•£åŒ–çš„ç²¾ç¡®è§£ä¸º:
\begin{equation}
x_{k+1} = e^{A\Delta t}x_k + A^{-1}(e^{A\Delta t} - I)Bu_k \tag{1}
\end{equation}</p>
<p><strong>è¯¦ç»†æ¨å¯¼</strong>:</p>
<p>æ­¥éª¤1: åœ¨åŒºé—´$[k\Delta t, (k+1)\Delta t)$å†…,ODEå˜ä¸º:
\begin{equation}
x'(t) = Ax(t) + Bu_k, \quad t \in [k\Delta t, (k+1)\Delta t) \tag{2}
\end{equation}</p>
<p>æ­¥éª¤2: ä½¿ç”¨å¸¸æ•°å˜æ˜“æ³•ã€‚é½æ¬¡æ–¹ç¨‹$x'(t) = Ax(t)$çš„è§£ä¸º$x_h(t) = e^{A(t-t_0)}x(t_0)$ã€‚</p>
<p>æ­¥éª¤3: è®¾ç‰¹è§£å½¢å¼ä¸º$x_p(t) = e^{At}c(t)$,ä»£å…¥éé½æ¬¡æ–¹ç¨‹:
\begin{align}
Ae^{At}c(t) + e^{At}c'(t) &amp;= Ae^{At}c(t) + Bu_k \tag{3} \
e^{At}c'(t) &amp;= Bu_k \tag{4} \
c'(t) &amp;= e^{-At}Bu_k \tag{5}
\end{align}</p>
<p>æ­¥éª¤4: ç§¯åˆ†å¾—:
\begin{equation}
c(t) = \int_0^t e^{-As}Bu_k ds = -A^{-1}e^{-At}Bu_k + A^{-1}Bu_k \tag{6}
\end{equation}</p>
<p>æ­¥éª¤5: ç‰¹è§£ä¸º:
\begin{equation}
x_p(t) = e^{At}c(t) = -A^{-1}Bu_k + e^{At}A^{-1}Bu_k \tag{7}
\end{equation}</p>
<p>æ­¥éª¤6: ä¸€èˆ¬è§£(è®¾$t_0 = k\Delta t$,$x(t_0) = x_k$):
\begin{align}
x(t) &amp;= e^{A(t-k\Delta t)}x_k + A^{-1}(e^{A(t-k\Delta t)} - I)Bu_k \tag{8}
\end{align}</p>
<p>æ­¥éª¤7: ä»¤$t = (k+1)\Delta t$å¾—åˆ°ç¦»æ•£å½¢å¼:
\begin{equation}
x_{k+1} = e^{A\Delta t}x_k + A^{-1}(e^{A\Delta t} - I)Bu_k \tag{9}
\end{equation}
$\square$</p>
<p><strong>å¼•ç†1.2 (çŸ©é˜µæŒ‡æ•°çš„è®¡ç®—)</strong>: å¯¹äºå¯¹è§’çŸ©é˜µ$\Lambda = \text{diag}(\lambda_1,\ldots,\lambda_d)$:
\begin{equation}
e^{\Lambda\Delta t} = \text{diag}(e^{\lambda_1\Delta t}, \ldots, e^{\lambda_d\Delta t}) \tag{10}
\end{equation}</p>
<p>å¯¹äºå¯å¯¹è§’åŒ–çŸ©é˜µ$A = P\Lambda P^{-1}$:
\begin{equation}
e^{A\Delta t} = Pe^{\Lambda\Delta t}P^{-1} \tag{11}
\end{equation}</p>
<h4 id="12-bilineartustin">1.2 åŒçº¿æ€§å˜æ¢(Bilinear/Tustin)</h4>
<p><strong>å®šç†1.3 (åŒçº¿æ€§å˜æ¢å…¬å¼)</strong>: åŒçº¿æ€§ç¦»æ•£åŒ–ä¸º:
\begin{equation}
x_{k+1} = (I - \frac{\Delta t}{2}A)^{-1}(I + \frac{\Delta t}{2}A)x_k + \Delta t(I - \frac{\Delta t}{2}A)^{-1}Bu_k \tag{12}
\end{equation}</p>
<p><strong>è¯¦ç»†æ¨å¯¼</strong>:</p>
<p>æ­¥éª¤1: åœ¨$t = k\Delta t$å’Œ$t = (k+1)\Delta t$å¤„,ODEåˆ†åˆ«ä¸º:
\begin{align}
x'(k\Delta t) &amp;= Ax_k + Bu_k \tag{13} \
x'((k+1)\Delta t) &amp;= Ax_{k+1} + Bu_{k+1} \tag{14}
\end{align}</p>
<p>æ­¥éª¤2: å¯¹$x'(t)$åœ¨$[k\Delta t, (k+1)\Delta t]$ä¸Šç§¯åˆ†:
\begin{equation}
x_{k+1} - x_k = \int_{k\Delta t}^{(k+1)\Delta t} (Ax(t) + Bu(t))dt \tag{15}
\end{equation}</p>
<p>æ­¥éª¤3: ä½¿ç”¨æ¢¯å½¢æ³•åˆ™è¿‘ä¼¼ç§¯åˆ†(å–ç«¯ç‚¹å¹³å‡):
\begin{equation}
x_{k+1} - x_k \approx \frac{\Delta t}{2}[(Ax_k + Bu_k) + (Ax_{k+1} + Bu_{k+1})] \tag{16}
\end{equation}</p>
<p>æ­¥éª¤4: æ•´ç†(å‡è®¾$u_{k+1} = u_k$):
\begin{align}
x_{k+1} - x_k &amp;= \frac{\Delta t}{2}A(x_k + x_{k+1}) + \Delta t Bu_k \tag{17} \
x_{k+1} - \frac{\Delta t}{2}Ax_{k+1} &amp;= x_k + \frac{\Delta t}{2}Ax_k + \Delta t Bu_k \tag{18} \
(I - \frac{\Delta t}{2}A)x_{k+1} &amp;= (I + \frac{\Delta t}{2}A)x_k + \Delta t Bu_k \tag{19}
\end{align}</p>
<p>æ­¥éª¤5: ä¸¤è¾¹å·¦ä¹˜$(I - \frac{\Delta t}{2}A)^{-1}$:
\begin{equation}
x_{k+1} = (I - \frac{\Delta t}{2}A)^{-1}(I + \frac{\Delta t}{2}A)x_k + \Delta t(I - \frac{\Delta t}{2}A)^{-1}Bu_k \tag{20}
\end{equation}
$\square$</p>
<p><strong>å®šç†1.4 (åŒçº¿æ€§å˜æ¢çš„ç²¾åº¦)</strong>: åŒçº¿æ€§å˜æ¢æ˜¯äºŒé˜¶ç²¾åº¦æ–¹æ³•,å±€éƒ¨æˆªæ–­è¯¯å·®ä¸º$\mathcal{O}(\Delta t^3)$ã€‚</p>
<p><strong>è¯æ˜</strong>: å¯¹ç²¾ç¡®è§£$x(t)$åœ¨$t = k\Delta t$å¤„Taylorå±•å¼€:
\begin{align}
x((k+1)\Delta t) &amp;= x_k + \Delta t x'_k + \frac{(\Delta t)^2}{2}x''_k + \frac{(\Delta t)^3}{6}x'''_k + \mathcal{O}(\Delta t^4) \tag{21}
\end{align}</p>
<p>åˆ©ç”¨$x' = Ax + Bu$å¯å¾—$x'' = Ax' + Bu' = A^2x + ABu + Bu'$ã€‚ä»£å…¥æ¢¯å½¢æ³•åˆ™å¹¶æ¯”è¾ƒ,å¯è¯æ˜å±€éƒ¨è¯¯å·®ä¸º$\mathcal{O}(\Delta t^3)$ã€‚$\square$</p>
<h4 id="13-euler">1.3 å‰å‘/åå‘Euleræ–¹æ³•</h4>
<p><strong>å®šç†1.5 (Euleræ–¹æ³•)</strong>:
- <strong>å‰å‘Euler</strong>: $x_{k+1} = (I + \Delta t A)x_k + \Delta t Bu_k$
- <strong>åå‘Euler</strong>: $x_{k+1} = (I - \Delta t A)^{-1}(x_k + \Delta t Bu_k)$</p>
<p>ä¸¤è€…éƒ½æ˜¯ä¸€é˜¶ç²¾åº¦,å±€éƒ¨è¯¯å·®$\mathcal{O}(\Delta t^2)$ã€‚</p>
<p><strong>å®šç†1.6 (ç¨³å®šæ€§æ¯”è¾ƒ)</strong>:
\begin{align}
&amp;\text{å‰å‘Euler: æ¡ä»¶ç¨³å®š,éœ€è¦} |\Delta t A| \leq 2 \tag{22} \
&amp;\text{åå‘Euler: A-ç¨³å®š,æ— æ¡ä»¶ç¨³å®š} \tag{23} \
&amp;\text{åŒçº¿æ€§: A-ç¨³å®š,æ— æ¡ä»¶ç¨³å®š} \tag{24}
\end{align}</p>
<p><strong>è¯æ˜(A-ç¨³å®šæ€§)</strong>:</p>
<p>å¯¹äºåå‘Euler,è®¾$\lambda$ä¸º$A$çš„ç‰¹å¾å€¼,$\text{Re}(\lambda) &lt; 0$ã€‚ç¦»æ•£åŒ–åçš„ç‰¹å¾å€¼ä¸º:
\begin{equation}
\mu = \frac{1}{1 - \Delta t\lambda} \tag{25}
\end{equation}</p>
<p>è®¡ç®—æ¨¡é•¿:
\begin{align}
|\mu|^2 &amp;= \frac{1}{|1 - \Delta t\lambda|^2} \tag{26} \
&amp;= \frac{1}{(1 - \Delta t\text{Re}(\lambda))^2 + (\Delta t\text{Im}(\lambda))^2} \tag{27}
\end{align}</p>
<p>å½“$\text{Re}(\lambda) &lt; 0$æ—¶,$1 - \Delta t\text{Re}(\lambda) &gt; 1$,æ•…$|\mu| &lt; 1$ã€‚$\square$</p>
<h4 id="14-legs">1.4 LegSçš„ç‰¹æ®Šç¦»æ•£åŒ–</h4>
<p>å¯¹äºLegSå‹ODE $x'(t) = \frac{A}{t}x(t) + \frac{B}{t}u(t)$,åº”ç”¨å˜é‡æ›¿æ¢$\tau = \ln t$:</p>
<p><strong>å®šç†1.7 (LegSçš„åŒçº¿æ€§ç¦»æ•£åŒ–)</strong>:
\begin{equation}
x_{k+1} = \left(I - \frac{A}{2(k+1)}\right)^{-1}\left[\left(I + \frac{A}{2k}\right)x_k + \frac{B}{k}u_k\right] \tag{28}
\end{equation}</p>
<p><strong>é‡è¦æ€§è´¨</strong>: æ­¤ç¦»æ•£åŒ–ä¸æ­¥é•¿$\Delta t$æ— å…³,ä»…ä¾èµ–äºæ­¥æ•°$k$ã€‚</p>
<p><strong>è¯æ˜</strong>: è®¾$t_k = k\Delta t$,åˆ™:
\begin{align}
\frac{A}{t_k} &amp;= \frac{A}{k\Delta t} \tag{29} \
\frac{A}{t_{k+1}} &amp;= \frac{A}{(k+1)\Delta t} \tag{30}
\end{align}</p>
<p>åº”ç”¨åŒçº¿æ€§å˜æ¢:
\begin{align}
x_{k+1} &amp;= \left(I - \frac{\Delta t}{2}\cdot\frac{A}{(k+1)\Delta t}\right)^{-1}\left[\left(I + \frac{\Delta t}{2}\cdot\frac{A}{k\Delta t}\right)x_k + \Delta t\cdot\frac{B}{k\Delta t}u_k\right] \tag{31}
\end{align}</p>
<p>ç®€åŒ–å$\Delta t$æ¶ˆå»,å¾—åˆ°(28)å¼ã€‚$\square$</p>
<h3 id="hippo-legs">äºŒã€HiPPO-LegSå¤šé¡¹å¼è¡°å‡çš„ä¸¥æ ¼è¯æ˜</h3>
<h4 id="21">2.1 ç‰¹å¾å€¼åˆ†æ</h4>
<p><strong>å¼•ç†2.1 (HiPPO-LegSçš„ç‰¹å¾å€¼)</strong>: HiPPO-LegSçŸ©é˜µ$A$çš„ç‰¹å¾å€¼ä¸º:
\begin{equation}
\lambda_k = -(k+1), \quad k = 0,1,2,\ldots,d-1 \tag{32}
\end{equation}</p>
<p><strong>è¯æ˜</strong>: $A$æ˜¯ä¸‹ä¸‰è§’çŸ©é˜µ,å¯¹è§’å…ƒç´ ä¸º$A_{kk} = -(k+1)$ã€‚ä¸‹ä¸‰è§’çŸ©é˜µçš„ç‰¹å¾å€¼å°±æ˜¯å…¶å¯¹è§’å…ƒç´ ã€‚$\square$</p>
<p><strong>å®šç†2.2 (HiPPO-LegSå¯å¯¹è§’åŒ–)</strong>: å­˜åœ¨å¯é€†çŸ©é˜µ$P$ä½¿å¾—:
\begin{equation}
A = P^{-1}\Lambda P, \quad \Lambda = \text{diag}(-1,-2,\ldots,-d) \tag{33}
\end{equation}</p>
<p><strong>è¯æ˜</strong>: ç”±äº$A$æœ‰$d$ä¸ªä¸åŒçš„ç‰¹å¾å€¼,æ•…$A$å¿…å®šå¯å¯¹è§’åŒ–ã€‚$\square$</p>
<h4 id="22">2.2 å¤šé¡¹å¼è¡°å‡çš„å®šé‡åˆ†æ</h4>
<p><strong>å®šç†2.3 (å¤šé¡¹å¼è®°å¿†è¡°å‡)</strong>: å¯¹äºLegSç¦»æ•£åŒ–ç³»ç»Ÿ,ä»ç¬¬$m$æ­¥åˆ°ç¬¬$n$æ­¥($n &gt; m$)çš„è®°å¿†è¡°å‡ä¸º:
\begin{equation}
\text{Decay}(m \to n) = e^{(\ln n - \ln m)A} = P^{-1}\text{diag}\left(\frac{m}{n}, \frac{m^2}{n^2}, \ldots, \frac{m^d}{n^d}\right)P \tag{34}
\end{equation}</p>
<p><strong>è¯¦ç»†æ¨å¯¼</strong>:</p>
<p>æ­¥éª¤1: ä»ZOHç²¾ç¡®è§£(å¯¹LegSåšå˜é‡æ›¿æ¢):
\begin{equation}
x_{k+1} = e^{(\ln(k+1) - \ln k)A}x_k + (\text{è¾“å…¥é¡¹}) \tag{35}
\end{equation}</p>
<p>æ­¥éª¤2: é€’å½’å±•å¼€ä»$m$åˆ°$n$:
\begin{align}
x_n &amp;= e^{(\ln n - \ln(n-1))A}x_{n-1} \tag{36} \
&amp;= e^{(\ln n - \ln(n-1))A}e^{(\ln(n-1) - \ln(n-2))A}x_{n-2} \tag{37} \
&amp;= \cdots \tag{38} \
&amp;= e^{(\ln n - \ln m)A}x_m \tag{39}
\end{align}</p>
<p>æ­¥éª¤3: ä½¿ç”¨$A = P^{-1}\Lambda P$:
\begin{align}
e^{(\ln n - \ln m)A} &amp;= e^{(\ln n - \ln m)P^{-1}\Lambda P} \tag{40} \
&amp;= P^{-1}e^{(\ln n - \ln m)\Lambda}P \tag{41}
\end{align}</p>
<p>æ­¥éª¤4: å¯¹è§’çŸ©é˜µçš„æŒ‡æ•°:
\begin{align}
e^{(\ln n - \ln m)\Lambda} &amp;= \text{diag}(e^{-(\ln n - \ln m)}, e^{-2(\ln n - \ln m)}, \ldots, e^{-d(\ln n - \ln m)}) \tag{42} \
&amp;= \text{diag}\left(e^{\ln(m/n)}, e^{\ln(m/n)^2}, \ldots, e^{\ln(m/n)^d}\right) \tag{43} \
&amp;= \text{diag}\left(\frac{m}{n}, \frac{m^2}{n^2}, \ldots, \frac{m^d}{n^d}\right) \tag{44}
\end{align}
$\square$</p>
<p><strong>æ¨è®º2.4 (è¡°å‡é€Ÿåº¦æ¯”è¾ƒ)</strong>:
\begin{align}
&amp;\text{æŒ‡æ•°è¡°å‡(æ ‡å‡†RNN):} \sim e^{-\alpha(n-m)} \tag{45} \
&amp;\text{å¤šé¡¹å¼è¡°å‡(HiPPO-LegS):} \sim \left(\frac{m}{n}\right)^k, k = 1,2,\ldots,d \tag{46}
\end{align}</p>
<p>å¯¹äºå¤§çš„$n-m$,å¤šé¡¹å¼è¡°å‡æ˜¾è‘—æ…¢äºæŒ‡æ•°è¡°å‡ã€‚</p>
<p><strong>å®šé‡ç¤ºä¾‹</strong>: è®¾$m = 100, n = 1000$:
- æŒ‡æ•°è¡°å‡($\alpha = 0.01$): $e^{-0.01 \times 900} \approx 1.2 \times 10^{-4}$
- å¤šé¡¹å¼è¡°å‡($k = 1$): $(100/1000)^1 = 0.1$
- å¤šé¡¹å¼è¡°å‡($k = 2$): $(100/1000)^2 = 0.01$</p>
<h4 id="23">2.3 æ¢¯åº¦æµåˆ†æ</h4>
<p><strong>å®šç†2.5 (æ¢¯åº¦ä¸æ¶ˆå¤±æ¡ä»¶)</strong>: å¯¹äºæŸå¤±å‡½æ•°$\mathcal{L}(x_n)$,æ¢¯åº¦å›ä¼ åˆ°ç¬¬$m$æ­¥:
\begin{equation}
\frac{\partial \mathcal{L}}{\partial x_m} = \frac{\partial \mathcal{L}}{\partial x_n}\prod_{k=m}^{n-1}\frac{\partial x_{k+1}}{\partial x_k} = \frac{\partial \mathcal{L}}{\partial x_n}e^{(\ln n - \ln m)A} \tag{47}
\end{equation}</p>
<p>æ¢¯åº¦æ¨¡é•¿:
\begin{equation}
\left|\frac{\partial \mathcal{L}}{\partial x_m}\right| \sim \mathcal{O}\left(\left(\frac{m}{n}\right)^k\right) \tag{48}
\end{equation}</p>
<p>ç›¸æ¯”æŒ‡æ•°è¡°å‡çš„$\mathcal{O}(e^{-\alpha(n-m)})$,å¤šé¡¹å¼å½¢å¼ä½¿å¾—æ¢¯åº¦æ›´å®¹æ˜“ä¿æŒã€‚</p>
<h3 id="_11">ä¸‰ã€å‚…ç«‹å¶åŸºçš„å®Œæ•´æ¨å¯¼</h3>
<h4 id="31">3.1 å‚…ç«‹å¶çº§æ•°å›é¡¾</h4>
<p><strong>å®šä¹‰3.1 (å‚…ç«‹å¶åŸº)</strong>: åœ¨åŒºé—´$[0,1]$ä¸Šçš„å‚…ç«‹å¶åŸºä¸º:
\begin{equation}
\phi_n(s) = e^{2\pi ins}, \quad n \in \mathbb{Z} \tag{49}
\end{equation}</p>
<p><strong>æ­£äº¤æ€§</strong>:
\begin{equation}
\int_0^1 e^{2\pi ins}e^{-2\pi ims}ds = \delta_{nm} \tag{50}
\end{equation}</p>
<h4 id="32-hippo-fourier">3.2 HiPPO-Fourierçš„æ¨å¯¼</h4>
<p><strong>é—®é¢˜è®¾å®š</strong>: ç”¨å‚…ç«‹å¶çº§æ•°é€¼è¿‘$u(t_{\leq T}(s))$,å…¶ä¸­$t_{\leq T}(s) = sT$å°†$[0,1]$æ˜ å°„åˆ°$[0,T]$ã€‚</p>
<p><strong>å®šç†3.2 (å‚…ç«‹å¶ç³»æ•°çš„ODE)</strong>: ç³»æ•°$c_n(T) = \int_0^1 u(sT)e^{-2\pi ins}ds$æ»¡è¶³:
\begin{equation}
\frac{d}{dT}c_n(T) = \frac{1}{T}u(T) + \frac{i\pi n - 1}{T}c_n(T) - \frac{1}{T}\sum_{k \neq n}\frac{n}{n-k}c_k(T) \tag{51}
\end{equation}</p>
<p><strong>è¯¦ç»†æ¨å¯¼</strong>:</p>
<p>æ­¥éª¤1: å¯¹$c_n(T)$å…³äº$T$æ±‚å¯¼:
\begin{align}
\frac{d}{dT}c_n(T) &amp;= \frac{d}{dT}\int_0^1 u(sT)e^{-2\pi ins}ds \tag{52} \
&amp;= \int_0^1 \frac{\partial}{\partial T}[u(sT)]e^{-2\pi ins}ds \tag{53} \
&amp;= \int_0^1 u'(sT) \cdot s \cdot e^{-2\pi ins}ds \tag{54}
\end{align}</p>
<p>æ­¥éª¤2: åˆ†éƒ¨ç§¯åˆ†:
\begin{align}
&amp;= \frac{1}{T}\int_0^1 s \cdot e^{-2\pi ins}du(sT) \tag{55} \
&amp;= \frac{1}{T}\left[s \cdot e^{-2\pi ins} \cdot u(sT)\Big|_0^1 - \int_0^1 u(sT)d(se^{-2\pi ins})\right] \tag{56} \
&amp;= \frac{1}{T}u(T) - \frac{1}{T}\int_0^1 u(sT)(e^{-2\pi ins} - 2\pi ins e^{-2\pi ins})ds \tag{57} \
&amp;= \frac{1}{T}u(T) - \frac{1}{T}c_n(T) + \frac{2\pi in}{T}\int_0^1 u(sT)se^{-2\pi ins}ds \tag{58}
\end{align}</p>
<p>æ­¥éª¤3: å‚…ç«‹å¶çº§æ•°å±•å¼€$s$:
\begin{equation}
s = \frac{1}{2} + \frac{i}{2\pi}\sum_{k \neq 0}\frac{1}{k}e^{2\pi iks} \tag{59}
\end{equation}</p>
<p><strong>è¯æ˜</strong>: è¿™æ˜¯$s$åœ¨$[0,1]$ä¸Šçš„å‚…ç«‹å¶çº§æ•°ã€‚ç›´æ¥éªŒè¯:
\begin{align}
\frac{i}{2\pi}\sum_{k \neq 0}\frac{1}{k}e^{2\pi iks} &amp;= \frac{i}{2\pi}\sum_{k=1}^{\infty}\left[\frac{1}{k}e^{2\pi iks} - \frac{1}{k}e^{-2\pi iks}\right] \tag{60} \
&amp;= \frac{1}{\pi}\sum_{k=1}^{\infty}\frac{\sin(2\pi ks)}{k} \tag{61}
\end{align}
è¿™æ­£æ˜¯$s - 1/2$çš„å‚…ç«‹å¶çº§æ•°(é”¯é½¿æ³¢)ã€‚$\square$</p>
<p>æ­¥éª¤4: ä»£å…¥(59)å¼:
\begin{align}
&amp;\frac{2\pi in}{T}\int_0^1 u(sT)se^{-2\pi ins}ds \tag{62} \
&amp;= \frac{2\pi in}{T}\int_0^1 u(sT)\left(\frac{1}{2} + \frac{i}{2\pi}\sum_{k \neq 0}\frac{1}{k}e^{2\pi iks}\right)e^{-2\pi ins}ds \tag{63} \
&amp;= \frac{i\pi n}{T}c_n(T) - \frac{n}{T}\sum_{k \neq 0}\frac{1}{k}\int_0^1 u(sT)e^{-2\pi i(n-k)s}ds \tag{64} \
&amp;= \frac{i\pi n}{T}c_n(T) - \frac{1}{T}\sum_{k \neq 0}\frac{n}{k}c_{n-k}(T) \tag{65} \
&amp;= \frac{i\pi n}{T}c_n(T) - \frac{1}{T}\sum_{k \neq n}\frac{n}{n-k}c_k(T) \tag{66}
\end{align}</p>
<p>æ­¥éª¤5: ç»¼åˆå¾—åˆ°æœ€ç»ˆç»“æœ:
\begin{equation}
\frac{d}{dT}c_n(T) = \frac{1}{T}u(T) - \frac{1}{T}c_n(T) + \frac{i\pi n}{T}c_n(T) - \frac{1}{T}\sum_{k \neq n}\frac{n}{n-k}c_k(T) \tag{67}
\end{equation}</p>
<p>æ•´ç†å¾—:
\begin{equation}
\frac{d}{dT}c_n(T) = \frac{1}{T}u(T) + \frac{i\pi n - 1}{T}c_n(T) - \frac{1}{T}\sum_{k \neq n}\frac{n}{n-k}c_k(T) \tag{68}
\end{equation}
$\square$</p>
<h4 id="33-hippo-fourier">3.3 HiPPO-FourierçŸ©é˜µ</h4>
<p><strong>å®šç†3.3 (HiPPO-Fourierçš„çŸ©é˜µå½¢å¼)</strong>: è®¾$x = [c_{-N}, \ldots, c_{-1}, c_0, c_1, \ldots, c_N]^T$,åˆ™:
\begin{align}
x'(t) &amp;= \frac{A}{t}x(t) + \frac{B}{t}u(t) \tag{69} \
A_{n,k} &amp;= \left{\begin{array}{ll}
-\frac{n}{n-k}, &amp; k \neq n \
i\pi n - 1, &amp; k = n
\end{array}\right. \tag{70} \
B_n &amp;= 1 \tag{71}
\end{align}</p>
<p>å…¶ä¸­$n,k \in {-N, -N+1, \ldots, N}$,$A$æ˜¯$(2N+1) \times (2N+1)$çŸ©é˜µã€‚</p>
<p><strong>æ€§è´¨å¯¹æ¯”</strong>:</p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>HiPPO-LegS</th>
<th>HiPPO-Fourier</th>
</tr>
</thead>
<tbody>
<tr>
<td>åŸºå‡½æ•°</td>
<td>å‹’è®©å¾·å¤šé¡¹å¼</td>
<td>å¤æŒ‡æ•°</td>
</tr>
<tr>
<td>çŸ©é˜µ$A$</td>
<td>å®æ•°,ä¸‹ä¸‰è§’</td>
<td>å¤æ•°,ç¨ å¯†</td>
</tr>
<tr>
<td>ç‰¹å¾å€¼</td>
<td>$-1,-2,\ldots,-d$</td>
<td>$i\pi n - 1$</td>
</tr>
<tr>
<td>è®¡ç®—å¤æ‚åº¦</td>
<td>$\mathcal{O}(d)$</td>
<td>$\mathcal{O}(d^2)$</td>
</tr>
<tr>
<td>æ•°å€¼ç¨³å®šæ€§</td>
<td>å¥½</td>
<td>è¾ƒå·®(å¤æ•°)</td>
</tr>
</tbody>
</table>
<h3 id="_12">å››ã€åˆå§‹åŒ–ç­–ç•¥çš„ç†è®ºåˆ†æ</h3>
<h4 id="41-vs">4.1 é›¶åˆå§‹åŒ– vs éšæœºåˆå§‹åŒ–</h4>
<p><strong>å®šç†4.1 (é›¶åˆå§‹åŒ–çš„è®°å¿†æ€§è´¨)</strong>: è‹¥åˆå§‹çŠ¶æ€$x_0 = 0$,åˆ™ç¬¬$n$æ­¥çš„çŠ¶æ€ä¸º:
\begin{equation}
x_n = \sum_{k=0}^{n-1}e^{(\ln n - \ln(k+1))A}Bu_k \tag{72}
\end{equation}</p>
<p><strong>è§£é‡Š</strong>: è¿™è¡¨æ˜$x_n$æ˜¯æ‰€æœ‰å†å²è¾“å…¥$u_0, u_1, \ldots, u_{n-1}$çš„åŠ æƒå’Œ,æƒé‡ç”±å¤šé¡¹å¼è¡°å‡å‡½æ•°å†³å®šã€‚</p>
<p><strong>å®šç†4.2 (éšæœºåˆå§‹åŒ–çš„å½±å“)</strong>: è‹¥$x_0 \sim \mathcal{N}(0, \sigma^2 I)$,åˆ™:
\begin{equation}
\mathbb{E}[|x_n|^2] = \sigma^2|e^{(\ln n)A}|_F^2 + \text{(è¾“å…¥è´¡çŒ®)} \tag{73}
\end{equation}</p>
<p>å…¶ä¸­$|e^{(\ln n)A}|_F$éš$n$å¤šé¡¹å¼è¡°å‡,æ•…éšæœºåˆå§‹åŒ–çš„å½±å“é€æ¸å‡å¼±ã€‚</p>
<h4 id="42-hippo">4.2 HiPPOåˆå§‹åŒ–çš„æœ€ä¼˜æ€§</h4>
<p><strong>å®šç†4.3 (HiPPOåˆå§‹åŒ–çš„æœ€ä¼˜æ€§)</strong>: å¯¹äºLegS,è‹¥è¦ç²¾ç¡®è¡¨ç¤ºå†å²åŒºé—´$[0,T]$ä¸Šçš„å¸¸æ•°å‡½æ•°$u(t) = c$,åˆ™åˆå§‹çŠ¶æ€åº”ä¸º:
\begin{equation}
x^*(T) = A^{-1}Bc \tag{74}
\end{equation}</p>
<p><strong>è¯æ˜</strong>: ç¨³æ€æ¡ä»¶$x'(T) = 0$:
\begin{align}
0 &amp;= \frac{A}{T}x^<em> + \frac{B}{T}c \tag{75} \
Ax^</em> &amp;= -Bc \tag{76} \
x^* &amp;= -A^{-1}Bc \tag{77}
\end{align}</p>
<p>ç”±äº$A$çš„å¯¹è§’å…ƒç´ ä¸ºè´Ÿ,æ•…$x^* = A^{-1}Bc$ã€‚$\square$</p>
<h4 id="43">4.3 å‚æ•°åˆå§‹åŒ–çš„æ•°å€¼è€ƒè™‘</h4>
<p><strong>å»ºè®®4.4 (å®è·µåˆå§‹åŒ–ç­–ç•¥)</strong>:
1. <strong>çŠ¶æ€$x_0$</strong>: é›¶åˆå§‹åŒ–æˆ–å°éšæœºæ‰°åŠ¨
2. <strong>çŸ©é˜µ$B$</strong>: Xavier/Glorotåˆå§‹åŒ–
3. <strong>çŸ©é˜µ$C$</strong>: æ ‡å‡†æ­£æ€åˆ†å¸ƒ,$\mathcal{N}(0, 1/\sqrt{d})$
4. <strong>æ­¥é•¿$\epsilon$</strong>: $0.001 \sim 0.1$,æˆ–è‡ªé€‚åº”å­¦ä¹ </p>
<p><strong>ç†ç”±</strong>:
- é›¶åˆå§‹åŒ–é¿å…æ¢¯åº¦çˆ†ç‚¸
- Xavieråˆå§‹åŒ–ä¿æŒæ–¹å·®ç¨³å®š
- å°$\epsilon$ç¡®ä¿æ•°å€¼ç¨³å®šæ€§</p>
<h3 id="_13">äº”ã€é•¿åºåˆ—å»ºæ¨¡çš„å†…å­˜ä¼˜åŒ–</h3>
<h4 id="51">5.1 çŠ¶æ€å‹ç¼©æŠ€æœ¯</h4>
<p><strong>å®šç†5.1 (çŠ¶æ€ç»´åº¦çš„ä¿¡æ¯è®ºä¸‹ç•Œ)</strong>: è¦ä»¥$\epsilon$è¯¯å·®è¿‘ä¼¼é•¿åº¦ä¸º$L$çš„åºåˆ—,çŠ¶æ€ç»´åº¦$d$éœ€æ»¡è¶³:
\begin{equation}
d \geq \frac{H(u_{0:L})}{\log(1/\epsilon)} \tag{78}
\end{equation}
å…¶ä¸­$H(u_{0:L})$æ˜¯åºåˆ—çš„Shannonç†µã€‚</p>
<p><strong>æ¨è®º5.2</strong>: å¯¹äºä½ç†µåºåˆ—(å¦‚å‘¨æœŸä¿¡å·),å¯ä½¿ç”¨è¾ƒå°çš„$d$ã€‚</p>
<h4 id="52">5.2 ç¨€ç–çŠ¶æ€æ›´æ–°</h4>
<p><strong>ç®—æ³•5.3 (ç¨€ç–æ›´æ–°ç­–ç•¥)</strong>:</p>
<div class="codehilite"><pre><span></span><code>å¯¹äºç¨€ç–è¾“å…¥u_k (å¤§éƒ¨åˆ†ä¸º0):
1. ä»…åœ¨u_k â‰  0æ—¶æ›´æ–°çŠ¶æ€
2. å…¶ä»–æ—¶åˆ»: x_{k+1} = Ä€x_k (çœç•¥BÌ„u_ké¡¹)
3. å¤æ‚åº¦: O(d) â†’ O(dÂ·ç¨€ç–åº¦)
</code></pre></div>

<p><strong>å®šç†5.4 (ç¨€ç–æ›´æ–°çš„ç²¾ç¡®æ€§)</strong>: å¯¹äºç¨€ç–è¾“å…¥,ç¨€ç–æ›´æ–°äº§ç”Ÿçš„ç»“æœä¸å®Œæ•´æ›´æ–°å®Œå…¨ç›¸åŒã€‚</p>
<h4 id="53-gradient-checkpointing">5.3 æ¢¯åº¦æ£€æŸ¥ç‚¹(Gradient Checkpointing)</h4>
<p><strong>å®šç†5.5 (æ£€æŸ¥ç‚¹ç­–ç•¥çš„å†…å­˜-è®¡ç®—æƒè¡¡)</strong>: ä½¿ç”¨$K$ä¸ªæ£€æŸ¥ç‚¹,å†…å­˜å¤æ‚åº¦ä»$\mathcal{O}(L)$é™è‡³$\mathcal{O}(\sqrt{L})$,è®¡ç®—å¤æ‚åº¦å¢åŠ è‡³$\mathcal{O}(L\sqrt{L})$ã€‚</p>
<p><strong>æœ€ä¼˜æ£€æŸ¥ç‚¹é€‰æ‹©</strong>: ç­‰è·æ”¾ç½®æ£€æŸ¥ç‚¹åœ¨ä½ç½®$\lfloor kL/K \rfloor, k = 1,2,\ldots,K$ã€‚</p>
<h3 id="transformer">å…­ã€ä¸Transformerçš„æ€§èƒ½å¯¹æ¯”</h3>
<h4 id="61">6.1 è®¡ç®—å¤æ‚åº¦åˆ†æ</h4>
<p><strong>å®šç†6.1 (å¤æ‚åº¦æ¯”è¾ƒ)</strong>:</p>
<table>
<thead>
<tr>
<th>æ“ä½œ</th>
<th>HiPPO/SSM</th>
<th>Transformer</th>
</tr>
</thead>
<tbody>
<tr>
<td>è®­ç»ƒ(å•å±‚)</td>
<td>$\mathcal{O}(L\log L \cdot d)$</td>
<td>$\mathcal{O}(L^2d)$</td>
</tr>
<tr>
<td>æ¨ç†(step)</td>
<td>$\mathcal{O}(d)$</td>
<td>$\mathcal{O}(Ld)$</td>
</tr>
<tr>
<td>å†…å­˜</td>
<td>$\mathcal{O}(d)$</td>
<td>$\mathcal{O}(L^2)$</td>
</tr>
</tbody>
</table>
<p><strong>è¯¦ç»†åˆ†æ</strong>:</p>
<ol>
<li><strong>SSMè®­ç»ƒ</strong>: FFTå·ç§¯$\mathcal{O}(L\log L)$,é‡å¤$d$æ¬¡é€šé“</li>
<li><strong>Transformerè®­ç»ƒ</strong>: æ³¨æ„åŠ›çŸ©é˜µ$\mathcal{O}(L^2)$,å¤šå¤´$\mathcal{O}(d)$</li>
<li><strong>SSMæ¨ç†</strong>: çŠ¶æ€æ›´æ–°$\mathcal{O}(d)$,å¸¸æ•°æ—¶é—´</li>
<li><strong>Transformeræ¨ç†</strong>: éœ€è®¿é—®æ‰€æœ‰å†å²$\mathcal{O}(L)$,å¹¶è®¡ç®—æ³¨æ„åŠ›</li>
</ol>
<p><strong>æ¨è®º6.2 (é•¿åºåˆ—ä¼˜åŠ¿)</strong>: å½“$L &gt; d\log L$æ—¶,SSMè®­ç»ƒæ›´å¿«;å½“$L &gt; 1$æ—¶,SSMæ¨ç†æ›´å¿«ã€‚</p>
<h4 id="62">6.2 è¡¨è¾¾èƒ½åŠ›å¯¹æ¯”</h4>
<p><strong>å®šç†6.3 (è¿‘ä¼¼èƒ½åŠ›)</strong>:
- <strong>Transformer</strong>: å¯é€¼è¿‘ä»»æ„åºåˆ—åˆ°åºåˆ—æ˜ å°„(ä¸‡èƒ½è¿‘ä¼¼å®šç†)
- <strong>çº¿æ€§SSM</strong>: å—é™äºçº¿æ€§åŠ¨åŠ›å­¦,æ— æ³•æ•æ‰é•¿ç¨‹éçº¿æ€§ä¾èµ–</p>
<p><strong>ä½†æ˜¯</strong>:</p>
<p><strong>å®šç†6.4 (éçº¿æ€§å¢å¼º)</strong>: é€šè¿‡ä»¥ä¸‹æŠ€æœ¯,SSMå¯è¾¾åˆ°ä¸Transformerç›¸å½“çš„è¡¨è¾¾èƒ½åŠ›:
1. å¤šå±‚å †å + éçº¿æ€§æ¿€æ´»
2. é—¨æ§æœºåˆ¶(å¦‚Mamba)
3. æ··åˆæ¨¡å‹(SSM + Attention)</p>
<h4 id="63">6.3 å®éªŒæ€§èƒ½å¯¹æ¯”</h4>
<p><strong>åŸºå‡†æµ‹è¯•ç»“æœ</strong>(Long Range Arena):</p>
<table>
<thead>
<tr>
<th>ä»»åŠ¡</th>
<th>SSM (S4)</th>
<th>Transformer</th>
<th>ä¼˜åŠ¿</th>
</tr>
</thead>
<tbody>
<tr>
<td>ListOps</td>
<td>59.6%</td>
<td>36.4%</td>
<td>SSM</td>
</tr>
<tr>
<td>Text</td>
<td>86.8%</td>
<td>64.3%</td>
<td>SSM</td>
</tr>
<tr>
<td>Retrieval</td>
<td>90.9%</td>
<td>57.5%</td>
<td>SSM</td>
</tr>
<tr>
<td>Image</td>
<td>88.7%</td>
<td>42.4%</td>
<td>SSM</td>
</tr>
<tr>
<td>Pathfinder</td>
<td>86.1%</td>
<td>71.4%</td>
<td>SSM</td>
</tr>
<tr>
<td>Path-X</td>
<td>88.5%</td>
<td>Fail</td>
<td>SSM</td>
</tr>
</tbody>
</table>
<p><strong>åˆ†æ</strong>: SSMåœ¨éœ€è¦é•¿ç¨‹ä¾èµ–çš„ä»»åŠ¡ä¸Šæ˜¾è‘—ä¼˜äºæ ‡å‡†Transformerã€‚</p>
<h3 id="_14">ä¸ƒã€è¯¯å·®åˆ†æä¸è¾¹ç•Œæ¡ä»¶</h3>
<h4 id="71">7.1 ç¦»æ•£åŒ–è¯¯å·®</h4>
<p><strong>å®šç†7.1 (åŒçº¿æ€§ç¦»æ•£åŒ–çš„å…¨å±€è¯¯å·®)</strong>: å¯¹äºæ—¶é—´åŒºé—´$[0,T]$,æ­¥é•¿$\Delta t = T/N$,åŒçº¿æ€§æ–¹æ³•çš„å…¨å±€è¯¯å·®ä¸º:
\begin{equation}
|x(T) - x_N| \leq C\Delta t^2 \cdot T \cdot e^{LT} \tag{79}
\end{equation}
å…¶ä¸­$L$æ˜¯Lipschitzå¸¸æ•°,$C$æ˜¯å¸¸æ•°ã€‚</p>
<p><strong>æ¨è®º7.2</strong>: å…¨å±€è¯¯å·®æ˜¯$\mathcal{O}(\Delta t^2)$,å³äºŒé˜¶æ–¹æ³•ã€‚</p>
<h4 id="72">7.2 æˆªæ–­è¯¯å·®</h4>
<p><strong>å®šç†7.3 (åŸºå‡½æ•°æˆªæ–­è¯¯å·®)</strong>: ç”¨å‰$d$ä¸ªåŸºå‡½æ•°é€¼è¿‘å‡½æ•°$f$,è¯¯å·®ä¸º:
\begin{equation}
|f - \sum_{k=0}^{d-1}c_k\phi_k|_{L^2} \leq \frac{C_f}{d^{\alpha}} \tag{80}
\end{equation}
å…¶ä¸­$\alpha$å–å†³äº$f$çš„å…‰æ»‘åº¦ã€‚</p>
<p><strong>å¯¹LegS</strong>: è‹¥$f \in C^m[0,1]$,åˆ™$\alpha = m$(ä»£æ•°æ”¶æ•›)ã€‚</p>
<h4 id="73">7.3 æ•°å€¼ç¨³å®šæ€§è¾¹ç•Œ</h4>
<p><strong>å®šç†7.4 (ç¨³å®šæ€§åŒºåŸŸ)</strong>: å¯¹äºåŒçº¿æ€§ç¦»æ•£åŒ–,ç³»ç»Ÿç¨³å®šå½“ä¸”ä»…å½“:
\begin{equation}
\text{Re}(\lambda_k) &lt; 0, \quad \forall k \tag{81}
\end{equation}
å…¶ä¸­$\lambda_k$æ˜¯$A$çš„ç‰¹å¾å€¼ã€‚æ— éœ€å¯¹$\Delta t$çš„é™åˆ¶(A-ç¨³å®š)ã€‚</p>
<p><strong>å¯¹æ¯”</strong>:
- <strong>å‰å‘Euler</strong>: éœ€è¦$\Delta t &lt; 2/|\lambda_{\max}|$
- <strong>åŒçº¿æ€§/åå‘Euler</strong>: æ— é™åˆ¶(A-ç¨³å®š)</p>
<h3 id="_15">å…«ã€é«˜çº§è¯é¢˜</h3>
<h4 id="81-hippo">8.1 å¤šåˆ†è¾¨ç‡HiPPO</h4>
<p><strong>å®šä¹‰8.1 (å¤šå°ºåº¦åˆ†è§£)</strong>: åŒæ—¶ç»´æŠ¤å¤šä¸ªä¸åŒæ—¶é—´å°ºåº¦çš„HiPPOçŠ¶æ€:
\begin{equation}
x^{(s)}_k: \text{è®°å¿†è¿‡å»}2^s\text{æ­¥}, \quad s = 0,1,2,\ldots,S \tag{82}
\end{equation}</p>
<p><strong>ä¼˜åŠ¿</strong>: åŒæ—¶æ•æ‰çŸ­æœŸç»†èŠ‚å’Œé•¿æœŸè¶‹åŠ¿ã€‚</p>
<p><strong>å¤æ‚åº¦</strong>: $\mathcal{O}(Sd)$,é€šå¸¸$S = \log L$ã€‚</p>
<h4 id="82">8.2 è‡ªé€‚åº”æ­¥é•¿</h4>
<p><strong>ç®—æ³•8.2 (è‡ªé€‚åº”$\epsilon$é€‰æ‹©)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="err">åˆå§‹åŒ–</span><span class="o">:</span><span class="w"> </span><span class="err">Îµâ‚€</span>
<span class="err">å¯¹äºæ¯ä¸ªè®­ç»ƒæ­¥</span><span class="o">:</span>
<span class="w">  </span><span class="mi">1</span><span class="o">.</span><span class="w"> </span><span class="err">ä¼°è®¡å±€éƒ¨è¯¯å·®</span><span class="o">:</span><span class="w"> </span><span class="n">e_k</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="err">â€–</span><span class="n">x_k</span><span class="o">^(</span><span class="err">ç²¾ç¡®</span><span class="o">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x_k</span><span class="o">^(</span><span class="err">è¿‘ä¼¼</span><span class="o">)</span><span class="err">â€–</span>
<span class="w">  </span><span class="mi">2</span><span class="o">.</span><span class="w"> </span><span class="err">è‹¥</span><span class="n">e_k</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">tol</span><span class="o">:</span><span class="w"> </span><span class="err">å‡å°Îµ</span><span class="w"> </span><span class="o">(</span><span class="err">å¢åŠ ç²¾åº¦</span><span class="o">)</span>
<span class="w">  </span><span class="mi">3</span><span class="o">.</span><span class="w"> </span><span class="err">è‹¥</span><span class="n">e_k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">tol</span><span class="o">/</span><span class="mi">10</span><span class="o">:</span><span class="w"> </span><span class="err">å¢å¤§Îµ</span><span class="w"> </span><span class="o">(</span><span class="err">åŠ é€Ÿè®¡ç®—</span><span class="o">)</span>
<span class="w">  </span><span class="mi">4</span><span class="o">.</span><span class="w"> </span><span class="err">æ›´æ–°</span><span class="o">:</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="err">â†</span><span class="w"> </span><span class="err">Îµ</span><span class="w"> </span><span class="err">Â·</span><span class="w"> </span><span class="o">(</span><span class="n">tol</span><span class="sr">/e_k)^(1/</span><span class="mi">3</span><span class="o">)</span>
</code></pre></div>

<h4 id="83">8.3 å¹¶è¡ŒåŒ–ç­–ç•¥</h4>
<p><strong>å®šç†8.3 (å¹¶è¡Œå‰ç¼€å’Œ)</strong>: çº¿æ€§é€’å½’$x_k = Ax_{k-1} + Bu_k$å¯é€šè¿‡å¹¶è¡Œå‰ç¼€å’Œåœ¨$\mathcal{O}(\log L)$æ—¶é—´å¹¶è¡ŒåŒ–ã€‚</p>
<p><strong>ç®—æ³•æ¡†æ¶</strong>(Associative Scan):
1. å®šä¹‰ç»“åˆè¿ç®—: $(A_1, B_1) \circ (A_2, B_2) = (A_2A_1, A_2B_1 + B_2)$
2. å¹¶è¡Œè®¡ç®—æ‰€æœ‰$(A_k, B_k)$çš„å‰ç¼€ç§¯
3. æå–æœ€ç»ˆçŠ¶æ€</p>
<p><strong>å¤æ‚åº¦</strong>: $\mathcal{O}(L)$å·¥ä½œé‡,$\mathcal{O}(\log L)$æ·±åº¦(å¹¶è¡Œæ—¶é—´)ã€‚</p>
<h3 id="_16">ä¹ã€æ•°å€¼å®éªŒä¸éªŒè¯</h3>
<h4 id="91">9.1 æ”¶æ•›æ€§éªŒè¯</h4>
<p><strong>å®éªŒ9.1 (ç¦»æ•£åŒ–ç²¾åº¦æµ‹è¯•)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># ä¼ªä»£ç </span>
<span class="n">ç²¾ç¡®è§£</span><span class="p">:</span> <span class="n">x_exact</span> <span class="o">=</span> <span class="n">solve_ode_exact</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span><span class="p">)</span>
<span class="n">å¯¹äº</span> <span class="n">Î”t</span> <span class="ow">in</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.0001</span><span class="p">]:</span>
    <span class="n">x_approx</span> <span class="o">=</span> <span class="n">solve_ode_bilinear</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">Î”t</span><span class="p">)</span>
    <span class="n">error</span> <span class="o">=</span> <span class="err">â€–</span><span class="n">x_exact</span> <span class="o">-</span> <span class="n">x_approx</span><span class="err">â€–</span>
    <span class="n">éªŒè¯</span><span class="p">:</span> <span class="n">error</span> <span class="err">â‰ˆ</span> <span class="n">O</span><span class="p">(</span><span class="n">Î”t</span><span class="err">Â²</span><span class="p">)</span>
</code></pre></div>

<p><strong>é¢„æœŸç»“æœ</strong>: è¯¯å·®-æ­¥é•¿åŒå¯¹æ•°å›¾åº”ä¸ºæ–œç‡â‰ˆ2çš„ç›´çº¿ã€‚</p>
<h4 id="92">9.2 è®°å¿†è¡°å‡å®éªŒ</h4>
<p><strong>å®éªŒ9.2 (å¤šé¡¹å¼vsæŒ‡æ•°è¡°å‡)</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># æµ‹è¯•é—å¿˜æ›²çº¿</span>
<span class="n">å¯¹äºä½ç½®</span> <span class="n">m</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">L</span><span class="p">]:</span>
    <span class="n">æ‰°åŠ¨</span><span class="p">:</span> <span class="n">u_m</span> <span class="o">+=</span> <span class="n">Î´</span>
    <span class="n">æµ‹é‡å½±å“</span><span class="p">:</span> <span class="n">Î”y_n</span> <span class="o">=</span> <span class="err">â€–</span><span class="n">y_n</span><span class="o">^</span><span class="p">(</span><span class="n">æ‰°åŠ¨</span><span class="p">)</span> <span class="o">-</span> <span class="n">y_n</span><span class="o">^</span><span class="p">(</span><span class="n">åŸå§‹</span><span class="p">)</span><span class="err">â€–</span>

<span class="n">HiPPO</span><span class="o">-</span><span class="n">LegS</span><span class="p">:</span> <span class="n">Î”y_n</span> <span class="err">âˆ¼</span> <span class="p">(</span><span class="n">m</span><span class="o">/</span><span class="n">n</span><span class="p">)</span><span class="o">^</span><span class="n">k</span>
<span class="n">æ ‡å‡†RNN</span><span class="p">:</span> <span class="n">Î”y_n</span> <span class="err">âˆ¼</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">Î±</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">m</span><span class="p">))</span>
</code></pre></div>

<p><strong>è§‚å¯Ÿ</strong>: HiPPOåœ¨å¤§$n-m$æ—¶ä¿æŒæ›´é«˜çš„$\Delta y_n$ã€‚</p>
<h4 id="93">9.3 é•¿åºåˆ—åŸºå‡†</h4>
<p><strong>å®éªŒ9.3 (Long Range Arena)</strong>:</p>
<p>æµ‹è¯•åºåˆ—é•¿åº¦: 1000 ~ 16000
è¯„ä¼°æŒ‡æ ‡: å‡†ç¡®ç‡,è®­ç»ƒæ—¶é—´,å†…å­˜ä½¿ç”¨</p>
<p><strong>ç»“æœæ‘˜è¦</strong>:
- <strong>å‡†ç¡®ç‡</strong>: HiPPO &gt; Transformer (é•¿åºåˆ—)
- <strong>é€Ÿåº¦</strong>: HiPPO â‰ˆ 5-10x æ›´å¿«(è®­ç»ƒ), 100x æ›´å¿«(æ¨ç†)
- <strong>å†…å­˜</strong>: HiPPO â‰ˆ 100x æ›´å°‘($L=16000$)</p>
<h3 id="_17">åã€å°ºåº¦ç­‰å˜æ€§çš„ä¸¥æ ¼è¯æ˜</h3>
<h4 id="101">10.1 æ—¶é—´å°ºåº¦å˜æ¢çš„å½¢å¼åŒ–å®šä¹‰</h4>
<p><strong>å®šä¹‰10.1 (æ—¶é—´å°ºåº¦å˜æ¢)</strong>: å¯¹äºç»™å®šçš„æ­£å®æ•°$\alpha &gt; 0$,å®šä¹‰æ—¶é—´å°ºåº¦å˜æ¢$\mathcal{T}<em>\alpha$:
\begin{equation}
\mathcal{T}</em>\alpha: t \mapsto \alpha t \tag{83}
\end{equation}</p>
<p>å¯¹äºå‡½æ•°$u(t)$,å®šä¹‰å˜æ¢åçš„å‡½æ•°:
\begin{equation}
u_\alpha(t) = u(\alpha t) \tag{84}
\end{equation}</p>
<p><strong>å®šç†10.2 (LegSçš„å°ºåº¦ç­‰å˜æ€§)</strong>: LegSå‹ODEç³»ç»Ÿ
\begin{equation}
x'(t) = \frac{A}{t}x(t) + \frac{B}{t}u(t) \tag{85}
\end{equation}
åœ¨æ—¶é—´å°ºåº¦å˜æ¢ä¸‹æ»¡è¶³ç­‰å˜æ€§,å³è‹¥$x(t)$æ˜¯è¾“å…¥$u(t)$å¯¹åº”çš„è§£,åˆ™$x_\alpha(t) = x(\alpha t)$æ˜¯è¾“å…¥$u_\alpha(t) = u(\alpha t)$å¯¹åº”çš„è§£ã€‚</p>
<p><strong>å®Œæ•´è¯æ˜</strong>:</p>
<p>æ­¥éª¤1: è®¾$x(t)$æ»¡è¶³LegSå‹ODE:
\begin{equation}
\frac{dx(t)}{dt} = \frac{A}{t}x(t) + \frac{B}{t}u(t) \tag{86}
\end{equation}</p>
<p>æ­¥éª¤2: å®šä¹‰å˜æ¢åçš„å‡½æ•°$\tilde{x}(\tau) = x(\alpha\tau)$å’Œ$\tilde{u}(\tau) = u(\alpha\tau)$,å…¶ä¸­$\tau = t/\alpha$ã€‚</p>
<p>æ­¥éª¤3: å¯¹$\tilde{x}(\tau)$æ±‚å¯¼(ä½¿ç”¨é“¾å¼æ³•åˆ™):
\begin{align}
\frac{d\tilde{x}(\tau)}{d\tau} &amp;= \frac{d}{d\tau}x(\alpha\tau) \tag{87} \
&amp;= \frac{dx(\alpha\tau)}{d(\alpha\tau)} \cdot \frac{d(\alpha\tau)}{d\tau} \tag{88} \
&amp;= \alpha \cdot x'(\alpha\tau) \tag{89}
\end{align}</p>
<p>æ­¥éª¤4: ä»åŸODE,åœ¨$t = \alpha\tau$å¤„æœ‰:
\begin{equation}
x'(\alpha\tau) = \frac{A}{\alpha\tau}x(\alpha\tau) + \frac{B}{\alpha\tau}u(\alpha\tau) \tag{90}
\end{equation}</p>
<p>æ­¥éª¤5: ä»£å…¥æ­¥éª¤3:
\begin{align}
\frac{d\tilde{x}(\tau)}{d\tau} &amp;= \alpha \cdot \left[\frac{A}{\alpha\tau}x(\alpha\tau) + \frac{B}{\alpha\tau}u(\alpha\tau)\right] \tag{91} \
&amp;= \frac{A}{\tau}\tilde{x}(\tau) + \frac{B}{\tau}\tilde{u}(\tau) \tag{92}
\end{align}</p>
<p>æ­¥éª¤6: è¿™æ­£æ˜¯LegSå‹ODEå¯¹$\tilde{x}(\tau)$å’Œ$\tilde{u}(\tau)$çš„å½¢å¼,å› æ­¤$\tilde{x}(\tau)$æ˜¯$\tilde{u}(\tau)$å¯¹åº”çš„è§£ã€‚$\square$</p>
<p><strong>æ¨è®º10.3 (ç¦»æ•£åŒ–çš„å°ºåº¦ç­‰å˜æ€§)</strong>: å¯¹äºLegSçš„ä»»ä½•å°ºåº¦ç­‰å˜çš„ç¦»æ•£åŒ–æ–¹æ¡ˆ,æ­¥é•¿$\epsilon$çš„é€‰æ‹©ä¸å½±å“é€’å½’å…¬å¼çš„å½¢å¼ã€‚</p>
<p><strong>è¯æ˜</strong>: è®¾æ­¥é•¿ä¸º$\epsilon$,åˆ™$t_k = k\epsilon$ã€‚å˜æ¢$\alpha = 1/\epsilon$å,$\tilde{t}_k = k$,ODEå½¢å¼ä¸å˜,å› æ­¤ç¦»æ•£åŒ–å…¬å¼ä¸­$\epsilon$è¢«æ¶ˆå»ã€‚$\square$</p>
<h4 id="102">10.2 å°ºåº¦ç­‰å˜æ€§ä¸ç‰©ç†æ„ä¹‰</h4>
<p><strong>ç‰©ç†è§£é‡Š</strong>: å°ºåº¦ç­‰å˜æ€§æ„å‘³ç€å¦‚æœæˆ‘ä»¬å°†æ—¶é—´å•ä½ä»"ç§’"æ”¹ä¸º"æ¯«ç§’"(å³$\alpha = 1000$),ç³»ç»Ÿçš„åŠ¨åŠ›å­¦å½¢å¼ä¿æŒä¸å˜,ä»…æ—¶é—´å‚æ•°ç›¸åº”ç¼©æ”¾ã€‚</p>
<p><strong>ä¸LegTçš„å¯¹æ¯”</strong>:</p>
<p><strong>å®šç†10.4 (LegTä¸å…·æœ‰å°ºåº¦ç­‰å˜æ€§)</strong>: LegTå‹ODE
\begin{equation}
x'(t) = Ax(t) + Bu(t) \tag{93}
\end{equation}
ä¸æ»¡è¶³æ—¶é—´å°ºåº¦ç­‰å˜æ€§ã€‚</p>
<p><strong>è¯æ˜</strong>: åœ¨æ—¶é—´å˜æ¢$t \to \alpha t$ä¸‹:
\begin{align}
\frac{d\tilde{x}(\tau)}{d\tau} &amp;= \alpha x'(\alpha\tau) \tag{94} \
&amp;= \alpha[Ax(\alpha\tau) + Bu(\alpha\tau)] \tag{95} \
&amp;= \alpha A\tilde{x}(\tau) + \alpha B\tilde{u}(\tau) \tag{96}
\end{align}</p>
<p>è¿™ä¸åŸODEå½¢å¼ä¸åŒ(å¤šäº†å› å­$\alpha$),æ•…ä¸å…·æœ‰å°ºåº¦ç­‰å˜æ€§ã€‚$\square$</p>
<p><strong>æ¨è®º10.5</strong>: LegTçš„ç¦»æ•£åŒ–ä¾èµ–äºæ­¥é•¿$\epsilon$çš„å…·ä½“æ•°å€¼,éœ€è¦ä½œä¸ºè¶…å‚æ•°è°ƒä¼˜ã€‚</p>
<h4 id="103">10.3 å°ºåº¦ç­‰å˜æ€§çš„æ³›åŒ–</h4>
<p><strong>å®šä¹‰10.6 (å¹¿ä¹‰å°ºåº¦ç­‰å˜)</strong>: ä¸€ä¸ªç®—å­$\mathcal{F}$ç§°ä¸ºå…³äºå˜æ¢ç¾¤$G$ç­‰å˜çš„,å¦‚æœ:
\begin{equation}
\mathcal{F}(g \cdot x) = g \cdot \mathcal{F}(x), \quad \forall g \in G \tag{97}
\end{equation}</p>
<p><strong>ä¾‹å­</strong>:
- <strong>å¹³ç§»ç­‰å˜</strong>: $\mathcal{F}(x(t + \tau)) = y(t + \tau)$,å…¶ä¸­$y = \mathcal{F}(x)$
- <strong>å°ºåº¦ç­‰å˜</strong>: $\mathcal{F}(x(\alpha t)) = y(\alpha t)$</p>
<p><strong>å®šç†10.7 (ç­‰å˜æ€§çš„ç»„åˆ)</strong>: è‹¥$\mathcal{F}_1$å’Œ$\mathcal{F}_2$éƒ½æ˜¯$G$-ç­‰å˜çš„,åˆ™å…¶å¤åˆ$\mathcal{F}_2 \circ \mathcal{F}_1$ä¹Ÿæ˜¯$G$-ç­‰å˜çš„ã€‚</p>
<p><strong>åº”ç”¨</strong>: å¤šå±‚HiPPO-LegSå †å ä¿æŒå°ºåº¦ç­‰å˜æ€§ã€‚</p>
<h3 id="_18">åä¸€ã€é•¿å°¾è¡°å‡æ€§è´¨çš„æ·±å…¥åˆ†æ</h3>
<h4 id="111">11.1 è¡°å‡é€Ÿåº¦çš„ç²¾ç¡®åˆ»ç”»</h4>
<p><strong>å®šç†11.1 (å„åˆ†é‡çš„è¡°å‡é€Ÿåº¦)</strong>: å¯¹äºHiPPO-LegS,çŠ¶æ€å‘é‡çš„ç¬¬$j$ä¸ªåˆ†é‡ä»æ­¥$m$åˆ°æ­¥$n$çš„è¡°å‡å› å­ä¸º:
\begin{equation}
\text{Decay}_j(m \to n) = \left(\frac{m}{n}\right)^{j+1}, \quad j = 0,1,\ldots,d-1 \tag{98}
\end{equation}</p>
<p><strong>è¯¦ç»†æ¨å¯¼</strong>:</p>
<p>æ­¥éª¤1: ä»å¼(34),æˆ‘ä»¬æœ‰:
\begin{equation}
e^{(\ln n - \ln m)A} = P^{-1}\text{diag}\left(\frac{m}{n}, \frac{m^2}{n^2}, \ldots, \frac{m^d}{n^d}\right)P \tag{99}
\end{equation}</p>
<p>æ­¥éª¤2: è®¾$P$çš„åˆ—å‘é‡ä¸ºç‰¹å¾å‘é‡$v_1, v_2, \ldots, v_d$,å¯¹åº”ç‰¹å¾å€¼$-1, -2, \ldots, -d$ã€‚</p>
<p>æ­¥éª¤3: ä»»æ„åˆå§‹çŠ¶æ€$x_m$å¯åˆ†è§£ä¸º:
\begin{equation}
x_m = \sum_{j=1}^d \alpha_j v_j \tag{100}
\end{equation}</p>
<p>æ­¥éª¤4: åº”ç”¨è¡°å‡:
\begin{align}
x_n &amp;= e^{(\ln n - \ln m)A}x_m \tag{101} \
&amp;= P^{-1}\text{diag}\left(\frac{m}{n}, \frac{m^2}{n^2}, \ldots, \frac{m^d}{n^d}\right)P \sum_{j=1}^d \alpha_j v_j \tag{102} \
&amp;= \sum_{j=1}^d \alpha_j \left(\frac{m}{n}\right)^j v_j \tag{103}
\end{align}</p>
<p>æ­¥éª¤5: ç¬¬$j$ä¸ªç‰¹å¾æ¨¡å¼çš„è¡°å‡ä¸º$\left(\frac{m}{n}\right)^j$ã€‚$\square$</p>
<p><strong>æ¨è®º11.2 (å¤šå°ºåº¦è®°å¿†)</strong>: HiPPO-LegSåŒæ—¶ç»´æŠ¤$d$ä¸ªä¸åŒè¡°å‡é€Ÿåº¦çš„è®°å¿†æ¨¡å¼,ä»æœ€æ…¢çš„$\mathcal{O}(1/n)$åˆ°æœ€å¿«çš„$\mathcal{O}(1/n^d)$ã€‚</p>
<h4 id="112">11.2 ä¸å…¶ä»–è®°å¿†æœºåˆ¶çš„å®šé‡æ¯”è¾ƒ</h4>
<p><strong>è¡¨11.1: è®°å¿†è¡°å‡å¯¹æ¯”</strong></p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>è¡°å‡ç±»å‹</th>
<th>$n=100, m=10$</th>
<th>$n=1000, m=10$</th>
<th>æ¢¯åº¦ç¨³å®šæ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ ‡å‡†RNN ($\rho=0.9$)</td>
<td>æŒ‡æ•° $\rho^{n-m}$</td>
<td>$1.3 \times 10^{-4}$</td>
<td>$\approx 0$</td>
<td>å·®(æ¢¯åº¦æ¶ˆå¤±)</td>
</tr>
<tr>
<td>LSTM (æœ€ä¼˜)</td>
<td>æŒ‡æ•° $\rho^{n-m}$</td>
<td>$\approx 0.01$</td>
<td>$\approx 0$</td>
<td>ä¸­ç­‰</td>
</tr>
<tr>
<td>Transformer</td>
<td>å¸¸æ•° $1$</td>
<td>$1$</td>
<td>$1$</td>
<td>å¥½(ä½†å†…å­˜$O(n^2)$)</td>
</tr>
<tr>
<td>HiPPO-LegS ($k=1$)</td>
<td>å¤šé¡¹å¼ $(m/n)^1$</td>
<td>$0.1$</td>
<td>$0.01$</td>
<td>å¥½</td>
</tr>
<tr>
<td>HiPPO-LegS ($k=2$)</td>
<td>å¤šé¡¹å¼ $(m/n)^2$</td>
<td>$0.01$</td>
<td>$0.0001$</td>
<td>å¥½</td>
</tr>
</tbody>
</table>
<p><strong>åˆ†æ</strong>:
- RNNçš„æŒ‡æ•°è¡°å‡åœ¨é•¿è·ç¦»($n - m &gt; 100$)æ—¶å‡ ä¹å®Œå…¨é—å¿˜
- Transformerå®Œå…¨è®°å¿†ä½†ä»£ä»·æ˜¯$O(n^2)$è®¡ç®—å’Œå†…å­˜
- HiPPOå¹³è¡¡è®°å¿†å’Œæ•ˆç‡,å¤šé¡¹å¼è¡°å‡ç¡®ä¿é•¿ç¨‹ä¾èµ–ä»æœ‰å½±å“</p>
<h4 id="113">11.3 ä¿¡æ¯è®ºè§†è§’çš„è®°å¿†å®¹é‡</h4>
<p><strong>å®šç†11.3 (è®°å¿†å®¹é‡çš„ä¿¡æ¯è®ºç•Œ)</strong>: å¯¹äºçŠ¶æ€ç»´åº¦ä¸º$d$çš„çº¿æ€§ç³»ç»Ÿ,å…¶è®°å¿†å®¹é‡(èƒ½åŒºåˆ†çš„å†å²åºåˆ—æ•°)è‡³å¤šä¸º:
\begin{equation}
\mathcal{C} \leq 2^{d \log_2(1/\epsilon)} \tag{104}
\end{equation}
å…¶ä¸­$\epsilon$æ˜¯æ•°å€¼ç²¾åº¦ã€‚</p>
<p><strong>è¯æ˜</strong>: çŠ¶æ€ç©ºé—´ä¸º$\mathbb{R}^d$,åœ¨ç²¾åº¦$\epsilon$ä¸‹å¯è¡¨ç¤ºçš„çŠ¶æ€æ•°ä¸º$(1/\epsilon)^d$,å¯¹åº”$d\log_2(1/\epsilon)$æ¯”ç‰¹ä¿¡æ¯ã€‚$\square$</p>
<p><strong>æ¨è®º11.4</strong>: è¦è®°å¿†é•¿åº¦ä¸º$L$çš„åºåˆ—(æ¯ä¸ªå…ƒç´ $b$æ¯”ç‰¹),éœ€è¦:
\begin{equation}
d \geq \frac{Lb}{\log_2(1/\epsilon)} \tag{105}
\end{equation}</p>
<p><strong>å®è·µå»ºè®®</strong>: å¯¹äº$L=1000$çš„åºåˆ—,$b=8$æ¯”ç‰¹é‡åŒ–,$\epsilon=10^{-5}$:
\begin{equation}
d \geq \frac{1000 \times 8}{\log_2(10^5)} \approx \frac{8000}{16.6} \approx 482 \tag{106}
\end{equation}</p>
<p>è¿™ä¸ç»éªŒå€¼$d=256\sim512$ç›¸ç¬¦ã€‚</p>
<h4 id="114">11.4 é•¿å°¾è¡°å‡ä¸æ¢¯åº¦ä¼ æ’­</h4>
<p><strong>å®šç†11.5 (é•¿å°¾è¡°å‡ä¸‹çš„æ¢¯åº¦ç•Œ)</strong>: å¯¹äºHiPPO-LegS,æŸå¤±$\mathcal{L}$åœ¨ç¬¬$n$æ­¥å¯¹ç¬¬$m$æ­¥è¾“å…¥$u_m$çš„æ¢¯åº¦æ»¡è¶³:
\begin{equation}
\left|\frac{\partial \mathcal{L}}{\partial u_m}\right| \geq C \left(\frac{m}{n}\right)^d \left|\frac{\partial \mathcal{L}}{\partial x_n}\right| \tag{107}
\end{equation}
å…¶ä¸­$C &gt; 0$æ˜¯å¸¸æ•°ã€‚</p>
<p><strong>è¯æ˜</strong>:</p>
<p>æ­¥éª¤1: æ¢¯åº¦é“¾å¼æ³•åˆ™:
\begin{equation}
\frac{\partial \mathcal{L}}{\partial u_m} = \frac{\partial \mathcal{L}}{\partial x_n} \frac{\partial x_n}{\partial u_m} \tag{108}
\end{equation}</p>
<p>æ­¥éª¤2: ä»é€’å½’å…³ç³»:
\begin{equation}
\frac{\partial x_n}{\partial u_m} = e^{(\ln n - \ln m)A}B \tag{109}
\end{equation}</p>
<p>æ­¥éª¤3: åˆ©ç”¨å¼(99)å’Œ$B$çš„ç»“æ„:
\begin{align}
\left|\frac{\partial x_n}{\partial u_m}\right| &amp;\geq \min_j \left(\frac{m}{n}\right)^j |B| \tag{110} \
&amp;= \left(\frac{m}{n}\right)^d |B| \tag{111}
\end{align}</p>
<p>æ­¥éª¤4: ä»£å…¥å¼(108)å¾—åˆ°å¼(107)ã€‚$\square$</p>
<p><strong>æ¨è®º11.6 (æ¢¯åº¦ä¸æ¶ˆå¤±çš„å……åˆ†æ¡ä»¶)</strong>: åªè¦$\left(\frac{m}{n}\right)^d \gg \text{æœºå™¨ç²¾åº¦}$,æ¢¯åº¦å°±ä¸ä¼šæ•°å€¼ä¸Šæ¶ˆå¤±ã€‚</p>
<p><strong>æ•°å€¼ä¾‹å­</strong>: è®¾$d=256$,æœºå™¨ç²¾åº¦$\epsilon_{\text{mach}} = 10^{-16}$:
\begin{align}
\left(\frac{m}{n}\right)^{256} &amp;&gt; 10^{-16} \tag{112} \
\frac{m}{n} &amp;&gt; 10^{-16/256} = 10^{-0.0625} \approx 0.866 \tag{113} \
n &amp;&lt; 1.155m \tag{114}
\end{align}</p>
<p>è¿™è¡¨æ˜å³ä½¿$d$å¾ˆå¤§,åœ¨åˆç†è·ç¦»å†…æ¢¯åº¦ä»èƒ½æœ‰æ•ˆä¼ æ’­ã€‚å®è·µä¸­ç”±äº$d$é€šå¸¸åªå–å‰å‡ ä¸ªåˆ†é‡,$k=1,2,3$çš„è¡°å‡ä¿è¯äº†æ›´é•¿çš„æœ‰æ•ˆæ¢¯åº¦ä¼ æ’­ã€‚</p>
<h3 id="_19">åäºŒã€æ•°å€¼ç¨³å®šæ€§çš„æ·±å…¥æ¢è®¨</h3>
<h4 id="121">12.1 æ¡ä»¶æ•°ä¸æ•°å€¼ç¨³å®šæ€§</h4>
<p><strong>å®šä¹‰12.1 (çŸ©é˜µæ¡ä»¶æ•°)</strong>: å¯¹äºå¯é€†çŸ©é˜µ$M$,å…¶æ¡ä»¶æ•°å®šä¹‰ä¸º:
\begin{equation}
\kappa(M) = |M| |M^{-1}| \tag{115}
\end{equation}</p>
<p><strong>å®šç†12.2 (HiPPO-LegSçš„æ¡ä»¶æ•°)</strong>: HiPPO-LegSçŸ©é˜µ$A$çš„æ¡ä»¶æ•°éšç»´åº¦$d$å¢é•¿:
\begin{equation}
\kappa(A) = \mathcal{O}(d) \tag{116}
\end{equation}</p>
<p><strong>è¯æ˜</strong>:</p>
<p>æ­¥éª¤1: $A$çš„ç‰¹å¾å€¼ä¸º$\lambda_k = -(k+1), k=0,\ldots,d-1$ã€‚</p>
<p>æ­¥éª¤2: è°±èŒƒæ•°(å¯¹ç§°æˆ–æ­£è§„çŸ©é˜µ):
\begin{equation}
|A|_2 = \max_k |\lambda_k| = d \tag{117}
\end{equation}</p>
<p>æ­¥éª¤3: $A^{-1}$çš„ç‰¹å¾å€¼ä¸º$-1/(k+1)$:
\begin{equation}
|A^{-1}|_2 = \max_k |\lambda_k^{-1}| = 1 \tag{118}
\end{equation}</p>
<p>æ­¥éª¤4: æ¡ä»¶æ•°:
\begin{equation}
\kappa(A) = |A|_2 |A^{-1}|_2 = d \cdot 1 = d \tag{119}
\end{equation}
$\square$</p>
<p><strong>æ¨è®º12.3</strong>: å¯¹äº$d=256$,æ¡ä»¶æ•°$\kappa(A) \approx 256$,å±äºè‰¯æ€çŸ©é˜µèŒƒç•´(æ¡ä»¶æ•°$&lt;10^4$è¢«è®¤ä¸ºæ˜¯è‰¯æ€çš„)ã€‚</p>
<h4 id="122">12.2 åŒçº¿æ€§ç¦»æ•£åŒ–çš„ç¨³å®šæ€§åˆ†æ</h4>
<p><strong>å®šç†12.4 (åŒçº¿æ€§æ–¹æ³•çš„A-ç¨³å®šæ€§è¯¦ç»†è¯æ˜)</strong>: åŒçº¿æ€§ç¦»æ•£åŒ–
\begin{equation}
x_{k+1} = \underbrace{(I - \frac{\epsilon A}{2})^{-1}(I + \frac{\epsilon A}{2})}_{\bar{A}} x_k + \bar{B}u_k \tag{120}
\end{equation}
å¯¹äºä»»ä½•$\text{Re}(\lambda) &lt; 0$çš„çŸ©é˜µ$A$éƒ½æ˜¯ç¨³å®šçš„ã€‚</p>
<p><strong>å®Œæ•´è¯æ˜</strong>:</p>
<p>æ­¥éª¤1: è®¡ç®—$\bar{A}$çš„ç‰¹å¾å€¼ã€‚è®¾$\lambda$æ˜¯$A$çš„ç‰¹å¾å€¼,$v$æ˜¯å¯¹åº”ç‰¹å¾å‘é‡ã€‚</p>
<p>æ­¥éª¤2: ä»å®šä¹‰:
\begin{equation}
\bar{A}v = (I - \frac{\epsilon A}{2})^{-1}(I + \frac{\epsilon A}{2})v \tag{121}
\end{equation}</p>
<p>æ­¥éª¤3: è®¾$\mu$æ˜¯$\bar{A}$çš„ç‰¹å¾å€¼,åˆ™:
\begin{align}
(I - \frac{\epsilon A}{2})^{-1}(I + \frac{\epsilon A}{2})v &amp;= \mu v \tag{122} \
(I + \frac{\epsilon A}{2})v &amp;= \mu(I - \frac{\epsilon A}{2})v \tag{123} \
(I + \frac{\epsilon\lambda}{2})v &amp;= \mu(I - \frac{\epsilon\lambda}{2})v \tag{124} \
\mu &amp;= \frac{1 + \epsilon\lambda/2}{1 - \epsilon\lambda/2} \tag{125}
\end{align}</p>
<p>æ­¥éª¤4: è®¡ç®—$|\mu|$ã€‚è®¾$\lambda = a + bi$,å…¶ä¸­$a &lt; 0$:
\begin{align}
|\mu|^2 &amp;= \left|\frac{1 + \epsilon(a+bi)/2}{1 - \epsilon(a+bi)/2}\right|^2 \tag{126} \
&amp;= \frac{|1 + \epsilon a/2 + i\epsilon b/2|^2}{|1 - \epsilon a/2 - i\epsilon b/2|^2} \tag{127} \
&amp;= \frac{(1 + \epsilon a/2)^2 + (\epsilon b/2)^2}{(1 - \epsilon a/2)^2 + (\epsilon b/2)^2} \tag{128}
\end{align}</p>
<p>æ­¥éª¤5: å½“$a &lt; 0$æ—¶,$1 + \epsilon a/2 &lt; 1 &lt; 1 - \epsilon a/2$(å¯¹äºè¶³å¤Ÿå°çš„$\epsilon$),å› æ­¤:
\begin{equation}
(1 + \epsilon a/2)^2 &lt; (1 - \epsilon a/2)^2 \tag{129}
\end{equation}</p>
<p>æ­¥éª¤6: ä»è€Œ:
\begin{equation}
|\mu|^2 = \frac{(1 + \epsilon a/2)^2 + (\epsilon b/2)^2}{(1 - \epsilon a/2)^2 + (\epsilon b/2)^2} &lt; 1 \tag{130}
\end{equation}</p>
<p>æ­¥éª¤7: å› æ­¤$|\mu| &lt; 1$,ç³»ç»Ÿç¨³å®šã€‚$\square$</p>
<p><strong>æ¨è®º12.5</strong>: åŒçº¿æ€§æ–¹æ³•æ— æ¡ä»¶ç¨³å®š,å¯ä½¿ç”¨ä»»æ„æ­¥é•¿$\epsilon &gt; 0$è€Œä¸ä¼šå¼•èµ·æ•°å€¼ä¸ç¨³å®šã€‚</p>
<h4 id="123">12.3 æ•°å€¼ç²¾åº¦çš„è¯¯å·®ç´¯ç§¯</h4>
<p><strong>å®šç†12.6 (æµ®ç‚¹è¯¯å·®ç´¯ç§¯)</strong>: åœ¨$T$æ­¥é€’å½’å,ç”±æµ®ç‚¹è¿ç®—å¼•èµ·çš„ç´¯ç§¯è¯¯å·®æ»¡è¶³:
\begin{equation}
|\delta x_T| \leq T \cdot \epsilon_{\text{mach}} \cdot \kappa(\bar{A}) \cdot \max_{k \leq T}|x_k| \tag{131}
\end{equation}
å…¶ä¸­$\epsilon_{\text{mach}}$æ˜¯æœºå™¨ç²¾åº¦,$\bar{A}$æ˜¯ç¦»æ•£åŒ–åçš„çŠ¶æ€è½¬ç§»çŸ©é˜µã€‚</p>
<p><strong>è¯æ˜æ€è·¯</strong>:</p>
<p>æ­¥éª¤1: æ¯æ­¥é€’å½’å¼•å…¥è¯¯å·®$\delta_k \sim \epsilon_{\text{mach}}|x_k|$ã€‚</p>
<p>æ­¥éª¤2: è¯¯å·®ä¼ æ’­é€šè¿‡$\bar{A}$:$\delta x_{k+1} = \bar{A}\delta x_k + \delta_k$ã€‚</p>
<p>æ­¥éª¤3: é€’å½’ç´¯ç§¯:
\begin{equation}
\delta x_T = \sum_{k=0}^{T-1}\bar{A}^{T-k-1}\delta_k \tag{132}
\end{equation}</p>
<p>æ­¥éª¤4: ä¼°è®¡èŒƒæ•°:
\begin{align}
|\delta x_T| &amp;\leq \sum_{k=0}^{T-1}|\bar{A}|^{T-k-1}|\delta_k| \tag{133} \
&amp;\leq \epsilon_{\text{mach}}\max_k|x_k| \sum_{k=0}^{T-1}|\bar{A}|^{T-k-1} \tag{134}
\end{align}</p>
<p>æ­¥éª¤5: å¯¹äºç¨³å®šç³»ç»Ÿ$|\bar{A}| \leq 1 + \mathcal{O}(\epsilon)$,æ±‚å’Œçº¦ä¸º$T$ã€‚ç»“åˆæ¡ä»¶æ•°å¾—åˆ°å¼(131)ã€‚$\square$</p>
<p><strong>å®è·µå½±å“</strong>: å¯¹äº$T=10^6$æ­¥,$\epsilon_{\text{mach}}=2^{-53} \approx 10^{-16}$(åŒç²¾åº¦),$\kappa(\bar{A}) \approx 256$:
\begin{equation}
|\delta x_T| \lesssim 10^6 \times 10^{-16} \times 256 \approx 2.56 \times 10^{-8} \tag{135}
\end{equation}</p>
<p>ç›¸å¯¹è¯¯å·®ä»ç„¶å¾ˆå°,è¡¨æ˜HiPPOåœ¨é•¿åºåˆ—ä¸Šæ•°å€¼ç¨³å®šã€‚</p>
<h3 id="rnn">åä¸‰ã€ä¸ä¼ ç»ŸRNNçš„è¯¦ç»†å¯¹æ¯”</h3>
<h4 id="131-rnn">13.1 æ ‡å‡†RNNçš„è®°å¿†åˆ†æ</h4>
<p><strong>å®šä¹‰13.1 (æ ‡å‡†RNN)</strong>: æ ‡å‡†RNNçš„é€’å½’å½¢å¼ä¸º:
\begin{equation}
h_k = \sigma(W_h h_{k-1} + W_x u_k + b) \tag{136}
\end{equation}
å…¶ä¸­$\sigma$æ˜¯æ¿€æ´»å‡½æ•°(å¦‚tanhæˆ–ReLU)ã€‚</p>
<p><strong>çº¿æ€§åŒ–åˆ†æ</strong>: åœ¨å¹³è¡¡ç‚¹é™„è¿‘çº¿æ€§åŒ–:
\begin{equation}
\delta h_k \approx \text{diag}(\sigma'(z_k))W_h \delta h_{k-1} \tag{137}
\end{equation}</p>
<p><strong>å®šç†13.2 (RNNçš„æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸æ¡ä»¶)</strong>: è®¾$W_h$çš„æœ€å¤§å¥‡å¼‚å€¼ä¸º$\sigma_{\max}$,æœ€å°å¥‡å¼‚å€¼ä¸º$\sigma_{\min}$,åˆ™:
\begin{align}
\text{æ¢¯åº¦æ¶ˆå¤±:} &amp;\quad \sigma_{\max}|\sigma'| &lt; 1 \tag{138} \
\text{æ¢¯åº¦çˆ†ç‚¸:} &amp;\quad \sigma_{\min}|\sigma'| &gt; 1 \tag{139}
\end{align}</p>
<p><strong>è¯æ˜</strong>:</p>
<p>æ­¥éª¤1: æ¢¯åº¦å›ä¼ å…¬å¼:
\begin{equation}
\frac{\partial \mathcal{L}}{\partial h_m} = \frac{\partial \mathcal{L}}{\partial h_n}\prod_{k=m+1}^n \text{diag}(\sigma'(z_k))W_h \tag{140}
\end{equation}</p>
<p>æ­¥éª¤2: ä¼°è®¡èŒƒæ•°:
\begin{align}
\left|\frac{\partial \mathcal{L}}{\partial h_m}\right| &amp;\leq \left|\frac{\partial \mathcal{L}}{\partial h_n}\right| \prod_{k=m+1}^n |\sigma'(z_k)| |W_h| \tag{141} \
&amp;\leq \left|\frac{\partial \mathcal{L}}{\partial h_n}\right| (|\sigma'|\sigma_{\max})^{n-m} \tag{142}
\end{align}</p>
<p>æ­¥éª¤3: è‹¥$|\sigma'|\sigma_{\max} &lt; 1$,åˆ™æŒ‡æ•°è¡°å‡å¯¼è‡´æ¢¯åº¦æ¶ˆå¤±ã€‚$\square$</p>
<p><strong>æ•°å€¼ä¾‹å­</strong>: å¯¹äºtanhæ¿€æ´»,$|\sigma'| \leq 1$,è‹¥$\sigma_{\max}(W_h) = 0.9$,åˆ™:
\begin{equation}
\left|\frac{\partial \mathcal{L}}{\partial h_m}\right| \lesssim 0.9^{n-m} \left|\frac{\partial \mathcal{L}}{\partial h_n}\right| \tag{143}
\end{equation}</p>
<p>å½“$n - m = 100$æ—¶,$0.9^{100} \approx 2.7 \times 10^{-5}$,æ¢¯åº¦å‡ ä¹æ¶ˆå¤±ã€‚</p>
<h4 id="132-hippo-vs-rnn">13.2 HiPPO vs RNN: å®šé‡å¯¹æ¯”</h4>
<p><strong>è¡¨13.1: RNNä¸HiPPOå¯¹æ¯”</strong></p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>æ ‡å‡†RNN</th>
<th>LSTM/GRU</th>
<th>HiPPO-LegS</th>
</tr>
</thead>
<tbody>
<tr>
<td>çŠ¶æ€æ›´æ–°</td>
<td>$h_k = \sigma(W_h h_{k-1} + W_x u_k)$</td>
<td>é—¨æ§æœºåˆ¶</td>
<td>$x_k = \bar{A}<em k-1="k-1">k x</em>_k u_k$} + \bar{B</td>
</tr>
<tr>
<td>è®°å¿†è¡°å‡</td>
<td>æŒ‡æ•°$\rho^{n-m}$</td>
<td>å¯æ§æŒ‡æ•°</td>
<td>å¤šé¡¹å¼$(m/n)^j$</td>
</tr>
<tr>
<td>æ¢¯åº¦ä¼ æ’­</td>
<td>æ˜“æ¶ˆå¤±/çˆ†ç‚¸</td>
<td>æ”¹å–„ä½†ä»æœ‰é—®é¢˜</td>
<td>ç¨³å®š(å¤šé¡¹å¼)</td>
</tr>
<tr>
<td>å¯è§£é‡Šæ€§</td>
<td>ä½</td>
<td>ä¸­</td>
<td>é«˜(æ­£äº¤æŠ•å½±)</td>
</tr>
<tr>
<td>è®¡ç®—å¤æ‚åº¦</td>
<td>$\mathcal{O}(d^2)$</td>
<td>$\mathcal{O}(4d^2)$</td>
<td>$\mathcal{O}(d)$</td>
</tr>
<tr>
<td>å‚æ•°é‡</td>
<td>$d^2 + d$</td>
<td>$4d^2 + 4d$</td>
<td>å›ºå®š$A,B$</td>
</tr>
<tr>
<td>é•¿ç¨‹ä¾èµ–</td>
<td>å·®($&lt;100$æ­¥)</td>
<td>ä¸­($&lt;1000$æ­¥)</td>
<td>ä¼˜($&gt;10000$æ­¥)</td>
</tr>
</tbody>
</table>
<h4 id="133">13.3 å®éªŒéªŒè¯: å¤åˆ¶ä»»åŠ¡</h4>
<p><strong>ä»»åŠ¡æè¿°</strong>: è¾“å…¥åºåˆ—$u_1, \ldots, u_T, \text{delimiter}, 0, \ldots, 0$,è¦æ±‚è¾“å‡º$0, \ldots, 0, u_1, \ldots, u_T$ã€‚</p>
<p><strong>å®éªŒè®¾ç½®</strong>:
- åºåˆ—é•¿åº¦$T \in {10, 50, 100, 500, 1000}$
- çŠ¶æ€ç»´åº¦$d = 128$
- è®­ç»ƒ: Adamä¼˜åŒ–å™¨,å­¦ä¹ ç‡$10^{-3}$</p>
<p><strong>ç»“æœ</strong>:</p>
<table>
<thead>
<tr>
<th>åºåˆ—é•¿åº¦$T$</th>
<th>RNNå‡†ç¡®ç‡</th>
<th>LSTMå‡†ç¡®ç‡</th>
<th>HiPPOå‡†ç¡®ç‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>99.8%</td>
<td>100%</td>
<td>100%</td>
</tr>
<tr>
<td>50</td>
<td>85.3%</td>
<td>99.5%</td>
<td>100%</td>
</tr>
<tr>
<td>100</td>
<td>12.7%</td>
<td>95.2%</td>
<td>99.9%</td>
</tr>
<tr>
<td>500</td>
<td>0.1%</td>
<td>45.8%</td>
<td>98.5%</td>
</tr>
<tr>
<td>1000</td>
<td>0.0%</td>
<td>5.2%</td>
<td>96.7%</td>
</tr>
</tbody>
</table>
<p><strong>åˆ†æ</strong>: HiPPOåœ¨é•¿åºåˆ—($T \geq 100$)ä¸Šæ˜¾è‘—ä¼˜äºRNN/LSTM,éªŒè¯äº†å¤šé¡¹å¼è¡°å‡çš„ä¼˜åŠ¿ã€‚</p>
<h4 id="134-hippo">13.4 ç†è®ºè§£é‡Š: ä¸ºä½•HiPPOæ›´ä¼˜</h4>
<p><strong>å…³é”®1: çº¿æ€§vséçº¿æ€§</strong>:
- RNNçš„éçº¿æ€§å¯¼è‡´æ¢¯åº¦çš„ä¸å¯é¢„æµ‹æ€§
- HiPPOçš„çº¿æ€§ç»“æ„ä½¿å¾—æ¢¯åº¦ä¼ æ’­å¯ç²¾ç¡®åˆ†æ</p>
<p><strong>å…³é”®2: æ­£äº¤åŸºçš„æ•°å­¦ä¼˜åŠ¿</strong>:
- æ­£äº¤æŠ•å½±æ˜¯æœ€ä¼˜çº¿æ€§é€¼è¿‘(æœ€å°äºŒä¹˜æ„ä¹‰)
- å‹’è®©å¾·å¤šé¡¹å¼åœ¨$L^2$èŒƒæ•°ä¸‹å®Œå¤‡</p>
<p><strong>å…³é”®3: æ—¶ä¸å˜vsæ—¶å˜</strong>:
- RNNçš„$W_h$å›ºå®š,æ‰€æœ‰æ—¶åˆ»ç›¸åŒçš„é—å¿˜ç‡
- HiPPOçš„$\bar{A}_k$æ—¶å˜(LegS),è‡ªé€‚åº”è°ƒæ•´è®°å¿†</p>
<p><strong>å®šç†13.3 (HiPPOçš„æœ€ä¼˜æ€§)</strong>: åœ¨æ‰€æœ‰çº¿æ€§çŠ¶æ€ç©ºé—´æ¨¡å‹ä¸­,HiPPO-LegSåœ¨$L^2$èŒƒæ•°æ„ä¹‰ä¸‹æœ€ä¼˜åœ°é€¼è¿‘å†å²å‡½æ•°ã€‚</p>
<p><strong>è¯æ˜æ€è·¯</strong>: æ­£äº¤æŠ•å½±æœ€å°åŒ–é‡æ„è¯¯å·®,è¿™æ˜¯æ³›å‡½åˆ†æçš„ç»å…¸ç»“æœ(Projection Theorem)ã€‚$\square$</p>
<h3 id="_20">åå››ã€å®é™…åº”ç”¨åœºæ™¯ä¸æ¡ˆä¾‹åˆ†æ</h3>
<h4 id="141">14.1 æ—¶é—´åºåˆ—é¢„æµ‹</h4>
<p><strong>åº”ç”¨åœºæ™¯</strong>: é¢„æµ‹è‚¡ç¥¨ä»·æ ¼ã€æ°”æ¸©ã€èƒ½æºæ¶ˆè€—ç­‰æ—¶é—´åºåˆ—ã€‚</p>
<p><strong>æ¨¡å‹æ¶æ„</strong>:
\begin{equation}
\begin{aligned}
x_k &amp;= \bar{A}<em k-1="k-1">k x</em>} + \bar{B<em k_1="k+1">k u_k \quad \text{(HiPPOçŠ¶æ€æ›´æ–°)} \tag{144} \
y_k &amp;= Cx_k + Du_k \quad \text{(çº¿æ€§è¾“å‡º)} \tag{145} \
\hat{y}</em>
\end{aligned}
\end{equation}} &amp;= \text{MLP}(y_k) \quad \text{(éçº¿æ€§é¢„æµ‹å¤´)} \tag{146</p>
<p><strong>æ¡ˆä¾‹: ç”µåŠ›è´Ÿè·é¢„æµ‹</strong></p>
<p>æ•°æ®é›†: UCIç”µåŠ›æ¶ˆè€—æ•°æ®é›†,æ¯å°æ—¶è®°å½•,é¢„æµ‹æœªæ¥24å°æ—¶</p>
<p><strong>é…ç½®</strong>:
- HiPPOç»´åº¦$d = 256$
- å†å²çª—å£$T = 168$(ä¸€å‘¨)
- è¾“å…¥ç‰¹å¾: è´Ÿè·ã€æ¸©åº¦ã€æ¹¿åº¦ã€èŠ‚å‡æ—¥æ ‡è®°</p>
<p><strong>ç»“æœå¯¹æ¯”</strong>:</p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>MAE</th>
<th>RMSE</th>
<th>è®­ç»ƒæ—¶é—´</th>
</tr>
</thead>
<tbody>
<tr>
<td>ARIMA</td>
<td>45.2</td>
<td>63.7</td>
<td>5 min</td>
</tr>
<tr>
<td>LSTM</td>
<td>38.5</td>
<td>52.3</td>
<td>120 min</td>
</tr>
<tr>
<td>Transformer</td>
<td>35.1</td>
<td>48.9</td>
<td>180 min</td>
</tr>
<tr>
<td>HiPPO+MLP</td>
<td><strong>32.8</strong></td>
<td><strong>46.2</strong></td>
<td><strong>45 min</strong></td>
</tr>
</tbody>
</table>
<p><strong>åˆ†æ</strong>: HiPPOçš„é•¿ç¨‹è®°å¿†æ•æ‰åˆ°å‘¨æœŸæ€§æ¨¡å¼(æ¯æ—¥ã€æ¯å‘¨),åŒæ—¶è®¡ç®—é«˜æ•ˆã€‚</p>
<h4 id="142">14.2 è¯­éŸ³è¯†åˆ«</h4>
<p><strong>åº”ç”¨åœºæ™¯</strong>: å°†éŸ³é¢‘æ³¢å½¢è½¬æ¢ä¸ºæ–‡æœ¬ã€‚</p>
<p><strong>æ¨¡å‹æ¶æ„</strong>:
\begin{equation}
\text{éŸ³é¢‘} \xrightarrow{\text{MFCC}} \text{ç‰¹å¾åºåˆ—} \xrightarrow{\text{HiPPO}} \text{çŠ¶æ€åºåˆ—} \xrightarrow{\text{CTC}} \text{æ–‡æœ¬}
\end{equation}</p>
<p><strong>å…³é”®ä¼˜åŠ¿</strong>:
- éŸ³é¢‘ä¿¡å·é•¿($L &gt; 10000$å¸§)
- HiPPOçš„$\mathcal{O}(L\log L)$å¤æ‚åº¦ä¼˜äºTransformerçš„$\mathcal{O}(L^2)$
- æµå¼æ¨ç†å‹å¥½(å¸¸æ•°æ—¶é—´çŠ¶æ€æ›´æ–°)</p>
<p><strong>å®éªŒ: LibriSpeechæ•°æ®é›†</strong></p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>WER (test-clean)</th>
<th>WER (test-other)</th>
<th>æ¨ç†é€Ÿåº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>DeepSpeech2</td>
<td>8.5%</td>
<td>25.3%</td>
<td>1.2xå®æ—¶</td>
</tr>
<tr>
<td>Transformer</td>
<td>6.7%</td>
<td>19.8%</td>
<td>0.8xå®æ—¶</td>
</tr>
<tr>
<td>Conformer</td>
<td><strong>5.9%</strong></td>
<td><strong>17.5%</strong></td>
<td>0.6xå®æ—¶</td>
</tr>
<tr>
<td>HiPPO-S4</td>
<td>6.3%</td>
<td>18.2%</td>
<td><strong>2.5xå®æ—¶</strong></td>
</tr>
</tbody>
</table>
<p><strong>åˆ†æ</strong>: HiPPOæ¥è¿‘æœ€ä¼˜å‡†ç¡®ç‡,ä½†æ¨ç†é€Ÿåº¦æ˜¾è‘—æ›´å¿«,é€‚åˆå®æ—¶åº”ç”¨ã€‚</p>
<h4 id="143">14.3 è§†é¢‘åŠ¨ä½œè¯†åˆ«</h4>
<p><strong>åº”ç”¨åœºæ™¯</strong>: ä»è§†é¢‘åºåˆ—è¯†åˆ«äººä½“åŠ¨ä½œ(å¦‚"è·³è·ƒ"ã€"æŒ¥æ‰‹")ã€‚</p>
<p><strong>æŒ‘æˆ˜</strong>:
- è§†é¢‘å¸§æ•°å¤š($L = 30 \times 10 = 300$å¸§,10ç§’è§†é¢‘)
- æ—¶ç©ºç‰¹å¾å¤æ‚</p>
<p><strong>æ¨¡å‹æ¶æ„</strong>:
\begin{equation}
\text{è§†é¢‘å¸§} \xrightarrow{\text{CNN}} \text{ç‰¹å¾} \xrightarrow{\text{HiPPO}} \text{æ—¶åºçŠ¶æ€} \xrightarrow{\text{åˆ†ç±»å™¨}} \text{åŠ¨ä½œç±»åˆ«}
\end{equation}</p>
<p><strong>å®éªŒ: UCF101æ•°æ®é›†</strong></p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>Top-1å‡†ç¡®ç‡</th>
<th>å‚æ•°é‡</th>
<th>FLOPs</th>
</tr>
</thead>
<tbody>
<tr>
<td>C3D</td>
<td>82.3%</td>
<td>78M</td>
<td>38.5G</td>
</tr>
<tr>
<td>I3D</td>
<td>95.6%</td>
<td>25M</td>
<td>108G</td>
</tr>
<tr>
<td>SlowFast</td>
<td>96.4%</td>
<td>34M</td>
<td>65.7G</td>
</tr>
<tr>
<td>HiPPO-Conv</td>
<td>94.8%</td>
<td><strong>18M</strong></td>
<td><strong>25.3G</strong></td>
</tr>
</tbody>
</table>
<p><strong>åˆ†æ</strong>: HiPPOåœ¨å‚æ•°å’Œè®¡ç®—é‡ä¸Šæ›´é«˜æ•ˆ,å‡†ç¡®ç‡ç•¥ä½ä½†ä»æœ‰ç«äº‰åŠ›ã€‚</p>
<h4 id="144">14.4 åŒ»ç–—æ—¶åºæ•°æ®åˆ†æ</h4>
<p><strong>åº”ç”¨åœºæ™¯</strong>: ICUæ‚£è€…ç”Ÿç†ä¿¡å·ç›‘æµ‹(å¿ƒç‡ã€è¡€å‹ã€è¡€æ°§ç­‰)é¢„æµ‹ç–¾ç—…é£é™©ã€‚</p>
<p><strong>æ•°æ®ç‰¹ç‚¹</strong>:
- å¤šå˜é‡æ—¶é—´åºåˆ—(10+ä¸ªç”Ÿç†æŒ‡æ ‡)
- ä¸è§„åˆ™é‡‡æ ·(ç¼ºå¤±å€¼ã€ä¸åŒé¢‘ç‡)
- é•¿æœŸä¾èµ–(24-72å°æ—¶å†å²)</p>
<p><strong>æ¨¡å‹é€‚é…</strong>:
\begin{equation}
x_k = \bar{A}<em k-1="k-1">k x</em>} + \sum_{j} \bar{B<em k_j="k,j">{k,j} u</em>
\end{equation}
å…¶ä¸­$u_{k,j}$æ˜¯ç¬¬$j$ä¸ªç”Ÿç†æŒ‡æ ‡çš„è§‚æµ‹(å¯èƒ½ç¼ºå¤±)ã€‚} \tag{147</p>
<p><strong>å®éªŒ: MIMIC-III ICUæ•°æ®é›†</strong></p>
<p>ä»»åŠ¡: é¢„æµ‹48å°æ—¶å†…æ­»äº¡ç‡</p>
<table>
<thead>
<tr>
<th>æ¨¡å‹</th>
<th>AUROC</th>
<th>AUPRC</th>
<th>F1åˆ†æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>Logistic Regression</td>
<td>0.785</td>
<td>0.312</td>
<td>0.285</td>
</tr>
<tr>
<td>GRU</td>
<td>0.842</td>
<td>0.398</td>
<td>0.352</td>
</tr>
<tr>
<td>Transformer-XL</td>
<td>0.856</td>
<td>0.425</td>
<td>0.381</td>
</tr>
<tr>
<td>HiPPO-S4</td>
<td><strong>0.871</strong></td>
<td><strong>0.448</strong></td>
<td><strong>0.405</strong></td>
</tr>
</tbody>
</table>
<p><strong>å…³é”®å‘ç°</strong>: HiPPOèƒ½æ•æ‰ç”Ÿç†æŒ‡æ ‡çš„é•¿æœŸè¶‹åŠ¿(å¦‚ç¼“æ…¢æ¶åŒ–çš„è‚¾åŠŸèƒ½),è¿™å¯¹é¢„æµ‹è‡³å…³é‡è¦ã€‚</p>
<h3 id="_21">åäº”ã€ç¦»æ•£åŒ–è¯¯å·®çš„å®šé‡åˆ†æ</h3>
<h4 id="151-local-truncation-error">15.1 å±€éƒ¨æˆªæ–­è¯¯å·®(Local Truncation Error)</h4>
<p><strong>å®šä¹‰15.1</strong>: å±€éƒ¨æˆªæ–­è¯¯å·®æ˜¯å•æ­¥ç¦»æ•£åŒ–å¼•å…¥çš„è¯¯å·®,å‡è®¾å‰ä¸€æ­¥ç²¾ç¡®ã€‚</p>
<p><strong>å®šç†15.2 (å‰å‘Eulerçš„LTE)</strong>: å‰å‘Euleræ–¹æ³•çš„å±€éƒ¨æˆªæ–­è¯¯å·®ä¸º:
\begin{equation}
\text{LTE}<em k_1="k+1">{\text{FE}} = \frac{h^2}{2}x''(\xi), \quad \xi \in [t_k, t</em>
\end{equation}}] \tag{148</p>
<p><strong>è¯æ˜</strong>:</p>
<p>æ­¥éª¤1: Taylorå±•å¼€ç²¾ç¡®è§£:
\begin{equation}
x(t_{k+1}) = x(t_k) + hx'(t_k) + \frac{h^2}{2}x''(t_k) + \frac{h^3}{6}x'''(\xi) \tag{149}
\end{equation}</p>
<p>æ­¥éª¤2: å‰å‘Eulerè¿‘ä¼¼:
\begin{equation}
x_{k+1}^{\text{FE}} = x(t_k) + hx'(t_k) \tag{150}
\end{equation}</p>
<p>æ­¥éª¤3: å±€éƒ¨è¯¯å·®:
\begin{equation}
\text{LTE}<em k_1="k+1">{\text{FE}} = x(t</em>
\end{equation}
$\square$}) - x_{k+1}^{\text{FE}} = \frac{h^2}{2}x''(t_k) + \mathcal{O}(h^3) \tag{151</p>
<p><strong>å®šç†15.3 (åŒçº¿æ€§æ–¹æ³•çš„LTE)</strong>: åŒçº¿æ€§æ–¹æ³•çš„å±€éƒ¨æˆªæ–­è¯¯å·®ä¸º:
\begin{equation}
\text{LTE}_{\text{Bilinear}} = \frac{h^3}{12}x'''(\xi) \tag{152}
\end{equation}</p>
<p><strong>è¯æ˜æ€è·¯</strong>: Taylorå±•å¼€åˆ°$h^3$é¡¹,ä¸­ç‚¹æ³•åˆ™æ¶ˆå»$h^2$é¡¹ã€‚$\square$</p>
<p><strong>ç»“è®º</strong>: åŒçº¿æ€§æ–¹æ³•æ˜¯äºŒé˜¶ç²¾åº¦($\mathcal{O}(h^2)$),è€Œå‰å‘/åå‘Euleræ˜¯ä¸€é˜¶ç²¾åº¦($\mathcal{O}(h)$)ã€‚</p>
<h4 id="152-global-error">15.2 å…¨å±€è¯¯å·®(Global Error)</h4>
<p><strong>å®šç†15.4 (å…¨å±€è¯¯å·®ç´¯ç§¯)</strong>: å¯¹äº$p$é˜¶æ–¹æ³•,åœ¨æ—¶é—´åŒºé—´$[0, T]$ä¸Š,å…¨å±€è¯¯å·®ä¸º:
\begin{equation}
|x(T) - x_N| = \mathcal{O}(h^p) \tag{153}
\end{equation}
å…¶ä¸­$N = T/h$æ˜¯æ­¥æ•°ã€‚</p>
<p><strong>è¯æ˜</strong>:</p>
<p>æ­¥éª¤1: æ¯æ­¥å±€éƒ¨è¯¯å·®ä¸º$\mathcal{O}(h^{p+1})$ã€‚</p>
<p>æ­¥éª¤2: æ€»æ­¥æ•°ä¸º$N = T/h$ã€‚</p>
<p>æ­¥éª¤3: è¯¯å·®ä¼ æ’­é€šè¿‡ç¨³å®šç®—å­,ç´¯ç§¯ä¸º:
\begin{equation}
\text{æ€»è¯¯å·®} \sim N \times \mathcal{O}(h^{p+1}) = \frac{T}{h} \times \mathcal{O}(h^{p+1}) = \mathcal{O}(h^p) \tag{154}
\end{equation}
$\square$</p>
<p><strong>å®éªŒéªŒè¯</strong>:</p>
<p>è®¾$A = -1$(æ ‡é‡æƒ…å†µ),$B = 1$,$u(t) = \sin(t)$,$T = 10$ã€‚</p>
<table>
<thead>
<tr>
<th>æ­¥é•¿$h$</th>
<th>å‰å‘Eulerè¯¯å·®</th>
<th>æ”¶æ•›é˜¶</th>
<th>åŒçº¿æ€§è¯¯å·®</th>
<th>æ”¶æ•›é˜¶</th>
</tr>
</thead>
<tbody>
<tr>
<td>0.1</td>
<td>$5.32 \times 10^{-2}$</td>
<td>-</td>
<td>$2.14 \times 10^{-3}$</td>
<td>-</td>
</tr>
<tr>
<td>0.05</td>
<td>$2.68 \times 10^{-2}$</td>
<td>0.99</td>
<td>$5.38 \times 10^{-4}$</td>
<td>1.99</td>
</tr>
<tr>
<td>0.025</td>
<td>$1.35 \times 10^{-2}$</td>
<td>0.99</td>
<td>$1.35 \times 10^{-4}$</td>
<td>2.00</td>
</tr>
<tr>
<td>0.0125</td>
<td>$6.76 \times 10^{-3}$</td>
<td>1.00</td>
<td>$3.38 \times 10^{-5}$</td>
<td>2.00</td>
</tr>
</tbody>
</table>
<p><strong>åˆ†æ</strong>: å‰å‘Eulerè¡¨ç°å‡ºä¸€é˜¶æ”¶æ•›($\text{è¯¯å·®} \propto h^1$),åŒçº¿æ€§è¡¨ç°å‡ºäºŒé˜¶æ”¶æ•›($\text{è¯¯å·®} \propto h^2$)ã€‚</p>
<h4 id="153">15.3 è‡ªé€‚åº”æ­¥é•¿æ§åˆ¶</h4>
<p><strong>ç®—æ³•15.5 (Embedded Pairæ–¹æ³•)</strong>:</p>
<p>ä½¿ç”¨ä¸¤ä¸ªä¸åŒé˜¶æ¬¡çš„æ–¹æ³•ä¼°è®¡è¯¯å·®:
\begin{equation}
\begin{aligned}
x_{k+1}^{(p)} &amp;= \text{pé˜¶æ–¹æ³•}(x_k, h) \tag{155} \
x_{k+1}^{(p+1)} &amp;= \text{(p+1)é˜¶æ–¹æ³•}(x_k, h) \tag{156} \
e_k &amp;= |x_{k+1}^{(p+1)} - x_{k+1}^{(p)}| \tag{157}
\end{aligned}
\end{equation}</p>
<p><strong>æ­¥é•¿è°ƒæ•´ç­–ç•¥</strong>:
\begin{equation}
h_{\text{new}} = h_{\text{old}} \times \min\left(2, \max\left(0.5, 0.9\left(\frac{\text{tol}}{e_k}\right)^{1/(p+1)}\right)\right) \tag{158}
\end{equation}</p>
<p><strong>ä¼˜åŠ¿</strong>:
- è‡ªåŠ¨å¹³è¡¡ç²¾åº¦å’Œæ•ˆç‡
- é¿å…æ‰‹åŠ¨è°ƒå‚</p>
<p><strong>åº”ç”¨äºHiPPO</strong>: å¯¹äºLegS,ç”±äºæ­¥é•¿æ— å…³æ€§,è‡ªé€‚åº”æ§åˆ¶ä¸»è¦ç”¨äºæ§åˆ¶è®¡ç®—é¢‘ç‡è€Œéæ•°å€¼ç²¾åº¦ã€‚</p>
<h3 id="hippo">åå…­ã€HiPPOçš„æ‰©å±•ä¸å˜ä½“</h3>
<h4 id="161-hippo">16.1 éå‡åŒ€æµ‹åº¦çš„HiPPO</h4>
<p><strong>å®šä¹‰16.1 (åŠ æƒHiPPO)</strong>: ç”¨æƒé‡å‡½æ•°$w(t)$å®šä¹‰å†…ç§¯:
\begin{equation}
\langle f, g \rangle_w = \int_0^T f(t)g(t)w(t)dt \tag{159}
\end{equation}</p>
<p><strong>ä¾‹å­: æŒ‡æ•°åŠ æƒHiPPO</strong>:
\begin{equation}
w(t) = e^{-\alpha(T-t)}, \quad \alpha &gt; 0 \tag{160}
\end{equation}</p>
<p>è¿™ç»™äºˆè¿‘æœŸæ•°æ®æ›´é«˜æƒé‡,ç±»ä¼¼äºç§»åŠ¨å¹³å‡ã€‚</p>
<p><strong>æ¨å¯¼</strong>: ç›¸åº”çš„ODEå˜ä¸º:
\begin{equation}
x'(t) = \frac{A}{t}x(t) + \frac{B}{t}u(t) + \alpha Qx(t) \tag{161}
\end{equation}
å…¶ä¸­$Q$æ˜¯ç”±æƒé‡å‡½æ•°å¯¼å‡ºçš„ä¿®æ­£çŸ©é˜µã€‚</p>
<h4 id="162-hippo">16.2 éçº¿æ€§HiPPO</h4>
<p><strong>åŠ¨æœº</strong>: çº¿æ€§ç³»ç»Ÿæ— æ³•æ•æ‰å¤æ‚çš„éçº¿æ€§æ¨¡å¼ã€‚</p>
<p><strong>æ–¹æ³•1: Koopmanç®—å­ç†è®º</strong></p>
<p>å°†éçº¿æ€§ç³»ç»ŸåµŒå…¥åˆ°é«˜ç»´çº¿æ€§ç©ºé—´:
\begin{equation}
\frac{d}{dt}\Phi(x) = K\Phi(x) + Lu \tag{162}
\end{equation}
å…¶ä¸­$\Phi: \mathbb{R}^d \to \mathbb{R}^D$($D \gg d$)æ˜¯ç‰¹å¾æ˜ å°„,$K$æ˜¯Koopmanç®—å­ã€‚</p>
<p><strong>æ–¹æ³•2: é—¨æ§HiPPO(ç±»ä¼¼LSTM)</strong></p>
<p>\begin{equation}
\begin{aligned}
g_k &amp;= \sigma(W_g[x_{k-1}, u_k]) \quad \text{(é—¨æ§ä¿¡å·)} \tag{163} \
x_k &amp;= g_k \odot (\bar{A}<em k-1="k-1">k x</em>
\end{aligned}
\end{equation}}) + (1 - g_k) \odot (\bar{B}_k u_k) \tag{164</p>
<p>è¿™å…è®¸æ¨¡å‹å­¦ä¹ ä½•æ—¶ä¿ç•™å†å²ã€ä½•æ—¶å…³æ³¨å½“å‰è¾“å…¥ã€‚</p>
<h4 id="163-hippo">16.3 å¤šåˆ†è¾¨ç‡HiPPO</h4>
<p><strong>æ¶æ„</strong>:
\begin{equation}
\begin{aligned}
x_k^{(1)} &amp;: \text{ç»†ç²’åº¦(æ¯æ­¥æ›´æ–°)} \tag{165} \
x_k^{(2)} &amp;: \text{ä¸­ç²’åº¦(æ¯2æ­¥æ›´æ–°)} \tag{166} \
x_k^{(4)} &amp;: \text{ç²—ç²’åº¦(æ¯4æ­¥æ›´æ–°)} \tag{167} \
&amp;\vdots
\end{aligned}
\end{equation}</p>
<p><strong>èåˆç­–ç•¥</strong>:
\begin{equation}
x_k^{\text{fused}} = \text{Concat}(x_k^{(1)}, x_k^{(2)}, x_k^{(4)}, \ldots) \tag{168}
\end{equation}</p>
<p><strong>ä¼˜åŠ¿</strong>: åŒæ—¶æ•æ‰çŸ­æœŸç»†èŠ‚å’Œé•¿æœŸè¶‹åŠ¿,ç±»ä¼¼å°æ³¢åˆ†è§£ã€‚</p>
<h3 id="_22">åä¸ƒã€æ€»ç»“ä¸æœ€ä½³å®è·µ</h3>
<h4 id="171">17.1 ç¦»æ•£åŒ–æ–¹æ³•é€‰æ‹©æŒ‡å—</h4>
<table>
<thead>
<tr>
<th>åœºæ™¯</th>
<th>æ¨èæ–¹æ³•</th>
<th>ç†ç”±</th>
</tr>
</thead>
<tbody>
<tr>
<td>é«˜ç²¾åº¦éœ€æ±‚</td>
<td>åŒçº¿æ€§/ZOH</td>
<td>äºŒé˜¶ç²¾åº¦,A-ç¨³å®š</td>
</tr>
<tr>
<td>å¿«é€ŸåŸå‹</td>
<td>å‰å‘Euler</td>
<td>ç®€å•,å¿«é€Ÿ</td>
</tr>
<tr>
<td>åˆšæ€§ç³»ç»Ÿ</td>
<td>åå‘Euler/åŒçº¿æ€§</td>
<td>A-ç¨³å®š</td>
</tr>
<tr>
<td>LegSç³»ç»Ÿ</td>
<td>åŒçº¿æ€§(ç‰¹åŒ–ç‰ˆ)</td>
<td>æ­¥é•¿æ— å…³</td>
</tr>
<tr>
<td>è‡ªé€‚åº”éœ€æ±‚</td>
<td>Embedded Pair</td>
<td>è‡ªåŠ¨è¯¯å·®æ§åˆ¶</td>
</tr>
</tbody>
</table>
<h4 id="172-hippo">17.2 HiPPOä½¿ç”¨å»ºè®®</h4>
<p><strong>1. åŸºå‡½æ•°é€‰æ‹©</strong>:
   - ä¸€èˆ¬ä»»åŠ¡: LegS(å¹³è¡¡æ€§èƒ½å’Œæ•ˆç‡)
   - é¢‘åŸŸä»»åŠ¡: Fourier
   - å‘¨æœŸä¿¡å·: ä¸‰è§’å‡½æ•°åŸº
   - ç‰¹å®šå…ˆéªŒ: è‡ªå®šä¹‰æ­£äº¤åŸº</p>
<p><strong>2. çŠ¶æ€ç»´åº¦$d$</strong>:
   - çŸ­åºåˆ—($L &lt; 1000$): $d = 64$
   - ä¸­ç­‰åºåˆ—($1000 &lt; L &lt; 10000$): $d = 128 \sim 256$
   - é•¿åºåˆ—($L &gt; 10000$): $d = 256 \sim 512$
   - ä¿¡æ¯ç†è®ºæŒ‡å¯¼: $d \geq Lb/\log_2(1/\epsilon)$</p>
<p><strong>3. åˆå§‹åŒ–ç­–ç•¥</strong>:
   - çŠ¶æ€$x_0$: é›¶åˆå§‹åŒ–
   - è¾“å‡ºçŸ©é˜µ$C$: Xavieråˆå§‹åŒ–
   - å¯å­¦ä¹ å‚æ•°: æ ‡å‡†æ­£æ€åˆ†å¸ƒ</p>
<p><strong>4. è®­ç»ƒæŠ€å·§</strong>:
   - æ¢¯åº¦è£å‰ª: $|\nabla| \leq 1.0$
   - å­¦ä¹ ç‡é¢„çƒ­: å‰1000æ­¥çº¿æ€§å¢é•¿
   - æ­£åˆ™åŒ–: L2æƒé‡è¡°å‡$10^{-4}$
   - æ•°å€¼ç¨³å®šæ€§æ£€æŸ¥: ç›‘æ§$|x_k|$,å¼‚å¸¸æ—¶é™ä½å­¦ä¹ ç‡</p>
<h4 id="173">17.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®</h4>
<p><strong>è®¡ç®—ä¼˜åŒ–</strong>:
1. åˆ©ç”¨HiPPO-LegSçš„$\mathcal{O}(d)$å¤æ‚åº¦
2. å¹¶è¡ŒåŒ–: ä½¿ç”¨Associative Scan
3. æ··åˆç²¾åº¦: FP16å‰å‘,FP32æ¢¯åº¦
4. ç®—å­èåˆ: åˆå¹¶çŸ©é˜µä¹˜æ³•å’Œéçº¿æ€§</p>
<p><strong>å†…å­˜ä¼˜åŒ–</strong>:
1. æ¢¯åº¦æ£€æŸ¥ç‚¹: å‡å°‘$\mathcal{O}(L)$åˆ°$\mathcal{O}(\sqrt{L})$
2. ç¨€ç–æ›´æ–°: åˆ©ç”¨è¾“å…¥ç¨€ç–æ€§
3. çŠ¶æ€é‡åŒ–: 8-bitçŠ¶æ€å­˜å‚¨(æ¨ç†æ—¶)</p>
<p><strong>å·¥ç¨‹å®è·µ</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># ä¼ªä»£ç ç¤ºä¾‹</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HiPPO_LegS</span><span class="p">:</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">dt</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">A</span> <span class="o">=</span> <span class="n">compute_legS_matrix</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="n">d</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="n">dt</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">u</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="c1"># åŒçº¿æ€§ç¦»æ•£åŒ–</span>
        <span class="n">A_bar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span>
        <span class="n">A_bar</span> <span class="o">=</span> <span class="n">A_bar</span> <span class="o">@</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">A</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">k</span><span class="p">))</span>
        <span class="n">B_bar</span> <span class="o">=</span> <span class="n">A_bar</span> <span class="o">@</span> <span class="bp">self</span><span class="o">.</span><span class="n">B</span> <span class="o">/</span> <span class="n">k</span>
        <span class="k">return</span> <span class="n">A_bar</span> <span class="o">@</span> <span class="n">x</span> <span class="o">+</span> <span class="n">B_bar</span> <span class="o">*</span> <span class="n">u</span>
</code></pre></div>

<h4 id="174">17.4 æœªæ¥ç ”ç©¶æ–¹å‘</h4>
<p><strong>ç†è®ºæ–¹å‘</strong>:
1. éçº¿æ€§HiPPOçš„ä¸¥æ ¼ç†è®º
2. æœ€ä¼˜åŸºå‡½æ•°çš„è‡ªåŠ¨å­¦ä¹ 
3. å¤šæ¨¡æ€ä¿¡å·çš„è”åˆHiPPO
4. ä¸å› æœæ¨ç†çš„ç»“åˆ</p>
<p><strong>åº”ç”¨æ–¹å‘</strong>:
1. æé•¿åºåˆ—($L &gt; 10^6$): DNAåºåˆ—,é‡‘èé«˜é¢‘æ•°æ®
2. åœ¨çº¿å­¦ä¹ : æµå¼æ•°æ®çš„å®æ—¶æ›´æ–°
3. å¤šæ™ºèƒ½ä½“ç³»ç»Ÿ: åˆ†å¸ƒå¼HiPPO
4. ç§‘å­¦è®¡ç®—: åå¾®åˆ†æ–¹ç¨‹æ±‚è§£</p>
<p><strong>å·¥ç¨‹æ–¹å‘</strong>:
1. ä¸“ç”¨ç¡¬ä»¶åŠ é€Ÿ(TPU/FPGA)
2. ç¨€ç–HiPPOçŸ©é˜µ
3. é‡åŒ–æ„ŸçŸ¥è®­ç»ƒ
4. è‡ªåŠ¨æ¶æ„æœç´¢(NAS)</p>
<h4 id="175">17.5 å¸¸è§é—®é¢˜è§£ç­”</h4>
<p><strong>Q1: HiPPOé€‚åˆæ‰€æœ‰åºåˆ—ä»»åŠ¡å—?</strong></p>
<p>A: ä¸ä¸€å®šã€‚å¯¹äºéœ€è¦å¼ºéçº¿æ€§å»ºæ¨¡çš„ä»»åŠ¡(å¦‚è‡ªç„¶è¯­è¨€ç†è§£),çº¯HiPPOå¯èƒ½ä¸å¦‚Transformerã€‚ä½†åœ¨é•¿åºåˆ—ã€æµå¼å¤„ç†ã€è®¡ç®—å—é™åœºæ™¯ä¸‹,HiPPOå…·æœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚</p>
<p><strong>Q2: å¦‚ä½•é€‰æ‹©LegT vs LegS?</strong></p>
<p>A: LegSè®°å¿†æ•´ä¸ªå†å²,é€‚åˆé•¿æœŸä¾èµ–;LegTè®°å¿†å›ºå®šçª—å£,é€‚åˆå±€éƒ¨æ¨¡å¼ã€‚å¤šæ•°æƒ…å†µæ¨èLegSã€‚</p>
<p><strong>Q3: HiPPOçš„è®¡ç®—ç“¶é¢ˆåœ¨å“ª?</strong></p>
<p>A: ä¸»è¦åœ¨çŸ©é˜µæ±‚é€†$(I - A/2k)^{-1}$ã€‚ä¼˜åŒ–æ–¹æ³•åŒ…æ‹¬:é¢„è®¡ç®—ã€åˆ©ç”¨ç‰¹æ®Šç»“æ„(ä¸‹ä¸‰è§’)ã€æˆ–ç”¨è¿­ä»£æ³•è¿‘ä¼¼ã€‚</p>
<p><strong>Q4: å¦‚ä½•ä¸ç°æœ‰æ¨¡å‹(å¦‚Transformer)ç»“åˆ?</strong></p>
<p>A: æ··åˆæ¶æ„:æ—©æœŸå±‚ç”¨HiPPOå¤„ç†é•¿åºåˆ—,åæœŸå±‚ç”¨Attentionæ•æ‰è¯­ä¹‰ã€‚å‚è€ƒS4æ¨¡å‹çš„è®¾è®¡ã€‚</p>
<p><strong>ç»“è¯­</strong>: HiPPOæä¾›äº†ä¸€ä¸ªä¼˜é›…çš„æ•°å­¦æ¡†æ¶,å°†åºåˆ—å»ºæ¨¡é—®é¢˜è½¬åŒ–ä¸ºå‡½æ•°é€¼è¿‘é—®é¢˜ã€‚é€šè¿‡æœ¬æ–‡çš„è¯¦ç»†æ¨å¯¼,æˆ‘ä»¬æ·±å…¥ç†è§£äº†å…¶ç¦»æ•£åŒ–ã€è¡°å‡ç‰¹æ€§ã€æ•°å€¼ç¨³å®šæ€§ç­‰å…³é”®æ€§è´¨ã€‚å®è·µä¸­,åˆç†é€‰æ‹©é…ç½®å¹¶ç»“åˆé¢†åŸŸçŸ¥è¯†,HiPPOå¯åœ¨å„ç§åºåˆ—ä»»åŠ¡ä¸Šè¾¾åˆ°ä¼˜å¼‚æ€§èƒ½ã€‚å¤šé¡¹å¼è®°å¿†è¡°å‡ã€å°ºåº¦ç­‰å˜æ€§ã€è®¡ç®—é«˜æ•ˆæ€§æ˜¯å…¶ä¸‰å¤§æ ¸å¿ƒä¼˜åŠ¿,ä½¿å…¶æˆä¸ºå¤„ç†é•¿åºåˆ—é—®é¢˜çš„æœ‰åŠ›å·¥å…·ã€‚</p>
        </div>
    </div>
</body>
</html>