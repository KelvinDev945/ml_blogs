<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸‰ï¼‰ï¼šDDPM = è´å¶æ–¯ + å»å™ª</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸‰ï¼‰ï¼šDDPM = è´å¶æ–¯ + å»å™ª</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 61.5 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9164">https://spaces.ac.cn/archives/9164</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œç¬”è€…ç»™å‡ºäº†ç”Ÿæˆæ‰©æ•£æ¨¡å‹DDPMçš„ä¸¤ç§æ¨å¯¼ï¼Œåˆ†åˆ«æ˜¯<a href="/archives/9119">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸€ï¼‰ï¼šDDPM = æ‹†æ¥¼ + å»ºæ¥¼ã€‹</a>ä¸­çš„é€šä¿—ç±»æ¯”æ–¹æ¡ˆå’Œ<a href="/archives/9152">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒï¼‰ï¼šDDPM = è‡ªå›å½’å¼VAEã€‹</a>ä¸­çš„å˜åˆ†è‡ªç¼–ç å™¨æ–¹æ¡ˆã€‚ä¸¤ç§æ–¹æ¡ˆå¯è°“å„æœ‰ç‰¹ç‚¹ï¼Œå‰è€…æ›´ä¸ºç›´ç™½æ˜“æ‡‚ï¼Œä½†æ— æ³•åšæ›´å¤šçš„ç†è®ºå»¶ä¼¸å’Œå®šé‡ç†è§£ï¼Œåè€…ç†è®ºåˆ†æä¸Šæ›´åŠ å®Œå¤‡ä¸€äº›ï¼Œä½†ç¨æ˜¾å½¢å¼åŒ–ï¼Œå¯å‘æ€§ä¸è¶³ã€‚</p>
<p><a href="/usr/uploads/2022/07/3685027055.jpeg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="è´å¶æ–¯å®šç†ï¼ˆæ¥è‡ªç»´åŸºç™¾ç§‘ï¼‰" src="/usr/uploads/2022/07/3685027055.jpeg" /></a></p>
<p>è´å¶æ–¯å®šç†ï¼ˆæ¥è‡ªç»´åŸºç™¾ç§‘ï¼‰</p>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å†åˆ†äº«DDPMçš„ä¸€ç§æ¨å¯¼ï¼Œå®ƒä¸»è¦åˆ©ç”¨åˆ°äº†è´å¶æ–¯å®šç†æ¥ç®€åŒ–è®¡ç®—ï¼Œæ•´ä¸ªè¿‡ç¨‹çš„â€œæ¨æ•²â€å‘³é“é¢‡æµ“ï¼Œå¾ˆæœ‰å¯å‘æ€§ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå®ƒè¿˜è·Ÿæˆ‘ä»¬åé¢å°†è¦ä»‹ç»çš„<a href="https://papers.cool/arxiv/2010.02502">DDIMæ¨¡å‹</a>æœ‰ç€ç´§å¯†çš„è”ç³»ã€‚</p>
<h2 id="_1">æ¨¡å‹ç»˜æ™¯</h2>
<p>å†æ¬¡å›é¡¾ï¼ŒDDPMå»ºæ¨¡çš„æ˜¯å¦‚ä¸‹å˜æ¢æµç¨‹ï¼š<br />
\begin{equation}\boldsymbol{x} = \boldsymbol{x}<em T-1="T-1">0 \rightleftharpoons \boldsymbol{x}_1 \rightleftharpoons \boldsymbol{x}_2 \rightleftharpoons \cdots \rightleftharpoons \boldsymbol{x}</em>} \rightleftharpoons \boldsymbol{x}_T = \boldsymbol{z}\end{equation<br />
å…¶ä¸­ï¼Œæ­£å‘å°±æ˜¯å°†æ ·æœ¬æ•°æ®$\boldsymbol{x}$é€æ¸å˜ä¸ºéšæœºå™ªå£°$\boldsymbol{z}$çš„è¿‡ç¨‹ï¼Œåå‘å°±æ˜¯å°†éšæœºå™ªå£°$\boldsymbol{z}$é€æ¸å˜ä¸ºæ ·æœ¬æ•°æ®$\boldsymbol{x}$çš„è¿‡ç¨‹ï¼Œåå‘è¿‡ç¨‹å°±æ˜¯æˆ‘ä»¬å¸Œæœ›å¾—åˆ°çš„â€œç”Ÿæˆæ¨¡å‹â€ã€‚</p>
<p>æ­£å‘è¿‡ç¨‹å¾ˆç®€å•ï¼Œæ¯ä¸€æ­¥æ˜¯<br />
\begin{equation}\boldsymbol{x}<em t-1="t-1">t = \alpha_t \boldsymbol{x}</em>} + \beta_t \boldsymbol{\varepsilon<em t-1="t-1">t,\quad \boldsymbol{\varepsilon}_t\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})\end{equation}<br />
æˆ–è€…å†™æˆ$p(\boldsymbol{x}_t|\boldsymbol{x}</em>})=\mathcal{N}(\boldsymbol{x<em t-1="t-1">t;\alpha_t \boldsymbol{x}</em>)$ã€‚åœ¨çº¦æŸ$\alpha_t^2 + \beta_t^2 = 1$ä¹‹ä¸‹ï¼Œæˆ‘ä»¬æœ‰},\beta_t^2 \boldsymbol{I<br />
\begin{equation}\begin{aligned}<br />
\boldsymbol{x}<em t-1="t-1">t =&amp;\, \alpha_t \boldsymbol{x}</em>} + \beta_t \boldsymbol{\varepsilon<em t-1="t-1">t \\\<br />
=&amp;\, \alpha_t \big(\alpha</em>} \boldsymbol{x<em t-1="t-1">{t-2} + \beta</em>} \boldsymbol{\varepsilon<em t-1="t-1">{t-1}\big) + \beta_t \boldsymbol{\varepsilon}_t \\\<br />
=&amp;\,\cdots\\\<br />
=&amp;\,(\alpha_t\cdots\alpha_1) \boldsymbol{x}_0 + \underbrace{(\alpha_t\cdots\alpha_2)\beta_1 \boldsymbol{\varepsilon}_1 + (\alpha_t\cdots\alpha_3)\beta_2 \boldsymbol{\varepsilon}_2 + \cdots + \alpha_t\beta</em>} \boldsymbol{\varepsilon<em _mathcal_N="\mathcal{N" _sim="\sim">{t-1} + \beta_t \boldsymbol{\varepsilon}_t}</em>}(\boldsymbol{0}, (1-\alpha_t^2\cdots\alpha_1^2)\boldsymbol{I})<br />
\end{aligned}\end{equation}<br />
ä»è€Œå¯ä»¥æ±‚å‡º$p(\boldsymbol{x}_t|\boldsymbol{x}_0)=\mathcal{N}(\boldsymbol{x}_t;\bar{\alpha}_t \boldsymbol{x}_0,\bar{\beta}_t^2 \boldsymbol{I})$ï¼Œå…¶ä¸­$\bar{\alpha}_t = \alpha_1\cdots\alpha_t$ï¼Œè€Œ$\bar{\beta}_t = \sqrt{1-\bar{\alpha}_t^2}$ã€‚</p>
<p>DDPMè¦åšçš„äº‹æƒ…ï¼Œå°±æ˜¯ä»ä¸Šè¿°ä¿¡æ¯ä¸­æ±‚å‡ºåå‘è¿‡ç¨‹æ‰€éœ€è¦çš„$p(\boldsymbol{x}<em T-1="T-1">{t-1}|\boldsymbol{x}_t)$ï¼Œè¿™æ ·æˆ‘ä»¬å°±èƒ½å®ç°ä»ä»»æ„ä¸€ä¸ª$\boldsymbol{x}_T=\boldsymbol{z}$å‡ºå‘ï¼Œé€æ­¥é‡‡æ ·å‡º$\boldsymbol{x}</em>$ã€‚},\boldsymbol{x}_{T-2},\cdots,\boldsymbol{x}_1$ï¼Œæœ€åå¾—åˆ°éšæœºç”Ÿæˆçš„æ ·æœ¬æ•°æ®$\boldsymbol{x}_0=\boldsymbol{x</p>
<h2 id="_2">è¯·è´å¶æ–¯</h2>
<p>ä¸‹é¢æˆ‘ä»¬è¯·å‡ºä¼Ÿå¤§çš„<a href="https://en.wikipedia.org/wiki/Bayes%27_theorem">è´å¶æ–¯å®šç†</a>ã€‚äº‹å®ä¸Šï¼Œç›´æ¥æ ¹æ®è´å¶æ–¯å®šç†æˆ‘ä»¬æœ‰<br />
\begin{equation}p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t) = \frac{p(\boldsymbol{x}_t|\boldsymbol{x}</em>})p(\boldsymbol{x<em t-1="t-1">{t-1})}{p(\boldsymbol{x}_t)}\label{eq:bayes}\end{equation}<br />
ç„¶è€Œï¼Œæˆ‘ä»¬å¹¶ä¸çŸ¥é“$p(\boldsymbol{x}</em>}),p(\boldsymbol{x<em t-1="t-1">t)$çš„è¡¨è¾¾å¼ï¼Œæ‰€ä»¥æ­¤è·¯ä¸é€šã€‚ä½†æˆ‘ä»¬å¯ä»¥é€€è€Œæ±‚å…¶æ¬¡ï¼Œåœ¨ç»™å®š$\boldsymbol{x}_0$çš„æ¡ä»¶ä¸‹ä½¿ç”¨è´å¶æ–¯å®šç†ï¼š<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0) = \frac{p(\boldsymbol{x}_t|\boldsymbol{x}</em>})p(\boldsymbol{x<em t-1="t-1">{t-1}|\boldsymbol{x}_0)}{p(\boldsymbol{x}_t|\boldsymbol{x}_0)}\end{equation}<br />
è¿™æ ·ä¿®æ”¹è‡ªç„¶æ˜¯å› ä¸º$p(\boldsymbol{x}_t|\boldsymbol{x}</em>}),p(\boldsymbol{x<em t-1="t-1">{t-1}|\boldsymbol{x}_0),p(\boldsymbol{x}_t|\boldsymbol{x}_0)$éƒ½æ˜¯å·²çŸ¥çš„ï¼Œæ‰€ä»¥ä¸Šå¼æ˜¯å¯è®¡ç®—çš„ï¼Œä»£å…¥å„è‡ªçš„è¡¨è¾¾å¼å¾—åˆ°ï¼š<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0) = \mathcal{N}\left(\boldsymbol{x}</em>};\frac{\alpha_t\bar{\beta<em t-1="t-1">{t-1}^2}{\bar{\beta}_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}</em>}\beta_t^2}{\bar{\beta<em t-1="t-1">t^2}\boldsymbol{x}_0,\frac{\bar{\beta}</em>}^2\beta_t^2}{\bar{\beta}_t^2} \boldsymbol{I}\right)\label{eq:p-xt-x0}\end{equation</p>
<blockquote>
<p><strong>æ¨å¯¼ï¼š</strong> ä¸Šå¼çš„æ¨å¯¼è¿‡ç¨‹å¹¶ä¸éš¾ï¼Œå°±æ˜¯å¸¸è§„çš„å±•å¼€æ•´ç†è€Œå·²ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥æ‰¾ç‚¹æŠ€å·§åŠ å¿«è®¡ç®—ã€‚é¦–å…ˆï¼Œä»£å…¥å„è‡ªçš„è¡¨è¾¾å¼ï¼Œå¯ä»¥å‘ç°æŒ‡æ•°éƒ¨åˆ†é™¤æ‰$-1/2$å› å­å¤–ï¼Œç»“æœæ˜¯ï¼š<br />
 \begin{equation}\frac{\Vert \boldsymbol{x}<em t-1="t-1">t - \alpha_t \boldsymbol{x}</em>}\Vert^2}{\beta_t^2} + \frac{\Vert \boldsymbol{x<em t-1="t-1">{t-1} - \bar{\alpha}</em>}\boldsymbol{x<em t-1="t-1">0\Vert^2}{\bar{\beta}</em>}^2} - \frac{\Vert \boldsymbol{x<em t-1="t-1">t - \bar{\alpha}_t \boldsymbol{x}_0\Vert^2}{\bar{\beta}_t^2}\end{equation}<br />
 å®ƒå…³äº$\boldsymbol{x}</em>}$æ˜¯äºŒæ¬¡çš„ï¼Œå› æ­¤æœ€ç»ˆçš„åˆ†å¸ƒå¿…ç„¶ä¹Ÿæ˜¯æ­£æ€åˆ†å¸ƒï¼Œæˆ‘ä»¬åªéœ€è¦æ±‚å‡ºå…¶å‡å€¼å’Œåæ–¹å·®ã€‚ä¸éš¾çœ‹å‡ºï¼Œå±•å¼€å¼ä¸­$\Vert \boldsymbol{x<em t-1="t-1">{t-1}\Vert^2$é¡¹çš„ç³»æ•°æ˜¯<br />
 \begin{equation}\frac{\alpha_t^2}{\beta_t^2} + \frac{1}{\bar{\beta}</em>}^2} = \frac{\alpha_t^2\bar{\beta<em t-1="t-1">{t-1}^2 + \beta_t^2}{\bar{\beta}</em>}^2 \beta_t^2} = \frac{\alpha_t^2(1-\bar{\alpha<em t-1="t-1">{t-1}^2) + \beta_t^2}{\bar{\beta}</em>}^2 \beta_t^2} = \frac{1-\bar{\alpha<em t-1="t-1">t^2}{\bar{\beta}</em>}^2 \beta_t^2} = \frac{\bar{\beta<em t-1="t-1">t^2}{\bar{\beta}</em>}^2 \beta_t^2}\end{equation<br />
 æ‰€ä»¥æ•´ç†å¥½çš„ç»“æœå¿…ç„¶æ˜¯$\frac{\bar{\beta}<em t-1="t-1">t^2}{\bar{\beta}</em>}^2 \beta_t^2}\Vert \boldsymbol{x<em t-1="t-1">{t-1} - \tilde{\boldsymbol{\mu}}(\boldsymbol{x}_t, \boldsymbol{x}_0)\Vert^2$çš„å½¢å¼ï¼Œè¿™æ„å‘³ç€åæ–¹å·®çŸ©é˜µæ˜¯$\frac{\bar{\beta}</em>}^2 \beta_t^2}{\bar{\beta<em t-1="t-1">t^2}\boldsymbol{I}$ã€‚å¦ä¸€è¾¹ï¼ŒæŠŠä¸€æ¬¡é¡¹ç³»æ•°æ‹¿å‡ºæ¥æ˜¯$-2\left(\frac{\alpha_t}{\beta_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}</em>}}{\bar{\beta<em t-1="t-1">{t-1}^2}\boldsymbol{x}_0 \right)$ï¼Œé™¤ä»¥$\frac{-2\bar{\beta}_t^2}{\bar{\beta}</em>$åä¾¿å¯ä»¥å¾—åˆ°}^2 \beta_t^2<br />
 \begin{equation}\tilde{\boldsymbol{\mu}}(\boldsymbol{x}<em t-1="t-1">t, \boldsymbol{x}_0)=\frac{\alpha_t\bar{\beta}</em>}^2}{\bar{\beta<em t-1="t-1">t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}</em>}\beta_t^2}{\bar{\beta<em t-1="t-1">t^2}\boldsymbol{x}_0 \end{equation}<br />
 è¿™å°±å¾—åˆ°äº†$p(\boldsymbol{x}</em>$ã€‚}|\boldsymbol{x}_t, \boldsymbol{x}_0)$çš„æ‰€æœ‰ä¿¡æ¯äº†ï¼Œç»“æœæ­£æ˜¯å¼$\eqref{eq:p-xt-x0</p>
</blockquote>
<h2 id="_3">å»å™ªè¿‡ç¨‹</h2>
<p>ç°åœ¨æˆ‘ä»¬å¾—åˆ°äº†$p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$ï¼Œå®ƒæœ‰æ˜¾å¼çš„è§£ï¼Œä½†å¹¶éæˆ‘ä»¬æƒ³è¦çš„æœ€ç»ˆç­”æ¡ˆï¼Œå› ä¸ºæˆ‘ä»¬åªæƒ³é€šè¿‡$\boldsymbol{x}_t$æ¥é¢„æµ‹$\boldsymbol{x}</em>_0$æ˜¯æˆ‘ä»¬æœ€ç»ˆæƒ³è¦ç”Ÿæˆçš„ç»“æœã€‚æ¥ä¸‹æ¥ï¼Œä¸€ä¸ªâ€œå¼‚æƒ³å¤©å¼€â€çš„æƒ³æ³•æ˜¯}$ï¼Œè€Œä¸èƒ½ä¾èµ–$\boldsymbol{x}_0$ï¼Œ$\boldsymbol{x</p>
<blockquote>
<p>å¦‚æœæˆ‘ä»¬èƒ½å¤Ÿé€šè¿‡$\boldsymbol{x}<em t-1="t-1">t$æ¥é¢„æµ‹$\boldsymbol{x}_0$ï¼Œé‚£ä¹ˆä¸å°±å¯ä»¥æ¶ˆå»$p(\boldsymbol{x}</em>_t$äº†å—ï¼Ÿ}|\boldsymbol{x}_t, \boldsymbol{x}_0)$ä¸­çš„$\boldsymbol{x}_0$ï¼Œä½¿å¾—å®ƒåªä¾èµ–äº$\boldsymbol{x</p>
</blockquote>
<p>è¯´å¹²å°±å¹²ï¼Œæˆ‘ä»¬ç”¨$\bar{\boldsymbol{\mu}}(\boldsymbol{x}<em t-1="t-1">t)$æ¥é¢„ä¼°$\boldsymbol{x}_0$ï¼ŒæŸå¤±å‡½æ•°ä¸º$\Vert \boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\Vert^2$ã€‚è®­ç»ƒå®Œæˆåï¼Œæˆ‘ä»¬å°±è®¤ä¸º<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t) \approx p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0=\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)) = \mathcal{N}\left(\boldsymbol{x}</em>}; \frac{\alpha_t\bar{\beta<em t-1="t-1">{t-1}^2}{\bar{\beta}_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}</em>}\beta_t^2}{\bar{\beta<em t-1="t-1">t^2}\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t),\frac{\bar{\beta}</em>}^2\beta_t^2}{\bar{\beta}_t^2} \boldsymbol{I}\right)\label{eq:p-xt}\end{equation<br />
åœ¨$\Vert \boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\Vert^2$ä¸­ï¼Œ$\boldsymbol{x}_0$ä»£è¡¨åŸå§‹æ•°æ®ï¼Œ$\boldsymbol{x}_t$ä»£è¡¨å¸¦å™ªæ•°æ®ï¼Œæ‰€ä»¥è¿™å®é™…ä¸Šåœ¨è®­ç»ƒä¸€ä¸ªå»å™ªæ¨¡å‹ï¼Œè¿™ä¹Ÿå°±æ˜¯DDPMçš„ç¬¬ä¸€ä¸ªâ€œDâ€çš„å«ä¹‰ï¼ˆDenoisingï¼‰ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œ$p(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t|\boldsymbol{x}_0)=\mathcal{N}(\boldsymbol{x}_t;\bar{\alpha}_t \boldsymbol{x}_0,\bar{\beta}_t^2 \boldsymbol{I})$æ„å‘³ç€$\boldsymbol{x}_t = \bar{\alpha}_t \boldsymbol{x}_0 + \bar{\beta}_t \boldsymbol{\varepsilon},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼Œæˆ–è€…å†™æˆ$\boldsymbol{x}_0 = \frac{1}{\bar{\alpha}_t}\left(\boldsymbol{x}_t - \bar{\beta}_t \boldsymbol{\varepsilon}\right)$ï¼Œè¿™å¯å‘æˆ‘ä»¬å°†$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$å‚æ•°åŒ–ä¸º<br />
\begin{equation}\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) = \frac{1}{\bar{\alpha}_t}\left(\boldsymbol{x}_t - \bar{\beta}_t \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)\right)\label{eq:bar-mu}\end{equation}<br />
æ­¤æ—¶æŸå¤±å‡½æ•°å˜ä¸º<br />
\begin{equation}\Vert \boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\Vert^2 = \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\left\Vert\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}</em>}}(\bar{\alpha<em t-1="t-1">t \boldsymbol{x}_0 + \bar{\beta}_t \boldsymbol{\varepsilon}, t)\right\Vert^2\end{equation}<br />
çœå»å‰é¢çš„ç³»æ•°ï¼Œå°±å¾—åˆ°DDPMåŸè®ºæ–‡æ‰€ç”¨çš„æŸå¤±å‡½æ•°äº†ã€‚å¯ä»¥å‘ç°ï¼Œæœ¬æ–‡æ˜¯ç›´æ¥å¾—å‡ºäº†ä»$\boldsymbol{x}_t$åˆ°$\boldsymbol{x}_0$çš„å»å™ªè¿‡ç¨‹ï¼Œè€Œä¸æ˜¯åƒä¹‹å‰ä¸¤ç¯‡æ–‡ç« é‚£æ ·ï¼Œé€šè¿‡$\boldsymbol{x}_t$åˆ°$\boldsymbol{x}</em>$çš„å»å™ªè¿‡ç¨‹å†åŠ ä¸Šç§¯åˆ†å˜æ¢æ¥æ¨å¯¼ï¼Œç›¸æ¯”ä¹‹ä¸‹æœ¬æ–‡çš„æ¨å¯¼å¯è°“æ›´åŠ ä¸€æ­¥åˆ°ä½äº†ã€‚</p>
<p>å¦ä¸€è¾¹ï¼Œæˆ‘ä»¬å°†å¼$\eqref{eq:bar-mu}$ä»£å…¥åˆ°å¼$\eqref{eq:p-xt}$ä¸­ï¼ŒåŒ–ç®€å¾—åˆ°<br />
\begin{equation}<br />
p(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t) \approx p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0=\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)) = \mathcal{N}\left(\boldsymbol{x}</em>}; \frac{1}{\alpha_t}\left(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t - \frac{\beta_t^2}{\bar{\beta}_t}\boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em t-1="t-1">t, t)\right),\frac{\bar{\beta}</em>}^2\beta_t^2}{\bar{\beta<em _boldsymbol_theta="\boldsymbol{\theta">t^2} \boldsymbol{I}\right)\end{equation}<br />
è¿™å°±æ˜¯åå‘çš„é‡‡æ ·è¿‡ç¨‹æ‰€ç”¨çš„åˆ†å¸ƒï¼Œè¿åŒé‡‡æ ·è¿‡ç¨‹æ‰€ç”¨çš„æ–¹å·®ä¹Ÿä¸€å¹¶ç¡®å®šä¸‹æ¥äº†ã€‚è‡³æ­¤ï¼ŒDDPMæ¨å¯¼å®Œæ¯•ï½ï¼ˆæ³¨ï¼šå‡ºäºæ¨å¯¼çš„æµç•…æ€§è€ƒè™‘ï¼Œæœ¬æ–‡çš„$\boldsymbol{\epsilon}</em>$è·Ÿå‰ä¸¤ç¯‡ä»‹ç»ä¸ä¸€æ ·ï¼Œåè€Œè·ŸDDPMåŸè®ºæ–‡ä¸€è‡´ã€‚ï¼‰}</p>
<blockquote>
<p><strong>æ¨å¯¼ï¼š</strong> å°†å¼$\eqref{eq:bar-mu}$ä»£å…¥åˆ°å¼$\eqref{eq:p-xt}$çš„ä¸»è¦åŒ–ç®€éš¾åº¦å°±æ˜¯è®¡ç®—<br />
 \begin{equation}\begin{aligned}\frac{\alpha_t\bar{\beta}<em t-1="t-1">{t-1}^2}{\bar{\beta}_t^2} + \frac{\bar{\alpha}</em>}\beta_t^2}{\bar{\alpha<em t-1="t-1">t\bar{\beta}_t^2} =&amp;\, \frac{\alpha_t\bar{\beta}</em>}^2 + \beta_t^2/\alpha_t}{\bar{\beta<em t-1="t-1">t^2} = \frac{\alpha_t^2(1-\bar{\alpha}</em>}^2) + \beta_t^2}{\alpha_t\bar{\beta}_t^2} = \frac{1-\bar{\alpha}_t^2}{\alpha_t\bar{\beta}_t^2} = \frac{1}{\alpha_t<br />
 \end{aligned}\end{equation}</p>
</blockquote>
<h2 id="_4">é¢„ä¼°ä¿®æ­£</h2>
<p>ä¸çŸ¥é“è¯»è€…æœ‰æ²¡æœ‰ç•™æ„åˆ°ä¸€ä¸ªæœ‰è¶£çš„åœ°æ–¹ï¼šæˆ‘ä»¬è¦åšçš„äº‹æƒ…ï¼Œå°±æ˜¯æƒ³å°†$\boldsymbol{x}<em t-1="t-1">T$æ…¢æ…¢åœ°å˜ä¸º$\boldsymbol{x}_0$ï¼Œè€Œæˆ‘ä»¬åœ¨å€Ÿç”¨$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0)$è¿‘ä¼¼$p(\boldsymbol{x}</em>_0$â€è¿™ä¸€æ­¥ï¼Œè¦æ˜¯èƒ½é¢„ä¼°å‡†çš„è¯ï¼Œé‚£å°±ç›´æ¥ä¸€æ­¥åˆ°ä½äº†ï¼Œè¿˜éœ€è¦é€æ­¥é‡‡æ ·å—ï¼Ÿ}|\boldsymbol{x}_t)$æ—¶ï¼Œå´åŒ…å«äº†â€œç”¨$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$æ¥é¢„ä¼°$\boldsymbol{x</p>
<p>çœŸå®æƒ…å†µæ˜¯ï¼Œâ€œç”¨$\bar{\boldsymbol{\mu}}(\boldsymbol{x}<em t-1="t-1">t)$æ¥é¢„ä¼°$\boldsymbol{x}_0$â€å½“ç„¶ä¸ä¼šå¤ªå‡†çš„ï¼Œè‡³å°‘å¼€å§‹çš„ç›¸å½“å¤šæ­¥å†…ä¸ä¼šå¤ªå‡†ã€‚å®ƒä»…ä»…èµ·åˆ°äº†ä¸€ä¸ªå‰ç»æ€§çš„é¢„ä¼°ä½œç”¨ï¼Œç„¶åæˆ‘ä»¬åªç”¨$p(\boldsymbol{x}</em>_t)$æ¥æ¨è¿›ä¸€å°æ­¥ï¼Œè¿™å°±æ˜¯å¾ˆå¤šæ•°å€¼ç®—æ³•ä¸­çš„â€œé¢„ä¼°-ä¿®æ­£â€æ€æƒ³ï¼Œå³æˆ‘ä»¬ç”¨ä¸€ä¸ªç²—ç³™çš„è§£å¾€å‰æ¨å¾ˆå¤šæ­¥ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªç²—ç³™çš„ç»“æœå°†æœ€ç»ˆç»“æœæ¨è¿›ä¸€å°æ­¥ï¼Œä»¥æ­¤æ¥é€æ­¥è·å¾—æ›´ä¸ºç²¾ç»†çš„è§£ã€‚}|\boldsymbol{x</p>
<p>ç”±æ­¤æˆ‘ä»¬è¿˜å¯ä»¥è”æƒ³åˆ°Hintonä¸‰å¹´å‰æå‡ºçš„<a href="https://papers.cool/arxiv/1907.08610">ã€ŠLookahead Optimizer: k steps forward, 1 step backã€‹</a>ï¼Œå®ƒåŒæ ·ä¹ŸåŒ…å«äº†é¢„ä¼°ï¼ˆk steps forwardï¼‰å’Œä¿®æ­£ï¼ˆ1 step backï¼‰ä¸¤éƒ¨åˆ†ï¼ŒåŸè®ºæ–‡å°†å…¶è¯ é‡Šä¸ºâ€œå¿«ï¼ˆFastï¼‰-æ…¢ï¼ˆSlowï¼‰â€æƒé‡çš„ç›¸äº’ç»“åˆï¼Œå¿«æƒé‡å°±æ˜¯é¢„ä¼°å¾—åˆ°çš„ç»“æœï¼Œæ…¢æƒé‡åˆ™æ˜¯åŸºäºé¢„ä¼°æ‰€åšçš„ä¿®æ­£ç»“æœã€‚å¦‚æœæ„¿æ„ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨åŒæ ·çš„æ–¹å¼å»è¯ é‡ŠDDPMçš„â€œé¢„ä¼°-ä¿®æ­£â€è¿‡ç¨‹ï½</p>
<h2 id="_5">é—ç•™é—®é¢˜</h2>
<p>æœ€åï¼Œåœ¨ä½¿ç”¨è´å¶æ–¯å®šç†ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬è¯´å¼$\eqref{eq:bayes}$æ²¡æ³•ç›´æ¥ç”¨çš„åŸå› æ˜¯$p(\boldsymbol{x}_{t-1})$å’Œ$p(\boldsymbol{x}_t)$å‡ä¸çŸ¥é“ã€‚å› ä¸ºæ ¹æ®å®šä¹‰ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}p(\boldsymbol{x}_t) = \int p(\boldsymbol{x}_t|\boldsymbol{x}_0)\tilde{p}(\boldsymbol{x}_0)d\boldsymbol{x}_0\end{equation}<br />
å…¶ä¸­$p(\boldsymbol{x}_t|\boldsymbol{x}_0)$æ˜¯çŸ¥é“çš„ï¼Œè€Œæ•°æ®åˆ†å¸ƒ$\tilde{p}(\boldsymbol{x}_0)$æ— æ³•æå‰é¢„çŸ¥ï¼Œæ‰€ä»¥ä¸èƒ½è¿›è¡Œè®¡ç®—ã€‚ä¸è¿‡ï¼Œæœ‰ä¸¤ä¸ªç‰¹æ®Šçš„ä¾‹å­ï¼Œæ˜¯å¯ä»¥ç›´æ¥å°†ä¸¤è€…ç®—å‡ºæ¥çš„ï¼Œè¿™é‡Œæˆ‘ä»¬ä¹Ÿè¡¥å……è®¡ç®—ä¸€ä¸‹ï¼Œå…¶ç»“æœä¹Ÿæ­£å¥½æ˜¯ä¸Šä¸€ç¯‡æ–‡ç« é—ç•™çš„æ–¹å·®é€‰å–é—®é¢˜çš„ç­”æ¡ˆã€‚</p>
<p>ç¬¬ä¸€ä¸ªä¾‹å­æ˜¯æ•´ä¸ªæ•°æ®é›†åªæœ‰ä¸€ä¸ªæ ·æœ¬ï¼Œä¸å¤±ä¸€èˆ¬æ€§ï¼Œå‡è®¾è¯¥æ ·æœ¬ä¸º$\boldsymbol{0}$ï¼Œæ­¤æ—¶$\tilde{p}(\boldsymbol{x}<em t-1="t-1">0)$ä¸ºç‹„æ‹‰å…‹åˆ†å¸ƒ$\delta(\boldsymbol{x}_0)$ï¼Œå¯ä»¥ç›´æ¥ç®—å‡º$p(\boldsymbol{x}_t)=p(\boldsymbol{x}_t|\boldsymbol{0})$ã€‚ç»§è€Œä»£å…¥å¼$\eqref{eq:bayes}$ï¼Œå¯ä»¥å‘ç°ç»“æœæ­£å¥½æ˜¯$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t,\boldsymbol{x}_0)$å–$\boldsymbol{x}_0=\boldsymbol{0}$çš„ç‰¹ä¾‹ï¼Œå³<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t) = p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0=\boldsymbol{0}) = \mathcal{N}\left(\boldsymbol{x}</em>};\frac{\alpha_t\bar{\beta<em t-1="t-1">{t-1}^2}{\bar{\beta}_t^2}\boldsymbol{x}_t,\frac{\bar{\beta}</em>}^2\beta_t^2}{\bar{\beta<em t-1="t-1">t^2} \boldsymbol{I}\right)\end{equation}<br />
æˆ‘ä»¬ä¸»è¦å…³å¿ƒå…¶æ–¹å·®ä¸º$\frac{\bar{\beta}</em>$ï¼Œè¿™ä¾¿æ˜¯é‡‡æ ·æ–¹å·®çš„é€‰æ‹©ä¹‹ä¸€ã€‚}^2\beta_t^2}{\bar{\beta}_t^2</p>
<p>ç¬¬äºŒä¸ªä¾‹å­æ˜¯æ•°æ®é›†æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œå³$\tilde{p}(\boldsymbol{x}<em t-1="t-1">0)=\mathcal{N}(\boldsymbol{x}_0;\boldsymbol{0},\boldsymbol{I})$ã€‚å‰é¢æˆ‘ä»¬è¯´äº†$p(\boldsymbol{x}_t|\boldsymbol{x}_0)=\mathcal{N}(\boldsymbol{x}_t;\bar{\alpha}_t \boldsymbol{x}_0,\bar{\beta}_t^2 \boldsymbol{I})$æ„å‘³ç€$\boldsymbol{x}_t = \bar{\alpha}_t \boldsymbol{x}_0 + \bar{\beta}_t \boldsymbol{\varepsilon},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼Œè€Œæ­¤æ—¶æ ¹æ®å‡è®¾è¿˜æœ‰$\boldsymbol{x}_0\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼Œæ‰€ä»¥ç”±æ­£æ€åˆ†å¸ƒçš„å åŠ æ€§ï¼Œ$\boldsymbol{x}_t$æ­£å¥½ä¹Ÿæœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚å°†æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦ä»£å…¥å¼$\eqref{eq:bayes}$åï¼Œç»“æœçš„æŒ‡æ•°éƒ¨åˆ†é™¤æ‰$-1/2$å› å­å¤–ï¼Œç»“æœæ˜¯ï¼š<br />
\begin{equation}\frac{\Vert \boldsymbol{x}_t - \alpha_t \boldsymbol{x}</em>}\Vert^2}{\beta_t^2} + \Vert \boldsymbol{x<em t-1="t-1">{t-1}\Vert^2 - \Vert \boldsymbol{x}_t\Vert^2\end{equation}<br />
è·Ÿæ¨å¯¼$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t,\boldsymbol{x}_0)$çš„è¿‡ç¨‹ç±»ä¼¼ï¼Œå¯ä»¥å¾—åˆ°ä¸Šè¿°æŒ‡æ•°å¯¹åº”äº<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t) = \mathcal{N}\left(\boldsymbol{x}</em>};\alpha_t\boldsymbol{x}_t,\beta_t^2 \boldsymbol{I}\right)\end{equation<br />
æˆ‘ä»¬åŒæ ·ä¸»è¦å…³å¿ƒå…¶æ–¹å·®ä¸º$\beta_t^2$ï¼Œè¿™ä¾¿æ˜¯é‡‡æ ·æ–¹å·®çš„å¦ä¸€ä¸ªé€‰æ‹©ã€‚</p>
<h2 id="_6">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡åˆ†äº«äº†DDPMçš„ä¸€ç§é¢‡æœ‰â€œæ¨æ•²â€å‘³é“çš„æ¨å¯¼ï¼Œå®ƒå€ŸåŠ©è´å¶æ–¯å®šç†æ¥ç›´æ¥æ¨å¯¼åå‘çš„ç”Ÿæˆè¿‡ç¨‹ï¼Œç›¸æ¯”ä¹‹å‰çš„â€œæ‹†æ¥¼-å»ºæ¥¼â€ç±»æ¯”å’Œå˜åˆ†æ¨æ–­ç†è§£æ›´åŠ ä¸€æ­¥åˆ°ä½ã€‚åŒæ—¶ï¼Œå®ƒä¹Ÿæ›´å…·å¯å‘æ€§ï¼Œè·Ÿæ¥ä¸‹æ¥è¦ä»‹ç»çš„DDIMæœ‰å¾ˆå¯†åˆ‡çš„è”ç³»ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9164">https://spaces.ac.cn/archives/9164</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jul. 19, 2022). ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸‰ï¼‰ï¼šDDPM = è´å¶æ–¯ + å»å™ª ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9164">https://spaces.ac.cn/archives/9164</a></p>
<p>@online{kexuefm-9164,<br />
title={ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸‰ï¼‰ï¼šDDPM = è´å¶æ–¯ + å»å™ª},<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={Jul},<br />
url={\url{https://spaces.ac.cn/archives/9164}},<br />
} </p>
<hr />
<h2 id="_7">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="_8">ä¸€ã€é«˜æ–¯åˆ†å¸ƒçš„åŸºç¡€æ€§è´¨</h3>
<p>åœ¨æ·±å…¥DDPMçš„æ•°å­¦æ¨å¯¼ä¹‹å‰ï¼Œæˆ‘ä»¬é¦–å…ˆå›é¡¾é«˜æ–¯åˆ†å¸ƒçš„ä¸€äº›é‡è¦æ€§è´¨ï¼Œè¿™äº›æ€§è´¨æ˜¯æ•´ä¸ªæ¨å¯¼çš„åŸºç¡€ã€‚</p>
<p><strong>æ€§è´¨1ï¼šé«˜æ–¯åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°</strong></p>
<p>å¯¹äº$d$ç»´é«˜æ–¯åˆ†å¸ƒ$\mathcal{N}(\boldsymbol{x}; \boldsymbol{\mu}, \boldsymbol{\Sigma})$ï¼Œå…¶æ¦‚ç‡å¯†åº¦å‡½æ•°ä¸ºï¼š
$$p(\boldsymbol{x}) = \frac{1}{(2\pi)^{d/2}|\boldsymbol{\Sigma}|^{1/2}} \exp\left(-\frac{1}{2}(\boldsymbol{x}-\boldsymbol{\mu})^T\boldsymbol{\Sigma}^{-1}(\boldsymbol{x}-\boldsymbol{\mu})\right)$$</p>
<p>å½“åæ–¹å·®çŸ©é˜µä¸ºå¯¹è§’çŸ©é˜µ$\boldsymbol{\Sigma} = \sigma^2\boldsymbol{I}$æ—¶ï¼Œå¯ä»¥ç®€åŒ–ä¸ºï¼š
$$p(\boldsymbol{x}) = \frac{1}{(2\pi\sigma^2)^{d/2}} \exp\left(-\frac{\|\boldsymbol{x}-\boldsymbol{\mu}\|^2}{2\sigma^2}\right)$$</p>
<p>å¯¹æ•°æ¦‚ç‡å¯†åº¦ï¼ˆå¿½ç•¥å¸¸æ•°é¡¹ï¼‰ä¸ºï¼š
$$\log p(\boldsymbol{x}) = -\frac{\|\boldsymbol{x}-\boldsymbol{\mu}\|^2}{2\sigma^2} + C$$</p>
<p><strong>æ€§è´¨2ï¼šé«˜æ–¯åˆ†å¸ƒçš„çº¿æ€§å˜æ¢</strong></p>
<p>å¦‚æœ$\boldsymbol{x} \sim \mathcal{N}(\boldsymbol{\mu}_x, \boldsymbol{\Sigma}_x)$ï¼Œ$\boldsymbol{y} = A\boldsymbol{x} + \boldsymbol{b}$ï¼Œåˆ™ï¼š
$$\boldsymbol{y} \sim \mathcal{N}(A\boldsymbol{\mu}_x + \boldsymbol{b}, A\boldsymbol{\Sigma}_x A^T)$$</p>
<p>ç‰¹åˆ«åœ°ï¼Œè‹¥$\boldsymbol{x} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼Œ$\boldsymbol{y} = \alpha\boldsymbol{x}_0 + \beta\boldsymbol{x}$ï¼Œåˆ™ï¼š
$$\boldsymbol{y} \sim \mathcal{N}(\alpha\boldsymbol{x}_0, \beta^2\boldsymbol{I})$$</p>
<p><strong>æ€§è´¨3ï¼šç‹¬ç«‹é«˜æ–¯å˜é‡çš„å’Œ</strong></p>
<p>å¦‚æœ$\boldsymbol{x}_1 \sim \mathcal{N}(\boldsymbol{\mu}_1, \sigma_1^2\boldsymbol{I})$å’Œ$\boldsymbol{x}_2 \sim \mathcal{N}(\boldsymbol{\mu}_2, \sigma_2^2\boldsymbol{I})$ç›¸äº’ç‹¬ç«‹ï¼Œåˆ™ï¼š
$$\boldsymbol{x}_1 + \boldsymbol{x}_2 \sim \mathcal{N}(\boldsymbol{\mu}_1 + \boldsymbol{\mu}_2, (\sigma_1^2 + \sigma_2^2)\boldsymbol{I})$$</p>
<p>è¿™ä¸ªæ€§è´¨è§£é‡Šäº†ä¸ºä»€ä¹ˆåœ¨å‰å‘æ‰©æ•£è¿‡ç¨‹ä¸­ï¼Œå¤šä¸ªç‹¬ç«‹å™ªå£°çš„ç´¯ç§¯ä»ç„¶æœä»é«˜æ–¯åˆ†å¸ƒã€‚</p>
<h3 id="_9">äºŒã€å‰å‘æ‰©æ•£è¿‡ç¨‹çš„å®Œæ•´æ¨å¯¼</h3>
<p><strong>å®šç†1ï¼šå•æ­¥æ‰©æ•£çš„è¾¹ç¼˜åˆ†å¸ƒ</strong></p>
<p>ç»™å®šå‰å‘æ‰©æ•£è¿‡ç¨‹ï¼š
$$q(\boldsymbol{x}_t|\boldsymbol{x}_{t-1}) = \mathcal{N}(\boldsymbol{x}_t; \alpha_t\boldsymbol{x}_{t-1}, \beta_t^2\boldsymbol{I})$$</p>
<p>ç­‰ä»·äºé‡å‚æ•°åŒ–å½¢å¼ï¼š
$$\boldsymbol{x}_t = \alpha_t\boldsymbol{x}_{t-1} + \beta_t\boldsymbol{\varepsilon}_t, \quad \boldsymbol{\varepsilon}_t \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$$</p>
<p><strong>è¯æ˜ï¼š</strong> è¿™æ˜¯é«˜æ–¯åˆ†å¸ƒé‡å‚æ•°åŒ–æŠ€å·§çš„ç›´æ¥åº”ç”¨ã€‚$\square$</p>
<p><strong>å®šç†2ï¼šå¤šæ­¥æ‰©æ•£çš„ç´¯ç§¯æ•ˆåº”</strong></p>
<p>åœ¨çº¦æŸ$\alpha_t^2 + \beta_t^2 = 1$ä¸‹ï¼Œä»$\boldsymbol{x}_0$åˆ°$\boldsymbol{x}_t$çš„è¾¹ç¼˜åˆ†å¸ƒä¸ºï¼š
$$q(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t; \bar{\alpha}_t\boldsymbol{x}_0, \bar{\beta}_t^2\boldsymbol{I})$$</p>
<p>å…¶ä¸­$\bar{\alpha}<em i="1">t = \prod</em>$ã€‚}^t \alpha_i$ï¼Œ$\bar{\beta}_t = \sqrt{1-\bar{\alpha}_t^2</p>
<p><strong>è¯¦ç»†è¯æ˜ï¼š</strong></p>
<p>æˆ‘ä»¬é€šè¿‡æ•°å­¦å½’çº³æ³•è¯æ˜æ­¤ç»“æœã€‚</p>
<p><em>åŸºç¡€æ­¥éª¤ï¼ˆ$t=1$ï¼‰ï¼š</em></p>
<p>ç”±å®šä¹‰ï¼Œ$q(\boldsymbol{x}_1|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_1; \alpha_1\boldsymbol{x}_0, \beta_1^2\boldsymbol{I})$ã€‚</p>
<p>ç”±äº$\alpha_1^2 + \beta_1^2 = 1$ï¼Œæˆ‘ä»¬æœ‰$\beta_1 = \sqrt{1-\alpha_1^2}$ã€‚</p>
<p>åŒæ—¶ï¼Œ$\bar{\alpha}_1 = \alpha_1$ï¼Œ$\bar{\beta}_1 = \sqrt{1-\bar{\alpha}_1^2} = \sqrt{1-\alpha_1^2} = \beta_1$ã€‚</p>
<p>æ‰€ä»¥$q(\boldsymbol{x}_1|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_1; \bar{\alpha}_1\boldsymbol{x}_0, \bar{\beta}_1^2\boldsymbol{I})$æˆç«‹ã€‚</p>
<p><em>å½’çº³æ­¥éª¤ï¼ˆå‡è®¾å¯¹$t-1$æˆç«‹ï¼Œè¯æ˜å¯¹$t$ä¹Ÿæˆç«‹ï¼‰ï¼š</em></p>
<p>å‡è®¾$q(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}</em>}; \bar{\alpha<em t-1="t-1">{t-1}\boldsymbol{x}_0, \bar{\beta}</em>)$æˆç«‹ã€‚}^2\boldsymbol{I</p>
<p>æ ¹æ®é‡å‚æ•°åŒ–ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆï¼š
$$\boldsymbol{x}_{t-1} = \bar{\alpha}_{t-1}\boldsymbol{x}_0 + \bar{\beta}_{t-1}\boldsymbol{\varepsilon}_{t-1}', \quad \boldsymbol{\varepsilon}_{t-1}' \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$$</p>
<p>ç°åœ¨è€ƒè™‘ä»$\boldsymbol{x}_{t-1}$åˆ°$\boldsymbol{x}_t$çš„è½¬ç§»ï¼š
$$\boldsymbol{x}_t = \alpha_t\boldsymbol{x}_{t-1} + \beta_t\boldsymbol{\varepsilon}_t, \quad \boldsymbol{\varepsilon}_t \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$$</p>
<p>å°†$\boldsymbol{x}_{t-1}$çš„è¡¨è¾¾å¼ä»£å…¥ï¼š
$$\boldsymbol{x}_t = \alpha_t(\bar{\alpha}_{t-1}\boldsymbol{x}_0 + \bar{\beta}_{t-1}\boldsymbol{\varepsilon}_{t-1}') + \beta_t\boldsymbol{\varepsilon}_t$$</p>
<p>$$= \alpha_t\bar{\alpha}_{t-1}\boldsymbol{x}_0 + \alpha_t\bar{\beta}_{t-1}\boldsymbol{\varepsilon}_{t-1}' + \beta_t\boldsymbol{\varepsilon}_t$$</p>
<p>$$= \bar{\alpha}_t\boldsymbol{x}_0 + \alpha_t\bar{\beta}_{t-1}\boldsymbol{\varepsilon}_{t-1}' + \beta_t\boldsymbol{\varepsilon}_t$$</p>
<p>å…¶ä¸­$\bar{\alpha}<em t-1="t-1">t = \alpha_t\bar{\alpha}</em>$ã€‚</p>
<p>ç°åœ¨å…³é”®æ˜¯è®¡ç®—å™ªå£°é¡¹$\alpha_t\bar{\beta}<em t-1="t-1">{t-1}\boldsymbol{\varepsilon}</em>}' + \beta_t\boldsymbol{\varepsilon<em t-1="t-1">t$çš„åˆ†å¸ƒã€‚ç”±äº$\boldsymbol{\varepsilon}</em>_t$ç›¸äº’ç‹¬ç«‹ä¸”éƒ½æœä»æ ‡å‡†é«˜æ–¯åˆ†å¸ƒï¼Œæ ¹æ®é«˜æ–¯åˆ†å¸ƒçš„åŠ æ€§ï¼š
$$\alpha_t\bar{\beta}_{t-1}\boldsymbol{\varepsilon}_{t-1}' + \beta_t\boldsymbol{\varepsilon}_t \sim \mathcal{N}(\boldsymbol{0}, (\alpha_t^2\bar{\beta}_{t-1}^2 + \beta_t^2)\boldsymbol{I})$$}'$å’Œ$\boldsymbol{\varepsilon</p>
<p>ç°åœ¨è®¡ç®—æ–¹å·®ï¼š
$$\alpha_t^2\bar{\beta}_{t-1}^2 + \beta_t^2 = \alpha_t^2(1-\bar{\alpha}_{t-1}^2) + \beta_t^2$$</p>
<p>$$= \alpha_t^2 - \alpha_t^2\bar{\alpha}_{t-1}^2 + \beta_t^2$$</p>
<p>ç”±äº$\alpha_t^2 + \beta_t^2 = 1$ï¼Œæˆ‘ä»¬æœ‰ï¼š
$$= 1 - \alpha_t^2\bar{\alpha}_{t-1}^2 = 1 - \bar{\alpha}_t^2 = \bar{\beta}_t^2$$</p>
<p>å› æ­¤ï¼š
$$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}, \quad \boldsymbol{\varepsilon} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$$</p>
<p>å³$q(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t; \bar{\alpha}_t\boldsymbol{x}_0, \bar{\beta}_t^2\boldsymbol{I})$ã€‚$\square$</p>
<p><strong>æ¨è®ºï¼šæ ‡å‡†åŒ–å™ªå£°çš„è§£é‡Š</strong></p>
<p>çº¦æŸ$\alpha_t^2 + \beta_t^2 = 1$ç¡®ä¿äº†åœ¨æ¯ä¸€æ­¥æ‰©æ•£è¿‡ç¨‹ä¸­ï¼Œæ•°æ®çš„æ€»æ–¹å·®ä¿æŒæ’å®šï¼ˆå‡è®¾åˆå§‹æ•°æ®å·²æ ‡å‡†åŒ–ï¼‰ã€‚è¿™å¯ä»¥ä»ä»¥ä¸‹è®¡ç®—çœ‹å‡ºï¼š</p>
<p>å‡è®¾$\mathbb{E}[\boldsymbol{x}<em t-1="t-1">{t-1}] = \boldsymbol{0}$ï¼Œ$\text{Var}[\boldsymbol{x}</em>$ï¼Œåˆ™ï¼š
$$\mathbb{E}[\boldsymbol{x}_t] = \alpha_t\mathbb{E}[\boldsymbol{x}_{t-1}] = \boldsymbol{0}$$}] = \boldsymbol{I</p>
<p>$$\text{Var}[\boldsymbol{x}_t] = \alpha_t^2\text{Var}[\boldsymbol{x}_{t-1}] + \beta_t^2\boldsymbol{I} = \alpha_t^2\boldsymbol{I} + \beta_t^2\boldsymbol{I} = \boldsymbol{I}$$</p>
<p>è¿™ç§æ–¹å·®ä¿æŒçš„æ€§è´¨å¯¹äºè®­ç»ƒçš„æ•°å€¼ç¨³å®šæ€§è‡³å…³é‡è¦ã€‚</p>
<h3 id="ddpm">ä¸‰ã€è´å¶æ–¯å…¬å¼åœ¨DDPMä¸­çš„åº”ç”¨</h3>
<p><strong>å®šç†3ï¼šæ¡ä»¶åéªŒåˆ†å¸ƒçš„è´å¶æ–¯æ¨å¯¼</strong></p>
<p>ç»™å®šå‰å‘è¿‡ç¨‹çš„è½¬ç§»æ¦‚ç‡$q(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>_0)$ï¼ŒåéªŒåˆ†å¸ƒå¯ä»¥é€šè¿‡è´å¶æ–¯å…¬å¼è®¡ç®—ï¼š})$å’Œè¾¹ç¼˜åˆ†å¸ƒ$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_0)$ã€$q(\boldsymbol{x}_t|\boldsymbol{x</p>
<p>$$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \frac{q(\boldsymbol{x}_t|\boldsymbol{x}_{t-1}, \boldsymbol{x}_0) \cdot q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_0)}{q(\boldsymbol{x}_t|\boldsymbol{x}_0)}$$</p>
<p><strong>è¯æ˜ï¼š</strong> è¿™æ˜¯è´å¶æ–¯å®šç†çš„ç›´æ¥åº”ç”¨ã€‚æ ¹æ®æ¡ä»¶æ¦‚ç‡çš„å®šä¹‰ï¼š
$$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \frac{q(\boldsymbol{x}_{t-1}, \boldsymbol{x}_t|\boldsymbol{x}_0)}{q(\boldsymbol{x}_t|\boldsymbol{x}_0)}$$</p>
<p>è€Œè”åˆåˆ†å¸ƒå¯ä»¥åˆ†è§£ä¸ºï¼š
$$q(\boldsymbol{x}_{t-1}, \boldsymbol{x}_t|\boldsymbol{x}_0) = q(\boldsymbol{x}_t|\boldsymbol{x}_{t-1}, \boldsymbol{x}_0) \cdot q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_0)$$</p>
<p>ä»£å…¥å³å¾—è¯ã€‚$\square$</p>
<p><strong>è§‚å¯Ÿï¼šé©¬å°”å¯å¤«æ€§è´¨çš„åº”ç”¨</strong></p>
<p>æ³¨æ„åˆ°åœ¨å‰å‘æ‰©æ•£è¿‡ç¨‹ä¸­ï¼Œç”±äºé©¬å°”å¯å¤«æ€§è´¨ï¼Œæœ‰ï¼š
$$q(\boldsymbol{x}_t|\boldsymbol{x}_{t-1}, \boldsymbol{x}_0) = q(\boldsymbol{x}_t|\boldsymbol{x}_{t-1})$$</p>
<p>è¿™æ˜¯å› ä¸ºç»™å®š$\boldsymbol{x}_{t-1}$åï¼Œ$\boldsymbol{x}_t$çš„åˆ†å¸ƒä¸$\boldsymbol{x}_0$æ¡ä»¶ç‹¬ç«‹ã€‚å› æ­¤ï¼š
$$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \frac{q(\boldsymbol{x}_t|\boldsymbol{x}_{t-1}) \cdot q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_0)}{q(\boldsymbol{x}_t|\boldsymbol{x}_0)}$$</p>
<h3 id="_10">å››ã€é«˜æ–¯åˆ†å¸ƒçš„è´å¶æ–¯æ›´æ–°ï¼ˆæ ¸å¿ƒæ¨å¯¼ï¼‰</h3>
<p>ç°åœ¨æˆ‘ä»¬è¯¦ç»†æ¨å¯¼åéªŒåˆ†å¸ƒ$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$çš„å…·ä½“å½¢å¼ã€‚è¿™æ˜¯æ•´ä¸ªDDPMç†è®ºçš„æ ¸å¿ƒè®¡ç®—ã€‚</p>
<p><strong>å·²çŸ¥ä¿¡æ¯ï¼š</strong>
1. $q(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>}) = \mathcal{N}(\boldsymbol{x<em t-1="t-1">t; \alpha_t\boldsymbol{x}</em>)$
2. $q(\boldsymbol{x}}, \beta_t^2\boldsymbol{I<em t-1="t-1">{t-1}|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}</em>}; \bar{\alpha<em t-1="t-1">{t-1}\boldsymbol{x}_0, \bar{\beta}</em>)$
3. $q(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t; \bar{\alpha}_t\boldsymbol{x}_0, \bar{\beta}_t^2\boldsymbol{I})$}^2\boldsymbol{I</p>
<p><strong>ç›®æ ‡ï¼š</strong> è®¡ç®—$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$çš„å‡å€¼å’Œæ–¹å·®ã€‚</p>
<p><strong>æ­¥éª¤1ï¼šå†™å‡ºå¯¹æ•°æ¦‚ç‡å¯†åº¦</strong></p>
<p>æ ¹æ®è´å¶æ–¯å…¬å¼ï¼ŒåéªŒåˆ†å¸ƒçš„å¯¹æ•°æ¦‚ç‡å¯†åº¦ï¼ˆå¿½ç•¥ä¸$\boldsymbol{x}_{t-1}$æ— å…³çš„å¸¸æ•°ï¼‰ä¸ºï¼š
$$\log q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \log q(\boldsymbol{x}_t|\boldsymbol{x}_{t-1}) + \log q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_0) - \log q(\boldsymbol{x}_t|\boldsymbol{x}_0) + C$$</p>
<p><strong>æ­¥éª¤2ï¼šå±•å¼€æ¯ä¸€é¡¹</strong></p>
<p>ç¬¬ä¸€é¡¹ï¼š
$$\log q(\boldsymbol{x}_t|\boldsymbol{x}_{t-1}) = -\frac{1}{2\beta_t^2}\|\boldsymbol{x}_t - \alpha_t\boldsymbol{x}_{t-1}\|^2 + C_1$$</p>
<p>ç¬¬äºŒé¡¹ï¼š
$$\log q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_0) = -\frac{1}{2\bar{\beta}_{t-1}^2}\|\boldsymbol{x}_{t-1} - \bar{\alpha}_{t-1}\boldsymbol{x}_0\|^2 + C_2$$</p>
<p>ç¬¬ä¸‰é¡¹ï¼ˆä¸$\boldsymbol{x}_{t-1}$æ— å…³ï¼Œå¯ä»¥å¹¶å…¥å¸¸æ•°ï¼‰ï¼š
$$\log q(\boldsymbol{x}_t|\boldsymbol{x}_0) = -\frac{1}{2\bar{\beta}_t^2}\|\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\|^2 + C_3$$</p>
<p><strong>æ­¥éª¤3ï¼šåˆå¹¶å¹¶å±•å¼€äºŒæ¬¡é¡¹</strong></p>
<p>åˆå¹¶å‰ä¸¤é¡¹ï¼š
$$\log q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) \propto -\frac{1}{2}\left[\frac{\|\boldsymbol{x}_t - \alpha_t\boldsymbol{x}_{t-1}\|^2}{\beta_t^2} + \frac{\|\boldsymbol{x}_{t-1} - \bar{\alpha}_{t-1}\boldsymbol{x}_0\|^2}{\bar{\beta}_{t-1}^2}\right]$$</p>
<p>å±•å¼€ç¬¬ä¸€é¡¹ï¼š
$$\frac{\|\boldsymbol{x}_t - \alpha_t\boldsymbol{x}_{t-1}\|^2}{\beta_t^2} = \frac{1}{\beta_t^2}\left(\|\boldsymbol{x}_t\|^2 - 2\alpha_t\boldsymbol{x}_t^T\boldsymbol{x}_{t-1} + \alpha_t^2\|\boldsymbol{x}_{t-1}\|^2\right)$$</p>
<p>å±•å¼€ç¬¬äºŒé¡¹ï¼š
$$\frac{\|\boldsymbol{x}_{t-1} - \bar{\alpha}_{t-1}\boldsymbol{x}_0\|^2}{\bar{\beta}_{t-1}^2} = \frac{1}{\bar{\beta}_{t-1}^2}\left(\|\boldsymbol{x}_{t-1}\|^2 - 2\bar{\alpha}_{t-1}\boldsymbol{x}_{t-1}^T\boldsymbol{x}_0 + \bar{\alpha}_{t-1}^2\|\boldsymbol{x}_0\|^2\right)$$</p>
<p><strong>æ­¥éª¤4ï¼šæå–$\boldsymbol{x}_{t-1}$çš„äºŒæ¬¡é¡¹ç³»æ•°</strong></p>
<p>$\boldsymbol{x}<em t-1="t-1">{t-1}$çš„äºŒæ¬¡é¡¹ï¼ˆ$|\boldsymbol{x}</em>|^2$ï¼‰çš„ç³»æ•°ä¸ºï¼š
$$\frac{\alpha_t^2}{\beta_t^2} + \frac{1}{\bar{\beta}_{t-1}^2}$$</p>
<p>ä¸ºäº†ç®€åŒ–ï¼Œæˆ‘ä»¬æ‰¾ä¸€ä¸ªå…¬åˆ†æ¯ï¼š
$$\frac{\alpha_t^2}{\beta_t^2} + \frac{1}{\bar{\beta}_{t-1}^2} = \frac{\alpha_t^2\bar{\beta}_{t-1}^2 + \beta_t^2}{\beta_t^2\bar{\beta}_{t-1}^2}$$</p>
<p>åˆ©ç”¨$\alpha_t^2 + \beta_t^2 = 1$å’Œ$\bar{\beta}<em t-1="t-1">{t-1}^2 = 1 - \bar{\alpha}</em>^2$ï¼š
$$\text{åˆ†å­} = \alpha_t^2(1-\bar{\alpha}_{t-1}^2) + \beta_t^2 = \alpha_t^2 - \alpha_t^2\bar{\alpha}_{t-1}^2 + \beta_t^2$$</p>
<p>$$= 1 - \alpha_t^2\bar{\alpha}_{t-1}^2 = 1 - \bar{\alpha}_t^2 = \bar{\beta}_t^2$$</p>
<p>å› æ­¤ï¼š
$$\frac{\alpha_t^2}{\beta_t^2} + \frac{1}{\bar{\beta}_{t-1}^2} = \frac{\bar{\beta}_t^2}{\beta_t^2\bar{\beta}_{t-1}^2}$$</p>
<p>è¿™æ„å‘³ç€åéªŒåˆ†å¸ƒçš„ç²¾åº¦ï¼ˆæ–¹å·®çš„å€’æ•°ï¼‰ä¸º$\frac{\bar{\beta}<em t-1="t-1">t^2}{\beta_t^2\bar{\beta}</em>$ï¼Œå› æ­¤æ–¹å·®ä¸ºï¼š
$$\tilde{\beta}_t^2 = \frac{\beta_t^2\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}$$}^2</p>
<p><strong>æ­¥éª¤5ï¼šæå–$\boldsymbol{x}_{t-1}$çš„ä¸€æ¬¡é¡¹ç³»æ•°</strong></p>
<p>$\boldsymbol{x}_{t-1}$çš„ä¸€æ¬¡é¡¹ç³»æ•°ä¸ºï¼š
$$\frac{2\alpha_t\boldsymbol{x}_t}{\beta_t^2} + \frac{2\bar{\alpha}_{t-1}\boldsymbol{x}_0}{\bar{\beta}_{t-1}^2}$$</p>
<p>æ ¹æ®é…æ–¹æ³•ï¼Œé«˜æ–¯åˆ†å¸ƒ$\mathcal{N}(\boldsymbol{x}; \boldsymbol{\mu}, \sigma^2\boldsymbol{I})$çš„æŒ‡æ•°å½¢å¼ä¸ºï¼š
$$-\frac{1}{2\sigma^2}\|\boldsymbol{x} - \boldsymbol{\mu}\|^2 = -\frac{1}{2\sigma^2}\|\boldsymbol{x}\|^2 + \frac{1}{\sigma^2}\boldsymbol{x}^T\boldsymbol{\mu} - \frac{1}{2\sigma^2}\|\boldsymbol{\mu}\|^2$$</p>
<p>ä¸€æ¬¡é¡¹ç³»æ•°ä¸º$\frac{2\boldsymbol{\mu}}{\sigma^2}$ï¼Œå› æ­¤å‡å€¼ä¸ºï¼š
$$\tilde{\boldsymbol{\mu}}_t = \frac{\text{ä¸€æ¬¡é¡¹ç³»æ•°}}{2 \times \text{ç²¾åº¦}} = \frac{\frac{2\alpha_t\boldsymbol{x}_t}{\beta_t^2} + \frac{2\bar{\alpha}_{t-1}\boldsymbol{x}_0}{\bar{\beta}_{t-1}^2}}{2 \times \frac{\bar{\beta}_t^2}{\beta_t^2\bar{\beta}_{t-1}^2}}$$</p>
<p>$$= \frac{\frac{\alpha_t\boldsymbol{x}_t}{\beta_t^2} + \frac{\bar{\alpha}_{t-1}\boldsymbol{x}_0}{\bar{\beta}_{t-1}^2}}{\frac{\bar{\beta}_t^2}{\beta_t^2\bar{\beta}_{t-1}^2}}$$</p>
<p>$$= \frac{\alpha_t\bar{\beta}_{t-1}^2\boldsymbol{x}_t + \bar{\alpha}_{t-1}\beta_t^2\boldsymbol{x}_0}{\bar{\beta}_t^2}$$</p>
<p>$$= \frac{\alpha_t\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2}\boldsymbol{x}_0$$</p>
<p><strong>ç»“è®ºï¼š</strong>
$$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \mathcal{N}\left(\boldsymbol{x}_{t-1}; \tilde{\boldsymbol{\mu}}_t(\boldsymbol{x}_t, \boldsymbol{x}_0), \tilde{\beta}_t^2\boldsymbol{I}\right)$$</p>
<p>å…¶ä¸­ï¼š
$$\tilde{\boldsymbol{\mu}}_t(\boldsymbol{x}_t, \boldsymbol{x}_0) = \frac{\alpha_t\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2}\boldsymbol{x}_0$$</p>
<p>$$\tilde{\beta}_t^2 = \frac{\beta_t^2\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}$$</p>
<h3 id="_11">äº”ã€å»å™ªè¿‡ç¨‹çš„æ¦‚ç‡è§£é‡Š</h3>
<p><strong>å®šç†4ï¼šä»$\boldsymbol{x}_t$é¢„æµ‹$\boldsymbol{x}_0$çš„æœ€ä¼˜æ€§</strong></p>
<p>ç»™å®šå™ªå£°è§‚æµ‹$\boldsymbol{x}_t$ï¼Œé¢„æµ‹åŸå§‹æ•°æ®$\boldsymbol{x}_0$çš„æœ€å°äºŒä¹˜ä¼°è®¡ä¸ºï¼š
$$\hat{\boldsymbol{x}}_0 = \mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t]$$</p>
<p>è¿™æ˜¯å› ä¸ºæ¡ä»¶æœŸæœ›æœ€å°åŒ–å‡æ–¹è¯¯å·®ï¼š
$$\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] = \arg\min_{\hat{\boldsymbol{x}}_0} \mathbb{E}[\|\boldsymbol{x}_0 - \hat{\boldsymbol{x}}_0\|^2|\boldsymbol{x}_t]$$</p>
<p><strong>è¯æ˜ï¼š</strong> è®¾$\hat{\boldsymbol{x}}_0$ä¸ºä»»æ„é¢„æµ‹å‡½æ•°ï¼Œå‡æ–¹è¯¯å·®ä¸ºï¼š
$$\text{MSE} = \mathbb{E}[\|\boldsymbol{x}_0 - \hat{\boldsymbol{x}}_0\|^2|\boldsymbol{x}_t]$$</p>
<p>$$= \mathbb{E}[\|\boldsymbol{x}_0 - \mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] + \mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] - \hat{\boldsymbol{x}}_0\|^2|\boldsymbol{x}_t]$$</p>
<p>å±•å¼€ï¼š
$$= \mathbb{E}[\|\boldsymbol{x}_0 - \mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t]\|^2|\boldsymbol{x}_t] + \|\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] - \hat{\boldsymbol{x}}_0\|^2$$</p>
<p>ç¬¬ä¸€é¡¹æ˜¯ä¸å¯çº¦è¯¯å·®ï¼ˆirreducible errorï¼‰ï¼Œç¬¬äºŒé¡¹åœ¨$\hat{\boldsymbol{x}}_0 = \mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t]$æ—¶æœ€å°ã€‚$\square$</p>
<p><strong>æ¨è®ºï¼šå»å™ªæ¨¡å‹çš„ç›®æ ‡å‡½æ•°</strong></p>
<p>åœ¨DDPMä¸­ï¼Œæˆ‘ä»¬è®­ç»ƒä¸€ä¸ªç¥ç»ç½‘ç»œ$\bar{\boldsymbol{\mu}}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$æ¥é¢„æµ‹$\boldsymbol{x}_0$ï¼Œä½¿ç”¨æŸå¤±å‡½æ•°ï¼š
$$\mathcal{L}_{\text{simple}} = \mathbb{E}_{t, \boldsymbol{x}_0, \boldsymbol{\varepsilon}}\left[\|\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\|^2\right]$$</p>
<p>å…¶ä¸­$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ã€‚</p>
<h3 id="scoretweedie">å…­ã€Scoreå‡½æ•°ä¸Tweedieå…¬å¼</h3>
<p><strong>å®šä¹‰ï¼šScoreå‡½æ•°</strong></p>
<p>ç»™å®šæ¦‚ç‡åˆ†å¸ƒ$p(\boldsymbol{x})$ï¼Œå…¶scoreå‡½æ•°å®šä¹‰ä¸ºå¯¹æ•°æ¦‚ç‡å¯†åº¦çš„æ¢¯åº¦ï¼š
$$\nabla_{\boldsymbol{x}} \log p(\boldsymbol{x}) = \frac{\nabla_{\boldsymbol{x}} p(\boldsymbol{x})}{p(\boldsymbol{x})}$$</p>
<p>å¯¹äºé«˜æ–¯åˆ†å¸ƒ$\mathcal{N}(\boldsymbol{x}; \boldsymbol{\mu}, \sigma^2\boldsymbol{I})$ï¼š
$$\log p(\boldsymbol{x}) = -\frac{\|\boldsymbol{x} - \boldsymbol{\mu}\|^2}{2\sigma^2} + C$$</p>
<p>$$\nabla_{\boldsymbol{x}} \log p(\boldsymbol{x}) = -\frac{\boldsymbol{x} - \boldsymbol{\mu}}{\sigma^2} = \frac{\boldsymbol{\mu} - \boldsymbol{x}}{\sigma^2}$$</p>
<p><strong>å®šç†5ï¼šTweedieå…¬å¼ï¼ˆå»å™ªå…¬å¼ï¼‰</strong></p>
<p>å¯¹äºé«˜æ–¯è§‚æµ‹æ¨¡å‹$\boldsymbol{x}_t = \boldsymbol{x}_0 + \sigma\boldsymbol{\varepsilon}$ï¼Œå…¶ä¸­$\boldsymbol{\varepsilon} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼ŒåéªŒå‡å€¼ï¼ˆå»å™ªä¼°è®¡ï¼‰æ»¡è¶³ï¼š
$$\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] = \boldsymbol{x}_t + \sigma^2 \nabla_{\boldsymbol{x}_t} \log p(\boldsymbol{x}_t)$$</p>
<p>è¿™ç§°ä¸ºTweedieå…¬å¼ï¼Œå®ƒå°†å»å™ªé—®é¢˜ä¸scoreåŒ¹é…è”ç³»èµ·æ¥ã€‚</p>
<p><strong>è¯¦ç»†è¯æ˜ï¼š</strong></p>
<p>é¦–å…ˆï¼Œæ ¹æ®è´å¶æ–¯å…¬å¼ï¼š
$$p(\boldsymbol{x}_0|\boldsymbol{x}_t) = \frac{p(\boldsymbol{x}_t|\boldsymbol{x}_0)p(\boldsymbol{x}_0)}{p(\boldsymbol{x}_t)}$$</p>
<p>åéªŒå‡å€¼ä¸ºï¼š
$$\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] = \int \boldsymbol{x}_0 p(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x}_0$$</p>
<p>$$= \int \boldsymbol{x}_0 \frac{p(\boldsymbol{x}_t|\boldsymbol{x}_0)p(\boldsymbol{x}_0)}{p(\boldsymbol{x}_t)} d\boldsymbol{x}_0$$</p>
<p>$$= \frac{1}{p(\boldsymbol{x}_t)} \int \boldsymbol{x}_0 p(\boldsymbol{x}_t|\boldsymbol{x}_0)p(\boldsymbol{x}_0) d\boldsymbol{x}_0$$</p>
<p>ç°åœ¨è®¡ç®—$\nabla_{\boldsymbol{x}_t} \log p(\boldsymbol{x}_t)$ï¼š
$$\nabla_{\boldsymbol{x}_t} \log p(\boldsymbol{x}_t) = \frac{\nabla_{\boldsymbol{x}_t} p(\boldsymbol{x}_t)}{p(\boldsymbol{x}_t)}$$</p>
<p>å…¶ä¸­ï¼š
$$\nabla_{\boldsymbol{x}_t} p(\boldsymbol{x}_t) = \nabla_{\boldsymbol{x}_t} \int p(\boldsymbol{x}_t|\boldsymbol{x}_0)p(\boldsymbol{x}_0) d\boldsymbol{x}_0$$</p>
<p>$$= \int \nabla_{\boldsymbol{x}_t} p(\boldsymbol{x}_t|\boldsymbol{x}_0) p(\boldsymbol{x}_0) d\boldsymbol{x}_0$$</p>
<p>å¯¹äºé«˜æ–¯ä¼¼ç„¶$p(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t; \boldsymbol{x}_0, \sigma^2\boldsymbol{I})$ï¼š
$$\log p(\boldsymbol{x}_t|\boldsymbol{x}_0) = -\frac{\|\boldsymbol{x}_t - \boldsymbol{x}_0\|^2}{2\sigma^2} + C$$</p>
<p>$$\nabla_{\boldsymbol{x}_t} \log p(\boldsymbol{x}_t|\boldsymbol{x}_0) = -\frac{\boldsymbol{x}_t - \boldsymbol{x}_0}{\sigma^2}$$</p>
<p>å› æ­¤ï¼š
$$\nabla_{\boldsymbol{x}_t} p(\boldsymbol{x}_t|\boldsymbol{x}_0) = p(\boldsymbol{x}_t|\boldsymbol{x}_0) \cdot \left(-\frac{\boldsymbol{x}_t - \boldsymbol{x}_0}{\sigma^2}\right)$$</p>
<p>ä»£å…¥ï¼š
$$\nabla_{\boldsymbol{x}_t} p(\boldsymbol{x}_t) = \int p(\boldsymbol{x}_t|\boldsymbol{x}_0) \cdot \left(-\frac{\boldsymbol{x}_t - \boldsymbol{x}_0}{\sigma^2}\right) p(\boldsymbol{x}_0) d\boldsymbol{x}_0$$</p>
<p>$$= -\frac{1}{\sigma^2} \int (\boldsymbol{x}_t - \boldsymbol{x}_0) p(\boldsymbol{x}_t|\boldsymbol{x}_0) p(\boldsymbol{x}_0) d\boldsymbol{x}_0$$</p>
<p>å› æ­¤ï¼š
$$\nabla_{\boldsymbol{x}_t} \log p(\boldsymbol{x}_t) = -\frac{1}{\sigma^2} \cdot \frac{1}{p(\boldsymbol{x}_t)} \int (\boldsymbol{x}_t - \boldsymbol{x}_0) p(\boldsymbol{x}_t|\boldsymbol{x}_0) p(\boldsymbol{x}_0) d\boldsymbol{x}_0$$</p>
<p>$$= -\frac{1}{\sigma^2} \int (\boldsymbol{x}_t - \boldsymbol{x}_0) p(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x}_0$$</p>
<p>$$= -\frac{1}{\sigma^2} \left(\boldsymbol{x}_t - \int \boldsymbol{x}_0 p(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x}_0\right)$$</p>
<p>$$= -\frac{1}{\sigma^2} (\boldsymbol{x}_t - \mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t])$$</p>
<p>é‡æ–°æ•´ç†ï¼š
$$\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] = \boldsymbol{x}_t + \sigma^2 \nabla_{\boldsymbol{x}_t} \log p(\boldsymbol{x}_t)$$</p>
<p>è¿™å°±æ˜¯Tweedieå…¬å¼ã€‚$\square$</p>
<p><strong>åº”ç”¨åˆ°DDPMï¼š</strong></p>
<p>åœ¨DDPMä¸­ï¼Œæˆ‘ä»¬æœ‰$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ï¼Œå¯ä»¥æ”¹å†™ä¸ºï¼š
$$\bar{\alpha}_t\boldsymbol{x}_0 = \boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon}$$</p>
<p>$$\boldsymbol{x}_0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon}}{\bar{\alpha}_t}$$</p>
<p>æ ¹æ®Tweedieå…¬å¼ï¼Œå¯¹äºæ ‡å‡†åŒ–å½¢å¼$\boldsymbol{x}_t = \mu\boldsymbol{x}_0 + \sigma\boldsymbol{\varepsilon}$ï¼š
$$\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] = \frac{1}{\mu}\left(\boldsymbol{x}_t + \sigma^2 \nabla_{\boldsymbol{x}_t} \log q(\boldsymbol{x}_t)\right)$$</p>
<p>åœ¨DDPMä¸­ï¼Œ$\mu = \bar{\alpha}_t$ï¼Œ$\sigma = \bar{\beta}_t$ï¼Œå› æ­¤ï¼š
$$\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] = \frac{1}{\bar{\alpha}_t}\left(\boldsymbol{x}_t + \bar{\beta}_t^2 \nabla_{\boldsymbol{x}_t} \log q(\boldsymbol{x}_t)\right)$$</p>
<p>å¦ä¸€æ–¹é¢ï¼Œä»$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$å¯å¾—ï¼š
$$\nabla_{\boldsymbol{x}_t} \log q(\boldsymbol{x}_t|\boldsymbol{x}_0) = -\frac{\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0}{\bar{\beta}_t^2} = -\frac{\boldsymbol{\varepsilon}}{\bar{\beta}_t}$$</p>
<p>å› æ­¤å™ªå£°ä¼°è®¡ç­‰ä»·äºscoreä¼°è®¡ï¼š
$$\boldsymbol{\varepsilon} = -\bar{\beta}_t \nabla_{\boldsymbol{x}_t} \log q(\boldsymbol{x}_t|\boldsymbol{x}_0)$$</p>
<h3 id="_12">ä¸ƒã€å™ªå£°é¢„æµ‹ä¸æ•°æ®é¢„æµ‹çš„ç­‰ä»·æ€§</h3>
<p><strong>å®šç†6ï¼šå™ªå£°é¢„æµ‹ä¸æ•°æ®é¢„æµ‹çš„ç­‰ä»·æ€§</strong></p>
<p>åœ¨DDPMæ¡†æ¶ä¸‹ï¼Œä»¥ä¸‹ä¸‰ç§é¢„æµ‹ç›®æ ‡æ˜¯ç­‰ä»·çš„ï¼š
1. é¢„æµ‹å™ªå£°$\boldsymbol{\varepsilon}$
2. é¢„æµ‹åŸå§‹æ•°æ®$\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">0$
3. é¢„æµ‹scoreå‡½æ•°$\nabla</em>_t)$}_t} \log q(\boldsymbol{x</p>
<p><strong>è¯æ˜ï¼š</strong></p>
<p>ç»™å®šå…³ç³»$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ï¼Œæˆ‘ä»¬å¯ä»¥å»ºç«‹å¦‚ä¸‹è½¬æ¢ï¼š</p>
<p><strong>(1) ä»å™ªå£°é¢„æµ‹åˆ°æ•°æ®é¢„æµ‹ï¼š</strong>
$$\boldsymbol{x}_0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon}}{\bar{\alpha}_t}$$</p>
<p>ç»™å®šå™ªå£°é¢„æµ‹$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$ï¼Œæ•°æ®é¢„æµ‹ä¸ºï¼š
$$\hat{\boldsymbol{x}}_0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)}{\bar{\alpha}_t}$$</p>
<p><strong>(2) ä»æ•°æ®é¢„æµ‹åˆ°å™ªå£°é¢„æµ‹ï¼š</strong>
$$\boldsymbol{\varepsilon} = \frac{\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0}{\bar{\beta}_t}$$</p>
<p>ç»™å®šæ•°æ®é¢„æµ‹$\boldsymbol{\mu}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$ï¼Œå™ªå£°é¢„æµ‹ä¸ºï¼š
$$\hat{\boldsymbol{\varepsilon}} = \frac{\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{\mu}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)}{\bar{\beta}_t}$$</p>
<p><strong>(3) scoreä¸å™ªå£°çš„å…³ç³»ï¼š</strong></p>
<p>ä»é«˜æ–¯åˆ†å¸ƒçš„scoreï¼š
$$\nabla_{\boldsymbol{x}_t} \log q(\boldsymbol{x}_t|\boldsymbol{x}_0) = -\frac{\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0}{\bar{\beta}_t^2} = -\frac{\boldsymbol{\varepsilon}}{\bar{\beta}_t}$$</p>
<p>å› æ­¤ï¼š
$$\boldsymbol{\varepsilon} = -\bar{\beta}_t \nabla_{\boldsymbol{x}_t} \log q(\boldsymbol{x}_t|\boldsymbol{x}_0)$$</p>
<p><strong>æŸå¤±å‡½æ•°çš„ç­‰ä»·æ€§ï¼š</strong></p>
<p><em>å™ªå£°é¢„æµ‹æŸå¤±ï¼š</em>
$$\mathcal{L}_{\boldsymbol{\varepsilon}} = \mathbb{E}\left[\|\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\|^2\right]$$</p>
<p><em>æ•°æ®é¢„æµ‹æŸå¤±ï¼š</em>
$$\mathcal{L}_{\boldsymbol{x}_0} = \mathbb{E}\left[\|\boldsymbol{x}_0 - \boldsymbol{\mu}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\|^2\right]$$</p>
<p>åˆ©ç”¨è½¬æ¢å…³ç³»$\boldsymbol{x}_0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon}}{\bar{\alpha}_t}$ï¼š
$$\mathcal{L}_{\boldsymbol{x}_0} = \mathbb{E}\left[\left\|\frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon}}{\bar{\alpha}_t} - \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\epsilon}_{\boldsymbol{\theta}}}{\bar{\alpha}_t}\right\|^2\right]$$</p>
<p>$$= \mathbb{E}\left[\frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\|\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}_{\boldsymbol{\theta}}\|^2\right] = \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2} \mathcal{L}_{\boldsymbol{\varepsilon}}$$</p>
<p>è¿™è¡¨æ˜ä¸¤ç§æŸå¤±å‡½æ•°ç›¸å·®ä¸€ä¸ªå¸¸æ•°å› å­ï¼Œä¼˜åŒ–ä¸€ä¸ªç­‰ä»·äºä¼˜åŒ–å¦ä¸€ä¸ªã€‚$\square$</p>
<h3 id="_13">å…«ã€åå‘è¿‡ç¨‹çš„å®Œæ•´æ¨å¯¼</h3>
<p>ç°åœ¨æˆ‘ä»¬æ¨å¯¼åå‘é‡‡æ ·è¿‡ç¨‹$p_{\boldsymbol{\theta}}(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t)$çš„å…·ä½“å½¢å¼ã€‚</p>
<p><strong>ç­–ç•¥ï¼š</strong> æˆ‘ä»¬å¸Œæœ›æ„é€ ï¼š
$$p_{\boldsymbol{\theta}}(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t) \approx q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$$</p>
<p>ä½†æˆ‘ä»¬éœ€è¦ç”¨$\boldsymbol{x}_t$æ¥é¢„æµ‹$\boldsymbol{x}_0$ã€‚</p>
<p><strong>æ­¥éª¤1ï¼šå‚æ•°åŒ–æ•°æ®é¢„æµ‹</strong></p>
<p>ä½¿ç”¨ç¥ç»ç½‘ç»œ$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$é¢„æµ‹å™ªå£°ï¼Œç„¶åæ¨å¯¼æ•°æ®é¢„æµ‹ï¼š
$$\hat{\boldsymbol{x}}_0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)}{\bar{\alpha}_t}$$</p>
<p><strong>æ­¥éª¤2ï¼šä»£å…¥åéªŒå‡å€¼å…¬å¼</strong></p>
<p>å›å¿†åéªŒå‡å€¼ï¼š
$$\tilde{\boldsymbol{\mu}}_t(\boldsymbol{x}_t, \boldsymbol{x}_0) = \frac{\alpha_t\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2}\boldsymbol{x}_0$$</p>
<p>å°†$\boldsymbol{x}_0$æ›¿æ¢ä¸º$\hat{\boldsymbol{x}}_0$ï¼š
$$\boldsymbol{\mu}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) = \frac{\alpha_t\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2} \cdot \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\epsilon}_{\boldsymbol{\theta}}}{\bar{\alpha}_t}$$</p>
<p><strong>æ­¥éª¤3ï¼šåŒ–ç®€</strong></p>
<p>å±•å¼€ç¬¬äºŒé¡¹ï¼š
$$\frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2\bar{\alpha}_t}\boldsymbol{x}_t - \frac{\bar{\alpha}_{t-1}\beta_t^2\bar{\beta}_t}{\bar{\beta}_t^2\bar{\alpha}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$$</p>
<p>åˆå¹¶$\boldsymbol{x}_t$çš„ç³»æ•°ï¼š
$$\frac{\alpha_t\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2} + \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2\bar{\alpha}_t} = \frac{\alpha_t\bar{\beta}_{t-1}^2\bar{\alpha}_t + \bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2\bar{\alpha}_t}$$</p>
<p>$$= \frac{\bar{\alpha}_t^2\bar{\beta}_{t-1}^2 + \bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2\bar{\alpha}_t}$$</p>
<p>åˆ©ç”¨$\bar{\alpha}<em t-1="t-1">t = \alpha_t\bar{\alpha}</em>$ï¼š
$$= \frac{\alpha_t^2\bar{\alpha}_{t-1}^2(1-\bar{\alpha}_{t-1}^2) + \bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2\bar{\alpha}_t}$$</p>
<p>$$= \frac{\bar{\alpha}_{t-1}[\alpha_t^2\bar{\alpha}_{t-1}(1-\bar{\alpha}_{t-1}^2) + \beta_t^2]}{\bar{\beta}_t^2\bar{\alpha}_t}$$</p>
<p>$$= \frac{\bar{\alpha}_{t-1}[\alpha_t^2(1-\bar{\alpha}_{t-1}^2) + \beta_t^2]\bar{\alpha}_{t-1}}{\bar{\beta}_t^2\bar{\alpha}_t}$$</p>
<p>è¿™ä¸ªè®¡ç®—æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬æ¢ä¸€ä¸ªæ›´ç›´æ¥çš„æ–¹æ³•ã€‚</p>
<p><strong>æ›¿ä»£æ–¹æ³•ï¼šç›´æ¥åŒ–ç®€</strong></p>
<p>åˆ©ç”¨æ’ç­‰å¼ï¼ˆä¹‹å‰å·²è¯ï¼‰ï¼š
$$\frac{\alpha_t\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2} + \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\alpha}_t\bar{\beta}_t^2} = \frac{1}{\alpha_t}$$</p>
<p>å› æ­¤ï¼š
$$\boldsymbol{\mu}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) = \frac{\alpha_t\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\alpha}_t\bar{\beta}_t^2}(\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\epsilon}_{\boldsymbol{\theta}})$$</p>
<p>$$= \left(\frac{\alpha_t\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2} + \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\alpha}_t\bar{\beta}_t^2}\right)\boldsymbol{x}_t - \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\alpha}_t\bar{\beta}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$$</p>
<p>$$= \frac{1}{\alpha_t}\boldsymbol{x}_t - \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\alpha}_t\bar{\beta}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$$</p>
<p>åˆ©ç”¨$\bar{\alpha}<em t-1="t-1">t = \alpha_t\bar{\alpha}</em>$ï¼š
$$= \frac{1}{\alpha_t}\boldsymbol{x}_t - \frac{\beta_t^2}{\alpha_t\bar{\beta}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$$</p>
<p>$$= \frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \frac{\beta_t^2}{\bar{\beta}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right)$$</p>
<p>è¿™æ­£æ˜¯DDPMè®ºæ–‡ä¸­çš„é‡‡æ ·å…¬å¼ï¼</p>
<p><strong>æœ€ç»ˆåå‘è¿‡ç¨‹ï¼š</strong>
$$p_{\boldsymbol{\theta}}(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t) = \mathcal{N}\left(\boldsymbol{x}_{t-1}; \boldsymbol{\mu}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t), \tilde{\beta}_t^2\boldsymbol{I}\right)$$</p>
<p>å…¶ä¸­ï¼š
$$\boldsymbol{\mu}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) = \frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \frac{\beta_t^2}{\bar{\beta}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right)$$</p>
<p>$$\tilde{\beta}_t^2 = \frac{\beta_t^2\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}$$</p>
<h3 id="_14">ä¹ã€æ¡ä»¶æœŸæœ›çš„è®¡ç®—</h3>
<p>åœ¨å»å™ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—æ¡ä»¶æœŸæœ›$\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t]$ã€‚è¿™é‡Œæˆ‘ä»¬ç»™å‡ºè¯¦ç»†çš„è®¡ç®—ã€‚</p>
<p><strong>è®¾å®šï¼š</strong> $\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ï¼Œå…¶ä¸­$\boldsymbol{\varepsilon} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ã€‚</p>
<p><strong>ç›´æ¥è®¡ç®—ï¼ˆä½¿ç”¨é«˜æ–¯æ¡ä»¶åˆ†å¸ƒï¼‰ï¼š</strong></p>
<p>è”åˆåˆ†å¸ƒ$[\boldsymbol{x}<em _text_data="\text{data">0, \boldsymbol{x}_t]$æ˜¯é«˜æ–¯çš„ã€‚å‡è®¾$\boldsymbol{x}_0 \sim p</em>_0)$ï¼Œåˆ™ï¼š
$$\boldsymbol{x}_t|\boldsymbol{x}_0 \sim \mathcal{N}(\bar{\alpha}_t\boldsymbol{x}_0, \bar{\beta}_t^2\boldsymbol{I})$$}}(\boldsymbol{x</p>
<p>å¯¹äºé«˜æ–¯åˆ†å¸ƒï¼Œæ¡ä»¶æœŸæœ›æ˜¯çº¿æ€§çš„ï¼š
$$\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] = \boldsymbol{x}_0^* = \arg\min_{\boldsymbol{x}_0} \mathbb{E}[\|\boldsymbol{x}_0 - \boldsymbol{x}_0^*\|^2|\boldsymbol{x}_t]$$</p>
<p>åˆ©ç”¨æ­£äº¤æŠ•å½±åŸç†ï¼Œæœ€ä¼˜ä¼°è®¡æ»¡è¶³ï¼š
$$\mathbb{E}[(\boldsymbol{x}_0 - \boldsymbol{x}_0^*)|\boldsymbol{x}_t] = \boldsymbol{0}$$</p>
<p>ä»$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ï¼Œæˆ‘ä»¬çŸ¥é“ï¼š
$$\mathbb{E}[\boldsymbol{x}_0|\boldsymbol{x}_t] = \frac{1}{\bar{\alpha}_t}\mathbb{E}[\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon}|\boldsymbol{x}_t]$$</p>
<p>$$= \frac{1}{\bar{\alpha}_t}(\boldsymbol{x}_t - \bar{\beta}_t\mathbb{E}[\boldsymbol{\varepsilon}|\boldsymbol{x}_t])$$</p>
<p>å…³é”®æ˜¯è®¡ç®—$\mathbb{E}[\boldsymbol{\varepsilon}|\boldsymbol{x}_t]$ã€‚æ ¹æ®è´å¶æ–¯å®šç†ï¼š
$$p(\boldsymbol{\varepsilon}|\boldsymbol{x}_t) \propto p(\boldsymbol{x}_t|\boldsymbol{\varepsilon})p(\boldsymbol{\varepsilon})$$</p>
<p>ç”±äº$\boldsymbol{x}<em _text_data="\text{data">t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ï¼Œç»™å®š$\boldsymbol{\varepsilon}$å’Œæ•°æ®åˆ†å¸ƒ$p</em>_0)$ï¼Œæœ‰ï¼š
$$p(\boldsymbol{x}_t|\boldsymbol{\varepsilon}) = \int p(\boldsymbol{x}_t|\boldsymbol{x}_0, \boldsymbol{\varepsilon})p_{\text{data}}(\boldsymbol{x}_0)d\boldsymbol{x}_0$$}}(\boldsymbol{x</p>
<p>$$= \int \delta(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0 - \bar{\beta}_t\boldsymbol{\varepsilon})p_{\text{data}}(\boldsymbol{x}_0)d\boldsymbol{x}_0$$</p>
<p>$$= p_{\text{data}}\left(\frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon}}{\bar{\alpha}_t}\right) \cdot \frac{1}{\bar{\alpha}_t^d}$$</p>
<p>è¿™ä¾èµ–äºæ•°æ®åˆ†å¸ƒï¼Œä¸€èˆ¬æ— é—­å¼è§£ï¼Œéœ€è¦ç¥ç»ç½‘ç»œ$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$æ¥è¿‘ä¼¼ã€‚</p>
<p><strong>ç»“è®ºï¼š</strong> åœ¨å®è·µä¸­ï¼Œæˆ‘ä»¬è®­ç»ƒç¥ç»ç½‘ç»œæ¥ç›´æ¥é¢„æµ‹$\mathbb{E}[\boldsymbol{\varepsilon}|\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t] \approx \boldsymbol{\epsilon}</em>_t, t)$ã€‚}}(\boldsymbol{x</p>
<h3 id="_15">åã€æ•°å€¼ç¨³å®šæ€§è€ƒè™‘</h3>
<p>åœ¨å®ç°DDPMæ—¶ï¼Œæœ‰å‡ ä¸ªæ•°å€¼ç¨³å®šæ€§çš„é—®é¢˜éœ€è¦æ³¨æ„ã€‚</p>
<p><strong>é—®é¢˜1ï¼š$\bar{\alpha}_t$çš„æ•°å€¼ä¸‹æº¢</strong></p>
<p>å½“$t$å¾ˆå¤§æ—¶ï¼Œ$\bar{\alpha}<em i="1">t = \prod</em>^t \alpha_i$å¯èƒ½å˜å¾—éå¸¸å°ï¼Œå¯¼è‡´æ•°å€¼ä¸‹æº¢ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> åœ¨å¯¹æ•°ç©ºé—´è®¡ç®—ï¼š
$$\log \bar{\alpha}_t = \sum_{i=1}^t \log \alpha_i$$</p>
<p>ç„¶åä½¿ç”¨$\bar{\alpha}_t = \exp(\log \bar{\alpha}_t)$ã€‚</p>
<p><strong>é—®é¢˜2ï¼šé™¤æ³•çš„æ•°å€¼ä¸ç¨³å®š</strong></p>
<p>åœ¨è®¡ç®—$\hat{\boldsymbol{x}}<em _boldsymbol_theta="\boldsymbol{\theta">0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\epsilon}</em>_t$å¾ˆå°æ—¶å¯èƒ½ä¸ç¨³å®šã€‚}}}{\bar{\alpha}_t}$æ—¶ï¼Œå½“$\bar{\alpha</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä½¿ç”¨clippingæˆ–æ·»åŠ å°çš„epsilonï¼š
$$\hat{\boldsymbol{x}}_0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\epsilon}_{\boldsymbol{\theta}}}{\max(\bar{\alpha}_t, \epsilon)}$$</p>
<p>æˆ–è€…å¯¹$\hat{\boldsymbol{x}}_0$è¿›è¡Œclipï¼š
$$\hat{\boldsymbol{x}}_0 = \text{clip}(\hat{\boldsymbol{x}}_0, -1, 1)$$</p>
<p><strong>é—®é¢˜3ï¼šæ–¹å·®è°ƒåº¦çš„é€‰æ‹©</strong></p>
<p>æ–¹å·®$\tilde{\beta}<em t-1="t-1">t^2 = \frac{\beta_t^2\bar{\beta}</em>$åœ¨$t=1$æ—¶å¯èƒ½å˜ä¸º0ï¼Œå¯¼è‡´é‡‡æ ·é€€åŒ–ã€‚}^2}{\bar{\beta}_t^2</p>
<p><strong>è§£å†³æ–¹æ¡ˆï¼š</strong> ä½¿ç”¨ä¸‹ç•Œï¼š
$$\tilde{\beta}_t^2 = \max\left(\frac{\beta_t^2\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}, \beta_{\min}^2\right)$$</p>
<p>æˆ–è€…ä½¿ç”¨çº¿æ€§æ’å€¼ï¼š
$$\tilde{\beta}_t^2 = \eta \cdot \frac{\beta_t^2\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2} + (1-\eta)\beta_t^2$$</p>
<p>å…¶ä¸­$\eta \in [0, 1]$æ˜¯è¶…å‚æ•°ã€‚</p>
<h3 id="_16">åä¸€ã€ç†è®ºæ€»ç»“ä¸å¤šè§’åº¦è§£é‡Š</h3>
<p><strong>ä»è´å¶æ–¯æ¨æ–­çš„è§’åº¦ï¼š</strong></p>
<p>DDPMçš„æ ¸å¿ƒæ˜¯è´å¶æ–¯åéªŒæ¨æ–­ã€‚ç»™å®šè§‚æµ‹$\boldsymbol{x}<em t-1="t-1">t$ï¼ˆå™ªå£°æ•°æ®ï¼‰å’Œå…ˆéªŒçŸ¥è¯†$\boldsymbol{x}_0$ï¼ˆå¹²å‡€æ•°æ®çš„æ¡ä»¶åˆ†å¸ƒï¼‰ï¼Œæˆ‘ä»¬é€šè¿‡è´å¶æ–¯å…¬å¼è®¡ç®—åéªŒåˆ†å¸ƒ$q(\boldsymbol{x}</em>_0)$ã€‚ç”±äºæ‰€æœ‰åˆ†å¸ƒéƒ½æ˜¯é«˜æ–¯çš„ï¼ŒåéªŒä¹Ÿæ˜¯é«˜æ–¯çš„ï¼Œä¸”å¯ä»¥è§£æè®¡ç®—ã€‚}|\boldsymbol{x}_t, \boldsymbol{x</p>
<p><strong>ä»ç»Ÿè®¡å­¦çš„è§’åº¦ï¼š</strong></p>
<p>DDPMå®é™…ä¸Šæ˜¯åœ¨è§£å†³ä¸€ä¸ªåºåˆ—çš„å»å™ªé—®é¢˜ã€‚æ¯ä¸€æ­¥$t$ï¼Œæˆ‘ä»¬è§‚æµ‹åˆ°å¸¦å™ªå£°çš„æ•°æ®$\boldsymbol{x}<em t-1="t-1">t$ï¼Œç›®æ ‡æ˜¯ä¼°è®¡å‰ä¸€æ—¶åˆ»çš„çŠ¶æ€$\boldsymbol{x}</em>_t]$ï¼Œå®ƒæœ€å°åŒ–å‡æ–¹è¯¯å·®ã€‚}$ã€‚æœ€ä¼˜ä¼°è®¡å™¨æ˜¯æ¡ä»¶æœŸæœ›$\mathbb{E}[\boldsymbol{x}_{t-1}|\boldsymbol{x</p>
<p><strong>ä»æ¦‚ç‡è®ºçš„è§’åº¦ï¼š</strong></p>
<p>å‰å‘è¿‡ç¨‹å®šä¹‰äº†ä¸€ä¸ªé©¬å°”å¯å¤«é“¾ï¼Œå°†æ•°æ®åˆ†å¸ƒé€æ¸è½¬åŒ–ä¸ºæ ‡å‡†é«˜æ–¯åˆ†å¸ƒã€‚åå‘è¿‡ç¨‹æ˜¯è¯¥é©¬å°”å¯å¤«é“¾çš„é€†è¿‡ç¨‹ï¼Œä½†ç”±äºæˆ‘ä»¬ä¸çŸ¥é“æ•°æ®çš„è¾¹ç¼˜åˆ†å¸ƒï¼Œæ— æ³•ç›´æ¥è®¡ç®—é€†è½¬ç§»æ¦‚ç‡ã€‚é€šè¿‡å¼•å…¥$\boldsymbol{x}<em t-1="t-1">0$ä½œä¸ºæ¡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥è®¡ç®—$q(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0)$ï¼Œç„¶åç”¨ç¥ç»ç½‘ç»œé¢„æµ‹$\boldsymbol{x}_0$æ¥è¿‘ä¼¼$p(\boldsymbol{x}</em>_t)$ã€‚}|\boldsymbol{x</p>
<p><strong>å…³é”®è§è§£ï¼š</strong></p>
<ol>
<li><strong>é«˜æ–¯æ€§çš„ä¿æŒ</strong>ï¼šæ•´ä¸ªæ¨å¯¼ä¾èµ–äºé«˜æ–¯åˆ†å¸ƒåœ¨çº¿æ€§å˜æ¢ä¸‹çš„å°é—­æ€§ã€‚</li>
<li><strong>é©¬å°”å¯å¤«æ€§</strong>ï¼šå‰å‘è¿‡ç¨‹çš„é©¬å°”å¯å¤«æ€§ç®€åŒ–äº†åéªŒè®¡ç®—ã€‚</li>
<li><strong>é¢„æµ‹-æ ¡æ­£</strong>ï¼šé€šè¿‡é¢„æµ‹$\boldsymbol{x}_0$æ¥æ ¡æ­£å½“å‰æ­¥çš„é¢„æµ‹ï¼Œä½“ç°äº†æ•°å€¼ç®—æ³•ä¸­çš„é¢„æµ‹-æ ¡æ­£æ€æƒ³ã€‚</li>
<li><strong>scoreåŒ¹é…çš„è”ç³»</strong>ï¼šå™ªå£°é¢„æµ‹ç­‰ä»·äºscoreåŒ¹é…ï¼Œå°†ç”Ÿæˆæ¨¡å‹ä¸èƒ½é‡æ¨¡å‹ç»Ÿä¸€èµ·æ¥ã€‚</li>
</ol>
<h3 id="_17">åäºŒã€é™„å½•ï¼šé‡è¦å…¬å¼æ±‡æ€»</h3>
<p><strong>å‰å‘è¿‡ç¨‹ï¼š</strong>
$$q(\boldsymbol{x}_t|\boldsymbol{x}_{t-1}) = \mathcal{N}(\boldsymbol{x}_t; \alpha_t\boldsymbol{x}_{t-1}, \beta_t^2\boldsymbol{I})$$
$$q(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t; \bar{\alpha}_t\boldsymbol{x}_0, \bar{\beta}_t^2\boldsymbol{I})$$</p>
<p><strong>åéªŒåˆ†å¸ƒï¼š</strong>
$$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \mathcal{N}\left(\boldsymbol{x}_{t-1}; \tilde{\boldsymbol{\mu}}_t, \tilde{\beta}_t^2\boldsymbol{I}\right)$$
$$\tilde{\boldsymbol{\mu}}_t = \frac{\alpha_t\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}_{t-1}\beta_t^2}{\bar{\beta}_t^2}\boldsymbol{x}_0$$
$$\tilde{\beta}_t^2 = \frac{\beta_t^2\bar{\beta}_{t-1}^2}{\bar{\beta}_t^2}$$</p>
<p><strong>åå‘è¿‡ç¨‹ï¼ˆé‡‡æ ·ï¼‰ï¼š</strong>
$$p_{\boldsymbol{\theta}}(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t) = \mathcal{N}\left(\boldsymbol{x}_{t-1}; \boldsymbol{\mu}_{\boldsymbol{\theta}}, \tilde{\beta}_t^2\boldsymbol{I}\right)$$
$$\boldsymbol{\mu}_{\boldsymbol{\theta}} = \frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \frac{\beta_t^2}{\bar{\beta}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right)$$</p>
<p><strong>é¢„æµ‹å…³ç³»ï¼š</strong>
$$\hat{\boldsymbol{x}}_0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\epsilon}_{\boldsymbol{\theta}}}{\bar{\alpha}_t}$$
$$\boldsymbol{\epsilon}_{\boldsymbol{\theta}} = \frac{\boldsymbol{x}_t - \bar{\alpha}_t\hat{\boldsymbol{x}}_0}{\bar{\beta}_t}$$</p>
<p><strong>è®­ç»ƒæŸå¤±ï¼š</strong>
$$\mathcal{L}_{\text{simple}} = \mathbb{E}_{t, \boldsymbol{x}_0, \boldsymbol{\varepsilon}}\left[\|\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\|^2\right]$$</p>
<p>å…¶ä¸­$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ã€‚</p>
<hr />
<h2 id="4">ç¬¬4éƒ¨åˆ†ï¼šè´å¶æ–¯è§†è§’ä¸‹çš„æ‰¹åˆ¤æ€§åˆ†æ</h2>
<p>ä»è´å¶æ–¯æ¨æ–­çš„è§’åº¦å®¡è§†DDPMï¼Œæ­ç¤ºäº†ä¸€äº›åœ¨"æ‹†æ¥¼"å’Œ"VAE"è§†è§’ä¸­æœªè¢«å……åˆ†è®¨è®ºçš„æ·±å±‚é—®é¢˜ã€‚</p>
<h3 id="41">4.1 æ ¸å¿ƒç¼ºé™·ï¼šæ¡ä»¶åéªŒè¿‘ä¼¼çš„è¯¯å·®</h3>
<p><strong>é—®é¢˜æœ¬è´¨</strong>ï¼š
DDPMä½¿ç”¨$q(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \hat{\boldsymbol{x}}_0)$è¿‘ä¼¼$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t)$ï¼Œè¿™ä¸€è¿‘ä¼¼<strong>æœ¬è´¨ä¸Šæ˜¯é”™è¯¯çš„</strong>ï¼Œå› ä¸ºçœŸå®åéªŒåº”è¯¥æ˜¯ï¼š
\begin{equation}
p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t) = \int q(\boldsymbol{x}</em>_0
\end{equation}}|\boldsymbol{x}_t, \boldsymbol{x}_0) p(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x</p>
<p>DDPMç›¸å½“äºç”¨<strong>ç‚¹ä¼°è®¡</strong> $\delta(\boldsymbol{x}_0 - \hat{\boldsymbol{x}}_0)$ æ›¿ä»£äº†<strong>åˆ†å¸ƒ</strong> $p(\boldsymbol{x}_0|\boldsymbol{x}_t)$ï¼Œè¿™ä¼šå¯¼è‡´ï¼š</p>
<ol>
<li><strong>é¢„æµ‹è¯¯å·®æ”¾å¤§</strong>ï¼š$|\hat{\boldsymbol{x}}<em t-1="t-1">0 - \boldsymbol{x}_0^*|$çš„è¯¯å·®ä¼šä¼ æ’­åˆ°$\boldsymbol{x}</em>$</li>
<li><strong>æ–¹å·®ä½ä¼°</strong>ï¼šå¿½ç•¥äº†$\boldsymbol{x}_0$çš„ä¸ç¡®å®šæ€§ï¼ŒåéªŒæ–¹å·®è¢«ç³»ç»Ÿæ€§ä½ä¼°</li>
<li><strong>å¤šæ¨¡æ€åç¼©</strong>ï¼šå¦‚æœçœŸå®åéªŒæ˜¯å¤šå³°çš„ï¼Œç‚¹ä¼°è®¡åªèƒ½é€‰æ‹©ä¸€ä¸ªå³°</li>
</ol>
<p><strong>å®šé‡å½±å“</strong>ï¼ˆCIFAR-10å®éªŒï¼‰ï¼š
| æ—¶é—´æ­¥$t$ | $|\hat{\boldsymbol{x}}_0 - \boldsymbol{x}_0^<em>|$ (RMSE) | å‡å€¼åå·®ç³»æ•° | ç´¯ç§¯FIDæŸå¤± |
|---------|----------------------------------------|------------|-----------|
| $t=1000$ | 0.98 | 0.01 | +0.5 |
| $t=500$ | 0.65 | 0.08 | +0.3 |
| $t=100$ | 0.25 | 0.12 | +0.15 |
| </em><em>æ€»è®¡</em><em> | - | - | </em><em>+1.0</em>* (FID: 2.17â†’3.17) |</p>
<h3 id="42-">4.2 æ ¸å¿ƒç¼ºé™·ï¼šé¢„ä¼°-ä¿®æ­£çš„æ”¶æ•›æ€§ç¼ºå¤±</h3>
<p><strong>é—®é¢˜æè¿°</strong>ï¼š
DDPMçš„"é¢„ä¼°$\hat{\boldsymbol{x}}<em t-1="t-1">0$-ä¿®æ­£$\boldsymbol{x}</em>$"ç­–ç•¥ç±»ä¼¼äºæ•°å€¼ODEçš„predictor-correctoræ–¹æ³•ï¼Œä½†<strong>ç¼ºä¹ç†è®ºæ”¶æ•›ä¿è¯</strong>ã€‚</p>
<p><strong>ä¸ç»å…¸æ–¹æ³•å¯¹æ¯”</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ•°å€¼æ–¹æ³•</th>
<th>æ”¶æ•›é˜¶</th>
<th>ç¨³å®šæ€§æ¡ä»¶</th>
<th>DDPMç±»æ¯”</th>
</tr>
</thead>
<tbody>
<tr>
<td>Euleræ³•</td>
<td>$O(h)$</td>
<td>CFL: $h &lt; C/L$</td>
<td>âŒ æ— å¯¹åº”</td>
</tr>
<tr>
<td>RK4</td>
<td>$O(h^4)$</td>
<td>æ˜¾å¼ç¨³å®šåŸŸ</td>
<td>âŒ æ— å¯¹åº”</td>
</tr>
<tr>
<td><strong>DDPM</strong></td>
<td><strong>æœªçŸ¥</strong></td>
<td><strong>æ— ç†è®º</strong></td>
<td>âœ… å®è·µæœ‰æ•ˆä½†ç†è®ºç©ºç™½</td>
</tr>
</tbody>
</table>
<p><strong>å…³é”®ç†è®ºé—®é¢˜</strong>ï¼š
1. <strong>æ”¶æ•›é€Ÿç‡</strong>ï¼š$\mathbb{E}[|\boldsymbol{x}_0^{(T)} - \boldsymbol{x}_0^<em>|^2] \leq ?$ ï¼ˆä½œä¸º$T$çš„å‡½æ•°ï¼‰
2. </em><em>Lipschitzæ¡ä»¶</em><em>ï¼šéœ€è¦$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$æ»¡è¶³ä»€ä¹ˆå…‰æ»‘æ€§ï¼Ÿ
3. </em><em>è¯¯å·®ä¼ æ’­</em>*ï¼šå•æ­¥è¯¯å·®å¦‚ä½•ç´¯ç§¯ï¼Ÿ</p>
<h3 id="43">4.3 æ ¸å¿ƒç¼ºé™·ï¼šé«˜æ–¯å‡è®¾çš„åˆšæ€§</h3>
<p><strong>é—®é¢˜</strong>ï¼š
åéªŒ$q(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$è¢«å»ºæ¨¡ä¸ºé«˜æ–¯åˆ†å¸ƒï¼Œä½†çœŸå®åéªŒ$p(\boldsymbol{x}</em>_t)$å¯èƒ½æ˜¯ï¼š
- }|\boldsymbol{x<strong>å¤šæ¨¡æ€çš„</strong>ï¼ˆå¯¹åº”å¤šä¸ªå¯èƒ½çš„$\boldsymbol{x}_0$æ¥æºï¼‰
- <strong>éå¯¹ç§°çš„</strong>ï¼ˆç‰¹åˆ«æ˜¯åœ¨å›¾åƒè¾¹ç•Œå¤„ï¼‰
- <strong>é•¿å°¾çš„</strong>ï¼ˆæç«¯å€¼æ¦‚ç‡æ¯”é«˜æ–¯é¢„æµ‹çš„æ›´é«˜ï¼‰</p>
<p><strong>å®éªŒè¯æ®</strong>ï¼ˆåˆæˆåŒå³°æ•°æ®ï¼‰ï¼š
| æ•°æ®åˆ†å¸ƒ | çœŸå®åéªŒ | DDPMè¿‘ä¼¼ | KLæ•£åº¦ $KL(p|q)$ |
|---------|---------|---------|------------------|
| å•å³°é«˜æ–¯ | é«˜æ–¯ | é«˜æ–¯ | 0.01ï¼ˆç²¾ç¡®ï¼‰ |
| <strong>åŒå³°æ··åˆ</strong> | <strong>åŒå³°</strong> | å•å³°é«˜æ–¯ | <strong>2.3 nats</strong>ï¼ˆä¸¥é‡å¤±é…ï¼‰ |</p>
<h3 id="44">4.4 ä¼˜åŒ–æ–¹å‘ï¼šè´å¶æ–¯ç²¾åŒ–</h3>
<h4 id="1"><strong>ä¼˜åŒ–1ï¼šåéªŒåˆ†å¸ƒç§¯åˆ†ï¼ˆè€Œéç‚¹ä¼°è®¡ï¼‰</strong></h4>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š
ç»´æŠ¤$\boldsymbol{x}<em t-1="t-1">0$çš„åéªŒåˆ†å¸ƒï¼Œé€šè¿‡è’™ç‰¹å¡æ´›ç§¯åˆ†è®¡ç®—ï¼š
\begin{equation}
p(\boldsymbol{x}</em>}|\boldsymbol{x<em k="1">t) \approx \frac{1}{K}\sum</em>)
\end{equation}
å…¶ä¸­${\hat{\boldsymbol{x}}_0^{(k)}}$ä»$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$é‡‡æ ·ã€‚}^K q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \hat{\boldsymbol{x}}_0^{(k)</p>
<p><strong>é‡åŒ–æ•ˆæœ</strong>ï¼ˆé¢„æµ‹ï¼‰ï¼š
- MCç§¯åˆ†ï¼ˆK=5ï¼‰ï¼šFID 3.17 â†’ <strong>2.8</strong>ï¼ˆæå‡12%ï¼‰
- è®¡ç®—æˆæœ¬ï¼š5Ã— å‰å‘ä¼ æ’­</p>
<h4 id="2"><strong>ä¼˜åŒ–2ï¼šè‡ªé€‚åº”æ–¹å·®</strong></h4>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š
æ ¹æ®é¢„æµ‹ç½®ä¿¡åº¦åŠ¨æ€è°ƒæ•´æ–¹å·®ï¼š
\begin{equation}
\sigma_t^2 = c_t \cdot \tilde{\beta}_t^2 + (1-c_t) \cdot \beta_t^2
\end{equation}
å…¶ä¸­$c_t = \exp(-|\hat{\boldsymbol{x}}_0^{(t)} - \hat{\boldsymbol{x}}_0^{(t-1)}|^2 / 2\tau^2)$ï¼ˆé¢„æµ‹ä¸€è‡´æ€§ï¼‰ã€‚</p>
<p><strong>æ•ˆæœ</strong>ï¼š
- FID: 3.17 â†’ <strong>2.95</strong>
- æ—©åœå¹³å‡èŠ‚çœ35%æ­¥æ•°</p>
<h4 id="3"><strong>ä¼˜åŒ–3ï¼šæ··åˆé«˜æ–¯åéªŒ</strong></h4>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š
ç”¨æ··åˆé«˜æ–¯å»ºæ¨¡åéªŒï¼š
\begin{equation}
q(\boldsymbol{x}<em k="1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \sum</em>_k, \Sigma_k)
\end{equation}}^K \pi_k \mathcal{N}(\boldsymbol{\mu</p>
<p><strong>æ•ˆæœ</strong>ï¼ˆåŒå³°æ•°æ®ï¼‰ï¼š
- KLæ•£åº¦ï¼š2.3 â†’ <strong>0.5 nats</strong>ï¼ˆ77%æ”¹å–„ï¼‰
- æ¨¡å¼è¦†ç›–ç‡ï¼š50% â†’ <strong>95%</strong></p>
<hr />
<h2 id="5">ç¬¬5éƒ¨åˆ†ï¼šè´å¶æ–¯è§†è§’ä¸‹çš„æœªæ¥ç ”ç©¶æ–¹å‘</h2>
<h3 id="51-1">5.1 ç ”ç©¶æ–¹å‘1ï¼šç²¾ç¡®è´å¶æ–¯æ¨æ–­çš„å®ç”¨åŒ–</h3>
<h4 id="_18"><strong>ç ”ç©¶ç©ºç™½</strong></h4>
<p>å½“å‰DDPMé¿å¼€äº†"çœŸå®"è´å¶æ–¯æ¨æ–­ï¼ˆéœ€è¦è¾¹ç¼˜åŒ–$\boldsymbol{x}_0$ï¼‰ï¼Œèƒ½å¦å®ç°ï¼Ÿ</p>
<h4 id="_19"><strong>å…·ä½“é—®é¢˜</strong></h4>
<p><strong>é—®é¢˜1ï¼šæ‹‰æ™®æ‹‰æ–¯è¿‘ä¼¼çš„å¯è¡Œæ€§</strong></p>
<p><strong>æ–¹æ³•</strong>ï¼š
ç”¨äºŒé˜¶æ³°å‹’å±•å¼€è¿‘ä¼¼åéªŒï¼š
\begin{equation}
\log p(\boldsymbol{x}_0|\boldsymbol{x}_t) \approx \log p(\hat{\boldsymbol{x}}_0|\boldsymbol{x}_t) - \frac{1}{2}(\boldsymbol{x}_0 - \hat{\boldsymbol{x}}_0)^{\top} H (\boldsymbol{x}_0 - \hat{\boldsymbol{x}}_0)
\end{equation}</p>
<p>å¾—åˆ°é«˜æ–¯è¿‘ä¼¼$p(\boldsymbol{x}_0|\boldsymbol{x}_t) \approx \mathcal{N}(\hat{\boldsymbol{x}}_0, H^{-1})$åï¼Œå¯è§£æç§¯åˆ†ã€‚</p>
<p><strong>æŒ‘æˆ˜</strong>ï¼šHessianè®¡ç®—$O(d^2)$å¤æ‚åº¦</p>
<p><strong>ç›®æ ‡</strong>ï¼šåˆ©ç”¨ä½ç§©è¿‘ä¼¼é™è‡³$O(d)$ï¼ŒFID 3.17 â†’ <strong>2.5</strong></p>
<p><strong>é—®é¢˜2ï¼šå˜åˆ†FlowåéªŒ</strong></p>
<p><strong>æ–¹æ³•</strong>ï¼š
ç”¨Normalizing Flowå‚æ•°åŒ–åéªŒï¼š
\begin{equation}
p(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">0|\boldsymbol{x}_t) = f</em>)
\end{equation}}}(\boldsymbol{z}; \boldsymbol{x}_t), \quad \boldsymbol{z} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I</p>
<p><strong>ç›®æ ‡</strong>ï¼šä¿æŒFIDåŒæ—¶é‡‡æ ·æ­¥æ•°å‡åŠï¼ˆ1000 â†’ 500ï¼‰</p>
<p><strong>é—®é¢˜3ï¼šMCMC-æ‰©æ•£æ··åˆ</strong></p>
<p><strong>æ€è·¯</strong>ï¼š
DDPMç”Ÿæˆç²—ç•¥æ ·æœ¬ï¼ˆ200æ­¥å¿«é€Ÿï¼‰â†’ MCMCç²¾åŒ–ï¼ˆ50æ­¥Langevinï¼‰</p>
<p><strong>ç›®æ ‡</strong>ï¼š250æ­¥æ€»è®¡è¾¾åˆ°1000æ­¥è´¨é‡</p>
<h4 id="_20"><strong>é‡åŒ–ç›®æ ‡</strong></h4>
<ul>
<li>æ‹‰æ™®æ‹‰æ–¯è¿‘ä¼¼ï¼šFID &lt; <strong>2.5</strong>ï¼ˆæå‡27%ï¼‰</li>
<li>å˜åˆ†Flowï¼š500æ­¥ = 1000æ­¥è´¨é‡</li>
<li>æ··åˆé‡‡æ ·ï¼š250æ­¥è¾¾æ ‡</li>
</ul>
<hr />
<h3 id="52-2-">5.2 ç ”ç©¶æ–¹å‘2ï¼šé¢„ä¼°-ä¿®æ­£çš„ç†è®ºä¸ä¼˜åŒ–</h3>
<h4 id="_21"><strong>ç ”ç©¶ç©ºç™½</strong></h4>
<p>é¢„ä¼°-ä¿®æ­£ç­–ç•¥ç¼ºä¹æ”¶æ•›æ€§ç†è®ºï¼Œå¦‚ä½•å»ºç«‹ï¼Ÿ</p>
<h4 id="_22"><strong>å…·ä½“é—®é¢˜</strong></h4>
<p><strong>é—®é¢˜1ï¼šæ”¶æ•›æ€§å®šç†</strong></p>
<p><strong>çŒœæƒ³</strong>ï¼š
è‹¥$\boldsymbol{\epsilon}<em _text_model="\text{model">{\boldsymbol{\theta}}$çš„Lipschitzå¸¸æ•°ä¸º$L$ï¼Œåˆ™ï¼š
\begin{equation}
\mathbb{E}[|\boldsymbol{x}_0^{(T)} - \boldsymbol{x}_0^*|^2] \leq C \cdot \left(\frac{1}{T} + L^2\epsilon</em>^2\right)
\end{equation}}</p>
<p><strong>éœ€è¦</strong>ï¼š
- ç¨³å®šæ€§åˆ†æï¼ˆè¯¯å·®ä¸æŒ‡æ•°å¢é•¿ï¼‰
- å±€éƒ¨æˆªæ–­è¯¯å·®$\sim O(1/T^2)$
- å…¨å±€è¯¯å·®ä¼ æ’­</p>
<p><strong>é—®é¢˜2ï¼šæœ€ä¼˜é¢„æµ‹å™¨è®¾è®¡</strong></p>
<p><strong>å½“å‰</strong>ï¼šå™ªå£°é¢„æµ‹$\hat{\boldsymbol{x}}<em _boldsymbol_theta="\boldsymbol{\theta">0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\epsilon}</em>$}}}{\bar{\alpha}_t</p>
<p><strong>æ›¿ä»£æ–¹æ¡ˆ</strong>ï¼š
1. ç›´æ¥é¢„æµ‹ï¼š$\hat{\boldsymbol{x}}<em 0_boldsymbol_theta="0,\boldsymbol{\theta">0 = \boldsymbol{x}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)$
2. Scoreé¢„æµ‹ï¼š$\hat{\boldsymbol{x}}_0 = \boldsymbol{x}_t + \bar{\beta}_t^2\boldsymbol{s}</em>$
3. é€Ÿåº¦é¢„æµ‹ï¼š$\hat{\boldsymbol{x}}}<em _boldsymbol_theta="\boldsymbol{\theta">0 = \boldsymbol{x}_t + \bar{\beta}_t\boldsymbol{v}</em>$}</p>
<p><strong>ç›®æ ‡</strong>ï¼šæ‰¾å‡ºMSEæœ€ä¼˜å‚æ•°åŒ–</p>
<p><strong>é—®é¢˜3ï¼šè‡ªé€‚åº”æ­¥é•¿</strong></p>
<p><strong>æ–¹æ¡ˆ</strong>ï¼š
æ ¹æ®è¯¯å·®$e_t = |\hat{\boldsymbol{x}}<em _text_low="\text{low">0^{(t)} - \hat{\boldsymbol{x}}_0^{(t-1)}|$è°ƒæ•´æ­¥é•¿ï¼š
\begin{equation}
\Delta t = \begin{cases}
2 &amp; \text{if } e_t &lt; \tau</em> \
1 &amp; \text{if } \tau_{\text{low}} \leq e_t \leq \tau_{\text{high}} \
0.5 &amp; \text{if } e_t &gt; \tau_{\text{high}}
\end{cases}
\end{equation}}</p>
<p><strong>ç›®æ ‡</strong>ï¼šå¹³å‡èŠ‚çœ50%è®¡ç®—ï¼ˆ1000 â†’ 500æ­¥ï¼‰</p>
<h4 id="_23"><strong>é‡åŒ–ç›®æ ‡</strong></h4>
<ul>
<li>æ”¶æ•›å®šç†ï¼šå»ºç«‹è¯¯å·®ç•Œ$O(1/T)$</li>
<li>æœ€ä¼˜é¢„æµ‹å™¨ï¼šMSEé™ä½20%</li>
<li>è‡ªé€‚åº”æ­¥é•¿ï¼šèŠ‚çœ50%</li>
</ul>
<hr />
<h3 id="53-3">5.3 ç ”ç©¶æ–¹å‘3ï¼šä¸ç¡®å®šæ€§é‡åŒ–ä¸åº”ç”¨</h3>
<h4 id="_24"><strong>ç ”ç©¶ç©ºç™½</strong></h4>
<p>è´å¶æ–¯è§†è§’å¤©ç„¶æä¾›ä¸ç¡®å®šæ€§ä¼°è®¡ï¼Œå¦‚ä½•åº”ç”¨ï¼Ÿ</p>
<h4 id="_25"><strong>å…·ä½“é—®é¢˜</strong></h4>
<p><strong>é—®é¢˜1ï¼šç”Ÿæˆå¯ä¿¡åº¦ä¼°è®¡</strong></p>
<p><strong>æ–¹æ³•</strong>ï¼š
åˆ©ç”¨åéªŒç†µé‡åŒ–ä¸ç¡®å®šæ€§ï¼š
\begin{equation}
U(\boldsymbol{x}_t) = H[p(\boldsymbol{x}_0|\boldsymbol{x}_t)]
\end{equation}</p>
<p><strong>åº”ç”¨</strong>ï¼š
- åŒ»ç–—AIï¼šé«˜ä¸ç¡®å®šæ€§â†’ä¸“å®¶å®¡æŸ¥
- å†…å®¹å®¡æ ¸ï¼šä½ç½®ä¿¡åº¦â†’æ‹’ç»å‘å¸ƒ</p>
<p><strong>ç›®æ ‡</strong>ï¼šä¸ç¡®å®šæ€§ä¸çœŸå®è¯¯å·®ç›¸å…³æ€§ &gt; <strong>0.85</strong></p>
<p><strong>é—®é¢˜2ï¼šä¸»åŠ¨å­¦ä¹ </strong></p>
<p><strong>æ–¹æ³•</strong>ï¼š
é€‰æ‹©åéªŒç†µæœ€é«˜çš„æ ·æœ¬è¿›è¡Œæ ‡æ³¨ï¼š
\begin{equation}
\boldsymbol{x}^* = \arg\max_{\boldsymbol{x}} H[p(\boldsymbol{x}_0|\boldsymbol{x}_t)]
\end{equation}</p>
<p><strong>ç›®æ ‡</strong>ï¼šå‡å°‘æ ‡æ³¨éœ€æ±‚<strong>50%</strong>è¾¾åˆ°ç›¸åŒæ€§èƒ½</p>
<p><strong>é—®é¢˜3ï¼šå¯¹æŠ—é²æ£’æ€§</strong></p>
<p><strong>æ–¹æ³•</strong>ï¼š
å¯¹æŠ—æ ·æœ¬$\boldsymbol{x}<em adv="adv">{adv}$è§†ä¸ºå™ªå£°ï¼ŒåéªŒ$p(\boldsymbol{x}_0|\boldsymbol{x}</em>)$è‡ªåŠ¨è¾¹ç¼˜åŒ–æ‰°åŠ¨ã€‚</p>
<p><strong>é˜²å¾¡ç­–ç•¥</strong>ï¼š
\begin{equation}
\boldsymbol{x}<em q_boldsymbol_x="q(\boldsymbol{x">{\text{robust}} = \mathbb{E}</em>_t)]
\end{equation}}_t|\boldsymbol{x})}[\hat{\boldsymbol{x}}_0(\boldsymbol{x</p>
<p><strong>æ•ˆæœ</strong>ï¼ˆCIFAR-10 + PGDæ”»å‡»ï¼‰ï¼š
| é˜²å¾¡ | å¯¹æŠ—å‡†ç¡®ç‡ â†‘ |
|------|------------|
| æ— é˜²å¾¡ | 12.3% |
| å¯¹æŠ—è®­ç»ƒ | 58.2% |
| <strong>æ‰©æ•£å»å™ª</strong> | <strong>67.8%</strong>ï¼ˆ+55%ï¼‰ |</p>
<h4 id="_26"><strong>é‡åŒ–ç›®æ ‡</strong></h4>
<ul>
<li>å¯ä¿¡åº¦ä¼°è®¡ï¼šç›¸å…³æ€§ &gt; 0.85</li>
<li>ä¸»åŠ¨å­¦ä¹ ï¼šèŠ‚çœ50%æ ‡æ³¨</li>
<li>å¯¹æŠ—é²æ£’æ€§ï¼šå‡†ç¡®ç‡ &gt; 70%</li>
</ul>
<h4 id="_27"><strong>æ½œåœ¨åº”ç”¨</strong></h4>
<ol>
<li><strong>åŒ»ç–—AI</strong>ï¼šåˆæˆç—…ä¾‹+ç½®ä¿¡åº¦+ç–‘éš¾è¯†åˆ«</li>
<li><strong>è‡ªåŠ¨é©¾é©¶</strong>ï¼šæç«¯åœºæ™¯ç”Ÿæˆ+ä¸ç¡®å®šæ€§æ„ŸçŸ¥</li>
<li><strong>ç§‘å­¦å‘ç°</strong>ï¼šåˆ†å­ç”Ÿæˆ+é¢„æµ‹å¯ä¿¡åº¦+å®éªŒè®¾è®¡</li>
</ol>
<hr />
<h2 id="_28">æ€»ç»“ï¼šè´å¶æ–¯æ¨æ–­çš„åŒé¢æ€§</h2>
<p>ä»è´å¶æ–¯è§†è§’ç†è§£DDPMï¼Œæ—¢æ­ç¤ºäº†å…¶ä¼˜é›…çš„æ•°å­¦ç»“æ„ï¼Œä¹Ÿæš´éœ²äº†æ·±å±‚ç†è®ºç¼ºé™·ï¼š</p>
<p><strong>âœ… ä¼˜åŠ¿</strong>ï¼š
- æ¸…æ™°çš„åéªŒæ¨æ–­æ¡†æ¶
- é¢„ä¼°-ä¿®æ­£çš„ç›´è§‚è§£é‡Š
- æ–¹å·®é€‰æ‹©çš„ç†è®ºä¾æ®</p>
<p><strong>âš ï¸ æŒ‘æˆ˜</strong>ï¼š
- æ¡ä»¶è¿‘ä¼¼æœ¬è´¨è¯¯å·®ï¼ˆç‚¹ä¼°è®¡ vs. åˆ†å¸ƒï¼‰
- æ”¶æ•›æ€§æ— ç†è®ºä¿è¯
- é«˜æ–¯å‡è®¾è¿‡äºåˆšæ€§</p>
<p><strong>ğŸ”® æ–¹å‘</strong>ï¼š
1. <strong>ç²¾ç¡®æ¨æ–­</strong>ï¼šæ‹‰æ™®æ‹‰æ–¯ã€Flowã€MCMC
2. <strong>ç†è®ºå®Œå–„</strong>ï¼šæ”¶æ•›å®šç†ã€è¯¯å·®åˆ†æ
3. <strong>åº”ç”¨æ‹“å±•</strong>ï¼šä¸ç¡®å®šæ€§é‡åŒ–ã€ä¸»åŠ¨å­¦ä¹ ã€é²æ£’æ€§</p>
<p>è´å¶æ–¯è§†è§’ä¸ä»…æ˜¯DDPMçš„ä¸€ç§æ¨å¯¼æ–¹å¼ï¼Œæ›´æ˜¯é€šå‘æ›´ç²¾ç¡®ã€æ›´å¯é ã€æ›´å¯è§£é‡Šçš„æ‰©æ•£æ¨¡å‹çš„å¿…ç»ä¹‹è·¯ã€‚</p>
        </div>
    </div>
</body>
</html>