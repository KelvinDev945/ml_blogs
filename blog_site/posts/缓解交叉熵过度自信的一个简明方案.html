<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç¼“è§£äº¤å‰ç†µè¿‡åº¦è‡ªä¿¡çš„ä¸€ä¸ªç®€æ˜æ–¹æ¡ˆ</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç¼“è§£äº¤å‰ç†µè¿‡åº¦è‡ªä¿¡çš„ä¸€ä¸ªç®€æ˜æ–¹æ¡ˆ</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 32.0 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9526">https://spaces.ac.cn/archives/9526</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œåˆ†ç±»é—®é¢˜çš„å¸¸è§„è¯„ä¼°æŒ‡æ ‡æ˜¯æ­£ç¡®ç‡ï¼Œè€Œæ ‡å‡†çš„æŸå¤±å‡½æ•°åˆ™æ˜¯äº¤å‰ç†µï¼Œäº¤å‰ç†µæœ‰ç€æ”¶æ•›å¿«çš„ä¼˜ç‚¹ï¼Œä½†å®ƒå¹¶éæ˜¯æ­£ç¡®ç‡çš„å…‰æ»‘è¿‘ä¼¼ï¼Œè¿™å°±å¸¦æ¥äº†è®­ç»ƒå’Œé¢„æµ‹çš„ä¸ä¸€è‡´æ€§é—®é¢˜ã€‚å¦ä¸€æ–¹é¢ï¼Œå½“è®­ç»ƒæ ·æœ¬çš„é¢„æµ‹æ¦‚ç‡å¾ˆä½æ—¶ï¼Œäº¤å‰ç†µä¼šç»™å‡ºä¸€ä¸ªéå¸¸å·¨å¤§çš„æŸå¤±ï¼ˆè¶‹äº$-\log 0^{+}=\infty$ï¼‰ï¼Œè¿™æ„å‘³ç€äº¤å‰ç†µä¼šç‰¹åˆ«å…³æ³¨é¢„æµ‹æ¦‚ç‡ä½çš„æ ·æœ¬â€”â€”å“ªæ€•è¿™ä¸ªæ ·æœ¬å¯èƒ½æ˜¯â€œè„æ•°æ®â€ã€‚æ‰€ä»¥ï¼Œäº¤å‰ç†µè®­ç»ƒå‡ºæ¥çš„æ¨¡å‹å¾€å¾€æœ‰è¿‡åº¦è‡ªä¿¡ç°è±¡ï¼Œå³æ¯ä¸ªæ ·æœ¬éƒ½ç»™å‡ºè¾ƒé«˜çš„é¢„æµ‹æ¦‚ç‡ï¼Œè¿™ä¼šå¸¦æ¥ä¸¤ä¸ªå‰¯ä½œç”¨ï¼šä¸€æ˜¯å¯¹è„æ•°æ®çš„è¿‡åº¦æ‹Ÿåˆå¸¦æ¥çš„æ•ˆæœä¸‹é™ï¼ŒäºŒæ˜¯é¢„æµ‹çš„æ¦‚ç‡å€¼æ— æ³•ä½œä¸ºä¸ç¡®å®šæ€§çš„è‰¯å¥½æŒ‡æ ‡ã€‚</p>
<p>å›´ç»•äº¤å‰ç†µçš„æ”¹è¿›ï¼Œå­¦æœ¯ç•Œä¸€ç›´éƒ½æœ‰æŒç»­è¾“å‡ºï¼Œç›®å‰è¿™æ–¹é¢çš„ç ”ç©¶ä»å¤„äºâ€œå…«ä»™è¿‡æµ·ï¼Œå„æ˜¾ç¥é€šâ€çš„çŠ¶æ€ï¼Œæ²¡æœ‰æ ‡å‡†ç­”æ¡ˆã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬æ¥å­¦ä¹ ä¸€ä¸‹è®ºæ–‡<a href="https://papers.cool/arxiv/2302.13344">ã€ŠTailoring Language Generation Models under Total Variation Distanceã€‹</a>ç»™å‡ºçš„è¯¥é—®é¢˜çš„åˆä¸€ç§ç®€æ˜çš„å€™é€‰æ–¹æ¡ˆã€‚</p>
<h2 id="_1">ç»“æœç®€ä»‹</h2>
<p>é¡¾åæ€ä¹‰ï¼ŒåŸè®ºæ–‡çš„æ”¹åŠ¨æ˜¯é’ˆå¯¹æ–‡æœ¬ç”Ÿæˆä»»åŠ¡çš„ï¼Œç†è®ºåŸºç¡€æ˜¯Total Variationè·ç¦»ï¼ˆå‚è€ƒ<a href="/archives/7210#Total%20Variation">ã€ŠDesigning GANsï¼šåˆä¸€ä¸ªGANç”Ÿäº§è½¦é—´ã€‹</a>ï¼‰ã€‚ä½†äº‹å®ä¸Šï¼Œç»è¿‡åŸè®ºæ–‡çš„ä¸€ç³»åˆ—æ”¾ç¼©å’Œç®€åŒ–åï¼Œæœ€ç»ˆç»“æœå·²ç»è·ŸTotal Variationè·ç¦»æ²¡æœ‰æ˜æ˜¾è”ç³»ï¼Œå¹¶ä¸”ç†è®ºä¸Šä¹Ÿä¸é™äºæ–‡æœ¬ç”Ÿæˆä»»åŠ¡ã€‚æ‰€ä»¥ï¼Œæœ¬æ–‡å°†å®ƒä½œä¸ºä¸€èˆ¬åˆ†ç±»ä»»åŠ¡çš„æŸå¤±å‡½æ•°æ¥çœ‹å¾…ã€‚</p>
<p>å¯¹äºæ•°æ®å¯¹$(x,y)$ï¼Œäº¤å‰ç†µç»™å‡ºçš„æŸå¤±å‡½æ•°ä¸º<br />
\begin{equation}-\log p_{\theta}(y|x)\end{equation}<br />
åŸè®ºæ–‡çš„æ”¹åŠ¨å¾ˆç®€å•ï¼Œæ”¹ä¸º<br />
\begin{equation}-\frac{\log \big[\gamma + (1 - \gamma)p_{\theta}(y|x)\big]}{1-\gamma}\label{eq:gamma-ce}\end{equation}<br />
å…¶ä¸­$\gamma\in[0,1]$ã€‚å½“$\gamma=0$æ—¶ï¼Œå°±æ˜¯æ™®é€šçš„äº¤å‰ç†µï¼›å½“$\gamma=1$æ—¶ï¼ŒæŒ‰æé™æ¥ç®—ï¼Œç»“æœæ˜¯$-p_{\theta}(y|x)$ã€‚</p>
<p>åœ¨åŸè®ºæ–‡çš„å®éªŒä¸­ï¼Œä¸åŒä»»åŠ¡çš„$\gamma$é€‰å–å·®åˆ«æ¯”è¾ƒå¤§ï¼Œæ¯”å¦‚è¯­è¨€æ¨¡å‹ä»»åŠ¡ä¸­å–åˆ°äº†$\gamma=10^{-7}$ï¼Œæœºå™¨ç¿»è¯‘ä»»åŠ¡ä¸­å–äº†$\gamma=0.1$ï¼Œæ–‡æœ¬æ‘˜è¦ä»»åŠ¡ä¸­å–äº†$\gamma=0.8$ã€‚ä¸€ä¸ªå¯ä»¥å‚è€ƒçš„è§„å¾‹æ˜¯ï¼Œå¦‚æœæ˜¯ä»é›¶è®­ç»ƒï¼Œé‚£ä¹ˆéœ€è¦é€‰æ‹©æ¯”è¾ƒæ¥è¿‘äº0çš„$\gamma$ï¼Œå¦‚æœæ˜¯å¾®è°ƒè®­ç»ƒï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘ç›¸å¯¹å¤§ä¸€ç‚¹çš„$\gamma$ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€ç§æ¯”è¾ƒç›´è§‚çš„æ–¹æ¡ˆï¼Œå°±æ˜¯å°†$\gamma$è§†ä¸ºåŠ¨æ€å‚æ•°ï¼Œä»$\gamma=0$å¼€å§‹ï¼Œéšç€è®­ç»ƒçš„æ¨è¿›æ…¢æ…¢è½¬å‘$\gamma=1$ï¼Œä½†è¿™æ ·å°±å¤šäº†ä¸ªscheduleè¦è°ƒè¯•ã€‚</p>
<p>æ•ˆæœä¸Šï¼Œç”±äºå¤šäº†ä¸ªå¯è°ƒçš„$\gamma$å‚æ•°ï¼Œå¹¶ä¸”åŸæœ¬çš„äº¤å‰ç†µä¹ŸåŒ…å«åœ¨é‡Œè¾¹ï¼Œæ‰€ä»¥åªè¦ç”¨å¿ƒå»è°ƒï¼Œä¸€èˆ¬æ€»æœ‰æœºä¼šè°ƒå‡ºæ¯”äº¤å‰ç†µæ›´å¥½çš„ç»“æœçš„ï¼Œè¿™ä¸ªå€’ä¸ç”¨å¤ªæ‹…å¿ƒã€‚</p>
<h2 id="_2">ä¸ªäººæ¨å¯¼</h2>
<p>æ€ä¹ˆç†è§£å¼$\eqref{eq:gamma-ce}$å‘¢ï¼Ÿåœ¨<a href="/archives/6620#%E6%AD%A3%E7%A1%AE%E7%8E%87">ã€Šå‡½æ•°å…‰æ»‘åŒ–æ‚è°ˆï¼šä¸å¯å¯¼å‡½æ•°çš„å¯å¯¼é€¼è¿‘ã€‹</a>ä¸­çš„â€œæ­£ç¡®ç‡â€ä¸€èŠ‚ï¼Œæˆ‘ä»¬æ¨å¯¼è¿‡æ­£ç¡®ç‡çš„å…‰æ»‘è¿‘ä¼¼æ˜¯<br />
\begin{equation}\mathbb{E}<em _theta="\theta">{(x,y)\sim \mathcal{D}}[p</em>}(y|x)]\end{equation<br />
æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬çš„è¯„ä¼°æŒ‡æ ‡æ˜¯æ­£ç¡®ç‡ï¼Œé‚£ä¹ˆç›´è§‰ä¸Šä»¥$-p_{\theta}(y|x)$ä¸ºæŸå¤±å‡½æ•°æ‰å¯¹ï¼Œå› ä¸ºè¿™æ—¶å€™æŸå¤±å‡½æ•°è·Ÿæ­£ç¡®ç‡çš„å˜åŒ–æ›´åŠ åŒæ­¥ã€‚ç„¶è€Œï¼Œäº‹å®ä¸Šæ˜¯äº¤å‰ç†µçš„è¡¨ç°å¾€å¾€æ›´å¥½ã€‚ä½†äº¤å‰ç†µçš„å‡ºå‘ç‚¹åªæ˜¯â€œæ›´å¥½è®­ç»ƒâ€ï¼Œæ‰€ä»¥æœ‰æ—¶å€™å°±ä¼šâ€œè®­è¿‡å¤´â€äº†ï¼Œå¯¼è‡´è¿‡æ‹Ÿåˆã€‚æ‰€ä»¥ä¸€ä¸ªç›´è§‚çš„æƒ³æ³•å°±æ˜¯èƒ½å¦å°†ä¸¤ä¸ªç»“æœâ€œæ’å€¼â€ä¸€ä¸‹ï¼Œä»¥å…¼é¡¾ä¸¤è€…çš„ä¼˜ç‚¹ã€‚</p>
<p>ä¸ºæ­¤ï¼Œæˆ‘ä»¬è€ƒè™‘ä¸¤è€…çš„æ¢¯åº¦ã€å‡†ç¡®ç‡æŒ‡çš„æ˜¯å®ƒçš„è´Ÿå…‰æ»‘è¿‘ä¼¼$-p_{\theta}(y|x)$ã€‘ï¼š<br />
\begin{equation}\begin{aligned}<br />
\text{å‡†ç¡®ç‡ï¼š}&amp;\,\quad-\nabla_{\theta} p_{\theta}(y|x) \\\<br />
\text{äº¤å‰ç†µï¼š}&amp;\,\quad-\frac{1}{p_{\theta}(y|x)}\nabla_{\theta} p_{\theta}(y|x)<br />
\end{aligned}\end{equation}<br />
ä¸¤è€…å°±å·®ä¸ª$\frac{1}{p_{\theta}(y|x)}$ã€‚æ€ä¹ˆæŠŠ$\frac{1}{p_{\theta}(y|x)}$å˜ä¸º1å‘¢ï¼ŸåŸè®ºæ–‡çš„æ–¹æ¡ˆæ˜¯ï¼š<br />
\begin{equation}\frac{1}{\gamma + (1 - \gamma)p_{\theta}(y|x)}\end{equation}<br />
å½“ç„¶è¿™ä¸ªæ„é€ æ–¹å¼ä¸æ˜¯å”¯ä¸€çš„ï¼ŒåŸè®ºæ–‡é€‰çš„è¿™ä¸ªæ–¹å¼ï¼Œå°½å¯èƒ½åœ°ä¿ç•™äº†äº¤å‰ç†µçš„æ¢¯åº¦ç‰¹æ€§ï¼Œä¹Ÿå°±å°½å¯èƒ½ä¿ç•™äº†äº¤å‰ç†µæ”¶æ•›å¿«çš„ç‰¹ç‚¹ã€‚æ ¹æ®è¿™ä¸ªæ„é€ ï¼Œæˆ‘ä»¬å°±å¸Œæœ›æ–°æŸå¤±å‡½æ•°çš„æ¢¯åº¦ä¸º<br />
\begin{equation}-\frac{\nabla_{\theta}p_{\theta}(y|x)}{\gamma + (1 - \gamma)p_{\theta}(y|x)} = \nabla_{\theta}\left(-\frac{\log \big[\gamma + (1 - \gamma)p_{\theta}(y|x)\big]}{1-\gamma}\right)\label{eq:gamma-ce-g}\end{equation}<br />
è¿™å°±æ‰¾å‡ºäº†æŸå¤±å‡½æ•°$\eqref{eq:gamma-ce}$ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å…ˆè®¾è®¡æ–°çš„æ¢¯åº¦ï¼Œç„¶åé€šè¿‡ç§¯åˆ†æ‰¾åŸå‡½æ•°çš„æ–¹å¼æ‰¾åˆ°äº†å¯¹åº”çš„æŸå¤±å‡½æ•°ã€‚</p>
<h2 id="_3">å¤šæ‰¯å‡ å¥</h2>
<p>ä¸ºä»€ä¹ˆè¦ä»æ¢¯åº¦è§’åº¦å»è®¾è®¡æŸå¤±å‡½æ•°å‘¢ï¼Ÿå¤§æ¦‚æœ‰ä¸¤æ–¹é¢çš„åŸå› ã€‚</p>
<p>ç¬¬ä¸€ï¼Œå¾ˆå¤šæŸå¤±å‡½æ•°æ±‚äº†æ¢¯åº¦åä¼šå¾—åˆ°ç®€åŒ–ï¼Œæ‰€ä»¥åœ¨æ¢¯åº¦ç©ºé—´è®¾è®¡ï¼Œå¾€å¾€æœ‰æ›´å¤šçš„çµæ„Ÿå’Œè‡ªç”±åº¦ï¼Œæ¯”å¦‚æœ¬æ–‡çš„ä¾‹å­ä¸­ï¼Œåœ¨æ¢¯åº¦ç©ºé—´è®¾è®¡$\frac{1}{p_{\theta}(y|x)}$ä¸$1$çš„è¿‡æ¸¡å‡½æ•°$\frac{1}{\gamma + (1 - \gamma)p_{\theta}(y|x)}$ä¸ç®—å¤ªå¤æ‚ï¼Œä½†å¦‚æœç›´æ¥åœ¨æŸå¤±å‡½æ•°ç©ºé—´è®¾è®¡$p_{\theta}(y|x)$å’Œ$\log p_{\theta}(y|x)$çš„è¿‡æ¸¡å‡½æ•°$\frac{\log \big[\gamma + (1 - \gamma)p_{\theta}(y|x)\big]}{1-\gamma}$å°±å¤æ‚å¤šäº†ã€‚</p>
<p>ç¬¬äºŒï¼Œç›®å‰ä½¿ç”¨çš„ä¼˜åŒ–å™¨éƒ½æ˜¯åŸºäºæ¢¯åº¦çš„ï¼Œæ‰€ä»¥å¾ˆå¤šæ—¶å€™æˆ‘ä»¬è®¾è®¡å¥½æ¢¯åº¦å°±è¡Œäº†ï¼Œç”šè‡³éƒ½ä¸å¿…è¦æ‰¾å‡ºåŸå‡½æ•°ã€‚è®ºæ–‡çš„åŸå§‹ç»“æœå®é™…ä¸Šå°±æ˜¯åªç»™å‡ºäº†æ¢¯åº¦ï¼š<br />
\begin{equation}-\max\left(b, \frac{p_{\theta}(y|x)}{\gamma + (1 - \gamma)p_{\theta}(y|x)}\right)\nabla_{\theta}\log p_{\theta}(y|x)\end{equation}<br />
å½“$b=0$æ—¶ï¼Œå®ƒå°±ç­‰ä»·äºå¼$\eqref{eq:gamma-ce}$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŸè®ºæ–‡åœ¨è®¾è®¡æ¢¯åº¦çš„æ—¶å€™è¿˜åŠ äº†ä¸ªé˜ˆå€¼ï¼Œè¿™æ—¶å€™å°±å¾ˆéš¾å†™å‡ºç®€å•çš„åŸå‡½æ•°äº†ã€‚ä½†ä¸Šå¼å®ç°ä¸Šå¹¶ä¸å›°éš¾ï¼Œåªè¦è€ƒè™‘æŸå¤±å‡½æ•°<br />
\begin{equation}-\max\left(b, \frac{p_{\theta}(y|x)}{\gamma + (1 - \gamma)p_{\theta}(y|x)}\right)<em _theta="\theta">{\text{stop_grad}}\log p</em>}(y|x)\end{equation<br />
è¿™é‡Œè¾¹çš„$\text{stop_grad}$å°±æ˜¯ç›´æ¥æ–­æ‰è¿™éƒ¨åˆ†ç»“æœçš„æ¢¯åº¦ï¼Œåœ¨tensorflowä¸­å¯¹åº”ç€<code>tf.stop_gradient</code>ç®—å­ã€‚</p>
<h2 id="_4">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº†ç¼“è§£äº¤å‰ç†µè¿‡åº¦è‡ªä¿¡çš„ä¸€ä¸ªç®€æ˜æ–¹æ¡ˆã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9526">https://spaces.ac.cn/archives/9526</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Mar. 14, 2023). ã€Šç¼“è§£äº¤å‰ç†µè¿‡åº¦è‡ªä¿¡çš„ä¸€ä¸ªç®€æ˜æ–¹æ¡ˆ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9526">https://spaces.ac.cn/archives/9526</a></p>
<p>@online{kexuefm-9526,<br />
title={ç¼“è§£äº¤å‰ç†µè¿‡åº¦è‡ªä¿¡çš„ä¸€ä¸ªç®€æ˜æ–¹æ¡ˆ},<br />
author={è‹å‰‘æ—},<br />
year={2023},<br />
month={Mar},<br />
url={\url{https://spaces.ac.cn/archives/9526}},<br />
} </p>
<hr />
<h2 id="_5">è¯¦ç»†æ•°å­¦æ¨å¯¼ä¸ç†è®ºåˆ†æ</h2>
<h3 id="1">1. äº¤å‰ç†µçš„è¿‡åº¦è‡ªä¿¡é—®é¢˜</h3>
<p><strong>æ ‡å‡†äº¤å‰ç†µæŸå¤±</strong>ï¼š</p>
<p>å¯¹äºåˆ†ç±»é—®é¢˜ï¼Œç»™å®šæ ·æœ¬$(x, y)$ï¼Œæ¨¡å‹é¢„æµ‹æ¦‚ç‡ä¸º$p_\theta(y|x)$ï¼Œäº¤å‰ç†µæŸå¤±ä¸ºï¼š
\begin{equation}
\mathcal{L}<em>{\text{CE}} = -\log p</em>\theta(y|x) \tag{1}
\end{equation}</p>
<p><strong>æ¢¯åº¦åˆ†æ</strong>ï¼š</p>
<p>å¯¹äºæ¨¡å‹å‚æ•°$\theta$ï¼Œæ¢¯åº¦ä¸ºï¼š
\begin{equation}
\nabla_\theta \mathcal{L}<em>{\text{CE}} = -\frac{1}{p</em>\theta(y|x)} \nabla_\theta p_\theta(y|x) \tag{2}
\end{equation}</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šå½“$p_\theta(y|x) \to 0$æ—¶ï¼Œæ¢¯åº¦è¶‹å‘æ— ç©·å¤§ï¼</p>
<p>\begin{equation}
p_\theta(y|x) \to 0^+ \Rightarrow |\nabla_\theta \mathcal{L}_{\text{CE}}| \to \infty \tag{3}
\end{equation}</p>
<p>è¿™å¯¼è‡´æ¨¡å‹å¯¹ä½æ¦‚ç‡æ ·æœ¬ç»™äºˆæå¤§å…³æ³¨ï¼Œå³ä½¿è¿™äº›æ ·æœ¬å¯èƒ½æ˜¯ï¼š
- <strong>å™ªå£°æ ‡ç­¾</strong>ï¼ˆlabel noiseï¼‰
- <strong>å¼‚å¸¸å€¼</strong>ï¼ˆoutliersï¼‰
- <strong>è¾¹ç•Œæ ·æœ¬</strong>ï¼ˆborderline casesï¼‰</p>
<p><strong>è¿‡åº¦è‡ªä¿¡ç°è±¡</strong>ï¼š</p>
<p>ä¼˜åŒ–äº¤å‰ç†µä¼šæ¨åŠ¨æ¨¡å‹ç»™å‡ºæç«¯çš„æ¦‚ç‡é¢„æµ‹ï¼š
\begin{equation}
p_\theta(y|x) \to 1 \quad \text{å¯¹äºè®­ç»ƒæ ·æœ¬} \tag{4}
\end{equation}</p>
<p>è¿™ä¼šå¯¼è‡´ï¼š
1. <strong>æ ¡å‡†æ€§å·®</strong>ï¼šé¢„æµ‹æ¦‚ç‡ä¸èƒ½å¾ˆå¥½åœ°åæ˜ çœŸå®ç½®ä¿¡åº¦
2. <strong>è¿‡æ‹Ÿåˆ</strong>ï¼šå¯¹è„æ•°æ®è¿‡åº¦æ‹Ÿåˆ
3. <strong>æ³›åŒ–æ€§å·®</strong>ï¼šåœ¨æµ‹è¯•é›†ä¸Šè¡¨ç°ä¸‹é™</p>
<h3 id="2-">2. Î³-äº¤å‰ç†µçš„å®šä¹‰ä¸æ¨å¯¼</h3>
<p><strong>åŸè®ºæ–‡çš„Î³-äº¤å‰ç†µ</strong>ï¼š</p>
<p>\begin{equation}
\mathcal{L}<em>{\gamma\text{-CE}} = -\frac{\log[\gamma + (1-\gamma)p</em>\theta(y|x)]}{1-\gamma} \tag{5}
\end{equation}</p>
<p>å…¶ä¸­$\gamma \in [0, 1]$æ˜¯è¶…å‚æ•°ã€‚</p>
<p><strong>ç‰¹æ®Šæƒ…å†µåˆ†æ</strong>ï¼š</p>
<p><strong>æƒ…å†µ1</strong>ï¼š$\gamma = 0$
\begin{equation}
\mathcal{L}<em>{0\text{-CE}} = -\frac{\log p</em>\theta(y|x)}{1} = -\log p_\theta(y|x) = \mathcal{L}_{\text{CE}} \tag{6}
\end{equation}</p>
<p>é€€åŒ–ä¸ºæ ‡å‡†äº¤å‰ç†µã€‚</p>
<p><strong>æƒ…å†µ2</strong>ï¼š$\gamma = 1$ï¼ˆåˆ©ç”¨æ´›å¿…è¾¾æ³•åˆ™ï¼‰
\begin{equation}
\begin{aligned}
\mathcal{L}<em 1="1" _gamma="\gamma" _to="\to">{1\text{-CE}} &amp;= \lim</em> \
&amp;= \lim_{\gamma \to 1} -\frac{\frac{d}{d\gamma}\log[\gamma + (1-\gamma)p_\theta(y|x)]}{\frac{d}{d\gamma}(1-\gamma)} \
&amp;= \lim_{\gamma \to 1} -\frac{\frac{1 - p_\theta(y|x)}{\gamma + (1-\gamma)p_\theta(y|x)}}{-1} \
&amp;= \frac{1 - p_\theta(y|x)}{1} = 1 - p_\theta(y|x)
\end{aligned} \tag{7}
\end{equation}} -\frac{\log[\gamma + (1-\gamma)p_\theta(y|x)]}{1-\gamma</p>
<p>è¿™æ˜¯<strong>è´Ÿçš„å‡†ç¡®ç‡å¹³æ»‘è¿‘ä¼¼</strong>ï¼</p>
<p><strong>ä¸­é—´æƒ…å†µ</strong>ï¼š$\gamma \in (0, 1)$</p>
<p>\begin{equation}
\mathcal{L}<em _text_CE="\text{CE">{\gamma\text{-CE}} \text{ åœ¨ } \mathcal{L}</em>
\end{equation}}} \text{ å’Œ } 1 - p_\theta(y|x) \text{ ä¹‹é—´æ’å€¼} \tag{8</p>
<h3 id="3-">3. ä»æ¢¯åº¦è§†è§’ç†è§£Î³-äº¤å‰ç†µ</h3>
<p><strong>å‡†ç¡®ç‡çš„å¹³æ»‘è¿‘ä¼¼</strong>ï¼š</p>
<p>å¦‚åŸæ–‡æ‰€è¿°ï¼Œåˆ†ç±»å‡†ç¡®ç‡çš„å¹³æ»‘è¿‘ä¼¼ä¸ºï¼š
\begin{equation}
\text{Accuracy} \approx \mathbb{E}<em>{(x,y)\sim\mathcal{D}}[p</em>\theta(y|x)] \tag{9}
\end{equation}</p>
<p>å› æ­¤ï¼Œæœ€å°åŒ–$-p_\theta(y|x)$ç­‰ä»·äºæœ€å¤§åŒ–å‡†ç¡®ç‡ã€‚</p>
<p><strong>ä¸¤ç§æŸå¤±çš„æ¢¯åº¦å¯¹æ¯”</strong>ï¼š</p>
<p>å‡†ç¡®ç‡æŸå¤±çš„æ¢¯åº¦ï¼š
\begin{equation}
\nabla_\theta[-p_\theta(y|x)] = -\nabla_\theta p_\theta(y|x) \tag{10}
\end{equation}</p>
<p>äº¤å‰ç†µæŸå¤±çš„æ¢¯åº¦ï¼š
\begin{equation}
\nabla_\theta[-\log p_\theta(y|x)] = -\frac{1}{p_\theta(y|x)} \nabla_\theta p_\theta(y|x) \tag{11}
\end{equation}</p>
<p><strong>å…³é”®å·®å¼‚</strong>ï¼šæƒé‡å› å­$\frac{1}{p_\theta(y|x)}$</p>
<p><strong>è®¾è®¡ç›®æ ‡</strong>ï¼šæ‰¾åˆ°ä¸€ä¸ªæƒé‡å‡½æ•°$w(p)$ï¼Œä½¿å¾—ï¼š
\begin{equation}
w(p) \text{ åœ¨ } 1 \text{ å’Œ } \frac{1}{p} \text{ ä¹‹é—´æ’å€¼} \tag{12}
\end{equation}</p>
<p><strong>åŸè®ºæ–‡çš„é€‰æ‹©</strong>ï¼š
\begin{equation}
w_\gamma(p) = \frac{1}{\gamma + (1-\gamma)p} \tag{13}
\end{equation}</p>
<p>éªŒè¯ï¼š
- $w_0(p) = \frac{1}{p}$ï¼ˆäº¤å‰ç†µï¼‰
- $w_1(p) = 1$ï¼ˆå‡†ç¡®ç‡ï¼‰</p>
<p><strong>å¯»æ‰¾å¯¹åº”çš„æŸå¤±å‡½æ•°</strong>ï¼š</p>
<p>æˆ‘ä»¬å¸Œæœ›æ‰¾åˆ°$\mathcal{L}$ä½¿å¾—ï¼š
\begin{equation}
\nabla_\theta \mathcal{L} = -\frac{1}{\gamma + (1-\gamma)p_\theta(y|x)} \nabla_\theta p_\theta(y|x) \tag{14}
\end{equation}</p>
<p><strong>ç§¯åˆ†åæ¨</strong>ï¼š</p>
<p>è®°$p = p_\theta(y|x)$ï¼Œæˆ‘ä»¬éœ€è¦ï¼š
\begin{equation}
\frac{d\mathcal{L}}{dp} = -\frac{1}{\gamma + (1-\gamma)p} \tag{15}
\end{equation}</p>
<p>ç§¯åˆ†ï¼š
\begin{equation}
\begin{aligned}
\mathcal{L} &amp;= -\int \frac{1}{\gamma + (1-\gamma)p} dp \
&amp;= -\frac{1}{1-\gamma} \int \frac{1}{\gamma + (1-\gamma)p} d[\gamma + (1-\gamma)p] \
&amp;= -\frac{1}{1-\gamma} \log[\gamma + (1-\gamma)p] + C
\end{aligned} \tag{16}
\end{equation}</p>
<p>é€‰æ‹©å¸¸æ•°$C=0$ï¼Œå¾—åˆ°å¼(5)ï¼</p>
<h3 id="4-">4. Î³-äº¤å‰ç†µçš„æ€§è´¨</h3>
<p><strong>æ€§è´¨1ï¼šå•è°ƒæ€§</strong></p>
<p>å¯¹äºå›ºå®šçš„$p$ï¼Œ$\mathcal{L}<em _gamma_text_-CE="\gamma\text{-CE">{\gamma\text{-CE}}$å…³äº$\gamma$å•è°ƒé€’å¢ï¼š
\begin{equation}
\frac{\partial \mathcal{L}</em>
\end{equation}}}}{\partial \gamma} = \frac{\log[\gamma + (1-\gamma)p]}{(1-\gamma)^2} - \frac{1-p}{(1-\gamma)[\gamma + (1-\gamma)p]} \tag{17</p>
<p>å½“$p &lt; 1$æ—¶ï¼Œå¯ä»¥è¯æ˜ï¼š
\begin{equation}
\frac{\partial \mathcal{L}_{\gamma\text{-CE}}}{\partial \gamma} &gt; 0 \tag{18}
\end{equation}</p>
<p><strong>æ€§è´¨2ï¼šæœ‰ç•Œæ€§</strong></p>
<p>å½“$\gamma &gt; 0$æ—¶ï¼ŒæŸå¤±æœ‰ä¸Šç•Œï¼š
\begin{equation}
\mathcal{L}_{\gamma\text{-CE}} \leq -\frac{\log \gamma}{1-\gamma} \tag{19}
\end{equation}</p>
<p>è¿™é¿å…äº†äº¤å‰ç†µåœ¨$p \to 0$æ—¶è¶‹å‘æ— ç©·çš„é—®é¢˜ï¼</p>
<p><strong>æ€§è´¨3ï¼šæ¢¯åº¦æœ‰ç•Œæ€§</strong></p>
<p>æ¢¯åº¦çš„å¤§å°ä¸ºï¼š
\begin{equation}
|\nabla_\theta \mathcal{L}<em>{\gamma\text{-CE}}| = \frac{1}{\gamma + (1-\gamma)p</em>\theta(y|x)} |\nabla_\theta p_\theta(y|x)| \tag{20}
\end{equation}</p>
<p>æœ‰ä¸Šç•Œï¼š
\begin{equation}
|\nabla_\theta \mathcal{L}<em>{\gamma\text{-CE}}| \leq \frac{1}{\gamma} |\nabla</em>\theta p_\theta(y|x)| \tag{21}
\end{equation}</p>
<p>è€Œäº¤å‰ç†µçš„æ¢¯åº¦å¯ä»¥æ— ç•Œï¼</p>
<h3 id="5-label-smoothing">5. ä¸Label Smoothingçš„è”ç³»</h3>
<p><strong>æ ‡å‡†Label Smoothing</strong>ï¼š</p>
<p>å¯¹äº$K$ç±»åˆ†ç±»é—®é¢˜ï¼Œç¡¬æ ‡ç­¾ä¸ºone-hotå‘é‡$\boldsymbol{y} = [0, \ldots, 1, \ldots, 0]$ã€‚</p>
<p>Label smoothingå®šä¹‰è½¯æ ‡ç­¾ä¸ºï¼š
\begin{equation}
\tilde{y}_i = \begin{cases}
1 - \alpha + \frac{\alpha}{K}, &amp; i = y \
\frac{\alpha}{K}, &amp; i \neq y
\end{cases} \tag{22}
\end{equation}</p>
<p>å…¶ä¸­$\alpha \in [0, 1]$æ˜¯å¹³æ»‘å‚æ•°ã€‚</p>
<p><strong>ç­‰ä»·å†™æ³•</strong>ï¼š
\begin{equation}
\tilde{\boldsymbol{y}} = (1-\alpha)\boldsymbol{y} + \alpha \boldsymbol{u} \tag{23}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{u} = [\frac{1}{K}, \ldots, \frac{1}{K}]$æ˜¯å‡åŒ€åˆ†å¸ƒã€‚</p>
<p><strong>Label Smoothingçš„æŸå¤±</strong>ï¼š
\begin{equation}
\mathcal{L}<em i="1">{\text{LS}} = -\sum</em>}^K \tilde{y<em>i \log p</em>\theta(i|x) \tag{24}
\end{equation}</p>
<p><strong>å±•å¼€</strong>ï¼š
\begin{equation}
\begin{aligned}
\mathcal{L}<em>{\text{LS}} &amp;= -(1-\alpha)\log p</em>\theta(y|x) - \frac{\alpha}{K}\sum_{i=1}^K \log p_\theta(i|x) \
&amp;= (1-\alpha)\mathcal{L}<em _text_unif="\text{unif">{\text{CE}} + \alpha \mathcal{L}</em>
\end{aligned} \tag{25}
\end{equation}}</p>
<p>å…¶ä¸­$\mathcal{L}<em>{\text{unif}} = -\frac{1}{K}\sum_i \log p</em>\theta(i|x)$æ˜¯ä¸å‡åŒ€åˆ†å¸ƒçš„äº¤å‰ç†µã€‚</p>
<p><strong>ä¸Î³-äº¤å‰ç†µçš„å¯¹æ¯”</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>å½¢å¼</th>
<th>æ’å€¼å¯¹è±¡</th>
</tr>
</thead>
<tbody>
<tr>
<td>Label Smoothing</td>
<td>$(1-\alpha)\mathcal{L}<em _text_unif="\text{unif">{\text{CE}} + \alpha \mathcal{L}</em>$}</td>
<td>æŸå¤±å‡½æ•°çš„çº¿æ€§ç»„åˆ</td>
</tr>
<tr>
<td>Î³-äº¤å‰ç†µ</td>
<td>$-\frac{\log[\gamma + (1-\gamma)p]}{1-\gamma}$</td>
<td>æ¢¯åº¦çš„æ’å€¼</td>
</tr>
</tbody>
</table>
<p><strong>åŒºåˆ«</strong>ï¼š
- Label Smoothingåœ¨<strong>æŸå¤±ç©ºé—´</strong>æ’å€¼
- Î³-äº¤å‰ç†µåœ¨<strong>æ¢¯åº¦ç©ºé—´</strong>æ’å€¼</p>
<h3 id="6-calibration">6. æ ¡å‡†ç†è®ºï¼ˆCalibrationï¼‰</h3>
<p><strong>ä»€ä¹ˆæ˜¯æ ¡å‡†ï¼Ÿ</strong></p>
<p>ä¸€ä¸ªæ¨¡å‹æ˜¯<strong>å®Œç¾æ ¡å‡†</strong>çš„ï¼Œå¦‚æœï¼š
\begin{equation}
\mathbb{P}(Y = y | p_\theta(Y|X) = p) = p \quad \forall p \in [0, 1] \tag{26}
\end{equation}</p>
<p>å³ï¼šå¯¹äºæ‰€æœ‰é¢„æµ‹æ¦‚ç‡ä¸º$p$çš„æ ·æœ¬ï¼ŒçœŸå®çš„å‡†ç¡®ç‡ä¹Ÿæ˜¯$p$ã€‚</p>
<p><strong>Expected Calibration Error (ECE)</strong>ï¼š</p>
<p>å°†é¢„æµ‹æ¦‚ç‡åˆ†ä¸º$M$ä¸ªåŒºé—´$B_1, \ldots, B_M$ï¼ŒECEå®šä¹‰ä¸ºï¼š
\begin{equation}
\text{ECE} = \sum_{m=1}^M \frac{|B_m|}{N} |\text{acc}(B_m) - \text{conf}(B_m)| \tag{27}
\end{equation}</p>
<p>å…¶ä¸­ï¼š
- $\text{conf}(B_m) = \frac{1}{|B_m|} \sum_{i \in B_m} \hat{p}<em B_m="B_m" _in="\in" i="i">i$ï¼ˆå¹³å‡ç½®ä¿¡åº¦ï¼‰
- $\text{acc}(B_m) = \frac{1}{|B_m|} \sum</em>_i = y_i]$ï¼ˆå‡†ç¡®ç‡ï¼‰} \mathbb{1}[\hat{y</p>
<p><strong>å¯é æ€§å›¾ï¼ˆReliability Diagramï¼‰</strong>ï¼š</p>
<p>æ¨ªè½´ä¸º$\text{conf}(B_m)$ï¼Œçºµè½´ä¸º$\text{acc}(B_m)$ã€‚å®Œç¾æ ¡å‡†å¯¹åº”äºå¯¹è§’çº¿$y=x$ã€‚</p>
<p><strong>äº¤å‰ç†µçš„æ ¡å‡†é—®é¢˜</strong>ï¼š</p>
<p>äº¤å‰ç†µè®­ç»ƒçš„æ¨¡å‹é€šå¸¸æ˜¯<strong>è¿‡åº¦è‡ªä¿¡</strong>çš„ï¼ˆoverconfidentï¼‰ï¼š
\begin{equation}
\text{conf}(B_m) &gt; \text{acc}(B_m) \tag{28}
\end{equation}</p>
<p>å³ï¼šé¢„æµ‹æ¦‚ç‡é«˜äºçœŸå®å‡†ç¡®ç‡ã€‚</p>
<p><strong>Î³-äº¤å‰ç†µçš„æ ¡å‡†æ•ˆæœ</strong>ï¼š</p>
<p>é€šè¿‡å‡å°æ¢¯åº¦æƒé‡ï¼ŒÎ³-äº¤å‰ç†µç¼“è§£äº†è¿‡åº¦è‡ªä¿¡é—®é¢˜ï¼Œä½¿å¾—ï¼š
\begin{equation}
\text{conf}(B_m) \approx \text{acc}(B_m) \tag{29}
\end{equation}</p>
<h3 id="7">7. æ­£åˆ™åŒ–æ•ˆåº”çš„æ•°å­¦è¯æ˜</h3>
<p><strong>å®šç†</strong>ï¼šÎ³-äº¤å‰ç†µç­‰ä»·äºåœ¨äº¤å‰ç†µä¸Šæ·»åŠ ä¸€ä¸ªéšå¼çš„æ­£åˆ™é¡¹ã€‚</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼š</p>
<p>Taylorå±•å¼€å¼(5)åœ¨$p = p_\theta(y|x)$é™„è¿‘ï¼š
\begin{equation}
\begin{aligned}
\mathcal{L}_{\gamma\text{-CE}} &amp;= -\frac{\log[\gamma + (1-\gamma)p]}{1-\gamma} \
&amp;\approx -\frac{\log[(1-\gamma)p] + \log[1 + \frac{\gamma}{(1-\gamma)p}]}{1-\gamma}
\end{aligned} \tag{30}
\end{equation}</p>
<p>åˆ©ç”¨$\log(1+x) \approx x - \frac{x^2}{2}$ï¼ˆå½“$x$å°æ—¶ï¼‰ï¼š
\begin{equation}
\log\left[1 + \frac{\gamma}{(1-\gamma)p}\right] \approx \frac{\gamma}{(1-\gamma)p} - \frac{1}{2}\left(\frac{\gamma}{(1-\gamma)p}\right)^2 \tag{31}
\end{equation}</p>
<p>ä»£å…¥ï¼š
\begin{equation}
\begin{aligned}
\mathcal{L}_{\gamma\text{-CE}} &amp;\approx -\frac{1}{1-\gamma}\left[\log p + \frac{\gamma}{(1-\gamma)p} - \frac{\gamma^2}{2(1-\gamma)^2 p^2}\right] \
&amp;= -\log p - \frac{\gamma}{(1-\gamma)^2 p} + \frac{\gamma^2}{2(1-\gamma)^3 p^2}
\end{aligned} \tag{32}
\end{equation}</p>
<p>ç¬¬ä¸€é¡¹æ˜¯äº¤å‰ç†µï¼Œåé¢ä¸¤é¡¹æ˜¯<strong>æ­£åˆ™é¡¹</strong>ï¼</p>
<p><strong>ç›´è§‰è§£é‡Š</strong>ï¼š
- $-\frac{\gamma}{(1-\gamma)^2 p}$ï¼šæƒ©ç½šå°æ¦‚ç‡ï¼ˆé˜²æ­¢è¿‡åº¦è‡ªä¿¡ï¼‰
- $+\frac{\gamma^2}{2(1-\gamma)^3 p^2}$ï¼šäºŒé˜¶ä¿®æ­£é¡¹</p>
<h3 id="8">8. ä¸å…¶ä»–é²æ£’æŸå¤±å‡½æ•°çš„å¯¹æ¯”</h3>
<p><strong>Mean Absolute Error (MAE)</strong>ï¼š
\begin{equation}
\mathcal{L}<em i="1">{\text{MAE}} = \sum</em>
\end{equation}}^K |y_i - p_\theta(i|x)| \tag{33</p>
<p><strong>Focal Loss</strong>ï¼š
\begin{equation}
\mathcal{L}<em>{\text{Focal}} = -(1 - p</em>\theta(y|x))^\beta \log p_\theta(y|x) \tag{34}
\end{equation}</p>
<p><strong>Generalized Cross Entropy (GCE)</strong>ï¼š
\begin{equation}
\mathcal{L}<em>{\text{GCE}} = \frac{1 - p</em>\theta(y|x)^q}{q} \tag{35}
\end{equation}</p>
<p><strong>å¯¹æ¯”è¡¨</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æŸå¤±å‡½æ•°</th>
<th>æ¢¯åº¦æƒé‡</th>
<th>é²æ£’æ€§æ¥æº</th>
<th>è¶…å‚æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>CE</td>
<td>$\frac{1}{p}$</td>
<td>æ— </td>
<td>æ— </td>
</tr>
<tr>
<td>Î³-CE</td>
<td>$\frac{1}{\gamma + (1-\gamma)p}$</td>
<td>æ¢¯åº¦è£å‰ª</td>
<td>$\gamma$</td>
</tr>
<tr>
<td>Focal</td>
<td>$\frac{(1-p)^\beta}{p}$</td>
<td>é™ä½æ˜“åˆ†æ ·æœ¬æƒé‡</td>
<td>$\beta$</td>
</tr>
<tr>
<td>GCE</td>
<td>$p^{q-1}$</td>
<td>æœ‰ç•ŒæŸå¤±</td>
<td>$q$</td>
</tr>
</tbody>
</table>
<h3 id="9">9. æ¢¯åº¦è£å‰ªçš„å‡ ä½•è§£é‡Š</h3>
<p><strong>æ¢¯åº¦ç©ºé—´çš„è§†è§’</strong>ï¼š</p>
<p>åœ¨å‚æ•°ç©ºé—´$\Theta$ä¸­ï¼Œæ¢¯åº¦$\nabla_\theta \mathcal{L}$å®šä¹‰äº†ä¸€ä¸ªå‘é‡åœºã€‚</p>
<p>äº¤å‰ç†µçš„æ¢¯åº¦ï¼š
\begin{equation}
\boldsymbol{g}<em>{\text{CE}} = -\frac{1}{p</em>\theta(y|x)} \nabla_\theta p_\theta(y|x) \tag{36}
\end{equation}</p>
<p>Î³-äº¤å‰ç†µçš„æ¢¯åº¦ï¼š
\begin{equation}
\boldsymbol{g}<em>{\gamma\text{-CE}} = -\frac{1}{\gamma + (1-\gamma)p</em>\theta(y|x)} \nabla_\theta p_\theta(y|x) \tag{37}
\end{equation}</p>
<p><strong>æ¯”ä¾‹å…³ç³»</strong>ï¼š
\begin{equation}
\boldsymbol{g}<em>{\gamma\text{-CE}} = \frac{\gamma + (1-\gamma)p</em>\theta(y|x)}{p_\theta(y|x)} \boldsymbol{g}<em>{\text{CE}} = \left[\gamma + (1-\gamma)p</em>\theta(y|x)\right] \frac{\boldsymbol{g}<em>{\text{CE}}}{p</em>\theta(y|x)} \tag{38}
\end{equation}</p>
<p>å®šä¹‰<strong>è£å‰ªå› å­</strong>ï¼š
\begin{equation}
c(\gamma, p) = \gamma + (1-\gamma)p = (1-\gamma)\left(p + \frac{\gamma}{1-\gamma}\right) \tag{39}
\end{equation}</p>
<p><strong>å…³é”®æ€§è´¨</strong>ï¼š
\begin{equation}
c(\gamma, p) \geq \gamma \quad \forall p \in [0, 1] \tag{40}
\end{equation}</p>
<p>å› æ­¤ï¼š
\begin{equation}
|\boldsymbol{g}<em _text_CE="\text{CE">{\gamma\text{-CE}}| \leq \frac{1}{\gamma} |\boldsymbol{g}</em>
\end{equation}}} \cdot p_\theta(y|x)| = \frac{1}{\gamma} |\nabla_\theta p_\theta(y|x)| \tag{41</p>
<p><strong>å‡ ä½•ç›´è§‰</strong>ï¼šÎ³-äº¤å‰ç†µç›¸å½“äºå¯¹äº¤å‰ç†µçš„æ¢¯åº¦è¿›è¡Œäº†<strong>è‡ªé€‚åº”è£å‰ª</strong>ï¼Œè£å‰ªå¼ºåº¦å–å†³äºå½“å‰é¢„æµ‹æ¦‚ç‡$p$ã€‚</p>
<h3 id="10-hessian">10. Hessianåˆ†æä¸æ”¶æ•›æ€§</h3>
<p><strong>äº¤å‰ç†µçš„Hessian</strong>ï¼š</p>
<p>å¯¹äºå•ä¸ªæ ·æœ¬ï¼Œè®°$\boldsymbol{p} = [p_1, \ldots, p_K]$ä¸ºé¢„æµ‹æ¦‚ç‡å‘é‡ï¼ˆ$\sum_i p_i = 1$ï¼‰ã€‚</p>
<p>å¯¹äºå‚æ•°$\theta_i$å’Œ$\theta_j$ï¼š
\begin{equation}
\frac{\partial^2 \mathcal{L}_{\text{CE}}}{\partial \theta_i \partial \theta_j} = -\frac{1}{p_y}\frac{\partial^2 p_y}{\partial \theta_i \partial \theta_j} + \frac{1}{p_y^2}\frac{\partial p_y}{\partial \theta_i}\frac{\partial p_y}{\partial \theta_j} \tag{42}
\end{equation}</p>
<p>å½“$p_y \to 0$æ—¶ï¼ŒHessiançš„ç¬¬äºŒé¡¹è¶‹å‘æ— ç©·ï¼</p>
<p><strong>Î³-äº¤å‰ç†µçš„Hessian</strong>ï¼š</p>
<p>\begin{equation}
\frac{\partial^2 \mathcal{L}_{\gamma\text{-CE}}}{\partial \theta_i \partial \theta_j} = -\frac{1}{\gamma + (1-\gamma)p_y}\frac{\partial^2 p_y}{\partial \theta_i \partial \theta_j} + \frac{1-\gamma}{[\gamma + (1-\gamma)p_y]^2}\frac{\partial p_y}{\partial \theta_i}\frac{\partial p_y}{\partial \theta_j} \tag{43}
\end{equation}</p>
<p><strong>å…³é”®åŒºåˆ«</strong>ï¼šç¬¬äºŒé¡¹è¢«$[\gamma + (1-\gamma)p_y]^2 \geq \gamma^2$ç•Œä½ï¼Œå› æ­¤Hessianæ˜¯<strong>æœ‰ç•Œçš„</strong>ï¼</p>
<p><strong>æ”¶æ•›é€Ÿåº¦</strong>ï¼š</p>
<p>åœ¨å‡¸ä¼˜åŒ–ä¸­ï¼ŒHessiançš„æ¡ä»¶æ•°å†³å®šäº†æ”¶æ•›é€Ÿåº¦ã€‚äº¤å‰ç†µçš„Hessianæ¡ä»¶æ•°å¯èƒ½å¾ˆå¤§ï¼ˆå½“$p_y$å¾ˆå°æ—¶ï¼‰ï¼Œè€ŒÎ³-äº¤å‰ç†µçš„Hessianæ¡ä»¶æ•°æ›´åŠ æ¸©å’Œã€‚</p>
<h3 id="11">11. è´å¶æ–¯è§†è§’</h3>
<p><strong>æœ€å¤§åéªŒä¼°è®¡ï¼ˆMAPï¼‰</strong>ï¼š</p>
<p>å‡è®¾æ¨¡å‹å‚æ•°$\theta$æœ‰å…ˆéªŒåˆ†å¸ƒ$p(\theta)$ï¼ŒMAPä¼°è®¡ä¸ºï¼š
\begin{equation}
\hat{\theta}<em>{\text{MAP}} = \arg\max</em>\theta p(\theta | \mathcal{D}) = \arg\max_\theta p(\mathcal{D} | \theta) p(\theta) \tag{44}
\end{equation}</p>
<p>ç­‰ä»·äºæœ€å°åŒ–ï¼š
\begin{equation}
\mathcal{L}_{\text{MAP}} = -\log p(\mathcal{D} | \theta) - \log p(\theta) \tag{45}
\end{equation}</p>
<p><strong>Î³-äº¤å‰ç†µçš„å…ˆéªŒè§£é‡Š</strong>ï¼š</p>
<p>å¯ä»¥è¯æ˜ï¼ŒÎ³-äº¤å‰ç†µç­‰ä»·äºä½¿ç”¨æŸç§éšå¼å…ˆéªŒçš„MAPä¼°è®¡ã€‚</p>
<p>å…·ä½“åœ°ï¼Œå¦‚æœæˆ‘ä»¬å‡è®¾ï¼š
\begin{equation}
p(\theta) \propto \exp\left(-\lambda \sum_i \frac{1}{p_\theta(y_i | x_i)}\right) \tag{46}
\end{equation}</p>
<p>é‚£ä¹ˆMAPç­‰ä»·äºæœ€å°åŒ–ï¼š
\begin{equation}
-\log p(\mathcal{D} | \theta) + \lambda \sum_i \frac{1}{p_\theta(y_i | x_i)} \tag{47}
\end{equation}</p>
<p>è¿™ä¸Î³-äº¤å‰ç†µçš„å½¢å¼ç±»ä¼¼ï¼ˆè§å¼32ï¼‰ã€‚</p>
<h3 id="12">12. ä¿¡æ¯è®ºè§†è§’</h3>
<p><strong>KLæ•£åº¦åˆ†è§£</strong>ï¼š</p>
<p>äº¤å‰ç†µå¯ä»¥åˆ†è§£ä¸ºï¼š
\begin{equation}
\mathcal{L}<em>{\text{CE}} = H(q, p</em>\theta) = H(q) + D_{\text{KL}}(q | p_\theta) \tag{48}
\end{equation}</p>
<p>å…¶ä¸­$q$æ˜¯çœŸå®åˆ†å¸ƒï¼ˆone-hotï¼‰ï¼Œ$H(q) = 0$ï¼Œæ‰€ä»¥ï¼š
\begin{equation}
\mathcal{L}<em _text_KL="\text{KL">{\text{CE}} = D</em>
\end{equation}}}(q | p_\theta) \tag{49</p>
<p><strong>Î³-äº¤å‰ç†µçš„ä¿¡æ¯è®ºè§£é‡Š</strong>ï¼š</p>
<p>Î³-äº¤å‰ç†µå¯ä»¥ç†è§£ä¸ºæœ€å°åŒ–ä¸€ä¸ª<strong>ä¿®æ­£çš„KLæ•£åº¦</strong>ï¼š
\begin{equation}
D_{\gamma\text{-KL}}(q | p_\theta) = -\frac{1}{1-\gamma}\sum_i q_i \log[\gamma + (1-\gamma)p_{\theta,i}] \tag{50}
\end{equation}</p>
<p>è¿™ä¸æ˜¯æ ‡å‡†çš„Bregmanæ•£åº¦ï¼Œä½†å…·æœ‰ç±»ä¼¼çš„æ€§è´¨ã€‚</p>
<p><strong>äº’ä¿¡æ¯æœ€å¤§åŒ–</strong>ï¼š</p>
<p>ä»ä¿¡æ¯è®ºè§’åº¦ï¼Œå­¦ä¹ ç›®æ ‡æ˜¯æœ€å¤§åŒ–è¾“å…¥$X$å’Œæ ‡ç­¾$Y$ä¹‹é—´çš„äº’ä¿¡æ¯ï¼š
\begin{equation}
I(X; Y) = H(Y) - H(Y|X) \tag{51}
\end{equation}</p>
<p>äº¤å‰ç†µç›´æ¥æœ€å°åŒ–æ¡ä»¶ç†µ$H(Y|X)$ï¼Œè€ŒÎ³-äº¤å‰ç†µé€šè¿‡æ­£åˆ™åŒ–é˜²æ­¢è¿‡åº¦å‡å°$H(Y|X)$ï¼Œä»è€Œä¿æŒä¸€å®šçš„ä¸ç¡®å®šæ€§ã€‚</p>
<h3 id="13-mixupcutout">13. ä¸Mixupå’ŒCutoutçš„å…³ç³»</h3>
<p><strong>Mixup</strong>ï¼š</p>
<p>å¯¹äºä¸¤ä¸ªæ ·æœ¬$(x_1, y_1)$å’Œ$(x_2, y_2)$ï¼Œç”Ÿæˆï¼š
\begin{equation}
\tilde{x} = \lambda x_1 + (1-\lambda)x_2, \quad \tilde{y} = \lambda y_1 + (1-\lambda)y_2 \tag{52}
\end{equation}</p>
<p>å…¶ä¸­$\lambda \sim \text{Beta}(\alpha, \alpha)$ã€‚</p>
<p><strong>Mixupçš„æŸå¤±</strong>ï¼š
\begin{equation}
\mathcal{L}<em>{\text{Mixup}} = -\tilde{y} \log p</em>\theta(\tilde{y} | \tilde{x}) - (1-\tilde{y})\log(1 - p_\theta(\tilde{y} | \tilde{x})) \tag{53}
\end{equation}</p>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>è½¯æ ‡ç­¾</strong>æŸå¤±ï¼</p>
<p><strong>ä¸Î³-äº¤å‰ç†µç»“åˆ</strong>ï¼š</p>
<p>å¯ä»¥å°†ä¸¤è€…ç»“åˆï¼š
\begin{equation}
\mathcal{L}<em>{\gamma\text{-Mixup}} = -\frac{\log[\gamma + (1-\gamma)\tilde{y} p</em>\theta(\tilde{y} | \tilde{x})]}{1-\gamma} \tag{54}
\end{equation}</p>
<p><strong>Cutout</strong>ï¼š</p>
<p>Cutoutéšæœºé®æŒ¡è¾“å…¥å›¾åƒçš„ä¸€éƒ¨åˆ†ã€‚è¿™å¯ä»¥ç†è§£ä¸ºä¸€ç§<strong>æ•°æ®å¢å¼º</strong>ï¼Œå¢åŠ äº†è¾“å…¥çš„ä¸ç¡®å®šæ€§ã€‚</p>
<p>ä¸Î³-äº¤å‰ç†µçš„ååŒæ•ˆåº”ï¼š
- Cutoutå¢åŠ è¾“å…¥ä¸ç¡®å®šæ€§
- Î³-äº¤å‰ç†µä¿æŒè¾“å‡ºä¸ç¡®å®šæ€§</p>
<p>ä¸¤è€…äº’è¡¥ï¼Œè¿›ä¸€æ­¥æé«˜æ³›åŒ–æ€§èƒ½ã€‚</p>
<h3 id="14">14. è¶…å‚æ•°é€‰æ‹©ç­–ç•¥</h3>
<p><strong>Î³çš„é€‰æ‹©ä¾æ®</strong>ï¼š</p>
<ol>
<li><strong>ä»»åŠ¡ç±»å‹</strong>ï¼š</li>
<li>ä»é›¶è®­ç»ƒï¼š$\gamma \in [0, 10^{-4}]$ï¼ˆæ¥è¿‘æ ‡å‡†äº¤å‰ç†µï¼‰</li>
<li>
<p>å¾®è°ƒé¢„è®­ç»ƒæ¨¡å‹ï¼š$\gamma \in [0.1, 0.8]$ï¼ˆæ›´å¤§çš„å¹³æ»‘ï¼‰</p>
</li>
<li>
<p><strong>æ•°æ®è´¨é‡</strong>ï¼š</p>
</li>
<li>å¹²å‡€æ ‡ç­¾ï¼šå°$\gamma$</li>
<li>
<p>å™ªå£°æ ‡ç­¾ï¼šå¤§$\gamma$ï¼ˆå¦‚$\gamma \geq 0.5$ï¼‰</p>
</li>
<li>
<p><strong>æ¨¡å‹å®¹é‡</strong>ï¼š</p>
</li>
<li>å¤§æ¨¡å‹ï¼šå¤§$\gamma$ï¼ˆé˜²æ­¢è¿‡æ‹Ÿåˆï¼‰</li>
<li>å°æ¨¡å‹ï¼šå°$\gamma$ï¼ˆä¿æŒæ‹Ÿåˆèƒ½åŠ›ï¼‰</li>
</ol>
<p><strong>è‡ªé€‚åº”Î³ç­–ç•¥</strong>ï¼š</p>
<p>å®šä¹‰<strong>åŠ¨æ€Î³</strong>ï¼š
\begin{equation}
\gamma(t) = \gamma_{\min} + (\gamma_{\max} - \gamma_{\min}) \cdot \frac{t}{T} \tag{55}
\end{equation}</p>
<p>å…¶ä¸­$t$æ˜¯å½“å‰epochï¼Œ$T$æ˜¯æ€»epochæ•°ã€‚</p>
<p><strong>ç›´è§‰</strong>ï¼šå¼€å§‹æ—¶ç”¨å°$\gamma$å¿«é€Ÿæ”¶æ•›ï¼ŒåæœŸç”¨å¤§$\gamma$æé«˜æ³›åŒ–ã€‚</p>
<p><strong>è‡ªé€‚åº”è°ƒæ•´ï¼ˆåŸºäºéªŒè¯é›†ï¼‰</strong>ï¼š
\begin{equation}
\gamma \leftarrow \gamma + \eta \cdot \text{sign}(\text{ECE}_{\text{val}}) \tag{56}
\end{equation}</p>
<p>å…¶ä¸­ECEæ˜¯éªŒè¯é›†ä¸Šçš„æ ¡å‡†è¯¯å·®ã€‚</p>
<h3 id="15">15. æ¢¯åº¦ç´¯ç§¯ä¸æ‰¹é‡å¤§å°çš„å½±å“</h3>
<p><strong>æ‰¹é‡æ¢¯åº¦</strong>ï¼š</p>
<p>å¯¹äºbatch $\mathcal{B}$ï¼Œæ€»æ¢¯åº¦ä¸ºï¼š
\begin{equation}
\nabla_\theta \mathcal{L}<em _in="\in" _mathcal_B="\mathcal{B" i="i">{\text{batch}} = \frac{1}{|\mathcal{B}|} \sum</em>
\end{equation}}} \nabla_\theta \mathcal{L}_{\gamma\text{-CE}}(x_i, y_i) \tag{57</p>
<p><strong>å¤§batch vs. å°batch</strong>ï¼š</p>
<ul>
<li><strong>å¤§batch</strong>ï¼šæ¢¯åº¦æ›´ç¨³å®šï¼Œä½†å¯èƒ½é™·å…¥å°–é”çš„æå°å€¼ï¼ˆæ³›åŒ–å·®ï¼‰</li>
<li><strong>å°batch</strong>ï¼šæ¢¯åº¦æœ‰å™ªå£°ï¼Œå€¾å‘äºå¹³å¦çš„æå°å€¼ï¼ˆæ³›åŒ–å¥½ï¼‰</li>
</ul>
<p><strong>Î³-äº¤å‰ç†µçš„å½±å“</strong>ï¼š</p>
<p>Î³-äº¤å‰ç†µé€šè¿‡å‡å°æ¢¯åº¦å¹…åº¦ï¼Œèµ·åˆ°äº†ç±»ä¼¼<strong>å°batch</strong>çš„æ­£åˆ™åŒ–æ•ˆæœï¼Œå³ä½¿åœ¨å¤§batchä¸‹ä¹Ÿèƒ½æ‰¾åˆ°å¹³å¦çš„æå°å€¼ã€‚</p>
<h3 id="16">16. æ¸©åº¦ç¼©æ”¾ä¸åå¤„ç†æ ¡å‡†</h3>
<p><strong>Temperature Scaling</strong>ï¼š</p>
<p>å¯¹äºå·²è®­ç»ƒçš„æ¨¡å‹ï¼Œå¯ä»¥é€šè¿‡æ¸©åº¦å‚æ•°$T$æ ¡å‡†è¾“å‡ºï¼š
\begin{equation}
p_T(y|x) = \frac{e^{z_y / T}}{\sum_i e^{z_i / T}} \tag{58}
\end{equation}</p>
<p>å…¶ä¸­$z_i$æ˜¯logitsã€‚é€šè¿‡æœ€å°åŒ–éªŒè¯é›†ä¸Šçš„è´Ÿå¯¹æ•°ä¼¼ç„¶æ¥ä¼˜åŒ–$T$ã€‚</p>
<p><strong>ä¸Î³-äº¤å‰ç†µçš„æ¯”è¾ƒ</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æ—¶æœº</th>
<th>é¢å¤–å‚æ•°</th>
<th>æ•ˆæœ</th>
</tr>
</thead>
<tbody>
<tr>
<td>Î³-äº¤å‰ç†µ</td>
<td>è®­ç»ƒæ—¶</td>
<td>$\gamma$ï¼ˆæ¯ä¸ªä»»åŠ¡ï¼‰</td>
<td>åŒæ—¶æé«˜å‡†ç¡®ç‡å’Œæ ¡å‡†</td>
</tr>
<tr>
<td>Temperature Scaling</td>
<td>åå¤„ç†</td>
<td>$T$ï¼ˆå•ä¸ªæ ‡é‡ï¼‰</td>
<td>åªæ”¹å–„æ ¡å‡†ï¼Œä¸æ”¹å˜å‡†ç¡®ç‡</td>
</tr>
</tbody>
</table>
<p><strong>ç»“åˆä½¿ç”¨</strong>ï¼š</p>
<p>å¯ä»¥å…ˆç”¨Î³-äº¤å‰ç†µè®­ç»ƒï¼Œå†ç”¨Temperature Scalingå¾®è°ƒï¼Œè¿›ä¸€æ­¥æé«˜æ ¡å‡†æ€§èƒ½ã€‚</p>
<h3 id="17">17. ç†è®ºæ”¶æ•›æ€§åˆ†æ</h3>
<p><strong>å‡è®¾</strong>ï¼šæŸå¤±å‡½æ•°$\mathcal{L}$æ˜¯$L$-smoothçš„ï¼Œå³ï¼š
\begin{equation}
|\nabla \mathcal{L}(\theta_1) - \nabla \mathcal{L}(\theta_2)| \leq L |\theta_1 - \theta_2| \tag{59}
\end{equation}</p>
<p><strong>å®šç†</strong>ï¼ˆSGDçš„æ”¶æ•›ï¼‰ï¼š</p>
<p>å¯¹äº$L$-smoothä¸”å‡¸çš„æŸå¤±å‡½æ•°ï¼Œä½¿ç”¨å­¦ä¹ ç‡$\eta &lt; \frac{1}{L}$çš„SGDï¼Œç»è¿‡$T$æ­¥åï¼š
\begin{equation}
\mathbb{E}[\mathcal{L}(\bar{\theta}_T)] - \mathcal{L}(\theta^<em>) \leq \frac{L |\theta_0 - \theta^</em>|^2}{2T} + \frac{\eta \sigma^2}{2} \tag{60}
\end{equation}</p>
<p>å…¶ä¸­$\bar{\theta}<em t="1">T = \frac{1}{T}\sum</em>^T \theta_t$ï¼Œ$\sigma^2$æ˜¯æ¢¯åº¦æ–¹å·®ã€‚</p>
<p><strong>Î³-äº¤å‰ç†µçš„ä¼˜åŠ¿</strong>ï¼š</p>
<p>ç”±äºæ¢¯åº¦æœ‰ç•Œï¼ˆå¼21ï¼‰ï¼Œ$\sigma^2$æ›´å°ï¼Œå› æ­¤æ”¶æ•›è¯¯å·®æ›´å°ï¼</p>
<h3 id="18">18. æ•°å€¼ç¨³å®šæ€§å®ç°</h3>
<p><strong>LogSumExpæŠ€å·§</strong>ï¼š</p>
<p>å¯¹äºsoftmaxï¼Œæ ‡å‡†å®ç°ï¼š
\begin{equation}
p_i = \frac{e^{z_i}}{\sum_j e^{z_j}} \tag{61}
\end{equation}</p>
<p>æ•°å€¼ç¨³å®šç‰ˆæœ¬ï¼š
\begin{equation}
p_i = \frac{e^{z_i - z_{\max}}}{\sum_j e^{z_j - z_{\max}}} \tag{62}
\end{equation}</p>
<p><strong>Î³-äº¤å‰ç†µçš„å®ç°</strong>ï¼š</p>
<p>\begin{equation}
\mathcal{L}_{\gamma\text{-CE}} = -\frac{\log[\gamma + (1-\gamma)p_y]}{1-\gamma} \tag{63}
\end{equation}</p>
<p>å½“$\gamma \to 0$æ—¶ï¼Œåˆ†å­åˆ†æ¯éƒ½è¶‹å‘0ï¼Œéœ€è¦ç‰¹æ®Šå¤„ç†ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gamma_cross_entropy</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">epsilon</span><span class="o">=</span><span class="mf">1e-10</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    y_true: çœŸå®æ ‡ç­¾ (batch_size,)</span>
<span class="sd">    y_pred: é¢„æµ‹logits (batch_size, num_classes)</span>
<span class="sd">    gamma: å¹³æ»‘å‚æ•°</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># è®¡ç®—softmaxæ¦‚ç‡</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">softmax</span><span class="p">(</span><span class="n">y_pred</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># è·å–çœŸå®ç±»åˆ«çš„æ¦‚ç‡</span>
    <span class="n">p_y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">gather_nd</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">y_true</span><span class="p">)[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">y_true</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

    <span class="c1"># é¿å…æ•°å€¼é—®é¢˜</span>
    <span class="n">p_y</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">clip_by_value</span><span class="p">(</span><span class="n">p_y</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">gamma</span> <span class="o">&lt;</span> <span class="n">epsilon</span><span class="p">:</span>
        <span class="c1"># å½“gammaæ¥è¿‘0æ—¶ï¼Œä½¿ç”¨æ ‡å‡†äº¤å‰ç†µ</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="o">-</span><span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">p_y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Î³-äº¤å‰ç†µ</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="o">-</span><span class="n">tf</span><span class="o">.</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">gamma</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="p">)</span> <span class="o">*</span> <span class="n">p_y</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">gamma</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">tf</span><span class="o">.</span><span class="n">reduce_mean</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
</code></pre></div>

<h3 id="19">19. å®éªŒè®¾è®¡ä¸æ¶ˆèç ”ç©¶</h3>
<p><strong>æ¶ˆèå®éªŒè®¾ç½®</strong>ï¼š</p>
<ol>
<li><strong>Baseline</strong>: æ ‡å‡†äº¤å‰ç†µï¼ˆ$\gamma = 0$ï¼‰</li>
<li><strong>å˜ä½“1</strong>: å°Î³ï¼ˆ$\gamma = 0.01$ï¼‰</li>
<li><strong>å˜ä½“2</strong>: ä¸­Î³ï¼ˆ$\gamma = 0.1$ï¼‰</li>
<li><strong>å˜ä½“3</strong>: å¤§Î³ï¼ˆ$\gamma = 0.5$ï¼‰</li>
<li><strong>å˜ä½“4</strong>: åŠ¨æ€Î³ï¼ˆä»0åˆ°0.5ï¼‰</li>
</ol>
<p><strong>è¯„ä¼°æŒ‡æ ‡</strong>ï¼š</p>
<ol>
<li><strong>å‡†ç¡®ç‡</strong>ï¼š$\text{Acc} = \frac{1}{N}\sum_i \mathbb{1}[y_i = \hat{y}_i]$</li>
<li><strong>ECE</strong>ï¼šé¢„æœŸæ ¡å‡†è¯¯å·®ï¼ˆå¼27ï¼‰</li>
<li><strong>è´Ÿå¯¹æ•°ä¼¼ç„¶</strong>ï¼š$\text{NLL} = -\frac{1}{N}\sum_i \log p_\theta(y_i | x_i)$</li>
<li><strong>Brieråˆ†æ•°</strong>ï¼š$\text{BS} = \frac{1}{N}\sum_i |\boldsymbol{y}_i - \boldsymbol{p}_i|^2$</li>
</ol>
<p><strong>å¯è§†åŒ–</strong>ï¼š</p>
<ol>
<li><strong>å¯é æ€§å›¾</strong>ï¼šç½®ä¿¡åº¦vs.å‡†ç¡®ç‡</li>
<li><strong>æŸå¤±æ›²çº¿</strong>ï¼šè®­ç»ƒ/éªŒè¯æŸå¤±éšepochå˜åŒ–</li>
<li><strong>æ¢¯åº¦èŒƒæ•°</strong>ï¼š$|\nabla_\theta \mathcal{L}|$éšè®­ç»ƒå˜åŒ–</li>
</ol>
<h3 id="20">20. ç†è®ºå¼€æ”¾é—®é¢˜</h3>
<p><strong>é—®é¢˜1</strong>ï¼šÎ³-äº¤å‰ç†µçš„æœ€ä¼˜$\gamma$é€‰æ‹©</p>
<p>æ˜¯å¦å­˜åœ¨ç†è®ºæœ€ä¼˜çš„$\gamma^*$ä½œä¸ºæ•°æ®åˆ†å¸ƒå’Œæ¨¡å‹æ¶æ„çš„å‡½æ•°ï¼Ÿ</p>
<p><strong>é—®é¢˜2</strong>ï¼šä¸å…¶ä»–æ•£åº¦çš„å…³ç³»</p>
<p>Î³-äº¤å‰ç†µæ˜¯å¦å¯ä»¥ç†è§£ä¸ºæŸç§f-æ•£åº¦æˆ–Bregmanæ•£åº¦çš„ç‰¹ä¾‹ï¼Ÿ</p>
<p><strong>é—®é¢˜3</strong>ï¼šæ³›åŒ–ç•Œ</p>
<p>èƒ½å¦ä¸ºÎ³-äº¤å‰ç†µæ¨å¯¼æ›´ç´§çš„æ³›åŒ–ç•Œï¼ˆgeneralization boundï¼‰ï¼Ÿ</p>
<p><strong>é—®é¢˜4</strong>ï¼šå¤šä»»åŠ¡å­¦ä¹ </p>
<p>åœ¨å¤šä»»åŠ¡å­¦ä¹ ä¸­ï¼Œä¸åŒä»»åŠ¡æ˜¯å¦åº”è¯¥ä½¿ç”¨ä¸åŒçš„$\gamma$ï¼Ÿå¦‚ä½•è‡ªåŠ¨ç¡®å®šï¼Ÿ</p>
<h3 id="21">21. æ‰©å±•ï¼šå¤šåˆ†ç±»åˆ°å¤šæ ‡ç­¾</h3>
<p><strong>å¤šæ ‡ç­¾Î³-äº¤å‰ç†µ</strong>ï¼š</p>
<p>å¯¹äºå¤šæ ‡ç­¾åˆ†ç±»ï¼Œæ¯ä¸ªç±»åˆ«ç‹¬ç«‹ï¼Œå¯ä»¥å®šä¹‰ï¼š
\begin{equation}
\mathcal{L}<em i="1">{\gamma\text{-BCE}} = -\sum</em>
\end{equation}}^K \frac{\log[\gamma + (1-\gamma)\sigma(z_i)^{y_i}(1-\sigma(z_i))^{1-y_i}]}{1-\gamma} \tag{64</p>
<p>å…¶ä¸­$\sigma(z_i)$æ˜¯ç¬¬$i$ä¸ªç±»åˆ«çš„sigmoidè¾“å‡ºã€‚</p>
<p><strong>ç®€åŒ–å½¢å¼</strong>ï¼š</p>
<p>å¯¹äºæ¯ä¸ªç±»åˆ«$i$ï¼š
\begin{equation}
\mathcal{L}_{\gamma\text{-BCE},i} = \begin{cases}
-\frac{\log[\gamma + (1-\gamma)\sigma(z_i)]}{1-\gamma}, &amp; y_i = 1 \
-\frac{\log[\gamma + (1-\gamma)(1-\sigma(z_i))]}{1-\gamma}, &amp; y_i = 0
\end{cases} \tag{65}
\end{equation}</p>
<h3 id="22-stop_gradient-">22. è¿æ¥ï¼šä»stop_gradientåˆ°Î³-äº¤å‰ç†µ</h3>
<p><strong>åŸè®ºæ–‡çš„stop_gradientç‰ˆæœ¬</strong>ï¼š</p>
<p>\begin{equation}
\mathcal{L}<em>{\text{sg}} = -\underbrace{\frac{p</em>\theta(y|x)}{\gamma + (1-\gamma)p_\theta(y|x)}}<em>{\text{stop_grad}} \log p</em>\theta(y|x) \tag{66}
\end{equation}</p>
<p><strong>æ¢¯åº¦</strong>ï¼š
\begin{equation}
\nabla_\theta \mathcal{L}<em>{\text{sg}} = -\frac{p</em>\theta(y|x)}{\gamma + (1-\gamma)p_\theta(y|x)} \cdot \frac{1}{p_\theta(y|x)} \nabla_\theta p_\theta(y|x) = -\frac{\nabla_\theta p_\theta(y|x)}{\gamma + (1-\gamma)p_\theta(y|x)} \tag{67}
\end{equation}</p>
<p>è¿™æ­£æ˜¯å¼(14)ï¼</p>
<p><strong>ä¸Î³-äº¤å‰ç†µçš„åŒºåˆ«</strong>ï¼š
- stop_gradientç‰ˆæœ¬ï¼šç›´æ¥å®šä¹‰æ¢¯åº¦ï¼ŒæŸå¤±å‡½æ•°æœ¬èº«æ²¡æœ‰æ„ä¹‰
- Î³-äº¤å‰ç†µï¼šæŸå¤±å‡½æ•°æœ‰æ˜ç¡®æ„ä¹‰ï¼Œæ¢¯åº¦æ˜¯è‡ªç„¶å¯¼å‡ºçš„</p>
<h3 id="23">23. å®è·µå»ºè®®æ€»ç»“</h3>
<p><strong>æ¨èé…ç½®</strong>ï¼š</p>
<ol>
<li><strong>å›¾åƒåˆ†ç±»ï¼ˆä»é›¶è®­ç»ƒï¼‰</strong>ï¼š</li>
<li>$\gamma \in [0, 0.01]$</li>
<li>
<p>ç»“åˆLabel Smoothing ($\alpha = 0.1$)</p>
</li>
<li>
<p><strong>å›¾åƒåˆ†ç±»ï¼ˆå¾®è°ƒï¼‰</strong>ï¼š</p>
</li>
<li>$\gamma \in [0.1, 0.3]$</li>
<li>
<p>å¯é€‰ï¼šåŠ¨æ€Î³ schedule</p>
</li>
<li>
<p><strong>NLPä»»åŠ¡</strong>ï¼š</p>
</li>
<li>è¯­è¨€æ¨¡å‹ï¼š$\gamma \approx 10^{-7}$ï¼ˆæ¥è¿‘æ ‡å‡†CEï¼‰</li>
<li>æœºå™¨ç¿»è¯‘ï¼š$\gamma \approx 0.1$</li>
<li>
<p>æ–‡æœ¬æ‘˜è¦ï¼š$\gamma \approx 0.8$</p>
</li>
<li>
<p><strong>å™ªå£°æ ‡ç­¾åœºæ™¯</strong>ï¼š</p>
</li>
<li>è½»åº¦å™ªå£°ï¼ˆ&lt;10%ï¼‰ï¼š$\gamma \approx 0.2$</li>
<li>ä¸­åº¦å™ªå£°ï¼ˆ10-30%ï¼‰ï¼š$\gamma \approx 0.5$</li>
<li>é‡åº¦å™ªå£°ï¼ˆ&gt;30%ï¼‰ï¼š$\gamma \approx 0.7$</li>
</ol>
<p><strong>è°ƒè¯•checklist</strong>ï¼š
- [ ] éªŒè¯æŸå¤±å•è°ƒä¸‹é™
- [ ] æ£€æŸ¥æ¢¯åº¦èŒƒæ•°æ˜¯å¦æœ‰ç•Œ
- [ ] åœ¨éªŒè¯é›†ä¸Šè¯„ä¼°ECE
- [ ] ç»˜åˆ¶å¯é æ€§å›¾
- [ ] ä¸baselineï¼ˆ$\gamma=0$ï¼‰å¯¹æ¯”</p>
<hr />
<h2 id="_6">å‚è€ƒæ–‡çŒ®</h2>
<ol>
<li>MÃ¼ller et al., "When Does Label Smoothing Help?", NeurIPS 2019</li>
<li>Guo et al., "On Calibration of Modern Neural Networks", ICML 2017</li>
<li>Zhang &amp; Sabuncu, "Generalized Cross Entropy Loss for Training Deep Neural Networks with Noisy Labels", NeurIPS 2018</li>
<li>Pereyra et al., "Regularizing Neural Networks by Penalizing Confident Output Distributions", ICLR 2017</li>
<li>Szegedy et al., "Rethinking the Inception Architecture for Computer Vision", CVPR 2016</li>
</ol>
<h2 id="_7">æ€»ç»“</h2>
<p>æœ¬æ–‡æ·±å…¥åˆ†æäº†Î³-äº¤å‰ç†µæŸå¤±å‡½æ•°ï¼Œå…³é”®æ´å¯ŸåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æ¢¯åº¦è§†è§’</strong>ï¼šÎ³-CEåœ¨äº¤å‰ç†µå’Œå‡†ç¡®ç‡çš„æ¢¯åº¦ä¹‹é—´æ’å€¼</li>
<li><strong>æ­£åˆ™åŒ–</strong>ï¼šç­‰ä»·äºæ·»åŠ éšå¼æ­£åˆ™é¡¹ï¼Œé˜²æ­¢è¿‡åº¦è‡ªä¿¡</li>
<li><strong>æ ¡å‡†æ€§</strong>ï¼šæ”¹å–„æ¨¡å‹çš„æ¦‚ç‡æ ¡å‡†ï¼Œé™ä½ECE</li>
<li><strong>é²æ£’æ€§</strong>ï¼šæ¢¯åº¦å’ŒHessianæœ‰ç•Œï¼Œå¯¹å™ªå£°æ ‡ç­¾æ›´é²æ£’</li>
<li><strong>çµæ´»æ€§</strong>ï¼šè¶…å‚æ•°$\gamma$å¯æ ¹æ®ä»»åŠ¡å’Œæ•°æ®è´¨é‡è°ƒæ•´</li>
</ol>
<p>Î³-äº¤å‰ç†µæ˜¯ä¸€ä¸ªç®€æ´è€Œå¼ºå¤§çš„å·¥å…·ï¼Œåœ¨å®è·µä¸­å€¼å¾—å°è¯•ï¼</p>
        </div>
    </div>
</body>
</html>