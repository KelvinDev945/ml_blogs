<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ³¨æ„åŠ›å’ŒSoftmaxçš„ä¸¤ç‚¹æœ‰è¶£å‘ç°ï¼šé²æ£’æ€§å’Œä¿¡æ¯é‡</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>æ³¨æ„åŠ›å’ŒSoftmaxçš„ä¸¤ç‚¹æœ‰è¶£å‘ç°ï¼šé²æ£’æ€§å’Œä¿¡æ¯é‡</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 31.1 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9593">https://spaces.ac.cn/archives/9593</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>æœ€è¿‘å‡ å‘¨ç¬”è€…ä¸€ç›´éƒ½åœ¨æ€è€ƒæ³¨æ„åŠ›æœºåˆ¶çš„ç›¸å…³æ€§è´¨ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­å¯¹æ³¨æ„åŠ›åŠSoftmaxæœ‰äº†æ›´æ·±åˆ»çš„ç†è§£ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œç¬”è€…ç®€å•åˆ†äº«å…¶ä¸­çš„ä¸¤ç‚¹ï¼š</p>
<blockquote>
<p>1ã€Softmaxæ³¨æ„åŠ›å¤©ç„¶èƒ½å¤ŸæŠµå¾¡ä¸€å®šçš„å™ªå£°æ‰°åŠ¨ï¼›</p>
<p>2ã€ä»ä¿¡æ¯ç†µè§’åº¦ä¹Ÿå¯ä»¥å¯¹åˆå§‹åŒ–é—®é¢˜å½¢æˆç›´è§‚ç†è§£ã€‚</p>
</blockquote>
<h2 id="_1">é²æ£’æ€§</h2>
<p>åŸºäºSoftmaxå½’ä¸€åŒ–çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Œå¯ä»¥å†™ä¸º<br />
\begin{equation}o = \frac{\sum\limits_{i=1}^n e^{s_i} v_i}{\sum\limits_{i=1}^n e^{s_i}}\end{equation}<br />
æœ‰ä¸€å¤©ç¬”è€…çªç„¶æƒ³åˆ°ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœå¾€$s_i$ä¸­åŠ å…¥ç‹¬ç«‹åŒåˆ†å¸ƒçš„å™ªå£°ä¼šæ€æ ·ï¼Ÿä¸ºæ­¤ï¼Œæˆ‘ä»¬è€ƒè™‘<br />
\begin{equation}\tilde{o} = \frac{\sum\limits_{i=1}^n e^{s_i+\varepsilon_i} v_i}{\sum\limits_{i=1}^n e^{s_i+\varepsilon_i}}\end{equation}<br />
å…¶ä¸­$\varepsilon_i$æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„å™ªå£°ã€‚ç„¶è€Œï¼Œç®€å•åˆ†æåç¬”è€…å‘ç°ç»“è®ºæ˜¯â€œä¸æ€ä¹ˆæ ·â€ï¼Œæ³¨æ„åŠ›æœºåˆ¶å¤©ç„¶èƒ½æŠµå¾¡è¿™ç±»å™ªå£°ï¼Œå³$\tilde{o}\approx o$ã€‚</p>
<p>ä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œåªéœ€è¦æ„è¯†åˆ°ï¼š<br />
\begin{equation}\tilde{o} = \frac{\frac{1}{n}\sum\limits_{i=1}^n e^{s_i+\varepsilon_i} v_i}{\frac{1}{n}\sum\limits_{i=1}^n e^{s_i+\varepsilon_i}}=\frac{\mathbb{E}_i[e^{s_i+\varepsilon_i} v_i]}{\mathbb{E}_i[e^{s_i+\varepsilon_i}]}\approx \frac{\mathbb{E}_i[e^{s_i}v_i]\mathbb{E}[e^{\varepsilon}]}{\mathbb{E}_i[e^{s_i}]\mathbb{E}[e^{\varepsilon}]}=\frac{\mathbb{E}_i[e^{s_i}v_i]}{\mathbb{E}_i[e^{s_i}]}=o\end{equation}<br />
çº¦ç­‰å·æ˜¯åˆ©ç”¨äº†$\varepsilon_i$è·Ÿ$s_i,v_i$ç›¸äº’ç‹¬ç«‹ï¼Œæ‰€ä»¥ç§¯çš„æœŸæœ›ç­‰äºæœŸæœ›çš„ç§¯ã€‚</p>
<h2 id="_2">ä¿¡æ¯é‡</h2>
<p>å¦‚æœæˆ‘ä»¬è®°$p_i = e^{s_i}\left/\sum\limits_{i=1}^n e^{s_i}\right.$ï¼Œé‚£ä¹ˆ$p_i$æè¿°äº†ä¸€ä¸ªç¦»æ•£å‹æ¦‚ç‡åˆ†å¸ƒï¼Œæˆ‘ä»¬å¯ä»¥ç®—ä¿¡æ¯ç†µ<br />
\begin{equation}H = -\sum_{i=1}^n p_i\log p_i\quad\in[0,\log n]\end{equation}<br />
åœ¨<a href="/archives/3534">ã€Šâ€œç†µâ€ä¸èµ·ï¼šä»ç†µã€æœ€å¤§ç†µåŸç†åˆ°æœ€å¤§ç†µæ¨¡å‹ï¼ˆä¸€ï¼‰ã€‹</a>ä¸­æˆ‘ä»¬è®¨è®ºè¿‡ï¼Œç†µæ˜¯ä¸ç¡®å®šæ€§çš„åº¦é‡ï¼Œä¹Ÿæ˜¯ä¿¡æ¯é‡çš„åº¦é‡ã€‚æ€ä¹ˆç†è§£ä¸¤è€…çš„è”ç³»å‘¢ï¼Ÿç†µæœ¬è´¨ä¸Šæ˜¯å‡åŒ€åº¦çš„åº¦é‡ï¼Œè¶Šå‡åŒ€è¶Šä¸ç¡®å®šï¼Œæ‰€ä»¥ç†µæ˜¯ä¸ç¡®å®šæ€§çš„åº¦é‡ï¼Œç†µçš„ä¸‹ç•Œæ˜¯0ï¼Œæ‰€ä»¥ä¸ç¡®å®šæ€§ä¹Ÿæ„å‘³ç€å®ƒæ˜¯æˆ‘ä»¬ä»â€œä¸ç¡®å®šâ€åˆ°â€œå®Œå…¨ç¡®å®šâ€æ‰€èƒ½è·å¾—çš„æœ€å¤§ä¿¡æ¯é‡ã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œå¦‚æœå°†$s_i$åˆå§‹åŒ–å¾—éå¸¸å¤§ï¼Œé‚£ä¹ˆ$p_i$å°±ä¼šæ¥è¿‘ä¸€ä¸ªone hotåˆ†å¸ƒï¼Œæ­¤æ—¶å°±ä¼šç”±äºæ¢¯åº¦æ¶ˆå¤±è€Œæ— æ³•è®­ç»ƒï¼ˆå‚è€ƒ<a href="/archives/8620">ã€Šæµ…è°ˆTransformerçš„åˆå§‹åŒ–ã€å‚æ•°åŒ–ä¸æ ‡å‡†åŒ–ã€‹ï¼‰</a>ã€‚ç¬”è€…å‘ç°ä»ä¿¡æ¯é‡çš„è§’åº¦ä¹Ÿå¯ä»¥å¾ˆç›´è§‚ç†è§£è¿™ä¸€ç‚¹ï¼šæ¨¡å‹è®­ç»ƒæœ¬èº«å°±æ˜¯ä»ä¸ç¡®å®šï¼ˆéšæœºæ¨¡å‹ï¼‰åˆ°ç¡®å®šï¼ˆè®­ç»ƒæ¨¡å‹ï¼‰çš„è¿‡ç¨‹ï¼Œä¼˜åŒ–å™¨è´Ÿè´£ä»éšæœºæ¨¡å‹ä¸­â€œæ¦¨å–â€ä¿¡æ¯ï¼Œè€Œone hotåˆ†å¸ƒçš„ä¿¡æ¯é‡ä¸º0ï¼Œä¼˜åŒ–å™¨â€œæ— åˆ©å¯å›¾â€ï¼Œè¯´ä¸å‡†è¿˜è¦â€œå€’è´´â€ï¼Œè‡ªç„¶ä¹Ÿå°±æ²¡æ³•ä¼˜åŒ–å¥½äº†ã€‚æ‰€ä»¥æˆ‘ä»¬è¦å°†æ¨¡å‹åˆå§‹åŒ–å¾—å°½é‡å‡åŒ€ï¼Œä»¥ä¿è¯å¯ä»¥â€œæ¦¨å–â€çš„ä¿¡æ¯é‡æœ€å¤§ã€‚</p>
<p>å½“ç„¶ï¼Œé™¤äº†è¦ä¿è¯ä¿¡æ¯é‡çš„ä¸Šç•Œè¶³å¤Ÿå¤§å¤–ï¼Œè¿˜è¦ä¿è¯ä¿¡æ¯é‡çš„ä¸‹ç•Œè¶³å¤Ÿå°ï¼Œæ‰èƒ½ä¿è¯å¯ä»¥â€œæ¦¨å–â€çš„ä¿¡æ¯é‡å°½é‡å¤§ã€‚ä¹‹å‰åœ¨ä»‹ç»å¯¹æ¯”å­¦ä¹ ä¸­ï¼Œæœ‰è¯»è€…ä¸ç†è§£æ¸©åº¦å‚æ•°çš„æ„ä¹‰ï¼Œå…¶å®ä¹Ÿå¯ä»¥ä»ä¿¡æ¯é‡æ¥ç†è§£ã€‚è®°<br />
\begin{equation}p_i = \frac{e^{(\cos\theta_i) / \tau}}{\sum\limits_{i=1}^n e^{(\cos\theta_i)/\tau}}\end{equation}<br />
å¦‚æœ$\tau=1$ï¼Œé‚£ä¹ˆä¿¡æ¯ç†µçš„ä¸Šç•Œä¸º$\log n$ï¼Œä½†æ˜¯ä¸‹ç•Œçº¦ä¸º$\log n - 0.4745$ï¼ˆå‚è€ƒ<a href="/archives/9593/comment-page-1#comment-28363">è¯„è®ºåŒº</a>ï¼‰ï¼Œèƒ½è·å¾—çš„ä¿¡æ¯é‡å¤ªå°‘ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç¼©å°$\tau$ï¼Œä½¿å¾—ä¿¡æ¯ç†µçš„ä¸‹ç•Œæ¥è¿‘0ï¼Œä»è€Œå¢åŠ èƒ½å¤Ÿè·å¾—çš„ä¿¡æ¯é‡ã€‚</p>
<h2 id="_3">ç®€è¨€ä¹‹</h2>
<p>ç®€å•æ°´äº†ä¸€ç¯‡åšå®¢ã€‚å¯ä»¥çœ‹å‡ºï¼Œæœ€ç»ˆçš„ç»“è®ºè¿˜æ˜¯â€”â€”<a href="/archives/9019">ã€Šå¬è¯´Attentionä¸Softmaxæ›´é…å“¦ï½ã€‹</a>ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9593">https://spaces.ac.cn/archives/9593</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Apr. 25, 2023). ã€Šæ³¨æ„åŠ›å’ŒSoftmaxçš„ä¸¤ç‚¹æœ‰è¶£å‘ç°ï¼šé²æ£’æ€§å’Œä¿¡æ¯é‡ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9593">https://spaces.ac.cn/archives/9593</a></p>
<p>@online{kexuefm-9593,<br />
title={æ³¨æ„åŠ›å’ŒSoftmaxçš„ä¸¤ç‚¹æœ‰è¶£å‘ç°ï¼šé²æ£’æ€§å’Œä¿¡æ¯é‡},<br />
author={è‹å‰‘æ—},<br />
year={2023},<br />
month={Apr},<br />
url={\url{https://spaces.ac.cn/archives/9593}},<br />
} </p>
<hr />
<h2 id="_4">è¯¦ç»†æ•°å­¦æ¨å¯¼ä¸ç†è®ºåˆ†æ</h2>
<h3 id="1-softmax">1. Softmaxæ³¨æ„åŠ›æœºåˆ¶å›é¡¾</h3>
<p><strong>æ ‡å‡†æ³¨æ„åŠ›å…¬å¼</strong>ï¼š</p>
<p>å¯¹äºæŸ¥è¯¢å‘é‡$\boldsymbol{q} \in \mathbb{R}^d$å’Œé”®å€¼å¯¹${(\boldsymbol{k}<em i="1">i, \boldsymbol{v}_i)}</em>^n$ï¼Œæ³¨æ„åŠ›è¾“å‡ºä¸ºï¼š
\begin{equation}
\boldsymbol{o} = \sum_{i=1}^n \alpha_i \boldsymbol{v}<em i="1">i = \frac{\sum</em>}^n e^{s_i} \boldsymbol{v<em i="1">i}{\sum</em>
\end{equation}}^n e^{s_i}} \tag{1</p>
<p>å…¶ä¸­ï¼š
- $s_i = \langle \boldsymbol{q}, \boldsymbol{k}_i \rangle$ æ˜¯æ³¨æ„åŠ›åˆ†æ•°ï¼ˆscoreï¼‰
- $\alpha_i = \frac{e^{s_i}}{\sum_j e^{s_j}}$ æ˜¯æ³¨æ„åŠ›æƒé‡</p>
<p><strong>ç´§å‡‘å½¢å¼</strong>ï¼š
\begin{equation}
\boldsymbol{o} = \frac{\sum_{i=1}^n e^{s_i} \boldsymbol{v}<em i="1">i}{\sum</em>
\end{equation}}^n e^{s_i}} = \frac{\mathbb{E}_i[e^{s_i} \boldsymbol{v}_i]}{\mathbb{E}_i[e^{s_i}]} \cdot n \tag{2</p>
<p>å…¶ä¸­$\mathbb{E}<em i="1">i[\cdot] = \frac{1}{n}\sum</em>^n (\cdot)$è¡¨ç¤ºç»éªŒæœŸæœ›ã€‚</p>
<h3 id="2">2. å™ªå£°é²æ£’æ€§çš„æ•°å­¦è¯æ˜</h3>
<p><strong>é—®é¢˜è®¾å®š</strong>ï¼šå‡è®¾æ³¨æ„åŠ›åˆ†æ•°å—åˆ°å™ªå£°æ‰°åŠ¨ï¼š
\begin{equation}
\tilde{s}_i = s_i + \varepsilon_i \tag{3}
\end{equation}</p>
<p>å…¶ä¸­${\varepsilon_i}_{i=1}^n$æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒçš„å™ªå£°ï¼Œæ»¡è¶³ï¼š
- $\varepsilon_i \perp!!!\perp (s_i, \boldsymbol{v}_i)$ï¼ˆç‹¬ç«‹æ€§ï¼‰
- $\mathbb{E}[\varepsilon_i] = 0$ï¼ˆé›¶å‡å€¼ï¼Œå¯é€‰ï¼‰
- $\mathbb{E}[e^{\varepsilon_i}] = c &lt; \infty$ï¼ˆæŒ‡æ•°çŸ©æœ‰é™ï¼‰</p>
<p><strong>åŠ å™ªåçš„æ³¨æ„åŠ›è¾“å‡º</strong>ï¼š
\begin{equation}
\tilde{\boldsymbol{o}} = \frac{\sum_{i=1}^n e^{s_i + \varepsilon_i} \boldsymbol{v}<em i="1">i}{\sum</em>}^n e^{s_i + \varepsilon_i}} = \frac{\sum_{i=1}^n e^{s_i} e^{\varepsilon_i} \boldsymbol{v<em i="1">i}{\sum</em>
\end{equation}}^n e^{s_i} e^{\varepsilon_i}} \tag{4</p>
<p><strong>å…³é”®å˜æ¢</strong>ï¼ˆæ”¹å†™ä¸ºæœŸæœ›å½¢å¼ï¼‰ï¼š
\begin{equation}
\tilde{\boldsymbol{o}} = \frac{n \cdot \mathbb{E}_i[e^{s_i} e^{\varepsilon_i} \boldsymbol{v}_i]}{n \cdot \mathbb{E}_i[e^{s_i} e^{\varepsilon_i}]} = \frac{\mathbb{E}_i[e^{s_i} e^{\varepsilon_i} \boldsymbol{v}_i]}{\mathbb{E}_i[e^{s_i} e^{\varepsilon_i}]} \tag{5}
\end{equation}</p>
<p><strong>åˆ©ç”¨ç‹¬ç«‹æ€§</strong>ï¼š</p>
<p>ç”±äº$\varepsilon_i \perp!!!\perp (s_i, \boldsymbol{v}_i)$ï¼Œæˆ‘ä»¬æœ‰ï¼š
\begin{equation}
\mathbb{E}_i[e^{s_i} e^{\varepsilon_i} \boldsymbol{v}_i] \approx \mathbb{E}_i[e^{s_i} \boldsymbol{v}_i] \cdot \mathbb{E}[e^{\varepsilon}] \tag{6}
\end{equation}</p>
<p>\begin{equation}
\mathbb{E}_i[e^{s_i} e^{\varepsilon_i}] \approx \mathbb{E}_i[e^{s_i}] \cdot \mathbb{E}[e^{\varepsilon}] \tag{7}
\end{equation}</p>
<p>å…¶ä¸­$\mathbb{E}[e^{\varepsilon}]$æ˜¯å™ªå£°çš„æŒ‡æ•°çŸ©ï¼Œä¸$i$æ— å…³ã€‚</p>
<p><strong>çº¦ç­‰å·è¯´æ˜</strong>ï¼šè¿™é‡Œç”¨äº†<strong>æ ·æœ¬å¹³å‡è¿‘ä¼¼æ€»ä½“æœŸæœ›</strong>çš„å‡è®¾ã€‚ä¸¥æ ¼æ¥è¯´ï¼š
\begin{equation}
\frac{1}{n}\sum_{i=1}^n e^{s_i} e^{\varepsilon_i} \boldsymbol{v}_i \xrightarrow{n\to\infty} \mathbb{E}[e^s e^\varepsilon \boldsymbol{v}] = \mathbb{E}[e^s \boldsymbol{v}] \mathbb{E}[e^\varepsilon] \tag{8}
\end{equation}</p>
<p>ï¼ˆæ ¹æ®å¤§æ•°å®šå¾‹å’Œç‹¬ç«‹æ€§ï¼‰</p>
<p><strong>å™ªå£°æ¶ˆé™¤</strong>ï¼š</p>
<p>ä»£å…¥å¼(5)ï¼š
\begin{equation}
\tilde{\boldsymbol{o}} \approx \frac{\mathbb{E}_i[e^{s_i} \boldsymbol{v}_i] \cdot \mathbb{E}[e^{\varepsilon}]}{\mathbb{E}_i[e^{s_i}] \cdot \mathbb{E}[e^{\varepsilon}]} = \frac{\mathbb{E}_i[e^{s_i} \boldsymbol{v}_i]}{\mathbb{E}_i[e^{s_i}]} = \boldsymbol{o} \tag{9}
\end{equation}</p>
<p><strong>ç»“è®º</strong>ï¼šå™ªå£°çš„å½±å“è¢«<strong>çº¦æ‰</strong>äº†ï¼</p>
<h3 id="3">3. é²æ£’æ€§çš„ä¸¥æ ¼åˆ†æ</h3>
<p>ä¸Šè¿°æ¨å¯¼ä½¿ç”¨äº†è¿‘ä¼¼ï¼Œç°åœ¨æˆ‘ä»¬è¿›è¡Œæ›´ä¸¥æ ¼çš„åˆ†æã€‚</p>
<p><strong>å®šç†1</strong>ï¼ˆå™ªå£°é²æ£’æ€§ï¼‰ï¼š</p>
<p>å‡è®¾$\varepsilon_i$ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œ$\mathbb{E}[e^\varepsilon] = c$ï¼Œ$\text{Var}(e^\varepsilon) = \sigma^2$ã€‚åˆ™ï¼š
\begin{equation}
\mathbb{E}[\tilde{\boldsymbol{o}}] = \boldsymbol{o} + O\left(\frac{1}{\sqrt{n}}\right) \tag{10}
\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>è®°$X_i = e^{s_i} \boldsymbol{v}_i$ï¼Œ$Y_i = e^{s_i}$ï¼Œ$Z_i = e^{\varepsilon_i}$ã€‚åˆ™ï¼š
\begin{equation}
\tilde{\boldsymbol{o}} = \frac{\sum_i X_i Z_i}{\sum_i Y_i Z_i} \tag{11}
\end{equation}</p>
<p>å¯¹åˆ†å­ï¼š
\begin{equation}
\mathbb{E}\left[\sum_i X_i Z_i\right] = \sum_i \mathbb{E}[X_i] \mathbb{E}[Z_i] = c \sum_i e^{s_i} \boldsymbol{v}_i \tag{12}
\end{equation}</p>
<p>å¯¹åˆ†æ¯ï¼š
\begin{equation}
\mathbb{E}\left[\sum_i Y_i Z_i\right] = c \sum_i e^{s_i} \tag{13}
\end{equation}</p>
<p>åˆ©ç”¨<strong>Deltaæ–¹æ³•</strong>ï¼ˆä¸€é˜¶Taylorå±•å¼€ï¼‰ï¼š</p>
<p>å¯¹äº$f(x, y) = \frac{x}{y}$ï¼Œåœ¨$(\bar{x}, \bar{y})$é™„è¿‘ï¼š
\begin{equation}
f(X, Y) \approx f(\bar{x}, \bar{y}) + \frac{\partial f}{\partial x}(X - \bar{x}) + \frac{\partial f}{\partial y}(Y - \bar{y}) \tag{14}
\end{equation}</p>
<p>å…¶ä¸­ï¼š
\begin{equation}
\frac{\partial f}{\partial x} = \frac{1}{y}, \quad \frac{\partial f}{\partial y} = -\frac{x}{y^2} \tag{15}
\end{equation}</p>
<p>å› æ­¤ï¼š
\begin{equation}
\mathbb{E}\left[\frac{X}{Y}\right] \approx \frac{\mathbb{E}[X]}{\mathbb{E}[Y]} + \frac{\text{Cov}(X, Y) \mathbb{E}[X] - \text{Var}(Y) \mathbb{E}[X]}{\mathbb{E}[Y]^3} \tag{16}
\end{equation}</p>
<p>å¯¹äºæˆ‘ä»¬çš„æƒ…å†µï¼Œç”±äº$Z_i$ç‹¬ç«‹ï¼š
\begin{equation}
\text{Var}\left(\sum_i Y_i Z_i\right) = \sum_i \text{Var}(Y_i Z_i) = \sigma^2 \sum_i e^{2s_i} = O(n) \tag{17}
\end{equation}</p>
<p>å› æ­¤è¯¯å·®ä¸º$O(1/\sqrt{n})$ã€‚</p>
<p><strong>æ›´ç›´è§‚çš„ç†è§£</strong>ï¼š</p>
<p>å½“$n$å¾ˆå¤§æ—¶ï¼Œæ ¹æ®ä¸­å¿ƒæé™å®šç†ï¼š
\begin{equation}
\frac{1}{n}\sum_{i=1}^n e^{s_i} e^{\varepsilon_i} \xrightarrow{d} \mathbb{E}[e^s e^\varepsilon] = \mathbb{E}[e^s] \mathbb{E}[e^\varepsilon] \tag{18}
\end{equation}</p>
<p>æ‰€ä»¥å™ªå£°çš„å½±å“åœ¨å¤§$n$ä¸‹è¢«å¹³å‡æ‰äº†ï¼</p>
<h3 id="4-lipschitz">4. Lipschitzè¿ç»­æ€§åˆ†æ</h3>
<p><strong>å®šä¹‰</strong>ï¼šå‡½æ•°$f: \mathbb{R}^n \to \mathbb{R}^d$æ˜¯$L$-Lipschitzçš„ï¼Œå¦‚æœï¼š
\begin{equation}
|f(\boldsymbol{x}) - f(\boldsymbol{y})| \leq L |\boldsymbol{x} - \boldsymbol{y}| \tag{19}
\end{equation}</p>
<p><strong>å®šç†2</strong>ï¼ˆSoftmaxæ³¨æ„åŠ›çš„Lipschitzå¸¸æ•°ï¼‰ï¼š</p>
<p>å°†æ³¨æ„åŠ›è§†ä¸ºå‡½æ•°$f: \mathbb{R}^n \to \mathbb{R}^d$ï¼Œ$f(\boldsymbol{s}) = \boldsymbol{o}$ã€‚åˆ™ï¼š
\begin{equation}
|f(\boldsymbol{s} + \boldsymbol{\varepsilon}) - f(\boldsymbol{s})| \leq L |\boldsymbol{\varepsilon}| \tag{20}
\end{equation}</p>
<p>å…¶ä¸­Lipschitzå¸¸æ•°$L$ä¾èµ–äº$\boldsymbol{s}$å’Œ${\boldsymbol{v}_i}$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>è®°$\alpha_i = \frac{e^{s_i}}{\sum_j e^{s_j}}$ï¼Œ$\tilde{\alpha}_i = \frac{e^{s_i + \varepsilon_i}}{\sum_j e^{s_j + \varepsilon_j}}$ã€‚</p>
<p>åˆ™ï¼š
\begin{equation}
\begin{aligned}
|\boldsymbol{o}' - \boldsymbol{o}| &amp;= \left|\sum_i (\tilde{\alpha}_i - \alpha_i) \boldsymbol{v}_i\right| \
&amp;\leq \sum_i |\tilde{\alpha}_i - \alpha_i| \cdot |\boldsymbol{v}_i| \
&amp;\leq \max_i |\boldsymbol{v}_i| \cdot \sum_i |\tilde{\alpha}_i - \alpha_i|
\end{aligned} \tag{21}
\end{equation}</p>
<p><strong>Softmaxçš„Lipschitzå¸¸æ•°</strong>ï¼š</p>
<p>å¯¹äºsoftmaxå‡½æ•°$\sigma: \mathbb{R}^n \to \Delta^{n-1}$ï¼ˆ$\Delta^{n-1}$æ˜¯å•çº¯å½¢ï¼‰ï¼š
\begin{equation}
|\sigma(\boldsymbol{s} + \boldsymbol{\varepsilon}) - \sigma(\boldsymbol{s})|<em>1 \leq |\boldsymbol{\varepsilon}|</em>\infty \tag{22}
\end{equation}</p>
<p>ï¼ˆè¿™æ˜¯softmaxçš„ç»å…¸æ€§è´¨ï¼‰</p>
<p>å› æ­¤ï¼š
\begin{equation}
|\boldsymbol{o}' - \boldsymbol{o}| \leq \max_i |\boldsymbol{v}<em>i| \cdot |\boldsymbol{\varepsilon}|</em>\infty \tag{23}
\end{equation}</p>
<p><strong>ç»“è®º</strong>ï¼šæ³¨æ„åŠ›å¯¹scoreçš„å°æ‰°åŠ¨æ˜¯<strong>Lipschitzè¿ç»­</strong>çš„ï¼Œè¿™ä¿è¯äº†é²æ£’æ€§ã€‚</p>
<h3 id="5">5. ä¸åŒå™ªå£°åˆ†å¸ƒçš„å½±å“</h3>
<p><strong>é«˜æ–¯å™ªå£°</strong>ï¼š$\varepsilon \sim \mathcal{N}(0, \sigma^2)$</p>
<p>çŸ©ç”Ÿæˆå‡½æ•°ï¼š
\begin{equation}
\mathbb{E}[e^{\varepsilon}] = e^{\sigma^2/2} \tag{24}
\end{equation}</p>
<p>ä»£å…¥å¼(9)ï¼š
\begin{equation}
\tilde{\boldsymbol{o}} \approx \boldsymbol{o} \quad \text{ï¼ˆå™ªå£°çº¦æ‰ï¼‰} \tag{25}
\end{equation}</p>
<p><strong>å‡åŒ€å™ªå£°</strong>ï¼š$\varepsilon \sim U(-a, a)$</p>
<p>\begin{equation}
\mathbb{E}[e^{\varepsilon}] = \frac{1}{2a}\int_{-a}^a e^t dt = \frac{e^a - e^{-a}}{2a} = \frac{\sinh(a)}{a} \tag{26}
\end{equation}</p>
<p>åŒæ ·ä¼šçº¦æ‰ã€‚</p>
<p><strong>Laplaceå™ªå£°</strong>ï¼š$\varepsilon \sim \text{Laplace}(0, b)$</p>
<p>\begin{equation}
\mathbb{E}[e^{\varepsilon}] = \int_{-\infty}^{\infty} \frac{1}{2b} e^{-|t|/b} e^t dt \tag{27}
\end{equation}</p>
<p>å½“$b &gt; 1$æ—¶å‘æ•£ï¼Œä½†åœ¨å®é™…åº”ç”¨ä¸­$b$é€šå¸¸å¾ˆå°ã€‚</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šåªè¦$\mathbb{E}[e^{\varepsilon}]$å­˜åœ¨ä¸”æœ‰é™ï¼Œå™ªå£°å°±èƒ½è¢«çº¦æ‰ï¼</p>
<h3 id="6">6. ä¿¡æ¯ç†µçš„å®šä¹‰ä¸æ€§è´¨</h3>
<p><strong>ç¦»æ•£æ¦‚ç‡åˆ†å¸ƒçš„ç†µ</strong>ï¼š</p>
<p>å¯¹äºæ³¨æ„åŠ›æƒé‡${\alpha_i}<em i="1">{i=1}^n$ï¼ˆæ»¡è¶³$\alpha_i \geq 0$ï¼Œ$\sum_i \alpha_i = 1$ï¼‰ï¼ŒShannonç†µä¸ºï¼š
\begin{equation}
H(\boldsymbol{\alpha}) = -\sum</em>
\end{equation}}^n \alpha_i \log \alpha_i \tag{28</p>
<p><strong>ç†µçš„æ€§è´¨</strong>ï¼š</p>
<ol>
<li><strong>éè´Ÿæ€§</strong>ï¼š$H(\boldsymbol{\alpha}) \geq 0$</li>
<li><strong>æœ‰ç•Œæ€§</strong>ï¼š$0 \leq H(\boldsymbol{\alpha}) \leq \log n$</li>
<li><strong>æœ€å¤§å€¼</strong>ï¼šå½“$\alpha_i = \frac{1}{n}$ï¼ˆå‡åŒ€åˆ†å¸ƒï¼‰æ—¶ï¼Œ$H = \log n$</li>
<li><strong>æœ€å°å€¼</strong>ï¼šå½“$\alpha_i = \delta_{ij}$ï¼ˆone-hotåˆ†å¸ƒï¼‰æ—¶ï¼Œ$H = 0$</li>
</ol>
<p><strong>ä»æ³¨æ„åŠ›åˆ†æ•°åˆ°ç†µ</strong>ï¼š</p>
<p>\begin{equation}
H(s_1, \ldots, s_n) = -\sum_{i=1}^n \frac{e^{s_i}}{\sum_j e^{s_j}} \log \frac{e^{s_i}}{\sum_j e^{s_j}} \tag{29}
\end{equation}</p>
<p>å±•å¼€ï¼š
\begin{equation}
\begin{aligned}
H &amp;= -\sum_i \frac{e^{s_i}}{\sum_j e^{s_j}} \left(s_i - \log\sum_j e^{s_j}\right) \
&amp;= \log\sum_j e^{s_j} - \frac{\sum_i s_i e^{s_i}}{\sum_j e^{s_j}}
\end{aligned} \tag{30}
\end{equation}</p>
<p>è®°$Z = \sum_j e^{s_j}$ï¼ˆé…åˆ†å‡½æ•°ï¼‰ï¼Œåˆ™ï¼š
\begin{equation}
H = \log Z - \frac{\sum_i s_i e^{s_i}}{Z} \tag{31}
\end{equation}</p>
<h3 id="7">7. ç†µä¸åˆå§‹åŒ–çš„å…³ç³»</h3>
<p><strong>é—®é¢˜</strong>ï¼šå¦‚æœå°†æ³¨æ„åŠ›åˆ†æ•°$s_i$åˆå§‹åŒ–å¾—å¾ˆå¤§ï¼Œä¼šæ€æ ·ï¼Ÿ</p>
<p><strong>åˆ†æ</strong>ï¼šå‡è®¾$s_i \sim \mathcal{N}(0, \sigma^2)$ï¼Œå½“$\sigma \to \infty$æ—¶ï¼š</p>
<p>\begin{equation}
\alpha_i \approx \delta_{i, i^<em>}, \quad i^</em> = \arg\max_i s_i \tag{32}
\end{equation}</p>
<p>å³ï¼šæ³¨æ„åŠ›æƒé‡é€€åŒ–ä¸º<strong>one-hotåˆ†å¸ƒ</strong>ã€‚</p>
<p><strong>ç†µçš„è®¡ç®—</strong>ï¼š</p>
<p>å½“$\sigma$å¾ˆå¤§æ—¶ï¼Œå‡ ä¹æ‰€æœ‰æƒé‡éƒ½é›†ä¸­åœ¨æœ€å¤§çš„$s_i$ä¸Šï¼š
\begin{equation}
H \approx 0 \tag{33}
\end{equation}</p>
<p><strong>ä¿¡æ¯é‡çš„è§£é‡Š</strong>ï¼š</p>
<p>ç†µ$H$åº¦é‡äº†<strong>ä¸ç¡®å®šæ€§</strong>ï¼Œä¹Ÿæ˜¯ä»"ä¸ç¡®å®š"åˆ°"ç¡®å®š"èƒ½è·å¾—çš„<strong>æœ€å¤§ä¿¡æ¯é‡</strong>ã€‚</p>
<ul>
<li>$H = 0$ï¼šå®Œå…¨ç¡®å®šï¼Œæ— ä¿¡æ¯å¯å­¦ä¹ </li>
<li>$H = \log n$ï¼šå®Œå…¨ä¸ç¡®å®šï¼Œæœ€å¤§ä¿¡æ¯å¯å­¦ä¹ </li>
</ul>
<p><strong>è®­ç»ƒçš„è§†è§’</strong>ï¼š</p>
<p>æœºå™¨å­¦ä¹ çš„ç›®æ ‡æ˜¯ä»éšæœºæ¨¡å‹ï¼ˆé«˜ç†µï¼‰å­¦ä¹ åˆ°ç¡®å®šæ¨¡å‹ï¼ˆä½ç†µï¼‰ã€‚å¦‚æœåˆå§‹åŒ–æ—¶ç†µå·²ç»å¾ˆä½ï¼Œé‚£ä¹ˆ<strong>å¯å­¦ä¹ çš„ä¿¡æ¯é‡å¾ˆå°‘</strong>ï¼Œå¯¼è‡´è®­ç»ƒå›°éš¾ã€‚</p>
<p><strong>æ¢¯åº¦æ¶ˆå¤±</strong>ï¼š</p>
<p>å½“$\alpha_i \approx \delta_{ij}$æ—¶ï¼Œå¯¹äº$i \neq j$ï¼š
\begin{equation}
\frac{\partial \alpha_i}{\partial s_i} = \alpha_i(1 - \alpha_i) \approx 0 \tag{34}
\end{equation}</p>
<p>å› æ­¤æ¢¯åº¦æ¶ˆå¤±ï¼Œæ— æ³•æœ‰æ•ˆè®­ç»ƒã€‚</p>
<h3 id="8">8. ç†µçš„ä¸‹ç•Œä¸åˆå§‹åŒ–</h3>
<p><strong>ç†µä¸åˆ†æ•°æ–¹å·®çš„å…³ç³»</strong>ï¼š</p>
<p>å‡è®¾$s_i \sim \mathcal{N}(\mu, \sigma^2)$ï¼Œåˆ™å¯ä»¥è¯æ˜ï¼ˆè§[è¯„è®ºåŒº]ï¼‰ï¼š</p>
<p>\begin{equation}
H \approx \log n - C \tag{35}
\end{equation}</p>
<p>å…¶ä¸­$C$æ˜¯ä¸€ä¸ªä¸$\sigma$ç›¸å…³çš„å¸¸æ•°ï¼Œæ»¡è¶³$C \approx 0.4745$ï¼ˆå½“$\sigma = 1$æ—¶ï¼‰ã€‚</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šå³ä½¿$s_i$æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œç†µçš„ä¸‹ç•Œä¹Ÿå¤§çº¦æ˜¯ï¼š
\begin{equation}
H_{\min} \approx \log n - 0.4745 \tag{36}
\end{equation}</p>
<p>è¿™æ„å‘³ç€<strong>ä¿¡æ¯ç†µçš„èŒƒå›´</strong>å¤§çº¦æ˜¯$[0.4745, \log n]$ï¼Œè€Œä¸æ˜¯$[0, \log n]$ï¼</p>
<p><strong>å¯å­¦ä¹ çš„ä¿¡æ¯é‡</strong>ï¼š
\begin{equation}
\Delta H = H_{\max} - H_{\min} \approx \log n - 0.4745 \tag{37}
\end{equation}</p>
<p>å½“$n$å¾ˆå¤§æ—¶ï¼Œ$\Delta H \approx \log n$ï¼Œä¿¡æ¯é‡å……è¶³ã€‚</p>
<p>ä½†å¦‚æœåˆå§‹åŒ–ä½¿å¾—$H \approx H_{\min}$ï¼Œé‚£ä¹ˆå¯å­¦ä¹ çš„ä¿¡æ¯é‡å¤ªå°‘ï¼</p>
<h3 id="9">9. æ¸©åº¦å‚æ•°çš„ä½œç”¨</h3>
<p><strong>æ¸©åº¦ç¼©æ”¾</strong>ï¼š</p>
<p>åœ¨å¯¹æ¯”å­¦ä¹ ç­‰åœºæ™¯ä¸­ï¼Œå¸¸ç”¨æ¸©åº¦å‚æ•°$\tau$ï¼š
\begin{equation}
\alpha_i = \frac{e^{s_i / \tau}}{\sum_j e^{s_j / \tau}} \tag{38}
\end{equation}</p>
<p><strong>æ¸©åº¦å¯¹ç†µçš„å½±å“</strong>ï¼š</p>
<p>å½“$\tau \to 0$æ—¶ï¼š
\begin{equation}
\alpha_i \to \delta_{i, \arg\max_j s_j}, \quad H \to 0 \tag{39}
\end{equation}</p>
<p>å½“$\tau \to \infty$æ—¶ï¼š
\begin{equation}
\alpha_i \to \frac{1}{n}, \quad H \to \log n \tag{40}
\end{equation}</p>
<p><strong>ä¸­é—´æ¸©åº¦</strong>ï¼š</p>
<p>åˆé€‚çš„$\tau$èƒ½å¤Ÿ<strong>è°ƒèŠ‚ç†µçš„èŒƒå›´</strong>ï¼š
\begin{equation}
H(\tau) = -\sum_i \frac{e^{s_i/\tau}}{\sum_j e^{s_j/\tau}} \log \frac{e^{s_i/\tau}}{\sum_j e^{s_j/\tau}} \tag{41}
\end{equation}</p>
<p>æ”¹å†™ï¼š
\begin{equation}
H(\tau) = \log\sum_j e^{s_j/\tau} - \frac{1}{\tau} \frac{\sum_i s_i e^{s_i/\tau}}{\sum_j e^{s_j/\tau}} \tag{42}
\end{equation}</p>
<p><strong>å¯¹æ¯”å­¦ä¹ ä¸­çš„æ¸©åº¦</strong>ï¼š</p>
<p>åœ¨å¯¹æ¯”å­¦ä¹ ä¸­ï¼Œ$s_i = \cos\theta_i$ï¼ˆä½™å¼¦ç›¸ä¼¼åº¦ï¼‰ï¼ŒèŒƒå›´æ˜¯$[-1, 1]$ã€‚</p>
<p>å¦‚æœ$\tau = 1$ï¼Œåˆ™ï¼š
\begin{equation}
H \in [0, \log n - 0.4745] \tag{43}
\end{equation}</p>
<p>ä¿¡æ¯é‡ä¸è¶³ï¼</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šç¼©å°$\tau$ï¼ˆå¦‚$\tau = 0.07$ï¼‰ï¼Œä½¿å¾—ï¼š
\begin{equation}
s_i' = \frac{s_i}{\tau} \in \left[-\frac{1}{\tau}, \frac{1}{\tau}\right] = [-14.3, 14.3] \tag{44}
\end{equation}</p>
<p>è¿™æ ·ç†µçš„ä¸‹ç•Œæ¥è¿‘0ï¼Œä¿¡æ¯é‡å……è¶³ï¼š
\begin{equation}
H \in [0, \log n] \tag{45}
\end{equation}</p>
<h3 id="10">10. ä¿¡æ¯è®ºçš„å‡ ä½•è§†è§’</h3>
<p><strong>æ¦‚ç‡å•çº¯å½¢</strong>ï¼š</p>
<p>$n$ä¸ªç±»åˆ«çš„æ¦‚ç‡åˆ†å¸ƒæ„æˆ$(n-1)$ç»´å•çº¯å½¢ï¼š
\begin{equation}
\Delta^{n-1} = \left{\boldsymbol{\alpha} \in \mathbb{R}^n : \alpha_i \geq 0, \sum_i \alpha_i = 1\right} \tag{46}
\end{equation}</p>
<p><strong>ç†µä½œä¸º"è·ç¦»"</strong>ï¼š</p>
<p>ç†µå¯ä»¥ç†è§£ä¸ºåˆ†å¸ƒåˆ°<strong>ä¸­å¿ƒç‚¹</strong>ï¼ˆå‡åŒ€åˆ†å¸ƒï¼‰çš„"è·ç¦»"ï¼š
\begin{equation}
H(\boldsymbol{\alpha}) = \log n - D_{\text{KL}}(\boldsymbol{\alpha} | \boldsymbol{u}) \tag{47}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{u} = [\frac{1}{n}, \ldots, \frac{1}{n}]$ã€‚</p>
<p><strong>Fisherä¿¡æ¯çŸ©é˜µ</strong>ï¼š</p>
<p>åœ¨æ¦‚ç‡æµå½¢ä¸Šï¼ŒFisherä¿¡æ¯åº¦é‡å®šä¹‰äº†Riemannianåº¦é‡ï¼š
\begin{equation}
g_{ij} = \mathbb{E}_{\alpha}\left[\frac{\partial \log p(x|\alpha)}{\partial \alpha_i} \frac{\partial \log p(x|\alpha)}{\partial \alpha_j}\right] \tag{48}
\end{equation}</p>
<p>å¯¹äºcategoricalåˆ†å¸ƒï¼Œè¿™ç®€åŒ–ä¸ºï¼š
\begin{equation}
g_{ij} = \frac{\delta_{ij}}{\alpha_i} - 1 \tag{49}
\end{equation}</p>
<p><strong>ç†µçš„æ¢¯åº¦</strong>ï¼š</p>
<p>åœ¨è¿™ä¸ªåº¦é‡ä¸‹ï¼Œç†µçš„æ¢¯åº¦ä¸ºï¼š
\begin{equation}
\nabla_{\alpha} H = -\log \boldsymbol{\alpha} - \mathbf{1} \tag{50}
\end{equation}</p>
<p>è¿™æŒ‡å‘äº†å‡åŒ€åˆ†å¸ƒï¼</p>
<h3 id="11">11. ç†µä¸æ³¨æ„åŠ›æœºåˆ¶çš„è®­ç»ƒåŠ¨æ€</h3>
<p><strong>è®­ç»ƒåˆæœŸ</strong>ï¼ˆéšæœºåˆå§‹åŒ–ï¼‰ï¼š</p>
<p>$s_i$æ¥è¿‘0ï¼Œ$\alpha_i \approx \frac{1}{n}$ï¼Œ$H \approx \log n$ï¼ˆé«˜ç†µï¼‰ã€‚</p>
<p><strong>è®­ç»ƒä¸­æœŸ</strong>ï¼š</p>
<p>æ¨¡å‹å¼€å§‹åŒºåˆ†é‡è¦å’Œä¸é‡è¦çš„tokensï¼ŒæŸäº›$\alpha_i$å˜å¤§ï¼Œ$H$ä¸‹é™ã€‚</p>
<p><strong>è®­ç»ƒåæœŸ</strong>ï¼š</p>
<p>æ³¨æ„åŠ›æƒé‡è¶‹å‘peakedåˆ†å¸ƒï¼Œ$H$æ¥è¿‘ä¸‹ç•Œï¼ˆä½†ä¸åº”è¯¥ä¸º0ï¼Œå¦åˆ™æ¢¯åº¦æ¶ˆå¤±ï¼‰ã€‚</p>
<p><strong>ç†æƒ³çš„è®­ç»ƒè½¨è¿¹</strong>ï¼š</p>
<p>\begin{equation}
H(t): \log n \to \text{ä¸­ç­‰å€¼} \to H_{\text{final}} \tag{51}
\end{equation}</p>
<p>å…¶ä¸­$H_{\text{final}}$åº”è¯¥è¶³å¤Ÿä½ï¼ˆè¡¨ç¤ºå­¦åˆ°äº†patternï¼‰ï¼Œä½†ä¸èƒ½å¤ªä½ï¼ˆä¿æŒæ¢¯åº¦ï¼‰ã€‚</p>
<h3 id="12-softmax">12. Softmaxçš„å¹³æ»‘è¿‘ä¼¼</h3>
<p><strong>LogSumExpä½œä¸ºmaxçš„å¹³æ»‘è¿‘ä¼¼</strong>ï¼š</p>
<p>Softmaxä¸maxå‡½æ•°å¯†åˆ‡ç›¸å…³ï¼š
\begin{equation}
\max_i s_i \leq \log\sum_i e^{s_i} \leq \max_i s_i + \log n \tag{52}
\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>ä¸‹ç•Œï¼š$\log\sum_i e^{s_i} \geq \log e^{\max_i s_i} = \max_i s_i$</p>
<p>ä¸Šç•Œï¼š$\log\sum_i e^{s_i} \leq \log(n \cdot e^{\max_i s_i}) = \max_i s_i + \log n$</p>
<p><strong>ç´§è‡´æ€§</strong>ï¼š</p>
<p>å½“æŸä¸ª$s_j \gg s_i$ ($i \neq j$)æ—¶ï¼š
\begin{equation}
\log\sum_i e^{s_i} \approx \max_i s_i = s_j \tag{53}
\end{equation}</p>
<p><strong>æ³¨æ„åŠ›æƒé‡çš„è¿‘ä¼¼</strong>ï¼š</p>
<p>\begin{equation}
\alpha_i \approx \begin{cases}
1, &amp; i = \arg\max_j s_j \
0, &amp; \text{otherwise}
\end{cases} \tag{54}
\end{equation}</p>
<p><strong>ä¸ç¡¬æ³¨æ„åŠ›çš„è”ç³»</strong>ï¼š</p>
<p>ç¡¬æ³¨æ„åŠ›ï¼ˆhard attentionï¼‰ç›´æ¥é€‰æ‹©æœ€å¤§çš„ï¼š
\begin{equation}
\boldsymbol{o}<em>{\text{hard}} = \boldsymbol{v}</em>{i^<em>}, \quad i^</em> = \arg\max_i s_i \tag{55}
\end{equation}</p>
<p>Softmaxæ³¨æ„åŠ›æ˜¯å…¶å¹³æ»‘ç‰ˆæœ¬ï¼š
\begin{equation}
\boldsymbol{o}<em i_="i^*">{\text{soft}} = \sum_i \alpha_i \boldsymbol{v}_i \approx \boldsymbol{v}</em>
\end{equation}} \tag{56</p>
<h3 id="13">13. å¯¹æŠ—æ ·æœ¬çš„å½±å“åˆ†æ</h3>
<p><strong>å¯¹æŠ—æ‰°åŠ¨</strong>ï¼š</p>
<p>å‡è®¾å¯¹åˆ†æ•°è¿›è¡Œç²¾å¿ƒè®¾è®¡çš„æ‰°åŠ¨ï¼š
\begin{equation}
\tilde{s}_i = s_i + \delta_i, \quad |\boldsymbol{\delta}| \leq \epsilon \tag{57}
\end{equation}</p>
<p>ç›®æ ‡æ˜¯æœ€å¤§åŒ–è¾“å‡ºå˜åŒ–$|\tilde{\boldsymbol{o}} - \boldsymbol{o}|$ã€‚</p>
<p><strong>ä¸€é˜¶è¿‘ä¼¼</strong>ï¼š</p>
<p>å¯¹æ³¨æ„åŠ›è¾“å‡ºè¿›è¡ŒTaylorå±•å¼€ï¼š
\begin{equation}
\tilde{\boldsymbol{o}} \approx \boldsymbol{o} + \sum_i \frac{\partial \boldsymbol{o}}{\partial s_i} \delta_i \tag{58}
\end{equation}</p>
<p><strong>æ¢¯åº¦è®¡ç®—</strong>ï¼š</p>
<p>\begin{equation}
\frac{\partial \boldsymbol{o}}{\partial s_i} = \frac{\partial}{\partial s_i}\left(\sum_j \alpha_j \boldsymbol{v}_j\right) = \sum_j \frac{\partial \alpha_j}{\partial s_i} \boldsymbol{v}_j \tag{59}
\end{equation}</p>
<p>åˆ©ç”¨softmaxçš„æ€§è´¨ï¼š
\begin{equation}
\frac{\partial \alpha_j}{\partial s_i} = \begin{cases}
\alpha_i(1 - \alpha_i), &amp; i = j \
-\alpha_i \alpha_j, &amp; i \neq j
\end{cases} \tag{60}
\end{equation}</p>
<p>ä»£å…¥ï¼š
\begin{equation}
\frac{\partial \boldsymbol{o}}{\partial s_i} = \alpha_i(1-\alpha_i)\boldsymbol{v}<em i="i" j_neq="j\neq">i - \alpha_i\sum</em>
\end{equation}}\alpha_j\boldsymbol{v}_j = \alpha_i(\boldsymbol{v}_i - \boldsymbol{o}) \tag{61</p>
<p><strong>å¯¹æŠ—æ–¹å‘</strong>ï¼š</p>
<p>æœ€å¤§åŒ–$|\tilde{\boldsymbol{o}} - \boldsymbol{o}|$çš„æ‰°åŠ¨ä¸ºï¼š
\begin{equation}
\delta_i^* = \epsilon \cdot \text{sign}\left(\left\langle \frac{\partial \boldsymbol{o}}{\partial s_i}, \boldsymbol{v} \right\rangle\right) \tag{62}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{v}$æ˜¯æŸä¸ªç›®æ ‡æ–¹å‘ã€‚</p>
<p><strong>é²æ£’æ€§åˆ†æ</strong>ï¼š</p>
<p>æ³¨æ„åˆ°å¼(61)ä¸­çš„å› å­$\alpha_i(1-\alpha_i)$ï¼š
- å½“$\alpha_i \approx 0$æˆ–$\alpha_i \approx 1$æ—¶ï¼Œæ¢¯åº¦å¾ˆå°ï¼ˆé²æ£’ï¼‰
- å½“$\alpha_i \approx 0.5$æ—¶ï¼Œæ¢¯åº¦æœ€å¤§ï¼ˆæ˜“å—æ”»å‡»ï¼‰</p>
<p>è¿™ä¸ç†µæœ‰å…³ï¼šå‡åŒ€åˆ†å¸ƒï¼ˆ$\alpha_i = \frac{1}{n}$ï¼‰æ—¶ç†µæœ€å¤§ï¼Œå¯¹æŠ—æ‰°åŠ¨çš„å½±å“ä¹Ÿæœ€å¤§ã€‚</p>
<h3 id="14">14. ç¼©æ”¾å› å­çš„ç†è®ºåˆ†æ</h3>
<p><strong>æ ‡å‡†Scaled Dot-Product Attention</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{o} = \text{softmax}\left(\frac{\boldsymbol{Q}\boldsymbol{K}^\top}{\sqrt{d}}\right) \boldsymbol{V} \tag{63}
\end{equation}</p>
<p>å…¶ä¸­$d$æ˜¯ç»´åº¦ï¼Œ$\sqrt{d}$æ˜¯ç¼©æ”¾å› å­ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦ç¼©æ”¾ï¼Ÿ</strong></p>
<p>å‡è®¾$\boldsymbol{q}, \boldsymbol{k} \in \mathbb{R}^d$çš„å…ƒç´ ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œ$\mathbb{E}[q_i] = 0$ï¼Œ$\text{Var}(q_i) = \sigma^2$ã€‚</p>
<p>åˆ™ï¼š
\begin{equation}
s = \langle \boldsymbol{q}, \boldsymbol{k} \rangle = \sum_{i=1}^d q_i k_i \tag{64}
\end{equation}</p>
<p>æœŸæœ›ï¼š$\mathbb{E}[s] = 0$</p>
<p>æ–¹å·®ï¼š
\begin{equation}
\text{Var}(s) = \sum_{i=1}^d \text{Var}(q_i k_i) = d \cdot \mathbb{E}[q_i^2] \mathbb{E}[k_i^2] = d\sigma^4 \tag{65}
\end{equation}</p>
<p><strong>é—®é¢˜</strong>ï¼šå½“$d$å¾ˆå¤§æ—¶ï¼Œ$s$çš„æ–¹å·®å˜å¾—å¾ˆå¤§ï¼Œå¯¼è‡´$e^s$æ•°å€¼ä¸ç¨³å®šã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šé™¤ä»¥$\sqrt{d}$ï¼š
\begin{equation}
s' = \frac{s}{\sqrt{d}} \Rightarrow \text{Var}(s') = \sigma^4 \tag{66}
\end{equation}</p>
<p>è¿™æ ·æ–¹å·®ä¸éš$d$å˜åŒ–ï¼</p>
<p><strong>ä¸ç†µçš„è”ç³»</strong>ï¼š</p>
<p>å¦‚æœä¸ç¼©æ”¾ï¼Œå½“$d \to \infty$æ—¶ï¼Œ$s_i$çš„æ–¹å·®è¶‹å‘æ— ç©·ï¼Œå¯¼è‡´ï¼š
\begin{equation}
\alpha_{i^*} \to 1, \quad H \to 0 \tag{67}
\end{equation}</p>
<p>ç¼©æ”¾åï¼Œç†µä¿æŒåœ¨åˆç†èŒƒå›´ã€‚</p>
<h3 id="15">15. ä¿¡æ¯ç“¶é¢ˆç†è®º</h3>
<p><strong>ä¿¡æ¯ç“¶é¢ˆï¼ˆInformation Bottleneckï¼‰</strong>ï¼š</p>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œéšè—å±‚$Z$åº”è¯¥ï¼š
1. æœ€å¤§åŒ–ä¸æ ‡ç­¾$Y$çš„äº’ä¿¡æ¯ï¼š$I(Z; Y)$
2. æœ€å°åŒ–ä¸è¾“å…¥$X$çš„äº’ä¿¡æ¯ï¼š$I(Z; X)$</p>
<p>å¹³è¡¡ä¸¤è€…ï¼š
\begin{equation}
\mathcal{L}_{\text{IB}} = I(Z; X) - \beta I(Z; Y) \tag{68}
\end{equation}</p>
<p><strong>æ³¨æ„åŠ›çš„è§†è§’</strong>ï¼š</p>
<p>æ³¨æ„åŠ›æœºåˆ¶ç›¸å½“äºä»${\boldsymbol{v}_i}$ä¸­é€‰æ‹©ä¿¡æ¯å‹ç¼©åˆ°$\boldsymbol{o}$ã€‚</p>
<ul>
<li>é«˜ç†µ$H$ï¼šä¿ç•™æ›´å¤šä¿¡æ¯ï¼ˆ$I(Z; X)$å¤§ï¼‰</li>
<li>ä½ç†µ$H$ï¼šå‹ç¼©ä¿¡æ¯ï¼ˆ$I(Z; X)$å°ï¼‰</li>
</ul>
<p><strong>æœ€ä¼˜ç†µ</strong>ï¼š</p>
<p>å­˜åœ¨ä¸€ä¸ªæœ€ä¼˜ç†µ$H^<em>$ï¼Œå¹³è¡¡ä¿¡æ¯ä¿ç•™å’Œå‹ç¼©ã€‚åˆå§‹åŒ–æ—¶åº”è¯¥æ¥è¿‘$H^</em>$ã€‚</p>
<h3 id="16">16. å¤šå¤´æ³¨æ„åŠ›ä¸ç†µ</h3>
<p><strong>å¤šå¤´æ³¨æ„åŠ›</strong>ï¼š</p>
<p>\begin{equation}
\text{MultiHead}(\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}) = \text{Concat}(\text{head}_1, \ldots, \text{head}_h) \boldsymbol{W}^O \tag{69}
\end{equation}</p>
<p>å…¶ä¸­ï¼š
\begin{equation}
\text{head}_i = \text{Attention}(\boldsymbol{Q}\boldsymbol{W}_i^Q, \boldsymbol{K}\boldsymbol{W}_i^K, \boldsymbol{V}\boldsymbol{W}_i^V) \tag{70}
\end{equation}</p>
<p><strong>æ¯ä¸ªå¤´çš„ç†µ</strong>ï¼š</p>
<p>ç¬¬$i$ä¸ªå¤´çš„ç†µä¸º$H_i$ã€‚æ€»çš„ä¿¡æ¯é‡å¤§çº¦æ˜¯ï¼š
\begin{equation}
H_{\text{total}} \approx \sum_{i=1}^h H_i \tag{71}
\end{equation}</p>
<p>ï¼ˆè¿‘ä¼¼ï¼Œå‡è®¾å„å¤´ç‹¬ç«‹ï¼‰</p>
<p><strong>å¤šæ ·æ€§</strong>ï¼š</p>
<p>ç†æƒ³æƒ…å†µä¸‹ï¼Œä¸åŒçš„å¤´åº”è¯¥å…³æ³¨ä¸åŒçš„æ–¹é¢ï¼Œå³ç†µåˆ†å¸ƒ${H_i}$åº”è¯¥æœ‰å¤šæ ·æ€§ã€‚</p>
<h3 id="17">17. è‡ªæ³¨æ„åŠ›çš„è°±åˆ†æ</h3>
<p><strong>è‡ªæ³¨æ„åŠ›çŸ©é˜µ</strong>ï¼š</p>
<p>å¯¹äºè‡ªæ³¨æ„åŠ›ï¼Œ$\boldsymbol{A} = \text{softmax}(\boldsymbol{Q}\boldsymbol{K}^\top / \sqrt{d})$æ˜¯ä¸€ä¸ª$n \times n$éšæœºçŸ©é˜µï¼ˆæ¯è¡Œå’Œä¸º1ï¼‰ã€‚</p>
<p><strong>è°±æ€§è´¨</strong>ï¼š</p>
<ol>
<li>æœ€å¤§ç‰¹å¾å€¼$\lambda_1 = 1$ï¼ˆå¯¹åº”ç‰¹å¾å‘é‡$\mathbf{1}$ï¼‰</li>
<li>å…¶ä»–ç‰¹å¾å€¼$|\lambda_i| &lt; 1$</li>
</ol>
<p><strong>ä¸ç†µçš„å…³ç³»</strong>ï¼š</p>
<p>å¯ä»¥è¯æ˜ï¼Œç†µä¸ç‰¹å¾å€¼åˆ†å¸ƒæœ‰å…³ï¼š
\begin{equation}
H \approx -\sum_i \lambda_i \log \lambda_i \tag{72}
\end{equation}</p>
<p>ï¼ˆè¿™æ˜¯von Neumannç†µçš„ç±»æ¯”ï¼‰</p>
<p><strong>Rankä¸ä¿¡æ¯</strong>ï¼š</p>
<p>æ³¨æ„åŠ›çŸ©é˜µçš„æœ‰æ•ˆç§©ï¼ˆeffective rankï¼‰ï¼š
\begin{equation}
\text{rank}_{\text{eff}}(\boldsymbol{A}) = \exp(H) \tag{73}
\end{equation}</p>
<p>è¿™åº¦é‡äº†æ³¨æ„åŠ›åˆ†å¸ƒçš„"æœ‰æ•ˆå®½åº¦"ã€‚</p>
<h3 id="18">18. ä½ç½®ç¼–ç çš„å½±å“</h3>
<p><strong>ç»å¯¹ä½ç½®ç¼–ç </strong>ï¼š</p>
<p>æ·»åŠ ä½ç½®ç¼–ç $\boldsymbol{p}<em ij="ij">i$åï¼š
\begin{equation}
s</em>
\end{equation}} = \langle \boldsymbol{q}_i + \boldsymbol{p}_i, \boldsymbol{k}_j + \boldsymbol{p}_j \rangle \tag{74</p>
<p><strong>å¯¹ç†µçš„å½±å“</strong>ï¼š</p>
<p>ä½ç½®ç¼–ç å¢åŠ äº†$s_{ij}$çš„å¤šæ ·æ€§ï¼Œé€šå¸¸ä¼šï¼š
- å¢åŠ ç†µ$H$ï¼ˆå¦‚æœä½ç½®ç¼–ç æ˜¯éšæœºçš„ï¼‰
- å‡å°‘ç†µ$H$ï¼ˆå¦‚æœä½ç½®ç¼–ç è¯±å¯¼äº†ç»“æ„ï¼Œå¦‚å±€éƒ¨æ€§ï¼‰</p>
<p><strong>ç›¸å¯¹ä½ç½®ç¼–ç </strong>ï¼š</p>
<p>\begin{equation}
s_{ij} = \langle \boldsymbol{q}<em i-j="i-j">i, \boldsymbol{k}_j \rangle + b</em>
\end{equation}} \tag{75</p>
<p>å…¶ä¸­$b_k$æ˜¯ç›¸å¯¹ä½ç½®åç½®ã€‚</p>
<p>è¿™å€¾å‘äºä½¿æ³¨æ„åŠ›é›†ä¸­åœ¨é™„è¿‘çš„tokensï¼Œ<strong>é™ä½ç†µ</strong>ã€‚</p>
<h3 id="19">19. æ³¨æ„åŠ›ç†µçš„å®éªŒè§‚å¯Ÿ</h3>
<p><strong>Transformerè®­ç»ƒä¸­çš„ç†µå˜åŒ–</strong>ï¼ˆç»éªŒè§‚å¯Ÿï¼‰ï¼š</p>
<ol>
<li><strong>åˆå§‹é˜¶æ®µ</strong>ï¼š$H \approx \log n$ï¼ˆæ¥è¿‘å‡åŒ€ï¼‰</li>
<li><strong>å¿«é€Ÿä¸‹é™</strong>ï¼š$H$è¿…é€Ÿä¸‹é™ï¼Œæ¨¡å‹å­¦ä¹ åˆ°åŸºæœ¬patterns</li>
<li><strong>éœ‡è¡ç¨³å®š</strong>ï¼š$H$åœ¨æŸä¸ªå€¼é™„è¿‘éœ‡è¡</li>
<li><strong>è¿‡æ‹Ÿåˆ</strong>ï¼šå¦‚æœç»§ç»­è®­ç»ƒï¼Œ$H$å¯èƒ½ç»§ç»­ä¸‹é™ï¼ˆè¿‡æ‹Ÿåˆè¿¹è±¡ï¼‰</li>
</ol>
<p><strong>å±‚é—´å·®å¼‚</strong>ï¼š</p>
<ul>
<li><strong>æµ…å±‚</strong>ï¼š$H$è¾ƒé«˜ï¼Œä¿ç•™æ›´å¤šå…¨å±€ä¿¡æ¯</li>
<li><strong>æ·±å±‚</strong>ï¼š$H$è¾ƒä½ï¼Œå…³æ³¨ç‰¹å®šçš„é‡è¦tokens</li>
</ul>
<p><strong>ä»»åŠ¡ä¾èµ–</strong>ï¼š</p>
<ul>
<li><strong>è¯­è¨€å»ºæ¨¡</strong>ï¼š$H$é€å±‚ä¸‹é™</li>
<li><strong>æœºå™¨ç¿»è¯‘</strong>ï¼šencoderçš„$H$è¾ƒé«˜ï¼Œdecoderçš„$H$è¾ƒä½</li>
</ul>
<h3 id="20">20. æ­£åˆ™åŒ–ä¸ç†µçº¦æŸ</h3>
<p><strong>ç†µæ­£åˆ™åŒ–</strong>ï¼š</p>
<p>åœ¨æŸå¤±å‡½æ•°ä¸­æ·»åŠ ç†µé¡¹ï¼š
\begin{equation}
\mathcal{L}<em _text_task="\text{task">{\text{total}} = \mathcal{L}</em>
\end{equation}}} + \lambda H(\boldsymbol{\alpha}) \tag{76</p>
<ul>
<li>$\lambda &gt; 0$ï¼šé¼“åŠ±é«˜ç†µï¼ˆå¹³æ»‘æ³¨æ„åŠ›ï¼‰</li>
<li>$\lambda &lt; 0$ï¼šé¼“åŠ±ä½ç†µï¼ˆpeakedæ³¨æ„åŠ›ï¼‰</li>
</ul>
<p><strong>æ•ˆæœ</strong>ï¼š</p>
<ul>
<li>é«˜ç†µæ­£åˆ™ï¼šé˜²æ­¢è¿‡æ‹Ÿåˆï¼Œå¢å¼ºé²æ£’æ€§</li>
<li>ä½ç†µæ­£åˆ™ï¼šåŠ é€Ÿæ”¶æ•›ï¼Œä½†å¯èƒ½è¿‡æ‹Ÿåˆ</li>
</ul>
<p><strong>ä¸Label Smoothingçš„ç±»æ¯”</strong>ï¼š</p>
<p>Label smoothingä¹Ÿæ˜¯ä¸€ç§ç†µæ­£åˆ™åŒ–ï¼Œé¼“åŠ±è¾“å‡ºåˆ†å¸ƒæœ‰æ›´é«˜çš„ç†µã€‚</p>
<h3 id="21">21. ç¨€ç–æ³¨æ„åŠ›ä¸ç†µ</h3>
<p><strong>ç¨€ç–æ³¨æ„åŠ›</strong>ï¼š</p>
<p>åªè®¡ç®—éƒ¨åˆ†attention scoresï¼š
\begin{equation}
\alpha_i = \begin{cases}
\frac{e^{s_i}}{\sum_{j \in \mathcal{N}(i)} e^{s_j}}, &amp; j \in \mathcal{N}(i) \
0, &amp; \text{otherwise}
\end{cases} \tag{77}
\end{equation}</p>
<p>å…¶ä¸­$\mathcal{N}(i)$æ˜¯$i$çš„é‚»åŸŸã€‚</p>
<p><strong>ç†µçš„å˜åŒ–</strong>ï¼š</p>
<p>ç¨€ç–åŒ–é€šå¸¸é™ä½æœ‰æ•ˆåºåˆ—é•¿åº¦$n$ï¼Œå› æ­¤æœ€å¤§ç†µå˜ä¸ºï¼š
\begin{equation}
H_{\max} = \log |\mathcal{N}(i)| &lt; \log n \tag{78}
\end{equation}</p>
<p><strong>ä¿¡æ¯æŸå¤±</strong>ï¼š</p>
<p>ç¨€ç–åŒ–ä¼šæŸå¤±ä¸€äº›ä¿¡æ¯ï¼Œä½†æ¢æ¥äº†è®¡ç®—æ•ˆç‡ã€‚</p>
<h3 id="22-vs">22. è¿ç»­vs.ç¦»æ•£æ³¨æ„åŠ›</h3>
<p><strong>ç¦»æ•£æ³¨æ„åŠ›</strong>ï¼ˆå¦‚Pointer Networkï¼‰ï¼š</p>
<p>é€‰æ‹©å•ä¸ªindexï¼š
\begin{equation}
i^* = \arg\max_i s_i \tag{79}
\end{equation}</p>
<p>ç†µä¸º0ï¼ˆç¡®å®šæ€§ï¼‰ã€‚</p>
<p><strong>Gumbel-Softmax</strong>ï¼š</p>
<p>ä»softmaxåˆ†å¸ƒä¸­é‡‡æ ·ï¼ŒåŒæ—¶ä¿æŒå¯å¾®ï¼š
\begin{equation}
\alpha_i = \frac{e^{(s_i + g_i) / \tau}}{\sum_j e^{(s_j + g_j) / \tau}} \tag{80}
\end{equation}</p>
<p>å…¶ä¸­$g_i \sim \text{Gumbel}(0, 1)$ã€‚</p>
<p>æ¸©åº¦$\tau$æ§åˆ¶ç†µï¼š
- $\tau \to 0$ï¼šæ¥è¿‘ç¦»æ•£ï¼ˆä½ç†µï¼‰
- $\tau$å¤§ï¼šæ¥è¿‘è¿ç»­ï¼ˆé«˜ç†µï¼‰</p>
<h3 id="23">23. æ³¨æ„åŠ›å¯è§†åŒ–ä¸ç†µ</h3>
<p><strong>çƒ­å›¾å¯è§†åŒ–</strong>ï¼š</p>
<p>ç»˜åˆ¶æ³¨æ„åŠ›çŸ©é˜µ$\boldsymbol{A} = [\alpha_{ij}]$ï¼Œé¢œè‰²æ·±æµ…è¡¨ç¤ºæƒé‡å¤§å°ã€‚</p>
<p><strong>ç†µçš„è§†è§‰å«ä¹‰</strong>ï¼š</p>
<ul>
<li><strong>é«˜ç†µ</strong>ï¼šçƒ­å›¾è¾ƒå‡åŒ€ï¼Œé¢œè‰²æµ…</li>
<li><strong>ä½ç†µ</strong>ï¼šçƒ­å›¾æœ‰æ˜æ˜¾çš„äº®ç‚¹ï¼Œé¢œè‰²æ·±</li>
</ul>
<p><strong>é€šè¿‡å¯è§†åŒ–è¯Šæ–­</strong>ï¼š</p>
<ol>
<li><strong>è¿‡äºå‡åŒ€</strong>ï¼ˆ$H \approx \log n$ï¼‰ï¼šæ¨¡å‹æœªå­¦åˆ°æœ‰ç”¨ä¿¡æ¯</li>
<li><strong>è¿‡äºé›†ä¸­</strong>ï¼ˆ$H \approx 0$ï¼‰ï¼šå¯èƒ½è¿‡æ‹Ÿåˆæˆ–æ¢¯åº¦æ¶ˆå¤±</li>
<li><strong>é€‚ä¸­ç†µ</strong>ï¼šç†æƒ³çŠ¶æ€</li>
</ol>
<h3 id="24-gap">24. ç†è®ºä¸å®è·µçš„Gap</h3>
<p><strong>ç†è®ºå‡è®¾</strong>ï¼š</p>
<ul>
<li>å™ªå£°ç‹¬ç«‹åŒåˆ†å¸ƒ</li>
<li>å¤§$n$æé™</li>
<li>çº¿æ€§è¿‘ä¼¼</li>
</ul>
<p><strong>å®é™…æƒ…å†µ</strong>ï¼š</p>
<ul>
<li>å™ªå£°å¯èƒ½ç›¸å…³ï¼ˆå¦‚ç³»ç»Ÿæ€§åå·®ï¼‰</li>
<li>$n$æœ‰é™ï¼ˆé€šå¸¸$n &lt; 1000$ï¼‰</li>
<li>éçº¿æ€§æ•ˆåº”</li>
</ul>
<p><strong>Gapçš„å½±å“</strong>ï¼š</p>
<p>ç†è®ºé¢„æµ‹çš„å®Œç¾é²æ£’æ€§åœ¨å®è·µä¸­å¯èƒ½ä¸æˆç«‹ï¼Œä½†<strong>å®šæ€§ç»“è®º</strong>ä»ç„¶æœ‰ç”¨ï¼š
- Softmaxæ³¨æ„åŠ›å¯¹ç‹¬ç«‹å™ªå£°æœ‰ä¸€å®šé²æ£’æ€§
- ç†µæ˜¯è®­ç»ƒåŠ¨æ€çš„é‡è¦æŒ‡æ ‡</p>
<h3 id="25">25. å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘</h3>
<p><strong>é—®é¢˜1</strong>ï¼šèƒ½å¦è®¾è®¡æ›´é²æ£’çš„æ³¨æ„åŠ›æœºåˆ¶ï¼Ÿ</p>
<p>ä¾‹å¦‚ï¼Œä½¿ç”¨å…¶ä»–å½’ä¸€åŒ–æ–¹æ³•ï¼ˆå¦‚L1å½’ä¸€åŒ–ï¼‰ï¼Ÿ</p>
<p><strong>é—®é¢˜2</strong>ï¼šæœ€ä¼˜ç†µçš„ç†è®ºè¡¨å¾</p>
<p>å¯¹äºç»™å®šä»»åŠ¡å’Œæ•°æ®ï¼Œæœ€ä¼˜çš„æ³¨æ„åŠ›ç†µæ˜¯å¤šå°‘ï¼Ÿ</p>
<p><strong>é—®é¢˜3</strong>ï¼šç†µçš„åŠ¨æ€è°ƒæ•´</p>
<p>èƒ½å¦è‡ªé€‚åº”åœ°è°ƒæ•´æ¸©åº¦å‚æ•°ï¼Œä½¿ç†µåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­è‡ªåŠ¨è¾¾åˆ°æœ€ä¼˜å€¼ï¼Ÿ</p>
<p><strong>é—®é¢˜4</strong>ï¼šå¤šæ¨¡æ€æ³¨æ„åŠ›çš„ç†µ</p>
<p>åœ¨è§†è§‰-è¯­è¨€æ¨¡å‹ä¸­ï¼Œcross-modal attentionçš„ç†µæœ‰ä½•ç‰¹ç‚¹ï¼Ÿ</p>
<p><strong>æœªæ¥æ–¹å‘</strong>ï¼š
1. è‡ªé€‚åº”æ¸©åº¦å­¦ä¹ 
2. ç†µæ„ŸçŸ¥çš„æ­£åˆ™åŒ–
3. é²æ£’æ€§çš„ç†è®ºä¿è¯
4. é«˜æ•ˆçš„ç†µè®¡ç®—æ–¹æ³•</p>
<hr />
<h2 id="_5">å‚è€ƒæ–‡çŒ®</h2>
<ol>
<li>Vaswani et al., "Attention Is All You Need", NeurIPS 2017</li>
<li>Pereyra et al., "Regularizing Neural Networks by Penalizing Confident Output Distributions", ICLR 2017</li>
<li>Jang et al., "Categorical Reparameterization with Gumbel-Softmax", ICLR 2017</li>
<li>Cordonnier et al., "On the Relationship between Self-Attention and Convolutional Layers", ICLR 2020</li>
<li>Kobayashi et al., "Attention is Not Only a Weight: Analyzing Transformers with Vector Norms", EMNLP 2020</li>
</ol>
<h2 id="_6">æ€»ç»“</h2>
<p>æœ¬æ–‡æ·±å…¥åˆ†æäº†Softmaxæ³¨æ„åŠ›çš„ä¸¤ä¸ªå…³é”®æ€§è´¨ï¼š</p>
<ol>
<li><strong>é²æ£’æ€§</strong>ï¼š</li>
<li>å¯¹ç‹¬ç«‹åŒåˆ†å¸ƒå™ªå£°æœ‰å¤©ç„¶é²æ£’æ€§</li>
<li>å™ªå£°çš„æŒ‡æ•°çŸ©è¢«çº¦æ‰</li>
<li>
<p>Lipschitzè¿ç»­æ€§ä¿è¯ç¨³å®šæ€§</p>
</li>
<li>
<p><strong>ä¿¡æ¯é‡</strong>ï¼š</p>
</li>
<li>ç†µæ˜¯ä¸ç¡®å®šæ€§å’Œä¿¡æ¯é‡çš„åº¦é‡</li>
<li>åˆå§‹åŒ–åº”ä¿è¯è¶³å¤Ÿçš„ç†µï¼ˆå¯å­¦ä¹ ä¿¡æ¯ï¼‰</li>
<li>æ¸©åº¦å‚æ•°è°ƒèŠ‚ç†µçš„èŒƒå›´</li>
</ol>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š
- Softmaxç»“æ„éšå«äº†å¹³å‡åŒ–æ•ˆåº”ï¼Œå¤©ç„¶å…·æœ‰é™å™ªèƒ½åŠ›
- ç†µæä¾›äº†ç†è§£è®­ç»ƒåŠ¨æ€çš„ä¿¡æ¯è®ºè§†è§’
- åˆé€‚çš„åˆå§‹åŒ–å’Œæ¸©åº¦é€‰æ‹©å¯¹è®­ç»ƒè‡³å…³é‡è¦</p>
<p>è¿™äº›ç†è®ºåˆ†æä¸ºTransformerç­‰attention-basedæ¨¡å‹çš„è®¾è®¡å’Œè°ƒè¯•æä¾›äº†åšå®çš„ç†è®ºåŸºç¡€ã€‚</p>
        </div>
    </div>
</body>
</html>