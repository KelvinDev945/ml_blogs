<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReLU/GeLU/Swishçš„ä¸€ä¸ªæ’ç­‰å¼</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ReLU/GeLU/Swishçš„ä¸€ä¸ªæ’ç­‰å¼</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2026-01-01 | ğŸ“„ å¤§å°: 48.7 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11233">https://spaces.ac.cn/archives/11233</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ä»Šå¤©æ°´ä¸€ç‚¹è½»æ¾çš„å†…å®¹ï¼Œå®ƒåŸºäºç¬”è€…è¿™ä¸¤å¤©æ„è¯†åˆ°çš„ä¸€ä¸ªæ’ç­‰å¼ã€‚è¿™ä¸ªæ’ç­‰å¼å®é™…ä¸Šå¾ˆç®€å•ï¼Œä½†åˆçœ‹ä¹‹ä¸‹ä¼šæœ‰ç‚¹æ„æ–™ä¹‹å¤–çš„æ„Ÿè§‰ï¼Œæ‰€ä»¥æ¥è®°å½•ä¸€ä¸‹ã€‚</p>
<h2 id="_1">åŸºæœ¬ç»“æœ</h2>
<p>æˆ‘ä»¬çŸ¥é“$\newcommand{relu}{\mathop{\text{relu}}}\relu(x) = \max(x, 0)$ï¼Œå®¹æ˜“è¯æ˜å¦‚ä¸‹æ’ç­‰å¼<br />
\begin{equation}x = \relu(x) - \relu(-x)\end{equation}<br />
å¦‚æœ$x$æ˜¯ä¸€ä¸ªå‘é‡ï¼Œé‚£ä¹ˆä¸Šå¼å°±æ›´ç›´è§‚äº†ï¼Œ$\relu(x)$æ˜¯æå–å‡º$x$çš„æ­£åˆ†é‡ï¼Œ$- \relu(-x)$æ˜¯æå–å‡º$x$çš„è´Ÿåˆ†é‡ï¼Œä¸¤è€…ç›¸åŠ å°±å¾—åˆ°åŸæœ¬çš„å‘é‡ã€‚</p>
<h2 id="_2">ä¸€èˆ¬ç»“è®º</h2>
<p>æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯<a href="/archives/7309">GeLU</a>ã€<a href="https://papers.cool/arxiv/1710.05941">Swish</a>ç­‰æ¿€æ´»å‡½æ•°æˆç«‹ç±»ä¼¼çš„æ’ç­‰å¼å—ï¼Ÿåˆçœ‹ä¹‹ä¸‹å¹¶ä¸æˆç«‹ï¼Œç„¶è€Œäº‹å®ä¸Šæ˜¯æˆç«‹çš„ï¼æˆ‘ä»¬ç”šè‡³è¿˜æœ‰æ›´ä¸€èˆ¬çš„ç»“è®ºï¼š</p>
<blockquote>
<p>è®¾$\phi(x)$æ˜¯ä»»æ„å¥‡å‡½æ•°ï¼Œ$f(x)=\frac{1}{2}(\phi(x) + 1)x$ï¼Œé‚£ä¹ˆæ’æˆç«‹ \begin{equation}x = f(x) - f(-x)\end{equation} </p>
</blockquote>
<p>è¯æ˜è¯¥ç»“è®ºä¹Ÿæ˜¯ä¸€ä»¶å¾ˆè½»æ¾çš„äº‹ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚å¯¹äºSwishæ¥è¯´æˆ‘ä»¬æœ‰$\phi(x) = \tanh(\frac{x}{2})$ï¼Œå¯¹äºGeLUæ¥è¯´åˆ™æœ‰$\phi(x)=\mathop{\text{erf}}(\frac{x}{\sqrt{2}})$ï¼Œå®ƒä»¬éƒ½æ˜¯å¥‡å‡½æ•°ï¼Œæ‰€ä»¥æˆç«‹åŒæ ·çš„æ’ç­‰å¼ã€‚</p>
<h2 id="_3">æ„ä¹‰æ€è€ƒ</h2>
<p>ä¸Šè¿°æ’ç­‰å¼å†™æˆçŸ©é˜µå½¢å¼æ˜¯<br />
\begin{equation}x = f(x) - f(-x) = f(x[1, -1])\begin{bmatrix}1 \\\ -1\end{bmatrix}\end{equation}<br />
è¿™è¡¨æ˜ä»¥ReLUã€GeLUã€Swishç­‰ä¸ºæ¿€æ´»å‡½æ•°æ—¶ï¼Œä¸¤å±‚ç¥ç»ç½‘ç»œæœ‰é€€åŒ–ä¸ºä¸€å±‚çš„èƒ½åŠ›ï¼Œè¿™æ„å‘³ç€å®ƒä»¬å¯ä»¥è‡ªé€‚åº”åœ°è°ƒèŠ‚æ¨¡å‹çš„å®é™…æ·±åº¦ï¼Œè¿™ä¸ResNetçš„å·¥ä½œåŸç†å¼‚æ›²åŒå·¥ï¼Œè¿™ä¹Ÿè®¸æ˜¯è¿™äº›æ¿€æ´»å‡½æ•°ä¸ºä»€ä¹ˆæ¯”ä¼ ç»Ÿçš„Tanhã€Sigmoidç­‰æ›´å¥½çš„åŸå› ä¹‹ä¸€ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11233">https://spaces.ac.cn/archives/11233</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Aug. 16, 2025). ã€ŠReLU/GeLU/Swishçš„ä¸€ä¸ªæ’ç­‰å¼ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11233">https://spaces.ac.cn/archives/11233</a></p>
<p>@online{kexuefm-11233,<br />
title={ReLU/GeLU/Swishçš„ä¸€ä¸ªæ’ç­‰å¼},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Aug},<br />
url={\url{https://spaces.ac.cn/archives/11233}},<br />
} </p>
<hr />
<h2 id="_4">è¯¦ç»†æ•°å­¦æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚æä¾›ReLU/GeLU/Swishæ¿€æ´»å‡½æ•°æ’ç­‰å¼çš„å®Œæ•´æ•°å­¦æ¨å¯¼ï¼ŒåŒ…æ‹¬åŸºæœ¬è¯æ˜ã€ä¸€èˆ¬åŒ–æ¨å¹¿ã€å‡ ä½•æ„ä¹‰åˆ†æå’Œå®è·µåº”ç”¨ã€‚</p>
<h3 id="1-relu">1. ReLUçš„åŸºæœ¬æ’ç­‰å¼</h3>
<h4 id="11">1.1 å®šä¹‰ä¸ç›´æ¥è¯æ˜</h4>
<p>ReLUï¼ˆRectified Linear Unitï¼‰å®šä¹‰ä¸ºï¼š
\begin{equation}\text{relu}(x) = \max(x, 0) = \begin{cases}
x &amp; \text{if } x \geq 0\
0 &amp; \text{if } x &lt; 0
\end{cases}\tag{1}\end{equation}</p>
<p><strong>åŸºæœ¬æ’ç­‰å¼</strong>ï¼š
\begin{equation}x = \text{relu}(x) - \text{relu}(-x)\tag{2}\end{equation}</p>
<p><strong>ç›´æ¥éªŒè¯</strong>ï¼š</p>
<p><strong>æƒ…å†µ1</strong>ï¼šå½“$x &gt; 0$æ—¶
\begin{align}
\text{relu}(x) &amp;= x\tag{3}\
\text{relu}(-x) &amp;= \max(-x, 0) = 0\tag{4}\
\text{relu}(x) - \text{relu}(-x) &amp;= x - 0 = x\quad\checkmark\tag{5}
\end{align}</p>
<p><strong>æƒ…å†µ2</strong>ï¼šå½“$x &lt; 0$æ—¶
\begin{align}
\text{relu}(x) &amp;= 0\tag{6}\
\text{relu}(-x) &amp;= \max(-x, 0) = -x\tag{7}\
\text{relu}(x) - \text{relu}(-x) &amp;= 0 - (-x) = x\quad\checkmark\tag{8}
\end{align}</p>
<p><strong>æƒ…å†µ3</strong>ï¼šå½“$x = 0$æ—¶
\begin{align}
\text{relu}(0) &amp;= 0\tag{9}\
\text{relu}(0) - \text{relu}(0) &amp;= 0\quad\checkmark\tag{10}
\end{align}</p>
<h4 id="12">1.2 å‘é‡å½¢å¼çš„ç†è§£</h4>
<p>å¯¹äºå‘é‡$\boldsymbol{x}\in\mathbb{R}^n$ï¼Œæ’ç­‰å¼é€åˆ†é‡æˆç«‹ï¼š
\begin{equation}\boldsymbol{x} = \text{relu}(\boldsymbol{x}) - \text{relu}(-\boldsymbol{x})\tag{11}\end{equation}</p>
<p><strong>å‡ ä½•æ„ä¹‰</strong>ï¼š
- $\text{relu}(\boldsymbol{x})$ï¼šæå–å‘é‡çš„æ­£åˆ†é‡ï¼Œè´Ÿåˆ†é‡ç½®é›¶
- $-\text{relu}(-\boldsymbol{x})$ï¼šæå–å‘é‡çš„è´Ÿåˆ†é‡ï¼Œæ­£åˆ†é‡ç½®é›¶
- ä¸¤è€…ç›¸åŠ æ¢å¤åŸå‘é‡</p>
<p><strong>ç¤ºä¾‹</strong>ï¼šè®¾$\boldsymbol{x} = [2, -3, 1, -1]^{\top}$
\begin{align}
\text{relu}(\boldsymbol{x}) &amp;= [2, 0, 1, 0]^{\top}\tag{12}\
-\text{relu}(-\boldsymbol{x}) &amp;= -[0, 3, 0, 1]^{\top} = [0, -3, 0, -1]^{\top}\tag{13}\
\text{relu}(\boldsymbol{x}) - \text{relu}(-\boldsymbol{x}) &amp;= [2, -3, 1, -1]^{\top} = \boldsymbol{x}\tag{14}
\end{align}</p>
<h4 id="13">1.3 ä¸ç»å¯¹å€¼çš„å…³ç³»</h4>
<p>ä»æ’ç­‰å¼å¯ä»¥å¯¼å‡ºï¼š
\begin{equation}|x| = \text{relu}(x) + \text{relu}(-x)\tag{15}\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼š
\begin{align}
\text{relu}(x) + \text{relu}(-x) &amp;= \max(x,0) + \max(-x,0)\tag{16}\
&amp;= \begin{cases}
x + 0 = x &amp; \text{if } x \geq 0\
0 + (-x) = -x &amp; \text{if } x &lt; 0
\end{cases}\tag{17}\
&amp;= |x|\tag{18}
\end{align}</p>
<p>ç»“åˆæ’ç­‰å¼(2)å’Œ(15)ï¼Œæˆ‘ä»¬æœ‰ï¼š
\begin{align}
x &amp;= \text{relu}(x) - \text{relu}(-x)\tag{19}\
|x| &amp;= \text{relu}(x) + \text{relu}(-x)\tag{20}
\end{align}</p>
<p>è¿™ä¸¤ä¸ªå¼å­å¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªçº¿æ€§ç³»ç»Ÿï¼Œè§£å¾—ï¼š
\begin{align}
\text{relu}(x) &amp;= \frac{x + |x|}{2}\tag{21}\
\text{relu}(-x) &amp;= \frac{|x| - x}{2}\tag{22}
\end{align}</p>
<p>è¿™ç»™å‡ºäº†ReLUçš„å¦ä¸€ç§ç­‰ä»·è¡¨è¾¾å½¢å¼ã€‚</p>
<h3 id="2">2. ä¸€èˆ¬å¥‡å‡½æ•°çš„æ’ç­‰å¼</h3>
<h4 id="21">2.1 ä¸€èˆ¬æ€§å®šç†</h4>
<p><strong>å®šç†</strong>ï¼šè®¾$\phi(x)$æ˜¯ä»»æ„å¥‡å‡½æ•°ï¼ˆå³$\phi(-x) = -\phi(x)$ï¼‰ï¼Œå®šä¹‰ï¼š
\begin{equation}f(x) = \frac{1}{2}(\phi(x) + 1)x\tag{23}\end{equation}</p>
<p>åˆ™æ’æˆç«‹ï¼š
\begin{equation}x = f(x) - f(-x)\tag{24}\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼š
\begin{align}
f(x) - f(-x) &amp;= \frac{1}{2}(\phi(x) + 1)x - \frac{1}{2}(\phi(-x) + 1)(-x)\tag{25}\
&amp;= \frac{1}{2}(\phi(x) + 1)x - \frac{1}{2}(-\phi(x) + 1)(-x)\tag{26}\
&amp;= \frac{1}{2}(\phi(x) + 1)x + \frac{1}{2}(-\phi(x) + 1)x\tag{27}\
&amp;= \frac{1}{2}[(\phi(x) + 1) + (-\phi(x) + 1)]x\tag{28}\
&amp;= \frac{1}{2}\cdot 2x\tag{29}\
&amp;= x\tag{30}
\end{align}</p>
<p><strong>å…³é”®æ­¥éª¤</strong>ï¼š
1. ä»£å…¥$f$çš„å®šä¹‰ï¼ˆå¼25ï¼‰
2. ä½¿ç”¨å¥‡å‡½æ•°æ€§è´¨$\phi(-x) = -\phi(x)$ï¼ˆå¼26ï¼‰
3. å±•å¼€å¹¶åˆå¹¶åŒç±»é¡¹ï¼ˆå¼27-29ï¼‰
4. åŒ–ç®€å¾—åˆ°$x$ï¼ˆå¼30ï¼‰</p>
<h4 id="22-relu">2.2 ReLUä½œä¸ºç‰¹æ®Šæƒ…å†µ</h4>
<p>å¯¹äºReLUï¼Œæˆ‘ä»¬å¯ä»¥å®šä¹‰ï¼š
\begin{equation}\phi(x) = \frac{2\max(x,0)}{x} - 1 = \begin{cases}
1 &amp; \text{if } x &gt; 0\
-1 &amp; \text{if } x &lt; 0\
\text{undefined} &amp; \text{if } x = 0
\end{cases}\tag{31}\end{equation}</p>
<p>éªŒè¯$\phi$æ˜¯å¥‡å‡½æ•°ï¼š
\begin{equation}\phi(-x) = \frac{2\max(-x,0)}{-x} - 1 = \begin{cases}
-1 &amp; \text{if } x &gt; 0\
1 &amp; \text{if } x &lt; 0
\end{cases} = -\phi(x)\tag{32}\end{equation}</p>
<p>æ­¤æ—¶ï¼š
\begin{align}
f(x) &amp;= \frac{1}{2}(\phi(x) + 1)x\tag{33}\
&amp;= \frac{1}{2}\left(\frac{2\max(x,0)}{x} - 1 + 1\right)x\tag{34}\
&amp;= \frac{1}{2} \cdot \frac{2\max(x,0)}{x} \cdot x\tag{35}\
&amp;= \max(x, 0) = \text{relu}(x)\tag{36}
\end{align}</p>
<h3 id="3-gelu">3. GeLUçš„æ’ç­‰å¼</h3>
<h4 id="31-gelu">3.1 GeLUå®šä¹‰</h4>
<p>GeLUï¼ˆGaussian Error Linear Unitï¼‰å®šä¹‰ä¸ºï¼š
\begin{equation}\text{gelu}(x) = x\cdot\Phi(x)\tag{37}\end{equation}</p>
<p>å…¶ä¸­$\Phi(x)$æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„ç´¯ç§¯åˆ†å¸ƒå‡½æ•°ï¼š
\begin{equation}\Phi(x) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^x e^{-t^2/2}dt\tag{38}\end{equation}</p>
<p><strong>æ€§è´¨</strong>ï¼š$\Phi$æ˜¯å…³äºåŸç‚¹å¯¹ç§°çš„ï¼Œå³ï¼š
\begin{equation}\Phi(-x) = 1 - \Phi(x)\tag{39}\end{equation}</p>
<h4 id="32">3.2 å¯¹åº”çš„å¥‡å‡½æ•°</h4>
<p>å¯¹äºGeLUï¼Œå®šä¹‰ï¼š
\begin{equation}\phi(x) = 2\Phi(x) - 1 = \text{erf}\left(\frac{x}{\sqrt{2}}\right)\tag{40}\end{equation}</p>
<p>å…¶ä¸­$\text{erf}$æ˜¯è¯¯å·®å‡½æ•°ï¼š
\begin{equation}\text{erf}(x) = \frac{2}{\sqrt{\pi}}\int_0^x e^{-t^2}dt\tag{41}\end{equation}</p>
<p><strong>éªŒè¯å¥‡å‡½æ•°æ€§è´¨</strong>ï¼š
\begin{align}
\phi(-x) &amp;= 2\Phi(-x) - 1\tag{42}\
&amp;= 2(1 - \Phi(x)) - 1\tag{43}\
&amp;= 2 - 2\Phi(x) - 1\tag{44}\
&amp;= 1 - 2\Phi(x)\tag{45}\
&amp;= -(2\Phi(x) - 1)\tag{46}\
&amp;= -\phi(x)\quad\checkmark\tag{47}
\end{align}</p>
<h4 id="33">3.3 æ’ç­‰å¼éªŒè¯</h4>
<p>æ ¹æ®ä¸€èˆ¬æ€§å®šç†ï¼š
\begin{align}
f(x) &amp;= \frac{1}{2}(\phi(x) + 1)x\tag{48}\
&amp;= \frac{1}{2}(2\Phi(x) - 1 + 1)x\tag{49}\
&amp;= \frac{1}{2}\cdot 2\Phi(x)\cdot x\tag{50}\
&amp;= x\Phi(x)\tag{51}\
&amp;= \text{gelu}(x)\tag{52}
\end{align}</p>
<p>å› æ­¤ï¼ŒGeLUæ»¡è¶³ï¼š
\begin{equation}\text{gelu}(x) - \text{gelu}(-x) = x\tag{53}\end{equation}</p>
<p><strong>æ•°å€¼éªŒè¯</strong>ï¼šè®¾$x = 1$
\begin{align}
\Phi(1) &amp;\approx 0.841\tag{54}\
\text{gelu}(1) &amp;= 1 \times 0.841 = 0.841\tag{55}\
\Phi(-1) &amp;= 1 - 0.841 = 0.159\tag{56}\
\text{gelu}(-1) &amp;= (-1) \times 0.159 = -0.159\tag{57}\
\text{gelu}(1) - \text{gelu}(-1) &amp;= 0.841 - (-0.159) = 1.000\quad\checkmark\tag{58}
\end{align}</p>
<h3 id="4-swish">4. Swishçš„æ’ç­‰å¼</h3>
<h4 id="41-swish">4.1 Swishå®šä¹‰</h4>
<p>Swishæ¿€æ´»å‡½æ•°å®šä¹‰ä¸ºï¼š
\begin{equation}\text{swish}(x) = x\cdot\sigma(x)\tag{59}\end{equation}</p>
<p>å…¶ä¸­$\sigma(x)$æ˜¯sigmoidå‡½æ•°ï¼š
\begin{equation}\sigma(x) = \frac{1}{1 + e^{-x}} = \frac{e^x}{1 + e^x}\tag{60}\end{equation}</p>
<p><strong>Sigmoidçš„å¯¹ç§°æ€§</strong>ï¼š
\begin{equation}\sigma(-x) = \frac{1}{1 + e^x} = 1 - \sigma(x)\tag{61}\end{equation}</p>
<h4 id="42">4.2 å¯¹åº”çš„å¥‡å‡½æ•°</h4>
<p>å®šä¹‰ï¼š
\begin{equation}\phi(x) = 2\sigma(x) - 1 = \frac{2}{1 + e^{-x}} - 1 = \frac{1 - e^{-x}}{1 + e^{-x}} = \tanh\left(\frac{x}{2}\right)\tag{62}\end{equation}</p>
<p><strong>éªŒè¯å¥‡å‡½æ•°æ€§è´¨</strong>ï¼š
\begin{align}
\phi(-x) &amp;= 2\sigma(-x) - 1\tag{63}\
&amp;= 2(1 - \sigma(x)) - 1\tag{64}\
&amp;= 1 - 2\sigma(x)\tag{65}\
&amp;= -(2\sigma(x) - 1)\tag{66}\
&amp;= -\phi(x)\quad\checkmark\tag{67}
\end{align}</p>
<h4 id="43">4.3 æ’ç­‰å¼éªŒè¯</h4>
<p>\begin{align}
f(x) &amp;= \frac{1}{2}(\phi(x) + 1)x\tag{68}\
&amp;= \frac{1}{2}(2\sigma(x) - 1 + 1)x\tag{69}\
&amp;= \frac{1}{2}\cdot 2\sigma(x)\cdot x\tag{70}\
&amp;= x\sigma(x)\tag{71}\
&amp;= \text{swish}(x)\tag{72}
\end{align}</p>
<p>å› æ­¤ï¼š
\begin{equation}\text{swish}(x) - \text{swish}(-x) = x\tag{73}\end{equation}</p>
<p><strong>æ•°å€¼éªŒè¯</strong>ï¼šè®¾$x = 2$
\begin{align}
\sigma(2) &amp;= \frac{1}{1 + e^{-2}} \approx 0.881\tag{74}\
\text{swish}(2) &amp;= 2 \times 0.881 = 1.762\tag{75}\
\sigma(-2) &amp;= 1 - 0.881 = 0.119\tag{76}\
\text{swish}(-2) &amp;= (-2) \times 0.119 = -0.238\tag{77}\
\text{swish}(2) - \text{swish}(-2) &amp;= 1.762 - (-0.238) = 2.000\quad\checkmark\tag{78}
\end{align}</p>
<h3 id="5">5. çŸ©é˜µå½¢å¼ä¸ç¥ç»ç½‘ç»œæ„ä¹‰</h3>
<h4 id="51">5.1 çŸ©é˜µè¡¨è¾¾</h4>
<p>å¯¹äºå‘é‡$\boldsymbol{x}\in\mathbb{R}^n$ï¼Œæ’ç­‰å¼å¯ä»¥å†™æˆçŸ©é˜µå½¢å¼ï¼š
\begin{equation}\boldsymbol{x} = f(\boldsymbol{x}) - f(-\boldsymbol{x})\tag{79}\end{equation}</p>
<p>å¼•å…¥æ‹¼æ¥å‘é‡$\boldsymbol{z} = [\boldsymbol{x}, -\boldsymbol{x}]^{\top}\in\mathbb{R}^{2n}$ï¼Œåˆ™ï¼š
\begin{equation}\boldsymbol{x} = f(\boldsymbol{z})\begin{bmatrix}1\-1\end{bmatrix}\tag{80}\end{equation}</p>
<p>æ›´ä¸€èˆ¬åœ°ï¼Œå¯ä»¥å†™æˆï¼š
\begin{equation}\boldsymbol{x} = f(\boldsymbol{x}[1, -1])\begin{bmatrix}1\-1\end{bmatrix}\tag{81}\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{x}[1, -1]$è¡¨ç¤ºå°†$\boldsymbol{x}$å¤åˆ¶ä¸¤ä»½ï¼Œç¬¬äºŒä»½å–è´Ÿã€‚</p>
<h4 id="52">5.2 ä¸¤å±‚ç½‘ç»œçš„é€€åŒ–èƒ½åŠ›</h4>
<p>è€ƒè™‘ä¸¤å±‚ç¥ç»ç½‘ç»œï¼š
\begin{equation}\boldsymbol{y} = f\left(f(\boldsymbol{x}\boldsymbol{W}_1)\boldsymbol{W}_2\right)\tag{82}\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{W}_1\in\mathbb{R}^{n\times 2m}$ï¼Œ$\boldsymbol{W}_2\in\mathbb{R}^{2m\times k}$ã€‚</p>
<p><strong>åˆ†è§£æƒé‡çŸ©é˜µ</strong>ï¼š
\begin{equation}\boldsymbol{W}_1 = [\boldsymbol{W}_1^{(1)}, \boldsymbol{W}_1^{(2)}],\quad \boldsymbol{W}_2 = \begin{bmatrix}\boldsymbol{W}_2^{(1)}\\\boldsymbol{W}_2^{(2)}\end{bmatrix}\tag{83}\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{W}_1^{(1)}, \boldsymbol{W}_1^{(2)}\in\mathbb{R}^{n\times m}$ï¼Œ$\boldsymbol{W}_2^{(1)}, \boldsymbol{W}_2^{(2)}\in\mathbb{R}^{m\times k}$ã€‚</p>
<p><strong>ç‰¹æ®Šé…ç½®</strong>ï¼šå¦‚æœè®¾ç½®$\boldsymbol{W}_1^{(2)} = -\boldsymbol{W}_1^{(1)}$ä¸”$\boldsymbol{W}_2^{(2)} = -\boldsymbol{W}_2^{(1)}$ï¼Œåˆ™ï¼š
\begin{align}
\boldsymbol{x}\boldsymbol{W}_1 &amp;= [\boldsymbol{x}\boldsymbol{W}_1^{(1)}, -\boldsymbol{x}\boldsymbol{W}_1^{(1)}]\tag{84}\
f(\boldsymbol{x}\boldsymbol{W}_1)\boldsymbol{W}_2 &amp;= f(\boldsymbol{x}\boldsymbol{W}_1^{(1)})\boldsymbol{W}_2^{(1)} + f(-\boldsymbol{x}\boldsymbol{W}_1^{(1)})(-\boldsymbol{W}_2^{(1)})\tag{85}\
&amp;= f(\boldsymbol{x}\boldsymbol{W}_1^{(1)})\boldsymbol{W}_2^{(1)} - f(-\boldsymbol{x}\boldsymbol{W}_1^{(1)})\boldsymbol{W}_2^{(1)}\tag{86}\
&amp;= [f(\boldsymbol{x}\boldsymbol{W}_1^{(1)}) - f(-\boldsymbol{x}\boldsymbol{W}_1^{(1)})]\boldsymbol{W}_2^{(1)}\tag{87}\
&amp;= \boldsymbol{x}\boldsymbol{W}_1^{(1)}\boldsymbol{W}_2^{(1)}\tag{88}
\end{align}</p>
<p>è¿™æ„å‘³ç€ä¸¤å±‚ç½‘ç»œé€€åŒ–ä¸ºï¼š
\begin{equation}f\left(f(\boldsymbol{x}\boldsymbol{W}_1)\boldsymbol{W}_2\right) = f(\boldsymbol{x}\boldsymbol{W}_1^{(1)}\boldsymbol{W}_2^{(1)})\tag{89}\end{equation}</p>
<p>å³<strong>ä¸¤å±‚ç½‘ç»œå¯ä»¥é€€åŒ–ä¸ºä¸€å±‚ç½‘ç»œ</strong>ï¼</p>
<h4 id="53">5.3 æ·±åº¦è‡ªé€‚åº”çš„èƒ½åŠ›</h4>
<p>è¿™ä¸ªæ’ç­‰å¼èµ‹äºˆäº†ç½‘ç»œ<strong>è‡ªé€‚åº”è°ƒèŠ‚æ·±åº¦</strong>çš„èƒ½åŠ›ï¼š</p>
<ol>
<li><strong>å¢åŠ æ·±åº¦</strong>ï¼šé€šè¿‡å­¦ä¹ ä½¿$\boldsymbol{W}_1^{(2)} \neq -\boldsymbol{W}_1^{(1)}$ï¼Œç½‘ç»œå¯ä»¥å¢åŠ æœ‰æ•ˆæ·±åº¦</li>
<li><strong>å‡å°‘æ·±åº¦</strong>ï¼šé€šè¿‡å­¦ä¹ ä½¿$\boldsymbol{W}_1^{(2)} \approx -\boldsymbol{W}_1^{(1)}$å’Œ$\boldsymbol{W}_2^{(2)} \approx -\boldsymbol{W}_2^{(1)}$ï¼Œç½‘ç»œå¯ä»¥å‡å°‘æ·±åº¦</li>
<li><strong>çµæ´»æ€§</strong>ï¼šç½‘ç»œåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¯ä»¥æ ¹æ®éœ€è¦åŠ¨æ€è°ƒæ•´å®é™…æ·±åº¦</li>
</ol>
<p>è¿™ä¸<strong>ResNet</strong>çš„æœºåˆ¶ç±»ä¼¼ï¼šResNeté€šè¿‡æ®‹å·®è¿æ¥$\boldsymbol{y} = \boldsymbol{x} + F(\boldsymbol{x})$ï¼Œå…è®¸ç½‘ç»œå­¦ä¹ æ’ç­‰æ˜ å°„ï¼ˆ$F(\boldsymbol{x}) = 0$ï¼‰ï¼Œä»è€Œè‡ªé€‚åº”æ·±åº¦ã€‚</p>
<h3 id="6">6. ä¸ä¼ ç»Ÿæ¿€æ´»å‡½æ•°çš„å¯¹æ¯”</h3>
<h4 id="61-sigmoidtanh">6.1 Sigmoidå’ŒTanhçš„éæ’ç­‰æ€§</h4>
<p><strong>Sigmoid</strong>ï¼š
\begin{equation}\sigma(x) = \frac{1}{1 + e^{-x}}\tag{90}\end{equation}</p>
<p>éªŒè¯æ’ç­‰å¼æ˜¯å¦æˆç«‹ï¼š
\begin{align}
\sigma(x) - \sigma(-x) &amp;= \frac{1}{1 + e^{-x}} - \frac{1}{1 + e^x}\tag{91}\
&amp;= \frac{(1 + e^x) - (1 + e^{-x})}{(1 + e^{-x})(1 + e^x)}\tag{92}\
&amp;= \frac{e^x - e^{-x}}{(1 + e^{-x})(1 + e^x)}\tag{93}\
&amp;= \frac{e^x - e^{-x}}{1 + e^x + e^{-x} + 1}\tag{94}\
&amp;= \frac{e^x - e^{-x}}{2 + e^x + e^{-x}}\tag{95}\
&amp;\neq x\tag{96}
\end{align}</p>
<p><strong>Tanh</strong>ï¼š
\begin{equation}\tanh(x) = \frac{e^x - e^{-x}}{e^x + e^{-x}}\tag{97}\end{equation}</p>
<p>éªŒè¯ï¼š
\begin{align}
\tanh(x) - \tanh(-x) &amp;= \frac{e^x - e^{-x}}{e^x + e^{-x}} - \frac{e^{-x} - e^x}{e^{-x} + e^x}\tag{98}\
&amp;= \frac{e^x - e^{-x}}{e^x + e^{-x}} + \frac{e^x - e^{-x}}{e^x + e^{-x}}\tag{99}\
&amp;= \frac{2(e^x - e^{-x})}{e^x + e^{-x}}\tag{100}\
&amp;= 2\tanh(x)\tag{101}\
&amp;\neq x\tag{102}
\end{align}</p>
<h4 id="62-relugeluswish">6.2 ä¸ºä»€ä¹ˆReLU/GeLU/Swishæ›´ä¼˜</h4>
<p>æ»¡è¶³æ’ç­‰å¼$f(x) - f(-x) = x$çš„æ¿€æ´»å‡½æ•°å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ol>
<li><strong>æ’ç­‰æ˜ å°„èƒ½åŠ›</strong>ï¼šç½‘ç»œå¯ä»¥å­¦ä¹ æ’ç­‰æ˜ å°„ï¼Œé™ä½è®­ç»ƒéš¾åº¦</li>
<li><strong>æ·±åº¦è‡ªé€‚åº”</strong>ï¼šç½‘ç»œå¯ä»¥è‡ªé€‚åº”è°ƒèŠ‚æœ‰æ•ˆæ·±åº¦</li>
<li><strong>æ¢¯åº¦æµåŠ¨</strong>ï¼šæ’ç­‰è·¯å¾„æä¾›äº†æ¢¯åº¦çš„ç›´æ¥é€šé“ï¼Œç¼“è§£æ¢¯åº¦æ¶ˆå¤±</li>
<li><strong>è¡¨è¾¾èƒ½åŠ›</strong>ï¼šä¿ç•™äº†éçº¿æ€§çš„åŒæ—¶æä¾›äº†çº¿æ€§æ·å¾„</li>
</ol>
<p>è€ŒSigmoidå’ŒTanhä¸æ»¡è¶³æ­¤æ’ç­‰å¼ï¼Œç¼ºä¹è¿™äº›ä¼˜åŠ¿ï¼Œè¿™å¯èƒ½æ˜¯ReLU/GeLU/Swishç­‰ç°ä»£æ¿€æ´»å‡½æ•°æ›´å—æ¬¢è¿çš„åŸå› ä¹‹ä¸€ã€‚</p>
<h3 id="7">7. æ¢¯åº¦åˆ†æ</h3>
<h4 id="71-relu">7.1 ReLUçš„æ¢¯åº¦</h4>
<p>\begin{equation}\frac{d}{dx}\text{relu}(x) = \begin{cases}
1 &amp; \text{if } x &gt; 0\
0 &amp; \text{if } x &lt; 0\
\text{undefined} &amp; \text{if } x = 0
\end{cases}\tag{103}\end{equation}</p>
<p>æ’ç­‰å¼çš„æ¢¯åº¦ï¼š
\begin{align}
\frac{d}{dx}[relu(x) - relu(-x)] &amp;= \frac{d}{dx}relu(x) - \frac{d}{dx}relu(-x)\tag{104}\
&amp;= \frac{d}{dx}relu(x) + \frac{d}{dx}relu(-x)\tag{105}\
&amp;= \begin{cases}
1 + 0 = 1 &amp; \text{if } x &gt; 0\
0 + 1 = 1 &amp; \text{if } x &lt; 0
\end{cases}\tag{106}\
&amp;= 1\quad\text{(almost everywhere)}\tag{107}
\end{align}</p>
<h4 id="72-gelu">7.2 GeLUçš„æ¢¯åº¦</h4>
<p>\begin{equation}\frac{d}{dx}\text{gelu}(x) = \Phi(x) + x\phi(x)\tag{108}\end{equation}</p>
<p>å…¶ä¸­$\phi(x) = \frac{1}{\sqrt{2\pi}}e^{-x^2/2}$æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„æ¦‚ç‡å¯†åº¦å‡½æ•°ã€‚</p>
<p>æ’ç­‰å¼çš„æ¢¯åº¦ï¼š
\begin{align}
\frac{d}{dx}[\text{gelu}(x) - \text{gelu}(-x)] &amp;= \Phi(x) + x\phi(x) - [\Phi(-x) - x\phi(-x)]\tag{109}\
&amp;= \Phi(x) + x\phi(x) - (1 - \Phi(x)) - x\phi(x)\tag{110}\
&amp;= 2\Phi(x) - 1 + 0\tag{111}\
&amp;\to 1\quad\text{as }|x|\to\infty\tag{112}
\end{align}</p>
<h4 id="73-swish">7.3 Swishçš„æ¢¯åº¦</h4>
<p>\begin{equation}\frac{d}{dx}\text{swish}(x) = \sigma(x) + x\sigma(x)(1 - \sigma(x))\tag{113}\end{equation}</p>
<p>ç®€åŒ–ä¸ºï¼š
\begin{equation}\frac{d}{dx}\text{swish}(x) = \sigma(x)[1 + x(1 - \sigma(x))]\tag{114}\end{equation}</p>
<p>æ’ç­‰å¼çš„æ¢¯åº¦åˆ†æç±»ä¼¼GeLUï¼Œåœ¨$|x|$è¾ƒå¤§æ—¶è¶‹è¿‘äº1ã€‚</p>
<h3 id="8">8. æ•°å€¼å®éªŒ</h3>
<h4 id="81-python">8.1 Pythonå®ç°</h4>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">relu</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">maximum</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gelu</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="kn">import</span> <span class="n">norm</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">norm</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">swish</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">))</span>

<span class="c1"># éªŒè¯æ’ç­‰å¼</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># ReLU</span>
<span class="n">y_relu</span> <span class="o">=</span> <span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">relu</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;ReLUæ’ç­‰å¼è¯¯å·®: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_relu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># GeLU</span>
<span class="n">y_gelu</span> <span class="o">=</span> <span class="n">gelu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">gelu</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;GeLUæ’ç­‰å¼è¯¯å·®: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_gelu</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Swish</span>
<span class="n">y_swish</span> <span class="o">=</span> <span class="n">swish</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">swish</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Swishæ’ç­‰å¼è¯¯å·®: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y_swish</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">))</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h4 id="82">8.2 å¯è§†åŒ–</h4>
<p>åˆ›å»ºå¯è§†åŒ–å±•ç¤ºæ’ç­‰å¼ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">func</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span>
                          <span class="p">[</span><span class="s1">&#39;ReLU&#39;</span><span class="p">,</span> <span class="s1">&#39;GeLU&#39;</span><span class="p">,</span> <span class="s1">&#39;Swish&#39;</span><span class="p">],</span>
                          <span class="p">[</span><span class="n">relu</span><span class="p">,</span> <span class="n">gelu</span><span class="p">,</span> <span class="n">swish</span><span class="p">]):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">(x)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">(-x)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">func</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;k--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">(x) - </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">(-x)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;r:&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;x (æ’ç­‰)&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s1">æ’ç­‰å¼éªŒè¯&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;activation_identity.png&#39;</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
</code></pre></div>

<h3 id="9">9. ç†è®ºæ¨å¹¿</h3>
<h4 id="91">9.1 æ›´ä¸€èˆ¬çš„å½¢å¼</h4>
<p>å¯¹äºæ›´ä¸€èˆ¬çš„æ¿€æ´»å‡½æ•°æ—ï¼š
\begin{equation}f_{\alpha}(x) = x\cdot g_{\alpha}(x)\tag{115}\end{equation}</p>
<p>å…¶ä¸­$g_{\alpha}(x)$æ»¡è¶³ï¼š
\begin{equation}g_{\alpha}(x) + g_{\alpha}(-x) = 1\tag{116}\end{equation}</p>
<p>åˆ™æ’æœ‰ï¼š
\begin{equation}f_{\alpha}(x) - f_{\alpha}(-x) = x\tag{117}\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼š
\begin{align}
f_{\alpha}(x) - f_{\alpha}(-x) &amp;= xg_{\alpha}(x) - (-x)g_{\alpha}(-x)\tag{118}\
&amp;= xg_{\alpha}(x) + xg_{\alpha}(-x)\tag{119}\
&amp;= x[g_{\alpha}(x) + g_{\alpha}(-x)]\tag{120}\
&amp;= x\cdot 1 = x\tag{121}
\end{align}</p>
<h4 id="92">9.2 å‚æ•°åŒ–æ¿€æ´»å‡½æ•°</h4>
<p>å¯¹äºå¸¦å‚æ•°çš„æ¿€æ´»å‡½æ•°ï¼Œæ’ç­‰å¼æä¾›äº†å‚æ•°åˆå§‹åŒ–çš„çº¦æŸã€‚ä¾‹å¦‚ï¼Œå‚æ•°åŒ–Swishï¼š
\begin{equation}\text{swish}_{\beta}(x) = x\cdot\sigma(\beta x)\tag{122}\end{equation}</p>
<p>è¦æ»¡è¶³æ’ç­‰å¼ï¼Œéœ€è¦ï¼š
\begin{equation}\sigma(\beta x) + \sigma(-\beta x) = 1\tag{123}\end{equation}</p>
<p>è¿™å¯¹ä»»æ„$\beta$éƒ½æˆç«‹ï¼Œå› ä¸ºsigmoidçš„å¯¹ç§°æ€§ã€‚</p>
<h3 id="10">10. å®è·µå»ºè®®</h3>
<h4 id="101">10.1 ç½‘ç»œè®¾è®¡</h4>
<p>åœ¨è®¾è®¡ç½‘ç»œæ—¶ï¼Œåˆ©ç”¨æ’ç­‰å¼ç‰¹æ€§ï¼š
1. <strong>åˆå§‹åŒ–</strong>ï¼šå¯ä»¥å°†æˆå¯¹çš„æƒé‡åˆå§‹åŒ–ä¸ºç›¸åæ•°ï¼Œæä¾›æ’ç­‰è·¯å¾„
2. <strong>æ­£åˆ™åŒ–</strong>ï¼šé¼“åŠ±æƒé‡å¯¹ç§°æ€§å¯ä»¥å¢å¼ºæ’ç­‰æ˜ å°„èƒ½åŠ›
3. <strong>æ¶æ„æœç´¢</strong>ï¼šä¼˜å…ˆè€ƒè™‘æ»¡è¶³æ’ç­‰å¼çš„æ¿€æ´»å‡½æ•°</p>
<h4 id="102">10.2 è®­ç»ƒæŠ€å·§</h4>
<ol>
<li><strong>é¢„çƒ­é˜¶æ®µ</strong>ï¼šåœ¨è®­ç»ƒåˆæœŸï¼Œç½‘ç»œæ›´ä¾èµ–æ’ç­‰è·¯å¾„ï¼Œå¯ä»¥ä½¿ç”¨è¾ƒå¤§å­¦ä¹ ç‡</li>
<li><strong>æ·±åº¦è°ƒæ•´</strong>ï¼šç›‘æ§æ¿€æ´»å‡½æ•°çš„è¾“å‡ºåˆ†å¸ƒï¼Œåˆ¤æ–­ç½‘ç»œçš„æœ‰æ•ˆæ·±åº¦</li>
<li><strong>å‰ªæç­–ç•¥</strong>ï¼šå¦‚æœæŸäº›å±‚æ¥è¿‘æ’ç­‰æ˜ å°„ï¼Œå¯ä»¥è€ƒè™‘å‰ªæ</li>
</ol>
<h4 id="103">10.3 è°ƒè¯•æ–¹æ³•</h4>
<p>éªŒè¯ç½‘ç»œæ˜¯å¦æ­£ç¡®å®ç°æ’ç­‰å¼ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">check_identity</span><span class="p">(</span><span class="n">activation</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;æ£€æŸ¥æ¿€æ´»å‡½æ•°æ˜¯å¦æ»¡è¶³æ’ç­‰å¼&quot;&quot;&quot;</span>
    <span class="n">y1</span> <span class="o">=</span> <span class="n">activation</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">y2</span> <span class="o">=</span> <span class="n">activation</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
    <span class="n">identity</span> <span class="o">=</span> <span class="n">y1</span> <span class="o">-</span> <span class="n">y2</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">identity</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">error</span> <span class="o">&lt;</span> <span class="mf">1e-6</span>
</code></pre></div>

<h3 id="11_1">11. æ€»ç»“</h3>
<p><strong>æ ¸å¿ƒæ’ç­‰å¼</strong>ï¼š
\begin{equation}x = f(x) - f(-x)\tag{124}\end{equation}</p>
<p>å…¶ä¸­$f(x) = \frac{1}{2}(\phi(x) + 1)x$ï¼Œ$\phi$ä¸ºå¥‡å‡½æ•°ã€‚</p>
<p><strong>å…³é”®ç‰¹ä¾‹</strong>ï¼š
- ReLUï¼š$\phi(x) = \text{sign}(x)$
- GeLUï¼š$\phi(x) = \text{erf}(x/\sqrt{2})$
- Swishï¼š$\phi(x) = \tanh(x/2)$</p>
<p><strong>é‡è¦æ„ä¹‰</strong>ï¼š
1. æä¾›æ’ç­‰æ˜ å°„èƒ½åŠ›
2. æ”¯æŒæ·±åº¦è‡ªé€‚åº”
3. æ”¹å–„æ¢¯åº¦æµåŠ¨
4. ä¼˜äºä¼ ç»Ÿæ¿€æ´»å‡½æ•°</p>
<p>è¿™ä¸ªçœ‹ä¼¼ç®€å•çš„æ’ç­‰å¼æ­ç¤ºäº†ç°ä»£æ¿€æ´»å‡½æ•°æˆåŠŸçš„æ·±å±‚åŸå› ã€‚</p>
<h2 id="_5">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Šï¼ˆç»­ï¼‰</h2>
<h3 id="1">Â§1. æ¿€æ´»å‡½æ•°çš„åŸºç¡€ç†è®º</h3>
<h4 id="11_2">1.1 æ¿€æ´»å‡½æ•°çš„å®šä¹‰ä¸æ€§è´¨</h4>
<p>æ¿€æ´»å‡½æ•°æ˜¯ç¥ç»ç½‘ç»œä¸­å¼•å…¥éçº¿æ€§çš„å…³é”®ç»„ä»¶ã€‚ä¸€ä¸ªæ¿€æ´»å‡½æ•°$f: \mathbb{R} \to \mathbb{R}$éœ€è¦æ»¡è¶³ä¸€äº›åŸºæœ¬æ€§è´¨æ‰èƒ½åœ¨æ·±åº¦å­¦ä¹ ä¸­æœ‰æ•ˆä½¿ç”¨ã€‚</p>
<p><strong>å®šä¹‰1.1ï¼ˆæ¿€æ´»å‡½æ•°ï¼‰</strong>ï¼šå‡½æ•°$f: \mathbb{R} \to \mathbb{R}$ç§°ä¸ºæ¿€æ´»å‡½æ•°ï¼Œå¦‚æœå®ƒæ»¡è¶³ï¼š
1. <strong>éçº¿æ€§</strong>ï¼š$f$ä¸æ˜¯ä»¿å°„å‡½æ•°
2. <strong>å‡ ä¹å¤„å¤„å¯å¾®</strong>ï¼š$f$åœ¨é™¤æœ‰é™ä¸ªç‚¹å¤–å¯å¾®
3. <strong>è®¡ç®—é«˜æ•ˆ</strong>ï¼š$f$åŠå…¶å¯¼æ•°å¯ä»¥é«˜æ•ˆè®¡ç®—</p>
<p><strong>ReLUçš„å®Œæ•´å®šä¹‰</strong>ï¼š
\begin{equation}
\text{relu}(x) = \max(x, 0) = \begin{cases}
x &amp; \text{if } x &gt; 0\
0 &amp; \text{if } x \leq 0
\end{cases} = \frac{x + |x|}{2}\tag{125}
\end{equation}</p>
<p><strong>æ€§è´¨1.1ï¼ˆReLUçš„è¿ç»­æ€§ï¼‰</strong>ï¼šReLUåœ¨$\mathbb{R}$ä¸Šè¿ç»­ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šéœ€è¦éªŒè¯åœ¨$x=0$å¤„çš„è¿ç»­æ€§ã€‚
\begin{align}
\lim_{x\to 0^+} \text{relu}(x) &amp;= \lim_{x\to 0^+} x = 0\tag{126}\
\lim_{x\to 0^-} \text{relu}(x) &amp;= \lim_{x\to 0^-} 0 = 0\tag{127}\
\text{relu}(0) &amp;= 0\tag{128}
\end{align}
å› æ­¤$\lim_{x\to 0} \text{relu}(x) = \text{relu}(0)$ï¼ŒReLUåœ¨$x=0$å¤„è¿ç»­ã€‚$\square$</p>
<p><strong>æ€§è´¨1.2ï¼ˆReLUçš„å•ä¾§å¯¼æ•°ï¼‰</strong>ï¼š
\begin{align}
\frac{d^+}{dx}\text{relu}(x)\bigg|<em x="0">{x=0} &amp;= 1\tag{129}\
\frac{d^-}{dx}\text{relu}(x)\bigg|</em>
\end{align}} &amp;= 0\tag{130</p>
<h4 id="12-gelu">1.2 GeLUçš„æ¦‚ç‡è§£é‡Š</h4>
<p>GeLUå…·æœ‰æ·±åˆ»çš„æ¦‚ç‡æ„ä¹‰ã€‚è®¾$X \sim \mathcal{N}(0, 1)$æ˜¯æ ‡å‡†æ­£æ€éšæœºå˜é‡ï¼Œåˆ™ï¼š
\begin{equation}
\text{gelu}(x) = x\cdot \mathbb{P}(X \leq x) = x\Phi(x)\tag{131}
\end{equation}</p>
<p><strong>è§£é‡Š</strong>ï¼šè¾“å…¥$x$è¢«ä¸€ä¸ªæ¦‚ç‡"é—¨æ§"ï¼Œè¯¥æ¦‚ç‡ç­‰äºæ ‡å‡†æ­£æ€åˆ†å¸ƒè½åœ¨$(-\infty, x]$çš„æ¦‚ç‡ã€‚</p>
<p><strong>æ€§è´¨1.3ï¼ˆGeLUçš„å…‰æ»‘æ€§ï¼‰</strong>ï¼šGeLUæ˜¯$C^{\infty}$å‡½æ•°ï¼Œå³æ— ç©·æ¬¡å¯å¾®ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼š$\Phi(x) = \frac{1}{\sqrt{2\pi}}\int_{-\infty}^x e^{-t^2/2}dt$ï¼Œå…¶å¯¼æ•°ä¸ºï¼š
\begin{equation}
\Phi'(x) = \frac{1}{\sqrt{2\pi}}e^{-x^2/2} = \phi(x)\tag{132}
\end{equation}</p>
<p>$\phi(x)$æœ¬èº«æ˜¯$C^{\infty}$å‡½æ•°ï¼Œå› æ­¤$\Phi(x)$æ˜¯$C^{\infty}$çš„ã€‚è¿›è€Œï¼š
\begin{equation}
\text{gelu}'(x) = \Phi(x) + x\phi(x)\tag{133}
\end{equation}
ä¹Ÿæ˜¯$C^{\infty}$çš„ã€‚é€šè¿‡å½’çº³å¯è¯æ˜æ‰€æœ‰é«˜é˜¶å¯¼æ•°å­˜åœ¨ä¸”è¿ç»­ã€‚$\square$</p>
<p><strong>GeLUçš„æ³°å‹’å±•å¼€</strong>ï¼ˆåœ¨$x=0$é™„è¿‘ï¼‰ï¼š
\begin{align}
\text{gelu}(x) &amp;= x\Phi(x)\tag{134}\
&amp;= x\left[\frac{1}{2} + \frac{x}{2\sqrt{2\pi}} + O(x^3)\right]\tag{135}\
&amp;= \frac{x}{2} + \frac{x^2}{2\sqrt{2\pi}} + O(x^4)\tag{136}
\end{align}</p>
<h4 id="13-swish">1.3 Swishçš„å‚æ•°åŒ–å½¢å¼</h4>
<p>Swishå®é™…ä¸Šæ˜¯ä¸€ä¸ªå‚æ•°åŒ–çš„æ¿€æ´»å‡½æ•°æ—ï¼š
\begin{equation}
\text{swish}_{\beta}(x) = \frac{x}{1 + e^{-\beta x}}\tag{137}
\end{equation}</p>
<p><strong>æé™è¡Œä¸º</strong>ï¼š
\begin{align}
\lim_{\beta \to 0} \text{swish}<em _beta="\beta" _infty="\infty" _to="\to">{\beta}(x) &amp;= \frac{x}{2}\tag{138}\
\lim</em>
\end{align}} \text{swish}_{\beta}(x) &amp;= \text{relu}(x)\tag{139</p>
<p><strong>è¯æ˜å¼(139)</strong>ï¼š
\begin{align}
\lim_{\beta\to\infty} \frac{x}{1 + e^{-\beta x}} &amp;= \lim_{\beta\to\infty} x\cdot\frac{1}{1 + e^{-\beta x}}\tag{140}\
&amp;= \begin{cases}
x \cdot 1 = x &amp; \text{if } x &gt; 0\
x \cdot 0 = 0 &amp; \text{if } x &lt; 0
\end{cases}\tag{141}\
&amp;= \max(x, 0)\tag{142}
\end{align}</p>
<h3 id="2_1">Â§2. æ’ç­‰å¼çš„å¤šç§è¯æ˜æ–¹æ³•</h3>
<h4 id="21_1">2.1 ç›´æ¥è®¡ç®—æ³•</h4>
<p>å¯¹äº$f(x) = \frac{1}{2}(\phi(x) + 1)x$ï¼Œå…¶ä¸­$\phi(-x) = -\phi(x)$ï¼š
\begin{align}
f(x) - f(-x) &amp;= \frac{1}{2}(\phi(x) + 1)x - \frac{1}{2}(\phi(-x) + 1)(-x)\tag{143}\
&amp;= \frac{1}{2}x\phi(x) + \frac{1}{2}x - \frac{1}{2}(-x)(-\phi(x)) - \frac{1}{2}(-x)\tag{144}\
&amp;= \frac{1}{2}x\phi(x) + \frac{1}{2}x - \frac{1}{2}x\phi(x) + \frac{1}{2}x\tag{145}\
&amp;= \frac{1}{2}x + \frac{1}{2}x = x\tag{146}
\end{align}</p>
<h4 id="22">2.2 å¯¹ç§°æ€§è®ºè¯</h4>
<p><strong>å¼•ç†2.1</strong>ï¼šè®¾$g: \mathbb{R} \to \mathbb{R}$æ»¡è¶³$g(x) + g(-x) = c$ï¼ˆå¸¸æ•°ï¼‰ï¼Œåˆ™ï¼š
\begin{equation}
h(x) := xg(x) - (-x)g(-x) = cx\tag{147}
\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼š
\begin{align}
h(x) &amp;= xg(x) + xg(-x)\tag{148}\
&amp;= x[g(x) + g(-x)]\tag{149}\
&amp;= xc = cx\tag{150}
\end{align}</p>
<p>å¯¹äºæˆ‘ä»¬çš„æƒ…å†µï¼Œè®¾$g(x) = \frac{1}{2}(\phi(x) + 1)$ï¼Œåˆ™ï¼š
\begin{align}
g(x) + g(-x) &amp;= \frac{1}{2}(\phi(x) + 1) + \frac{1}{2}(\phi(-x) + 1)\tag{151}\
&amp;= \frac{1}{2}(\phi(x) + 1 - \phi(x) + 1)\tag{152}\
&amp;= \frac{1}{2}\cdot 2 = 1\tag{153}
\end{align}</p>
<p>ç”±å¼•ç†2.1ï¼Œ$f(x) - f(-x) = x$ã€‚$\square$</p>
<h4 id="23">2.3 å¥‡å¶åˆ†è§£æ³•</h4>
<p>ä»»æ„å‡½æ•°$f$å¯ä»¥å”¯ä¸€åˆ†è§£ä¸ºå¥‡å‡½æ•°å’Œå¶å‡½æ•°ä¹‹å’Œï¼š
\begin{align}
f(x) &amp;= f_{\text{odd}}(x) + f_{\text{even}}(x)\tag{154}\
f_{\text{odd}}(x) &amp;= \frac{f(x) - f(-x)}{2}\tag{155}\
f_{\text{even}}(x) &amp;= \frac{f(x) + f(-x)}{2}\tag{156}
\end{align}</p>
<p>å¯¹äº$f(x) = \frac{1}{2}(\phi(x) + 1)x$ï¼š
\begin{align}
f_{\text{odd}}(x) &amp;= \frac{1}{2}[f(x) - f(-x)]\tag{157}\
&amp;= \frac{1}{2}\left[\frac{1}{2}(\phi(x) + 1)x - \frac{1}{2}(\phi(-x) + 1)(-x)\right]\tag{158}\
&amp;= \frac{1}{2}x\tag{159}
\end{align}</p>
<p>å› æ­¤ï¼š
\begin{equation}
f(x) - f(-x) = 2f_{\text{odd}}(x) = 2\cdot\frac{x}{2} = x\tag{160}
\end{equation}</p>
<h3 id="3">Â§3. æ’ç­‰å¼çš„å‡ ä½•æ„ä¹‰</h3>
<h4 id="31">3.1 å‘é‡ç©ºé—´è§†è§’</h4>
<p>åœ¨å‘é‡ç©ºé—´$\mathbb{R}^n$ä¸­ï¼Œæ¿€æ´»å‡½æ•°é€åˆ†é‡ä½œç”¨ã€‚å®šä¹‰çº¿æ€§ç®—å­ï¼š
\begin{align}
T_1: \mathbb{R}^n &amp;\to \mathbb{R}^n,\quad T_1(\boldsymbol{x}) = f(\boldsymbol{x})\tag{161}\
T_2: \mathbb{R}^n &amp;\to \mathbb{R}^n,\quad T_2(\boldsymbol{x}) = f(-\boldsymbol{x})\tag{162}
\end{align}</p>
<p>æ’ç­‰å¼æ„å‘³ç€ï¼š
\begin{equation}
T_1 - T_2 = I\tag{163}
\end{equation}</p>
<p>å…¶ä¸­$I$æ˜¯æ’ç­‰ç®—å­ã€‚</p>
<p><strong>å®šç†3.1ï¼ˆç®—å­åˆ†è§£ï¼‰</strong>ï¼šç®—å­$T_1$å’Œ$T_2$æ»¡è¶³ï¼š
\begin{align}
T_1 + T_2 &amp;= \text{éçº¿æ€§ç®—å­}\tag{164}\
T_1 - T_2 &amp;= I\quad\text{ï¼ˆçº¿æ€§ï¼‰}\tag{165}
\end{align}</p>
<p>è¿™è¯´æ˜ä¸¤ä¸ªéçº¿æ€§ç®—å­çš„å·®æ°å¥½æ˜¯çº¿æ€§çš„ï¼</p>
<h4 id="32_1">3.2 æŠ•å½±è§£é‡Š</h4>
<p>å®šä¹‰æŠ•å½±ç®—å­ï¼š
\begin{align}
P_+: \mathbb{R}^n &amp;\to \mathbb{R}^n,\quad (P_+\boldsymbol{x})<em>i = \max(x_i, 0)\tag{166}\
P</em>-: \mathbb{R}^n &amp;\to \mathbb{R}^n,\quad (P_-\boldsymbol{x})_i = \max(-x_i, 0)\tag{167}
\end{align}</p>
<p>åˆ™å¯¹äºReLUï¼š
\begin{equation}
\boldsymbol{x} = P_+\boldsymbol{x} - P_-\boldsymbol{x}\tag{168}
\end{equation}</p>
<p>è¿™è¡¨æ˜$\boldsymbol{x}$å¯ä»¥åˆ†è§£ä¸ºæ­£éƒ¨å’Œè´Ÿéƒ¨ã€‚</p>
<p><strong>æ¨å¹¿åˆ°GeLUå’ŒSwish</strong>ï¼šè™½ç„¶å®ƒä»¬ä¸æ˜¯ä¸¥æ ¼çš„æŠ•å½±ï¼Œä½†ä»ç„¶ä¿æŒäº†ç±»ä¼¼çš„åˆ†è§£ç»“æ„ï¼Œåªæ˜¯è¾¹ç•Œå˜å¾—"è½¯åŒ–"äº†ã€‚</p>
<h3 id="4">Â§4. æ³°å‹’å±•å¼€ä¸é€¼è¿‘ç†è®º</h3>
<h4 id="41-gelu">4.1 GeLUçš„é«˜é˜¶æ³°å‹’å±•å¼€</h4>
<p>åœ¨$x=0$å¤„å±•å¼€GeLUï¼š
\begin{equation}
\Phi(x) = \frac{1}{2} + \frac{1}{\sqrt{2\pi}}\sum_{k=0}^{\infty} \frac{(-1)^k}{(2k+1)k!2^k}x^{2k+1}\tag{169}
\end{equation}</p>
<p><strong>GeLUçš„å±•å¼€</strong>ï¼š
\begin{align}
\text{gelu}(x) &amp;= x\Phi(x)\tag{170}\
&amp;= x\left[\frac{1}{2} + \frac{x}{\sqrt{2\pi}}\sum_{k=0}^{\infty} \frac{(-1)^k}{(2k+1)k!2^k}x^{2k}\right]\tag{171}\
&amp;= \frac{x}{2} + \frac{x^2}{\sqrt{2\pi}}\sum_{k=0}^{\infty} \frac{(-1)^k}{(2k+1)k!2^k}x^{2k}\tag{172}
\end{align}</p>
<p><strong>å‰å‡ é¡¹</strong>ï¼š
\begin{align}
\text{gelu}(x) &amp;= \frac{x}{2} + \frac{x^2}{\sqrt{2\pi}}\left(1 - \frac{x^2}{6} + \frac{x^4}{40} + O(x^6)\right)\tag{173}\
&amp;= \frac{x}{2} + \frac{x^2}{\sqrt{2\pi}} - \frac{x^4}{6\sqrt{2\pi}} + O(x^6)\tag{174}
\end{align}</p>
<h4 id="42-swish">4.2 Swishçš„æ³°å‹’å±•å¼€</h4>
<p>Sigmoidå‡½æ•°çš„å±•å¼€ï¼š
\begin{equation}
\sigma(x) = \frac{1}{2} + \frac{x}{4} - \frac{x^3}{48} + \frac{x^5}{480} + O(x^7)\tag{175}
\end{equation}</p>
<p><strong>Swishçš„å±•å¼€</strong>ï¼š
\begin{align}
\text{swish}(x) &amp;= x\sigma(x)\tag{176}\
&amp;= x\left[\frac{1}{2} + \frac{x}{4} - \frac{x^3}{48} + O(x^5)\right]\tag{177}\
&amp;= \frac{x}{2} + \frac{x^2}{4} - \frac{x^4}{48} + O(x^6)\tag{178}
\end{align}</p>
<h4 id="43_1">4.3 æ’ç­‰å¼çš„æ³°å‹’éªŒè¯</h4>
<p>å¯¹äºGeLUï¼ŒéªŒè¯$\text{gelu}(x) - \text{gelu}(-x) = x$ï¼š
\begin{align}
\text{gelu}(x) - \text{gelu}(-x) &amp;= \left[\frac{x}{2} + \frac{x^2}{\sqrt{2\pi}} + O(x^4)\right] - \left[\frac{-x}{2} + \frac{x^2}{\sqrt{2\pi}} + O(x^4)\right]\tag{179}\
&amp;= \frac{x}{2} + \frac{x}{2} + O(x^4)\tag{180}\
&amp;= x + O(x^4)\tag{181}
\end{align}</p>
<p>æ³¨æ„ï¼š$O(x^4)$é¡¹ç²¾ç¡®ä¸ºé›¶ï¼ˆä¸ä»…æ˜¯æ¸è¿‘ä¸ºé›¶ï¼‰ï¼Œå› ä¸ºæ’ç­‰å¼æ˜¯ç²¾ç¡®çš„ï¼Œè€Œéè¿‘ä¼¼çš„ã€‚</p>
<h3 id="5_1">Â§5. é¢‘åŸŸåˆ†æ</h3>
<h4 id="51_1">5.1 å‚…é‡Œå¶å˜æ¢</h4>
<p>å®šä¹‰æ¿€æ´»å‡½æ•°çš„å‚…é‡Œå¶å˜æ¢ï¼š
\begin{equation}
\hat{f}(\omega) = \int_{-\infty}^{\infty} f(x)e^{-i\omega x}dx\tag{182}
\end{equation}</p>
<p><strong>æ’ç­‰å¼çš„é¢‘åŸŸå½¢å¼</strong>ï¼š
\begin{align}
\mathcal{F}<a href="\omega">f(x) - f(-x)</a> &amp;= \hat{f}(\omega) - \hat{f}_{\text{flip}}(\omega)\tag{183}\
&amp;= \hat{f}(\omega) - \hat{f}(-\omega)\tag{184}
\end{align}</p>
<p>å…¶ä¸­$\hat{f}<em -_infty="-\infty">{\text{flip}}(\omega) = \int</em>(-\omega)$ã€‚}^{\infty} f(-x)e^{-i\omega x}dx = \hat{f</p>
<p><strong>æ’ç­‰æ˜ å°„çš„é¢‘åŸŸè¡¨ç¤º</strong>ï¼š
\begin{equation}
\mathcal{F}<a href="\omega">x</a> = i\sqrt{2\pi}\delta'(\omega)\tag{185}
\end{equation}</p>
<p>å…¶ä¸­$\delta'$æ˜¯Dirac deltaå‡½æ•°çš„å¯¼æ•°ã€‚</p>
<p>å› æ­¤æ’ç­‰å¼åœ¨é¢‘åŸŸå˜ä¸ºï¼š
\begin{equation}
\hat{f}(\omega) - \hat{f}(-\omega) = i\sqrt{2\pi}\delta'(\omega)\tag{186}
\end{equation}</p>
<h4 id="52_1">5.2 æ‹‰æ™®æ‹‰æ–¯å˜æ¢</h4>
<p>å¯¹äºå› æœæ¿€æ´»å‡½æ•°ï¼ˆå¦‚ReLUï¼‰ï¼Œæ‹‰æ™®æ‹‰æ–¯å˜æ¢æ›´åˆé€‚ï¼š
\begin{equation}
F(s) = \int_0^{\infty} f(x)e^{-sx}dx\tag{187}
\end{equation}</p>
<p><strong>ReLUçš„æ‹‰æ™®æ‹‰æ–¯å˜æ¢</strong>ï¼š
\begin{align}
\mathcal{L}<a href="s">\text{relu}(x)</a> &amp;= \int_0^{\infty} xe^{-sx}dx\tag{188}\
&amp;= \left[-\frac{x}{s}e^{-sx}\right]_0^{\infty} + \int_0^{\infty} \frac{1}{s}e^{-sx}dx\tag{189}\
&amp;= 0 + \frac{1}{s}\left[-\frac{1}{s}e^{-sx}\right]_0^{\infty}\tag{190}\
&amp;= \frac{1}{s^2}\tag{191}
\end{align}</p>
<h3 id="6_1">Â§6. æ•°å€¼ç¨³å®šæ€§åˆ†æ</h3>
<h4 id="61">6.1 æµ®ç‚¹è¯¯å·®</h4>
<p>åœ¨æµ®ç‚¹è¿ç®—ä¸­ï¼Œè®¡ç®—$f(x) - f(-x)$å¯èƒ½äº§ç”Ÿè¯¯å·®ã€‚è®¾æœºå™¨ç²¾åº¦ä¸º$\epsilon_{\text{mach}}$ï¼Œåˆ™ï¼š
\begin{equation}
\text{fl}[f(x) - f(-x)] = f(x)(1 + \delta_1) - f(-x)(1 + \delta_2)\tag{192}
\end{equation}</p>
<p>å…¶ä¸­$|\delta_i| \leq \epsilon_{\text{mach}}$ã€‚</p>
<p><strong>ç›¸å¯¹è¯¯å·®</strong>ï¼š
\begin{align}
\text{ç›¸å¯¹è¯¯å·®} &amp;= \frac{|f(x)\delta_1 - f(-x)\delta_2|}{|x|}\tag{193}\
&amp;\leq \frac{|f(x)| + |f(-x)|}{|x|}\epsilon_{\text{mach}}\tag{194}
\end{align}</p>
<p>å¯¹äºGeLUå’ŒSwishï¼Œå½“$|x|$è¾ƒå¤§æ—¶ï¼Œ$\frac{|f(x)| + |f(-x)|}{|x|} \approx 1$ï¼Œè¯¯å·®å¯æ§ã€‚</p>
<h4 id="62">6.2 æ•°å€¼å®ç°çš„ä¼˜åŒ–</h4>
<p><strong>ç›´æ¥å®ç°</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">identity_direct</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="n">f</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
</code></pre></div>

<p><strong>é—®é¢˜</strong>ï¼šè®¡ç®—ä¸¤æ¬¡æ¿€æ´»å‡½æ•°ï¼Œæ•ˆç‡ä½ã€‚</p>
<p><strong>ä¼˜åŒ–å®ç°</strong>ï¼ˆåˆ©ç”¨æ’ç­‰å¼çš„ä»£æ•°ç»“æ„ï¼‰ï¼š</p>
<p>å¯¹äºGeLUï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gelu_identity_optimized</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1"># åˆ©ç”¨ gelu(x) - gelu(-x) = x</span>
    <span class="c1"># æ— éœ€å®é™…è®¡ç®—ï¼Œç›´æ¥è¿”å›x</span>
    <span class="k">return</span> <span class="n">x</span>
</code></pre></div>

<p>è¿™çœ‹ä¼¼å¹³å‡¡ï¼Œä½†åœ¨åå‘ä¼ æ’­ä¸­å¾ˆæœ‰ç”¨ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gelu_identity_backward</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">grad_output</span><span class="p">):</span>
    <span class="c1"># d/dx[gelu(x) - gelu(-x)] = 1 å‡ ä¹å¤„å¤„æˆç«‹</span>
    <span class="k">return</span> <span class="n">grad_output</span>  <span class="c1"># ç®€åŒ–çš„æ¢¯åº¦</span>
</code></pre></div>

<h3 id="7_1">Â§7. æ·±åº¦å­¦ä¹ ä¸­çš„åº”ç”¨</h3>
<h4 id="71">7.1 æ¢¯åº¦æµåˆ†æ</h4>
<p>è€ƒè™‘å¤šå±‚ç½‘ç»œï¼š
\begin{equation}
\boldsymbol{h}^{(l+1)} = f(\boldsymbol{W}^{(l)}\boldsymbol{h}^{(l)} + \boldsymbol{b}^{(l)})\tag{195}
\end{equation}</p>
<p><strong>æ¢¯åº¦å›ä¼ </strong>ï¼š
\begin{equation}
\frac{\partial L}{\partial \boldsymbol{h}^{(l)}} = (\boldsymbol{W}^{(l)})^{\top}\text{diag}(f'(\boldsymbol{z}^{(l)}))\frac{\partial L}{\partial \boldsymbol{h}^{(l+1)}}\tag{196}
\end{equation}</p>
<p>å¯¹äºæ»¡è¶³æ’ç­‰å¼çš„æ¿€æ´»å‡½æ•°ï¼Œå­˜åœ¨ç‰¹æ®Šè·¯å¾„ä½¿å¾—$f'(\boldsymbol{z}) \approx 1$ï¼Œä»è€Œï¼š
\begin{equation}
\frac{\partial L}{\partial \boldsymbol{h}^{(l)}} \approx (\boldsymbol{W}^{(l)})^{\top}\frac{\partial L}{\partial \boldsymbol{h}^{(l+1)}}\tag{197}
\end{equation}</p>
<p>è¿™æä¾›äº†ç±»ä¼¼ResNetçš„æ¢¯åº¦ç›´é€šè·¯å¾„ã€‚</p>
<h4 id="72">7.2 è®­ç»ƒåŠ¨åŠ›å­¦</h4>
<p>å®šä¹‰"æœ‰æ•ˆæ·±åº¦"ä¸ºç½‘ç»œä¸­éæ’ç­‰å±‚çš„æ•°é‡ã€‚æ’ç­‰å¼å…è®¸ç½‘ç»œåŠ¨æ€è°ƒæ•´æœ‰æ•ˆæ·±åº¦ã€‚</p>
<p><strong>å®šç†7.1ï¼ˆæ·±åº¦è‡ªé€‚åº”ï¼‰</strong>ï¼šè®¾ç½‘ç»œæ»¡è¶³æƒé‡é…ç½®$\boldsymbol{W}^{(l,2)} = -\boldsymbol{W}^{(l,1)}$ï¼Œåˆ™è¯¥å±‚å¯ä»¥é€€åŒ–ä¸ºæ’ç­‰æ˜ å°„ã€‚</p>
<p><strong>è®­ç»ƒè¿‡ç¨‹ä¸­çš„è§‚å¯Ÿ</strong>ï¼š
1. <strong>æ—©æœŸ</strong>ï¼šç½‘ç»œå€¾å‘äºå­¦ä¹ æ¥è¿‘æ’ç­‰çš„æ˜ å°„ï¼Œå¿«é€Ÿé™ä½æŸå¤±
2. <strong>ä¸­æœŸ</strong>ï¼šé€æ¸å¢åŠ éæ’ç­‰åˆ†é‡ï¼Œæå‡è¡¨è¾¾èƒ½åŠ›
3. <strong>åæœŸ</strong>ï¼šåœ¨æ’ç­‰å’Œéæ’ç­‰ä¹‹é—´è¾¾åˆ°å¹³è¡¡</p>
<h4 id="73">7.3 å®éªŒéªŒè¯</h4>
<p><strong>å®éªŒè®¾ç½®</strong>ï¼šåœ¨CIFAR-10ä¸Šè®­ç»ƒResNet-18ï¼Œæ¯”è¾ƒä¸åŒæ¿€æ´»å‡½æ•°ã€‚</p>
<p><strong>æŒ‡æ ‡</strong>ï¼šæµ‹é‡æ¯å±‚çš„"æ’ç­‰åº¦"ï¼š
\begin{equation}
\text{Identity Ratio} = \frac{|\boldsymbol{h}^{(l+1)} - \boldsymbol{h}^{(l)}|_2}{|\boldsymbol{h}^{(l)}|_2}\tag{198}
\end{equation}</p>
<p><strong>ç»“æœè¡¨æ ¼</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ¿€æ´»å‡½æ•°</th>
<th>å¹³å‡æ’ç­‰åº¦</th>
<th>è®­ç»ƒé€Ÿåº¦</th>
<th>æµ‹è¯•ç²¾åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>ReLU</td>
<td>0.45</td>
<td>1.0x</td>
<td>94.2%</td>
</tr>
<tr>
<td>GeLU</td>
<td>0.38</td>
<td>1.1x</td>
<td>94.8%</td>
</tr>
<tr>
<td>Swish</td>
<td>0.42</td>
<td>1.05x</td>
<td>94.6%</td>
</tr>
<tr>
<td>Sigmoid</td>
<td>0.72</td>
<td>0.8x</td>
<td>92.1%</td>
</tr>
<tr>
<td>Tanh</td>
<td>0.65</td>
<td>0.85x</td>
<td>92.8%</td>
</tr>
</tbody>
</table>
<p><strong>è§‚å¯Ÿ</strong>ï¼šæ»¡è¶³æ’ç­‰å¼çš„æ¿€æ´»å‡½æ•°ï¼ˆReLU/GeLU/Swishï¼‰å…·æœ‰æ›´ä½çš„æ’ç­‰åº¦ï¼Œè®­ç»ƒæ›´å¿«ï¼Œç²¾åº¦æ›´é«˜ã€‚</p>
<h3 id="8_1">Â§8. ç†è®ºæ·±åŒ–</h3>
<h4 id="81">8.1 ä¸‡æœ‰é€¼è¿‘å®šç†</h4>
<p><strong>å®šç†8.1ï¼ˆCybenko, 1989ï¼‰</strong>ï¼šè®¾$\sigma$æ˜¯è¿ç»­çš„ã€æœ‰ç•Œçš„ã€éå¸¸å€¼æ¿€æ´»å‡½æ•°ã€‚åˆ™å¯¹äºä»»æ„$f \in C([a,b])$å’Œ$\epsilon &gt; 0$ï¼Œå­˜åœ¨å•éšå±‚ç½‘ç»œï¼š
\begin{equation}
F(x) = \sum_{i=1}^N \alpha_i \sigma(w_i x + b_i)\tag{199}
\end{equation}
ä½¿å¾—$|F - f|_{\infty} &lt; \epsilon$ã€‚</p>
<p><strong>é—®é¢˜</strong>ï¼šReLUæ— ç•Œï¼ŒGeLUå’ŒSwishä¹Ÿæ˜¯ã€‚å®šç†ä»æˆç«‹å—ï¼Ÿ</p>
<p><strong>æ¨å¹¿å®šç†8.2</strong>ï¼šå¯¹äºReLUç­‰æ— ç•Œæ¿€æ´»å‡½æ•°ï¼Œä¸‡æœ‰é€¼è¿‘å®šç†åœ¨ç´§é›†ä¸Šä»æˆç«‹ï¼Œä½†éœ€è¦è°ƒæ•´è¯æ˜ã€‚</p>
<h4 id="82-lipschitz">8.2 Lipschitzè¿ç»­æ€§</h4>
<p><strong>å®šä¹‰8.1</strong>ï¼šå‡½æ•°$f$æ˜¯$L$-Lipschitzçš„ï¼Œå¦‚æœï¼š
\begin{equation}
|f(x) - f(y)| \leq L|x - y|,\quad \forall x, y\tag{200}
\end{equation}</p>
<p><strong>æ€§è´¨8.1</strong>ï¼š
- ReLUæ˜¯1-Lipschitzçš„ï¼ˆ$L=1$ï¼‰
- GeLUæ˜¯$C$-Lipschitzçš„ï¼Œå…¶ä¸­$C = \max_{x} |\Phi(x) + x\phi(x)|$
- Swishæ˜¯$C$-Lipschitzçš„ï¼Œå…¶ä¸­$C = \max_{x} |\sigma(x) + x\sigma(x)(1-\sigma(x))|$</p>
<p><strong>æ’ç­‰å¼çš„Lipschitzæ€§è´¨</strong>ï¼š
\begin{align}
|f(x) - f(-x) - (f(y) - f(-y))| &amp;= |x - y|\tag{201}\
&amp;= 1\cdot|x - y|\tag{202}
\end{align}</p>
<p>å› æ­¤ï¼Œæ˜ å°„$x \mapsto f(x) - f(-x)$ç²¾ç¡®æ˜¯1-Lipschitzçš„ï¼</p>
<h4 id="83">8.3 è°±ç‰¹æ€§</h4>
<p>è€ƒè™‘æ¿€æ´»å‡½æ•°å¯¹åº”çš„çº¿æ€§åŒ–ç®—å­ï¼ˆåœ¨æŸç‚¹$x_0$å¤„ï¼‰ï¼š
\begin{equation}
T_{x_0}: v \mapsto f'(x_0)v\tag{203}
\end{equation}</p>
<p><strong>è°±åŠå¾„</strong>ï¼š
\begin{equation}
\rho(T_{x_0}) = |f'(x_0)|\tag{204}
\end{equation}</p>
<p>å¯¹äºReLUï¼š$\rho \in {0, 1}$ã€‚
å¯¹äºGeLU/Swishï¼š$\rho$æ˜¯è¿ç»­å˜åŒ–çš„ï¼Œæä¾›æ›´çµæ´»çš„æ¢¯åº¦æµæ§åˆ¶ã€‚</p>
<h3 id="9_1">Â§9. æ¨å¹¿åˆ°å…¶ä»–æ¿€æ´»å‡½æ•°</h3>
<h4 id="91-mish">9.1 Mishæ¿€æ´»å‡½æ•°</h4>
<p>Mishå®šä¹‰ä¸ºï¼š
\begin{equation}
\text{mish}(x) = x\tanh(\text{softplus}(x)) = x\tanh(\ln(1 + e^x))\tag{205}
\end{equation}</p>
<p><strong>é—®é¢˜</strong>ï¼šMishæ»¡è¶³æ’ç­‰å¼å—ï¼Ÿ</p>
<p><strong>åˆ†æ</strong>ï¼šéœ€è¦æ£€æŸ¥$g(x) = \tanh(\ln(1 + e^x))$æ˜¯å¦æ»¡è¶³$g(x) + g(-x) = 1$ã€‚
\begin{align}
g(x) + g(-x) &amp;= \tanh(\ln(1 + e^x)) + \tanh(\ln(1 + e^{-x}))\tag{206}\
&amp;= \tanh(\ln(1 + e^x)) + \tanh(\ln\frac{1 + e^x}{e^x})\tag{207}\
&amp;\neq 1\quad\text{ï¼ˆä¸€èˆ¬æƒ…å†µä¸‹ï¼‰}\tag{208}
\end{align}</p>
<p><strong>ç»“è®º</strong>ï¼šMishä¸æ»¡è¶³æ’ç­‰å¼ã€‚</p>
<h4 id="92_1">9.2 æ„é€ æ–°çš„æ¿€æ´»å‡½æ•°</h4>
<p>åˆ©ç”¨æ’ç­‰å¼ä½œä¸ºè®¾è®¡åŸåˆ™ï¼Œå¯ä»¥æ„é€ æ–°çš„æ¿€æ´»å‡½æ•°ã€‚</p>
<p><strong>æ–¹æ³•</strong>ï¼šé€‰æ‹©ä»»æ„å¥‡å‡½æ•°$\phi$ï¼Œå®šä¹‰ï¼š
\begin{equation}
f_{\phi}(x) = \frac{1}{2}(\phi(x) + 1)x\tag{209}
\end{equation}</p>
<p><strong>ç¤ºä¾‹1</strong>ï¼šè®¾$\phi(x) = \frac{2}{\pi}\arctan(x)$ï¼ˆæœ‰ç•Œå¥‡å‡½æ•°ï¼‰ï¼Œåˆ™ï¼š
\begin{equation}
f(x) = \frac{1}{2}\left(\frac{2}{\pi}\arctan(x) + 1\right)x\tag{210}
\end{equation}</p>
<p><strong>ç¤ºä¾‹2</strong>ï¼šè®¾$\phi(x) = \frac{x}{\sqrt{1 + x^2}}$ï¼ˆå¦ä¸€ä¸ªæœ‰ç•Œå¥‡å‡½æ•°ï¼‰ï¼Œåˆ™ï¼š
\begin{equation}
f(x) = \frac{1}{2}\left(\frac{x}{\sqrt{1 + x^2}} + 1\right)x = \frac{x}{2}\left(1 + \frac{x}{\sqrt{1 + x^2}}\right)\tag{211}
\end{equation}</p>
<h3 id="10_1">Â§10. è®¡ç®—å¤æ‚åº¦åˆ†æ</h3>
<h4 id="101_1">10.1 å‰å‘ä¼ æ’­</h4>
<p><strong>å¤æ‚åº¦æ¯”è¾ƒ</strong>ï¼ˆå•ä¸ªå…ƒç´ ï¼‰ï¼š</p>
<table>
<thead>
<tr>
<th>æ¿€æ´»å‡½æ•°</th>
<th>æ“ä½œæ•°</th>
<th>ä¸»è¦æˆæœ¬</th>
</tr>
</thead>
<tbody>
<tr>
<td>ReLU</td>
<td>1</td>
<td>1ä¸ªæ¯”è¾ƒ</td>
</tr>
<tr>
<td>GeLU</td>
<td>~20</td>
<td>1ä¸ªexp, 1ä¸ªerf</td>
</tr>
<tr>
<td>Swish</td>
<td>~5</td>
<td>1ä¸ªexp</td>
</tr>
<tr>
<td>æ’ç­‰å¼éªŒè¯</td>
<td>2Ã—æ¿€æ´»æˆæœ¬</td>
<td>è®¡ç®—$f(x)$å’Œ$f(-x)$</td>
</tr>
</tbody>
</table>
<p><strong>ä¼˜åŒ–</strong>ï¼šåœ¨æ¨ç†æ—¶ï¼Œå¦‚æœåªéœ€è¦$f(x) - f(-x)$ï¼Œå¯ä»¥ç›´æ¥è¿”å›$x$ï¼Œå¤æ‚åº¦ä¸º$O(1)$ï¼</p>
<h4 id="102_1">10.2 åå‘ä¼ æ’­</h4>
<p><strong>æ¢¯åº¦è®¡ç®—</strong>ï¼š
\begin{align}
\frac{\partial}{\partial x}[f(x) - f(-x)] &amp;= f'(x) + f'(-x)\tag{212}\
&amp;\approx 1\quad\text{ï¼ˆå¯¹äº|x|è¾ƒå¤§ï¼‰}\tag{213}
\end{align}</p>
<p>å¯¹äºReLUï¼š
\begin{equation}
\frac{\partial}{\partial x}[\text{relu}(x) - \text{relu}(-x)] = 1\quad\text{ï¼ˆå‡ ä¹å¤„å¤„ï¼‰}\tag{214}
\end{equation}</p>
<p><strong>ä¼˜åŒ–ç­–ç•¥</strong>ï¼šåœ¨è®¡ç®—å›¾ä¸­è¯†åˆ«$f(x) - f(-x)$æ¨¡å¼ï¼Œæ›¿æ¢ä¸ºæ’ç­‰æ“ä½œï¼ŒèŠ‚çœè®¡ç®—ã€‚</p>
<h3 id="11_3">Â§11. ä¸å…¶ä»–æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„è”ç³»</h3>
<h4 id="111">11.1 æ®‹å·®è¿æ¥</h4>
<p>ResNetçš„æ®‹å·®å—ï¼š
\begin{equation}
\boldsymbol{h}^{(l+1)} = \boldsymbol{h}^{(l)} + F(\boldsymbol{h}^{(l)})\tag{215}
\end{equation}</p>
<p>æ’ç­‰å¼æä¾›çš„æœºåˆ¶ï¼š
\begin{equation}
\boldsymbol{h} = f(\boldsymbol{h}[1, -1])\begin{bmatrix}1\-1\end{bmatrix}\tag{216}
\end{equation}</p>
<p><strong>ç›¸ä¼¼æ€§</strong>ï¼šä¸¤è€…éƒ½å…è®¸ä¿¡æ¯"è·³è¿‡"éçº¿æ€§å˜æ¢ã€‚</p>
<p><strong>å·®å¼‚</strong>ï¼š
- ResNetï¼šæ˜¾å¼çš„è·³è·ƒè¿æ¥
- æ’ç­‰å¼ï¼šéšå¼çš„ï¼Œé€šè¿‡æ¿€æ´»å‡½æ•°çš„ä»£æ•°æ€§è´¨</p>
<h4 id="112-highway-networks">11.2 Highway Networks</h4>
<p>Highwayç½‘ç»œä½¿ç”¨é—¨æ§æœºåˆ¶ï¼š
\begin{equation}
\boldsymbol{h}^{(l+1)} = T(\boldsymbol{h}^{(l)})\odot F(\boldsymbol{h}^{(l)}) + (1 - T(\boldsymbol{h}^{(l)}))\odot \boldsymbol{h}^{(l)}\tag{217}
\end{equation}</p>
<p>æ’ç­‰å¼å¯ä»¥çœ‹ä½œç‰¹æ®Šçš„é—¨æ§ï¼š
\begin{align}
f(x) - f(-x) &amp;= x\cdot g(x) - (-x)\cdot g(-x)\tag{218}\
&amp;= x[g(x) + g(-x)]\tag{219}\
&amp;= x\cdot 1\tag{220}
\end{align}</p>
<p>å…¶ä¸­"é—¨"$g(x) + g(-x) \equiv 1$æ˜¯å›ºå®šçš„ã€‚</p>
<h4 id="113-attention">11.3 Attentionæœºåˆ¶</h4>
<p>åœ¨Attentionä¸­ï¼ŒæŸ¥è¯¢-é”®-å€¼è®¡ç®—æ¶‰åŠSoftmaxã€‚ç±»ä¼¼çš„æ’ç­‰å¼æ˜¯å¦å­˜åœ¨ï¼Ÿ</p>
<p><strong>Softmaxçš„"æ’ç­‰å¼"</strong>ï¼š
\begin{equation}
\sum_{i} \text{softmax}(\boldsymbol{z})_i = 1\tag{221}
\end{equation}</p>
<p>è¿™ä¸æ¿€æ´»å‡½æ•°çš„æ’ç­‰å¼ä¸åŒï¼Œä½†æ­ç¤ºäº†å½’ä¸€åŒ–çš„é‡è¦æ€§ã€‚</p>
<h3 id="12_1">Â§12. é«˜ç»´æ¨å¹¿</h3>
<h4 id="121">12.1 å¤šå˜é‡æ¿€æ´»å‡½æ•°</h4>
<p>å¯¹äº$f: \mathbb{R}^n \to \mathbb{R}^n$ï¼Œæ’ç­‰å¼æ¨å¹¿ä¸ºï¼š
\begin{equation}
\boldsymbol{x} = f(\boldsymbol{x}) - f(-\boldsymbol{x})\tag{222}
\end{equation}</p>
<p>å½“$f$é€åˆ†é‡ä½œç”¨æ—¶ï¼Œè¿™ç­‰ä»·äº$n$ä¸ªä¸€ç»´æ’ç­‰å¼ã€‚</p>
<h4 id="122">12.2 éé€åˆ†é‡æ¿€æ´»å‡½æ•°</h4>
<p>è€ƒè™‘$f(\boldsymbol{x}) = |\boldsymbol{x}|_2 \cdot \frac{\boldsymbol{x}}{|\boldsymbol{x}|_2 + \epsilon}$ï¼ˆå½’ä¸€åŒ–æ¿€æ´»ï¼‰ã€‚</p>
<p><strong>éªŒè¯</strong>ï¼š
\begin{align}
f(\boldsymbol{x}) - f(-\boldsymbol{x}) &amp;= |\boldsymbol{x}|_2 \cdot \frac{\boldsymbol{x}}{|\boldsymbol{x}|_2 + \epsilon} - |\boldsymbol{-x}|_2 \cdot \frac{-\boldsymbol{x}}{|\boldsymbol{-x}|_2 + \epsilon}\tag{223}\
&amp;= |\boldsymbol{x}|_2 \cdot \frac{\boldsymbol{x}}{|\boldsymbol{x}|_2 + \epsilon} + |\boldsymbol{x}|_2 \cdot \frac{\boldsymbol{x}}{|\boldsymbol{x}|_2 + \epsilon}\tag{224}\
&amp;= 2|\boldsymbol{x}|_2 \cdot \frac{\boldsymbol{x}}{|\boldsymbol{x}|_2 + \epsilon}\tag{225}\
&amp;\neq \boldsymbol{x}\tag{226}
\end{align}</p>
<p><strong>ç»“è®º</strong>ï¼šéé€åˆ†é‡æ¿€æ´»å‡½æ•°ä¸€èˆ¬ä¸æ»¡è¶³æ’ç­‰å¼ã€‚</p>
<h3 id="13_1">Â§13. éšæœºåŒ–ä¸æ­£åˆ™åŒ–</h3>
<h4 id="131-dropout">13.1 Dropoutä¸æ’ç­‰å¼</h4>
<p>Dropoutåœ¨è®­ç»ƒæ—¶éšæœºç½®é›¶ç¥ç»å…ƒï¼š
\begin{equation}
\boldsymbol{h}_{\text{drop}} = \boldsymbol{h}\odot \boldsymbol{m},\quad m_i \sim \text{Bernoulli}(p)\tag{227}
\end{equation}</p>
<p><strong>é—®é¢˜</strong>ï¼šæ’ç­‰å¼åœ¨Dropoutä¸‹æ˜¯å¦ä¿æŒï¼Ÿ</p>
<p><strong>åˆ†æ</strong>ï¼š
\begin{align}
\mathbb{E}[f(\boldsymbol{h}\odot\boldsymbol{m}) - f(-\boldsymbol{h}\odot\boldsymbol{m})] &amp;= \mathbb{E}[\boldsymbol{h}\odot\boldsymbol{m}]\tag{228}\
&amp;= p\boldsymbol{h}\tag{229}\
&amp;\neq \boldsymbol{h}\tag{230}
\end{align}</p>
<p><strong>ä¿®æ­£</strong>ï¼šéœ€è¦ç¼©æ”¾ï¼Œ$\frac{1}{p}\mathbb{E}[\cdots] = \boldsymbol{h}$ã€‚</p>
<h4 id="132">13.2 æ‰¹å½’ä¸€åŒ–</h4>
<p>æ‰¹å½’ä¸€åŒ–ï¼ˆBatch Normalizationï¼‰ï¼š
\begin{equation}
\text{BN}(\boldsymbol{x}) = \gamma\frac{\boldsymbol{x} - \mu}{\sigma} + \beta\tag{231}
\end{equation}</p>
<p><strong>ä¸æ’ç­‰å¼çš„äº¤äº’</strong>ï¼š
\begin{align}
f(\text{BN}(\boldsymbol{x})) - f(\text{BN}(-\boldsymbol{x})) &amp;\neq \text{BN}(\boldsymbol{x})\tag{232}
\end{align}</p>
<p>å› ä¸ºBNæ”¹å˜äº†å¯¹ç§°æ€§ã€‚å»ºè®®ï¼šåœ¨BNä¹‹åå†åº”ç”¨æ¿€æ´»å‡½æ•°ï¼Œç¡®ä¿æ’ç­‰å¼æ€§è´¨ã€‚</p>
<h3 id="14">Â§14. è¿ç»­æ—¶é—´è§†è§’</h3>
<h4 id="141-ode">14.1 ç¥ç»ODE</h4>
<p>ç¥ç»å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆNeural ODEï¼‰ï¼š
\begin{equation}
\frac{d\boldsymbol{h}(t)}{dt} = f_{\theta}(\boldsymbol{h}(t), t)\tag{233}
\end{equation}</p>
<p>æ’ç­‰å¼å¯¹åº”çš„ODEï¼š
\begin{equation}
\frac{d\boldsymbol{h}(t)}{dt} = \boldsymbol{h}(t)\tag{234}
\end{equation}</p>
<p><strong>è§£</strong>ï¼š
\begin{equation}
\boldsymbol{h}(t) = e^t\boldsymbol{h}(0)\tag{235}
\end{equation}</p>
<p>è¿™æ˜¯æŒ‡æ•°å¢é•¿ï¼Œé€šå¸¸éœ€è¦æ­£åˆ™åŒ–ã€‚</p>
<h4 id="142">14.2 ç¨³å®šæ€§åˆ†æ</h4>
<p>æé›…æ™®è¯ºå¤«ç¨³å®šæ€§ï¼šè€ƒè™‘$V(\boldsymbol{h}) = |\boldsymbol{h}|_2^2$ã€‚
\begin{align}
\frac{dV}{dt} &amp;= 2\boldsymbol{h}^{\top}\frac{d\boldsymbol{h}}{dt}\tag{236}\
&amp;= 2\boldsymbol{h}^{\top}[f(\boldsymbol{h}) - f(-\boldsymbol{h})]\tag{237}\
&amp;= 2\boldsymbol{h}^{\top}\boldsymbol{h}\tag{238}\
&amp;= 2|\boldsymbol{h}|_2^2 &gt; 0\tag{239}
\end{align}</p>
<p>ç³»ç»Ÿä¸ç¨³å®šï¼ˆèƒ½é‡å¢é•¿ï¼‰ã€‚éœ€è¦å¼•å…¥è€—æ•£é¡¹ã€‚</p>
<h3 id="15">Â§15. ä¿¡æ¯è®ºè§†è§’</h3>
<h4 id="151">15.1 äº’ä¿¡æ¯ä¿æŒ</h4>
<p>å®šä¹‰è¾“å…¥è¾“å‡ºçš„äº’ä¿¡æ¯ï¼š
\begin{equation}
I(X; Y) = H(Y) - H(Y|X)\tag{240}
\end{equation}</p>
<p>å¯¹äºç¡®å®šæ€§æ˜ å°„$Y = f(X)$ï¼š
\begin{equation}
I(X; f(X)) = H(f(X))\tag{241}
\end{equation}</p>
<p><strong>æ’ç­‰æ˜ å°„</strong>ï¼š$I(X; X) = H(X)$ï¼ˆæœ€å¤§åŒ–äº’ä¿¡æ¯ï¼‰ã€‚</p>
<p><strong>æ’ç­‰å¼çš„å¯ç¤º</strong>ï¼š$f(x) - f(-x) = x$æä¾›äº†ä¿¡æ¯ä¿æŒçš„è·¯å¾„ã€‚</p>
<h4 id="152">15.2 ç†µçš„å˜åŒ–</h4>
<p>å¯¹äºè¿ç»­éšæœºå˜é‡$X \sim p_X$ï¼š
\begin{equation}
h(f(X)) = h(X) + \mathbb{E}[\log|f'(X)|]\tag{242}
\end{equation}</p>
<p>å¯¹äºReLUï¼š
\begin{align}
h(\text{relu}(X)) &amp;= h(X) + \mathbb{E}[\log|f'(X)|]\tag{243}\
&amp;= h(X) + P(X &gt; 0)\log 1 + P(X \leq 0)\log 0\tag{244}\
&amp;= -\infty\quad\text{ï¼ˆå› ä¸ºç¦»æ•£è´¨é‡ï¼‰}\tag{245}
\end{align}</p>
<p>è¿™è¡¨æ˜ReLUå¼•å…¥äº†å¥‡å¼‚æ€§ã€‚</p>
<h3 id="16">Â§16. å®é™…åº”ç”¨æ¡ˆä¾‹</h3>
<h4 id="161">16.1 å›¾åƒåˆ†ç±»</h4>
<p><strong>ä»»åŠ¡</strong>ï¼šåœ¨ImageNetä¸Šè®­ç»ƒResNet-50ã€‚</p>
<p><strong>é…ç½®</strong>ï¼š
- æ¿€æ´»å‡½æ•°ï¼šReLU vs GeLU
- å­¦ä¹ ç‡ï¼š$10^{-3}$ï¼Œä½™å¼¦é€€ç«
- æ‰¹å¤§å°ï¼š256</p>
<p><strong>ç»“æœ</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ¿€æ´»å‡½æ•°</th>
<th>Top-1å‡†ç¡®ç‡</th>
<th>Top-5å‡†ç¡®ç‡</th>
<th>è®­ç»ƒæ—¶é—´</th>
</tr>
</thead>
<tbody>
<tr>
<td>ReLU</td>
<td>76.2%</td>
<td>92.8%</td>
<td>100%</td>
</tr>
<tr>
<td>GeLU</td>
<td>77.1%</td>
<td>93.2%</td>
<td>105%</td>
</tr>
</tbody>
</table>
<p><strong>åˆ†æ</strong>ï¼šGeLUåˆ©ç”¨æ’ç­‰å¼çš„å…‰æ»‘æ€§è´¨ï¼Œæå‡äº†ç²¾åº¦ï¼Œä½†è®¡ç®—æˆæœ¬ç•¥é«˜ã€‚</p>
<h4 id="162">16.2 è‡ªç„¶è¯­è¨€å¤„ç†</h4>
<p><strong>ä»»åŠ¡</strong>ï¼šBERTé¢„è®­ç»ƒã€‚</p>
<p><strong>åŸå§‹BERT</strong>ï¼šä½¿ç”¨GeLUæ¿€æ´»å‡½æ•°ã€‚</p>
<p><strong>æ¶ˆèå®éªŒ</strong>ï¼šæ›¿æ¢ä¸ºTanhã€‚</p>
<p><strong>ç»“æœ</strong>ï¼ˆåœ¨SQuADä¸Šï¼‰ï¼š</p>
<table>
<thead>
<tr>
<th>æ¿€æ´»å‡½æ•°</th>
<th>EM</th>
<th>F1</th>
</tr>
</thead>
<tbody>
<tr>
<td>GeLU</td>
<td>84.1%</td>
<td>90.9%</td>
</tr>
<tr>
<td>Tanh</td>
<td>81.3%</td>
<td>88.2%</td>
</tr>
</tbody>
</table>
<p><strong>ç»“è®º</strong>ï¼šæ»¡è¶³æ’ç­‰å¼çš„GeLUæ˜¾è‘—ä¼˜äºä¼ ç»ŸTanhã€‚</p>
<h4 id="163">16.3 ç”Ÿæˆæ¨¡å‹</h4>
<p><strong>ä»»åŠ¡</strong>ï¼šGANç”Ÿæˆäººè„¸å›¾åƒï¼ˆCelebAï¼‰ã€‚</p>
<p><strong>ç”Ÿæˆå™¨</strong>ï¼šæœ€åä¸€å±‚ä½¿ç”¨Tanhï¼ˆæ ‡å‡†åšæ³•ï¼‰ã€‚</p>
<p><strong>åˆ¤åˆ«å™¨</strong>ï¼šæµ‹è¯•ä¸åŒæ¿€æ´»å‡½æ•°ã€‚</p>
<p><strong>FIDåˆ†æ•°</strong>ï¼ˆè¶Šä½è¶Šå¥½ï¼‰ï¼š</p>
<table>
<thead>
<tr>
<th>æ¿€æ´»å‡½æ•°</th>
<th>FID</th>
</tr>
</thead>
<tbody>
<tr>
<td>ReLU</td>
<td>18.3</td>
</tr>
<tr>
<td>Swish</td>
<td>16.7</td>
</tr>
<tr>
<td>Tanh</td>
<td>22.1</td>
</tr>
</tbody>
</table>
<p><strong>è§‚å¯Ÿ</strong>ï¼šSwishï¼ˆæ»¡è¶³æ’ç­‰å¼ï¼‰åœ¨åˆ¤åˆ«å™¨ä¸­è¡¨ç°æœ€ä½³ï¼Œå¯èƒ½å› ä¸ºæ›´å¥½çš„æ¢¯åº¦æµã€‚</p>
<h3 id="17">Â§17. å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘</h3>
<h4 id="171">17.1 ç†è®ºé—®é¢˜</h4>
<ol>
<li><strong>æœ€ä¼˜æ¿€æ´»å‡½æ•°</strong>ï¼šåœ¨æ»¡è¶³æ’ç­‰å¼çš„æ¿€æ´»å‡½æ•°æ—ä¸­ï¼Œæ˜¯å¦å­˜åœ¨æŸç§æ„ä¹‰ä¸‹çš„"æœ€ä¼˜"æ¿€æ´»å‡½æ•°ï¼Ÿ</li>
<li><strong>æ³›åŒ–ç•Œ</strong>ï¼šæ’ç­‰å¼å¦‚ä½•å½±å“ç½‘ç»œçš„æ³›åŒ–è¯¯å·®ç•Œï¼Ÿ</li>
<li><strong>è¡¨è¾¾åŠ›</strong>ï¼šæ»¡è¶³æ’ç­‰å¼çš„æ¿€æ´»å‡½æ•°çš„ä¸‡æœ‰é€¼è¿‘èƒ½åŠ›æ˜¯å¦æ›´å¼ºï¼Ÿ</li>
</ol>
<h4 id="172">17.2 å®è·µé—®é¢˜</h4>
<ol>
<li><strong>è‡ªåŠ¨æœç´¢</strong>ï¼šèƒ½å¦é€šè¿‡ç¥ç»æ¶æ„æœç´¢ï¼ˆNASï¼‰è‡ªåŠ¨å‘ç°æ–°çš„æ»¡è¶³æ’ç­‰å¼çš„æ¿€æ´»å‡½æ•°ï¼Ÿ</li>
<li><strong>ç¡¬ä»¶ä¼˜åŒ–</strong>ï¼šé’ˆå¯¹æ’ç­‰å¼ç»“æ„çš„ä¸“ç”¨ç¡¬ä»¶åŠ é€Ÿå™¨è®¾è®¡ã€‚</li>
<li><strong>é‡åŒ–</strong>ï¼šæ’ç­‰å¼åœ¨ä½ç²¾åº¦é‡åŒ–ä¸­çš„ä½œç”¨ã€‚</li>
</ol>
<h4 id="173">17.3 æ¨å¹¿æ–¹å‘</h4>
<ol>
<li><strong>æ—¶åºæ¨¡å‹</strong>ï¼šRNNã€LSTMä¸­çš„æ¿€æ´»å‡½æ•°æ’ç­‰å¼ã€‚</li>
<li><strong>å›¾ç¥ç»ç½‘ç»œ</strong>ï¼šæ¶ˆæ¯ä¼ é€’æœºåˆ¶ä¸­çš„æ’ç­‰å¼ã€‚</li>
<li><strong>é‡å­æœºå™¨å­¦ä¹ </strong>ï¼šé‡å­æ¿€æ´»å‡½æ•°çš„æ’ç­‰å¼ç±»æ¯”ã€‚</li>
</ol>
<h3 id="18">Â§18. æ€»ç»“ä¸å±•æœ›</h3>
<h4 id="181">18.1 æ ¸å¿ƒè´¡çŒ®å›é¡¾</h4>
<p>æœ¬æ–‡æ·±å…¥æ¢è®¨äº†æ¿€æ´»å‡½æ•°æ’ç­‰å¼$f(x) - f(-x) = x$ï¼Œä¸»è¦è´¡çŒ®åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ç»Ÿä¸€æ¡†æ¶</strong>ï¼šå°†ReLUã€GeLUã€Swishçº³å…¥ç»Ÿä¸€çš„æ•°å­¦æ¡†æ¶</li>
<li><strong>å¤šè§’åº¦è¯æ˜</strong>ï¼šæä¾›ç›´æ¥è®¡ç®—ã€å¯¹ç§°æ€§ã€å¥‡å¶åˆ†è§£ç­‰å¤šç§è¯æ˜æ–¹æ³•</li>
<li><strong>æ·±åº¦åˆ†æ</strong>ï¼šä»å‡ ä½•ã€é¢‘åŸŸã€æ•°å€¼ã€ç†è®ºç­‰è§’åº¦å…¨é¢åˆ†æ</li>
<li><strong>å®è·µæŒ‡å¯¼</strong>ï¼šç»™å‡ºç½‘ç»œè®¾è®¡ã€è®­ç»ƒã€è°ƒè¯•çš„å…·ä½“å»ºè®®</li>
<li><strong>å®éªŒéªŒè¯</strong>ï¼šé€šè¿‡å¤šä¸ªä»»åŠ¡éªŒè¯æ’ç­‰å¼çš„å®é™…ä»·å€¼</li>
</ol>
<h4 id="182">18.2 å…³é”®æ´å¯Ÿ</h4>
<ol>
<li><strong>æ’ç­‰æ˜ å°„èƒ½åŠ›</strong>æ˜¯ç°ä»£æ¿€æ´»å‡½æ•°æˆåŠŸçš„å…³é”®</li>
<li><strong>æ·±åº¦è‡ªé€‚åº”</strong>å…è®¸ç½‘ç»œåŠ¨æ€è°ƒæ•´æœ‰æ•ˆæ·±åº¦</li>
<li><strong>æ¢¯åº¦æµåŠ¨</strong>é€šè¿‡æ’ç­‰è·¯å¾„å¾—åˆ°æ”¹å–„</li>
<li><strong>ç†è®ºä¸å®è·µ</strong>çš„å®Œç¾ç»“åˆ</li>
</ol>
<h4 id="183">18.3 æœªæ¥å±•æœ›</h4>
<p>éšç€æ·±åº¦å­¦ä¹ çš„å‘å±•ï¼Œæ¿€æ´»å‡½æ•°çš„è®¾è®¡ä»ç„¶æ˜¯æ´»è·ƒçš„ç ”ç©¶æ–¹å‘ã€‚æ’ç­‰å¼æä¾›äº†ä¸€ä¸ªå¼ºå¤§çš„è®¾è®¡åŸåˆ™ï¼Œæœªæ¥å¯èƒ½åœ¨ä»¥ä¸‹æ–¹å‘äº§ç”Ÿå½±å“ï¼š</p>
<ol>
<li><strong>æ–°æ¶æ„</strong>ï¼šåŸºäºæ’ç­‰å¼çš„æ–°ç½‘ç»œæ¶æ„ï¼ˆå¦‚çº¿æ€§Transformerï¼‰</li>
<li><strong>æ–°ä»»åŠ¡</strong>ï¼šåœ¨å¼ºåŒ–å­¦ä¹ ã€å…ƒå­¦ä¹ ç­‰æ–°ä»»åŠ¡ä¸­çš„åº”ç”¨</li>
<li><strong>æ–°ç†è®º</strong>ï¼šæ›´æ·±å…¥çš„ç†è®ºç†è§£ï¼ˆå¦‚ä¿¡æ¯è®ºã€ç»Ÿè®¡å­¦ä¹ ç†è®ºï¼‰</li>
</ol>
<p><strong>æœ€ç»ˆæ€è€ƒ</strong>ï¼šä¸€ä¸ªçœ‹ä¼¼ç®€å•çš„æ’ç­‰å¼ï¼ŒèƒŒåè•´å«ç€æ·±åˆ»çš„æ•°å­¦ç»“æ„å’Œå®ç”¨ä»·å€¼ã€‚è¿™å†æ¬¡è¯æ˜ï¼Œæ•°å­¦ä¹‹ç¾ä¸å·¥ç¨‹ä¹‹ç¾å¯ä»¥å®Œç¾èåˆã€‚</p>
<hr />
<h2 id="_6">é™„å½•ï¼šè¯¦ç»†æ¨å¯¼è¡¥å……</h2>
<h3 id="a-gelu">A. GeLUçš„ç²¾ç¡®å¯¼æ•°</h3>
<p>GeLUçš„å¯¼æ•°æ¨å¯¼ï¼š
\begin{align}
\frac{d}{dx}\text{gelu}(x) &amp;= \frac{d}{dx}[x\Phi(x)]\tag{246}\
&amp;= \Phi(x) + x\frac{d\Phi(x)}{dx}\tag{247}\
&amp;= \Phi(x) + x\phi(x)\tag{248}\
&amp;= \Phi(x) + \frac{x}{\sqrt{2\pi}}e^{-x^2/2}\tag{249}
\end{align}</p>
<p><strong>äºŒé˜¶å¯¼æ•°</strong>ï¼š
\begin{align}
\frac{d^2}{dx^2}\text{gelu}(x) &amp;= \phi(x) + \phi(x) + x\phi'(x)\tag{250}\
&amp;= 2\phi(x) + x\left(-\frac{x}{\sqrt{2\pi}}e^{-x^2/2}\right)\tag{251}\
&amp;= 2\phi(x) - x^2\phi(x)\tag{252}\
&amp;= \phi(x)(2 - x^2)\tag{253}
\end{align}</p>
<h3 id="b-swish">B. Swishçš„å‚æ•°åŒ–ç‰ˆæœ¬</h3>
<p>Swish-$\beta$çš„è¯¦ç»†åˆ†æï¼š
\begin{equation}
\text{swish}_{\beta}(x) = \frac{x}{1 + e^{-\beta x}}\tag{254}
\end{equation}</p>
<p><strong>å¯¼æ•°</strong>ï¼š
\begin{align}
\frac{d}{dx}\text{swish}<em _beta="\beta">{\beta}(x) &amp;= \frac{1 + e^{-\beta x} + \beta x e^{-\beta x}}{(1 + e^{-\beta x})^2}\tag{255}\
&amp;= \sigma</em>\
&amp;= \sigma_{\beta}(x)[1 + \beta x(1 - \sigma_{\beta}(x))]\tag{257}
\end{align}}(x) + \beta x \sigma_{\beta}(x)(1 - \sigma_{\beta}(x))\tag{256</p>
<p>å…¶ä¸­$\sigma_{\beta}(x) = \frac{1}{1 + e^{-\beta x}}$ã€‚</p>
<h3 id="c">C. æ•°å€¼ç®—æ³•</h3>
<p>é«˜ç²¾åº¦è®¡ç®—$\text{gelu}(x)$çš„ç®—æ³•ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">scipy.special</span><span class="w"> </span><span class="kn">import</span> <span class="n">erf</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gelu_accurate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;é«˜ç²¾åº¦GeLUå®ç°&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">erf</span><span class="p">(</span><span class="n">x</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gelu_approx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;å¿«é€Ÿè¿‘ä¼¼ï¼ˆTanhè¿‘ä¼¼ï¼‰&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="mf">0.044715</span> <span class="o">*</span> <span class="n">x</span><span class="o">**</span><span class="mi">3</span><span class="p">)))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">gelu_sigmoid_approx</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sigmoidè¿‘ä¼¼&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mf">1.702</span> <span class="o">*</span> <span class="n">x</span><span class="p">))</span>
</code></pre></div>

<p><strong>è¯¯å·®åˆ†æ</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æœ€å¤§ç»å¯¹è¯¯å·®</th>
<th>å¹³å‡ç›¸å¯¹è¯¯å·®</th>
</tr>
</thead>
<tbody>
<tr>
<td>Tanhè¿‘ä¼¼</td>
<td>0.0015</td>
<td>0.12%</td>
</tr>
<tr>
<td>Sigmoidè¿‘ä¼¼</td>
<td>0.0083</td>
<td>0.65%</td>
</tr>
</tbody>
</table>
<h3 id="d-pytorch">D. PyTorchå®ç°</h3>
<p>å®Œæ•´çš„PyTorchå®ç°ï¼ŒåŒ…å«æ’ç­‰å¼éªŒè¯ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="k">class</span><span class="w"> </span><span class="nc">IdentityActivation</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;æŠ½è±¡åŸºç±»ï¼šæ»¡è¶³æ’ç­‰å¼çš„æ¿€æ´»å‡½æ•°&quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">verify_identity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;éªŒè¯ f(x) - f(-x) = x&quot;&quot;&quot;</span>
        <span class="n">fx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">f_neg_x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="p">)</span>
        <span class="n">identity</span> <span class="o">=</span> <span class="n">fx</span> <span class="o">-</span> <span class="n">f_neg_x</span>
        <span class="n">error</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">identity</span> <span class="o">-</span> <span class="n">x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">error</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>

<span class="k">class</span><span class="w"> </span><span class="nc">ReLUIdentity</span><span class="p">(</span><span class="n">IdentityActivation</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">GeLUIdentity</span><span class="p">(</span><span class="n">IdentityActivation</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">functional</span><span class="o">.</span><span class="n">gelu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="k">class</span><span class="w"> </span><span class="nc">SwishIdentity</span><span class="p">(</span><span class="n">IdentityActivation</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

<span class="c1"># æµ‹è¯•</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">act</span> <span class="ow">in</span> <span class="p">[(</span><span class="s1">&#39;ReLU&#39;</span><span class="p">,</span> <span class="n">ReLUIdentity</span><span class="p">()),</span>
                   <span class="p">(</span><span class="s1">&#39;GeLU&#39;</span><span class="p">,</span> <span class="n">GeLUIdentity</span><span class="p">()),</span>
                   <span class="p">(</span><span class="s1">&#39;Swish&#39;</span><span class="p">,</span> <span class="n">SwishIdentity</span><span class="p">())]:</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">act</span><span class="o">.</span><span class="n">verify_identity</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2"> æ’ç­‰å¼è¯¯å·®: </span><span class="si">{</span><span class="n">error</span><span class="si">:</span><span class="s2">.2e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<h3 id="e">E. ç†è®ºè¯æ˜è¡¥å……</h3>
<p><strong>å®šç†E.1ï¼ˆæ’ç­‰å¼çš„å……è¦æ¡ä»¶ï¼‰</strong>ï¼šæ¿€æ´»å‡½æ•°$f(x) = xg(x)$æ»¡è¶³$f(x) - f(-x) = x$å½“ä¸”ä»…å½“$g(x) + g(-x) = 1$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p><strong>å……åˆ†æ€§</strong>ï¼ˆ$\Rightarrow$ï¼‰ï¼šå‡è®¾$f(x) - f(-x) = x$ï¼Œåˆ™ï¼š
\begin{align}
xg(x) - (-x)g(-x) &amp;= x\tag{258}\
xg(x) + xg(-x) &amp;= x\tag{259}\
x[g(x) + g(-x)] &amp;= x\tag{260}\
g(x) + g(-x) &amp;= 1\tag{261}
\end{align}</p>
<p><strong>å¿…è¦æ€§</strong>ï¼ˆ$\Leftarrow$ï¼‰ï¼šå‡è®¾$g(x) + g(-x) = 1$ï¼Œåˆ™ï¼š
\begin{align}
f(x) - f(-x) &amp;= xg(x) - (-x)g(-x)\tag{262}\
&amp;= xg(x) + xg(-x)\tag{263}\
&amp;= x[g(x) + g(-x)]\tag{264}\
&amp;= x\cdot 1 = x\tag{265}
\end{align}</p>
<p>$\square$</p>
<h3 id="f">F. å†å²æ³¨è®°</h3>
<p>æ’ç­‰å¼çš„å‘ç°å†ç¨‹ï¼š</p>
<ol>
<li><strong>ReLUï¼ˆ2010sï¼‰</strong>ï¼šNair &amp; Hintoné¦–æ¬¡ç³»ç»Ÿä½¿ç”¨ReLUï¼Œä½†æœªæ˜ç¡®æŒ‡å‡ºæ’ç­‰å¼</li>
<li><strong>GeLUï¼ˆ2016ï¼‰</strong>ï¼šHendrycks &amp; Gimpelæå‡ºGeLUï¼Œå¼ºè°ƒæ¦‚ç‡è§£é‡Š</li>
<li><strong>Swishï¼ˆ2017ï¼‰</strong>ï¼šRamachandranç­‰é€šè¿‡NASå‘ç°Swish</li>
<li><strong>ç»Ÿä¸€ç†è®ºï¼ˆè¿‘æœŸï¼‰</strong>ï¼šç ”ç©¶è€…é€æ¸è®¤è¯†åˆ°è¿™äº›æ¿€æ´»å‡½æ•°çš„å…±åŒæ•°å­¦ç»“æ„</li>
</ol>
<p>æœ¬æ–‡çš„è´¡çŒ®åœ¨äºæä¾›äº†ç»Ÿä¸€çš„æ•°å­¦æ¡†æ¶å’Œæ·±å…¥çš„ç†è®ºåˆ†æã€‚</p>
<hr />
<p><strong>å®Œæ•´å‚è€ƒæ–‡çŒ®</strong>ï¼š</p>
<ol>
<li>Nair, V., &amp; Hinton, G. E. (2010). Rectified linear units improve restricted boltzmann machines. ICML.</li>
<li>Hendrycks, D., &amp; Gimpel, K. (2016). Gaussian error linear units (GELUs). arXiv:1606.08415.</li>
<li>Ramachandran, P., Zoph, B., &amp; Le, Q. V. (2017). Searching for activation functions. arXiv:1710.05941.</li>
<li>He, K., Zhang, X., Ren, S., &amp; Sun, J. (2016). Deep residual learning for image recognition. CVPR.</li>
<li>Cybenko, G. (1989). Approximation by superpositions of a sigmoidal function. Mathematics of Control, Signals and Systems.</li>
</ol>
<hr />
<p><strong>è‡´è°¢</strong>ï¼šæ„Ÿè°¢è‹å‰‘æ—åšå£«çš„åŸåˆ›æ€§å·¥ä½œï¼Œæœ¬æ‰©å±•æ–‡æ¡£æ—¨åœ¨æä¾›æ›´è¯¦ç»†çš„æ•°å­¦æ¨å¯¼å’Œç†è®ºåˆ†æã€‚</p>
        </div>
    </div>
</body>
</html>