<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AdamWçš„Weight RMSçš„...</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>AdamWçš„Weight RMSçš„...</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 39.1 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11307">https://spaces.ac.cn/archives/11307</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨<a href="/archives/11267">ã€Šä¸ºä»€ä¹ˆAdamçš„Update RMSæ˜¯0.2ï¼Ÿã€‹</a>ä¸­ï¼Œæˆ‘ä»¬ç”¨å¹³å‡åœºè¿‘ä¼¼ä¼°è®¡äº†Adamçš„Update RMSã€‚ä¸ä¹…åï¼Œè¯»è€… <a href="https://x.com/EIFY/status/1965888629814988984">@EIFY</a> æŒ‡å‡ºç›¸åŒçš„ç»“æœå·²ç»å‡ºç°åœ¨è®ºæ–‡<a href="https://papers.cool/arxiv/2305.17212">ã€ŠRotational Equilibrium: How Weight Decay Balances Learning Across Neural Networksã€‹</a>ä¸­ã€‚é˜…è¯»åï¼Œç¬”è€…å‘ç°å…¶ä¸­ä¸ä»…åŒ…å«äº†Update RMSçš„ä¼°è®¡ï¼Œè¿˜åŒ…å«äº†Weight RMSçš„ä¼°è®¡ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒAdamWè®­å‡ºæ¥çš„æ¨¡å‹ï¼Œå…¶æƒé‡çš„RMSæ˜¯å¯ä»¥äº‹å…ˆä¼°è®¡å‡ºæ¥ä¸€ä¸ªæ¸è¿‘ç»“æœçš„ã€‚å¤§å®¶ä¼šä¸ä¼šè§‰å¾—è¿™ä¸ªç»“è®ºæœ‰ç‚¹æ„å¤–ï¼Ÿåæ­£ç¬”è€…ç¬¬ä¸€æ¬¡çœ‹åˆ°å®ƒæ˜¯é¢‡ä¸ºæ„å¤–çš„ï¼Œç›´è§‰ä¸Šæƒé‡æ¨¡é•¿æ˜¯æ¨¡å‹æ ¹æ®è®­ç»ƒé›†è‡ªå·±å­¦å‡ºæ¥çš„ï¼Œç»“æœå®ƒå‘Šè¯‰æˆ‘è¿™å·²ç»éšè—åœ¨ä¼˜åŒ–å™¨çš„è¶…å‚ä¸­ï¼Œå¯è°“å¾ˆåç›´è§‰äº†ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬è¿˜æ˜¯ç”¨å¹³å‡åœºè¿‘ä¼¼æ–¹æ³•ï¼Œæ¥å¤ç°å¯¹Weight RMSçš„æ¸è¿‘ä¼°è®¡ã€‚</p>
<h2 id="_1">æ»‘åŠ¨è§†è§’</h2>
<p>é¦–å…ˆè¿˜æ˜¯æ¥å›é¡¾AdamWçš„æ›´æ–°è§„åˆ™ï¼š<br />
\begin{equation}\text{Adam}\color{skyblue}{\text{W}}:=\left\{\begin{aligned}<br />
&amp;\boldsymbol{m}<em t-1="t-1">t = \beta_1 \boldsymbol{m}</em>} + \left(1 - \beta_1\right) \boldsymbol{g<em t-1="t-1">t\\\<br />
&amp;\boldsymbol{v}_t = \beta_2 \boldsymbol{v}</em>} + \left(1 - \beta_2\right) \boldsymbol{g<em t-1="t-1">t^2\\\<br />
&amp;\hat{\boldsymbol{m}}_t = \boldsymbol{m}_t\left/\left(1 - \beta_1^t\right)\right.\\\<br />
&amp;\hat{\boldsymbol{v}}_t = \boldsymbol{v}_t\left/\left(1 - \beta_2^t\right)\right.\\\<br />
&amp;\boldsymbol{u}_t =\hat{\boldsymbol{m}}_t\left/\left(\sqrt{\hat{\boldsymbol{v}}_t} + \epsilon\right)\right.\\\<br />
&amp;\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>} - \eta_t (\boldsymbol{u<em t-1="t-1">t \color{skyblue}{ + \lambda_t \boldsymbol{\theta}</em>)}<br />
\end{aligned}\right.\end{equation}<br />
å†æ¬¡è¯´æ˜ï¼Œè¿™é‡ŒåŠ ç²—ç¬¦å·é»˜è®¤éƒ½æ˜¯$\mathbb{R}^d$çš„å‘é‡ï¼Œå‘é‡çš„ä¹˜é™¤ï¼ˆåŒ…æ‹¬å¹³æ–¹ã€å¼€æ ¹å·ï¼‰é»˜è®¤éƒ½æ˜¯Element-wiseçš„Hadamardç§¯/å•†ã€‚</p>
<p>è·Ÿ<a href="/archives/11267">ã€Šä¸ºä»€ä¹ˆAdamçš„Update RMSæ˜¯0.2ï¼Ÿã€‹</a>ä¸€æ ·ï¼Œæˆ‘ä»¬è€ƒè™‘$t\to\infty$ï¼ˆå¯¹äº$\beta_1,\beta_2$æ¥è¯´ï¼‰å’Œ$\epsilon\to 0$ï¼Œæ‰€ä»¥$\boldsymbol{u}<em t-1="t-1">t=\boldsymbol{m}_t/\sqrt{\boldsymbol{v}_t}$ã€‚æˆ‘ä»¬æš‚æ—¶å…ˆè€ƒè™‘$\eta_t,\lambda_t$éƒ½æ˜¯å¸¸æ•°çš„ä¾‹å­ï¼Œæ‰€ä»¥å®ƒä»¬çš„ä¸‹æ ‡å¯ä»¥çœç•¥æ‰ï¼Œå¹¶ä¸”è®°$\beta_3 = 1-\eta\lambda$ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\boldsymbol{\theta}_t = \beta_3\boldsymbol{\theta}</em>} + (1-\beta_3)(-\boldsymbol{u}_t/\lambda)\label{eq:ema-wd}\end{equation<br />
è¿™ä¸ªå¼å­è¡¨æ˜ï¼Œæˆ‘ä»¬å¯ä»¥ä»æ›´æ–°é‡çš„æ»‘åŠ¨å¹³å‡ï¼ˆExponential Moving Averageï¼ŒEMAï¼‰è§’åº¦æ¥ç†è§£Weight Decayã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆæœ‰æ„ä¹‰çš„è§†è§’è½¬æ¢ï¼Œæ˜¯<a href="https://papers.cool/arxiv/2405.13698">ã€ŠHow to set AdamWâ€™s weight decay as you scale model and dataset sizeã€‹</a>ã€<a href="https://papers.cool/arxiv/2505.13738">ã€ŠPower Lines: Scaling Laws for Weight Decay and Batch Size in LLM Pre-trainingã€‹</a>ç­‰å·¥ä½œçš„åŸºç¡€ã€‚</p>
<h2 id="_2">åŠ æƒå¹³å‡</h2>
<p>æ ¹æ®å¼$\eqref{eq:ema-wd}$ï¼Œæˆ‘ä»¬å¯ä»¥å°†$\boldsymbol{\theta}<em i="1">t$å±•å¼€ä¸ºåŠ æƒå¹³å‡å½¢å¼<br />
\begin{equation}\boldsymbol{\theta}_t = \beta_3^t\boldsymbol{\theta}_0 + (1-\beta_3)\sum</em>}^t \beta_3^{t-i} (-\boldsymbol{u<em i="1">i/\lambda)\label{eq:theta-t}\end{equation}<br />
åŒç†ï¼Œ$\boldsymbol{m}_t$å’Œ$\boldsymbol{v}_t$ä¹Ÿå¯ä»¥å±•å¼€ä¸º<br />
\begin{equation}\boldsymbol{m}_t = (1 - \beta_1)\sum</em>}^t \beta_1^{t-i}\boldsymbol{g<em i="1">i,\qquad \boldsymbol{v}_t = (1 - \beta_2)\sum</em>}^t \beta_2^{t-i}\boldsymbol{g}_i^2\label{eq:mv-roll}\end{equation<br />
è¿™é‡Œæœ‰ä¸ªå°ç»†èŠ‚ï¼Œ$\boldsymbol{\theta}_t$çš„è¡¨è¾¾å¼æˆ‘ä»¬ä¿ç•™äº†$\boldsymbol{\theta}_0$ï¼Œä½†$\boldsymbol{m}_t$å’Œ$\boldsymbol{v}_t$çš„è¡¨è¾¾å¼æˆ‘ä»¬æ²¡æœ‰ä¿ç•™$\boldsymbol{m}_0$å’Œ$\boldsymbol{v}_0$ï¼ŒåŸå› æœ‰ä¸¤ä¸ªï¼š1ã€$\boldsymbol{m}$å’Œ$\boldsymbol{v}$çš„åˆå§‹åŒ–ä¸€èˆ¬æ˜¯é›¶ï¼›2ã€å³ä¾¿å®ƒä»¬åˆå§‹åŒ–ä¸æ˜¯é›¶ï¼Œä½†å¯¹åº”çš„$\beta_1^t$å’Œ$\beta_2^t$ä¹Ÿä¼šè¶³å¤Ÿæ¥è¿‘äºé›¶ï¼Œå› æ­¤åˆå§‹åŒ–çš„å½±å“å¯ä»¥å¿½ç•¥ã€‚</p>
<p>ç„¶è€Œï¼Œ$\boldsymbol{\theta}$æ˜¯æ¨¡å‹æƒé‡ï¼Œå®ƒçš„åˆå§‹åŒ–é€šå¸¸ä¸æ˜¯é›¶ï¼Œå¹¶ä¸”$\beta_3$å¾€å¾€éå¸¸æ¥è¿‘äº1ï¼Œå¯¹äºæ•´ä¸ªè®­ç»ƒå‘¨æœŸè€Œè¨€ï¼Œ$\beta_3^t$ä¸ä¸€å®šèƒ½å……åˆ†æ¥è¿‘äºé›¶ï¼Œå› æ­¤æˆ‘ä»¬æ˜¾å¼ä¿ç•™$\beta_3^t$å’Œ$\boldsymbol{\theta}_0$ï¼ŒæŒ‰éœ€å–èˆã€‚</p>
<h2 id="_3">å¿«é€Ÿä¼°è®¡</h2>
<p>æˆ‘ä»¬çš„ä»»åŠ¡æ˜¯ä¼°è®¡Weight RMSï¼Œå³$\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>$ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯å„ä¸ªåˆ†é‡çš„Root Mean Squareï¼š<br />
\begin{equation}\Vert\boldsymbol{\theta}\Vert_{RMS} = \sqrt{\frac{1}{d}\sum_{i=1}^d \theta_i^2},\qquad\qquad \text{å…¶ä¸­ }\boldsymbol{\theta} = (\theta_1,\theta_2,\cdots,\theta_d)\end{equation}<br />
å®ƒè·Ÿæ¨¡é•¿çš„åŒºåˆ«å°±æ˜¯å¤šé™¤äº†ä¸ª$\sqrt{d}$ï¼Œæ‰€ä»¥æ¨¡é•¿çš„å¤§éƒ¨åˆ†æ€§è´¨å¯¹RMSåŒæ ·æˆç«‹ã€‚å¯¹äº$\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>^2$ï¼Œå¯ä»¥å¾—åˆ°}$ï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªå¿«é€Ÿä½†ä¸æ˜¯é‚£ä¹ˆå‡†ç¡®çš„æ¨å¯¼æ–¹å¼ï¼šç›´æ¥å¯¹å¼$\eqref{eq:ema-wd}$ä¸¤è¾¹æ±‚$\Vert\cdot\Vert_{RMS<br />
\begin{equation}\begin{aligned}<br />
\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>}^2 =&amp;\, \Vert\beta_3\boldsymbol{\theta<em RMS="RMS">{t-1} + (1-\beta_3)(-\boldsymbol{u}_t/\lambda)\Vert</em>^2 \\\[5pt]<br />
=&amp;\, \beta_3^2\Vert\boldsymbol{\theta}<em RMS="RMS">{t-1}\Vert</em>}^2 + (1-\beta_3)^2\Vert\boldsymbol{u<em RMS="RMS">t\Vert</em>}^2/\lambda^2 - 2\beta_3(1-\beta_3)\boldsymbol{\theta<em t-1="t-1">{t-1}\cdot\boldsymbol{u}_t/(\lambda d)<br />
\end{aligned}\end{equation}<br />
å‡è®¾$\boldsymbol{\theta}</em>},\boldsymbol{u<em t-1="t-1">t$è¿‘ä¹æ­£äº¤ï¼Œé‚£ä¹ˆ$\boldsymbol{\theta}</em>}\cdot\boldsymbol{u<em RMS="RMS">t\approx 0$ï¼Œè¿™åœ¨é«˜ç»´ç©ºé—´ä¸­é€šå¸¸æ˜¯ä¸€ä¸ªä¸é”™çš„è¿‘ä¼¼ï¼ˆå‚è€ƒ<a href="/archives/7076">ã€Šnç»´ç©ºé—´ä¸‹ä¸¤ä¸ªéšæœºå‘é‡çš„å¤¹è§’åˆ†å¸ƒã€‹</a>ï¼‰ï¼Œç„¶å$\Vert\boldsymbol{u}_t\Vert</em>}$æˆ‘ä»¬å·²ç»ç®—è¿‡äº†ï¼Œç­”æ¡ˆæ˜¯çº¦ç­‰äº$\sqrt{\frac{1-\beta_1}{1+\beta_1}}$ï¼Œæœ€åæˆ‘ä»¬è€ƒè™‘çš„æ˜¯è¶‹äºç¨³æ€çš„ç»“æœï¼Œæ‰€ä»¥$\Vert\boldsymbol{\theta<em RMS="RMS">t\Vert</em>}^2=\Vert\boldsymbol{\theta<em RMS="RMS">{t-1}\Vert</em>^2$ï¼Œäºæ˜¯æœ‰<br />
\begin{equation}(1-\beta_3^2)\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>}^2 \approx (1-\beta_3)^2 \frac{1-\beta_1}{1+\beta_1} /\lambda^2\qquad\Rightarrow\qquad \Vert\boldsymbol{\theta<em RMS="RMS">t\Vert</em>} \approx \sqrt{\frac{1-\beta_1}{1+\beta_1}\frac{\eta}{2\lambda}}\end{equation<br />
ä»å·¦å¼åˆ°å³å¼è¿˜ç”¨åˆ°äº†$\beta_3\approx 1$çš„è¿‘ä¼¼ã€‚æœ€åçš„ç»“æœä¼šæœ‰äº›è¯¯å·®ï¼Œå› ä¸º$\boldsymbol{\theta}<em RMS="RMS">t\cdot\boldsymbol{u}_t\approx 0$å®é™…ä¸Šå¹¶ä¸é‚£ä¹ˆæˆç«‹ï¼Œä½†$\Vert\boldsymbol{\theta}_t\Vert</em>$çš„ç»“è®ºæ˜¯æ­£ç¡®çš„ã€‚ç±»ä¼¼çš„æ¨å¯¼è¿˜å‡ºç°åœ¨}\propto \sqrt{\eta/\lambda<a href="https://papers.cool/arxiv/2506.02285">ã€ŠWhy Gradients Rapidly Increase Near the End of Trainingã€‹</a>ã€‚</p>
<h2 id="_4">æ›´å¥½è¿‘ä¼¼</h2>
<p>å¾ˆå¤šæƒ…å†µä¸‹æˆ‘ä»¬åªéœ€è¦çŸ¥é“$\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>$å°±è¡Œäº†ï¼Œè¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒé€šç”¨çš„ç»“è®ºã€‚è€Œå¯¹äºè¿½æ±‚æ›´å‡†ç¡®ç»“è®ºçš„è¯»è€…æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¹³å‡åœºæ–¹æ³•å¾—åˆ°ä¸€ä¸ªæ›´å¥½çš„è¿‘ä¼¼ï¼Œä»£ä»·æ˜¯è®¡ç®—è¿‡ç¨‹ä¼šå¤æ‚ä¸å°‘ï¼Œä½†å¥½å¤„æ˜¯æˆ‘ä»¬å¯ä»¥è·å¾—æ›´å¤šæ›´æ¸…æ™°çš„è®¤çŸ¥ã€‚}\propto \sqrt{\eta/\lambda</p>
<h3 id="_5">æ­¥éª¤ä¹‹ä¸€</h3>
<p>æˆ‘ä»¬ä»å¼$\eqref{eq:theta-t}$å‡ºå‘ï¼Œæ±‚å’Œè¿™ä¸€é¡¹ï¼Œæœ¬èº«å°±å…·æœ‰åŠ æƒå¹³å‡çš„å½¢å¼ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆç”¨ç¬¬ä¸€æ¬¡å¹³å‡åœºï¼š<br />
\begin{equation}\underbrace{\frac{1-\beta_3}{1-\beta_3^t}\sum_{i=1}^t \beta_3^{t-i} \boldsymbol{u}<em _text_è®°ä¸º="\text{è®°ä¸º">i}</em>}\bar{\boldsymbol{u}<em i="1">t} = \frac{1-\beta_3}{1-\beta_3^t}\sum</em>}^t \beta_3^{t-i} \frac{\boldsymbol{m<em i="1">i}{\sqrt{\boldsymbol{v}_i}}\approx \frac{\bar{\boldsymbol{m}}_t \,\,\triangleq\,\, \frac{1-\beta_3}{1-\beta_3^t}\sum</em>}^t \beta_3^{t-i}\boldsymbol{m<em i="1">i}{\sqrt{\bar{\boldsymbol{v}}_t \,\,\triangleq\,\, \frac{1-\beta_3}{1-\beta_3^t}\sum</em>}^t \beta_3^{t-i}\boldsymbol{v<em RMS="RMS">i}}\label{eq:u-bar}\end{equation}<br />
ç°åœ¨å†æ¬¡å›åˆ°å¼$\eqref{eq:theta-t}$ï¼Œç”±äº$\boldsymbol{\theta}_0$æ˜¯éšæœºçš„åˆå§‹åŒ–å‘é‡ï¼Œå› æ­¤å¯ä»¥å‡è®¾$\boldsymbol{\theta}_0$ä¸$\bar{\boldsymbol{u}}_t$æ­£äº¤ï¼Œäºæ˜¯æˆ‘ä»¬æœ‰<br />
\begin{equation}\Vert\boldsymbol{\theta}_t\Vert</em>}^2 \approx \beta_3^{2t}\Vert\boldsymbol{\theta<em RMS="RMS">0\Vert</em>}^2 + (1-\beta_3^t)^2 \lambda^{-2}\Vert \bar{\boldsymbol{u}<em RMS="RMS">t\Vert</em>}^2\end{equation<br />
ç°åœ¨æˆ‘ä»¬è¦æ±‚$\Vert \bar{\boldsymbol{u}}<em RMS="RMS">t\Vert</em>}^2$ï¼Œæ ¹æ®ä¹‹å‰çš„ç»éªŒï¼Œæˆ‘ä»¬éœ€è¦å‡è®¾$\boldsymbol{g<em RMS="RMS">j$ç‹¬ç«‹åŒåˆ†å¸ƒåœ°æœä»$\mathcal{N}(\boldsymbol{\mu},\boldsymbol{\sigma}^2)$ï¼Œç„¶åæ±‚<br />
\begin{equation}\mathbb{E}[\bar{\boldsymbol{u}}_t^2] \approx \mathbb{E}\left[\frac{\bar{\boldsymbol{m}}_t^2}{\bar{\boldsymbol{v}}_t}\right] \approx \frac{\mathbb{E}[\bar{\boldsymbol{m}}_t^2]}{\mathbb{E}[\bar{\boldsymbol{v}}_t]}\end{equation}<br />
æœ€åå†å¯¹$\mathbb{E}[\bar{\boldsymbol{u}}_t^2]$çš„å„ä¸ªåˆ†é‡æ±‚å¹³å‡ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä½œä¸º$\Vert \bar{\boldsymbol{u}}_t\Vert</em>^2$çš„è¿‘ä¼¼ã€‚</p>
<h3 id="_6">æ­¥éª¤ä¹‹äºŒ</h3>
<p>ç»“åˆå¼$\eqref{eq:mv-roll}$ï¼Œæˆ‘ä»¬å¾—åˆ°<br />
\begin{gather}<br />
\sum_{i=1}^t \beta_3^{t-i}\boldsymbol{m}<em i="1">i = (1 - \beta_1)\sum</em>}^t \beta_3^{t-i} \sum_{j=1}^i \beta_1^{i-j}\boldsymbol{g<em j="1">j = (1 - \beta_1)\sum</em>}^t \frac{\beta_3^{t-j+1} - \beta_1^{t-j+1}}{\beta_3 - \beta_1}\boldsymbol{g<em i="1">j\\\<br />
\sum</em>}^t \beta_3^{t-i}\boldsymbol{v<em i="1">i = (1 - \beta_2)\sum</em>}^t \beta_3^{t-i} \sum_{j=1}^i \beta_2^{i-j}\boldsymbol{g<em j="1">j^2 = (1 - \beta_2)\sum</em>}^t \frac{\beta_3^{t-j+1} - \beta_2^{t-j+1}}{\beta_3 - \beta_2}\boldsymbol{g<em RMS="RMS">j^2\\\<br />
\end{gather}<br />
æœ€åä¸€ä¸ªåŒé‡æ±‚å’ŒåŒ–ç®€ï¼Œå¦‚æœå¤§å®¶æ²¡æœ‰æ€è·¯ï¼Œå¯ä»¥äº¤ç»™Kimiå®Œæˆï¼ˆå‚è€ƒ<a href="https://www.kimi.com/share/d3d35hpsfuv6jqe78c20">é“¾æ¥</a>ï¼‰ã€‚ç”±ä¸Šå¼å¯çŸ¥$\bar{\boldsymbol{m}}_t,\bar{\boldsymbol{v}}_t$åˆ†åˆ«æ˜¯æ¢¯åº¦å’Œæ¢¯åº¦å¹³æ–¹çš„åŠ æƒå¹³å‡ï¼Œæ‰€ä»¥æ±‚$\Vert \bar{\boldsymbol{u}}_t\Vert</em>^2$è·Ÿ<a href="/archives/11267">ã€Šä¸ºä»€ä¹ˆAdamçš„Update RMSæ˜¯0.2ï¼Ÿã€‹</a>æ±‚$\Vert \boldsymbol{u}<em RMS="RMS">t\Vert</em>^2$æœ¬è´¨ä¸Šæ˜¯ä¸€æ ·çš„ï¼Œåªä¸è¿‡åŠ æƒç³»æ•°ä¸åŒã€‚</p>
<h3 id="_7">æ­¥éª¤ä¹‹ä¸‰</h3>
<p>æˆ‘ä»¬å…ˆæ±‚åˆ†æ¯<br />
\begin{equation}\begin{aligned}<br />
\mathbb{E}[\bar{\boldsymbol{v}}<em j="1">t] =&amp;\, \frac{(1 - \beta_3)(1 - \beta_2)}{1 - \beta_3^t}\sum</em>}^t \frac{\beta_3^{t-j+1} - \beta_2^{t-j+1}}{\beta_3 - \beta_2}\mathbb{E}[\boldsymbol{g<em j="1">j^2] \\\<br />
=&amp;\, \frac{(1 - \beta_3)(1 - \beta_2)}{1 - \beta_3^t}\sum</em>^2) \\\}^t \frac{\beta_3^{t-j+1} - \beta_2^{t-j+1}}{\beta_3 - \beta_2}(\boldsymbol{\mu}^2 + \boldsymbol{\sigma<br />
=&amp;\, \frac{(1 - \beta_3)(1 - \beta_2)}{(1 - \beta_3^t)(\beta_3 - \beta_2)}\left(\frac{\beta_3 - \beta_3^{t+1}}{1 - \beta_3} - \frac{\beta_2 - \beta_2^{t+1}}{1 - \beta_2}\right)(\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2) \\\[5pt]<br />
\approx &amp;\, \boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2<br />
\end{aligned}\end{equation}<br />
æœ€åä¸€æ­¥çš„çº¦ç­‰å·ï¼Œæ˜¯å› ä¸ºå®é™…è®­ç»ƒä¸­ï¼Œ$\beta_3$ä¼šè¶³å¤Ÿæ¥è¿‘äº1ï¼Œè€Œ$\beta_2^{t+1}$ä¼šè¶³å¤Ÿæ¥è¿‘äº0ï¼Œä½†$\beta_3^{t+1}$ä¸ä¸€å®šï¼Œæ‰€ä»¥æˆ‘ä»¬å°†$\beta_2^{t+1}$æ›¿æ¢æˆé›¶ï¼Œå¹¶åœ¨åŒ–ç®€ä¹‹åå°†ç‹¬ç«‹çš„$\beta_3$æ›¿æ¢æˆ$1$ï¼Œæœ€åå†åŠ ä¸Šè¿‘ä¼¼$\beta_3^{t+1}\approx \beta_3^t$ã€‚</p>
<h3 id="_8">æ­¥éª¤ä¹‹å››</h3>
<p>ç„¶åæ˜¯$\mathbb{E}[\bar{\boldsymbol{m}}<em j="1">t^2] = \mathbb{E}[\bar{\boldsymbol{m}}_t]^2 + \mathbb{V}ar[\bar{\boldsymbol{m}}_t]$ï¼Œ$\mathbb{E}[\bar{\boldsymbol{m}}_t]$çš„è®¡ç®—è·Ÿ$\mathbb{E}[\bar{\boldsymbol{v}}_t]$ç±»ä¼¼ï¼Œç»“æœæ˜¯$\boldsymbol{\mu}$ï¼Œ$\mathbb{V}ar[\bar{\boldsymbol{m}}_t]$çš„è®¡ç®—æˆ‘ä»¬åˆ™åˆ©ç”¨æ–¹å·®çš„å¹³æ–¹å¯åŠ æ€§ï¼š<br />
\begin{equation}\begin{aligned}<br />
\mathbb{V}ar[\bar{\boldsymbol{m}}_t] =&amp;\, \frac{(1 - \beta_3)^2(1 - \beta_1)^2}{(1-\beta_3^t)^2}\sum</em>}^t \left(\frac{\beta_3^{t-j+1} - \beta_1^{t-j+1}}{\beta_3 - \beta_1}\right)^2\mathbb{V}ar[\boldsymbol{g<em j="1">j] \\\<br />
=&amp;\, \frac{(1 - \beta_3)^2(1 - \beta_1)^2}{(1-\beta_3^t)^2}\sum</em>^2 \\\}^t \left(\frac{\beta_3^{t-j+1} - \beta_1^{t-j+1}}{\beta_3 - \beta_1}\right)^2 \boldsymbol{\sigma<br />
=&amp;\, \frac{(1 - \beta_3)^2(1 - \beta_1)^2}{(1-\beta_3^t)^2(\beta_3 - \beta_1)^2}\left(\frac{\beta_3^2 - \beta_3^{2(t+1)}}{1 - \beta_3^2} + \frac{\beta_1^2 - \beta_1^{2(t+1)}}{1 - \beta_1^2} - 2\frac{\beta_1\beta_3 - \beta_1^{t+1}\beta_3^{t+1}}{1 - \beta_1\beta_3}\right) \boldsymbol{\sigma}^2 \\\[5pt]<br />
\approx &amp;\, (1 - \beta_3)(1 + \beta_3^t)\boldsymbol{\sigma}^2/2(1 - \beta_3^t)<br />
\end{aligned}\end{equation}<br />
å–çº¦ç­‰å·çš„ç†ç”±åŒä¸Šã€‚</p>
<h3 id="_9">æ­¥éª¤ä¹‹äº”</h3>
<p>ä»£å…¥ä¸Šä¸¤èŠ‚çš„è®¡ç®—ç»“æœï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\mathbb{E}[\bar{\boldsymbol{u}}<em RMS="RMS">t^2] \approx \frac{\boldsymbol{\mu}^2 + (1 - \beta_3)(1 + \beta_3^t)\boldsymbol{\sigma}^2/2(1 - \beta_3^t)}{\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2}\end{equation}<br />
é‚£ä¹ˆ<br />
\begin{equation}\Vert\bar{\boldsymbol{u}}_t\Vert</em>}^2 \approx \frac{\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2 + (1 - \beta_3)(1 + \beta_3^t)/2(1 - \beta_3^t)}{\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2 + 1} \end{equation<br />
æœ€ç»ˆæœ‰<br />
\begin{equation}\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>}^2 \approx \beta_3^{2t}\Vert\boldsymbol{\theta<em RMS="RMS">0\Vert</em>}^2 + (1-\beta_3^t)^2 \frac{\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2 + (1 - \beta_3)(1 + \beta_3^t)/2(1 - \beta_3^t)}{\lambda^2(\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2 + 1)}\label{eq:theta-rms}\end{equation</p>
<h2 id="_10">ç»“æœæµ…æ</h2>
<p>å¼$\eqref{eq:theta-rms}$çœ‹èµ·æ¥æ¯”è¾ƒå¤æ‚ï¼Œæˆ‘ä»¬è§‚å¯Ÿå‡ ä¸ªç‰¹ä¾‹ã€‚é¦–å…ˆè€ƒè™‘$\boldsymbol{\mu}=\boldsymbol{0}$è¿™ä¸ªä¾‹å­ï¼Œæ­¤æ—¶<br />
\begin{equation}\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>}^2 \approx \beta_3^{2t}\Vert\boldsymbol{\theta<em RMS="RMS">0\Vert</em>}^2 + (1-\beta_3^{2t}) (1 - \beta_3)/2\lambda^2 = \beta_3^{2t}\Vert\boldsymbol{\theta<em RMS="RMS">0\Vert</em>}^2 + (1-\beta_3^{2t}) \eta/2\lambda\label{eq:theta-rms-mu0}\end{equation<br />
ç‰¹åˆ«åœ°ï¼Œå¦‚æœè€ƒè™‘$t\to\infty$ï¼Œæˆ–è€…$\Vert\boldsymbol{\theta}<em RMS="RMS">0\Vert</em>^2$å°±åˆå§‹åŒ–ä¸º$\eta/2\lambda$ï¼Œé‚£ä¹ˆå°±æœ‰<br />
\begin{equation}\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>} \approx \sqrt{\frac{\eta}{2\lambda}}\label{eq:theta-rms-simple}\end{equation<br />
è¿™ä¾¿æ˜¯è®ºæ–‡<a href="https://papers.cool/arxiv/2305.17212">ã€ŠRotational Equilibrium: How Weight Decay Balances Learning Across Neural Networksã€‹</a>ç»™å‡ºçš„ç»“æœï¼Œè·ŸåŸè®ºæ–‡çš„å‡è®¾ä¸€è‡´ï¼Œå®ƒæ˜¯é›¶å‡å€¼ä¸‹çš„éšæœºæ¸¸èµ°çš„ç¨³æ€ç»“æœã€‚å¦‚æœä¸è€ƒè™‘$t\to\infty$ï¼Œè€Œæ˜¯è€ƒè™‘$\lambda\to 0$çš„æé™ï¼Œé‚£ä¹ˆç”±å¼$\eqref{eq:theta-rms-mu0}$æˆ‘ä»¬å°†å¾—åˆ°<br />
\begin{equation}\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>}^2 \approx \Vert\boldsymbol{\theta<em RMS="RMS">0\Vert</em>}^2 + \eta^2 t\end{equation<br />
è¿™è¡¨æ˜åœ¨æ²¡æœ‰Weight Decayçš„æ—¶å€™ï¼Œ$\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>$å¾—}$å¤§è‡´æŒ‰ç…§$\eta\sqrt{t}$çš„é€Ÿåº¦å¢é•¿ï¼Œè¿™ä¹Ÿè¡¨æ˜åœ¨æ²¡æœ‰Weight Decayæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®ç‰¹å®šçš„å­¦ä¹ ç‡Scheduleæ¥å®ç°Weight RMSçš„ç¨³å®šæ€§ã€‚å¦ä¸€æ–¹é¢ï¼Œå¦‚æœBatch Sizeè¶³å¤Ÿå¤§ï¼Œå¯¼è‡´ä¿¡å™ªæ¯”é¡¹$\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2$å ä¸»å¯¼ï¼Œé‚£ä¹ˆç”±å¼$\eqref{eq:theta-rms<br />
\begin{equation}\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>}^2 \approx \beta_3^{2t}\Vert\boldsymbol{\theta<em RMS="RMS">0\Vert</em>}^2 + (1-\beta_3^t)^2 \frac{\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2}{\lambda^2(\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2 + 1)}\end{equation<br />
è¿™ä¸ªå¯èƒ½é€‚ç”¨äºæ¨¡å‹éœ€è¦ä¸»åŠ¨å¢åŠ Weight RMSçš„ç‰¹æ®Šæƒ…å½¢ã€‚ä¸è¿‡ä»ç»éªŒæ¥çœ‹ï¼Œè¿™ç§æƒ…å†µå‘ç”Ÿçš„æ¦‚ç‡ä¸€èˆ¬æ¯”è¾ƒå°ã€‚</p>
<h2 id="_11">æ¨¡æ‹Ÿå®éªŒ</h2>
<p>æˆ‘ä»¬å¯ä»¥ç”¨å¦‚ä¸‹æ¨¡æ‹Ÿè„šæœ¬ï¼Œæ¥ç®€å•éªŒè¯ä¸Šè¿°çš„å‡†ç¡®æ€§ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">N</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">100000</span>
<span class="n">beta1</span><span class="p">,</span> <span class="n">beta2</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span>
<span class="n">m</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">*</span> <span class="mf">0.1</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">beta1</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta1</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">beta2</span> <span class="o">*</span> <span class="n">v</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta2</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">w</span> <span class="o">=</span> <span class="n">w</span> <span class="o">-</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">/</span> <span class="n">v</span><span class="o">**</span><span class="mf">0.5</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">w</span><span class="p">)</span>

<span class="n">weight_rms</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="kp">mean</span><span class="p">()</span><span class="o">**</span><span class="mf">0.5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">weight_rms</span><span class="p">)</span>
</code></pre></div>

<p>å¤§å®¶å¯ä»¥è‡ªè¡Œæ”¹å˜æƒé‡çš„åˆå§‹åŒ–æˆ–æ¢¯åº¦çš„å‡å€¼æ–¹å·®ç­‰ï¼Œçœ‹æœ€ç»ˆç»“æœè·Ÿå¼$\eqref{eq:theta-rms}$çš„å»åˆç¨‹åº¦ï¼Œç¬”è€…è‡ªè¡Œè¯•äº†ä¸€æ³¢ï¼Œæ•´ä½“æ¥è¯´è¿˜æ˜¯æ¯”è¾ƒé è°±çš„ã€‚</p>
<h2 id="_12">ç¬¦å·ç‰ˆæœ¬</h2>
<p>åªéœ€è¦å°†å‰è¿°è¯æ˜è°ƒæ•´ä¸€ä¸‹ï¼Œå°±å¯ä»¥é€‚ç”¨äºâ€œSignSGDM + Weight Decayâ€çš„ç»„åˆï¼š<br />
\begin{equation}\text{SignSGDM}\color{skyblue}{\text{W}}:=\left\{\begin{aligned}<br />
&amp;\boldsymbol{m}<em t-1="t-1">t = \beta_1 \boldsymbol{m}</em>} + \left(1 - \beta_1\right) \boldsymbol{g<em t-1="t-1">t\\\<br />
&amp;\boldsymbol{u}_t = \newcommand{sign}{\mathop{\text{sign}}}\sign(\boldsymbol{m}_t)\\\<br />
&amp;\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>} - \eta_t (\boldsymbol{u<em t-1="t-1">t \color{skyblue}{ + \lambda_t \boldsymbol{\theta}</em>)}<br />
\end{aligned}\right.\end{equation}<br />
ä¿®æ”¹çš„åœ°æ–¹æ˜¯ç”±äº$\sign(\boldsymbol{m}<em i="1">t)=\boldsymbol{m}_t/\sqrt{\boldsymbol{m}_t^2}$ï¼Œæ‰€ä»¥è¦å°†$\bar{\boldsymbol{v}}_t$çš„å®šä¹‰æ”¹ä¸º<br />
\begin{equation}\bar{\boldsymbol{v}}_t \triangleq \frac{1-\beta_3}{1-\beta_3^t}\sum</em>}^t \beta_3^{t-i}\boldsymbol{m<em i="1">i^2\end{equation}<br />
é‚£ä¹ˆ<br />
\begin{equation}\mathbb{E}[\bar{\boldsymbol{v}}_t] = \frac{1-\beta_3}{1-\beta_3^t}\sum</em>}^t \beta_3^{t-i}\mathbb{E}[\boldsymbol{m<em i="1">i^2] \approx \frac{1-\beta_3}{1-\beta_3^t}\sum</em>}^t \beta_3^{t-i}\mathbb{E}\left(\boldsymbol{\mu}^2 + \frac{1-\beta_1}{1 + \beta_1}\boldsymbol{\sigma}^2\right) = \boldsymbol{\mu}^2 + \frac{1-\beta_1}{1 + \beta_1}\boldsymbol{\sigma}^2\end{equation<br />
å…¶ä¸­$\mathbb{E}[\boldsymbol{m}<em RMS="RMS">i^2]$çš„è®¡ç®—æˆ‘ä»¬å‚è€ƒ<a href="/archives/11267">ã€Šä¸ºä»€ä¹ˆAdamçš„Update RMSæ˜¯0.2ï¼Ÿã€‹</a>æˆ–<a href="/archives/11301">ã€Šé‡æ–°æ€è€ƒå­¦ä¹ ç‡ä¸Batch Sizeï¼ˆå››ï¼‰ï¼šEMAã€‹</a>éƒ½è¡Œã€‚åˆ©ç”¨ä¸Šè¿°ç»“æœï¼Œæˆ‘ä»¬å¾—åˆ°<br />
\begin{equation}\Vert\boldsymbol{\theta}_t\Vert</em>}^2 \approx \beta_3^{2t}\Vert\boldsymbol{\theta<em RMS="RMS">0\Vert</em>}^2 + (1-\beta_3^t)^2 \frac{\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2 + (1 - \beta_3)(1 + \beta_3^t)/2(1 - \beta_3^t)}{\lambda^2\left(\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2 + \frac{1-\beta_1}{1 + \beta_1}\right)}\end{equation<br />
ç‰¹åˆ«åœ°ï¼Œè€ƒè™‘$\boldsymbol{\mu}=0,t\to\infty$çš„æé™ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>}^2 \approx \sqrt{\frac{\eta}{2\lambda}\frac{1+\beta_1}{1 - \beta_1}}\end{equation<br />
è¿™ä¸ªç»“æœä¹Ÿå¾ˆåˆç†ï¼Œå› ä¸ºSignSGDMWçš„Update RMSæ˜¯AdamWçš„$\sqrt{\frac{1+\beta_1}{1 - \beta_1}}$å€ï¼Œæ‰€ä»¥åŒæ ·$\eta,\lambda$ä¸‹å®ƒçš„Weight RMSä¹Ÿæ˜¯$\sqrt{\frac{1+\beta_1}{1 - \beta_1}}$å€ã€‚</p>
<h2 id="_13">ç›¸å…³åˆ†æ</h2>
<p>å‰é¢è¯´äº†ï¼Œç»“æœ$\eqref{eq:theta-rms-simple}$è·Ÿè®ºæ–‡<a href="https://papers.cool/arxiv/2305.17212">ã€ŠRotational Equilibrium: How Weight Decay Balances Learning Across Neural Networksã€‹</a>æ˜¯ä¸€è‡´çš„ï¼Œä½†æˆ‘ä»¬çš„æ¨å¯¼æ–¹æ³•æ˜¯å®Œå…¨ä¸åŒçš„ï¼Œå¹¶ä¸”èƒ½å¾—åˆ°æ›´ä¸€èˆ¬çš„$\eqref{eq:theta-rms}$ã€‚ä¸è¿‡ï¼ŒåŸè®ºæ–‡ä¹Ÿæœ‰ä¸€äº›å¾ˆæœ‰æ„æ€çš„åœ°æ–¹ï¼Œæ¯”å¦‚å®ƒæ‰€æçš„ <strong>Total Update Contribution (TUC)</strong> æ¦‚å¿µï¼Œå°±å€¼å¾—èµæä¸€ç•ªã€‚</p>
<p>TUCçš„æ€æƒ³æ˜¯è¿™æ ·çš„ï¼šç”±äºåŠ¨é‡æœºåˆ¶çš„å­˜åœ¨ï¼Œå½“å‰çš„æ¢¯åº¦$\boldsymbol{g}<em t_1="t+1">t$ä¸æ­¢åœç•™åœ¨å½“å‰æ­¥éª¤ï¼Œå®ƒè¿˜ä¼šå½±å“åˆ°æœªæ¥çš„æ­¥éª¤ï¼ˆä½†ä¼šæ‰“ä¸ªâ€œæŠ˜æ‰£â€ï¼‰ï¼Œæ‰€ä»¥å‡è®¾è®­ç»ƒæ­¥æ•°è¶‹äºæ— ç©·ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘å½“å‰æ¢¯åº¦$\boldsymbol{g}_t$å¯¹æ•´ä¸ªè®­ç»ƒè¿‡ç¨‹çš„<strong>æ€»è´¡çŒ®</strong> ã€‚å…·ä½“æ¥è¯´ï¼Œå¯¹äºAdamæˆ‘ä»¬æœ‰$\boldsymbol{u}_t=\boldsymbol{m}_t/\sqrt{\boldsymbol{v}_t}$ï¼Œå½“å‰$\boldsymbol{g}_t$å¯¹$\boldsymbol{u}_t$çš„è´¡çŒ®æ˜¯$(1-\beta_1)\boldsymbol{g}_t/\sqrt{\boldsymbol{v}_t}$ï¼Œä¸‹ä¸€æ­¥$\boldsymbol{g}_t$å°†ä¼šæ‰“ä¸ªæŠ˜æ‰£ï¼ˆä¹˜ä»¥$\beta_1$ï¼‰ï¼Œè€Œä¸”åˆ†æ¯æ”¹ä¸º$\boldsymbol{v}</em>$ï¼Œä¾æ­¤ç±»æ¨ï¼Œæ‰€ä»¥å¯ä»¥å®šä¹‰æ€»è´¡çŒ®ä¸º<br />
\begin{equation}\tilde{\boldsymbol{u}}<em k="t">t = \sum</em>}^{\infty} (1-\beta_1)\beta_1^{k-t}\frac{\boldsymbol{g<em RMS="RMS">t}{\sqrt{\boldsymbol{v}_k}}\end{equation}<br />
è¿™æ ·æˆ‘ä»¬å°±å°†æ›´æ–°$\boldsymbol{u}_1,\boldsymbol{u}_2,\boldsymbol{u}_3,\cdots$åˆ†è§£ä¸ºæ›´æ–°$\tilde{\boldsymbol{u}}_1,\tilde{\boldsymbol{u}}_2,\tilde{\boldsymbol{u}}_3,\cdots$ï¼Œè¿™æ ·çš„å¥½å¤„æ˜¯æ¯ä¸ª$\tilde{\boldsymbol{u}}$åªæœ‰å•æ­¥æ¢¯åº¦ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é‡å¤å¿«é€Ÿä¼°è®¡ä¸€èŠ‚çš„æ¨å¯¼ï¼š<br />
\begin{equation}\Vert\boldsymbol{\theta}_t\Vert</em>}^2 = \Vert\beta_3\boldsymbol{\theta<em RMS="RMS">{t-1} + (1-\beta_3)(-\tilde{\boldsymbol{u}}_t/\lambda)\Vert</em>}^2 \approx \beta_3^2\Vert\boldsymbol{\theta<em RMS="RMS">{t-1}\Vert</em>}^2 + (1-\beta_3)^2\Vert\tilde{\boldsymbol{u}<em RMS="RMS">t\Vert</em>}^2/\lambda^2 \label{eq:tilde-u-rms}\end{equation<br />
æœ€åçš„è¿‘ä¼¼ä¾èµ–äº$\boldsymbol{\theta}<em t-1="t-1">{t-1}\cdot\tilde{\boldsymbol{u}}_t\approx 0$ï¼Œæˆ‘ä»¬æ–­è¨€$\boldsymbol{\theta}</em>}\cdot\tilde{\boldsymbol{u}<em t-1="t-1">t$æ¯”$\boldsymbol{\theta}</em>}\cdot\boldsymbol{u<em t-1="t-1">t$æ›´æ¥è¿‘äºé›¶ï¼Œå› ä¸º$\tilde{\boldsymbol{u}}_t$åªä¾èµ–äºå½“å‰æ¢¯åº¦$\boldsymbol{g}_t$ï¼Œè€Œ$\boldsymbol{\theta}</em>}$è¿˜æ²¡æ¥è§¦åˆ°$\boldsymbol{g<em t-1="t-1">t$ï¼Œæ‰€ä»¥å®ƒä»¬æ˜¯ç‹¬ç«‹çš„å˜é‡ï¼Œå‡è®¾$\boldsymbol{g}_t$å…·æœ‰é›¶å‡å€¼æ—¶ï¼Œ$\boldsymbol{\theta}</em>}\cdot\tilde{\boldsymbol{u}<em RMS="RMS">t\approx 0$å¾€å¾€å°±å®¹æ˜“æˆç«‹äº†ã€‚è€Œä¸ºäº†ä¼°è®¡$\Vert\tilde{\boldsymbol{u}}_t\Vert</em>}^2$ï¼ŒåŸè®ºæ–‡ç›´æ¥å‡è®¾$\boldsymbol{g<em RMS="RMS">t/\sqrt{\boldsymbol{v}_k}$å…·æœ‰ç›¸åŒæ–¹å‘å¹¶ä¸”å•ä½RMSï¼Œäºæ˜¯<br />
\begin{equation}\Vert\tilde{\boldsymbol{u}}_t\Vert</em>} = \sum_{k=t}^{\infty} (1-\beta_1)\beta_1^{k-t}\left\Vert\frac{\boldsymbol{g<em RMS="RMS">t}{\sqrt{\boldsymbol{v}_k}}\right\Vert</em>} = \sum_{k=t}^{\infty} (1-\beta_1)\beta_1^{k-t} = 1\end{equation<br />
ä»£å…¥å¼$\eqref{eq:tilde-u-rms}$ï¼Œç»“åˆå¿«é€Ÿä¼°è®¡ä¸€èŠ‚åŒæ ·çš„è¿‘ä¼¼å¤„ç†ï¼Œè§£å¾—<br />
\begin{equation}\Vert\boldsymbol{\theta}<em RMS="RMS">t\Vert</em>} \approx \sqrt{\frac{\eta}{2\lambda}}\end{equation<br />
ç„¶è€Œï¼Œå¦‚æœå±€é™åœ¨åŸè®ºæ–‡çœ‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°æœ‰å¾ˆå¤šè¿‘ä¼¼æ˜¯è«åå…¶å¦™çš„ï¼Œæ¯”å¦‚$\boldsymbol{v}<em RMS="RMS">t$ä¸­ä¹Ÿæœ‰$\boldsymbol{g}_t$ï¼Œæ‰€ä»¥è¯´$\tilde{\boldsymbol{u}}_t$åªåŒ…å«å½“å‰$\boldsymbol{g}_t$çš„å½±å“æ˜¯ä¸å¤§å‡†ç¡®çš„ï¼Œè¿˜æœ‰$\Vert\boldsymbol{g}_t/\sqrt{\boldsymbol{v}_k}\Vert</em>=1$çš„æ–­è¨€ä¹Ÿæ˜¾å¾—æ¯”è¾ƒç”Ÿç¡¬ã€‚ä½†å¦‚æœæ”¾åˆ°æœ¬æ–‡æ¥çœ‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°åœ¨å¹³å‡åœºè¿‘ä¼¼ä¸‹ï¼ŒåŸè®ºæ–‡çš„å„ç§æ“ä½œä¼šæ˜¾å¾—å¾ˆåˆç†ï¼Œæ‰€ä»¥åŸè®ºæ–‡å…¶å®å·²ç»éšå«åœ°ç”¨åˆ°äº†å¹³å‡åœºæ–¹æ³•ã€‚</p>
<h2 id="_14">æ–‡ç« å°ç»“</h2>
<p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬ç”¨å¹³å‡åœºè¿‘ä¼¼æ¨å¯¼äº†ä¸€ä¸ªæœ‰è¶£ä¸”å¯èƒ½è®©äººæ„å¤–çš„ç»“è®ºï¼šAdamWè®­å‡ºæ¥çš„æ¨¡å‹ï¼Œå…¶æƒé‡çš„RMSä¹Ÿæ˜¯å¯ä»¥æ¸è¿‘ä¼°è®¡å‡ºæ¥çš„ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå®ƒåªä¾èµ–äºå­¦ä¹ ç‡å’ŒWeight Decayã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11307">https://spaces.ac.cn/archives/11307</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Oct. 01, 2025). ã€ŠAdamWçš„Weight RMSçš„æ¸è¿‘ä¼°è®¡ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11307">https://spaces.ac.cn/archives/11307</a></p>
<p>@online{kexuefm-11307,<br />
title={AdamWçš„Weight RMSçš„æ¸è¿‘ä¼°è®¡},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Oct},<br />
url={\url{https://spaces.ac.cn/archives/11307}},<br />
} </p>
<hr />
<h2 id="_15">è¯¦ç»†æ•°å­¦æ¨å¯¼</h2>
<h3 id="1-adamw">1. AdamWä¼˜åŒ–å™¨çš„å®Œæ•´æ¨å¯¼</h3>
<h4 id="11-adamadamw">1.1 ä»Adamåˆ°AdamWçš„æ¼”åŒ–</h4>
<p>Adamä¼˜åŒ–å™¨çš„åŸå§‹å½¢å¼ä¸ºï¼š
\begin{gather}
\boldsymbol{m}<em t-1="t-1">t = \beta_1 \boldsymbol{m}</em>} + (1-\beta_1)\boldsymbol{g<em t-1="t-1">t \tag{1} \
\boldsymbol{v}_t = \beta_2 \boldsymbol{v}</em>} + (1-\beta_2)\boldsymbol{g<em t-1="t-1">t^2 \tag{2} \
\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>
\end{gather}} - \eta \frac{\boldsymbol{m}_t}{\sqrt{\boldsymbol{v}_t}+\epsilon} \tag{3</p>
<p><strong>æ¨å¯¼æ³¨é‡Š</strong>ï¼šå…¬å¼(1)æ˜¯ä¸€é˜¶çŸ©ï¼ˆåŠ¨é‡ï¼‰çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡ï¼Œ$\beta_1$æ§åˆ¶å†å²æ¢¯åº¦çš„è¡°å‡é€Ÿåº¦ã€‚å…¬å¼(2)æ˜¯äºŒé˜¶çŸ©çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡ï¼Œç”¨äºè‡ªé€‚åº”è°ƒæ•´æ¯ä¸ªå‚æ•°çš„å­¦ä¹ ç‡ã€‚å…¬å¼(3)æ˜¯å‚æ•°æ›´æ–°è§„åˆ™ï¼Œåˆ†æ¯ä¸­çš„$\sqrt{\boldsymbol{v}_t}$æä¾›äº†è‡ªé€‚åº”çš„å­¦ä¹ ç‡ç¼©æ”¾ã€‚</p>
<p>AdamWçš„å…³é”®æ”¹è¿›æ˜¯å°†æƒé‡è¡°å‡ä»æ¢¯åº¦ä¸­è§£è€¦ï¼š
\begin{equation}
\boldsymbol{\theta}<em t-1="t-1">t = \boldsymbol{\theta}</em>} - \eta \left(\frac{\boldsymbol{m<em t-1="t-1">t}{\sqrt{\boldsymbol{v}_t}+\epsilon} + \lambda\boldsymbol{\theta}</em>
\end{equation}}\right) \tag{4</p>
<p><strong>å‡ ä½•ç›´è§‰</strong>ï¼šæƒé‡è¡°å‡é¡¹$\lambda\boldsymbol{\theta}_{t-1}$ä½¿å‚æ•°å‘åŸç‚¹æ”¶ç¼©ï¼Œè¿™åœ¨é«˜ç»´ç©ºé—´ä¸­æä¾›äº†ä¸€ä¸ª"å‘å¿ƒåŠ›"ï¼Œé˜²æ­¢å‚æ•°å‘é‡çš„æ¨¡é•¿æ— é™å¢é•¿ã€‚</p>
<h4 id="12">1.2 åå·®ä¿®æ­£çš„å¿…è¦æ€§</h4>
<p>åœ¨è®­ç»ƒåˆæœŸï¼Œç”±äº$\boldsymbol{m}_0=\boldsymbol{v}_0=\mathbf{0}$ï¼Œä¼°è®¡å€¼å­˜åœ¨åå·®ã€‚å¼•å…¥åå·®ä¿®æ­£ï¼š
\begin{gather}
\hat{\boldsymbol{m}}_t = \frac{\boldsymbol{m}_t}{1-\beta_1^t} \tag{5} \
\hat{\boldsymbol{v}}_t = \frac{\boldsymbol{v}_t}{1-\beta_2^t} \tag{6}
\end{gather}</p>
<p><strong>æ¨å¯¼</strong>ï¼šè€ƒè™‘$\boldsymbol{m}<em i="1">t$çš„æœŸæœ›å€¼ã€‚å‡è®¾æ¢¯åº¦çš„æœŸæœ›ä¸º$\mathbb{E}[\boldsymbol{g}_t]=\boldsymbol{\mu}$ï¼Œåˆ™ï¼š
\begin{align}
\mathbb{E}[\boldsymbol{m}_t] &amp;= \mathbb{E}\left[\sum</em>}^t (1-\beta_1)\beta_1^{t-i}\boldsymbol{g<em i="1">i\right] \notag \
&amp;= \boldsymbol{\mu}(1-\beta_1)\sum</em> \notag \
&amp;= \boldsymbol{\mu}(1-\beta_1^t) \tag{7}
\end{align}}^t \beta_1^{t-i</p>
<p>å› æ­¤ï¼Œ$\mathbb{E}[\hat{\boldsymbol{m}}_t] = \boldsymbol{\mu}$ï¼Œåå·®å¾—åˆ°ä¿®æ­£ã€‚</p>
<h3 id="2-weight-rms">2. Weight RMSçš„å¹³å‡åœºæ¨å¯¼</h3>
<h4 id="21">2.1 æ»‘åŠ¨å¹³å‡è§†è§’çš„æ·±å…¥åˆ†æ</h4>
<p>å®šä¹‰$\beta_3 = 1-\eta\lambda$ï¼Œå°†AdamWçš„æ›´æ–°æ”¹å†™ä¸ºï¼š
\begin{equation}
\boldsymbol{\theta}<em t-1="t-1">t = \beta_3\boldsymbol{\theta}</em>
\end{equation}} + (1-\beta_3)\left(-\frac{\boldsymbol{u}_t}{\lambda}\right) \tag{8</p>
<p>å…¶ä¸­$\boldsymbol{u}_t = \frac{\hat{\boldsymbol{m}}_t}{\sqrt{\hat{\boldsymbol{v}}_t}+\epsilon}$ã€‚</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šè¿™ä¸ªå½¢å¼æ­ç¤ºäº†æƒé‡è¡°å‡çš„æœ¬è´¨â€”â€”å®ƒä½¿å‚æ•°æˆä¸ºæ›´æ–°é‡çš„æŒ‡æ•°ç§»åŠ¨å¹³å‡ã€‚å‚æ•°ä¸ä¼šæ— é™åç¦»åŸç‚¹ï¼Œè€Œæ˜¯åœ¨$-\boldsymbol{u}_t/\lambda$é™„è¿‘æŒ¯è¡ã€‚</p>
<p>å±•å¼€é€’æ¨å…³ç³»ï¼š
\begin{align}
\boldsymbol{\theta}<em i="1">t &amp;= \beta_3^t\boldsymbol{\theta}_0 + (1-\beta_3)\sum</em>}^t \beta_3^{t-i}\left(-\frac{\boldsymbol{u<em i="1">i}{\lambda}\right) \tag{9} \
&amp;= \beta_3^t\boldsymbol{\theta}_0 - \frac{1-\beta_3}{\lambda}\sum</em>
\end{align}}^t \beta_3^{t-i}\boldsymbol{u}_i \tag{10</p>
<p><strong>é•¿æœŸè¡Œä¸ºåˆ†æ</strong>ï¼šå½“$t\to\infty$ä¸”$\beta_3$æ¥è¿‘1æ—¶ï¼Œ$\beta_3^t$é¡¹çš„è´¡çŒ®é€æ¸æ¶ˆå¤±ï¼Œå‚æ•°ä¸»è¦ç”±å†å²æ›´æ–°é‡çš„åŠ æƒå¹³å‡å†³å®šã€‚</p>
<h4 id="22">2.2 å¹³å‡åœºè¿‘ä¼¼çš„æ•°å­¦åŸºç¡€</h4>
<p>å¹³å‡åœºè¿‘ä¼¼çš„æ ¸å¿ƒå‡è®¾ï¼š
\begin{equation}
\frac{\sum_{i=1}^t w_i f(\boldsymbol{x}<em i="1">i)}{\sum</em>}^t w_i} \approx \frac{f\left(\sum_{i=1}^t w_i\boldsymbol{x<em i="1">i\right)}{\sum</em>
\end{equation}}^t w_i} \tag{11</p>
<p>è¿™åœ¨é«˜ç»´ç©ºé—´ä¸­æ˜¯åˆç†çš„ï¼Œå› ä¸ºï¼š
1. å¤§æ•°å®šå¾‹ï¼šå¤šä¸ªéšæœºå˜é‡çš„åŠ æƒå¹³å‡è¶‹äºå…¶æœŸæœ›
2. ä¸­å¿ƒæé™å®šç†ï¼šåŠ æƒå’Œè¿‘ä¼¼æœä»æ­£æ€åˆ†å¸ƒ
3. é«˜ç»´å‡ ä½•ï¼šåœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œå‘é‡é—´çš„å¤¹è§’è¶‹äºå‚ç›´</p>
<p>åº”ç”¨åˆ°æˆ‘ä»¬çš„é—®é¢˜ï¼š
\begin{align}
\bar{\boldsymbol{u}}<em i="1">t &amp;= \frac{\sum</em>}^t \beta_3^{t-i}\boldsymbol{u<em i="1">i}{\sum</em> \notag \
&amp;= \frac{\sum_{i=1}^t \beta_3^{t-i}\frac{\boldsymbol{m}}^t \beta_3^{t-i}<em i="1">i}{\sqrt{\boldsymbol{v}_i}}}{\sum</em> \notag \
&amp;\approx \frac{\sum_{i=1}^t \beta_3^{t-i}\boldsymbol{m}}^t \beta_3^{t-i}<em i="1">i}{\sqrt{\sum</em>
\end{align}}^t \beta_3^{t-i}\boldsymbol{v}_i}} = \frac{\bar{\boldsymbol{m}}_t}{\sqrt{\bar{\boldsymbol{v}}_t}} \tag{12</p>
<h3 id="3">3. æ”¶æ•›æ€§åˆ†æ</h3>
<h4 id="31">3.1 å‡¸ä¼˜åŒ–æƒ…å†µ</h4>
<p><strong>å®šç†1ï¼ˆå‡¸æƒ…å†µä¸‹çš„æ”¶æ•›é€Ÿåº¦ï¼‰</strong>ï¼šå‡è®¾æŸå¤±å‡½æ•°$L(\boldsymbol{\theta})$æ˜¯å‡¸çš„ä¸”$L$-å…‰æ»‘ï¼ˆå³æ¢¯åº¦Lipschitzè¿ç»­ï¼Œå¸¸æ•°ä¸º$L$ï¼‰ï¼Œåˆ™AdamWæ»¡è¶³ï¼š
\begin{equation}
\mathbb{E}[L(\bar{\boldsymbol{\theta}}_T)] - L(\boldsymbol{\theta}^*) \leq \frac{C}{\sqrt{T}} \tag{13}
\end{equation}</p>
<p>å…¶ä¸­$\bar{\boldsymbol{\theta}}<em t="1">T = \frac{1}{T}\sum</em>^*$æ˜¯æœ€ä¼˜è§£ï¼Œ$C$æ˜¯ä¸åˆå§‹åŒ–ã€å­¦ä¹ ç‡ç­‰ç›¸å…³çš„å¸¸æ•°ã€‚}^T \boldsymbol{\theta}_t$ï¼Œ$\boldsymbol{\theta</p>
<p><strong>è¯æ˜æ¦‚è¦</strong>ï¼š
åˆ©ç”¨å‡¸å‡½æ•°çš„æ€§è´¨$L(\boldsymbol{\theta}) \geq L(\boldsymbol{\theta}^<em>) + \nabla L(\boldsymbol{\theta}^</em>)\cdot(\boldsymbol{\theta}-\boldsymbol{\theta}^<em>)$ï¼Œç»“åˆAdamWçš„æ›´æ–°è§„åˆ™ï¼š
\begin{align}
&amp;\Vert\boldsymbol{\theta}_{t+1}-\boldsymbol{\theta}^</em>\Vert^2 \notag \
&amp;= \Vert\boldsymbol{\theta}_t-\boldsymbol{\theta}^<em>\Vert^2 - 2\eta_t\left(\frac{\boldsymbol{m}_t}{\sqrt{\boldsymbol{v}_t}}+\lambda\boldsymbol{\theta}_t\right)\cdot(\boldsymbol{\theta}_t-\boldsymbol{\theta}^</em>) + \mathcal{O}(\eta_t^2) \tag{14}
\end{align}</p>
<p>å¯¹æ—¶é—´æ±‚å’Œå¹¶åˆ©ç”¨$\boldsymbol{m}_t$å’Œ$\nabla L(\boldsymbol{\theta}_t)$çš„å…³ç³»ï¼Œå¯ä»¥å¾—åˆ°é—æ†¾ç•Œã€‚</p>
<h4 id="32">3.2 éå‡¸ä¼˜åŒ–æƒ…å†µ</h4>
<p><strong>å®šç†2ï¼ˆéå‡¸æƒ…å†µä¸‹çš„ä¸€é˜¶å¹³ç¨³ç‚¹ï¼‰</strong>ï¼šå¯¹äºéå‡¸ä½†å…‰æ»‘çš„å‡½æ•°ï¼ŒAdamWä¿è¯ï¼š
\begin{equation}
\min_{t\in[T]} \mathbb{E}\left[\Vert\nabla L(\boldsymbol{\theta}_t)\Vert\right] \leq \frac{C'}{\sqrt{T}} \tag{15}
\end{equation}</p>
<p>è¿™æ„å‘³ç€ç®—æ³•èƒ½å¤Ÿæ‰¾åˆ°æ¢¯åº¦æ¥è¿‘é›¶çš„ç‚¹ï¼ˆä¸€é˜¶å¹³ç¨³ç‚¹ï¼‰ã€‚</p>
<p><strong>å…³é”®å¼•ç†</strong>ï¼šæƒé‡è¡°å‡é¡¹æœ‰åŠ©äºé¿å…æ¢¯åº¦çˆ†ç‚¸ï¼š
\begin{equation}
\Vert\boldsymbol{\theta}_t\Vert \leq \frac{\Vert\boldsymbol{u}_t\Vert}{\lambda(1-\beta_3)} + \mathcal{O}(\beta_3^t) \tag{16}
\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼šä»$\boldsymbol{\theta}<em t-1="t-1">t = \beta_3\boldsymbol{\theta}</em>} - \eta(\boldsymbol{u<em t-1="t-1">t + \lambda\boldsymbol{\theta}</em>)$å‡ºå‘ï¼Œå–æ¨¡é•¿ï¼š
\begin{align}
\Vert\boldsymbol{\theta}<em t-1="t-1">t\Vert &amp;\leq \beta_3\Vert\boldsymbol{\theta}</em>}\Vert + \eta\Vert\boldsymbol{u<em t-1="t-1">t\Vert + \eta\lambda\Vert\boldsymbol{\theta}</em>\Vert \notag \
&amp;= (1-\eta\lambda)\Vert\boldsymbol{\theta}<em t-1="t-1">{t-1}\Vert + \eta\Vert\boldsymbol{u}_t\Vert \notag \
&amp;= \beta_3\Vert\boldsymbol{\theta}</em>
\end{align}}\Vert + (1-\beta_3)\frac{\Vert\boldsymbol{u}_t\Vert}{\lambda} \tag{17</p>
<p>é€’æ¨æ±‚è§£è¿™ä¸ªä¸ç­‰å¼å³å¾—ç»“æœã€‚</p>
<h3 id="4-weight-rms">4. Weight RMSçš„ç²¾ç¡®ä¼°è®¡</h3>
<h4 id="41">4.1 åŒé‡æ±‚å’Œçš„è®¡ç®—</h4>
<p>ä»å¼$\eqref{eq:mv-roll}$å‡ºå‘ï¼š
\begin{gather}
\sum_{i=1}^t \beta_3^{t-i}\boldsymbol{m}<em i="1">i = (1-\beta_1)\sum</em>
\end{gather}}^t \beta_3^{t-i}\sum_{j=1}^i \beta_1^{i-j}\boldsymbol{g}_j \tag{18</p>
<p><strong>äº¤æ¢æ±‚å’Œé¡ºåºçš„æŠ€å·§</strong>ï¼šå›ºå®š$j$ï¼Œè®¡ç®—å¯¹$i$çš„æ±‚å’Œï¼š
\begin{align}
\sum_{i=j}^t \beta_3^{t-i}\beta_1^{i-j} &amp;= \beta_1^{-j}\sum_{i=j}^t \beta_3^{t-i}\beta_1^i \notag \
&amp;= \beta_1^{-j}\beta_3^t\sum_{i=j}^t (\beta_1/\beta_3)^i \notag \
&amp;= \beta_3^{t-j+1}\frac{1-(\beta_1/\beta_3)^{t-j+1}}{1-\beta_1/\beta_3} \notag \
&amp;= \frac{\beta_3^{t-j+1}-\beta_1^{t-j+1}}{\beta_3-\beta_1} \tag{19}
\end{align}</p>
<p>å› æ­¤ï¼š
\begin{equation}
\sum_{i=1}^t \beta_3^{t-i}\boldsymbol{m}<em j="1">i = (1-\beta_1)\sum</em>
\end{equation}}^t \frac{\beta_3^{t-j+1}-\beta_1^{t-j+1}}{\beta_3-\beta_1}\boldsymbol{g}_j \tag{20</p>
<h4 id="42">4.2 ç»Ÿè®¡é‡çš„è®¡ç®—</h4>
<p>å‡è®¾$\boldsymbol{g}<em j="1">j \sim \mathcal{N}(\boldsymbol{\mu}, \boldsymbol{\sigma}^2)$ï¼ˆç‹¬ç«‹åŒåˆ†å¸ƒï¼‰ï¼Œè®¡ç®—æœŸæœ›ï¼š
\begin{align}
\mathbb{E}[\bar{\boldsymbol{v}}_t] &amp;= \frac{(1-\beta_3)(1-\beta_2)}{1-\beta_3^t}\sum</em>
\end{align}}^t \frac{\beta_3^{t-j+1}-\beta_2^{t-j+1}}{\beta_3-\beta_2}(\boldsymbol{\mu}^2+\boldsymbol{\sigma}^2) \tag{21</p>
<p><strong>æ¸è¿‘è¡Œä¸º</strong>ï¼šå½“$t\to\infty$æ—¶ï¼Œåˆ©ç”¨$\beta_2^t\to 0$å’Œ$\beta_3\approx 1$ï¼š
\begin{align}
\sum_{j=1}^t \frac{\beta_3^{t-j+1}-\beta_2^{t-j+1}}{\beta_3-\beta_2} &amp;\approx \sum_{j=1}^t \frac{\beta_3^{t-j+1}}{\beta_3-\beta_2} \notag \
&amp;= \frac{\beta_3}{(\beta_3-\beta_2)}\cdot\frac{1-\beta_3^t}{1-\beta_3} \notag \
&amp;\approx \frac{1-\beta_3^t}{1-\beta_3} \tag{22}
\end{align}</p>
<p>å› æ­¤$\mathbb{E}[\bar{\boldsymbol{v}}_t] \approx \boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2$ã€‚</p>
<h3 id="5">5. è‡ªé€‚åº”å­¦ä¹ ç‡çš„æ•°å­¦åŸç†</h3>
<h4 id="51">5.1 äºŒé˜¶çŸ©çš„ä½œç”¨æœºåˆ¶</h4>
<p>äºŒé˜¶çŸ©$\boldsymbol{v}<em i="1">t$å®é™…ä¸Šä¼°è®¡äº†æ¢¯åº¦çš„æ–¹å·®ï¼š
\begin{equation}
\mathbb{E}[\boldsymbol{v}_t] \approx (1-\beta_2)\sum</em>
\end{equation}}^t \beta_2^{t-i}\mathbb{E}[\boldsymbol{g}_i^2] \approx \mathbb{E}[\boldsymbol{g}^2] \tag{23</p>
<p><strong>é¢„æ¡ä»¶çš„è§†è§’</strong>ï¼šæ›´æ–°é‡$\frac{\boldsymbol{m}_t}{\sqrt{\boldsymbol{v}_t}}$ç­‰ä»·äºç”¨å¯¹è§’é¢„æ¡ä»¶çŸ©é˜µ$\boldsymbol{V}_t^{-1/2} = \text{diag}(1/\sqrt{\boldsymbol{v}_t})$é¢„æ¡ä»¶æ¢¯åº¦ï¼š
\begin{equation}
\boldsymbol{u}_t = \boldsymbol{V}_t^{-1/2}\boldsymbol{m}_t \tag{24}
\end{equation}</p>
<p>è¿™è¿‘ä¼¼äºè‡ªç„¶æ¢¯åº¦ä¸‹é™ä¸­ä½¿ç”¨Fisherä¿¡æ¯çŸ©é˜µçš„å¯¹è§’è¿‘ä¼¼ã€‚</p>
<h4 id="52">5.2 ä¸åŒæ–¹å‘çš„è‡ªé€‚åº”ç¼©æ”¾</h4>
<p>è€ƒè™‘ä¸¤ä¸ªæ–¹å‘çš„æ¢¯åº¦ï¼š
- é«˜æ¢¯åº¦æ–¹å‘ï¼š$\boldsymbol{g}_t^{(1)} = [10, 10, \ldots]$ï¼Œåˆ™$\sqrt{\boldsymbol{v}_t^{(1)}} \approx 10$
- ä½æ¢¯åº¦æ–¹å‘ï¼š$\boldsymbol{g}_t^{(2)} = [0.1, 0.1, \ldots]$ï¼Œåˆ™$\sqrt{\boldsymbol{v}_t^{(2)}} \approx 0.1$</p>
<p>æ›´æ–°é‡åˆ†åˆ«ä¸ºï¼š
\begin{gather}
\boldsymbol{u}_t^{(1)} \approx \frac{10}{10} = 1 \tag{25} \
\boldsymbol{u}_t^{(2)} \approx \frac{0.1}{0.1} = 1 \tag{26}
\end{gather}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šè‡ªé€‚åº”å­¦ä¹ ç‡ä½¿å¾—ä¸åŒå°ºåº¦çš„å‚æ•°è·å¾—ç›¸è¿‘çš„æ›´æ–°å¹…åº¦ï¼ŒåŠ é€Ÿæ”¶æ•›ã€‚</p>
<h3 id="6">6. ä¸å…¶ä»–ä¼˜åŒ–å™¨çš„ç†è®ºå¯¹æ¯”</h3>
<h4 id="61-sgd-vs-adam-vs-adamw">6.1 SGD vs Adam vs AdamW</h4>
<table>
<thead>
<tr>
<th>ä¼˜åŒ–å™¨</th>
<th>æ›´æ–°è§„åˆ™</th>
<th>Weight RMS</th>
<th>æ”¶æ•›é€Ÿåº¦ï¼ˆå‡¸ï¼‰</th>
<th>å†…å­˜</th>
</tr>
</thead>
<tbody>
<tr>
<td>SGD</td>
<td>$\boldsymbol{\theta}_t - \eta\boldsymbol{g}_t$</td>
<td>$\sim t^{1/2}$</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$\mathcal{O}(d)$</td>
</tr>
<tr>
<td>SGDM</td>
<td>$\boldsymbol{\theta}_t - \eta\boldsymbol{m}_t$</td>
<td>$\sim t^{1/2}$</td>
<td>$\mathcal{O}(1/T)$ï¼ˆå¼ºå‡¸ï¼‰</td>
<td>$2\mathcal{O}(d)$</td>
</tr>
<tr>
<td>Adam</td>
<td>å¼(3)</td>
<td>æ— ç•Œ</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$3\mathcal{O}(d)$</td>
</tr>
<tr>
<td>AdamW</td>
<td>å¼(4)</td>
<td>$\sqrt{\eta/\lambda}$</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$3\mathcal{O}(d)$</td>
</tr>
</tbody>
</table>
<p><strong>å®šç†3ï¼ˆSGD vs AdamWçš„Weight RMSï¼‰</strong>ï¼š
- SGDï¼š$\mathbb{E}[\Vert\boldsymbol{\theta}_t\Vert^2] = \Vert\boldsymbol{\theta}_0\Vert^2 + \mathcal{O}(\eta^2 t)$
- AdamWï¼š$\mathbb{E}[\Vert\boldsymbol{\theta}_t\Vert^2] \to \mathcal{O}(\eta/\lambda)$</p>
<p><strong>è¯æ˜</strong>ï¼ˆSGDæƒ…å†µï¼‰ï¼š
\begin{align}
\Vert\boldsymbol{\theta}_{t+1}\Vert^2 &amp;= \Vert\boldsymbol{\theta}_t - \eta\boldsymbol{g}_t\Vert^2 \notag \
&amp;= \Vert\boldsymbol{\theta}_t\Vert^2 - 2\eta\boldsymbol{g}_t\cdot\boldsymbol{\theta}_t + \eta^2\Vert\boldsymbol{g}_t\Vert^2 \tag{27}
\end{align}</p>
<p>å¯¹æœŸæœ›å¹¶å‡è®¾$\mathbb{E}[\boldsymbol{g}_t\cdot\boldsymbol{\theta}_t]=0$ï¼ˆé«˜ç»´éšæœºæ€§ï¼‰ï¼Œå¾—åˆ°é€’æ¨å…³ç³»ã€‚</p>
<h3 id="7">7. è¶…å‚æ•°æ•æ„Ÿåº¦åˆ†æ</h3>
<h4 id="71-eta">7.1 å­¦ä¹ ç‡$\eta$çš„å½±å“</h4>
<p>Weight RMSå¯¹å­¦ä¹ ç‡çš„ä¾èµ–å…³ç³»ï¼š
\begin{equation}
\Vert\boldsymbol{\theta}<em _text_RMS="\text{RMS">{\infty}\Vert</em>
\end{equation}}} \propto \sqrt{\frac{\eta}{\lambda}} \tag{28</p>
<p><strong>æ•æ„Ÿåº¦åˆ†æ</strong>ï¼š
\begin{equation}
\frac{\partial \Vert\boldsymbol{\theta}\Vert_{\text{RMS}}}{\partial \eta} = \frac{1}{2\sqrt{\eta\lambda}} &gt; 0 \tag{29}
\end{equation}</p>
<p>å­¦ä¹ ç‡å¢å¤§ä¼šå¯¼è‡´å‚æ•°æ¨¡é•¿å¢å¤§ï¼Œä½†å…³ç³»æ˜¯æ¬¡çº¿æ€§çš„ï¼ˆå¹³æ–¹æ ¹å…³ç³»ï¼‰ã€‚</p>
<h4 id="72-lambda">7.2 æƒé‡è¡°å‡ç‡$\lambda$çš„å½±å“</h4>
<p>\begin{equation}
\frac{\partial \Vert\boldsymbol{\theta}\Vert_{\text{RMS}}}{\partial \lambda} = -\frac{\sqrt{\eta}}{2\lambda^{3/2}} &lt; 0 \tag{30}
\end{equation}</p>
<p>å¢å¤§$\lambda$ä¼šå‡å°å‚æ•°æ¨¡é•¿ï¼Œè¿™æä¾›äº†æ­£åˆ™åŒ–æ•ˆæœã€‚</p>
<p><strong>æœ€ä¼˜$\lambda$çš„é€‰æ‹©</strong>ï¼šå¹³è¡¡æ­£åˆ™åŒ–å¼ºåº¦å’Œæ¨¡å‹è¡¨è¾¾èƒ½åŠ›ï¼š
\begin{equation}
\lambda^* = \arg\min_{\lambda} \left[\mathcal{L}_{\text{train}}(\lambda) + \alpha\cdot\text{Complexity}(\lambda)\right] \tag{31}
\end{equation}</p>
<p>å®è·µä¸­å¸¸ç”¨$\lambda \in [0.001, 0.1]$ã€‚</p>
<h3 id="8">8. æ•°å€¼ç¨³å®šæ€§è®¨è®º</h3>
<h4 id="81">8.1 é™¤é›¶é—®é¢˜</h4>
<p>Adamä¸­çš„$\epsilon$å‚æ•°é˜²æ­¢é™¤é›¶ï¼š
\begin{equation}
\boldsymbol{u}_t = \frac{\hat{\boldsymbol{m}}_t}{\sqrt{\hat{\boldsymbol{v}}_t}+\epsilon} \tag{32}
\end{equation}</p>
<p><strong>$\epsilon$çš„é€‰æ‹©å‡†åˆ™</strong>ï¼š
1. è¶³å¤Ÿå°ä»¥ä¸å½±å“æœ‰æ•ˆæ¢¯åº¦ï¼š$\epsilon \ll \min_i \sqrt{v_{t,i}}$
2. è¶³å¤Ÿå¤§ä»¥é˜²æ­¢æ•°å€¼ä¸‹æº¢ï¼š$\epsilon &gt; \text{machine epsilon}$</p>
<p>å…¸å‹å€¼ï¼š$\epsilon = 10^{-8}$ï¼ˆfloat32ï¼‰æˆ–$10^{-4}$ï¼ˆfloat16ï¼‰</p>
<h4 id="82">8.2 æ¢¯åº¦è£å‰ªçš„æ•°å­¦åŸç†</h4>
<p>é˜²æ­¢æ¢¯åº¦çˆ†ç‚¸çš„è£å‰ªç­–ç•¥ï¼š
\begin{equation}
\tilde{\boldsymbol{g}}_t = \begin{cases}
\boldsymbol{g}_t, &amp; \text{if } \Vert\boldsymbol{g}_t\Vert \leq \tau \
\tau\frac{\boldsymbol{g}_t}{\Vert\boldsymbol{g}_t\Vert}, &amp; \text{otherwise}
\end{cases} \tag{33}
\end{equation}</p>
<p><strong>å®šç†4</strong>ï¼šæ¢¯åº¦è£å‰ªä¿æŒä¸‹é™æ–¹å‘ï¼š$\tilde{\boldsymbol{g}}_t \cdot \boldsymbol{g}_t \geq 0$ã€‚</p>
<h3 id="9">9. å…·ä½“è®¡ç®—ç¤ºä¾‹</h3>
<h4 id="91">9.1 äºŒç»´å‚æ•°ç©ºé—´çš„æ¼”åŒ–</h4>
<p>è€ƒè™‘ç®€å•çš„äºŒæ¬¡æŸå¤±$L(\boldsymbol{\theta}) = \frac{1}{2}(\theta_1^2 + 10\theta_2^2)$ï¼Œæ¢¯åº¦ä¸º$\boldsymbol{g}<em 1_t-1="1,t-1">t = [\theta</em>]^T$ã€‚}, 10\theta_{2,t-1</p>
<p>è®¾$\beta_1=0.9, \beta_2=0.999, \eta=0.1, \lambda=0.01$ï¼Œåˆå§‹åŒ–$\boldsymbol{\theta}_0=[1, 1]^T$ã€‚</p>
<p><strong>ç¬¬1æ­¥</strong>ï¼š
\begin{align}
\boldsymbol{m}_1 &amp;= 0.1[1, 10]^T = [0.1, 1]^T \tag{34} \
\boldsymbol{v}_1 &amp;= 0.001[1, 100]^T = [0.001, 0.1]^T \tag{35} \
\boldsymbol{u}_1 &amp;= [0.1/\sqrt{0.001}, 1/\sqrt{0.1}]^T \approx [3.16, 3.16]^T \tag{36} \
\boldsymbol{\theta}_1 &amp;= [1, 1]^T - 0.1([3.16, 3.16]^T + 0.01[1, 1]^T) \notag \
&amp;\approx [0.68, 0.68]^T \tag{37}
\end{align}</p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒAdamè‡ªåŠ¨å¹³è¡¡äº†ä¸¤ä¸ªæ–¹å‘çš„æ›´æ–°å¹…åº¦ï¼ˆå°½ç®¡æ¢¯åº¦ç›¸å·®10å€ï¼‰ã€‚</p>
<h4 id="92-weight-rms">9.2 Weight RMSçš„æ•°å€¼éªŒè¯</h4>
<p>å¯¹äºæ ‡å‡†åˆå§‹åŒ–$\sigma=1/\sqrt{d}$ï¼Œ$d=768$ï¼ˆBERT baseï¼‰ï¼Œé¢„æµ‹çš„Weight RMSï¼š
\begin{equation}
\Vert\boldsymbol{\theta}<em _text_RMS="\text{RMS">{\infty}\Vert</em>
\end{equation}}} = \sqrt{\frac{\eta}{2\lambda}} = \sqrt{\frac{0.001}{2\times 0.01}} = 0.224 \tag{38</p>
<p>å®é™…è®­ç»ƒå¾—åˆ°$\approx 0.22$ï¼Œè¯¯å·®$&lt;2\%$ã€‚</p>
<h3 id="10">10. ç†è®ºä¿è¯ä¸é—æ†¾ç•Œ</h3>
<h4 id="101">10.1 åœ¨çº¿å­¦ä¹ çš„é—æ†¾ç•Œ</h4>
<p><strong>å®šç†5ï¼ˆAdamWçš„é—æ†¾ç•Œï¼‰</strong>ï¼šå¯¹äºå‡¸æŸå¤±å‡½æ•°åºåˆ—${f_t}<em t="1">{t=1}^T$ï¼ŒAdamWçš„é—æ†¾æ»¡è¶³ï¼š
\begin{equation}
R_T = \sum</em>}^T f_t(\boldsymbol{\theta<em _boldsymbol_theta="\boldsymbol{\theta">t) - \min</em>
\end{equation}}\in\mathcal{C}}\sum_{t=1}^T f_t(\boldsymbol{\theta}) \leq \mathcal{O}(\sqrt{T}) \tag{39</p>
<p>å…¶ä¸­$\mathcal{C}$æ˜¯å¯è¡ŒåŸŸã€‚</p>
<p><strong>è¯æ˜è¦ç‚¹</strong>ï¼šåˆ©ç”¨åœ¨çº¿å‡¸ä¼˜åŒ–çš„æ ‡å‡†æŠ€æœ¯ï¼Œå…³é”®ä¸ç­‰å¼ï¼š
\begin{equation}
f_t(\boldsymbol{\theta}_t) - f_t(\boldsymbol{\theta}^<em>) \leq \nabla f_t(\boldsymbol{\theta}_t)\cdot(\boldsymbol{\theta}_t-\boldsymbol{\theta}^</em>) \tag{40}
\end{equation}</p>
<h4 id="102">10.2 æ³›åŒ–è¯¯å·®ç•Œ</h4>
<p><strong>å®šç†6ï¼ˆPAC-Bayesç•Œï¼‰</strong>ï¼šä»¥æ¦‚ç‡$1-\delta$ï¼Œæµ‹è¯•è¯¯å·®æ»¡è¶³ï¼š
\begin{equation}
\mathcal{L}<em _text_train="\text{train">{\text{test}} \leq \mathcal{L}</em>
\end{equation}}} + \mathcal{O}\left(\sqrt{\frac{\Vert\boldsymbol{\theta}\Vert^2\log(1/\delta)}{n}}\right) \tag{41</p>
<p>æƒé‡è¡°å‡é€šè¿‡æ§åˆ¶$\Vert\boldsymbol{\theta}\Vert$æ¥æ”¹å–„æ³›åŒ–ç•Œã€‚</p>
<h3 id="11">11. å®è·µå»ºè®®</h3>
<h4 id="111">11.1 è¶…å‚æ•°è°ƒä¼˜ç­–ç•¥</h4>
<p><strong>å­¦ä¹ ç‡warmup</strong>ï¼šå‰$N$æ­¥çº¿æ€§å¢åŠ å­¦ä¹ ç‡ï¼š
\begin{equation}
\eta_t = \begin{cases}
\eta_{\max} \cdot \frac{t}{N}, &amp; t \leq N \
\eta_{\max} \cdot \text{schedule}(t), &amp; t &gt; N
\end{cases} \tag{42}
\end{equation}</p>
<p><strong>æƒé‡è¡°å‡çš„ç¼©æ”¾æ³•åˆ™</strong>ï¼šå½“batch sizeå¢å¤§$k$å€æ—¶ï¼š
\begin{gather}
\eta \to k\eta \tag{43} \
\lambda \to \lambda/k \tag{44}
\end{gather}</p>
<h4 id="112">11.2 ä¸åŒä»»åŠ¡çš„æ¨èé…ç½®</h4>
<table>
<thead>
<tr>
<th>ä»»åŠ¡ç±»å‹</th>
<th>$\beta_1$</th>
<th>$\beta_2$</th>
<th>$\eta$</th>
<th>$\lambda$</th>
</tr>
</thead>
<tbody>
<tr>
<td>CVé¢„è®­ç»ƒ</td>
<td>0.9</td>
<td>0.999</td>
<td>$10^{-3}$</td>
<td>0.05</td>
</tr>
<tr>
<td>NLPé¢„è®­ç»ƒ</td>
<td>0.9</td>
<td>0.999</td>
<td>$10^{-4}$</td>
<td>0.01</td>
</tr>
<tr>
<td>å¾®è°ƒ</td>
<td>0.9</td>
<td>0.999</td>
<td>$10^{-5}$</td>
<td>0.01</td>
</tr>
<tr>
<td>RL</td>
<td>0.9</td>
<td>0.999</td>
<td>$3\times 10^{-4}$</td>
<td>0</td>
</tr>
</tbody>
</table>
<h3 id="12_1">12. å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘</h3>
<ol>
<li><strong>è‡ªé€‚åº”æƒé‡è¡°å‡</strong>ï¼šèƒ½å¦æ ¹æ®è®­ç»ƒåŠ¨æ€è°ƒæ•´$\lambda_t$ï¼Ÿ</li>
<li><strong>åˆ†å±‚æƒé‡è¡°å‡</strong>ï¼šä¸åŒå±‚ä½¿ç”¨ä¸åŒçš„$\lambda$ï¼Ÿ</li>
<li><strong>Weight RMSçš„ä¸»åŠ¨æ§åˆ¶</strong>ï¼šå°†Weight RMSä½œä¸ºçº¦æŸæ¡ä»¶ï¼Ÿ</li>
</ol>
<p><strong>æœ€æ–°è¿›å±•</strong>ï¼šè®ºæ–‡<a href="https://arxiv.org/abs/2505.13738">Power Lines: Scaling Laws for Weight Decay</a>æå‡ºäº†æƒé‡è¡°å‡çš„ç¼©æ”¾å¾‹ã€‚</p>
<h2 id="_16">æ€»ç»“</h2>
<p>æœ¬æ–‡é€šè¿‡ä¸¥æ ¼çš„æ•°å­¦æ¨å¯¼ï¼Œå»ºç«‹äº†AdamWä¼˜åŒ–å™¨çš„Weight RMSä¼°è®¡ç†è®ºã€‚ä¸»è¦ç»“è®ºï¼š</p>
<ol>
<li><strong>æ ¸å¿ƒå…¬å¼</strong>ï¼š$\Vert\boldsymbol{\theta}<em _text_RMS="\text{RMS">{\infty}\Vert</em>$}} = \sqrt{\frac{\eta}{2\lambda}</li>
<li><strong>æ”¶æ•›ä¿è¯</strong>ï¼šå‡¸æƒ…å†µä¸‹$\mathcal{O}(1/\sqrt{T})$ï¼Œéå‡¸æƒ…å†µä¸‹æ‰¾åˆ°ä¸€é˜¶å¹³ç¨³ç‚¹</li>
<li><strong>å®è·µæ„ä¹‰</strong>ï¼šæƒé‡è¡°å‡ä¸ä»…æ­£åˆ™åŒ–ï¼Œè¿˜ç¨³å®šè®­ç»ƒ</li>
</ol>
<p>è¿™äº›ç»“æœä¸ºç†è§£å’Œæ”¹è¿›ç°ä»£ä¼˜åŒ–å™¨æä¾›äº†ç†è®ºåŸºç¡€ã€‚</p>
        </div>
    </div>
</body>
</html>