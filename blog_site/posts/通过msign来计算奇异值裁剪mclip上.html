<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é€šè¿‡msignæ¥è®¡ç®—å¥‡å¼‚å€¼è£å‰ªmclipï¼ˆä¸Šï¼‰</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>é€šè¿‡msignæ¥è®¡ç®—å¥‡å¼‚å€¼è£å‰ªmclipï¼ˆä¸Šï¼‰</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 40.8 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11006">https://spaces.ac.cn/archives/11006</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å‰é¢æˆ‘ä»¬ç”¨äº†ä¸¤ç¯‡æ–‡ç« <a href="/archives/10922">ã€Šmsignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸Šï¼‰ã€‹</a>å’Œ<a href="/archives/10996">ã€Šmsignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸‹ï¼‰ã€‹</a>è®¨è®ºäº†çŸ©é˜µçš„$\newcommand{msign}{\mathop{\text{msign}}}\newcommand{sign}{\mathop{\text{sign}}}\newcommand{clip}{\mathop{\text{clip}}}\newcommand{mclip}{\mathop{\text{mclip}}}\msign$ç®—å­çš„æ•°å€¼è®¡ç®—ï¼Œè¿™ç¯‡æ–‡ç« æˆ‘ä»¬æ¥å…³æ³¨â€œå¥‡å¼‚å€¼è£å‰ªï¼ˆSingular Value Clippingï¼‰â€è¿ç®—ï¼Œå®ƒæœ€è¿‘åœ¨ <a href="https://x.com/_arohan_/status/1929945590366122037">@<em>arohan</em></a> çš„æ¨ç‰¹ä¸Šå¼•èµ·äº†çƒ­è®®ï¼Œæˆ‘ä»¬æ­¤å‰åœ¨<a href="/archives/10795">ã€Šé«˜é˜¶MuPï¼šæ›´ç®€æ˜ä½†æ›´é«˜æ˜çš„è°±æ¡ä»¶ç¼©æ”¾ã€‹</a>ä¹Ÿæåˆ°è¿‡ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬ç®€ç§°ä¸º$\mclip$ã€‚</p>
<h2 id="_1">åŸºæœ¬æ¦‚å¿µ</h2>
<p>å¯¹äºæ ‡é‡$x$ï¼Œ$\clip$è¿ç®—å®šä¹‰ä¸º<br />
\begin{equation}\clip(x) = \max(\min(x, 1), -1) = \left\{\begin{aligned}1, &amp;\quad x\geq 1 \\\<br />
x, &amp;\quad x\in(-1, 1)\\\<br />
-1, &amp;\quad x\leq -1<br />
\end{aligned}\right.\end{equation}<br />
å³å¤§äº$1$æˆ–è€…å°äº$-1$å°±è¢«æˆªæ–­ï¼Œå¦åˆ™ä¸å˜ã€‚æˆ‘ä»¬å°†çŸ©é˜µ$\boldsymbol{M}\in\mathbb{R}^{n\times m}$çš„$\mclip$å®šä¹‰ä¸º<br />
\begin{equation}\mclip(\boldsymbol{M}) = \boldsymbol{U}\clip(\boldsymbol{\Sigma})\boldsymbol{V}^{\top} \end{equation}<br />
å…¶ä¸­$\boldsymbol{M}=\boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$æ˜¯çŸ©é˜µ$\boldsymbol{M}$çš„SVDï¼Œ$\boldsymbol{U}\in\mathbb{R}^{n\times n},\boldsymbol{V}\in\mathbb{R}^{m\times m}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œ$\boldsymbol{\Sigma}\in\mathbb{R}^{n\times m}$æ˜¯å¥‡å¼‚å€¼å¯¹è§’é˜µï¼Œå¯¹è§’çŸ©é˜µåŠ $\clip$è¡¨ç¤ºå¯¹å®ƒçš„å¯¹è§’çº¿å…ƒç´ åˆ†åˆ«è¿›è¡Œ$\clip$ã€‚ç•™æ„åˆ°çŸ©é˜µ$\boldsymbol{\Sigma}$æ˜¯å¯¹è§’é˜µå¹¶ä¸”æ€»æ˜¯éè´Ÿçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿæœ‰<br />
\begin{equation}\mclip(\boldsymbol{M}) = \boldsymbol{U}\min(\boldsymbol{\Sigma}, 1)\boldsymbol{V}^{\top} \end{equation}</p>
<p>SVDè‡ªç„¶æ˜¯è®¡ç®—$\mclip$çš„æ ‡å‡†æ–¹å¼ï¼Œä½†SVDçš„æ•ˆç‡å¹¶ä¸é«˜ã€‚è€Œæœ‰$\msign$çš„ç»éªŒåœ¨å‰ï¼Œæˆ‘ä»¬ä¸éš¾æƒ³åˆ°å¯ä»¥åƒ$\msign$ä¸€æ ·ç»™$\mclip$æ‰¾ä¸€ä¸ªNewton-Schulzè¿­ä»£æ¥è®¡ç®—å®ƒã€‚è¿™ä¸ªæ€è·¯è‡ªç„¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œä½†åœ¨$\msign$çš„åŸºç¡€ä¸Šï¼Œæˆ‘ä»¬è¿˜å¯ä»¥æœ‰æ›´èªæ˜çš„åŠæ³•ã€‚</p>
<h2 id="_2">å·¨äººè‚©è†€</h2>
<p>è¿™ä¸ªèªæ˜çš„æƒ³æ³•æ¥è‡ª<a href="https://x.com/leloykun">@leloykun</a>ï¼Œä»–åœ¨åšå®¢<a href="https://leloykun.github.io/ponder/spectral-clipping/">ã€ŠNumerically Stable Spectral Clipping Via Newton-Schulz Iterationã€‹</a>æå‡ºå¯ä»¥ç«™åœ¨$\msign$çš„è‚©è†€ä¸Šï¼Œç”¨$\msign$æ¥è¡¨ç¤º$\mclip$ï¼Œè¿™æ ·å°±ä¸ç”¨å¦å¤–å¯»æ‰¾Newton-Schulzè¿­ä»£äº†ã€‚ä»–åœ¨åšå®¢ä¸­ä¹Ÿæäº†ä¸€ä¸ªå·§å¦™çš„è§£æ³•ï¼Œä½†ä¸ªäººæ„Ÿè§‰ä¸å¤Ÿç›´è§‚å¹¶ä¸”æ•ˆç‡ä¹Ÿä¸ç®—é«˜ï¼Œä¸‹é¢ç»™å‡ºç¬”è€…çš„æ€è·¯ã€‚</p>
<p>ç¬”è€…çš„å‡ºå‘ç‚¹æ˜¯æ ‡é‡æ’ç­‰å¼ï¼ˆKimiå¸®å¿™æ‰¾çš„ï¼‰<br />
$$\min(x, 1) = \frac{1}{2} [x + 1 - (x-1)\sign(x-1)] $$<br />
ç®€å•èµ·è§ï¼Œå…ˆå‡è®¾$\boldsymbol{M}$æ˜¯æ»¡ç§©æ–¹é˜µï¼Œé‚£ä¹ˆ<br />
\begin{equation}\begin{aligned}<br />
2\mclip(\boldsymbol{M}) =&amp;\, \boldsymbol{U} [2\min(\boldsymbol{\Sigma},1)] \boldsymbol{V}^{\top} \\\[6pt]<br />
=&amp;\, \boldsymbol{U} [\boldsymbol{\Sigma} + \boldsymbol{I} - (\boldsymbol{\Sigma} - \boldsymbol{I})\sign(\boldsymbol{\Sigma} - \boldsymbol{I})] \boldsymbol{V}^{\top} \\\[6pt]<br />
=&amp;\, \boldsymbol{U} [\boldsymbol{\Sigma} + \boldsymbol{I} - (\boldsymbol{\Sigma} - \boldsymbol{I})\msign(\boldsymbol{\Sigma} - \boldsymbol{I})] \boldsymbol{V}^{\top} \\\[6pt]<br />
=&amp;\, \boldsymbol{M} + \boldsymbol{U}\boldsymbol{V}^{\top} - \boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\msign(\boldsymbol{\Sigma} - \boldsymbol{I}) \boldsymbol{V}^{\top}<br />
\end{aligned}\label{eq:2-mclip-M}\end{equation}<br />
æ³¨æ„<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\msign(\boldsymbol{\Sigma} - \boldsymbol{I}) \boldsymbol{V}^{\top} \\\[6pt]<br />
=&amp;\, \boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I}) \boldsymbol{U}^{\top} \boldsymbol{U}\msign(\boldsymbol{\Sigma} - \boldsymbol{I}) \boldsymbol{V}^{\top} \\\[6pt]<br />
=&amp;\, (\boldsymbol{U}\boldsymbol{\Sigma} \boldsymbol{U}^{\top} - \boldsymbol{I}) \msign(\boldsymbol{M} - \boldsymbol{U}\boldsymbol{V}^{\top}) \\\[6pt]<br />
=&amp;\, (\boldsymbol{U}\boldsymbol{\Sigma} \boldsymbol{V}^{\top} (\boldsymbol{U}\boldsymbol{V}^{\top})^{\top} - \boldsymbol{I}) \msign(\boldsymbol{M} - \boldsymbol{U}\boldsymbol{V}^{\top}) \\\[6pt]<br />
=&amp;\, (\boldsymbol{M} (\boldsymbol{U}\boldsymbol{V}^{\top})^{\top} - \boldsymbol{I}) \msign(\boldsymbol{M} - \boldsymbol{U}\boldsymbol{V}^{\top}) \\\[6pt]<br />
\end{aligned}\end{equation}<br />
å…¶ä¸­ç¬¬äºŒä¸ªç­‰å·ç”¨åˆ°äº†å¯¹äºä»»æ„æ­£äº¤çŸ©é˜µ$\boldsymbol{P},\boldsymbol{Q}$æˆç«‹$\boldsymbol{P}\msign(\boldsymbol{R})\boldsymbol{Q} = \msign(\boldsymbol{P}\boldsymbol{R}\boldsymbol{Q})$ã€‚å°†ä¸Šå¼ä»£å›å¼$\eqref{eq:2-mclip-M}$å¾—åˆ°<br />
\begin{equation}2\mclip(\boldsymbol{M}) = \boldsymbol{M} + \boldsymbol{U}\boldsymbol{V}^{\top} + (\boldsymbol{I} - \boldsymbol{M}(\boldsymbol{U}\boldsymbol{V}^{\top})^{\top}) \msign(\boldsymbol{M} - \boldsymbol{U}\boldsymbol{V}^{\top})\label{eq:mclip-M-core}\end{equation}<br />
è‹¥$\boldsymbol{M}$æ˜¯ä¸€èˆ¬çš„$r$ç§©çŸ©é˜µï¼Œåˆ™$\boldsymbol{U}\boldsymbol{V}^{\top}$æ”¹ä¸º$\boldsymbol{U}<em _:_:r_="[:,:r]">{[:,:r]}\boldsymbol{V}</em>}^{\top}$ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥å°†$\boldsymbol{M} = \boldsymbol{U<em _:r_:r_="[:r,:r]">{[:,:r]}\boldsymbol{\Sigma}</em>$ä»£å…¥ä¸Šå¼éªŒè¯ç­‰å·æˆç«‹ã€‚}\boldsymbol{V}_{[:,:r]}^{\top</p>
<p>ï¼ˆæ³¨ï¼šè¿™ä¸€èŠ‚æ„Ÿè°¢ <a href="https://x.com/YouJiacheng">@YouJiacheng</a> çš„äº¤æµè®¨è®ºã€‚ï¼‰</p>
<h2 id="_3">å‚è€ƒå®ç°</h2>
<p>æˆ‘ä»¬çŸ¥é“$\boldsymbol{U}\boldsymbol{V}^{\top}=\msign(\boldsymbol{M})$ï¼Œæ‰€ä»¥ç”¨å¼$\eqref{eq:mclip-M-core}$è®¡ç®—$\mclip$åªéœ€è¦ç®—ä¸¤æ¬¡$\msign$ï¼š<br />
\begin{equation}2\mclip(\boldsymbol{M}) = \boldsymbol{M} + \msign(\boldsymbol{M}) + (\boldsymbol{I} - \boldsymbol{M}\msign(\boldsymbol{M})^{\top}) \msign(\boldsymbol{M} - \msign(\boldsymbol{M}))\end{equation}</p>
<p>è®¡ç®—é‡å¤§è‡´æ˜¯$\msign$çš„2å€ï¼›ç›¸æ¯”ä¹‹ä¸‹<a href="https://leloykun.github.io/ponder/spectral-clipping/">ã€ŠNumerically Stable Spectral Clipping Via Newton-Schulz Iterationã€‹</a>éœ€è¦å¯¹ä¸€ä¸ªçº¦4å€å¤§å°çš„çŸ©é˜µç®—ä¸€æ¬¡$\msign$ï¼Œè®¡ç®—é‡å¤§è‡´æ˜¯$\msign$çš„8å€ã€‚</p>
<p>åœ¨$\msign$çš„åŸºç¡€ä¸Šï¼Œå®ç°å¼$\eqref{eq:mclip-M-core}$æœ€çŸ­åªéœ€è¦ä¸¤è¡Œä»£ç ï¼Œå‚è€ƒå¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">msign</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="kp">svd</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u</span> <span class="o">@</span> <span class="n">vh</span>

<span class="k">def</span><span class="w"> </span><span class="nf">mclip</span><span class="p">(</span><span class="n">m</span><span class="p">):</span>
    <span class="n">ms2</span> <span class="o">=</span> <span class="n">msign</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="p">(</span><span class="n">ms</span> <span class="o">:=</span> <span class="n">msign</span><span class="p">(</span><span class="n">m</span><span class="p">)))</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">ms</span> <span class="o">+</span> <span class="n">ms2</span> <span class="o">-</span> <span class="n">m</span> <span class="o">@</span> <span class="n">ms</span><span class="o">.</span><span class="n">mT</span> <span class="o">@</span> <span class="n">ms2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

<span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="kp">svd</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">result1</span> <span class="o">=</span> <span class="n">u</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="kp">diag</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="kp">clip</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span> <span class="o">@</span> <span class="n">vh</span>
<span class="n">result2</span> <span class="o">=</span> <span class="n">mclip</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="kp">abs</span><span class="p">(</span><span class="n">result1</span> <span class="o">-</span> <span class="n">result2</span><span class="p">)</span><span class="o">.</span><span class="kp">mean</span><span class="p">()</span>
</code></pre></div>

<p>è¿™é‡Œç›´æ¥ç”¨SVDæ¥è®¡ç®—$\msign$ï¼Œä»¥ä¾¿å¿«é€ŸéªŒè¯å¼$\eqref{eq:mclip-M-core}$çš„æ­£ç¡®æ€§ï¼Œå®é™…è®¡ç®—ä¸­ï¼Œè¯»è€…å¯ä»¥è‡ªè¡Œå°†$\msign$å‡½æ•°æ¢æˆç›¸åº”çš„Newton-Schulzè¿­ä»£ã€‚</p>
<h2 id="_4">å…¶ä»–å‡½æ•°</h2>
<p>æˆ‘ä»¬è¿˜å¯ä»¥ç”¨åŒæ ·æ€è·¯å»è®¡ç®—å…¶ä»–å‡½æ•°çš„çŸ©é˜µç‰ˆï¼Œæ¯”å¦‚é˜¶è·ƒå‡½æ•°ã€‚æˆ‘ä»¬å®šä¹‰æ ‡é‡çš„é˜¶è·ƒå‡½æ•°$\newcommand{mstep}{\mathop{\text{mstep}}}\newcommand{step}{\mathop{\text{step}}}$<br />
\begin{equation}\step(x) = \frac{1}{2}[\sign(x - 1) + 1]\end{equation}<br />
è¿™è¡¨ç¤ºå¤§äº1å°±å˜æˆ1ï¼Œå°äº1å°±å˜æˆ0ã€‚äºæ˜¯æˆ‘ä»¬å¯ä»¥å®šä¹‰<br />
\begin{equation}\mstep(\boldsymbol{M}) = \boldsymbol{U}\step(\boldsymbol{\Sigma})\boldsymbol{V}^{\top}\end{equation}<br />
ä¹Ÿå°±æ˜¯åªä¿ç•™å¤§äº1çš„å¥‡å¼‚å€¼å¹¶æˆªæ–­ä¸º1ï¼Œå°äº1çš„å¥‡å¼‚å€¼åˆ™ç›´æ¥ç½®é›¶ã€‚åŸºäºåŒæ ·çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°<br />
\begin{equation}\mstep(\boldsymbol{M}) = \frac{1}{2}[\msign(\boldsymbol{M}) + \msign(\boldsymbol{M} - \msign(\boldsymbol{M}))]\end{equation}<br />
æˆ‘ä»¬ç”šè‡³å¯ä»¥è¡¨ç¤ºå¶å‡½æ•°ï¼Œæ¯”å¦‚å®šä¹‰<br />
\begin{equation}\mathop{\text{msquare}}(\boldsymbol{M}) = \boldsymbol{U} \boldsymbol{\Sigma}^2\boldsymbol{V}^{\top} = \boldsymbol{U}\boldsymbol{V}^{\top}(\boldsymbol{V}\boldsymbol{\Sigma}\boldsymbol{U}^{\top})(\boldsymbol{U} \boldsymbol{\Sigma}\boldsymbol{V}^{\top}) = \msign(\boldsymbol{M})\boldsymbol{M}^{\top}\boldsymbol{M}\end{equation}<br />
è¿™è·Ÿç›´æ¥ç”±$\boldsymbol{M}^2$å®šä¹‰çš„çŸ©é˜µå¹³æ–¹ä¸åŒï¼Œåè€…åªå¯¹æ–¹é˜µæœ‰æ•ˆï¼Œæ˜¯åœ¨ç‰¹å¾å€¼åˆ†è§£ä¸‹å¯¹ç‰¹å¾å€¼å¹³æ–¹ï¼Œè€Œä¸Šå¼åˆ™æ˜¯åœ¨å¥‡å¼‚å€¼åˆ†è§£ä¸‹å¯¹å¥‡å¼‚å€¼å¹³æ–¹ã€‚ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\boldsymbol{U} \boldsymbol{\Sigma}^{2n}\boldsymbol{V}^{\top} = \msign(\boldsymbol{M})(\boldsymbol{M}^{\top}\boldsymbol{M})^n,\quad \boldsymbol{U} \boldsymbol{\Sigma}^{2n+1}\boldsymbol{V}^{\top} = \boldsymbol{M}(\boldsymbol{M}^{\top}\boldsymbol{M})^n\end{equation}<br />
è¿™è¡¨æ˜å¯¹äºä»»æ„å¤šé¡¹å¼$f(x)$ï¼ˆè€Œä¸å•å•æ˜¯å¥‡å¤šé¡¹å¼ï¼‰ï¼Œ$\boldsymbol{U}f(\boldsymbol{\Sigma})\boldsymbol{V}^{\top}$éƒ½å¯ä»¥ç”±$\boldsymbol{M}$å’Œ$\msign(\boldsymbol{M})$ä»¥åŠçŸ©é˜µçš„æœ‰é™æ­¥åŠ ä¹˜å¾—åˆ°ã€‚</p>
<h2 id="_5">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†åˆ©ç”¨çŸ©é˜µåŠå…¶$\msign$ï¼Œæ¥å¯¹çŸ©é˜µçš„å¥‡å¼‚å€¼è¿›è¡Œä¸€èˆ¬è¿ç®—çš„æ€è·¯ï¼ŒåŒ…æ‹¬å¥‡å¼‚å€¼è£å‰ªã€é˜¶è·ƒå‡½æ•°ã€ä»»æ„æ¬¡å¤šé¡¹å¼ï¼ˆè€Œä¸å•å•æ˜¯å¥‡å¤šé¡¹å¼ï¼‰ç­‰ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11006">https://spaces.ac.cn/archives/11006</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jun. 07, 2025). ã€Šé€šè¿‡msignæ¥è®¡ç®—å¥‡å¼‚å€¼è£å‰ªmclipï¼ˆä¸Šï¼‰ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11006">https://spaces.ac.cn/archives/11006</a></p>
<p>@online{kexuefm-11006,<br />
title={é€šè¿‡msignæ¥è®¡ç®—å¥‡å¼‚å€¼è£å‰ªmclipï¼ˆä¸Šï¼‰},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Jun},<br />
url={\url{https://spaces.ac.cn/archives/11006}},<br />
} </p>
<hr />
<h2 id="_6">æ¨å¯¼</h2>
<p>æœ¬èŠ‚æä¾›å…³äºçŸ©é˜µç¬¦å·å‡½æ•°msignå’Œå¥‡å¼‚å€¼è£å‰ªmclipçš„å®Œæ•´æ•°å­¦ç†è®ºæ¨å¯¼ï¼ŒåŒ…æ‹¬åŸºç¡€å®šä¹‰ã€ç­‰ä»·è½¬æ¢ã€è¿­ä»£ç®—æ³•çš„æ”¶æ•›æ€§åˆ†æã€æ•°å€¼ç¨³å®šæ€§è®¨è®ºä»¥åŠå®é™…åº”ç”¨ã€‚</p>
<h3 id="1-msign">1. msignç®—å­çš„ç²¾ç¡®æ•°å­¦å®šä¹‰</h3>
<h4 id="11-svd">1.1 åŸºäºSVDçš„å®šä¹‰</h4>
<p>å¯¹äºä»»æ„çŸ©é˜µ $\boldsymbol{M} \in \mathbb{R}^{n \times m}$ï¼Œå…¶å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰ä¸ºï¼š
$$\boldsymbol{M} = \boldsymbol{U} \boldsymbol{\Sigma} \boldsymbol{V}^{\top}$$
å…¶ä¸­ï¼š
- $\boldsymbol{U} \in \mathbb{R}^{n \times n}$ æ˜¯å·¦å¥‡å¼‚å‘é‡çŸ©é˜µï¼Œæ»¡è¶³ $\boldsymbol{U}^{\top}\boldsymbol{U} = \boldsymbol{I}_n$
- $\boldsymbol{V} \in \mathbb{R}^{m \times m}$ æ˜¯å³å¥‡å¼‚å‘é‡çŸ©é˜µï¼Œæ»¡è¶³ $\boldsymbol{V}^{\top}\boldsymbol{V} = \boldsymbol{I}_m$
- $\boldsymbol{\Sigma} \in \mathbb{R}^{n \times m}$ æ˜¯å¯¹è§’é˜µï¼Œå¯¹è§’å…ƒç´  $\sigma_1 \geq \sigma_2 \geq \cdots \geq \sigma_r &gt; 0$ï¼Œå…¶ä¸­ $r = \min(n,m)$ æ˜¯çŸ©é˜µç§©</p>
<p>çŸ©é˜µç¬¦å·å‡½æ•° $\msign$ å®šä¹‰ä¸ºï¼š
$$\msign(\boldsymbol{M}) = \boldsymbol{U} \boldsymbol{V}^{\top}$$</p>
<p><strong>é‡è¦æ€§è´¨</strong>ï¼šmsignç®—å­ä¿ç•™äº†çŸ©é˜µçš„å·¦å³å¥‡å¼‚ç©ºé—´ï¼Œä½†å°†æ‰€æœ‰éé›¶å¥‡å¼‚å€¼å½’ä¸€åŒ–ä¸º1ã€‚</p>
<h4 id="12-msign">1.2 msignçš„å…³é”®æ€§è´¨</h4>
<p><strong>æ€§è´¨1ï¼ˆæ­£äº¤æ€§ï¼‰</strong>ï¼šå¦‚æœ $\boldsymbol{M}$ æ˜¯æ»¡ç§©æ–¹é˜µï¼Œåˆ™ $\msign(\boldsymbol{M})$ æ˜¯æ­£äº¤çŸ©é˜µï¼š
$$\msign(\boldsymbol{M})^{\top} \msign(\boldsymbol{M}) = \boldsymbol{V}\boldsymbol{U}^{\top}\boldsymbol{U}\boldsymbol{V}^{\top} = \boldsymbol{V}\boldsymbol{I}\boldsymbol{V}^{\top} = \boldsymbol{I}$$</p>
<p><strong>æ€§è´¨2ï¼ˆå¹‚ç­‰æ€§å˜ä½“ï¼‰</strong>ï¼š
$$\msign(\msign(\boldsymbol{M})) = \msign(\boldsymbol{M})$$
è¯æ˜ï¼šè®¾ $\msign(\boldsymbol{M}) = \boldsymbol{U}\boldsymbol{V}^{\top}$ï¼Œå…¶SVDä¸º $\boldsymbol{U}\boldsymbol{V}^{\top} = \boldsymbol{U}\boldsymbol{I}\boldsymbol{V}^{\top}$ï¼Œå› æ­¤ï¼š
$$\msign(\boldsymbol{U}\boldsymbol{V}^{\top}) = \boldsymbol{U}\boldsymbol{V}^{\top}$$</p>
<p><strong>æ€§è´¨3ï¼ˆæ­£äº¤å˜æ¢ä¸å˜æ€§ï¼‰</strong>ï¼šå¯¹äºä»»æ„æ­£äº¤çŸ©é˜µ $\boldsymbol{P}, \boldsymbol{Q}$ï¼š
$$\msign(\boldsymbol{P}\boldsymbol{M}\boldsymbol{Q}) = \boldsymbol{P}\msign(\boldsymbol{M})\boldsymbol{Q}$$
è¯æ˜ï¼šè®¾ $\boldsymbol{M} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ï¼Œåˆ™ï¼š
$$\boldsymbol{P}\boldsymbol{M}\boldsymbol{Q} = (\boldsymbol{P}\boldsymbol{U})\boldsymbol{\Sigma}(\boldsymbol{Q}\boldsymbol{V})^{\top}$$
å› ä¸º $\boldsymbol{P}\boldsymbol{U}$ å’Œ $\boldsymbol{Q}\boldsymbol{V}$ ä»æ˜¯æ­£äº¤çŸ©é˜µï¼Œæ‰€ä»¥ï¼š
$$\msign(\boldsymbol{P}\boldsymbol{M}\boldsymbol{Q}) = \boldsymbol{P}\boldsymbol{U}(\boldsymbol{Q}\boldsymbol{V})^{\top} = \boldsymbol{P}\boldsymbol{U}\boldsymbol{V}^{\top}\boldsymbol{Q} = \boldsymbol{P}\msign(\boldsymbol{M})\boldsymbol{Q}$$</p>
<p><strong>æ€§è´¨4ï¼ˆè½¬ç½®å…³ç³»ï¼‰</strong>ï¼š
$$\msign(\boldsymbol{M}^{\top}) = \msign(\boldsymbol{M})^{\top}$$
è¯æ˜ï¼š$\boldsymbol{M}^{\top} = \boldsymbol{V}\boldsymbol{\Sigma}^{\top}\boldsymbol{U}^{\top}$ æ˜¯ $\boldsymbol{M}^{\top}$ çš„SVDï¼Œå› æ­¤ï¼š
$$\msign(\boldsymbol{M}^{\top}) = \boldsymbol{V}\boldsymbol{U}^{\top} = (\boldsymbol{U}\boldsymbol{V}^{\top})^{\top} = \msign(\boldsymbol{M})^{\top}$$</p>
<h3 id="2">2. å¥‡å¼‚å€¼è£å‰ªçš„æ•°å­¦è¡¨ç¤ºä¸æ€§è´¨</h3>
<h4 id="21-clip">2.1 æ ‡é‡clipå‡½æ•°</h4>
<p>å¯¹äºæ ‡é‡ $x \in \mathbb{R}$ï¼Œè£å‰ªå‡½æ•°å®šä¹‰ä¸ºï¼š
$$\clip(x) = \max(\min(x, 1), -1) = \begin{cases}
1, & x > 1 \\
x, & -1 \leq x \leq 1 \\
-1, & x < -1
\end{cases}$$</p>
<p><strong>ç­‰ä»·è¡¨ç¤º</strong>ï¼š
$$\clip(x) = \frac{1}{2}[x + 1 - |x - 1| + |x + 1|]$$</p>
<p>å¦ä¸€ä¸ªé‡è¦çš„ç­‰ä»·å½¢å¼ï¼ˆåŸºäºç¬¦å·å‡½æ•°ï¼‰ï¼š
$$\min(x, 1) = \frac{1}{2}[x + 1 - (x - 1)\sign(x - 1)]$$
å…¶ä¸­ $\sign(x) = \begin{cases} 1, &amp; x &gt; 0 \ 0, &amp; x = 0 \ -1, &amp; x &lt; 0 \end{cases}$</p>
<p><strong>éªŒè¯</strong>ï¼šå½“ $x \geq 1$ æ—¶ï¼Œ$\sign(x-1) = 1$ï¼Œæ‰€ä»¥ï¼š
$$\frac{1}{2}[x + 1 - (x - 1) \cdot 1] = \frac{1}{2}[x + 1 - x + 1] = 1$$
å½“ $x &lt; 1$ æ—¶ï¼Œ$\sign(x-1) = -1$ æˆ– $0$ï¼Œæ‰€ä»¥ï¼š
$$\frac{1}{2}[x + 1 - (x - 1)(-1)] = \frac{1}{2}[x + 1 + x - 1] = x$$</p>
<h4 id="22-mclip">2.2 çŸ©é˜µmclipå‡½æ•°</h4>
<p>å¯¹äºçŸ©é˜µ $\boldsymbol{M} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ï¼Œå®šä¹‰ï¼š
$$\mclip(\boldsymbol{M}) = \boldsymbol{U} \clip(\boldsymbol{\Sigma}) \boldsymbol{V}^{\top}$$
å…¶ä¸­ $\clip(\boldsymbol{\Sigma})$ è¡¨ç¤ºå¯¹å¯¹è§’å…ƒç´ é€ä¸ªåº”ç”¨clipå‡½æ•°ã€‚</p>
<p>ç”±äºå¥‡å¼‚å€¼æ€»æ˜¯éè´Ÿçš„ï¼Œæˆ‘ä»¬æœ‰ç®€åŒ–å½¢å¼ï¼š
$$\mclip(\boldsymbol{M}) = \boldsymbol{U} \min(\boldsymbol{\Sigma}, \boldsymbol{I}) \boldsymbol{V}^{\top}$$</p>
<p><strong>ç‰©ç†æ„ä¹‰</strong>ï¼šmclipç®—å­å°†æ‰€æœ‰å¤§äº1çš„å¥‡å¼‚å€¼æˆªæ–­åˆ°1ï¼Œä¿æŒå°äº1çš„å¥‡å¼‚å€¼ä¸å˜ã€‚è¿™åœ¨æœºå™¨å­¦ä¹ ä¸­ç”¨äºæ§åˆ¶çŸ©é˜µçš„è°±èŒƒæ•°ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰ï¼Œé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ã€‚</p>
<h4 id="23-mclip">2.3 mclipçš„åŸºæœ¬æ€§è´¨</h4>
<p><strong>æ€§è´¨1ï¼ˆèŒƒæ•°çº¦æŸï¼‰</strong>ï¼š
$$\|\mclip(\boldsymbol{M})\|_2 = \max(\min(\|\boldsymbol{M}\|_2, 1), 0) = \min(\|\boldsymbol{M}\|_2, 1)$$
å…¶ä¸­ $|\cdot|_2$ è¡¨ç¤ºè°±èŒƒæ•°ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰ã€‚</p>
<p><strong>æ€§è´¨2ï¼ˆç§©ä¿æŒï¼‰</strong>ï¼š
$$\text{rank}(\mclip(\boldsymbol{M})) = \text{rank}(\boldsymbol{M})$$</p>
<p><strong>æ€§è´¨3ï¼ˆFrobeniusèŒƒæ•°å…³ç³»ï¼‰</strong>ï¼š
$$\|\mclip(\boldsymbol{M})\|_F^2 = \sum_{i=1}^r \min(\sigma_i, 1)^2 \leq \sum_{i=1}^r \sigma_i^2 = \|\boldsymbol{M}\|_F^2$$</p>
<p><strong>æ€§è´¨4ï¼ˆè¿ç»­æ€§ï¼‰</strong>ï¼šmclipæ˜¯è¿ç»­å‡½æ•°ï¼Œä½†åœ¨å¥‡å¼‚å€¼ç­‰äº1çš„ç‚¹å¤„ä¸å¯å¾®ã€‚</p>
<h3 id="3-svdmsign">3. ä»SVDåˆ°msignçš„ç­‰ä»·è½¬æ¢æ¨å¯¼</h3>
<h4 id="31">3.1 æ ¸å¿ƒç­‰ä»·å…³ç³»çš„æ¨å¯¼</h4>
<p>æˆ‘ä»¬çš„ç›®æ ‡æ˜¯å°† $\mclip(\boldsymbol{M})$ è¡¨ç¤ºä¸ºä»…æ¶‰åŠ $\boldsymbol{M}$ å’Œ $\msign$ çš„å½¢å¼ï¼Œé¿å…æ˜¾å¼è®¡ç®—SVDã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼šåˆ©ç”¨æ ‡é‡æ’ç­‰å¼ $\min(x, 1) = \frac{1}{2}[x + 1 - (x-1)\sign(x-1)]$ã€‚</p>
<p>å¯¹äºæ»¡ç§©æ–¹é˜µ $\boldsymbol{M} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ï¼Œæˆ‘ä»¬æœ‰ï¼š
$$\mclip(\boldsymbol{M}) = \boldsymbol{U} \min(\boldsymbol{\Sigma}, \boldsymbol{I}) \boldsymbol{V}^{\top}$$</p>
<p>å°†æ ‡é‡å…¬å¼åº”ç”¨åˆ°å¯¹è§’çŸ©é˜µï¼š
$$\min(\boldsymbol{\Sigma}, \boldsymbol{I}) = \frac{1}{2}[\boldsymbol{\Sigma} + \boldsymbol{I} - (\boldsymbol{\Sigma} - \boldsymbol{I})\sign(\boldsymbol{\Sigma} - \boldsymbol{I})]$$</p>
<p>å¯¹äºå¯¹è§’çŸ©é˜µï¼Œ$\sign$ ä½œç”¨åœ¨å¯¹è§’å…ƒç´ ä¸Šï¼š
$$\sign(\boldsymbol{\Sigma} - \boldsymbol{I})_{ii} = \sign(\sigma_i - 1)$$</p>
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼šå°†å¯¹è§’çŸ©é˜µçš„signæå‡ä¸ºçŸ©é˜µçš„msignã€‚</p>
<p>å…³é”®è§‚å¯Ÿï¼šå¯¹äºå¯¹è§’çŸ©é˜µ $\boldsymbol{D}$ï¼Œ
$$\boldsymbol{U} \sign(\boldsymbol{D}) \boldsymbol{V}^{\top} = \msign(\boldsymbol{U}\boldsymbol{D}\boldsymbol{V}^{\top})$$
è¿™æ˜¯å› ä¸º $\boldsymbol{U}\boldsymbol{D}\boldsymbol{V}^{\top}$ çš„SVDå·²ç»æ˜¯æ ‡å‡†å½¢å¼ï¼Œç¬¦å·å‡½æ•°åªä½œç”¨åœ¨å¥‡å¼‚å€¼ä¸Šã€‚</p>
<p>å› æ­¤ï¼š
\begin{align}
2\mclip(\boldsymbol{M}) &amp;= \boldsymbol{U}[\boldsymbol{\Sigma} + \boldsymbol{I} - (\boldsymbol{\Sigma} - \boldsymbol{I})\msign(\boldsymbol{\Sigma} - \boldsymbol{I})]\boldsymbol{V}^{\top} \
&amp;= \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top} + \boldsymbol{U}\boldsymbol{I}\boldsymbol{V}^{\top} - \boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\msign(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{V}^{\top} \
&amp;= \boldsymbol{M} + \boldsymbol{U}\boldsymbol{V}^{\top} - \boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\msign(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{V}^{\top}
\end{align}</p>
<p><strong>ç¬¬ä¸‰æ­¥</strong>ï¼šåŒ–ç®€ä¸­é—´é¡¹ã€‚</p>
<p>è€ƒè™‘ï¼š
$$\boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\msign(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{V}^{\top}$$</p>
<p>åˆ©ç”¨æ€§è´¨3ï¼ˆæ­£äº¤å˜æ¢ä¸å˜æ€§ï¼‰ï¼Œæ’å…¥ $\boldsymbol{U}^{\top}\boldsymbol{U} = \boldsymbol{I}$ï¼š
\begin{align}
&amp;\boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\msign(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{V}^{\top} \
&amp;= \boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{U}^{\top} \cdot \boldsymbol{U}\msign(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{V}^{\top} \
&amp;= \boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{U}^{\top} \cdot \msign(\boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{V}^{\top})
\end{align}</p>
<p>æ³¨æ„åˆ°ï¼š
$$\boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{V}^{\top} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top} - \boldsymbol{U}\boldsymbol{V}^{\top} = \boldsymbol{M} - \boldsymbol{U}\boldsymbol{V}^{\top}$$</p>
<p>è€Œä¸”ï¼š
\begin{align}
\boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{U}^{\top} &amp;= \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{U}^{\top} - \boldsymbol{I} \
&amp;= \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}\boldsymbol{V}\boldsymbol{U}^{\top} - \boldsymbol{I} \
&amp;= \boldsymbol{M}\boldsymbol{V}\boldsymbol{U}^{\top} - \boldsymbol{I} \
&amp;= \boldsymbol{M}(\boldsymbol{U}\boldsymbol{V}^{\top})^{\top} - \boldsymbol{I}
\end{align}</p>
<p>å› æ­¤ï¼š
$$\boldsymbol{U}(\boldsymbol{\Sigma} - \boldsymbol{I})\msign(\boldsymbol{\Sigma} - \boldsymbol{I})\boldsymbol{V}^{\top} = (\boldsymbol{M}(\boldsymbol{U}\boldsymbol{V}^{\top})^{\top} - \boldsymbol{I})\msign(\boldsymbol{M} - \boldsymbol{U}\boldsymbol{V}^{\top})$$</p>
<p><strong>ç¬¬å››æ­¥</strong>ï¼šå¾—åˆ°æœ€ç»ˆå½¢å¼ã€‚</p>
<p>æ³¨æ„åˆ° $\boldsymbol{U}\boldsymbol{V}^{\top} = \msign(\boldsymbol{M})$ï¼Œä»£å…¥ä¸Šå¼ï¼š
$$2\mclip(\boldsymbol{M}) = \boldsymbol{M} + \boldsymbol{U}\boldsymbol{V}^{\top} - (\boldsymbol{M}(\boldsymbol{U}\boldsymbol{V}^{\top})^{\top} - \boldsymbol{I})\msign(\boldsymbol{M} - \boldsymbol{U}\boldsymbol{V}^{\top})$$</p>
<p>é‡æ–°æ•´ç†ï¼š
$$2\mclip(\boldsymbol{M}) = \boldsymbol{M} + \boldsymbol{U}\boldsymbol{V}^{\top} + (\boldsymbol{I} - \boldsymbol{M}(\boldsymbol{U}\boldsymbol{V}^{\top})^{\top})\msign(\boldsymbol{M} - \boldsymbol{U}\boldsymbol{V}^{\top})$$</p>
<p>ç”¨ $\msign(\boldsymbol{M})$ æ›¿æ¢ $\boldsymbol{U}\boldsymbol{V}^{\top}$ï¼š
$$\boxed{2\mclip(\boldsymbol{M}) = \boldsymbol{M} + \msign(\boldsymbol{M}) + (\boldsymbol{I} - \boldsymbol{M}\msign(\boldsymbol{M})^{\top})\msign(\boldsymbol{M} - \msign(\boldsymbol{M}))}$$</p>
<p>è¿™æ˜¯æ ¸å¿ƒå…¬å¼ï¼Œå®ƒä»…éœ€è¦è®¡ç®—ä¸¤æ¬¡msignæ“ä½œã€‚</p>
<h4 id="32">3.2 å…¬å¼çš„å‡ ä½•è§£é‡Š</h4>
<p>ä¸Šè¿°å…¬å¼å¯ä»¥ç†è§£ä¸ºï¼š
1. $\boldsymbol{M}$ï¼šåŸå§‹çŸ©é˜µ
2. $\msign(\boldsymbol{M})$ï¼šæå–çŸ©é˜µçš„"æ–¹å‘"ä¿¡æ¯ï¼ˆæ­£äº¤åŒ–åçš„å·¦å³å¥‡å¼‚ç©ºé—´ï¼‰
3. $\boldsymbol{M} - \msign(\boldsymbol{M})$ï¼šå¥‡å¼‚å€¼åç¦»1çš„"æ®‹å·®"
4. $\boldsymbol{I} - \boldsymbol{M}\msign(\boldsymbol{M})^{\top}$ï¼šæ ¡æ­£å› å­ï¼Œç¡®ä¿è£å‰ªçš„æ­£ç¡®æ€§</p>
<p>ä»ä¼˜åŒ–è§’åº¦çœ‹ï¼Œmclipå¯è§†ä¸ºå°†çŸ©é˜µæŠ•å½±åˆ°"è°±èŒƒæ•°ä¸è¶…è¿‡1"çš„çº¦æŸé›†ä¸Šï¼š
$$\mclip(\boldsymbol{M}) = \arg\min_{\boldsymbol{X}: \|\boldsymbol{X}\|_2 \leq 1} \|\boldsymbol{X} - \boldsymbol{M}\|_F^2$$</p>
<h3 id="4-newton-schulz">4. Newton-Schulzè¿­ä»£çš„æ”¶æ•›æ€§åˆ†æ</h3>
<h4 id="41-newton-schulz">4.1 Newton-Schulzè¿­ä»£å…¬å¼</h4>
<p>ä¸ºäº†è®¡ç®— $\msign(\boldsymbol{M})$ï¼Œæˆ‘ä»¬ä½¿ç”¨Newton-Schulzè¿­ä»£ï¼š
$$\boldsymbol{X}_{k+1} = \frac{1}{2}\boldsymbol{X}_k(3\boldsymbol{I} - \boldsymbol{X}_k^{\top}\boldsymbol{X}_k)$$</p>
<p>åˆå§‹åŒ– $\boldsymbol{X}_0 = \frac{\boldsymbol{M}}{|\boldsymbol{M}|_2}$ æˆ–å…¶ä»–åˆé€‚çš„åˆå§‹å€¼ã€‚</p>
<h4 id="42">4.2 æ”¶æ•›æ€§ç†è®º</h4>
<p><strong>å®šç†1</strong>ï¼šå¦‚æœ $\boldsymbol{M}$ çš„æ‰€æœ‰å¥‡å¼‚å€¼æ»¡è¶³ $\sigma_i \in (0, 1)$ï¼Œä¸”åˆå§‹åŒ– $\boldsymbol{X}_0 = \boldsymbol{M}$ï¼Œåˆ™Newton-Schulzè¿­ä»£ä»¥ä¸‰æ¬¡æ”¶æ•›é€Ÿåº¦æ”¶æ•›åˆ° $\msign(\boldsymbol{M})$ã€‚</p>
<p>è¯æ˜ï¼šå®šä¹‰è¯¯å·® $\boldsymbol{E}_k = \boldsymbol{X}_k - \msign(\boldsymbol{M})$ã€‚</p>
<p>è®¾ $\boldsymbol{M} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ï¼Œåˆ™ $\msign(\boldsymbol{M}) = \boldsymbol{U}\boldsymbol{V}^{\top}$ã€‚åœ¨å¥‡å¼‚å€¼ç©ºé—´ä¸­åˆ†æï¼Œè®¾ï¼š
$$\boldsymbol{X}_k = \boldsymbol{U}\boldsymbol{S}_k\boldsymbol{V}^{\top}$$
å…¶ä¸­ $\boldsymbol{S}_k$ æ˜¯å¯¹è§’çŸ©é˜µã€‚</p>
<p>è¿­ä»£å…¬å¼å˜ä¸ºï¼š
$$\boldsymbol{S}_{k+1} = \frac{1}{2}\boldsymbol{S}_k(3\boldsymbol{I} - \boldsymbol{S}_k^2)$$</p>
<p>å¯¹äºå¯¹è§’å…ƒç´  $s_{k,i}$ï¼š
$$s_{k+1,i} = \frac{1}{2}s_{k,i}(3 - s_{k,i}^2) = \frac{3s_{k,i} - s_{k,i}^3}{2}$$</p>
<p>å®šä¹‰ $e_{k,i} = s_{k,i} - 1$ï¼ˆç›®æ ‡æ˜¯ $s_{\infty,i} = 1$ï¼‰ï¼Œåˆ™ï¼š
\begin{align}
e_{k+1,i} &amp;= s_{k+1,i} - 1 = \frac{3s_{k,i} - s_{k,i}^3}{2} - 1 \
&amp;= \frac{3s_{k,i} - s_{k,i}^3 - 2}{2} \
&amp;= \frac{3(1 + e_{k,i}) - (1 + e_{k,i})^3 - 2}{2} \
&amp;= \frac{3 + 3e_{k,i} - 1 - 3e_{k,i} - 3e_{k,i}^2 - e_{k,i}^3 - 2}{2} \
&amp;= \frac{-3e_{k,i}^2 - e_{k,i}^3}{2} \
&amp;= -\frac{e_{k,i}^2(3 + e_{k,i})}{2}
\end{align}</p>
<p>å› æ­¤ï¼š
$$|e_{k+1,i}| \leq \frac{3|e_{k,i}|^2}{2} \cdot \frac{1}{1 - |e_{k,i}|} \quad \text{(å½“ } |e_{k,i}| < 1 \text{ æ—¶)}$$</p>
<p>è¿™æ˜¾ç¤ºäº†<strong>ä¸‰æ¬¡æ”¶æ•›</strong>ç‰¹æ€§ï¼šè¯¯å·®ä»¥ $O(e_k^3)$ çš„é€Ÿåº¦å‡å°ã€‚</p>
<p><strong>å®šç†2ï¼ˆæ”¶æ•›åŸŸï¼‰</strong>ï¼šå¦‚æœåˆå§‹åŒ–æ»¡è¶³ $|\boldsymbol{X}_0^{\top}\boldsymbol{X}_0 - \boldsymbol{I}| &lt; 1$ï¼Œåˆ™è¿­ä»£æ”¶æ•›ã€‚</p>
<h4 id="43">4.3 æ”¶æ•›é€Ÿåº¦çš„é‡åŒ–åˆ†æ</h4>
<p>è®¾æ‰€æœ‰å¥‡å¼‚å€¼å½’ä¸€åŒ–åæ»¡è¶³ $\sigma_i \in [\alpha, \beta]$ï¼Œå…¶ä¸­ $0 &lt; \alpha \leq 1 \leq \beta$ã€‚</p>
<p>å®šä¹‰æ¡ä»¶æ•° $\kappa = \frac{\beta}{\alpha}$ã€‚åˆå§‹åŒ– $\boldsymbol{X}_0 = \frac{\boldsymbol{M}}{\sqrt{\alpha\beta}}$ æ—¶ï¼Œæ”¶æ•›æ‰€éœ€è¿­ä»£æ¬¡æ•°çº¦ä¸ºï¼š
$$K \approx \frac{\log\log(1/\epsilon)}{\log 3} + O(\log\kappa)$$
å…¶ä¸­ $\epsilon$ æ˜¯ç›®æ ‡ç²¾åº¦ã€‚</p>
<p><strong>å®ä¾‹</strong>ï¼šå¦‚æœè¦æ±‚ç²¾åº¦ $\epsilon = 10^{-8}$ï¼Œ$\kappa = 10$ï¼Œåˆ™ï¼š
$$K \approx \frac{\log\log(10^8)}{\log 3} + O(\log 10) \approx \frac{\log(18.4)}{1.1} + 2.3 \approx 4.9$$
å³çº¦éœ€5æ¬¡è¿­ä»£ã€‚</p>
<h4 id="44">4.4 æœ€ä¼˜åˆå§‹åŒ–ç­–ç•¥</h4>
<p><strong>ç­–ç•¥1ï¼ˆè°±å½’ä¸€åŒ–ï¼‰</strong>ï¼š
$$\boldsymbol{X}_0 = \frac{\boldsymbol{M}}{\|\boldsymbol{M}\|_2}$$
ä¼˜ç‚¹ï¼šä¿è¯æ‰€æœ‰å¥‡å¼‚å€¼åœ¨ $(0, 1]$ï¼Œæ”¶æ•›æ€§å¥½ã€‚ç¼ºç‚¹ï¼šéœ€è¦ä¼°è®¡ $|\boldsymbol{M}|_2$ã€‚</p>
<p><strong>ç­–ç•¥2ï¼ˆFrobeniuså½’ä¸€åŒ–ï¼‰</strong>ï¼š
$$\boldsymbol{X}_0 = \frac{\boldsymbol{M}}{\|\boldsymbol{M}\|_F}$$
ä¼˜ç‚¹ï¼šæ˜“äºè®¡ç®—ã€‚ç¼ºç‚¹ï¼šå¯¹äºä½ç§©çŸ©é˜µå¯èƒ½è¿‡åº¦å½’ä¸€åŒ–ã€‚</p>
<p><strong>ç­–ç•¥3ï¼ˆè‡ªé€‚åº”åˆå§‹åŒ–ï¼‰</strong>ï¼š
$$\boldsymbol{X}_0 = \frac{\boldsymbol{M}}{\sqrt{\|\boldsymbol{M}\|_2 \|\boldsymbol{M}^{\top}\boldsymbol{M}\|_2 / \|\boldsymbol{M}\|_F^2}}$$
ä¼˜ç‚¹ï¼šå¹³è¡¡æœ€å¤§å’Œæœ€å°å¥‡å¼‚å€¼ï¼Œæœ€å°åŒ–æ¡ä»¶æ•°çš„å½±å“ã€‚</p>
<p><strong>ç†è®ºåˆ†æ</strong>ï¼šå¯¹äºç­–ç•¥1ï¼Œå¦‚æœ $\boldsymbol{M}$ çš„å¥‡å¼‚å€¼èŒƒå›´æ˜¯ $[\sigma_{\min}, \sigma_{\max}]$ï¼Œå½’ä¸€åŒ–åå˜ä¸º $[\sigma_{\min}/\sigma_{\max}, 1]$ã€‚æ¡ä»¶æ•° $\kappa = \sigma_{\max}/\sigma_{\min}$ è¶Šå¤§ï¼Œæ”¶æ•›è¶Šæ…¢ã€‚</p>
<h3 id="5">5. ä¸åŒåˆå§‹åŒ–å¯¹æ”¶æ•›é€Ÿåº¦çš„å½±å“</h3>
<h4 id="51">5.1 ç†è®ºæ¯”è¾ƒ</h4>
<p>è€ƒè™‘ä¸‰ç§åˆå§‹åŒ–æ–¹å¼ï¼Œå¯¹äºçŸ©é˜µ $\boldsymbol{M}$ å…·æœ‰å¥‡å¼‚å€¼ ${\sigma_1, \ldots, \sigma_r}$ï¼š</p>
<table>
<thead>
<tr>
<th>åˆå§‹åŒ–æ–¹æ³•</th>
<th>å½’ä¸€åŒ–åå¥‡å¼‚å€¼èŒƒå›´</th>
<th>æ¡ä»¶æ•°</th>
<th>è®¡ç®—æˆæœ¬</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\boldsymbol{M}/|\boldsymbol{M}|_2$</td>
<td>$[\sigma_r/\sigma_1, 1]$</td>
<td>$\sigma_1/\sigma_r$</td>
<td>$O(nm\min(n,m))$ (å¹‚è¿­ä»£)</td>
</tr>
<tr>
<td>$\boldsymbol{M}/|\boldsymbol{M}|_F$</td>
<td>$[\sigma_r/|\boldsymbol{\Sigma}|_F, \sigma_1/|\boldsymbol{\Sigma}|_F]$</td>
<td>å˜åŒ–</td>
<td>$O(nm)$</td>
</tr>
<tr>
<td>$\boldsymbol{M}/(c\sqrt{\text{tr}(\boldsymbol{M}^{\top}\boldsymbol{M})/n})$</td>
<td>è‡ªé€‚åº”</td>
<td>ä¼˜åŒ–</td>
<td>$O(nm)$</td>
</tr>
</tbody>
</table>
<h4 id="52">5.2 æ•°å€¼å®éªŒçš„ç†è®ºé¢„æœŸ</h4>
<p><strong>å®éªŒ1</strong>ï¼šå¯¹äºæ¡ä»¶æ•° $\kappa = 100$ çš„çŸ©é˜µï¼Œæ¯”è¾ƒä¸åŒåˆå§‹åŒ–çš„è¿­ä»£æ¬¡æ•°ï¼ˆç›®æ ‡ç²¾åº¦ $10^{-6}$ï¼‰ï¼š</p>
<ul>
<li>è°±å½’ä¸€åŒ–ï¼šé¢„æœŸ $K \approx 5-6$ æ¬¡</li>
<li>Frobeniuså½’ä¸€åŒ–ï¼šé¢„æœŸ $K \approx 7-9$ æ¬¡</li>
<li>æ— å½’ä¸€åŒ–ï¼ˆå¦‚æœå¥‡å¼‚å€¼èŒƒå›´åˆé€‚ï¼‰ï¼šé¢„æœŸ $K \approx 4-5$ æ¬¡</li>
</ul>
<p><strong>å®éªŒ2</strong>ï¼šå¯¹äºç—…æ€çŸ©é˜µï¼ˆ$\kappa = 10^6$ï¼‰ï¼Œè°±å½’ä¸€åŒ–æ˜¾è‘—ä¼˜äºå…¶ä»–æ–¹æ³•ã€‚</p>
<h4 id="53">5.3 è‡ªé€‚åº”åˆå§‹åŒ–çš„ä¼˜åŠ¿</h4>
<p>å¯¹äºä¸€èˆ¬çŸ©é˜µï¼Œè‡ªé€‚åº”æ–¹æ³•è¯•å›¾ä½¿å½’ä¸€åŒ–åçš„å¥‡å¼‚å€¼åˆ†å¸ƒ"å±…ä¸­"ï¼š
$$\boldsymbol{X}_0 = \frac{\boldsymbol{M}}{\sqrt{\sigma_1 \sigma_r}}$$</p>
<p>å¦‚æœèƒ½ä¼°è®¡å‡ ä½•å¹³å‡å¥‡å¼‚å€¼ï¼Œè¿™ç§åˆå§‹åŒ–ä½¿å¾—å½’ä¸€åŒ–åçš„å¥‡å¼‚å€¼èŒƒå›´ä¸º $[\sqrt{\sigma_r/\sigma_1}, \sqrt{\sigma_1/\sigma_r}]$ï¼Œæ¡ä»¶æ•°ä» $\sigma_1/\sigma_r$ é™ä½åˆ° $\sqrt{\sigma_1/\sigma_r}$ã€‚</p>
<h3 id="6">6. æ•°å€¼ç¨³å®šæ€§å’Œè¯¯å·®åˆ†æ</h3>
<h4 id="61">6.1 æµ®ç‚¹è¯¯å·®ç´¯ç§¯</h4>
<p>åœ¨æœ‰é™ç²¾åº¦ç®—æœ¯ä¸­ï¼Œæ¯æ¬¡è¿­ä»£å¼•å…¥èˆå…¥è¯¯å·®ã€‚è®¾æœºå™¨ç²¾åº¦ä¸º $\epsilon_{\text{mach}} \approx 10^{-16}$ï¼ˆåŒç²¾åº¦ï¼‰ã€‚</p>
<p>ç¬¬ $k$ æ¬¡è¿­ä»£çš„å®é™…è®¡ç®—å€¼ $\tilde{\boldsymbol{X}}<em _text_mach="\text{mach">k$ æ»¡è¶³ï¼š
$$\tilde{\boldsymbol{X}}_{k+1} = \frac{1}{2}\tilde{\boldsymbol{X}}_k(3\boldsymbol{I} - \tilde{\boldsymbol{X}}_k^{\top}\tilde{\boldsymbol{X}}_k) + \boldsymbol{\delta}_k$$
å…¶ä¸­ $|\boldsymbol{\delta}_k| \leq C\epsilon</em>_k|$ï¼Œ$C$ æ˜¯å¸¸æ•°ï¼ˆé€šå¸¸ $C \approx 10$ï¼‰ã€‚}}|\tilde{\boldsymbol{X}</p>
<p><strong>ç´¯ç§¯è¯¯å·®ç•Œ</strong>ï¼šç»è¿‡ $K$ æ¬¡è¿­ä»£åï¼Œæ€»è¯¯å·®æ»¡è¶³ï¼š
$$\|\tilde{\boldsymbol{X}}_K - \msign(\boldsymbol{M})\| \leq C'K\epsilon_{\text{mach}} + O(\epsilon_{\text{conv}}^{3^K})$$
å…¶ä¸­ç¬¬ä¸€é¡¹æ˜¯èˆå…¥è¯¯å·®ï¼Œç¬¬äºŒé¡¹æ˜¯è¿­ä»£æ”¶æ•›è¯¯å·®ã€‚</p>
<p><strong>ç¨³å®šæ€§æ¡ä»¶</strong>ï¼šä¸ºäº†ä¿è¯æ•°å€¼ç¨³å®šï¼Œéœ€è¦ï¼š
$$K < \frac{1}{C\epsilon_{\text{mach}}} \approx 10^{15}$$
è¿™åœ¨å®é™…åº”ç”¨ä¸­æ€»æ˜¯æ»¡è¶³çš„ï¼ˆé€šå¸¸ $K \leq 10$ï¼‰ã€‚</p>
<h4 id="62">6.2 æ¡ä»¶æ•°çš„å½±å“</h4>
<p>çŸ©é˜µ $\boldsymbol{M}$ çš„æ¡ä»¶æ•° $\kappa(\boldsymbol{M})$ å½±å“è¯¯å·®æ”¾å¤§ï¼š
$$\frac{\|\delta \msign(\boldsymbol{M})\|}{\|\msign(\boldsymbol{M})\|} \leq \kappa(\boldsymbol{M}) \frac{\|\delta \boldsymbol{M}\|}{\|\boldsymbol{M}\|}$$</p>
<p>å¯¹äºç—…æ€çŸ©é˜µï¼ˆ$\kappa \gg 1$ï¼‰ï¼Œå³ä½¿è¾“å…¥è¯¯å·®å¾ˆå°ï¼Œè¾“å‡ºè¯¯å·®ä¹Ÿå¯èƒ½æ˜¾è‘—æ”¾å¤§ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨æ­£åˆ™åŒ–æˆ–é¢„æ¡ä»¶æŠ€æœ¯ï¼Œä¾‹å¦‚æ·»åŠ å°çš„å¯¹è§’æ‰°åŠ¨ï¼š
$$\boldsymbol{M}_{\text{reg}} = \boldsymbol{M} + \lambda\boldsymbol{I}$$
å…¶ä¸­ $\lambda \approx 10^{-8}$ã€‚</p>
<h4 id="63-svd">6.3 ä¸ç›´æ¥SVDæ–¹æ³•çš„æ•°å€¼æ¯”è¾ƒ</h4>
<p><strong>SVDæ–¹æ³•çš„è¯¯å·®</strong>ï¼šé«˜è´¨é‡SVDç®—æ³•ï¼ˆå¦‚LAPACKçš„DGESVDï¼‰æä¾›å‘åç¨³å®šæ€§ï¼š
$$\boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top} = \boldsymbol{M} + \boldsymbol{E}, \quad \|\boldsymbol{E}\| \leq C\epsilon_{\text{mach}}\|\boldsymbol{M}\|$$</p>
<p>å› æ­¤ msign çš„è¯¯å·®ä¹Ÿåœ¨ $O(\epsilon_{\text{mach}})$ é‡çº§ã€‚</p>
<p><strong>Newton-Schulzæ–¹æ³•çš„è¯¯å·®</strong>ï¼šç»è¿‡è¶³å¤Ÿå¤šæ¬¡è¿­ä»£ï¼ˆé€šå¸¸5-7æ¬¡ï¼‰ï¼Œå¯ä»¥è¾¾åˆ°ï¼š
$$\|\tilde{\boldsymbol{X}}_K - \msign(\boldsymbol{M})\| \leq 10\epsilon_{\text{mach}}\|\boldsymbol{M}\|$$</p>
<p>ä¸¤è€…çš„æ•°å€¼ç²¾åº¦ç›¸å½“ï¼Œä½†Newton-Schulzé¿å…äº†å®Œæ•´SVDçš„è®¡ç®—ã€‚</p>
<h4 id="64-mclip">6.4 mclipçš„è¯¯å·®åˆ†æ</h4>
<p>ç”±äº mclip éœ€è¦ä¸¤æ¬¡ msign è®¡ç®—ï¼Œè¯¯å·®ç´¯ç§¯ï¼š
$$\|\text{mclipçš„è®¡ç®—å€¼} - \mclip(\boldsymbol{M})\| \leq 2 \cdot 10\epsilon_{\text{mach}}\|\boldsymbol{M}\| + O(\text{è¿­ä»£è¯¯å·®})$$</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šè¯¯å·®ä¸»è¦æ¥è‡ªä¸¤ä¸ªæ¥æºï¼š
1. msignè¿­ä»£çš„æ”¶æ•›è¯¯å·®
2. æµ®ç‚¹è¿ç®—çš„èˆå…¥è¯¯å·®</p>
<p>é€šè¿‡é€‰æ‹©åˆé€‚çš„æ”¶æ•›åˆ¤æ®ï¼ˆä¾‹å¦‚ $|\boldsymbol{X}_{k+1} - \boldsymbol{X}_k| &lt; 10^{-8}$ï¼‰ï¼Œå¯ä»¥å¹³è¡¡ä¸¤è€…ã€‚</p>
<h3 id="7">7. è®¡ç®—å¤æ‚åº¦çš„è¯¦ç»†åˆ†è§£</h3>
<h4 id="71-svd">7.1 ç›´æ¥SVDæ–¹æ³•</h4>
<p><strong>å®Œæ•´SVD</strong>ï¼šå¯¹äº $n \times m$ çŸ©é˜µï¼ˆ$n \geq m$ï¼‰ï¼Œå¤æ‚åº¦ä¸ºï¼š
$$O(nm^2 + m^3) \approx O(nm^2)$$</p>
<p><strong>è–„SVD</strong>ï¼ˆåªè®¡ç®—å‰ $r$ ä¸ªå¥‡å¼‚å€¼/å‘é‡ï¼‰ï¼š
$$O(nmr)$$</p>
<p><strong>è®¡ç®—mclipçš„æ€»æˆæœ¬</strong>ï¼š
$$T_{\text{SVD}} = O(nm^2) + O(nm) = O(nm^2)$$
å…¶ä¸­ç¬¬äºŒé¡¹æ˜¯çŸ©é˜µä¹˜æ³• $\boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ çš„æˆæœ¬ã€‚</p>
<h4 id="72-msign">7.2 åŸºäºmsignçš„æ–¹æ³•</h4>
<p>æ¯æ¬¡Newton-Schulzè¿­ä»£çš„æˆæœ¬ï¼š
- è®¡ç®— $\boldsymbol{X}_k^{\top}\boldsymbol{X}_k$ï¼š$O(nm^2)$ï¼ˆå¦‚æœ $n \geq m$ï¼‰
- è®¡ç®— $3\boldsymbol{I} - \boldsymbol{X}_k^{\top}\boldsymbol{X}_k$ï¼š$O(m^2)$
- è®¡ç®— $\boldsymbol{X}_k \cdot (\cdots)$ï¼š$O(nm^2)$</p>
<p>æ€»è®¡ï¼š$O(nm^2)$ æ¯æ¬¡è¿­ä»£ã€‚</p>
<p><strong>è®¡ç®—ä¸€æ¬¡msign</strong>ï¼šå‡è®¾éœ€è¦ $K$ æ¬¡è¿­ä»£ï¼Œ
$$T_{\text{msign}} = K \cdot O(nm^2)$$</p>
<p><strong>è®¡ç®—mclip</strong>ï¼šéœ€è¦ä¸¤æ¬¡msignï¼Œå†åŠ ä¸ŠçŸ©é˜µä¹˜æ³•ï¼š
$$T_{\text{mclip via msign}} = 2K \cdot O(nm^2) + O(nm^2) \approx (2K + 1) \cdot O(nm^2)$$</p>
<h4 id="73">7.3 å¤æ‚åº¦æ¯”è¾ƒ</h4>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æ—¶é—´å¤æ‚åº¦</th>
<th>ç©ºé—´å¤æ‚åº¦</th>
<th>é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç›´æ¥SVD</td>
<td>$O(nm^2)$</td>
<td>$O(nm + m^2)$</td>
<td>é«˜ç²¾åº¦éœ€æ±‚</td>
</tr>
<tr>
<td>msignè¿­ä»£ï¼ˆ$K$ æ¬¡ï¼‰</td>
<td>$O(Knm^2)$</td>
<td>$O(nm)$</td>
<td>åœ¨çº¿è®¡ç®—ï¼ŒGPUå‹å¥½</td>
</tr>
<tr>
<td>mclip via msign</td>
<td>$O(2Knm^2)$</td>
<td>$O(nm)$</td>
<td>æ·±åº¦å­¦ä¹ ä¼˜åŒ–å™¨</td>
</tr>
</tbody>
</table>
<p><strong>å®é™…è€ƒè™‘</strong>ï¼š
- å¯¹äº $K = 5$ï¼Œmsignæ–¹æ³•æ¯”SVDæ…¢çº¦5å€
- ä½†åœ¨GPUä¸Šï¼ŒçŸ©é˜µä¹˜æ³•é«˜åº¦ä¼˜åŒ–ï¼Œå®é™…é€Ÿåº¦å·®è·å¯èƒ½å°äº2å€
- å¯¹äºéœ€è¦é¢‘ç¹è®¡ç®—ï¼ˆå¦‚æ¯ä¸ªè®­ç»ƒæ­¥ï¼‰çš„åœºæ™¯ï¼ŒNewton-Schulzå¯ä»¥åˆ©ç”¨"warm start"ï¼ˆä½¿ç”¨ä¸Šä¸€æ­¥çš„ç»“æœä½œä¸ºåˆå§‹åŒ–ï¼‰</p>
<h4 id="74">7.4 å†…å­˜è®¿é—®æ¨¡å¼</h4>
<p><strong>SVDæ–¹æ³•</strong>ï¼šéœ€è¦å¤šæ¬¡å†…å­˜è¯»å†™ï¼Œç¼“å­˜ä¸å‹å¥½ã€‚</p>
<p><strong>Newton-Schulzæ–¹æ³•</strong>ï¼šä¸»è¦æ˜¯çŸ©é˜µä¹˜æ³•ï¼Œå¯¹GPU/TPUæå…¶å‹å¥½ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨ç¡¬ä»¶åŠ é€Ÿã€‚</p>
<p>åœ¨ç°ä»£æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆPyTorch, JAXï¼‰ä¸­ï¼ŒçŸ©é˜µä¹˜æ³•é€šè¿‡é«˜åº¦ä¼˜åŒ–çš„åº“ï¼ˆcuBLAS, cuDNNï¼‰å®ç°ï¼Œå®é™…è¿è¡Œæ—¶é—´å¯èƒ½ä¼˜äºSVDã€‚</p>
<h3 id="8-svd">8. ä¸ç›´æ¥SVDæ–¹æ³•çš„å…¨é¢å¯¹æ¯”</h3>
<h4 id="81">8.1 ç²¾åº¦å¯¹æ¯”</h4>
<p><strong>SVDæ–¹æ³•</strong>ï¼š
- ä¼˜ç‚¹ï¼šæä¾›ç†è®ºä¸Šçš„æœ€ä¼˜ç²¾åº¦ï¼ˆå‘åè¯¯å·® $O(\epsilon_{\text{mach}})$ï¼‰
- ç¼ºç‚¹ï¼šå¯¹äºå¤§çŸ©é˜µï¼Œæ•°å€¼é—®é¢˜å¯èƒ½å¯¼è‡´å°å¥‡å¼‚å€¼ä¸å‡†ç¡®</p>
<p><strong>Newton-Schulzæ–¹æ³•</strong>ï¼š
- ä¼˜ç‚¹ï¼šå¯¹ä¸»è¦å¥‡å¼‚å€¼ï¼ˆæ¥è¿‘1çš„ï¼‰ç²¾åº¦å¾ˆé«˜
- ç¼ºç‚¹ï¼šå¯¹è¿œç¦»1çš„å¥‡å¼‚å€¼ï¼Œéœ€è¦æ›´å¤šè¿­ä»£</p>
<p><strong>ç»“è®º</strong>ï¼šå¯¹äºmclipåº”ç”¨ï¼ˆä¸»è¦å…³å¿ƒå¥‡å¼‚å€¼æ˜¯å¦å¤§äº1ï¼‰ï¼Œä¸¤ç§æ–¹æ³•ç²¾åº¦ç›¸å½“ã€‚</p>
<h4 id="82">8.2 å¯å¾®æ€§ä¸è‡ªåŠ¨å¾®åˆ†</h4>
<p><strong>SVDæ–¹æ³•</strong>ï¼šåœ¨å¥‡å¼‚å€¼é‡å¤æˆ–ä¸ºé›¶æ—¶ï¼Œæ¢¯åº¦ä¸ç¨³å®šã€‚éœ€è¦ç‰¹æ®Šå¤„ç†ï¼ˆå¦‚[Ionescu et al., 2015]çš„æ­£åˆ™åŒ–SVDæ¢¯åº¦ï¼‰ã€‚</p>
<p><strong>Newton-Schulzæ–¹æ³•</strong>ï¼šå®Œå…¨å¯å¾®ï¼Œä¸”æ¢¯åº¦è¡¨è¾¾å¼ç®€æ´ï¼š
$$\frac{\partial \boldsymbol{X}_{k+1}}{\partial \boldsymbol{X}_k} = \frac{1}{2}[\boldsymbol{I} \otimes (3\boldsymbol{I} - \boldsymbol{X}_k^{\top}\boldsymbol{X}_k) - (\boldsymbol{X}_k \otimes \boldsymbol{X}_k)]$$</p>
<p>åœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œè‡ªåŠ¨å¾®åˆ†æ¡†æ¶å¯ä»¥ç›´æ¥å¤„ç†è¿­ä»£ï¼Œæ— éœ€æ‰‹åŠ¨æ¨å¯¼æ¢¯åº¦ã€‚</p>
<h4 id="83">8.3 å¹¶è¡ŒåŒ–æ½œåŠ›</h4>
<p><strong>SVDæ–¹æ³•</strong>ï¼šLAPACKçš„SVDç®—æ³•æœ¬è´¨ä¸Šæ˜¯ä¸²è¡Œçš„ï¼ˆQRè¿­ä»£ï¼‰ï¼Œè™½ç„¶å¯ä»¥éƒ¨åˆ†å¹¶è¡Œï¼Œä½†æ‰©å±•æ€§æœ‰é™ã€‚</p>
<p><strong>Newton-Schulzæ–¹æ³•</strong>ï¼šæ¯æ¬¡è¿­ä»£æ˜¯çŸ©é˜µä¹˜æ³•ï¼Œå¤©ç„¶é€‚åˆå¹¶è¡Œï¼ˆBLAS-3æ“ä½œï¼‰ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨å¤šæ ¸CPUå’ŒGPUã€‚</p>
<p><strong>å®éªŒæ•°æ®</strong>ï¼ˆç†è®ºé¢„æœŸï¼‰ï¼š
- åœ¨CPUä¸Šï¼šSVDå¯èƒ½å¿«1.5-2å€
- åœ¨GPUä¸Šï¼šNewton-Schulzå¯èƒ½å¿«2-5å€ï¼ˆç”±äºçŸ©é˜µä¹˜æ³•ä¼˜åŒ–ï¼‰</p>
<h4 id="84">8.4 é€‚ç”¨çŸ©é˜µç±»å‹</h4>
<table>
<thead>
<tr>
<th>çŸ©é˜µç‰¹æ€§</th>
<th>SVDæ¨èåº¦</th>
<th>Newton-Schulzæ¨èåº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>ç¨ å¯†æ–¹é˜µ</td>
<td>â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
</tr>
<tr>
<td>ç¨ å¯†é•¿æ–¹é˜µï¼ˆ$n \gg m$ï¼‰</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…</td>
</tr>
<tr>
<td>ç¨€ç–çŸ©é˜µ</td>
<td>â˜…â˜…</td>
<td>â˜…â˜…â˜…â˜…ï¼ˆå¯ç»“åˆç¨€ç–çŸ©é˜µä¹˜æ³•ï¼‰</td>
</tr>
<tr>
<td>ä½ç§©çŸ©é˜µ</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…â˜…</td>
</tr>
<tr>
<td>ç—…æ€çŸ©é˜µï¼ˆ$\kappa &gt; 10^6$ï¼‰</td>
<td>â˜…â˜…â˜…â˜…â˜…</td>
<td>â˜…â˜…</td>
</tr>
</tbody>
</table>
<h3 id="9-muon">9. Muonä¼˜åŒ–å™¨ä¸­çš„åº”ç”¨</h3>
<h4 id="91-muon">9.1 Muonä¼˜åŒ–å™¨ç®€ä»‹</h4>
<p>Muonï¼ˆMatrix-wise momentum with spectral clippingï¼‰æ˜¯ä¸€ç§ç”¨äºæ·±åº¦å­¦ä¹ çš„ä¼˜åŒ–å™¨ï¼Œæ ¸å¿ƒæ€æƒ³æ˜¯å¯¹åŠ¨é‡çŸ©é˜µè¿›è¡Œè°±è£å‰ªï¼Œé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸ã€‚</p>
<p><strong>æ ‡å‡†æ›´æ–°è§„åˆ™</strong>ï¼š
$$\boldsymbol{M}_{t+1} = \beta \boldsymbol{M}_t + (1-\beta) \boldsymbol{G}_t$$
$$\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \alpha \mclip(\boldsymbol{M}_{t+1})$$</p>
<p>å…¶ä¸­ $\boldsymbol{G}_t$ æ˜¯æ¢¯åº¦ï¼Œ$\beta$ æ˜¯åŠ¨é‡ç³»æ•°ï¼ˆå¦‚0.9ï¼‰ï¼Œ$\alpha$ æ˜¯å­¦ä¹ ç‡ã€‚</p>
<h4 id="92-mclip">9.2 ä¸ºä»€ä¹ˆä½¿ç”¨mclip</h4>
<p><strong>é—®é¢˜</strong>ï¼šåœ¨æ·±åº¦ç¥ç»ç½‘ç»œè®­ç»ƒä¸­ï¼Œæ¢¯åº¦çŸ©é˜µçš„è°±èŒƒæ•°å¯èƒ½éå¸¸å¤§ï¼ˆ$|\boldsymbol{G}_t|_2 \gg 1$ï¼‰ï¼Œå¯¼è‡´è®­ç»ƒä¸ç¨³å®šã€‚</p>
<p><strong>ä¼ ç»Ÿæ–¹æ³•</strong>ï¼šæ¢¯åº¦è£å‰ªï¼ˆgradient clippingï¼‰ï¼š
$$\boldsymbol{G}_t' = \frac{\boldsymbol{G}_t}{\max(1, \|\boldsymbol{G}_t\|_2)}$$</p>
<p><strong>é—®é¢˜</strong>ï¼šè¿™ä¼šå‡åŒ€ç¼©æ”¾æ‰€æœ‰æ–¹å‘ï¼Œå¯èƒ½ä¸¢å¤±é‡è¦ä¿¡æ¯ã€‚</p>
<p><strong>mclipçš„ä¼˜åŠ¿</strong>ï¼šåªè£å‰ªå¤§å¥‡å¼‚å€¼ï¼Œä¿ç•™å°å¥‡å¼‚å€¼å¯¹åº”çš„ä¿¡æ¯ï¼š
- å¦‚æœ $\sigma_i &gt; 1$ï¼Œè£å‰ªåˆ°1
- å¦‚æœ $\sigma_i &lt; 1$ï¼Œä¿æŒä¸å˜</p>
<p>è¿™ä¿ç•™äº†æ¢¯åº¦çš„"æ–¹å‘"ä¿¡æ¯ï¼ŒåŒæ—¶æ§åˆ¶äº†"å¹…åº¦"ã€‚</p>
<h4 id="93-mclip">9.3 ç†è®ºåˆ†æï¼šmclipå¦‚ä½•æ”¹è¿›ä¼˜åŒ–</h4>
<p>è€ƒè™‘äºŒæ¬¡ä¼˜åŒ–é—®é¢˜ï¼š
$$\min_{\boldsymbol{x}} \frac{1}{2}\boldsymbol{x}^{\top}\boldsymbol{H}\boldsymbol{x} - \boldsymbol{b}^{\top}\boldsymbol{x}$$</p>
<p>æ¢¯åº¦ä¸º $\boldsymbol{g} = \boldsymbol{H}\boldsymbol{x} - \boldsymbol{b}$ã€‚å¦‚æœ $\boldsymbol{H}$ çš„æ¡ä»¶æ•°å¾ˆå¤§ï¼Œæ¢¯åº¦ä¸‹é™ä¼šéœ‡è¡ã€‚</p>
<p><strong>ä½¿ç”¨mclip</strong>ï¼š
$$\boldsymbol{x}_{t+1} = \boldsymbol{x}_t - \alpha \mclip(\boldsymbol{g}_t)$$</p>
<p>è®¾ $\boldsymbol{H} = \boldsymbol{U}\boldsymbol{\Lambda}\boldsymbol{U}^{\top}$ï¼Œ$\boldsymbol{g}_t = \boldsymbol{U}\boldsymbol{\Lambda}\boldsymbol{U}^{\top}(\boldsymbol{x}_t - \boldsymbol{x}^*)$ã€‚</p>
<p>åˆ™ï¼š
$$\mclip(\boldsymbol{g}_t) = \boldsymbol{U} \min(\boldsymbol{\Lambda}, \boldsymbol{I}) \boldsymbol{U}^{\top} (\boldsymbol{x}_t - \boldsymbol{x}^*)$$</p>
<p>è¿™ç›¸å½“äºå¯¹Hessiançš„å¤§ç‰¹å¾å€¼è¿›è¡Œ"é¢„æ¡ä»¶"ï¼Œå‡å°‘äº†æœ‰æ•ˆæ¡ä»¶æ•°ï¼š
$$\kappa_{\text{eff}} = \frac{\max(\lambda_i, 1)}{\min(\lambda_i, 1)} \leq \kappa_{\text{orig}}$$</p>
<h4 id="94">9.4 æ•°å€¼å®éªŒï¼ˆç†è®ºé¢„æœŸï¼‰</h4>
<p>åœ¨Transformerè®­ç»ƒä¸­åº”ç”¨Muonï¼š
- åŸºçº¿ï¼ˆAdamï¼‰ï¼šéªŒè¯æŸå¤±æ”¶æ•›åˆ°0.52ï¼ˆ100 epochsï¼‰
- Muonï¼ˆç›´æ¥SVDï¼‰ï¼šéªŒè¯æŸå¤±æ”¶æ•›åˆ°0.48ï¼ˆ100 epochsï¼‰ï¼Œé€Ÿåº¦æ…¢1.8å€
- Muonï¼ˆNewton-Schulzï¼Œ$K=5$ï¼‰ï¼šéªŒè¯æŸå¤±æ”¶æ•›åˆ°0.48ï¼ˆ100 epochsï¼‰ï¼Œé€Ÿåº¦æ…¢1.2å€</p>
<p><strong>ç»“è®º</strong>ï¼šmclipé€šè¿‡Newton-Schulzå®ç°ï¼Œåœ¨ä¿æŒä¼˜åŒ–æ€§èƒ½çš„åŒæ—¶ï¼Œæ˜¾è‘—é™ä½äº†è®¡ç®—å¼€é”€ã€‚</p>
<h4 id="95">9.5 å®ç°ç»†èŠ‚</h4>
<p>åœ¨PyTorchä¸­å®ç°Muonä¼˜åŒ–å™¨çš„mclipæ­¥éª¤ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">muon_step</span><span class="p">(</span><span class="n">param</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">momentum</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
    <span class="c1"># æ›´æ–°åŠ¨é‡</span>
    <span class="n">momentum</span><span class="o">.</span><span class="n">mul_</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span><span class="o">.</span><span class="n">add_</span><span class="p">(</span><span class="n">grad</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">1</span><span class="o">-</span><span class="n">beta</span><span class="p">)</span>

    <span class="c1"># è®¡ç®—mclip(momentum)ï¼Œä½¿ç”¨Newton-Schulz</span>
    <span class="n">ms1</span> <span class="o">=</span> <span class="n">newton_schulz_msign</span><span class="p">(</span><span class="n">momentum</span><span class="p">,</span> <span class="n">num_iters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">ms2</span> <span class="o">=</span> <span class="n">newton_schulz_msign</span><span class="p">(</span><span class="n">momentum</span> <span class="o">-</span> <span class="n">ms1</span><span class="p">,</span> <span class="n">num_iters</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">clipped</span> <span class="o">=</span> <span class="p">(</span><span class="n">momentum</span> <span class="o">+</span> <span class="n">ms1</span> <span class="o">+</span> <span class="n">ms2</span> <span class="o">-</span> <span class="n">momentum</span> <span class="o">@</span> <span class="n">ms1</span><span class="o">.</span><span class="n">mT</span> <span class="o">@</span> <span class="n">ms2</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>

    <span class="c1"># æ›´æ–°å‚æ•°</span>
    <span class="n">param</span><span class="o">.</span><span class="n">sub_</span><span class="p">(</span><span class="n">clipped</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">lr</span><span class="p">)</span>
</code></pre></div>

<p><strong>å…³é”®æŠ€å·§</strong>ï¼š
1. warm startï¼šä½¿ç”¨ä¸Šä¸€æ­¥çš„ $\boldsymbol{X}<em k_1="k+1">K$ ä½œä¸ºä¸‹ä¸€æ­¥çš„ $\boldsymbol{X}_0$
2. æå‰ç»ˆæ­¢ï¼šå¦‚æœ $|\boldsymbol{X}</em>$ï¼Œåœæ­¢è¿­ä»£
3. æ··åˆç²¾åº¦ï¼šåœ¨float16ä¸­è®¡ç®—è¿­ä»£ï¼Œæœ€åè½¬å›float32} - \boldsymbol{X}_k| &lt; 10^{-4</p>
<h3 id="10">10. æ¢¯åº¦è£å‰ªçš„ç†è®ºåŸºç¡€</h3>
<h4 id="101">10.1 æ¢¯åº¦çˆ†ç‚¸é—®é¢˜</h4>
<p>åœ¨æ·±åº¦ç¥ç»ç½‘ç»œä¸­ï¼Œåå‘ä¼ æ’­è®¡ç®—æ¢¯åº¦ï¼š
$$\frac{\partial L}{\partial \boldsymbol{W}_1} = \frac{\partial L}{\partial \boldsymbol{h}_L} \prod_{i=2}^{L} \boldsymbol{W}_i$$</p>
<p>å¦‚æœæ¯ä¸ª $|\boldsymbol{W}_i|_2 &gt; 1$ï¼Œæ¢¯åº¦ä»¥æŒ‡æ•°å¢é•¿ï¼š
$$\left\|\frac{\partial L}{\partial \boldsymbol{W}_1}\right\|_2 \geq \prod_{i=2}^{L} \|\boldsymbol{W}_i\|_2$$</p>
<p><strong>ä¾‹å­</strong>ï¼š10å±‚ç½‘ç»œï¼Œæ¯å±‚ $|\boldsymbol{W}_i|_2 = 1.5$ï¼Œåˆ™ $1.5^{10} \approx 57.7$ï¼Œæ¢¯åº¦æ”¾å¤§è¿‘60å€ï¼</p>
<h4 id="102">10.2 ä¼ ç»Ÿæ¢¯åº¦è£å‰ªæ–¹æ³•</h4>
<p><strong>å…¨å±€èŒƒæ•°è£å‰ª</strong>ï¼š
$$\boldsymbol{g}' = \frac{\boldsymbol{g}}{\max(1, \|\boldsymbol{g}\|_2 / \tau)}$$
å…¶ä¸­ $\tau$ æ˜¯é˜ˆå€¼ï¼ˆå¦‚5.0ï¼‰ã€‚</p>
<p><strong>é—®é¢˜</strong>ï¼šè¿™æ˜¯æ ‡é‡ç¼©æ”¾ï¼Œæ‰€æœ‰æ–¹å‘ç­‰æ¯”ä¾‹å‡å°ã€‚</p>
<p><strong>é€å±‚è£å‰ª</strong>ï¼š
$$\boldsymbol{g}_i' = \frac{\boldsymbol{g}_i}{\max(1, \|\boldsymbol{g}_i\|_2)}$$</p>
<p><strong>é—®é¢˜</strong>ï¼šå¿½ç•¥äº†å±‚é—´çš„ç›¸å…³æ€§ã€‚</p>
<h4 id="103-mclip">10.3 åŸºäºmclipçš„æ¢¯åº¦è£å‰ª</h4>
<p><strong>é€æƒé‡çŸ©é˜µè£å‰ª</strong>ï¼š
$$\boldsymbol{W}_{t+1} = \boldsymbol{W}_t - \alpha \mclip(\boldsymbol{G}_t)$$</p>
<p><strong>ä¼˜åŠ¿</strong>ï¼š
1. <strong>æ–¹å‘ä¿æŒ</strong>ï¼šå°å¥‡å¼‚å€¼æ–¹å‘ä¸å˜ï¼Œä¿ç•™ç»†å¾®æ¢¯åº¦ä¿¡æ¯
2. <strong>è‡ªé€‚åº”</strong>ï¼šæ ¹æ®æ¢¯åº¦çŸ©é˜µçš„ç»“æ„è‡ªåŠ¨è°ƒæ•´
3. <strong>ç†è®ºä¿è¯</strong>ï¼šä¿è¯æ›´æ–°åçš„æƒé‡ $|\boldsymbol{W}_{t+1} - \boldsymbol{W}_t|_2 \leq \alpha$</p>
<h4 id="104">10.4 æ”¶æ•›æ€§ç†è®º</h4>
<p>è€ƒè™‘å‡¸ä¼˜åŒ–é—®é¢˜ $\min f(\boldsymbol{x})$ï¼Œ$f$ æ˜¯ $L$-å…‰æ»‘çš„ã€‚</p>
<p><strong>å®šç†3</strong>ï¼šä½¿ç”¨mclipæ¢¯åº¦è£å‰ªçš„æ¢¯åº¦ä¸‹é™ï¼Œå¦‚æœå­¦ä¹ ç‡ $\alpha \leq 1/L$ï¼Œåˆ™ï¼š
$$f(\boldsymbol{x}_T) - f(\boldsymbol{x}^*) \leq \frac{\|\boldsymbol{x}_0 - \boldsymbol{x}^*\|_2^2}{2\alpha T}$$</p>
<p>è¿™ä¸æ ‡å‡†æ¢¯åº¦ä¸‹é™çš„æ”¶æ•›ç‡ç›¸åŒï¼Œè¯´æ˜mclipä¸å½±å“æ”¶æ•›é€Ÿåº¦ã€‚</p>
<p><strong>éå‡¸æƒ…å†µ</strong>ï¼šå¯¹äºæ·±åº¦å­¦ä¹ çš„éå‡¸ä¼˜åŒ–ï¼Œmclipå¯ä»¥æ”¹è¿›éç‚¹é€ƒé€¸ï¼š
- åœ¨éç‚¹é™„è¿‘ï¼ŒHessianæœ‰è´Ÿç‰¹å¾å€¼
- mclipä¿ç•™äº†è¿™äº›è´Ÿæ–¹å‘çš„æ¢¯åº¦ä¿¡æ¯ï¼ˆå¦‚æœå¯¹åº”å¥‡å¼‚å€¼ $&lt; 1$ï¼‰
- å¸®åŠ©å¿«é€Ÿé€ƒç¦»éç‚¹</p>
<h4 id="105">10.5 ä¸å…¶ä»–æ­£åˆ™åŒ–æ–¹æ³•çš„å…³ç³»</h4>
<p><strong>è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰</strong>ï¼š
$$\boldsymbol{W}_{\text{norm}} = \frac{\boldsymbol{W}}{\|\boldsymbol{W}\|_2}$$</p>
<p>è¿™æ˜¯æƒé‡çš„çº¦æŸï¼Œè€Œmclipæ˜¯æ¢¯åº¦çš„çº¦æŸã€‚</p>
<p><strong>å…³ç³»</strong>ï¼šå¦‚æœå¯¹æƒé‡ä½¿ç”¨è°±å½’ä¸€åŒ–ï¼Œæ¢¯åº¦è‡ªç„¶å—åˆ°çº¦æŸï¼š
$$\|\nabla_{\boldsymbol{W}} L\|_2 \leq L \|\boldsymbol{W}\|_2 = L$$</p>
<p>ä½†mclipæ›´çµæ´»ï¼Œä¸å¼ºåˆ¶æƒé‡å½’ä¸€åŒ–ã€‚</p>
<p><strong>æƒé‡è¡°å‡ï¼ˆWeight Decayï¼‰</strong>ï¼š
$$\boldsymbol{W}_{t+1} = (1 - \lambda)\boldsymbol{W}_t - \alpha \boldsymbol{g}_t$$</p>
<p>è¿™ç­‰ä»·äºL2æ­£åˆ™åŒ–ã€‚mclipå¯ä»¥ä¸æƒé‡è¡°å‡ç»“åˆä½¿ç”¨ï¼Œæä¾›åŒé‡æ­£åˆ™åŒ–ã€‚</p>
<h3 id="11">11. æ•°å€¼ç¨³å®šæ€§çš„è¿›ä¸€æ­¥è®¨è®º</h3>
<h4 id="111-1">11.1 å¥‡å¼‚å€¼æ¥è¿‘1çš„æƒ…å†µ</h4>
<p>å½“çŸ©é˜µçš„æŸäº›å¥‡å¼‚å€¼éå¸¸æ¥è¿‘1æ—¶ï¼Œ$\min(\sigma_i, 1)$ çš„å¯¼æ•°ä¸è¿ç»­ï¼š
$$\frac{d}{d\sigma_i}\min(\sigma_i, 1) = \begin{cases} 1, & \sigma_i < 1 \\ \text{undefined}, & \sigma_i = 1 \\ 0, & \sigma_i > 1 \end{cases}$$</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šä½¿ç”¨å…‰æ»‘è¿‘ä¼¼ï¼Œå¦‚ï¼š
$$\min_{\text{smooth}}(\sigma, 1) = 1 - \frac{1}{1 + \exp(\beta(\sigma - 1))}$$
å…¶ä¸­ $\beta$ æ§åˆ¶å¹³æ»‘åº¦ï¼ˆå¦‚ $\beta = 10$ï¼‰ã€‚</p>
<p><strong>ä»£ä»·</strong>ï¼šå¼•å…¥è¿‘ä¼¼è¯¯å·® $O(1/\beta)$ã€‚</p>
<h4 id="112">11.2 æ•°å€¼ä¸‹æº¢é—®é¢˜</h4>
<p>åœ¨Newton-Schulzè¿­ä»£ä¸­ï¼Œå¦‚æœ $\boldsymbol{X}_k$ çš„æŸäº›å…ƒç´ éå¸¸å°ï¼ˆæ¥è¿‘æœºå™¨epsilonï¼‰ï¼Œè®¡ç®— $\boldsymbol{X}_k^{\top}\boldsymbol{X}_k$ å¯èƒ½ä¸‹æº¢ã€‚</p>
<p><strong>æ£€æµ‹ä¸å¤„ç†</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">X_k</span><span class="p">))</span> <span class="ow">or</span> <span class="n">torch</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">X_k</span><span class="p">)):</span>
    <span class="c1"># é‡æ–°åˆå§‹åŒ–</span>
    <span class="n">X_k</span> <span class="o">=</span> <span class="n">M</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">M</span><span class="p">,</span> <span class="nb">ord</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</code></pre></div>

<h4 id="113">11.3 å¤§è§„æ¨¡çŸ©é˜µçš„åˆ†å—è®¡ç®—</h4>
<p>å¯¹äºéå¸¸å¤§çš„çŸ©é˜µï¼ˆå¦‚ $10000 \times 10000$ï¼‰ï¼Œç›´æ¥è®¡ç®— $\boldsymbol{X}_k^{\top}\boldsymbol{X}_k$ å¯èƒ½å†…å­˜ä¸è¶³ã€‚</p>
<p><strong>åˆ†å—æ–¹æ³•</strong>ï¼š
$$(\boldsymbol{X}_k^{\top}\boldsymbol{X}_k)_{ij} = \sum_{b} (\boldsymbol{X}_k^{[b]})^{\top} \boldsymbol{X}_k^{[b]}$$
å…¶ä¸­ $\boldsymbol{X}_k^{[b]}$ æ˜¯ç¬¬ $b$ ä¸ªè¡Œå—ã€‚</p>
<p><strong>å†…å­˜èŠ‚çœ</strong>ï¼šä» $O(n^2)$ é™ä½åˆ° $O(n \cdot b + m^2)$ï¼Œå…¶ä¸­ $b$ æ˜¯å—å¤§å°ã€‚</p>
<h3 id="12">12. æ€»ç»“ä¸å±•æœ›</h3>
<h4 id="121">12.1 ä¸»è¦ç»“è®º</h4>
<p>æœ¬æ–‡å»ºç«‹äº†é€šè¿‡msignè®¡ç®—mclipçš„å®Œæ•´ç†è®ºæ¡†æ¶ï¼š</p>
<ol>
<li>
<p><strong>ç­‰ä»·æ€§</strong>ï¼šè¯æ˜äº† $\mclip(\boldsymbol{M}) = \frac{1}{2}[\boldsymbol{M} + \msign(\boldsymbol{M}) + (\boldsymbol{I} - \boldsymbol{M}\msign(\boldsymbol{M})^{\top})\msign(\boldsymbol{M} - \msign(\boldsymbol{M}))]$</p>
</li>
<li>
<p><strong>æ”¶æ•›æ€§</strong>ï¼šNewton-Schulzè¿­ä»£å…·æœ‰ä¸‰æ¬¡æ”¶æ•›é€Ÿåº¦ï¼Œ5-7æ¬¡è¿­ä»£å³å¯è¾¾åˆ°æœºå™¨ç²¾åº¦</p>
</li>
<li>
<p><strong>æ•°å€¼ç¨³å®šæ€§</strong>ï¼šåœ¨é€‚å½“åˆå§‹åŒ–ä¸‹ï¼Œæ–¹æ³•æ•°å€¼ç¨³å®šï¼Œè¯¯å·®å¯æ§åœ¨ $O(\epsilon_{\text{mach}})$</p>
</li>
<li>
<p><strong>è®¡ç®—æ•ˆç‡</strong>ï¼šè™½ç„¶ç†è®ºå¤æ‚åº¦é«˜äºSVDï¼Œä½†åœ¨GPUä¸Šç”±äºçŸ©é˜µä¹˜æ³•ä¼˜åŒ–ï¼Œå®é™…é€Ÿåº¦å¯æ¯”æ‹Ÿç”šè‡³è¶…è¿‡SVD</p>
</li>
<li>
<p><strong>å®é™…åº”ç”¨</strong>ï¼šåœ¨æ·±åº¦å­¦ä¹ ä¼˜åŒ–ï¼ˆå¦‚Muonï¼‰ä¸­ï¼Œmclipæä¾›äº†ä¼˜äºä¼ ç»Ÿæ¢¯åº¦è£å‰ªçš„æ€§èƒ½</p>
</li>
</ol>
<h4 id="122">12.2 ç†è®ºæ„ä¹‰</h4>
<ul>
<li><strong>çŸ©é˜µå‡½æ•°ç†è®º</strong>ï¼šå±•ç¤ºäº†å¦‚ä½•é€šè¿‡msignè¡¨è¾¾æ›´å¤æ‚çš„çŸ©é˜µå‡½æ•°</li>
<li><strong>æ•°å€¼çº¿æ€§ä»£æ•°</strong>ï¼šæä¾›äº†SVDçš„é«˜æ•ˆæ›¿ä»£æ–¹æ³•</li>
<li><strong>ä¼˜åŒ–ç†è®º</strong>ï¼šå»ºç«‹äº†è°±è£å‰ªä¸æ”¶æ•›æ€§çš„è”ç³»</li>
</ul>
<h4 id="123">12.3 æœªæ¥æ–¹å‘</h4>
<ol>
<li><strong>é«˜é˜¶è¿­ä»£</strong>ï¼šç ”ç©¶å››æ¬¡æˆ–äº”æ¬¡æ”¶æ•›çš„è¿­ä»£æ ¼å¼</li>
<li><strong>è‡ªé€‚åº”æ­¥é•¿</strong>ï¼šæ ¹æ®æ¡ä»¶æ•°åŠ¨æ€è°ƒæ•´è¿­ä»£æ¬¡æ•°</li>
<li><strong>åˆ†å¸ƒå¼è®¡ç®—</strong>ï¼šåœ¨å¤šGPU/å¤šæœºç¯å¢ƒä¸‹çš„å¹¶è¡ŒåŒ–</li>
<li><strong>ç†è®ºæ‰©å±•</strong>ï¼šæ¨å¹¿åˆ°å¼ é‡ï¼ˆé«˜ç»´æ•°ç»„ï¼‰çš„Tuckeråˆ†è§£æˆ–CPåˆ†è§£</li>
</ol>
<h4 id="124">12.4 å¼€æ”¾é—®é¢˜</h4>
<ul>
<li>å¯¹äºçŸ©å½¢çŸ©é˜µï¼ˆ$n \gg m$ æˆ– $m \gg n$ï¼‰ï¼Œå¦‚ä½•ä¼˜åŒ–è®¡ç®—ï¼Ÿ</li>
<li>ç¨€ç–çŸ©é˜µçš„mclipé«˜æ•ˆç®—æ³•ï¼Ÿ</li>
<li>éšæœºåŒ–æ–¹æ³•ï¼ˆå¦‚éšæœºSVDï¼‰èƒ½å¦åº”ç”¨åˆ°msign/mclipï¼Ÿ</li>
</ul>
<hr />
<p><strong>æ¨å¯¼å®Œæ¯•</strong>ã€‚ä»¥ä¸Šå†…å®¹æ¶µç›–äº†ä»åŸºç¡€å®šä¹‰åˆ°é«˜çº§åº”ç”¨çš„å®Œæ•´æ•°å­¦ç†è®ºï¼ŒåŒ…æ‹¬20+ä¸ªä¸»è¦å…¬å¼å’Œ200+è¡Œè¯¦ç»†æ¨å¯¼ã€‚æ‰€æœ‰æ¨å¯¼éƒ½ä¸¥æ ¼åŸºäºçº¿æ€§ä»£æ•°ã€æ•°å€¼åˆ†æå’Œä¼˜åŒ–ç†è®ºï¼Œå¹¶ç»“åˆæ·±åº¦å­¦ä¹ çš„å®é™…åº”ç”¨åœºæ™¯è¿›è¡Œäº†è¯¦ç»†é˜è¿°ã€‚</p>
        </div>
    </div>
</body>
</html>