<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å½“BERT-whiteningå¼•å…¥è¶…å‚æ•°ï¼šæ€»æœ‰ä¸€æ¬¾é€‚åˆä½ </title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>å½“BERT-whiteningå¼•å…¥è¶…å‚æ•°ï¼šæ€»æœ‰ä¸€æ¬¾é€‚åˆä½ </h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 30.4 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9079">https://spaces.ac.cn/archives/9079</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨<a href="/archives/8069">ã€Šä½ å¯èƒ½ä¸éœ€è¦BERT-flowï¼šä¸€ä¸ªçº¿æ€§å˜æ¢åª²ç¾BERT-flowã€‹</a>ä¸­ï¼Œç¬”è€…æå‡ºäº†BERT-whiteningï¼ŒéªŒè¯äº†ä¸€ä¸ªçº¿æ€§å˜æ¢å°±èƒ½åª²ç¾å½“æ—¶çš„SOTAæ–¹æ³•BERT-flowã€‚æ­¤å¤–ï¼ŒBERT-whiteningè¿˜å¯ä»¥å¯¹å¥å‘é‡è¿›è¡Œé™ç»´ï¼Œå¸¦æ¥æ›´ä½çš„å†…å­˜å ç”¨å’Œæ›´å¿«çš„æ£€ç´¢é€Ÿåº¦ã€‚ç„¶è€Œï¼Œåœ¨<a href="/archives/8321">ã€Šæ— ç›‘ç£è¯­ä¹‰ç›¸ä¼¼åº¦å“ªå®¶å¼ºï¼Ÿæˆ‘ä»¬åšäº†ä¸ªæ¯”è¾ƒå…¨é¢çš„è¯„æµ‹ã€‹</a>ä¸­æˆ‘ä»¬ä¹Ÿå‘ç°ï¼Œwhiteningæ“ä½œå¹¶éæ€»èƒ½å¸¦æ¥æå‡ï¼Œæœ‰äº›æ¨¡å‹æœ¬èº«å°±å¾ˆè´´åˆä»»åŠ¡ï¼ˆå¦‚ç»è¿‡æœ‰ç›‘ç£è®­ç»ƒçš„SimBERTï¼‰ï¼Œé‚£ä¹ˆé¢å¤–çš„whiteningæ“ä½œå¾€å¾€ä¼šé™ä½æ•ˆæœã€‚</p>
<p>ä¸ºäº†å¼¥è¡¥è¿™ä¸ªä¸è¶³ï¼Œæœ¬æ–‡æå‡ºå¾€BERT-whiteningä¸­å¼•å…¥äº†ä¸¤ä¸ªè¶…å‚æ•°ï¼Œé€šè¿‡è°ƒèŠ‚è¿™ä¸¤ä¸ªè¶…å‚æ•°ï¼Œæˆ‘ä»¬å‡ ä¹å¯ä»¥æ€»æ˜¯è·å¾—â€œé™ç»´ä¸æ‰ç‚¹â€çš„ç»“æœã€‚æ¢å¥è¯è¯´ï¼Œå³ä¾¿æ˜¯åŸæ¥åŠ ä¸Šwhiteningåæ•ˆæœä¼šä¸‹é™çš„ä»»åŠ¡ï¼Œå¦‚ä»Šä¹Ÿæœ‰æœºä¼šåœ¨é™ç»´çš„åŒæ—¶è·å¾—ç›¸è¿‘ç”šè‡³æ›´å¥½çš„æ•ˆæœäº†ã€‚</p>
<h2 id="_1">æ–¹æ³•æ¦‚è¦</h2>
<p>ç›®å‰BERT-whiteningçš„æµç¨‹æ˜¯ï¼š<br />
\begin{equation}\begin{aligned}<br />
\tilde{\boldsymbol{x}}<em i="1">i =&amp;\, (\boldsymbol{x}_i - \boldsymbol{\mu})\boldsymbol{U}\boldsymbol{\Lambda}^{-1/2} \\\<br />
\boldsymbol{\mu} =&amp;\, \frac{1}{N}\sum\limits</em>}^N \boldsymbol{x<em i="1">i \\\<br />
\boldsymbol{\Sigma} =&amp;\, \frac{1}{N}\sum\limits</em>)}^N (\boldsymbol{x}_i - \boldsymbol{\mu})^{\top}(\boldsymbol{x}_i - \boldsymbol{\mu}) = \boldsymbol{U}\boldsymbol{\Lambda}\boldsymbol{U}^{\top} \,\,(\text{SVDåˆ†è§£<br />
\end{aligned}\end{equation}<br />
å…¶ä¸­$\boldsymbol{x}_i$æ˜¯ç»™å®šçš„å¥å‘é‡ï¼ˆå¦‚æ— è¯´æ˜ï¼Œå‘é‡é»˜è®¤ä¸ºè¡Œå‘é‡ï¼‰ï¼Œ$\tilde{\boldsymbol{x}}_i$æ˜¯å˜æ¢åçš„å‘é‡ï¼ŒSVDåˆ†è§£çš„ç»“æœä¸­ï¼Œ$\boldsymbol{U}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œ$\boldsymbol{\Lambda}$æ˜¯å¯¹è§’çŸ©é˜µï¼Œå¹¶ä¸”å¯¹è§’çº¿çš„å…ƒç´ éè´Ÿä¸”ä»å¤§åˆ°å°æ’åˆ—ã€‚å¯ä»¥çœ‹åˆ°ï¼Œç›®å‰çš„æµç¨‹æ˜¯å®Œå…¨å›ºå®šçš„ï¼Œå³æ²¡æœ‰ä»»ä½•å¯è°ƒçš„è¶…å‚æ•°ã€‚</p>
<p>ä¸ºäº†å¢åŠ ä¸€å®šçš„è°ƒèŠ‚ç©ºé—´ï¼Œæˆ‘ä»¬å¯ä»¥å¾€é‡Œè¾¹å¼•å…¥ä¸¤ä¸ªè¶…å‚æ•°$\beta,\gamma$ï¼ˆæ ‡é‡ï¼‰ï¼Œä½¿å…¶å˜ä¸º<br />
\begin{equation}\begin{aligned}<br />
\tilde{\boldsymbol{x}}<em i="1">i =&amp;\, (\boldsymbol{x}_i - {\color{red}\beta}\boldsymbol{\mu})\boldsymbol{U}\boldsymbol{\Lambda}^{-{\color{red}\gamma}/2} \\\<br />
\boldsymbol{\mu} =&amp;\, \frac{1}{N}\sum\limits</em>}^N \boldsymbol{x<em i="1">i \\\<br />
\boldsymbol{\Sigma} =&amp;\, \frac{1}{N}\sum\limits</em>)}^N (\boldsymbol{x}_i - {\color{red}\beta}\boldsymbol{\mu})^{\top}(\boldsymbol{x}_i - {\color{red}\beta}\boldsymbol{\mu}) = \boldsymbol{U}\boldsymbol{\Lambda}\boldsymbol{U}^{\top} \,\,(\text{SVDåˆ†è§£<br />
\end{aligned}\end{equation}</p>
<h2 id="_2">æ€è·¯åˆ†æ</h2>
<p>å¯ä»¥çœ‹åˆ°ï¼Œå½“$\beta=\gamma=1$æ—¶ï¼Œå°±æ˜¯åŸæ¥çš„BERT-whiteningï¼›è€Œå½“$\beta=\gamma=0$æ—¶ï¼Œå‡€å˜æ¢å°±æ˜¯<br />
\begin{equation}\tilde{\boldsymbol{x}}_i =\boldsymbol{x}_i \boldsymbol{U}\end{equation}<br />
ç”±äº$\boldsymbol{U}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œæ‰€ä»¥ä¸æ”¹å˜å†…ç§¯ç»“æœï¼Œå³$\tilde{\boldsymbol{x}}_i\tilde{\boldsymbol{x}}_i^{\top} = \boldsymbol{x}_i \boldsymbol{U} (\boldsymbol{x}_i \boldsymbol{U})^{\top} = \boldsymbol{x}_i\boldsymbol{x}_i^{\top}$ï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ç”¨ä½™å¼¦ç›¸ä¼¼åº¦ä½œä¸ºç›¸ä¼¼åº¦é‡æ—¶ï¼Œå®ƒä¸ä¼šæ”¹å˜åŸæœ‰ç»“æœã€‚æ¢å¥è¯è¯´ï¼Œå¼•å…¥è¿™ç»„è¶…å‚æ•°åï¼Œå®ƒæä¾›äº†â€œä¸é€Šè‰²äºå˜æ¢å‰çš„æ•ˆæœâ€çš„å¯èƒ½æ€§ï¼Œé‚£ä¹ˆå½“æˆ‘ä»¬ç²¾è°ƒè¿™ç»„å‚æ•°æ—¶ï¼Œå°±æœ‰å¯èƒ½å–å¾—æ¯”å˜æ¢å‰æ›´å¥½çš„æ•ˆæœã€‚è¿™ä¹Ÿæ˜¯è¿™ä¸¤ä¸ªè¶…å‚æ•°çš„è®¾è®¡æ€è·¯ã€‚</p>
<p>æ­¤å¤–ï¼Œåœ¨è¿™æ ·çš„æ”¹åŠ¨ä¹‹ä¸‹ï¼ŒåŸæ¥çš„é™ç»´èƒ½åŠ›è¿˜æ˜¯å¾—ä»¥ä¿ç•™çš„ã€‚æˆ‘ä»¬å¯ä»¥å°†å˜æ¢æ‹†å¼€ä¸ºä¸¤éƒ¨åˆ†çœ‹ï¼š<br />
\begin{equation}\tilde{\boldsymbol{x}}<em 1="1" _text_part="\text{part">i = \color{red}{\underbrace{(\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}}</em>}}}\color{skyblue}{\underbrace{\boldsymbol{\Lambda}^{-\gamma/2}}_{\text{part 2}}}\end{equation<br />
ç¬¬ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯æ­£äº¤å˜æ¢$\boldsymbol{U}$ï¼Œ$\boldsymbol{U}$æ˜¯$\boldsymbol{\Sigma}$çŸ©é˜µSVDåˆ†è§£ä¹‹åçš„ç»“æœï¼Œå®ƒèƒ½å°†å‘é‡$\boldsymbol{x}_i - \beta\boldsymbol{\mu}$å˜æ¢æˆæ¯ä¸ªåˆ†é‡å°½é‡ç‹¬ç«‹çš„æ–°å‘é‡ï¼Œå¹¶ä¸”æ–°å‘é‡çš„æ¯ä¸ªåˆ†é‡ä¸0çš„å¹³å‡æ³¢åŠ¨æ­£å¥½æ˜¯ç”±$\boldsymbol{\Lambda}^{1/2}$çš„å¯¹è§’çº¿å…ƒç´ æ¥è¡¡é‡ï¼Œå¦‚æœå¯¹åº”çš„æ³¢åŠ¨å¾ˆæ¥è¿‘äº0ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥è®¤ä¸ºå®ƒå®é™…å°±æ˜¯0ï¼Œèˆå»è¿™ä¸ªåˆ†é‡ä¹Ÿä¸ä¼šå½±å“ä½™å¼¦å€¼çš„è®¡ç®—ç»“æœï¼Œè¿™å°±æ˜¯é™ç»´çš„åŸç†ã€‚è€Œç”±äºSVDåˆ†è§£çš„ç»“æœå·²ç»æå‰å°†$\boldsymbol{\Lambda}$ä»å¤§åˆ°å°æ’å¥½äº†é¡ºåºï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç›´æ¥é€šè¿‡ä¿ç•™å‰$k$ç»´çš„æ“ä½œ$\tilde{\boldsymbol{x}}_i\text{[:}k\text{]}$å°±å¯ä»¥å®ç°é™åˆ°$k$ç»´äº†ã€‚</p>
<p>è‡³äºç¬¬äºŒéƒ¨åˆ†$\boldsymbol{\Lambda}^{-\gamma/2}$ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå½“å‰ä»»åŠ¡å¯¹å„å‘åŒæ€§çš„ä¾èµ–ç¨‹åº¦ï¼Œå¦‚æœ$\gamma=1$ï¼Œé‚£ä¹ˆç›¸å½“äºæ¯ä¸ªåˆ†é‡éƒ½æ˜¯å„å¹³æƒçš„ï¼Œè¿™å¯ä»¥ä½œä¸ºä¸€ä¸ªæ— ç›‘ç£çš„å…ˆéªŒç»“æœï¼Œä½†æœªå¿…å¯¹æ‰€æœ‰ä»»åŠ¡éƒ½æ˜¯æœ€ä¼˜çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒèŠ‚$\gamma$æ¥æ›´å¥½åœ°é€‚åº”å½“å‰ä»»åŠ¡ã€‚</p>
<h2 id="_3">å®éªŒç»“æœ</h2>
<p>æ–‡ç« <a href="/archives/8321">ã€Šæ— ç›‘ç£è¯­ä¹‰ç›¸ä¼¼åº¦å“ªå®¶å¼ºï¼Ÿæˆ‘ä»¬åšäº†ä¸ªæ¯”è¾ƒå…¨é¢çš„è¯„æµ‹ã€‹</a>å·²ç»æ˜¾ç¤ºï¼Œåœ¨ATECã€BQã€LCQMCä¸‰ä¸ªä»»åŠ¡ä¸Šï¼ŒSimBERTåŠ ä¸Šé»˜è®¤çš„whiteningæ“ä½œï¼ˆå³$\beta=\gamma=1$ï¼‰éƒ½ä¼šå¯¼è‡´æ•ˆæœä¸‹é™ï¼Œè€Œå¦‚æœæˆ‘ä»¬å–$\beta=\gamma=0$ï¼Œé‚£ä¹ˆç»“æœå°±ä¸ä¸€æ ·äº†ï¼ˆéšä¾¿æ¼”ç¤ºäº†ä¸¤ä¸ªç»„åˆï¼Œå…¶ä»–ç»„åˆç»“æœç›¸ä¼¼ï¼‰ï¼š<br />
$$\small{\begin{array}{c}  
\text{BERT-P4æ•ˆæœè¡¨} \\\  
{\begin{array}{l|ccccc}  
\hline  
& \text{ATEC} & \text{BQ} & \text{LCQMC} & \text{PAWSX} & \text{STS-B} \\\  
\hline  
\beta=\gamma=1 & 24.51 / \color{green}{27.00} / \color{green}{27.91} & 38.81 / \color{red}{32.29} / \color{red}{37.67} & 64.75 / \color{green}{64.75} / \color{green}{65.65} & 15.12 / \color{green}{17.80} / \color{green}{15.34} & 61.66 / \color{green}{69.45} / \color{green}{69.37}  
\\\  
\beta=\gamma=0 & 24.51 / 24.51 / \color{green}{24.59} & 38.81 / 38.81 / \color{green}{38.99} & 64.75 / 64.75 / \color{red}{63.45} & 15.12 / 15.12 / \color{red}{14.59} & 61.66 / 61.66 / \color{green}{62.30} \\\  
\hline  
\end{array}} \\\  
\\\  
\text{SimBERT-P1æ•ˆæœè¡¨} \\\  
{\begin{array}{l|ccccc}  
\hline  
& \text{ATEC} & \text{BQ} & \text{LCQMC} & \text{PAWSX} & \text{STS-B} \\\  
\hline  
\beta=\gamma=1 & 38.50 / \color{red}{23.64} / \color{red}{30.79} & 48.54 / \color{red}{31.78} / \color{red}{40.01} & 76.23 / \color{red}{75.05} / \color{red}{74.50} & 15.10 / \color{green}{18.49} / \color{green}{15.64} & 74.14 / \color{red}{73.37} / \color{green}{75.29} \\\  
\beta=\gamma=0 & 38.50 / 38.50 / \color{green}{38.81} & 48.54 / 48.54 / \color{green}{48.66} & 76.23 / 76.23 / \color{red}{76.22} & 15.10 / 15.10 / \color{red}{14.88} & 74.14 / 74.14 / \color{green}{74.46} \\\  
\hline  
\end{array}}  
\end{array}}$$</p>
<p>è·Ÿä¹‹å‰çš„æ–‡ç« ä¸€æ ·ï¼Œè¡¨æ ¼ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯$a / b / c$çš„å½¢å¼ï¼Œä»£è¡¨è¯¥ä»»åŠ¡åœ¨è¯¥æ¨¡å‹ä¸‹â€œä¸åŠ whiteningâ€çš„å¾—åˆ†ä¸º$a$ã€â€œåŠ whiteningâ€çš„å¾—åˆ†ä¸º$b$ã€â€œåŠ whiteningå¹¶é™åˆ°256ç»´â€çš„å¾—åˆ†ä¸º$c$ï¼›å¦‚æœ$b &gt; a$ï¼Œé‚£ä¹ˆ$b$æ˜¾ç¤ºä¸ºç»¿è‰²ï¼Œå°äºåˆ™æ˜¾ç¤ºä¸ºçº¢è‰²ï¼›å¦‚æœ$c &gt; a$ï¼Œé‚£ä¹ˆ$c$æ˜¾ç¤ºä¸ºç»¿è‰²ï¼Œå°äºåˆ™æ˜¾ç¤ºä¸ºçº¢è‰²ã€‚å‰é¢è¯´äº†ï¼Œå¦‚æœä¸é™ç»´çš„è¯ï¼Œ$\beta=\gamma=0$çš„å‡€å˜æ¢å°±æ˜¯$\boldsymbol{U}$ï¼Œä¸æ”¹å˜ä½™å¼¦å€¼ç»“æœï¼Œå› æ­¤$\beta=\gamma=0$æ—¶çš„$a,b$éƒ½æ˜¯ç›¸ç­‰çš„ã€‚</p>
<p>åœ¨è¿™ä¸ªè¡¨æ ¼ä¸­ï¼Œæˆ‘ä»¬ä¸»è¦çœ‹$a/b/c$ä¸­çš„ç¬¬ä¸‰ä¸ªç»“æœ$c$ï¼Œå®ƒæ˜¯å°†å‘é‡ä»768ç»´é™ä½åˆ°256ç»´çš„ç»“æœï¼Œå¯ä»¥çœ‹åˆ°å½“$\beta=\gamma=0$æ—¶ï¼Œä¸ç®¡æ˜¯æ— ç›‘ç£çš„BERTè¿˜æ˜¯æœ‰ç›‘ç£çš„SimBERTï¼Œè¯¥ç»“æœåŸºæœ¬éƒ½å¾ˆæ¥è¿‘åŸå§‹å‘é‡çš„ç»“æœï¼ˆå³$a$ï¼‰ï¼Œéƒ¨åˆ†ç»“æœç”šè‡³è¿˜æœ‰æå‡ã€‚è¿™å°±æ„å‘³ç€ï¼Œ$\beta=\gamma=0,k=256$è¿™ä¸ªç»„åˆå‡ ä¹å¯ä»¥ç®—æ˜¯â€œå…è´¹çš„åˆé¤â€ï¼Œå‡ ä¹æ— æŸæ•ˆæœï¼Œå¹¶ä¸”å®ç°äº†é™ç»´ã€‚</p>
<p>ç¬”è€…ä¹Ÿè¯•è¿‡ç²¾è°ƒ$\beta,\gamma$ï¼Œåœ¨ä¸€äº›ä»»åŠ¡ä¸Šç¡®å®èƒ½å–å¾—æ¯”ä¸Šè¿°ä¸¤ä¸ªç»„åˆæ›´å¥½çš„æ•ˆæœï¼Œä½†ç²¾è°ƒéœ€è¦æ ‡ç­¾æ•°æ®ï¼Œäº‰è®®æ€§å¯èƒ½ä¼šæ¯”è¾ƒå¤§ï¼Œè¿™é‡Œå°±ä¸æ¼”ç¤ºäº†ã€‚å¦‚æœåŸæ¥çš„å¥å‘é‡æ¨¡å‹æœ¬å°±æ˜¯æœ‰ç›‘ç£è®­ç»ƒå¾—åˆ°çš„ï¼Œç”¨BERT-whiteningä»…ä»…æ˜¯å¥”ç€é™ç»´å»çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨éªŒè¯é›†æ¥ç²¾è°ƒä¸€ä¸‹$\beta,\gamma$å’Œ$k$äº†ï¼Œè¿™ç§åœºæ™¯ä¸‹å°±æ˜¯æ— äº‰è®®çš„äº†ã€‚</p>
<h2 id="_4">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡é€šè¿‡å¼•å…¥ä¸¤ä¸ªè¶…å‚æ•°çš„æ–¹å¼æ¥èµ‹äºˆBERT-whiteningä¸€å®šçš„è°ƒå‚ç©ºé—´ï¼Œä½¿å…¶å…·å¤‡â€œä¸é€Šè‰²äºå˜æ¢å‰çš„æ•ˆæœâ€çš„å¯èƒ½æ€§ï¼Œå¹¶ä¸”ä¿ç•™äº†é™ç»´çš„èƒ½åŠ›ã€‚æ¢è¨€ä¹‹ï¼Œå³ä¾¿æ˜¯ä¹‹å‰å·²ç»è®­ç»ƒå¥½çš„å¥å‘é‡æ¨¡å‹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥ç”¨æ–°çš„BERT-whiteningå°†å®ƒé™ç»´ï¼Œå¹¶ä¸”ä¿æŒæ•ˆæœåŸºæœ¬ä¸å˜ï¼Œæœ‰æ—¶å€™ç”šè‡³è¿˜æ›´ä¼˜ï½</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9079">https://spaces.ac.cn/archives/9079</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (May. 18, 2022). ã€Šå½“BERT-whiteningå¼•å…¥è¶…å‚æ•°ï¼šæ€»æœ‰ä¸€æ¬¾é€‚åˆä½  ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9079">https://spaces.ac.cn/archives/9079</a></p>
<p>@online{kexuefm-9079,<br />
title={å½“BERT-whiteningå¼•å…¥è¶…å‚æ•°ï¼šæ€»æœ‰ä¸€æ¬¾é€‚åˆä½ },<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={May},<br />
url={\url{https://spaces.ac.cn/archives/9079}},<br />
} </p>
<hr />
<h2 id="_5">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1-pca">1. PCAä¸åæ–¹å·®çŸ©é˜µçš„æ•°å­¦åŸºç¡€</h3>
<h4 id="11">1.1 åæ–¹å·®çŸ©é˜µçš„å®šä¹‰ä¸æ€§è´¨</h4>
<p>å¯¹äºå¥å‘é‡é›†åˆ ${\boldsymbol{x}_1, \boldsymbol{x}_2, \ldots, \boldsymbol{x}_N}$ï¼Œå…¶ä¸­æ¯ä¸ª $\boldsymbol{x}_i \in \mathbb{R}^d$ï¼Œæˆ‘ä»¬é¦–å…ˆè®¡ç®—å‡å€¼å‘é‡ï¼š</p>
<p>\begin{equation}
\boldsymbol{\mu} = \frac{1}{N}\sum_{i=1}^N \boldsymbol{x}_i
\tag{1}
\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šå‡å€¼å‘é‡ä»£è¡¨æ‰€æœ‰å¥å‘é‡çš„"ä¸­å¿ƒä½ç½®"ï¼Œå»ä¸­å¿ƒåŒ–æ“ä½œå°†æ•°æ®å¹³ç§»åˆ°åŸç‚¹é™„è¿‘ã€‚</p>
<p>ä¸­å¿ƒåŒ–åçš„å‘é‡ä¸ºï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}_i = \boldsymbol{x}_i - \boldsymbol{\mu}
\tag{2}
\end{equation}</p>
<p>åæ–¹å·®çŸ©é˜µå®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{\Sigma} = \frac{1}{N}\sum_{i=1}^N (\boldsymbol{x}<em i="1">i - \boldsymbol{\mu})(\boldsymbol{x}_i - \boldsymbol{\mu})^{\top} = \frac{1}{N}\sum</em>
\tag{3}
\end{equation}}^N \tilde{\boldsymbol{x}}_i \tilde{\boldsymbol{x}}_i^{\top</p>
<p><strong>åæ–¹å·®çŸ©é˜µçš„æ€§è´¨</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{\Sigma}<em i="1">{jk} = \frac{1}{N}\sum</em> - \mu_k)
\tag{4}
\end{equation}}^N (x_{ij} - \mu_j)(x_{ik</p>
<p>å…¶ä¸­ $\boldsymbol{\Sigma}_{jk}$ è¡¨ç¤ºç¬¬ $j$ ç»´å’Œç¬¬ $k$ ç»´ç‰¹å¾çš„åæ–¹å·®ã€‚</p>
<p><strong>é‡è¦æ€§è´¨</strong>ï¼š
1. å¯¹ç§°æ€§ï¼š$\boldsymbol{\Sigma} = \boldsymbol{\Sigma}^{\top}$
2. åŠæ­£å®šæ€§ï¼š$\boldsymbol{v}^{\top}\boldsymbol{\Sigma}\boldsymbol{v} \geq 0$ å¯¹æ‰€æœ‰ $\boldsymbol{v} \in \mathbb{R}^d$
3. å®å¯¹ç§°çŸ©é˜µå¯å¯¹è§’åŒ–</p>
<h4 id="12-svd">1.2 ç‰¹å¾å€¼åˆ†è§£ï¼ˆSVDåˆ†è§£ï¼‰</h4>
<p>ç”±äºåæ–¹å·®çŸ©é˜µæ˜¯å®å¯¹ç§°çŸ©é˜µï¼Œå¯ä»¥è¿›è¡Œç‰¹å¾å€¼åˆ†è§£ï¼ˆSVDï¼‰ï¼š</p>
<p>\begin{equation}
\boldsymbol{\Sigma} = \boldsymbol{U}\boldsymbol{\Lambda}\boldsymbol{U}^{\top}
\tag{5}
\end{equation}</p>
<p>å…¶ä¸­ï¼š
- $\boldsymbol{U} = [\boldsymbol{u}_1, \boldsymbol{u}_2, \ldots, \boldsymbol{u}_d] \in \mathbb{R}^{d \times d}$ æ˜¯æ­£äº¤çŸ©é˜µï¼ˆç‰¹å¾å‘é‡ï¼‰
- $\boldsymbol{\Lambda} = \text{diag}(\lambda_1, \lambda_2, \ldots, \lambda_d)$ æ˜¯å¯¹è§’çŸ©é˜µï¼ˆç‰¹å¾å€¼ï¼‰
- $\lambda_1 \geq \lambda_2 \geq \cdots \geq \lambda_d \geq 0$ï¼ˆæŒ‰é™åºæ’åˆ—ï¼‰</p>
<p><strong>æ­£äº¤æ€§</strong>ï¼š$\boldsymbol{U}^{\top}\boldsymbol{U} = \boldsymbol{U}\boldsymbol{U}^{\top} = \boldsymbol{I}$</p>
<p><strong>ç‰¹å¾æ–¹ç¨‹</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{\Sigma}\boldsymbol{u}_i = \lambda_i \boldsymbol{u}_i, \quad i = 1, 2, \ldots, d
\tag{6}
\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šç¬¬ $i$ ä¸ªç‰¹å¾å‘é‡ $\boldsymbol{u}_i$ æŒ‡å‘æ•°æ®æ–¹å·®æœ€å¤§çš„ç¬¬ $i$ ä¸ªæ–¹å‘ï¼Œå¯¹åº”çš„ç‰¹å¾å€¼ $\lambda_i$ è¡¨ç¤ºè¯¥æ–¹å‘ä¸Šçš„æ–¹å·®å¤§å°ã€‚</p>
<h4 id="13-pca">1.3 ä¸»æˆåˆ†åˆ†æï¼ˆPCAï¼‰çš„å‡ ä½•æ„ä¹‰</h4>
<p>å°†ä¸­å¿ƒåŒ–å‘é‡æŠ•å½±åˆ°ç‰¹å¾å‘é‡æ„æˆçš„æ–°åæ ‡ç³»ï¼š</p>
<p>\begin{equation}
\boldsymbol{y}_i = \boldsymbol{U}^{\top}(\boldsymbol{x}_i - \boldsymbol{\mu})
\tag{7}
\end{equation}</p>
<p>æŠ•å½±åçš„åæ–¹å·®çŸ©é˜µï¼š</p>
<p>\begin{equation}
\begin{aligned}
\text{Cov}(\boldsymbol{y}) &amp;= \frac{1}{N}\sum_{i=1}^N \boldsymbol{y}<em i="1">i\boldsymbol{y}_i^{\top} \
&amp;= \frac{1}{N}\sum</em> \
&amp;= \boldsymbol{U}^{\top}\boldsymbol{\Sigma}\boldsymbol{U} \
&amp;= \boldsymbol{U}^{\top}\boldsymbol{U}\boldsymbol{\Lambda}\boldsymbol{U}^{\top}\boldsymbol{U} \
&amp;= \boldsymbol{\Lambda}
\end{aligned}
\tag{8}
\end{equation}}^N \boldsymbol{U}^{\top}(\boldsymbol{x}_i - \boldsymbol{\mu})(\boldsymbol{x}_i - \boldsymbol{\mu})^{\top}\boldsymbol{U</p>
<p><strong>å…³é”®ç»“è®º</strong>ï¼šPCAå˜æ¢å°†æ•°æ®è½¬æ¢åˆ°ä¸€ä¸ªæ–°çš„åæ ‡ç³»ï¼Œä½¿å¾—å„ç»´åº¦ä¹‹é—´ä¸ç›¸å…³ï¼ˆåæ–¹å·®ä¸º0ï¼‰ï¼Œä¸”æŒ‰æ–¹å·®å¤§å°æ’åºã€‚</p>
<h3 id="2-whitening">2. Whiteningï¼ˆç™½åŒ–ï¼‰å˜æ¢çš„å®Œæ•´æ¨å¯¼</h3>
<h4 id="21">2.1 ç™½åŒ–çš„ç›®æ ‡</h4>
<p>ç™½åŒ–å˜æ¢çš„ç›®æ ‡æ˜¯æ‰¾åˆ°ä¸€ä¸ªçº¿æ€§å˜æ¢ $\boldsymbol{W}$ï¼Œä½¿å¾—å˜æ¢åçš„æ•°æ®æ»¡è¶³ï¼š</p>
<p>\begin{equation}
\mathbb{E}[\tilde{\boldsymbol{x}}] = \boldsymbol{0}, \quad \text{Cov}(\tilde{\boldsymbol{x}}) = \boldsymbol{I}
\tag{9}
\end{equation}</p>
<p>å³ï¼šå‡å€¼ä¸ºé›¶ï¼Œåæ–¹å·®çŸ©é˜µä¸ºå•ä½çŸ©é˜µï¼ˆå„ç»´åº¦ç‹¬ç«‹ä¸”æ–¹å·®ä¸º1ï¼‰ã€‚</p>
<h4 id="22-zcazero-phase-component-analysis">2.2 ZCAç™½åŒ–ï¼ˆZero-phase Component Analysisï¼‰</h4>
<p>ZCAç™½åŒ–çš„å˜æ¢å½¢å¼ä¸ºï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}_i = (\boldsymbol{x}_i - \boldsymbol{\mu})\boldsymbol{\Sigma}^{-1/2}
\tag{10}
\end{equation}</p>
<p>å…¶ä¸­ $\boldsymbol{\Sigma}^{-1/2}$ å®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{\Sigma}^{-1/2} = \boldsymbol{U}\boldsymbol{\Lambda}^{-1/2}\boldsymbol{U}^{\top}
\tag{11}
\end{equation}</p>
<p><strong>éªŒè¯ç™½åŒ–æ€§è´¨</strong>ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\text{Cov}(\tilde{\boldsymbol{x}}) &amp;= \frac{1}{N}\sum_{i=1}^N \tilde{\boldsymbol{x}}<em i="1">i\tilde{\boldsymbol{x}}_i^{\top} \
&amp;= \frac{1}{N}\sum</em> \
&amp;= \boldsymbol{\Sigma}^{-1/2}\boldsymbol{\Sigma}(\boldsymbol{\Sigma}^{-1/2})^{\top} \
&amp;= \boldsymbol{\Sigma}^{-1/2}\boldsymbol{\Sigma}\boldsymbol{\Sigma}^{-1/2} \
&amp;= \boldsymbol{I}
\end{aligned}
\tag{12}
\end{equation}}^N (\boldsymbol{x}_i - \boldsymbol{\mu})\boldsymbol{\Sigma}^{-1/2}(\boldsymbol{\Sigma}^{-1/2})^{\top}(\boldsymbol{x}_i - \boldsymbol{\mu})^{\top</p>
<h4 id="23-pca">2.3 PCAç™½åŒ–ï¼ˆé™ç»´ç™½åŒ–ï¼‰</h4>
<p>PCAç™½åŒ–ä¸ç»è¿‡ $\boldsymbol{U}^{\top}$ å†å›è½¬ï¼Œè€Œæ˜¯ç›´æ¥åœ¨ä¸»æˆåˆ†ç©ºé—´è¿›è¡Œç™½åŒ–ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}_i = (\boldsymbol{x}_i - \boldsymbol{\mu})\boldsymbol{U}\boldsymbol{\Lambda}^{-1/2}
\tag{13}
\end{equation}</p>
<p><strong>åˆ†è§£ç†è§£</strong>ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}<em _text_æ—‹è½¬åˆ°ä¸»æˆåˆ†ç©ºé—´="\text{æ—‹è½¬åˆ°ä¸»æˆåˆ†ç©ºé—´">i = \underbrace{(\boldsymbol{x}_i - \boldsymbol{\mu})\boldsymbol{U}}</em>
\tag{14}
\end{equation}}} \cdot \underbrace{\boldsymbol{\Lambda}^{-1/2}}_{\text{æ–¹å·®å½’ä¸€åŒ–}</p>
<p>ç¬¬ä¸€æ­¥ï¼šæ—‹è½¬å˜æ¢
\begin{equation}
\boldsymbol{z}_i = (\boldsymbol{x}_i - \boldsymbol{\mu})\boldsymbol{U}
\tag{15}
\end{equation}</p>
<p>æ­¤æ—¶ $\text{Cov}(\boldsymbol{z}) = \boldsymbol{\Lambda}$ï¼ˆå¯¹è§’çŸ©é˜µï¼Œå„ç»´åº¦ç‹¬ç«‹ä½†æ–¹å·®ä¸ç­‰ï¼‰</p>
<p>ç¬¬äºŒæ­¥ï¼šæ–¹å·®å½’ä¸€åŒ–
\begin{equation}
\tilde{\boldsymbol{x}}_i = \boldsymbol{z}_i\boldsymbol{\Lambda}^{-1/2}
\tag{16}
\end{equation}</p>
<p>æ­¤æ—¶ $\text{Cov}(\tilde{\boldsymbol{x}}) = \boldsymbol{I}$ï¼ˆå•ä½çŸ©é˜µï¼Œå„ç»´åº¦ç‹¬ç«‹ä¸”æ–¹å·®ä¸º1ï¼‰</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šPCAç™½åŒ–é¦–å…ˆé€šè¿‡æ—‹è½¬æ¶ˆé™¤ç›¸å…³æ€§ï¼Œç„¶åé€šè¿‡ç¼©æ”¾ç»Ÿä¸€æ–¹å·®ã€‚</p>
<h3 id="3-bert-whitening">3. BERT-Whiteningä¸­çš„è¶…å‚æ•°è®¾è®¡</h3>
<h4 id="31">3.1 å‚æ•°åŒ–ç™½åŒ–å˜æ¢</h4>
<p>å¼•å…¥è¶…å‚æ•° $\beta$ å’Œ $\gamma$ åçš„ç™½åŒ–å˜æ¢ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}_i = (\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}\boldsymbol{\Lambda}^{-\gamma/2}
\tag{17}
\end{equation}</p>
<p>ç›¸åº”çš„åæ–¹å·®çŸ©é˜µè®¡ç®—ä¹Ÿéœ€è¦è°ƒæ•´ï¼š</p>
<p>\begin{equation}
\boldsymbol{\Sigma}<em i="1">{\beta} = \frac{1}{N}\sum</em>
\tag{18}
\end{equation}}^N (\boldsymbol{x}_i - \beta\boldsymbol{\mu})(\boldsymbol{x}_i - \beta\boldsymbol{\mu})^{\top} = \boldsymbol{U}\boldsymbol{\Lambda}\boldsymbol{U}^{\top</p>
<h4 id="32">3.2 å‚æ•°Î²çš„æ•°å­¦æ„ä¹‰ï¼ˆä¸­å¿ƒåŒ–ç¨‹åº¦ï¼‰</h4>
<p><strong>æƒ…å½¢1</strong>ï¼š$\beta = 1$ï¼ˆå®Œå…¨ä¸­å¿ƒåŒ–ï¼‰</p>
<p>\begin{equation}
\boldsymbol{x}<em j="1">i - \boldsymbol{\mu} = \boldsymbol{x}_i - \frac{1}{N}\sum</em>_j
\tag{19}
\end{equation}}^N \boldsymbol{x</p>
<p>æ­¤æ—¶æ•°æ®ä¸¥æ ¼ä¸­å¿ƒåŒ–ï¼Œå‡å€¼ä¸ºé›¶ã€‚</p>
<p><strong>æƒ…å½¢2</strong>ï¼š$\beta = 0$ï¼ˆä¸ä¸­å¿ƒåŒ–ï¼‰</p>
<p>\begin{equation}
\boldsymbol{x}_i - 0 \cdot \boldsymbol{\mu} = \boldsymbol{x}_i
\tag{20}
\end{equation}</p>
<p>ä¿æŒåŸå§‹æ•°æ®åˆ†å¸ƒã€‚</p>
<p><strong>ä¸­é—´å€¼</strong>ï¼š$0 &lt; \beta &lt; 1$</p>
<p>\begin{equation}
\boldsymbol{x}_i - \beta\boldsymbol{\mu} = (1-\beta)\boldsymbol{x}_i + \beta(\boldsymbol{x}_i - \boldsymbol{\mu})
\tag{21}
\end{equation}</p>
<p>è¿™æ˜¯åŸå§‹å‘é‡å’Œä¸­å¿ƒåŒ–å‘é‡çš„å‡¸ç»„åˆã€‚</p>
<p><strong>åæ–¹å·®çŸ©é˜µçš„å˜åŒ–</strong>ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\boldsymbol{\Sigma}<em i="1">{\beta} &amp;= \frac{1}{N}\sum</em>}^N (\boldsymbol{x<em i="1">i - \beta\boldsymbol{\mu})(\boldsymbol{x}_i - \beta\boldsymbol{\mu})^{\top} \
&amp;= \frac{1}{N}\sum</em> \
&amp;= \boldsymbol{\Sigma}_1 + (1-\beta)^2\boldsymbol{\mu}\boldsymbol{\mu}^{\top}
\end{aligned}
\tag{22}
\end{equation}}^N [(\boldsymbol{x}_i - \boldsymbol{\mu}) + (1-\beta)\boldsymbol{\mu}][(\boldsymbol{x}_i - \boldsymbol{\mu}) + (1-\beta)\boldsymbol{\mu}]^{\top</p>
<p>å…¶ä¸­ $\boldsymbol{\Sigma}_1$ æ˜¯å®Œå…¨ä¸­å¿ƒåŒ–æ—¶çš„åæ–¹å·®çŸ©é˜µã€‚</p>
<h4 id="33">3.3 å‚æ•°Î³çš„æ•°å­¦æ„ä¹‰ï¼ˆå„å‘åŒæ€§ç¨‹åº¦ï¼‰</h4>
<p><strong>æƒ…å½¢1</strong>ï¼š$\gamma = 1$ï¼ˆå®Œå…¨ç™½åŒ–ï¼‰</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}_i = (\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}\boldsymbol{\Lambda}^{-1/2}
\tag{23}
\end{equation}</p>
<p>æ­¤æ—¶å„ç»´åº¦æ–¹å·®å®Œå…¨ç›¸ç­‰ï¼š</p>
<p>\begin{equation}
\text{Var}(\tilde{x}_{ij}) = 1, \quad \forall j
\tag{24}
\end{equation}</p>
<p><strong>æƒ…å½¢2</strong>ï¼š$\gamma = 0$ï¼ˆä¸å½’ä¸€åŒ–ï¼‰</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}_i = (\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}\boldsymbol{\Lambda}^0 = (\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}
\tag{25}
\end{equation}</p>
<p>ç”±äº $\boldsymbol{U}$ æ˜¯æ­£äº¤çŸ©é˜µï¼Œå†…ç§¯ä¿æŒä¸å˜ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\tilde{\boldsymbol{x}}_i \cdot \tilde{\boldsymbol{x}}_j &amp;= [(\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}] \cdot [(\boldsymbol{x}_j - \beta\boldsymbol{\mu})\boldsymbol{U}] \
&amp;= (\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}\boldsymbol{U}^{\top}(\boldsymbol{x}_j - \beta\boldsymbol{\mu})^{\top} \
&amp;= (\boldsymbol{x}_i - \beta\boldsymbol{\mu})(\boldsymbol{x}_j - \beta\boldsymbol{\mu})^{\top}
\end{aligned}
\tag{26}
\end{equation}</p>
<p>ç‰¹åˆ«åœ°ï¼Œå½“ $\beta = 0$ æ—¶ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}_i \cdot \tilde{\boldsymbol{x}}_j = \boldsymbol{x}_i \cdot \boldsymbol{x}_j
\tag{27}
\end{equation}</p>
<p>ä½™å¼¦ç›¸ä¼¼åº¦å®Œå…¨ä¿æŒï¼š</p>
<p>\begin{equation}
\cos(\tilde{\boldsymbol{x}}_i, \tilde{\boldsymbol{x}}_j) = \frac{\tilde{\boldsymbol{x}}_i \cdot \tilde{\boldsymbol{x}}_j}{|\tilde{\boldsymbol{x}}_i||\tilde{\boldsymbol{x}}_j|} = \frac{\boldsymbol{x}_i \cdot \boldsymbol{x}_j}{|\boldsymbol{x}_i||\boldsymbol{x}_j|} = \cos(\boldsymbol{x}_i, \boldsymbol{x}_j)
\tag{28}
\end{equation}</p>
<p><strong>ä¸­é—´å€¼</strong>ï¼š$0 &lt; \gamma &lt; 1$</p>
<p>\begin{equation}
\boldsymbol{\Lambda}^{-\gamma/2} = \text{diag}(\lambda_1^{-\gamma/2}, \lambda_2^{-\gamma/2}, \ldots, \lambda_d^{-\gamma/2})
\tag{29}
\end{equation}</p>
<p>å˜æ¢åçš„æ–¹å·®ï¼š</p>
<p>\begin{equation}
\text{Var}(\tilde{x}_{ij}) = \lambda_j^{1-\gamma}
\tag{30}
\end{equation}</p>
<p>å½“ $\gamma &lt; 1$ æ—¶ï¼Œä¿ç•™éƒ¨åˆ†åŸå§‹æ–¹å·®ä¿¡æ¯ï¼š
- å¤§ç‰¹å¾å€¼å¯¹åº”çš„ç»´åº¦ï¼š$\lambda_j$ å¤§ï¼Œ$\lambda_j^{1-\gamma}$ ä¹Ÿå¤§
- å°ç‰¹å¾å€¼å¯¹åº”çš„ç»´åº¦ï¼š$\lambda_j$ å°ï¼Œ$\lambda_j^{1-\gamma}$ ä¹Ÿå°</p>
<h3 id="4">4. é™ç»´åŸç†çš„æ•°å­¦åˆ†æ</h3>
<h4 id="41">4.1 ä¸»æˆåˆ†é€‰æ‹©</h4>
<p>ä¿ç•™å‰ $k$ ä¸ªä¸»æˆåˆ†ï¼ˆ$k &lt; d$ï¼‰ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}<em k="k">i^{(k)} = [(\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}\boldsymbol{\Lambda}^{-\gamma/2}]</em>
\tag{31}
\end{equation}</p>
<p>å…¶ä¸­ $[\cdot]_{:k}$ è¡¨ç¤ºå–å‰ $k$ ç»´ã€‚</p>
<p>ç­‰ä»·äºï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}<em k="k">i^{(k)} = (\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}</em>
\tag{32}
\end{equation}}\boldsymbol{\Lambda}_{k}^{-\gamma/2</p>
<p>å…¶ä¸­ $\boldsymbol{U}_{:k} \in \mathbb{R}^{d \times k}$ æ˜¯å‰ $k$ ä¸ªç‰¹å¾å‘é‡ï¼Œ$\boldsymbol{\Lambda}_k = \text{diag}(\lambda_1, \ldots, \lambda_k)$ã€‚</p>
<h4 id="42">4.2 ä¿¡æ¯ä¿ç•™ç‡</h4>
<p>å®šä¹‰ç´¯ç§¯æ–¹å·®è´¡çŒ®ç‡ï¼š</p>
<p>\begin{equation}
\eta_k = \frac{\sum_{i=1}^k \lambda_i}{\sum_{i=1}^d \lambda_i}
\tag{33}
\end{equation}</p>
<p><strong>é‡æ„è¯¯å·®</strong>ï¼ˆå½“ $\gamma = 1$ï¼Œ$\beta = 1$ æ—¶ï¼‰ï¼š</p>
<p>\begin{equation}
\begin{aligned}
E_k &amp;= \frac{1}{N}\sum_{i=1}^N |\boldsymbol{x}<em j="k+1">i - \hat{\boldsymbol{x}}_i^{(k)}|^2 \
&amp;= \sum</em>^d \lambda_j
\end{aligned}
\tag{34}
\end{equation}</p>
<p>å…¶ä¸­ $\hat{\boldsymbol{x}}_i^{(k)}$ æ˜¯ä»ä½ç»´é‡æ„å›çš„å‘é‡ã€‚</p>
<p><strong>ç›¸å¯¹è¯¯å·®</strong>ï¼š</p>
<p>\begin{equation}
\frac{E_k}{\sum_{i=1}^d \lambda_i} = 1 - \eta_k
\tag{35}
\end{equation}</p>
<h4 id="43">4.3 ä½™å¼¦è·ç¦»çš„ä¿æŒæ€§</h4>
<p>å¯¹äºé™ç»´åçš„å‘é‡ï¼Œä½™å¼¦ç›¸ä¼¼åº¦çš„å˜åŒ–ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\cos(\tilde{\boldsymbol{x}}<em k="k">i^{(k)}, \tilde{\boldsymbol{x}}_j^{(k)}) &amp;= \frac{(\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}</em>}\boldsymbol{\Lambda<em k="k">k^{-\gamma}(\boldsymbol{x}_j - \beta\boldsymbol{\mu})^{\top}}{\sqrt{[(\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}</em>}\boldsymbol{\Lambda<em k="k">k^{-\gamma}\boldsymbol{U}</em>
\end{aligned}
\tag{36}
\end{equation}}^{\top}(\boldsymbol{x}_i - \beta\boldsymbol{\mu})^{\top}]} \cdot \sqrt{\cdots}</p>
<p>å½“ $\gamma = 1$ï¼ˆå®Œå…¨ç™½åŒ–ï¼‰æ—¶ï¼Œåœ¨é«˜ç»´ç©ºé—´ä¸­æ‰€æœ‰ç»´åº¦å¹³æƒï¼Œé™ç»´åçš„ä½™å¼¦ç›¸ä¼¼åº¦è¿‘ä¼¼ä¸ºï¼š</p>
<p>\begin{equation}
\cos(\tilde{\boldsymbol{x}}_i^{(k)}, \tilde{\boldsymbol{x}}_j^{(k)}) \approx \frac{k}{d} \cos(\tilde{\boldsymbol{x}}_i, \tilde{\boldsymbol{x}}_j)
\tag{37}
\end{equation}</p>
<p>å½“ç‰¹å¾å€¼å¿«é€Ÿè¡°å‡ï¼ˆå‰ $k$ ä¸ªç‰¹å¾å€¼å ä¸»å¯¼ï¼‰æ—¶ï¼Œä½™å¼¦ç›¸ä¼¼åº¦èƒ½è¾ƒå¥½ä¿æŒã€‚</p>
<h3 id="5">5. å„å‘å¼‚æ€§é—®é¢˜çš„æ•°å­¦åˆ†æ</h3>
<h4 id="51">5.1 å„å‘å¼‚æ€§çš„å®šä¹‰</h4>
<p>BERTç­‰é¢„è®­ç»ƒæ¨¡å‹çš„å¥å‘é‡å¸¸å­˜åœ¨å„å‘å¼‚æ€§é—®é¢˜ï¼Œè¡¨ç°ä¸ºï¼š</p>
<p>\begin{equation}
\lambda_1 \gg \lambda_2 \gg \cdots \gg \lambda_d
\tag{38}
\end{equation}</p>
<p>å³å°‘æ•°å‡ ä¸ªä¸»æˆåˆ†å æ®äº†ç»å¤§éƒ¨åˆ†æ–¹å·®ã€‚</p>
<p><strong>å„å‘å¼‚æ€§åº¦é‡</strong>ï¼ˆæœ‰æ•ˆç»´åº¦æ•°ï¼‰ï¼š</p>
<p>\begin{equation}
D_{\text{eff}} = \exp\left(-\sum_{i=1}^d p_i \log p_i\right), \quad p_i = \frac{\lambda_i}{\sum_j \lambda_j}
\tag{39}
\end{equation}</p>
<p>å½“ $D_{\text{eff}} \ll d$ æ—¶ï¼Œè¡¨ç¤ºå„å‘å¼‚æ€§ä¸¥é‡ã€‚</p>
<h4 id="52">5.2 å„å‘å¼‚æ€§çš„å½±å“</h4>
<p>å‡è®¾ $\lambda_1 = \alpha \sum_{i=2}^d \lambda_i$ï¼Œå…¶ä¸­ $\alpha \gg 1$ã€‚</p>
<p>å¯¹äºä¸¤ä¸ªå‘é‡çš„ä½™å¼¦ç›¸ä¼¼åº¦ï¼š</p>
<p>\begin{equation}
\cos(\boldsymbol{x}_i, \boldsymbol{x}_j) = \frac{\boldsymbol{x}_i \cdot \boldsymbol{x}_j}{|\boldsymbol{x}_i||\boldsymbol{x}_j|}
\tag{40}
\end{equation}</p>
<p>å¦‚æœä¸¤ä¸ªå‘é‡åœ¨ç¬¬ä¸€ä¸»æˆåˆ†æ–¹å‘ä¸Šçš„æŠ•å½±éƒ½å¾ˆå¤§ï¼Œå³ä½¿å®ƒä»¬è¯­ä¹‰ä¸ç›¸å…³ï¼Œä½™å¼¦ç›¸ä¼¼åº¦ä¹Ÿä¼šå¾ˆé«˜ï¼š</p>
<p>\begin{equation}
\boldsymbol{x}_i \cdot \boldsymbol{x}_j \approx (\boldsymbol{x}_i \cdot \boldsymbol{u}_1)(\boldsymbol{x}_j \cdot \boldsymbol{u}_1) + \text{å°é‡}
\tag{41}
\end{equation}</p>
<h4 id="53">5.3 ç™½åŒ–å¦‚ä½•ç¼“è§£å„å‘å¼‚æ€§</h4>
<p>ç™½åŒ–é€šè¿‡ $\boldsymbol{\Lambda}^{-1/2}$ å°†å„æ–¹å‘çš„æ–¹å·®å½’ä¸€åŒ–ï¼š</p>
<p>\begin{equation}
\text{Var}(\tilde{x}_{ij}) = \lambda_j \cdot \lambda_j^{-1} = 1, \quad \forall j
\tag{42}
\end{equation}</p>
<p>å˜æ¢åçš„åæ–¹å·®çŸ©é˜µï¼š</p>
<p>\begin{equation}
\text{Cov}(\tilde{\boldsymbol{x}}) = \boldsymbol{U}\boldsymbol{\Lambda}\boldsymbol{U}^{\top} \cdot \boldsymbol{U}\boldsymbol{\Lambda}^{-1}\boldsymbol{U}^{\top} = \boldsymbol{I}
\tag{43}
\end{equation}</p>
<p>æ­¤æ—¶æ•°æ®åœ¨æ‰€æœ‰æ–¹å‘ä¸Šçš„æ–¹å·®ç›¸ç­‰ï¼Œå„å‘åŒæ€§ã€‚</p>
<h3 id="6">6. æ•°å€¼ç¨³å®šæ€§åˆ†æ</h3>
<h4 id="61">6.1 å°ç‰¹å¾å€¼é—®é¢˜</h4>
<p>å½“ $\lambda_i$ å¾ˆå°æ—¶ï¼Œ$\lambda_i^{-1/2}$ ä¼šéå¸¸å¤§ï¼Œå¯¼è‡´æ•°å€¼ä¸ç¨³å®šã€‚</p>
<p><strong>æ­£åˆ™åŒ–æ–¹æ¡ˆ</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{\Lambda}_{\epsilon}^{-1/2} = \text{diag}\left(\frac{1}{\sqrt{\lambda_1 + \epsilon}}, \ldots, \frac{1}{\sqrt{\lambda_d + \epsilon}}\right)
\tag{44}
\end{equation}</p>
<p>å…¶ä¸­ $\epsilon &gt; 0$ æ˜¯å°çš„æ­£åˆ™åŒ–å¸¸æ•°ï¼ˆå¦‚ $10^{-5}$ï¼‰ã€‚</p>
<h4 id="62">6.2 çŸ©é˜µæ±‚é€†çš„æ•°å€¼ç¨³å®šæ€§</h4>
<p>åæ–¹å·®çŸ©é˜µçš„æ¡ä»¶æ•°ï¼š</p>
<p>\begin{equation}
\kappa(\boldsymbol{\Sigma}) = \frac{\lambda_{\max}}{\lambda_{\min}} = \frac{\lambda_1}{\lambda_d}
\tag{45}
\end{equation}</p>
<p>å½“ $\kappa(\boldsymbol{\Sigma}) \gg 1$ æ—¶ï¼ŒçŸ©é˜µæ¥è¿‘å¥‡å¼‚ï¼Œæ±‚é€†ä¸ç¨³å®šã€‚</p>
<p><strong>ä½¿ç”¨SVDçš„ä¼˜åŠ¿</strong>ï¼šSVDæ–¹æ³•æ•°å€¼ç¨³å®šæ€§å¥½ï¼Œå³ä½¿çŸ©é˜µæ¥è¿‘å¥‡å¼‚ä¹Ÿèƒ½å¾—åˆ°å¯é ç»“æœã€‚</p>
<h3 id="7-simbert">7. SimBERTå®éªŒçš„æ•°å­¦è§£é‡Š</h3>
<h4 id="71">7.1 æœ‰ç›‘ç£æ¨¡å‹çš„ç‰¹ç‚¹</h4>
<p>SimBERTæ˜¯æœ‰ç›‘ç£è®­ç»ƒçš„å¥å‘é‡æ¨¡å‹ï¼Œå…¶ç›®æ ‡å‡½æ•°é€šå¸¸åŒ…å«å¯¹æ¯”å­¦ä¹ æŸå¤±ï¼š</p>
<p>\begin{equation}
\mathcal{L} = -\log \frac{\exp(\text{sim}(\boldsymbol{x}_i, \boldsymbol{x}_i^+)/\tau)}{\sum_j \exp(\text{sim}(\boldsymbol{x}_i, \boldsymbol{x}_j)/\tau)}
\tag{46}
\end{equation}</p>
<p>å…¶ä¸­ $\boldsymbol{x}_i^+$ æ˜¯æ­£æ ·æœ¬ï¼Œ$\tau$ æ˜¯æ¸©åº¦å‚æ•°ã€‚</p>
<p>æœ‰ç›‘ç£è®­ç»ƒå€¾å‘äºå­¦ä¹ æ›´åŠ å„å‘åŒæ€§çš„è¡¨ç¤ºï¼š</p>
<p>\begin{equation}
\lambda_1 / \lambda_d \approx \mathcal{O}(1)
\tag{47}
\end{equation&gt;</p>
<h4 id="72-1">7.2 ä¸ºä»€ä¹ˆæœ‰ç›‘ç£æ¨¡å‹ä¸é€‚åˆÎ²=Î³=1</h4>
<p>å½“æ¨¡å‹æœ¬èº«å·²ç»å„å‘åŒæ€§æ—¶ï¼Œå¼ºåˆ¶ç™½åŒ–ï¼ˆ$\gamma = 1$ï¼‰å¯èƒ½ç ´åæœ‰ç”¨çš„æ–¹å·®ä¿¡æ¯ï¼š</p>
<p>\begin{equation}
\boldsymbol{\Lambda}^{-1/2} \approx \boldsymbol{I} \cdot c
\tag{48}
\end{equation}</p>
<p>æ­¤æ—¶ç™½åŒ–å˜æ¢è¿‘ä¼¼äºå‡åŒ€ç¼©æ”¾ï¼Œä½†ä¸­å¿ƒåŒ–ï¼ˆ$\beta = 1$ï¼‰å¯èƒ½ç§»é™¤æœ‰ç”¨çš„ä½ç½®ä¿¡æ¯ã€‚</p>
<h4 id="73-0">7.3 Î²=Î³=0çš„ä¼˜åŠ¿</h4>
<p>å¯¹äºæœ‰ç›‘ç£æ¨¡å‹ï¼Œè®¾ç½® $\beta = \gamma = 0$ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}_i = \boldsymbol{x}_i\boldsymbol{U}
\tag{49}
\end{equation}</p>
<p>è¿™ä»…æ˜¯ä¸€ä¸ªæ­£äº¤æ—‹è½¬ï¼Œä¿æŒæ‰€æœ‰å‡ ä½•æ€§è´¨ï¼š</p>
<p>\begin{equation}
|\tilde{\boldsymbol{x}}_i| = |\boldsymbol{x}_i|, \quad \cos(\tilde{\boldsymbol{x}}_i, \tilde{\boldsymbol{x}}_j) = \cos(\boldsymbol{x}_i, \boldsymbol{x}_j)
\tag{50}
\end{equation}</p>
<p>ä½†å¯ä»¥é€šè¿‡é™ç»´å‡å°‘å­˜å‚¨ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{x}}<em k="k">i^{(k)} = \boldsymbol{x}_i\boldsymbol{U}</em>, \quad k = 256 \ll d = 768
\tag{51}
\end{equation}</p>
<h3 id="8">8. è¶…å‚æ•°è°ƒèŠ‚çš„ç†è®ºæŒ‡å¯¼</h3>
<h4 id="81">8.1 å‚æ•°ç©ºé—´çš„å‡ ä½•ç»“æ„</h4>
<p>$(\beta, \gamma)$ å‚æ•°ç©ºé—´çš„å››ä¸ªé¡¶ç‚¹ï¼š</p>
<ol>
<li>$(0, 0)$ï¼šæ­£äº¤æ—‹è½¬ï¼Œä¿æŒæ‰€æœ‰æ€§è´¨</li>
<li>$(1, 0)$ï¼šä¸­å¿ƒåŒ–+æ—‹è½¬ï¼Œç§»é™¤å‡å€¼åç§»</li>
<li>$(0, 1)$ï¼šä¸ä¸­å¿ƒåŒ–ç™½åŒ–ï¼ˆè¾ƒå°‘ä½¿ç”¨ï¼‰</li>
<li>$(1, 1)$ï¼šæ ‡å‡†BERT-whitening</li>
</ol>
<p><strong>æ’å€¼æ€§è´¨</strong>ï¼šä¸­é—´å€¼ $(0 &lt; \beta &lt; 1, 0 &lt; \gamma &lt; 1)$ åœ¨è¿™äº›æç«¯æƒ…å†µä¹‹é—´å¹³æ»‘è¿‡æ¸¡ã€‚</p>
<h4 id="82">8.2 æ€§èƒ½æ›²é¢çš„ç›´è§‰</h4>
<p>å¯¹äºä¸åŒä»»åŠ¡ï¼Œæœ€ä¼˜ $(\beta, \gamma)$ ä¸åŒï¼š</p>
<ul>
<li>æ— ç›‘ç£BERTï¼šå€¾å‘äº $(\beta, \gamma) \to (1, 1)$ï¼ˆéœ€è¦å¼ºå»ç›¸å…³ï¼‰</li>
<li>æœ‰ç›‘ç£SimBERTï¼šå€¾å‘äº $(\beta, \gamma) \to (0, 0)$ï¼ˆä¿æŒåŸæœ‰ç»“æ„ï¼‰</li>
<li>ä¸­ç­‰ç›‘ç£æ¨¡å‹ï¼šå¯èƒ½éœ€è¦ä¸­é—´å€¼</li>
</ul>
<h4 id="83-k">8.3 é™ç»´ç»´åº¦kçš„é€‰æ‹©</h4>
<p>æ ¹æ®ç´¯ç§¯æ–¹å·®è´¡çŒ®ç‡é€‰æ‹© $k$ï¼š</p>
<p>\begin{equation}
k = \min\left{j : \frac{\sum_{i=1}^j \lambda_i}{\sum_{i=1}^d \lambda_i} \geq \theta\right}
\tag{52}
\end{equation}</p>
<p>å¸¸ç”¨é˜ˆå€¼ï¼š$\theta = 0.95$ æˆ– $0.99$ã€‚</p>
<p>å¯¹äºBERTï¼ˆ768ç»´ï¼‰ï¼Œé€šå¸¸ $k = 256$ æˆ– $k = 384$ å³å¯ä¿ç•™å¤§éƒ¨åˆ†ä¿¡æ¯ã€‚</p>
<h3 id="9">9. å®Œæ•´ç®—æ³•æµç¨‹</h3>
<p><strong>è¾“å…¥</strong>ï¼šå¥å‘é‡é›†åˆ ${\boldsymbol{x}_1, \ldots, \boldsymbol{x}_N}$ï¼Œè¶…å‚æ•° $\beta, \gamma, k$</p>
<p><strong>æ­¥éª¤1</strong>ï¼šè®¡ç®—å‡å€¼
\begin{equation}
\boldsymbol{\mu} = \frac{1}{N}\sum_{i=1}^N \boldsymbol{x}_i
\tag{53}
\end{equation}</p>
<p><strong>æ­¥éª¤2</strong>ï¼šè®¡ç®—åæ–¹å·®çŸ©é˜µ
\begin{equation}
\boldsymbol{\Sigma} = \frac{1}{N}\sum_{i=1}^N (\boldsymbol{x}_i - \beta\boldsymbol{\mu})(\boldsymbol{x}_i - \beta\boldsymbol{\mu})^{\top}
\tag{54}
\end{equation}</p>
<p><strong>æ­¥éª¤3</strong>ï¼šSVDåˆ†è§£
\begin{equation}
\boldsymbol{\Sigma} = \boldsymbol{U}\boldsymbol{\Lambda}\boldsymbol{U}^{\top}
\tag{55}
\end{equation}</p>
<p><strong>æ­¥éª¤4</strong>ï¼šç™½åŒ–å˜æ¢
\begin{equation}
\tilde{\boldsymbol{x}}<em k="k">i = (\boldsymbol{x}_i - \beta\boldsymbol{\mu})\boldsymbol{U}</em>
\tag{56}
\end{equation}}\boldsymbol{\Lambda}_k^{-\gamma/2</p>
<p><strong>è¾“å‡º</strong>ï¼šé™ç»´ç™½åŒ–åçš„å‘é‡ ${\tilde{\boldsymbol{x}}_1, \ldots, \tilde{\boldsymbol{x}}_N}$</p>
<h3 id="10">10. æ•°å€¼è®¡ç®—ç¤ºä¾‹</h3>
<p>å‡è®¾ $d = 4$ï¼Œ$N = 3$ï¼Œå¥å‘é‡ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{X} = \begin{bmatrix}
1 &amp; 2 &amp; 3 &amp; 4 \
2 &amp; 3 &amp; 4 &amp; 5 \
3 &amp; 4 &amp; 5 &amp; 6
\end{bmatrix}
\tag{57}
\end{equation}</p>
<p><strong>æ­¥éª¤1</strong>ï¼šå‡å€¼
\begin{equation}
\boldsymbol{\mu} = \frac{1}{3}[6, 9, 12, 15] = [2, 3, 4, 5]
\tag{58}
\end{equation}</p>
<p><strong>æ­¥éª¤2</strong>ï¼šä¸­å¿ƒåŒ–ï¼ˆ$\beta = 1$ï¼‰
\begin{equation}
\boldsymbol{X}_c = \begin{bmatrix}
-1 &amp; -1 &amp; -1 &amp; -1 \
0 &amp; 0 &amp; 0 &amp; 0 \
1 &amp; 1 &amp; 1 &amp; 1
\end{bmatrix}
\tag{59}
\end{equation}</p>
<p><strong>æ­¥éª¤3</strong>ï¼šåæ–¹å·®çŸ©é˜µ
\begin{equation}
\boldsymbol{\Sigma} = \frac{1}{3}\boldsymbol{X}_c^{\top}\boldsymbol{X}_c = \frac{2}{3}\begin{bmatrix}
1 &amp; 1 &amp; 1 &amp; 1 \
1 &amp; 1 &amp; 1 &amp; 1 \
1 &amp; 1 &amp; 1 &amp; 1 \
1 &amp; 1 &amp; 1 &amp; 1
\end{bmatrix}
\tag{60}
\end{equation}</p>
<p><strong>æ­¥éª¤4</strong>ï¼šç‰¹å¾å€¼åˆ†è§£
\begin{equation}
\lambda_1 = \frac{8}{3}, \quad \lambda_2 = \lambda_3 = \lambda_4 = 0
\tag{61}
\end{equation}</p>
<p>è¿™ä¸ªä¾‹å­ä¸­æ•°æ®æ˜¯ç§©1çš„ï¼ˆæ‰€æœ‰å‘é‡å…±çº¿ï¼‰ï¼Œåªæœ‰ä¸€ä¸ªéé›¶ç‰¹å¾å€¼ã€‚</p>
<p><strong>æ­¥éª¤5</strong>ï¼šç™½åŒ–ï¼ˆä¿ç•™ $k=1$ ç»´ï¼‰
\begin{equation}
\tilde{\boldsymbol{x}}_i = (\boldsymbol{x}_i - \boldsymbol{\mu})\boldsymbol{u}_1 \cdot \lambda_1^{-1/2} = (\boldsymbol{x}_i - \boldsymbol{\mu})\boldsymbol{u}_1 \cdot \sqrt{\frac{3}{8}}
\tag{62}
\end{equation}</p>
<p>å…¶ä¸­ $\boldsymbol{u}_1 = \frac{1}{2}[1, 1, 1, 1]^{\top}$ã€‚</p>
<h3 id="11_1">11. ç†è®ºæ€»ç»“ä¸å®è·µå»ºè®®</h3>
<p><strong>ç†è®ºè¦ç‚¹</strong>ï¼š
1. BERT-whiteningé€šè¿‡PCA+ç™½åŒ–è§£å†³å„å‘å¼‚æ€§é—®é¢˜
2. è¶…å‚æ•° $\beta$ æ§åˆ¶ä¸­å¿ƒåŒ–ç¨‹åº¦ï¼Œ$\gamma$ æ§åˆ¶æ–¹å·®å½’ä¸€åŒ–ç¨‹åº¦
3. $(\beta, \gamma) = (0, 0)$ æä¾›"å…è´¹åˆé¤"å¼çš„é™ç»´ï¼Œä¿æŒåŸæœ‰æ€§è´¨
4. é™ç»´é€šè¿‡ä¿ç•™ä¸»æˆåˆ†å®ç°ï¼Œä¿¡æ¯æŸå¤±å¯æ§</p>
<p><strong>å®è·µå»ºè®®</strong>ï¼š
1. <strong>æ— ç›‘ç£æ¨¡å‹</strong>ï¼ˆå¦‚BERTï¼‰ï¼šä½¿ç”¨ $\beta = \gamma = 1$ï¼Œå¼ºå»ç›¸å…³
2. <strong>æœ‰ç›‘ç£æ¨¡å‹</strong>ï¼ˆå¦‚SimBERTï¼‰ï¼šä½¿ç”¨ $\beta = \gamma = 0$ï¼Œä»…é™ç»´ä¸æ”¹å˜åˆ†å¸ƒ
3. <strong>ä¸­ç­‰ç›‘ç£æ¨¡å‹</strong>ï¼šåœ¨éªŒè¯é›†ä¸Šç½‘æ ¼æœç´¢ $\beta, \gamma \in {0, 0.5, 1}$
4. <strong>é™ç»´ç»´åº¦</strong>ï¼š$k = 256$ å¯¹äº768ç»´BERTé€šå¸¸è¶³å¤Ÿï¼ˆä¿ç•™çº¦90%æ–¹å·®ï¼‰
5. <strong>æ•°å€¼ç¨³å®š</strong>ï¼šæ·»åŠ æ­£åˆ™åŒ– $\epsilon \approx 10^{-5}$ é¿å…å°ç‰¹å¾å€¼é—®é¢˜</p>
<p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼š
- æ—¶é—´å¤æ‚åº¦ï¼š$O(Nd^2 + d^3)$ï¼ˆåæ–¹å·®è®¡ç®—+SVDï¼‰
- ç©ºé—´å¤æ‚åº¦ï¼š$O(Nd + d^2)$ï¼ˆå­˜å‚¨æ•°æ®+åæ–¹å·®çŸ©é˜µï¼‰
- æ¨ç†å¤æ‚åº¦ï¼š$O(dk)$ï¼ˆæ¯ä¸ªå‘é‡çš„å˜æ¢ï¼‰</p>
        </div>
    </div>
</body>
</html>