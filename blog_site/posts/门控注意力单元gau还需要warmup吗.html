<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é—¨æ§æ³¨æ„åŠ›å•å…ƒï¼ˆGAUï¼‰è¿˜éœ€è¦Warmupå—ï¼Ÿ</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>é—¨æ§æ³¨æ„åŠ›å•å…ƒï¼ˆGAUï¼‰è¿˜éœ€è¦Warmupå—ï¼Ÿ</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-27 | ğŸ“„ å¤§å°: 19.3 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8990">https://spaces.ac.cn/archives/8990</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨æ–‡ç« <a href="/archives/8978">ã€Šè®­ç»ƒ1000å±‚çš„Transformerç©¶ç«Ÿæœ‰ä»€ä¹ˆå›°éš¾ï¼Ÿã€‹</a>å‘å¸ƒä¹‹åï¼Œå¾ˆå¿«å°±æœ‰è¯»è€…é—®åˆ°å¦‚æœå°†å…¶ç”¨åˆ°<a href="/archives/8934">ã€ŠFLASHï¼šå¯èƒ½æ˜¯è¿‘æ¥æœ€æœ‰æ„æ€çš„é«˜æ•ˆTransformerè®¾è®¡ã€‹</a>ä¸­çš„â€œé—¨æ§æ³¨æ„åŠ›å•å…ƒï¼ˆGAUï¼‰â€ï¼Œé‚£ç»“æœæ˜¯æ€æ ·çš„ï¼Ÿè·Ÿæ ‡å‡†Transformerçš„ç»“æœæœ‰ä½•ä¸åŒï¼Ÿæœ¬æ–‡å°±æ¥è®¨è®ºè¿™ä¸ªé—®é¢˜ã€‚</p>
<h2 id="_1">å…ˆè¯´ç»“è®º</h2>
<p>äº‹å®ä¸Šï¼ŒGAUæ˜¯éå¸¸å®¹æ˜“è®­ç»ƒçš„æ¨¡å‹ï¼Œå“ªæ€•æˆ‘ä»¬ä¸åŠ è°ƒæ•´åœ°ç›´æ¥ä½¿ç”¨â€œPost Norm + Xavieråˆå§‹åŒ–â€ï¼Œä¹Ÿèƒ½è½»æ¾è®­ç»ƒä¸ªå‡ åå±‚çš„GAUï¼Œå¹¶ä¸”è¿˜ä¸ç”¨Warmupã€‚æ‰€ä»¥å…³äºæ ‡å‡†Transformerçš„å¾ˆå¤šè®­ç»ƒæŠ€å·§ï¼Œåˆ°äº†GAUè¿™é‡Œå¯èƒ½å°±æ— ç”¨æ­¦ä¹‹åœ°äº†...</p>
<p>ä¸ºä»€ä¹ˆGAUèƒ½åšåˆ°è¿™äº›ï¼Ÿå¾ˆç®€å•ï¼Œå› ä¸ºåœ¨é»˜è®¤è®¾ç½®ä¹‹ä¸‹ï¼Œç†è®ºä¸Š$\text{GAU}(\boldsymbol{x}<em l_1="l+1">l)$ç›¸æ¯”$\boldsymbol{x}_l$å‡ ä¹å°äº†ä¸¤ä¸ªæ•°é‡çº§ï¼Œæ‰€ä»¥<br />
\begin{equation}\boldsymbol{x}</em>} = \text{LN}(\boldsymbol{x}_l + \text{GAU}(\boldsymbol{x}_l))\approx \boldsymbol{x}_l\end{equation<br />
å› æ­¤ï¼ŒGAUé…åˆæ®‹å·®ï¼Œåœ¨æ ‡å‡†çš„åˆå§‹åŒ–ä¹‹ä¸‹å°±å·²ç»å¾ˆæ¥è¿‘ä¸€ä¸ªæ’ç­‰å‡½æ•°ï¼Œæœ‰è¿™ç§æ€§è´¨çš„æ¨¡å‹æ˜¯éå¸¸å®¹æ˜“è®­ç»ƒçš„ï¼Œé€šå¸¸éƒ½ä¸éœ€è¦Warmupã€‚å¦‚æœè¦å¯¹åº”ä¸Š<a href="/archives/8978">ã€Šè®­ç»ƒ1000å±‚çš„Transformerç©¶ç«Ÿæœ‰ä»€ä¹ˆå›°éš¾ï¼Ÿã€‹</a>çš„ç»“è®ºï¼Œè¿™ä¸¤ä¸ªæ•°é‡çº§ç›¸å½“äº$\lambda=1,\alpha=100$ï¼Œæ„å‘³ç€å®ƒè‡ªåŠ¨åœ°åŒ…å«äº†ä¸Šç™¾å±‚çš„æ¨¡å‹DeepNormæ“ä½œï¼Œå› æ­¤ç†è®ºä¸Šæˆ‘ä»¬å¯ä»¥ç›´æ¥è®­ç»ƒä¸Šç™¾å±‚çš„GAUæ¨¡å‹è€Œä¸éœ€è¦ç‰¹åˆ«çš„è°ƒæ•´æŠ€å·§ã€‚</p>
<h2 id="_2">æ¨¡å‹å‡è®¾</h2>
<p>å…¶å®æˆ‘ä»¬åªéœ€è¦å¯¹GAUçš„è¾“å…¥å’Œè¾“å‡ºåšä¸€ä¸ªé‡çº§åˆ†æå°±è¡Œäº†ã€‚æ ‡å‡†çš„GAUè¿ç®—å¦‚ä¸‹ï¼š<br />
\begin{equation}\begin{aligned}<br />
&amp;\boldsymbol{O}=(\boldsymbol{U}\odot\boldsymbol{A}\boldsymbol{V})\boldsymbol{W}_o,\quad \boldsymbol{A}=\frac{1}{ns}\text{relu}^2\left(\mathcal{Q}(\boldsymbol{Z})\mathcal{K}(\boldsymbol{Z})^{\top}\right)\\\<br />
&amp;\boldsymbol{U}=\phi(\boldsymbol{X}\boldsymbol{W}_u),\quad\boldsymbol{V}=\phi(\boldsymbol{X}\boldsymbol{W}_v),\quad\boldsymbol{Z}=\phi(\boldsymbol{X}\boldsymbol{W}_z)<br />
\end{aligned}\end{equation}<br />
å…¶ä¸­$\boldsymbol{X}\in\mathbb{R}^{n\times d}$ã€$\boldsymbol{W}_u,\boldsymbol{W}_v\in\mathbb{R}^{d\times e}$ã€$\boldsymbol{W}_z\in\mathbb{R}^{d\times s}$ã€$\boldsymbol{W}_o\in\mathbb{R}^{e\times d}$ï¼Œ$\mathcal{Q},\mathcal{K}$æ˜¯ç®€å•çš„ä»¿å°„å˜æ¢ï¼Œ$\phi$æ˜¯æ¿€æ´»å‡½æ•°ï¼Œé»˜è®¤æ˜¯Swishã€‚å¦‚æœè¿˜æœ‰ä¸æ¸…æ¥šçš„åœ°æ–¹ï¼Œå¯ä»¥å‚è€ƒ<a href="/archives/8934">ã€ŠFLASHï¼šå¯èƒ½æ˜¯è¿‘æ¥æœ€æœ‰æ„æ€çš„é«˜æ•ˆTransformerè®¾è®¡ã€‹</a>ã€‚</p>
<p>æˆ‘ä»¬å‡è®¾$\boldsymbol{X}$çš„å„ä¸ªåˆ†é‡ç‹¬ç«‹åœ°æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒ$\mathcal{N}(0,1)$ï¼Œç„¶å$\boldsymbol{W}_u,\boldsymbol{W}_v,\boldsymbol{W}_z$çš„åˆå§‹åŒ–åˆ†å¸ƒæ˜¯$\mathcal{N}(0,1/d)$è€Œ$\boldsymbol{W}_o$çš„åˆå§‹åŒ–åˆ†å¸ƒåˆ™æ˜¯$\mathcal{N}(0,1/e)$ç‹¬ç«‹é‡å¤é‡‡æ ·å‡ºæ¥çš„ï¼Œè¿™ç§åˆå§‹åŒ–åˆ†å¸ƒè¢«ç§°ä¸º<a href="http://yann.lecun.com/exdb/publis/pdf/lecun-98b.pdf">LeCunåˆå§‹åŒ–</a>ï¼Œå®ƒçš„ç‰¹ç‚¹æ˜¯èƒ½è®©è¾“å‡ºçš„å‡å€¼ä¸º0ï¼Œå¹¶ä¸”ä¿æŒè¾“å…¥è¾“å‡ºçš„äºŒé˜¶çŸ©ä¸€è‡´ï¼Œç›¸å…³å†…å®¹å¯ä»¥å‚è€ƒç¬”è€…ä¹‹å‰çš„æ–‡ç« <a href="/archives/8620">ã€Šæµ…è°ˆTransformerçš„åˆå§‹åŒ–ã€å‚æ•°åŒ–ä¸æ ‡å‡†åŒ–ã€‹</a>ã€‚</p>
<h2 id="_3">åŸºæœ¬ç§¯åˆ†</h2>
<p>åœ¨è¿™äº›å‡è®¾ä¹‹ä¸‹ï¼Œæˆ‘ä»¬æ¥é€ä¸€ä¼°è®¡æ¯æ­¥è¿ç®—ä¹‹åçš„åˆ†å¸ƒã€‚ç»“åˆå‡è®¾ï¼Œç”±äºLeCunåˆå§‹åŒ–èƒ½ä¿æŒäºŒé˜¶çŸ©ä¸å˜ï¼Œæ‰€ä»¥$\boldsymbol{X}\boldsymbol{W}$ä¹Ÿå¯ä»¥è¿‘ä¼¼è®¤ä¸ºæ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥ç”¨ä¸‹é¢çš„å¼å­ä¼°è®¡åŠ äº†æ¿€æ´»å‡½æ•°$\phi$ä¹‹åçš„å‡å€¼å’ŒäºŒé˜¶çŸ©ï¼š<br />
\begin{equation}\begin{aligned}<br />
\mu\triangleq\mathbb{E}[\phi(\varepsilon)] =&amp;\, \int_{-\infty}^{\infty} \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}\varepsilon^2\right)\phi(\varepsilon)d\varepsilon = 0.2066\cdots \\\<br />
\nu^2\triangleq\mathbb{E}[\phi(\varepsilon)^2] =&amp;\, \int_{-\infty}^{\infty} \frac{1}{\sqrt{2\pi}}\exp\left(-\frac{1}{2}\varepsilon^2\right)\phi(\varepsilon)^2d\varepsilon = 0.3557\cdots<br />
\end{aligned}\end{equation}<br />
æ¢è¨€ä¹‹ï¼Œ$\boldsymbol{U},\boldsymbol{V},\boldsymbol{Z}$çš„åˆ†é‡å‡å€¼å’ŒäºŒé˜¶çŸ©åˆ†åˆ«æ˜¯$\mu$å’Œ$\nu^2$ï¼Œäº‹å®ä¸Šåé¢åªç”¨åˆ°äº†äºŒé˜¶çŸ©$\nu^2$ï¼Œç®€å•ä¼°è®¡æ—¶ï¼Œå–$\nu=0.6$å°±è¡Œäº†ã€‚</p>
<h2 id="_4">è‡ªæ³¨æ„åŠ›</h2>
<p>åœ¨åˆå§‹é˜¶æ®µï¼Œæˆ‘ä»¬æœ‰$\mathcal{Q}(\boldsymbol{Z})=\mathcal{K}(\boldsymbol{Z})=\boldsymbol{Z}$ï¼Œæ‰€ä»¥åˆå§‹é˜¶æ®µæœ‰$\boldsymbol{A}=\frac{1}{ns}\text{relu}^2\left(\boldsymbol{Z}\boldsymbol{Z}^{\top}\right)$ï¼Œå³ï¼ˆä¸‹é¢$i\neq j$ï¼‰<br />
\begin{equation}\begin{aligned}<br />
&amp;\boldsymbol{A}<em i_j="i,j">{i,i} = \frac{1}{ns}\text{relu}^2\big(\left\langle\boldsymbol{Z}_i, \boldsymbol{Z}_i\right\rangle\big) \approx \frac{1}{ns}\text{relu}^2\big(s\mathbb{E}[\phi(\varepsilon)^2]\big) = \frac{sv^4}{n} \\\<br />
&amp;\boldsymbol{A}</em>} = \frac{1}{ns}\text{relu}^2\big(\left\langle\boldsymbol{Z<em i_i="i,i">i, \boldsymbol{Z}_j\right\rangle\big) \approx \frac{1}{ns}\text{relu}^2\big(s\mathbb{E}[\phi(\varepsilon)]^2\big) = \frac{s\mu^4}{n}<br />
\end{aligned}\end{equation}<br />
æ³¨æ„åˆ°$\boldsymbol{A}</em>$ï¼Œäºæ˜¯} / \boldsymbol{A}_{i,j} \approx \nu^4 / \mu^4 \approx 69 \gg 1$ï¼Œä¹Ÿå°±æ˜¯å¯¹è§’çº¿å…ƒç´ è¿œè¿œå¤§äºéå¯¹è§’çº¿å…ƒç´ ï¼Œå› æ­¤åˆå§‹é˜¶æ®µçš„$\boldsymbol{A}$å…¶å®å¾ˆæ¥è¿‘å•ä½é˜µçš„$\frac{sv^4}{n}$å€ï¼Œå³$\boldsymbol{A}\approx \frac{sv^4}{n}\boldsymbol{I<br />
\begin{equation}\boldsymbol{O}=(\boldsymbol{U}\odot\boldsymbol{A}\boldsymbol{V})\boldsymbol{W}_o\approx \frac{sv^4}{n}(\boldsymbol{U}\odot\boldsymbol{V})\boldsymbol{W}_o\end{equation}</p>
<h2 id="_5">å‰©ä½™éƒ¨åˆ†</h2>
<p>å¯¹äº$\boldsymbol{U}\odot\boldsymbol{V}$ï¼Œå®ƒè¿‘ä¼¼äºä¸¤ä¸ªç‹¬ç«‹åŒåˆ†å¸ƒçš„å˜é‡$\varepsilon_i,\varepsilon_j$ç®—å‡ºæ¥çš„$\phi(\varepsilon_i)\phi(\varepsilon_j)$ï¼Œæ‰€ä»¥<br />
\begin{equation}\mathbb{E}[(\boldsymbol{U}\odot\boldsymbol{V})^2] \approx \mathbb{E}[\phi(\varepsilon_i)^2\phi(\varepsilon_j)^2] = \mathbb{E}[\phi(\varepsilon_i)^2]\mathbb{E}[\phi(\varepsilon_j)^2] = \nu^4\end{equation}<br />
äºæ˜¯æœ‰ï¼ˆ$\boldsymbol{W}_o$ä¸æ”¹å˜äºŒé˜¶çŸ©ï¼‰<br />
\begin{equation}\mathbb{E}[\boldsymbol{O}^2] \approx \mathbb{E}\left[\left(\frac{sv^4}{n}\boldsymbol{U}\odot\boldsymbol{V}\right)^2\right] = \mathbb{E}[\phi(\varepsilon_i)^2\phi(\varepsilon_j)^2] = \frac{s^2\nu^{12}}{n^2}\end{equation}<br />
å› æ­¤$\boldsymbol{O}$çš„é‡çº§æ˜¯<br />
\begin{equation}\boldsymbol{O} = \mathcal{O}\left(\sqrt{\frac{s^2\nu^{12}}{n^2}}\right) = \mathcal{O}\left(\frac{s\nu^{6}}{n}\right) \end{equation}<br />
ä»¥å¸¸è§„çš„é¢„è®­ç»ƒè®¾ç½®$s=128,n=512$ä¸ºä¾‹ï¼Œ$s\nu^6/n\approx 0.01$ï¼Œå› æ­¤åœ¨åˆå§‹é˜¶æ®µç»è¿‡$\text{GAU}(\boldsymbol{x}_l)$åå‡ºæ¥çš„ç»“æœå¤§è‡´æ˜¯$0.01\boldsymbol{x}_l$è¿™ä¸ªçº§åˆ«çš„ï¼Œå°ä¸¤ä¸ªæ•°é‡çº§ã€‚å½“ç„¶ï¼Œè¿™æ˜¯ç†è®ºç»“æœï¼Œå®é™…ä¸Šç”±äºéšæœºè¯¯å·®åŸå› å¯èƒ½ä¼šæ›´å¤§æˆ–æ›´å°ï¼Œä¸è¿‡å°±ç®—æ›´å¤§äº†ä¹Ÿä¸ç”¨æ‹…å¿ƒï¼Œå› ä¸ºGAUè¿˜æœ‰ä¸‹é¢çš„â€œç–¯ç‹‚å°ºåº¦â€æ€§è´¨ã€‚</p>
<h2 id="_6">ç–¯ç‹‚å°ºåº¦</h2>
<p>åœ¨GAUè®ºæ–‡çš„é™„å½•å‚è€ƒä»£ç ä¸­ï¼Œä½œè€…æ‰€ç”¨çš„åˆå§‹åŒ–æ–¹æ³•è¿˜ä¸æ˜¯LeCunåˆå§‹åŒ–ï¼Œè€Œæ˜¯0.02æ ‡å‡†å·®çš„æ­£æ€åˆ†å¸ƒã€‚å¯¹äºBERT baseæ¥è¯´$d=786$ï¼ŒLeCunåˆå§‹åŒ–ç»™å‡ºçš„æ ‡å‡†å·®æ˜¯$1/\sqrt{d}\approx 0.036$ï¼Œä¹Ÿå°±æ˜¯è¯´é™„å½•æ‰€ç”¨çš„åˆå§‹åŒ–æ ‡å‡†å·®å¤§çº¦åªæœ‰LeCunåˆå§‹åŒ–çš„ä¸€åŠã€‚</p>
<p>å½“æˆ‘ä»¬å°†GAUä¸­æ‰€æœ‰çš„$\boldsymbol{W}$éƒ½æ¢æˆ$\lambda \boldsymbol{W}$æ—¶ï¼Œæˆ‘ä»¬å°†æœ‰<br />
\begin{equation}\begin{aligned}<br />
&amp;\tilde{\boldsymbol{U}}=\phi(\boldsymbol{X}\lambda\boldsymbol{W}_u) \approx \lambda\phi(\boldsymbol{X}\boldsymbol{W}_u)=\lambda \boldsymbol{U}\\\<br />
&amp;\tilde{\boldsymbol{V}}=\phi(\boldsymbol{X}\lambda\boldsymbol{W}_v) \approx \lambda\phi(\boldsymbol{X}\boldsymbol{W}_v)=\lambda \boldsymbol{V}\\\<br />
&amp;\tilde{\boldsymbol{Z}}=\phi(\boldsymbol{X}\lambda\boldsymbol{W}_z) \approx \lambda\phi(\boldsymbol{X}\boldsymbol{W}_z)=\lambda \boldsymbol{Z}\\\<br />
&amp;\tilde{\boldsymbol{A}}=\frac{1}{ns}\text{relu}^2\left(\lambda^2\mathcal{Q}(\boldsymbol{Z})\mathcal{K}(\boldsymbol{Z})^{\top}\right) = \lambda^4 \boldsymbol{A}\\\<br />
&amp;\tilde{\boldsymbol{O}}=(\tilde{\boldsymbol{U}}\odot\tilde{\boldsymbol{A}}\tilde{\boldsymbol{V}})\lambda\boldsymbol{W}_o \approx \lambda^7 \boldsymbol{O}<br />
\end{aligned}\end{equation}<br />
ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ‰€æœ‰åˆå§‹åŒ–éƒ½ç¼©å°åˆ°åŸæ¥çš„$\lambda$å€ï¼Œé‚£ä¹ˆGAUçš„è¾“å‡ºå°†ä¼šç¼©å°åˆ°åŸæ¥çš„$\lambda^7$å€ï¼è¿™æ˜¯å…³äºGAUçš„ä¸€ä¸ªç›¸å½“ç–¯ç‹‚çš„Scaleï¼ŒæŒ‰ç…§$\lambda=1/2$ç®—ï¼Œ$\lambda^7$åŒæ ·æ˜¯0.01çº§åˆ«ï¼Œå†æ¬¡ç¼©å°äº†ä¸¤ä¸ªæ•°é‡çº§ï¼æ‰€ä»¥ï¼Œå¦‚æœæŒ‰ç…§åŸè®ºæ–‡çš„åˆå§‹åŒ–é€‰æ‹©ï¼Œæˆ‘ä»¬ç†è®ºä¸Šå¯ä»¥ç›´æ¥è®­ç»ƒä¸Šä¸‡å±‚çš„GAUæ¨¡å‹ï¼</p>
<h2 id="_7">æœ¬æ–‡å°ç»“</h2>
<p>æœ¬æ–‡ä¸»è¦ç®€å•åˆ†æäº†ä¸€ä¸‹GAUåœ¨åˆå§‹é˜¶æ®µçš„æ•°é‡çº§ï¼Œå¾—å‡ºæ ‡å‡†åˆå§‹åŒ–ä¸‹çš„GAUå…¶å®å·²ç»æ¥è¿‘æ’ç­‰å‡½æ•°ï¼Œå› æ­¤å…·æœ‰ç›¸å½“å®¹æ˜“è®­ç»ƒçš„ç‰¹ç‚¹ï¼ŒåŸºæœ¬ä¸Šè®­ç»ƒä¸Šç™¾å±‚çš„GAUæ¨¡å‹ä¹Ÿç”¨ä¸ç€é¢å¤–çš„è°ƒæ•´ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8990">https://spaces.ac.cn/archives/8990</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Mar. 11, 2022). ã€Šé—¨æ§æ³¨æ„åŠ›å•å…ƒï¼ˆGAUï¼‰è¿˜éœ€è¦Warmupå—ï¼Ÿ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8990">https://spaces.ac.cn/archives/8990</a></p>
<p>@online{kexuefm-8990,<br />
title={é—¨æ§æ³¨æ„åŠ›å•å…ƒï¼ˆGAUï¼‰è¿˜éœ€è¦Warmupå—ï¼Ÿ},<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={Mar},<br />
url={\url{https://spaces.ac.cn/archives/8990}},<br />
} </p>
<hr />
<h2 id="_8">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">ç¬¬1éƒ¨åˆ†ï¼šæ ¸å¿ƒç†è®ºã€å…¬ç†ä¸å†å²åŸºç¡€</h3>
<div class="theorem-box">

#### 1.1 ç†è®ºèµ·æºä¸GAUçš„è®¾è®¡å“²å­¦

**GAUçš„å†å²èƒŒæ™¯**ï¼š

1. **Transformer (2017)**ï¼šå¼•å…¥Self-Attentionæœºåˆ¶
2. **GLU/Gated Linear Unit (2016)**ï¼šé—¨æ§æœºåˆ¶æå‡è¡¨è¾¾èƒ½åŠ›
3. **FLASH/GAU (2022)**ï¼šèåˆAttentionå’Œé—¨æ§ï¼Œå‚æ•°æ•ˆç‡æå‡

**GAUçš„æ ¸å¿ƒåˆ›æ–°**ï¼š
- å°†Multi-Head Attentionå’ŒFFNèåˆä¸ºå•ä¸€å±‚
- ä½¿ç”¨é—¨æ§æœºåˆ¶ï¼ˆ$\boldsymbol{U} \odot \boldsymbol{A}\boldsymbol{V}$ï¼‰æ›¿ä»£ä¼ ç»Ÿçš„æ®‹å·®è¿æ¥
- é€šè¿‡ç»“æ„è®¾è®¡å®ç°å¤©ç„¶çš„æ˜“è®­ç»ƒæ€§

**è®¾è®¡å“²å­¦**ï¼š
- **å‚æ•°å…±äº«**ï¼š$\boldsymbol{Z}$åŒæ—¶ç”¨äºè®¡ç®—Attentionå’Œé—¨æ§
- **ç»“æ„ç®€åŒ–**ï¼šå‡å°‘å±‚æ•°ï¼Œæå‡æ•ˆç‡
- **è‡ªç¨³å®šæ€§**ï¼šåˆå§‹åŒ–é˜¶æ®µè¾“å‡ºæ¥è¿‘é›¶ï¼Œå¤©ç„¶æ˜“è®­ç»ƒ

</div>

<div class="theorem-box">

#### 1.2 æ•°å­¦å…¬ç†ï¼šåˆå§‹åŒ–ç†è®º

**å…¬ç†1ï¼šLeCunåˆå§‹åŒ–**

å¯¹äºæƒé‡çŸ©é˜µ$\boldsymbol{W} \in \mathbb{R}^{d_{\text{in}} \times d_{\text{out}}}$ï¼ŒLeCunåˆå§‹åŒ–ä½¿ç”¨ï¼š
$$\boldsymbol{W}_{ij} \sim \mathcal{N}(0, 1/d_{\text{in}})$$

**æ€§è´¨**ï¼šä¿æŒè¾“å…¥è¾“å‡ºçš„äºŒé˜¶çŸ©ä¸å˜ï¼š
$$\mathbb{E}[(\boldsymbol{x}\boldsymbol{W})^2] = \mathbb{E}[\boldsymbol{x}^2]$$

**å…¬ç†2ï¼šæ¿€æ´»å‡½æ•°çš„ç»Ÿè®¡æ€§è´¨**

å¯¹äºSwishæ¿€æ´»å‡½æ•°$\phi(x) = x \cdot \sigma(x)$ï¼Œå½“$x \sim \mathcal{N}(0,1)$æ—¶ï¼š
$$\mu = \mathbb{E}[\phi(x)] \approx 0.207,\quad \nu^2 = \mathbb{E}[\phi(x)^2] \approx 0.356$$

</div>

<hr />
<h3 id="2">ç¬¬2éƒ¨åˆ†ï¼šä¸¥è°¨çš„æ ¸å¿ƒæ•°å­¦æ¨å¯¼</h3>
<div class="derivation-box">

#### 2.1 GAUè¾“å‡ºé‡çº§çš„å®Œæ•´æ¨å¯¼

**ç›®æ ‡**ï¼šè¯æ˜GAUåœ¨åˆå§‹åŒ–é˜¶æ®µçš„è¾“å‡ºé‡çº§ä¸º$\mathcal{O}(s\nu^6/n)$ï¼Œè¿œå°äºè¾“å…¥ã€‚

**æ­¥éª¤1ï¼šGAUçš„æ•°å­¦è¡¨è¾¾**

$$\boldsymbol{O}=(\boldsymbol{U}\odot\boldsymbol{A}\boldsymbol{V})\boldsymbol{W}_o$$

å…¶ä¸­ï¼š
- $\boldsymbol{U}=\phi(\boldsymbol{X}\boldsymbol{W}_u)$ï¼Œ$\boldsymbol{V}=\phi(\boldsymbol{X}\boldsymbol{W}_v)$
- $\boldsymbol{A}=\frac{1}{ns}\text{relu}^2(\boldsymbol{Z}\boldsymbol{Z}^{\top})$ï¼Œ$\boldsymbol{Z}=\phi(\boldsymbol{X}\boldsymbol{W}_z)$

**æ­¥éª¤2ï¼šè®¡ç®—AttentionçŸ©é˜µ$\boldsymbol{A}$çš„é‡çº§**

å¯¹äºå¯¹è§’å…ƒç´ ï¼ˆ$i=j$ï¼‰ï¼š
$$\boldsymbol{A}_{ii} = \frac{1}{ns}\text{relu}^2(\langle\boldsymbol{Z}_i, \boldsymbol{Z}_i\rangle) \approx \frac{1}{ns} \cdot (s\nu^2)^2 = \frac{s\nu^4}{n}$$

å¯¹äºéå¯¹è§’å…ƒç´ ï¼ˆ$i \neq j$ï¼‰ï¼š
$$\boldsymbol{A}_{ij} = \frac{1}{ns}\text{relu}^2(\langle\boldsymbol{Z}_i, \boldsymbol{Z}_j\rangle) \approx \frac{1}{ns} \cdot (s\mu^2)^2 = \frac{s\mu^4}{n}$$

**å…³é”®è§‚å¯Ÿ**ï¼š
$$\frac{\boldsymbol{A}_{ii}}{\boldsymbol{A}_{ij}} \approx \frac{\nu^4}{\mu^4} \approx 69 \gg 1$$

å› æ­¤ï¼Œ$\boldsymbol{A} \approx \frac{s\nu^4}{n}\boldsymbol{I}$ï¼ˆè¿‘ä¼¼å¯¹è§’é˜µï¼‰

**æ­¥éª¤3ï¼šè®¡ç®—$\boldsymbol{A}\boldsymbol{V}$çš„é‡çº§**

$$\boldsymbol{A}\boldsymbol{V} \approx \frac{s\nu^4}{n}\boldsymbol{V}$$

**æ­¥éª¤4ï¼šè®¡ç®—$\boldsymbol{U}\odot\boldsymbol{A}\boldsymbol{V}$çš„äºŒé˜¶çŸ©**

$$\mathbb{E}[(\boldsymbol{U}\odot\boldsymbol{A}\boldsymbol{V})^2] \approx \left(\frac{s\nu^4}{n}\right)^2 \mathbb{E}[\boldsymbol{U}^2\boldsymbol{V}^2] = \frac{s^2\nu^8}{n^2} \cdot \nu^4 = \frac{s^2\nu^{12}}{n^2}$$

**æ­¥éª¤5ï¼šæœ€ç»ˆé‡çº§**

$$\boldsymbol{O} = \mathcal{O}\left(\frac{s\nu^6}{n}\right)$$

å¯¹äº$s=128, n=512, \nu=0.6$ï¼š
$$\frac{s\nu^6}{n} = \frac{128 \times 0.047}{512} \approx 0.01$$

**ç»“è®º**ï¼šGAUçš„è¾“å‡ºæ¯”è¾“å…¥å°ä¸¤ä¸ªæ•°é‡çº§ï¼

</div>

<div class="derivation-box">

#### 2.2 "ç–¯ç‹‚å°ºåº¦"æ€§è´¨çš„æ¨å¯¼

**ç›®æ ‡**ï¼šè¯æ˜GAUå¯¹åˆå§‹åŒ–ç¼©æ”¾çš„7æ¬¡æ–¹æ•æ„Ÿæ€§ã€‚

**æ­¥éª¤1ï¼šå°†æ‰€æœ‰æƒé‡ç¼©æ”¾$\lambda$å€**

$$\tilde{\boldsymbol{W}}_u = \lambda\boldsymbol{W}_u,\quad \tilde{\boldsymbol{W}}_v = \lambda\boldsymbol{W}_v,\quad \tilde{\boldsymbol{W}}_z = \lambda\boldsymbol{W}_z,\quad \tilde{\boldsymbol{W}}_o = \lambda\boldsymbol{W}_o$$

**æ­¥éª¤2ï¼šæ¨å¯¼å„ä¸­é—´å˜é‡çš„ç¼©æ”¾**

å¯¹äºå°çš„$\lambda$ï¼ŒSwishæ¿€æ´»è¿‘ä¼¼çº¿æ€§ï¼š
$$\phi(\lambda x) \approx \lambda\phi(x)$$

å› æ­¤ï¼š
$$\tilde{\boldsymbol{U}} \approx \lambda\boldsymbol{U},\quad \tilde{\boldsymbol{V}} \approx \lambda\boldsymbol{V},\quad \tilde{\boldsymbol{Z}} \approx \lambda\boldsymbol{Z}$$

**æ­¥éª¤3ï¼šAttentionçŸ©é˜µçš„ç¼©æ”¾**

$$\tilde{\boldsymbol{A}} = \frac{1}{ns}\text{relu}^2(\lambda^2\boldsymbol{Z}\boldsymbol{Z}^{\top}) = \lambda^4\boldsymbol{A}$$

ï¼ˆå› ä¸º$\text{relu}^2$æ˜¯2æ¬¡å‡½æ•°ï¼‰

**æ­¥éª¤4ï¼šæœ€ç»ˆè¾“å‡ºçš„ç¼©æ”¾**

$$\tilde{\boldsymbol{O}} = (\tilde{\boldsymbol{U}}\odot\tilde{\boldsymbol{A}}\tilde{\boldsymbol{V}})\tilde{\boldsymbol{W}}_o = (\lambda\boldsymbol{U}\odot\lambda^4\boldsymbol{A}\lambda\boldsymbol{V})\lambda\boldsymbol{W}_o = \lambda^7\boldsymbol{O}$$

**ç»“è®º**ï¼šæƒé‡ç¼©æ”¾$\lambda$å€ï¼Œè¾“å‡ºç¼©æ”¾$\lambda^7$å€ï¼

å¯¹äº$\lambda=0.5$ï¼ˆFLASHè®ºæ–‡çš„åˆå§‹åŒ–ï¼‰ï¼š
$$\lambda^7 = (0.5)^7 = 0.0078 \approx 0.01$$

å†æ¬¡å°äº†ä¸¤ä¸ªæ•°é‡çº§ï¼

</div>

<div class="derivation-box">

#### 2.3 ä¸ºä»€ä¹ˆGAUä¸éœ€è¦Warmup

**æ¢¯åº¦ä¼ æ’­åˆ†æ**ï¼š

å¯¹äºæ®‹å·®è¿æ¥ï¼š
$$\boldsymbol{x}_{l+1} = \text{LN}(\boldsymbol{x}_l + \text{GAU}(\boldsymbol{x}_l))$$

å½“$\text{GAU}(\boldsymbol{x}_l) \ll \boldsymbol{x}_l$æ—¶ï¼š
$$\boldsymbol{x}_{l+1} \approx \text{LN}(\boldsymbol{x}_l) \approx \boldsymbol{x}_l$$

æ¢¯åº¦å›ä¼ ï¼š
$$\frac{\partial \mathcal{L}}{\partial \boldsymbol{x}_l} \approx \frac{\partial \mathcal{L}}{\partial \boldsymbol{x}_{l+1}}$$

**å…³é”®**ï¼šåˆå§‹é˜¶æ®µGAUæ¥è¿‘æ’ç­‰å‡½æ•°ï¼Œæ¢¯åº¦å¯ä»¥é¡ºç•…ä¼ æ’­ï¼Œæ— éœ€Warmupï¼

</div>

<hr />
<h3 id="3">ç¬¬3éƒ¨åˆ†ï¼šæ•°å­¦ç›´è§‰ã€å¤šè§’åº¦è§£é‡Šä¸ç±»æ¯”</h3>
<div class="intuition-box">

#### 3.1 ç”Ÿæ´»åŒ–ç±»æ¯”

**ç±»æ¯”1ï¼šæ–°æ‰‹å¸æœºçš„æ¸è¿›å¼è®­ç»ƒ**

- **ä¼ ç»ŸTransformer**ï¼šæ–°æ‰‹å¸æœºç›´æ¥ä¸Šé«˜é€Ÿï¼Œå®¹æ˜“å‡ºäº‹ï¼ˆæ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±ï¼‰â†’ éœ€è¦Warmupï¼ˆå…ˆåœ¨å¹³è·¯ç»ƒä¹ ï¼‰
- **GAU**ï¼šè‡ªå¸¦"æ–°æ‰‹ä¿æŠ¤"ï¼Œåˆå§‹é˜¶æ®µè‡ªåŠ¨"æ€ é€Ÿè¡Œé©¶"ï¼ˆè¾“å‡º$\approx 0.01$å€è¾“å…¥ï¼‰ï¼Œé€æ¸"åŠ é€Ÿ"

**ç±»æ¯”2ï¼šç›–æˆ¿å­çš„åœ°åŸº**

- **ä¼ ç»ŸTransformer**ï¼šåœ°åŸºä¸ç¨³ï¼ˆåˆå§‹åŒ–ä¸å½“ï¼‰ï¼Œéœ€è¦å…ˆæ‰“æ¡©ï¼ˆWarmupï¼‰
- **GAU**ï¼šè‡ªå¸¦"ç¨³å›ºåœ°åŸº"ï¼ˆ$\lambda^7$ç¼©æ”¾ï¼‰ï¼Œç›´æ¥å¼€å»ºå³å¯

</div>

<div class="intuition-box">

#### 3.2 å‡ ä½•æ„ä¹‰

ä»å‡½æ•°ç©ºé—´çš„è§’åº¦ï¼š
- åˆå§‹çš„GAUæ¥è¿‘æ’ç­‰æ˜ å°„$f(\boldsymbol{x}) \approx \boldsymbol{x}$
- è¿™åœ¨å‡½æ•°ç©ºé—´ä¸­æ˜¯ä¸€ä¸ª"ç¨³å®šç‚¹"
- è®­ç»ƒè¿‡ç¨‹æ˜¯ä»è¿™ä¸ªç¨³å®šç‚¹å‡ºå‘çš„"å°æ­¥æ‰°åŠ¨"

**ä¼˜åŠ¿**ï¼š
- é¿å…äº†éšæœºåˆå§‹åŒ–çš„"ä¹±èµ°"
- æ¢¯åº¦æ–¹å‘æ›´æ˜ç¡®
- æ”¶æ•›æ›´ç¨³å®š

</div>

<hr />
<h3 id="4">ç¬¬4éƒ¨åˆ†ï¼šæ‰¹åˆ¤æ€§æ¯”è¾ƒä¸ä¼˜åŒ–</h3>
<h4 id="41-gau-vs-transformer">4.1 GAU vs ä¼ ç»ŸTransformerå¯¹æ¯”</h4>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æ ¸å¿ƒæ€æƒ³</th>
<th>ä¼˜ç‚¹</th>
<th><strong>ç¼ºé™·</strong></th>
<th><strong>ä¼˜åŒ–æ–¹å‘</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Transformer</strong></td>
<td>ç‹¬ç«‹Attention+FFN</td>
<td>âœ… è¡¨è¾¾èƒ½åŠ›å¼º<br>âœ… ç†è®ºå®Œå–„</td>
<td>âŒ éœ€è¦Warmup<br>âŒ å‚æ•°é‡å¤§<br>âŒ è®­ç»ƒä¸ç¨³å®š</td>
<td>âœ… Pre-LN<br>âœ… DeepNorm<br>âœ… T-Fixup</td>
</tr>
<tr>
<td><strong>GAU</strong></td>
<td>èåˆAttention+é—¨æ§</td>
<td>âœ… æ— éœ€Warmup<br>âœ… å‚æ•°é«˜æ•ˆ<br>âœ… è®­ç»ƒç¨³å®š</td>
<td>âŒ <strong>è¡¨è¾¾èƒ½åŠ›æœªçŸ¥</strong><br>âŒ <strong>é•¿åºåˆ—æ€§èƒ½</strong><br>âŒ <strong>ç†è®ºä¸å®Œå–„</strong></td>
<td>âœ… å¤šå¤´æ‰©å±•<br>âœ… ç›¸å¯¹ä½ç½®ç¼–ç <br>âœ… ç†è®ºåˆ†æ</td>
</tr>
</tbody>
</table>
<h4 id="42-gau">4.2 GAUçš„æ ¸å¿ƒç¼ºé™·</h4>
<p><strong>ç¼ºé™·1ï¼šAttentioné€€åŒ–ä¸ºè¿‘ä¼¼å¯¹è§’é˜µ</strong>
- <strong>é—®é¢˜</strong>ï¼šåˆå§‹é˜¶æ®µ$\boldsymbol{A} \approx \frac{s\nu^4}{n}\boldsymbol{I}$ï¼Œå¤±å»äº†Attentionçš„"å…³æ³¨è¿œç¨‹"èƒ½åŠ›
- <strong>å½±å“</strong>ï¼šå¯èƒ½éœ€è¦æ›´å¤šè®­ç»ƒæ­¥æ•°æ‰èƒ½å­¦ä¼šçœŸæ­£çš„Attentionæ¨¡å¼
- <strong>é‡åŒ–</strong>ï¼šå¯¹è§’å ä¼˜æ¯”$\approx 69:1$</p>
<p><strong>ç¼ºé™·2ï¼šå¯¹åˆå§‹åŒ–è¶…å‚æ•°æ•æ„Ÿ</strong>
- <strong>é—®é¢˜</strong>ï¼šè™½ç„¶ä¸éœ€è¦Warmupï¼Œä½†å¯¹åˆå§‹åŒ–æ ‡å‡†å·®æ•æ„Ÿï¼ˆ$\lambda^7$ç¼©æ”¾ï¼‰
- <strong>å½±å“</strong>ï¼šéœ€è¦ç²¾ç¡®è°ƒæ•´åˆå§‹åŒ–å‚æ•°</p>
<p><strong>ç¼ºé™·3ï¼šç†è®ºåˆ†æä»…é™åˆå§‹é˜¶æ®µ</strong>
- <strong>é—®é¢˜</strong>ï¼šæœ¬æ–‡çš„åˆ†æåªé€‚ç”¨äºåˆå§‹åŒ–é˜¶æ®µï¼Œè®­ç»ƒåæœŸGAUçš„è¡Œä¸ºæœªçŸ¥
- <strong>ç†è®ºç©ºç™½</strong>ï¼šç¼ºä¹æ”¶æ•›æ€§ä¿è¯</p>
<h4 id="43">4.3 ä¼˜åŒ–æ–¹å‘</h4>
<p><strong>ä¼˜åŒ–1ï¼šè‡ªé€‚åº”é—¨æ§</strong>
- <strong>ç­–ç•¥</strong>ï¼šè®©é—¨æ§æƒé‡$\boldsymbol{A}$å¯å­¦ä¹ åœ°è°ƒæ•´å¯¹è§’å ä¼˜ç¨‹åº¦
- <strong>æ•ˆæœ</strong>ï¼šæ›´çµæ´»åœ°å¹³è¡¡å±€éƒ¨å’Œå…¨å±€ä¿¡æ¯</p>
<p><strong>ä¼˜åŒ–2ï¼šå¤šå°ºåº¦GAU</strong>
- <strong>ç­–ç•¥</strong>ï¼šä¸åŒå±‚ä½¿ç”¨ä¸åŒçš„$s$ï¼ˆAttentionç»´åº¦ï¼‰
- <strong>æ•ˆæœ</strong>ï¼šæµ…å±‚å…³æ³¨å±€éƒ¨ï¼Œæ·±å±‚å…³æ³¨å…¨å±€</p>
<hr />
<h3 id="5">ç¬¬5éƒ¨åˆ†ï¼šå­¦ä¹ è·¯çº¿å›¾ä¸æœªæ¥å±•æœ›</h3>
<h4 id="51">5.1 å­¦ä¹ è·¯çº¿</h4>
<p><strong>å‰ç½®çŸ¥è¯†</strong>ï¼š
1. TransformeråŸºç¡€
2. Layer Normalization
3. åˆå§‹åŒ–ç†è®ºï¼ˆXavierã€Heã€LeCunï¼‰
4. æ¿€æ´»å‡½æ•°çš„ç»Ÿè®¡æ€§è´¨</p>
<p><strong>æ¨èè®ºæ–‡</strong>ï¼š
1. Vaswani et al. (2017) - "Attention is All You Need"
2. Hua et al. (2022) - "Transformer Quality in Linear Time" (GAU/FLASH)
3. Zhang et al. (2019) - "Fixup Initialization"</p>
<h4 id="52">5.2 æœªæ¥ç ”ç©¶æ–¹å‘</h4>
<p><strong>æ–¹å‘1ï¼šç†è®ºå®Œå–„ - GAUçš„è¡¨è¾¾èƒ½åŠ›åˆ†æ</strong></p>
<p><strong>ç ”ç©¶é—®é¢˜</strong>ï¼š
1. GAUèƒ½é€¼è¿‘å“ªäº›å‡½æ•°ç±»ï¼Ÿä¸æ ‡å‡†Transformerçš„è¡¨è¾¾èƒ½åŠ›å·®å¼‚ï¼Ÿ
2. $\lambda^7$ç¼©æ”¾æ˜¯å¦æ˜¯æœ€ä¼˜çš„ï¼Ÿèƒ½å¦æ‰¾åˆ°æ›´å¥½çš„åˆå§‹åŒ–ç­–ç•¥ï¼Ÿ
3. è®­ç»ƒåæœŸGAUçš„Attentionæ¨¡å¼å¦‚ä½•æ¼”åŒ–ï¼Ÿ</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- å»ºç«‹GAUçš„VCç»´ç†è®ºç•Œ
- è¯æ˜GAUåœ¨æŸäº›ä»»åŠ¡ä¸Šä¸Transformerç­‰ä»·</p>
<p><strong>æ–¹å‘2ï¼šé•¿åºåˆ—æ‰©å±•</strong></p>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- GAUåœ¨è¶…é•¿åºåˆ—ï¼ˆ&gt;8Kï¼‰ä¸Šçš„è¡¨ç°æœªçŸ¥
- å¦‚ä½•ç»“åˆçº¿æ€§AttentionæŠ€æœ¯ï¼Ÿ</p>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- GAU + Flash Attentionèåˆ
- ç¨€ç–GAUï¼šåªè®¡ç®—Top-Kçš„Attention</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- åœ¨64Ké•¿åº¦ä¸Šä¿æŒçº¿æ€§å¤æ‚åº¦</p>
<p><strong>æ–¹å‘3ï¼šå¤šæ¨¡æ€GAU</strong></p>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š
- è§†è§‰Transformerï¼šViT-GAU
- å¤šæ¨¡æ€èåˆï¼šCLIP-GAU</p>
<hr />
        </div>
    </div>
</body>
</html>