<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåå…­ï¼‰ï¼šWè·ç¦» â‰¤ å¾—åˆ†åŒ¹é…</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåå…­ï¼‰ï¼šWè·ç¦» â‰¤ å¾—åˆ†åŒ¹é…</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 63.1 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9467">https://spaces.ac.cn/archives/9467</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>Wassersteinè·ç¦»ï¼ˆä¸‹é¢ç®€ç§°â€œWè·ç¦»â€ï¼‰ï¼Œæ˜¯åŸºäºæœ€ä¼˜ä¼ è¾“æ€æƒ³æ¥åº¦é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒå·®å¼‚ç¨‹åº¦çš„è·ç¦»å‡½æ•°ï¼Œç¬”è€…ä¹‹å‰åœ¨<a href="/archives/6280">ã€Šä»Wassersteinè·ç¦»ã€å¯¹å¶ç†è®ºåˆ°WGANã€‹</a>ç­‰åšæ–‡ä¸­ä¹Ÿåšè¿‡ä»‹ç»ã€‚å¯¹äºå¾ˆå¤šè¯»è€…æ¥è¯´ï¼Œç¬¬ä¸€æ¬¡å¬è¯´Wè·ç¦»ï¼Œæ˜¯å› ä¸º2017å¹´å‡ºä¸–çš„<a href="https://papers.cool/arxiv/1701.07875">WGAN</a>ï¼Œå®ƒå¼€åˆ›äº†ä»æœ€ä¼˜ä¼ è¾“è§†è§’æ¥ç†è§£GANçš„æ–°åˆ†æ”¯ï¼Œä¹Ÿæé«˜äº†æœ€ä¼˜ä¼ è¾“ç†è®ºåœ¨æœºå™¨å­¦ä¹ ä¸­çš„åœ°ä½ã€‚å¾ˆé•¿ä¸€æ®µæ—¶é—´ä»¥æ¥ï¼Œ<a href="https://papers.cool/arxiv/1406.2661">GAN</a>éƒ½æ˜¯ç”Ÿæˆæ¨¡å‹é¢†åŸŸçš„â€œä¸»åŠ›å†›â€ï¼Œç›´åˆ°æœ€è¿‘è¿™ä¸¤å¹´æ‰©æ•£æ¨¡å‹å¼‚å†›çªèµ·ï¼ŒGANçš„é£å¤´æ‰æœ‰æ‰€ä¸‹é™ï¼Œä½†å…¶æœ¬èº«ä»ä¸å¤±ä¸ºä¸€ä¸ªå¼ºå¤§çš„ç”Ÿæˆæ¨¡å‹ã€‚</p>
<p>ä»å½¢å¼ä¸Šæ¥çœ‹ï¼Œæ‰©æ•£æ¨¡å‹å’ŒGANå·®å¼‚å¾ˆæ˜æ˜¾ï¼Œæ‰€ä»¥å…¶ç ”ç©¶ä¸€ç›´éƒ½ç›¸å¯¹ç‹¬ç«‹ã€‚ä¸è¿‡ï¼Œå»å¹´åº•çš„ä¸€ç¯‡è®ºæ–‡<a href="https://papers.cool/arxiv/2212.06359">ã€ŠScore-based Generative Modeling Secretly Minimizes the Wasserstein Distanceã€‹</a>æ‰“ç ´äº†è¿™ä¸ªéš”é˜‚ï¼šå®ƒè¯æ˜äº†æ‰©æ•£æ¨¡å‹çš„å¾—åˆ†åŒ¹é…æŸå¤±å¯ä»¥å†™æˆWè·ç¦»çš„ä¸Šç•Œå½¢å¼ã€‚è¿™æ„å‘³ç€åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œæœ€å°åŒ–æ‰©æ•£æ¨¡å‹çš„æŸå¤±å‡½æ•°ï¼Œå®åˆ™è·ŸWGANä¸€æ ·ï¼Œéƒ½æ˜¯åœ¨æœ€å°åŒ–ä¸¤ä¸ªåˆ†å¸ƒçš„Wè·ç¦»ã€‚</p>
<h2 id="_1">ç»“è®ºåˆ†æ</h2>
<p>å…·ä½“æ¥è¯´ï¼ŒåŸè®ºæ–‡çš„ç»“æœï¼Œæ˜¯é’ˆå¯¹<a href="/archives/9209">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäº”ï¼‰ï¼šä¸€èˆ¬æ¡†æ¶ä¹‹SDEç¯‡ã€‹</a>ä¸­ä»‹ç»çš„SDEå¼æ‰©æ•£æ¨¡å‹çš„ï¼Œå…¶æ ¸å¿ƒç»“è®ºæ˜¯ä¸ç­‰å¼ï¼ˆå…¶ä¸­$I_t$æ˜¯$t$çš„éè´Ÿå‡½æ•°ï¼Œå…·ä½“å«ä¹‰æˆ‘ä»¬åæ¥å†è¯¦ç»†ä»‹ç»ï¼‰<br />
\begin{equation}\mathcal{W}<em _boldsymbol_x="\boldsymbol{x">2[p_0,q_0]\leq \int_0^T g_t^2 I_t \left(\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p_t(\boldsymbol{x}_t)}\left[\left\Vert\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p(\boldsymbol{x}_t) - \boldsymbol{s}</em>}}(\boldsymbol{x}_t,t)\right\Vert^2\right]\right)^{1/2}dt + I_T \mathcal{W}_2[p_T,q_T]\label{eq:w-neq}\end{equation<br />
é‚£ä¹ˆæ€æ ·ç†è§£è¿™ä¸ªä¸ç­‰å¼å‘¢ï¼Ÿé¦–å…ˆï¼Œæ‰©æ•£æ¨¡å‹å¯ä»¥ç†è§£ä¸ºSDEä»$t=T$åˆ°$t=0$çš„ä¸€ä¸ªè¿åŠ¨è¿‡ç¨‹ï¼Œæœ€å³è¾¹çš„$p_T,q_T$æ˜¯$T$æ—¶åˆ»çš„éšæœºé‡‡æ ·åˆ†å¸ƒï¼Œ$p_T$é€šå¸¸å°±æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒï¼Œè€Œå®é™…åº”ç”¨ä¸­ä¸€èˆ¬éƒ½æœ‰$q_T = p_T$ï¼Œæ‰€ä»¥$\mathcal{W}_2[p_T,q_T]=0$ï¼ŒåŸè®ºæ–‡ä¹‹æ‰€ä»¥æ˜¾å¼å†™å‡ºå®ƒï¼Œåªæ˜¯ä¸ºäº†ä»ç†è®ºä¸Šç»™å‡ºæœ€ä¸€èˆ¬çš„ç»“æœã€‚</p>
<p>æ¥ç€ï¼Œå·¦è¾¹çš„$p_0$ï¼Œæ˜¯ä»$p_T$é‡‡æ ·çš„éšæœºç‚¹å‡ºå‘ï¼Œç»åå‘SDE<br />
\begin{equation}d\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t = \left[\boldsymbol{f}_t(\boldsymbol{x}_t) - g_t^2\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p_t(\boldsymbol{x}_t) \right] dt + g_t d\boldsymbol{w}\label{eq:reverse-sde}\end{equation}<br />
æ±‚è§£å¾—åˆ°çš„$t=0$æ—¶åˆ»çš„å€¼çš„åˆ†å¸ƒï¼Œå®ƒå®é™…ä¸Šå°±æ˜¯è¦ç”Ÿæˆçš„æ•°æ®åˆ†å¸ƒï¼›è€Œ$q_0$ï¼Œåˆ™æ˜¯ä»$q_T$é‡‡æ ·çš„éšæœºç‚¹å‡ºå‘ï¼Œç»è¿‡SDE<br />
\begin{equation}d\boldsymbol{x}_t = \left[\boldsymbol{f}_t(\boldsymbol{x}_t) - g_t^2\boldsymbol{s}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t,t) \right] dt + g_t d\boldsymbol{w}\end{equation}<br />
æ±‚è§£å¾—åˆ°çš„$t=0$æ—¶åˆ»çš„å€¼çš„åˆ†å¸ƒï¼Œå…¶ä¸­$\boldsymbol{s}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t,t)$æ˜¯$\nabla</em>_2[p_0,q_0]$çš„å«ä¹‰å°±æ˜¯æ•°æ®åˆ†å¸ƒä¸ç”Ÿæˆåˆ†å¸ƒçš„Wè·ç¦»ã€‚}_t}\log p_t(\boldsymbol{x}_t)$çš„ç¥ç»ç½‘ç»œè¿‘ä¼¼ï¼Œæ‰€ä»¥$q_0$å®é™…å°±æ˜¯æ‰©æ•£æ¨¡å‹ç”Ÿæˆçš„æ•°æ®åˆ†å¸ƒã€‚å› æ­¤ï¼Œ$\mathcal{W</p>
<p>æœ€åï¼Œå‰©ä¸‹çš„ç§¯åˆ†é¡¹ï¼Œå…¶å…³é”®éƒ¨åˆ†æ˜¯<br />
\begin{equation}\mathbb{E}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{x}_t\sim p_t(\boldsymbol{x}_t)}\left[\left\Vert\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p(\boldsymbol{x}_t) - \boldsymbol{s}</em>}}(\boldsymbol{x}_t,t)\right\Vert^2\right]\label{eq:sm}\end{equation<br />
è¿™ä¹Ÿæ­£å¥½æ˜¯æ‰©æ•£æ¨¡å‹çš„â€œå¾—åˆ†åŒ¹é…â€æŸå¤±ã€‚æ‰€ä»¥ï¼Œå½“æˆ‘ä»¬ç”¨å¾—åˆ†åŒ¹é…æŸå¤±å»è®­ç»ƒæ‰©æ•£æ¨¡å‹çš„æ—¶å€™ï¼Œå…¶å®ä¹Ÿé—´æ¥åœ°æœ€å°åŒ–äº†æ•°æ®åˆ†å¸ƒä¸ç”Ÿæˆåˆ†å¸ƒçš„Wè·ç¦»ã€‚è·ŸWGANä¸åŒçš„æ˜¯ï¼ŒWGANä¼˜åŒ–çš„Wè·ç¦»æ˜¯$\mathcal{W}_1[p_0,q_0]$è€Œè¿™é‡Œæ˜¯$\mathcal{W}_2[p_0,q_0]$ã€‚</p>
<blockquote>
<p><strong>æ³¨ï¼š</strong> å‡†ç¡®æ¥è¯´ï¼Œå¼$\eqref{eq:sm}$è¿˜ä¸æ˜¯æ‰©æ•£æ¨¡å‹çš„æŸå¤±å‡½æ•°ï¼Œæ‰©æ•£æ¨¡å‹çš„æŸå¤±å‡½æ•°åº”è¯¥æ˜¯â€œæ¡ä»¶å¾—åˆ†åŒ¹é…â€ï¼Œå®ƒè·Ÿå¾—åˆ†åŒ¹é…çš„å…³ç³»æ˜¯ï¼š<br />
 \begin{equation}\begin{aligned}<br />
 &amp;\,\mathbb{E}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{x}_t\sim p_t(\boldsymbol{x}_t)}\left[\left\Vert\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p_t(\boldsymbol{x}_t) - \boldsymbol{s}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t,t)\right\Vert^2\right] \\\<br />
 =&amp;\,\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p_t(\boldsymbol{x}_t)}\left[\left\Vert\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim p_t(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)\right] - \boldsymbol{s}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t,t)\right\Vert^2\right] \\\<br />
 \leq &amp;\,\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p_t(\boldsymbol{x}_t)}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim p_t(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left\Vert\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x}_0) - \boldsymbol{s}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t,t)\right\Vert^2\right] \\\<br />
 = &amp;\,\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_t\sim p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)}\left[\left\Vert\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x}_0) - \boldsymbol{s}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t,t)\right\Vert^2\right] \\\<br />
 \end{aligned}\end{equation}<br />
 æœ€åçš„ç»“æœæ‰æ˜¯æ‰©æ•£æ¨¡å‹çš„æŸå¤±å‡½æ•°â€œæ¡ä»¶å¾—åˆ†åŒ¹é…â€ã€‚ç¬¬ä¸€ä¸ªç­‰å·æ˜¯å› ä¸ºæ’ç­‰å¼$\nabla</em><em _boldsymbol_x="\boldsymbol{x">t}\log p_t(\boldsymbol{x}_t)=\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim p_t(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\nabla</em>_0)\right]$ï¼Œç¬¬äºŒä¸ªä¸ç­‰å·åˆ™æ˜¯å› ä¸ºå¹³æ–¹å¹³å‡ä¸ç­‰å¼çš„æ¨å¹¿æˆ–è€…è©¹æ£®ä¸ç­‰å¼ï¼Œç¬¬ä¸‰ä¸ªç­‰å·åˆ™æ˜¯è´å¶æ–¯å…¬å¼äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¡ä»¶å¾—åˆ†åŒ¹é…æ˜¯å¾—åˆ†åŒ¹é…çš„ä¸Šç•Œï¼Œæ‰€ä»¥ä¹Ÿæ˜¯Wè·ç¦»çš„ä¸Šç•Œã€‚}_t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x</p>
</blockquote>
<p>ä»å¼$\eqref{eq:w-neq}$ä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥ç®€å•ç†è§£ä¸ºä»€ä¹ˆæ‰©æ•£æ¨¡å‹çš„ç›®æ ‡å‡½æ•°è¦èˆå»æ¨¡é•¿å‰é¢çš„ç³»æ•°äº†ï¼Œå› ä¸ºWè·ç¦»æ˜¯æ¦‚ç‡åˆ†å¸ƒçš„è‰¯å¥½åº¦é‡ï¼Œè€Œå¼$\eqref{eq:w-neq}$å³ç«¯çš„$g_t^2 I_t$æ˜¯å…³äº$t$çš„å•è°ƒé€’å¢å‡½æ•°ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬è¦é€‚å½“åŠ å¤§å½“$t$è¾ƒå°æ—¶çš„å¾—åˆ†åŒ¹é…æŸå¤±ã€‚è€Œåœ¨<a href="/archives/9209">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäº”ï¼‰ï¼šä¸€èˆ¬æ¡†æ¶ä¹‹SDEç¯‡ã€‹</a>æˆ‘ä»¬æ¨å¯¼è¿‡å¾—åˆ°åŒ¹é…çš„æœ€ç»ˆå½¢å¼ä¸ºï¼š<br />
\begin{equation}\frac{1}{\bar{\beta}<em _boldsymbol_x="\boldsymbol{x">t^2}\mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim \tilde{p}(\boldsymbol{x}_0),\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I})}\left[\left\Vert \boldsymbol{\epsilon}</em>}}(\bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}, t) - \boldsymbol{\varepsilon}\right\Vert^2\right]\end{equation<br />
èˆå»ç³»æ•°$\frac{1}{\bar{\beta}_t^2}$ç­‰ä»·äºä¹˜ä»¥$\bar{\beta}_t^2$ï¼Œè€Œ$\bar{\beta}_t^2$ä¹Ÿæ˜¯$t$çš„å•è°ƒé€’å¢å‡½æ•°ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥ç®€å•åœ°è®¤ä¸ºèˆå»ç³»æ•°æ˜¯è®©è®­ç»ƒç›®æ ‡æ›´åŠ æ¥è¿‘ä¸¤ä¸ªåˆ†å¸ƒçš„Wè·ç¦»ã€‚</p>
<h2 id="_2">å‡†å¤‡å·¥ä½œ</h2>
<p>å°½ç®¡åŸè®ºæ–‡ç»™å‡ºäº†ä¸ç­‰å¼$\eqref{eq:w-neq}$çš„è¯æ˜è¿‡ç¨‹ï¼Œä½†æ¶‰åŠåˆ°è¾ƒå¤šçš„æœ€ä¼˜ä¼ è¾“ç›¸å…³çŸ¥è¯†ï¼Œå¦‚è¿ç»­æ€§æ–¹ç¨‹ã€æ¢¯åº¦æµç­‰ï¼Œç‰¹åˆ«æ˜¯å®ƒä¸åŠ è¯æ˜å¼•ç”¨çš„ä¸€ä¸ªå®šç†ï¼Œè¿˜æ˜¯æ”¾åœ¨ä¸€æœ¬æ¢¯åº¦æµä¸“è‘—çš„ç¬¬8ç« æˆ–å¦ä¸€æœ¬æœ€ä¼˜ä¼ è¾“ä¸“è‘—çš„ç¬¬5ç« ï¼Œè¿™å¯¹ç¬”è€…æ¥è¯´é˜…è¯»éš¾åº¦å®åœ¨å¤ªå¤§ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„å°è¯•ï¼Œç¬”è€…ç»ˆäºåœ¨ä¸Šå‘¨ç¬”è€…å®Œæˆäº†è‡ªå·±å…³äºä¸ç­‰å¼$\eqref{eq:w-neq}$çš„ï¼ˆä¸€éƒ¨åˆ†ï¼‰è¯æ˜ï¼Œå…¶ä¸­åªéœ€è¦ç”¨åˆ°Wè·ç¦»çš„å®šä¹‰ã€å¾®åˆ†æ–¹ç¨‹åŸºç¡€ä»¥åŠæŸ¯è¥¿ä¸ç­‰å¼ï¼Œç›¸æ¯”åŸè®ºæ–‡çš„è¯æ˜ç†è§£éš¾åº¦åº”è¯¥æ˜¯æ˜æ˜¾é™ä½äº†ã€‚ç»è¿‡å‡ å¤©çš„ä¿®æ”¹å®Œå–„ï¼Œç»™å‡ºå¦‚ä¸‹çš„è¯æ˜è¿‡ç¨‹ã€‚</p>
<p>åœ¨å¼€å§‹è¯æ˜ä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆåšä¸€ä¸‹å‡†å¤‡ï¼Œå…ˆæ•´ç†ä¸€ä¸‹æ¥ä¸‹æ¥ä¼šç”¨åˆ°çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µå’Œç»“è®ºã€‚é¦–å…ˆæ˜¯Wè·ç¦»ï¼Œå®ƒå®šä¹‰ä¸º<br />
\begin{equation}\mathcal{W}<em _Pi_p_q_="\Pi[p,q]" _gamma_in="\gamma\in">{\rho}[p,q]=\left(\inf</em>} \iint \gamma(\boldsymbol{x},\boldsymbol{y}) \Vert\boldsymbol{x} - \boldsymbol{y}\Vert^{\rho} d\boldsymbol{x}d\boldsymbol{y}\right)^{1/\rho}\end{equation<br />
å…¶ä¸­$\Pi[p,q]$æ˜¯æŒ‡æ‰€æœ‰ä»¥$p,q$ä¸ºè¾¹ç¼˜åˆ†å¸ƒçš„è”åˆæ¦‚ç‡å¯†åº¦å‡½æ•°ï¼Œå®ƒæè¿°äº†å…·ä½“çš„ä¼ è¾“æ–¹æ¡ˆã€‚æœ¬æ–‡åªè€ƒè™‘$\rho=2$ï¼Œå› ä¸ºåªæœ‰è¿™ç§æƒ…å½¢æ–¹ä¾¿åç»­æ¨å¯¼ã€‚æ³¨æ„åˆ°Wè·ç¦»çš„å®šä¹‰åŒ…å«äº†ä¸‹ç¡®ç•Œè¿ç®—$\inf$ï¼Œè¿™å°±æ„å‘³ç€å¯¹äºä»»æ„æˆ‘ä»¬èƒ½å†™å‡ºçš„$\gamma\in \Pi[p,q]$ï¼Œéƒ½æœ‰<br />
\begin{equation}\mathcal{W}<em _boldsymbol_x="\boldsymbol{x">2[p,q]\leq\left(\iint \gamma(\boldsymbol{x},\boldsymbol{y}) \Vert\boldsymbol{x} - \boldsymbol{y}\Vert^{2} d\boldsymbol{x}d\boldsymbol{y}\right)^{1/2}\label{eq:core-neq}\end{equation}<br />
è¿™æ˜¯ç¬”è€…æ‰€ç»™è¯æ˜çš„æ ¸å¿ƒæ€æƒ³ã€‚è¯æ˜è¿‡ç¨‹çš„æ”¾ç¼©ï¼Œä¸»è¦ç”¨åˆ°æŸ¯è¥¿ä¸ç­‰å¼ï¼š<br />
\begin{equation}\begin{aligned}<br />
&amp;\text{å‘é‡ç‰ˆï¼š}\quad\boldsymbol{x}\cdot\boldsymbol{y}\leq \Vert \boldsymbol{x}\Vert \Vert\boldsymbol{y}\Vert\\\<br />
&amp;\text{æœŸæœ›ç‰ˆï¼š}\quad\mathbb{E}</em>}}\left[f(\boldsymbol{x})g(\boldsymbol{x})\right]\leq \left(\mathbb{E<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{x}}\left[f^2(\boldsymbol{x})\right]\right)^{1/2}\left(\mathbb{E}</em>}}\left[g^2(\boldsymbol{x})\right]\right)^{1/2<br />
\end{aligned}\end{equation}<br />
è¯æ˜è¿‡ç¨‹ä¸­æˆ‘ä»¬ä¼šå‡è®¾å‡½æ•°$\boldsymbol{g}_t(\boldsymbol{x})$æ»¡è¶³â€œå•ä¾§Lipschitzçº¦æŸâ€ï¼Œå…¶å®šä¹‰ä¸º<br />
\begin{equation}(\boldsymbol{g}_t(\boldsymbol{x}) - \boldsymbol{g}_t(\boldsymbol{y}))\cdot(\boldsymbol{x} - \boldsymbol{y}) \leq L_t \Vert \boldsymbol{x} - \boldsymbol{y}\Vert^2\label{eq:assum}\end{equation}<br />
å¯ä»¥è¯æ˜å®ƒæ¯”å¸¸è§çš„Lipschitzçº¦æŸï¼ˆå‚è€ƒ<a href="/archives/6051">ã€Šæ·±åº¦å­¦ä¹ ä¸­çš„Lipschitzçº¦æŸï¼šæ³›åŒ–ä¸ç”Ÿæˆæ¨¡å‹ã€‹</a>ï¼‰æ›´å¼±ï¼Œå³å¦‚æœå‡½æ•°$\boldsymbol{g}_t(\boldsymbol{x})$æ»¡è¶³Lipschitzçº¦æŸï¼Œé‚£ä¹ˆå®ƒä¸€å®šæ»¡è¶³å•ä¾§Lipschitzçº¦æŸã€‚</p>
<h2 id="_3">ç‰›åˆ€å°è¯•</h2>
<p>ä¸ç­‰å¼$\eqref{eq:w-neq}$è¿‡äºä¸€èˆ¬äº†ï¼Œä¸€ä¸Šæ¥å°±è¯•å›¾åˆ†æä¸€èˆ¬åŒ–çš„ç»“æœå¹¶ä¸åˆ©äºæˆ‘ä»¬çš„æ€è€ƒå’Œç†è§£ã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬å…ˆå°†é—®é¢˜ç®€åŒ–ä¸€ä¸‹ï¼Œçœ‹èƒ½ä¸èƒ½å…ˆè¯æ˜ä¸€ä¸ªç¨å¼±ä¸€äº›çš„ç»“æœã€‚æ€ä¹ˆç®€åŒ–å‘¢ï¼Ÿé¦–å…ˆï¼Œä¸ç­‰å¼$\eqref{eq:w-neq}$è€ƒè™‘äº†åˆå§‹åˆ†å¸ƒï¼ˆæç¤ºï¼Œæ‰©æ•£æ¨¡å‹æ˜¯$t=T$åˆ°$t=0$çš„æ¼”åŒ–è¿‡ç¨‹ï¼Œæ‰€ä»¥$t=T$æ˜¯åˆå§‹æ—¶åˆ»ï¼Œ$t=0$æ˜¯ç»ˆæ­¢æ—¶åˆ»ï¼‰çš„å·®å¼‚ï¼Œè€Œè¿™é‡Œæˆ‘ä»¬å…ˆè€ƒè™‘ç›¸åŒåˆå§‹åˆ†å¸ƒï¼›æ­¤å¤–ï¼ŒåŸæœ¬çš„åå‘æ–¹ç¨‹$\eqref{eq:reverse-sde}$æ˜¯ä¸€ä¸ªSDEï¼Œè¿™é‡Œå…ˆè€ƒè™‘ç¡®å®šæ€§çš„ODEã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬è€ƒè™‘ä»åŒä¸€ä¸ªåˆ†å¸ƒ$q(\boldsymbol{z})$å‡ºå‘é‡‡æ ·$\boldsymbol{z}$ä½œä¸º$T$æ—¶åˆ»çš„åˆå§‹å€¼ï¼Œç„¶ååˆ†åˆ«æ²¿ç€ä¸¤ä¸ªä¸åŒçš„ODE<br />
\begin{equation}\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{f}_t(\boldsymbol{x}_t),\quad \frac{d\boldsymbol{y}_t}{dt} = \boldsymbol{g}_t(\boldsymbol{y}_t)\end{equation}<br />
è¿›è¡Œæ¼”åŒ–ï¼Œè®¾$t$æ—¶åˆ»$\boldsymbol{x}_t$çš„åˆ†å¸ƒä¸º$p_t$ã€$\boldsymbol{y}_t$çš„åˆ†å¸ƒä¸º$q_t$ï¼Œæˆ‘ä»¬å°è¯•å»ä¼°è®¡$\mathcal{W}_2[p_0,q_0]$çš„ä¸€ä¸ªä¸Šç•Œã€‚</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œ$\boldsymbol{x}_t,\boldsymbol{y}_t$éƒ½æ˜¯ä»¥$\boldsymbol{z}$ä¸ºåˆå§‹å€¼é€šè¿‡å„è‡ªçš„ODEæ¼”åŒ–è€Œæ¥ï¼Œæ‰€ä»¥å®ƒä»¬å…¶å®éƒ½æ˜¯$\boldsymbol{z}$çš„ç¡®å®šæ€§å‡½æ•°ï¼Œæ›´å‡†ç¡®çš„è®°å·åº”è¯¥æ˜¯$\boldsymbol{x}_t(\boldsymbol{z}),\boldsymbol{y}_t(\boldsymbol{z})$ï¼Œç®€å•èµ·è§æˆ‘ä»¬æ‰ç•¥å»äº†$\boldsymbol{z}$ã€‚è¿™å°±æ„å‘³ç€å¯¹åº”äºåŒä¸€ä¸ª$\boldsymbol{x}$çš„$\boldsymbol{x}_t\leftrightarrow \boldsymbol{y}_t$æ„æˆäº†$p_t,q_t$çš„æ ·æœ¬ä¹‹é—´çš„ä¸€ä¸ªå¯¹åº”å…³ç³»ï¼ˆä¼ è¾“æ–¹æ¡ˆï¼‰ï¼Œå¦‚ä¸‹å›¾ï¼ˆè¿™ä¸ªå›¾ä¸å¤§å¥½ç”»ï¼Œå°±éšä¾¿æ‰‹ç”»äº†ä¸€ä¸‹ï¼‰ï¼š  </p>
<p><a href="/usr/uploads/2023/02/1814162448.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="è¿‘ä¼¼æœ€ä¼˜ä¼ è¾“æ–¹æ¡ˆç¤ºæ„å›¾" src="/usr/uploads/2023/02/1814162448.png" /></a></p>
<p>è¿‘ä¼¼æœ€ä¼˜ä¼ è¾“æ–¹æ¡ˆç¤ºæ„å›¾</p>
<p>äºæ˜¯æ ¹æ®å¼$\eqref{eq:core-neq}$ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡º<br />
\begin{equation}\mathcal{W}<em _boldsymbol_z="\boldsymbol{z">2^2[p_t,q_t]\leq \mathbb{E}</em>}}\left[\Vert\boldsymbol{x}_t - \boldsymbol{y}_t\Vert^{2} \right]\triangleq \tilde{\mathcal{W}}_2^2[p_t,q_t]\label{eq:core-neq-2}\end{equation<br />
ä¸‹é¢æˆ‘ä»¬å¯¹$\tilde{\mathcal{W}}_2^2[p_t,q_t]$è¿›è¡Œæ”¾ç¼©ã€‚ä¸ºäº†å°†å®ƒè·Ÿ$\boldsymbol{f}_t(\boldsymbol{x}_t),\boldsymbol{g}_t(\boldsymbol{y}_t)$è”ç³»èµ·æ¥ï¼Œæˆ‘ä»¬å¯¹å®ƒæ±‚å¯¼ï¼š</p>
<p>\begin{equation}\begin{aligned}<br />
\pm\frac{d\left(\tilde{\mathcal{W}}<em _boldsymbol_z="\boldsymbol{z">2^2[p_t,q_t]\right)}{dt}=&amp;\, \pm2\mathbb{E}</em>}}\left[(\boldsymbol{x<em _boldsymbol_z="\boldsymbol{z">t - \boldsymbol{y}_t)\cdot \left(\frac{d\boldsymbol{x}_t}{dt} - \frac{d\boldsymbol{y}_t}{dt}\right)\right] \\\[5pt]<br />
=&amp;\, \pm 2\mathbb{E}</em>}}\left[(\boldsymbol{x<em _boldsymbol_z="\boldsymbol{z">t - \boldsymbol{y}_t)\cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t))\right] \\\[5pt]<br />
=&amp;\, \pm 2\mathbb{E}</em>}}\left[(\boldsymbol{x<em _boldsymbol_z="\boldsymbol{z">t - \boldsymbol{y}_t)\cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t))\right] \pm 2\mathbb{E}</em>}}\left[(\boldsymbol{x<em _boldsymbol_z="\boldsymbol{z">t - \boldsymbol{y}_t)\cdot (\boldsymbol{g}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t))\right] \\\[5pt]<br />
\leq&amp;\, 2\mathbb{E}</em>}}\left[\Vert\boldsymbol{x<em _boldsymbol_z="\boldsymbol{z">t - \boldsymbol{y}_t\Vert \Vert\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\Vert\right] + 2\mathbb{E}</em>}}\left[L_t\Vert\boldsymbol{x<em _boldsymbol_z="\boldsymbol{z">t - \boldsymbol{y}_t\Vert^2\right] \\\[5pt]<br />
\leq&amp;\, 2\left(\mathbb{E}</em>}}\left[\Vert\boldsymbol{x<em _boldsymbol_z="\boldsymbol{z">t - \boldsymbol{y}_t\Vert^2\right]\right)^{1/2} \left(\mathbb{E}</em>}}\left[\Vert\boldsymbol{f<em _boldsymbol_z="\boldsymbol{z">t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\Vert^2\right]\right)^{1/2} + 2L_t\mathbb{E}</em>}}\left[\Vert\boldsymbol{x<em _boldsymbol_z="\boldsymbol{z">t - \boldsymbol{y}_t\Vert^2\right] \\\[5pt]<br />
=&amp;\, 2 \tilde{\mathcal{W}}_2[p_t,q_t] \left(\mathbb{E}</em>_2^2[p_t,q_t] \\\[5pt]}}\left[\Vert\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\Vert^2\right]\right)^{1/2} + 2L_t\tilde{\mathcal{W}<br />
\end{aligned}\label{eq:der-neq-0}\end{equation}</p>
<p>å…¶ä¸­ç¬¬ä¸€ä¸ªä¸ç­‰å·ç”¨åˆ°äº†æŸ¯è¥¿ä¸ç­‰å¼çš„å‘é‡ç‰ˆï¼Œä»¥åŠå•ä¾§Lipschitzçº¦æŸå‡è®¾$\eqref{eq:assum}$ï¼Œç¬¬äºŒä¸ªä¸ç­‰å·åˆ™ç”¨åˆ°äº†æŸ¯è¥¿ä¸ç­‰å¼çš„æœŸæœ›ç‰ˆï¼Œ$\pm$çš„æ„æ€æ˜¯æœ€ç»ˆå¾—åˆ°çš„ä¸ç­‰å…³ç³»ï¼Œä¸ç®¡å–$+$è¿˜æ˜¯$-$éƒ½æ˜¯æˆç«‹çš„ï¼Œä¸‹é¢çš„æ¨å¯¼åªç”¨åˆ°äº†$-$è¿™ä¸€ä¾§ã€‚ç»“åˆ$\left(w^2\right)'=2ww'$ï¼Œæˆ‘ä»¬å¾—åˆ°<br />
\begin{equation}-\frac{d\tilde{\mathcal{W}}<em _boldsymbol_z="\boldsymbol{z">2[p_t,q_t]}{dt} \leq \left(\mathbb{E}</em>}}\left[\Vert\boldsymbol{f<em _boldsymbol_z="\boldsymbol{z">t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\Vert^2\right]\right)^{1/2} + L_t\tilde{\mathcal{W}}_2[p_t,q_t] \label{eq:der-neq-1}\end{equation}<br />
ç”¨å¸¸æ•°å˜æ˜“æ³•ï¼Œè®¾$\tilde{\mathcal{W}}_2[p_t,q_t]=C_t \exp\left(\int_t^T L_s ds\right)$ï¼Œä»£å…¥ä¸Šå¼å¾—åˆ°<br />
\begin{equation}-\frac{dC_t}{dt} \leq \exp\left(-\int_t^T L_s ds\right)\left(\mathbb{E}</em>}}\left[\Vert\boldsymbol{f<em _boldsymbol_z="\boldsymbol{z">t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\Vert^2\right]\right)^{1/2}\label{eq:der-neq-2}\end{equation}<br />
ä¸¤è¾¹åœ¨$[0,T]$ç§¯åˆ†ï¼Œå¹¶ç»“åˆ$C_T=0$ï¼ˆåˆå§‹æ—¶åˆ»ä¸¤ä¸ªåˆ†å¸ƒç›¸ç­‰ï¼Œè·ç¦»ä¸º0ï¼‰ï¼Œå¾—åˆ°<br />
\begin{equation}C_0 \leq \int_0^T \exp\left(-\int_t^T L_s ds\right)\left(\mathbb{E}</em>}}\left[\Vert\boldsymbol{f<em _boldsymbol_z="\boldsymbol{z">t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\Vert^2\right]\right)^{1/2} dt\end{equation}<br />
äºæ˜¯<br />
\begin{equation}\tilde{\mathcal{W}}_2[p_0,q_0] \leq C_0 \exp\left(\int_0^T L_s ds\right) =\int_0^T I_t\left(\mathbb{E}</em>}}\left[\Vert\boldsymbol{f<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\Vert^2\right]\right)^{1/2} dt\end{equation}<br />
å…¶ä¸­$I_t = \exp\left(\int_0^t L_s ds\right)$ã€‚æ ¹æ®å¼$\eqref{eq:core-neq-2}$ï¼Œè¿™ä¹Ÿæ˜¯$\mathcal{W}_2[p_0,q_0]$çš„ä¸Šç•Œã€‚æœ€åï¼Œç”±äºæ±‚æœŸæœ›çš„å¼å­åªæ˜¯$\boldsymbol{x}_t$çš„å‡½æ•°ï¼Œ$\boldsymbol{x}_t$åˆæ˜¯$\boldsymbol{z}$çš„ç¡®å®šæ€§å‡½æ•°ï¼Œå¯¹äºå®ƒå…³äº$\boldsymbol{z}$çš„æœŸæœ›ç­‰ä»·äºç›´æ¥å…³äº$\boldsymbol{x}_t$çš„æœŸæœ›ï¼Œäºæ˜¯ï¼š<br />
\begin{equation}\mathcal{W}_2[p_0,q_0] \leq\int_0^T I_t\left(\mathbb{E}</em>}_t\sim p_t(\boldsymbol{x}_t)}\left[\Vert\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\Vert^2\right]\right)^{1/2} dt\label{eq:w-neq-0}\end{equation</p>
<h2 id="_4">ä¸€é¼“ä½œæ°”</h2>
<p>å®é™…ä¸Šï¼Œç®€åŒ–ç‰ˆçš„ä¸ç­‰å¼$\eqref{eq:w-neq-0}$å·²ç»å’Œæ›´ä¸€èˆ¬çš„$\eqref{eq:w-neq}$æ²¡æœ‰æœ¬è´¨åŒºåˆ«äº†ï¼Œå®ƒçš„æ¨å¯¼è¿‡ç¨‹å·²ç»åŒ…å«äº†å¯¼å‡ºå®Œæ•´ç»“æœçš„ä¸€èˆ¬æ€è·¯ï¼Œä¸‹é¢æˆ‘ä»¬æ¥å®Œæˆå‰©ä½™çš„æ¨å¯¼è¿‡ç¨‹ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å°†å¼$\eqref{eq:w-neq-0}$æ¨å¹¿åˆ°ä¸åŒåˆå§‹åˆ†å¸ƒçš„åœºæ™¯ï¼Œå‡è®¾ä¸¤ä¸ªåˆå§‹åˆ†å¸ƒä¸º$p_T(\boldsymbol{z}<em _boldsymbol_z="\boldsymbol{z">1),q_T(\boldsymbol{z}_2)$ï¼Œä»$p_T(\boldsymbol{z}_1)$é‡‡æ ·åˆå§‹å€¼æ¼”åŒ–$\boldsymbol{x}_t$ï¼Œä»$q_T(\boldsymbol{z}_2)$é‡‡æ ·åˆå§‹å€¼æ¼”åŒ–$\boldsymbol{y}_t$ï¼Œæ‰€ä»¥æ­¤æ—¶$\boldsymbol{x}_t,\boldsymbol{y}_t$åˆ†åˆ«æ˜¯$\boldsymbol{z}_1,\boldsymbol{z}_2$çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯åƒä¹‹å‰é‚£æ ·æ˜¯åŒä¸€ä¸ª$\boldsymbol{z}$çš„å‡½æ•°ï¼Œæ‰€ä»¥æ— æ³•ç›´æ¥æ„é€ ä¸€ä¸ªä¼ è¾“æ–¹æ¡ˆã€‚æ‰€ä»¥ï¼Œæˆ‘ä»¬è¿˜éœ€è¦$\boldsymbol{z}_1,\boldsymbol{z}_2$ä¹‹é—´çš„ä¸€ä¸ªå¯¹åº”å…³ç³»ï¼ˆä¼ è¾“æ–¹æ¡ˆï¼‰ï¼Œæˆ‘ä»¬å°†å®ƒé€‰æ‹©ä¸º$p_T(\boldsymbol{z}_1),q_T(\boldsymbol{z}_2)$ä¹‹é—´çš„ä¸€ä¸ªæœ€ä¼˜ä¼ è¾“æ–¹æ¡ˆ$\gamma^<em>(\boldsymbol{z}<em _boldsymbol_z="\boldsymbol{z">1,\boldsymbol{z}_2)$ã€‚äºæ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºç±»ä¼¼å¼$\eqref{eq:core-neq-2}$çš„ç»“æœï¼š<br />
\begin{equation}\mathcal{W}_2^2[p_t,q_t]\leq \mathbb{E}</em>_2\sim \gamma^}_1,\boldsymbol{z</em>(\boldsymbol{z}_1,\boldsymbol{z}_2)}\left[\Vert\boldsymbol{x}_t - \boldsymbol{y}_t\Vert^{2} \right]\triangleq \tilde{\mathcal{W}}_2^2[p_t,q_t]\label{eq:core-neq-3}\end{equation}<br />
ç”±äºå®šä¹‰çš„ä¸€è‡´æ€§ï¼Œé‚£ä¹ˆæ”¾ç¼©è¿‡ç¨‹$\eqref{eq:der-neq-0}$åŒæ ·æ˜¯æˆç«‹çš„ï¼Œåªä¸è¿‡æœŸæœ›$\mathbb{E}</em>}}$æ¢æˆäº†$\mathbb{E<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{z}_1,\boldsymbol{z}_2}$ï¼Œæ‰€ä»¥ä¸ç­‰å¼$\eqref{eq:der-neq-1}$ã€$\eqref{eq:der-neq-2}$ä¹Ÿæ˜¯æˆç«‹çš„ã€‚ä¸åŒçš„æ˜¯åœ¨å¯¹$\eqref{eq:der-neq-2}$ä¸¤ç«¯åœ¨$[0,T]$ç§¯åˆ†æ—¶ï¼Œä¸å†æœ‰$C_T = 0$ï¼Œè€Œæ˜¯æ ¹æ®å®šä¹‰æœ‰$C_T=\tilde{\mathcal{W}}_2[p_T,q_T]=\mathcal{W}_2[p_T,q_T]$ã€‚æ‰€ä»¥ï¼Œæœ€ç»ˆçš„ç»“æœæ˜¯<br />
\begin{equation}\mathcal{W}_2[p_0,q_0] \leq\int_0^T I_t\left(\mathbb{E}</em>}_t\sim p_t(\boldsymbol{x}_t)}\left[\Vert\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\Vert^2\right]\right)^{1/2} dt + I_T \mathcal{W}_2[p_T,q_T]\label{eq:w-neq-1}\end{equation</p>
<p>æœ€åï¼Œæˆ‘ä»¬å›åˆ°æ‰©æ•£æ¨¡å‹ã€‚åœ¨<a href="/archives/9228">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆå…­ï¼‰ï¼šä¸€èˆ¬æ¡†æ¶ä¹‹ODEç¯‡ã€‹</a>æˆ‘ä»¬å·²ç»æ¨å¯¼è¿‡ï¼ŒåŒä¸€ä¸ªå‰å‘æ‰©æ•£è¿‡ç¨‹ï¼Œå®é™…ä¸Šå¯¹åº”ä¸€ç°‡åå‘è¿‡ç¨‹ï¼š<br />
\begin{equation}d\boldsymbol{x} = \left(\boldsymbol{f}<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x}) - \frac{1}{2}(g_t^2 + \sigma_t^2)\nabla</em>}}\log p_t(\boldsymbol{x})\right) dt + \sigma_t d\boldsymbol{w}\label{eq:sde-reverse-2}\end{equation<br />
å…¶ä¸­$\sigma_t$æ˜¯å¯ä»¥è‡ªç”±é€‰æ‹©çš„æ ‡å‡†å·®å‡½æ•°ï¼Œå½“$\sigma_t=g_t$æ—¶ï¼Œé‚£ä¹ˆå°±æ˜¯æ–¹ç¨‹$\eqref{eq:reverse-sde}$ã€‚ç”±äºæˆ‘ä»¬ä¸Šé¢åˆ†æçš„æ˜¯ODEï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè€ƒè™‘$\sigma_t=0$çš„æƒ…å½¢ï¼Œæ­¤æ—¶ç»“æœ$\eqref{eq:w-neq-1}$ä¾ç„¶å¯ç”¨ï¼Œåªä¸è¿‡å°†$\boldsymbol{f}<em _boldsymbol_x="\boldsymbol{x">t(\boldsymbol{x}_t)$æ¢æˆ$\boldsymbol{f}_t(\boldsymbol{x}_t) - \frac{1}{2}g_t^2\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p_t(\boldsymbol{x}_t)$ã€å°†$\boldsymbol{g}_t(\boldsymbol{x}_t)$æ¢æˆ$\boldsymbol{f}_t(\boldsymbol{x}_t) - \frac{1}{2}g_t^2\boldsymbol{s}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t,t)$ï¼Œä»£å…¥å¼$\eqref{eq:w-neq-1}$åå°±å¾—åˆ°æ–‡ç« å¼€å¤´çš„ç»“è®º$\eqref{eq:w-neq}$äº†ã€‚å½“ç„¶åˆ«å¿˜äº†æˆ‘ä»¬æ¨å¯¼è¿‡ç¨‹ä¸­å¯¹$\boldsymbol{g}_t(\boldsymbol{x}_t)$æ‰€åšçš„å•ä¾§Lipschitzçº¦æŸå‡è®¾$\eqref{eq:assum}$ï¼Œç°åœ¨å¯ä»¥åˆ†åˆ«å¯¹$\boldsymbol{f}_t(\boldsymbol{x}_t)$ã€$\boldsymbol{s}</em>_t,t)$åšå‡ºå‡è®¾ï¼Œè¿™äº›ç»†èŠ‚å°±ä¸å±•å¼€äº†ã€‚}}(\boldsymbol{x</p>
<h2 id="_5">è‰°éš¾æ”¶å°¾</h2>
<p>æŒ‰ç…§æµç¨‹ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬åº”è¯¥å†æ¥å†å‰ï¼Œå®Œæˆ$\sigma_t\neq 0$çš„æ”¶å°¾è¯æ˜ã€‚ä¸è¿‡å¾ˆé—æ†¾ï¼Œæœ¬æ–‡çš„æ€è·¯ä¸èƒ½å®Œå…¨è¯æ˜SDEçš„æƒ…å½¢ï¼Œä¸‹é¢ç»™å‡ºç¬”è€…çš„åˆ†æè¿‡ç¨‹ã€‚äº‹å®ä¸Šï¼Œå¯¹äºå¤§éƒ¨åˆ†è¯»è€…æ¥è¯´ï¼Œäº†è§£åˆ°ä¸Šä¸€èŠ‚çš„ODEä¾‹å­å°±å¯ä»¥çª¥è§å¼$\eqref{eq:w-neq-1}$çš„ç²¾é«“äº†ï¼Œå®Œæ•´çš„ç»†èŠ‚ä¹Ÿä¸æ˜¯å¤ªé‡è¦ã€‚</p>
<p>ç®€å•èµ·è§ï¼Œä¸‹é¢æˆ‘ä»¬ä»¥$\eqref{eq:reverse-sde}$ä¸ºä¾‹ï¼Œæ›´ä¸€èˆ¬çš„$\eqref{eq:sde-reverse-2}$ä¹Ÿå¯ä»¥ç±»ä¼¼åœ°åˆ†æã€‚æˆ‘ä»¬éœ€è¦ä¼°ç®—çš„æ˜¯å¦‚ä¸‹ä¸¤ä¸ªSDEçš„æ¼”åŒ–è½¨è¿¹åˆ†å¸ƒå·®å¼‚ï¼š<br />
\begin{equation}\left\{\begin{aligned}<br />
d\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t =&amp;\, \left[\boldsymbol{f}_t(\boldsymbol{x}_t) - g_t^2\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p_t(\boldsymbol{x}_t) \right] dt + g_t d\boldsymbol{w}\\\[5pt]<br />
d\boldsymbol{y}_t =&amp;\, \left[\boldsymbol{f}_t(\boldsymbol{y}_t) - g_t^2\boldsymbol{s}</em>}}(\boldsymbol{y<em _boldsymbol_x="\boldsymbol{x">t,t) \right] dt + g_t d\boldsymbol{w}<br />
\end{aligned}\right.\end{equation}<br />
ä¹Ÿå°±æ˜¯å°†å‡†ç¡®çš„$\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p_t(\boldsymbol{x}_t)$æ¢æˆè¿‘ä¼¼çš„$\boldsymbol{s}</em>}}(\boldsymbol{y<em _boldsymbol_x="\boldsymbol{x">t,t)$ï¼Œå¯¹æœ€ç»ˆåˆ†å¸ƒçš„å½±å“æœ‰å¤šå¤§ã€‚ç¬”è€…çš„è¯æ˜æ€è·¯åŒæ ·æ˜¯å°†å®ƒè½¬åŒ–ä¸ºODEï¼Œç»§è€Œç”¨å›å‰é¢çš„è¯æ˜è¿‡ç¨‹ã€‚é¦–å…ˆï¼Œæ ¹æ®å¼$\eqref{eq:sde-reverse-2}$ï¼Œæˆ‘ä»¬çŸ¥é“ç¬¬ä¸€ä¸ªSDEå¯¹åº”çš„ODEä¸ºï¼š<br />
\begin{equation}<br />
d\boldsymbol{x}_t = \left[\boldsymbol{f}_t(\boldsymbol{x}_t) - g_t^2\nabla</em><em _boldsymbol_x="\boldsymbol{x">t}\log p_t(\boldsymbol{x}_t) \right] dt + g_t d\boldsymbol{w}\\\<br />
\Downarrow \\\<br />
d\boldsymbol{x}_t = \left[\boldsymbol{f}_t(\boldsymbol{x}_t) - \frac{1}{2}g_t^2\nabla</em><em _boldsymbol_y="\boldsymbol{y">t}\log p_t(\boldsymbol{x}_t) \right] dt<br />
\end{equation}<br />
è‡³äºç¬¬äºŒä¸ªSDEå¯¹åº”çš„ODEçš„æ¨å¯¼æœ‰äº›æŠ€å·§ï¼Œéœ€è¦å…ˆå˜ä¸º$-g_t^2\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log q_t(\boldsymbol{y}_t)$çš„å½¢å¼ï¼Œç„¶åå†åˆ©ç”¨å¼$\eqref{eq:sde-reverse-2}$ï¼š<br />
\begin{equation}<br />
d\boldsymbol{y}_t = \left[\boldsymbol{f}_t(\boldsymbol{y}_t) - g_t^2\boldsymbol{s}</em>}}(\boldsymbol{y<em _boldsymbol_theta="\boldsymbol{\theta">t,t) \right] dt + g_t d\boldsymbol{w} \\\<br />
\Downarrow \\\<br />
d\boldsymbol{y}_t = \Big[\underbrace{\boldsymbol{f}_t(\boldsymbol{y}_t) - g_t^2\boldsymbol{s}</em>}}(\boldsymbol{y<em _boldsymbol_y="\boldsymbol{y">t,t) + g_t^2\nabla</em><em _text_çœ‹æˆæ•´ä½“="\text{çœ‹æˆæ•´ä½“">t}\log q_t(\boldsymbol{y}_t)}</em>}} - g_t^2\nabla_{\boldsymbol{y<em _boldsymbol_theta="\boldsymbol{\theta">t}\log q_t(\boldsymbol{y}_t) \Big] dt + g_t d\boldsymbol{w} \\\<br />
\Downarrow \\\<br />
d\boldsymbol{y}_t = \left[\boldsymbol{f}_t(\boldsymbol{y}_t) - g_t^2\boldsymbol{s}</em>}}(\boldsymbol{y<em _boldsymbol_y="\boldsymbol{y">t,t) + g_t^2\nabla</em><em _boldsymbol_y="\boldsymbol{y">t}\log q_t(\boldsymbol{y}_t) - \frac{1}{2}g_t^2\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log q_t(\boldsymbol{y}_t) \right] dt \\\<br />
\Downarrow \\\<br />
d\boldsymbol{y}_t = \left[\boldsymbol{f}_t(\boldsymbol{y}_t) - g_t^2\boldsymbol{s}</em>}}(\boldsymbol{y<em _boldsymbol_y="\boldsymbol{y">t,t) + \frac{1}{2}g_t^2\nabla</em><em _boldsymbol_z="\boldsymbol{z">t}\log q_t(\boldsymbol{y}_t)\right] dt<br />
\end{equation}<br />
å¯¹è¿™ä¸¤ä¸ªODEé‡å¤æ”¾ç¼©è¿‡ç¨‹$\eqref{eq:der-neq-0}$ï¼ˆ$\pm$å–è´Ÿå·ï¼‰ï¼Œé‚£ä¹ˆä¸»è¦çš„åŒºåˆ«æ˜¯å¤šå‡ºæ¥ä¸€é¡¹<br />
\begin{equation}-\frac{1}{2}g_t^2\mathbb{E}</em>}}\left[(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t - \boldsymbol{y}_t)\cdot (\nabla</em><em _boldsymbol_y="\boldsymbol{y">t}\log p_t(\boldsymbol{x}_t)-\nabla</em>}_t}\log q_t(\boldsymbol{y}_t))\right]\end{equation<br />
å¦‚æœè¿™ä¸€é¡¹å°äºç­‰äº0ï¼Œé‚£ä¹ˆæ”¾ç¼©è¿‡ç¨‹$\eqref{eq:der-neq-0}$ä¾ç„¶æˆç«‹ï¼Œåé¢çš„æ‰€æœ‰ç»“æœåŒæ ·ä¹Ÿæˆç«‹ï¼Œæœ€ç»ˆç»“è®ºçš„å½¢å¼è·Ÿå¼$\eqref{eq:w-neq-1}$ä¸€è‡´ã€‚</p>
<p>æ‰€ä»¥ï¼Œç°åœ¨å‰©ä¸‹çš„é—®é¢˜å°±æ˜¯èƒ½å¦è¯æ˜<br />
\begin{equation}\mathbb{E}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{z}}\left[(\boldsymbol{x}_t - \boldsymbol{y}_t)\cdot (\nabla</em><em _boldsymbol_y="\boldsymbol{y">t}\log p_t(\boldsymbol{x}_t)-\nabla</em>}_t}\log q_t(\boldsymbol{y}_t))\right]\geq 0\end{equation<br />
å¾ˆé—æ†¾ï¼Œå¯ä»¥ä¸¾å‡ºåä¾‹è¡¨æ˜å®ƒä¸€èˆ¬æ˜¯ä¸æˆç«‹çš„ã€‚åŸè®ºæ–‡çš„è¯æ˜è¿‡ç¨‹ä¹Ÿå‡ºç°äº†ç±»ä¼¼çš„ä¸€é¡¹ï¼Œä¸è¿‡æ±‚æœŸæœ›çš„åˆ†å¸ƒä¸æ˜¯$\boldsymbol{z}$ï¼Œè€Œæ˜¯$\boldsymbol{x}_t,\boldsymbol{y}_t$çš„æœ€ä¼˜ä¼ è¾“åˆ†å¸ƒï¼Œåœ¨æ­¤å‰æä¹‹ä¸‹ï¼ŒåŸè®ºæ–‡ç›´æ¥æŠ›å‡ºä¸¤ç¯‡æ–‡çŒ®çš„ç»“è®ºä½œä¸ºå¼•ç†ï¼Œå¯¥å¯¥å‡ è¡Œä¾¿å®Œæˆäº†è¯æ˜ã€‚ä¸å¾—ä¸è¯´åŸè®ºæ–‡ä½œè€…ä»¬çœŸçš„å¾ˆç†Ÿæ‚‰æœ€ä¼˜ä¼ è¾“ç›¸å…³å†…å®¹ï¼Œå„ç§æ–‡çŒ®ç»“è®ºâ€œä¿¡æ‰‹æ‹ˆæ¥â€ï¼Œå°±æ˜¯è‹¦äº†ç¬”è€…è¿™æ ·çš„æ–°æ‰‹è¯»è€…ï¼Œæƒ³è¦å½»åº•ç†è§£å´éš¾ä»¥ä¸‹æ‰‹ï¼Œåªèƒ½åˆ°æ­¤ä¸ºæ­¢äº†ã€‚</p>
<p>ç‰¹åˆ«æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½å¯¹$\nabla_{\boldsymbol{x}<em _boldsymbol_y="\boldsymbol{y">t}\log p_t(\boldsymbol{x}_t)$æˆ–$\nabla</em>_t)$åšå•ä¾§Lipschitzçº¦æŸå‡è®¾ï¼Œå› ä¸ºå¾ˆå®¹æ˜“ä¸¾å‡ºå…¶å¯¹æ•°æ¢¯åº¦ä¸æ»¡è¶³å•ä¾§Lipschitzçº¦æŸçš„åˆ†å¸ƒï¼Œå› æ­¤ï¼Œè¦è¯æ˜è¿™ä¸ªä¸ç­‰å¼ï¼Œåªèƒ½å‚è€ƒåŸè®ºæ–‡çš„æ€è·¯é€šè¿‡åˆ†å¸ƒæœ¬èº«çš„æ€§è´¨æ¥è¿›è¡Œï¼Œä¸èƒ½å¼ºåŠ é¢å¤–çš„å‡è®¾ã€‚}_t}\log q_t(\boldsymbol{y</p>
<h2 id="_6">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ä¸ªæ–°çš„ç†è®ºç»“æœï¼Œæ˜¾ç¤ºæ‰©æ•£æ¨¡å‹çš„å¾—åˆ†åŒ¹é…æŸå¤±å¯ä»¥å†™æˆWè·ç¦»çš„ä¸Šç•Œå½¢å¼ï¼Œå¹¶ç»™å‡ºäº†è‡ªå·±çš„éƒ¨åˆ†è¯æ˜ã€‚è¿™ä¸ªç»“æœæ„å‘³ç€ï¼Œåœ¨æŸç§ç¨‹åº¦ä¸Šæ‰©æ•£æ¨¡å‹å’ŒWGANéƒ½æœ‰ç€ç›¸åŒçš„ä¼˜åŒ–ç›®æ ‡ï¼Œæ‰©æ•£æ¨¡å‹ä¹Ÿåœ¨å·å·ä¼˜åŒ–Wè·ç¦»ï¼</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9467">https://spaces.ac.cn/archives/9467</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Feb. 14, 2023). ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåå…­ï¼‰ï¼šWè·ç¦» â‰¤ å¾—åˆ†åŒ¹é… ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9467">https://spaces.ac.cn/archives/9467</a></p>
<p>@online{kexuefm-9467,<br />
title={ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåå…­ï¼‰ï¼šWè·ç¦» â‰¤ å¾—åˆ†åŒ¹é…},<br />
author={è‹å‰‘æ—},<br />
year={2023},<br />
month={Feb},<br />
url={\url{https://spaces.ac.cn/archives/9467}},<br />
} </p>
<hr />
<h2 id="_7">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚æä¾›æ–‡ç« ä¸­æ¶‰åŠçš„æ‰€æœ‰æ ¸å¿ƒæ•°å­¦å…¬å¼çš„è¯¦ç»†æ¨å¯¼è¿‡ç¨‹ï¼ŒåŒ…æ‹¬Wassersteinè·ç¦»çš„ç†è®ºåŸºç¡€ã€æœ€ä¼˜ä¼ è¾“ç†è®ºã€ä»¥åŠWè·ç¦»ä¸å¾—åˆ†åŒ¹é…ä¹‹é—´çš„æ·±å±‚è”ç³»ã€‚</p>
<h3 id="1-wasserstein">1. Wassersteinè·ç¦»çš„æ•°å­¦å®šä¹‰ä¸æ€§è´¨</h3>
<h4 id="11">1.1 åŸºæœ¬å®šä¹‰</h4>
<p>Wassersteinè·ç¦»ï¼ˆä¹Ÿç§°ä¸ºEarth Mover's Distanceï¼‰æ˜¯æµ‹åº¦è®ºä¸­ç”¨äºè¡¡é‡ä¸¤ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹‹é—´å·®å¼‚çš„é‡è¦å·¥å…·ã€‚</p>
<p><strong>å®šä¹‰1.1ï¼ˆWasserstein-pè·ç¦»ï¼‰</strong>ï¼šè®¾ $p, q$ æ˜¯ $\mathbb{R}^d$ ä¸Šçš„ä¸¤ä¸ªæ¦‚ç‡æµ‹åº¦ï¼Œåˆ™ $p$-Wassersteinè·ç¦»å®šä¹‰ä¸ºï¼š</p>
<p>$$
\mathcal{W}_{\rho}[p,q] = \left(\inf_{\gamma \in \Pi[p,q]} \int_{\mathbb{R}^d \times \mathbb{R}^d} \|\boldsymbol{x} - \boldsymbol{y}\|^{\rho} d\gamma(\boldsymbol{x}, \boldsymbol{y})\right)^{1/\rho}
$$</p>
<p>å…¶ä¸­ $\Pi[p,q]$ è¡¨ç¤ºæ‰€æœ‰ä»¥ $p$ å’Œ $q$ ä¸ºè¾¹ç¼˜åˆ†å¸ƒçš„è”åˆæ¦‚ç‡æµ‹åº¦çš„é›†åˆï¼Œå³ï¼š</p>
<p>$$
\Pi[p,q] = \left\{\gamma \in \mathcal{P}(\mathbb{R}^d \times \mathbb{R}^d) : \int_{\mathbb{R}^d} d\gamma(\boldsymbol{x}, \boldsymbol{y}) = q(\boldsymbol{y}), \int_{\mathbb{R}^d} d\gamma(\boldsymbol{x}, \boldsymbol{y}) = p(\boldsymbol{x})\right\}
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ä¸ªå®šä¹‰çš„ç›´è§‚ç†è§£æ˜¯ï¼Œæˆ‘ä»¬æƒ³è¦å°†åˆ†å¸ƒ $p$ è½¬æ¢ä¸ºåˆ†å¸ƒ $q$ï¼Œè€Œ $\gamma(\boldsymbol{x}, \boldsymbol{y})$ è¡¨ç¤ºä»ä½ç½® $\boldsymbol{x}$ è¿è¾“åˆ°ä½ç½® $\boldsymbol{y}$ çš„"è´¨é‡"ã€‚è¿è¾“æˆæœ¬ä¸è·ç¦»çš„ $\rho$ æ¬¡æ–¹æˆæ­£æ¯”ï¼ŒWassersteinè·ç¦»å°±æ˜¯æœ€å°çš„æ€»è¿è¾“æˆæœ¬çš„ $\rho$ æ¬¡æ ¹ã€‚</p>
<h4 id="12">1.2 è¾¹ç¼˜åˆ†å¸ƒçº¦æŸçš„è¯¦ç»†è§£é‡Š</h4>
<p>å¯¹äºä»»æ„ $\gamma \in \Pi[p,q]$ï¼Œè¾¹ç¼˜åˆ†å¸ƒçº¦æŸæ„å‘³ç€ï¼š</p>
<p>$$
\int_{\mathbb{R}^d} \gamma(\boldsymbol{x}, \boldsymbol{y}) d\boldsymbol{y} = p(\boldsymbol{x}), \quad \forall \boldsymbol{x} \in \mathbb{R}^d
$$</p>
<p>$$
\int_{\mathbb{R}^d} \gamma(\boldsymbol{x}, \boldsymbol{y}) d\boldsymbol{x} = q(\boldsymbol{y}), \quad \forall \boldsymbol{y} \in \mathbb{R}^d
$$</p>
<p><strong>æ¨å¯¼1.1</strong>ï¼šéªŒè¯è¾¹ç¼˜åˆ†å¸ƒçº¦æŸçš„ç‰©ç†æ„ä¹‰ã€‚</p>
<p>è®¾ $\gamma$ ä¸ºä¸€ä¸ªè¿è¾“æ–¹æ¡ˆï¼Œæˆ‘ä»¬å¯¹æ‰€æœ‰ç›®æ ‡ä½ç½® $\boldsymbol{y}$ ç§¯åˆ†ï¼š</p>
<p>$$
\int_{\mathbb{R}^d} \gamma(\boldsymbol{x}, \boldsymbol{y}) d\boldsymbol{y}
$$</p>
<p>è¿™è¡¨ç¤ºä»æºä½ç½® $\boldsymbol{x}$ è¿å‡ºçš„æ€»è´¨é‡ã€‚æ ¹æ®è´¨é‡å®ˆæ’ï¼Œè¿™åº”è¯¥ç­‰äº $p(\boldsymbol{x})$ï¼Œå³æºåˆ†å¸ƒåœ¨ $\boldsymbol{x}$ å¤„çš„æ¦‚ç‡å¯†åº¦ã€‚</p>
<p>ç±»ä¼¼åœ°ï¼Œå¯¹æ‰€æœ‰æºä½ç½® $\boldsymbol{x}$ ç§¯åˆ†ï¼š</p>
<p>$$
\int_{\mathbb{R}^d} \gamma(\boldsymbol{x}, \boldsymbol{y}) d\boldsymbol{x}
$$</p>
<p>è¿™è¡¨ç¤ºè¿è¾“åˆ°ç›®æ ‡ä½ç½® $\boldsymbol{y}$ çš„æ€»è´¨é‡ï¼Œåº”è¯¥ç­‰äº $q(\boldsymbol{y})$ã€‚</p>
<h4 id="13-w2">1.3 W2è·ç¦»çš„ç‰¹æ®Šæ€§è´¨</h4>
<p>æœ¬æ–‡é‡ç‚¹å…³æ³¨ $\rho = 2$ çš„æƒ…å†µï¼Œå³ $\mathcal{W}_2$ è·ç¦»ï¼š</p>
<p>$$
\mathcal{W}_2[p,q] = \left(\inf_{\gamma \in \Pi[p,q]} \int_{\mathbb{R}^d \times \mathbb{R}^d} \|\boldsymbol{x} - \boldsymbol{y}\|^2 d\gamma(\boldsymbol{x}, \boldsymbol{y})\right)^{1/2}
$$</p>
<p><strong>å®šç†1.1ï¼ˆW2è·ç¦»æ˜¯åº¦é‡ï¼‰</strong>ï¼š$\mathcal{W}_2$ æ»¡è¶³åº¦é‡çš„ä¸‰ä¸ªåŸºæœ¬æ€§è´¨ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>(1) éè´Ÿæ€§ï¼š$\mathcal{W}_2[p,q] \geq 0$ï¼Œä¸” $\mathcal{W}_2[p,p] = 0$ã€‚</p>
<p>è¿™æ˜¯æ˜¾ç„¶çš„ï¼Œå› ä¸ºè·ç¦»å¹³æ–¹ $|\boldsymbol{x} - \boldsymbol{y}|^2 \geq 0$ï¼Œä¸”å½“ $p = q$ æ—¶ï¼Œå¯ä»¥å– $\gamma(\boldsymbol{x}, \boldsymbol{y}) = p(\boldsymbol{x})\delta(\boldsymbol{x} - \boldsymbol{y})$ï¼ˆå¯¹è§’çº¿ä¸Šçš„æµ‹åº¦ï¼‰ï¼Œæ­¤æ—¶ï¼š</p>
<p>$$
\int_{\mathbb{R}^d \times \mathbb{R}^d} \|\boldsymbol{x} - \boldsymbol{y}\|^2 \delta(\boldsymbol{x} - \boldsymbol{y}) p(\boldsymbol{x}) d\boldsymbol{x} d\boldsymbol{y} = \int_{\mathbb{R}^d} \|\boldsymbol{x} - \boldsymbol{x}\|^2 p(\boldsymbol{x}) d\boldsymbol{x} = 0
$$</p>
<p>(2) å¯¹ç§°æ€§ï¼š$\mathcal{W}_2[p,q] = \mathcal{W}_2[q,p]$ã€‚</p>
<p>å¯¹äºä»»ä½• $\gamma \in \Pi[p,q]$ï¼Œå®šä¹‰ $\tilde{\gamma}(\boldsymbol{x}, \boldsymbol{y}) = \gamma(\boldsymbol{y}, \boldsymbol{x})$ï¼Œåˆ™ $\tilde{\gamma} \in \Pi[q,p]$ï¼Œä¸”ï¼š</p>
<p>$$
\int \|\boldsymbol{x} - \boldsymbol{y}\|^2 d\gamma(\boldsymbol{x}, \boldsymbol{y}) = \int \|\boldsymbol{y} - \boldsymbol{x}\|^2 d\tilde{\gamma}(\boldsymbol{x}, \boldsymbol{y})
$$</p>
<p>å› æ­¤ä¸¤ä¸ªä¸‹ç¡®ç•Œç›¸ç­‰ã€‚</p>
<p>(3) ä¸‰è§’ä¸ç­‰å¼ï¼š$\mathcal{W}_2[p,r] \leq \mathcal{W}_2[p,q] + \mathcal{W}_2[q,r]$ã€‚</p>
<p>è¿™ä¸ªè¯æ˜è¾ƒä¸ºå¤æ‚ï¼Œéœ€è¦ä½¿ç”¨Gluingå¼•ç†æ¥æ„é€ åˆé€‚çš„è”åˆæµ‹åº¦ã€‚</p>
<h3 id="2-kantorovich">2. Kantorovichå¯¹å¶ç†è®º</h3>
<h4 id="21-kantorovich">2.1 Kantorovichå¯¹å¶å…¬å¼</h4>
<p><strong>å®šç†2.1ï¼ˆKantorovichå¯¹å¶ï¼‰</strong>ï¼šå¯¹äº $\mathcal{W}_1$ è·ç¦»ï¼Œå­˜åœ¨å¯¹å¶è¡¨ç¤ºï¼š</p>
<p>$$
\mathcal{W}_1[p,q] = \sup_{\|f\|_L \leq 1} \left(\int f(\boldsymbol{x}) dp(\boldsymbol{x}) - \int f(\boldsymbol{y}) dq(\boldsymbol{y})\right)
$$</p>
<p>å…¶ä¸­ $|f|_L \leq 1$ è¡¨ç¤º $f$ æ˜¯1-Lipschitzå‡½æ•°ï¼Œå³ $|f(\boldsymbol{x}) - f(\boldsymbol{y})| \leq |\boldsymbol{x} - \boldsymbol{y}|$ã€‚</p>
<p><strong>æ¨å¯¼2.1</strong>ï¼šä»åŸå§‹é—®é¢˜åˆ°å¯¹å¶é—®é¢˜çš„è½¬æ¢ã€‚</p>
<p>åŸå§‹é—®é¢˜ï¼ˆPrimal Problemï¼‰ï¼š</p>
<p>$$
\min_{\gamma \in \Pi[p,q]} \int_{\mathbb{R}^d \times \mathbb{R}^d} c(\boldsymbol{x}, \boldsymbol{y}) d\gamma(\boldsymbol{x}, \boldsymbol{y})
$$</p>
<p>å…¶ä¸­ $c(\boldsymbol{x}, \boldsymbol{y}) = |\boldsymbol{x} - \boldsymbol{y}|$ æ˜¯æˆæœ¬å‡½æ•°ã€‚</p>
<p>å¼•å…¥Lagrangeä¹˜å­ $f(\boldsymbol{x})$ å’Œ $g(\boldsymbol{y})$ å¯¹åº”è¾¹ç¼˜åˆ†å¸ƒçº¦æŸï¼Œå¯¹å¶é—®é¢˜ï¼ˆDual Problemï¼‰ä¸ºï¼š</p>
<p>$$
\max_{f,g} \left(\int f(\boldsymbol{x}) dp(\boldsymbol{x}) + \int g(\boldsymbol{y}) dq(\boldsymbol{y})\right)
$$</p>
<p>çº¦æŸæ¡ä»¶ä¸ºï¼š$f(\boldsymbol{x}) + g(\boldsymbol{y}) \leq c(\boldsymbol{x}, \boldsymbol{y})$ã€‚</p>
<p>é€šè¿‡å˜é‡æ›¿æ¢ $g(\boldsymbol{y}) = -f(\boldsymbol{y})$ï¼Œå¯ä»¥å¾—åˆ°ï¼š</p>
<p>$$
f(\boldsymbol{x}) - f(\boldsymbol{y}) \leq \|\boldsymbol{x} - \boldsymbol{y}\|
$$</p>
<p>è¿™æ­£æ˜¯1-Lipschitzæ¡ä»¶ã€‚</p>
<h4 id="22">2.2 å¯¹å¶é—´éš™ä¸å¼ºå¯¹å¶æ€§</h4>
<p><strong>å®šç†2.2ï¼ˆå¼ºå¯¹å¶æ€§ï¼‰</strong>ï¼šåœ¨é€‚å½“çš„ç´§æ€§æ¡ä»¶ä¸‹ï¼ŒKantoroviché—®é¢˜æ»¡è¶³å¼ºå¯¹å¶æ€§ï¼Œå³åŸå§‹é—®é¢˜çš„æœ€ä¼˜å€¼ç­‰äºå¯¹å¶é—®é¢˜çš„æœ€ä¼˜å€¼ï¼š</p>
<p>$$
\inf_{\gamma \in \Pi[p,q]} \int c(\boldsymbol{x}, \boldsymbol{y}) d\gamma = \sup_{f \oplus g \leq c} \left(\int f dp + \int g dq\right)
$$</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼š</p>
<p>åˆ©ç”¨Fenchel-Rockafellarå¯¹å¶å®šç†ã€‚å®šä¹‰ç®—å­ $A: \mathcal{M}(\mathbb{R}^d \times \mathbb{R}^d) \to \mathcal{M}(\mathbb{R}^d) \times \mathcal{M}(\mathbb{R}^d)$ï¼š</p>
<p>$$
A(\gamma) = \left(\int \gamma(\cdot, \boldsymbol{y}) d\boldsymbol{y}, \int \gamma(\boldsymbol{x}, \cdot) d\boldsymbol{x}\right)
$$</p>
<p>åˆ™åŸå§‹é—®é¢˜å¯ä»¥å†™ä¸ºï¼š</p>
<p>$$
\min_{\gamma \geq 0, A\gamma = (p,q)} \int c d\gamma
$$</p>
<p>åº”ç”¨Fenchel-Rockafellarå®šç†ï¼Œåœ¨é€‚å½“çš„å†…ç‚¹æ¡ä»¶ä¸‹ï¼Œå¯¹å¶é—´éš™ä¸ºé›¶ã€‚</p>
<h4 id="23">2.3 æœ€ä¼˜è¿è¾“æ˜ å°„çš„å­˜åœ¨æ€§</h4>
<p><strong>å®šç†2.3ï¼ˆBrenierå®šç†ï¼‰</strong>ï¼šå½“ $\rho = 2$ ä¸”æºåˆ†å¸ƒ $p$ ç»å¯¹è¿ç»­æ—¶ï¼Œå­˜åœ¨å”¯ä¸€çš„æœ€ä¼˜è¿è¾“æ˜ å°„ $T: \mathbb{R}^d \to \mathbb{R}^d$ ä½¿å¾—ï¼š</p>
<p>$$
T_{\#}p = q
$$</p>
<p>ä¸” $T$ æ˜¯æŸä¸ªå‡¸å‡½æ•°çš„æ¢¯åº¦ï¼Œå³å­˜åœ¨å‡¸å‡½æ•° $\phi$ ä½¿å¾— $T = \nabla \phi$ã€‚</p>
<p><strong>æ¨å¯¼2.2</strong>ï¼šæœ€ä¼˜è¿è¾“æ˜ å°„ä¸å‡¸å‡½æ•°çš„å…³ç³»ã€‚</p>
<p>è®¾ $T$ æ˜¯æœ€ä¼˜è¿è¾“æ˜ å°„ï¼Œå®šä¹‰ $\phi$ ä¸ºï¼š</p>
<p>$$
\phi(\boldsymbol{x}) = \sup_{\boldsymbol{y}} \left(\boldsymbol{x} \cdot \boldsymbol{y} - \frac{1}{2}\|\boldsymbol{y}\|^2\right)
$$</p>
<p>è¿™æ˜¯ä¸€ä¸ªå‡¸å‡½æ•°ï¼ˆä½œä¸ºçº¿æ€§å‡½æ•°çš„ä¸Šç¡®ç•Œï¼‰ã€‚</p>
<p>å¯¹äºæœ€ä¼˜è¿è¾“ï¼Œå¿…é¡»æ»¡è¶³c-å•è°ƒæ€§æ¡ä»¶ï¼šå¯¹äºä»»æ„ $(x_i, y_i)$ï¼Œ$i = 1, 2$ åœ¨æœ€ä¼˜è¿è¾“è®¡åˆ’çš„æ”¯æ’‘é›†ä¸­ï¼Œæœ‰ï¼š</p>
<p>$$
\|x_1 - y_1\|^2 + \|x_2 - y_2\|^2 \leq \|x_1 - y_2\|^2 + \|x_2 - y_1\|^2
$$</p>
<p>å±•å¼€è¿™ä¸ªä¸ç­‰å¼ï¼š</p>
<p>$$
x_1 \cdot y_1 + x_2 \cdot y_2 \geq x_1 \cdot y_2 + x_2 \cdot y_1
$$</p>
<p>è¿™æ­£æ˜¯å‡¸å‡½æ•°æ¢¯åº¦çš„å•è°ƒæ€§æ¡ä»¶ã€‚</p>
<h3 id="3-benamou-brenier">3. Benamou-BrenieråŠ¨æ€å…¬å¼</h3>
<h4 id="31">3.1 åŠ¨æ€æœ€ä¼˜ä¼ è¾“é—®é¢˜</h4>
<p><strong>å®šç†3.1ï¼ˆBenamou-Brenierå…¬å¼ï¼‰</strong>ï¼šWasserstein-2è·ç¦»å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<p>$$
\mathcal{W}_2^2[p_0, p_1] = \inf_{(\rho_t, \boldsymbol{v}_t)} \int_0^1 \int_{\mathbb{R}^d} \rho_t(\boldsymbol{x}) \|\boldsymbol{v}_t(\boldsymbol{x})\|^2 d\boldsymbol{x} dt
$$</p>
<p>çº¦æŸæ¡ä»¶ä¸ºè¿ç»­æ€§æ–¹ç¨‹ï¼š</p>
<p>$$
\frac{\partial \rho_t}{\partial t} + \nabla \cdot (\rho_t \boldsymbol{v}_t) = 0
$$</p>
<p>è¾¹ç•Œæ¡ä»¶ä¸ºï¼š$\rho_0 = p_0$ï¼Œ$\rho_1 = p_1$ã€‚</p>
<p><strong>æ¨å¯¼3.1</strong>ï¼šä»é™æ€åˆ°åŠ¨æ€çš„è½¬æ¢ã€‚</p>
<p>è€ƒè™‘ä¸€ä¸ªä» $p_0$ åˆ° $p_1$ çš„è¿ç»­è·¯å¾„ ${\rho_t}_{t \in [0,1]}$ï¼Œä¼´éšé€Ÿåº¦åœº $\boldsymbol{v}_t$ã€‚</p>
<p>è·¯å¾„ä¸Šä»»æ„ç²’å­çš„è½¨è¿¹æ»¡è¶³ï¼š</p>
<p>$$
\frac{d\boldsymbol{X}_t}{dt} = \boldsymbol{v}_t(\boldsymbol{X}_t)
$$</p>
<p>è¿è¾“æ€»æˆæœ¬å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<p>$$
\text{Cost} = \int_0^1 \int_{\mathbb{R}^d} \rho_t(\boldsymbol{x}) \|\boldsymbol{v}_t(\boldsymbol{x})\|^2 d\boldsymbol{x} dt
$$</p>
<p>è¿™é‡Œ $\rho_t(\boldsymbol{x}) |\boldsymbol{v}_t(\boldsymbol{x})|^2$ å¯ä»¥ç†è§£ä¸ºä½ç½® $\boldsymbol{x}$ å¤„çš„åŠ¨èƒ½å¯†åº¦ã€‚</p>
<p>è´¨é‡å®ˆæ’è¦æ±‚ $\rho_t$ æ»¡è¶³è¿ç»­æ€§æ–¹ç¨‹ï¼š</p>
<p>$$
\frac{\partial \rho_t}{\partial t} + \nabla \cdot (\rho_t \boldsymbol{v}_t) = 0
$$</p>
<h4 id="32">3.2 è¿ç»­æ€§æ–¹ç¨‹çš„æ¨å¯¼</h4>
<p><strong>æ¨å¯¼3.2</strong>ï¼šè¿ç»­æ€§æ–¹ç¨‹çš„ç‰©ç†æ„ä¹‰ã€‚</p>
<p>è€ƒè™‘ä¸€ä¸ªå›ºå®šåŒºåŸŸ $\Omega \subset \mathbb{R}^d$ï¼ŒåŒºåŸŸå†…çš„æ€»è´¨é‡ä¸ºï¼š</p>
<p>$$
M(t) = \int_{\Omega} \rho_t(\boldsymbol{x}) d\boldsymbol{x}
$$</p>
<p>è´¨é‡çš„å˜åŒ–ç‡ä¸ºï¼š</p>
<p>$$
\frac{dM(t)}{dt} = \int_{\Omega} \frac{\partial \rho_t(\boldsymbol{x})}{\partial t} d\boldsymbol{x}
$$</p>
<p>å¦ä¸€æ–¹é¢ï¼Œè´¨é‡å˜åŒ–ä¹Ÿç­‰äºé€šè¿‡è¾¹ç•Œ $\partial\Omega$ æµå‡ºçš„é€šé‡ï¼š</p>
<p>$$
\frac{dM(t)}{dt} = -\int_{\partial\Omega} \rho_t \boldsymbol{v}_t \cdot \boldsymbol{n} dS
$$</p>
<p>å…¶ä¸­ $\boldsymbol{n}$ æ˜¯å¤–æ³•å‘é‡ã€‚åº”ç”¨æ•£åº¦å®šç†ï¼ˆDivergence Theoremï¼‰ï¼š</p>
<p>$$
\int_{\partial\Omega} \rho_t \boldsymbol{v}_t \cdot \boldsymbol{n} dS = \int_{\Omega} \nabla \cdot (\rho_t \boldsymbol{v}_t) d\boldsymbol{x}
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
\int_{\Omega} \frac{\partial \rho_t}{\partial t} d\boldsymbol{x} = -\int_{\Omega} \nabla \cdot (\rho_t \boldsymbol{v}_t) d\boldsymbol{x}
$$</p>
<p>ç”±äº $\Omega$ æ˜¯ä»»æ„çš„ï¼Œæˆ‘ä»¬å¾—åˆ°è¿ç»­æ€§æ–¹ç¨‹ï¼š</p>
<p>$$
\frac{\partial \rho_t}{\partial t} + \nabla \cdot (\rho_t \boldsymbol{v}_t) = 0
$$</p>
<h4 id="33">3.3 åŠ¨æ€å…¬å¼ä¸é™æ€å…¬å¼çš„ç­‰ä»·æ€§</h4>
<p><strong>æ¨å¯¼3.3</strong>ï¼šè¯æ˜åŠ¨æ€å…¬å¼ç¡®å®ç»™å‡º $\mathcal{W}_2$ è·ç¦»ã€‚</p>
<p>è®¾ $T: \mathbb{R}^d \to \mathbb{R}^d$ æ˜¯ä» $p_0$ åˆ° $p_1$ çš„æœ€ä¼˜è¿è¾“æ˜ å°„ã€‚å®šä¹‰æµ‹åœ°çº¿è·¯å¾„ï¼š</p>
<p>$$
\boldsymbol{X}_t = (1-t)\boldsymbol{x} + t T(\boldsymbol{x}), \quad t \in [0,1]
$$</p>
<p>å…¶ä¸­ $\boldsymbol{x} \sim p_0$ã€‚åˆ™é€Ÿåº¦åœºä¸ºï¼š</p>
<p>$$
\boldsymbol{v}_t = \frac{d\boldsymbol{X}_t}{dt} = T(\boldsymbol{x}) - \boldsymbol{x}
$$</p>
<p>å¯†åº¦ $\rho_t$ ç”±æ¨å‰æµ‹åº¦å®šä¹‰ï¼š$\rho_t = (\boldsymbol{X}<em _35_="#">t)</em>p_0$ã€‚</p>
<p>è®¡ç®—åŠ¨åŠ›å­¦æˆæœ¬ï¼š</p>
<p>$$
\begin{aligned}
\int_0^1 \int_{\mathbb{R}^d} \rho_t(\boldsymbol{y}) \|\boldsymbol{v}_t(\boldsymbol{y})\|^2 d\boldsymbol{y} dt
&= \int_0^1 \int_{\mathbb{R}^d} \|T(\boldsymbol{x}) - \boldsymbol{x}\|^2 p_0(\boldsymbol{x}) d\boldsymbol{x} dt \\
&= \int_{\mathbb{R}^d} \|T(\boldsymbol{x}) - \boldsymbol{x}\|^2 p_0(\boldsymbol{x}) d\boldsymbol{x}
\end{aligned}
$$</p>
<p>æœ€åè¿™ä¸ªç§¯åˆ†æ­£æ˜¯ $\mathcal{W}_2^2[p_0, p_1]$ çš„å®šä¹‰ï¼ˆå½“ $T$ æ˜¯æœ€ä¼˜è¿è¾“æ˜ å°„æ—¶ï¼‰ã€‚</p>
<h3 id="4-lipschitz">4. å•ä¾§Lipschitzæ¡ä»¶</h3>
<h4 id="41-lipschitz">4.1 å•ä¾§Lipschitzæ¡ä»¶çš„å®šä¹‰</h4>
<p><strong>å®šä¹‰4.1ï¼ˆå•ä¾§Lipschitzï¼‰</strong>ï¼šå‡½æ•° $\boldsymbol{g}: \mathbb{R}^d \to \mathbb{R}^d$ æ»¡è¶³å•ä¾§Lipschitzæ¡ä»¶ï¼Œå¦‚æœå­˜åœ¨å¸¸æ•° $L$ ä½¿å¾—ï¼š</p>
<p>$$
(\boldsymbol{g}(\boldsymbol{x}) - \boldsymbol{g}(\boldsymbol{y})) \cdot (\boldsymbol{x} - \boldsymbol{y}) \leq L \|\boldsymbol{x} - \boldsymbol{y}\|^2
$$</p>
<p>å¯¹æ‰€æœ‰ $\boldsymbol{x}, \boldsymbol{y} \in \mathbb{R}^d$ æˆç«‹ã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šå•ä¾§Lipschitzæ¡ä»¶æ¯”æ ‡å‡†Lipschitzæ¡ä»¶ï¼ˆ$|\boldsymbol{g}(\boldsymbol{x}) - \boldsymbol{g}(\boldsymbol{y})| \leq L |\boldsymbol{x} - \boldsymbol{y}|$ï¼‰æ›´å¼±ï¼Œå®ƒåªçº¦æŸäº†å‡½æ•°å˜åŒ–åœ¨è¿æ¥ä¸¤ç‚¹æ–¹å‘ä¸Šçš„æŠ•å½±ã€‚</p>
<h4 id="42-lipschitz">4.2 å•ä¾§Lipschitzæ¡ä»¶çš„æ€§è´¨</h4>
<p><strong>å‘½é¢˜4.1</strong>ï¼šå¦‚æœ $\boldsymbol{g}$ æ»¡è¶³æ ‡å‡†Lipschitzæ¡ä»¶ï¼ˆå¸¸æ•°ä¸º $L$ï¼‰ï¼Œåˆ™å®ƒæ»¡è¶³å•ä¾§Lipschitzæ¡ä»¶ï¼ˆå¸¸æ•°ä¹Ÿä¸º $L$ï¼‰ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>ç”±Cauchy-Schwarzä¸ç­‰å¼ï¼š</p>
<p>$$
\begin{aligned}
(\boldsymbol{g}(\boldsymbol{x}) - \boldsymbol{g}(\boldsymbol{y})) \cdot (\boldsymbol{x} - \boldsymbol{y})
&\leq \|\boldsymbol{g}(\boldsymbol{x}) - \boldsymbol{g}(\boldsymbol{y})\| \cdot \|\boldsymbol{x} - \boldsymbol{y}\| \\
&\leq L \|\boldsymbol{x} - \boldsymbol{y}\| \cdot \|\boldsymbol{x} - \boldsymbol{y}\| \\
&= L \|\boldsymbol{x} - \boldsymbol{y}\|^2
\end{aligned}
$$</p>
<p><strong>æ¨å¯¼4.1</strong>ï¼šå•ä¾§Lipschitzæ¡ä»¶ä¸æ¢¯åº¦çš„å…³ç³»ã€‚</p>
<p>å‡è®¾ $\boldsymbol{g}$ å¯å¾®ï¼Œå¯¹äºä»»æ„ $\boldsymbol{x}, \boldsymbol{y}$ï¼Œè€ƒè™‘å‡½æ•°ï¼š</p>
<p>$$
h(t) = \boldsymbol{g}(t\boldsymbol{x} + (1-t)\boldsymbol{y}) \cdot (\boldsymbol{x} - \boldsymbol{y})
$$</p>
<p>åˆ™ï¼š</p>
<p>$$
h'(t) = \nabla\boldsymbol{g}(t\boldsymbol{x} + (1-t)\boldsymbol{y})(\boldsymbol{x} - \boldsymbol{y}) \cdot (\boldsymbol{x} - \boldsymbol{y})
$$</p>
<p>æ ¹æ®å¾®ç§¯åˆ†åŸºæœ¬å®šç†ï¼š</p>
<p>$$
\begin{aligned}
&\,(\boldsymbol{g}(\boldsymbol{x}) - \boldsymbol{g}(\boldsymbol{y})) \cdot (\boldsymbol{x} - \boldsymbol{y}) \\
=&\, h(1) - h(0) \\
=&\, \int_0^1 h'(t) dt \\
=&\, \int_0^1 (\boldsymbol{x} - \boldsymbol{y})^T \nabla\boldsymbol{g}(t\boldsymbol{x} + (1-t)\boldsymbol{y}) (\boldsymbol{x} - \boldsymbol{y}) dt
\end{aligned}
$$</p>
<p>å¦‚æœ Jacobian çŸ©é˜µ $\nabla\boldsymbol{g}$ çš„å¯¹ç§°éƒ¨åˆ†çš„æœ€å¤§ç‰¹å¾å€¼æœ‰ç•Œï¼Œå³ï¼š</p>
<p>$$
\lambda_{\max}\left(\frac{\nabla\boldsymbol{g} + \nabla\boldsymbol{g}^T}{2}\right) \leq L
$$</p>
<p>åˆ™å•ä¾§Lipschitzæ¡ä»¶æˆç«‹ã€‚</p>
<h4 id="43-lipschitzode">4.3 å•ä¾§Lipschitzæ¡ä»¶åœ¨ODEä¸­çš„åº”ç”¨</h4>
<p><strong>å®šç†4.1ï¼ˆGronwallä¸ç­‰å¼çš„åº”ç”¨ï¼‰</strong>ï¼šè€ƒè™‘ä¸¤ä¸ªODEï¼š</p>
<p>$$
\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{f}_t(\boldsymbol{x}_t), \quad \frac{d\boldsymbol{y}_t}{dt} = \boldsymbol{g}_t(\boldsymbol{y}_t)
$$</p>
<p>å¦‚æœ $\boldsymbol{g}_t$ æ»¡è¶³å•ä¾§Lipschitzæ¡ä»¶ï¼ˆå¸¸æ•° $L_t$ï¼‰ï¼Œåˆ™ï¼š</p>
<p>$$
\frac{d}{dt}\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2 \leq 2(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)) + 2L_t\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2
$$</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>$$
\begin{aligned}
\frac{d}{dt}\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2
&= 2(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot \left(\frac{d\boldsymbol{x}_t}{dt} - \frac{d\boldsymbol{y}_t}{dt}\right) \\
&= 2(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t)) \\
&= 2(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)) \\
&\quad + 2(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{g}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t)) \\
&\leq 2(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)) + 2L_t\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2
\end{aligned}
$$</p>
<p>æœ€åä¸€æ­¥ä½¿ç”¨äº†å•ä¾§Lipschitzæ¡ä»¶ã€‚</p>
<h3 id="5">5. æ ¸å¿ƒä¸ç­‰å¼çš„è¯¦ç»†æ¨å¯¼</h3>
<h4 id="51">5.1 ä¼ è¾“æ–¹æ¡ˆçš„æ„é€ </h4>
<p><strong>æ¨å¯¼5.1</strong>ï¼šä»ODEè½¨è¿¹æ„é€ ä¼ è¾“æ–¹æ¡ˆã€‚</p>
<p>è€ƒè™‘ä»åŒä¸€åˆå§‹åˆ†å¸ƒ $q(\boldsymbol{z})$ å‡ºå‘çš„ä¸¤æ¡ODEè½¨è¿¹ï¼š</p>
<p>$$
\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{f}_t(\boldsymbol{x}_t), \quad \boldsymbol{x}_T = \boldsymbol{z}
$$</p>
<p>$$
\frac{d\boldsymbol{y}_t}{dt} = \boldsymbol{g}_t(\boldsymbol{y}_t), \quad \boldsymbol{y}_T = \boldsymbol{z}
$$</p>
<p>ç”±äº $\boldsymbol{x}_t$ å’Œ $\boldsymbol{y}_t$ éƒ½ç”± $\boldsymbol{z}$ å”¯ä¸€ç¡®å®šï¼Œæˆ‘ä»¬å¯ä»¥å†™ä½œ $\boldsymbol{x}_t(\boldsymbol{z})$ å’Œ $\boldsymbol{y}_t(\boldsymbol{z})$ã€‚</p>
<p>å®šä¹‰è”åˆåˆ†å¸ƒï¼š</p>
<p>$$
\gamma_t(\boldsymbol{x}, \boldsymbol{y}) = \int q(\boldsymbol{z}) \delta(\boldsymbol{x} - \boldsymbol{x}_t(\boldsymbol{z})) \delta(\boldsymbol{y} - \boldsymbol{y}_t(\boldsymbol{z})) d\boldsymbol{z}
$$</p>
<p>éªŒè¯è¾¹ç¼˜åˆ†å¸ƒï¼š</p>
<p>$$
\begin{aligned}
\int \gamma_t(\boldsymbol{x}, \boldsymbol{y}) d\boldsymbol{y}
&= \int q(\boldsymbol{z}) \delta(\boldsymbol{x} - \boldsymbol{x}_t(\boldsymbol{z})) d\boldsymbol{z} \\
&= p_t(\boldsymbol{x})
\end{aligned}
$$</p>
<p>å…¶ä¸­ä½¿ç”¨äº†æ¨å‰æµ‹åº¦çš„å®šä¹‰ï¼š$p_t = (\boldsymbol{x}<em _35_="#">t)</em>q$ã€‚</p>
<p>ç±»ä¼¼åœ°ï¼Œ$\int \gamma_t(\boldsymbol{x}, \boldsymbol{y}) d\boldsymbol{x} = q_t(\boldsymbol{y})$ã€‚</p>
<p>å› æ­¤ $\gamma_t \in \Pi[p_t, q_t]$ã€‚</p>
<h4 id="52">5.2 ä¸Šç•Œçš„å»ºç«‹</h4>
<p><strong>æ¨å¯¼5.2</strong>ï¼šä»ä¼ è¾“æ–¹æ¡ˆåˆ°Wassersteinè·ç¦»çš„ä¸Šç•Œã€‚</p>
<p>æ ¹æ®Wassersteinè·ç¦»çš„å®šä¹‰ï¼š</p>
<p>$$
\mathcal{W}_2^2[p_t, q_t] = \inf_{\gamma \in \Pi[p_t, q_t]} \int \|\boldsymbol{x} - \boldsymbol{y}\|^2 d\gamma(\boldsymbol{x}, \boldsymbol{y})
$$</p>
<p>ç”±äº $\gamma_t$ æ˜¯ä¸€ä¸ªå¯è¡Œçš„ä¼ è¾“æ–¹æ¡ˆï¼Œæˆ‘ä»¬æœ‰ï¼š</p>
<p>$$
\begin{aligned}
\mathcal{W}_2^2[p_t, q_t]
&\leq \int \|\boldsymbol{x} - \boldsymbol{y}\|^2 d\gamma_t(\boldsymbol{x}, \boldsymbol{y}) \\
&= \int \|\boldsymbol{x}_t(\boldsymbol{z}) - \boldsymbol{y}_t(\boldsymbol{z})\|^2 q(\boldsymbol{z}) d\boldsymbol{z} \\
&= \mathbb{E}_{\boldsymbol{z} \sim q}[\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2] \\
&\triangleq \tilde{\mathcal{W}}_2^2[p_t, q_t]
\end{aligned}
$$</p>
<p>æˆ‘ä»¬å®šä¹‰ $\tilde{\mathcal{W}}_2^2[p_t, q_t]$ ä¸ºè¿™ä¸ªä¸Šç•Œï¼Œä¸‹é¢çš„ç›®æ ‡æ˜¯å¯¹å®ƒè¿›è¡Œæ”¾ç¼©ã€‚</p>
<h4 id="53">5.3 æ—¶é—´å¯¼æ•°çš„è®¡ç®—</h4>
<p><strong>æ¨å¯¼5.3</strong>ï¼šè®¡ç®— $\tilde{\mathcal{W}}_2^2[p_t, q_t]$ å¯¹æ—¶é—´çš„å¯¼æ•°ã€‚</p>
<p>$$
\begin{aligned}
\frac{d}{dt}\tilde{\mathcal{W}}_2^2[p_t, q_t]
&= \frac{d}{dt}\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2] \\
&= \mathbb{E}_{\boldsymbol{z}}\left[\frac{d}{dt}\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2\right]
\end{aligned}
$$</p>
<p>ä½¿ç”¨é“¾å¼æ³•åˆ™ï¼š</p>
<p>$$
\frac{d}{dt}\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2 = \frac{d}{dt}[(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{x}_t - \boldsymbol{y}_t)]
$$</p>
<p>$$
= 2(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot \left(\frac{d\boldsymbol{x}_t}{dt} - \frac{d\boldsymbol{y}_t}{dt}\right)
$$</p>
<p>ä»£å…¥ODEï¼š</p>
<p>$$
= 2(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t))
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
\frac{d}{dt}\tilde{\mathcal{W}}_2^2[p_t, q_t] = 2\mathbb{E}_{\boldsymbol{z}}[(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t))]
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™é‡Œæˆ‘ä»¬å¯ä»¥äº¤æ¢æ±‚å¯¼å’ŒæœŸæœ›çš„é¡ºåºï¼Œå‰ææ˜¯æ»¡è¶³é€‚å½“çš„å¯ç§¯æ€§æ¡ä»¶ï¼ˆDominated Convergence Theoremï¼‰ã€‚</p>
<h4 id="54">5.4 å·§å¦™çš„æ‹†åˆ†æŠ€å·§</h4>
<p><strong>æ¨å¯¼5.4</strong>ï¼šå°†å·®é¡¹æ‹†åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚</p>
<p>å…³é”®æŠ€å·§æ˜¯å¼•å…¥ä¸­é—´é¡¹ $\boldsymbol{g}_t(\boldsymbol{x}_t)$ï¼š</p>
<p>$$
\begin{aligned}
&\,(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t)) \\
=&\, (\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t) + \boldsymbol{g}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t)) \\
=&\, (\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)) \\
&\, + (\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{g}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t))
\end{aligned}
$$</p>
<p>ç¬¬ä¸€é¡¹è¡¡é‡äº†ä¸¤ä¸ªå‘é‡åœº $\boldsymbol{f}_t$ å’Œ $\boldsymbol{g}_t$ åœ¨åŒä¸€ç‚¹çš„å·®å¼‚ã€‚</p>
<p>ç¬¬äºŒé¡¹è¡¡é‡äº†å‘é‡åœº $\boldsymbol{g}_t$ åœ¨ä¸åŒç‚¹ä¹‹é—´çš„å˜åŒ–ã€‚</p>
<h3 id="6-cauchy-schwarz">6. Cauchy-Schwarzä¸ç­‰å¼çš„åº”ç”¨</h3>
<h4 id="61-cauchy-schwarz">6.1 å‘é‡å½¢å¼çš„Cauchy-Schwarzä¸ç­‰å¼</h4>
<p><strong>å¼•ç†6.1ï¼ˆCauchy-Schwarzä¸ç­‰å¼ï¼‰</strong>ï¼šå¯¹äºä»»æ„å‘é‡ $\boldsymbol{u}, \boldsymbol{v} \in \mathbb{R}^d$ï¼š</p>
<p>$$
\boldsymbol{u} \cdot \boldsymbol{v} \leq |\boldsymbol{u} \cdot \boldsymbol{v}| \leq \|\boldsymbol{u}\| \|\boldsymbol{v}\|
$$</p>
<p>ç­‰å·æˆç«‹å½“ä¸”ä»…å½“ $\boldsymbol{u}$ å’Œ $\boldsymbol{v}$ å…±çº¿ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>è€ƒè™‘å‡½æ•° $f(\lambda) = |\boldsymbol{u} - \lambda\boldsymbol{v}|^2 \geq 0$ï¼Œå±•å¼€ï¼š</p>
<p>$$
f(\lambda) = \|\boldsymbol{u}\|^2 - 2\lambda(\boldsymbol{u} \cdot \boldsymbol{v}) + \lambda^2\|\boldsymbol{v}\|^2
$$</p>
<p>è¿™æ˜¯å…³äº $\lambda$ çš„äºŒæ¬¡å‡½æ•°ï¼Œå…¶åˆ¤åˆ«å¼å¿…é¡»éæ­£ï¼š</p>
<p>$$
\Delta = 4(\boldsymbol{u} \cdot \boldsymbol{v})^2 - 4\|\boldsymbol{u}\|^2\|\boldsymbol{v}\|^2 \leq 0
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
(\boldsymbol{u} \cdot \boldsymbol{v})^2 \leq \|\boldsymbol{u}\|^2\|\boldsymbol{v}\|^2
$$</p>
<p>å–å¹³æ–¹æ ¹å³å¾—ç»“è®ºã€‚</p>
<h4 id="62">6.2 åº”ç”¨åˆ°ç¬¬ä¸€é¡¹</h4>
<p><strong>æ¨å¯¼6.1</strong>ï¼šå¯¹ç¬¬ä¸€é¡¹åº”ç”¨Cauchy-Schwarzä¸ç­‰å¼ã€‚</p>
<p>$$
\begin{aligned}
&\,\mathbb{E}_{\boldsymbol{z}}[(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t))] \\
\leq&\, \mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{x}_t - \boldsymbol{y}_t\| \cdot \|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|]
\end{aligned}
$$</p>
<p>è¿™æ˜¯å‘é‡Cauchy-Schwarzä¸ç­‰å¼çš„ç›´æ¥åº”ç”¨ã€‚æ³¨æ„è¿™é‡Œä¸¤è¾¹éƒ½å¯èƒ½æ˜¯è´Ÿæ•°ï¼Œä½†å–ç»å¯¹å€¼åä¸ç­‰å¼ä¾ç„¶æˆç«‹ã€‚</p>
<h4 id="63-cauchy-schwarz">6.3 æœŸæœ›å½¢å¼çš„Cauchy-Schwarzä¸ç­‰å¼</h4>
<p><strong>å¼•ç†6.2ï¼ˆæœŸæœ›ç‰ˆCauchy-Schwarzï¼‰</strong>ï¼šå¯¹äºéšæœºå˜é‡ $X, Y$ï¼š</p>
<p>$$
|\mathbb{E}[XY]| \leq \mathbb{E}[|XY|] \leq \sqrt{\mathbb{E}[X^2]} \sqrt{\mathbb{E}[Y^2]}
$$</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼š</p>
<p>ä¸å‘é‡ç‰ˆæœ¬ç±»ä¼¼ï¼Œè€ƒè™‘ $\mathbb{E}[(X - \lambda Y)^2] \geq 0$ï¼š</p>
<p>$$
\mathbb{E}[X^2] - 2\lambda\mathbb{E}[XY] + \lambda^2\mathbb{E}[Y^2] \geq 0
$$</p>
<p>åˆ¤åˆ«å¼éæ­£ï¼š</p>
<p>$$
4(\mathbb{E}[XY])^2 - 4\mathbb{E}[X^2]\mathbb{E}[Y^2] \leq 0
$$</p>
<h4 id="64">6.4 åº”ç”¨åˆ°æ”¾ç¼©è¿‡ç¨‹</h4>
<p><strong>æ¨å¯¼6.2</strong>ï¼šç»§ç»­å¯¹ç¬¬ä¸€é¡¹è¿›è¡Œæ”¾ç¼©ã€‚</p>
<p>$$
\begin{aligned}
&\,\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{x}_t - \boldsymbol{y}_t\| \cdot \|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|] \\
\leq&\, \sqrt{\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2]} \cdot \sqrt{\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]} \\
=&\, \tilde{\mathcal{W}}_2[p_t, q_t] \cdot \sqrt{\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]}
\end{aligned}
$$</p>
<p>è¿™é‡Œåˆ©ç”¨äº† $\tilde{\mathcal{W}}<em _boldsymbol_z="\boldsymbol{z">2^2[p_t, q_t] = \mathbb{E}</em>_t|^2]$ã€‚}}[|\boldsymbol{x}_t - \boldsymbol{y</p>
<h4 id="65">6.5 åº”ç”¨åˆ°ç¬¬äºŒé¡¹</h4>
<p><strong>æ¨å¯¼6.3</strong>ï¼šå¯¹ç¬¬äºŒé¡¹åº”ç”¨å•ä¾§Lipschitzæ¡ä»¶ã€‚</p>
<p>æ ¹æ®å•ä¾§Lipschitzæ¡ä»¶ï¼ˆå¼ $\eqref{eq:assum}$ï¼‰ï¼š</p>
<p>$$
(\boldsymbol{g}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t)) \cdot (\boldsymbol{x}_t - \boldsymbol{y}_t) \leq L_t\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2
$$</p>
<p>å–æœŸæœ›ï¼š</p>
<p>$$
\mathbb{E}_{\boldsymbol{z}}[(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{g}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t))] \leq L_t\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2] = L_t\tilde{\mathcal{W}}_2^2[p_t, q_t]
$$</p>
<h3 id="7">7. å¾®åˆ†ä¸ç­‰å¼çš„æ±‚è§£</h3>
<h4 id="71">7.1 ç»¼åˆä¸¤é¡¹å¾—åˆ°å¾®åˆ†ä¸ç­‰å¼</h4>
<p><strong>æ¨å¯¼7.1</strong>ï¼šåˆå¹¶æ‰€æœ‰ä¸ç­‰å¼ã€‚</p>
<p>å°†å‰é¢çš„ç»“æœä»£å›åŸå¯¼æ•°è¡¨è¾¾å¼ï¼š</p>
<p>$$
\begin{aligned}
\frac{d}{dt}\tilde{\mathcal{W}}_2^2[p_t, q_t]
&= 2\mathbb{E}_{\boldsymbol{z}}[(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t))] \\
&\quad + 2\mathbb{E}_{\boldsymbol{z}}[(\boldsymbol{x}_t - \boldsymbol{y}_t) \cdot (\boldsymbol{g}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{y}_t))] \\
&\leq 2\tilde{\mathcal{W}}_2[p_t, q_t] \sqrt{\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]} + 2L_t\tilde{\mathcal{W}}_2^2[p_t, q_t]
\end{aligned}
$$</p>
<h4 id="72">7.2 è½¬æ¢ä¸ºä¸€é˜¶å¾®åˆ†ä¸ç­‰å¼</h4>
<p><strong>æ¨å¯¼7.2</strong>ï¼šä»äºŒé˜¶åˆ°ä¸€é˜¶ã€‚</p>
<p>è®¾ $W_t = \tilde{\mathcal{W}}_2[p_t, q_t]$ï¼Œåˆ™ $W_t^2 = \tilde{\mathcal{W}}_2^2[p_t, q_t]$ã€‚</p>
<p>æ±‚å¯¼ï¼š</p>
<p>$$
\frac{d(W_t^2)}{dt} = 2W_t\frac{dW_t}{dt}
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
2W_t\frac{dW_t}{dt} \leq 2W_t\sqrt{\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]} + 2L_tW_t^2
$$</p>
<p>é™¤ä»¥ $2W_t$ï¼ˆå‡è®¾ $W_t &gt; 0$ï¼‰ï¼š</p>
<p>$$
\frac{dW_t}{dt} \leq \sqrt{\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]} + L_tW_t
$$</p>
<p>ä¸ºäº†å¤„ç†åå‘æ—¶é—´ï¼Œæˆ‘ä»¬è€ƒè™‘ $-\frac{dW_t}{dt}$ï¼š</p>
<p>$$
-\frac{dW_t}{dt} \leq \sqrt{\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]} + L_tW_t
$$</p>
<h4 id="73-variation-of-constants">7.3 å¸¸æ•°å˜æ˜“æ³•ï¼ˆVariation of Constantsï¼‰</h4>
<p><strong>æ¨å¯¼7.3</strong>ï¼šæ±‚è§£çº¿æ€§éé½æ¬¡å¾®åˆ†ä¸ç­‰å¼ã€‚</p>
<p>æ ‡å‡†å½¢å¼çš„å¾®åˆ†ä¸ç­‰å¼ï¼š</p>
<p>$$
-\frac{dW_t}{dt} \leq F_t + L_tW_t
$$</p>
<p>å…¶ä¸­ $F_t = \sqrt{\mathbb{E}_{\boldsymbol{z}}[|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)|^2]}$ã€‚</p>
<p>è¿™æ˜¯ä¸€ä¸ªä¸€é˜¶çº¿æ€§å¾®åˆ†ä¸ç­‰å¼ã€‚ä½¿ç”¨å¸¸æ•°å˜æ˜“æ³•ï¼Œè®¾ï¼š</p>
<p>$$
W_t = C_t e^{\int_t^T L_s ds}
$$</p>
<p>ä»£å…¥ä¸ç­‰å¼ï¼š</p>
<p>$$
-\frac{dC_t}{dt}e^{\int_t^T L_s ds} + C_t e^{\int_t^T L_s ds} \cdot L_t \leq F_t + L_t C_t e^{\int_t^T L_s ds}
$$</p>
<p>ç®€åŒ–ï¼š</p>
<p>$$
-\frac{dC_t}{dt}e^{\int_t^T L_s ds} \leq F_t
$$</p>
<p>$$
-\frac{dC_t}{dt} \leq F_t e^{-\int_t^T L_s ds}
$$</p>
<h4 id="74">7.4 ç§¯åˆ†æ±‚è§£</h4>
<p><strong>æ¨å¯¼7.4</strong>ï¼šå¯¹æ—¶é—´ç§¯åˆ†ã€‚</p>
<p>å¯¹ä¸Šå¼ä» $0$ åˆ° $T$ ç§¯åˆ†ï¼š</p>
<p>$$
\int_0^T \left(-\frac{dC_t}{dt}\right) dt \leq \int_0^T F_t e^{-\int_t^T L_s ds} dt
$$</p>
<p>å·¦è¾¹ï¼š</p>
<p>$$
\int_0^T \left(-\frac{dC_t}{dt}\right) dt = C_0 - C_T
$$</p>
<p>åˆå§‹æ¡ä»¶ï¼š$W_T = 0$ï¼ˆå› ä¸ºä¸¤æ¡è½¨è¿¹ä»åŒä¸€ç‚¹å‡ºå‘ï¼‰ï¼Œæ‰€ä»¥ï¼š</p>
<p>$$
C_T = W_T e^{-\int_T^T L_s ds} = 0
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
C_0 \leq \int_0^T F_t e^{-\int_t^T L_s ds} dt
$$</p>
<h4 id="75">7.5 å¾—åˆ°æœ€ç»ˆä¼°è®¡</h4>
<p><strong>æ¨å¯¼7.5</strong>ï¼šæ¢å¤åŸå˜é‡ã€‚</p>
<p>ç”± $W_0 = C_0 e^{\int_0^T L_s ds}$ï¼š</p>
<p>$$
W_0 = C_0 e^{\int_0^T L_s ds} \leq e^{\int_0^T L_s ds} \int_0^T F_t e^{-\int_t^T L_s ds} dt
$$</p>
<p>æ”¹å†™æŒ‡æ•°éƒ¨åˆ†ï¼š</p>
<p>$$
e^{\int_0^T L_s ds} \cdot e^{-\int_t^T L_s ds} = e^{\int_0^t L_s ds}
$$</p>
<p>å®šä¹‰ $I_t = e^{\int_0^t L_s ds}$ï¼Œå¾—åˆ°ï¼š</p>
<p>$$
W_0 \leq \int_0^T I_t F_t dt
$$</p>
<p>å³ï¼š</p>
<p>$$
\tilde{\mathcal{W}}_2[p_0, q_0] \leq \int_0^T I_t \sqrt{\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]} dt
$$</p>
<h3 id="8">8. ä»è½¨è¿¹æœŸæœ›åˆ°åˆ†å¸ƒæœŸæœ›</h3>
<h4 id="81">8.1 æµ‹åº¦å˜æ¢</h4>
<p><strong>æ¨å¯¼8.1</strong>ï¼šæœŸæœ›çš„ç­‰ä»·è¡¨è¾¾ã€‚</p>
<p>æ³¨æ„åˆ° $\boldsymbol{x}_t$ æ˜¯ $\boldsymbol{z}$ çš„ç¡®å®šæ€§å‡½æ•°ï¼Œå³ $\boldsymbol{x}_t = \boldsymbol{x}_t(\boldsymbol{z})$ã€‚</p>
<p>å¯¹äºä»»æ„å‡½æ•° $h(\boldsymbol{x}_t)$ï¼š</p>
<p>$$
\mathbb{E}_{\boldsymbol{z} \sim q}[h(\boldsymbol{x}_t(\boldsymbol{z}))] = \int h(\boldsymbol{x}_t(\boldsymbol{z})) q(\boldsymbol{z}) d\boldsymbol{z}
$$</p>
<p>ä½¿ç”¨æ¨å‰æµ‹åº¦çš„å®šä¹‰ï¼Œ$p_t = (\boldsymbol{x}<em _35_="#">t)</em>q$ æ„å‘³ç€ï¼š</p>
<p>$$
\int h(\boldsymbol{x}) p_t(\boldsymbol{x}) d\boldsymbol{x} = \int h(\boldsymbol{x}_t(\boldsymbol{z})) q(\boldsymbol{z}) d\boldsymbol{z}
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
\mathbb{E}_{\boldsymbol{z} \sim q}[h(\boldsymbol{x}_t(\boldsymbol{z}))] = \mathbb{E}_{\boldsymbol{x}_t \sim p_t}[h(\boldsymbol{x}_t)]
$$</p>
<h4 id="82">8.2 åº”ç”¨åˆ°ä¸ç­‰å¼</h4>
<p><strong>æ¨å¯¼8.2</strong>ï¼šæ”¹å†™æœŸæœ›çš„ä¸‹æ ‡ã€‚</p>
<p>åº”ç”¨ä¸Šè¿°æµ‹åº¦å˜æ¢ï¼š</p>
<p>$$
\mathbb{E}_{\boldsymbol{z}}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2] = \mathbb{E}_{\boldsymbol{x}_t \sim p_t}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]
$$</p>
<p>ä»£å…¥ä¹‹å‰çš„ä¸ç­‰å¼ï¼š</p>
<p>$$
\tilde{\mathcal{W}}_2[p_0, q_0] \leq \int_0^T I_t \sqrt{\mathbb{E}_{\boldsymbol{x}_t \sim p_t}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]} dt
$$</p>
<p>ç»“åˆ $\mathcal{W}_2[p_0, q_0] \leq \tilde{\mathcal{W}}_2[p_0, q_0]$ï¼Œå¾—åˆ°ï¼š</p>
<p>$$
\mathcal{W}_2[p_0, q_0] \leq \int_0^T I_t \left(\mathbb{E}_{\boldsymbol{x}_t \sim p_t}[\|\boldsymbol{f}_t(\boldsymbol{x}_t) - \boldsymbol{g}_t(\boldsymbol{x}_t)\|^2]\right)^{1/2} dt
$$</p>
<p>è¿™å°±æ˜¯å¼ $\eqref{eq:w-neq-0}$ çš„å®Œæ•´æ¨å¯¼ã€‚</p>
<h3 id="9">9. æ¨å¹¿åˆ°ä¸åŒåˆå§‹åˆ†å¸ƒ</h3>
<h4 id="91">9.1 æœ€ä¼˜ä¼ è¾“è€¦åˆ</h4>
<p><strong>æ¨å¯¼9.1</strong>ï¼šæ„é€ è·¨åˆ†å¸ƒçš„ä¼ è¾“æ–¹æ¡ˆã€‚</p>
<p>ç°åœ¨è€ƒè™‘ä¸¤ä¸ªä¸åŒçš„åˆå§‹åˆ†å¸ƒ $p_T(\boldsymbol{z}_1)$ å’Œ $q_T(\boldsymbol{z}_2)$ã€‚</p>
<p>è®¾ $\gamma^*(\boldsymbol{z}_1, \boldsymbol{z}_2)$ æ˜¯ $p_T$ å’Œ $q_T$ ä¹‹é—´çš„æœ€ä¼˜ä¼ è¾“è®¡åˆ’ï¼Œå³ï¼š</p>
<p>$$
\mathcal{W}_2^2[p_T, q_T] = \int \|\boldsymbol{z}_1 - \boldsymbol{z}_2\|^2 d\gamma^*(\boldsymbol{z}_1, \boldsymbol{z}_2)
$$</p>
<p>ä» $\boldsymbol{z}_1 \sim p_T$ å‡ºå‘è¿è¡Œç¬¬ä¸€ä¸ªODEå¾—åˆ° $\boldsymbol{x}_t(\boldsymbol{z}_1)$ã€‚</p>
<p>ä» $\boldsymbol{z}_2 \sim q_T$ å‡ºå‘è¿è¡Œç¬¬äºŒä¸ªODEå¾—åˆ° $\boldsymbol{y}_t(\boldsymbol{z}_2)$ã€‚</p>
<p>å®šä¹‰æ—¶åˆ» $t$ çš„è”åˆåˆ†å¸ƒï¼š</p>
<p>$$
\gamma_t(\boldsymbol{x}, \boldsymbol{y}) = \int \gamma^*(\boldsymbol{z}_1, \boldsymbol{z}_2) \delta(\boldsymbol{x} - \boldsymbol{x}_t(\boldsymbol{z}_1)) \delta(\boldsymbol{y} - \boldsymbol{y}_t(\boldsymbol{z}_2)) d\boldsymbol{z}_1 d\boldsymbol{z}_2
$$</p>
<h4 id="92">9.2 ä¸Šç•Œçš„æ„é€ </h4>
<p><strong>æ¨å¯¼9.2</strong>ï¼šå»ºç«‹æ–°çš„ä¸Šç•Œã€‚</p>
<p>ç±»ä¼¼ä¹‹å‰çš„åˆ†æï¼š</p>
<p>$$
\begin{aligned}
\mathcal{W}_2^2[p_t, q_t]
&\leq \int \|\boldsymbol{x} - \boldsymbol{y}\|^2 d\gamma_t(\boldsymbol{x}, \boldsymbol{y}) \\
&= \iint \|\boldsymbol{x}_t(\boldsymbol{z}_1) - \boldsymbol{y}_t(\boldsymbol{z}_2)\|^2 d\gamma^*(\boldsymbol{z}_1, \boldsymbol{z}_2) \\
&= \mathbb{E}_{(\boldsymbol{z}_1, \boldsymbol{z}_2) \sim \gamma^*}[\|\boldsymbol{x}_t - \boldsymbol{y}_t\|^2] \\
&\triangleq \tilde{\mathcal{W}}_2^2[p_t, q_t]
\end{aligned}
$$</p>
<h4 id="93">9.3 è¾¹ç•Œæ¡ä»¶çš„å˜åŒ–</h4>
<p><strong>æ¨å¯¼9.3</strong>ï¼šåˆå§‹æ—¶åˆ»çš„è·ç¦»ã€‚</p>
<p>å½“ $t = T$ æ—¶ï¼š</p>
<p>$$
\tilde{\mathcal{W}}_2^2[p_T, q_T] = \mathbb{E}_{(\boldsymbol{z}_1, \boldsymbol{z}_2) \sim \gamma^*}[\|\boldsymbol{x}_T - \boldsymbol{y}_T\|^2] = \mathbb{E}_{(\boldsymbol{z}_1, \boldsymbol{z}_2) \sim \gamma^*}[\|\boldsymbol{z}_1 - \boldsymbol{z}_2\|^2]
$$</p>
<p>ç”±äº $\gamma^*$ æ˜¯æœ€ä¼˜ä¼ è¾“è®¡åˆ’ï¼š</p>
<p>$$
\tilde{\mathcal{W}}_2^2[p_T, q_T] = \mathcal{W}_2^2[p_T, q_T]
$$</p>
<p>å› æ­¤è¾¹ç•Œæ¡ä»¶å˜ä¸ºï¼š</p>
<p>$$
C_T = W_T = \mathcal{W}_2[p_T, q_T]
$$</p>
<p>è€Œä¸æ˜¯ä¹‹å‰çš„ $C_T = 0$ã€‚</p>
<h4 id="94">9.4 ç§¯åˆ†æ—¶çš„ä¿®æ­£</h4>
<p><strong>æ¨å¯¼9.4</strong>ï¼šä¿®æ­£ç§¯åˆ†ç»“æœã€‚</p>
<p>å›åˆ°ç§¯åˆ†æ­¥éª¤ï¼š</p>
<p>$$
C_0 - C_T \leq \int_0^T F_t e^{-\int_t^T L_s ds} dt
$$</p>
<p>ç°åœ¨ $C_T = \mathcal{W}_2[p_T, q_T]$ï¼š</p>
<p>$$
C_0 \leq \int_0^T F_t e^{-\int_t^T L_s ds} dt + \mathcal{W}_2[p_T, q_T]
$$</p>
<p>ä¹˜ä»¥ $e^{\int_0^T L_s ds}$ï¼š</p>
<p>$$
W_0 \leq \int_0^T I_t F_t dt + I_T \mathcal{W}_2[p_T, q_T]
$$</p>
<p>å…¶ä¸­ $I_T = e^{\int_0^T L_s ds}$ã€‚</p>
<h3 id="10">10. åº”ç”¨åˆ°æ‰©æ•£æ¨¡å‹</h3>
<h4 id="101-sdeode">10.1 åå‘SDEçš„ODEå½¢å¼</h4>
<p><strong>æ¨å¯¼10.1</strong>ï¼šä»SDEåˆ°ODEã€‚</p>
<p>æ‰©æ•£æ¨¡å‹çš„ä¸€èˆ¬åå‘SDEï¼ˆå¼ $\eqref{eq:sde-reverse-2}$ï¼‰ï¼š</p>
<p>$$
d\boldsymbol{x}_t = \left[\boldsymbol{f}_t(\boldsymbol{x}_t) - \frac{1}{2}(g_t^2 + \sigma_t^2)\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t)\right]dt + \sigma_t d\boldsymbol{w}
$$</p>
<p>å½“ $\sigma_t = 0$ æ—¶ï¼Œé€€åŒ–ä¸ºODEï¼š</p>
<p>$$
\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{f}_t(\boldsymbol{x}_t) - \frac{1}{2}g_t^2\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t)
$$</p>
<p>è¿™æ˜¯æ¦‚ç‡æµODEï¼ˆProbability Flow ODEï¼‰ã€‚</p>
<h4 id="102">10.2 å¾—åˆ†å‡½æ•°çš„è¿‘ä¼¼</h4>
<p><strong>æ¨å¯¼10.2</strong>ï¼šç¥ç»ç½‘ç»œè¿‘ä¼¼çš„ODEã€‚</p>
<p>ç”¨ç¥ç»ç½‘ç»œ $\boldsymbol{s}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$ è¿‘ä¼¼ $\nabla</em>_t)$ï¼Œå¾—åˆ°è¿‘ä¼¼ODEï¼š}_t}\log p_t(\boldsymbol{x</p>
<p>$$
\frac{d\boldsymbol{y}_t}{dt} = \boldsymbol{f}_t(\boldsymbol{y}_t) - \frac{1}{2}g_t^2\boldsymbol{s}_{\boldsymbol{\theta}}(\boldsymbol{y}_t, t)
$$</p>
<p>ä¸¤ä¸ªODEçš„å·®å¼‚ä¸ºï¼š</p>
<p>$$
\begin{aligned}
&\,\boldsymbol{f}_t(\boldsymbol{x}_t) - \frac{1}{2}g_t^2\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t) - \left[\boldsymbol{f}_t(\boldsymbol{x}_t) - \frac{1}{2}g_t^2\boldsymbol{s}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right] \\
=&\, -\frac{1}{2}g_t^2\left[\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t) - \boldsymbol{s}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right]
\end{aligned}
$$</p>
<h4 id="103">10.3 ä»£å…¥ä¸ç­‰å¼</h4>
<p><strong>æ¨å¯¼10.3</strong>ï¼šå¾—åˆ†åŒ¹é…æŸå¤±çš„å‡ºç°ã€‚</p>
<p>å°†å‘é‡åœºå·®å¼‚ä»£å…¥ä¹‹å‰çš„ä¸ç­‰å¼ï¼š</p>
<p>$$
\begin{aligned}
&\,\mathcal{W}_2[p_0, q_0] \\
\leq&\, \int_0^T I_t \left(\mathbb{E}_{\boldsymbol{x}_t \sim p_t}\left[\left\|\frac{1}{2}g_t^2\left[\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t) - \boldsymbol{s}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right]\right\|^2\right]\right)^{1/2} dt \\
&\, + I_T\mathcal{W}_2[p_T, q_T] \\
=&\, \int_0^T I_t \frac{g_t^2}{2} \left(\mathbb{E}_{\boldsymbol{x}_t \sim p_t}\left[\left\|\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t) - \boldsymbol{s}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right\|^2\right]\right)^{1/2} dt \\
&\, + I_T\mathcal{W}_2[p_T, q_T]
\end{aligned}
$$</p>
<p>è¿™æ­£æ˜¯æ–‡ç« å¼€å¤´çš„æ ¸å¿ƒä¸ç­‰å¼ $\eqref{eq:w-neq}$ï¼ˆå– $g_t^2 I_t/2$ ä¸ºæ–°çš„æƒé‡å‡½æ•°ï¼‰ã€‚</p>
<h3 id="11-lipschitz">11. å¾—åˆ†å‡½æ•°çš„Lipschitzæ€§è´¨</h3>
<h4 id="111">11.1 å¯¹æ•°å¯†åº¦æ¢¯åº¦çš„æ€§è´¨</h4>
<p><strong>å‘½é¢˜11.1</strong>ï¼šå¯¹äºå…‰æ»‘çš„æ¦‚ç‡å¯†åº¦ $p(\boldsymbol{x})$ï¼Œå¾—åˆ†å‡½æ•° $\nabla_{\boldsymbol{x}}\log p(\boldsymbol{x})$ çš„Lipschitzæ€§è´¨ä¸å¯†åº¦çš„HessiançŸ©é˜µæœ‰å…³ã€‚</p>
<p><strong>æ¨å¯¼11.1</strong>ï¼šè®¡ç®—å¾—åˆ†å‡½æ•°çš„Jacobianã€‚</p>
<p>è®¾ $\boldsymbol{s}(\boldsymbol{x}) = \nabla_{\boldsymbol{x}}\log p(\boldsymbol{x})$ï¼Œè®¡ç®—å…¶JacobiançŸ©é˜µï¼š</p>
<p>$$
\begin{aligned}
J_{ij} = \frac{\partial s_i}{\partial x_j}
&= \frac{\partial}{\partial x_j}\left(\frac{\partial \log p}{\partial x_i}\right) \\
&= \frac{\partial}{\partial x_j}\left(\frac{1}{p}\frac{\partial p}{\partial x_i}\right) \\
&= -\frac{1}{p^2}\frac{\partial p}{\partial x_j}\frac{\partial p}{\partial x_i} + \frac{1}{p}\frac{\partial^2 p}{\partial x_i \partial x_j}
\end{aligned}
$$</p>
<p>ç”¨å¾—åˆ†å‡½æ•°è¡¨ç¤ºï¼š</p>
<p>$$
J_{ij} = -s_i(\boldsymbol{x})s_j(\boldsymbol{x}) + \frac{\partial s_i}{\partial x_j}
$$</p>
<p>è¿™æ˜¯ä¸€ä¸ªéçº¿æ€§è¡¨è¾¾å¼ï¼Œè¯´æ˜å¾—åˆ†å‡½æ•°çš„Lipschitzæ€§è´¨ä¾èµ–äºå¯†åº¦æœ¬èº«ã€‚</p>
<h4 id="112-log-">11.2 å¼ºlog-å‡¹åˆ†å¸ƒçš„æƒ…å†µ</h4>
<p><strong>å®šä¹‰11.1ï¼ˆå¼ºlog-å‡¹ï¼‰</strong>ï¼šå¦‚æœå¯†åº¦ $p(\boldsymbol{x})$ æ»¡è¶³ $-\log p(\boldsymbol{x})$ æ˜¯å¼ºå‡¸çš„ï¼Œå³ï¼š</p>
<p>$$
-\nabla^2 \log p(\boldsymbol{x}) \succeq m I
$$</p>
<p>å¯¹æŸä¸ª $m &gt; 0$ï¼Œåˆ™ç§° $p$ æ˜¯ $m$-å¼ºlog-å‡¹çš„ã€‚</p>
<p><strong>æ¨å¯¼11.2</strong>ï¼šå¼ºlog-å‡¹åˆ†å¸ƒçš„å•ä¾§Lipschitzæ€§ã€‚</p>
<p>å¯¹äºå¼ºlog-å‡¹åˆ†å¸ƒï¼š</p>
<p>$$
\nabla^2 \log p(\boldsymbol{x}) \preceq -m I
$$</p>
<p>å¾—åˆ†å‡½æ•°çš„Jacobianï¼š</p>
<p>$$
\nabla \boldsymbol{s}(\boldsymbol{x}) = \nabla^2 \log p(\boldsymbol{x}) \preceq -m I
$$</p>
<p>å› æ­¤ï¼Œå¯¹äºä»»æ„ $\boldsymbol{x}, \boldsymbol{y}$ï¼š</p>
<p>$$
\begin{aligned}
&\,(\boldsymbol{s}(\boldsymbol{x}) - \boldsymbol{s}(\boldsymbol{y})) \cdot (\boldsymbol{x} - \boldsymbol{y}) \\
=&\, \int_0^1 (\boldsymbol{x} - \boldsymbol{y})^T \nabla\boldsymbol{s}(t\boldsymbol{x} + (1-t)\boldsymbol{y}) (\boldsymbol{x} - \boldsymbol{y}) dt \\
\leq&\, -m\|\boldsymbol{x} - \boldsymbol{y}\|^2
\end{aligned}
$$</p>
<p>è¿™è¡¨æ˜å¼ºlog-å‡¹åˆ†å¸ƒçš„å¾—åˆ†å‡½æ•°æ»¡è¶³å•ä¾§Lipschitzæ¡ä»¶ï¼ˆå¸¸æ•°ä¸º $-m &lt; 0$ï¼‰ã€‚</p>
<h4 id="113">11.3 é«˜æ–¯åˆ†å¸ƒçš„ä¾‹å­</h4>
<p><strong>ä¾‹11.1ï¼ˆé«˜æ–¯åˆ†å¸ƒï¼‰</strong>ï¼šå¯¹äºé«˜æ–¯åˆ†å¸ƒ $p(\boldsymbol{x}) = \mathcal{N}(\boldsymbol{\mu}, \Sigma)$ï¼š</p>
<p>$$
\log p(\boldsymbol{x}) = -\frac{1}{2}(\boldsymbol{x} - \boldsymbol{\mu})^T\Sigma^{-1}(\boldsymbol{x} - \boldsymbol{\mu}) + \text{const}
$$</p>
<p>å¾—åˆ†å‡½æ•°ï¼š</p>
<p>$$
\boldsymbol{s}(\boldsymbol{x}) = \nabla_{\boldsymbol{x}}\log p(\boldsymbol{x}) = -\Sigma^{-1}(\boldsymbol{x} - \boldsymbol{\mu})
$$</p>
<p>è¿™æ˜¯ä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œå…¶Jacobianä¸ºï¼š</p>
<p>$$
\nabla \boldsymbol{s}(\boldsymbol{x}) = -\Sigma^{-1}
$$</p>
<p>å¯¹äºå•ä½åæ–¹å·® $\Sigma = I$ï¼š</p>
<p>$$
\nabla \boldsymbol{s}(\boldsymbol{x}) = -I
$$</p>
<p>å› æ­¤æ»¡è¶³å•ä¾§Lipschitzæ¡ä»¶ï¼ˆå¸¸æ•° $L = -1$ï¼‰ã€‚</p>
<h3 id="12_1">12. æ¡ä»¶å¾—åˆ†åŒ¹é…</h3>
<h4 id="121">12.1 æ¡ä»¶æœŸæœ›çš„æ€§è´¨</h4>
<p><strong>æ¨å¯¼12.1</strong>ï¼šä»æ— æ¡ä»¶å¾—åˆ†åˆ°æ¡ä»¶å¾—åˆ†ã€‚</p>
<p>åˆ©ç”¨æ¡ä»¶æœŸæœ›ï¼Œå¾—åˆ†å‡½æ•°å¯ä»¥å†™ä¸ºï¼š</p>
<p>$$
\begin{aligned}
\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t)
&= \nabla_{\boldsymbol{x}_t}\log \int p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)p_0(\boldsymbol{x}_0) d\boldsymbol{x}_0 \\
&= \frac{\int \nabla_{\boldsymbol{x}_t}p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)p_0(\boldsymbol{x}_0) d\boldsymbol{x}_0}{p_t(\boldsymbol{x}_t)} \\
&= \frac{\int p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)p_0(\boldsymbol{x}_0) d\boldsymbol{x}_0}{p_t(\boldsymbol{x}_t)}
\end{aligned}
$$</p>
<h4 id="122">12.2 åéªŒåˆ†å¸ƒ</h4>
<p><strong>æ¨å¯¼12.2</strong>ï¼šåˆ©ç”¨è´å¶æ–¯å…¬å¼ã€‚</p>
<p>ç”±è´å¶æ–¯å…¬å¼ï¼š</p>
<p>$$
p_t(\boldsymbol{x}_0|\boldsymbol{x}_t) = \frac{p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)p_0(\boldsymbol{x}_0)}{p_t(\boldsymbol{x}_t)}
$$</p>
<p>å› æ­¤ï¼š</p>
<p>$$
\begin{aligned}
\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t)
&= \int \nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x}_0) p_t(\boldsymbol{x}_0|\boldsymbol{x}_t) d\boldsymbol{x}_0 \\
&= \mathbb{E}_{\boldsymbol{x}_0 \sim p_t(\boldsymbol{x}_0|\boldsymbol{x}_t)}[\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)]
\end{aligned}
$$</p>
<p>è¿™å°±æ˜¯æ¡ä»¶æœŸæœ›çš„å½¢å¼ã€‚</p>
<h4 id="123-jensen">12.3 Jensenä¸ç­‰å¼çš„åº”ç”¨</h4>
<p><strong>æ¨å¯¼12.3</strong>ï¼šä»æ¡ä»¶å¾—åˆ†åŒ¹é…åˆ°æ— æ¡ä»¶å¾—åˆ†åŒ¹é…ã€‚</p>
<p>è€ƒè™‘æŸå¤±å‡½æ•°ï¼š</p>
<p>$$
\mathcal{L}_1 = \mathbb{E}_{\boldsymbol{x}_t}[\|\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t) - \boldsymbol{s}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\|^2]
$$</p>
<p>åˆ©ç”¨æ¡ä»¶æœŸæœ›ï¼š</p>
<p>$$
\begin{aligned}
\mathcal{L}_1
&= \mathbb{E}_{\boldsymbol{x}_t}\left[\left\|\mathbb{E}_{\boldsymbol{x}_0|\boldsymbol{x}_t}[\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)] - \boldsymbol{s}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right\|^2\right]
\end{aligned}
$$</p>
<p>æ¡ä»¶å¾—åˆ†åŒ¹é…æŸå¤±ï¼š</p>
<p>$$
\mathcal{L}_2 = \mathbb{E}_{\boldsymbol{x}_t}\mathbb{E}_{\boldsymbol{x}_0|\boldsymbol{x}_t}[\|\nabla_{\boldsymbol{x}_t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x}_0) - \boldsymbol{s}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\|^2]
$$</p>
<p>ç”±Jensenä¸ç­‰å¼ï¼ˆ$\mathbb{E}[X]$ çš„å¹³æ–¹å°äºç­‰äº $\mathbb{E}[X^2]$ï¼‰ï¼š</p>
<p>$$
\mathbb{E}_{\boldsymbol{x}_0|\boldsymbol{x}_t}[\|\boldsymbol{g}(\boldsymbol{x}_0) - \boldsymbol{c}\|^2] \geq \|\mathbb{E}_{\boldsymbol{x}_0|\boldsymbol{x}_t}[\boldsymbol{g}(\boldsymbol{x}_0)] - \boldsymbol{c}\|^2
$$</p>
<p>å– $\boldsymbol{g}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">0) = \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p_t(\boldsymbol{x}_t|\boldsymbol{x}_0)$ï¼Œ$\boldsymbol{c} = \boldsymbol{s}</em>_t, t)$ï¼š}}(\boldsymbol{x</p>
<p>$$
\mathcal{L}_1 \leq \mathcal{L}_2
$$</p>
<p>å› æ­¤ï¼Œä¼˜åŒ–æ¡ä»¶å¾—åˆ†åŒ¹é…ä¹Ÿä¼šä¼˜åŒ–æ— æ¡ä»¶å¾—åˆ†åŒ¹é…ã€‚</p>
<h3 id="13">13. æ€»ç»“ä¸å±•æœ›</h3>
<p>é€šè¿‡ä»¥ä¸Šè¯¦å°½çš„æ¨å¯¼ï¼Œæˆ‘ä»¬å®Œæˆäº†ä»Wassersteinè·ç¦»çš„åŸºæœ¬å®šä¹‰åˆ°æ‰©æ•£æ¨¡å‹å¾—åˆ†åŒ¹é…æŸå¤±ä¸Šç•Œçš„å®Œæ•´è¯æ˜é“¾æ¡ã€‚ä¸»è¦æŠ€æœ¯è¦ç‚¹åŒ…æ‹¬ï¼š</p>
<ol>
<li>
<p><strong>Wassersteinè·ç¦»çš„ä¸‹ç¡®ç•Œæ€§è´¨</strong>ï¼šå…è®¸æˆ‘ä»¬ç”¨ä»»æ„å¯è¡Œçš„ä¼ è¾“æ–¹æ¡ˆæ„é€ ä¸Šç•Œã€‚</p>
</li>
<li>
<p><strong>ODEè½¨è¿¹çš„ç¡®å®šæ€§è€¦åˆ</strong>ï¼šæä¾›äº†è‡ªç„¶çš„ä¼ è¾“æ–¹æ¡ˆã€‚</p>
</li>
<li>
<p><strong>Cauchy-Schwarzä¸ç­‰å¼</strong>ï¼šå…³é”®çš„æ”¾ç¼©å·¥å…·ã€‚</p>
</li>
<li>
<p><strong>å•ä¾§Lipschitzæ¡ä»¶</strong>ï¼šæ¯”æ ‡å‡†Lipschitzæ›´å¼±ä½†è¶³å¤Ÿçš„æ¡ä»¶ã€‚</p>
</li>
<li>
<p><strong>å¸¸æ•°å˜æ˜“æ³•</strong>ï¼šæ±‚è§£å¾®åˆ†ä¸ç­‰å¼çš„ç»å…¸æ–¹æ³•ã€‚</p>
</li>
<li>
<p><strong>æµ‹åº¦è®ºçš„ç­‰ä»·å˜æ¢</strong>ï¼šè¿æ¥è½¨è¿¹æœŸæœ›ä¸åˆ†å¸ƒæœŸæœ›ã€‚</p>
</li>
</ol>
<p>è¿™äº›æŠ€æœ¯çš„ç»¼åˆè¿ç”¨ï¼Œæœ€ç»ˆå»ºç«‹äº†å¾—åˆ†åŒ¹é…æŸå¤±ä½œä¸ºWassersteinè·ç¦»ä¸Šç•Œçš„ç†è®ºåŸºç¡€ï¼Œä¸ºç†è§£æ‰©æ•£æ¨¡å‹çš„ä¼˜åŒ–ç›®æ ‡æä¾›äº†æ–°çš„è§†è§’ã€‚</p>
        </div>
    </div>
</body>
</html>