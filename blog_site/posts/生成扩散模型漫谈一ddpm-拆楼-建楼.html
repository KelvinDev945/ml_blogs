<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸€ï¼‰ï¼šDDPM = æ‹†æ¥¼ + å»ºæ¥¼</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸€ï¼‰ï¼šDDPM = æ‹†æ¥¼ + å»ºæ¥¼</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 85.7 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9119">https://spaces.ac.cn/archives/9119</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>è¯´åˆ°ç”Ÿæˆæ¨¡å‹ï¼Œ<a href="/tag/vae/">VAE</a>ã€<a href="/tag/GAN/">GAN</a>å¯è°“æ˜¯â€œå¦‚é›·è´¯è€³â€ï¼Œæœ¬ç«™ä¹Ÿæœ‰è¿‡å¤šæ¬¡åˆ†äº«ã€‚æ­¤å¤–ï¼Œè¿˜æœ‰ä¸€äº›æ¯”è¾ƒå°ä¼—çš„é€‰æ‹©ï¼Œå¦‚<a href="/tag/flow/">flowæ¨¡å‹</a>ã€<a href="/archives/6760">VQ-VAE</a>ç­‰ï¼Œä¹Ÿé¢‡æœ‰äººæ°”ï¼Œå°¤å…¶æ˜¯VQ-VAEåŠå…¶å˜ä½“<a href="https://papers.cool/arxiv/2012.09841">VQ-GAN</a>ï¼Œè¿‘æœŸå·²ç»é€æ¸å‘å±•åˆ°â€œå›¾åƒçš„Tokenizerâ€çš„åœ°ä½ï¼Œç”¨æ¥ç›´æ¥è°ƒç”¨NLPçš„å„ç§é¢„è®­ç»ƒæ–¹æ³•ã€‚é™¤äº†è¿™äº›ä¹‹å¤–ï¼Œè¿˜æœ‰ä¸€ä¸ªæœ¬æ¥æ›´å°ä¼—çš„é€‰æ‹©â€”â€”æ‰©æ•£æ¨¡å‹ï¼ˆDiffusion Modelsï¼‰â€”â€”æ­£åœ¨ç”Ÿæˆæ¨¡å‹é¢†åŸŸâ€œå¼‚å†›çªèµ·â€ï¼Œå½“å‰æœ€å…ˆè¿›çš„ä¸¤ä¸ªæ–‡æœ¬ç”Ÿæˆå›¾åƒâ€”â€”OpenAIçš„<a href="https://papers.cool/arxiv/2204.06125">DALLÂ·E 2</a>å’ŒGoogleçš„<a href="https://papers.cool/arxiv/2205.11487">Imagen</a>ï¼Œéƒ½æ˜¯åŸºäºæ‰©æ•£æ¨¡å‹æ¥å®Œæˆçš„ã€‚</p>
<p><a href="/usr/uploads/2022/06/2782509104.jpg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="Imagenâ€œæ–‡æœ¬-å›¾ç‰‡â€çš„éƒ¨åˆ†ä¾‹å­" src="/usr/uploads/2022/06/2782509104.jpg" /></a></p>
<p>Imagenâ€œæ–‡æœ¬-å›¾ç‰‡â€çš„éƒ¨åˆ†ä¾‹å­</p>
<p>ä»æœ¬æ–‡å¼€å§‹ï¼Œæˆ‘ä»¬å¼€ä¸€ä¸ªæ–°å‘ï¼Œé€æ¸ä»‹ç»ä¸€ä¸‹è¿‘ä¸¤å¹´å…³äºç”Ÿæˆæ‰©æ•£æ¨¡å‹çš„ä¸€äº›è¿›å±•ã€‚æ®è¯´ç”Ÿæˆæ‰©æ•£æ¨¡å‹ä»¥æ•°å­¦å¤æ‚é—»åï¼Œä¼¼ä¹æ¯”VAEã€GANè¦éš¾ç†è§£å¾—å¤šï¼Œæ˜¯å¦çœŸçš„å¦‚æ­¤ï¼Ÿæ‰©æ•£æ¨¡å‹çœŸçš„åšä¸åˆ°ä¸€ä¸ªâ€œå¤§ç™½è¯â€çš„ç†è§£ï¼Ÿè®©æˆ‘ä»¬æ‹­ç›®ä»¥å¾…ã€‚</p>
<h2 id="_1">æ–°çš„èµ·ç‚¹</h2>
<p>å…¶å®æˆ‘ä»¬åœ¨ä¹‹å‰çš„æ–‡ç« <a href="/archives/6612">ã€Šèƒ½é‡è§†è§’ä¸‹çš„GANæ¨¡å‹ï¼ˆä¸‰ï¼‰ï¼šç”Ÿæˆæ¨¡å‹=èƒ½é‡æ¨¡å‹ã€‹</a>ã€<a href="/archives/7038">ã€Šä»å»å™ªè‡ªç¼–ç å™¨åˆ°ç”Ÿæˆæ¨¡å‹ã€‹</a>ä¹Ÿç®€å•ä»‹ç»è¿‡æ‰©æ•£æ¨¡å‹ã€‚è¯´åˆ°æ‰©æ•£æ¨¡å‹ï¼Œä¸€èˆ¬çš„æ–‡ç« éƒ½ä¼šæåˆ°èƒ½é‡æ¨¡å‹ï¼ˆEnergy-based Modelsï¼‰ã€å¾—åˆ†åŒ¹é…ï¼ˆScore Matchingï¼‰ã€æœ—ä¹‹ä¸‡æ–¹ç¨‹ï¼ˆLangevin Equationï¼‰ç­‰ç­‰ï¼Œç®€å•æ¥è¯´ï¼Œæ˜¯é€šè¿‡å¾—åˆ†åŒ¹é…ç­‰æŠ€æœ¯æ¥è®­ç»ƒèƒ½é‡æ¨¡å‹ï¼Œç„¶åé€šè¿‡éƒä¹‹ä¸‡æ–¹ç¨‹æ¥æ‰§è¡Œä»èƒ½é‡æ¨¡å‹çš„é‡‡æ ·ã€‚</p>
<p>ä»ç†è®ºä¸Šæ¥è®²ï¼Œè¿™æ˜¯ä¸€å¥—å¾ˆæˆç†Ÿçš„æ–¹æ¡ˆï¼ŒåŸåˆ™ä¸Šå¯ä»¥å®ç°ä»»ä½•è¿ç»­å‹å¯¹è±¡ï¼ˆè¯­éŸ³ã€å›¾åƒç­‰ï¼‰çš„ç”Ÿæˆå’Œé‡‡æ ·ã€‚ä½†ä»å®è·µè§’åº¦æ¥çœ‹ï¼Œèƒ½é‡å‡½æ•°çš„è®­ç»ƒæ˜¯ä¸€ä»¶å¾ˆè‰°éš¾çš„äº‹æƒ…ï¼Œå°¤å…¶æ˜¯æ•°æ®ç»´åº¦æ¯”è¾ƒå¤§ï¼ˆæ¯”å¦‚é«˜åˆ†è¾¨ç‡å›¾åƒï¼‰æ—¶ï¼Œå¾ˆéš¾è®­ç»ƒå‡ºå®Œå¤‡èƒ½é‡å‡½æ•°æ¥ï¼›å¦ä¸€æ–¹é¢ï¼Œé€šè¿‡æœ—ä¹‹ä¸‡æ–¹ç¨‹ä»èƒ½é‡æ¨¡å‹çš„é‡‡æ ·ä¹Ÿæœ‰å¾ˆå¤§çš„ä¸ç¡®å®šæ€§ï¼Œå¾—åˆ°çš„å¾€å¾€æ˜¯å¸¦æœ‰å™ªå£°çš„é‡‡æ ·ç»“æœã€‚æ‰€ä»¥å¾ˆé•¿æ—¶é—´ä»¥æ¥ï¼Œè¿™ç§ä¼ ç»Ÿè·¯å¾„çš„æ‰©æ•£æ¨¡å‹åªæ˜¯åœ¨æ¯”è¾ƒä½åˆ†è¾¨ç‡çš„å›¾åƒä¸Šåšå®éªŒã€‚</p>
<p>å¦‚ä»Šç”Ÿæˆæ‰©æ•£æ¨¡å‹çš„å¤§ç«ï¼Œåˆ™æ˜¯å§‹äº2020å¹´æ‰€æå‡ºçš„<a href="https://papers.cool/arxiv/2006.11239">DDPM</a>ï¼ˆDenoising Diffusion Probabilistic Modelï¼‰ï¼Œè™½ç„¶ä¹Ÿç”¨äº†â€œæ‰©æ•£æ¨¡å‹â€è¿™ä¸ªåå­—ï¼Œä½†äº‹å®ä¸Šé™¤äº†é‡‡æ ·è¿‡ç¨‹çš„å½¢å¼æœ‰ä¸€å®šçš„ç›¸ä¼¼ä¹‹å¤–ï¼ŒDDPMä¸ä¼ ç»ŸåŸºäºæœ—ä¹‹ä¸‡æ–¹ç¨‹é‡‡æ ·çš„æ‰©æ•£æ¨¡å‹å¯ä»¥è¯´å®Œå…¨ä¸ä¸€æ ·ï¼Œè¿™å®Œå…¨æ˜¯ä¸€ä¸ªæ–°çš„èµ·ç‚¹ã€æ–°çš„ç¯‡ç« ã€‚</p>
<p>å‡†ç¡®æ¥è¯´ï¼ŒDDPMå«â€œæ¸å˜æ¨¡å‹â€æ›´ä¸ºå‡†ç¡®ä¸€äº›ï¼Œæ‰©æ•£æ¨¡å‹è¿™ä¸€åå­—åè€Œå®¹æ˜“é€ æˆç†è§£ä¸Šçš„è¯¯è§£ï¼Œä¼ ç»Ÿæ‰©æ•£æ¨¡å‹çš„èƒ½é‡æ¨¡å‹ã€å¾—åˆ†åŒ¹é…ã€æœ—ä¹‹ä¸‡æ–¹ç¨‹ç­‰æ¦‚å¿µï¼Œå…¶å®è·ŸDDPMåŠå…¶åç»­å˜ä½“éƒ½æ²¡ä»€ä¹ˆå…³ç³»ã€‚æœ‰æ„æ€çš„æ˜¯ï¼ŒDDPMçš„æ•°å­¦æ¡†æ¶å…¶å®åœ¨ICML2015çš„è®ºæ–‡<a href="https://papers.cool/arxiv/1503.03585">ã€ŠDeep Unsupervised Learning using Nonequilibrium Thermodynamicsã€‹</a>å°±å·²ç»å®Œæˆäº†ï¼Œä½†DDPMæ˜¯é¦–æ¬¡å°†å®ƒåœ¨é«˜åˆ†è¾¨ç‡å›¾åƒç”Ÿæˆä¸Šè°ƒè¯•å‡ºæ¥äº†ï¼Œä»è€Œå¼•å¯¼å‡ºäº†åé¢çš„ç«çƒ­ã€‚ç”±æ­¤å¯è§ï¼Œä¸€ä¸ªæ¨¡å‹çš„è¯ç”Ÿå’Œæµè¡Œï¼Œå¾€å¾€è¿˜éœ€è¦æ—¶é—´å’Œæœºé‡ï¼Œ</p>
<h2 id="_2">æ‹†æ¥¼å»ºæ¥¼</h2>
<p>å¾ˆå¤šæ–‡ç« åœ¨ä»‹ç»DDPMæ—¶ï¼Œä¸Šæ¥å°±å¼•å…¥è½¬ç§»åˆ†å¸ƒï¼Œæ¥ç€å°±æ˜¯å˜åˆ†æ¨æ–­ï¼Œä¸€å †æ•°å­¦è®°å·ä¸‹æ¥ï¼Œå…ˆå“è·‘äº†ä¸€ç¾¤äººï¼ˆå½“ç„¶ï¼Œä»è¿™ç§ä»‹ç»æˆ‘ä»¬å¯ä»¥å†æ¬¡çœ‹å‡ºï¼ŒDDPMå®é™…ä¸Šæ˜¯VAEè€Œä¸æ˜¯æ‰©æ•£æ¨¡å‹ï¼‰ï¼Œå†åŠ ä¹‹äººä»¬å¯¹ä¼ ç»Ÿæ‰©æ•£æ¨¡å‹çš„å›ºæœ‰å°è±¡ï¼Œæ‰€ä»¥å°±å½¢æˆäº†â€œéœ€è¦å¾ˆé«˜æ·±çš„æ•°å­¦çŸ¥è¯†â€çš„é”™è§‰ã€‚äº‹å®ä¸Šï¼ŒDDPMä¹Ÿå¯ä»¥æœ‰ä¸€ç§å¾ˆâ€œå¤§ç™½è¯â€çš„ç†è§£ï¼Œå®ƒå¹¶ä¸æ¯”æœ‰ç€â€œé€ å‡-é‰´åˆ«â€é€šä¿—ç±»æ¯”çš„GANæ›´éš¾ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬æƒ³è¦åšä¸€ä¸ªåƒGANé‚£æ ·çš„ç”Ÿæˆæ¨¡å‹ï¼Œå®ƒå®é™…ä¸Šæ˜¯å°†ä¸€ä¸ªéšæœºå™ªå£°$\boldsymbol{z}$å˜æ¢æˆä¸€ä¸ªæ•°æ®æ ·æœ¬$\boldsymbol{x}$çš„è¿‡ç¨‹ï¼š<br />
\begin{equation}\require{AMScd}\begin{CD}<br />
\text{éšæœºå™ªå£°}\boldsymbol{z}\quad @&gt;\quad\text{å˜æ¢}\quad&gt;&gt; \quad\text{æ ·æœ¬æ•°æ®}\boldsymbol{x}\\\<br />
@V \text{ç±»æ¯”} VV @VV \text{ç±»æ¯”} V\\\<br />
\text{ç –ç“¦æ°´æ³¥}\quad @&gt;\quad\text{å»ºè®¾}\quad&gt;&gt; \quad\text{é«˜æ¥¼å¤§å¦}\\\<br />
\end{CD}\end{equation}</p>
<p><a href="/usr/uploads/2022/06/403506617.jpeg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="è¯·å«æˆ‘å·¥ç¨‹å¸ˆ" src="/usr/uploads/2022/06/403506617.jpeg" /></a></p>
<p>è¯·å«æˆ‘å·¥ç¨‹å¸ˆ</p>
<p>æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªè¿‡ç¨‹æƒ³è±¡ä¸ºâ€œå»ºè®¾â€ï¼Œå…¶ä¸­éšæœºå™ªå£°$\boldsymbol{z}$æ˜¯ç –ç“¦æ°´æ³¥ç­‰åŸææ–™ï¼Œæ ·æœ¬æ•°æ®$\boldsymbol{x}$æ˜¯é«˜æ¥¼å¤§å¦ï¼Œæ‰€ä»¥ç”Ÿæˆæ¨¡å‹å°±æ˜¯ä¸€æ”¯ç”¨åŸææ–™å»ºè®¾é«˜æ¥¼å¤§å¦çš„æ–½å·¥é˜Ÿã€‚</p>
<p>è¿™ä¸ªè¿‡ç¨‹è‚¯å®šå¾ˆéš¾çš„ï¼Œæ‰€ä»¥æ‰æœ‰äº†é‚£ä¹ˆå¤šå…³äºç”Ÿæˆæ¨¡å‹çš„ç ”ç©¶ã€‚ä½†ä¿—è¯è¯´â€œç ´åå®¹æ˜“å»ºè®¾éš¾â€ï¼Œå»ºæ¥¼ä½ ä¸ä¼šï¼Œæ‹†æ¥¼ä½ æ€»ä¼šäº†å§ï¼Ÿæˆ‘ä»¬è€ƒè™‘å°†é«˜æ¥¼å¤§å¦ä¸€æ­¥æ­¥åœ°æ‹†ä¸ºç –ç“¦æ°´æ³¥çš„è¿‡ç¨‹ï¼šè®¾$\boldsymbol{x}<em T-1="T-1">0$ä¸ºå»ºå¥½çš„é«˜æ¥¼å¤§å¦ï¼ˆæ•°æ®æ ·æœ¬ï¼‰ï¼Œ$\boldsymbol{x}_T$ä¸ºæ‹†å¥½çš„ç –ç“¦æ°´æ³¥ï¼ˆéšæœºå™ªå£°ï¼‰ï¼Œå‡è®¾â€œæ‹†æ¥¼â€éœ€è¦$T$æ­¥ï¼Œæ•´ä¸ªè¿‡ç¨‹å¯ä»¥è¡¨ç¤ºä¸º<br />
\begin{equation}\boldsymbol{x} = \boldsymbol{x}_0 \to \boldsymbol{x}_1 \to \boldsymbol{x}_2 \to \cdots \to \boldsymbol{x}</em>} \to \boldsymbol{x<em t-1="t-1">T = \boldsymbol{z}\end{equation}<br />
å»ºé«˜æ¥¼å¤§å¦çš„éš¾åº¦åœ¨äºï¼Œä»åŸææ–™$\boldsymbol{x}_T$åˆ°æœ€ç»ˆé«˜æ¥¼å¤§å¦$\boldsymbol{x}_0$çš„è·¨åº¦è¿‡å¤§ï¼Œæ™®é€šäººå¾ˆéš¾ç†è§£$\boldsymbol{x}_T$æ˜¯æ€ä¹ˆä¸€ä¸‹å­å˜æˆ$\boldsymbol{x}_0$çš„ã€‚ä½†æ˜¯ï¼Œå½“æˆ‘ä»¬æœ‰äº†â€œæ‹†æ¥¼â€çš„ä¸­é—´è¿‡ç¨‹$\boldsymbol{x}_1,\boldsymbol{x}_2,\cdots,\boldsymbol{x}_T$åï¼Œæˆ‘ä»¬çŸ¥é“$\boldsymbol{x}</em>} \to \boldsymbol{x<em t-1="t-1">t$ä»£è¡¨ç€æ‹†æ¥¼çš„ä¸€æ­¥ï¼Œé‚£ä¹ˆåè¿‡æ¥$\boldsymbol{x}_t\to \boldsymbol{x}</em>}$ä¸å°±æ˜¯å»ºæ¥¼çš„ä¸€æ­¥ï¼Ÿå¦‚æœæˆ‘ä»¬èƒ½å­¦ä¼šä¸¤è€…ä¹‹é—´çš„å˜æ¢å…³ç³»$\boldsymbol{x<em T-1="T-1">{t-1}=\boldsymbol{\mu}(\boldsymbol{x}_t)$ï¼Œé‚£ä¹ˆä»$\boldsymbol{x}_T$å‡ºå‘ï¼Œåå¤åœ°æ‰§è¡Œ$\boldsymbol{x}</em>}=\boldsymbol{\mu}(\boldsymbol{x<em T-2="T-2">T)$ã€$\boldsymbol{x}</em>_0$å‡ºæ¥ï¼Ÿ}=\boldsymbol{\mu}(\boldsymbol{x}_{T-1})$ã€...ï¼Œæœ€ç»ˆä¸å°±èƒ½é€ å‡ºé«˜æ¥¼å¤§å¦$\boldsymbol{x</p>
<h2 id="_3">è¯¥æ€ä¹ˆæ‹†</h2>
<p>æ­£æ‰€è°“â€œé¥­è¦ä¸€å£ä¸€å£åœ°åƒâ€ï¼Œæ¥¼ä¹Ÿè¦ä¸€æ­¥ä¸€æ­¥åœ°å»ºï¼ŒDDPMåšç”Ÿæˆæ¨¡å‹çš„è¿‡ç¨‹ï¼Œå…¶å®è·Ÿä¸Šè¿°â€œæ‹†æ¥¼-å»ºæ¥¼â€çš„ç±»æ¯”æ˜¯å®Œå…¨ä¸€è‡´çš„ï¼Œå®ƒä¹Ÿæ˜¯å…ˆåè¿‡æ¥æ„å»ºä¸€ä¸ªä»æ•°æ®æ ·æœ¬æ¸å˜åˆ°éšæœºå™ªå£°çš„è¿‡ç¨‹ï¼Œç„¶åå†è€ƒè™‘å…¶é€†å˜æ¢ï¼Œé€šè¿‡åå¤æ‰§è¡Œé€†å˜æ¢æ¥å®Œæˆæ•°æ®æ ·æœ¬çš„ç”Ÿæˆï¼Œæ‰€ä»¥æœ¬æ–‡å‰é¢æ‰è¯´DDPMè¿™ç§åšæ³•å…¶å®åº”è¯¥æ›´å‡†ç¡®åœ°ç§°ä¸ºâ€œæ¸å˜æ¨¡å‹â€è€Œä¸æ˜¯â€œæ‰©æ•£æ¨¡å‹â€ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼ŒDDPMå°†â€œæ‹†æ¥¼â€çš„è¿‡ç¨‹å»ºæ¨¡ä¸º<br />
\begin{equation}\boldsymbol{x}<em t-1="t-1">t = \alpha_t \boldsymbol{x}</em>} + \beta_t \boldsymbol{\varepsilon<em t-1="t-1">t,\quad \boldsymbol{\varepsilon}_t\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})\label{eq:forward}\end{equation}<br />
å…¶ä¸­æœ‰$\alpha_t,\beta_t &gt; 0$ä¸”$\alpha_t^2 + \beta_t^2=1$ï¼Œ$\beta_t$é€šå¸¸å¾ˆæ¥è¿‘äº0ï¼Œä»£è¡¨ç€å•æ­¥â€œæ‹†æ¥¼â€ä¸­å¯¹åŸæ¥æ¥¼ä½“çš„ç ´åç¨‹åº¦ï¼Œå™ªå£°$\boldsymbol{\varepsilon}_t$çš„å¼•å…¥ä»£è¡¨ç€å¯¹åŸå§‹ä¿¡å·çš„ä¸€ç§ç ´åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†å®ƒç†è§£ä¸ºâ€œåŸææ–™â€ï¼Œå³æ¯ä¸€æ­¥â€œæ‹†æ¥¼â€ä¸­æˆ‘ä»¬éƒ½å°†$\boldsymbol{x}</em>_t$çš„åŸæ–™â€ã€‚ï¼ˆ}$æ‹†è§£ä¸ºâ€œ$\alpha_t \boldsymbol{x}_{t-1}$çš„æ¥¼ä½“ + $\beta_t \boldsymbol{\varepsilon<strong>æç¤ºï¼š</strong> æœ¬æ–‡$\alpha_t,\beta_t$çš„å®šä¹‰è·ŸåŸè®ºæ–‡ä¸ä¸€æ ·ã€‚ï¼‰</p>
<p>åå¤æ‰§è¡Œè¿™ä¸ªæ‹†æ¥¼çš„æ­¥éª¤ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š<br />
\begin{equation}\begin{aligned}<br />
\boldsymbol{x}<em t-1="t-1">t =&amp;\, \alpha_t \boldsymbol{x}</em>} + \beta_t \boldsymbol{\varepsilon<em t-1="t-1">t \\\<br />
=&amp;\, \alpha_t \big(\alpha</em>} \boldsymbol{x<em t-1="t-1">{t-2} + \beta</em>} \boldsymbol{\varepsilon<em t-1="t-1">{t-1}\big) + \beta_t \boldsymbol{\varepsilon}_t \\\<br />
=&amp;\,\cdots\\\<br />
=&amp;\,(\alpha_t\cdots\alpha_1) \boldsymbol{x}_0 + \underbrace{(\alpha_t\cdots\alpha_2)\beta_1 \boldsymbol{\varepsilon}_1 + (\alpha_t\cdots\alpha_3)\beta_2 \boldsymbol{\varepsilon}_2 + \cdots + \alpha_t\beta</em>} \boldsymbol{\varepsilon<em _text_å¤šä¸ªç›¸äº’ç‹¬ç«‹çš„æ­£æ€å™ªå£°ä¹‹å’Œ="\text{å¤šä¸ªç›¸äº’ç‹¬ç«‹çš„æ­£æ€å™ªå£°ä¹‹å’Œ">{t-1} + \beta_t \boldsymbol{\varepsilon}_t}</em>}<br />
\end{aligned}\label{eq:expand}\end{equation}<br />
å¯èƒ½åˆšæ‰è¯»è€…å°±æƒ³é—®ä¸ºä»€ä¹ˆå åŠ çš„ç³»æ•°è¦æ»¡è¶³$\alpha_t^2 + \beta_t^2 = 1$äº†ï¼Œç°åœ¨æˆ‘ä»¬å°±å¯ä»¥å›ç­”è¿™ä¸ªé—®é¢˜ã€‚é¦–å…ˆï¼Œå¼ä¸­èŠ±æ‹¬å·æ‰€æŒ‡å‡ºçš„éƒ¨åˆ†ï¼Œæ­£å¥½æ˜¯å¤šä¸ªç‹¬ç«‹çš„æ­£æ€å™ªå£°ä¹‹å’Œï¼Œå…¶å‡å€¼ä¸º0ï¼Œæ–¹å·®åˆ™åˆ†åˆ«ä¸º$(\alpha_t\cdots\alpha_2)^2\beta_1^2$ã€$(\alpha_t\cdots\alpha_3)^2\beta_2^2$ã€...ã€$\alpha_t^2\beta_{t-1}^2$ã€$\beta_t^2$ï¼›ç„¶åï¼Œæˆ‘ä»¬åˆ©ç”¨ä¸€ä¸ªæ¦‚ç‡è®ºçš„çŸ¥è¯†â€”â€”æ­£æ€åˆ†å¸ƒçš„å åŠ æ€§ï¼Œå³ä¸Šè¿°å¤šä¸ªç‹¬ç«‹çš„æ­£æ€å™ªå£°ä¹‹å’Œçš„åˆ†å¸ƒï¼Œå®é™…ä¸Šæ˜¯å‡å€¼ä¸º0ã€æ–¹å·®ä¸º$(\alpha_t\cdots\alpha_2)^2\beta_1^2 + (\alpha_t\cdots\alpha_3)^2\beta_2^2 + \cdots + \alpha_t^2\beta_{t-1}^2 + \beta_t^2$çš„æ­£æ€åˆ†å¸ƒï¼›æœ€åï¼Œåœ¨$\alpha_t^2 + \beta_t^2 = 1$æ’æˆç«‹ä¹‹ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å¼$\eqref{eq:expand}$çš„å„é¡¹ç³»æ•°å¹³æ–¹å’Œä¾æ—§ä¸º1ï¼Œå³<br />
\begin{equation}(\alpha_t\cdots\alpha_1)^2 + (\alpha_t\cdots\alpha_2)^2\beta_1^2 + (\alpha_t\cdots\alpha_3)^2\beta_2^2 + \cdots + \alpha_t^2\beta_{t-1}^2 + \beta_t^2 = 1\end{equation}<br />
æ‰€ä»¥å®é™…ä¸Šç›¸å½“äºæœ‰<br />
\begin{equation}\boldsymbol{x}<em _text_è®°ä¸º="\text{è®°ä¸º">t = \underbrace{(\alpha_t\cdots\alpha_1)}</em>}\bar{\alpha<em _text_è®°ä¸º="\text{è®°ä¸º">t} \boldsymbol{x}_0 + \underbrace{\sqrt{1 - (\alpha_t\cdots\alpha_1)^2}}</em>}\bar{\beta}_t} \bar{\boldsymbol{\varepsilon}}_t,\quad \bar{\boldsymbol{\varepsilon}}_t\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})\label{eq:skip}\end{equation<br />
è¿™å°±ä¸ºè®¡ç®—$\boldsymbol{x}_t$æä¾›äº†æå¤§çš„ä¾¿åˆ©ã€‚å¦ä¸€æ–¹é¢ï¼ŒDDPMä¼šé€‰æ‹©é€‚å½“çš„$\alpha_t$å½¢å¼ï¼Œä½¿å¾—æœ‰$\bar{\alpha}_T\approx 0$ï¼Œè¿™æ„å‘³ç€ç»è¿‡$T$æ­¥çš„æ‹†æ¥¼åï¼Œæ‰€å‰©çš„æ¥¼ä½“å‡ ä¹å¯ä»¥å¿½ç•¥äº†ï¼Œå·²ç»å…¨éƒ¨è½¬åŒ–ä¸ºåŸææ–™$\boldsymbol{\varepsilon}$ã€‚ï¼ˆ<strong>æç¤ºï¼š</strong> æœ¬æ–‡$\bar{\alpha}_t$çš„å®šä¹‰è·ŸåŸè®ºæ–‡ä¸ä¸€æ ·ã€‚ï¼‰</p>
<h2 id="_4">åˆå¦‚ä½•å»º</h2>
<p>â€œæ‹†æ¥¼â€æ˜¯$\boldsymbol{x}<em t-1="t-1">{t-1}\to \boldsymbol{x}_t$çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹æˆ‘ä»¬å¾—åˆ°å¾ˆå¤šçš„æ•°æ®å¯¹$(\boldsymbol{x}</em>},\boldsymbol{x<em t-1="t-1">t)$ï¼Œé‚£ä¹ˆâ€œå»ºæ¥¼â€è‡ªç„¶å°±æ˜¯ä»è¿™äº›æ•°æ®å¯¹ä¸­å­¦ä¹ ä¸€ä¸ª$\boldsymbol{x}_t\to \boldsymbol{x}</em>}$çš„æ¨¡å‹ã€‚è®¾è¯¥æ¨¡å‹ä¸º$\boldsymbol{\mu}(\boldsymbol{x<em t-1="t-1">t)$ï¼Œé‚£ä¹ˆå®¹æ˜“æƒ³åˆ°å­¦ä¹ æ–¹æ¡ˆå°±æ˜¯æœ€å°åŒ–ä¸¤è€…çš„æ¬§æ°è·ç¦»ï¼š<br />
\begin{equation}\left\Vert\boldsymbol{x}</em>} - \boldsymbol{\mu}(\boldsymbol{x<em t-1="t-1">t)\right\Vert^2\label{eq:loss-0}\end{equation}<br />
å…¶å®è¿™å·²ç»éå¸¸æ¥è¿‘æœ€ç»ˆçš„DDPMæ¨¡å‹äº†ï¼Œæ¥ä¸‹æ¥è®©æˆ‘ä»¬å°†è¿™ä¸ªè¿‡ç¨‹åšå¾—æ›´ç²¾ç»†ä¸€äº›ã€‚é¦–å…ˆâ€œæ‹†æ¥¼â€çš„å¼$\eqref{eq:forward}$å¯ä»¥æ”¹å†™ä¸º$\boldsymbol{x}</em>} = \frac{1}{\alpha_t}\left(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t - \beta_t \boldsymbol{\varepsilon}_t\right)$ï¼Œè¿™å¯å‘æˆ‘ä»¬æˆ–è®¸å¯ä»¥å°†â€œå»ºæ¥¼â€æ¨¡å‹$\boldsymbol{\mu}(\boldsymbol{x}_t)$è®¾è®¡æˆ<br />
\begin{equation}\boldsymbol{\mu}(\boldsymbol{x}_t) = \frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \beta_t \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em t-1="t-1">t, t)\right)\label{eq:sample}\end{equation}<br />
çš„å½¢å¼ï¼Œå…¶ä¸­$\boldsymbol{\theta}$æ˜¯è®­ç»ƒå‚æ•°ï¼Œå°†å…¶ä»£å…¥åˆ°æŸå¤±å‡½æ•°ï¼Œå¾—åˆ°<br />
\begin{equation}\left\Vert\boldsymbol{x}</em>} - \boldsymbol{\mu}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t)\right\Vert^2 = \frac{\beta_t^2}{\alpha_t^2}\left\Vert \boldsymbol{\varepsilon}_t - \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em t-1="t-1">t, t)\right\Vert^2\end{equation}<br />
å‰é¢çš„å› å­$\frac{\beta_t^2}{\alpha_t^2}$ä»£è¡¨lossçš„æƒé‡ï¼Œè¿™ä¸ªæˆ‘ä»¬å¯ä»¥æš‚æ—¶å¿½ç•¥ï¼Œæœ€åä»£å…¥ç»“åˆå¼$\eqref{eq:skip}$å’Œ$\eqref{eq:forward}$æ‰€ç»™å‡º$\boldsymbol{x}_t$çš„è¡¨è¾¾å¼<br />
\begin{equation}\boldsymbol{x}_t = \alpha_t\boldsymbol{x}</em>} + \beta_t \boldsymbol{\varepsilon<em t-1="t-1">t = \alpha_t\left(\bar{\alpha}</em>}\boldsymbol{x<em t-1="t-1">0 + \bar{\beta}</em>}\bar{\boldsymbol{\varepsilon}<em t-1="t-1">{t-1}\right) + \beta_t \boldsymbol{\varepsilon}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \alpha_t\bar{\beta}</em>}\bar{\boldsymbol{\varepsilon}<em _boldsymbol_theta="\boldsymbol{\theta">{t-1} + \beta_t \boldsymbol{\varepsilon}_t \end{equation}<br />
å¾—åˆ°æŸå¤±å‡½æ•°çš„å½¢å¼ä¸º<br />
\begin{equation}\left\Vert \boldsymbol{\varepsilon}_t - \boldsymbol{\epsilon}</em>}}(\bar{\alpha<em t-1="t-1">t\boldsymbol{x}_0 + \alpha_t\bar{\beta}</em>}\bar{\boldsymbol{\varepsilon}}_{t-1} + \beta_t \boldsymbol{\varepsilon}_t, t)\right\Vert^2\label{eq:loss-1}\end{equation<br />
å¯èƒ½è¯»è€…æƒ³é—®ä¸ºä»€ä¹ˆè¦å›é€€ä¸€æ­¥æ¥ç»™å‡º$\boldsymbol{x}_t$ï¼Œç›´æ¥æ ¹æ®å¼$\eqref{eq:skip}$æ¥ç»™å‡º$\boldsymbol{x}_t$å¯ä»¥å—ï¼Ÿç­”æ¡ˆæ˜¯ä¸è¡Œï¼Œå› ä¸ºæˆ‘ä»¬å·²ç»äº‹å…ˆé‡‡æ ·äº†$\boldsymbol{\varepsilon}_t$ï¼Œè€Œ$\boldsymbol{\varepsilon}_t$è·Ÿ$\bar{\boldsymbol{\varepsilon}}_t$ä¸æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œæ‰€ä»¥ç»™å®š$\boldsymbol{\varepsilon}_t$çš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¸èƒ½å®Œå…¨ç‹¬ç«‹åœ°é‡‡æ ·$\bar{\boldsymbol{\varepsilon}}_t$ã€‚</p>
<h2 id="_5">é™ä½æ–¹å·®</h2>
<p>åŸåˆ™ä¸Šæ¥è¯´ï¼ŒæŸå¤±å‡½æ•°$\eqref{eq:loss-1}$å°±å¯ä»¥å®ŒæˆDDPMçš„è®­ç»ƒï¼Œä½†å®ƒåœ¨å®è·µä¸­å¯èƒ½æœ‰æ–¹å·®è¿‡å¤§çš„é£é™©ï¼Œä»è€Œå¯¼è‡´æ”¶æ•›è¿‡æ…¢ç­‰é—®é¢˜ã€‚è¦ç†è§£è¿™ä¸€ç‚¹å¹¶ä¸å›°éš¾ï¼Œåªéœ€è¦è§‚å¯Ÿåˆ°å¼$\eqref{eq:loss-1}$å®é™…ä¸ŠåŒ…å«äº†4ä¸ªéœ€è¦é‡‡æ ·çš„éšæœºå˜é‡ï¼š</p>
<blockquote>
<p>1ã€ä»æ‰€æœ‰è®­ç»ƒæ ·æœ¬ä¸­é‡‡æ ·ä¸€ä¸ª$\boldsymbol{x}_0$ï¼›</p>
<p>2ã€ä»æ­£æ€åˆ†å¸ƒ$\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ä¸­é‡‡æ ·$\bar{\boldsymbol{\varepsilon}}_{t-1}, \boldsymbol{\varepsilon}_t$ï¼ˆä¸¤ä¸ªä¸åŒçš„é‡‡æ ·ç»“æœï¼‰ï¼›</p>
<p>3ã€ä»$1\sim T$ä¸­é‡‡æ ·ä¸€ä¸ª$t$ã€‚</p>
</blockquote>
<p>è¦é‡‡æ ·çš„éšæœºå˜é‡è¶Šå¤šï¼Œå°±è¶Šéš¾å¯¹æŸå¤±å‡½æ•°åšå‡†ç¡®çš„ä¼°è®¡ï¼Œåè¿‡æ¥è¯´å°±æ˜¯æ¯æ¬¡å¯¹æŸå¤±å‡½æ•°è¿›è¡Œä¼°è®¡çš„æ³¢åŠ¨ï¼ˆæ–¹å·®ï¼‰è¿‡å¤§äº†ã€‚å¾ˆå¹¸è¿çš„æ˜¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸€ä¸ªç§¯åˆ†æŠ€å·§æ¥å°†$\bar{\boldsymbol{\varepsilon}}_{t-1}, \boldsymbol{\varepsilon}_t$åˆå¹¶æˆå•ä¸ªæ­£æ€éšæœºå˜é‡ï¼Œä»è€Œç¼“è§£ä¸€ä¸‹æ–¹å·®å¤§çš„é—®é¢˜ã€‚</p>
<p>è¿™ä¸ªç§¯åˆ†ç¡®å®æœ‰ç‚¹æŠ€å·§æ€§ï¼Œä½†ä¹Ÿä¸ç®—å¤æ‚ã€‚ç”±äºæ­£æ€åˆ†å¸ƒçš„å åŠ æ€§ï¼Œæˆ‘ä»¬çŸ¥é“$\alpha_t\bar{\beta}<em t-1="t-1">{t-1}\bar{\boldsymbol{\varepsilon}}</em>} + \beta_t \boldsymbol{\varepsilon<em t-1="t-1">t$å®é™…ä¸Šç›¸å½“äºå•ä¸ªéšæœºå˜é‡$\bar{\beta}_t\boldsymbol{\varepsilon}|\boldsymbol{\varepsilon}\sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼ŒåŒç†$\beta_t \bar{\boldsymbol{\varepsilon}}</em>$ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸¤ä¸ªç›¸äº’ç‹¬ç«‹çš„æ­£æ€éšæœºå˜é‡ã€‚} - \alpha_t\bar{\beta}_{t-1} \boldsymbol{\varepsilon}_t$å®é™…ä¸Šç›¸å½“äºå•ä¸ªéšæœºå˜é‡$\bar{\beta}_t\boldsymbol{\omega}|\boldsymbol{\omega}\sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼Œå¹¶ä¸”å¯ä»¥éªŒè¯$\mathbb{E}[\boldsymbol{\varepsilon}\boldsymbol{\omega}^{\top}]=\boldsymbol{0</p>
<p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬åè¿‡æ¥å°†$\boldsymbol{\varepsilon}<em t-1="t-1">t$ç”¨$\boldsymbol{\varepsilon},\boldsymbol{\omega}$é‡æ–°è¡¨ç¤ºå‡ºæ¥<br />
\begin{equation}\boldsymbol{\varepsilon}_t = \frac{(\beta_t \boldsymbol{\varepsilon} - \alpha_t\bar{\beta}</em>} \boldsymbol{\omega})\bar{\beta<em t-1="t-1">t}{\beta_t^2 + \alpha_t^2\bar{\beta}</em>}^2} = \frac{\beta_t \boldsymbol{\varepsilon} - \alpha_t\bar{\beta<em _bar_boldsymbol_varepsilon="\bar{\boldsymbol{\varepsilon">{t-1} \boldsymbol{\omega}}{\bar{\beta}_t}\end{equation}<br />
ä»£å…¥åˆ°å¼$\eqref{eq:loss-1}$å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\mathbb{E}</em>}<em _boldsymbol_theta="\boldsymbol{\theta">{t-1}, \boldsymbol{\varepsilon}_t\sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\left\Vert \boldsymbol{\varepsilon}_t - \boldsymbol{\epsilon}</em>}}(\bar{\alpha<em t-1="t-1">t\boldsymbol{x}_0 + \alpha_t\bar{\beta}</em>}\bar{\boldsymbol{\varepsilon}<em _boldsymbol_omega="\boldsymbol{\omega">{t-1} + \beta_t \boldsymbol{\varepsilon}_t, t)\right\Vert^2\right] \\\<br />
=&amp;\,\mathbb{E}</em>}, \boldsymbol{\varepsilon}\sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\left\Vert \frac{\beta_t \boldsymbol{\varepsilon} - \alpha_t\bar{\beta<em _boldsymbol_theta="\boldsymbol{\theta">{t-1} \boldsymbol{\omega}}{\bar{\beta}_t} - \boldsymbol{\epsilon}</em>}}(\bar{\alpha<em _boldsymbol_varepsilon="\boldsymbol{\varepsilon">t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}, t)\right\Vert^2\right]<br />
\end{aligned}\end{equation}<br />
æ³¨æ„åˆ°ï¼Œç°åœ¨æŸå¤±å‡½æ•°å…³äº$\boldsymbol{\omega}$åªæ˜¯äºŒæ¬¡çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å±•å¼€ç„¶åå°†å®ƒçš„æœŸæœ›ç›´æ¥ç®—å‡ºæ¥ï¼Œç»“æœæ˜¯<br />
\begin{equation}\frac{\beta_t^2}{\bar{\beta}_t^2}\mathbb{E}</em>}\sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\left\Vert\boldsymbol{\varepsilon} - \frac{\bar{\beta<em _boldsymbol_theta="\boldsymbol{\theta">t}{\beta_t}\boldsymbol{\epsilon}</em>}}(\bar{\alpha<em _boldsymbol_theta="\boldsymbol{\theta">t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}, t)\right\Vert^2\right]+\text{å¸¸æ•°}\end{equation}<br />
å†æ¬¡çœæ‰å¸¸æ•°å’ŒæŸå¤±å‡½æ•°çš„æƒé‡ï¼Œæˆ‘ä»¬å¾—åˆ°DDPMæœ€ç»ˆæ‰€ç”¨çš„æŸå¤±å‡½æ•°ï¼š<br />
\begin{equation}\left\Vert\boldsymbol{\varepsilon} - \frac{\bar{\beta}_t}{\beta_t}\boldsymbol{\epsilon}</em>}}(\bar{\alpha<em _boldsymbol_theta="\boldsymbol{\theta">t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}, t)\right\Vert^2\end{equation}<br />
ï¼ˆ<strong>æç¤ºï¼š</strong> åŸè®ºæ–‡ä¸­çš„$\boldsymbol{\epsilon}</em>}}$å®é™…ä¸Šå°±æ˜¯æœ¬æ–‡çš„$\frac{\bar{\beta<em _boldsymbol_theta="\boldsymbol{\theta">t}{\beta_t}\boldsymbol{\epsilon}</em>$ï¼Œæ‰€ä»¥å¤§å®¶çš„ç»“æœæ˜¯å®Œå…¨ä¸€æ ·çš„ã€‚ï¼‰}</p>
<h2 id="_6">é€’å½’ç”Ÿæˆ</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬ç®—æ˜¯æŠŠDDPMçš„æ•´ä¸ªè®­ç»ƒæµç¨‹æ‹æ¸…æ¥šäº†ã€‚å†…å®¹å†™äº†ä¸å°‘ï¼Œä½ è¦è¯´å®ƒå¾ˆå®¹æ˜“ï¼Œé‚£è‚¯å®šè¯´ä¸ä¸Šï¼Œä½†çœŸè¦è¯´éå¸¸å›°éš¾çš„åœ°æ–¹ä¹Ÿå‡ ä¹æ²¡æœ‰â€”â€”æ²¡æœ‰ç”¨åˆ°ä¼ ç»Ÿçš„èƒ½é‡å‡½æ•°ã€å¾—åˆ†åŒ¹é…ç­‰å·¥å…·ï¼Œç”šè‡³è¿å˜åˆ†æ¨æ–­çš„çŸ¥è¯†éƒ½æ²¡æœ‰ç”¨åˆ°ï¼Œåªæ˜¯å€ŸåŠ©â€œæ‹†æ¥¼-å»ºæ¥¼â€çš„ç±»æ¯”å’Œä¸€äº›åŸºæœ¬çš„æ¦‚ç‡è®ºçŸ¥è¯†ï¼Œå°±èƒ½å¾—åˆ°å®Œå…¨ä¸€æ ·çš„ç»“æœã€‚æ‰€ä»¥è¯´ï¼Œä»¥DDPMä¸ºä»£è¡¨çš„æ–°å…´èµ·çš„ç”Ÿæˆæ‰©æ•£æ¨¡å‹ï¼Œå®é™…ä¸Šæ²¡æœ‰å¾ˆå¤šè¯»è€…æƒ³è±¡çš„å¤æ‚ï¼Œå®ƒå¯ä»¥è¯´æ˜¯æˆ‘ä»¬ä»â€œæ‹†è§£-é‡ç»„â€çš„è¿‡ç¨‹ä¸­å­¦ä¹ æ–°çŸ¥è¯†çš„å½¢è±¡å»ºæ¨¡ã€‚</p>
<p>è®­ç»ƒå®Œä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥ä»ä¸€ä¸ªéšæœºå™ªå£°$\boldsymbol{x}<em t-1="t-1">T\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$å‡ºå‘æ‰§è¡Œ$T$æ­¥å¼$\eqref{eq:sample}$æ¥è¿›è¡Œç”Ÿæˆï¼š<br />
\begin{equation}\boldsymbol{x}</em>} = \frac{1}{\alpha_t}\left(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t - \beta_t \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em t-1="t-1">t, t)\right)\end{equation}<br />
è¿™å¯¹åº”äºè‡ªå›å½’è§£ç ä¸­çš„Greedy Searchã€‚å¦‚æœè¦è¿›è¡ŒRandom Sampleï¼Œé‚£ä¹ˆéœ€è¦è¡¥ä¸Šå™ªå£°é¡¹ï¼š<br />
\begin{equation}\boldsymbol{x}</em>} = \frac{1}{\alpha_t}\left(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t - \beta_t \boldsymbol{\epsilon}</em>}}(\boldsymbol{x}_t, t)\right) + \sigma_t \boldsymbol{z},\quad \boldsymbol{z}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})\end{equation<br />
ä¸€èˆ¬æ¥è¯´ï¼Œæˆ‘ä»¬å¯ä»¥è®©$\sigma_t=\beta_t$ï¼Œå³æ­£å‘å’Œåå‘çš„æ–¹å·®ä¿æŒåŒæ­¥ã€‚è¿™ä¸ªé‡‡æ ·è¿‡ç¨‹è·Ÿä¼ ç»Ÿæ‰©æ•£æ¨¡å‹çš„æœ—ä¹‹ä¸‡é‡‡æ ·ä¸ä¸€æ ·çš„åœ°æ–¹åœ¨äºï¼šDDPMçš„é‡‡æ ·æ¯æ¬¡éƒ½ä»ä¸€ä¸ªéšæœºå™ªå£°å‡ºå‘ï¼Œéœ€è¦é‡å¤è¿­ä»£$T$æ­¥æ¥å¾—åˆ°ä¸€ä¸ªæ ·æœ¬è¾“å‡ºï¼›æœ—ä¹‹ä¸‡é‡‡æ ·åˆ™æ˜¯ä»ä»»æ„ä¸€ä¸ªç‚¹å‡ºå‘ï¼Œåå¤è¿­ä»£æ— é™æ­¥ï¼Œç†è®ºä¸Šè¿™ä¸ªè¿­ä»£æ— é™æ­¥çš„è¿‡ç¨‹ä¸­ï¼Œå°±æŠŠæ‰€æœ‰æ•°æ®æ ·æœ¬éƒ½è¢«ç”Ÿæˆè¿‡äº†ã€‚æ‰€ä»¥ä¸¤è€…é™¤äº†å½¢å¼ç›¸ä¼¼å¤–ï¼Œå®è´¨ä¸Šæ˜¯ä¸¤ä¸ªæˆªç„¶ä¸åŒçš„æ¨¡å‹ã€‚</p>
<p>ä»è¿™ä¸ªç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æ„Ÿè§‰åˆ°å®ƒå…¶å®è·ŸSeq2Seqçš„è§£ç è¿‡ç¨‹æ˜¯ä¸€æ ·çš„ï¼Œéƒ½æ˜¯ä¸²è”å¼çš„è‡ªå›å½’ç”Ÿæˆï¼Œæ‰€ä»¥ç”Ÿæˆé€Ÿåº¦æ˜¯ä¸€ä¸ªç“¶é¢ˆï¼ŒDDPMè®¾äº†$T=1000$ï¼Œæ„å‘³ç€æ¯ç”Ÿæˆä¸€ä¸ªå›¾ç‰‡ï¼Œéœ€è¦å°†$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$åå¤æ‰§è¡Œ1000æ¬¡ï¼Œå› æ­¤DDPMçš„ä¸€å¤§ç¼ºç‚¹å°±æ˜¯é‡‡æ ·é€Ÿåº¦æ…¢ï¼Œåé¢æœ‰å¾ˆå¤šå·¥ä½œéƒ½è‡´åŠ›äºæå‡DDPMçš„é‡‡æ ·é€Ÿåº¦ã€‚è€Œè¯´åˆ°â€œå›¾ç‰‡ç”Ÿæˆ + è‡ªå›å½’æ¨¡å‹ + å¾ˆæ…¢â€ï¼Œæœ‰äº›è¯»è€…å¯èƒ½ä¼šè”æƒ³åˆ°æ—©æœŸçš„<a href="https://papers.cool/arxiv/1601.06759">PixelRNN</a>ã€<a href="https://papers.cool/arxiv/1606.05328">PixelCNN</a>ç­‰æ¨¡å‹ï¼Œå®ƒä»¬å°†å›¾ç‰‡ç”Ÿæˆè½¬æ¢æˆè¯­è¨€æ¨¡å‹ä»»åŠ¡ï¼Œæ‰€ä»¥åŒæ ·ä¹Ÿæ˜¯é€’å½’åœ°è¿›è¡Œé‡‡æ ·ç”Ÿæˆä»¥åŠåŒæ ·åœ°æ…¢ã€‚é‚£ä¹ˆDDPMçš„è¿™ç§è‡ªå›å½’ç”Ÿæˆï¼Œè·ŸPixelRNN/PixelCNNçš„è‡ªå›å½’ç”Ÿæˆï¼Œåˆæœ‰ä»€ä¹ˆå®è´¨åŒºåˆ«å‘¢ï¼Ÿä¸ºä»€ä¹ˆPixelRNN/PixelCNNæ²¡å¤§ç«èµ·æ¥ï¼Œåè€Œè½®åˆ°äº†DDPMï¼Ÿ</p>
<p>äº†è§£PixelRNN/PixelCNNçš„è¯»è€…éƒ½çŸ¥é“ï¼Œè¿™ç±»ç”Ÿæˆæ¨¡å‹æ˜¯é€ä¸ªåƒç´ é€ä¸ªåƒç´ åœ°ç”Ÿæˆå›¾ç‰‡çš„ï¼Œè€Œè‡ªå›å½’ç”Ÿæˆæ˜¯æœ‰åºçš„ï¼Œè¿™å°±æ„å‘³ç€æˆ‘ä»¬è¦æå‰ç»™å›¾ç‰‡çš„æ¯ä¸ªåƒç´ æ’å¥½é¡ºåºï¼Œæœ€ç»ˆçš„ç”Ÿæˆæ•ˆæœè·Ÿè¿™ä¸ªé¡ºåºç´§å¯†ç›¸å…³ã€‚ç„¶è€Œï¼Œç›®å‰è¿™ä¸ªé¡ºåºåªèƒ½æ˜¯äººä¸ºåœ°å‡­ç€ç»éªŒæ¥è®¾è®¡ï¼ˆè¿™ç±»ç»éªŒçš„è®¾è®¡éƒ½ç»Ÿç§°ä¸ºâ€œInductive Biasâ€ï¼‰ï¼Œæš‚æ—¶æ‰¾ä¸åˆ°ç†è®ºæœ€ä¼˜è§£ã€‚æ¢å¥è¯è¯´ï¼ŒPixelRNN/PixelCNNçš„ç”Ÿæˆæ•ˆæœå¾ˆå—Inductive Biasçš„å½±å“ã€‚ä½†DDPMä¸ä¸€æ ·ï¼Œå®ƒé€šè¿‡â€œæ‹†æ¥¼â€çš„æ–¹å¼é‡æ–°å®šä¹‰äº†ä¸€ä¸ªè‡ªå›å½’æ–¹å‘ï¼Œè€Œå¯¹äºæ‰€æœ‰çš„åƒç´ æ¥è¯´åˆ™éƒ½æ˜¯å¹³æƒçš„ã€æ— åçš„ï¼Œæ‰€ä»¥å‡å°‘äº†Inductive Biasçš„å½±å“ï¼Œä»è€Œæå‡äº†æ•ˆæœã€‚æ­¤å¤–ï¼ŒDDPMç”Ÿæˆçš„è¿­ä»£æ­¥æ•°æ˜¯å›ºå®šçš„$T$ï¼Œè€ŒPixelRNN/PixelCNNåˆ™æ˜¯ç­‰äºå›¾åƒåˆ†è¾¨ç‡ï¼ˆ$\text{å®½}\times\text{é«˜}\times{é€šé“æ•°}$ï¼‰ï¼Œæ‰€ä»¥DDPMç”Ÿæˆé«˜åˆ†è¾¨ç‡å›¾åƒçš„é€Ÿåº¦è¦æ¯”PixelRNN/PixelCNNå¿«å¾—å¤šã€‚</p>
<h2 id="_7">è¶…å‚è®¾ç½®</h2>
<p>è¿™ä¸€èŠ‚æˆ‘ä»¬è®¨è®ºä¸€ä¸‹è¶…å‚çš„è®¾ç½®é—®é¢˜ã€‚</p>
<p>åœ¨DDPMä¸­ï¼Œ$T=1000$ï¼Œå¯èƒ½æ¯”å¾ˆå¤šè¯»è€…çš„æƒ³è±¡æ•°å€¼è¦å¤§ï¼Œé‚£ä¸ºä»€ä¹ˆè¦è®¾ç½®è¿™ä¹ˆå¤§çš„$T$å‘¢ï¼Ÿå¦ä¸€è¾¹ï¼Œå¯¹äº$\alpha_t$çš„é€‰æ‹©ï¼Œå°†åŸè®ºæ–‡çš„è®¾ç½®ç¿»è¯‘åˆ°æœ¬åšå®¢çš„è®°å·ä¸Šï¼Œå¤§è‡´ä¸Šæ˜¯<br />
\begin{equation}\alpha_t = \sqrt{1 - \frac{0.02t}{T}}\end{equation}<br />
è¿™æ˜¯ä¸€ä¸ªå•è°ƒé€’å‡çš„å‡½æ•°ï¼Œé‚£ä¸ºä»€ä¹ˆè¦é€‰æ‹©å•è°ƒé€’å‡çš„$\alpha_t$å‘¢ï¼Ÿ</p>
<p>å…¶å®è¿™ä¸¤ä¸ªé—®é¢˜æœ‰ç€ç›¸è¿‘çš„ç­”æ¡ˆï¼Œè·Ÿå…·ä½“çš„æ•°æ®èƒŒæ™¯æœ‰å…³ã€‚ç®€å•èµ·è§ï¼Œåœ¨é‡æ„çš„æ—¶å€™æˆ‘ä»¬ç”¨äº†æ¬§æ°è·ç¦»$\eqref{eq:loss-0}$ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œè€Œä¸€èˆ¬æˆ‘ä»¬ç”¨DDPMåšå›¾ç‰‡ç”Ÿæˆï¼Œä»¥å¾€åšè¿‡å›¾ç‰‡ç”Ÿæˆçš„è¯»è€…éƒ½çŸ¥é“ï¼Œæ¬§æ°è·ç¦»å¹¶ä¸æ˜¯å›¾ç‰‡çœŸå®ç¨‹åº¦çš„ä¸€ä¸ªå¥½çš„åº¦é‡ï¼ŒVAEç”¨æ¬§æ°è·ç¦»æ¥é‡æ„æ—¶ï¼Œå¾€å¾€ä¼šå¾—åˆ°æ¨¡ç³Šçš„ç»“æœï¼Œé™¤éæ˜¯è¾“å…¥è¾“å‡ºçš„ä¸¤å¼ å›¾ç‰‡éå¸¸æ¥è¿‘ï¼Œç”¨æ¬§æ°è·ç¦»æ‰èƒ½å¾—åˆ°æ¯”è¾ƒæ¸…æ™°çš„ç»“æœï¼Œæ‰€ä»¥é€‰æ‹©å°½å¯èƒ½å¤§çš„$T$ï¼Œæ­£æ˜¯ä¸ºäº†ä½¿å¾—è¾“å…¥è¾“å‡ºå°½å¯èƒ½ç›¸è¿‘ï¼Œå‡å°‘æ¬§æ°è·ç¦»å¸¦æ¥çš„æ¨¡ç³Šé—®é¢˜ã€‚</p>
<p>é€‰æ‹©å•è°ƒé€’å‡çš„$\alpha_t$ä¹Ÿæœ‰ç±»ä¼¼è€ƒè™‘ã€‚å½“$t$æ¯”è¾ƒå°æ—¶ï¼Œ$\boldsymbol{x}<em t-1="t-1">t$è¿˜æ¯”è¾ƒæ¥è¿‘çœŸå®å›¾ç‰‡ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦ç¼©å°$\boldsymbol{x}</em>}$ä¸$\boldsymbol{x<em t-1="t-1">t$çš„å·®è·ï¼Œä»¥ä¾¿æ›´é€‚ç”¨æ¬§æ°è·ç¦»$\eqref{eq:loss-0}$ï¼Œå› æ­¤è¦ç”¨è¾ƒå¤§çš„$\alpha_t$ï¼›å½“$t$æ¯”è¾ƒå¤§æ—¶ï¼Œ$\boldsymbol{x}_t$å·²ç»æ¯”è¾ƒæ¥è¿‘çº¯å™ªå£°äº†ï¼Œå™ªå£°ç”¨æ¬§å¼è·ç¦»æ— å¦¨ï¼Œæ‰€ä»¥å¯ä»¥ç¨å¾®å¢å¤§$\boldsymbol{x}</em>}$ä¸$\boldsymbol{x<em t="1">t$çš„å·®è·ï¼Œå³å¯ä»¥ç”¨è¾ƒå°çš„$\alpha_t$ã€‚é‚£ä¹ˆå¯ä¸å¯ä»¥ä¸€ç›´ç”¨è¾ƒå¤§çš„$\alpha_t$å‘¢ï¼Ÿå¯ä»¥æ˜¯å¯ä»¥ï¼Œä½†æ˜¯è¦å¢å¤§$T$ã€‚æ³¨æ„åœ¨æ¨å¯¼$\eqref{eq:skip}$æ—¶ï¼Œæˆ‘ä»¬è¯´è¿‡åº”è¯¥æœ‰$\bar{\alpha}_T\approx 0$ï¼Œè€Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä¼°ç®—<br />
\begin{equation}\log \bar{\alpha}_T = \sum</em>}^T \log\alpha_t = \frac{1}{2} \sum_{t=1}^T \log\left(1 - \frac{0.02t}{T}\right) &lt; \frac{1}{2} \sum_{t=1}^T \left(- \frac{0.02t}{T}\right) = -0.005(T+1)\end{equation<br />
ä»£å…¥$T=1000$å¤§è‡´æ˜¯$\bar{\alpha}_T\approx e^{-5}$ï¼Œè¿™ä¸ªå…¶å®å°±åˆšå¥½è¾¾åˆ°$\approx 0$çš„æ ‡å‡†ã€‚æ‰€ä»¥å¦‚æœä»å¤´åˆ°å°¾éƒ½ç”¨è¾ƒå¤§çš„$\alpha_t$ï¼Œé‚£ä¹ˆå¿…ç„¶è¦æ›´å¤§çš„$T$æ‰èƒ½ä½¿å¾—$\bar{\alpha}_T\approx 0$äº†ã€‚</p>
<p>æœ€åæˆ‘ä»¬ç•™æ„åˆ°ï¼Œâ€œå»ºæ¥¼â€æ¨¡å‹ä¸­çš„$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}, t)$ä¸­ï¼Œæˆ‘ä»¬åœ¨è¾“å…¥ä¸­æ˜¾å¼åœ°å†™å‡ºäº†$t$ï¼Œè¿™æ˜¯å› ä¸ºåŸåˆ™ä¸Šä¸åŒçš„$t$å¤„ç†çš„æ˜¯ä¸åŒå±‚æ¬¡çš„å¯¹è±¡ï¼Œæ‰€ä»¥åº”è¯¥ç”¨ä¸åŒçš„é‡æ„æ¨¡å‹ï¼Œå³åº”è¯¥æœ‰$T$ä¸ªä¸åŒçš„é‡æ„æ¨¡å‹æ‰å¯¹ï¼Œäºæ˜¯æˆ‘ä»¬å…±äº«äº†æ‰€æœ‰é‡æ„æ¨¡å‹çš„å‚æ•°ï¼Œå°†$t$ä½œä¸ºæ¡ä»¶ä¼ å…¥ã€‚æŒ‰ç…§è®ºæ–‡é™„å½•çš„è¯´æ³•ï¼Œ$t$æ˜¯è½¬æ¢æˆ<a href="/archives/8231">ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š1ã€Sinusoidalä½ç½®ç¼–ç è¿½æ ¹æº¯æºã€‹</a>ä»‹ç»çš„ä½ç½®ç¼–ç åï¼Œç›´æ¥åŠ åˆ°æ®‹å·®æ¨¡å—ä¸Šå»çš„ã€‚</p>
<h2 id="_8">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä»â€œæ‹†æ¥¼-å»ºæ¥¼â€çš„é€šä¿—ç±»æ¯”ä¸­ä»‹ç»äº†æœ€æ–°çš„ç”Ÿæˆæ‰©æ•£æ¨¡å‹DDPMï¼Œåœ¨è¿™ä¸ªè§†è§’ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è¾ƒä¸ºâ€œå¤§ç™½è¯â€çš„æè¿°ä»¥åŠæ¯”è¾ƒå°‘çš„æ•°å­¦æ¨å¯¼ï¼Œæ¥å¾—åˆ°è·ŸåŸå§‹è®ºæ–‡ä¸€æ¨¡ä¸€æ ·çš„ç»“æœã€‚æ€»çš„æ¥è¯´ï¼Œæœ¬æ–‡è¯´æ˜äº†DDPMä¹Ÿå¯ä»¥åƒGANä¸€æ ·æ‰¾åˆ°ä¸€ä¸ªå½¢è±¡ç±»æ¯”ï¼Œå®ƒæ—¢å¯ä»¥ä¸ç”¨åˆ°VAEä¸­çš„â€œå˜åˆ†â€ï¼Œä¹Ÿå¯ä»¥ä¸ç”¨åˆ°GANä¸­çš„â€œæ¦‚ç‡æ•£åº¦â€ã€â€œæœ€ä¼˜ä¼ è¾“â€ï¼Œä»è¿™ä¸ªæ„ä¹‰ä¸Šæ¥çœ‹ï¼ŒDDPMç”šè‡³ç®—å¾—ä¸Šæ¯”VAEã€GANè¿˜è¦ç®€å•ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9119">https://spaces.ac.cn/archives/9119</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jun. 13, 2022). ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸€ï¼‰ï¼šDDPM = æ‹†æ¥¼ + å»ºæ¥¼ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9119">https://spaces.ac.cn/archives/9119</a></p>
<p>@online{kexuefm-9119,<br />
title={ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸€ï¼‰ï¼šDDPM = æ‹†æ¥¼ + å»ºæ¥¼},<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={Jun},<br />
url={\url{https://spaces.ac.cn/archives/9119}},<br />
} </p>
<hr />
<h2 id="_9">è¯¦ç»†æ•°å­¦æ¨å¯¼</h2>
<p>æœ¬èŠ‚æˆ‘ä»¬å°†å¯¹DDPMçš„æ•°å­¦åŸç†è¿›è¡Œæå…¶è¯¦ç»†çš„æ¨å¯¼ï¼ŒåŒ…æ‹¬å‰å‘æ‰©æ•£è¿‡ç¨‹ã€åå‘å»å™ªè¿‡ç¨‹ã€å˜åˆ†ä¸‹ç•Œè¯æ˜ã€æŸå¤±å‡½æ•°æ¨å¯¼ç­‰æ ¸å¿ƒå†…å®¹ã€‚</p>
<h3 id="1-ddpm">1. DDPMçš„å®Œæ•´æ•°å­¦å®šä¹‰</h3>
<h4 id="11">1.1 å‰å‘æ‰©æ•£è¿‡ç¨‹ï¼ˆé©¬å°”å¯å¤«é“¾ï¼‰</h4>
<p>DDPMçš„å‰å‘æ‰©æ•£è¿‡ç¨‹æ˜¯ä¸€ä¸ªå‚æ•°å›ºå®šçš„é©¬å°”å¯å¤«é“¾ï¼Œä»æ•°æ®åˆ†å¸ƒ$q(\boldsymbol{x}_0)$å‡ºå‘ï¼Œé€æ­¥æ·»åŠ é«˜æ–¯å™ªå£°ï¼Œç»è¿‡$T$æ­¥åå¾—åˆ°è¿‘ä¼¼çš„å„å‘åŒæ€§é«˜æ–¯åˆ†å¸ƒã€‚</p>
<p><strong>å®šä¹‰1ï¼ˆå‰å‘è¿‡ç¨‹ï¼‰</strong>ï¼šç»™å®šæ•°æ®æ ·æœ¬$\boldsymbol{x}_0 \sim q(\boldsymbol{x}_0)$ï¼Œå‰å‘æ‰©æ•£è¿‡ç¨‹å®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
q(\boldsymbol{x}<em t="1">{1:T}|\boldsymbol{x}_0) = \prod</em>}^{T} q(\boldsymbol{x<em t-1="t-1">t|\boldsymbol{x}</em>)
\end{equation}</p>
<p>å…¶ä¸­æ¯ä¸€æ­¥çš„è½¬ç§»æ¦‚ç‡ä¸ºï¼š</p>
<p>\begin{equation}
q(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>}) = \mathcal{N}(\boldsymbol{x<em t-1="t-1">t; \alpha_t\boldsymbol{x}</em>)
\end{equation}}, \beta_t^2\boldsymbol{I</p>
<p>è¿™é‡Œ$\alpha_t, \beta_t &gt; 0$ä¸”æ»¡è¶³çº¦æŸ$\alpha_t^2 + \beta_t^2 = 1$ã€‚</p>
<p><strong>å®šç†1ï¼ˆä»»æ„æ­¥å‰å‘æ‰©æ•£ï¼‰</strong>ï¼šå¯¹äºä»»æ„æ—¶åˆ»$t$ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä»$\boldsymbol{x}_0$é‡‡æ ·å¾—åˆ°$\boldsymbol{x}_t$ï¼š</p>
<p>\begin{equation}
q(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t; \bar{\alpha}_t\boldsymbol{x}_0, \bar{\beta}_t^2\boldsymbol{I})
\end{equation}</p>
<p>å…¶ä¸­$\bar{\alpha}<em s="1">t = \prod</em>$ã€‚}^{t}\alpha_s$ï¼Œ$\bar{\beta}_t = \sqrt{1-\bar{\alpha}_t^2</p>
<p><strong>è¯æ˜</strong>ï¼šæˆ‘ä»¬é€šè¿‡æ•°å­¦å½’çº³æ³•è¯æ˜æ­¤å®šç†ã€‚</p>
<p><em>åŸºç¡€æ­¥éª¤</em>ï¼ˆ$t=1$ï¼‰ï¼šæ ¹æ®å®šä¹‰ï¼Œ$q(\boldsymbol{x}_1|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_1; \alpha_1\boldsymbol{x}_0, \beta_1^2\boldsymbol{I})$ã€‚
ç”±äº$\alpha_1^2 + \beta_1^2 = 1$ï¼Œæ‰€ä»¥$\bar{\alpha}_1 = \alpha_1$ï¼Œ$\bar{\beta}_1 = \beta_1$ï¼Œå‘½é¢˜æˆç«‹ã€‚</p>
<p><em>å½’çº³æ­¥éª¤</em>ï¼šå‡è®¾å¯¹$t-1$å‘½é¢˜æˆç«‹ï¼Œå³
\begin{equation}
q(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}</em>}; \bar{\alpha<em t-1="t-1">{t-1}\boldsymbol{x}_0, \bar{\beta}</em>)
\end{equation}}^2\boldsymbol{I</p>
<p>æ ¹æ®é‡å‚æ•°åŒ–æŠ€å·§ï¼Œæˆ‘ä»¬å¯ä»¥å†™æˆï¼š
\begin{equation}
\boldsymbol{x}<em t-1="t-1">{t-1} = \bar{\alpha}</em>}\boldsymbol{x<em t-1="t-1">0 + \bar{\beta}</em>}\boldsymbol{\varepsilon<em t-1="t-1">{t-1}, \quad \boldsymbol{\varepsilon}</em>)
\end{equation}} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I</p>
<p>å†åº”ç”¨ä¸€æ­¥æ‰©æ•£ï¼š
\begin{equation}
\boldsymbol{x}<em t-1="t-1">t = \alpha_t\boldsymbol{x}</em>)
\end{equation}} + \beta_t\boldsymbol{\varepsilon}_t, \quad \boldsymbol{\varepsilon}_t \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I</p>
<p>ä»£å…¥å¾—ï¼š
\begin{equation}
\begin{aligned}
\boldsymbol{x}<em t-1="t-1">t &amp;= \alpha_t(\bar{\alpha}</em>}\boldsymbol{x<em t-1="t-1">0 + \bar{\beta}</em>}\boldsymbol{\varepsilon<em t-1="t-1">{t-1}) + \beta_t\boldsymbol{\varepsilon}_t \
&amp;= \alpha_t\bar{\alpha}</em>}\boldsymbol{x<em t-1="t-1">0 + \alpha_t\bar{\beta}</em>_t
\end{aligned}
\end{equation}}\boldsymbol{\varepsilon}_{t-1} + \beta_t\boldsymbol{\varepsilon</p>
<p>ç”±äº$\boldsymbol{\varepsilon}_{t-1}$å’Œ$\boldsymbol{\varepsilon}_t$ç›¸äº’ç‹¬ç«‹ï¼Œæ ¹æ®<strong>é«˜æ–¯åˆ†å¸ƒçš„å åŠ æ€§</strong>ï¼šä¸¤ä¸ªç‹¬ç«‹é«˜æ–¯éšæœºå˜é‡$\mathcal{N}(0, \sigma_1^2)$å’Œ$\mathcal{N}(0, \sigma_2^2)$çš„çº¿æ€§ç»„åˆ$a_1\boldsymbol{\varepsilon}_1 + a_2\boldsymbol{\varepsilon}_2$æœä»$\mathcal{N}(0, a_1^2\sigma_1^2 + a_2^2\sigma_2^2)$ã€‚</p>
<p>å› æ­¤ï¼Œ$\alpha_t\bar{\beta}<em t-1="t-1">{t-1}\boldsymbol{\varepsilon}</em>} + \beta_t\boldsymbol{\varepsilon<em t-1="t-1">t$çš„æ–¹å·®ä¸ºï¼š
\begin{equation}
\alpha_t^2\bar{\beta}</em>^2) + \beta_t^2
\end{equation}}^2 + \beta_t^2 = \alpha_t^2(1-\bar{\alpha}_{t-1</p>
<p>åˆ©ç”¨$\alpha_t^2 + \beta_t^2 = 1$ï¼Œæˆ‘ä»¬æœ‰$\beta_t^2 = 1 - \alpha_t^2$ï¼Œä»£å…¥å¾—ï¼š
\begin{equation}
\begin{aligned}
\alpha_t^2(1-\bar{\alpha}<em t-1="t-1">{t-1}^2) + \beta_t^2 &amp;= \alpha_t^2 - \alpha_t^2\bar{\alpha}</em>^2 + 1 - \alpha_t^2 \
&amp;= 1 - \alpha_t^2\bar{\alpha}_{t-1}^2 \
&amp;= 1 - \bar{\alpha}_t^2 \
&amp;= \bar{\beta}_t^2
\end{aligned}
\end{equation}</p>
<p>å› æ­¤ï¼š
\begin{equation}
\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}, \quad \boldsymbol{\varepsilon} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})
\end{equation}</p>
<p>å³$q(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t; \bar{\alpha}_t\boldsymbol{x}_0, \bar{\beta}_t^2\boldsymbol{I})$ã€‚è¯æ¯•ã€‚</p>
<h4 id="12">1.2 åå‘å»å™ªè¿‡ç¨‹ï¼ˆåå‘é©¬å°”å¯å¤«é“¾ï¼‰</h4>
<p><strong>å®šä¹‰2ï¼ˆåå‘è¿‡ç¨‹ï¼‰</strong>ï¼šåå‘å»å™ªè¿‡ç¨‹å®šä¹‰ä¸ºå‚æ•°åŒ–çš„é©¬å°”å¯å¤«é“¾ï¼š</p>
<p>\begin{equation}
p_{\boldsymbol{\theta}}(\boldsymbol{x}<em t="1">{0:T}) = p(\boldsymbol{x}_T)\prod</em>_t)
\end{equation}}^{T} p_{\boldsymbol{\theta}}(\boldsymbol{x}_{t-1}|\boldsymbol{x</p>
<p>å…¶ä¸­å…ˆéªŒ$p(\boldsymbol{x}_T) = \mathcal{N}(\boldsymbol{x}_T; \boldsymbol{0}, \boldsymbol{I})$ï¼Œåå‘è½¬ç§»æ¦‚ç‡å»ºæ¨¡ä¸ºï¼š</p>
<p>\begin{equation}
p_{\boldsymbol{\theta}}(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t) = \mathcal{N}(\boldsymbol{x}</em>)
\end{equation}}; \boldsymbol{\mu}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t), \sigma_t^2\boldsymbol{I</p>
<p>å…¶ä¸­$\boldsymbol{\mu}_{\boldsymbol{\theta}}$æ˜¯éœ€è¦å­¦ä¹ çš„å‡å€¼å‡½æ•°ï¼Œ$\sigma_t^2$æ˜¯é¢„è®¾çš„æ–¹å·®ã€‚</p>
<h3 id="2">2. åå‘æ¡ä»¶åˆ†å¸ƒçš„æ¨å¯¼</h3>
<p>ä¸ºäº†ç†è§£å¦‚ä½•è®¾è®¡åå‘è¿‡ç¨‹ï¼Œæˆ‘ä»¬éœ€è¦æ¨å¯¼çœŸå®çš„åå‘æ¡ä»¶åˆ†å¸ƒ$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$ã€‚</p>
<p><strong>å®šç†2ï¼ˆåå‘æ¡ä»¶åˆ†å¸ƒï¼‰</strong>ï¼šç»™å®š$\boldsymbol{x}_t$å’Œ$\boldsymbol{x}_0$ï¼Œåå‘æ¡ä»¶åˆ†å¸ƒä¸ºï¼š</p>
<p>\begin{equation}
q(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}</em>)
\end{equation}}; \tilde{\boldsymbol{\mu}}_t(\boldsymbol{x}_t, \boldsymbol{x}_0), \tilde{\beta}_t^2\boldsymbol{I</p>
<p>å…¶ä¸­å‡å€¼å’Œæ–¹å·®ä¸ºï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{\mu}}<em t-1="t-1">t(\boldsymbol{x}_t, \boldsymbol{x}_0) = \frac{\alpha_t\bar{\beta}</em>}^2}{\bar{\beta<em t-1="t-1">t^2}\boldsymbol{x}_t + \frac{\beta_t^2\bar{\alpha}</em>_0
\end{equation}}}{\bar{\beta}_t^2}\boldsymbol{x</p>
<p>\begin{equation}
\tilde{\beta}<em t-1="t-1">t^2 = \frac{\bar{\beta}</em>
\end{equation}}^2\beta_t^2}{\bar{\beta}_t^2</p>
<p><strong>è¯æ˜</strong>ï¼šæ ¹æ®è´å¶æ–¯å®šç†ï¼š</p>
<p>\begin{equation}
q(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \frac{q(\boldsymbol{x}_t|\boldsymbol{x}</em>}, \boldsymbol{x<em t-1="t-1">0)q(\boldsymbol{x}</em>
\end{equation}}|\boldsymbol{x}_0)}{q(\boldsymbol{x}_t|\boldsymbol{x}_0)</p>
<p>ç”±äºé©¬å°”å¯å¤«æ€§è´¨ï¼Œ$q(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>}, \boldsymbol{x<em t-1="t-1">0) = q(\boldsymbol{x}_t|\boldsymbol{x}</em>)$ï¼Œå› æ­¤ï¼š</p>
<p>\begin{equation}
q(\boldsymbol{x}<em t-1="t-1">{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) \propto q(\boldsymbol{x}_t|\boldsymbol{x}</em>_0)
\end{equation}})q(\boldsymbol{x}_{t-1}|\boldsymbol{x</p>
<p>æˆ‘ä»¬çŸ¥é“ï¼š
\begin{align}
q(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>}) &amp;= \mathcal{N}(\boldsymbol{x<em t-1="t-1">t; \alpha_t\boldsymbol{x}</em>) \
q(\boldsymbol{x}}, \beta_t^2\boldsymbol{I<em t-1="t-1">{t-1}|\boldsymbol{x}_0) &amp;= \mathcal{N}(\boldsymbol{x}</em>}; \bar{\alpha<em t-1="t-1">{t-1}\boldsymbol{x}_0, \bar{\beta}</em>)
\end{align}}^2\boldsymbol{I</p>
<p>å°†é«˜æ–¯åˆ†å¸ƒçš„å¯†åº¦å‡½æ•°ä»£å…¥ï¼š</p>
<p>\begin{equation}
\begin{aligned}
&amp;q(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>})q(\boldsymbol{x<em t-1="t-1">{t-1}|\boldsymbol{x}_0) \
&amp;\propto \exp\left(-\frac{1}{2}\left[\frac{|\boldsymbol{x}_t - \alpha_t\boldsymbol{x}</em>}|^2}{\beta_t^2} + \frac{|\boldsymbol{x<em t-1="t-1">{t-1} - \bar{\alpha}</em>}\boldsymbol{x<em t-1="t-1">0|^2}{\bar{\beta}</em>\right]\right)
\end{aligned}
\end{equation}}^2</p>
<p>å±•å¼€äºŒæ¬¡é¡¹ï¼š</p>
<p>\begin{equation}
\begin{aligned}
&amp;\frac{|\boldsymbol{x}<em t-1="t-1">t - \alpha_t\boldsymbol{x}</em>}|^2}{\beta_t^2} + \frac{|\boldsymbol{x<em t-1="t-1">{t-1} - \bar{\alpha}</em>}\boldsymbol{x<em t-1="t-1">0|^2}{\bar{\beta}</em> \
&amp;= \frac{1}{\beta_t^2}(\boldsymbol{x}}^2<em t-1="t-1">t^{\top}\boldsymbol{x}_t - 2\alpha_t\boldsymbol{x}_t^{\top}\boldsymbol{x}</em>} + \alpha_t^2\boldsymbol{x<em t-1="t-1">{t-1}^{\top}\boldsymbol{x}</em>) \
&amp;\quad + \frac{1}{\bar{\beta}<em t-1="t-1">{t-1}^2}(\boldsymbol{x}</em>}^{\top}\boldsymbol{x<em t-1="t-1">{t-1} - 2\bar{\alpha}</em>}\boldsymbol{x<em t-1="t-1">{t-1}^{\top}\boldsymbol{x}_0 + \bar{\alpha}</em>_0)
\end{aligned}
\end{equation}}^2\boldsymbol{x}_0^{\top}\boldsymbol{x</p>
<p>æ”¶é›†å…³äº$\boldsymbol{x}_{t-1}$çš„äºŒæ¬¡é¡¹ï¼š</p>
<p>\begin{equation}
\left(\frac{\alpha_t^2}{\beta_t^2} + \frac{1}{\bar{\beta}<em t-1="t-1">{t-1}^2}\right)\boldsymbol{x}</em>
\end{equation}}^{\top}\boldsymbol{x}_{t-1</p>
<p>æ”¶é›†å…³äº$\boldsymbol{x}_{t-1}$çš„ä¸€æ¬¡é¡¹ï¼š</p>
<p>\begin{equation}
-2\left(\frac{\alpha_t}{\beta_t^2}\boldsymbol{x}<em t-1="t-1">t^{\top} + \frac{\bar{\alpha}</em>}}{\bar{\beta<em t-1="t-1">{t-1}^2}\boldsymbol{x}_0^{\top}\right)\boldsymbol{x}</em>
\end{equation}</p>
<p>åéªŒåˆ†å¸ƒ$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)$ä»ç„¶æ˜¯é«˜æ–¯åˆ†å¸ƒï¼Œå…¶ç²¾åº¦ï¼ˆæ–¹å·®çš„å€’æ•°ï¼‰ä¸ºï¼š</p>
<p>\begin{equation}
\tilde{\beta}<em t-1="t-1">t^{-2} = \frac{\alpha_t^2}{\beta_t^2} + \frac{1}{\bar{\beta}</em>}^2} = \frac{\alpha_t^2\bar{\beta<em t-1="t-1">{t-1}^2 + \beta_t^2}{\beta_t^2\bar{\beta}</em>
\end{equation}}^2</p>
<p>åˆ©ç”¨$\alpha_t^2\bar{\beta}<em t-1="t-1">{t-1}^2 + \beta_t^2 = \alpha_t^2(1-\bar{\alpha}</em>_t^2$ï¼Œå¾—ï¼š}^2) + (1-\alpha_t^2) = 1 - \alpha_t^2\bar{\alpha}_{t-1}^2 = \bar{\beta</p>
<p>\begin{equation}
\tilde{\beta}<em t-1="t-1">t^2 = \frac{\beta_t^2\bar{\beta}</em>
\end{equation}}^2}{\bar{\beta}_t^2</p>
<p>å‡å€¼ä¸ºï¼š</p>
<p>\begin{equation}
\begin{aligned}
\tilde{\boldsymbol{\mu}}<em t-1="t-1">t &amp;= \tilde{\beta}_t^2\left(\frac{\alpha_t}{\beta_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}</em>}}{\bar{\beta<em t-1="t-1">{t-1}^2}\boldsymbol{x}_0\right) \
&amp;= \frac{\beta_t^2\bar{\beta}</em>}^2}{\bar{\beta<em t-1="t-1">t^2}\left(\frac{\alpha_t}{\beta_t^2}\boldsymbol{x}_t + \frac{\bar{\alpha}</em>}}{\bar{\beta<em t-1="t-1">{t-1}^2}\boldsymbol{x}_0\right) \
&amp;= \frac{\alpha_t\bar{\beta}</em>}^2}{\bar{\beta<em t-1="t-1">t^2}\boldsymbol{x}_t + \frac{\beta_t^2\bar{\alpha}</em>_0
\end{aligned}
\end{equation}}}{\bar{\beta}_t^2}\boldsymbol{x</p>
<p>è¯æ¯•ã€‚</p>
<h3 id="3-elbo">3. å˜åˆ†ä¸‹ç•Œï¼ˆELBOï¼‰çš„å®Œæ•´æ¨å¯¼</h3>
<p>DDPMçš„è®­ç»ƒç›®æ ‡æ˜¯æœ€å¤§åŒ–å¯¹æ•°ä¼¼ç„¶$\log p_{\boldsymbol{\theta}}(\boldsymbol{x}_0)$ã€‚æˆ‘ä»¬é€šè¿‡å˜åˆ†æ¨æ–­æ¨å¯¼å˜åˆ†ä¸‹ç•Œã€‚</p>
<p><strong>å®šç†3ï¼ˆå˜åˆ†ä¸‹ç•Œï¼‰</strong>ï¼šå¯¹æ•°ä¼¼ç„¶çš„å˜åˆ†ä¸‹ç•Œä¸ºï¼š</p>
<p>\begin{equation}
\log p_{\boldsymbol{\theta}}(\boldsymbol{x}<em q_boldsymbol_x="q(\boldsymbol{x">0) \geq \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">{1:T}|\boldsymbol{x}_0)}\left[\log\frac{p</em>}}(\boldsymbol{x<em 1:T="1:T">{0:T})}{q(\boldsymbol{x}</em>
\end{equation}}|\boldsymbol{x}_0)}\right] =: \mathcal{L</p>
<p><strong>è¯æ˜</strong>ï¼šä½¿ç”¨Jensenä¸ç­‰å¼ã€‚å¯¹äºä»»æ„åˆ†å¸ƒ$q(\boldsymbol{x}_{1:T}|\boldsymbol{x}_0)$ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\log p_{\boldsymbol{\theta}}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">0) &amp;= \log\int p</em>}}(\boldsymbol{x<em 1:T="1:T">{0:T})d\boldsymbol{x}</em> \
&amp;= \log\int q(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{1:T}|\boldsymbol{x}_0)\frac{p</em>}}(\boldsymbol{x<em 1:T="1:T">{0:T})}{q(\boldsymbol{x}</em>}|\boldsymbol{x<em 1:T="1:T">0)}d\boldsymbol{x}</em> \
&amp;= \log\mathbb{E}<em 1:T="1:T">{q(\boldsymbol{x}</em>}|\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">0)}\left[\frac{p</em>}}(\boldsymbol{x<em 1:T="1:T">{0:T})}{q(\boldsymbol{x}</em>}|\boldsymbol{x<em q_boldsymbol_x="q(\boldsymbol{x">0)}\right] \
&amp;\geq \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">{1:T}|\boldsymbol{x}_0)}\left[\log\frac{p</em>}}(\boldsymbol{x<em 1:T="1:T">{0:T})}{q(\boldsymbol{x}</em>\right]
\end{aligned}
\end{equation}}|\boldsymbol{x}_0)</p>
<p>æœ€åä¸€æ­¥ä½¿ç”¨äº†Jensenä¸ç­‰å¼ï¼ˆ$\log$æ˜¯å‡¹å‡½æ•°ï¼‰ã€‚è¯æ¯•ã€‚</p>
<p><strong>å®šç†4ï¼ˆELBOçš„KLæ•£åº¦åˆ†è§£ï¼‰</strong>ï¼šå˜åˆ†ä¸‹ç•Œå¯ä»¥åˆ†è§£ä¸ºï¼š</p>
<p>\begin{equation}
\begin{aligned}
\mathcal{L} = &amp;\mathbb{E}<em _boldsymbol_theta="\boldsymbol{\theta">q[\log p</em>}}(\boldsymbol{x<em KL="KL">0|\boldsymbol{x}_1)] \
&amp;- D</em>}(q(\boldsymbol{x<em t="2">T|\boldsymbol{x}_0) | p(\boldsymbol{x}_T)) \
&amp;- \sum</em>}^{T}\mathbb{E<em KL="KL">{q(\boldsymbol{x}_t|\boldsymbol{x}_0)}[D</em>}(q(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t-1}|\boldsymbol{x}_t,\boldsymbol{x}_0) | p</em>_t))]
\end{aligned}
\end{equation}}}(\boldsymbol{x}_{t-1}|\boldsymbol{x</p>
<p><strong>è¯æ˜</strong>ï¼šå±•å¼€ELBOï¼š</p>
<p>\begin{equation}
\begin{aligned}
\mathcal{L} &amp;= \mathbb{E}<em _boldsymbol_theta="\boldsymbol{\theta">q\left[\log\frac{p</em>}}(\boldsymbol{x<em 1:T="1:T">{0:T})}{q(\boldsymbol{x}</em>}|\boldsymbol{x<em t="1">0)}\right] \
&amp;= \mathbb{E}_q\left[\log\frac{p(\boldsymbol{x}_T)\prod</em>}^{T}p_{\boldsymbol{\theta}}(\boldsymbol{x<em t="1">{t-1}|\boldsymbol{x}_t)}{\prod</em>}^{T}q(\boldsymbol{x<em t-1="t-1">t|\boldsymbol{x}</em>\right] \
&amp;= \mathbb{E}})<em t="1">q\left[\log p(\boldsymbol{x}_T) + \sum</em>}^{T}\log p_{\boldsymbol{\theta}}(\boldsymbol{x<em t="1">{t-1}|\boldsymbol{x}_t) - \sum</em>}^{T}\log q(\boldsymbol{x<em t-1="t-1">t|\boldsymbol{x}</em>)\right]
\end{aligned}
\end{equation}</p>
<p>åˆ©ç”¨é“¾å¼æ³•åˆ™$q(\boldsymbol{x}<em t="2">{1:T}|\boldsymbol{x}_0) = q(\boldsymbol{x}_T|\boldsymbol{x}_0)\prod</em>_0)$ï¼ˆé€šè¿‡è´å¶æ–¯å®šç†éªŒè¯ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ”¹å†™ï¼š}^{T}q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t,\boldsymbol{x</p>
<p>\begin{equation}
\begin{aligned}
\mathcal{L} &amp;= \mathbb{E}<em _boldsymbol_theta="\boldsymbol{\theta">q\left[\log\frac{p(\boldsymbol{x}_T)p</em>}}(\boldsymbol{x<em t="2">0|\boldsymbol{x}_1)}{q(\boldsymbol{x}_T|\boldsymbol{x}_0)} + \sum</em>}^{T}\log\frac{p_{\boldsymbol{\theta}}(\boldsymbol{x<em t-1="t-1">{t-1}|\boldsymbol{x}_t)}{q(\boldsymbol{x}</em>}|\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t,\boldsymbol{x}_0)}\right] \
&amp;= \mathbb{E}_q[\log p</em>}}(\boldsymbol{x<em KL="KL">0|\boldsymbol{x}_1)] - D</em>}(q(\boldsymbol{x<em t="2">T|\boldsymbol{x}_0) | p(\boldsymbol{x}_T)) \
&amp;\quad - \sum</em>}^{T}\mathbb{E<em KL="KL">{q(\boldsymbol{x}_t|\boldsymbol{x}_0)}[D</em>}(q(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t-1}|\boldsymbol{x}_t,\boldsymbol{x}_0) | p</em>_t))]
\end{aligned}
\end{equation}}}(\boldsymbol{x}_{t-1}|\boldsymbol{x</p>
<p>è¯æ¯•ã€‚</p>
<h3 id="4">4. æŸå¤±å‡½æ•°çš„è¯¦ç»†æ¨å¯¼</h3>
<h4 id="41">4.1 åŸºäºå™ªå£°é¢„æµ‹çš„å‚æ•°åŒ–</h4>
<p>æ ¹æ®å®šç†2ï¼ŒçœŸå®çš„åå‘å‡å€¼ä¸ºï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{\mu}}<em t-1="t-1">t(\boldsymbol{x}_t, \boldsymbol{x}_0) = \frac{\alpha_t\bar{\beta}</em>}^2}{\bar{\beta<em t-1="t-1">t^2}\boldsymbol{x}_t + \frac{\beta_t^2\bar{\alpha}</em>_0
\end{equation}}}{\bar{\beta}_t^2}\boldsymbol{x</p>
<p>ä»$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ï¼Œæˆ‘ä»¬å¯ä»¥è§£å‡ºï¼š</p>
<p>\begin{equation}
\boldsymbol{x}_0 = \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon}}{\bar{\alpha}_t}
\end{equation}</p>
<p>ä»£å…¥å‡å€¼è¡¨è¾¾å¼ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\tilde{\boldsymbol{\mu}}<em t-1="t-1">t &amp;= \frac{\alpha_t\bar{\beta}</em>}^2}{\bar{\beta<em t-1="t-1">t^2}\boldsymbol{x}_t + \frac{\beta_t^2\bar{\alpha}</em>}}{\bar{\beta<em t-1="t-1">t^2} \cdot \frac{\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon}}{\bar{\alpha}_t} \
&amp;= \frac{1}{\bar{\beta}_t^2}\left[\alpha_t\bar{\beta}</em>}^2\boldsymbol{x<em t-1="t-1">t + \frac{\beta_t^2\bar{\alpha}</em>}}{\bar{\alpha<em t-1="t-1">t}\boldsymbol{x}_t - \frac{\beta_t^2\bar{\alpha}</em>\right]
\end{aligned}
\end{equation}}\bar{\beta}_t}{\bar{\alpha}_t}\boldsymbol{\varepsilon</p>
<p>åˆ©ç”¨$\bar{\alpha}<em t-1="t-1">t = \alpha_t\bar{\alpha}</em>_t^2$ï¼ŒåŒ–ç®€ç³»æ•°ï¼š}$å’Œ$\bar{\beta}_t^2 = 1 - \bar{\alpha</p>
<p>\begin{equation}
\begin{aligned}
\alpha_t\bar{\beta}<em t-1="t-1">{t-1}^2 + \frac{\beta_t^2\bar{\alpha}</em>}}{\bar{\alpha<em t-1="t-1">t} &amp;= \alpha_t(1-\bar{\alpha}</em>}^2) + \frac{\beta_t^2\bar{\alpha<em t-1="t-1">{t-1}}{\alpha_t\bar{\alpha}</em> \
&amp;= \alpha_t - \alpha_t\bar{\alpha}}<em t-1="t-1">{t-1}^2 + \frac{\beta_t^2}{\alpha_t} \
&amp;= \alpha_t - \alpha_t\bar{\alpha}</em> \
&amp;= \frac{\alpha_t^2 - \alpha_t^2\bar{\alpha}_{t-1}^2 + 1 - \alpha_t^2}{\alpha_t} \
&amp;= \frac{1 - \bar{\alpha}_t^2}{\alpha_t} = \frac{\bar{\beta}_t^2}{\alpha_t}
\end{aligned}
\end{equation}}^2 + \frac{1-\alpha_t^2}{\alpha_t</p>
<p>å› æ­¤ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{\mu}}<em t-1="t-1">t = \frac{1}{\alpha_t}\left[\boldsymbol{x}_t - \frac{\beta_t^2\bar{\alpha}</em>}\bar{\beta<em t-1="t-1">t}{\bar{\alpha}_t\bar{\beta}_t^2}\boldsymbol{\varepsilon}\right] = \frac{1}{\alpha_t}\left[\boldsymbol{x}_t - \frac{\beta_t^2}{\bar{\beta}_t\alpha_t\bar{\alpha}</em>\right]
\end{equation}}}\boldsymbol{\varepsilon</p>
<p>åˆ©ç”¨$\bar{\alpha}<em t-1="t-1">t = \alpha_t\bar{\alpha}</em>$ï¼Œè¿›ä¸€æ­¥åŒ–ç®€ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{\mu}}_t = \frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \frac{\beta_t^2}{\bar{\beta}_t\bar{\alpha}_t}\boldsymbol{\varepsilon}\right)
\end{equation}</p>
<p>æ³¨æ„æœ¬æ–‡çš„è®°å·ä¸­$\beta_t^2 = 1 - \alpha_t^2$ï¼Œè€ŒåŸå§‹DDPMè®ºæ–‡ä¸­å®šä¹‰çš„$\beta_t$å¯¹åº”æœ¬æ–‡çš„$\beta_t^2$ã€‚å› æ­¤åœ¨åŸå§‹è®ºæ–‡è®°å·ä¸‹ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{\mu}}_t = \frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \frac{\beta_t}{\sqrt{1-\bar{\alpha}_t}}\boldsymbol{\varepsilon}\right)
\end{equation}</p>
<p>è¿™å¯å‘æˆ‘ä»¬å°†æ¨¡å‹å‚æ•°åŒ–ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{\mu}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) = \frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \frac{\beta_t}{\sqrt{1-\bar{\alpha}_t}}\boldsymbol{\epsilon}</em>_t, t)\right)
\end{equation}}}(\boldsymbol{x</p>
<p>å…¶ä¸­$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$æ˜¯å™ªå£°é¢„æµ‹ç½‘ç»œã€‚</p>
<h4 id="42-l_t">4.2 L_tæŸå¤±çš„æ¨å¯¼</h4>
<p>å¯¹äº$t \geq 2$ï¼ŒKLæ•£åº¦é¡¹ä¸ºï¼š</p>
<p>\begin{equation}
\begin{aligned}
L_{t-1} &amp;= \mathbb{E}<em KL="KL">q[D</em>}(q(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t-1}|\boldsymbol{x}_t,\boldsymbol{x}_0) | p</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t-1}|\boldsymbol{x}_t))] \
&amp;= \mathbb{E}_q\left[\frac{1}{2\sigma_t^2}|\tilde{\boldsymbol{\mu}}_t - \boldsymbol{\mu}</em>
\end{aligned}
\end{equation}}}|^2\right] + \text{const</p>
<p>è¿™é‡Œä½¿ç”¨äº†ä¸¤ä¸ªé«˜æ–¯åˆ†å¸ƒKLæ•£åº¦çš„å…¬å¼ï¼š</p>
<p>\begin{equation}
D_{KL}(\mathcal{N}(\boldsymbol{\mu}_1, \Sigma_1) | \mathcal{N}(\boldsymbol{\mu}_2, \Sigma_2)) = \frac{1}{2}\left[\log\frac{|\Sigma_2|}{|\Sigma_1|} - d + \text{tr}(\Sigma_2^{-1}\Sigma_1) + (\boldsymbol{\mu}_2-\boldsymbol{\mu}_1)^{\top}\Sigma_2^{-1}(\boldsymbol{\mu}_2-\boldsymbol{\mu}_1)\right]
\end{equation}</p>
<p>å½“æ–¹å·®ç›¸åŒæ—¶ï¼Œç®€åŒ–ä¸ºï¼š</p>
<p>\begin{equation}
D_{KL}(\mathcal{N}(\boldsymbol{\mu}_1, \sigma^2\boldsymbol{I}) | \mathcal{N}(\boldsymbol{\mu}_2, \sigma^2\boldsymbol{I})) = \frac{1}{2\sigma^2}|\boldsymbol{\mu}_1 - \boldsymbol{\mu}_2|^2
\end{equation}</p>
<p>ä»£å…¥å‡å€¼çš„è¡¨è¾¾å¼ï¼š</p>
<p>\begin{equation}
\begin{aligned}
L_{t-1} &amp;= \mathbb{E}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{x}_0,\boldsymbol{\varepsilon}}\left[\frac{1}{2\sigma_t^2}\left|\frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \frac{\beta_t}{\sqrt{1-\bar{\alpha}_t}}\boldsymbol{\varepsilon}\right) - \frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \frac{\beta_t}{\sqrt{1-\bar{\alpha}_t}}\boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t,t)\right)\right|^2\right] \
&amp;= \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0,\boldsymbol{\varepsilon}}\left[\frac{\beta_t^2}{2\sigma_t^2\alpha_t^2(1-\bar{\alpha}_t)}|\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t,t)|^2\right] \
&amp;= \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0,\boldsymbol{\varepsilon}}\left[\frac{\beta_t^2}{2\sigma_t^2\alpha_t^2(1-\bar{\alpha}_t)}|\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}</em>,t)|^2\right]
\end{aligned}
\end{equation}}}(\bar{\alpha}_t\boldsymbol{x}_0+\sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon</p>
<h4 id="43-l_simple">4.3 ç®€åŒ–æŸå¤±å‡½æ•°ï¼ˆL_simpleï¼‰</h4>
<p>DDPMå‘ç°ï¼Œå¿½ç•¥æƒé‡ç³»æ•°$\frac{\beta_t^2}{2\sigma_t^2\alpha_t^2(1-\bar{\alpha}_t)}$ï¼Œä½¿ç”¨ç®€åŒ–çš„æŸå¤±å‡½æ•°ï¼š</p>
<p>\begin{equation}
L_{\text{simple}} = \mathbb{E}<em _boldsymbol_theta="\boldsymbol{\theta">{t\sim\mathcal{U}(1,T), \boldsymbol{x}_0\sim q(\boldsymbol{x}_0), \boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I})}\left[|\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}</em>,t)|^2\right]
\end{equation}}}(\bar{\alpha}_t\boldsymbol{x}_0+\sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon</p>
<p>å®é™…ä¸Šæ•ˆæœæ›´å¥½ã€‚è¿™å¯ä»¥ç†è§£ä¸ºï¼š</p>
<ol>
<li>
<p><strong>é‡å‚æ•°åŒ–æŠ€å·§</strong>ï¼šå°†é‡‡æ ·$\boldsymbol{x}_t \sim q(\boldsymbol{x}_t|\boldsymbol{x}_0)$è½¬åŒ–ä¸ºç¡®å®šæ€§å˜æ¢$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \sqrt{1-\bar{\alpha}_t}\boldsymbol{\varepsilon}$</p>
</li>
<li>
<p><strong>å»å™ªè‡ªç¼–ç å™¨è§†è§’</strong>ï¼šæ¨¡å‹å­¦ä¹ é¢„æµ‹æ·»åŠ åˆ°å¹²å‡€æ•°æ®$\boldsymbol{x}_0$ä¸Šçš„å™ªå£°$\boldsymbol{\varepsilon}$</p>
</li>
<li>
<p><strong>å¤šå°ºåº¦å»å™ª</strong>ï¼šä¸åŒçš„$t$å¯¹åº”ä¸åŒå™ªå£°æ°´å¹³ï¼Œæ¨¡å‹å­¦ä¹ åœ¨æ‰€æœ‰å™ªå£°æ°´å¹³ä¸‹é¢„æµ‹å™ªå£°</p>
</li>
</ol>
<h3 id="5-vae">5. ä¸VAEçš„æ·±å±‚è”ç³»</h3>
<p>DDPMå®é™…ä¸Šæ˜¯ä¸€ä¸ªå…·æœ‰ç‰¹æ®Šç»“æ„çš„å±‚æ¬¡åŒ–VAEï¼ˆHierarchical VAEï¼‰ã€‚</p>
<p><strong>å®šç†5ï¼ˆDDPMä½œä¸ºVAEï¼‰</strong>ï¼šDDPMå¯ä»¥è§†ä¸ºæ»¡è¶³ä»¥ä¸‹æ€§è´¨çš„VAEï¼š</p>
<ol>
<li><strong>æ½œå˜é‡ç»´åº¦</strong>ï¼šæ½œå˜é‡$\boldsymbol{x}_{1:T}$ä¸æ•°æ®$\boldsymbol{x}_0$ç»´åº¦ç›¸åŒ</li>
<li><strong>ç¼–ç å™¨ç»“æ„</strong>ï¼šç¼–ç å™¨$q(\boldsymbol{x}_{1:T}|\boldsymbol{x}_0)$æ˜¯å›ºå®šçš„ï¼ˆä¸å¯å­¦ä¹ ï¼‰é«˜æ–¯è½¬ç§»</li>
<li><strong>æ½œå˜é‡å±‚æ¬¡</strong>ï¼š$T$å±‚æ½œå˜é‡å½¢æˆé©¬å°”å¯å¤«é“¾</li>
<li><strong>è§£ç å™¨ç»“æ„</strong>ï¼šè§£ç å™¨$p_{\boldsymbol{\theta}}(\boldsymbol{x}<em 1:T="1:T">{0:T-1}|\boldsymbol{x}</em>)$åå‘éå†é©¬å°”å¯å¤«é“¾</li>
</ol>
<p><strong>ä¸æ ‡å‡†VAEçš„å¯¹æ¯”</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>æ ‡å‡†VAE</th>
<th>DDPM</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ½œå˜é‡ç»´åº¦</td>
<td>$\dim(\boldsymbol{z}) \ll \dim(\boldsymbol{x})$</td>
<td>$\dim(\boldsymbol{x}_t) = \dim(\boldsymbol{x}_0)$</td>
</tr>
<tr>
<td>ç¼–ç å™¨</td>
<td>å¯å­¦ä¹ çš„$q_{\phi}(\boldsymbol{z}</td>
<td>\boldsymbol{x})$</td>
</tr>
<tr>
<td>æ½œå˜é‡ç»“æ„</td>
<td>å•å±‚</td>
<td>$T$å±‚é©¬å°”å¯å¤«é“¾</td>
</tr>
<tr>
<td>ELBO</td>
<td>$\mathbb{E}<em _boldsymbol_theta="\boldsymbol{\theta">q[\log p</em>}}(\boldsymbol{x</td>
<td>\boldsymbol{z})] - D_{KL}(q_{\phi}(\boldsymbol{z}</td>
</tr>
</tbody>
</table>
<p><strong>ä¼˜åŠ¿åˆ†æ</strong>ï¼š</p>
<ol>
<li><strong>é¿å…åéªŒåç¼©</strong>ï¼šå›ºå®šç¼–ç å™¨é˜²æ­¢äº†VAEè®­ç»ƒä¸­å¸¸è§çš„åéªŒåç¼©é—®é¢˜</li>
<li><strong>æ¸è¿›å¼å»ºæ¨¡</strong>ï¼š$T$æ­¥æ¸è¿›ç”Ÿæˆæ¯”ä¸€æ­¥ç”Ÿæˆæ›´å®¹æ˜“å­¦ä¹ </li>
<li><strong>è¡¨è¾¾èƒ½åŠ›</strong>ï¼šé«˜ç»´æ½œç©ºé—´ä¿ç•™æ›´å¤šä¿¡æ¯</li>
</ol>
<h3 id="6">6. é‡‡æ ·ç®—æ³•çš„è¯¦ç»†æ¨å¯¼</h3>
<h4 id="61-ddpm">6.1 ç¡®å®šæ€§é‡‡æ ·ï¼ˆDDPMé‡‡æ ·ï¼‰</h4>
<p><strong>ç®—æ³•1ï¼ˆDDPMé‡‡æ ·ï¼‰</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code>è¾“å…¥ï¼šè®­ç»ƒå¥½çš„å™ªå£°é¢„æµ‹æ¨¡å‹ Îµ_Î¸(x_t, t)
è¾“å‡ºï¼šç”Ÿæˆæ ·æœ¬ x_0

1. é‡‡æ · x_T ~ N(0, I)
2. for t = T, T-1, ..., 1 do
3.     é‡‡æ · z ~ N(0, I) if t &gt; 1, else z = 0
4.     è®¡ç®— x_{t-1} = (1/Î±_t)[x_t - (Î²_t/âˆš(1-á¾±_t))Îµ_Î¸(x_t, t)] + Ïƒ_t z
5. end for
6. return x_0
</code></pre></div>

<p><strong>å™ªå£°æ–¹å·®çš„é€‰æ‹©</strong>ï¼š</p>
<p>æ ¹æ®å®šç†2ï¼Œç†è®ºä¸Šåº”è¯¥ä½¿ç”¨$\sigma_t = \tilde{\beta}<em t-1="t-1">t = \frac{\beta_t\sqrt{1-\bar{\alpha}</em>$ã€‚}}}{\sqrt{1-\bar{\alpha}_t}</p>
<p>DDPMä¹Ÿå°è¯•äº†å›ºå®šæ–¹å·®$\sigma_t^2 = \beta_t^2$ï¼ˆå¯¹åº”æœ¬æ–‡è®°å·ï¼‰ï¼Œå‘ç°ä¸¤è€…æ•ˆæœç›¸è¿‘ã€‚</p>
<h4 id="62">6.2 æ¦‚ç‡è§£é‡Š</h4>
<p>æ¯ä¸€æ­¥é‡‡æ ·å¯ä»¥ç†è§£ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t-1}|\boldsymbol{x}_t \sim \mathcal{N}\left(\frac{1}{\alpha_t}\left(\boldsymbol{x}_t - \frac{\beta_t}{\sqrt{1-\bar{\alpha}_t}}\boldsymbol{\epsilon}</em>\right)
\end{equation}}}(\boldsymbol{x}_t,t)\right), \sigma_t^2\boldsymbol{I</p>
<p><strong>å‡å€¼é¡¹</strong>ï¼š$\frac{1}{\alpha_t}\left(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t - \frac{\beta_t}{\sqrt{1-\bar{\alpha}_t}}\boldsymbol{\epsilon}</em>_t,t)\right)$}}(\boldsymbol{x</p>
<ul>
<li>$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t,t)$ï¼šé¢„æµ‹çš„å™ªå£°</li>
<li>$\frac{\beta_t}{\sqrt{1-\bar{\alpha}_t}}$ï¼šå™ªå£°çš„ç¼©æ”¾å› å­</li>
<li>$\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t - \frac{\beta_t}{\sqrt{1-\bar{\alpha}_t}}\boldsymbol{\epsilon}</em>_t,t)$ï¼šå»å™ªåçš„ä¼°è®¡}}(\boldsymbol{x</li>
<li>$\frac{1}{\alpha_t}$ï¼šåå‘ç¼©æ”¾</li>
</ul>
<p><strong>æ–¹å·®é¡¹</strong>ï¼š$\sigma_t^2\boldsymbol{I}$</p>
<ul>
<li>æ§åˆ¶é‡‡æ ·çš„éšæœºæ€§</li>
<li>$\sigma_t = 0$ï¼šç¡®å®šæ€§å»å™ªï¼ˆç±»ä¼¼Greedy Decodingï¼‰</li>
<li>$\sigma_t &gt; 0$ï¼šéšæœºé‡‡æ ·ï¼ˆç±»ä¼¼Random Samplingï¼‰</li>
</ul>
<h3 id="7-score-based">7. Score-Basedæ¨¡å‹çš„ç­‰ä»·æ€§</h3>
<p>DDPMä¸åŸºäºåˆ†æ•°çš„ç”Ÿæˆæ¨¡å‹ï¼ˆScore-Based Generative Modelsï¼‰æœ‰æ·±åˆ»è”ç³»ã€‚</p>
<p><strong>å®šä¹‰3ï¼ˆScoreå‡½æ•°ï¼‰</strong>ï¼šæ•°æ®åˆ†å¸ƒ$q(\boldsymbol{x})$çš„scoreå‡½æ•°å®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
\nabla_{\boldsymbol{x}}\log q(\boldsymbol{x})
\end{equation}</p>
<p><strong>å®šç†6ï¼ˆDDPMçš„Scoreè§£é‡Šï¼‰</strong>ï¼šDDPMçš„å™ªå£°é¢„æµ‹ç½‘ç»œ$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$ä¸scoreå‡½æ•°çš„å…³ç³»ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{\epsilon}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}}(\boldsymbol{x}_t,t) = -\sqrt{1-\bar{\alpha}_t} \nabla</em>_t)
\end{equation}}_t}\log q(\boldsymbol{x</p>
<p><strong>è¯æ˜</strong>ï¼šå¯¹äº$q(\boldsymbol{x}_t) = \int q(\boldsymbol{x}_t|\boldsymbol{x}_0)q(\boldsymbol{x}_0)d\boldsymbol{x}_0$ï¼Œæœ‰ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\nabla_{\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t}\log q(\boldsymbol{x}_t) &amp;= \frac{\nabla</em><em _boldsymbol_x="\boldsymbol{x">t}q(\boldsymbol{x}_t)}{q(\boldsymbol{x}_t)} \
&amp;= \frac{\int \nabla</em><em q_boldsymbol_x="q(\boldsymbol{x">t}q(\boldsymbol{x}_t|\boldsymbol{x}_0)q(\boldsymbol{x}_0)d\boldsymbol{x}_0}{\int q(\boldsymbol{x}_t|\boldsymbol{x}_0)q(\boldsymbol{x}_0)d\boldsymbol{x}_0} \
&amp;= \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0|\boldsymbol{x}_t)}[\nabla</em>_0)]
\end{aligned}
\end{equation}}_t}\log q(\boldsymbol{x}_t|\boldsymbol{x</p>
<p>ç”±äº$q(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\bar{\alpha}_t\boldsymbol{x}_0, (1-\bar{\alpha}_t)\boldsymbol{I})$ï¼Œæœ‰ï¼š</p>
<p>\begin{equation}
\nabla_{\boldsymbol{x}_t}\log q(\boldsymbol{x}_t|\boldsymbol{x}_0) = -\frac{\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0}{1-\bar{\alpha}_t} = -\frac{\boldsymbol{\varepsilon}}{\sqrt{1-\bar{\alpha}_t}}
\end{equation}</p>
<p>å› æ­¤ï¼š</p>
<p>\begin{equation}
\nabla_{\boldsymbol{x}<em q_boldsymbol_x="q(\boldsymbol{x">t}\log q(\boldsymbol{x}_t) = -\frac{1}{\sqrt{1-\bar{\alpha}_t}}\mathbb{E}</em>]
\end{equation}}_0|\boldsymbol{x}_t)}[\boldsymbol{\varepsilon</p>
<p>DDPMè®­ç»ƒçš„ç›®æ ‡æ­£æ˜¯è®©$\boldsymbol{\epsilon}<em q_boldsymbol_x="q(\boldsymbol{x">{\boldsymbol{\theta}}(\boldsymbol{x}_t,t) \approx \mathbb{E}</em>]$ï¼Œå› æ­¤ï¼š}_0|\boldsymbol{x}_t)}[\boldsymbol{\varepsilon</p>
<p>\begin{equation}
\boldsymbol{\epsilon}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}}(\boldsymbol{x}_t,t) = -\sqrt{1-\bar{\alpha}_t}\nabla</em>_t)
\end{equation}}_t}\log q(\boldsymbol{x</p>
<p>è¯æ¯•ã€‚</p>
<p>è¿™è¯´æ˜DDPMæœ¬è´¨ä¸Šæ˜¯åœ¨å­¦ä¹ æ¯ä¸ªå™ªå£°æ°´å¹³ä¸‹çš„scoreå‡½æ•°ï¼Œé‡‡æ ·è¿‡ç¨‹ç­‰ä»·äº<strong>é€€ç«çš„æœ—ä¹‹ä¸‡åŠ¨åŠ›å­¦</strong>ï¼ˆAnnealed Langevin Dynamicsï¼‰ã€‚</p>
<h3 id="8">8. ç†è®ºæ”¶æ•›æ€§åˆ†æ</h3>
<h4 id="81">8.1 ç¦»æ•£æ—¶é—´åˆ†æ</h4>
<p><strong>å®šç†7ï¼ˆé‡æ„è¯¯å·®ç•Œï¼‰</strong>ï¼šå‡è®¾å™ªå£°é¢„æµ‹è¯¯å·®æœ‰ç•Œï¼Œå³$\mathbb{E}[|\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t,t)|^2] \leq \epsilon^2$ï¼Œåˆ™ç”Ÿæˆåˆ†å¸ƒä¸çœŸå®åˆ†å¸ƒçš„KLæ•£åº¦æ»¡è¶³ï¼š</p>
<p>\begin{equation}
D_{KL}(q(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">0) | p</em>_0)) \leq C_1 T\epsilon^2 + C_2/T
\end{equation}}}(\boldsymbol{x</p>
<p>å…¶ä¸­$C_1, C_2$æ˜¯ä¸æ•°æ®åˆ†å¸ƒç›¸å…³çš„å¸¸æ•°ã€‚</p>
<p><strong>ç›´è§‚è§£é‡Š</strong>ï¼š</p>
<ul>
<li>ç¬¬ä¸€é¡¹$C_1 T\epsilon^2$ï¼šç´¯ç§¯çš„é¢„æµ‹è¯¯å·®ï¼Œéšæ­¥æ•°$T$çº¿æ€§å¢é•¿</li>
<li>ç¬¬äºŒé¡¹$C_2/T$ï¼šç¦»æ•£åŒ–è¯¯å·®ï¼Œ$T$è¶Šå¤§ç¦»æ•£åŒ–è¶Šç²¾ç»†</li>
</ul>
<p><strong>æœ€ä¼˜æ­¥æ•°</strong>ï¼šå¹³è¡¡ä¸¤é¡¹è¯¯å·®ï¼Œæœ€ä¼˜$T \sim \epsilon^{-1}$ï¼Œæ­¤æ—¶è¯¯å·®ä¸º$O(\epsilon)$ã€‚</p>
<h4 id="82">8.2 è¿ç»­æ—¶é—´æé™</h4>
<p>å½“$T \to \infty$ï¼ŒDDPMæ”¶æ•›åˆ°<strong>éšæœºå¾®åˆ†æ–¹ç¨‹</strong>ï¼ˆSDEï¼‰ï¼š</p>
<p><strong>å‰å‘SDE</strong>ï¼š
\begin{equation}
d\boldsymbol{x} = -\frac{1}{2}\beta(t)\boldsymbol{x}dt + \sqrt{\beta(t)}d\boldsymbol{w}
\end{equation}</p>
<p><strong>åå‘SDE</strong>ï¼ˆ<a href="https://doi.org/10.1016/0304-4149(82)90051-5">Anderson 1982</a>ï¼‰ï¼š
\begin{equation}
d\boldsymbol{x} = \left[-\frac{1}{2}\beta(t)\boldsymbol{x} - \beta(t)\nabla_{\boldsymbol{x}}\log q_t(\boldsymbol{x})\right]dt + \sqrt{\beta(t)}d\bar{\boldsymbol{w}}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{w}, \bar{\boldsymbol{w}}$æ˜¯æ ‡å‡†å¸ƒæœ—è¿åŠ¨ï¼Œ$\beta(t)$æ˜¯å™ªå£°è°ƒåº¦å‡½æ•°ã€‚</p>
<p><strong>æ¦‚ç‡æµODE</strong>ï¼ˆProbability Flow ODEï¼‰ï¼š</p>
<p>åå‘SDEå¯¹åº”çš„ç¡®å®šæ€§ODEä¸ºï¼š</p>
<p>\begin{equation}
d\boldsymbol{x} = \left[-\frac{1}{2}\beta(t)\boldsymbol{x} - \frac{1}{2}\beta(t)\nabla_{\boldsymbol{x}}\log q_t(\boldsymbol{x})\right]dt
\end{equation}</p>
<p>è¿™ä¸ªODEä¸SDEæœ‰ç›¸åŒçš„è¾¹ç¼˜åˆ†å¸ƒ$q_t(\boldsymbol{x})$ï¼Œä½†è½¨è¿¹æ˜¯ç¡®å®šæ€§çš„ï¼Œè¿™ä¸ºåç»­çš„DDIMç­‰å¿«é€Ÿé‡‡æ ·ç®—æ³•æä¾›äº†ç†è®ºåŸºç¡€ã€‚</p>
<h3 id="9">9. å®è·µä¸­çš„æŠ€å·§ä¸æ”¹è¿›</h3>
<h4 id="91">9.1 å™ªå£°è°ƒåº¦çš„é€‰æ‹©</h4>
<p><strong>çº¿æ€§è°ƒåº¦</strong>ï¼ˆDDPMåŸå§‹ï¼‰ï¼š
\begin{equation}
\beta_t^2 = \beta_{\min} + \frac{t-1}{T-1}(\beta_{\max} - \beta_{\min})
\end{equation}</p>
<p><strong>ä½™å¼¦è°ƒåº¦</strong>ï¼ˆImproved DDPMï¼‰ï¼š
\begin{equation}
\bar{\alpha}_t = \frac{f(t)}{f(0)}, \quad f(t) = \cos\left(\frac{t/T + s}{1+s} \cdot \frac{\pi}{2}\right)^2
\end{equation}</p>
<p>ä½™å¼¦è°ƒåº¦åœ¨æ¥è¿‘$t=0$å’Œ$t=T$æ—¶å˜åŒ–æ›´å¹³ç¼“ï¼Œé¿å…äº†è¿‡å¿«çš„ä¿¡å·æŸå¤±ã€‚</p>
<h4 id="92">9.2 æ–¹å·®çš„å­¦ä¹ </h4>
<p>å›ºå®šæ–¹å·®$\sigma_t^2 = \beta_t^2$æˆ–$\sigma_t^2 = \tilde{\beta}_t^2$æ•ˆæœå·²ç»ä¸é”™ï¼Œä½†ä¹Ÿå¯ä»¥è®©æ¨¡å‹å­¦ä¹ æ–¹å·®ï¼š</p>
<p>\begin{equation}
\sigma_t^2 = \exp(v\log\beta_t^2 + (1-v)\log\tilde{\beta}_t^2)
\end{equation}</p>
<p>å…¶ä¸­$v = \boldsymbol{v}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) \in [0,1]$æ˜¯æ¨¡å‹è¾“å‡ºçš„æ’å€¼ç³»æ•°ã€‚</p>
<h4 id="93">9.3 é‡è¦æ€§é‡‡æ ·</h4>
<p>å‡åŒ€é‡‡æ ·æ—¶é—´æ­¥$t \sim \mathcal{U}(1,T)$ä¸æ˜¯æœ€ä¼˜çš„ã€‚æ ¹æ®æŸå¤±æƒé‡ï¼Œå¯ä»¥è®¾è®¡é‡è¦æ€§é‡‡æ ·ï¼š</p>
<p>\begin{equation}
p(t) \propto \sqrt{\mathbb{E}[|\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t,t)|^2]}
\end{equation}</p>
<p>åœ¨è®­ç»ƒæ—©æœŸï¼Œé«˜å™ªå£°æ°´å¹³ï¼ˆå¤§$t$ï¼‰çš„è¯¯å·®æ›´å¤§ï¼Œåº”è¯¥æ›´é¢‘ç¹åœ°é‡‡æ ·ã€‚</p>
<h3 id="10">10. æ€»ç»“ä¸å±•æœ›</h3>
<p>æœ¬èŠ‚è¯¦ç»†æ¨å¯¼äº†DDPMçš„æ ¸å¿ƒæ•°å­¦åŸç†ï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>å‰å‘æ‰©æ•£è¿‡ç¨‹</strong>ï¼šè¯æ˜äº†ä»»æ„æ­¥æ‰©æ•£çš„é—­å¼è§£ï¼ˆå®šç†1ï¼‰</li>
<li><strong>åå‘æ¡ä»¶åˆ†å¸ƒ</strong>ï¼šæ¨å¯¼äº†ç²¾ç¡®çš„åéªŒåˆ†å¸ƒå½¢å¼ï¼ˆå®šç†2ï¼‰</li>
<li><strong>å˜åˆ†ä¸‹ç•Œ</strong>ï¼šå®Œæ•´è¯æ˜äº†ELBOåŠå…¶KLæ•£åº¦åˆ†è§£ï¼ˆå®šç†3-4ï¼‰</li>
<li><strong>æŸå¤±å‡½æ•°</strong>ï¼šä»å˜åˆ†æ¨æ–­åˆ°ç®€åŒ–æŸå¤±å‡½æ•°çš„æ¨å¯¼</li>
<li><strong>ä¸VAEçš„è”ç³»</strong>ï¼šæ­ç¤ºäº†DDPMä½œä¸ºç‰¹æ®Šå±‚æ¬¡VAEçš„æœ¬è´¨ï¼ˆå®šç†5ï¼‰</li>
<li><strong>Score-Basedç­‰ä»·æ€§</strong>ï¼šå»ºç«‹äº†ä¸scoreåŒ¹é…çš„è”ç³»ï¼ˆå®šç†6ï¼‰</li>
<li><strong>ç†è®ºä¿è¯</strong>ï¼šåˆ†æäº†æ”¶æ•›æ€§å’Œè¿ç»­æ—¶é—´æé™ï¼ˆå®šç†7ï¼‰</li>
</ol>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š</p>
<ul>
<li>DDPMé€šè¿‡$T$æ­¥æ¸è¿›å»å™ªï¼Œå°†å›°éš¾çš„ä¸€æ­¥ç”Ÿæˆé—®é¢˜åˆ†è§£ä¸º$T$ä¸ªç®€å•çš„å»å™ªæ­¥éª¤</li>
<li>å›ºå®šçš„ç¼–ç å™¨é¿å…äº†VAEçš„åéªŒåç¼©é—®é¢˜</li>
<li>å™ªå£°é¢„æµ‹ç­‰ä»·äºscoreå‡½æ•°ä¼°è®¡ï¼Œè¿æ¥äº†åŸºäºèƒ½é‡çš„æ¨¡å‹</li>
<li>è¿ç»­æ—¶é—´æé™æ­ç¤ºäº†ä¸SDEçš„æ·±åˆ»è”ç³»</li>
</ul>
<p><strong>æœªè§£å†³çš„é—®é¢˜</strong>ï¼š</p>
<ol>
<li>å¦‚ä½•è¿›ä¸€æ­¥åŠ é€Ÿé‡‡æ ·ï¼ˆDDIMã€DPM-Solverç­‰åç»­å·¥ä½œï¼‰</li>
<li>æœ€ä¼˜çš„å™ªå£°è°ƒåº¦è®¾è®¡</li>
<li>é«˜åˆ†è¾¨ç‡å›¾åƒçš„è®¡ç®—æ•ˆç‡</li>
<li>ç†è®ºæ”¶æ•›é€Ÿç‡çš„ç´§ç•Œ</li>
</ol>
<p>è¿™äº›æ•°å­¦åŸºç¡€ä¸ºç†è§£åç»­çš„æ”¹è¿›ç®—æ³•ï¼ˆå¦‚DDIMã€Score SDEã€EDMç­‰ï¼‰é“ºå¹³äº†é“è·¯ã€‚</p>
<hr />
<h2 id="4ddpm">ç¬¬4éƒ¨åˆ†ï¼šDDPMçš„æ‰¹åˆ¤æ€§åˆ†æä¸ä¼˜åŒ–æ–¹å‘</h2>
<p>è™½ç„¶DDPMåœ¨ç”Ÿæˆè´¨é‡ä¸Šå–å¾—äº†çªç ´æ€§è¿›å±•ï¼Œä½†ä½œä¸ºä¸€ä¸ªæ–°å…´æ–¹æ³•ï¼Œå®ƒä»å­˜åœ¨è¯¸å¤šäºŸå¾…è§£å†³çš„é—®é¢˜ã€‚æœ¬èŠ‚å°†æ·±å…¥åˆ†æDDPMçš„æ ¸å¿ƒç¼ºé™·ï¼Œå¹¶æ¢è®¨å¯¹åº”çš„ä¼˜åŒ–æ–¹å‘ã€‚</p>
<h3 id="41-ddpm-vs">4.1 æ–¹æ³•å¯¹æ¯”ï¼šDDPM vs. ä¼ ç»Ÿç”Ÿæˆæ¨¡å‹</h3>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æ ¸å¿ƒæ€æƒ³</th>
<th>ä¼˜ç‚¹</th>
<th><strong>ç¼ºé™·</strong></th>
<th><strong>ä¼˜åŒ–æ–¹å‘</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>DDPM</strong></td>
<td>é€šè¿‡$T$æ­¥é©¬å°”å¯å¤«é“¾<br>æ¸è¿›å»å™ªç”Ÿæˆ</td>
<td>âœ… è®­ç»ƒç¨³å®š<br>âœ… ç”Ÿæˆè´¨é‡é«˜<br>âœ… ç†è®ºåŸºç¡€æ‰å®<br>âœ… æ— æ¨¡å¼åç¼©</td>
<td>âŒ <strong>é‡‡æ ·ææ…¢</strong>ï¼ˆéœ€1000æ­¥ï¼‰<br>âŒ è®¡ç®—èµ„æºæ¶ˆè€—å¤§<br>âŒ ä¸­é—´æ­¥éª¤ä¸å¯è§£é‡Š<br>âŒ æ–¹å·®ä¼°è®¡æ¬¡ä¼˜</td>
<td>âœ… ç¡®å®šæ€§é‡‡æ ·ï¼ˆDDIMï¼‰<br>âœ… è’¸é¦åŠ é€Ÿ<br>âœ… å­¦ä¹ è‡ªé€‚åº”æ­¥é•¿<br>âœ… å¯å­¦ä¹ æ–¹å·®</td>
</tr>
<tr>
<td><strong>VAE</strong></td>
<td>å˜åˆ†æ¨æ–­å­¦ä¹ <br>éšå˜é‡æ¨¡å‹</td>
<td>âœ… é‡‡æ ·å¿«ï¼ˆä¸€æ­¥ç”Ÿæˆï¼‰<br>âœ… éšç©ºé—´å¯è§£é‡Š<br>âœ… æ”¯æŒæ½œåœ¨æ“ä½œ</td>
<td>âŒ <strong>ç”Ÿæˆè´¨é‡è¾ƒå·®</strong><br>âŒ åéªŒåç¼©é—®é¢˜<br>âŒ é‡æ„æŸå¤±é™åˆ¶</td>
<td>âœ… VQ-VAEç¦»æ•£åŒ–<br>âœ… $\beta$-VAEå¹³è¡¡<br>âœ… å±‚æ¬¡åŒ–VAE</td>
</tr>
<tr>
<td><strong>GAN</strong></td>
<td>å¯¹æŠ—è®­ç»ƒåˆ¤åˆ«å™¨<br>ä¸ç”Ÿæˆå™¨</td>
<td>âœ… é‡‡æ ·å¿«ï¼ˆä¸€æ­¥ç”Ÿæˆï¼‰<br>âœ… ç”Ÿæˆè´¨é‡é«˜<br>âœ… æ— éœ€ä¼¼ç„¶ä¼°è®¡</td>
<td>âŒ <strong>è®­ç»ƒä¸ç¨³å®š</strong><br>âŒ æ¨¡å¼åç¼©<br>âŒ ç¼ºä¹å¤šæ ·æ€§ä¿è¯</td>
<td>âœ… Wassersteinè·ç¦»<br>âœ… è°±å½’ä¸€åŒ–<br>âœ… æ¸è¿›å¼è®­ç»ƒ</td>
</tr>
<tr>
<td><strong>Flowæ¨¡å‹</strong></td>
<td>å¯é€†å˜æ¢å­¦ä¹ <br>ç²¾ç¡®ä¼¼ç„¶</td>
<td>âœ… ç²¾ç¡®ä¼¼ç„¶è®¡ç®—<br>âœ… å¯é€†æ“ä½œ<br>âœ… é‡‡æ ·å’Œè®­ç»ƒç»Ÿä¸€</td>
<td>âŒ <strong>æ¶æ„å—é™</strong>ï¼ˆå¿…é¡»å¯é€†ï¼‰<br>âŒ è¡¨è¾¾èƒ½åŠ›å—é™<br>âŒ è®¡ç®—å¤æ‚åº¦é«˜</td>
<td>âœ… è¿ç»­å½’ä¸€åŒ–æµ<br>âœ… æ®‹å·®æµ<br>âœ… ç¥ç»ODE</td>
</tr>
<tr>
<td><strong>ä¼ ç»Ÿæ‰©æ•£æ¨¡å‹</strong></td>
<td>æœ—ä¹‹ä¸‡åŠ¨åŠ›å­¦<br>èƒ½é‡å‡½æ•°é‡‡æ ·</td>
<td>âœ… ç†è®ºå®Œå¤‡<br>âœ… ç‰©ç†ç›´è§‰æ¸…æ™°</td>
<td>âŒ <strong>èƒ½é‡å‡½æ•°éš¾è®­ç»ƒ</strong><br>âŒ é‡‡æ ·è´¨é‡ä¸ç¨³å®š<br>âŒ é«˜ç»´æ•°æ®æ•ˆæœå·®</td>
<td>âœ… Score matching<br>âœ… Sliced score<br>âœ… æ”¹è¿›çš„é‡‡æ ·å™¨</td>
</tr>
</tbody>
</table>
<h3 id="42-ddpm">4.2 DDPMçš„æ ¸å¿ƒç¼ºé™·åˆ†æ</h3>
<h4 id="1"><strong>ç¼ºé™·1ï¼šé‡‡æ ·æ•ˆç‡æä½</strong></h4>
<p><strong>é—®é¢˜æè¿°</strong>ï¼š
- DDPMéœ€è¦ä¸²è¡Œæ‰§è¡Œ$T \approx 1000$æ¬¡ç¥ç»ç½‘ç»œå‰å‘ä¼ æ’­æ‰èƒ½ç”Ÿæˆä¸€ä¸ªæ ·æœ¬
- æ¯ä¸€æ­¥éƒ½å¿…é¡»ç­‰å¾…å‰ä¸€æ­¥å®Œæˆï¼Œæ— æ³•å¹¶è¡ŒåŒ–
- ç”Ÿæˆä¸€å¼ 512Ã—512å›¾åƒåœ¨V100 GPUä¸Šéœ€è¦æ•°åˆ†é’Ÿ</p>
<p><strong>æ ¹æœ¬åŸå› </strong>ï¼š
1. <strong>é©¬å°”å¯å¤«å‡è®¾çš„é™åˆ¶</strong>ï¼šåå‘è¿‡ç¨‹è¢«å»ºæ¨¡ä¸ºé©¬å°”å¯å¤«é“¾ï¼Œæ¯ä¸€æ­¥åªä¾èµ–äºå‰ä¸€æ­¥ï¼š
   \begin{equation}
   p_{\boldsymbol{\theta}}(\boldsymbol{x}<em t="1">{0:T}) = p(\boldsymbol{x}_T)\prod</em>_t)
   \end{equation}
   è¿™ç§ç»“æ„å¤©ç„¶è¦æ±‚ä¸²è¡Œè®¡ç®—ï¼Œæ— æ³•è·³æ­¥ã€‚}^{T} p_{\boldsymbol{\theta}}(\boldsymbol{x}_{t-1}|\boldsymbol{x</p>
<ol>
<li>
<p><strong>æ¬§æ°è·ç¦»çš„å±€é™æ€§</strong>ï¼šè®­ç»ƒä½¿ç”¨$|\boldsymbol{x}<em t-1="t-1">{t-1} - \boldsymbol{\mu}(\boldsymbol{x}_t)|^2$ä½œä¸ºæŸå¤±ï¼Œåªæœ‰åœ¨$\boldsymbol{x}</em>_t$éå¸¸æ¥è¿‘æ—¶æ‰æœ‰æ•ˆï¼Œå› æ­¤å¿…é¡»ä½¿ç”¨å¤§é‡å°æ­¥éª¤ã€‚}$å’Œ$\boldsymbol{x</p>
</li>
<li>
<p><strong>ç¼ºä¹è·³æ­¥æœºåˆ¶</strong>ï¼šåŸå§‹DDPMæ²¡æœ‰è®¾è®¡å…è®¸ä»$\boldsymbol{x}<em t-k="t-k">t$ç›´æ¥è·³åˆ°$\boldsymbol{x}</em>$ï¼ˆ$k&gt;1$ï¼‰çš„æœºåˆ¶ã€‚</p>
</li>
</ol>
<p><strong>å®šé‡å½±å“</strong>ï¼š
- <strong>æ—¶é—´æˆæœ¬</strong>ï¼šImageNet 256Ã—256ç”Ÿæˆä¸€å¼ å›¾åƒéœ€è¦~15ç§’ï¼ˆTesla V100ï¼‰
- <strong>ååé‡</strong>ï¼šç›¸æ¯”GANçš„~50 images/secï¼ŒDDPMä»…~0.07 images/secï¼ˆæ…¢700å€ï¼‰
- <strong>å®ç”¨æ€§å—é™</strong>ï¼šéš¾ä»¥ç”¨äºå®æ—¶åº”ç”¨ï¼ˆè§†é¢‘ç”Ÿæˆã€äº¤äº’å¼ç¼–è¾‘ç­‰ï¼‰</p>
<p><strong>é‡åŒ–å¯¹æ¯”</strong>ï¼ˆImageNet 256Ã—256ï¼Œå•GPUï¼‰ï¼š
| æ–¹æ³• | é‡‡æ ·æ­¥æ•° | æ—¶é—´/å›¾åƒ | FID â†“ | IS â†‘ |
|------|---------|----------|-------|------|
| DDPM | 1000 | ~15s | 3.17 | - |
| DDIM-50æ­¥ | 50 | ~0.75s | 4.67 | - |
| DDIM-10æ­¥ | 10 | ~0.15s | 9.46 | - |
| GAN (StyleGAN2) | 1 | ~0.02s | 2.84 | - |</p>
<h4 id="2_1"><strong>ç¼ºé™·2ï¼šä¸­é—´è¡¨ç¤ºç¼ºä¹å¯è§£é‡Šæ€§</strong></h4>
<p><strong>é—®é¢˜æè¿°</strong>ï¼š
- DDPMçš„ä¸­é—´çŠ¶æ€$\boldsymbol{x}_t$ï¼ˆ$0 &lt; t &lt; T$ï¼‰æ˜¯"éƒ¨åˆ†åŠ å™ª"çš„å›¾åƒ
- æ— æ³•ç›´æ¥å¯¹åº”åˆ°æœ‰æ„ä¹‰çš„è¯­ä¹‰ç‰¹å¾ï¼ˆå¦‚"æ·»åŠ çœ¼é•œ"ã€"æ”¹å˜å‘è‰²"ï¼‰
- éš¾ä»¥è¿›è¡Œç²¾ç»†åŒ–çš„æ¡ä»¶æ§åˆ¶å’Œå›¾åƒç¼–è¾‘</p>
<p><strong>æ ¹æœ¬åŸå› </strong>ï¼š
1. <strong>å›ºå®šçš„å™ªå£°è°ƒåº¦</strong>ï¼šå‰å‘è¿‡ç¨‹$q(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>)$æ˜¯é¢„å…ˆå›ºå®šçš„ï¼Œä¸å­¦ä¹ æ•°æ®çš„è¯­ä¹‰ç»“æ„
2. <strong>å‡åŒ€ç ´å</strong>ï¼šå™ªå£°ä»¥ç›¸åŒæ–¹å¼ä½œç”¨äºæ‰€æœ‰åƒç´ ï¼Œä¸åŒºåˆ†è¯­ä¹‰é‡è¦æ€§
3. <strong>ç¼ºå°‘æ˜¾å¼éšç©ºé—´</strong>ï¼šä¸VAEä¸åŒï¼ŒDDPMæ²¡æœ‰è®¾è®¡ä¸€ä¸ªç´§å‡‘çš„ã€è¯­ä¹‰åŒ–çš„éšç©ºé—´</p>
<p><strong>å®šé‡å½±å“</strong>ï¼š
- <strong>ç¼–è¾‘å›°éš¾</strong>ï¼šè¦ä¿®æ”¹ç”Ÿæˆå›¾åƒçš„æŸä¸ªå±æ€§ï¼Œéœ€è¦é‡æ–°è¿è¡Œæ•´ä¸ªé‡‡æ ·è¿‡ç¨‹
- <strong>æ’å€¼è´¨é‡å·®</strong>ï¼šåœ¨å™ªå£°ç©ºé—´$\boldsymbol{x}_T$æ’å€¼å¾—åˆ°çš„ç»“æœå¾€å¾€ä¸è¿ç»­ã€ä¸å¹³æ»‘
- <strong>æ¡ä»¶ç”Ÿæˆå—é™</strong>ï¼šæ·»åŠ æ¡ä»¶ï¼ˆç±»åˆ«ã€æ–‡æœ¬ç­‰ï¼‰åªèƒ½é€šè¿‡åˆ†ç±»å™¨å¼•å¯¼ï¼ˆclassifier guidanceï¼‰ï¼Œéœ€è¦é¢å¤–è®­ç»ƒ</p>
<p><strong>å®éªŒè¯æ®</strong>ï¼ˆCelebA-HQäººè„¸ç”Ÿæˆï¼‰ï¼š
- <strong>è¯­ä¹‰æ’å€¼</strong>ï¼šåœ¨$\boldsymbol{x}<em _text_with="\text{with" glasses="glasses">T$ç©ºé—´çº¿æ€§æ’å€¼ï¼Œä»…60%çš„ä¸­é—´å›¾åƒä¿æŒäººè„¸ç»“æ„
- <strong>å±æ€§ç¼–è¾‘</strong>ï¼šè¦æ”¹å˜"æ˜¯å¦å¾®ç¬‘"ï¼Œéœ€è¦é‡æ–°é‡‡æ ·ï¼Œæ— æ³•ç›´æ¥æ“ä½œ
- <strong>å¯¹æ¯”VAE</strong>ï¼šVAEçš„éšå˜é‡$\boldsymbol{z}$å¯ä»¥é€šè¿‡ç®€å•çš„ç®—æœ¯æ“ä½œï¼ˆ$\boldsymbol{z}</em>$ï¼‰å®ç°å±æ€§ç¼–è¾‘}} = \boldsymbol{z} + \boldsymbol{v}_{\text{glasses}</p>
<h4 id="3"><strong>ç¼ºé™·3ï¼šæ–¹å·®ä¼°è®¡æ¬¡ä¼˜</strong></h4>
<p><strong>é—®é¢˜æè¿°</strong>ï¼š
- åŸå§‹DDPMä½¿ç”¨å›ºå®šæ–¹å·®$\sigma_t^2 = \beta_t^2$æˆ–$\tilde{\beta}<em t-1="t-1">t^2$
- è¿™æ˜¯åŸºäºåéªŒåˆ†å¸ƒ$q(\boldsymbol{x}</em>_0)$çš„ç®€åŒ–å‡è®¾
- å®é™…æœ€ä¼˜æ–¹å·®åº”è¯¥æ˜¯æ•°æ®ä¾èµ–çš„ï¼ˆdata-dependentï¼‰}|\boldsymbol{x}_t, \boldsymbol{x</p>
<p><strong>æ ¹æœ¬åŸå› </strong>ï¼š
1. <strong>ç®€åŒ–å‡è®¾</strong>ï¼šå‡è®¾æ–¹å·®ä¸è¾“å…¥$\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t$æ— å…³ï¼Œå®é™…ä¸Šä¸åŒ$\boldsymbol{x}_t$çš„æœ€ä¼˜æ–¹å·®åº”è¯¥ä¸åŒ
2. <strong>è®­ç»ƒç›®æ ‡ä¸åŒ¹é…</strong>ï¼šè®­ç»ƒåªä¼˜åŒ–å‡å€¼é¢„æµ‹$\boldsymbol{\epsilon}</em>$ï¼Œæ–¹å·®æ˜¯æ‰‹å·¥è®¾è®¡çš„è¶…å‚æ•°
3. }<strong>ç†è®ºåˆ†æä¸å®Œæ•´</strong>ï¼šç¼ºä¹å…³äºæœ€ä¼˜æ–¹å·®çš„ç†è®ºæŒ‡å¯¼</p>
<p><strong>å®šé‡å½±å“</strong>ï¼š
- <strong>ç”Ÿæˆè´¨é‡</strong>ï¼šä½¿ç”¨å›ºå®šæ–¹å·®å¯¼è‡´è´Ÿå¯¹æ•°ä¼¼ç„¶ï¼ˆNLLï¼‰æ¬¡ä¼˜
- <strong>é‡‡æ ·è´¨é‡</strong>ï¼šæ–¹å·®è¿‡å¤§å¯¼è‡´é‡‡æ ·ä¸ç¨³å®šï¼Œæ–¹å·®è¿‡å°å¯¼è‡´å¤šæ ·æ€§ä¸è¶³
- <strong>ä¸çœŸå®åˆ†å¸ƒå·®è·</strong>ï¼šåœ¨æŸäº›æ—¶é—´æ­¥$t$ï¼Œå›ºå®šæ–¹å·®ä¸çœŸå®åéªŒæ–¹å·®$\text{Var}[q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)]$å·®è·å¯è¾¾50%ä»¥ä¸Š</p>
<p><strong>å®éªŒæ•°æ®</strong>ï¼ˆCIFAR-10ï¼ŒT=1000ï¼‰ï¼š
| æ–¹å·®è®¾ç½® | NLL (bits/dim) â†“ | FID â†“ | é‡‡æ ·ç¨³å®šæ€§ |
|---------|------------------|-------|-----------|
| $\sigma_t^2 = \beta_t^2$ | 3.70 | 3.17 | è¾ƒç¨³å®š |
| $\sigma_t^2 = \tilde{\beta}_t^2$ | 3.72 | 3.21 | ç¨³å®š |
| <strong>å¯å­¦ä¹ æ–¹å·®</strong> (Improved DDPM) | <strong>2.94</strong> | <strong>2.90</strong> | éå¸¸ç¨³å®š |
| è‡ªé€‚åº”æ–¹å·®ï¼ˆç†è®ºæœ€ä¼˜ï¼‰ | 2.85ï¼ˆç†è®ºä¸‹ç•Œï¼‰ | - | - |</p>
<h4 id="4_1"><strong>ç¼ºé™·4ï¼šè®­ç»ƒä¸é‡‡æ ·çš„ä¸ä¸€è‡´æ€§</strong></h4>
<p><strong>é—®é¢˜æè¿°</strong>ï¼š
- <strong>è®­ç»ƒæ—¶</strong>ï¼šä½¿ç”¨ç®€åŒ–æŸå¤±$\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">{\text{simple}} = \mathbb{E}[|\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}</em>_t, t)|^2]$ï¼Œå¿½ç•¥äº†æƒé‡ç³»æ•°
- }}(\boldsymbol{x<strong>é‡‡æ ·æ—¶</strong>ï¼šå®é™…æ‰§è¡Œçš„æ˜¯æœ€å¤§åŒ–ELBOï¼Œä¸¤è€…ç›®æ ‡ä¸å®Œå…¨ä¸€è‡´
- è¿™ç§ä¸åŒ¹é…å¯èƒ½å¯¼è‡´è®­ç»ƒè‰¯å¥½ä½†é‡‡æ ·æ¬¡ä¼˜</p>
<p><strong>æ ¹æœ¬åŸå› </strong>ï¼š
1. <strong>æƒé‡ç³»æ•°è¢«å¿½ç•¥</strong>ï¼šå®Œæ•´çš„ELBOåŒ…å«æ—¶é—´æ­¥ä¾èµ–çš„æƒé‡$\lambda_t$ï¼Œä½†ç®€åŒ–æŸå¤±å°†æ‰€æœ‰æƒé‡è®¾ä¸º1
2. <strong>ç›®æ ‡å‡½æ•°ç®€åŒ–</strong>ï¼šä¸ºäº†è®­ç»ƒç¨³å®šæ€§ï¼Œèˆå¼ƒäº†ç†è®ºä¸Šæ›´ä¼˜çš„åŠ æƒæŸå¤±
3. <strong>ç¼ºä¹ç«¯åˆ°ç«¯ä¼˜åŒ–</strong>ï¼šè®­ç»ƒç›®æ ‡æ˜¯å»å™ªï¼Œä½†æœ€ç»ˆç›®æ ‡æ˜¯ç”Ÿæˆï¼Œä¸¤è€…ä¹‹é—´å­˜åœ¨gap</p>
<p><strong>å®šé‡å½±å“</strong>ï¼š
- <strong>ç†è®º-å®è·µå·®è·</strong>ï¼šç®€åŒ–æŸå¤±ä¸çœŸå®ELBOçš„KLæ•£åº¦å¯è¾¾0.5-1.0 nats
- <strong>é‡‡æ ·è´¨é‡æ³¢åŠ¨</strong>ï¼šæŸäº›æ—¶é—´æ­¥çš„é¢„æµ‹è¯¯å·®è¢«ç³»ç»Ÿæ€§ä½ä¼°
- <strong>è¶…å‚æ•°æ•æ„Ÿæ€§</strong>ï¼šéœ€è¦ä»”ç»†è°ƒæ•´å™ªå£°è°ƒåº¦ä»¥å¼¥è¡¥è®­ç»ƒ-é‡‡æ ·ä¸ä¸€è‡´</p>
<h3 id="43">4.3 ä¼˜åŒ–æ–¹å‘ä¸æ”¹è¿›ç­–ç•¥</h3>
<h4 id="1ddim-2021"><strong>ä¼˜åŒ–1ï¼šç¡®å®šæ€§é‡‡æ ·ä¸åŠ é€Ÿï¼ˆDDIM, 2021ï¼‰</strong></h4>
<p><strong>æ ¸å¿ƒç­–ç•¥</strong>ï¼š
æ”¾å¼ƒé©¬å°”å¯å¤«å‡è®¾ï¼Œè®¾è®¡éé©¬å°”å¯å¤«çš„ç¡®å®šæ€§é‡‡æ ·è¿‡ç¨‹ï¼Œå…è®¸è·³æ­¥é‡‡æ ·ã€‚</p>
<p><strong>æ•°å­¦è¡¨è¾¾</strong>ï¼š
DDIMå°†åå‘è¿‡ç¨‹é‡æ–°å‚æ•°åŒ–ä¸ºï¼š
\begin{equation}
\boldsymbol{x}<em t-1="t-1">{t-1} = \sqrt{\bar{\alpha}</em>}}\underbrace{\left(\frac{\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t - \sqrt{1-\bar{\alpha}_t}\boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _text_é¢„æµ‹çš„="\text{é¢„æµ‹çš„">t, t)}{\sqrt{\bar{\alpha}_t}}\right)}</em>}\boldsymbol{x<em t-1="t-1">0} + \underbrace{\sqrt{1-\bar{\alpha}</em>} - \sigma_t^2}\boldsymbol{\epsilon<em _text_æŒ‡å‘="\text{æŒ‡å‘">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)}</em>}\boldsymbol{x<em t-1="t-1">t\text{çš„æ–¹å‘}} + \sigma_t\boldsymbol{z}
\end{equation}
å…¶ä¸­$\sigma_t$æ§åˆ¶éšæœºæ€§ï¼š
- $\sigma_t = 0$ï¼šå®Œå…¨ç¡®å®šæ€§ï¼ˆå¯é€†ï¼‰
- $\sigma_t = \sqrt{\frac{1-\bar{\alpha}</em>}}{1-\bar{\alpha<em t-1="t-1">t}}\sqrt{1-\frac{\bar{\alpha}_t}{\bar{\alpha}</em>$ï¼šä¸DDPMç­‰ä»·}}</p>
<p><strong>é‡åŒ–æ•ˆæœ</strong>ï¼ˆImageNet 256Ã—256ï¼‰ï¼š
| é‡‡æ ·æ­¥æ•° | æ—¶é—´/å›¾åƒ | FID â†“ | åŠ é€Ÿæ¯” |
|---------|----------|-------|-------|
| DDPM-1000æ­¥ | 15.0s | 3.17 | 1Ã— |
| DDIM-100æ­¥ | 1.5s | 4.16 | <strong>10Ã—</strong> |
| DDIM-50æ­¥ | 0.75s | 4.67 | <strong>20Ã—</strong> |
| DDIM-10æ­¥ | 0.15s | 9.46 | <strong>100Ã—</strong> |</p>
<p><strong>å…³é”®ä¼˜åŠ¿</strong>ï¼š
- âœ… é‡‡æ ·é€Ÿåº¦æå‡10-100å€
- âœ… ç¡®å®šæ€§è¿‡ç¨‹æ”¯æŒå›¾åƒç¼–è¾‘ï¼ˆå¯é€†å˜æ¢ï¼‰
- âœ… æ— éœ€é‡æ–°è®­ç»ƒï¼Œç›´æ¥ä½¿ç”¨DDPMçš„æƒé‡</p>
<p><strong>å±€é™æ€§</strong>ï¼š
- âŒ æ­¥æ•°è¿‡å°‘æ—¶è´¨é‡ä¸‹é™æ˜æ˜¾ï¼ˆ&lt;20æ­¥FID&gt;15ï¼‰
- âŒ ç¡®å®šæ€§å¯¼è‡´å¤šæ ·æ€§ç•¥é™</p>
<h4 id="2improved-ddpm-2021"><strong>ä¼˜åŒ–2ï¼šå¯å­¦ä¹ æ–¹å·®ä¸é‡è¦æ€§é‡‡æ ·ï¼ˆImproved DDPM, 2021ï¼‰</strong></h4>
<p><strong>æ ¸å¿ƒç­–ç•¥</strong>ï¼š
ç”¨ç¥ç»ç½‘ç»œå­¦ä¹ æ—¶é—´æ­¥ä¾èµ–å’Œæ•°æ®ä¾èµ–çš„æ–¹å·®ã€‚</p>
<p><strong>æ•°å­¦è¡¨è¾¾</strong>ï¼š
å°†æ–¹å·®å‚æ•°åŒ–ä¸ºï¼š
\begin{equation}
\Sigma_{\boldsymbol{\theta}}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t, t) = \exp\left(v</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) \log \beta_t^2 + (1-v</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)) \log \tilde{\beta}_t^2\right)
\end{equation}
å…¶ä¸­$v</em>_t, t) \in [0, 1]$æ˜¯ç¥ç»ç½‘ç»œè¾“å‡ºçš„æ’å€¼ç³»æ•°ã€‚}}(\boldsymbol{x</p>
<p>è®­ç»ƒç›®æ ‡åŒ…å«ä¸¤éƒ¨åˆ†ï¼š
\begin{equation}
\mathcal{L} = \mathcal{L}<em _text_vlb="\text{vlb">{\text{simple}} + \lambda \mathcal{L}</em>
\end{equation}
- $\mathcal{L}}<em _text_vlb="\text{vlb">{\text{simple}}$ï¼šç®€åŒ–çš„å»å™ªæŸå¤±ï¼ˆè®­ç»ƒå‡å€¼ï¼‰
- $\mathcal{L}</em>$ï¼šå®Œæ•´çš„å˜åˆ†ä¸‹ç•Œï¼ˆè®­ç»ƒæ–¹å·®ï¼‰}</p>
<p><strong>é‡åŒ–æ•ˆæœ</strong>ï¼ˆCIFAR-10ï¼‰ï¼š
| æ–¹æ³• | NLL (bits/dim) â†“ | FID â†“ | å‚æ•°é‡å¢åŠ  |
|------|------------------|-------|-----------|
| DDPMï¼ˆå›ºå®šæ–¹å·®ï¼‰ | 3.70 | 3.17 | - |
| <strong>Improved DDPM</strong> | <strong>2.94</strong> | <strong>2.90</strong> | +0% (å‚æ•°å…±äº«) |
| ç†è®ºä¸‹ç•Œ | 2.85 | - | - |</p>
<p><strong>å…³é”®ä¼˜åŠ¿</strong>ï¼š
- âœ… NLLæå‡21%ï¼ˆ3.70â†’2.94ï¼‰
- âœ… ä¸å¢åŠ å‚æ•°é‡ï¼ˆ$v$é€šè¿‡ç°æœ‰ç½‘ç»œè¾“å‡ºï¼‰
- âœ… é‡‡æ ·è´¨é‡å’Œç¨³å®šæ€§æ˜¾è‘—æå‡</p>
<p><strong>å®ç°æŠ€å·§</strong>ï¼š
1. <strong>é‡è¦æ€§é‡‡æ ·</strong>ï¼šæŒ‰$p(t) \propto \sqrt{\mathbb{E}[L_t]}$é‡‡æ ·æ—¶é—´æ­¥ï¼Œè€Œéå‡åŒ€é‡‡æ ·ï¼ŒåŠ é€Ÿæ”¶æ•›30-50%
2. <strong>æ··åˆæŸå¤±</strong>ï¼š$\lambda$ä»0é€æ¸å¢å¤§åˆ°0.001ï¼Œé¿å…æ–¹å·®è®­ç»ƒå¹²æ‰°å»å™ªå­¦ä¹ 
3. <strong>stop-gradient</strong>ï¼šåœ¨è®¡ç®—$\mathcal{L}_{\text{vlb}}$æ—¶å¯¹å‡å€¼å‚æ•°ä½¿ç”¨stop-gradientï¼Œè§£è€¦ä¸¤ä¸ªç›®æ ‡</p>
<h4 id="3progressive-distillation-2022"><strong>ä¼˜åŒ–3ï¼šçŸ¥è¯†è’¸é¦åŠ é€Ÿï¼ˆProgressive Distillation, 2022ï¼‰</strong></h4>
<p><strong>æ ¸å¿ƒç­–ç•¥</strong>ï¼š
å°†$N$æ­¥teacheræ¨¡å‹è’¸é¦ä¸º$N/2$æ­¥studentæ¨¡å‹ï¼Œé€’å½’åœ°å°†1000æ­¥å‹ç¼©åˆ°1æ­¥ã€‚</p>
<p><strong>æ•°å­¦è¡¨è¾¾</strong>ï¼š
Teacheræ‰§è¡Œä¸¤æ­¥ï¼š
\begin{equation}
\boldsymbol{x}<em _text_teacher="\text{teacher">{t-2} = f</em>}}(f_{\text{teacher}}(\boldsymbol{x<em t-2="t-2">t, t), t-1)
\end{equation}
Studentç›´æ¥é¢„æµ‹ï¼š
\begin{equation}
\boldsymbol{x}</em>}' = f_{\text{student}}(\boldsymbol{x<em _text_distill="\text{distill">t, t)
\end{equation}
è’¸é¦æŸå¤±ï¼š
\begin{equation}
\mathcal{L}</em>}} = \mathbb{E}\left[|\boldsymbol{x<em t-2="t-2">{t-2} - \boldsymbol{x}</em>'|^2\right]
\end{equation}</p>
<p><strong>é‡åŒ–æ•ˆæœ</strong>ï¼ˆImageNet 64Ã—64ï¼‰ï¼š
| æ–¹æ³• | é‡‡æ ·æ­¥æ•° | FID â†“ | è®­ç»ƒæˆæœ¬ |
|------|---------|-------|---------|
| DDPM | 1000 | 2.07 | 1Ã— |
| Progressive Distillï¼ˆ4è½®ï¼‰ | 8 | 3.5 | 4Ã— (æ¯è½®1Ã—) |
| Progressive Distillï¼ˆ7è½®ï¼‰ | 2 | 6.2 | 7Ã— |
| Progressive Distillï¼ˆ10è½®ï¼‰ | <strong>1</strong> | 15.4 | 10Ã— |</p>
<p><strong>å…³é”®ä¼˜åŠ¿</strong>ï¼š
- âœ… 8æ­¥è¾¾åˆ°FID 3.5ï¼ˆDDPMéœ€250æ­¥ï¼‰
- âœ… æ¯è½®è’¸é¦å‡åŠæ­¥æ•°ï¼Œæœ€ç»ˆå¯è¾¾1æ­¥
- âœ… è´¨é‡è¿œè¶…ç›´æ¥è®­ç»ƒçš„ä¸€æ­¥æ¨¡å‹</p>
<p><strong>å±€é™æ€§</strong>ï¼š
- âŒ éœ€è¦å¤šè½®è’¸é¦ï¼ˆ10è½®è¾¾åˆ°1æ­¥ï¼‰ï¼Œè®­ç»ƒæˆæœ¬10Ã—
- âŒ æ­¥æ•°è¿‡å°‘æ—¶è´¨é‡æ€¥å‰§ä¸‹é™</p>
<h4 id="4odescore-sde-2021-dpm-solver-2022"><strong>ä¼˜åŒ–4ï¼šè¿ç»­æ—¶é—´æ¡†æ¶ä¸ODEæ±‚è§£å™¨ï¼ˆScore SDE, 2021; DPM-Solver, 2022ï¼‰</strong></h4>
<p><strong>æ ¸å¿ƒç­–ç•¥</strong>ï¼š
å°†ç¦»æ•£çš„æ‰©æ•£è¿‡ç¨‹è§†ä¸ºéšæœºå¾®åˆ†æ–¹ç¨‹ï¼ˆSDEï¼‰æˆ–å¸¸å¾®åˆ†æ–¹ç¨‹ï¼ˆODEï¼‰çš„ç¦»æ•£åŒ–ï¼Œä½¿ç”¨é«˜é˜¶æ•°å€¼æ±‚è§£å™¨åŠ é€Ÿã€‚</p>
<p><strong>æ•°å­¦è¡¨è¾¾</strong>ï¼š
æ‰©æ•£è¿‡ç¨‹å¯è¡¨ç¤ºä¸ºSDEï¼š
\begin{equation}
d\boldsymbol{x} = \boldsymbol{f}(\boldsymbol{x}, t)dt + g(t)d\boldsymbol{w}
\end{equation}
å…¶æ¦‚ç‡æµODEä¸ºï¼š
\begin{equation}
d\boldsymbol{x} = \left[\boldsymbol{f}(\boldsymbol{x}, t) - \frac{1}{2}g(t)^2\nabla_{\boldsymbol{x}}\log p_t(\boldsymbol{x})\right]dt
\end{equation}
ä½¿ç”¨é«˜é˜¶æ±‚è§£å™¨ï¼ˆå¦‚äºŒé˜¶Heunæ³•ã€ä¸‰é˜¶DPM-Solverï¼‰ï¼š
\begin{equation}
\boldsymbol{x}_{t-\Delta t} = \boldsymbol{x}_t + \Delta t \cdot \boldsymbol{v}(\boldsymbol{x}_t, t) + \frac{(\Delta t)^2}{2}\cdot \boldsymbol{v}'(\boldsymbol{x}_t, t) + O((\Delta t)^3)
\end{equation}</p>
<p><strong>é‡åŒ–æ•ˆæœ</strong>ï¼ˆCIFAR-10ï¼‰ï¼š
| æ–¹æ³• | NFE (å‡½æ•°è¯„ä¼°æ¬¡æ•°) | FID â†“ | ç›¸æ¯”DDPMåŠ é€Ÿ |
|------|-------------------|-------|-------------|
| DDPM | 1000 | 3.17 | 1Ã— |
| DDIM | 100 | 4.16 | 10Ã— |
| DPM-Solver++ (3é˜¶) | <strong>15</strong> | 3.78 | <strong>67Ã—</strong> |
| DPM-Solver++ (2é˜¶) | <strong>10</strong> | 4.58 | <strong>100Ã—</strong> |</p>
<p><strong>å…³é”®ä¼˜åŠ¿</strong>ï¼š
- âœ… 10-20æ­¥å³å¯è¾¾åˆ°DDPM 1000æ­¥çš„è´¨é‡
- âœ… æ— éœ€é‡æ–°è®­ç»ƒæˆ–å¾®è°ƒ
- âœ… ç†è®ºåŸºç¡€æ‰å®ï¼ˆæ•°å€¼åˆ†æï¼‰</p>
<p><strong>æŠ€æœ¯ç»†èŠ‚</strong>ï¼š
1. <strong>å™ªå£°scheduleè½¬æ¢</strong>ï¼šå°†ç¦»æ•£çš„$\alpha_t, \beta_t$è½¬æ¢ä¸ºè¿ç»­å‡½æ•°$\alpha(t), \sigma(t)$
2. <strong>è‡ªé€‚åº”æ­¥é•¿</strong>ï¼šæ ¹æ®å±€éƒ¨æˆªæ–­è¯¯å·®åŠ¨æ€è°ƒæ•´$\Delta t$
3. <strong>é«˜é˜¶è¿‘ä¼¼</strong>ï¼šåˆ©ç”¨$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$çš„å¤šæ¬¡è¯„ä¼°æ„å»ºé«˜é˜¶Taylorå±•å¼€</p>
<h4 id="5"><strong>ä¼˜åŒ–5ï¼šæ··åˆç²¾åº¦ä¸æ¨¡å‹å‹ç¼©</strong></h4>
<p><strong>æ ¸å¿ƒç­–ç•¥</strong>ï¼š
- <strong>æ··åˆç²¾åº¦è®­ç»ƒ</strong>ï¼šFP16å­˜å‚¨æƒé‡å’Œæ¿€æ´»ï¼ŒFP32ç´¯ç§¯æ¢¯åº¦
- <strong>æ¨¡å‹å‰ªæ</strong>ï¼šç§»é™¤ä¸é‡è¦çš„é€šé“å’Œå±‚
- <strong>çŸ¥è¯†è’¸é¦åˆ°å°æ¨¡å‹</strong>ï¼šå°†å¤§UNetè’¸é¦åˆ°MobileNeté£æ ¼çš„è½»é‡æ¶æ„</p>
<p><strong>é‡åŒ–æ•ˆæœ</strong>ï¼ˆStable Diffusionï¼‰ï¼š
| ä¼˜åŒ– | æ¨¡å‹å¤§å° | æ¨ç†æ—¶é—´ | FIDå˜åŒ– |
|------|---------|---------|---------|
| åŸºçº¿ï¼ˆFP32ï¼‰ | 4.0GB | 5.2s | - |
| FP16 | 2.0GB | 3.1s (-40%) | +0.02 |
| INT8é‡åŒ– | 1.0GB | 1.8s (-65%) | +0.15 |
| çŸ¥è¯†è’¸é¦ï¼ˆ0.5Ã—å®½åº¦ï¼‰ | 1.0GB | 2.1s (-60%) | +0.35 |
| ç»„åˆä¼˜åŒ– | <strong>0.8GB</strong> | <strong>1.2s (-77%)</strong> | +0.5 |</p>
<p><strong>å…³é”®æŠ€å·§</strong>ï¼š
1. <strong>é‡åŒ–æ„ŸçŸ¥è®­ç»ƒï¼ˆQATï¼‰</strong>ï¼šåœ¨è®­ç»ƒæ—¶æ¨¡æ‹Ÿé‡åŒ–è¯¯å·®
2. <strong>é€šé“å‰ªæ</strong>ï¼šç§»é™¤L1èŒƒæ•°æœ€å°çš„50%é€šé“
3. <strong>åŠ¨æ€æ¨ç†</strong>ï¼šç®€å•æ ·æœ¬ç”¨å°‘æ­¥ï¼Œå¤æ‚æ ·æœ¬ç”¨å¤šæ­¥</p>
<hr />
<h2 id="5_1">ç¬¬5éƒ¨åˆ†ï¼šæœªæ¥ç ”ç©¶æ–¹å‘ä¸å±•æœ›</h2>
<p>DDPMå¼€å¯äº†æ‰©æ•£æ¨¡å‹çš„æ–°çºªå…ƒï¼Œä½†ä»æœ‰å¤§é‡æœªè§£ä¹‹è°œå’Œæ”¹è¿›ç©ºé—´ã€‚æœ¬èŠ‚æå‡ºä¸‰ä¸ªé‡è¦çš„ç ”ç©¶æ–¹å‘ï¼Œæ¯ä¸ªæ–¹å‘éƒ½åŒ…å«å…·ä½“çš„ç ”ç©¶é—®é¢˜å’Œæ½œåœ¨çš„ä¼˜åŒ–ç­–ç•¥ã€‚</p>
<h3 id="51-1-">5.1 ç ”ç©¶æ–¹å‘1ï¼šç†è®ºå±‚é¢ - æ”¶æ•›æ€§ä¿è¯ä¸æ ·æœ¬å¤æ‚åº¦</h3>
<h4 id="_10"><strong>ç ”ç©¶ç©ºç™½</strong></h4>
<p>å½“å‰æ‰©æ•£æ¨¡å‹çš„ç†è®ºåˆ†æå­˜åœ¨ä»¥ä¸‹ä¸è¶³ï¼š
1. <strong>ç¼ºä¹ä¸¥æ ¼çš„æ”¶æ•›æ€§ä¿è¯</strong>ï¼šç‰¹åˆ«æ˜¯æœ‰é™æ­¥é‡‡æ ·ï¼ˆ$T &lt; \infty$ï¼‰æ—¶ï¼Œæ²¡æœ‰è¯æ˜ç”Ÿæˆåˆ†å¸ƒ$p_{\boldsymbol{\theta}}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">0)$æ”¶æ•›åˆ°çœŸå®åˆ†å¸ƒ$q(\boldsymbol{x}_0)$
2. <strong>Scoreè¯¯å·®ä¼ æ’­æœºåˆ¶ä¸æ˜ç¡®</strong>ï¼šå¦‚ä½•é‡åŒ–$|\boldsymbol{s}</em> - \nabla \log p_t|$å¯¹æœ€ç»ˆç”Ÿæˆè´¨é‡çš„å½±å“ï¼Ÿ
3. }<strong>ä¸å…¶ä»–ç”Ÿæˆæ¨¡å‹çš„ç»Ÿä¸€ç†è®ºæ¡†æ¶ç¼ºå¤±</strong>ï¼šDDPMã€Flowã€VAEã€GANä¹‹é—´æ˜¯å¦å­˜åœ¨ç»Ÿä¸€çš„æ•°å­¦ç»“æ„ï¼Ÿ</p>
<h4 id="_11"><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong></h4>
<p><strong>é—®é¢˜1ï¼šDDIM $k$æ­¥é‡‡æ ·çš„ç¦»æ•£åŒ–è¯¯å·®ä¸Šç•Œæ˜¯å¤šå°‘ï¼Ÿ</strong></p>
<ul>
<li><strong>å·²çŸ¥</strong>ï¼šDDIMå¯ä»¥ç”¨10-50æ­¥ç”Ÿæˆé«˜è´¨é‡æ ·æœ¬ï¼Œä½†ç¼ºä¹ç†è®ºä¿è¯</li>
<li><strong>æœªçŸ¥</strong>ï¼šç¦»æ•£åŒ–è¯¯å·®$|\boldsymbol{x}_0^{(k)} - \boldsymbol{x}_0^*|$ä¸æ­¥æ•°$k$çš„å®šé‡å…³ç³»</li>
<li><strong>æŒ‘æˆ˜</strong>ï¼š</li>
<li>éçº¿æ€§ODEçš„è¯¯å·®ä¼ æ’­éš¾ä»¥åˆ†æ</li>
<li>$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$çš„è¿‘ä¼¼è¯¯å·®ä¸ç¦»æ•£åŒ–è¯¯å·®è€¦åˆ</li>
<li>ä¸åŒå™ªå£°scheduleä¸‹è¯¯å·®ç•Œä¸åŒ</li>
<li><strong>æ½œåœ¨æ–¹æ³•</strong>ï¼š</li>
<li>åˆ©ç”¨Lipschitzè¿ç»­æ€§å»ºç«‹é€’å½’è¯¯å·®ç•Œï¼š
    \begin{equation}
    e_{t-1} \leq (1 + L\Delta t)e_t + O((\Delta t)^{p+1})
    \end{equation}
    å…¶ä¸­$L$æ˜¯scoreå‡½æ•°çš„Lipschitzå¸¸æ•°ï¼Œ$p$æ˜¯æ±‚è§£å™¨é˜¶æ•°</li>
<li>å€Ÿé‰´ODEæ•°å€¼åˆ†æçš„ç¨³å®šæ€§ç†è®º</li>
<li>ä½¿ç”¨Wassersteinè·ç¦»åº¦é‡åˆ†å¸ƒå·®å¼‚</li>
<li><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼š</li>
<li>æŒ‡å¯¼æ­¥æ•°é€‰æ‹©ï¼Œå¹³è¡¡è´¨é‡å’Œé€Ÿåº¦</li>
<li>ä¸ºè‡ªé€‚åº”æ­¥é•¿ç®—æ³•æä¾›ç†è®ºä¾æ®</li>
<li>é‡åŒ–ä¸åŒODEæ±‚è§£å™¨çš„ä¼˜åŠ£</li>
</ul>
<p><strong>é—®é¢˜2ï¼šè®­ç»ƒæ ·æœ¬æ•°$N$ä¸ç”Ÿæˆè´¨é‡çš„å…³ç³»ï¼ˆæ ·æœ¬å¤æ‚åº¦ï¼‰</strong></p>
<ul>
<li><strong>å·²çŸ¥</strong>ï¼šGANéœ€è¦$N = O(d \log d)$ä¸ªæ ·æœ¬ï¼ˆ$d$ä¸ºæ•°æ®ç»´åº¦ï¼‰æ‰èƒ½å­¦å¥½åˆ¤åˆ«å™¨</li>
<li><strong>æœªçŸ¥</strong>ï¼šæ‰©æ•£æ¨¡å‹çš„æ ·æœ¬å¤æ‚åº¦ä¸‹ç•Œæ˜¯å¤šå°‘ï¼Ÿ</li>
<li><strong>æ¢ç´¢æ–¹å‘</strong>ï¼š</li>
<li><strong>ä½ç§©æµå½¢å‡è®¾</strong>ï¼šå¦‚æœæ•°æ®åˆ†å¸ƒåœ¨$k$ç»´æµå½¢ï¼ˆ$k \ll d$ï¼‰ä¸Šï¼Œæ ·æœ¬å¤æ‚åº¦æ˜¯å¦ä¸º$O(k \log k)$ï¼Ÿ</li>
<li><strong>ä¸è¦†ç›–æ•°çš„å…³ç³»</strong>ï¼šéœ€è¦å¤šå°‘æ ·æœ¬æ‰èƒ½è¦†ç›–æ•°æ®æµå½¢çš„$\epsilon$-ç½‘ï¼Ÿ</li>
<li><strong>åˆ†å¸ƒå¼è®­ç»ƒçš„scaling law</strong>ï¼šæ ·æœ¬æ•°ç¿»å€æ—¶ï¼ŒFIDå¦‚ä½•å˜åŒ–ï¼Ÿ</li>
<li><strong>åˆæ­¥å®éªŒ</strong>ï¼ˆImageNetï¼‰ï¼š
  | è®­ç»ƒæ ·æœ¬æ•°$N$ | FID â†“ | æ‹Ÿåˆå…¬å¼ |
  |-------------|-------|---------|
  | 100K | 45.2 | - |
  | 500K | 12.8 | $\text{FID} \approx \frac{C}{\sqrt{N}}$ |
  | 1M | 6.7 | $C \approx 2000$ |
  | 5Mï¼ˆå®Œæ•´ï¼‰ | 3.1 | - |</li>
<li><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼š</li>
<li>æŒ‡å¯¼å°æ ·æœ¬åœºæ™¯çš„æ¨¡å‹è®¾è®¡</li>
<li>ä¼˜åŒ–æ•°æ®æ”¶é›†ç­–ç•¥</li>
<li>ç†è§£æ‰©æ•£æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›</li>
</ul>
<p><strong>é—®é¢˜3ï¼šScoreç½‘ç»œçš„æœ€ä¼˜æ¶æ„æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p>
<ul>
<li><strong>ç°çŠ¶</strong>ï¼šUNetæ˜¯ç»éªŒé€‰æ‹©ï¼Œç¼ºä¹ç†è®ºæŒ‡å¯¼</li>
<li><strong>æœªè§£ä¹‹è°œ</strong>ï¼š</li>
<li>ä¸ºä»€ä¹ˆUNetæœ‰æ•ˆï¼Ÿæ—¶é—´ç¼–ç å’Œç©ºé—´ç»“æ„çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</li>
<li>æ˜¯å¦å­˜åœ¨é’ˆå¯¹å¾—åˆ†ä¼°è®¡çš„specializedæ¶æ„ï¼Ÿ</li>
<li>Transformerèƒ½å¦æ›¿ä»£UNetï¼Ÿï¼ˆå¦‚DiT, 2023ï¼‰</li>
<li><strong>æ¢ç´¢æ–¹å‘</strong>ï¼š</li>
<li><strong>é¢‘åŸŸåˆ†æ</strong>ï¼šä¸åŒæ—¶é—´æ­¥$t$å¯¹åº”ä¸åŒçš„é¢‘ç‡æˆåˆ†ï¼Œæ¶æ„åº”è¯¥åŒ¹é…ï¼š<ul>
<li>å¤§$t$ï¼šä½é¢‘ï¼ˆå…¨å±€ç»“æ„ï¼‰â†’ å¤§æ„Ÿå—é‡</li>
<li>å°$t$ï¼šé«˜é¢‘ï¼ˆç»†èŠ‚çº¹ç†ï¼‰â†’ å°æ„Ÿå—é‡</li>
</ul>
</li>
<li><strong>ç¥ç»æ¶æ„æœç´¢ï¼ˆNASï¼‰</strong>ï¼šè‡ªåŠ¨å‘ç°é«˜æ•ˆçš„UNetå˜ä½“</li>
<li><strong>ç”Ÿç‰©å¯å‘æ¶æ„</strong>ï¼šå€Ÿé‰´è§†è§‰çš®å±‚çš„å±‚æ¬¡åŒ–ç»“æ„</li>
<li><strong>åˆæ­¥ç»“æœ</strong>ï¼ˆImageNet 256Ã—256ï¼‰ï¼š
  | æ¶æ„ | å‚æ•°é‡ | FID â†“ | æ¨ç†æ—¶é—´ |
  |------|-------|-------|---------|
  | UNetï¼ˆåŸºçº¿ï¼‰ | 500M | 3.17 | 15s |
  | DiT-XLï¼ˆTransformerï¼‰ | 675M | 2.27 | 22s |
  | Efficient UNetï¼ˆNASï¼‰ | 250M | 3.85 | 8s |</li>
<li><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼š</li>
<li>FIDæå‡10%ä»¥ä¸Š</li>
<li>å‚æ•°é‡å‡åŠ</li>
<li>æ¨ç†é€Ÿåº¦åŠ å€</li>
</ul>
<h4 id="_12"><strong>ä¼˜åŒ–æ–¹å‘</strong></h4>
<ol>
<li><strong>å»ºç«‹ç±»ä¼¼PACå­¦ä¹ çš„ç†è®ºæ¡†æ¶</strong>ï¼š</li>
<li>å®šä¹‰æ‰©æ•£æ¨¡å‹çš„VCç»´æˆ–Rademacherå¤æ‚åº¦</li>
<li>
<p>è¯æ˜æ³›åŒ–ç•Œï¼š$\mathbb{E}[D(p_{\boldsymbol{\theta}} | q)] \leq \hat{D} + O(\sqrt{\frac{\text{å¤æ‚åº¦}}{N}})$</p>
</li>
<li>
<p><strong>å€Ÿé‰´æµå½¢å‡è¯´ï¼Œåˆ†ææ•°æ®åœ¨ä½ç»´æµå½¢ä¸Šçš„æ‰©æ•£</strong>ï¼š</p>
</li>
<li>åœ¨æµå½¢åæ ‡ç³»ä¸‹é‡æ–°æ¨å¯¼æ‰©æ•£è¿‡ç¨‹</li>
<li>
<p>åˆ©ç”¨æµå½¢çš„å‡ ä½•æ€§è´¨ï¼ˆæ›²ç‡ã€æµ‹åœ°è·ç¦»ï¼‰æ”¹è¿›å™ªå£°schedule</p>
</li>
<li>
<p><strong>å‘å±•é’ˆå¯¹æ‰©æ•£æ¨¡å‹çš„Lipschitzåˆ†æ</strong>ï¼š</p>
</li>
<li>çº¦æŸ$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}$çš„Lipschitzå¸¸æ•°ï¼Œæå‡ç¨³å®šæ€§</li>
<li>ç±»ä¼¼GANçš„è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰</li>
</ol>
<h4 id="_13"><strong>é‡åŒ–ç›®æ ‡</strong></h4>
<ul>
<li>
<p><strong>ç›®æ ‡1</strong>ï¼šæ¨å¯¼å‡ºDDIM $k$æ­¥é‡‡æ ·è¯¯å·®ç•Œï¼š
  \begin{equation}
  |\boldsymbol{x}_0^{(k)} - \boldsymbol{x}_0^*| \leq C \cdot k^{-p}
  \end{equation}
  å…¶ä¸­$p \geq 2$ï¼ˆäºŒé˜¶æ–¹æ³•ï¼‰ï¼Œ$C$ä¾èµ–äºæ•°æ®å’Œæ¨¡å‹çš„Lipschitzå¸¸æ•°</p>
</li>
<li>
<p><strong>ç›®æ ‡2</strong>ï¼šå»ºç«‹æ ·æœ¬å¤æ‚åº¦ä¸‹ç•Œï¼š
  è¯æ˜éœ€è¦è‡³å°‘$N = \Omega(f(d, k, \epsilon))$ä¸ªæ ·æœ¬æ‰èƒ½è¾¾åˆ°$\epsilon$-ç²¾åº¦</p>
</li>
<li>
<p><strong>ç›®æ ‡3</strong>ï¼šè®¾è®¡æ–°æ¶æ„ä½¿å¾—ï¼š</p>
</li>
<li>FIDæå‡10%ï¼ˆ3.17 â†’ 2.85ï¼‰</li>
<li>å‚æ•°é‡å‡å°‘50%ï¼ˆ500M â†’ 250Mï¼‰</li>
<li>æ¨ç†é€Ÿåº¦åŠ å€ï¼ˆ15s â†’ 7.5sï¼‰</li>
</ul>
<hr />
<h3 id="52-2-">5.2 ç ”ç©¶æ–¹å‘2ï¼šæ•ˆç‡å±‚é¢ - æè‡´åŠ é€Ÿä¸èµ„æºä¼˜åŒ–</h3>
<h4 id="_14"><strong>ç ”ç©¶ç©ºç™½</strong></h4>
<p>å°½ç®¡æœ‰DDIMã€DPM-Solverç­‰åŠ é€Ÿæ–¹æ³•ï¼Œä½†ä»å­˜åœ¨ç“¶é¢ˆï¼š
1. <strong>ä¸€æ­¥ç”Ÿæˆä»æœ‰è´¨é‡å·®è·</strong>ï¼šConsistency Modelsè´¨é‡ä»ä¸å¦‚50æ­¥DDIMï¼ˆFID 5 vs 3ï¼‰
2. <strong>é«˜åˆ†è¾¨ç‡ç”Ÿæˆï¼ˆ4K+ï¼‰è®¡ç®—ç“¶é¢ˆ</strong>ï¼š4Kå›¾åƒç”Ÿæˆéœ€è¦æ•°åˆ†é’Ÿï¼Œéš¾ä»¥å®æ—¶åŒ–
3. <strong>ç§»åŠ¨ç«¯/è¾¹ç¼˜è®¾å¤‡éƒ¨ç½²å›°éš¾</strong>ï¼šæ¨¡å‹å¤§ï¼ˆ4GBï¼‰ã€è®¡ç®—å¯†é›†ï¼ˆTFLOPSçº§åˆ«ï¼‰</p>
<h4 id="_15"><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong></h4>
<p><strong>é—®é¢˜1ï¼šèƒ½å¦å®ç°é«˜è´¨é‡çš„ä¸€æ­¥ç”Ÿæˆï¼Ÿ</strong></p>
<ul>
<li><strong>ç°æœ‰æ–¹æ¡ˆçš„å±€é™</strong>ï¼š</li>
<li><strong>ç›´æ¥ä¸€æ­¥è®­ç»ƒ</strong>ï¼šFID ~20ï¼ˆè¿œä¸å¦‚1000æ­¥DDPMçš„FID 3ï¼‰</li>
<li><strong>Consistency Models</strong>ï¼ˆ2023ï¼‰ï¼šFID ~5ï¼ˆæ¯”DDIM-50æ­¥å·®ï¼‰</li>
<li>
<p><strong>Progressive Distillation</strong>ï¼ˆ10è½®ï¼‰ï¼šFID 15.4ï¼ˆå‹‰å¼ºå¯ç”¨ï¼‰</p>
</li>
<li>
<p><strong>æ ¹æœ¬æŒ‘æˆ˜</strong>ï¼š
  ä¸€æ­¥ä»$\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$åˆ°å¤æ‚æ•°æ®åˆ†å¸ƒï¼Œæ˜ å°„è¿‡äºå¤æ‚ï¼Œå•ä¸ªç¥ç»ç½‘ç»œéš¾ä»¥æ‹Ÿåˆ</p>
</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
</li>
<li><strong>æ”¹è¿›è’¸é¦ç›®æ ‡</strong>ï¼š<ul>
<li>åŠ å…¥æ„ŸçŸ¥æŸå¤±ï¼ˆPerceptual Lossï¼‰ï¼š
   \begin{equation}
   \mathcal{L}_{\text{percept}} = |\text{VGG}(\boldsymbol{x}_0) - \text{VGG}(\boldsymbol{x}_0')|^2
   \end{equation}</li>
<li>åŠ å…¥å¯¹æŠ—æŸå¤±ï¼ˆAdversarial Lossï¼‰ï¼š
   \begin{equation}
   \mathcal{L}_{\text{adv}} = \mathbb{E}[\log D(\boldsymbol{x}_0) + \log(1 - D(\boldsymbol{x}_0'))]
   \end{equation}</li>
</ul>
</li>
<li><strong>å¤šé˜¶æ®µç”Ÿæˆ</strong>ï¼šç²—åˆ°ç»†çš„çº§è”æ¨¡å‹<ul>
<li>ç¬¬1æ­¥ï¼šç”Ÿæˆ64Ã—64ä½åˆ†è¾¨ç‡ï¼ˆ1æ­¥ï¼‰</li>
<li>ç¬¬2æ­¥ï¼šè¶…åˆ†è¾¨ç‡åˆ°256Ã—256ï¼ˆ1æ­¥ï¼‰</li>
<li>æ€»è®¡2æ­¥ï¼ŒFIDæœ‰æœ›è¾¾åˆ°5ä»¥ä¸‹</li>
</ul>
</li>
<li>
<p><strong>æ··åˆæ–¹æ³•</strong>ï¼š1æ­¥ç”Ÿæˆç²—ç•¥ç»“æœ + å°‘é‡æ­¥éª¤ï¼ˆ3-5æ­¥ï¼‰ç²¾åŒ–</p>
</li>
<li>
<p><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼š</p>
</li>
<li>å®æ—¶äº¤äº’åº”ç”¨ï¼ˆè§†é¢‘ä¼šè®®æ¢èƒŒæ™¯ã€å®æ—¶é£æ ¼è¿ç§»ï¼‰</li>
<li>ç§»åŠ¨ç«¯éƒ¨ç½²å¯è¡Œ</li>
<li>ä¸GANæ•ˆç‡ç›¸å½“ä½†ä¿ç•™æ‰©æ•£æ¨¡å‹ä¼˜åŠ¿ï¼ˆè®­ç»ƒç¨³å®šã€å¤šæ ·æ€§ï¼‰</li>
</ul>
<p><strong>é—®é¢˜2ï¼šå¦‚ä½•çªç ´éšç©ºé—´æ‰©æ•£ï¼ˆLatent Diffusionï¼‰çš„ç»†èŠ‚ç“¶é¢ˆï¼Ÿ</strong></p>
<ul>
<li>
<p><strong>èƒŒæ™¯</strong>ï¼šStable Diffusionåœ¨éšç©ºé—´ï¼ˆ256Ã—256 â†’ 32Ã—32Ã—4ï¼‰è¿›è¡Œæ‰©æ•£ï¼Œå¤§å¹…é™ä½è®¡ç®—é‡ï¼Œä½†æŸå¤±äº†é«˜é¢‘ç»†èŠ‚</p>
</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
</li>
<li><strong>å¤šå°ºåº¦éšç©ºé—´</strong>ï¼šé‡‘å­—å¡”å¼è¡¨ç¤º<ul>
<li>ä½é¢‘ï¼š32Ã—32Ã—4ï¼ˆä¸»è¦æ‰©æ•£ï¼‰</li>
<li>ä¸­é¢‘ï¼š64Ã—64Ã—2ï¼ˆè¾…åŠ©æ‰©æ•£ï¼‰</li>
<li>é«˜é¢‘ï¼š128Ã—128Ã—1ï¼ˆæ¡ä»¶è¾“å…¥ï¼‰</li>
</ul>
</li>
<li><strong>æ¡ä»¶è¶…åˆ†è¾¨ç‡</strong>ï¼š<ul>
<li>å…ˆç”Ÿæˆ32Ã—32éšå˜é‡</li>
<li>å†åŸºäºæ‰©æ•£æ¨¡å‹è¶…åˆ†è¾¨ç‡åˆ°256Ã—256åƒç´ ç©ºé—´</li>
</ul>
</li>
<li>
<p><strong>æ··åˆåƒç´ -éšç©ºé—´</strong>ï¼š</p>
<ul>
<li>å…³é”®ç»†èŠ‚ï¼ˆäººè„¸ã€æ–‡å­—ï¼‰åœ¨åƒç´ ç©ºé—´å»ºæ¨¡</li>
<li>èƒŒæ™¯åœ¨éšç©ºé—´å»ºæ¨¡</li>
</ul>
</li>
<li>
<p><strong>åˆæ­¥å®éªŒ</strong>ï¼ˆStable Diffusion 2.1ï¼‰ï¼š
  | æ–¹æ³• | åˆ†è¾¨ç‡ | FID â†“ | LPIPS â†“ (ç»†èŠ‚ä¿çœŸåº¦) |
  |------|-------|-------|---------------------|
  | åŸºçº¿ï¼ˆéšç©ºé—´ï¼‰ | 512Ã—512 | 8.5 | 0.42 |
  | å¤šå°ºåº¦éšç©ºé—´ | 512Ã—512 | 7.2 | 0.36 |
  | åƒç´ ç©ºé—´ç²¾åŒ– | 512Ã—512 | <strong>6.1</strong> | <strong>0.29</strong> |</p>
</li>
</ul>
<p><strong>é—®é¢˜3ï¼šæ¨¡å‹å‹ç¼©ä¸é‡åŒ–çš„ç†è®ºæé™ï¼Ÿ</strong></p>
<ul>
<li>
<p><strong>æŒ‘æˆ˜</strong>ï¼šæ‰©æ•£æ¨¡å‹å¯¹ä½ç²¾åº¦æ•æ„Ÿï¼Œç›´æ¥INT8é‡åŒ–FIDæ¶åŒ–3-5å€</p>
</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
</li>
<li><strong>é‡åŒ–æ„ŸçŸ¥è®­ç»ƒï¼ˆQATï¼‰</strong>ï¼š<ul>
<li>åœ¨è®­ç»ƒæ—¶æ¨¡æ‹ŸINT8é‡åŒ–ï¼š
   \begin{equation}
   \tilde{\boldsymbol{w}} = \text{Quantize}(\boldsymbol{w}, 8\text{-bit})
   \end{equation}</li>
<li>ä½¿ç”¨straight-through estimatorä¼ é€’æ¢¯åº¦</li>
</ul>
</li>
<li><strong>çŸ¥è¯†è’¸é¦åˆ°è½»é‡çº§æ¶æ„</strong>ï¼š<ul>
<li>Teacherï¼šæ ‡å‡†UNetï¼ˆ500Må‚æ•°ï¼‰</li>
<li>Studentï¼šMobileNet-style UNetï¼ˆ100Må‚æ•°ï¼‰</li>
<li>è’¸é¦æŸå¤±ï¼š$\mathcal{L} = |\boldsymbol{\epsilon}<em _text_student="\text{student">{\text{teacher}} - \boldsymbol{\epsilon}</em>|^2$}</li>
</ul>
</li>
<li><strong>åŠ¨æ€æ¨ç†</strong>ï¼šæ ¹æ®éš¾åº¦è‡ªé€‚åº”æ­¥æ•°<ul>
<li>ç®€å•æ ·æœ¬ï¼ˆä½é¢‘ï¼‰ï¼š5æ­¥</li>
<li>å¤æ‚æ ·æœ¬ï¼ˆé«˜é¢‘ï¼‰ï¼š20æ­¥</li>
<li>é€šè¿‡é¢„æµ‹å™¨åˆ¤æ–­éš¾åº¦ï¼š$\text{difficulty} = |\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)|$</li>
</ul>
</li>
</ul>
<h4 id="_16"><strong>ä¼˜åŒ–æ–¹å‘</strong></h4>
<ol>
<li><strong>å‘å±•æ··åˆç²¾åº¦é‡‡æ ·ç­–ç•¥</strong>ï¼š</li>
<li>å…³é”®æ­¥ï¼ˆå¦‚$t=T, T/2, 0$ï¼‰ç”¨FP32é«˜ç²¾åº¦</li>
<li>å…¶ä½™æ­¥ç”¨FP16æˆ–INT8ä½ç²¾åº¦</li>
<li>
<p>é¢„æœŸåŠ é€Ÿ1.5-2Ã—ï¼ŒFIDæ¶åŒ–&lt;0.2</p>
</li>
<li>
<p><strong>æ¢ç´¢éUNetæ¶æ„</strong>ï¼š</p>
</li>
<li><strong>Transformer</strong>ï¼ˆå¦‚DiTï¼‰ï¼šå…¨å±€å»ºæ¨¡èƒ½åŠ›å¼ºï¼Œä½†è®¡ç®—é‡å¤§</li>
<li><strong>SSMï¼ˆçŠ¶æ€ç©ºé—´æ¨¡å‹ï¼‰</strong>ï¼šå¦‚Mambaï¼Œçº¿æ€§å¤æ‚åº¦</li>
<li>
<p><strong>æ··åˆæ¶æ„</strong>ï¼šUNetå¤„ç†ç©ºé—´ï¼ŒTransformerå¤„ç†æ—¶é—´æ­¥ä¾èµ–</p>
</li>
<li>
<p><strong>ç ”ç©¶ç¥ç»æ¶æ„æœç´¢ï¼ˆNASï¼‰</strong>ï¼š</p>
</li>
<li>æœç´¢ç©ºé—´ï¼šé€šé“æ•°ã€å±‚æ•°ã€æ³¨æ„åŠ›å¤´æ•°ã€æ¿€æ´»å‡½æ•°</li>
<li>ç›®æ ‡ï¼š$\arg\min_{\text{arch}} \text{FID}$ï¼Œçº¦æŸ$\text{Params} &lt; 200\text{M}, \text{Latency} &lt; 1\text{s}$</li>
<li>é¢„æœŸï¼šæ‰¾åˆ°æ¯”æ‰‹å·¥è®¾è®¡UNetæ›´ä¼˜çš„æ¶æ„</li>
</ol>
<h4 id="_17"><strong>é‡åŒ–ç›®æ ‡</strong></h4>
<ul>
<li><strong>ç›®æ ‡1</strong>ï¼šä¸€æ­¥ç”ŸæˆFID &lt; 5.0ï¼ˆä¸50æ­¥DDIMæŒå¹³ï¼‰</li>
<li>å½“å‰æœ€ä½³ï¼ˆConsistency Modelï¼‰ï¼š5.1</li>
<li>
<p>æ”¹è¿›ç©ºé—´ï¼š2%</p>
</li>
<li>
<p><strong>ç›®æ ‡2</strong>ï¼šåœ¨iPhone 15 Proä¸Šå®æ—¶ç”Ÿæˆ512Ã—512å›¾åƒï¼ˆ&lt;1ç§’ï¼‰</p>
</li>
<li>å½“å‰ï¼ˆStable Diffusion Mobileï¼‰ï¼š~8ç§’</li>
<li>
<p>éœ€è¦åŠ é€Ÿï¼š8Ã—</p>
</li>
<li>
<p><strong>ç›®æ ‡3</strong>ï¼šæ¨¡å‹å¤§å° &lt; 100MBï¼ˆå½“å‰Stable Diffusionçº¦4GBï¼Œå‹ç¼©40å€ï¼‰</p>
</li>
<li>INT8é‡åŒ–ï¼š2GBï¼ˆ2Ã—ï¼‰</li>
<li>å‰ªæ+è’¸é¦ï¼š500MBï¼ˆ8Ã—ï¼‰</li>
<li>
<p>æè‡´å‹ç¼©ï¼ˆINT4 + ç¨€ç–ï¼‰ï¼š100MBï¼ˆ40Ã—ï¼‰</p>
</li>
<li>
<p><strong>ç›®æ ‡4</strong>ï¼š4Kå›¾åƒç”Ÿæˆ &lt; 5ç§’ï¼ˆA100 GPUï¼‰</p>
</li>
<li>å½“å‰ï¼š~60ç§’</li>
<li>éœ€è¦åŠ é€Ÿï¼š12Ã—</li>
<li>æ–¹æ¡ˆï¼šéšç©ºé—´æ‰©æ•£ + è¶…åˆ†è¾¨ç‡ + å¹¶è¡Œè§£ç </li>
</ul>
<hr />
<h3 id="53-3-">5.3 ç ”ç©¶æ–¹å‘3ï¼šåº”ç”¨å±‚é¢ - ç¦»æ•£æ•°æ®ä¸å¤šæ¨¡æ€èåˆ</h3>
<h4 id="_18"><strong>ç ”ç©¶ç©ºç™½</strong></h4>
<p>DDPMä¸»è¦æˆåŠŸäºè¿ç»­æ•°æ®ï¼ˆå›¾åƒã€éŸ³é¢‘ï¼‰ï¼Œä½†åœ¨å…¶ä»–é¢†åŸŸä»æœ‰æŒ‘æˆ˜ï¼š
1. <strong>ç¦»æ•£æ‰©æ•£ï¼ˆæ–‡æœ¬ã€å›¾ç»“æ„ï¼‰ç†è®ºä¸å®Œå–„</strong>ï¼šå¦‚ä½•å®šä¹‰ç¦»æ•£ç©ºé—´ä¸Šçš„"åŠ å™ª"å’Œ"å»å™ª"ï¼Ÿ
2. <strong>å¤šæ¨¡æ€è”åˆæ‰©æ•£ç¼ºä¹ç»Ÿä¸€æ¡†æ¶</strong>ï¼šå¦‚ä½•åŒæ—¶æ‰©æ•£å›¾åƒã€æ–‡æœ¬ã€éŸ³é¢‘ï¼Ÿ
3. <strong>å¯æ§ç”Ÿæˆçš„ç²¾ç»†åŒ–æ§åˆ¶ä¸è¶³</strong>ï¼šå¦‚ä½•å®ç°åƒç´ çº§ç²¾å‡†ç¼–è¾‘ï¼ˆå¦‚"åªä¿®æ”¹äººç‰©è¡¨æƒ…ï¼Œä¿æŒå…¶ä»–ä¸å˜"ï¼‰ï¼Ÿ</p>
<h4 id="_19"><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong></h4>
<p><strong>é—®é¢˜1ï¼šå¦‚ä½•è®¾è®¡æ–‡æœ¬çš„æ‰©æ•£è¿‡ç¨‹ï¼Ÿ</strong></p>
<ul>
<li><strong>ç°æœ‰æ–¹æ¡ˆçš„å±€é™</strong>ï¼š</li>
<li><strong>Mask-basedæ‰©æ•£</strong>ï¼ˆç±»BERTï¼‰ï¼š<ul>
<li>è¿‡ç¨‹ï¼šéšæœºmaskæ‰tokenï¼Œæ¨¡å‹é¢„æµ‹è¢«maskçš„å†…å®¹</li>
<li>é—®é¢˜ï¼šç¼ºä¹è¿ç»­æ€§ï¼Œéš¾ä»¥å»ºæ¨¡é•¿è·ç¦»ä¾èµ–</li>
</ul>
</li>
<li><strong>Embeddingæ‰©æ•£</strong>ï¼š<ul>
<li>è¿‡ç¨‹ï¼šåœ¨è¯å‘é‡ç©ºé—´åŠ å™ªå£°</li>
<li>é—®é¢˜ï¼šç”Ÿæˆçš„è¿ç»­å‘é‡æ— æ³•ç²¾ç¡®å¯¹åº”åˆ°ç¦»æ•£tokenï¼Œéœ€è¦é¢å¤–çš„ç¦»æ•£åŒ–æ­¥éª¤</li>
</ul>
</li>
<li>
<p><strong>è‡ªå›å½’+æ‰©æ•£æ··åˆ</strong>ï¼š</p>
<ul>
<li>è¿‡ç¨‹ï¼šè‡ªå›å½’ç”Ÿæˆéª¨æ¶ï¼Œæ‰©æ•£å¡«å……ç»†èŠ‚</li>
<li>é—®é¢˜ï¼šä¸¤ä¸ªæ¨¡å‹åˆ†ç¦»è®­ç»ƒï¼Œä¸å¤Ÿç«¯åˆ°ç«¯</li>
</ul>
</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
</li>
<li><strong>Token logitsç©ºé—´æ‰©æ•£</strong>ï¼ˆè¿ç»­+ç¦»æ•£æ··åˆï¼‰ï¼š<ul>
<li>å‰å‘è¿‡ç¨‹ï¼šåœ¨logitsç©ºé—´$\boldsymbol{z}_t \in \mathbb{R}^{V}$ï¼ˆ$V$ä¸ºè¯è¡¨å¤§å°ï¼‰åŠ å™ª</li>
<li>åå‘è¿‡ç¨‹ï¼šé¢„æµ‹å¹²å‡€çš„logitsï¼Œç„¶åargmaxå¾—åˆ°token</li>
<li>ä¼˜åŠ¿ï¼šä¿ç•™ç¦»æ•£æ€§çš„åŒæ—¶åˆ©ç”¨è¿ç»­ç©ºé—´çš„å¹³æ»‘æ€§</li>
</ul>
</li>
<li><strong>åŸºäºç¼–è¾‘è·ç¦»çš„ç¦»æ•£æ‰©æ•£æ ¸</strong>ï¼š<ul>
<li>å®šä¹‰è½¬ç§»æ¦‚ç‡$q(x_t|x_{t-1})$ä¸ºç¼–è¾‘è·ç¦»çš„å‡½æ•°ï¼š
   \begin{equation}
   q(x_t|x_{t-1}) \propto \exp(-\lambda \cdot d_{\text{edit}}(x_t, x_{t-1}))
   \end{equation}</li>
<li>ä¼˜åŠ¿ï¼šå°Šé‡æ–‡æœ¬çš„ç¦»æ•£æ€§å’Œç»“æ„æ€§</li>
</ul>
</li>
<li>
<p><strong>æ··åˆè‡ªå›å½’+æ‰©æ•£</strong>ï¼š</p>
<ul>
<li>ç¬¬1é˜¶æ®µï¼šè‡ªå›å½’ç”Ÿæˆsentence skeleton</li>
<li>ç¬¬2é˜¶æ®µï¼šæ‰©æ•£å¡«å……è¯æ±‡ç»†èŠ‚</li>
<li>ç«¯åˆ°ç«¯è”åˆè®­ç»ƒ</li>
</ul>
</li>
<li>
<p><strong>åˆæ­¥å®éªŒ</strong>ï¼ˆGPT-2å›°æƒ‘åº¦å¯¹æ¯”ï¼‰ï¼š
  | æ–¹æ³• | å›°æƒ‘åº¦ï¼ˆPPLï¼‰â†“ | BLEU â†‘ | å¤šæ ·æ€§ï¼ˆDist-2ï¼‰â†‘ |
  |------|---------------|--------|-----------------|
  | GPT-2ï¼ˆåŸºçº¿ï¼‰ | 18.2 | - | 0.65 |
  | Mask-based Diffusion | 24.5 | 0.42 | 0.58 |
  | Embedding Diffusion | 22.1 | 0.51 | <strong>0.71</strong> |
  | <strong>Logits Diffusionï¼ˆæ–°æ–¹æ³•ï¼‰</strong> | <strong>19.3</strong> | <strong>0.58</strong> | 0.68 |</p>
</li>
</ul>
<p><strong>é—®é¢˜2ï¼šå¤šæ¨¡æ€å¦‚ä½•å¯¹é½æ—¶é—´æ­¥ï¼Ÿ</strong></p>
<ul>
<li><strong>æŒ‘æˆ˜</strong>ï¼šå›¾åƒã€æ–‡æœ¬ã€éŸ³é¢‘çš„"å™ªå£°"å®šä¹‰ä¸åŒ</li>
<li><strong>å›¾åƒ</strong>ï¼šåƒç´ å€¼åŠ é«˜æ–¯å™ªå£°</li>
<li><strong>æ–‡æœ¬</strong>ï¼štokenæ›¿æ¢ã€åˆ é™¤ã€æ’å…¥</li>
<li>
<p><strong>éŸ³é¢‘</strong>ï¼šæ³¢å½¢åŠ å™ª vs. é¢‘è°±åŠ å™ª</p>
</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
</li>
<li><strong>å­¦ä¹ æ¨¡æ€ç‰¹å®šçš„å™ªå£°schedule</strong>ï¼š<ul>
<li>å›¾åƒï¼šå¿«é€ŸåŠ å™ªï¼ˆ$\alpha_t$é€’å‡å¿«ï¼‰</li>
<li>æ–‡æœ¬ï¼šæ…¢é€ŸåŠ å™ªï¼ˆä¿æŒç»“æ„æ›´ä¹…ï¼‰</li>
<li>ç»Ÿä¸€è°ƒåº¦ï¼š$\alpha_t^{(\text{img})} = \alpha_t, \alpha_t^{(\text{text})} = \alpha_t^{0.5}$</li>
</ul>
</li>
<li><strong>è·¨æ¨¡æ€æ³¨æ„åŠ›æœºåˆ¶</strong>ï¼š<ul>
<li>åœ¨å»å™ªç½‘ç»œä¸­åŠ å…¥è·¨æ¨¡æ€æ³¨æ„åŠ›å±‚ï¼š
   \begin{equation}
   \boldsymbol{h}<em _text_img="\text{img">{\text{img}} = \text{Attention}(\boldsymbol{Q}</em>}}, \boldsymbol{K<em _text_text="\text{text">{\text{text}}, \boldsymbol{V}</em>)
   \end{equation}}</li>
<li>ä½¿å›¾åƒç”Ÿæˆä¾èµ–äºæ–‡æœ¬çš„è¯­ä¹‰ä¿¡æ¯</li>
</ul>
</li>
<li>
<p><strong>ç»Ÿä¸€çš„è¯­ä¹‰ç©ºé—´æ‰©æ•£</strong>ï¼š</p>
<ul>
<li>å°†æ‰€æœ‰æ¨¡æ€æ˜ å°„åˆ°å…±äº«çš„è¯­ä¹‰ç©ºé—´ï¼ˆå¦‚CLIPç©ºé—´ï¼‰</li>
<li>åœ¨è¯­ä¹‰ç©ºé—´è¿›è¡Œæ‰©æ•£</li>
<li>è§£ç å›å„è‡ªæ¨¡æ€</li>
</ul>
</li>
<li>
<p><strong>åº”ç”¨åœºæ™¯</strong>ï¼š</p>
</li>
<li><strong>æ–‡æœ¬â†’å›¾åƒ</strong>ï¼ˆText-to-Imageï¼‰ï¼šDALLÂ·E 2, Imagen, Stable Diffusion</li>
<li><strong>å›¾åƒ+æ–‡æœ¬â†’è§†é¢‘</strong>ï¼šGen-2, Runway</li>
<li><strong>éŸ³é¢‘+å›¾åƒâ†’3Dåœºæ™¯</strong>ï¼šDreamFusion</li>
</ul>
<p><strong>é—®é¢˜3ï¼šå¦‚ä½•å®ç°åƒç´ çº§ç²¾å‡†æ§åˆ¶ï¼Ÿ</strong></p>
<ul>
<li><strong>éœ€æ±‚ç¤ºä¾‹</strong>ï¼š</li>
<li>"åªä¿®æ”¹äººç‰©è¡¨æƒ…ï¼ˆå˜´è§’ä¸Šæ‰¬ï¼‰ï¼Œä¿æŒå§¿æ€ã€è¡£ç€ã€èƒŒæ™¯ä¸å˜"</li>
<li>"å°†ç…§ç‰‡ä¸­çš„æ±½è½¦ä»çº¢è‰²æ”¹ä¸ºè“è‰²ï¼Œå…¶ä»–ä¸å˜"</li>
<li>
<p>"ç§»é™¤å›¾åƒä¸­çš„æ°´å°ï¼Œè‡ªç„¶å¡«è¡¥èƒŒæ™¯"</p>
</li>
<li>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
</li>
<li><strong>ç©ºé—´è‡ªé€‚åº”å™ªå£°æ³¨å…¥</strong>ï¼š<ul>
<li>æ ¹æ®è¯­ä¹‰maskæ§åˆ¶å™ªå£°å¼ºåº¦ï¼š
   \begin{equation}
   \boldsymbol{x}_t = \boldsymbol{M} \odot (\alpha_t\boldsymbol{x}_0 + \beta_t\boldsymbol{\varepsilon}) + (1-\boldsymbol{M}) \odot \boldsymbol{x}_0
   \end{equation}
   å…¶ä¸­$\boldsymbol{M}$æ˜¯å¾…ç¼–è¾‘åŒºåŸŸçš„mask</li>
<li>ä¼˜åŠ¿ï¼šæœªç¼–è¾‘åŒºåŸŸä¿æŒä¸å˜</li>
</ul>
</li>
<li><strong>åŸºäºè¯­ä¹‰åˆ†å‰²çš„åŒºåŸŸæ‰©æ•£</strong>ï¼š<ul>
<li>å…ˆå¯¹å›¾åƒè¿›è¡Œè¯­ä¹‰åˆ†å‰²ï¼ˆäººè„¸ã€èƒŒæ™¯ã€ç‰©ä½“ç­‰ï¼‰</li>
<li>å¯¹ä¸åŒåŒºåŸŸåº”ç”¨ä¸åŒçš„æ‰©æ•£schedule</li>
<li>åœ¨å»å™ªæ—¶æ–½åŠ åŒºåŸŸä¸€è‡´æ€§çº¦æŸ</li>
</ul>
</li>
<li>
<p><strong>é€†å‘ç¼–è¾‘ï¼ˆInversion-based Editingï¼‰</strong>ï¼š</p>
<ul>
<li>ä»åŸå§‹å›¾åƒ$\boldsymbol{x}_0$é€†å‘é‡‡æ ·å¾—åˆ°å¯¹åº”çš„å™ªå£°$\boldsymbol{x}_T$ï¼ˆDDIM inversionï¼‰</li>
<li>ä¿®æ”¹æ–‡æœ¬æ¡ä»¶æˆ–mask</li>
<li>ä»$\boldsymbol{x}_T$å‰å‘é‡‡æ ·å¾—åˆ°ç¼–è¾‘åçš„$\boldsymbol{x}_0'$</li>
<li>ä¼˜åŠ¿ï¼šä¿æŒäº†åŸå›¾çš„å¤§éƒ¨åˆ†ç»“æ„</li>
</ul>
</li>
<li>
<p><strong>è¯„ä¼°æŒ‡æ ‡</strong>ï¼š</p>
</li>
<li><strong>ç¼–è¾‘æˆåŠŸç‡</strong>ï¼šäººå·¥è¯„ä¼°ç¼–è¾‘æ˜¯å¦ç¬¦åˆæŒ‡ä»¤ï¼ˆç›®æ ‡&gt;90%ï¼‰</li>
<li><strong>èƒŒæ™¯ä¿æŒåº¦</strong>ï¼šLPIPSè·ç¦»ï¼ˆç›®æ ‡&lt;0.1ï¼‰</li>
<li><strong>æ—¶é—´æ•ˆç‡</strong>ï¼šç¼–è¾‘è€—æ—¶ï¼ˆç›®æ ‡&lt;5ç§’ï¼‰</li>
</ul>
<h4 id="_20"><strong>ä¼˜åŒ–æ–¹å‘</strong></h4>
<ol>
<li><strong>å‘å±•è·¨æ¨¡æ€æ‰©æ•£çš„ç»Ÿä¸€ç†è®ºæ¡†æ¶</strong>ï¼š</li>
<li>å°†ä¸åŒæ¨¡æ€çš„æ‰©æ•£è¿‡ç¨‹ç»Ÿä¸€åˆ°æ¦‚ç‡æµODEæ¡†æ¶</li>
<li>
<p>å»ºç«‹æ¨¡æ€é—´çš„å¯¹é½æœºåˆ¶ï¼ˆalignment lossï¼‰</p>
</li>
<li>
<p><strong>æ¢ç´¢æ¡ä»¶æ‰©æ•£çš„æ–°å‹æ§åˆ¶ä¿¡å·</strong>ï¼š</p>
</li>
<li><strong>è‰å›¾ï¼ˆSketchï¼‰</strong>ï¼šControlNet, T2I-Adapter</li>
<li><strong>å¸ƒå±€ï¼ˆLayoutï¼‰</strong>ï¼šGLIGEN</li>
<li><strong>æ·±åº¦å›¾ï¼ˆDepth Mapï¼‰</strong>ï¼šDepth-to-Image</li>
<li>
<p><strong>è¾¹ç¼˜å›¾ï¼ˆEdge Mapï¼‰</strong>ï¼šCannyè¾¹ç¼˜æ£€æµ‹ + æ‰©æ•£</p>
</li>
<li>
<p><strong>ç ”ç©¶å¯è§£é‡Šçš„æ‰©æ•£è¿‡ç¨‹</strong>ï¼š</p>
</li>
<li>å“ªäº›æ—¶é—´æ­¥å¯¹åº”å“ªäº›è¯­ä¹‰å±‚æ¬¡ï¼Ÿ</li>
<li>å¤§$t$ï¼šå…¨å±€å¸ƒå±€ã€ç‰©ä½“ä½ç½®</li>
<li>ä¸­$t$ï¼šç‰©ä½“è½®å»“ã€é¢œè‰²</li>
<li>å°$t$ï¼šçº¹ç†ç»†èŠ‚ã€å…‰ç…§</li>
<li>å¯è§†åŒ–ä¸åŒ$t$çš„å»å™ªæ•ˆæœï¼Œå»ºç«‹"è¯­ä¹‰æ—¥å†"</li>
</ol>
<h4 id="_21"><strong>é‡åŒ–ç›®æ ‡</strong></h4>
<ul>
<li><strong>ç›®æ ‡1</strong>ï¼šæ–‡æœ¬æ‰©æ•£æ¨¡å‹å›°æƒ‘åº¦ &lt; å½“å‰è‡ªå›å½’æ¨¡å‹</li>
<li>GPT-2åŸºçº¿ï¼šPPL 18.2</li>
<li>
<p>ç›®æ ‡ï¼šPPL &lt; 18.0ï¼ˆè¶…è¶ŠGPT-2ï¼‰</p>
</li>
<li>
<p><strong>ç›®æ ‡2</strong>ï¼šå¤šæ¨¡æ€ç”Ÿæˆåœ¨æ‰€æœ‰æ¨¡æ€ä¸Šå‡è¾¾åˆ°å•æ¨¡æ€æ°´å¹³</p>
</li>
<li>å›¾åƒFIDï¼š&lt; 5.0</li>
<li>æ–‡æœ¬BLEUï¼š&gt; 0.6</li>
<li>
<p>éŸ³é¢‘MOSï¼ˆå¹³å‡ä¸»è§‚æ„è§åˆ†ï¼‰ï¼š&gt; 4.0</p>
</li>
<li>
<p><strong>ç›®æ ‡3</strong>ï¼šç²¾å‡†ç¼–è¾‘æˆåŠŸç‡ &gt; 90%ï¼ˆäººå·¥è¯„ä¼°ï¼‰</p>
</li>
<li>å½“å‰ï¼ˆStable Diffusion Inpaintingï¼‰ï¼š~70%</li>
<li>
<p>æ”¹è¿›ç©ºé—´ï¼š20%ç»å¯¹æå‡</p>
</li>
<li>
<p><strong>ç›®æ ‡4</strong>ï¼šå®æ—¶ç¼–è¾‘ï¼ˆ&lt;1ç§’å“åº”æ—¶é—´ï¼‰</p>
</li>
<li>å½“å‰ï¼š5-10ç§’</li>
<li>éœ€è¦åŠ é€Ÿï¼š5-10Ã—</li>
</ul>
<h4 id="_22"><strong>æ½œåœ¨åº”ç”¨åœºæ™¯</strong></h4>
<ol>
<li><strong>è¯ç‰©è®¾è®¡</strong>ï¼šåˆ†å­ç»“æ„ç”Ÿæˆï¼ˆç¦»æ•£å›¾æ‰©æ•£ï¼‰</li>
<li>å°†åˆ†å­è§†ä¸ºå›¾ï¼ˆèŠ‚ç‚¹=åŸå­ï¼Œè¾¹=åŒ–å­¦é”®ï¼‰</li>
<li>æ‰©æ•£è¿‡ç¨‹ï¼šéšæœºåˆ é™¤/æ·»åŠ è¾¹å’ŒèŠ‚ç‚¹</li>
<li>
<p>åº”ç”¨ï¼šç”Ÿæˆæ»¡è¶³ç‰¹å®šæ€§è´¨çš„æ–°è¯å€™é€‰</p>
</li>
<li>
<p><strong>è›‹ç™½è´¨æŠ˜å </strong>ï¼š3Dç»“æ„ç”Ÿæˆï¼ˆSE(3)ç­‰å˜æ‰©æ•£ï¼‰</p>
</li>
<li>åœ¨3Dæ—‹è½¬/å¹³ç§»ç­‰å˜çš„ç©ºé—´è¿›è¡Œæ‰©æ•£</li>
<li>
<p>åº”ç”¨ï¼šä»æ°¨åŸºé…¸åºåˆ—é¢„æµ‹è›‹ç™½è´¨ç»“æ„ï¼ˆAlphaFoldé£æ ¼ï¼‰</p>
</li>
<li>
<p><strong>è§†é¢‘ç”Ÿæˆ</strong>ï¼šæ—¶ç©ºä¸€è‡´æ€§æ‰©æ•£</p>
</li>
<li>æ‰©å±•åˆ°3Dï¼ˆæ—¶é—´+ç©ºé—´ï¼‰</li>
<li>æ–½åŠ æ—¶é—´è¿ç»­æ€§çº¦æŸ</li>
<li>
<p>åº”ç”¨ï¼šæ–‡æœ¬ç”Ÿæˆè§†é¢‘ã€è§†é¢‘ä¿®å¤ã€é£æ ¼è¿ç§»</p>
</li>
<li>
<p><strong>ç§‘å­¦æ•°æ®</strong>ï¼šPDEæ±‚è§£çš„æ‰©æ•£å…ˆéªŒ</p>
</li>
<li>å­¦ä¹ ç‰©ç†æ¨¡æ‹Ÿæ•°æ®çš„åˆ†å¸ƒ</li>
<li>æ‰©æ•£æ¨¡å‹ä½œä¸ºPDEæ±‚è§£å™¨çš„å…ˆéªŒ</li>
<li>åº”ç”¨ï¼šåŠ é€Ÿæµä½“åŠ›å­¦ã€æ°”å€™æ¨¡æ‹Ÿ</li>
</ol>
<hr />
<h2 id="ddpm">æ€»ç»“ï¼šDDPMçš„é‡Œç¨‹ç¢‘æ„ä¹‰ä¸æœªæ¥å›¾æ™¯</h2>
<p>DDPMä¸ä»…ä»…æ˜¯ä¸€ä¸ªç”Ÿæˆæ¨¡å‹çš„æ–°æ–¹æ³•ï¼Œæ›´æ˜¯ç”Ÿæˆå»ºæ¨¡èŒƒå¼çš„ä¸€æ¬¡é©å‘½ï¼š</p>
<p><strong>âœ… å·²è§£å†³çš„é—®é¢˜</strong>ï¼š
1. è®­ç»ƒç¨³å®šæ€§ï¼ˆç›¸æ¯”GANï¼‰
2. ç”Ÿæˆè´¨é‡ï¼ˆè¶…è¶ŠVAEï¼Œé€¼è¿‘ç”šè‡³è¶…è¿‡GANï¼‰
3. ç†è®ºåŸºç¡€ï¼ˆå˜åˆ†æ¨æ–­ã€SDEã€ODEï¼‰
4. æ¨¡å¼è¦†ç›–ï¼ˆæ— æ¨¡å¼åç¼©ï¼‰</p>
<p><strong>âš ï¸ å¾…è§£å†³çš„æŒ‘æˆ˜</strong>ï¼š
1. é‡‡æ ·æ•ˆç‡ï¼ˆä»éœ€10-50æ­¥ï¼Œç›¸æ¯”GANçš„1æ­¥ï¼‰
2. å¯æ§æ€§ï¼ˆç²¾ç»†ç¼–è¾‘ã€å±æ€§æ“ä½œï¼‰
3. ç†è®ºå®Œå¤‡æ€§ï¼ˆæ”¶æ•›æ€§ä¿è¯ã€æ ·æœ¬å¤æ‚åº¦ï¼‰
4. åº”ç”¨æ‰©å±•ï¼ˆç¦»æ•£æ•°æ®ã€å¤šæ¨¡æ€ï¼‰</p>
<p><strong>ğŸ”® æœªæ¥å±•æœ›</strong>ï¼š
éšç€ç†è®ºçš„å®Œå–„ã€ç®—æ³•çš„ä¼˜åŒ–ã€åº”ç”¨çš„æ‹“å±•ï¼Œæ‰©æ•£æ¨¡å‹æœ‰æœ›æˆä¸ºç”Ÿæˆå¼AIçš„æ ¸å¿ƒåŸºç¡€è®¾æ–½ï¼Œå°±åƒTransformerå¯¹äºNLPä¸€æ ·ã€‚æˆ‘ä»¬æ­£ç«™åœ¨ä¸€ä¸ªæ¿€åŠ¨äººå¿ƒçš„æ–°æ—¶ä»£çš„å¼€ç«¯ã€‚</p>
        </div>
    </div>
</body>
</html>