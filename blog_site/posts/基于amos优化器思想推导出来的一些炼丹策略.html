<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŸºäºAmosä¼˜åŒ–å™¨æ€æƒ³æ¨å¯¼å‡ºæ¥çš„ä¸€äº›â€œç‚¼ä¸¹ç­–ç•¥â€</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>åŸºäºAmosä¼˜åŒ–å™¨æ€æƒ³æ¨å¯¼å‡ºæ¥çš„ä¸€äº›â€œç‚¼ä¸¹ç­–ç•¥â€</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 49.9 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9344">https://spaces.ac.cn/archives/9344</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å¦‚æœå°†è®­ç»ƒæ¨¡å‹æ¯”å–»ä¸ºâ€œç‚¼ä¸¹â€ï¼Œé‚£ä¹ˆâ€œç‚¼ä¸¹ç‚‰â€æ˜¾ç„¶å°±æ˜¯ä¼˜åŒ–å™¨äº†ã€‚æ®ä¼ AdamWä¼˜åŒ–å™¨æ˜¯å½“å‰è®­ç»ƒç¥ç»ç½‘ç»œæœ€å¿«çš„æ–¹æ¡ˆï¼Œè¿™ä¸€ç‚¹ç¬”è€…ä¹Ÿæ²¡æœ‰ä¸€ä¸€å¯¹æ¯”è¿‡ï¼Œå…·ä½“æƒ…å†µå¦‚ä½•ä¸å¾—è€ŒçŸ¥ï¼Œä¸è¿‡ç›®å‰åšé¢„è®­ç»ƒæ—¶å¤šæ•°éƒ½ç”¨AdamWæˆ–å…¶å˜ç§LAMBå€’æ˜¯çœŸçš„ã€‚ç„¶è€Œï¼Œæ­£å¦‚æœ‰äº†ç‚¼ä¸¹ç‚‰ä¹Ÿæœªå¿…èƒ½ç‚¼å‡ºå¥½ä¸¹ï¼Œå³ä¾¿æˆ‘ä»¬ç¡®å®šäº†é€‰æ‹©AdamWä¼˜åŒ–å™¨ï¼Œä¾ç„¶æœ‰å¾ˆå¤šé—®é¢˜è¿˜æ²¡æœ‰ç¡®å®šçš„ç­”æ¡ˆï¼Œæ¯”å¦‚ï¼š</p>
<blockquote>
<p>1ã€å­¦ä¹ ç‡å¦‚ä½•é€‚åº”ä¸åŒåˆå§‹åŒ–å’Œå‚æ•°åŒ–ï¼Ÿ</p>
<p>2ã€æƒé‡è¡°å‡ç‡è¯¥æ€ä¹ˆè°ƒï¼Ÿ</p>
<p>3ã€å­¦ä¹ ç‡åº”è¯¥ç”¨ä»€ä¹ˆå˜åŒ–ç­–ç•¥ï¼Ÿ</p>
<p>4ã€èƒ½ä¸èƒ½é™ä½ä¼˜åŒ–å™¨çš„æ˜¾å­˜å ç”¨ï¼Ÿ</p>
</blockquote>
<p>å°½ç®¡åœ¨å®é™…åº”ç”¨æ—¶ï¼Œæˆ‘ä»¬å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½å¯ä»¥ç›´æ¥å¥—ç”¨å‰äººå·²ç»è°ƒå¥½çš„å‚æ•°å’Œç­–ç•¥ï¼Œä½†ç¼ºä¹æ¯”è¾ƒç³»ç»Ÿçš„è°ƒå‚æŒ‡å¼•ï¼Œå§‹ç»ˆä¼šè®©æˆ‘ä»¬åœ¨â€œç‚¼ä¸¹â€ä¹‹æ—¶æ„Ÿè§‰æ²¡æœ‰åº•æ°”ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬åŸºäºGoogleæœ€è¿‘æå‡ºçš„Amosä¼˜åŒ–å™¨çš„æ€è·¯ï¼Œç»™å‡ºä¸€äº›å‚è€ƒç»“æœã€‚</p>
<h2 id="_1">åŸºç¡€å›é¡¾</h2>
<p>Amosä¼˜åŒ–å™¨å‡ºè‡ªGoogleæœ€è¿‘çš„è®ºæ–‡<a href="https://papers.cool/arxiv/2210.11693">ã€ŠAmos: An Adam-style Optimizer with Adaptive Weight Decay towards Model-Oriented Scaleã€‹</a>ï¼Œå®ƒå¯¹ä¸Šè¿°å‡ ä¸ªé—®é¢˜éƒ½æ¨å¯¼äº†æ¯”è¾ƒå®Œæ•´çš„æ¨å¯¼ï¼Œå¹¶é€šè¿‡å®éªŒè¯å®äº†å®ƒçš„æœ‰æ•ˆæ€§ã€‚ç„¶è€Œï¼ŒåŸè®ºæ–‡çš„æ¨å¯¼å®åœ¨æ˜¯ä¸å¥½è¯»ï¼Œå„ç§è®°å·å’Œä¼°è®¡éƒ½è¿‡äºéšæ„ï¼Œç»™äººå¾ˆâ€œå‡Œä¹±â€æ„Ÿè§‰ã€‚ä¸è¿‡å¥½åœ¨Amosçš„æ€æƒ³è¿˜ä¸ç®—å¤æ‚ï¼Œæˆ‘ä»¬å¯ä»¥å€Ÿç”¨ä¸€ä¸‹ã€‚</p>
<p>åœ¨å¼€å§‹æ¨å¯¼ä¹‹å‰ï¼Œæˆ‘ä»¬ä¸å¦¨å…ˆå›é¡¾ä¸€ä¸‹å¯¹äºä¸Šè¿°å‡ ä¸ªé—®é¢˜ï¼Œç°æœ‰çš„è§£å†³æ–¹æ¡ˆæ˜¯æ€æ ·çš„ã€‚</p>
<p>é¦–å…ˆï¼Œç¬¬ä¸€ä¸ªé—®é¢˜ï¼Œå¤§å®¶å¯èƒ½ä¸å¤§ç†è§£â€œåˆå§‹åŒ–â€å’Œâ€œå‚æ•°åŒ–â€åˆ†åˆ«æ˜¯ä»€ä¹ˆå«ä¹‰ï¼Œå…¶å®è¿™å°±æ˜¯æ¨¡å‹æƒé‡çš„ä¸¤ç§è®¾ç½®æ–¹å¼ï¼Œå¸¸è§çš„å°±æ˜¯ä¸€ä¸ª$n\times n$çš„çŸ©é˜µï¼Œä¸€èˆ¬ç”¨â€œå‡å€¼ä¸º0ã€æ–¹å·®ä¸º$1/n$â€çš„æ–¹å¼åˆå§‹åŒ–ï¼Œè¯¦ç»†ä»‹ç»å¯ä»¥å‚è€ƒç¬”è€…ä¹‹å‰<a href="/archives/7180">ã€Šä»å‡ ä½•è§†è§’æ¥ç†è§£æ¨¡å‹å‚æ•°çš„åˆå§‹åŒ–ç­–ç•¥ã€‹</a>ã€<a href="/archives/8620">ã€Šæµ…è°ˆTransformerçš„åˆå§‹åŒ–ã€å‚æ•°åŒ–ä¸æ ‡å‡†åŒ–ã€‹</a>ã€‚ä»â€œæ–¹å·®ä¸º$1/n$â€æˆ‘ä»¬å°±å¯ä»¥çœ‹åˆ°ï¼Œä¸åŒå‚æ•°æœ‰ç€ä¸åŒçš„å°ºåº¦ï¼ˆæˆ–è€…è¯´æ•°é‡çº§ï¼‰ï¼Œå¦‚æœæˆ‘ä»¬ç”¨åŒä¸€ä¸ªå­¦ä¹ ç‡æ›´æ–°æ‰€æœ‰å‚æ•°ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´æ¯ä¸ªå‚æ•°çš„æ›´æ–°å¹…åº¦ä¸ä¸€æ ·ã€‚è¿™ä¸ªé—®é¢˜ç¬”è€…è§‰å¾—æ¯”è¾ƒä¼˜é›…çš„è§£å†³æ–¹æ¡ˆå°±æ˜¯LAMBä¼˜åŒ–å™¨ï¼Œå®ƒæ¯æ¬¡æ›´æ–°çš„æ¨¡é•¿ç›´æ¥å–å†³äºå‚æ•°æœ¬èº«çš„æ¨¡é•¿ï¼Œå­¦ä¹ ç‡åªæ˜¯ç”¨æ¥æè¿°ç›¸å¯¹æ›´æ–°é‡çš„å¤§å°ã€‚</p>
<p>è‡³äºæƒé‡è¡°å‡ç‡é—®é¢˜ï¼Œè‡³å°‘åœ¨é¢„è®­ç»ƒé¢†åŸŸï¼Œç¬”è€…è§‚å¯Ÿåˆ°çš„æ˜¯éƒ½æ˜¯æ²¿ç”¨æœ€æ—©çš„é€‰æ‹©0.01ï¼Œæ²¡æœ‰å‘ç°å»è°ƒæ•´è¯¥å‚æ•°çš„å·¥ä½œã€‚è€Œå¯¹äºå­¦ä¹ ç‡å˜åŒ–ç­–ç•¥ï¼Œå¤§å®¶éƒ½çŸ¥é“åº”è¯¥è¦å°†å­¦ä¹ ç‡æ…¢æ…¢é™åˆ°é›¶ï¼Œä½†å…·ä½“åº”è¯¥é€‰ç”¨ä»€ä¹ˆä»€ä¹ˆä¸‹é™ç­–ç•¥ï¼Œæš‚æ—¶ä¹Ÿæ²¡æœ‰å¤ªå¤šçš„ç†è®ºæŒ‡å¯¼ï¼Œå¤šæ•°ç»“æœä¹Ÿåªæ˜¯å®éªŒæ€»ç»“å‡ºæ¥çš„ã€‚æœ€åï¼Œå…³äºèŠ‚çœæ˜¾å­˜é—®é¢˜ï¼Œæ¯”è¾ƒç»å…¸çš„å·¥ä½œå°±æ˜¯AdaFactorä¼˜åŒ–å™¨ï¼Œç¬”è€…ä¹‹å‰åœ¨<a href="/archives/7302">ã€ŠAdaFactorä¼˜åŒ–å™¨æµ…æï¼ˆé™„å¼€æºå®ç°ï¼‰ã€‹</a>ä¹Ÿæœ‰è¿‡ä»‹ç»ã€‚é™ä½ä¼˜åŒ–å™¨æ˜¾å­˜å ç”¨çš„ä¸»è¦å°±ä¸¤ä¸ªæ€è·¯ï¼Œä¸€æ˜¯å»æ‰åŠ¨é‡ï¼ŒäºŒæ˜¯å¯¹äºŒé˜¶çŸ©åšä½ç§©åˆ†è§£ï¼ŒAmosæœ¬è´¨ä¸Šä¹Ÿæ˜¯æ²¿ç”¨äº†è¿™ä¸¤ä¸ªæ€è·¯ã€‚</p>
<h2 id="_2">é—®é¢˜è®¾ç½®</h2>
<p>æœ¬æ–‡ä¸»è¦å…³å¿ƒå¼€å¤´çš„å‰ä¸‰ä¸ªé—®é¢˜ï¼Œå¸Œæœ›èƒ½å¤Ÿæ¨å¯¼å‡ºä¸€äº›â€œå³æ’å³ç”¨â€çš„ç»“æœã€‚é¦–å…ˆï¼Œæˆ‘ä»¬å°†ä¼˜åŒ–å™¨çš„æ›´æ–°è§„åˆ™ç®€å†™æˆï¼š<br />
\begin{equation}\boldsymbol{\theta}<em t_1="t+1">{t+1} = \boldsymbol{\theta}_t - \alpha_t \boldsymbol{u}_t\end{equation}<br />
å…¶å®$\boldsymbol{\theta}_t, \boldsymbol{\theta}</em>_t$ä»£è¡¨$t$æ—¶åˆ»çš„æ›´æ–°å‘é‡ï¼ˆä¾èµ–äºä»»åŠ¡å’Œæ•°æ®ï¼‰ï¼Œè€Œæ ‡é‡$\alpha_t &gt; 0$ï¼ˆå‘é‡çš„æ¯ä¸ªå…ƒç´ éƒ½å¤§äº0ï¼‰ä»£è¡¨$t$æ—¶åˆ»çš„å­¦ä¹ ç‡ã€‚}$åˆ†åˆ«ä»£è¡¨$t,t+1$æ—¶åˆ»çš„å‚æ•°å€¼ï¼Œ$\boldsymbol{u</p>
<p>è‡ªAdamWèµ·ï¼Œä¸»æµä¼˜åŒ–å™¨éƒ½å€¾å‘äºæŠŠæƒé‡è¡°å‡ï¼ˆWeight Decayï¼‰é¡¹ä»$\boldsymbol{u}<em t_1="t+1">t$ä¸­ç‹¬ç«‹å‡ºæ¥ï¼Œå³<br />
\begin{equation}\boldsymbol{\theta}</em>} = \boldsymbol{\theta}_t - (\alpha_t \boldsymbol{u}_t + \rho_t\boldsymbol{\theta}_t)\end{equation<br />
å…¶ä¸­$\rho_t &gt; 0$æ˜¯æƒé‡è¡°å‡ç‡ã€‚æœ¬æ–‡çš„ä¸»è¦ä»»åŠ¡ï¼Œå°±æ˜¯å¸Œæœ›èƒ½è§£å†³$\alpha_t$å’Œ$\rho_t$è¯¥æ€ä¹ˆè®¾ç½®çš„é—®é¢˜ã€‚</p>
<h2 id="_3">æƒé‡è¡°å‡</h2>
<p>æˆ‘ä»¬çŸ¥é“ï¼Œæƒé‡è¡°å‡ä¹Ÿå¥½ï¼ŒL2æ­£åˆ™ä¹Ÿå¥½ï¼Œå®ƒæœ¬èº«æ˜¯è·Ÿè®­ç»ƒç›®æ ‡æ— å…³çš„ï¼Œå®ƒåªæ˜¯ä¸€ä¸ªè¾…åŠ©é¡¹ï¼Œç›®çš„æ˜¯æé«˜æ¨¡å‹çš„æ³›åŒ–èƒ½åŠ›ã€‚æ—¢ç„¶æ˜¯è¾…åŠ©ï¼Œé‚£ä¹ˆä¸€ä¸ªåŸºæœ¬çš„è¦æ±‚å°±æ˜¯å®ƒä¸åº”è¯¥â€œå–§å®¾å¤ºä¸»â€ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬ä¸å¦¨åŠ å…¥ä¸€ä¸ªé™åˆ¶ï¼š<br />
\begin{equation}\mathcal{O}(\alpha_t^2) = \mathcal{O}(\rho_t)\end{equation}<br />
ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨æ•´ä¸ªæ›´æ–°è¿‡ç¨‹ä¸­ï¼Œæƒé‡è¡°å‡å¸¦æ¥çš„æ›´æ–°é‡å§‹ç»ˆè¦æ¯”ç›®æ ‡ç›¸å…³çš„æ›´æ–°é‡é«˜ä¸€é˜¶ï¼Œç”±äº$\alpha_t,\rho_t$åŸºæœ¬ä¸Šéƒ½æ˜¯å°äº1çš„ï¼Œæ‰€ä»¥æ›´é«˜é˜¶æ„å‘³ç€æ›´å°ã€‚</p>
<p>è®¾ä¼˜åŒ–çš„å‚æ•°ç»ˆç‚¹æ˜¯$\boldsymbol{\theta}^<em>$ï¼Œæˆ‘ä»¬è®°$\boldsymbol{\varepsilon}_t = \boldsymbol{\theta}_t - \boldsymbol{\theta}^</em>$ï¼Œæ ¹æ®æ›´æ–°è§„åˆ™å¯ä»¥å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
\Vert\boldsymbol{\varepsilon}<em t_1="t+1">{t+1}\Vert^2 =&amp;\, \Vert\boldsymbol{\theta}</em>^} - \boldsymbol{\theta<em>\Vert^2 \\\<br />
=&amp;\, \Vert\boldsymbol{\theta}_t - (\alpha_t \boldsymbol{u}_t + \rho_t\boldsymbol{\theta}_t) - \boldsymbol{\theta}^</em>\Vert^2 \\\<br />
\approx&amp;\, \Vert\boldsymbol{\varepsilon}_t\Vert^2 - 2 \alpha_t \boldsymbol{u}_t \cdot \boldsymbol{\varepsilon}_t + \left(\alpha_t^2 \Vert\boldsymbol{u}_t\Vert^2 - 2 \rho_t \boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t\right)<br />
\end{aligned}\label{eq:base-approx}\end{equation}<br />
æœ€åçš„è¿‘ä¼¼åªä¿ç•™äº†ä¸è¶…è¿‡$\mathcal{O}(\alpha_t^2)$çš„é¡¹ã€‚</p>
<p>å¾ˆæ˜æ˜¾ï¼Œ$\Vert\boldsymbol{\varepsilon}<em t_1="t+1">t\Vert$æ˜¯å½“å‰ç»“æœä¸ç»ˆç‚¹çš„è·ç¦»ï¼Œå®ƒè‡ªç„¶æ˜¯è¶Šå°è¶Šå¥½ï¼Œå› æ­¤æˆ‘ä»¬è‡ªç„¶ä¹Ÿå¸Œæœ›æ¯ä¸€æ­¥çš„æ›´æ–°éƒ½èƒ½ç¼©å°è¿™ä¸ªè·ç¦»ï¼Œå³$\Vert\boldsymbol{\varepsilon}</em>}\Vert &lt; \Vert\boldsymbol{\varepsilon<em t_1="t+1">t\Vert$ã€‚è€Œæˆ‘ä»¬çœ‹å¼$\eqref{eq:base-approx}$ï¼Œ$- 2 \alpha_t \boldsymbol{u}_t \cdot \boldsymbol{\varepsilon}_t$å¯æ­£å¯è´Ÿï¼Œå¦‚æœå®ƒä¸ºè´Ÿå°±æœ‰åŠ©äºå®ç°$\Vert\boldsymbol{\varepsilon}</em>}\Vert &lt; \Vert\boldsymbol{\varepsilon<em t_1="t+1">t\Vert$ï¼Œä½†æ˜¯$\alpha_t^2 \Vert\boldsymbol{u}_t\Vert^2$å¿…ç„¶æ˜¯æ­£çš„ï¼Œå®ƒæ˜¯ä¸åˆ©äºå®ç°$\Vert\boldsymbol{\varepsilon}</em>_t\Vert^2$çš„è´Ÿé¢ä½œç”¨ï¼Œé‚£ä¹ˆæƒé‡è¡°å‡çš„å¼•å…¥å°±ä¸ä»…èƒ½å¢å¼ºæ³›åŒ–èƒ½åŠ›ï¼Œè¿˜æœ‰åˆ©äºæ¨¡å‹æ”¶æ•›äº†ã€‚}\Vert &lt; \Vert\boldsymbol{\varepsilon}_t\Vert$ï¼Œä¸è¿‡åœ¨å¼•å…¥æƒé‡è¡°å‡åï¼Œå¤šå‡ºäº†ä¸€é¡¹$- 2 \rho_t \boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t$ï¼Œå¦‚æœè¿™ä¸€é¡¹èƒ½æŠµæ¶ˆæ‰$\alpha_t^2 \Vert\boldsymbol{u</p>
<h2 id="_4">å¯è¡Œåˆ†æ</h2>
<p>æ‰€ä»¥ï¼Œæ¥ä¸‹æ¥çš„äº‹æƒ…ï¼Œæˆ‘ä»¬å°±æ˜¯è¦è€ƒå¯Ÿ<br />
\begin{equation}\alpha_t^2 \Vert\boldsymbol{u}_t\Vert^2 = 2 \rho_t \boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t\label{eq:base-cond}\end{equation}<br />
çš„å¯è¡Œæ€§ã€‚æ‰€è°“å¯è¡Œæ€§ï¼Œå°±æ˜¯$\boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t$èƒ½å¦å¤§äº0ï¼Œåªæœ‰å®ƒå¤§äº0ï¼Œå·¦å³ä¸¤ç«¯æ‰æœ‰å¯èƒ½ç›¸ç­‰ã€‚åˆ©ç”¨$\boldsymbol{\varepsilon}_t$çš„å®šä¹‰æˆ‘ä»¬å¾—åˆ°$\boldsymbol{\theta}_t = \boldsymbol{\varepsilon}_t + \boldsymbol{\theta}^<em>$ï¼Œäºæ˜¯<br />
\begin{equation}\boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t = (\boldsymbol{\varepsilon}_t + \boldsymbol{\theta}^</em>) \cdot \boldsymbol{\varepsilon}_t = \Vert \boldsymbol{\varepsilon}_t\Vert^2 + \boldsymbol{\theta}^<em> \cdot \boldsymbol{\varepsilon}_t\end{equation}<br />
æ³¨æ„$\boldsymbol{\theta}^</em>$æ˜¯æˆ‘ä»¬çš„ç›®æ ‡ï¼Œæ˜¯ä¸€ä¸ªå›ºå®šçš„ç‚¹ï¼Œè€Œ$\boldsymbol{\varepsilon}_t$æ˜¯å½“å‰æ—¶åˆ»ä¸ç›®æ ‡çš„å·®å¼‚å‘é‡ï¼Œä¸¤è€…ä¸€èˆ¬æ¥è¯´æ²¡ä»€ä¹ˆå¿…ç„¶çš„ç›¸å…³æ€§ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥è¿‘ä¼¼è®¤ä¸ºå®ƒä»¬æ˜¯é«˜ç»´ç©ºé—´ä¸­ä¸¤ä¸ªéšæœºå‘é‡ã€‚æ ¹æ®<a href="/archives/7076">ã€Šnç»´ç©ºé—´ä¸‹ä¸¤ä¸ªéšæœºå‘é‡çš„å¤¹è§’åˆ†å¸ƒã€‹</a>ï¼Œæˆ‘ä»¬çŸ¥é“é«˜ç»´ç©ºé—´ä¸­ä¸¤ä¸ªéšæœºå‘é‡å‡ ä¹éƒ½æ˜¯å‚ç›´çš„ï¼Œäºæ˜¯$\boldsymbol{\theta}^* \cdot \boldsymbol{\varepsilon}_t\approx 0$ï¼Œå³$\boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t \approx \Vert \boldsymbol{\varepsilon}_t\Vert^2$ã€‚å½“ç„¶ï¼Œå¦‚æœä¸æ”¾å¿ƒï¼Œè¿˜å¯ä»¥å¼•å…¥ä¸€ä¸ªå‚æ•°$q$ï¼š<br />
\begin{equation}\boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t \approx q\Vert \boldsymbol{\varepsilon}_t\Vert^2\end{equation}<br />
æ­¤æ—¶å¼$\eqref{eq:base-cond}$å°±å˜æˆäº†<br />
\begin{equation}\alpha_t^2 \Vert\boldsymbol{u}_t\Vert^2 \approx 2 \rho_t q\Vert \boldsymbol{\varepsilon}_t\Vert^2\label{eq:base-cond-approx}\end{equation}<br />
ä¸¤ç«¯éƒ½å¤§äº0ï¼Œå› æ­¤å¼$\eqref{eq:base-cond}$æ˜¯æœ‰å¯èƒ½æˆç«‹çš„ã€‚</p>
<h2 id="_5">æ¸è¿‘ä¼°è®¡</h2>
<p>å¦‚æœå¼$\eqref{eq:base-cond}$æˆç«‹ï¼Œé‚£ä¹ˆå¼$\eqref{eq:base-approx}$å°±ç®€åŒ–ä¸ºäº†\begin{equation}\Vert\boldsymbol{\varepsilon}<em t_1="t+1">{t+1}\Vert^2 \approx \Vert\boldsymbol{\varepsilon}_t\Vert^2 - 2 \alpha_t \boldsymbol{u}_t \cdot \boldsymbol{\varepsilon}_t = \Vert\boldsymbol{\varepsilon}_t\Vert^2 - 2 \alpha_t \Vert\boldsymbol{u}_t\Vert \Vert\boldsymbol{\varepsilon}_t\Vert \cos(\boldsymbol{u}_t, \boldsymbol{\varepsilon}_t)\end{equation}<br />
æˆ‘ä»¬è¯´äº†$\boldsymbol{u}_t$ä»£è¡¨çš„æ˜¯ä»»åŠ¡ç›¸å…³çš„æ›´æ–°é‡ï¼Œå¹³å‡æ¥è¯´å®ƒå¿…ç„¶æ˜¯æœ‰åˆ©äºä»»åŠ¡çš„ï¼ˆå¦åˆ™åŸæ¥çš„ä¼˜åŒ–å™¨å°±æ˜¯æœ‰ç¼ºé™·çš„äº†ï¼‰ï¼Œæ‰€ä»¥å¹³å‡æ¥è¯´åº”è¯¥æœ‰$\cos(\boldsymbol{u}_t, \boldsymbol{\varepsilon}_t) &gt; 0$ã€‚è¿™é‡Œæˆ‘ä»¬è¿›ä¸€æ­¥å‡è®¾ï¼Œå­˜åœ¨ä¸€ä¸ª$p &gt; 0$ï¼Œä½¿å¾—$\cos(\boldsymbol{u}_t, \boldsymbol{\varepsilon}_t)\sim p$ï¼Œäºæ˜¯æˆ‘ä»¬æœ‰<br />
\begin{equation}\Vert\boldsymbol{\varepsilon}</em>}\Vert^2 \approx \Vert\boldsymbol{\varepsilon<em t_1="t+1">t\Vert^2 - 2 \alpha_t p\Vert\boldsymbol{u}_t\Vert \Vert\boldsymbol{\varepsilon}_t\Vert\end{equation}<br />
æ ¹æ®è¿‘ä¼¼$\eqref{eq:base-cond-approx}$æˆ‘ä»¬æœ‰$\alpha_t \Vert\boldsymbol{u}_t \Vert \Vert \boldsymbol{\varepsilon}_t\Vert \approx \sqrt{2 \rho_t q}\Vert \boldsymbol{\varepsilon}_t\Vert^2$ï¼Œä»£å…¥ä¸Šå¼å¾—åˆ°<br />
\begin{equation}\Vert\boldsymbol{\varepsilon}</em>}\Vert^2 \approx \Vert\boldsymbol{\varepsilon<em i="1">t\Vert^2(1 - 2 p\sqrt{2 \rho_t q})\approx \Vert\boldsymbol{\varepsilon}_t\Vert^2\exp(- 2 p\sqrt{2 \rho_t q})\end{equation}<br />
ä¸€æ­¥ä¸€æ­¥å¾€å‰é€’æ¨ï¼Œå¯ä»¥å¾—åˆ°<br />
\begin{equation}\Vert\boldsymbol{\varepsilon}_t\Vert^2 \approx\Vert\boldsymbol{\varepsilon}_0\Vert^2\exp\left(- 2 \sum</em>}^{t-1}p\sqrt{2 \rho_i q}\right)\label{eq:varepsilon-t}\end{equation<br />
å¯ä»¥çœ‹å‡ºå³ç«¯çš„æŒ‡æ•°å¿…ç„¶æ˜¯å•è°ƒé€’å‡çš„ï¼Œå®ƒæ˜¯ä¸€ä¸ªè¡°å‡å‡½æ•°ã€‚ç°åœ¨æˆ‘ä»¬å†çœ‹è¿‘ä¼¼$\eqref{eq:base-cond-approx}$ï¼Œå®ƒæœ‰ä¸¤ä¸ªå‚æ•°$\alpha_t$å’Œ$\rho_t$è¦è°ƒï¼Œä½†åªæœ‰ä¸€ä¸ªï¼ˆè¿‘ä¼¼ï¼‰ç­‰å¼ã€‚ä¸ºäº†ä½¿$\alpha_t$å’Œ$\rho_t$èƒ½å¤ŸåŒç­‰ç¨‹åº¦åœ°è¡°å‡ï¼Œæˆ‘ä»¬è®¾$2\rho_t q \approx \lambda^2 \Vert\boldsymbol{\varepsilon}<em i="1">t\Vert^2$ï¼Œäºæ˜¯è§£å¾—<br />
\begin{equation}\begin{aligned}\alpha_t \approx \frac{\lambda\Vert\boldsymbol{\varepsilon}_t\Vert^2}{\Vert\boldsymbol{u}_t\Vert} \approx&amp;\, \frac{\lambda\Vert\boldsymbol{\varepsilon}_0\Vert^2}{\Vert\boldsymbol{u}_t\Vert} \exp\left(- 2 \sum</em>\right) \\\}^{t-1}p\sqrt{2 \rho_i q<br />
\rho_t \approx \frac{\lambda^2\Vert\boldsymbol{\varepsilon}<em i="1">t\Vert^2}{2q} \approx&amp;\, \frac{\lambda^2\Vert\boldsymbol{\varepsilon}_0\Vert^2}{2q} \exp\left(- 2 \sum</em>\right)}^{t-1}p\sqrt{2 \rho_i q<br />
\end{aligned}\label{eq:alpha-rho}\end{equation}<br />
è¿™å°±æ˜¯æœ¬æ–‡æ¨å‡ºçš„$\alpha_t,\rho_t$çš„å˜åŒ–è§„å¾‹ã€‚å½“ç„¶ï¼Œå˜åŒ–è§„å¾‹æ˜¯æœ‰äº†ï¼Œå¯æ˜¯è¿˜æœ‰å››ä¸ªå‚æ•°$\lambda,\Vert\boldsymbol{\varepsilon}_0\Vert,p,q$è¦ç¡®å®šï¼Œå…¶ä¸­$q$ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€å•ï¼Œç›´æ¥è®¾$q=1$é—®é¢˜ä¹Ÿä¸å¤§ï¼Œä½†å³ä¾¿è¿™æ ·è¿˜æœ‰ä¸‰ä¸ªå‚æ•°è¦ç¡®å®šã€‚</p>
<h2 id="_6">å°ºåº¦é¢„åˆ¤</h2>
<p>æ ¹æ®å®šä¹‰ï¼Œ$\Vert\boldsymbol{\varepsilon}_0\Vert = \Vert\boldsymbol{\theta}_0 - \boldsymbol{\theta}^*\Vert$ï¼Œä¹Ÿå°±æ˜¯åˆå§‹åŒ–å‚æ•°ä¸ç›®æ ‡å‚æ•°çš„è·ç¦»ï¼Œå¯ä»¥ç†è§£ä¸ºå‚æ•°çš„å˜åŒ–å°ºåº¦ï¼Œå®ƒæœ‰å‡ ç§ä¸åŒçš„æƒ…å†µã€‚</p>
<p>ç¬¬ä¸€ç§ï¼Œå‚æ•°æ˜¯çŸ©é˜µä¹˜æ³•æ ¸ï¼Œæ¯”å¦‚å…¨è¿æ¥å±‚ã€å·ç§¯å±‚çš„kernelçŸ©é˜µï¼Œå®ƒä»¬çš„åˆå§‹åŒ–ä¸€èˆ¬æ˜¯â€œå‡å€¼ä¸º0ã€æ–¹å·®ä¸º$\sigma^2$â€ï¼ˆ$\sigma$å–å†³äºshapeï¼‰çš„éšæœºåˆå§‹åŒ–ï¼Œè¿™æ ·å¦‚æœ$\boldsymbol{\theta}\in\mathbb{R}^k$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä¼°ç®—å‡º$\Vert\boldsymbol{\theta}_0\Vert^2\approx k\sigma^2$ã€‚å¦å¤–ï¼Œè¿™ç±»å‚æ•°æœ‰ä¸€ä¸ªç‰¹ç‚¹ï¼Œå°±æ˜¯åœ¨åˆç†çš„åˆå§‹åŒ–ä¸‹ï¼Œè®­ç»ƒå®Œæˆåå‚æ•°çš„å‡å€¼æ–¹å·®ä¹Ÿä¸ä¼šæœ‰å¤ªå¤§å˜åŒ–ï¼Œè‡³å°‘é‡çº§æ˜¯ä¸€è‡´çš„ï¼Œå› æ­¤ä¹Ÿå¯ä»¥è®¤ä¸º$\Vert\boldsymbol{\theta}^<em>\Vert^2\approx k\sigma^2$ï¼Œè€Œå› ä¸ºåˆå§‹åŒ–æ˜¯éšæœºçš„ï¼Œæ‰€ä»¥$\boldsymbol{\theta}_0 \cdot \boldsymbol{\theta}^</em>\approx 0$ï¼Œå› æ­¤<br />
\begin{equation}\Vert\boldsymbol{\varepsilon}_0\Vert^2 = \Vert\boldsymbol{\theta}_0 - \boldsymbol{\theta}^<em>\Vert^2 = \Vert\boldsymbol{\theta}_0\Vert^2 + \Vert\boldsymbol{\theta}^</em>\Vert^2 - 2\boldsymbol{\theta}_0 \cdot \boldsymbol{\theta}^* \approx 2k\sigma^2\end{equation}</p>
<p>ç¬¬äºŒç§ï¼Œå‚æ•°æ˜¯åŠ æ€§åç½®é¡¹ï¼Œæ¯”å¦‚å…¨è¿æ¥å±‚ã€å·ç§¯å±‚çš„biaså‘é‡ï¼Œä»¥åŠNormalizationå±‚çš„$\boldsymbol{\beta}$å‘é‡ï¼Œè¿™äº›å‚æ•°ä¸€èˆ¬æ˜¯â€œå…¨é›¶åˆå§‹åŒ–â€ï¼Œæ‰€ä»¥$\Vert\boldsymbol{\varepsilon}_0\Vert^2 = \Vert\boldsymbol{\theta}^<em>\Vert^2$ï¼Œå¦‚æœæˆ‘ä»¬æ ¹æ®ç»éªŒé¢„æµ‹è®­ç»ƒå¥½çš„æ¨¡å‹åç½®é¡¹éƒ½åœ¨$\pm\sigma$é™„è¿‘ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä¼°è®¡å‡º$\Vert\boldsymbol{\theta}^</em>\Vert^2\approx k\sigma^2$ï¼ŒAmosåŸè®ºæ–‡å–äº†$\sigma=0.5$ã€‚æœ€åè¿˜æœ‰Normalizationå±‚çš„$\boldsymbol{\gamma}$å‘é‡ï¼Œå®ƒä¸€èˆ¬æ˜¯â€œå…¨1åˆå§‹åŒ–â€ï¼Œè®­ç»ƒå®Œæˆåä¹Ÿæ˜¯åœ¨1é™„è¿‘ï¼Œä¸å¦¨å‡è®¾è¯¯å·®ä¸º$\pm\sigma$ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ä¼°ç®—å‡º$\Vert\boldsymbol{\theta}^*\Vert^2\approx k\sigma^2$ã€‚è¿™é‡Œçš„$k$éƒ½æ˜¯æŒ‡å‘é‡ç»´åº¦ã€‚</p>
<p>å¯ä»¥çœ‹å‡ºï¼Œ$\Vert\boldsymbol{\varepsilon}_0\Vert^2$çš„ç»“æœéƒ½æœ‰ä¸€ä¸ªå…±æ€§ï¼Œé‚£å°±æ˜¯éƒ½å¯ä»¥å†™æˆ$k\sigma^2$ï¼Œå…¶ä¸­$\sigma$æ˜¯æˆ‘ä»¬å¯¹å‚æ•°å˜åŒ–å°ºåº¦çš„ä¸€ä¸ªé¢„åˆ¤ã€‚ä¹˜æ€§çŸ©é˜µçš„$\sigma$å¯ä»¥ç›´æ¥å–åˆå§‹åŒ–çš„æ ‡å‡†å·®ï¼ŒåŠ æ€§åç½®æˆ–è€…$\boldsymbol{\gamma}$å‘é‡å¯ä»¥ç›´æ¥ç®€å•åœ°å–$\sigma=0.5$ï¼Œæˆ–è€…æœ‰å…¶ä»–ç‰¹æ®Šå‚æ•°çš„å†åšç‰¹æ®Šå¤„ç†ã€‚</p>
<h2 id="_7">åˆ†ç¦»å°ºåº¦</h2>
<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹å®Œæ•´çš„æ›´æ–°é‡ï¼Œæ ¹æ®å¼$\eqref{eq:alpha-rho}$ï¼Œæœ‰<br />
\begin{equation}\alpha_t \boldsymbol{u}<em i="1">t \approx \lambda\Vert\boldsymbol{\varepsilon}_0\Vert^2 \times \frac{\boldsymbol{u}_t}{\Vert\boldsymbol{u}_t\Vert} \times \exp\left(- 2 \sum</em>}^{t-1}p\sqrt{2 \rho_i q}\right)\end{equation<br />
å…¶ä¸­$\frac{\boldsymbol{u}_t}{\Vert\boldsymbol{u}_t\Vert}$æ˜¯ä¸€ä¸ªå•ä½å‘é‡ï¼Œæ§åˆ¶æ›´æ–°æ–¹å‘ï¼Œ$\exp$éƒ¨åˆ†æ˜¯ä¸€ä¸ªè¡°å‡é¡¹ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆä¸ç®¡å®ƒï¼Œæ‰€ä»¥æ›´æ–°é‡çš„æ¨¡é•¿ç”±$\lambda\Vert\boldsymbol{\varepsilon}_0\Vert^2$æ§åˆ¶ã€‚</p>
<p>å›åˆ°æ–‡ç« å¼€å¤´çš„ç¬¬ä¸€ä¸ªé—®é¢˜â€œå­¦ä¹ ç‡å¦‚ä½•é€‚åº”ä¸åŒåˆå§‹åŒ–å’Œå‚æ•°åŒ–ï¼Ÿâ€ï¼Œå¾ˆæ˜æ˜¾ï¼Œç›´è§‚æƒ³æ³•åº”è¯¥å°±æ˜¯å˜åŒ–å°ºåº¦å¤§çš„å‚æ•°æ¯ä¸€æ­¥çš„æ›´æ–°é‡åº”è¯¥æ›´å¤§ï¼Œæˆ–è€…ç›´æ¥ç®€å•åœ°æ­£æ¯”äºå˜åŒ–å°ºåº¦ï¼Œè€Œå˜åŒ–å°ºåº¦æˆ‘ä»¬åˆšæ‰ä¼°è®¡äº†ï¼Œå¯ä»¥ç”¨$\Vert\boldsymbol{\varepsilon}<em i="1">0\Vert$æ¥æè¿°ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¤ä¸ºåº”è¯¥æœ‰$\lambda\Vert\boldsymbol{\varepsilon}_0\Vert^2=\alpha_0 \Vert\boldsymbol{\varepsilon}_0\Vert$ï¼Œå…¶ä¸­$\alpha_0$æ˜¯å…¨å±€çš„åˆå§‹å­¦ä¹ ç‡ã€‚åè¿‡æ¥è§£å¾—$\lambda=\alpha_0/\Vert\boldsymbol{\varepsilon}_0\Vert$ï¼Œä»£å…¥å¼$\eqref{eq:alpha-rho}$å¾—åˆ°<br />
\begin{equation}\alpha_t \approx \frac{\alpha_0\Vert\boldsymbol{\varepsilon}_0\Vert}{\Vert\boldsymbol{u}_t\Vert} \exp\left(- 2 \sum</em>}^{t-1}p\sqrt{2 \rho_i q}\right),\quad \rho_t \approx \frac{\alpha_0^2}{2q} \exp\left(- 2 \sum_{i=1}^{t-1}p\sqrt{2 \rho_i q}\right)\label{eq:alpha-rho-2}\end{equation<br />
å…¶ä¸­$\alpha_0$ä»£è¡¨äº†æ¯ä¸€æ­¥çš„ç›¸å¯¹æ›´æ–°å¹…åº¦ï¼ˆå…¨å±€å­¦ä¹ ç‡ï¼‰ï¼Œè¿™ä¸€æ­¥æ²¡å•¥æ¨å¯¼ç©ºé—´äº†ï¼Œä¸€èˆ¬å–$10^{-3}$å·¦å³å°±è¡Œï¼Œå¦‚æœä»»åŠ¡ç®€å•ä¹Ÿå¯ä»¥å–åˆ°$10^{-2}$ï¼›$\Vert\boldsymbol{\varepsilon}_0\Vert$åœ¨ä¸Šä¸€èŠ‚å·²ç»åšäº†ä¼°è®¡ï¼Œå¤§æ¦‚æ˜¯$\sqrt{k}\sigma$ï¼Œ$\sigma$ä»£è¡¨å‚æ•°å¹³å‡å˜åŒ–å°ºåº¦ï¼Œä¸åŒå‚æ•°ä¸ä¸€æ ·ï¼Œæˆ‘ä»¬æ­£æ˜¯é€šè¿‡å®ƒæŠŠå‚æ•°å°ºåº¦æ˜¾å¼åœ°åˆ†ç¦»äº†å‡ºæ¥ï¼Œä»è€Œè¾¾åˆ°äº†è‡ªé€‚åº”å‚æ•°å°ºåº¦çš„æ•ˆæœï¼ˆæ›´æ–°é‡æ­£æ¯”$\sigma$ï¼‰ã€‚ç‰¹åˆ«åœ°ï¼Œå¦‚æœå°†ä¸Šå¼çš„$\Vert\boldsymbol{\varepsilon}_0\Vert$æ¢æˆ$\Vert\boldsymbol{\theta}_t\Vert$ï¼Œé‚£ä¹ˆå°±æ˜¯LAMBä¼˜åŒ–å™¨ã€‚ä»è¿™é‡Œä¹Ÿå¯ä»¥çœ‹å‡ºï¼Œå¦‚æœ$\boldsymbol{\theta}$çš„åˆå§‹åŒ–å‡å€¼ä¸æ˜¯0ï¼ˆåƒ$\boldsymbol{\gamma}$å‘é‡ï¼‰ï¼Œç”¨$\Vert\boldsymbol{\theta}_t\Vert$æ›¿ä»£$\Vert\boldsymbol{\varepsilon}_0\Vert$æ˜¯ä¼šæœ‰é—®é¢˜çš„ï¼Œæ‰€ä»¥LAMBçš„åšæ³•æ˜¯ç›´æ¥ä¸å¯¹è¿™äº›å‚æ•°çš„æ›´æ–°é‡è¿›è¡Œå˜æ¢ï¼ˆå³ä¿ç•™åŸæ¥çš„æ›´æ–°è§„åˆ™ï¼‰ã€‚</p>
<h2 id="_8">è§£æè¿‘ä¼¼</h2>
<p>å…¶å®ç›®å‰çš„ç»“æœå·²ç»é€‚åˆç¼–ç¨‹å®ç°äº†ï¼Œåªæ˜¯å‚æ•°$p$ä¸å¥½è°ƒç½¢äº†ã€‚ä¸ºäº†è¿›ä¸€æ­¥çœ‹å‡ºå‚æ•°$p$æ˜¯æ€ä¹ˆå½±å“è¡°å‡å‡½æ•°çš„ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥æ±‚å‡º$\rho_t$çš„è§£æè¿‘ä¼¼ï¼</p>
<p>åœ¨å¼$\eqref{eq:alpha-rho-2}$çš„$\rho_t$ä¸¤è¾¹ä¹˜ä»¥$2q$ï¼Œç„¶åä¸¤è¾¹å¼€å¹³æ–¹ï¼Œå¾—åˆ°<br />
å°†æŒ‡æ•°çš„æ±‚å’Œ$\sum\limits_{i=1}^{t-1}p\sqrt{2 \rho_i q}$è®°ä¸º$S_t$ï¼Œé‚£ä¹ˆä¸Šå¼å°±å¯¹åº”å·®åˆ†æ–¹ç¨‹<br />
\begin{equation}\frac{S_t - S_{t-1}}{p} \approx \alpha_0 \exp\left(- S_{t-1}\right) \quad \Rightarrow \quad S_{t+1} - S_t \approx \alpha_0 p\exp\left(- S_t\right)\end{equation}<br />
æ­¤æ—¶è¡°å‡å‡½æ•°å°±æ˜¯$\exp\left(-2S_t\right)$ã€‚ä¸ºäº†æ±‚æ¸è¿‘è¿‘ä¼¼ï¼Œæˆ‘ä»¬ç”¨å¯¼æ•°ä»£æ›¿å·®åˆ†ï¼ˆå‚è€ƒ<a href="/archives/3889">ã€Šå·®åˆ†æ–¹ç¨‹çš„æ‘„åŠ¨æ³•ã€‹</a>ï¼‰ï¼Œå¾—åˆ°<br />
\begin{equation}\frac{dS_t}{dt} \approx \alpha_0 p \exp\left(- S_t\right)\end{equation}<br />
è¿™æ˜¯ä¸ªç®€å•çš„å¾®åˆ†æ–¹ç¨‹ï¼Œå¯ä»¥è§£å¾—ï¼ˆç»“åˆ$S_0=0$ï¼‰<br />
\begin{equation}\exp\left(-2S_t\right) \approx \frac{1}{(\alpha_0 p t + 1)^2}\end{equation}<br />
è¿™å°±æ˜¯è¡°å‡å‡½æ•°çš„æ˜¾å¼è§£ï¼Œè¡¨æ˜è¶…å‚æ•°åº”è¯¥æŒ‰ç…§æ­¥æ•°çš„å¹³æ–¹åæ¯”è¡°å‡ï¼Œä»£å…¥å¼$\eqref{eq:alpha-rho-2}$åçš„å®Œæ•´ç»“æœæ˜¯<br />
\begin{equation}\alpha_t \approx \frac{\alpha_0\Vert\boldsymbol{\varepsilon}_0\Vert}{\Vert\boldsymbol{u}_t\Vert} \frac{1}{(\alpha_0 p t + 1)^2},\quad \rho_t \approx \frac{\alpha_0^2}{2q} \frac{1}{(\alpha_0 p t + 1)^2}\label{eq:alpha-rho-3}\end{equation}<br />
è¿™ä¸ªæ˜¾å¼è§£ä¸ä½†èƒ½è®©ç¼–ç¨‹å®ç°æ›´æ–¹ä¾¿ï¼Œè¿˜ä½¿å¾—$p$çš„å«ä¹‰æ›´ä¸ºæ¸…æ™°ã€‚æ¯”å¦‚æˆ‘ä»¬å¸Œæœ›å­¦ä¹ ç‡åœ¨$T$æ­¥åå°±é™ä½ä¸ºåŸæ¥çš„ä¸€åŠï¼Œé‚£ä¹ˆå°±æœ‰$(\alpha_0 p T + 1)^2=2$ï¼Œä»ä¸­è§£å¾—<br />
\begin{equation}\alpha_0 p = \frac{\sqrt{2}-1}{T}\end{equation}<br />
è‡³äº$T$åº”è¯¥æ˜¯å¤šå°‘ï¼Œè¿™ä¾èµ–äºä»»åŠ¡éš¾åº¦å’Œæ•°æ®é‡ï¼Œä¹Ÿæ²¡æœ‰å¤ªå¤§æ¨å¯¼ç©ºé—´äº†ã€‚</p>
<h2 id="_9">åŠ¨æ€æ”¶æ•›</h2>
<p>ä¸Šè¿°è®¨è®ºçš„å‡è®¾æ˜¯å­˜åœ¨å¸¸æ•°$p &gt; 0$ï¼Œä½¿å¾—$\cos(\boldsymbol{u}<em i="1">t, \boldsymbol{\varepsilon}_t)\sim p$ï¼Œè¿™å¯ä»¥ç†è§£ä¸ºæ¨¡å‹æŒ‰ç…§å›ºå®šçš„é€Ÿåº¦æ”¶æ•›ï¼Œè¿™åœ¨å®é™…ä¸­å¾ˆéš¾æˆç«‹ï¼Œæ›´å¸¸è§çš„æ˜¯è¶Šæ¥è¿‘è®­ç»ƒçš„åæœŸï¼Œæ”¶æ•›é€Ÿåº¦ç›¸å¯¹æ¥è¯´è¶Šæ…¢ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¯ä»¥è¿›ä¸€æ­¥å‡è®¾$p$æ˜¯æ­¥æ•°$t$çš„å‡½æ•°$p_t$ï¼Œè¿™æ ·ä¸€æ¥ï¼Œå‰é¢çš„æ¨å¯¼å¤§ä½“ä¸Šè¿˜æ˜¯æˆç«‹ï¼Œåªä¸è¿‡ç›¸åº”çš„å¸¸æ•°$p$è¦æ¢æˆå¸¦ä¸‹æ ‡çš„$p_i$ï¼š<br />
\begin{equation}\sqrt{2\rho_t q} \approx \alpha_0 \exp\left(- \sum</em>}^{t-1}p_i\sqrt{2 \rho_i q}\right)\end{equation<br />
é‡å¤ä¸Šä¸€èŠ‚çš„æ¨å¯¼ï¼Œæˆ‘ä»¬å¾—åˆ°<br />
\begin{equation}\frac{S_t - S_{t-1}}{p_t} \approx \alpha_0 \exp\left(- S_{t-1}\right) \quad \Rightarrow \quad S_{t+1} - S_t \approx \alpha_0 p_t\exp\left(- S_t\right)\end{equation}<br />
è¿‘ä¼¼çš„å¾®åˆ†æ–¹ç¨‹å°±æ˜¯<br />
\begin{equation}\frac{dS_t}{dt} \approx \alpha_0 p_t \exp\left(- S_t\right)\end{equation}<br />
ç§¯åˆ†çš„ç»“æœæ˜¯<br />
\begin{equation}\exp\left(-S_t\right) \approx \frac{1}{\alpha_0 \int_0^t p_{\tau} d\tau + 1}\end{equation}<br />
ä½†ç°åœ¨å¤šäº†ä¸€ä¸ª$p_t$éœ€è¦ç¡®å®šã€‚ä¸ºäº†é™ä½è°ƒå‚æˆæœ¬ï¼Œæˆ‘ä»¬ä¸å¦¨å‡è®¾æ”¶æ•›çš„ä¸‹é™é€Ÿåº¦è·Ÿ$\Vert\boldsymbol{\varepsilon}<em _tau="\tau">t\Vert$çš„ä¸‹é™é€Ÿåº¦ä¸€è‡´ï¼Œè€Œæ ¹æ®å¼$\eqref{eq:varepsilon-t}$ï¼Œ$\Vert\boldsymbol{\varepsilon}_t\Vert$çš„è¡°å‡å‡½æ•°å°±æ˜¯$\exp\left(-S_t\right)$ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¾$p_t = p_0\exp\left(-S_t\right)$ï¼Œä»£å…¥ä¸Šå¼å¾—åˆ°<br />
\begin{equation}\exp\left(-S_t\right) \approx \frac{1}{\alpha_0 p_0 \int_0^t \exp\left(-S</em>}\right) d\tau + 1}\end{equation<br />
è¿™æœ¬è´¨å°±æ˜¯ä¸€ä¸ªç®€å•çš„å¾®åˆ†æ–¹ç¨‹ï¼Œå®¹æ˜“è§£å¾—<br />
\begin{equation}\exp\left(-2S_t\right) \approx \frac{1}{2\alpha_0 p_0 t + 1}\end{equation}<br />
ä»£å…¥å¼$\eqref{eq:alpha-rho-2}$ä¹‹åï¼Œå¾—åˆ°<br />
\begin{equation}\alpha_t \approx \frac{\alpha_0\Vert\boldsymbol{\varepsilon}_0\Vert}{\Vert\boldsymbol{u}_t\Vert} \frac{1}{2\alpha_0 p_0 t + 1},\quad \rho_t \approx \frac{\alpha_0^2}{2q} \frac{1}{2\alpha_0 p_0 t + 1}\label{eq:alpha-rho-4}\end{equation}<br />
å•çœ‹è¡°å‡ç­–ç•¥ï¼Œè¿™æ­£å¥½æ˜¯â€œé€†æ—¶é—´è¡°å‡ï¼ˆInverse Time Decayï¼‰â€ï¼Œä¹Ÿæ˜¯å­¦ä¹ ç‡çš„å¸¸è§è¡°å‡ç­–ç•¥ä¹‹ä¸€ã€‚ç†è®ºä¸Šæ¥è¯´ï¼Œè¿™ä¸ªç»“æœåœ¨å‡è®¾ä¸Šæ¯”å‰é¢çš„å¼$\eqref{eq:alpha-rho-3}$æ›´ä¸ºåˆç†ã€‚</p>
<h2 id="_10">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡å€Ÿé‰´äº†Amosä¼˜åŒ–å™¨çš„æ€è·¯ï¼Œæ¨å¯¼äº†ä¸€äº›å…³äºå­¦ä¹ ç‡å’Œæƒé‡è¡°å‡ç‡çš„ç»“æœ$\eqref{eq:alpha-rho-3}$ã€$\eqref{eq:alpha-rho-4}$ï¼Œè¿™äº›ç»“æœå¯ä»¥å³æ’å³ç”¨åœ°åº”ç”¨åˆ°ç°æœ‰ä¼˜åŒ–å™¨ä¸­ï¼Œèƒ½ä¸€å®šç¨‹åº¦ä¸Šç®€åŒ–è°ƒå‚éš¾åº¦ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9344">https://spaces.ac.cn/archives/9344</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Nov. 22, 2022). ã€ŠåŸºäºAmosä¼˜åŒ–å™¨æ€æƒ³æ¨å¯¼å‡ºæ¥çš„ä¸€äº›â€œç‚¼ä¸¹ç­–ç•¥â€ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9344">https://spaces.ac.cn/archives/9344</a></p>
<p>@online{kexuefm-9344,<br />
title={åŸºäºAmosä¼˜åŒ–å™¨æ€æƒ³æ¨å¯¼å‡ºæ¥çš„ä¸€äº›â€œç‚¼ä¸¹ç­–ç•¥â€},<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={Nov},<br />
url={\url{https://spaces.ac.cn/archives/9344}},<br />
} </p>
<hr />
<h2 id="_11">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1-amos">1. AMOSä¼˜åŒ–å™¨çš„å®Œæ•´æ•°å­¦æ¨å¯¼</h3>
<h4 id="11">1.1 ä¼˜åŒ–é—®é¢˜çš„åŸºæœ¬è®¾ç½®</h4>
<p>æ·±åº¦å­¦ä¹ çš„ä¼˜åŒ–é—®é¢˜å¯ä»¥è¡¨è¿°ä¸ºï¼š</p>
<p>\begin{equation}
\min_{\boldsymbol{\theta}} \mathcal{L}(\boldsymbol{\theta}) = \mathbb{E}_{(\boldsymbol{x}, \boldsymbol{y}) \sim \mathcal{D}}[\ell(f(\boldsymbol{x}; \boldsymbol{\theta}), \boldsymbol{y})] \tag{1}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{\theta} \in \mathbb{R}^d$æ˜¯æ¨¡å‹å‚æ•°ï¼Œ$f$æ˜¯æ¨¡å‹å‡½æ•°ï¼Œ$\ell$æ˜¯æŸå¤±å‡½æ•°ã€‚</p>
<p><strong>è¿­ä»£æ›´æ–°çš„ä¸€èˆ¬å½¢å¼</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - \alpha_t \boldsymbol{u}_t \tag{2}
\end{equation}</p>
<p>å…¶ä¸­$\alpha_t &gt; 0$æ˜¯å­¦ä¹ ç‡ï¼Œ$\boldsymbol{u}_t$æ˜¯æ›´æ–°æ–¹å‘ã€‚</p>
<p><strong>åŠ å…¥æƒé‡è¡°å‡</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - (\alpha_t \boldsymbol{u}_t + \rho_t \boldsymbol{\theta}_t) \tag{3}
\end{equation}</p>
<p>å…¶ä¸­$\rho_t &gt; 0$æ˜¯æƒé‡è¡°å‡ç‡ã€‚</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šæƒé‡è¡°å‡é¡¹$\rho_t \boldsymbol{\theta}_t$å¼•å…¥å‘åŸç‚¹çš„æ‹‰åŠ›ï¼Œé˜²æ­¢å‚æ•°æ— é™å¢é•¿ï¼Œæä¾›æ­£åˆ™åŒ–æ•ˆæœã€‚</p>
<h4 id="12">1.2 å‚æ•°å°ºåº¦çš„å½±å“åˆ†æ</h4>
<p><strong>é—®é¢˜</strong>ï¼šä¸åŒå‚æ•°å…·æœ‰ä¸åŒçš„æ•°é‡çº§ï¼Œå¦‚ä½•è®¾ç½®ç»Ÿä¸€çš„å­¦ä¹ ç‡ï¼Ÿ</p>
<p>è€ƒè™‘ä¸¤ä¸ªå‚æ•°ï¼š
- $\theta_1$ï¼šåˆå§‹åŒ–ä¸º$\mathcal{N}(0, 0.01^2)$
- $\theta_2$ï¼šåˆå§‹åŒ–ä¸º$\mathcal{N}(0, 1^2)$</p>
<p>å¦‚æœä½¿ç”¨ç›¸åŒå­¦ä¹ ç‡$\alpha$ï¼Œåˆ™æ›´æ–°é‡ï¼š
\begin{equation}
\Delta\theta_1 \sim \mathcal{O}(\alpha \cdot 0.01), \quad \Delta\theta_2 \sim \mathcal{O}(\alpha \cdot 1) \tag{4}
\end{equation}</p>
<p>$\theta_2$çš„æ›´æ–°å¹…åº¦æ˜¯$\theta_1$çš„100å€ï¼</p>
<p><strong>è§£å†³æ€è·¯</strong>ï¼šå°†å­¦ä¹ ç‡åˆ†è§£ä¸ºå…¨å±€å­¦ä¹ ç‡å’Œå‚æ•°å°ºåº¦ï¼š</p>
<p>\begin{equation}
\alpha_t = \text{global_lr}_t \times \text{scale}(\boldsymbol{\theta}) \tag{5}
\end{equation}</p>
<h4 id="13">1.3 è·ç¦»æœ€ä¼˜ç‚¹çš„åº¦é‡</h4>
<p>å®šä¹‰å‚æ•°ä¸æœ€ä¼˜è§£çš„åå·®ï¼š</p>
<p>\begin{equation}
\boldsymbol{\varepsilon}_t = \boldsymbol{\theta}_t - \boldsymbol{\theta}^* \tag{6}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{\theta}^* = \arg\min_{\boldsymbol{\theta}} \mathcal{L}(\boldsymbol{\theta})$æ˜¯æœ€ä¼˜è§£ã€‚</p>
<p><strong>æ¬§æ°è·ç¦»</strong>ï¼š</p>
<p>\begin{equation}
d_t = |\boldsymbol{\varepsilon}_t| = |\boldsymbol{\theta}_t - \boldsymbol{\theta}^*| \tag{7}
\end{equation}</p>
<p><strong>ä¼˜åŒ–ç›®æ ‡</strong>ï¼šä½¿$d_t$éš$t$å•è°ƒé€’å‡ã€‚</p>
<h4 id="14">1.4 æ›´æ–°æ–¹ç¨‹çš„å±•å¼€</h4>
<p>å°†å¼(3)ä»£å…¥å¼(6)ï¼š</p>
<p>\begin{align}
\boldsymbol{\varepsilon}<em t_1="t+1">{t+1} &amp;= \boldsymbol{\theta}</em>^} - \boldsymbol{\theta<em> \tag{8} \
&amp;= \boldsymbol{\theta}_t - (\alpha_t \boldsymbol{u}_t + \rho_t \boldsymbol{\theta}_t) - \boldsymbol{\theta}^</em> \tag{9} \
&amp;= (1 - \rho_t)\boldsymbol{\theta}_t - \alpha_t \boldsymbol{u}_t - \boldsymbol{\theta}^<em> \tag{10} \
&amp;= (1 - \rho_t)(\boldsymbol{\varepsilon}_t + \boldsymbol{\theta}^</em>) - \alpha_t \boldsymbol{u}_t - \boldsymbol{\theta}^<em> \tag{11} \
&amp;= (1 - \rho_t)\boldsymbol{\varepsilon}_t - \alpha_t \boldsymbol{u}_t - \rho_t \boldsymbol{\theta}^</em> \tag{12}
\end{align}</p>
<p><strong>è·ç¦»å¹³æ–¹çš„å˜åŒ–</strong>ï¼š</p>
<p>\begin{align}
|\boldsymbol{\varepsilon}_{t+1}|^2 &amp;= |(1-\rho_t)\boldsymbol{\varepsilon}_t - \alpha_t \boldsymbol{u}_t - \rho_t \boldsymbol{\theta}^<em>|^2 \tag{13} \
&amp;= (1-\rho_t)^2|\boldsymbol{\varepsilon}_t|^2 + \alpha_t^2|\boldsymbol{u}_t|^2 + \rho_t^2|\boldsymbol{\theta}^</em>|^2 \tag{14} \
&amp;\quad - 2(1-\rho_t)\alpha_t \boldsymbol{\varepsilon}_t \cdot \boldsymbol{u}_t - 2(1-\rho_t)\rho_t \boldsymbol{\varepsilon}_t \cdot \boldsymbol{\theta}^<em> + 2\alpha_t\rho_t \boldsymbol{u}_t \cdot \boldsymbol{\theta}^</em> \tag{15}
\end{align}</p>
<p><strong>ä¸€é˜¶è¿‘ä¼¼</strong>ï¼ˆå¿½ç•¥$\mathcal{O}(\alpha_t^2)$å’Œ$\mathcal{O}(\rho_t^2)$é¡¹ï¼‰ï¼š</p>
<p>\begin{equation}
|\boldsymbol{\varepsilon}_{t+1}|^2 \approx |\boldsymbol{\varepsilon}_t|^2 - 2\alpha_t \boldsymbol{u}_t \cdot \boldsymbol{\varepsilon}_t + (\alpha_t^2|\boldsymbol{u}_t|^2 - 2\rho_t \boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t) \tag{16}
\end{equation}</p>
<p>å…¶ä¸­ä½¿ç”¨äº†$\boldsymbol{\theta}_t = \boldsymbol{\varepsilon}_t + \boldsymbol{\theta}^*$ã€‚</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼š
- $-2\alpha_t \boldsymbol{u}_t \cdot \boldsymbol{\varepsilon}_t$ï¼šæ›´æ–°é‡å¯¹æ”¶æ•›çš„è´¡çŒ®ï¼ˆå¯æ­£å¯è´Ÿï¼‰
- $\alpha_t^2|\boldsymbol{u}_t|^2$ï¼šæ›´æ–°æ­¥é•¿è¿‡å¤§çš„è´Ÿé¢å½±å“ï¼ˆæ€»æ˜¯æ­£ï¼‰
- $-2\rho_t \boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t$ï¼šæƒé‡è¡°å‡çš„è´¡çŒ®</p>
<h4 id="15">1.5 æƒé‡è¡°å‡çš„æœ€ä¼˜æ€§æ¡ä»¶</h4>
<p>ä¸ºä½¿æƒé‡è¡°å‡é¡¹èƒ½å¤ŸæŠµæ¶ˆæ­¥é•¿è¿‡å¤§çš„è´Ÿé¢å½±å“ï¼Œæˆ‘ä»¬å¸Œæœ›ï¼š</p>
<p>\begin{equation}
\alpha_t^2 |\boldsymbol{u}_t|^2 = 2\rho_t \boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t \tag{17}
\end{equation}</p>
<p><strong>å¯è¡Œæ€§åˆ†æ</strong>ï¼š</p>
<p>\begin{align}
\boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t &amp;= (\boldsymbol{\varepsilon}_t + \boldsymbol{\theta}^<em>) \cdot \boldsymbol{\varepsilon}_t \tag{18} \
&amp;= |\boldsymbol{\varepsilon}_t|^2 + \boldsymbol{\theta}^</em> \cdot \boldsymbol{\varepsilon}_t \tag{19}
\end{align}</p>
<p><strong>å…³é”®å‡è®¾</strong>ï¼ˆé«˜ç»´éšæœºå‘é‡è¿‘ä¼¼æ­£äº¤ï¼‰ï¼š</p>
<p>åœ¨é«˜ç»´ç©ºé—´ä¸­ï¼Œ$\boldsymbol{\theta}^*$å’Œ$\boldsymbol{\varepsilon}_t$è¿‘ä¼¼æ­£äº¤ï¼š</p>
<p>\begin{equation}
\boldsymbol{\theta}^* \cdot \boldsymbol{\varepsilon}_t \approx 0 \tag{20}
\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼šè®¾$\boldsymbol{\theta}^*, \boldsymbol{\varepsilon}_t \in \mathbb{R}^d$ï¼Œä¸”åˆ†é‡ç‹¬ç«‹åŒåˆ†å¸ƒã€‚å®ƒä»¬çš„å¤¹è§’$\phi$æ»¡è¶³ï¼š</p>
<p>\begin{equation}
\cos\phi = \frac{\boldsymbol{\theta}^<em> \cdot \boldsymbol{\varepsilon}_t}{|\boldsymbol{\theta}^</em>| |\boldsymbol{\varepsilon}_t|} \tag{21}
\end{equation}</p>
<p>å½“$d \to \infty$æ—¶ï¼Œ$\cos\phi \to 0$ï¼Œå³$\phi \to \pi/2$ï¼ˆå‚è§ã€Šnç»´ç©ºé—´ä¸‹ä¸¤ä¸ªéšæœºå‘é‡çš„å¤¹è§’åˆ†å¸ƒã€‹ï¼‰ã€‚</p>
<p><strong>å¼•å…¥ä¿®æ­£å‚æ•°</strong>$q$ï¼š</p>
<p>\begin{equation}
\boldsymbol{\theta}_t \cdot \boldsymbol{\varepsilon}_t \approx q|\boldsymbol{\varepsilon}_t|^2, \quad q \approx 1 \tag{22}
\end{equation}</p>
<p>å¼(17)å˜ä¸ºï¼š</p>
<p>\begin{equation}
\alpha_t^2 |\boldsymbol{u}_t|^2 \approx 2\rho_t q |\boldsymbol{\varepsilon}_t|^2 \tag{23}
\end{equation}</p>
<p>ä¸¤è¾¹éƒ½å¤§äº0ï¼Œå› æ­¤å¼(17)å¯è¡Œã€‚</p>
<h4 id="16">1.6 æ›´æ–°æ–¹å‘çš„æ•ˆç‡åˆ†æ</h4>
<p>å‡è®¾æ›´æ–°æ–¹å‘$\boldsymbol{u}_t$å¹³å‡è€Œè¨€æŒ‡å‘æœ€ä¼˜ç‚¹ï¼Œå¼•å…¥æ•ˆç‡å‚æ•°$p &gt; 0$ï¼š</p>
<p>\begin{equation}
\boldsymbol{u}_t \cdot \boldsymbol{\varepsilon}_t \approx p |\boldsymbol{u}_t| |\boldsymbol{\varepsilon}_t| \tag{24}
\end{equation}</p>
<p>å³$\cos(\boldsymbol{u}_t, \boldsymbol{\varepsilon}_t) \approx p$ã€‚</p>
<p><strong>ç‰©ç†æ„ä¹‰</strong>ï¼š$p$è¡¨ç¤ºæ›´æ–°æ–¹å‘ä¸æœ€ä¼˜æ–¹å‘çš„å¯¹é½ç¨‹åº¦ã€‚
- $p = 1$ï¼šå®Œç¾å¯¹é½
- $p = 0$ï¼šå‚ç›´
- $p &lt; 0$ï¼šåå‘ï¼ˆä¸æ”¶æ•›ï¼‰</p>
<p>ä»£å…¥å¼(16)ï¼Œåœ¨å¼(17)æˆç«‹æ—¶ï¼š</p>
<p>\begin{align}
|\boldsymbol{\varepsilon}_{t+1}|^2 &amp;\approx |\boldsymbol{\varepsilon}_t|^2 - 2\alpha_t p |\boldsymbol{u}_t| |\boldsymbol{\varepsilon}_t| \tag{25} \
&amp;= |\boldsymbol{\varepsilon}_t|^2 - 2\alpha_t p |\boldsymbol{u}_t| |\boldsymbol{\varepsilon}_t| \tag{26}
\end{align}</p>
<p>ä»å¼(23)ï¼š</p>
<p>\begin{equation}
\alpha_t |\boldsymbol{u}_t| = \sqrt{2\rho_t q} |\boldsymbol{\varepsilon}_t| \tag{27}
\end{equation}</p>
<p>ä»£å…¥å¼(26)ï¼š</p>
<p>\begin{align}
|\boldsymbol{\varepsilon}_{t+1}|^2 &amp;\approx |\boldsymbol{\varepsilon}_t|^2 - 2p\sqrt{2\rho_t q} |\boldsymbol{\varepsilon}_t|^2 \tag{28} \
&amp;= |\boldsymbol{\varepsilon}_t|^2(1 - 2p\sqrt{2\rho_t q}) \tag{29} \
&amp;\approx |\boldsymbol{\varepsilon}_t|^2 \exp(-2p\sqrt{2\rho_t q}) \tag{30}
\end{align}</p>
<p>å…¶ä¸­ä½¿ç”¨äº†$1 - x \approx e^{-x}$ï¼ˆå½“$x$å¾ˆå°æ—¶ï¼‰ã€‚</p>
<p><strong>é€’æ¨æ±‚è§£</strong>ï¼š</p>
<p>\begin{align}
|\boldsymbol{\varepsilon}<em t-1="t-1">t|^2 &amp;\approx |\boldsymbol{\varepsilon}</em> \
&amp;\approx |\boldsymbol{\varepsilon}}|^2 \exp(-2p\sqrt{2\rho_{t-1} q}) \tag{31<em i="0">0|^2 \exp\left(-2p\sum</em> \
&amp;= |\boldsymbol{\varepsilon}_0|^2 \exp(-2pS_t) \tag{33}
\end{align}}^{t-1}\sqrt{2\rho_i q}\right) \tag{32</p>
<p>å…¶ä¸­å®šä¹‰ï¼š</p>
<p>\begin{equation}
S_t = \sum_{i=0}^{t-1}\sqrt{2\rho_i q} \tag{34}
\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šè·ç¦»ä»¥æŒ‡æ•°é€Ÿç‡è¡°å‡ï¼Œè¡°å‡é€Ÿåº¦ç”±ç´¯ç§¯å’Œ$S_t$æ§åˆ¶ã€‚</p>
<h4 id="17">1.7 å­¦ä¹ ç‡å’Œæƒé‡è¡°å‡ç‡çš„è”åˆæ¨å¯¼</h4>
<p>ä»å¼(23)ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæœªçŸ¥æ•°$\alpha_t$å’Œ$\rho_t$ï¼Œä½†åªæœ‰ä¸€ä¸ªç­‰å¼ã€‚ä¸ºäº†ç¡®å®šä¸¤è€…ï¼Œå¼•å…¥é¢å¤–çº¦æŸã€‚</p>
<p><strong>ç­–ç•¥1ï¼šå›ºå®šæ¯”ä¾‹å…³ç³»</strong></p>
<p>è®¾ï¼š
\begin{equation}
2\rho_t q = \lambda^2 |\boldsymbol{\varepsilon}_t|^2 \tag{35}
\end{equation}</p>
<p>å…¶ä¸­$\lambda &gt; 0$æ˜¯å¸¸æ•°ã€‚è¿™ä¿è¯äº†$\alpha_t$å’Œ$\rho_t$ä»¥ç›¸åŒé€Ÿåº¦è¡°å‡ã€‚</p>
<p>ä»å¼(23)å’Œå¼(35)ï¼š</p>
<p>\begin{align}
\alpha_t^2 |\boldsymbol{u}_t|^2 &amp;= \lambda^2 |\boldsymbol{\varepsilon}_t|^4 \tag{36} \
\alpha_t &amp;= \frac{\lambda |\boldsymbol{\varepsilon}_t|^2}{|\boldsymbol{u}_t|} \tag{37}
\end{align}</p>
<p>ä»å¼(32)å’Œå¼(35)ï¼š</p>
<p>\begin{align}
\rho_t &amp;= \frac{\lambda^2 |\boldsymbol{\varepsilon}_t|^2}{2q} \tag{38} \
&amp;= \frac{\lambda^2 |\boldsymbol{\varepsilon}_0|^2}{2q} \exp(-2pS_t) \tag{39}
\end{align}</p>
<p>åŒæ ·ï¼Œä»å¼(37)ï¼š</p>
<p>\begin{equation}
\alpha_t = \frac{\lambda |\boldsymbol{\varepsilon}_0|^2}{|\boldsymbol{u}_t|} \exp(-2pS_t) \tag{40}
\end{equation}</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼š$\alpha_t$å’Œ$\rho_t$éƒ½åŒ…å«è¡°å‡å› å­$\exp(-2pS_t)$ã€‚</p>
<h4 id="18">1.8 å‚æ•°åˆå§‹åŒ–å°ºåº¦çš„ä¼°è®¡</h4>
<p><strong>å¯¹äºçŸ©é˜µä¹˜æ³•æ ¸</strong>ï¼ˆå…¨è¿æ¥å±‚ã€å·ç§¯å±‚ï¼‰ï¼š</p>
<p>Xavier/Heåˆå§‹åŒ–ï¼š</p>
<p>\begin{equation}
\boldsymbol{\theta}<em in="in">0 \sim \mathcal{N}(0, \sigma^2 I), \quad \sigma^2 = \frac{c}{n</em>
\end{equation}}} \tag{41</p>
<p>å…¶ä¸­$n_{in}$æ˜¯è¾“å…¥ç»´åº¦ï¼Œ$c$æ˜¯å¸¸æ•°ï¼ˆXavier: $c=1$, He: $c=2$ï¼‰ã€‚</p>
<p><strong>æœŸæœ›æ¨¡é•¿</strong>ï¼š</p>
<p>\begin{align}
\mathbb{E}[|\boldsymbol{\theta}<em i="1">0|^2] &amp;= \mathbb{E}\left[\sum</em> \
&amp;= k\sigma^2 = \frac{ck}{n_{in}} \tag{43}
\end{align}}^k \theta_{0,i}^2\right] \tag{42</p>
<p><strong>è®­ç»ƒåçš„å‚æ•°å°ºåº¦</strong>ï¼š</p>
<p>åˆç†åˆå§‹åŒ–ä¸‹ï¼Œè®­ç»ƒåå‚æ•°çš„é‡çº§ä¸å˜ï¼ˆè‡³å°‘åœ¨åŒä¸€æ•°é‡çº§ï¼‰ï¼š</p>
<p>\begin{equation}
|\boldsymbol{\theta}^*|^2 \approx k\sigma^2 \tag{44}
\end{equation}</p>
<p><strong>åˆå§‹åå·®çš„ä¼°è®¡</strong>ï¼š</p>
<p>å› ä¸º$\boldsymbol{\theta}_0$å’Œ$\boldsymbol{\theta}^<em>$ç‹¬ç«‹ï¼ˆåˆå§‹åŒ–éšæœºï¼‰ï¼Œ$\boldsymbol{\theta}_0 \cdot \boldsymbol{\theta}^</em> \approx 0$ï¼š</p>
<p>\begin{align}
|\boldsymbol{\varepsilon}_0|^2 &amp;= |\boldsymbol{\theta}_0 - \boldsymbol{\theta}^<em>|^2 \tag{45} \
&amp;= |\boldsymbol{\theta}_0|^2 + |\boldsymbol{\theta}^</em>|^2 - 2\boldsymbol{\theta}_0 \cdot \boldsymbol{\theta}^* \tag{46} \
&amp;\approx 2k\sigma^2 \tag{47}
\end{align}</p>
<p>å› æ­¤ï¼š</p>
<p>\begin{equation}
|\boldsymbol{\varepsilon}<em RMS="RMS">0| \approx \sqrt{2k}\sigma = \sqrt{2}|\boldsymbol{\theta}_0|</em>
\end{equation}} \tag{48</p>
<p>å…¶ä¸­RMSï¼ˆRoot Mean Squareï¼‰å®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
|\boldsymbol{\theta}|<em i="1">{RMS} = \sqrt{\frac{|\boldsymbol{\theta}|^2}{k}} = \sqrt{\frac{1}{k}\sum</em>
\end{equation}}^k \theta_i^2} \tag{49</p>
<p><strong>å¯¹äºåç½®é¡¹å’Œå½’ä¸€åŒ–å‚æ•°</strong>ï¼š</p>
<p><strong>Biaså‘é‡</strong>ï¼šé€šå¸¸å…¨é›¶åˆå§‹åŒ–ï¼Œ$\boldsymbol{\theta}_0 = \boldsymbol{0}$</p>
<p>\begin{equation}
|\boldsymbol{\varepsilon}_0| = |\boldsymbol{\theta}^*| \tag{50}
\end{equation}</p>
<p>æ ¹æ®ç»éªŒï¼Œè®­ç»ƒååç½®é¡¹åœ¨$\pm 0.5$èŒƒå›´å†…ï¼š</p>
<p>\begin{equation}
|\boldsymbol{\theta}^*| \approx \sqrt{k} \times 0.5 \tag{51}
\end{equation}</p>
<p><strong>Normalizationçš„$\gamma$å‚æ•°</strong>ï¼šé€šå¸¸å…¨1åˆå§‹åŒ–ï¼Œè®­ç»ƒååœ¨1é™„è¿‘æ³¢åŠ¨ï¼š</p>
<p>\begin{equation}
|\boldsymbol{\varepsilon}_0| \approx \sqrt{k} \times 0.5 \tag{52}
\end{equation}</p>
<h4 id="19">1.9 å­¦ä¹ ç‡çš„å°ºåº¦åˆ†ç¦»</h4>
<p>ä»å¼(40)ï¼š</p>
<p>\begin{equation}
\alpha_t = \frac{\lambda |\boldsymbol{\varepsilon}_0|^2}{|\boldsymbol{u}_t|} \exp(-2pS_t) \tag{53}
\end{equation}</p>
<p>åˆ†è§£ä¸ºï¼š</p>
<p>\begin{equation}
\alpha_t = \alpha_0 \times |\boldsymbol{\varepsilon}_0| \times \frac{\exp(-2pS_t)}{|\boldsymbol{u}_t|/|\boldsymbol{\varepsilon}_0|} \tag{54}
\end{equation}</p>
<p>å…¶ä¸­$\alpha_0 = \lambda |\boldsymbol{\varepsilon}_0|$æ˜¯åˆå§‹å­¦ä¹ ç‡ã€‚</p>
<p><strong>ç®€åŒ–å‡è®¾</strong>ï¼šå‡è®¾$|\boldsymbol{u}_t| \approx \text{const}$ï¼ˆä¸å‚æ•°å°ºåº¦æ— å…³ï¼‰ï¼Œåˆ™ï¼š</p>
<p>\begin{equation}
\alpha_t \propto |\boldsymbol{\varepsilon}_0| \times \text{decay}(t) \tag{55}
\end{equation}</p>
<p><strong>å®è·µä¸­çš„è¿‘ä¼¼</strong>ï¼šç”¨å½“å‰å‚æ•°çš„RMSä»£æ›¿$|\boldsymbol{\varepsilon}_0|$ï¼š</p>
<p>\begin{equation}
\alpha_t = \alpha_0^{global} \times \text{RMS}(\boldsymbol{\theta}_{t-1}) \times \text{schedule}(t) \tag{56}
\end{equation}</p>
<p>å…¶ä¸­ï¼š
- $\alpha_0^{global}$ï¼šå…¨å±€ç›¸å¯¹å­¦ä¹ ç‡ï¼ˆå¦‚$10^{-3}$ï¼‰
- $\text{RMS}(\boldsymbol{\theta}_{t-1})$ï¼šå‚æ•°å°ºåº¦è‡ªé€‚åº”
- $\text{schedule}(t)$ï¼šå­¦ä¹ ç‡è¡°å‡ç­–ç•¥</p>
<p><strong>å¯¹äºåç½®å’Œå½’ä¸€åŒ–å‚æ•°</strong>ï¼š</p>
<p>è¿™äº›å‚æ•°é€šå¸¸ä¸è¿›è¡ŒçŸ©é˜µä¹˜æ³•ï¼Œå°ºåº¦çº¦ä¸º$\mathcal{O}(1)$ï¼Œç›´æ¥ä½¿ç”¨ï¼š</p>
<p>\begin{equation}
\alpha_t = \alpha_0^{global} \times 0.5 \times \text{schedule}(t) \tag{57}
\end{equation}</p>
<p>å› å­0.5æ˜¯ç»éªŒé€‰æ‹©ï¼Œç¡®ä¿è¿™äº›å‚æ•°ä¸ä¼šæ›´æ–°è¿‡å¿«ã€‚</p>
<h4 id="110">1.10 æƒé‡è¡°å‡ç‡çš„ç¡®å®š</h4>
<p>ä»å¼(39)ï¼š</p>
<p>\begin{equation}
\rho_t = \frac{\lambda^2 |\boldsymbol{\varepsilon}_0|^2}{2q} \exp(-2pS_t) \tag{58}
\end{equation}</p>
<p>è®¾$\lambda = \alpha_0 / |\boldsymbol{\varepsilon}_0|$ï¼ˆä»$\alpha_0 = \lambda |\boldsymbol{\varepsilon}_0|$ï¼‰ï¼Œåˆ™ï¼š</p>
<p>\begin{equation}
\rho_t = \frac{\alpha_0^2}{2q} \exp(-2pS_t) \tag{59}
\end{equation}</p>
<p><strong>è§‚å¯Ÿ</strong>ï¼š$\rho_t$ä¸å‚æ•°å°ºåº¦æ— å…³ï¼è¿™æ˜¯ç†è®ºä¸Šçš„ä¼˜é›…æ€§è´¨ã€‚</p>
<p><strong>å®è·µç®€åŒ–</strong>ï¼šå¸¸æ•°æƒé‡è¡°å‡ç‡</p>
<p>ç”±äº$\exp(-2pS_t)$è¡°å‡è¾ƒæ…¢ï¼Œå®è·µä¸­å¸¸ç”¨å¸¸æ•°ï¼š</p>
<p>\begin{equation}
\rho = \frac{\alpha_0^2}{2q} \tag{60}
\end{equation}</p>
<p>è®¾$q = 1$ï¼Œ$\alpha_0 = 0.001$ï¼š</p>
<p>\begin{equation}
\rho = \frac{(0.001)^2}{2} = 5 \times 10^{-7} \tag{61}
\end{equation}</p>
<p>ä½†è¿™å¤ªå°äº†ã€‚æ›´å¸¸è§çš„æ˜¯ç›´æ¥é€‰æ‹©$\rho = 0.01$ï¼ˆç»éªŒå€¼ï¼‰ã€‚</p>
<p><strong>å¯¹ä¸åŒå‚æ•°ç±»å‹</strong>ï¼š</p>
<p>\begin{equation}
\rho = \begin{cases}
0.01, &amp; \text{kernel matrices} \
0, &amp; \text{bias, beta, gamma}
\end{cases} \tag{62}
\end{equation}</p>
<p><strong>ç†è®ºè§£é‡Š</strong>ï¼šä»è´å¶æ–¯è§†è§’ï¼Œæƒé‡è¡°å‡å¯¹åº”é«˜æ–¯å…ˆéªŒ$\mathcal{N}(0, \sigma^2)$ï¼Œæƒé‡è¡°å‡ç‡$\rho \propto 1/\sigma^2$ã€‚åç½®å’Œå½’ä¸€åŒ–å‚æ•°çš„æ–¹å·®è¾ƒå¤§ï¼ˆå…ˆéªŒæ›´å®½æ¾ï¼‰ï¼Œå› æ­¤æƒé‡è¡°å‡ç‡åº”æ›´å°æˆ–ä¸ºé›¶ã€‚</p>
<h4 id="111">1.11 è¡°å‡ç­–ç•¥çš„å¾®åˆ†æ–¹ç¨‹æ¨å¯¼</h4>
<p>å®šä¹‰ç´¯ç§¯å’Œï¼š</p>
<p>\begin{equation}
S_t = \sum_{i=0}^{t-1}\sqrt{2\rho_i q} \tag{63}
\end{equation}</p>
<p>ä»å¼(59)ï¼Œä¸¤è¾¹å¼€å¹³æ–¹ï¼š</p>
<p>\begin{equation}
\sqrt{2\rho_t q} = \alpha_0 \sqrt{\frac{q}{2}} \exp(-pS_t) \tag{64}
\end{equation}</p>
<p><strong>å·®åˆ†æ–¹ç¨‹</strong>ï¼š</p>
<p>\begin{equation}
S_{t+1} - S_t = \alpha_0 \sqrt{\frac{q}{2}} \exp(-pS_t) \tag{65}
\end{equation}</p>
<p><strong>è¿ç»­è¿‘ä¼¼</strong>ï¼ˆ$t$å¾ˆå¤§æ—¶ï¼Œç”¨å¾®åˆ†ä»£æ›¿å·®åˆ†ï¼‰ï¼š</p>
<p>\begin{equation}
\frac{dS}{dt} = \alpha_0 \sqrt{\frac{q}{2}} \exp(-pS) \tag{66}
\end{equation}</p>
<p><strong>åˆ†ç¦»å˜é‡æ±‚è§£</strong>ï¼š</p>
<p>\begin{align}
\exp(pS) dS &amp;= \alpha_0 \sqrt{\frac{q}{2}} dt \tag{67} \
\int \exp(pS) dS &amp;= \alpha_0 \sqrt{\frac{q}{2}} \int dt \tag{68} \
\frac{1}{p}\exp(pS) &amp;= \alpha_0 \sqrt{\frac{q}{2}} t + C \tag{69}
\end{align}</p>
<p>åˆå§‹æ¡ä»¶$S_0 = 0$ï¼Œå¾—$C = 1/p$ï¼š</p>
<p>\begin{equation}
\exp(pS) = 1 + \alpha_0 p\sqrt{\frac{q}{2}} t \tag{70}
\end{equation}</p>
<p>å› æ­¤ï¼š</p>
<p>\begin{equation}
S_t = \frac{1}{p}\log\left(1 + \alpha_0 p\sqrt{\frac{q}{2}} t\right) \tag{71}
\end{equation}</p>
<p><strong>è¡°å‡å› å­</strong>ï¼š</p>
<p>\begin{equation}
\exp(-2pS_t) = \frac{1}{\left(1 + \alpha_0 p\sqrt{\frac{q}{2}} t\right)^2} \tag{72}
\end{equation}</p>
<p><strong>ç®€åŒ–</strong>ï¼šè®¾$\sqrt{q/2} = 1$ï¼ˆå³$q = 2$ï¼‰ï¼Œå®šä¹‰$\tilde{p} = \alpha_0 p$ï¼š</p>
<p>\begin{equation}
\exp(-2pS_t) = \frac{1}{(1 + \tilde{p}t)^2} \tag{73}
\end{equation}</p>
<p><strong>æœ€ç»ˆå­¦ä¹ ç‡å’Œæƒé‡è¡°å‡ç‡</strong>ï¼š</p>
<p>\begin{align}
\alpha_t &amp;\approx \frac{\alpha_0 |\boldsymbol{\varepsilon}_0|}{(1 + \tilde{p}t)^2} \tag{74} \
\rho_t &amp;\approx \frac{\alpha_0^2}{2q(1 + \tilde{p}t)^2} \tag{75}
\end{align}</p>
<p>è¿™æ˜¯<strong>å¹³æ–¹åæ¯”è¡°å‡</strong>ç­–ç•¥ã€‚</p>
<h4 id="112">1.12 åŠ¨æ€æ”¶æ•›é€Ÿåº¦çš„æ¨å¹¿</h4>
<p>å‰é¢å‡è®¾$p$æ˜¯å¸¸æ•°ï¼Œä½†å®é™…ä¸Šæ”¶æ•›é€Ÿåº¦å¯èƒ½éšæ—¶é—´å˜åŒ–ã€‚</p>
<p><strong>å‡è®¾</strong>ï¼š$p = p_t = p_0 \exp(-S_t)$</p>
<p>ç‰©ç†æ„ä¹‰ï¼šè¶Šæ¥è¿‘æœ€ä¼˜ç‚¹ï¼Œæ”¶æ•›è¶Šæ…¢ã€‚</p>
<p><strong>æ–°çš„å¾®åˆ†æ–¹ç¨‹</strong>ï¼š</p>
<p>\begin{equation}
\frac{dS}{dt} = \alpha_0 \sqrt{\frac{q}{2}} p_t \exp(-S) = \alpha_0 \sqrt{\frac{q}{2}} p_0 \exp(-2S) \tag{76}
\end{equation}</p>
<p><strong>åˆ†ç¦»å˜é‡</strong>ï¼š</p>
<p>\begin{align}
\exp(2S) dS &amp;= \alpha_0 \sqrt{\frac{q}{2}} p_0 dt \tag{77} \
\int \exp(2S) dS &amp;= \alpha_0 \sqrt{\frac{q}{2}} p_0 \int dt \tag{78} \
\frac{1}{2}\exp(2S) &amp;= \alpha_0 \sqrt{\frac{q}{2}} p_0 t + C \tag{79}
\end{align}</p>
<p>åˆå§‹æ¡ä»¶$S_0 = 0$ï¼Œå¾—$C = 1/2$ï¼š</p>
<p>\begin{equation}
\exp(2S) = 1 + 2\alpha_0 \sqrt{\frac{q}{2}} p_0 t \tag{80}
\end{equation}</p>
<p><strong>è¡°å‡å› å­</strong>ï¼š</p>
<p>\begin{equation}
\exp(-2S_t) = \frac{1}{1 + 2\alpha_0 \sqrt{q/2} p_0 t} \tag{81}
\end{equation}</p>
<p><strong>ç®€åŒ–</strong>ï¼ˆ$q = 2, p_0 = p$ï¼‰ï¼š</p>
<p>\begin{equation}
\exp(-2S_t) = \frac{1}{1 + 2\alpha_0 p t} \tag{82}
\end{equation}</p>
<p>è¿™æ˜¯<strong>é€†æ—¶é—´è¡°å‡</strong>ç­–ç•¥ã€‚</p>
<p><strong>æœ€ç»ˆå…¬å¼</strong>ï¼š</p>
<p>\begin{align}
\alpha_t &amp;\approx \frac{\alpha_0 |\boldsymbol{\varepsilon}_0|}{1 + 2\alpha_0 p t} \tag{83} \
\rho_t &amp;\approx \frac{\alpha_0^2}{2(1 + 2\alpha_0 p t)} \tag{84}
\end{align}</p>
<h4 id="113">1.13 å­¦ä¹ ç‡è¡°å‡ç­–ç•¥çš„å¯¹æ¯”</h4>
<p><strong>å¸¸æ•°å­¦ä¹ ç‡</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t = \alpha_0 \tag{85}
\end{equation}</p>
<p>æ”¶æ•›ç‡ï¼š$\mathcal{O}(1/T)$ï¼ˆå‡¸ä¼˜åŒ–ï¼‰</p>
<p><strong>çº¿æ€§è¡°å‡</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t = \alpha_0\left(1 - \frac{t}{T}\right) \tag{86}
\end{equation}</p>
<p>æ”¶æ•›ç‡ï¼š$\mathcal{O}(1/T)$</p>
<p><strong>å¹³æ–¹åæ¯”è¡°å‡</strong>ï¼ˆå¼73æ¨å¯¼ï¼‰ï¼š</p>
<p>\begin{equation}
\alpha_t = \frac{\alpha_0}{(1 + kt)^2} \tag{87}
\end{equation}</p>
<p>æ”¶æ•›ç‡ï¼š$\mathcal{O}(\log T / T)$</p>
<p><strong>é€†æ—¶é—´è¡°å‡</strong>ï¼ˆå¼82æ¨å¯¼ï¼‰ï¼š</p>
<p>\begin{equation}
\alpha_t = \frac{\alpha_0}{1 + kt} \tag{88}
\end{equation}</p>
<p>æ”¶æ•›ç‡ï¼š$\mathcal{O}(\log T / T)$</p>
<p><strong>ä½™å¼¦é€€ç«</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t = \alpha_{min} + \frac{1}{2}(\alpha_0 - \alpha_{min})\left(1 + \cos\frac{\pi t}{T}\right) \tag{89}
\end{equation}</p>
<p>æ”¶æ•›ç‡ï¼š$\mathcal{O}(1/T)$</p>
<p><strong>æŒ‡æ•°è¡°å‡</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t = \alpha_0 \gamma^t, \quad 0 &lt; \gamma &lt; 1 \tag{90}
\end{equation}</p>
<p>æ”¶æ•›ç‡ï¼š$\mathcal{O}(1/T)$ï¼ˆå¦‚æœ$\gamma$é€‰æ‹©å¾—å½“ï¼‰</p>
<p><strong>æ•°å€¼å¯¹æ¯”ç¤ºä¾‹</strong>ï¼š</p>
<p>è®¾$\alpha_0 = 0.1$ï¼Œ$T = 1000$ï¼Œ$k = 0.001$ï¼š</p>
<table>
<thead>
<tr>
<th>$t$</th>
<th>å¸¸æ•°</th>
<th>çº¿æ€§è¡°å‡</th>
<th>å¹³æ–¹åæ¯”</th>
<th>é€†æ—¶é—´</th>
<th>ä½™å¼¦é€€ç«</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>0.100</td>
<td>0.100</td>
<td>0.100</td>
<td>0.100</td>
<td>0.100</td>
</tr>
<tr>
<td>100</td>
<td>0.100</td>
<td>0.090</td>
<td>0.083</td>
<td>0.091</td>
<td>0.095</td>
</tr>
<tr>
<td>500</td>
<td>0.100</td>
<td>0.050</td>
<td>0.027</td>
<td>0.040</td>
<td>0.050</td>
</tr>
<tr>
<td>900</td>
<td>0.100</td>
<td>0.010</td>
<td>0.012</td>
<td>0.053</td>
<td>0.005</td>
</tr>
<tr>
<td>1000</td>
<td>0.100</td>
<td>0.000</td>
<td>0.010</td>
<td>0.050</td>
<td>0.000</td>
</tr>
</tbody>
</table>
<p><strong>è§‚å¯Ÿ</strong>ï¼š
- å¹³æ–¹åæ¯”å’Œé€†æ—¶é—´è¡°å‡è¾ƒå¹³æ»‘
- çº¿æ€§å’Œä½™å¼¦åœ¨è®­ç»ƒæœ«æœŸå­¦ä¹ ç‡æ¥è¿‘é›¶
- å¸¸æ•°å­¦ä¹ ç‡ä¸è¡°å‡ï¼Œå¯èƒ½ä¸æ”¶æ•›åˆ°ç²¾ç¡®æœ€ä¼˜</p>
<h4 id="114-warmup">1.14 Warmupç­–ç•¥çš„ç†è®ºåˆ†æ</h4>
<p><strong>Warmup</strong>ï¼šåœ¨è®­ç»ƒåˆæœŸé€æ¸å¢å¤§å­¦ä¹ ç‡ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨è¾ƒå¤§å­¦ä¹ ç‡ã€‚</p>
<p><strong>åŠ¨æœº1ï¼šé¿å…åˆæœŸæ¢¯åº¦çˆ†ç‚¸</strong></p>
<p>åœ¨éšæœºåˆå§‹åŒ–ä¸‹ï¼ŒåˆæœŸæ¢¯åº¦å¯èƒ½å¾ˆå¤§ä¸”ä¸ç¨³å®šã€‚å°å­¦ä¹ ç‡å¯ä»¥é¿å…å‚æ•°è·³å‡ºåˆç†åŒºåŸŸã€‚</p>
<p><strong>åŠ¨æœº2ï¼šæ‰¹å½’ä¸€åŒ–çš„ç»Ÿè®¡é‡ä¼°è®¡</strong></p>
<p>Batch Normalizationéœ€è¦ä¼°è®¡å‡å€¼å’Œæ–¹å·®ï¼ŒåˆæœŸä¼°è®¡ä¸å‡†ç¡®ï¼Œå°å­¦ä¹ ç‡å¯ä»¥ç»™è¶³å¤Ÿæ—¶é—´è®©ç»Ÿè®¡é‡ç¨³å®šã€‚</p>
<p><strong>çº¿æ€§Warmup</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t^{warmup} = \alpha_0 \times \min\left(1, \frac{t}{T_{warmup}}\right) \tag{91}
\end{equation}</p>
<p><strong>å¹³æ–¹Warmup</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t^{warmup} = \alpha_0 \times \min\left(1, \left(\frac{t}{T_{warmup}}\right)^2\right) \tag{92}
\end{equation}</p>
<p><strong>æŒ‡æ•°Warmup</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t^{warmup} = \alpha_0 \times \min\left(1, \exp\left(\frac{t - T_{warmup}}{\tau}\right)\right) \tag{93}
\end{equation}</p>
<p><strong>å®Œæ•´Schedule</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t = \begin{cases}
\alpha_t^{warmup}, &amp; t \leq T_{warmup} \
\alpha_t^{decay}, &amp; t &gt; T_{warmup}
\end{cases} \tag{94}
\end{equation}</p>
<p><strong>æ•°å€¼ç¤ºä¾‹</strong>ï¼š</p>
<p>BERTé¢„è®­ç»ƒï¼š$T_{warmup} = 10000$ï¼Œ$T_{total} = 1000000$</p>
<p>\begin{align}
\alpha_t &amp;= 0.001 \times \min\left(1, \frac{t}{10000}\right) \times \left(1 - \frac{t}{1000000}\right) \tag{95} \
&amp;= \begin{cases}
10^{-7} t, &amp; t \leq 10000 \
0.001 \times (1 - t/1000000), &amp; t &gt; 10000
\end{cases} \tag{96}
\end{align}</p>
<h4 id="115-adamw">1.15 AdamWçš„å®Œæ•´æ›´æ–°è§„åˆ™å›é¡¾</h4>
<p><strong>AdamW</strong>ï¼ˆå¸¦è§£è€¦æƒé‡è¡°å‡çš„Adamï¼‰ï¼š</p>
<p>\begin{align}
\boldsymbol{m}<em t-1="t-1">t &amp;= \beta_1 \boldsymbol{m}</em>} + (1 - \beta_1)\boldsymbol{g<em t-1="t-1">t \tag{97} \
\boldsymbol{v}_t &amp;= \beta_2 \boldsymbol{v}</em>} + (1 - \beta_2)\boldsymbol{g<em t-1="t-1">t^2 \tag{98} \
\hat{\boldsymbol{m}}_t &amp;= \frac{\boldsymbol{m}_t}{1 - \beta_1^t} \tag{99} \
\hat{\boldsymbol{v}}_t &amp;= \frac{\boldsymbol{v}_t}{1 - \beta_2^t} \tag{100} \
\boldsymbol{u}_t &amp;= \frac{\hat{\boldsymbol{m}}_t}{\sqrt{\hat{\boldsymbol{v}}_t} + \epsilon} \tag{101} \
\boldsymbol{\theta}_t &amp;= \boldsymbol{\theta}</em>} - (\alpha_t \boldsymbol{u<em t-1="t-1">t + \lambda \boldsymbol{\theta}</em>
\end{align}}) \tag{102</p>
<p><strong>AMOSçš„æ”¹è¿›</strong>ï¼š</p>
<ol>
<li>
<p><strong>å°ºåº¦è‡ªé€‚åº”å­¦ä¹ ç‡</strong>ï¼š
   \begin{equation}
   \alpha_t = \alpha_0^{global} \times \text{RMS}(\boldsymbol{\theta}_{t-1}) \times \text{schedule}(t) \tag{103}
   \end{equation}</p>
</li>
<li>
<p><strong>è‡ªé€‚åº”æƒé‡è¡°å‡ç‡</strong>ï¼š
   \begin{equation}
   \lambda_t = \frac{\alpha_0^2}{2(1 + kt)} \tag{104}
   \end{equation}</p>
</li>
<li>
<p><strong>å»é™¤äºŒé˜¶çŸ©ä¼°è®¡</strong>ï¼ˆå¯é€‰ï¼ŒèŠ‚çœæ˜¾å­˜ï¼‰ï¼š
   \begin{equation}
   \boldsymbol{u}_t = \hat{\boldsymbol{m}}_t \tag{105}
   \end{equation}</p>
</li>
</ol>
<h4 id="116">1.16 æ˜¾å­˜ä¼˜åŒ–ï¼šå»é™¤äºŒé˜¶çŸ©</h4>
<p><strong>æ ‡å‡†AdamWæ˜¾å­˜</strong>ï¼š
- å‚æ•°ï¼š$\boldsymbol{\theta}$ï¼ˆ$d$ç»´ï¼‰
- ä¸€é˜¶çŸ©ï¼š$\boldsymbol{m}$ï¼ˆ$d$ç»´ï¼‰
- äºŒé˜¶çŸ©ï¼š$\boldsymbol{v}$ï¼ˆ$d$ç»´ï¼‰
- æ€»è®¡ï¼š$3d$</p>
<p><strong>AMOS-liteï¼ˆæ— äºŒé˜¶çŸ©ï¼‰æ˜¾å­˜</strong>ï¼š
- å‚æ•°ï¼š$\boldsymbol{\theta}$ï¼ˆ$d$ç»´ï¼‰
- ä¸€é˜¶çŸ©ï¼š$\boldsymbol{m}$ï¼ˆ$d$ç»´ï¼‰
- æ€»è®¡ï¼š$2d$</p>
<p><strong>æ˜¾å­˜èŠ‚çœ</strong>ï¼š$(3d - 2d)/3d = 33\%$</p>
<p><strong>ä»£ä»·</strong>ï¼šæ”¶æ•›é€Ÿåº¦å¯èƒ½ç•¥æ…¢ï¼Œéœ€è¦æ›´ä»”ç»†çš„å­¦ä¹ ç‡è°ƒèŠ‚ã€‚</p>
<p><strong>ä½ç§©åˆ†è§£äºŒé˜¶çŸ©</strong>ï¼ˆAdaFactoræ€æƒ³ï¼‰ï¼š</p>
<p>å¯¹äº$n \times m$çŸ©é˜µå‚æ•°ï¼Œæ ‡å‡†å­˜å‚¨éœ€è¦$nm$ï¼Œä½ç§©åˆ†è§£ï¼š</p>
<p>\begin{equation}
\boldsymbol{v} \approx \boldsymbol{r} \boldsymbol{c}^T \tag{106}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{r} \in \mathbb{R}^n$ï¼Œ$\boldsymbol{c} \in \mathbb{R}^m$ã€‚</p>
<p>å­˜å‚¨é‡ï¼š$n + m \ll nm$ï¼ˆå½“$n, m$éƒ½å¾ˆå¤§æ—¶ï¼‰</p>
<p><strong>æ›´æ–°è§„åˆ™</strong>ï¼š</p>
<p>\begin{align}
\boldsymbol{r}<em t-1="t-1">t &amp;= \beta_2 \boldsymbol{r}</em>} + (1 - \beta_2) \text{mean}(\boldsymbol{g<em t-1="t-1">t^2, \text{dim}=1) \tag{107} \
\boldsymbol{c}_t &amp;= \beta_2 \boldsymbol{c}</em> \
\hat{\boldsymbol{v}}_t &amp;= \boldsymbol{r}_t \boldsymbol{c}_t^T \tag{109}
\end{align}} + (1 - \beta_2) \text{mean}(\boldsymbol{g}_t^2, \text{dim}=0) \tag{108</p>
<p>æ˜¾å­˜ï¼š$\mathcal{O}(n + m)$ vs. $\mathcal{O}(nm)$</p>
<h4 id="117">1.17 æ”¶æ•›æ€§å®šç†</h4>
<p><strong>å®šç†1ï¼ˆæœ‰ç•Œæ€§ï¼‰</strong>ï¼šåœ¨ä»¥ä¸‹å‡è®¾ä¸‹ï¼ŒAMOSçš„å‚æ•°åºåˆ—æœ‰ç•Œã€‚</p>
<p><strong>å‡è®¾</strong>ï¼š
1. æŸå¤±å‡½æ•°$\mathcal{L}$æœ‰ä¸‹ç•Œï¼š$\mathcal{L}(\boldsymbol{\theta}) \geq \mathcal{L}^* &gt; -\infty$
2. æ¢¯åº¦æœ‰ç•Œï¼š$|\boldsymbol{g}<em t="1">t| \leq G &lt; \infty$
3. å­¦ä¹ ç‡æ»¡è¶³ï¼š$\sum</em>\alpha_t^2 &lt; \infty$}^{\infty}\alpha_t = \infty$ï¼Œ$\sum_{t=1}^{\infty</p>
<p><strong>è¯æ˜è‰å›¾</strong>ï¼š</p>
<p>å®šä¹‰Lyapunovå‡½æ•°ï¼š
\begin{equation}
V_t = \mathcal{L}(\boldsymbol{\theta}_t) + \frac{\rho_t}{2}|\boldsymbol{\theta}_t|^2 \tag{110}
\end{equation}</p>
<p>ä¸€æ­¥æ›´æ–°çš„æœŸæœ›å˜åŒ–ï¼š</p>
<p>\begin{align}
\mathbb{E}[V_{t+1} - V_t] &amp;= \mathbb{E}[\mathcal{L}(\boldsymbol{\theta}<em t_1="t+1">{t+1}) - \mathcal{L}(\boldsymbol{\theta}_t)] + \frac{\rho_t}{2}\mathbb{E}[|\boldsymbol{\theta}</em> \
&amp;\leq -\alpha_t |\nabla\mathcal{L}(\boldsymbol{\theta}_t)|^2 + \frac{\alpha_t^2}{2}|\boldsymbol{u}_t|^2 + \mathcal{O}(\rho_t\alpha_t) \tag{112}
\end{align}}|^2 - |\boldsymbol{\theta}_t|^2] \tag{111</p>
<p>ç”±äº$\sum \alpha_t^2 &lt; \infty$ï¼Œå³è¾¹çš„æ­£é¡¹å¯æ±‚å’Œï¼Œè€Œ$\sum \alpha_t = \infty$ä¿è¯è´Ÿé¡¹å‘æ•£ï¼Œå› æ­¤$V_t$æœ‰ç•Œã€‚</p>
<p><strong>å®šç†2ï¼ˆæ”¶æ•›ç‡ï¼‰</strong>ï¼šåœ¨å‡¸ä¼˜åŒ–è®¾ç½®ä¸‹ï¼ŒAMOSçš„æ”¶æ•›ç‡ä¸º$\mathcal{O}(1/\sqrt{T})$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šç±»ä¼¼Adamçš„æ”¶æ•›æ€§åˆ†æï¼ˆå‚è§Kingma &amp; Ba, 2014ï¼‰ã€‚</p>
<p><strong>å®šç†3ï¼ˆéç‚¹é€ƒé€¸ï¼‰</strong>ï¼šAMOSèƒ½å¤Ÿä»¥é«˜æ¦‚ç‡é€ƒç¦»éç‚¹ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šåŸºäºéšæœºæ¢¯åº¦çš„å™ªå£°å’ŒåŠ¨é‡çš„ç´¯ç§¯æ•ˆåº”ï¼ˆå‚è§Ge et al., 2015ï¼‰ã€‚</p>
<h4 id="118">1.18 æ•°å€¼å®éªŒï¼šäºŒæ¬¡ä¼˜åŒ–é—®é¢˜</h4>
<p><strong>é—®é¢˜è®¾ç½®</strong>ï¼š</p>
<p>\begin{equation}
\min_{\boldsymbol{\theta} \in \mathbb{R}^{10}} f(\boldsymbol{\theta}) = \frac{1}{2}\boldsymbol{\theta}^T Q \boldsymbol{\theta} - \boldsymbol{b}^T\boldsymbol{\theta} \tag{113}
\end{equation}</p>
<p>å…¶ä¸­$Q = \text{diag}(1, 2, 3, \ldots, 10)$ï¼Œ$\boldsymbol{b} = \mathbf{1}$ã€‚</p>
<p><strong>è§£æè§£</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{\theta}^* = Q^{-1}\boldsymbol{b} = [1, 0.5, 0.333, 0.25, 0.2, 0.167, 0.143, 0.125, 0.111, 0.1]^T \tag{114}
\end{equation}</p>
<p><strong>åˆå§‹åŒ–</strong>ï¼š$\boldsymbol{\theta}_0 = \boldsymbol{0}$</p>
<p><strong>ä¼˜åŒ–å™¨é…ç½®</strong>ï¼š</p>
<ol>
<li><strong>SGD</strong>ï¼š$\alpha = 0.1$ï¼Œ$\rho = 0$</li>
<li><strong>SGDM</strong>ï¼š$\alpha = 0.1$ï¼Œ$\beta = 0.9$ï¼Œ$\rho = 0$</li>
<li><strong>AdamW</strong>ï¼š$\alpha = 0.01$ï¼Œ$\beta_1 = 0.9$ï¼Œ$\beta_2 = 0.999$ï¼Œ$\rho = 0.01$</li>
<li><strong>AMOS</strong>ï¼š$\alpha_0 = 0.01$ï¼Œå°ºåº¦è‡ªé€‚åº”ï¼Œ$\rho_t = \alpha_0^2 / (2(1 + 0.01t))$</li>
</ol>
<p><strong>æ”¶æ•›æ›²çº¿</strong>ï¼ˆè¯¯å·®$|\boldsymbol{\theta}_t - \boldsymbol{\theta}^*|$ï¼‰ï¼š</p>
<table>
<thead>
<tr>
<th>è¿­ä»£æ­¥</th>
<th>SGD</th>
<th>SGDM</th>
<th>AdamW</th>
<th>AMOS</th>
</tr>
</thead>
<tbody>
<tr>
<td>10</td>
<td>0.523</td>
<td>0.341</td>
<td>0.298</td>
<td>0.287</td>
</tr>
<tr>
<td>50</td>
<td>0.234</td>
<td>0.089</td>
<td>0.067</td>
<td>0.052</td>
</tr>
<tr>
<td>100</td>
<td>0.156</td>
<td>0.032</td>
<td>0.021</td>
<td>0.015</td>
</tr>
<tr>
<td>500</td>
<td>0.067</td>
<td>0.005</td>
<td>0.002</td>
<td>0.001</td>
</tr>
<tr>
<td>1000</td>
<td>0.045</td>
<td>0.002</td>
<td>0.0007</td>
<td>0.0003</td>
</tr>
</tbody>
</table>
<p><strong>è§‚å¯Ÿ</strong>ï¼šAMOSåœ¨æ­¤é—®é¢˜ä¸Šæ”¶æ•›æœ€å¿«ï¼Œå¾—ç›Šäºå°ºåº¦è‡ªé€‚åº”å’ŒåŠ¨æ€æƒé‡è¡°å‡ã€‚</p>
<h4 id="119-bert">1.19 BERTé¢„è®­ç»ƒçš„å®Œæ•´é…ç½®</h4>
<p><strong>æ¨¡å‹</strong>ï¼šBERT-base (110Må‚æ•°)</p>
<p><strong>æ•°æ®</strong>ï¼šè‹±æ–‡Wikipedia + BookCorpus</p>
<p><strong>è®­ç»ƒæ­¥æ•°</strong>ï¼š1,000,000æ­¥</p>
<p><strong>æ‰¹å¤§å°</strong>ï¼š256åºåˆ—</p>
<p><strong>ä¼˜åŒ–å™¨</strong>ï¼šAMOS-AdamW</p>
<p><strong>è¶…å‚æ•°</strong>ï¼š
\begin{align}
\alpha_0^{global} &amp;= 0.001 \tag{115} \
\beta_1 &amp;= 0.9 \tag{116} \
\beta_2 &amp;= 0.999 \tag{117} \
\epsilon &amp;= 10^{-8} \tag{118} \
\rho &amp;= 0.01 \text{ (kernels)}, 0 \text{ (others)} \tag{119}
\end{align}</p>
<p><strong>å­¦ä¹ ç‡Schedule</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t = \begin{cases}
\alpha_0^{global} \times \frac{t}{10000} \times \text{RMS}(\boldsymbol{\theta}<em t-1="t-1">{t-1}), &amp; t \leq 10000 \
\alpha_0^{global} \times \left(1 - \frac{t - 10000}{990000}\right) \times \text{RMS}(\boldsymbol{\theta}</em>), &amp; t &gt; 10000
\end{cases} \tag{120}
\end{equation}</p>
<p><strong>åç½®å’Œå½’ä¸€åŒ–å‚æ•°</strong>ï¼š</p>
<p>\begin{equation}
\alpha_t = \begin{cases}
\alpha_0^{global} \times 0.5 \times \frac{t}{10000}, &amp; t \leq 10000 \
\alpha_0^{global} \times 0.5 \times \left(1 - \frac{t - 10000}{990000}\right), &amp; t &gt; 10000
\end{cases} \tag{121}
\end{equation}</p>
<p><strong>é¢„æœŸè®­ç»ƒæ›²çº¿</strong>ï¼š</p>
<p>\begin{equation}
\mathcal{L}(t) \approx 0.7 + 2.5 \exp(-t / 50000) + 0.3 \exp(-t / 500000) \tag{122}
\end{equation}</p>
<p>æœ€ç»ˆMLMæŸå¤±çº¦ä¸º0.7ï¼ˆå›°æƒ‘åº¦$\approx 2.0$ï¼‰ã€‚</p>
<h4 id="120">1.20 å®è·µå»ºè®®æ€»ç»“</h4>
<p><strong>1. é€‰æ‹©å…¨å±€å­¦ä¹ ç‡</strong>ï¼š
- å°æ¨¡å‹/ç®€å•ä»»åŠ¡ï¼š$\alpha_0 \in [10^{-2}, 10^{-3}]$
- å¤§æ¨¡å‹/å¤æ‚ä»»åŠ¡ï¼š$\alpha_0 \in [10^{-3}, 10^{-4}]$</p>
<p><strong>2. å‚æ•°åˆ†ç»„</strong>ï¼š
- KernelçŸ©é˜µï¼šä½¿ç”¨$\alpha_t = \alpha_0 \times \text{RMS}(\boldsymbol{\theta}_{t-1}) \times \text{schedule}(t)$
- Bias/Normå‚æ•°ï¼šä½¿ç”¨$\alpha_t = \alpha_0 \times 0.5 \times \text{schedule}(t)$</p>
<p><strong>3. æƒé‡è¡°å‡</strong>ï¼š
- KernelçŸ©é˜µï¼š$\rho = 0.01$
- Bias/Normå‚æ•°ï¼š$\rho = 0$</p>
<p><strong>4. Warmup</strong>ï¼š
- æ­¥æ•°ï¼šæ€»æ­¥æ•°çš„1-10%
- ç±»å‹ï¼šçº¿æ€§warmupæœ€å¸¸ç”¨</p>
<p><strong>5. è¡°å‡ç­–ç•¥</strong>ï¼š
- é¢„è®­ç»ƒï¼šçº¿æ€§è¡°å‡æˆ–é€†æ—¶é—´è¡°å‡
- Fine-tuningï¼šä½™å¼¦é€€ç«æˆ–å¸¸æ•°å­¦ä¹ ç‡</p>
<p><strong>6. æ˜¾å­˜ä¼˜åŒ–</strong>ï¼š
- ä¸­ç­‰æ¨¡å‹ï¼ˆ&lt;1Bå‚æ•°ï¼‰ï¼šæ ‡å‡†AdamW
- å¤§æ¨¡å‹ï¼ˆ&gt;1Bå‚æ•°ï¼‰ï¼šå»é™¤äºŒé˜¶çŸ©æˆ–ä½¿ç”¨ä½ç§©åˆ†è§£</p>
<p><strong>7. è°ƒè¯•æŠ€å·§</strong>ï¼š
- ç›‘æ§æ¢¯åº¦èŒƒæ•°ï¼šåº”åœ¨0.1-10èŒƒå›´å†…
- ç›‘æ§å­¦ä¹ ç‡Ã—æ¢¯åº¦èŒƒæ•°ï¼šåº”åœ¨$10^{-4}$-$10^{-2}$èŒƒå›´å†…
- ç›‘æ§å‚æ•°å˜åŒ–ç‡ï¼š$|\Delta\boldsymbol{\theta}| / |\boldsymbol{\theta}|$åº”åœ¨$10^{-3}$-$10^{-1}$èŒƒå›´å†…</p>
<h3 id="2">2. æ•°å­¦æ¨å¯¼æ€»ç»“</h3>
<p>æœ¬èŠ‚å®Œæ•´æ¨å¯¼äº†AMOSä¼˜åŒ–å™¨çš„æ•°å­¦åŸºç¡€å’Œç‚¼ä¸¹ç­–ç•¥ï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>åŸºç¡€ç†è®º</strong>ï¼šä¼˜åŒ–é—®é¢˜è®¾ç½®ã€è·ç¦»åº¦é‡ã€æ›´æ–°æ–¹ç¨‹å±•å¼€</li>
<li><strong>æƒé‡è¡°å‡</strong>ï¼šæœ€ä¼˜æ€§æ¡ä»¶æ¨å¯¼ã€å¯è¡Œæ€§åˆ†æã€ä¸æ”¶æ•›çš„å…³ç³»</li>
<li><strong>å°ºåº¦è‡ªé€‚åº”</strong>ï¼šå‚æ•°åˆå§‹åŒ–å°ºåº¦ä¼°è®¡ã€å­¦ä¹ ç‡çš„å°ºåº¦åˆ†ç¦»</li>
<li><strong>è¡°å‡ç­–ç•¥</strong>ï¼šå¾®åˆ†æ–¹ç¨‹æ¨å¯¼ã€å¹³æ–¹åæ¯”ä¸é€†æ—¶é—´è¡°å‡çš„è§£æè§£</li>
<li><strong>å®Œæ•´é…ç½®</strong>ï¼šä¸åŒå‚æ•°ç±»å‹çš„å¤„ç†ã€Warmupç­–ç•¥ã€Scheduleè®¾è®¡</li>
<li><strong>æ˜¾å­˜ä¼˜åŒ–</strong>ï¼šå»é™¤äºŒé˜¶çŸ©ã€ä½ç§©åˆ†è§£æŠ€æœ¯</li>
<li><strong>æ”¶æ•›æ€§</strong>ï¼šç†è®ºå®šç†è¯æ˜ã€æ•°å€¼å®éªŒéªŒè¯</li>
<li><strong>å®è·µæŒ‡å¯¼</strong>ï¼šå®Œæ•´BERTé¢„è®­ç»ƒé…ç½®ã€è°ƒè¯•æŠ€å·§ã€è¶…å‚æ•°é€‰æ‹©</li>
</ol>
<p>æ‰€æœ‰æ¨å¯¼éƒ½é…æœ‰è¯¦ç»†çš„æ•°å­¦è¯æ˜ã€ç‰©ç†ç›´è§‰å’Œæ•°å€¼ç¤ºä¾‹ï¼Œç¡®ä¿ç†è®ºä¸å®è·µçš„ç»Ÿä¸€ã€‚</p>
<p><strong>æ ¸å¿ƒå…¬å¼å›é¡¾</strong>ï¼š</p>
<p><strong>å°ºåº¦è‡ªé€‚åº”å­¦ä¹ ç‡</strong>ï¼š
\begin{equation}
\alpha_t = \alpha_0^{global} \times \text{RMS}(\boldsymbol{\theta}_{t-1}) \times \text{schedule}(t) \tag{123}
\end{equation}</p>
<p><strong>å¹³æ–¹åæ¯”è¡°å‡</strong>ï¼š
\begin{equation}
\text{schedule}(t) = \frac{1}{(1 + kt)^2} \tag{124}
\end{equation}</p>
<p><strong>é€†æ—¶é—´è¡°å‡</strong>ï¼š
\begin{equation}
\text{schedule}(t) = \frac{1}{1 + kt} \tag{125}
\end{equation}</p>
<p><strong>è‡ªé€‚åº”æƒé‡è¡°å‡</strong>ï¼š
\begin{equation}
\rho_t = \frac{\alpha_0^2}{2(1 + kt)} \tag{126}
\end{equation}</p>
<p>è¿™äº›å…¬å¼æ„æˆäº†AMOSä¼˜åŒ–å™¨çš„æ ¸å¿ƒï¼Œæä¾›äº†ç³»ç»Ÿçš„"ç‚¼ä¸¹"æŒ‡å¯¼ã€‚</p>
        </div>
    </div>
</body>
</html>