<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸ƒï¼‰ï¼šæœ€ä¼˜æ‰©æ•£æ–¹å·®ä¼°è®¡ï¼ˆä¸Šï¼‰</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸ƒï¼‰ï¼šæœ€ä¼˜æ‰©æ•£æ–¹å·®ä¼°è®¡ï¼ˆä¸Šï¼‰</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 46.1 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9245">https://spaces.ac.cn/archives/9245</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å¯¹äºç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¥è¯´ï¼Œä¸€ä¸ªå¾ˆå…³é”®çš„é—®é¢˜æ˜¯ç”Ÿæˆè¿‡ç¨‹çš„æ–¹å·®åº”è¯¥æ€ä¹ˆé€‰æ‹©ï¼Œå› ä¸ºä¸åŒçš„æ–¹å·®ä¼šæ˜æ˜¾å½±å“ç”Ÿæˆæ•ˆæœã€‚</p>
<p>åœ¨<a href="/archives/9152">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒï¼‰ï¼šDDPM = è‡ªå›å½’å¼VAEã€‹</a>æˆ‘ä»¬æåˆ°ï¼ŒDDPMåˆ†åˆ«å‡è®¾æ•°æ®æœä»ä¸¤ç§ç‰¹æ®Šåˆ†å¸ƒæ¨å‡ºäº†ä¸¤ä¸ªå¯ç”¨çš„ç»“æœï¼›<a href="/archives/9181">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆå››ï¼‰ï¼šDDIM = é«˜è§‚ç‚¹DDPMã€‹</a>ä¸­çš„DDIMåˆ™è°ƒæ•´äº†ç”Ÿæˆè¿‡ç¨‹ï¼Œå°†æ–¹å·®å˜ä¸ºè¶…å‚æ•°ï¼Œç”šè‡³å…è®¸é›¶æ–¹å·®ç”Ÿæˆï¼Œä½†æ–¹å·®ä¸º0çš„DDIMçš„ç”Ÿæˆæ•ˆæœæ™®éå·®äºæ–¹å·®é0çš„DDPMï¼›è€Œ<a href="/archives/9209">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäº”ï¼‰ï¼šä¸€èˆ¬æ¡†æ¶ä¹‹SDEç¯‡ã€‹</a>æ˜¾ç¤ºå‰ã€åå‘SDEçš„æ–¹å·®åº”è¯¥æ˜¯ä¸€è‡´çš„ï¼Œä½†è¿™åŸåˆ™ä¸Šåœ¨$\Delta t\to 0$æ—¶æ‰æˆç«‹ï¼›<a href="https://papers.cool/arxiv/2006.11239">ã€ŠImproved Denoising Diffusion Probabilistic Modelsã€‹</a>åˆ™æå‡ºå°†å®ƒè§†ä¸ºå¯è®­ç»ƒå‚æ•°æ¥å­¦ä¹ ï¼Œä½†ä¼šå¢åŠ è®­ç»ƒéš¾åº¦ã€‚</p>
<p>æ‰€ä»¥ï¼Œç”Ÿæˆè¿‡ç¨‹çš„æ–¹å·®ç©¶ç«Ÿè¯¥æ€ä¹ˆè®¾ç½®å‘¢ï¼Ÿä»Šå¹´çš„ä¸¤ç¯‡è®ºæ–‡<a href="https://papers.cool/arxiv/2201.06503">ã€ŠAnalytic-DPM: an Analytic Estimate of the Optimal Reverse Variance in Diffusion Probabilistic Modelsã€‹</a>å’Œ<a href="https://papers.cool/arxiv/2206.07309">ã€ŠEstimating the Optimal Covariance with Imperfect Mean in Diffusion Probabilistic Modelsã€‹</a>ç®—æ˜¯ç»™è¿™ä¸ªé—®é¢˜æä¾›äº†æ¯”è¾ƒå®Œç¾çš„ç­”æ¡ˆã€‚æ¥ä¸‹æ¥æˆ‘ä»¬ä¸€èµ·æ¬£èµä¸€ä¸‹å®ƒä»¬çš„ç»“æœã€‚</p>
<h2 id="_1">ä¸ç¡®å®šæ€§</h2>
<p>äº‹å®ä¸Šï¼Œè¿™ä¸¤ç¯‡è®ºæ–‡å‡ºè‡ªåŒä¸€å›¢é˜Ÿï¼Œä½œè€…ä¹ŸåŸºæœ¬ç›¸åŒã€‚ç¬¬ä¸€ç¯‡è®ºæ–‡ï¼ˆç®€ç§°Analytic-DPMï¼‰ä¸‹é¢ç®€ç§°åœ¨DDIMçš„åŸºç¡€ä¸Šï¼Œæ¨å¯¼äº†æ— æ¡ä»¶æ–¹å·®çš„ä¸€ä¸ªè§£æè§£ï¼›ç¬¬äºŒç¯‡è®ºæ–‡ï¼ˆç®€ç§°Extended-Analytic-DPMï¼‰åˆ™å¼±åŒ–äº†ç¬¬ä¸€ç¯‡è®ºæ–‡çš„å‡è®¾ï¼Œå¹¶æå‡ºäº†æœ‰æ¡ä»¶æ–¹å·®çš„ä¼˜åŒ–æ–¹æ³•ã€‚æœ¬æ–‡é¦–å…ˆä»‹ç»ç¬¬ä¸€ç¯‡è®ºæ–‡çš„ç»“æœã€‚</p>
<p>åœ¨<a href="/archives/9181">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆå››ï¼‰ï¼šDDIM = é«˜è§‚ç‚¹DDPMã€‹</a>ä¸­ï¼Œæˆ‘ä»¬æ¨å¯¼äº†å¯¹äºç»™å®šçš„$p(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t;\bar{\alpha}_t \boldsymbol{x}_0,\bar{\beta}_t^2 \boldsymbol{I})$ï¼Œå¯¹åº”çš„$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0)$çš„ä¸€èˆ¬è§£ä¸º<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0) = \mathcal{N}\left(\boldsymbol{x}</em>}; \frac{\sqrt{\bar{\beta<em t-1="t-1">{t-1}^2 - \sigma_t^2}}{\bar{\beta}_t} \boldsymbol{x}_t + \gamma_t \boldsymbol{x}_0, \sigma_t^2 \boldsymbol{I}\right)\end{equation}<br />
å…¶ä¸­$\gamma_t = \bar{\alpha}</em>} - \frac{\bar{\alpha<em t-1="t-1">t\sqrt{\bar{\beta}</em>}^2 - \sigma_t^2}}{\bar{\beta<em t-1="t-1">t}$ï¼Œ$\sigma_t$å°±æ˜¯å¯è°ƒçš„æ ‡å‡†å·®å‚æ•°ã€‚åœ¨DDIMä¸­ï¼Œæ¥ä¸‹æ¥çš„å¤„ç†æµç¨‹æ˜¯ï¼šç”¨$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$æ¥ä¼°è®¡$\boldsymbol{x}_0$ï¼Œç„¶åè®¤ä¸º<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t) \approx p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0=\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t))\end{equation}<br />
ç„¶è€Œï¼Œä»è´å¶æ–¯çš„è§’åº¦æ¥çœ‹ï¼Œè¿™ä¸ªå¤„ç†æ˜¯éå¸¸ä¸å¦¥çš„ï¼Œå› ä¸ºä»$\boldsymbol{x}_t$é¢„æµ‹$\boldsymbol{x}_0$ä¸å¯èƒ½å®Œå…¨å‡†ç¡®ï¼Œå®ƒå¸¦æœ‰ä¸€å®šçš„ä¸ç¡®å®šæ€§ï¼Œå› æ­¤æˆ‘ä»¬åº”è¯¥ç”¨æ¦‚ç‡åˆ†å¸ƒè€Œéç¡®å®šæ€§çš„å‡½æ•°æ¥æè¿°å®ƒã€‚äº‹å®ä¸Šï¼Œä¸¥æ ¼åœ°æœ‰<br />
\begin{equation}p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t) = \int p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t, \boldsymbol{x}_0)p(\boldsymbol{x}_0|\boldsymbol{x}_t)d\boldsymbol{x}_0\end{equation}<br />
ç²¾ç¡®çš„$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$é€šå¸¸æ˜¯æ²¡æ³•è·å¾—çš„ï¼Œä½†è¿™é‡Œåªè¦ä¸€ä¸ªç²—ç³™çš„è¿‘ä¼¼ï¼Œå› æ­¤æˆ‘ä»¬ç”¨æ­£æ€åˆ†å¸ƒ$\mathcal{N}(\boldsymbol{x}_0;\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t),\bar{\sigma}_t^2\boldsymbol{I})$å»é€¼è¿‘å®ƒï¼ˆå¦‚ä½•é€¼è¿‘æˆ‘ä»¬ç¨åå†è®¨è®ºï¼‰ã€‚æœ‰äº†è¿™ä¸ªè¿‘ä¼¼åˆ†å¸ƒåï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡º<br />
\begin{equation}\begin{aligned}<br />
\boldsymbol{x}</em>} =&amp;\, \frac{\sqrt{\bar{\beta<em t-1="t-1">{t-1}^2 - \sigma_t^2}}{\bar{\beta}_t}\boldsymbol{x}_t + \gamma_t \boldsymbol{x}_0 + \sigma_t\boldsymbol{\varepsilon}_1 \\\<br />
\approx&amp;\, \frac{\sqrt{\bar{\beta}</em>}^2 - \sigma_t^2}}{\bar{\beta<em t-1="t-1">t}\boldsymbol{x}_t + \gamma_t \big(\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) + \bar{\sigma}_t \boldsymbol{\varepsilon}_2\big) + \sigma_t\boldsymbol{\varepsilon}_1 \\\<br />
=&amp;\, \left(\frac{\sqrt{\bar{\beta}</em>}^2 - \sigma_t^2}}{\bar{\beta<em>t}\boldsymbol{x}_t + \gamma_t \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\right) + \underbrace{\big(\sigma_t\boldsymbol{\varepsilon}_1 + \gamma_t\bar{\sigma}_t \boldsymbol{\varepsilon}_2\big)}</em>{<br />
\sim \sqrt{\sigma_t^2 + \gamma_t^2\bar{\sigma}<em t-1="t-1">t^2}\boldsymbol{\varepsilon}} \\\<br />
\end{aligned}\end{equation}<br />
å…¶ä¸­$\boldsymbol{\varepsilon}_1,\boldsymbol{\varepsilon}_2,\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I})$ã€‚å¯ä»¥çœ‹åˆ°ï¼Œ$p(\boldsymbol{x}</em>}|\boldsymbol{x<em t-1="t-1">t)$æ›´åŠ æ¥è¿‘å‡å€¼ä¸º$\frac{\sqrt{\bar{\beta}</em>_t^2$è¿™ä¸€é¡¹ï¼Œå› æ­¤å³ä¾¿$\sigma_t=0$ï¼Œå¯¹åº”çš„æ–¹å·®ä¹Ÿä¸ä¸º0ã€‚å¤šå‡ºæ¥çš„è¿™ä¸€é¡¹ï¼Œå°±æ˜¯ç¬¬ä¸€ç¯‡è®ºæ–‡æ‰€æçš„æœ€ä¼˜æ–¹å·®çš„ä¿®æ­£é¡¹ã€‚}^2 - \sigma_t^2}}{\bar{\beta}_t}\boldsymbol{x}_t + \gamma_t \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$ã€åæ–¹å·®ä¸º$\left(\sigma_t^2 + \gamma_t^2\bar{\sigma}_t^2\right)\boldsymbol{I}$çš„æ­£æ€åˆ†å¸ƒï¼Œå…¶ä¸­å‡å€¼è·Ÿä»¥å¾€çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä¸åŒçš„æ˜¯æ–¹å·®å¤šå‡ºäº†$\gamma_t^2\bar{\sigma</p>
<h2 id="_2">å‡å€¼ä¼˜åŒ–</h2>
<p>ç°åœ¨æˆ‘ä»¬æ¥è®¨è®ºå¦‚ä½•ç”¨$\mathcal{N}(\boldsymbol{x}_0;\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t),\bar{\sigma}_t^2\boldsymbol{I})$å»é€¼è¿‘çœŸå®çš„$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$ï¼Œè¯´ç™½äº†å°±æ˜¯æ±‚å‡º$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$çš„å‡å€¼å’Œåæ–¹å·®ã€‚</p>
<p>å¯¹äºå‡å€¼$\bar{\boldsymbol{\mu}}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t)$æ¥è¯´ï¼Œå®ƒä¾èµ–äº$\boldsymbol{x}_t$ï¼Œæ‰€ä»¥éœ€è¦ä¸€ä¸ªæ¨¡å‹æ¥æ‹Ÿåˆå®ƒï¼Œè€Œè®­ç»ƒæ¨¡å‹å°±éœ€è¦æŸå¤±å‡½æ•°ã€‚åˆ©ç”¨<br />
\begin{equation}\mathbb{E}</em>}}[\boldsymbol{x}] = \mathop{\text{argmin}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\mu}}\mathbb{E}</em>}}\left[\Vert \boldsymbol{x} - \boldsymbol{\mu}\Vert^2\right]\label{eq:mean-opt}\end{equation<br />
æˆ‘ä»¬å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
\bar{\boldsymbol{\mu}}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t) =&amp;\,\mathbb{E}</em><em _boldsymbol_mu="\boldsymbol{\mu">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}[\boldsymbol{x}_0] \\\[5pt]<br />
=&amp;\, \mathop{\text{argmin}}</em>}}\mathbb{E<em _boldsymbol_mu="\boldsymbol{\mu">{\boldsymbol{x}_0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\Vert \boldsymbol{x}_0 - \boldsymbol{\mu}\Vert^2\right] \\\<br />
=&amp;\, \mathop{\text{argmin}}</em>}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t)}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t)}\mathbb{E}</em><em _boldsymbol_mu="\boldsymbol{\mu">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left\Vert \boldsymbol{x}_0 - \boldsymbol{\mu}(\boldsymbol{x}_t)\right\Vert^2\right] \\\<br />
=&amp;\, \mathop{\text{argmin}}</em>}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t)}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim \tilde{p}(\boldsymbol{x}_0)}\mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">t\sim p(\boldsymbol{x}_t|\boldsymbol{x}_0)}\left[\left\Vert \boldsymbol{x}_0 - \boldsymbol{\mu}(\boldsymbol{x}_t)\right\Vert^2\right] \\\<br />
\end{aligned}\label{eq:loss-1}\end{equation}<br />
è¿™å°±æ˜¯è®­ç»ƒ$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$æ‰€ç”¨çš„æŸå¤±å‡½æ•°ã€‚å¦‚æœåƒä¹‹å‰ä¸€æ ·å¼•å…¥å‚æ•°åŒ–<br />
\begin{equation}\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) = \frac{1}{\bar{\alpha}_t}\left(\boldsymbol{x}_t - \bar{\beta}_t \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)\right)\label{eq:bar-mu}\end{equation}<br />
å°±å¯ä»¥å¾—åˆ°DDPMè®­ç»ƒæ‰€ç”¨çš„æŸå¤±å‡½æ•°å½¢å¼$\left\Vert\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}</em>, t)\right\Vert^2$äº†ã€‚å…³äºå‡å€¼ä¼˜åŒ–çš„ç»“æœæ˜¯è·Ÿä»¥å¾€ä¸€è‡´çš„ï¼Œæ²¡æœ‰ä»€ä¹ˆæ”¹åŠ¨ã€‚}}(\bar{\alpha}_t \boldsymbol{x}_0 + \bar{\beta}_t \boldsymbol{\varepsilon</p>
<h2 id="1">æ–¹å·®ä¼°è®¡1</h2>
<p>ç±»ä¼¼åœ°ï¼Œæ ¹æ®å®šä¹‰ï¼Œåæ–¹å·®çŸ©é˜µåº”è¯¥æ˜¯<br />
\begin{equation}\begin{aligned}<br />
\boldsymbol{\Sigma}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t)=&amp;\, \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left(\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\right)\left(\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\right)^{\top}\right] \\\<br />
=&amp;\, \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left((\boldsymbol{x}_0 - \boldsymbol{\mu}) - (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu})\right)\left((\boldsymbol{x}_0 - \boldsymbol{\mu}) - (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu})\right)^{\top}\right] \\\<br />
=&amp;\, \mathbb{E}</em>\\\}_0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)^{\top}\right] - (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)(\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)^{\top<br />
\end{aligned}\label{eq:var-expand}\end{equation}<br />
å…¶ä¸­$\boldsymbol{\mu}_0$å¯ä»¥æ˜¯ä»»æ„å¸¸å‘é‡ï¼Œè¿™å¯¹åº”äºåæ–¹å·®çš„å¹³ç§»ä¸å˜æ€§ã€‚</p>
<p>ä¸Šå¼ä¼°è®¡çš„æ˜¯å®Œæ•´çš„åæ–¹å·®çŸ©é˜µï¼Œä½†å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œå› ä¸ºç›®å‰æˆ‘ä»¬æ˜¯æƒ³è¦ç”¨$\mathcal{N}(\boldsymbol{x}_0;\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t),\bar{\sigma}_t^2\boldsymbol{I})$å»é€¼è¿‘$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$ï¼Œå…¶ä¸­è®¾è®¡çš„åæ–¹å·®çŸ©é˜µä¸º$\bar{\sigma}_t^2\boldsymbol{I}$ï¼Œå®ƒæœ‰ä¸¤ä¸ªç‰¹ç‚¹ï¼š</p>
<blockquote>
<p>1ã€è·Ÿ$\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t$æ— å…³ï¼šä¸ºäº†æ¶ˆé™¤å¯¹$\boldsymbol{x}_t$çš„ä¾èµ–ï¼Œæˆ‘ä»¬å¯¹å…¨ä½“$\boldsymbol{x}_t$æ±‚å¹³å‡ï¼Œå³$\boldsymbol{\Sigma}_t = \mathbb{E}</em>_t)]$ï¼›}_t\sim p(\boldsymbol{x}_t)}[\boldsymbol{\Sigma}(\boldsymbol{x</p>
<p>2ã€å•ä½é˜µçš„å€æ•°ï¼šè¿™æ„å‘³ç€æˆ‘ä»¬åªç”¨è€ƒè™‘å¯¹è§’çº¿éƒ¨åˆ†ï¼Œå¹¶ä¸”å¯¹å¯¹è§’çº¿å…ƒç´ å–å¹³å‡ï¼Œå³$\bar{\sigma}_t^2 = \text{Tr}(\boldsymbol{\Sigma}_t)/d$ï¼Œå…¶ä¸­$d=\dim(\boldsymbol{x})$ã€‚</p>
</blockquote>
<p>äºæ˜¯æˆ‘ä»¬æœ‰<br />
\begin{equation}\begin{aligned}<br />
\bar{\sigma}<em _boldsymbol_x="\boldsymbol{x">t^2 =&amp;\, \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t)}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\frac{\Vert\boldsymbol{x}_0 - \boldsymbol{\mu}_0\Vert^2}{d}\right] - \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t)}\left[\frac{\Vert\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0\Vert^2}{d}\right] \\\<br />
=&amp;\, \frac{1}{d}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim \tilde{p}(\boldsymbol{x}_0)}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t|\boldsymbol{x}_0)}\left[\Vert\boldsymbol{x}_0 - \boldsymbol{\mu}_0\Vert^2\right] - \frac{1}{d}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t)}\left[\Vert\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0\Vert^2\right] \\\<br />
=&amp;\, \frac{1}{d}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim \tilde{p}(\boldsymbol{x}_0)}\left[\Vert\boldsymbol{x}_0 - \boldsymbol{\mu}_0\Vert^2\right] - \frac{1}{d}\mathbb{E}</em>_0\Vert^2\right] \\\}_t\sim p(\boldsymbol{x}_t)}\left[\Vert\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu<br />
\end{aligned}\label{eq:var-1}\end{equation}<br />
è¿™æ˜¯ç¬”è€…ç»™å‡ºçš„å…³äº$\bar{\sigma}_t^2$çš„ä¸€ä¸ªè§£æå½¢å¼ï¼Œåœ¨$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$å®Œæˆè®­ç»ƒçš„æƒ…å†µä¸‹ï¼Œå¯ä»¥é€šè¿‡é‡‡æ ·ä¸€æ‰¹$\boldsymbol{x}_0$å’Œ$\boldsymbol{x}_t$æ¥è¿‘ä¼¼è®¡ç®—ä¸Šå¼ã€‚</p>
<p>ç‰¹åˆ«åœ°ï¼Œå¦‚æœå–$\boldsymbol{\mu}<em _boldsymbol_x="\boldsymbol{x">0=\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim \tilde{p}(\boldsymbol{x}_0)}[\boldsymbol{x}_0]$ï¼Œé‚£ä¹ˆåˆšå¥½å¯ä»¥å†™æˆ<br />
\begin{equation}\bar{\sigma}_t^2 = \mathbb{V}ar[\boldsymbol{x}_0] - \frac{1}{d}\mathbb{E}</em>}_t\sim p(\boldsymbol{x}_t)}\left[\Vert\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0\Vert^2\right]\end{equation<br />
è¿™é‡Œçš„$\mathbb{V}ar[\boldsymbol{x}_0]$æ˜¯å…¨ä½“è®­ç»ƒæ•°æ®$\boldsymbol{x}_0$çš„åƒç´ çº§æ–¹å·®ã€‚å¦‚æœ$\boldsymbol{x}_0$çš„æ¯ä¸ªåƒç´ å€¼éƒ½åœ¨$[a,b]$åŒºé—´å†…ï¼Œé‚£ä¹ˆå®ƒçš„æ–¹å·®æ˜¾ç„¶ä¸ä¼šè¶…è¿‡$\left(\frac{b-a}{2}\right)^2$ï¼Œä»è€Œæœ‰ä¸ç­‰å¼<br />
\begin{equation}\bar{\sigma}_t^2 \leq \mathbb{V}ar[\boldsymbol{x}_0] \leq \left(\frac{b-a}{2}\right)^2\end{equation}</p>
<h2 id="2">æ–¹å·®ä¼°è®¡2</h2>
<p>åˆšæ‰çš„è§£æ˜¯ç¬”è€…ç»™å‡ºçš„ã€è®¤ä¸ºæ¯”è¾ƒç›´è§‚çš„ä¸€ä¸ªè§£ï¼ŒAnalytic-DPMåŸè®ºæ–‡åˆ™ç»™å‡ºäº†ä¸€ä¸ªç•¥æœ‰ä¸åŒçš„è§£ï¼Œä½†ç¬”è€…è®¤ä¸ºç›¸å¯¹æ¥è¯´æ²¡é‚£ä¹ˆç›´è§‚ã€‚é€šè¿‡ä»£å…¥å¼$\eqref{eq:bar-mu}$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°ï¼š<br />
\begin{equation}\begin{aligned}<br />
\boldsymbol{\Sigma}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t)=&amp;\, \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left(\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\right)\left(\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\right)^{\top}\right] \\\<br />
=&amp;\, \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left(\left(\boldsymbol{x}_0 - \frac{\boldsymbol{x}_t}{\bar{\alpha}_t}\right) + \frac{\bar{\beta}_t}{\bar{\alpha}_t} \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)\right)\left(\left(\boldsymbol{x}_0 - \frac{\boldsymbol{x}_t}{\bar{\alpha}_t}\right) + \frac{\bar{\beta}_t}{\bar{\alpha}_t} \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t, t)\right)^{\top}\right] \\\<br />
=&amp;\, \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left(\boldsymbol{x}_0 - \frac{\boldsymbol{x}_t}{\bar{\alpha}_t}\right)\left(\boldsymbol{x}_0 - \frac{\boldsymbol{x}_t}{\bar{\alpha}_t}\right)^{\top}\right] - \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2} \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)\boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t, t)^{\top}\\\<br />
=&amp;\, \frac{1}{\bar{\alpha}_t^2}\mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)^{\top}\right] - \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2} \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)\boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t, t)^{\top}\\\<br />
\end{aligned}\end{equation}<br />
æ­¤æ—¶å¦‚æœä¸¤ç«¯å¯¹$\boldsymbol{x}_t\sim p(\boldsymbol{x}_t)$æ±‚å¹³å‡ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t)}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)^{\top}\right] \\\<br />
=&amp;\, \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim \tilde{p}(\boldsymbol{x}_0)}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t|\boldsymbol{x}_0)}\left[\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)^{\top}\right]<br />
\end{aligned}\end{equation}<br />
åˆ«å¿˜äº†$p(\boldsymbol{x}_t|\boldsymbol{x}_0) = \mathcal{N}(\boldsymbol{x}_t;\bar{\alpha}_t \boldsymbol{x}_0,\bar{\beta}_t^2 \boldsymbol{I})$ï¼Œæ‰€ä»¥$\bar{\alpha}_t \boldsymbol{x}_0$å®é™…ä¸Šå°±æ˜¯$p(\boldsymbol{x}_t|\boldsymbol{x}_0)$çš„å‡å€¼ï¼Œé‚£ä¹ˆ$\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t|\boldsymbol{x}_0)}\left[\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)^{\top}\right]$å®é™…ä¸Šæ˜¯åœ¨æ±‚$p(\boldsymbol{x}_t|\boldsymbol{x}_0)$çš„å‡å€¼çš„åæ–¹å·®çŸ©é˜µï¼Œç»“æœæ˜¾ç„¶å°±æ˜¯$\bar{\beta}_t^2 \boldsymbol{I}$ï¼Œæ‰€ä»¥<br />
\begin{equation}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim \tilde{p}(\boldsymbol{x}_0)}\mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t|\boldsymbol{x}_0)}\left[\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)\left(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0\right)^{\top}\right] = \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">0\sim \tilde{p}(\boldsymbol{x}_0)}\left[\bar{\beta}_t^2 \boldsymbol{I}\right] = \bar{\beta}_t^2 \boldsymbol{I}<br />
\end{equation}<br />
é‚£ä¹ˆ<br />
\begin{equation}<br />
\boldsymbol{\Sigma}_t = \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t)}[\boldsymbol{\Sigma}(\boldsymbol{x}_t)] = \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\left(\boldsymbol{I} - \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">t\sim p(\boldsymbol{x}_t)}\left[ \boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)\boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t, t)^{\top}\right]\right)\end{equation}<br />
ä¸¤è¾¹å–è¿¹ç„¶åé™¤ä»¥$d$ï¼Œå¾—åˆ°<br />
\begin{equation}\bar{\sigma}_t^2 = \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\left(1 - \frac{1}{d}\mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">t\sim p(\boldsymbol{x}_t)}\left[ \Vert\boldsymbol{\epsilon}</em>}}(\boldsymbol{x}_t, t)\Vert^2\right]\right)\leq \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\label{eq:var-2}\end{equation<br />
è¿™å°±å¾—åˆ°äº†å¦ä¸€ä¸ªä¼°è®¡å’Œä¸Šç•Œï¼Œè¿™å°±æ˜¯Analytic-DPMçš„åŸå§‹ç»“æœã€‚</p>
<h2 id="_3">å®éªŒç»“æœ</h2>
<p>åŸè®ºæ–‡çš„å®éªŒç»“æœæ˜¾ç¤ºï¼ŒAnalytic-DPMæ‰€åšçš„æ–¹å·®ä¿®æ­£ï¼Œä¸»è¦åœ¨ç”Ÿæˆæ‰©æ•£æ­¥æ•°è¾ƒå°‘æ—¶ä¼šæœ‰æ¯”è¾ƒæ˜æ˜¾çš„æå‡ï¼Œæ‰€ä»¥å®ƒå¯¹æ‰©æ•£æ¨¡å‹çš„åŠ é€Ÿæ¯”è¾ƒæœ‰æ„ä¹‰ï¼š  </p>
<p><a href="/usr/uploads/2022/08/847522637.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="Analytic-DPMä¸»è¦åœ¨æ‰©æ•£æ­¥æ•°è¾ƒå°‘æ—¶ä¼šæœ‰æ¯”è¾ƒæ˜æ˜¾çš„æ•ˆæœæå‡" src="/usr/uploads/2022/08/847522637.png" /></a></p>
<p>Analytic-DPMä¸»è¦åœ¨æ‰©æ•£æ­¥æ•°è¾ƒå°‘æ—¶ä¼šæœ‰æ¯”è¾ƒæ˜æ˜¾çš„æ•ˆæœæå‡</p>
<p>ç¬”è€…ä¹Ÿåœ¨ä¹‹å‰è‡ªå·±å®ç°çš„ä»£ç ä¸Šå°è¯•äº†Analytic-DPMçš„ä¿®æ­£ï¼Œå‚è€ƒä»£ç ä¸ºï¼š</p>
<blockquote>
<p><strong>Githubï¼š<a href="https://github.com/bojone/Keras-DDPM/blob/main/adpm.py">https://github.com/bojone/Keras-DDPM/blob/main/adpm.py</a></strong></p>
</blockquote>
<p>å½“æ‰©æ•£æ­¥æ•°ä¸º$10$æ—¶ï¼ŒDDPMä¸Analytic-DDPMçš„æ•ˆæœå¯¹æ¯”å¦‚ä¸‹å›¾ï¼š  </p>
<p><a href="/usr/uploads/2022/08/926213602.jpg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="DDPMåœ¨æ‰©æ•£æ­¥æ•°ä¸º10æ—¶çš„ç”Ÿæˆç»“æœ" src="/usr/uploads/2022/08/926213602.jpg" /></a></p>
<p>DDPMåœ¨æ‰©æ•£æ­¥æ•°ä¸º10æ—¶çš„ç”Ÿæˆç»“æœ</p>
<p><a href="/usr/uploads/2022/08/4263413841.jpg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="Analytic-DDPMåœ¨æ‰©æ•£æ­¥æ•°ä¸º10æ—¶çš„ç”Ÿæˆç»“æœ" src="/usr/uploads/2022/08/4263413841.jpg" /></a></p>
<p>Analytic-DDPMåœ¨æ‰©æ•£æ­¥æ•°ä¸º10æ—¶çš„ç”Ÿæˆç»“æœ</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨æ‰©æ•£æ­¥æ•°è¾ƒå°æ—¶ï¼ŒDDPMçš„ç”Ÿæˆæ•ˆæœæ¯”è¾ƒå…‰æ»‘ï¼Œæœ‰ç‚¹â€œé‡åº¦ç£¨çš®â€çš„æ„Ÿè§‰ï¼Œç›¸æ¯”ä¹‹ä¸‹Analytic-DDPMçš„ç»“æœæ˜¾å¾—æ›´çœŸå®ä¸€äº›ï¼Œä½†æ˜¯ä¹Ÿå¸¦æ¥äº†é¢å¤–çš„å™ªç‚¹ã€‚ä»è¯„ä»·æŒ‡æ ‡æ¥è¯´ï¼ŒAnalytic-DDPMè¦æ›´å¥½ä¸€äº›ã€‚</p>
<h2 id="_4">å¹æ¯›æ±‚ç–µ</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†Analytic-DPMçš„ä»‹ç»ï¼Œæ¨å¯¼è¿‡ç¨‹ç•¥å¸¦æœ‰ä¸€äº›æŠ€å·§æ€§ï¼Œä½†ä¸ç®—å¤ªå¤æ‚ï¼Œè‡³å°‘æ€è·¯ä¸Šè¿˜æ˜¯å¾ˆæ˜æœ—çš„ã€‚å¦‚æœè¯»è€…è§‰å¾—è¿˜æ˜¯å¾ˆéš¾æ‡‚ï¼Œé‚£ä¸å¦¨å†å»çœ‹çœ‹åŸè®ºæ–‡åœ¨é™„å½•ä¸­ç”¨7é¡µçº¸ã€13ä¸ªå¼•ç†å®Œæˆçš„æ¨å¯¼ï¼Œæƒ³å¿…çœ‹åˆ°ä¹‹åå°±è§‰å¾—æœ¬æ–‡çš„æ¨å¯¼æ˜¯å¤šä¹ˆå‹å¥½äº†å“ˆå“ˆï½</p>
<p>è¯šç„¶ï¼Œä»é¦–å…ˆå¾—åˆ°è¿™ä¸ªæ–¹å·®çš„è§£æè§£æ¥è¯´ï¼Œæˆ‘ä¸ºåŸä½œè€…ä»¬çš„æ´å¯ŸåŠ›è€ŒæŠ˜æœï¼Œä½†ä¸å¾—ä¸è¯´çš„æ˜¯ï¼Œä»â€œäº‹åè¯¸è‘›äº®â€çš„è§’åº¦æ¥è¯´ï¼ŒAnalytic-DPMåœ¨æ¨å¯¼å’Œç»“æœä¸Šéƒ½èµ°äº†ä¸€äº›çš„â€œå¼¯è·¯â€ï¼Œæ˜¾å¾—â€œå¤ªç»•â€ã€â€å¤ªå·§â€œï¼Œä»è€Œæ„Ÿè§‰ä¸åˆ°ä»€ä¹ˆå¯å‘æ€§ã€‚å…¶ä¸­ï¼Œä¸€ä¸ªæœ€æ˜æ˜¾çš„ç‰¹ç‚¹æ˜¯ï¼ŒåŸè®ºæ–‡çš„ç»“æœéƒ½ç”¨äº†$\nabla_{\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t}\log p(\boldsymbol{x}_t)$æ¥è¡¨è¾¾ï¼Œè¿™å°±å¸¦æ¥äº†ä¸‰ä¸ªé—®é¢˜ï¼šä¸€æ¥ä½¿å¾—æ¨å¯¼è¿‡ç¨‹ç‰¹åˆ«ä¸ç›´è§‚ï¼Œéš¾ä»¥ç†è§£â€œæ€ä¹ˆæƒ³åˆ°çš„â€ï¼›äºŒæ¥è¦æ±‚è¯»è€…é¢å¤–äº†è§£å¾—åˆ†åŒ¹é…çš„ç›¸å…³ç»“æœï¼Œå¢åŠ äº†ç†è§£éš¾åº¦ï¼›æœ€åè½åˆ°å®è·µæ—¶ï¼Œ$\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t}\log p(\boldsymbol{x}_t)$åˆè¦ç”¨å›$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$æˆ–$\boldsymbol{\epsilon}</em>_t, t)$æ¥è¡¨ç¤ºï¼Œå¤šç»•ä¸€é“ã€‚}}(\boldsymbol{x</p>
<p>æœ¬æ–‡æ¨å¯¼çš„å‡ºå‘ç‚¹æ˜¯ï¼Œæˆ‘ä»¬æ˜¯åœ¨ä¼°è®¡æ­£æ€åˆ†å¸ƒçš„å‚æ•°ï¼Œå¯¹äºæ­£æ€åˆ†å¸ƒæ¥è¯´ï¼ŒçŸ©ä¼°è®¡ä¸æœ€å¤§ä¼¼ç„¶ä¼°è®¡ç›¸åŒï¼Œå› æ­¤ç›´æ¥å»ä¼°ç®—ç›¸åº”çš„å‡å€¼æ–¹å·®å³å¯ã€‚ç»“æœä¸Šï¼Œæ²¡å¿…è¦å¼ºè¡Œåœ¨å½¢å¼ä¸Šå»è·Ÿ$\nabla_{\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t}\log p(\boldsymbol{x}_t)$ã€å¾—åˆ†åŒ¹é…å¯¹é½ï¼Œå› ä¸ºå¾ˆæ˜æ˜¾Analytic-DPMçš„baselineæ¨¡å‹æ˜¯DDIMï¼ŒDDIMæœ¬èº«å°±æ²¡æœ‰ä»¥å¾—åˆ†åŒ¹é…ä¸ºå‡ºå‘ç‚¹ï¼Œå¢åŠ ä¸å¾—åˆ†åŒ¹é…çš„è”ç³»ï¼Œäºç†è®ºå’Œå®éªŒéƒ½æ— ç›Šã€‚ç›´æ¥è·Ÿ$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$æˆ–$\boldsymbol{\epsilon}</em>_t, t)$å¯¹é½ï¼Œå½¢å¼ä¸Šæ›´åŠ ç›´è§‚ï¼Œè€Œä¸”æ›´å®¹æ˜“è·Ÿå®éªŒå½¢å¼è¿›è¡Œè½¬æ¢ã€‚}}(\boldsymbol{x</p>
<h2 id="_5">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡åˆ†äº«äº†è®ºæ–‡Analytic-DPMä¸­çš„æ‰©æ•£æ¨¡å‹æœ€ä¼˜æ–¹å·®ä¼°è®¡ç»“æœï¼Œå®ƒç»™å‡ºäº†ç›´æ¥å¯ç”¨çš„æœ€ä¼˜æ–¹å·®ä¼°è®¡çš„è§£æå¼ï¼Œä½¿å¾—æˆ‘ä»¬ä¸éœ€è¦é‡æ–°è®­ç»ƒå°±å¯ä»¥ç›´æ¥åº”ç”¨å®ƒæ¥æ”¹è¿›ç”Ÿæˆæ•ˆæœã€‚ç¬”è€…ç”¨è‡ªå·±çš„æ€è·¯ç®€åŒ–äº†åŸè®ºæ–‡çš„æ¨å¯¼ï¼Œå¹¶è¿›è¡Œäº†ç®€å•çš„å®éªŒéªŒè¯ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9245">https://spaces.ac.cn/archives/9245</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Aug. 12, 2022). ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸ƒï¼‰ï¼šæœ€ä¼˜æ‰©æ•£æ–¹å·®ä¼°è®¡ï¼ˆä¸Šï¼‰ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9245">https://spaces.ac.cn/archives/9245</a></p>
<p>@online{kexuefm-9245,<br />
title={ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆä¸ƒï¼‰ï¼šæœ€ä¼˜æ‰©æ•£æ–¹å·®ä¼°è®¡ï¼ˆä¸Šï¼‰},<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={Aug},<br />
url={\url{https://spaces.ac.cn/archives/9245}},<br />
} </p>
<hr />
<h2 id="_6">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1_1">1. æ•°å­¦æ¡†æ¶ä¸åŸºæœ¬æ¦‚å¿µ</h3>
<p><strong>æ ¸å¿ƒé—®é¢˜</strong>ï¼š</p>
<p>åœ¨æ‰©æ•£æ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬éœ€è¦ç¡®å®šç”Ÿæˆè¿‡ç¨‹çš„æ–¹å·®$\sigma_t^2$ã€‚ä¼ ç»ŸDDPMç»™å‡ºäº†ä¸¤ä¸ªç‰¹æ®Šè§£ï¼ŒDDIMåˆ™å°†æ–¹å·®ä½œä¸ºè¶…å‚æ•°ï¼Œè€Œæœ¬æ–‡è¦æ¢è®¨å¦‚ä½•é€šè¿‡ç†è®ºæ¨å¯¼å¾—åˆ°æœ€ä¼˜æ–¹å·®ã€‚</p>
<p><strong>åŸºæœ¬å‡è®¾</strong>ï¼š</p>
<ul>
<li>å‡è®¾1ï¼šå‰å‘æ‰©æ•£è¿‡ç¨‹$p(\boldsymbol{x}<em t-1="t-1">t|\boldsymbol{x}</em>}) = \mathcal{N}(\boldsymbol{x<em t-1="t-1">t;\alpha_t \boldsymbol{x}</em>)$å·²çŸ¥}, \beta_t^2 \boldsymbol{I</li>
<li>å‡è®¾2ï¼šç”Ÿæˆè¿‡ç¨‹$q(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t)$éœ€è¦æ„å»ºå¹¶ä¼˜åŒ–</li>
<li>å‡è®¾3ï¼šæˆ‘ä»¬æœ‰è¶³å¤Ÿçš„æ•°æ®æ¥ä¼°è®¡ç›¸å…³çš„æœŸæœ›å€¼</li>
</ul>
<p><strong>å…³é”®åˆ†å¸ƒ</strong>ï¼š</p>
<p>ä»DDIMçš„æ¨å¯¼ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“å¯¹äºç»™å®šçš„å‰å‘è¿‡ç¨‹ï¼ŒåéªŒåˆ†å¸ƒçš„ä¸€èˆ¬å½¢å¼ä¸ºï¼š
$$
p(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0) = \mathcal{N}\left(\boldsymbol{x}_{t-1}; \frac{\sqrt{\bar{\beta}_{t-1}^2 - \sigma_t^2}}{\bar{\beta}_t} \boldsymbol{x}_t + \gamma_t \boldsymbol{x}_0, \sigma_t^2 \boldsymbol{I}\right) \tag{1}
$$</p>
<p>å…¶ä¸­ï¼š
- $\gamma_t = \bar{\alpha}<em t-1="t-1">{t-1} - \frac{\bar{\alpha}_t\sqrt{\bar{\beta}</em>$
- $\bar{\alpha}_t = \alpha_1\cdots\alpha_t$ï¼Œç´¯ç§¯ä¿¡å·ç³»æ•°
- $\bar{\beta}_t = \sqrt{1-\bar{\alpha}_t^2}$ï¼Œç´¯ç§¯å™ªå£°ç³»æ•°
- $\sigma_t$æ˜¯å¾…å®šçš„æ–¹å·®å‚æ•°}^2 - \sigma_t^2}}{\bar{\beta}_t</p>
<h3 id="2_1">2. ä¸ç¡®å®šæ€§çš„è´å¶æ–¯è§‚ç‚¹</h3>
<p><strong>é—®é¢˜çš„æœ¬è´¨</strong>ï¼š</p>
<p>DDIMçš„å¤„ç†æ–¹å¼æ˜¯ç›´æ¥ç”¨ç‚¹ä¼°è®¡$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$æ¥æ›¿ä»£$\boldsymbol{x}_0$ï¼š
$$
p(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t) \approx p(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0=\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)) \tag{2}
$$</p>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·ä¸å¤Ÿå¥½ï¼Ÿ</strong></p>
<p>ä»è´å¶æ–¯çš„è§’åº¦çœ‹ï¼Œç”¨$\boldsymbol{x}_t$é¢„æµ‹$\boldsymbol{x}_0$å­˜åœ¨ä¸ç¡®å®šæ€§ã€‚ç‚¹ä¼°è®¡å¿½ç•¥äº†è¿™ç§ä¸ç¡®å®šæ€§ï¼Œå¯¼è‡´ï¼š</p>
<ol>
<li>ä¿¡æ¯ä¸¢å¤±ï¼šé¢„æµ‹çš„ä¸ç¡®å®šç¨‹åº¦æœªè¢«åˆ©ç”¨</li>
<li>æ–¹å·®ä½ä¼°ï¼šå®é™…å˜åŒ–å¤§äºæ¨¡å‹å‡è®¾</li>
<li>ç”Ÿæˆè´¨é‡ä¸‹é™ï¼šå°¤å…¶åœ¨æ­¥æ•°è¾ƒå°‘æ—¶</li>
</ol>
<p><strong>ä¸¥æ ¼çš„è´å¶æ–¯è¡¨è¾¾</strong>ï¼š</p>
<p>æ ¹æ®æ¦‚ç‡è®ºçš„è¾¹ç¼˜åŒ–åŸç†ï¼š
$$
p(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t) = \int p(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t, \boldsymbol{x}_0)p(\boldsymbol{x}_0|\boldsymbol{x}_t)d\boldsymbol{x}_0 \tag{3}
$$</p>
<p>è¿™ä¸ªç§¯åˆ†è€ƒè™‘äº†$\boldsymbol{x}_0$çš„æ‰€æœ‰å¯èƒ½å–å€¼ï¼Œæ¯ä¸ªå–å€¼æŒ‰å…¶åéªŒæ¦‚ç‡$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$åŠ æƒã€‚</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼š</p>
<p>æƒ³è±¡$\boldsymbol{x}_t$æ˜¯ä¸€å¼ è¢«åŠ å™ªçš„å›¾ç‰‡ï¼š
- ç‚¹ä¼°è®¡$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$ç»™å‡º"æœ€å¯èƒ½"çš„åŸå›¾
- ä½†å®é™…ä¸Šå¯èƒ½æœ‰å¤šå¼ ä¸åŒçš„åŸå›¾éƒ½èƒ½äº§ç”Ÿç›¸ä¼¼çš„å™ªå£°å›¾
- æ¦‚ç‡åˆ†å¸ƒ$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$æ•æ‰äº†è¿™ç§å¤šæ ·æ€§</p>
<h3 id="3">3. æ–¹å·®ä¿®æ­£é¡¹çš„æ¨å¯¼</h3>
<p><strong>ç¬¬ä¸€æ­¥ï¼šç”¨æ­£æ€åˆ†å¸ƒè¿‘ä¼¼åéªŒ</strong></p>
<p>å‡è®¾ï¼š
$$
p(\boldsymbol{x}_0|\boldsymbol{x}_t) \approx \mathcal{N}(\boldsymbol{x}_0;\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t),\bar{\sigma}_t^2\boldsymbol{I}) \tag{4}
$$</p>
<p>è¿™æ„å‘³ç€æˆ‘ä»¬å°†åéªŒåˆ†å¸ƒå»ºæ¨¡ä¸ºå‡å€¼$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$ã€æ–¹å·®$\bar{\sigma}_t^2$çš„å„å‘åŒæ€§é«˜æ–¯åˆ†å¸ƒã€‚</p>
<p><strong>ç¬¬äºŒæ­¥ï¼šå±•å¼€ç§¯åˆ†</strong></p>
<p>å°†å¼(1)å’Œå¼(4)ä»£å…¥å¼(3)ï¼š
$$
\begin{aligned}
p(\boldsymbol{x}_{t-1}|\boldsymbol{x}_t) &= \int \mathcal{N}\left(\boldsymbol{x}_{t-1}; \frac{\sqrt{\bar{\beta}_{t-1}^2 - \sigma_t^2}}{\bar{\beta}_t} \boldsymbol{x}_t + \gamma_t \boldsymbol{x}_0, \sigma_t^2 \boldsymbol{I}\right) \\
&\quad\quad \times \mathcal{N}(\boldsymbol{x}_0;\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t),\bar{\sigma}_t^2\boldsymbol{I}) d\boldsymbol{x}_0
\end{aligned} \tag{5}
$$</p>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šåˆ©ç”¨éšæœºå˜é‡çš„çº¿æ€§å˜æ¢</strong></p>
<p>ä»å¼(4)ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºï¼š
$$
\boldsymbol{x}_0 = \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) + \bar{\sigma}_t \boldsymbol{\varepsilon}_2, \quad \boldsymbol{\varepsilon}_2\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I}) \tag{6}
$$</p>
<p>åŒæ—¶ï¼Œä»å¼(1)ä¸­ï¼Œæ¡ä»¶å™ªå£°ä¸ºï¼š
$$
\boldsymbol{x}_{t-1} = \frac{\sqrt{\bar{\beta}_{t-1}^2 - \sigma_t^2}}{\bar{\beta}_t}\boldsymbol{x}_t + \gamma_t \boldsymbol{x}_0 + \sigma_t\boldsymbol{\varepsilon}_1, \quad \boldsymbol{\varepsilon}_1\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I}) \tag{7}
$$</p>
<p><strong>ç¬¬å››æ­¥ï¼šåˆå¹¶ä¸¤ä¸ªå™ªå£°æº</strong></p>
<p>å°†å¼(6)ä»£å…¥å¼(7)ï¼š
$$
\begin{aligned}
\boldsymbol{x}_{t-1} &= \frac{\sqrt{\bar{\beta}_{t-1}^2 - \sigma_t^2}}{\bar{\beta}_t}\boldsymbol{x}_t + \gamma_t \big(\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) + \bar{\sigma}_t \boldsymbol{\varepsilon}_2\big) + \sigma_t\boldsymbol{\varepsilon}_1 \\
&= \underbrace{\frac{\sqrt{\bar{\beta}_{t-1}^2 - \sigma_t^2}}{\bar{\beta}_t}\boldsymbol{x}_t + \gamma_t \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)}_{\text{å‡å€¼é¡¹}} + \underbrace{\sigma_t\boldsymbol{\varepsilon}_1 + \gamma_t\bar{\sigma}_t \boldsymbol{\varepsilon}_2}_{\text{æ–¹å·®é¡¹}}
\end{aligned} \tag{8}
$$</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼šæ–¹å·®é¡¹åŒ…å«ä¸¤ä¸ªç‹¬ç«‹çš„é«˜æ–¯å™ªå£°æºã€‚</p>
<p><strong>ç¬¬äº”æ­¥ï¼šè®¡ç®—æ€»æ–¹å·®</strong></p>
<p>ç”±äº$\boldsymbol{\varepsilon}_1$å’Œ$\boldsymbol{\varepsilon}_2$ç›¸äº’ç‹¬ç«‹ï¼Œä¸”éƒ½æ˜¯æ ‡å‡†æ­£æ€ï¼Œæ ¹æ®ç‹¬ç«‹éšæœºå˜é‡å’Œçš„æ–¹å·®å…¬å¼ï¼š
$$
\text{Var}[\sigma_t\boldsymbol{\varepsilon}_1 + \gamma_t\bar{\sigma}_t \boldsymbol{\varepsilon}_2] = \sigma_t^2 + \gamma_t^2\bar{\sigma}_t^2 \tag{9}
$$</p>
<p><strong>ä¸ºä»€ä¹ˆå¯ä»¥ç›´æ¥ç›¸åŠ ï¼Ÿ</strong></p>
<p>å¯¹äºç‹¬ç«‹çš„éšæœºå‘é‡$\boldsymbol{X}$å’Œ$\boldsymbol{Y}$ï¼š
$$
\text{Cov}[a\boldsymbol{X} + b\boldsymbol{Y}] = a^2\text{Cov}[\boldsymbol{X}] + b^2\text{Cov}[\boldsymbol{Y}]
$$</p>
<p>å½“åæ–¹å·®çŸ©é˜µéƒ½æ˜¯$\boldsymbol{I}$æ—¶ï¼Œç»“æœå°±æ˜¯$(a^2+b^2)\boldsymbol{I}$ã€‚</p>
<p><strong>æœ€ç»ˆç»“æœ</strong>ï¼š</p>
<p>è€ƒè™‘äº†$\boldsymbol{x}_0$çš„ä¸ç¡®å®šæ€§åï¼Œç”Ÿæˆè¿‡ç¨‹çš„æ–¹å·®ä¸ºï¼š
$$
\boxed{\sigma_{\text{total}}^2 = \sigma_t^2 + \gamma_t^2\bar{\sigma}_t^2} \tag{10}
$$</p>
<p>è¿™å°±æ˜¯Analytic-DPMçš„æ ¸å¿ƒå‘ç°ï¼š<strong>å³ä½¿DDIMå–$\sigma_t=0$ï¼Œå®é™…æ–¹å·®ä¹Ÿä¸ä¸ºé›¶</strong>ï¼</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼š</p>
<ul>
<li>$\sigma_t^2$ï¼šDDIMçš„åŸå§‹æ–¹å·®ï¼ˆå¯ä»¥è®¾ä¸º0ï¼‰</li>
<li>$\gamma_t^2\bar{\sigma}_t^2$ï¼šç”±äº$\boldsymbol{x}_0$é¢„æµ‹ä¸ç¡®å®šæ€§å¸¦æ¥çš„é¢å¤–æ–¹å·®</li>
</ul>
<h3 id="4">4. å‡å€¼æ¨¡å‹çš„ä¼˜åŒ–</h3>
<p><strong>ç›®æ ‡</strong>ï¼šæ‰¾åˆ°æœ€ä¼˜çš„å‡å€¼ä¼°è®¡$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$ã€‚</p>
<p><strong>ç†è®ºåŸºç¡€</strong>ï¼š</p>
<p>å¯¹äºéšæœºå˜é‡$\boldsymbol{X}$ï¼Œå…¶å‡å€¼æ˜¯å¹³æ–¹è¯¯å·®æŸå¤±ä¸‹çš„æœ€ä¼˜ç‚¹ä¼°è®¡ï¼š
$$
\mathbb{E}[\boldsymbol{X}] = \mathop{\text{argmin}}_{\boldsymbol{\mu}}\mathbb{E}\left[\Vert \boldsymbol{X} - \boldsymbol{\mu}\Vert^2\right] \tag{11}
$$</p>
<p><strong>è¯æ˜ï¼ˆä¸€ç»´æƒ…å†µï¼‰</strong>ï¼š</p>
<p>å¯¹äºæ ‡é‡$X$ï¼ŒæŸå¤±å‡½æ•°ä¸ºï¼š
$$
L(\mu) = \mathbb{E}[(X - \mu)^2] = \mathbb{E}[X^2] - 2\mu\mathbb{E}[X] + \mu^2
$$</p>
<p>æ±‚å¯¼å¹¶ä»¤å…¶ä¸ºé›¶ï¼š
$$
\frac{dL}{d\mu} = -2\mathbb{E}[X] + 2\mu = 0 \quad \Rightarrow \quad \mu^* = \mathbb{E}[X]
$$</p>
<p>äºŒé˜¶å¯¼æ•°$\frac{d^2L}{d\mu^2} = 2 &gt; 0$ï¼Œç¡®è®¤è¿™æ˜¯æœ€å°å€¼ç‚¹ã€‚</p>
<p><strong>åº”ç”¨åˆ°æˆ‘ä»¬çš„é—®é¢˜</strong>ï¼š</p>
<p>æˆ‘ä»¬è¦ä¼°è®¡$\mathbb{E}_{\boldsymbol{x}_0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}[\boldsymbol{x}_0]$ï¼Œæ ¹æ®å¼(11)ï¼š
$$
\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) = \mathop{\text{argmin}}_{\boldsymbol{\mu}}\mathbb{E}_{\boldsymbol{x}_0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\Vert \boldsymbol{x}_0 - \boldsymbol{\mu}\Vert^2\right] \tag{12}
$$</p>
<p><strong>é—®é¢˜</strong>ï¼š$\boldsymbol{\mu}$ä¾èµ–äº$\boldsymbol{x}_t$ï¼Œæ‰€ä»¥éœ€è¦å­¦ä¹ ä¸€ä¸ªå‡½æ•°$\boldsymbol{\mu}(\boldsymbol{x}_t)$ã€‚</p>
<p><strong>å±•å¼€ä¸ºå¯è®­ç»ƒçš„å½¢å¼</strong>ï¼š</p>
<p>$$
\begin{aligned}
\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) &= \mathop{\text{argmin}}_{\boldsymbol{\mu}(\boldsymbol{x}_t)}\mathbb{E}_{\boldsymbol{x}_t\sim p(\boldsymbol{x}_t)}\mathbb{E}_{\boldsymbol{x}_0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left\Vert \boldsymbol{x}_0 - \boldsymbol{\mu}(\boldsymbol{x}_t)\right\Vert^2\right] \\
&= \mathop{\text{argmin}}_{\boldsymbol{\mu}(\boldsymbol{x}_t)}\mathbb{E}_{\boldsymbol{x}_0\sim \tilde{p}(\boldsymbol{x}_0)}\mathbb{E}_{\boldsymbol{x}_t\sim p(\boldsymbol{x}_t|\boldsymbol{x}_0)}\left[\left\Vert \boldsymbol{x}_0 - \boldsymbol{\mu}(\boldsymbol{x}_t)\right\Vert^2\right]
\end{aligned} \tag{13}
$$</p>
<p><strong>ä¸ºä»€ä¹ˆå¯ä»¥äº¤æ¢æœŸæœ›é¡ºåºï¼Ÿ</strong></p>
<p>æ ¹æ®å…¨æ¦‚ç‡å…¬å¼å’Œè´å¶æ–¯å®šç†ï¼š
$$
p(\boldsymbol{x}_t, \boldsymbol{x}_0) = p(\boldsymbol{x}_0|\boldsymbol{x}_t)p(\boldsymbol{x}_t) = p(\boldsymbol{x}_t|\boldsymbol{x}_0)\tilde{p}(\boldsymbol{x}_0)
$$</p>
<p>å› æ­¤å¯¹$(\boldsymbol{x}_t, \boldsymbol{x}_0)$çš„è”åˆæœŸæœ›å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼åˆ†è§£ã€‚</p>
<p><strong>å‚æ•°åŒ–æŠ€å·§</strong>ï¼š</p>
<p>å›å¿†å‰å‘è¿‡ç¨‹ï¼š$\boldsymbol{x}_t = \bar{\alpha}_t \boldsymbol{x}_0 + \bar{\beta}_t \boldsymbol{\varepsilon}$ï¼Œå¯ä»¥åè§£ï¼š
$$
\boldsymbol{x}_0 = \frac{1}{\bar{\alpha}_t}(\boldsymbol{x}_t - \bar{\beta}_t \boldsymbol{\varepsilon}) \tag{14}
$$</p>
<p>è¿™å¯å‘æˆ‘ä»¬å‚æ•°åŒ–ï¼š
$$
\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) = \frac{1}{\bar{\alpha}_t}\left(\boldsymbol{x}_t - \bar{\beta}_t \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right) \tag{15}
$$</p>
<p>å…¶ä¸­$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$æ˜¯ç¥ç»ç½‘ç»œï¼Œç”¨æ¥é¢„æµ‹å™ªå£°$\boldsymbol{\varepsilon}$ã€‚</p>
<p><strong>ä»£å…¥å¼(13)</strong>ï¼š</p>
<p>$$
\begin{aligned}
&\mathbb{E}_{\boldsymbol{x}_0\sim \tilde{p}(\boldsymbol{x}_0), \boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I})}\left[\left\Vert \boldsymbol{x}_0 - \frac{1}{\bar{\alpha}_t}\left(\bar{\alpha}_t \boldsymbol{x}_0 + \bar{\beta}_t \boldsymbol{\varepsilon} - \bar{\beta}_t \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\bar{\alpha}_t \boldsymbol{x}_0 + \bar{\beta}_t \boldsymbol{\varepsilon}, t)\right)\right\Vert^2\right] \\
&= \mathbb{E}_{\boldsymbol{x}_0\sim \tilde{p}(\boldsymbol{x}_0), \boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I})}\left[\left\Vert \frac{\bar{\beta}_t}{\bar{\alpha}_t}\left(\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\bar{\alpha}_t \boldsymbol{x}_0 + \bar{\beta}_t \boldsymbol{\varepsilon}, t)\right)\right\Vert^2\right] \\
&\propto \mathbb{E}_{\boldsymbol{x}_0\sim \tilde{p}(\boldsymbol{x}_0), \boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I})}\left[\left\Vert\boldsymbol{\varepsilon} - \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\bar{\alpha}_t \boldsymbol{x}_0 + \bar{\beta}_t \boldsymbol{\varepsilon}, t)\right\Vert^2\right]
\end{aligned} \tag{16}
$$</p>
<p>è¿™æ­£æ˜¯DDPMçš„æ ‡å‡†è®­ç»ƒæŸå¤±ï¼</p>
<h3 id="5-1">5. æ–¹å·®ä¼°è®¡æ–¹æ³•1ï¼šåŸºäºåæ–¹å·®å®šä¹‰</h3>
<p><strong>ç›®æ ‡</strong>ï¼šä¼°è®¡$\bar{\sigma}_t^2 = \frac{1}{d}\text{Tr}[\boldsymbol{\Sigma}_t]$ï¼Œå…¶ä¸­$\boldsymbol{\Sigma}_t$æ˜¯$p(\boldsymbol{x}_0|\boldsymbol{x}_t)$çš„åæ–¹å·®çŸ©é˜µã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šåæ–¹å·®çŸ©é˜µçš„å®šä¹‰</strong></p>
<p>å¯¹äºéšæœºå˜é‡$\boldsymbol{X}$ï¼Œå…¶åæ–¹å·®çŸ©é˜µä¸ºï¼š
$$
\boldsymbol{\Sigma} = \mathbb{E}[(\boldsymbol{X} - \boldsymbol{\mu})(\boldsymbol{X} - \boldsymbol{\mu})^{\top}] \tag{17}
$$</p>
<p>å…¶ä¸­$\boldsymbol{\mu} = \mathbb{E}[\boldsymbol{X}]$ã€‚</p>
<p><strong>åº”ç”¨åˆ°æˆ‘ä»¬çš„æƒ…å†µ</strong>ï¼š</p>
<p>$$
\boldsymbol{\Sigma}(\boldsymbol{x}_t) = \mathbb{E}_{\boldsymbol{x}_0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)}\left[\left(\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\right)\left(\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\right)^{\top}\right] \tag{18}
$$</p>
<p><strong>ç¬¬äºŒæ­¥ï¼šå¼•å…¥è¾…åŠ©å¸¸å‘é‡</strong></p>
<p>ä¸ºäº†ç®€åŒ–è®¡ç®—ï¼Œå¼•å…¥ä»»æ„å¸¸å‘é‡$\boldsymbol{\mu}_0$ï¼ˆä¸$\boldsymbol{x}_t$æ— å…³ï¼‰ï¼š
$$
\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) = (\boldsymbol{x}_0 - \boldsymbol{\mu}_0) - (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0) \tag{19}
$$</p>
<p><strong>ä¸ºä»€ä¹ˆè¿™æ ·åšï¼Ÿ</strong></p>
<p>å±•å¼€å¼(18)ä¸­çš„å¤–ç§¯ï¼š
$$
\begin{aligned}
&\left(\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\right)\left(\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)\right)^{\top} \\
&= \left[(\boldsymbol{x}_0 - \boldsymbol{\mu}_0) - (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)\right]\left[(\boldsymbol{x}_0 - \boldsymbol{\mu}_0) - (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)\right]^{\top}
\end{aligned}
$$</p>
<p><strong>å±•å¼€è¿™ä¸ªå¤–ç§¯</strong>ï¼ˆåˆ©ç”¨$(A-B)(A-B)^{\top} = AA^{\top} - AB^{\top} - BA^{\top} + BB^{\top}$ï¼‰ï¼š</p>
<p>$$
\begin{aligned}
&= (\boldsymbol{x}_0 - \boldsymbol{\mu}_0)(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)^{\top} \\
&\quad - (\boldsymbol{x}_0 - \boldsymbol{\mu}_0)(\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)^{\top} \\
&\quad - (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)^{\top} \\
&\quad + (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)(\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)^{\top}
\end{aligned} \tag{20}
$$</p>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šå¯¹$\boldsymbol{x}_0\sim p(\boldsymbol{x}_0|\boldsymbol{x}_t)$æ±‚æœŸæœ›</strong></p>
<ul>
<li>ç¬¬1é¡¹ï¼š$\mathbb{E}_{\boldsymbol{x}_0}[(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)^{\top}]$ ä¿ç•™</li>
<li>ç¬¬2é¡¹å’Œç¬¬3é¡¹ï¼šæ³¨æ„åˆ°$\bar{\boldsymbol{\mu}}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t)$ä¸ä¾èµ–$\boldsymbol{x}_0$ï¼ˆç»™å®š$\boldsymbol{x}_t$åï¼‰ï¼Œå¹¶ä¸”$\mathbb{E}</em>_0$ï¼Œæ‰€ä»¥ï¼š}_0}[\boldsymbol{x}_0 - \boldsymbol{\mu}_0] = \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu</li>
</ul>
<p>$$
\begin{aligned}
&\mathbb{E}_{\boldsymbol{x}_0}[(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)(\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)^{\top}] \\
&= \mathbb{E}_{\boldsymbol{x}_0}[(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)](\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)^{\top} \\
&= (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)(\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)^{\top}
\end{aligned}
$$</p>
<ul>
<li>ç¬¬4é¡¹ï¼šä¸ä¾èµ–$\boldsymbol{x}_0$ï¼Œç›´æ¥ä¿ç•™</li>
</ul>
<p><strong>åˆå¹¶</strong>ï¼š</p>
<p>$$
\boldsymbol{\Sigma}(\boldsymbol{x}_t) = \mathbb{E}_{\boldsymbol{x}_0}[(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)^{\top}] - (\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)(\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)^{\top} \tag{21}
$$</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šè¿™æ˜¯<strong>æ–¹å·®åˆ†è§£å…¬å¼</strong>çš„çŸ©é˜µå½¢å¼ï¼Œç±»ä¼¼äºï¼š
$$
\text{Var}[X] = \mathbb{E}[X^2] - (\mathbb{E}[X])^2
$$</p>
<p><strong>ç¬¬å››æ­¥ï¼šç®€åŒ–ä¸ºæ ‡é‡</strong></p>
<p>æˆ‘ä»¬éœ€è¦å„å‘åŒæ€§çš„æ–¹å·®$\bar{\sigma}_t^2 \boldsymbol{I}$ï¼Œæ‰€ä»¥ï¼š</p>
<ol>
<li>
<p>å¯¹$\boldsymbol{x}_t$æ±‚æœŸæœ›ï¼ˆæ¶ˆé™¤å¯¹$\boldsymbol{x}_t$çš„ä¾èµ–ï¼‰ï¼š
$$
\boldsymbol{\Sigma}_t = \mathbb{E}_{\boldsymbol{x}_t}[\boldsymbol{\Sigma}(\boldsymbol{x}_t)]
$$</p>
</li>
<li>
<p>å–å¯¹è§’çº¿å…ƒç´ çš„å¹³å‡ï¼ˆå¾—åˆ°æ ‡é‡æ–¹å·®ï¼‰ï¼š
$$
\bar{\sigma}_t^2 = \frac{1}{d}\text{Tr}[\boldsymbol{\Sigma}_t]
$$</p>
</li>
</ol>
<p><strong>è¯¦ç»†è®¡ç®—</strong>ï¼š</p>
<p>$$
\begin{aligned}
\bar{\sigma}_t^2 &= \frac{1}{d}\mathbb{E}_{\boldsymbol{x}_t}\left[\text{Tr}\left(\mathbb{E}_{\boldsymbol{x}_0}[(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)(\boldsymbol{x}_0 - \boldsymbol{\mu}_0)^{\top}]\right)\right] \\
&\quad - \frac{1}{d}\mathbb{E}_{\boldsymbol{x}_t}\left[\text{Tr}\left((\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)(\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0)^{\top}\right)\right]
\end{aligned}
$$</p>
<p>åˆ©ç”¨$\text{Tr}[\boldsymbol{v}\boldsymbol{v}^{\top}] = \Vert\boldsymbol{v}\Vert^2$ï¼š</p>
<p>$$
\begin{aligned}
\bar{\sigma}_t^2 &= \frac{1}{d}\mathbb{E}_{\boldsymbol{x}_t}\mathbb{E}_{\boldsymbol{x}_0}\left[\Vert\boldsymbol{x}_0 - \boldsymbol{\mu}_0\Vert^2\right] - \frac{1}{d}\mathbb{E}_{\boldsymbol{x}_t}\left[\Vert\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0\Vert^2\right] \\
&= \frac{1}{d}\mathbb{E}_{\boldsymbol{x}_0}\left[\Vert\boldsymbol{x}_0 - \boldsymbol{\mu}_0\Vert^2\right] - \frac{1}{d}\mathbb{E}_{\boldsymbol{x}_t}\left[\Vert\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \boldsymbol{\mu}_0\Vert^2\right]
\end{aligned} \tag{22}
$$</p>
<p><strong>ç‰¹æ®Šæƒ…å†µ</strong>ï¼šå–$\boldsymbol{\mu}_0 = \mathbb{E}[\boldsymbol{x}_0]$ï¼ˆçœŸå®æ•°æ®çš„å‡å€¼ï¼‰ï¼Œåˆ™ï¼š
$$
\bar{\sigma}_t^2 = \text{Var}[\boldsymbol{x}_0] - \frac{1}{d}\mathbb{E}_{\boldsymbol{x}_t}\left[\Vert\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) - \mathbb{E}[\boldsymbol{x}_0]\Vert^2\right] \tag{23}
$$</p>
<p><strong>ä¸Šç•Œä¼°è®¡</strong>ï¼š</p>
<p>å¦‚æœæ•°æ®èŒƒå›´åœ¨$[a,b]$ï¼Œæ ¹æ®æ–¹å·®çš„æ€§è´¨ï¼š
$$
\text{Var}[\boldsymbol{x}_0] \leq \left(\frac{b-a}{2}\right)^2
$$</p>
<p>å› æ­¤ï¼š
$$
\bar{\sigma}_t^2 \leq \left(\frac{b-a}{2}\right)^2 \tag{24}
$$</p>
<h3 id="6-2">6. æ–¹å·®ä¼°è®¡æ–¹æ³•2ï¼šåŸºäºå™ªå£°é¢„æµ‹</h3>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼šç›´æ¥åˆ©ç”¨å™ªå£°é¢„æµ‹æ¨¡å‹$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$æ¥è®¡ç®—æ–¹å·®ã€‚</p>
<p><strong>ç¬¬ä¸€æ­¥ï¼šå°†$\boldsymbol{\mu}$çš„å‚æ•°åŒ–ä»£å…¥</strong></p>
<p>å›å¿†å¼(15)ï¼š
$$
\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) = \frac{1}{\bar{\alpha}_t}\left(\boldsymbol{x}_t - \bar{\beta}_t \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right)
$$</p>
<p>ä»£å…¥å¼(18)ï¼š
$$
\begin{aligned}
\boldsymbol{\Sigma}(\boldsymbol{x}_t) &= \mathbb{E}_{\boldsymbol{x}_0}\left[\left(\boldsymbol{x}_0 - \frac{1}{\bar{\alpha}_t}\left(\boldsymbol{x}_t - \bar{\beta}_t \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right)\right)\left(\boldsymbol{x}_0 - \frac{1}{\bar{\alpha}_t}\left(\boldsymbol{x}_t - \bar{\beta}_t \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\right)\right)^{\top}\right]
\end{aligned}
$$</p>
<p><strong>ç¬¬äºŒæ­¥ï¼šé‡æ–°ç»„ç»‡</strong></p>
<p>æ³¨æ„åˆ°$\boldsymbol{x}_0 = \frac{1}{\bar{\alpha}_t}(\boldsymbol{x}_t - \bar{\beta}_t\boldsymbol{\varepsilon})$ï¼ˆçœŸå®å…³ç³»ï¼‰ï¼Œæ‰€ä»¥ï¼š
$$
\boldsymbol{x}_0 - \frac{1}{\bar{\alpha}_t}\boldsymbol{x}_t = -\frac{\bar{\beta}_t}{\bar{\alpha}_t}\boldsymbol{\varepsilon}
$$</p>
<p>å› æ­¤ï¼š
$$
\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) = -\frac{1}{\bar{\alpha}_t}\boldsymbol{x}_t + \frac{\bar{\beta}_t}{\bar{\alpha}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) - \boldsymbol{x}_0 + \frac{1}{\bar{\alpha}_t}\boldsymbol{x}_t = \frac{\bar{\beta}_t}{\bar{\alpha}_t}\left(\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) - \boldsymbol{\varepsilon}\right)
$$</p>
<p>ç­‰ç­‰ï¼Œè®©æˆ‘ä»¬æ›´ä»”ç»†åœ°å¤„ç†ï¼š</p>
<p>$$
\begin{aligned}
\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) &= \boldsymbol{x}_0 - \frac{1}{\bar{\alpha}_t}\boldsymbol{x}_t + \frac{\bar{\beta}_t}{\bar{\alpha}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) \\
&= \left(\boldsymbol{x}_0 - \frac{1}{\bar{\alpha}_t}\boldsymbol{x}_t\right) + \frac{\bar{\beta}_t}{\bar{\alpha}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)
\end{aligned} \tag{25}
$$</p>
<p><strong>ç¬¬ä¸‰æ­¥ï¼šåˆ©ç”¨å‰å‘è¿‡ç¨‹çš„å…³ç³»</strong></p>
<p>ä»$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š
$$
\boldsymbol{x}_0 - \frac{\boldsymbol{x}_t}{\bar{\alpha}_t} = \boldsymbol{x}_0 - \boldsymbol{x}_0 - \frac{\bar{\beta}_t}{\bar{\alpha}_t}\boldsymbol{\varepsilon} = -\frac{\bar{\beta}_t}{\bar{\alpha}_t}\boldsymbol{\varepsilon}
$$</p>
<p>ä»£å…¥å¼(25)ï¼š
$$
\boldsymbol{x}_0 - \bar{\boldsymbol{\mu}}(\boldsymbol{x}_t) = -\frac{\bar{\beta}_t}{\bar{\alpha}_t}\boldsymbol{\varepsilon} + \frac{\bar{\beta}_t}{\bar{\alpha}_t}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) = \frac{\bar{\beta}_t}{\bar{\alpha}_t}\left(\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) - \boldsymbol{\varepsilon}\right) \tag{26}
$$</p>
<p><strong>ç¬¬å››æ­¥ï¼šè®¡ç®—åæ–¹å·®</strong></p>
<p>$$
\begin{aligned}
\boldsymbol{\Sigma}(\boldsymbol{x}_t) &= \mathbb{E}_{\boldsymbol{x}_0}\left[\frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\left(\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) - \boldsymbol{\varepsilon}\right)\left(\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) - \boldsymbol{\varepsilon}\right)^{\top}\right] \\
&= \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\mathbb{E}_{\boldsymbol{x}_0}\left[\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)^{\top} - \boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\boldsymbol{\varepsilon}^{\top} - \boldsymbol{\varepsilon}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)^{\top} + \boldsymbol{\varepsilon}\boldsymbol{\varepsilon}^{\top}\right]
\end{aligned}
$$</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼š$\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$æ˜¯$\boldsymbol{x}_t$çš„å‡½æ•°ï¼Œè€Œ$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$åŒæ—¶ä¾èµ–$\boldsymbol{x}_0$å’Œ$\boldsymbol{\varepsilon}$ã€‚</p>
<p>ä½†åœ¨ç»™å®š$\boldsymbol{x}_t$åï¼Œå¯¹$\boldsymbol{x}_0$ï¼ˆç­‰ä»·äºå¯¹$\boldsymbol{\varepsilon}$ï¼‰ç§¯åˆ†æ—¶ï¼š
$$
\mathbb{E}_{\boldsymbol{x}_0|\boldsymbol{x}_t}[\boldsymbol{\varepsilon}] = \mathbb{E}\left[\frac{\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0}{\bar{\beta}_t}\right] = \frac{\boldsymbol{x}_t - \bar{\alpha}_t\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)}{\bar{\beta}_t}
$$</p>
<p>è¿™å˜å¾—å¤æ‚äº†ã€‚è®©æˆ‘ä»¬æ¢ä¸ªè§’åº¦ã€‚</p>
<p><strong>æ¢ä¸ªè§†è§’ï¼šå¯¹$\boldsymbol{x}_t$ç§¯åˆ†</strong></p>
<p>$$
\begin{aligned}
\boldsymbol{\Sigma}_t &= \mathbb{E}_{\boldsymbol{x}_t}[\boldsymbol{\Sigma}(\boldsymbol{x}_t)] \\
&= \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\mathbb{E}_{\boldsymbol{x}_t}\mathbb{E}_{\boldsymbol{x}_0|\boldsymbol{x}_t}\left[\left(\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) - \boldsymbol{\varepsilon}\right)\left(\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) - \boldsymbol{\varepsilon}\right)^{\top}\right] \\
&= \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\mathbb{E}_{\boldsymbol{x}_0, \boldsymbol{x}_t}\left[\left(\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) - \boldsymbol{\varepsilon}\right)\left(\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t) - \boldsymbol{\varepsilon}\right)^{\top}\right] \\
&= \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\left(\mathbb{E}_{\boldsymbol{x}_t}\left[\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)^{\top}\right] - \mathbb{E}_{\boldsymbol{x}_0,\boldsymbol{\varepsilon}}\left[\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\boldsymbol{\varepsilon}^{\top}\right] - \mathbb{E}_{\boldsymbol{x}_0,\boldsymbol{\varepsilon}}\left[\boldsymbol{\varepsilon}\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)^{\top}\right] + \boldsymbol{I}\right)
\end{aligned}
$$</p>
<p><strong>ç®€åŒ–äº¤å‰é¡¹</strong>ï¼š</p>
<p>å¦‚æœ$\boldsymbol{\epsilon}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}$è®­ç»ƒå¾—å¾ˆå¥½ï¼Œé‚£ä¹ˆ$\mathbb{E}[\boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t)\boldsymbol{\varepsilon}^{\top}] \approx \boldsymbol{I}$ï¼ˆå› ä¸º$\boldsymbol{\epsilon}</em>$ï¼‰ã€‚}} \approx \boldsymbol{\varepsilon</p>
<p>ä½†ä¸¥æ ¼æ¥è¯´ï¼Œæˆ‘ä»¬éœ€è¦ç”¨$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$æ¥åˆ†æã€‚ç»è¿‡è¯¦ç»†è®¡ç®—ï¼ˆåŸæ–‡ä¸­è·³è¿‡äº†å¾ˆå¤šæ­¥éª¤ï¼‰ï¼Œæœ€ç»ˆå¯ä»¥å¾—åˆ°ï¼š</p>
<p>$$
\boldsymbol{\Sigma}_t = \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\left(\boldsymbol{I} - \mathbb{E}_{\boldsymbol{x}_t}\left[\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)^{\top}\right]\right) \tag{27}
$$</p>
<p><strong>ä¸ºä»€ä¹ˆï¼Ÿå…³é”®å¼•ç†</strong>ï¼š</p>
<p>å¯¹äºå‰å‘è¿‡ç¨‹$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ï¼Œæœ‰ï¼š
$$
\mathbb{E}_{\boldsymbol{x}_0,\boldsymbol{\varepsilon}}\left[(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0)(\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0)^{\top}\right] = \bar{\beta}_t^2\boldsymbol{I}
$$</p>
<p>è¿™æ˜¯å› ä¸º$\boldsymbol{x}_t - \bar{\alpha}_t\boldsymbol{x}_0 = \bar{\beta}_t\boldsymbol{\varepsilon}$ï¼Œè€Œ$\mathbb{E}[\boldsymbol{\varepsilon}\boldsymbol{\varepsilon}^{\top}] = \boldsymbol{I}$ã€‚</p>
<p><strong>æœ€ç»ˆæ ‡é‡å½¢å¼</strong>ï¼š</p>
<p>$$
\bar{\sigma}_t^2 = \frac{1}{d}\text{Tr}[\boldsymbol{\Sigma}_t] = \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2}\left(1 - \frac{1}{d}\mathbb{E}_{\boldsymbol{x}_t}\left[\Vert\boldsymbol{\epsilon}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)\Vert^2\right]\right) \tag{28}
$$</p>
<p><strong>ä¸Šç•Œ</strong>ï¼š
$$
\bar{\sigma}_t^2 \leq \frac{\bar{\beta}_t^2}{\bar{\alpha}_t^2} \tag{29}
$$</p>
<h3 id="7">7. ä¸¤ç§æ–¹æ³•çš„æ¯”è¾ƒ</h3>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>ä¼˜ç‚¹</th>
<th>ç¼ºç‚¹</th>
<th>é€‚ç”¨åœºæ™¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ–¹æ³•1 (å¼22)</td>
<td>ç›´è§‚ï¼ŒåŸºäºåæ–¹å·®å®šä¹‰</td>
<td>éœ€è¦è®¡ç®—ä¸¤ä¸ªæœŸæœ›é¡¹</td>
<td>ç†è®ºåˆ†æ</td>
</tr>
<tr>
<td>æ–¹æ³•2 (å¼28)</td>
<td>ç›´æ¥åˆ©ç”¨å™ªå£°é¢„æµ‹</td>
<td>å½¢å¼ç•¥å¤æ‚</td>
<td>å®é™…åº”ç”¨</td>
</tr>
</tbody>
</table>
<p><strong>æ•°å­¦è”ç³»</strong>ï¼š</p>
<p>ä¸¤ç§æ–¹æ³•åœ¨ç†è®ºä¸Šæ˜¯ç­‰ä»·çš„ï¼Œéƒ½åŸºäºåŒä¸€ä¸ªåæ–¹å·®çŸ©é˜µã€‚å·®å¼‚åœ¨äºï¼š
- æ–¹æ³•1é€šè¿‡æ•°æ®å‡å€¼$\boldsymbol{\mu}_0$æ¥åˆ†è§£
- æ–¹æ³•2é€šè¿‡å™ªå£°$\boldsymbol{\varepsilon}$æ¥åˆ†è§£</p>
<h3 id="8">8. æ€»ç»“ä¸æ·±å±‚ç†è§£</h3>
<p><strong>æ ¸å¿ƒæ´å¯Ÿ</strong>ï¼š</p>
<ol>
<li>
<p><strong>ä¸ç¡®å®šæ€§ä¼ æ’­</strong>ï¼šå³ä½¿æˆ‘ä»¬å®Œç¾åœ°è®­ç»ƒäº†$\bar{\boldsymbol{\mu}}(\boldsymbol{x}_t)$ï¼Œç”±äº$\boldsymbol{x}_0$çš„é¢„æµ‹å­˜åœ¨ä¸ç¡®å®šæ€§ï¼Œç”Ÿæˆè¿‡ç¨‹ä»ç„¶éœ€è¦éé›¶æ–¹å·®ã€‚</p>
</li>
<li>
<p><strong>æ–¹å·®åˆ†è§£</strong>ï¼š
   $$
   \underbrace{\sigma_t^2}_{\text{DDIMè®¾å®š}} + \underbrace{\gamma_t^2\bar{\sigma}_t^2}_{\text{ä¸ç¡®å®šæ€§ä¿®æ­£}} = \text{çœŸå®æœ€ä¼˜æ–¹å·®}
   $$</p>
</li>
<li>
<p><strong>æ­¥æ•°ä¾èµ–</strong>ï¼šå½“ç”Ÿæˆæ­¥æ•°$T$è¾ƒå°æ—¶ï¼Œ$\bar{\sigma}_t^2$è¾ƒå¤§ï¼Œä¿®æ­£é¡¹$\gamma_t^2\bar{\sigma}_t^2$çš„ä½œç”¨æ›´æ˜¾è‘—ã€‚</p>
</li>
</ol>
<p><strong>å®è·µæ„ä¹‰</strong>ï¼š</p>
<ul>
<li>DDPMçš„ä¸¤ä¸ªæ–¹å·®é€‰æ‹©$\beta_t$å’Œ$\frac{\bar{\beta}_{t-1}}{\bar{\beta}_t}\beta_t$å¯ä»¥çœ‹ä½œæ˜¯å¼(28)åœ¨ç‰¹æ®Šæ•°æ®åˆ†å¸ƒå‡è®¾ä¸‹çš„è§£</li>
<li>Analytic-DPMæä¾›äº†æ— éœ€é‡æ–°è®­ç»ƒå°±èƒ½æ”¹å–„ç”Ÿæˆæ•ˆæœçš„æ–¹æ³•</li>
<li>å¯¹äºåŠ é€Ÿé‡‡æ ·ï¼ˆå°‘æ­¥ç”Ÿæˆï¼‰ç‰¹åˆ«æœ‰æ•ˆ</li>
</ul>
<p><strong>æœªæ¥æ–¹å‘</strong>ï¼š</p>
<ol>
<li>èƒ½å¦è®¾è®¡è‡ªé€‚åº”çš„æ–¹å·®ä¼°è®¡ï¼Œæ ¹æ®å½“å‰$\boldsymbol{x}_t$åŠ¨æ€è°ƒæ•´ï¼Ÿ</li>
<li>æ–¹å·®ä¼°è®¡æ˜¯å¦å¯ä»¥é€šè¿‡ç¥ç»ç½‘ç»œå­¦ä¹ è€Œéè§£æè®¡ç®—ï¼Ÿ</li>
<li>å¦‚ä½•æ¨å¹¿åˆ°å…¶ä»–ç±»å‹çš„æ‰©æ•£æ¨¡å‹ï¼ˆå¦‚LDMã€VDMç­‰ï¼‰ï¼Ÿ</li>
</ol>
        </div>
    </div>
</body>
</html>