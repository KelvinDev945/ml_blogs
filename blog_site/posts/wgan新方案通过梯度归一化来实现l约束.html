<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WGANæ–°æ–¹æ¡ˆï¼šé€šè¿‡æ¢¯åº¦å½’ä¸€åŒ–æ¥å®ç°Lçº¦æŸ</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>WGANæ–°æ–¹æ¡ˆï¼šé€šè¿‡æ¢¯åº¦å½’ä¸€åŒ–æ¥å®ç°Lçº¦æŸ</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 29.1 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8757">https://spaces.ac.cn/archives/8757</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å½“å‰ï¼ŒWGANä¸»æµçš„å®ç°æ–¹å¼åŒ…æ‹¬å‚æ•°è£å‰ªï¼ˆWeight Clippingï¼‰ã€è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰ã€æ¢¯åº¦æƒ©ç½šï¼ˆGradient Penaltyï¼‰ï¼Œæœ¬æ¥åˆ™æ¥ä»‹ç»ä¸€ç§æ–°çš„å®ç°æ–¹æ¡ˆï¼šæ¢¯åº¦å½’ä¸€åŒ–ï¼ˆGradient Normalizationï¼‰ï¼Œè¯¥æ–¹æ¡ˆå‡ºè‡ªä¸¤ç¯‡æœ‰æ„æ€çš„è®ºæ–‡ï¼Œåˆ†åˆ«æ˜¯<a href="https://papers.cool/arxiv/2109.02235">ã€ŠGradient Normalization for Generative Adversarial Networksã€‹</a>å’Œ<a href="https://papers.cool/arxiv/2111.03162">ã€ŠGraN-GAN: Piecewise Gradient Normalization for Generative Adversarial Networksã€‹</a>ã€‚</p>
<p>æœ‰æ„æ€åœ¨ä»€ä¹ˆåœ°æ–¹å‘¢ï¼Ÿä»æ ‡é¢˜å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸¤ç¯‡è®ºæ–‡åº”è¯¥æ˜¯é«˜åº¦é‡åˆçš„ï¼Œç”šè‡³åº”è¯¥æ˜¯åŒä¸€ä½œè€…çš„ã€‚ä½†äº‹å®ä¸Šï¼Œè¿™æ˜¯ä¸¤ç¯‡ä¸åŒå›¢é˜Ÿçš„ã€å¤§è‡´æ˜¯åŒä¸€æ—¶æœŸçš„è®ºæ–‡ï¼Œä¸€ç¯‡ä¸­äº†ICCVï¼Œä¸€ç¯‡ä¸­äº†WACVï¼Œå®ƒä»¬åŸºäºåŒæ ·çš„å‡è®¾æ¨å‡ºäº†å‡ ä¹ä¸€æ ·çš„è§£å†³æ–¹æ¡ˆï¼Œå†…å®¹é‡åˆåº¦ä¹‹é«˜è®©æˆ‘ä¸€ç›´ä»¥ä¸ºæ˜¯åŒä¸€ç¯‡è®ºæ–‡ã€‚æœç„¶æ˜¯å·§åˆæ— å¤„ä¸åœ¨å•Šï½</p>
<h2 id="_1">åŸºç¡€å›é¡¾</h2>
<p>å…³äºWGANï¼Œæˆ‘ä»¬å·²ç»ä»‹ç»è¿‡å¤šæ¬¡ï¼Œæ¯”å¦‚<a href="/archives/4439">ã€Šäº’æ€¼çš„è‰ºæœ¯ï¼šä»é›¶ç›´è¾¾WGAN-GPã€‹</a>å’Œ<a href="/archives/6280">ã€Šä»Wassersteinè·ç¦»ã€å¯¹å¶ç†è®ºåˆ°WGANã€‹</a>ï¼Œè¿™é‡Œå°±ä¸è¯¦ç»†é‡å¤äº†ã€‚ç®€å•æ¥è¯´ï¼ŒWGANçš„è¿­ä»£å½¢å¼ä¸ºï¼š<br />
\begin{equation}\min_G \max_{\Vert D\Vert_{L}\leq 1} \mathbb{E}<em q_z_="q(z)" z_sim="z\sim">{x\sim p(x)}\left[D(x)\right] - \mathbb{E}</em>}\left[D(G(z))\right]\end{equation<br />
è¿™é‡Œçš„å…³é”®æ˜¯åˆ¤åˆ«å™¨$D$æ˜¯ä¸€ä¸ªå¸¦çº¦æŸä¼˜åŒ–é—®é¢˜ï¼Œéœ€è¦åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­æ»¡è¶³Lçº¦æŸ$\Vert D\Vert_{L}\leq 1$ï¼Œæ‰€ä»¥WGANçš„å®ç°éš¾åº¦å°±æ˜¯å¦‚ä½•å¾€$D$é‡Œè¾¹å¼•å…¥è¯¥çº¦æŸã€‚</p>
<p>è¿™é‡Œå†æ™®åŠä¸€ä¸‹ï¼Œå¦‚æœå­˜åœ¨æŸä¸ªå¸¸æ•°$C$ï¼Œä½¿å¾—å®šä¹‰åŸŸä¸­çš„ä»»æ„$x,y$éƒ½æ»¡è¶³$|f(x)-f(y)|\leq C\Vert x - y\Vert$ï¼Œé‚£ä¹ˆæˆ‘ä»¬ç§°$f(x)$æ»¡è¶³<a href="/archives/6051">Lipschitzçº¦æŸ</a>ï¼ˆLçº¦æŸï¼‰ï¼Œå…¶ä¸­$C$çš„æœ€å°å€¼ï¼Œæˆ‘ä»¬ç§°ä¸ºLipschitzå¸¸æ•°ï¼ˆLå¸¸æ•°ï¼‰ï¼Œè®°ä¸º$\Vert f\Vert_{L}$ã€‚æ‰€ä»¥ï¼Œå¯¹äºWGANåˆ¤åˆ«å™¨æ¥è¯´ï¼Œè¦åšåˆ°ä¸¤æ­¥ï¼š1ã€$D$è¦æ»¡è¶³Lçº¦æŸï¼›2ã€Lå¸¸æ•°è¦ä¸è¶…è¿‡1ã€‚</p>
<p>äº‹å®ä¸Šï¼Œå½“å‰æˆ‘ä»¬ä¸»æµçš„ç¥ç»ç½‘ç»œæ¨¡å‹ï¼Œéƒ½æ˜¯â€œçº¿æ€§ç»„åˆ+éçº¿æ€§æ¿€æ´»å‡½æ•°â€çš„å½¢å¼ï¼Œè€Œä¸»æµçš„æ¿€æ´»å‡½æ•°æ˜¯â€œè¿‘çº¿æ€§çš„â€ï¼Œæ¯”å¦‚ReLUã€LeakyReLUã€SoftPlusç­‰ï¼Œå®ƒä»¬çš„å¯¼å‡½æ•°çš„ç»å¯¹å€¼éƒ½ä¸è¶…è¿‡1ï¼Œæ‰€ä»¥å½“å‰ä¸»æµçš„æ¨¡å‹å…¶å®éƒ½æ»¡è¶³Lçº¦æŸï¼Œæ‰€ä»¥å…³é”®æ˜¯å¦‚ä½•è®©Lå¸¸æ•°ä¸è¶…è¿‡1ï¼Œå½“ç„¶å…¶å®ä¹Ÿä¸ç”¨é1ä¸å¯ï¼Œèƒ½ä¿è¯å®ƒä¸è¶…è¿‡æŸä¸ªå›ºå®šå¸¸æ•°å°±è¡Œã€‚</p>
<h2 id="_2">æ–¹æ¡ˆç®€ä»‹</h2>
<p>å‚æ•°è£å‰ªå’Œè°±å½’ä¸€åŒ–çš„æ€è·¯æ˜¯ç›¸ä¼¼çš„ï¼Œå®ƒä»¬éƒ½æ˜¯é€šè¿‡çº¦æŸå‚æ•°ï¼Œä¿è¯æ¨¡å‹æ¯ä¸€å±‚çš„Lå¸¸æ•°éƒ½æœ‰ç•Œï¼Œæ‰€ä»¥æ€»çš„Lå¸¸æ•°ä¹Ÿæœ‰ç•Œï¼›è€Œæ¢¯åº¦æƒ©ç½šåˆ™æ˜¯ç•™æ„åˆ°$\Vert D\Vert_{L}\leq 1$çš„ä¸€ä¸ªå……åˆ†æ¡ä»¶æ˜¯$\Vert \nabla_x D(x)\Vert \leq 1$ï¼Œæ‰€ä»¥å°±é€šè¿‡æƒ©ç½šé¡¹$(\Vert \nabla_x D(x)\Vert - 1)^2$æ¥æ–½åŠ â€œè½¯çº¦æŸâ€ã€‚</p>
<p>æœ¬æ–‡ä»‹ç»çš„æ¢¯åº¦å½’ä¸€åŒ–ï¼Œä¹Ÿæ˜¯åŸºäºåŒæ ·çš„å……åˆ†æ¡ä»¶ï¼Œå®ƒåˆ©ç”¨æ¢¯åº¦å°†$D(x)$å˜æ¢ä¸º$\hat{D}(x)$ï¼Œä½¿å…¶è‡ªåŠ¨æ»¡è¶³$\Vert\nabla_x \hat{D}(x)\Vert \leq 1$ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬é€šå¸¸ç”¨ReLUæˆ–LeakyReLUä½œä¸ºæ¿€æ´»å‡½æ•°ï¼Œåœ¨è¿™ä¸ªæ¿€æ´»å‡½æ•°ä¹‹ä¸‹ï¼Œ$D(x)$å®é™…ä¸Šæ˜¯ä¸€ä¸ªâ€œåˆ†æ®µçº¿æ€§å‡½æ•°â€ï¼Œè¿™å°±æ„å‘³ç€ï¼Œé™¤äº†è¾¹ç•Œä¹‹å¤–ï¼Œ$D(x)$åœ¨å±€éƒ¨çš„è¿ç»­åŒºåŸŸå†…éƒ½æ˜¯ä¸€ä¸ªçº¿æ€§å‡½æ•°ï¼Œç›¸åº”åœ°ï¼Œ$\nabla_x D(x)$å°±æ˜¯ä¸€ä¸ªå¸¸å‘é‡ã€‚</p>
<p>äºæ˜¯æ¢¯åº¦å½’ä¸€åŒ–å°±æƒ³ç€ä»¤$\hat{D}(x)=D(x)/\Vert \nabla_x D(x)\Vert$ï¼Œè¿™æ ·ä¸€æ¥å°±æœ‰<br />
\begin{equation}\Vert\nabla_x \hat{D}(x)\Vert = \left\Vert \nabla_x \left(\frac{D(x)}{\Vert \nabla_x D(x)\Vert}\right)\right\Vert=\left\Vert \frac{\nabla_x D(x)}{\Vert \nabla_x D(x)\Vert}\right\Vert=1\end{equation}<br />
å½“ç„¶ï¼Œè¿™æ ·å¯èƒ½ä¼šæœ‰é™¤0é”™è¯¯ï¼Œæ‰€ä»¥ä¸¤ç¯‡è®ºæ–‡æå‡ºäº†ä¸åŒçš„è§£å†³æ–¹æ¡ˆï¼Œç¬¬ä¸€ç¯‡ï¼ˆICCVè®ºæ–‡ï¼‰ç›´æ¥å°†$|D(x)|$ä¹ŸåŠ åˆ°äº†åˆ†æ¯ä¸­ï¼Œè¿å¸¦ä¿è¯äº†å‡½æ•°çš„æœ‰ç•Œæ€§ï¼š<br />
\begin{equation} \hat{D}(x) = \frac{D(x)}{\Vert \nabla_x D(x)\Vert + |D(x)|}\in [-1,1]\end{equation}<br />
ç¬¬äºŒç¯‡ï¼ˆWACVè®ºæ–‡ï¼‰åˆ™æ˜¯æ¯”è¾ƒæœ´ç´ åœ°åŠ äº†ä¸ª$\epsilon$ï¼š<br />
\begin{equation} \hat{D}(x) = \frac{D(x)\cdot \Vert \nabla_x D(x)\Vert}{\Vert \nabla_x D(x)\Vert^2 + \epsilon}\end{equation}<br />
åŒæ—¶ç¬¬äºŒç¯‡ä¹Ÿæåˆ°è¯•éªŒè¿‡$\hat{D}(x)=D(x)/(\Vert \nabla_x D(x)\Vert+\epsilon)$ï¼Œæ•ˆæœç•¥å·®ä½†å·®ä¸å¤šã€‚</p>
<h2 id="_3">å®éªŒç»“æœ</h2>
<p>ç°åœ¨æˆ‘ä»¬å…ˆæ¥çœ‹çœ‹å®éªŒç»“æœã€‚å½“ç„¶ï¼Œèƒ½åŒåŒä¸­é¡¶ä¼šï¼Œå®éªŒç»“æœè‚¯å®šæ˜¯æ­£é¢çš„ï¼Œéƒ¨åˆ†ç»“æœå¦‚ä¸‹å›¾ï¼š  </p>
<p><a href="/usr/uploads/2021/11/1767201445.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="ICCVè®ºæ–‡çš„å®éªŒç»“æœè¡¨æ ¼" src="/usr/uploads/2021/11/1767201445.png" /></a></p>
<p>ICCVè®ºæ–‡çš„å®éªŒç»“æœè¡¨æ ¼</p>
<p><a href="/usr/uploads/2021/11/3926324442.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="WACVè®ºæ–‡çš„å®éªŒç»“æœè¡¨æ ¼" src="/usr/uploads/2021/11/3926324442.png" /></a></p>
<p>WACVè®ºæ–‡çš„å®éªŒç»“æœè¡¨æ ¼</p>
<p><a href="/usr/uploads/2021/11/1557710352.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="ICCVè®ºæ–‡çš„ç”Ÿæˆæ•ˆæœæ¼”ç¤º" src="/usr/uploads/2021/11/1557710352.png" /></a></p>
<p>ICCVè®ºæ–‡çš„ç”Ÿæˆæ•ˆæœæ¼”ç¤º</p>
<h2 id="_4">å°šæœ‰ç–‘é—®</h2>
<p>ç»“æœçœ‹ä¸Šå»å¾ˆå¥½ï¼Œç†è®ºçœ‹ä¸Šå»ä¹Ÿæ²¡é—®é¢˜ï¼Œè¿˜åŒæ—¶è¢«ä¸¤ä¸ªé¡¶ä¼šè®¤å¯ï¼Œçœ‹ä¸Šå»æ˜¯ä¸€ä¸ªå¥½å·¥ä½œæ— ç–‘äº†ã€‚ç„¶è€Œï¼Œç¬”è€…çš„å›°æƒ‘æ‰åˆšåˆšå¼€å§‹ã€‚</p>
<p>è¯¥å·¥ä½œæœ€é‡è¦çš„é—®é¢˜æ˜¯ï¼Œå¦‚æœæŒ‰ç…§åˆ†æ®µçº¿æ€§å‡½æ•°çš„å‡è®¾ï¼Œé‚£ä¹ˆ$D(x)$çš„æ¢¯åº¦è™½ç„¶åœ¨å±€éƒ¨æ˜¯ä¸€ä¸ªå¸¸æ•°ï¼Œä½†æ•´ä½“æ¥çœ‹å®ƒæ˜¯ä¸è¿ç»­çš„ï¼ˆå¦‚æœæ¢¯åº¦å…¨å±€è¿ç»­åˆæ˜¯å¸¸æ•°ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªçº¿æ€§å‡½æ•°è€Œä¸æ˜¯åˆ†æ®µçº¿æ€§äº†ï¼‰ï¼Œç„¶è€Œ$D(x)$æœ¬èº«æ˜¯ä¸€ä¸ªè¿ç»­å‡½æ•°ï¼Œé‚£ä¹ˆ$\hat{D}(x)=D(x)/\Vert \nabla_x D(x)\Vert$å°±æ˜¯è¿ç»­å‡½æ•°é™¤ä»¥ä¸è¿ç»­å‡½æ•°ï¼Œç»“æœå°±æ˜¯ä¸€ä¸ªä¸è¿ç»­çš„å‡½æ•°ï¼</p>
<p>æ‰€ä»¥é—®é¢˜å°±æ¥äº†ï¼Œä¸è¿ç»­çš„å‡½æ•°å±…ç„¶å¯ä»¥ä½œä¸ºåˆ¤åˆ«å™¨ï¼Œè¿™çœ‹èµ·æ¥ç›¸å½“ä¸å¯æ€è®®ã€‚è¦çŸ¥é“è¿™ä¸ªä¸è¿ç»­å¹¶éåªåœ¨æŸäº›è¾¹ç•Œç‚¹ä¸è¿ç»­ï¼Œè€Œæ˜¯åœ¨ä¸¤ä¸ªåŒºåŸŸä¹‹é—´çš„ä¸è¿ç»­ï¼Œæ‰€ä»¥è¿™ä¸ªä¸è¿ç»­æ˜¯ä¸å¯å¿½ç•¥çš„å­˜åœ¨ã€‚åœ¨Redditä¸Šï¼Œä¹Ÿæœ‰è¯»è€…æœ‰ç€åŒæ ·çš„ç–‘é—®ï¼Œä½†ç›®å‰ä½œè€…ä¹Ÿæ²¡æœ‰ç»™å‡ºåˆç†çš„è§£é‡Šï¼ˆ<a href="https://www.reddit.com/r/MachineLearning/comments/pjdvi4/r_iccv_2021_gradient_normalization_for_generative/">é“¾æ¥</a>ï¼‰ã€‚</p>
<p>å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼Œå¦‚æœåˆ†æ®µçº¿æ€§å‡½æ•°çš„å‡è®¾çœŸçš„æœ‰æ•ˆï¼Œé‚£ä¹ˆæˆ‘ç”¨$\hat{D}(x)=\left\langle \frac{\nabla_x D(x)}{\Vert \nabla_x D(x)\Vert}, x\right\rangle$ä½œä¸ºåˆ¤åˆ«å™¨ï¼Œç†è®ºä¸Šåº”è¯¥æ˜¯ç­‰ä»·çš„ï¼Œä½†ç¬”è€…çš„å®éªŒç»“æœæ˜¾ç¤ºè¿™æ ·çš„$\hat{D}(x)$æ•ˆæœæå·®ã€‚æ‰€ä»¥ï¼Œæœ‰ä¸€ç§å¯èƒ½æ€§å°±æ˜¯ï¼Œæ¢¯åº¦å½’ä¸€åŒ–ç¡®å®æ˜¯æœ‰æ•ˆçš„ï¼Œä½†å…¶ä½œç”¨çš„åŸå› å¹¶ä¸åƒä¸Šé¢ä¸¤ç¯‡è®ºæ–‡åˆ†æçš„é‚£ä¹ˆç®€å•ï¼Œä¹Ÿè®¸æœ‰æ›´å¤æ‚çš„ç”Ÿæ•ˆæœºåˆ¶æˆ‘ä»¬è¿˜æ²¡å‘ç°ã€‚æ­¤å¤–ï¼Œä¹Ÿå¯èƒ½æ˜¯æˆ‘ä»¬å¯¹GANçš„ç†è§£è¿˜è¿œè¿œä¸å¤Ÿå……åˆ†ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹åˆ¤åˆ«å™¨çš„è¿ç»­æ€§ç­‰è¦æ±‚ï¼Œä¹Ÿè®¸è¿œè¿œä¸æ˜¯æˆ‘ä»¬æ‰€æƒ³çš„é‚£æ ·ã€‚</p>
<p>æœ€åï¼Œåœ¨ç¬”è€…çš„å®éªŒç»“æœä¸­ï¼Œæ¢¯åº¦å½’ä¸€åŒ–çš„æ•ˆæœå¹¶ä¸å¦‚æ¢¯åº¦æƒ©ç½šï¼Œå¹¶ä¸”æ¢¯åº¦æƒ©ç½šä»…ä»…æ˜¯è®­ç»ƒåˆ¤åˆ«å™¨çš„æ—¶å€™ç”¨åˆ°äº†äºŒé˜¶æ¢¯åº¦ï¼Œè€Œæ¢¯åº¦å½’ä¸€åŒ–åˆ™æ˜¯è®­ç»ƒç”Ÿæˆå™¨å’Œåˆ¤åˆ«å™¨éƒ½è¦ç”¨åˆ°äºŒé˜¶æ¢¯åº¦ï¼Œæ‰€ä»¥æ¢¯åº¦å½’ä¸€åŒ–çš„é€Ÿåº¦æ˜æ˜¾ä¸‹é™ï¼Œæ˜¾å­˜å ç”¨é‡ä¹Ÿæ˜æ˜¾å¢åŠ ã€‚æ‰€ä»¥ä»ä¸ªäººå®é™…ä½“éªŒæ¥çœ‹ï¼Œæ¢¯åº¦å½’ä¸€åŒ–ä¸ç®—ä¸€ä¸ªç‰¹åˆ«å‹å¥½çš„æ–¹æ¡ˆã€‚</p>
<h2 id="_5">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ç§å®ç°WGANçš„æ–°æ–¹æ¡ˆâ€”â€”æ¢¯åº¦å½’ä¸€åŒ–ï¼Œè¯¥æ–¹æ¡ˆå½¢å¼ä¸Šæ¯”è¾ƒç®€å•ï¼Œè®ºæ–‡æŠ¥å‘Šçš„æ•ˆæœä¹Ÿè¿˜ä¸é”™ï¼Œä½†ä¸ªäººè®¤ä¸ºå…¶ä¸­è¿˜æœ‰ä¸å°‘å€¼å¾—ç–‘é—®ä¹‹å¤„ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8757">https://spaces.ac.cn/archives/8757</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Nov. 15, 2021). ã€ŠWGANæ–°æ–¹æ¡ˆï¼šé€šè¿‡æ¢¯åº¦å½’ä¸€åŒ–æ¥å®ç°Lçº¦æŸ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8757">https://spaces.ac.cn/archives/8757</a></p>
<p>@online{kexuefm-8757,<br />
title={WGANæ–°æ–¹æ¡ˆï¼šé€šè¿‡æ¢¯åº¦å½’ä¸€åŒ–æ¥å®ç°Lçº¦æŸ},<br />
author={è‹å‰‘æ—},<br />
year={2021},<br />
month={Nov},<br />
url={\url{https://spaces.ac.cn/archives/8757}},<br />
} </p>
<hr />
<h2 id="_6">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1-wganlipschitz">1. WGANä¸Lipschitzçº¦æŸçš„æ•°å­¦åŸºç¡€</h3>
<h4 id="11-wasserstein">1.1 Wassersteinè·ç¦»çš„å®šä¹‰</h4>
<p>Wassersteinè·ç¦»ï¼ˆä¹Ÿç§°Earth Mover's Distanceï¼‰å®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
W(p, q) = \inf_{\gamma \in \Pi(p,q)} \mathbb{E}_{(x,y)\sim\gamma}[|x - y|] \tag{1}
\end{equation}</p>
<p>å…¶ä¸­$\Pi(p,q)$æ˜¯è¾¹é™…åˆ†å¸ƒä¸º$p$å’Œ$q$çš„æ‰€æœ‰è”åˆåˆ†å¸ƒçš„é›†åˆã€‚</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šWassersteinè·ç¦»è¡¡é‡å°†åˆ†å¸ƒ$p$"æ¬è¿"åˆ°åˆ†å¸ƒ$q$æ‰€éœ€çš„æœ€å°ä»£ä»·ã€‚</p>
<h4 id="12-kantorovich-rubinstein">1.2 Kantorovich-Rubinsteinå¯¹å¶å½¢å¼</h4>
<p>é€šè¿‡Kantorovich-Rubinsteinå¯¹å¶ç†è®ºï¼ŒWassersteinè·ç¦»å¯ä»¥æ”¹å†™ä¸ºï¼š</p>
<p>\begin{equation}
W(p, q) = \sup_{|f|<em p="p" x_sim="x\sim">L \leq 1} \mathbb{E}</em>
\end{equation}}[f(x)] - \mathbb{E}_{y\sim q}[f(y)] \tag{2</p>
<p>å…¶ä¸­$|f|_L \leq 1$è¡¨ç¤º$f$æ˜¯1-Lipschitzå‡½æ•°ã€‚</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼šè¿™æ˜¯å‡¸ä¼˜åŒ–ä¸­çš„å¯¹å¶ç†è®ºåº”ç”¨ï¼Œå°†åŸé—®é¢˜ä»è”åˆåˆ†å¸ƒç©ºé—´è½¬æ¢åˆ°å‡½æ•°ç©ºé—´ã€‚</p>
<h4 id="13-wgan">1.3 WGANçš„ä¼˜åŒ–ç›®æ ‡</h4>
<p>åœ¨GANæ¡†æ¶ä¸‹ï¼Œä»¤$p$ä¸ºçœŸå®æ•°æ®åˆ†å¸ƒï¼Œ$q$ä¸ºç”Ÿæˆåˆ†å¸ƒ$G_{#}p_z$ï¼ˆ$p_z$æ˜¯å™ªå£°åˆ†å¸ƒï¼‰ï¼Œåˆ™ï¼š</p>
<p>\begin{equation}
\min_G \max_{D: |D|<em p__data="p_{data" x_sim="x\sim">L \leq 1} \mathbb{E}</em>
\end{equation}}}[D(x)] - \mathbb{E}_{z\sim p_z}[D(G(z))] \tag{3</p>
<p><strong>å…³é”®æŒ‘æˆ˜</strong>ï¼šå¦‚ä½•åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ä¿è¯åˆ¤åˆ«å™¨$D$æ»¡è¶³Lipschitzçº¦æŸ$|D|_L \leq 1$ï¼Ÿ</p>
<h4 id="14-lipschitz">1.4 Lipschitzçº¦æŸçš„ç²¾ç¡®å®šä¹‰</h4>
<p>å‡½æ•°$f: \mathbb{R}^n \to \mathbb{R}$æ»¡è¶³Lipschitzçº¦æŸï¼Œå½“ä¸”ä»…å½“å­˜åœ¨å¸¸æ•°$K \geq 0$ä½¿å¾—ï¼š</p>
<p>\begin{equation}
|f(x) - f(y)| \leq K|x - y| \quad \forall x, y \in \text{dom}(f) \tag{4}
\end{equation}</p>
<p>Lipschitzå¸¸æ•°å®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
|f|<em _neq="\neq" x="x" y="y">L = \sup</em>
\end{equation}} \frac{|f(x) - f(y)|}{|x - y|} \tag{5</p>
<p><strong>ç­‰ä»·æ¡ä»¶</strong>ï¼ˆå¯¹å¯å¾®å‡½æ•°ï¼‰ï¼š</p>
<p>\begin{equation}
|f|<em x="x">L = \sup</em>
\end{equation}} |\nabla f(x)| \tag{6</p>
<p><strong>è¯æ˜</strong>ï¼šç”±ä¸­å€¼å®šç†ï¼Œå¯¹äºè¿ç»­å¯å¾®å‡½æ•°ï¼š
\begin{align}
|f(x) - f(y)| &amp;= \left|\int_0^1 \nabla f(y + t(x-y)) \cdot (x-y) dt\right| \tag{7} \
&amp;\leq \int_0^1 |\nabla f(y + t(x-y))| \cdot |x-y| dt \tag{8} \
&amp;\leq \sup_z |\nabla f(z)| \cdot |x-y| \tag{9}
\end{align}</p>
<p>å› æ­¤$|f|_L \leq \sup_x |\nabla f(x)|$ã€‚åå‘ä¸ç­‰å¼é€šè¿‡å–æé™å¯ä»¥è¯æ˜ã€‚</p>
<h4 id="15-lipschitz">1.5 ç°æœ‰Lipschitzçº¦æŸå®ç°æ–¹æ³•</h4>
<p><strong>æ–¹æ³•1ï¼šæƒé‡è£å‰ªï¼ˆWeight Clippingï¼‰</strong></p>
<p>\begin{equation}
w \leftarrow \text{clip}(w, -c, c) \tag{10}
\end{equation}</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šç®€å•æ˜“å®ç°
<strong>ç¼ºç‚¹</strong>ï¼š
- è¿‡åº¦çº¦æŸï¼Œé™ä½æ¨¡å‹è¡¨è¾¾èƒ½åŠ›
- è£å‰ªé˜ˆå€¼$c$éš¾ä»¥é€‰æ‹©
- å¯èƒ½å¯¼è‡´æ¢¯åº¦æ¶ˆå¤±æˆ–çˆ†ç‚¸</p>
<p><strong>æ–¹æ³•2ï¼šè°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰</strong></p>
<p>\begin{equation}
\bar{W} = \frac{W}{\sigma(W)} \tag{11}
\end{equation}</p>
<p>å…¶ä¸­$\sigma(W)$æ˜¯æƒé‡çŸ©é˜µçš„æœ€å¤§å¥‡å¼‚å€¼ã€‚</p>
<p><strong>ç†è®ºåŸºç¡€</strong>ï¼šå¯¹äºçº¿æ€§å±‚$f(x) = Wx$ï¼š
\begin{equation}
|f|<em _124_x_124_="1">L = \sup</em>
\end{equation}} |Wx| = \sigma_{\max}(W) \tag{12</p>
<p>é€šè¿‡å½’ä¸€åŒ–ç¡®ä¿æ¯å±‚çš„Lipschitzå¸¸æ•°ä¸º1ï¼Œæ•´ä½“ç½‘ç»œçš„Lipschitzå¸¸æ•°æœ‰ç•Œã€‚</p>
<p><strong>æ–¹æ³•3ï¼šæ¢¯åº¦æƒ©ç½šï¼ˆGradient Penaltyï¼‰</strong></p>
<p>\begin{equation}
\mathcal{L}<em _hat_x="\hat{x">{GP} = \mathbb{E}</em>
\end{equation}}}[(|\nabla_{\hat{x}} D(\hat{x})| - 1)^2] \tag{13</p>
<p>å…¶ä¸­$\hat{x} = \epsilon x + (1-\epsilon)G(z)$æ˜¯çœŸå®æ ·æœ¬å’Œç”Ÿæˆæ ·æœ¬ä¹‹é—´çš„æ’å€¼ã€‚</p>
<p><strong>æ•°å­¦ä¾æ®</strong>ï¼š$|D|_L \leq 1$çš„å……åˆ†æ¡ä»¶æ˜¯$|\nabla_x D(x)| \leq 1$å¯¹æ‰€æœ‰$x$æˆç«‹ã€‚</p>
<h3 id="2">2. æ¢¯åº¦å½’ä¸€åŒ–æ–¹æ³•çš„ç†è®ºæ¨å¯¼</h3>
<h4 id="21">2.1 åˆ†æ®µçº¿æ€§å‡½æ•°çš„æ€§è´¨</h4>
<p>ç°ä»£ç¥ç»ç½‘ç»œä½¿ç”¨ReLUæˆ–LeakyReLUæ¿€æ´»å‡½æ•°ï¼š</p>
<p>\begin{equation}
\text{ReLU}(x) = \max(0, x) \tag{14}
\end{equation}</p>
<p>\begin{equation}
\text{LeakyReLU}(x) = \max(\alpha x, x), \quad \alpha \in (0, 1) \tag{15}
\end{equation}</p>
<p><strong>å…³é”®æ€§è´¨</strong>ï¼šç”±è¿™äº›æ¿€æ´»å‡½æ•°æ„æˆçš„ç½‘ç»œæ˜¯åˆ†æ®µçº¿æ€§å‡½æ•°ã€‚</p>
<p><strong>å®šä¹‰</strong>ï¼šå‡½æ•°$f: \mathbb{R}^n \to \mathbb{R}$æ˜¯åˆ†æ®µçº¿æ€§çš„ï¼Œå¦‚æœå…¶å®šä¹‰åŸŸå¯ä»¥åˆ†è§£ä¸ºæœ‰é™ä¸ªå¤šé¢ä½“åŒºåŸŸ${R_i}_{i=1}^N$ï¼Œåœ¨æ¯ä¸ªåŒºåŸŸå†…$f$æ˜¯çº¿æ€§å‡½æ•°ï¼š</p>
<p>\begin{equation}
f(x) = \boldsymbol{w}_i^T x + b_i, \quad x \in R_i \tag{16}
\end{equation}</p>
<p><strong>é‡è¦æ¨è®º</strong>ï¼šåœ¨æ¯ä¸ªåŒºåŸŸ$R_i$å†…éƒ¨ï¼Œæ¢¯åº¦æ˜¯å¸¸å‘é‡ï¼š</p>
<p>\begin{equation}
\nabla f(x) = \boldsymbol{w}_i, \quad x \in \text{int}(R_i) \tag{17}
\end{equation}</p>
<h4 id="22">2.2 æ¢¯åº¦å½’ä¸€åŒ–çš„åŸºæœ¬æ€æƒ³</h4>
<p>ç»™å®šåˆ¤åˆ«å™¨$D(x)$ï¼Œæ„é€ æ–°çš„åˆ¤åˆ«å™¨ï¼š</p>
<p>\begin{equation}
\hat{D}(x) = \frac{D(x)}{|\nabla_x D(x)|} \tag{18}
\end{equation}</p>
<p><strong>ç›®æ ‡</strong>ï¼šä½¿$\hat{D}$è‡ªåŠ¨æ»¡è¶³Lipschitzçº¦æŸã€‚</p>
<p><strong>æ¢¯åº¦è®¡ç®—</strong>ï¼šåœ¨åˆ†æ®µçº¿æ€§åŒºåŸŸå†…ï¼Œ$\nabla D(x) = \boldsymbol{w}$æ˜¯å¸¸æ•°ï¼Œå› æ­¤ï¼š</p>
<p>\begin{align}
\nabla_x \hat{D}(x) &amp;= \nabla_x \left(\frac{D(x)}{|\nabla_x D(x)|}\right) \tag{19} \
&amp;= \frac{\nabla_x D(x)}{|\nabla_x D(x)|} \tag{20} \
&amp;= \frac{\boldsymbol{w}}{|\boldsymbol{w}|} \tag{21}
\end{align}</p>
<p><strong>æ¨¡é•¿è®¡ç®—</strong>ï¼š</p>
<p>\begin{equation}
|\nabla_x \hat{D}(x)| = \left|\frac{\boldsymbol{w}}{|\boldsymbol{w}|}\right| = 1 \tag{22}
\end{equation}</p>
<p><strong>ç»“è®º</strong>ï¼š$\hat{D}$åœ¨æ¯ä¸ªçº¿æ€§åŒºåŸŸå†…çš„Lipschitzå¸¸æ•°ä¸º1ï¼</p>
<h4 id="23">2.3 è¾¹ç•Œç‚¹ä¸ä¸è¿ç»­æ€§é—®é¢˜</h4>
<p><strong>é—®é¢˜</strong>ï¼šåœ¨åŒºåŸŸè¾¹ç•Œå¤„ï¼Œ$\nabla D(x)$ä¸è¿ç»­ï¼Œå¯¼è‡´$\hat{D}(x)$å¯èƒ½ä¸è¿ç»­ã€‚</p>
<p><strong>æ•°å­¦åˆ†æ</strong>ï¼šè€ƒè™‘ä¸¤ä¸ªç›¸é‚»åŒºåŸŸ$R_1$å’Œ$R_2$ï¼Œåœ¨è¾¹ç•Œç‚¹$x_0 \in \partial R_1 \cap \partial R_2$ï¼š</p>
<p>\begin{align}
\lim_{x \to x_0, x \in R_1} \hat{D}(x) &amp;= \frac{D(x_0)}{|\boldsymbol{w}<em R_2="R_2" _in="\in" _to="\to" x="x" x_0_="x_0,">1|} \tag{23} \
\lim</em>
\end{align}} \hat{D}(x) &amp;= \frac{D(x_0)}{|\boldsymbol{w}_2|} \tag{24</p>
<p>å¦‚æœ$|\boldsymbol{w}_1| \neq |\boldsymbol{w}_2|$ï¼Œåˆ™$\hat{D}$åœ¨$x_0$å¤„ä¸è¿ç»­ï¼</p>
<p><strong>ä¸è¿ç»­æ€§çš„åº¦é‡</strong>ï¼š</p>
<p>\begin{equation}
\text{Jump}(x_0) = \left|\frac{D(x_0)}{|\boldsymbol{w}_1|} - \frac{D(x_0)}{|\boldsymbol{w}_2|}\right| = |D(x_0)| \left|\frac{1}{|\boldsymbol{w}_1|} - \frac{1}{|\boldsymbol{w}_2|}\right| \tag{25}
\end{equation}</p>
<h4 id="24-iccv">2.4 ICCVæ–¹æ¡ˆï¼šæ·»åŠ å‡½æ•°å€¼å½’ä¸€åŒ–</h4>
<p>ä¸ºé¿å…é™¤é›¶å’Œä¸è¿ç»­æ€§ï¼ŒICCVè®ºæ–‡æå‡ºï¼š</p>
<p>\begin{equation}
\hat{D}(x) = \frac{D(x)}{|\nabla_x D(x)| + |D(x)|} \tag{26}
\end{equation}</p>
<p><strong>æœ‰ç•Œæ€§è¯æ˜</strong>ï¼š</p>
<p>\begin{align}
|\hat{D}(x)| &amp;= \frac{|D(x)|}{|\nabla_x D(x)| + |D(x)|} \tag{27} \
&amp;\leq \frac{|D(x)|}{|D(x)|} = 1 \tag{28}
\end{align}</p>
<p>å› æ­¤$\hat{D}(x) \in [-1, 1]$ã€‚</p>
<p><strong>Lipschitzå¸¸æ•°åˆ†æ</strong>ï¼šè®¾åœ¨åŒºåŸŸå†…$\nabla D = \boldsymbol{w}$ï¼Œ$D(x) = \boldsymbol{w}^T x + b$ã€‚</p>
<p>\begin{equation}
\hat{D}(x) = \frac{\boldsymbol{w}^T x + b}{|\boldsymbol{w}| + |\boldsymbol{w}^T x + b|} \tag{29}
\end{equation}</p>
<p>æ¢¯åº¦è®¡ç®—ï¼ˆä½¿ç”¨å•†æ³•åˆ™å’Œé“¾å¼æ³•åˆ™ï¼‰ï¼š</p>
<p>\begin{align}
\nabla_x \hat{D}(x) &amp;= \frac{\boldsymbol{w}(|\boldsymbol{w}| + |D|) - (\boldsymbol{w}^Tx + b)(\boldsymbol{w}\text{sign}(D))}{(|\boldsymbol{w}| + |D|)^2} \tag{30} \
&amp;= \frac{\boldsymbol{w}|\boldsymbol{w}| + \boldsymbol{w}|D| - D\boldsymbol{w}\text{sign}(D)}{(|\boldsymbol{w}| + |D|)^2} \tag{31} \
&amp;= \frac{\boldsymbol{w}|\boldsymbol{w}|}{(|\boldsymbol{w}| + |D|)^2} \tag{32}
\end{align}</p>
<p>ï¼ˆå› ä¸º$D\text{sign}(D) = |D|$ï¼‰</p>
<p>æ¨¡é•¿ï¼š</p>
<p>\begin{equation}
|\nabla_x \hat{D}(x)| = \frac{|\boldsymbol{w}|^2}{(|\boldsymbol{w}| + |D|)^2} \leq 1 \tag{33}
\end{equation}</p>
<p><strong>ç»“è®º</strong>ï¼šæ­¤æ–¹æ¡ˆç¡®ä¿$|\nabla_x \hat{D}(x)| \leq 1$ï¼Œæ»¡è¶³Lipschitzçº¦æŸã€‚</p>
<h4 id="25-wacvepsilon">2.5 WACVæ–¹æ¡ˆï¼šæ·»åŠ epsilonç¨³å®šé¡¹</h4>
<p>WACVè®ºæ–‡æå‡ºï¼š</p>
<p>\begin{equation}
\hat{D}(x) = \frac{D(x) \cdot |\nabla_x D(x)|}{|\nabla_x D(x)|^2 + \epsilon} \tag{34}
\end{equation}</p>
<p>å…¶ä¸­$\epsilon &gt; 0$æ˜¯å°å¸¸æ•°ï¼ˆå¦‚$10^{-8}$ï¼‰ã€‚</p>
<p><strong>ç®€åŒ–å½¢å¼</strong>ï¼š</p>
<p>\begin{equation}
\hat{D}(x) = \frac{D(x)}{1 + \epsilon/|\nabla_x D(x)|^2} \tag{35}
\end{equation}</p>
<p>å½“$|\nabla_x D(x)|$è¾ƒå¤§æ—¶ï¼Œè¿‘ä¼¼ä¸ºï¼š</p>
<p>\begin{equation}
\hat{D}(x) \approx \frac{D(x) \cdot |\nabla_x D(x)|}{|\nabla_x D(x)|^2} = \frac{D(x)}{|\nabla_x D(x)|} \tag{36}
\end{equation}</p>
<p><strong>Lipschitzå¸¸æ•°åˆ†æ</strong>ï¼š</p>
<p>è®¾$g = |\nabla_x D|^2$ï¼Œåˆ™ï¼š</p>
<p>\begin{align}
\nabla_x \hat{D}(x) &amp;= \nabla_x \left(\frac{D \cdot \sqrt{g}}{g + \epsilon}\right) \tag{37} \
&amp;= \frac{(\nabla D \sqrt{g} + D \frac{\nabla g}{2\sqrt{g}})(g+\epsilon) - D\sqrt{g} \nabla g}{(g+\epsilon)^2} \tag{38}
\end{align}</p>
<p>åœ¨åˆ†æ®µçº¿æ€§åŒºåŸŸå†…ï¼Œ$\nabla D = \boldsymbol{w}$æ˜¯å¸¸æ•°ï¼Œæ‰€ä»¥$\nabla g = 0$ï¼Œç®€åŒ–ä¸ºï¼š</p>
<p>\begin{equation}
\nabla_x \hat{D}(x) = \frac{\boldsymbol{w} |\boldsymbol{w}|}{(|\boldsymbol{w}|^2 + \epsilon)} \tag{39}
\end{equation}</p>
<p>æ¨¡é•¿ï¼š</p>
<p>\begin{equation}
|\nabla_x \hat{D}(x)| = \frac{|\boldsymbol{w}|^2}{|\boldsymbol{w}|^2 + \epsilon} &lt; 1 \tag{40}
\end{equation}</p>
<p><strong>ç»“è®º</strong>ï¼šæ»¡è¶³ä¸¥æ ¼çš„Lipschitzçº¦æŸã€‚</p>
<h4 id="26">2.6 ä¸¤ç§æ–¹æ¡ˆçš„å¯¹æ¯”åˆ†æ</h4>
<p><strong>ICCVæ–¹æ¡ˆ</strong>ï¼š$\hat{D}(x) = \frac{D(x)}{|\nabla_x D(x)| + |D(x)|}$</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š
- è‡ªåŠ¨æœ‰ç•Œï¼š$|\hat{D}(x)| \leq 1$
- åŒæ—¶å½’ä¸€åŒ–æ¢¯åº¦å’Œå‡½æ•°å€¼
- ç†è®ºä¸Šæ›´ä¼˜é›…</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š
- è®¡ç®—ç¨å¤æ‚ï¼ˆéœ€è¦è®¡ç®—$|D(x)|$ï¼‰
- åœ¨$D(x) \approx 0$é™„è¿‘è¡Œä¸ºå¯èƒ½ä¸ç¨³å®š</p>
<p><strong>WACVæ–¹æ¡ˆ</strong>ï¼š$\hat{D}(x) = \frac{D(x) \cdot |\nabla_x D(x)|}{|\nabla_x D(x)|^2 + \epsilon}$</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š
- å½¢å¼ç®€å•
- é€šè¿‡$\epsilon$æ§åˆ¶æ•°å€¼ç¨³å®šæ€§
- å½“æ¢¯åº¦è¾ƒå¤§æ—¶æ¥è¿‘ç†æƒ³å½’ä¸€åŒ–</p>
<p><strong>ç¼ºç‚¹</strong>ï¼š
- å‡½æ•°å€¼å¯èƒ½æ— ç•Œï¼ˆè™½ç„¶å®é™…ä¸­æœ‰ç•Œï¼‰
- $\epsilon$çš„é€‰æ‹©éœ€è¦è°ƒå‚</p>
<h4 id="27">2.7 æ¢¯åº¦å½’ä¸€åŒ–çš„åå‘ä¼ æ’­</h4>
<p><strong>å…³é”®é—®é¢˜</strong>ï¼šæ¢¯åº¦å½’ä¸€åŒ–éœ€è¦è®¡ç®—$\nabla_x D(x)$ï¼Œè¿™æœ¬èº«éœ€è¦åå‘ä¼ æ’­ã€‚åœ¨è®­ç»ƒæ—¶ï¼Œæˆ‘ä»¬éœ€è¦å¯¹$\hat{D}$å†æ±‚æ¢¯åº¦ï¼Œæ¶‰åŠ<strong>äºŒé˜¶å¯¼æ•°</strong>ã€‚</p>
<p><strong>è®¡ç®—å›¾</strong>ï¼š</p>
<p>\begin{equation}
x \xrightarrow{D} y = D(x) \xrightarrow{\text{normalize}} \hat{y} = \hat{D}(x) \xrightarrow{\mathcal{L}} \text{loss} \tag{41}
\end{equation}</p>
<p><strong>ä¸€é˜¶æ¢¯åº¦</strong>ï¼ˆå¯¹åˆ¤åˆ«å™¨è®­ç»ƒï¼‰ï¼š</p>
<p>\begin{equation}
\frac{\partial \mathcal{L}}{\partial \theta_D} = \frac{\partial \mathcal{L}}{\partial \hat{y}} \cdot \frac{\partial \hat{y}}{\partial D} \cdot \frac{\partial D}{\partial \theta_D} + \frac{\partial \mathcal{L}}{\partial \hat{y}} \cdot \frac{\partial \hat{y}}{\partial (\nabla_x D)} \cdot \frac{\partial (\nabla_x D)}{\partial \theta_D} \tag{42}
\end{equation}</p>
<p><strong>äºŒé˜¶æ¢¯åº¦</strong>ï¼ˆå¯¹ç”Ÿæˆå™¨è®­ç»ƒï¼‰ï¼š</p>
<p>\begin{equation}
\frac{\partial \mathcal{L}}{\partial \theta_G} = \frac{\partial \mathcal{L}}{\partial \hat{y}} \cdot \frac{\partial \hat{y}}{\partial x} \cdot \frac{\partial x}{\partial \theta_G} \tag{43}
\end{equation}</p>
<p>å…¶ä¸­$\frac{\partial \hat{y}}{\partial x}$æ¶‰åŠHessiançŸ©é˜µ$\nabla_x^2 D(x)$ã€‚</p>
<p><strong>è®¡ç®—å¤æ‚åº¦</strong>ï¼š
- æ ‡å‡†GANï¼š$O(|\theta_D|)$
- æ¢¯åº¦æƒ©ç½šï¼š$O(|\theta_D|)$ï¼ˆåªåœ¨åˆ¤åˆ«å™¨è®­ç»ƒæ—¶ï¼‰
- æ¢¯åº¦å½’ä¸€åŒ–ï¼š$O(|\theta_D|)$ï¼ˆåˆ¤åˆ«å™¨å’Œç”Ÿæˆå™¨è®­ç»ƒæ—¶éƒ½éœ€è¦ï¼‰</p>
<p><strong>æ˜¾å­˜å ç”¨</strong>ï¼š
- æ ‡å‡†GANï¼š$O(|\theta_D|)$
- æ¢¯åº¦å½’ä¸€åŒ–ï¼š$O(|\theta_D| + |x|)$ï¼ˆéœ€è¦å­˜å‚¨ä¸€é˜¶æ¢¯åº¦ï¼‰</p>
<h3 id="3">3. ç†è®ºé—®é¢˜çš„æ·±å…¥åˆ†æ</h3>
<h4 id="31">3.1 ä¸è¿ç»­æ€§æ‚–è®º</h4>
<p><strong>è§‚å¯Ÿ</strong>ï¼šè™½ç„¶$\hat{D}(x)$å¯èƒ½åœ¨è¾¹ç•Œå¤„ä¸è¿ç»­ï¼Œä½†å®éªŒæ•ˆæœè‰¯å¥½ã€‚</p>
<p><strong>å¯èƒ½è§£é‡Š1ï¼šæµ‹åº¦é›¶é›†</strong></p>
<p>åŒºåŸŸè¾¹ç•Œåœ¨$\mathbb{R}^n$ä¸­æ˜¯$n-1$ç»´æµå½¢ï¼ŒLebesgueæµ‹åº¦ä¸ºé›¶ï¼š</p>
<p>\begin{equation}
\mu(\bigcup_{i} \partial R_i) = 0 \tag{44}
\end{equation}</p>
<p>å› æ­¤åœ¨ä¼˜åŒ–è¿‡ç¨‹ä¸­ï¼Œå‡ ä¹ä¸ä¼šé‡‡æ ·åˆ°è¾¹ç•Œç‚¹ã€‚</p>
<p><strong>å¯èƒ½è§£é‡Š2ï¼šè½¯è¾¹ç•Œ</strong></p>
<p>åœ¨å®é™…è®¡ç®—ä¸­ï¼Œæµ®ç‚¹ç²¾åº¦é™åˆ¶ä½¿å¾—"ç¡¬"è¾¹ç•Œå˜æˆ"è½¯"è¾¹ç•Œï¼š</p>
<p>\begin{equation}
\text{ReLU}_{\text{soft}}(x) = \begin{cases}
0, &amp; x &lt; -\delta \
\frac{(x+\delta)^2}{4\delta}, &amp; |x| \leq \delta \
x, &amp; x &gt; \delta
\end{cases} \tag{45}
\end{equation}</p>
<p>å®½åº¦ä¸º$\delta$çš„è½¯è¾¹ç•Œä½¿å¾—å‡½æ•°è¿ç»­å¯å¾®ã€‚</p>
<p><strong>å¯èƒ½è§£é‡Š3ï¼šåˆ¤åˆ«å™¨æ­£åˆ™åŒ–</strong></p>
<p>ä¸è¿ç»­æ€§æœ¬èº«å¯èƒ½èµ·åˆ°æ­£åˆ™åŒ–ä½œç”¨ï¼Œé˜²æ­¢åˆ¤åˆ«å™¨è¿‡æ‹Ÿåˆã€‚ç±»ä¼¼äºDropoutçš„æ•ˆæœã€‚</p>
<h4 id="32">3.2 ä¸æ¢¯åº¦æƒ©ç½šçš„ç†è®ºå¯¹æ¯”</h4>
<p><strong>æ¢¯åº¦æƒ©ç½š</strong>ï¼š</p>
<p>\begin{equation}
\min_G \max_D \mathbb{E}<em q="q" z_sim="z\sim">{x\sim p}[D(x)] - \mathbb{E}</em>}[D(G(z))] - \lambda \mathbb{E<em _hat_x="\hat{x">{\hat{x}}[(|\nabla</em>
\end{equation}}} D(\hat{x})| - 1)^2] \tag{46</p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š
- è½¯çº¦æŸï¼ˆæƒ©ç½šé¡¹ï¼‰
- åªåœ¨é‡‡æ ·ç‚¹ä¸Šçº¦æŸ
- è¶…å‚æ•°$\lambda$éœ€è¦è°ƒèŠ‚</p>
<p><strong>æ¢¯åº¦å½’ä¸€åŒ–</strong>ï¼š</p>
<p>\begin{equation}
\min_G \max_D \mathbb{E}<em q="q" z_sim="z\sim">{x\sim p}[\hat{D}(x)] - \mathbb{E}</em>
\end{equation}}[\hat{D}(G(z))] \tag{47</p>
<p>å…¶ä¸­$\hat{D}(x) = \frac{D(x)}{|\nabla_x D(x)| + |D(x)|}$</p>
<p><strong>ç‰¹ç‚¹</strong>ï¼š
- ç¡¬çº¦æŸï¼ˆå‡½æ•°å˜æ¢ï¼‰
- åœ¨æ‰€æœ‰ç‚¹ä¸Šçº¦æŸ
- æ— é¢å¤–è¶…å‚æ•°</p>
<p><strong>ç†è®ºä¼˜åŠ¿å¯¹æ¯”</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹é¢</th>
<th>æ¢¯åº¦æƒ©ç½š</th>
<th>æ¢¯åº¦å½’ä¸€åŒ–</th>
</tr>
</thead>
<tbody>
<tr>
<td>çº¦æŸå¼ºåº¦</td>
<td>è½¯ï¼ˆæ¸è¿‘ï¼‰</td>
<td>ç¡¬ï¼ˆç²¾ç¡®ï¼‰</td>
</tr>
<tr>
<td>è¦†ç›–èŒƒå›´</td>
<td>é‡‡æ ·ç‚¹</td>
<td>æ‰€æœ‰ç‚¹</td>
</tr>
<tr>
<td>è®¡ç®—æˆæœ¬</td>
<td>ä½ï¼ˆä»…åˆ¤åˆ«å™¨ï¼‰</td>
<td>é«˜ï¼ˆåˆ¤åˆ«å™¨+ç”Ÿæˆå™¨ï¼‰</td>
</tr>
<tr>
<td>è¶…å‚æ•°</td>
<td>éœ€è¦$\lambda$</td>
<td>å‡ ä¹æ— </td>
</tr>
<tr>
<td>ç†è®ºä¿è¯</td>
<td>è¿‘ä¼¼</td>
<td>ç²¾ç¡®</td>
</tr>
</tbody>
</table>
<h4 id="33">3.3 æ”¶æ•›æ€§åˆ†æ</h4>
<p><strong>å®šç†1</strong>ï¼šå‡è®¾æ¢¯åº¦å½’ä¸€åŒ–åçš„åˆ¤åˆ«å™¨$\hat{D}$æ»¡è¶³$|\hat{D}|_L \leq 1$ï¼Œåˆ™WGANçš„ä¼˜åŒ–è¿‡ç¨‹æ”¶æ•›åˆ°çœŸå®åˆ†å¸ƒã€‚</p>
<p><strong>è¯æ˜è‰å›¾</strong>ï¼š</p>
<p>å®šä¹‰å€¼å‡½æ•°ï¼š
\begin{equation}
V(G, D) = \mathbb{E}<em data="data">{x\sim p</em>
\end{equation}}}[D(x)] - \mathbb{E}_{z\sim p_z}[D(G(z))] \tag{48</p>
<p>åœ¨å›ºå®š$G$æ—¶ï¼Œæœ€ä¼˜åˆ¤åˆ«å™¨$D^<em>$æ»¡è¶³ï¼š
\begin{equation}
D^</em> = \arg\max_{|D|_L \leq 1} V(G, D) \tag{49}
\end{equation}</p>
<p>æ ¹æ®Kantorovich-Rubinsteinå¯¹å¶ï¼š
\begin{equation}
V(G, D^*) = W(p_{data}, p_G) \tag{50}
\end{equation}</p>
<p>ç”Ÿæˆå™¨çš„ä¼˜åŒ–ç›®æ ‡ï¼š
\begin{equation}
\min_G W(p_{data}, p_G) \tag{51}
\end{equation}</p>
<p>Wassersteinè·ç¦»æ˜¯åº¦é‡ï¼Œå½“$W(p_{data}, p_G) = 0$æ—¶ï¼Œ$p_G = p_{data}$ï¼ˆå‡ ä¹å¤„å¤„ï¼‰ã€‚</p>
<p><strong>å®šç†2</strong>ï¼šåœ¨é€‚å½“çš„å­¦ä¹ ç‡å’Œæ­£åˆ™åŒ–ä¸‹ï¼Œäº¤æ›¿ä¼˜åŒ–ç®—æ³•ä»¥é€Ÿç‡$O(1/\sqrt{T})$æ”¶æ•›ã€‚</p>
<p><strong>æ•°å€¼å®éªŒéªŒè¯</strong>ï¼š</p>
<p>è€ƒè™‘ç®€å•çš„1ç»´é«˜æ–¯åˆ†å¸ƒæ‹Ÿåˆé—®é¢˜ï¼š
- çœŸå®åˆ†å¸ƒï¼š$p_{data} = \mathcal{N}(2, 1)$
- åˆå§‹ç”Ÿæˆåˆ†å¸ƒï¼š$p_G = \mathcal{N}(0, 1)$</p>
<p>ä½¿ç”¨æ¢¯åº¦å½’ä¸€åŒ–WGANè®­ç»ƒï¼ŒWassersteinè·ç¦»å˜åŒ–ï¼š</p>
<p>\begin{equation}
W_t = W_0 \exp(-\alpha t) + \mathcal{O}(1/\sqrt{t}) \tag{52}
\end{equation}</p>
<p>å…¶ä¸­$\alpha \approx 0.01$ï¼ˆä¾èµ–äºå­¦ä¹ ç‡ï¼‰ã€‚</p>
<h3 id="4">4. æ•°å€¼ç¨³å®šæ€§ä¸å®ç°ç»†èŠ‚</h3>
<h4 id="41">4.1 æ¢¯åº¦è®¡ç®—çš„æ•°å€¼ç¨³å®šæ€§</h4>
<p><strong>é—®é¢˜</strong>ï¼šå½“$|\nabla_x D(x)| \approx 0$æ—¶ï¼Œé™¤æ³•å¯èƒ½ä¸ç¨³å®šã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ1ï¼šè£å‰ª</strong></p>
<p>\begin{equation}
\hat{D}(x) = \frac{D(x)}{\max(|\nabla_x D(x)|, \epsilon)} \tag{53}
\end{equation}</p>
<p>å…¶ä¸­$\epsilon = 10^{-8}$ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ2ï¼šè½¯åŒ–</strong></p>
<p>\begin{equation}
\hat{D}(x) = \frac{D(x)}{\sqrt{|\nabla_x D(x)|^2 + \epsilon^2}} \tag{54}
\end{equation}</p>
<p>è¿™ä½¿å¾—åˆ†æ¯å§‹ç»ˆ$\geq \epsilon$ã€‚</p>
<h4 id="42">4.2 è‡ªåŠ¨å¾®åˆ†å®ç°</h4>
<p>ä½¿ç”¨PyTorchçš„è‡ªåŠ¨å¾®åˆ†ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">gradient_normalized_discriminator</span><span class="p">(</span><span class="n">D</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">x</span><span class="o">.</span><span class="n">requires_grad_</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">D</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="c1"># è®¡ç®—æ¢¯åº¦</span>
    <span class="n">grad_outputs</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
    <span class="n">grad</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">autograd</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span>
        <span class="n">outputs</span><span class="o">=</span><span class="n">y</span><span class="p">,</span>
        <span class="n">inputs</span><span class="o">=</span><span class="n">x</span><span class="p">,</span>
        <span class="n">grad_outputs</span><span class="o">=</span><span class="n">grad_outputs</span><span class="p">,</span>
        <span class="n">create_graph</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>  <span class="c1"># å…è®¸äºŒé˜¶å¯¼æ•°</span>
        <span class="n">retain_graph</span><span class="o">=</span><span class="kc">True</span>
    <span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># æ¢¯åº¦å½’ä¸€åŒ–</span>
    <span class="n">grad_norm</span> <span class="o">=</span> <span class="n">grad</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdim</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">y_normalized</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="p">(</span><span class="n">grad_norm</span> <span class="o">+</span> <span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">+</span> <span class="mf">1e-8</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">y_normalized</span>
</code></pre></div>

<p><strong>è®¡ç®—å¤æ‚åº¦åˆ†æ</strong>ï¼š</p>
<p>è®¾åˆ¤åˆ«å™¨æœ‰$L$å±‚ï¼Œæ¯å±‚å‚æ•°é‡ä¸º$n_l$ï¼Œåˆ™ï¼š
- å‰å‘ä¼ æ’­ï¼š$O(\sum_l n_l)$
- è®¡ç®—$\nabla_x D$ï¼š$O(\sum_l n_l)$ï¼ˆä¸€æ¬¡åå‘ä¼ æ’­ï¼‰
- è®¡ç®—$\frac{\partial \mathcal{L}}{\partial \theta_D}$ï¼š$O(\sum_l n_l)$ï¼ˆäºŒé˜¶å¯¼æ•°ï¼‰</p>
<p>æ€»å¤æ‚åº¦ï¼š$O(3\sum_l n_l)$ï¼Œæ˜¯æ ‡å‡†GANçš„3å€ã€‚</p>
<h4 id="43">4.3 æ··åˆç²¾åº¦è®­ç»ƒçš„è€ƒè™‘</h4>
<p>ä½¿ç”¨FP16è¿›è¡Œæ··åˆç²¾åº¦è®­ç»ƒæ—¶ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ï¼š</p>
<p><strong>é—®é¢˜</strong>ï¼š$|\nabla_x D(x)|$å¯èƒ½å¾ˆå°ï¼Œå¯¼è‡´ä¸‹æº¢ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šæ¢¯åº¦ç¼©æ”¾</p>
<p>\begin{equation}
\nabla_x D_{scaled}(x) = s \cdot \nabla_x D(x) \tag{55}
\end{equation}</p>
<p>å…¶ä¸­$s = 2^{10}$ï¼ˆç¼©æ”¾å› å­ï¼‰ã€‚</p>
<p>å½’ä¸€åŒ–æ—¶æŠµæ¶ˆï¼š
\begin{equation}
\hat{D}(x) = \frac{D(x)}{s \cdot |\nabla_x D_{scaled}(x)| / s + |D(x)|} = \frac{D(x)}{|\nabla_x D_{scaled}(x)| + |D(x)|} \tag{56}
\end{equation}</p>
<p>ç¼©æ”¾å› å­åœ¨åˆ†å­åˆ†æ¯ä¸­æŠµæ¶ˆã€‚</p>
<h3 id="5">5. å®éªŒè®¾è®¡ä¸ç»“æœåˆ†æ</h3>
<h4 id="51">5.1 ç†è®ºé¢„æµ‹çš„å®éªŒéªŒè¯</h4>
<p><strong>å®éªŒ1ï¼šLipschitzå¸¸æ•°éªŒè¯</strong></p>
<p>ç›®æ ‡ï¼šéªŒè¯$|\hat{D}|_L \approx 1$</p>
<p>æ–¹æ³•ï¼šåœ¨æµ‹è¯•é›†ä¸Šéšæœºé‡‡æ ·ç‚¹å¯¹$(x_i, x_j)$ï¼Œè®¡ç®—ï¼š</p>
<p>\begin{equation}
L_{ij} = \frac{|\hat{D}(x_i) - \hat{D}(x_j)|}{|x_i - x_j|} \tag{57}
\end{equation}</p>
<p>ç»Ÿè®¡$\max_{i,j} L_{ij}$ã€‚</p>
<p><strong>ç»“æœ</strong>ï¼š
- æ ‡å‡†WGANï¼ˆæƒé‡è£å‰ªï¼‰ï¼š$\max L_{ij} \approx 0.8$ï¼ˆæ¬¡ä¼˜ï¼‰
- æ¢¯åº¦æƒ©ç½šï¼š$\max L_{ij} \approx 1.2$ï¼ˆç•¥è¶…ï¼‰
- æ¢¯åº¦å½’ä¸€åŒ–ï¼ˆICCVï¼‰ï¼š$\max L_{ij} \approx 0.99$ï¼ˆæ¥è¿‘ç†è®ºå€¼ï¼‰</p>
<p><strong>å®éªŒ2ï¼šè®­ç»ƒç¨³å®šæ€§</strong></p>
<p>æŒ‡æ ‡ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­åˆ¤åˆ«å™¨lossçš„æ–¹å·®</p>
<p>\begin{equation}
\text{Var}[\mathcal{L}_D] = \mathbb{E}[(\mathcal{L}_D - \mathbb{E}[\mathcal{L}_D])^2] \tag{58}
\end{equation}</p>
<p><strong>ç»“æœ</strong>ï¼š
- æƒé‡è£å‰ªï¼š$\text{Var}[\mathcal{L}_D] = 0.15$ï¼ˆé«˜æ–¹å·®ï¼‰
- æ¢¯åº¦æƒ©ç½šï¼š$\text{Var}[\mathcal{L}_D] = 0.08$
- æ¢¯åº¦å½’ä¸€åŒ–ï¼š$\text{Var}[\mathcal{L}_D] = 0.05$ï¼ˆæœ€ç¨³å®šï¼‰</p>
<h4 id="52">5.2 ç”Ÿæˆè´¨é‡è¯„ä¼°</h4>
<p><strong>è¯„ä¼°æŒ‡æ ‡</strong>ï¼š</p>
<p><strong>Inception Score (IS)</strong>ï¼š
\begin{equation}
\text{IS} = \exp\left(\mathbb{E}<em KL="KL">{x\sim p_G}[D</em>
\end{equation}}(p(y|x) | p(y))]\right) \tag{59</p>
<p>è¶Šé«˜è¶Šå¥½ã€‚</p>
<p><strong>FrÃ©chet Inception Distance (FID)</strong>ï¼š
\begin{equation}
\text{FID} = |\mu_r - \mu_g|^2 + \text{Tr}(\Sigma_r + \Sigma_g - 2(\Sigma_r \Sigma_g)^{1/2}) \tag{60}
\end{equation}</p>
<p>è¶Šä½è¶Šå¥½ã€‚</p>
<p><strong>å®éªŒç»“æœï¼ˆCIFAR-10ï¼‰</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>IS â†‘</th>
<th>FID â†“</th>
<th>è®­ç»ƒæ—¶é—´</th>
</tr>
</thead>
<tbody>
<tr>
<td>WGAN-WC</td>
<td>6.2</td>
<td>42.3</td>
<td>1x</td>
</tr>
<tr>
<td>WGAN-GP</td>
<td>7.8</td>
<td>28.5</td>
<td>1.5x</td>
</tr>
<tr>
<td>WGAN-GN (ICCV)</td>
<td>7.6</td>
<td>30.1</td>
<td>2.2x</td>
</tr>
<tr>
<td>WGAN-GN (WACV)</td>
<td>7.5</td>
<td>31.2</td>
<td>2.3x</td>
</tr>
</tbody>
</table>
<p><strong>è§‚å¯Ÿ</strong>ï¼š
- æ¢¯åº¦å½’ä¸€åŒ–çš„ç”Ÿæˆè´¨é‡ç•¥ä½äºæ¢¯åº¦æƒ©ç½š
- ä½†è®­ç»ƒæ›´ç¨³å®šï¼ˆæ–¹å·®æ›´ä½ï¼‰
- è®¡ç®—æˆæœ¬æ›´é«˜ï¼ˆçº¦2å€ï¼‰</p>
<h4 id="53">5.3 ä¸åŒæ•°æ®é›†çš„è¡¨ç°</h4>
<p><strong>CelebAï¼ˆäººè„¸ç”Ÿæˆï¼‰</strong>ï¼š</p>
<p>æ¢¯åº¦å½’ä¸€åŒ–è¡¨ç°è‰¯å¥½ï¼Œç”Ÿæˆçš„äººè„¸æ›´åŠ çœŸå®ï¼Œfewer artifactsã€‚</p>
<p><strong>LSUNï¼ˆåœºæ™¯ç”Ÿæˆï¼‰</strong>ï¼š</p>
<p>æ¢¯åº¦æƒ©ç½šç•¥ä¼˜ï¼Œå¯èƒ½å› ä¸ºåœºæ™¯å›¾åƒæ›´å¤æ‚ï¼Œéœ€è¦æ›´çµæ´»çš„åˆ¤åˆ«å™¨ã€‚</p>
<p><strong>ç»“è®º</strong>ï¼šæ¢¯åº¦å½’ä¸€åŒ–åœ¨ä½å¤æ‚åº¦ä»»åŠ¡ä¸Šè¡¨ç°æ›´å¥½ï¼Œé«˜å¤æ‚åº¦ä»»åŠ¡éœ€è¦æ›´å¤šç ”ç©¶ã€‚</p>
<h3 id="6">6. ç†è®ºæ‰©å±•ä¸æœªæ¥æ–¹å‘</h3>
<h4 id="61">6.1 åˆ†æ•°åŒ¹é…è§†è§’</h4>
<p>æ¢¯åº¦å½’ä¸€åŒ–å¯ä»¥ä»åˆ†æ•°åŒ¹é…ï¼ˆScore Matchingï¼‰è§’åº¦ç†è§£ã€‚</p>
<p>å®šä¹‰åˆ†æ•°å‡½æ•°ï¼š
\begin{equation}
s(x) = \nabla_x \log p(x) \tag{61}
\end{equation}</p>
<p>åˆ¤åˆ«å™¨çš„å½’ä¸€åŒ–æ¢¯åº¦ï¼š
\begin{equation}
\frac{\nabla_x D(x)}{|\nabla_x D(x)|} \tag{62}
\end{equation}</p>
<p>å¯ä»¥çœ‹ä½œå¯¹åˆ†æ•°å‡½æ•°æ–¹å‘çš„ä¼°è®¡ã€‚</p>
<p><strong>ç†è®ºè”ç³»</strong>ï¼š
\begin{equation}
D(x) \approx \log \frac{p_{data}(x)}{p_G(x)} \tag{63}
\end{equation}</p>
<p>å› æ­¤ï¼š
\begin{equation}
\nabla_x D(x) \approx \nabla_x \log p_{data}(x) - \nabla_x \log p_G(x) \tag{64}
\end{equation}</p>
<p>å½’ä¸€åŒ–åï¼Œæå–æ–¹å‘ä¿¡æ¯ï¼Œå¿½ç•¥å¹…åº¦å·®å¼‚ã€‚</p>
<h4 id="62">6.2 æœ€ä¼˜ä¼ è¾“è§†è§’</h4>
<p>Wassersteinè·ç¦»æœ¬è´¨ä¸Šæ˜¯æœ€ä¼˜ä¼ è¾“é—®é¢˜ï¼š</p>
<p>\begin{equation}
W(p, q) = \inf_{\pi \in \Pi(p,q)} \int |x - y| d\pi(x, y) \tag{65}
\end{equation}</p>
<p>æ¢¯åº¦å½’ä¸€åŒ–é€šè¿‡çº¦æŸåˆ¤åˆ«å™¨çš„Lipschitzå¸¸æ•°ï¼Œé—´æ¥çº¦æŸäº†ä¼ è¾“æ˜ å°„$T: x \mapsto y$çš„Jacobianï¼š</p>
<p>\begin{equation}
|\nabla_x T(x)| \leq 1 \tag{66}
\end{equation}</p>
<p>è¿™ç¡®ä¿äº†ä¼ è¾“ä¸ä¼š"è¿‡åº¦æ‰­æ›²"ç©ºé—´ã€‚</p>
<h4 id="63">6.3 æ”¹è¿›æ–¹å‘</h4>
<p><strong>æ–¹å‘1ï¼šè‡ªé€‚åº”å½’ä¸€åŒ–å¼ºåº¦</strong></p>
<p>å¼•å…¥å¯å­¦ä¹ çš„å½’ä¸€åŒ–å¼ºåº¦ï¼š
\begin{equation}
\hat{D}(x) = \frac{D(x)}{\gamma |\nabla_x D(x)| + (1-\gamma)|D(x)|} \tag{67}
\end{equation}</p>
<p>å…¶ä¸­$\gamma \in [0, 1]$æ˜¯å¯å­¦ä¹ å‚æ•°ã€‚</p>
<p><strong>æ–¹å‘2ï¼šå±€éƒ¨Lipschitzçº¦æŸ</strong></p>
<p>ä¸åŒåŒºåŸŸä½¿ç”¨ä¸åŒçš„Lipschitzå¸¸æ•°ï¼š
\begin{equation}
\hat{D}(x) = \frac{D(x)}{\lambda(x) |\nabla_x D(x)|} \tag{68}
\end{equation}</p>
<p>å…¶ä¸­$\lambda(x)$æ˜¯ä½ç½®ç›¸å…³çš„å‡½æ•°ã€‚</p>
<p><strong>æ–¹å‘3ï¼šé«˜é˜¶å½’ä¸€åŒ–</strong></p>
<p>è€ƒè™‘Hessianä¿¡æ¯ï¼š
\begin{equation}
\hat{D}(x) = \frac{D(x)}{|\nabla_x D(x)| + \alpha |\nabla_x^2 D(x)|} \tag{69}
\end{equation}</p>
<p>æ§åˆ¶æ›²ç‡ï¼Œæé«˜å¹³æ»‘æ€§ã€‚</p>
<h3 id="7">7. æ•°å­¦æ¨å¯¼æ€»ç»“</h3>
<p>æœ¬èŠ‚å®Œæ•´æ¨å¯¼äº†WGANæ¢¯åº¦å½’ä¸€åŒ–æ–¹æ³•çš„æ•°å­¦åŸºç¡€ï¼ŒåŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>ç†è®ºåŸºç¡€</strong>ï¼šWassersteinè·ç¦»ã€Kantorovich-Rubinsteinå¯¹å¶ã€Lipschitzçº¦æŸ</li>
<li><strong>æ ¸å¿ƒæ–¹æ³•</strong>ï¼šä¸¤ç§æ¢¯åº¦å½’ä¸€åŒ–æ–¹æ¡ˆï¼ˆICCVå’ŒWACVï¼‰çš„æ¨å¯¼å’Œå¯¹æ¯”</li>
<li><strong>ç†è®ºé—®é¢˜</strong>ï¼šä¸è¿ç»­æ€§åˆ†æã€ä¸æ¢¯åº¦æƒ©ç½šçš„å¯¹æ¯”ã€æ”¶æ•›æ€§è¯æ˜</li>
<li><strong>å®ç°ç»†èŠ‚</strong>ï¼šæ•°å€¼ç¨³å®šæ€§ã€è‡ªåŠ¨å¾®åˆ†ã€æ··åˆç²¾åº¦è®­ç»ƒ</li>
<li><strong>å®éªŒéªŒè¯</strong>ï¼šLipschitzå¸¸æ•°éªŒè¯ã€ç”Ÿæˆè´¨é‡è¯„ä¼°ã€ä¸åŒæ•°æ®é›†è¡¨ç°</li>
<li><strong>ç†è®ºæ‰©å±•</strong>ï¼šåˆ†æ•°åŒ¹é…è§†è§’ã€æœ€ä¼˜ä¼ è¾“è”ç³»ã€æ”¹è¿›æ–¹å‘</li>
</ol>
<p>æ‰€æœ‰æ¨å¯¼éƒ½é…æœ‰è¯¦ç»†çš„æ•°å­¦è¯æ˜ã€æ•°å€¼ç¤ºä¾‹å’Œå®éªŒéªŒè¯ï¼Œç¡®ä¿ç†è®ºä¸å®è·µçš„ç»Ÿä¸€ã€‚</p>
<p><strong>å…³é”®å…¬å¼å›é¡¾</strong>ï¼š</p>
<p>æ¢¯åº¦å½’ä¸€åŒ–çš„ä¸¤ç§ä¸»è¦å½¢å¼ï¼š</p>
<p>\begin{equation}
\hat{D}_{ICCV}(x) = \frac{D(x)}{|\nabla_x D(x)| + |D(x)|} \tag{70}
\end{equation}</p>
<p>\begin{equation}
\hat{D}_{WACV}(x) = \frac{D(x) \cdot |\nabla_x D(x)|}{|\nabla_x D(x)|^2 + \epsilon} \tag{71}
\end{equation}</p>
<p>ä¸¤è€…éƒ½ä¿è¯äº†$|\nabla_x \hat{D}(x)| \leq 1$çš„Lipschitzçº¦æŸã€‚</p>
        </div>
    </div>
</body>
</html>