<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåä¸ƒï¼‰ï¼šå°†æ­¥é•¿ä½œä¸ºæ¡ä»¶è¾“å…¥</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåä¸ƒï¼‰ï¼šå°†æ­¥é•¿ä½œä¸ºæ¡ä»¶è¾“å…¥</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 35.0 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10617">https://spaces.ac.cn/archives/10617</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å†æ¬¡èšç„¦äºæ‰©æ•£æ¨¡å‹çš„é‡‡æ ·åŠ é€Ÿã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œæ‰©æ•£æ¨¡å‹çš„é‡‡æ ·åŠ é€Ÿä¸»è¦æœ‰ä¸¤ç§æ€è·¯ï¼Œä¸€æ˜¯å¼€å‘æ›´é«˜æ•ˆçš„æ±‚è§£å™¨ï¼ŒäºŒæ˜¯äº‹åè’¸é¦ã€‚ç„¶è€Œï¼Œæ®ç¬”è€…è§‚å¯Ÿï¼Œé™¤äº†ä¸Šä¸¤ç¯‡æ–‡ç« ä»‹ç»è¿‡çš„<a href="/archives/10085">SiD</a>å¤–ï¼Œè¿™ä¸¤ç§æ–¹æ¡ˆéƒ½é²œæœ‰èƒ½å°†ç”Ÿæˆæ­¥æ•°é™ä½åˆ°ä¸€æ­¥çš„ç»“æœã€‚è™½ç„¶SiDèƒ½åšåˆ°å•æ­¥ç”Ÿæˆï¼Œä½†å®ƒéœ€è¦é¢å¤–çš„è’¸é¦æˆæœ¬ï¼Œå¹¶ä¸”è’¸é¦è¿‡ç¨‹ä¸­ç”¨åˆ°äº†ç±»ä¼¼GANçš„äº¤æ›¿è®­ç»ƒè¿‡ç¨‹ï¼Œæ€»è®©äººæ„Ÿè§‰å·®ç‚¹æ„æ€ã€‚</p>
<p>æœ¬æ–‡è¦ä»‹ç»çš„æ˜¯<a href="https://papers.cool/arxiv/2410.12557">ã€ŠOne Step Diffusion via Shortcut Modelsã€‹</a>ï¼Œå…¶çªç ´æ€§æ€æƒ³æ˜¯å°†ç”Ÿæˆæ­¥é•¿ä¹Ÿä½œä¸ºæ‰©æ•£æ¨¡å‹çš„æ¡ä»¶è¾“å…¥ï¼Œç„¶åå¾€è®­ç»ƒç›®æ ‡ä¸­åŠ å…¥äº†ä¸€ä¸ªç›´è§‚çš„æ­£åˆ™é¡¹ï¼Œè¿™æ ·å°±èƒ½ç›´æ¥ç¨³å®šè®­ç»ƒå‡ºå¯ä»¥å•æ­¥ç”Ÿæˆæ¨¡å‹ï¼Œå¯è°“ç®€å•æœ‰æ•ˆçš„ç»å…¸ä¹‹ä½œã€‚</p>
<h2 id="ode">ODEæ‰©æ•£</h2>
<p>åŸè®ºæ–‡çš„ç»“è®ºæ˜¯åŸºäºODEå¼æ‰©æ•£æ¨¡å‹çš„ï¼Œè€Œå¯¹äºODEå¼æ‰©æ•£çš„ç†è®ºåŸºç¡€ï¼Œæˆ‘ä»¬åœ¨æœ¬ç³»åˆ—çš„<a href="/archives/9228">ï¼ˆå…­ï¼‰</a>ã€<a href="/archives/9280">ï¼ˆåäºŒï¼‰</a>ã€<a href="/archives/9370">ï¼ˆåå››ï¼‰</a>ã€<a href="/archives/9379">ï¼ˆåäº”ï¼‰</a>ã€<a href="/archives/9497">ï¼ˆåä¸ƒï¼‰</a>ç­‰åšå®¢ä¸­å·²ç»å¤šæ¬¡ä»‹ç»ï¼Œå…¶ä¸­æœ€ç®€å•çš„ä¸€ç§ç†è§£æ–¹å¼å¤§æ¦‚æ˜¯<a href="/archives/9497">ï¼ˆåä¸ƒï¼‰</a>ä¸­çš„ReFlowè§†è§’ï¼Œä¸‹é¢æˆ‘ä»¬ç®€å•é‡å¤ä¸€ä¸‹ã€‚</p>
<p>å‡è®¾$\boldsymbol{x}<em>0\sim p_0(\boldsymbol{x}_0)$æ˜¯å…ˆéªŒåˆ†å¸ƒé‡‡æ ·çš„ _éšæœºå™ªå£°</em> ï¼Œ$\boldsymbol{x}<em>1\sim p_1(\boldsymbol{x}_1)$æ˜¯ç›®æ ‡åˆ†å¸ƒé‡‡æ ·çš„ _çœŸå®æ ·æœ¬</em> ï¼ˆæ³¨ï¼šå‰é¢çš„æ–‡ç« ä¸­ï¼Œæ™®é€šéƒ½æ˜¯$\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">T$æ˜¯å™ªå£°ã€$\boldsymbol{x}_0$æ˜¯ç›®æ ‡æ ·æœ¬ï¼Œè¿™é‡Œæ–¹ä¾¿èµ·è§åè¿‡æ¥äº†ï¼‰ï¼ŒReFlowå…è®¸æˆ‘ä»¬æŒ‡å®šä»»æ„ä»$\boldsymbol{x}_0$åˆ°$\boldsymbol{x}_1$çš„è¿åŠ¨è½¨è¿¹ï¼Œæœ€ç®€å•çš„è½¨è¿¹è‡ªç„¶æ˜¯ç›´çº¿ï¼š<br />
\begin{equation}\boldsymbol{x}_t = (1-t)\boldsymbol{x}_0 + t \boldsymbol{x}_1\label{eq:line}\end{equation}<br />
ä¸¤è¾¹æ±‚å¯¼ï¼Œå°±å¯ä»¥å¾—åˆ°å®ƒæ»¡è¶³çš„ODEï¼ˆå¸¸å¾®åˆ†æ–¹ç¨‹ï¼‰ï¼š<br />
\begin{equation}\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{x}_1 - \boldsymbol{x}_0\end{equation}<br />
è¿™ä¸ªODEå¾ˆç®€å•ï¼Œä½†å®é™…ä¸Šæ²¡ç”¨ï¼Œå› ä¸ºæˆ‘ä»¬æƒ³è¦çš„æ˜¯é€šè¿‡ODEç”±$\boldsymbol{x}_0$ç”Ÿæˆ$\boldsymbol{x}_1$ï¼Œè€Œä¸Šè¿°ODEå´æ˜¾å¼åœ°ä¾èµ–$\boldsymbol{x}_1$ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä¸€ä¸ªå¾ˆç®€å•çš„æƒ³æ³•æ˜¯â€œå­¦ä¸€ä¸ª$\boldsymbol{x}_t$çš„å‡½æ•°å»é€¼è¿‘$\boldsymbol{x}_1 - \boldsymbol{x}_0$â€ï¼Œå­¦å®Œä¹‹åå°±ç”¨å®ƒæ¥å–ä»£$\boldsymbol{x}_1 - \boldsymbol{x}_0$ï¼Œå³<br />
\begin{equation}\boldsymbol{\theta}^<em> = \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\left[\Vert\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) - (\boldsymbol{x}_1 - \boldsymbol{x}_0)\Vert^2\right]\label{eq:loss}\end{equation}<br />
ä»¥åŠ<br />
\begin{equation}\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{x}_1 - \boldsymbol{x}_0\quad\Rightarrow\quad\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{v}</em>^</em>}(\boldsymbol{x}_t, t)\label{eq:ode-core}\end{equation}<br />
è¿™å°±æ˜¯ReFlowã€‚å½“ç„¶è¿™é‡Œè¾¹è¿˜æ¬ ç¼ºäº†ä¸€ä¸ªç†è®ºè¯æ˜ï¼Œå°±æ˜¯é€šè¿‡å¹³æ–¹è¯¯å·®æ¥æ‹Ÿåˆ$\boldsymbol{v}</em>_t, t)$æ‰€å¾—åˆ°çš„ODEç¡®å®èƒ½ç”Ÿæˆæˆ‘ä»¬æœŸæœ›çš„åˆ†å¸ƒï¼Œè¿™éƒ¨åˆ†å¤§å®¶è‡ªè¡Œçœ‹}}(\boldsymbol{x<a href="/archives/9497">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåä¸ƒï¼‰ï¼šæ„å»ºODEçš„ä¸€èˆ¬æ­¥éª¤ï¼ˆä¸‹ï¼‰ã€‹</a>å°±å¥½ã€‚</p>
<h2 id="_1">æ­¥é•¿è‡ªæ´½</h2>
<p>å‡è®¾æˆ‘ä»¬å·²ç»æœ‰äº†$\boldsymbol{v}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$ï¼Œé‚£ä¹ˆé€šè¿‡æ±‚è§£å¾®åˆ†æ–¹ç¨‹$\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{v}</em>}}(\boldsymbol{x<em _="+" _epsilon="\epsilon" t="t">t, t)$å°±å¯ä»¥å®ç°ä»$\boldsymbol{x}_0$åˆ°$\boldsymbol{x}_1$çš„å˜æ¢ã€‚åˆ’é‡ç‚¹ï¼Œæ˜¯â€œå¾®åˆ†æ–¹ç¨‹â€ï¼Œä½†å®é™…ä¸Šæˆ‘ä»¬æ²¡æ³•çœŸçš„å»æ•°å€¼è®¡ç®—å¾®åˆ†æ–¹ç¨‹ï¼Œè€Œæ˜¯åªèƒ½ç®—â€œå·®åˆ†æ–¹ç¨‹â€ï¼š<br />
\begin{equation}\boldsymbol{x}</em>} - \boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t = \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) \epsilon\label{eq:de}\end{equation}<br />
è¿™ä¸ªå·®åˆ†æ–¹ç¨‹æ˜¯åŸå§‹ODEçš„â€œæ¬§æ‹‰è¿‘ä¼¼â€ï¼Œè¿‘ä¼¼ç¨‹åº¦å–å†³äºæ­¥é•¿$\epsilon$çš„å¤§å°ï¼Œå½“$\epsilon\to 0$æ—¶å°±ç²¾ç¡®ç­‰äºåŸå§‹ODEï¼Œæ¢è¨€ä¹‹æ­¥é•¿è¶Šå°è¶Šç²¾ç¡®ã€‚ç„¶è€Œï¼Œç”Ÿæˆæ­¥æ•°ç­‰äº$1/\epsilon$ï¼Œæˆ‘ä»¬å¸Œæœ›ç”Ÿæˆæ­¥æ•°è¶Šå°‘è¶Šå¥½ï¼Œè¿™æ„å‘³ç€ä¸èƒ½ç”¨å¤ªå¤§çš„æ­¥é•¿ï¼Œæœ€å¥½$\epsilon$å¯ä»¥ç­‰äº1ï¼Œè¿™æ ·$\boldsymbol{x}_1 = \boldsymbol{x}_0 + \boldsymbol{v}</em>_0, 0)$ï¼Œä¸€æ­¥å°±å¯ä»¥å®Œæˆç”Ÿæˆã€‚}}(\boldsymbol{x</p>
<p>é—®é¢˜æ˜¯ï¼Œå¦‚æœç›´æ¥ç”¨å¤§æ­¥é•¿ä»£å…¥ä¸Šå¼ï¼Œæœ€ç»ˆæ‰€ç®—å¾—çš„$\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1$å¿…ç„¶ä¼šä¸¥é‡åç¦»ç²¾ç¡®è§£ã€‚è¿™æ—¶å€™åŸè®ºæ–‡ï¼ˆä¸‹ç§°â€œShortcutæ¨¡å‹â€ï¼‰çš„å·§å¦™æ„æ€å°±ç™»åœºäº†ï¼šå®ƒè®¤ä¸ºæ¨¡å‹$\boldsymbol{v}</em>}}(\boldsymbol{x<em _="+" _epsilon="\epsilon" t="t">t, t)$ä¸åº”è¯¥åªæ˜¯$\boldsymbol{x}_t$å’Œ$t$çš„å‡½æ•°ï¼Œè¿˜åº”è¯¥æ˜¯æ­¥é•¿$\epsilon$çš„å‡½æ•°ï¼Œè¿™æ ·å·®åˆ†æ–¹ç¨‹$\eqref{eq:de}$å°±å¯ä»¥è‡ªè¡Œé€‚åº”æ­¥é•¿ï¼š<br />
\begin{equation}\boldsymbol{x}</em>} - \boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t = \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t, t, \epsilon) \epsilon\end{equation}<br />
ç›®æ ‡$\eqref{eq:loss}$è®­ç»ƒçš„æ˜¯ç²¾ç¡®çš„ODEæ¨¡å‹ï¼Œæ‰€ä»¥å®ƒè®­ç»ƒçš„æ˜¯$\epsilon=0$çš„æ¨¡å‹ï¼š<br />
\begin{equation}\mathcal{L}_1 = \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\left[\frac{1}{2}\Vert\boldsymbol{v}</em>}}(\boldsymbol{x<em>t, t, 0) - (\boldsymbol{x}_1 - \boldsymbol{x}_0)\Vert^2\right]\end{equation}<br />
é‚£$\epsilon &gt; 0$çš„éƒ¨åˆ†åˆæ€ä¹ˆè®­ç»ƒå‘¢ï¼Ÿæˆ‘ä»¬çš„ç›®æ ‡æ˜¯ç”Ÿæˆæ­¥æ•°è¶Šå°‘è¶Šå¥½ï¼Œè¿™ç­‰ä»·äºè¯´å¸Œæœ›â€œ _ä¸¤å€çš„æ­¥é•¿èµ°1æ­¥</em> ç­‰äº <em>å•å€çš„æ­¥é•¿èµ°2æ­¥</em> â€ï¼š<br />
\begin{equation}\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t + \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, 2\epsilon) 2\epsilon = \color{green}{\underbrace{\boldsymbol{x}_t + \boldsymbol{v}</em>}}(\boldsymbol{x<em _tilde_boldsymbol_x="\tilde{\boldsymbol{x">t, t, \epsilon) \epsilon}</em>}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon}}} + \boldsymbol{v}</em>}}\big(\color{green}{\underbrace{\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t + \boldsymbol{v}</em>}}(\boldsymbol{x<em _tilde_boldsymbol_x="\tilde{\boldsymbol{x">t, t, \epsilon) \epsilon}</em>}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon}}}, t+\epsilon, \epsilon\big) \epsilon\label{eq:cond}\end{equation}<br />
å³$\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, 2\epsilon) = [\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, \epsilon) + \boldsymbol{v}</em>}}(\color{green}{\tilde{\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">{t+\epsilon}}, t+\epsilon, \epsilon)] /2$ã€‚ä¸ºäº†è¾¾åˆ°è¿™ä¸ªç›®æ ‡ï¼Œæˆ‘ä»¬è¡¥å……ä¸€é¡¹è‡ªæ´½æ€§æŸå¤±å‡½æ•°<br />
\begin{equation}\mathcal{L}_2 = \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\left[\Vert\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, 2\epsilon) - [\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, \epsilon)+ \boldsymbol{v}</em>}}(\color{green}{\tilde{\boldsymbol{x}}_{t+\epsilon}}, t+\epsilon, \epsilon) ]/2\Vert^2\right]\end{equation<br />
$\mathcal{L}_1$ä¸$\mathcal{L}_2$ç›¸åŠ ï¼Œå°±æ„æˆäº†Shortcutæ¨¡å‹çš„æŸå¤±å‡½æ•°ã€‚</p>
<p>ï¼ˆæ³¨ï¼šæœ‰è¯»è€…æŒ‡å‡ºï¼Œæ›´æ—©çš„<a href="https://papers.cool/arxiv/2310.02279">ã€ŠConsistency Trajectory Models: Learning Probability Flow ODE Trajectory of Diffusionã€‹</a>æå‡ºè¿‡ä»¥ç¦»æ•£åŒ–æ—¶é—´çš„èµ·ç‚¹å’Œç»ˆç‚¹ä½œä¸ºæ¡ä»¶è¾“å…¥çš„åšæ³•ï¼ŒæŒ‡å®šèµ·ç‚¹å’Œç»ˆç‚¹åæ­¥é•¿å…¶å®ä¹Ÿå°±ç¡®å®šäº†ï¼Œæ‰€ä»¥Shortcutä»¥æ­¥é•¿ä¸ºè¾“å…¥çš„åšæ³•å¹¶ä¸ç®—å®Œå…¨åˆ›æ–°ã€‚ï¼‰</p>
<h2 id="_2">æ¨¡å‹ç»†èŠ‚</h2>
<p>ä»¥ä¸ŠåŸºæœ¬å°±æ˜¯Shortcutæ¨¡å‹çš„å…¨éƒ¨ç†è®ºå†…å®¹ï¼Œéå¸¸ç²¾å·§ä¸”ç®€æ˜ï¼Œä½†ä»ç†è®ºåˆ°å®éªŒï¼Œè¿˜éœ€è¦ä¸€äº›ç»†èŠ‚ï¼Œæ¯”å¦‚æ­¥é•¿$\epsilon$å¦‚ä½•èå…¥åˆ°æ¨¡å‹ä¸­å»ã€‚</p>
<p>é¦–å…ˆï¼Œåœ¨è®­ç»ƒ$\mathcal{L}_2$æ—¶ï¼ŒShortcutå¹¶æ²¡æœ‰å‡åŒ€åœ°ä»$[0,1]$é‡‡æ ·$\epsilon$ï¼Œè€Œæ˜¯è®¾ç½®äº†ä¸€ä¸ªæœ€å°æ­¥é•¿$2^{-7}$ï¼Œç„¶åå°†å®ƒä»¬å€å¢è‡³1ï¼Œå³æ‰€æœ‰çš„éé›¶æ­¥é•¿åªæœ‰$\{2^{-7},2^{-6},2^{-5},2^{-4},2^{-3},2^{-2},2^{-1},1\}$è¿™8ä¸ªå€¼ï¼Œä»å‰7ä¸ªä¸­å‡åŒ€é‡‡æ ·æ¥è®­ç»ƒ$\mathcal{L}_2$ã€‚è¿™æ ·ä¸€æ¥ï¼Œ$\epsilon$çš„å–å€¼å°±æ˜¯æœ‰é™çš„ï¼Œç®—ä¸Š$0$ä¸€å…±å°±åªæœ‰9ä¸ªï¼Œæ‰€ä»¥Shortcutæ¨¡å‹ç›´æ¥ä»¥Embeddingçš„æ–¹å¼æ¥è¾“å…¥$\epsilon$ï¼Œå°†å®ƒè·Ÿ$t$çš„EmbeddingåŠ åœ¨ä¸€èµ·ã€‚</p>
<p>å…¶æ¬¡ï¼Œæ³¨æ„åˆ°$\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">2$çš„è®¡ç®—é‡æ˜¯æ¯”$\mathcal{L}_1$å¤§çš„ï¼Œå› ä¸º$\boldsymbol{v}</em>_1$æ›´å¥½è®­ç»ƒï¼Œæ‰€ä»¥å®ƒçš„è®­ç»ƒæ ·æœ¬å¯ä»¥é€‚å½“å°‘äº›ã€‚}}(\tilde{\boldsymbol{x}}_{t+\epsilon}, t, \epsilon)$è¿™ä¸€é¡¹éœ€è¦ä¸¤æ¬¡å‰å‘ä¼ æ’­ï¼Œæ‰€ä»¥è®ºæ–‡çš„åšæ³•æ˜¯æ¯ä¸ªbatchä¸­$3/4$çš„æ ·æœ¬éƒ½ç”¨æ¥è®¡ç®—$\mathcal{L}_1$ï¼Œå‰©ä¸‹çš„$1/4$æ ·æœ¬æ‰ç”¨æ¥ç®—$\mathcal{L}_2$ã€‚è¯¥æ“ä½œä¸ä»…æ˜¯ä¸ºäº†èŠ‚çœè®¡ç®—é‡ï¼Œå®é™…ä¸Šè¿˜è°ƒèŠ‚äº†$\mathcal{L}_1,\mathcal{L}_2$çš„æƒé‡ï¼Œå› ä¸º$\mathcal{L}_2$æ¯”$\mathcal{L</p>
<p>é™¤æ­¤ä¹‹å¤–ï¼Œè®ºæ–‡åœ¨å®è·µçš„æ—¶å€™è¿˜å¯¹$\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">2$åšäº†å¾®è°ƒï¼Œå¤šåŠ äº†ä¸ªstop gradientç®—å­ï¼š<br />
\begin{equation}\mathcal{L}_2 = \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0(\boldsymbol{x}_0),\boldsymbol{x}_1\sim p_1(\boldsymbol{x}_1)}\left[\Vert\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, 2\epsilon) - \color{skyblue}{\text{sg}[}\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, \epsilon)+ \boldsymbol{v}</em>}}(\color{green}{\tilde{\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon}}, t+\epsilon, \epsilon) \color{skyblue}{]}/2\Vert^2\right]\end{equation}<br />
ä¸ºä»€ä¹ˆè¦è¿™æ ·åšå‘¢ï¼ŸæŒ‰ç…§ä½œè€…çš„<a href="https://openreview.net/forum?id=OlzB6LnXcSÂ¬eId=k4If3csXST">å›å¤</a>ï¼Œè¿™æ˜¯è‡ªå¼•å¯¼å­¦ä¹ çš„å¸¸è§åšæ³•ï¼Œè¢«stop gradientçš„éƒ¨åˆ†å±äºç›®æ ‡ï¼Œä¸åº”è¯¥æœ‰æ¢¯åº¦ï¼Œè·Ÿ<a href="https://papers.cool/arxiv/2006.07733">BYOL</a>ã€<a href="https://papers.cool/arxiv/2011.10566">SimSiam</a>ç­‰æ— ç›‘ç£å­¦ä¹ æ–¹æ¡ˆç±»ä¼¼ã€‚ä¸è¿‡ç…§ç¬”è€…çœ‹æ¥ï¼Œè¿™ä¸ªæ“ä½œæœ€å¤§çš„ä»·å€¼è¿˜æ˜¯èŠ‚çœè®­ç»ƒæˆæœ¬ï¼Œå› ä¸º$\boldsymbol{v}</em>, t, \epsilon)$è¿™ä¸€é¡¹åšäº†ä¸¤æ¬¡å‰å‘ä¼ æ’­ï¼Œå¦‚æœè¦å¯¹å®ƒåå‘ä¼ æ’­ï¼Œè®¡ç®—é‡ä¹Ÿè¦ç¿»å€ã€‚}}(\tilde{\boldsymbol{x}}_{t+\epsilon</p>
<h2 id="_3">å®éªŒæ•ˆæœ</h2>
<p>ç°åœ¨æˆ‘ä»¬æ¥çœ‹Shortcutæ¨¡å‹çš„å®éªŒæ•ˆæœï¼Œçœ‹èµ·æ¥å®ƒæ˜¯ç›®å‰å•æ­¥ç”Ÿæˆæ•ˆæœæœ€å¥½çš„ã€å•é˜¶æ®µè®­ç»ƒçš„æ‰©æ•£æ¨¡å‹ï¼š  </p>
<p><a href="/usr/uploads/2024/12/2449555374.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="å„ç§æ‰©æ•£æ¨¡å‹çš„ç”Ÿæˆè´¨é‡è¯„ä¼°" src="/usr/uploads/2024/12/2449555374.png" /></a></p>
<p>å„ç§æ‰©æ•£æ¨¡å‹çš„ç”Ÿæˆè´¨é‡è¯„ä¼°</p>
<p>è¿™æ˜¯å®ƒçš„å®é™…é‡‡æ ·æ•ˆæœå›¾ï¼š  </p>
<p><a href="/usr/uploads/2024/12/3428964799.jpg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="Flow Matchingä¸Shortcut Modelçš„å®é™…é‡‡æ ·æ•ˆæœå¯¹æ¯”" src="/usr/uploads/2024/12/3428964799.jpg" /></a></p>
<p>Flow Matchingä¸Shortcut Modelçš„å®é™…é‡‡æ ·æ•ˆæœå¯¹æ¯”</p>
<p>ä¸è¿‡ä»”ç»†è§‚å¯Ÿå•æ­¥ç”Ÿæˆçš„æ ·æœ¬å°±ä¼šå‘ç°ï¼Œå…¶å®è¿˜æœ‰æ˜æ˜¾çš„ç‘•ç–µï¼Œæ‰€ä»¥è¯´è™½ç„¶Shortcutæ¨¡å‹ç›¸æ¯”äºä¹‹å‰çš„å•é˜¶æ®µè®­ç»ƒæ–¹æ¡ˆæ¥è¯´å·²ç»å–å¾—äº†è¾ƒå¤§çš„è¿›æ­¥ï¼Œä½†è¿˜æœ‰æ˜æ˜¾çš„æå‡ç©ºé—´ã€‚</p>
<p>ä½œè€…å·²ç»å°†Shortcutæ¨¡å‹çš„ä»£ç å¼€æºï¼ŒGithubé“¾æ¥æ˜¯ï¼š</p>
<blockquote>
<p><strong><a href="https://github.com/kvfrans/shortcut-models">https://github.com/kvfrans/shortcut-models</a></strong></p>
</blockquote>
<p>é¡ºä¾¿è¯´ï¼ŒShortcutæ¨¡å‹æŠ•åˆ°äº†ICLR 2025ä¸Šï¼Œè·å¾—äº†reviewerçš„ä¸€è‡´å¥½è¯„ï¼ˆå…¨8åˆ†ï¼‰ã€‚</p>
<h2 id="_4">å»¶ä¼¸æ€è€ƒ</h2>
<p>çœ‹åˆ°Shortcutæ¨¡å‹ï¼Œä¸çŸ¥é“å¤§å®¶æƒ³åˆ°äº†å“ªäº›ç›¸å…³å·¥ä½œï¼Ÿç¬”è€…æƒ³åˆ°äº†ä¸€ä¸ªå¯èƒ½å¤§å®¶éƒ½æ„æƒ³ä¸åˆ°çš„ï¼Œé‚£å°±æ˜¯æˆ‘ä»¬åœ¨<a href="/archives/9881">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåä¸€ï¼‰ï¼šä¸­å€¼å®šç†åŠ é€ŸODEé‡‡æ ·ã€‹</a>ä»‹ç»è¿‡çš„AMEDã€‚</p>
<p>Shortcutæ¨¡å‹ä¸AMEDçš„åº•å±‚æ€æƒ³æ˜¯ç›¸é€šçš„ï¼Œå®ƒä»¬éƒ½å·²ç»å‘ç°ï¼Œå•é ç ”ç©¶å¤æ‚çš„é«˜é˜¶æ±‚è§£å™¨ï¼Œå°†ç”Ÿæˆçš„NFEï¼ˆæ¨¡å‹çš„è¿è¡Œæ¬¡æ•°ï¼‰é™ä½åˆ°ä¸ªä½æ•°å°±å·²ç»å¾ˆç®€å•äº†ï¼Œæ›´ä¸ç”¨è¯´åšå•æ­¥ç”Ÿæˆäº†ã€‚æ‰€ä»¥å®ƒä»¬ä¸€è‡´è®¤ä¸ºï¼ŒçœŸæ­£è¦å˜çš„å¹¶ä¸æ˜¯æ±‚è§£å™¨ï¼Œè€Œæ˜¯æ¨¡å‹ã€‚è¯¥æ€ä¹ˆå˜å‘¢ï¼ŸAMEDæƒ³åˆ°çš„æ˜¯â€œä¸­å€¼å®šç†â€ï¼šå¯¹ODEä¸¤ç«¯ç§¯åˆ†ï¼Œæˆ‘ä»¬æœ‰ç²¾ç¡®çš„<br />
\begin{equation}\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t + \epsilon} - \boldsymbol{x}_t = \int_t^{t + \epsilon}\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{\tau}, \tau) d\tau\end{equation}<br />
ç±»æ¯”â€œ<a href="https://en.wikipedia.org/wiki/Mean_value_theorem#Mean_value_theorems_for_definite_integrals">ç§¯åˆ†ä¸­å€¼å®šç†</a>â€ï¼Œæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸€ä¸ª$s\in[t, t + \epsilon]$ï¼Œæˆç«‹<br />
\begin{equation}\frac{1}{\epsilon}\int_t^{t + \epsilon}\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{\tau}, \tau) d\tau = \boldsymbol{v}</em>}}(\boldsymbol{x<em _="+" _epsilon="\epsilon" t="t">s, s)\end{equation}<br />
äºæ˜¯æˆ‘ä»¬å¾—åˆ°<br />
\begin{equation}\boldsymbol{x}</em>} - \boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t = \boldsymbol{v}</em>}}(\boldsymbol{x}_s, s) \epsilon\end{equation<br />
å½“ç„¶ï¼Œç§¯åˆ†ä¸­å€¼å®šç†å®é™…ä¸Šåªå¯¹æ ‡é‡å‡½æ•°æˆç«‹ï¼Œå¯¹å‘é‡å‡½æ•°æ˜¯ä¸ä¿è¯æˆç«‹çš„ï¼Œæ‰€ä»¥è¯´æ˜¯â€œç±»æ¯”â€ã€‚ç°åœ¨çš„é—®é¢˜æ˜¯å¹¶ä¸çŸ¥é“$s$çš„å€¼ï¼Œæ‰€ä»¥AMEDçš„åç»­åšæ³•æ˜¯ç”¨ä¸€ä¸ªéå¸¸å°çš„ï¼ˆè®¡ç®—é‡å‡ ä¹å¯ä»¥å¿½ç•¥çš„ï¼‰æ¨¡å‹å»é¢„æµ‹$s$ã€‚</p>
<p>AMEDæ˜¯åŸºäºç°æˆæ‰©æ•£æ¨¡å‹çš„äº‹åä¿®æ­£æ–¹æ³•ï¼Œå› æ­¤å®ƒçš„æ•ˆæœå–å†³äºä¸­å€¼å®šç†å¯¹$\boldsymbol{v}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$æ¨¡å‹çš„æˆç«‹ç¨‹åº¦ï¼Œè¿™æ˜¾å¾—æœ‰äº›â€œè¿æ°”æˆåˆ†â€ï¼Œå¹¶ä¸”AMEDéœ€è¦å…ˆç”¨æ¬§æ‹‰æ ¼å¼é¢„ä¼°ä¸€ä¸‹$\boldsymbol{x}_s$ï¼Œæ‰€ä»¥å®ƒçš„NFEæœ€å°‘æ˜¯2ï¼Œä¸èƒ½åšåˆ°å•æ­¥ç”Ÿæˆã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒShortcutæ¨¡å‹æ›´â€œæ¿€è¿›â€ï¼Œå®ƒç›´æ¥æŠŠæ­¥é•¿ä½œä¸ºæ¡ä»¶è¾“å…¥ï¼Œå°†åŠ é€Ÿç”Ÿæˆçš„æ¡ä»¶$\eqref{eq:cond}$ä½œä¸ºæŸå¤±å‡½æ•°ï¼Œè¿™æ ·ä¸€æ¥ä¸ä»…é¿å…äº†â€œä¸­å€¼å®šç†â€è¿‘ä¼¼çš„å¯è¡Œæ€§è®¨è®ºï¼Œè¿˜ä½¿å¾—æœ€å°‘NFEå¯ä»¥é™ä½åˆ°1ã€‚</p>
<p>æ›´å·§å¦™çš„æ˜¯ï¼Œç»†æ€ä¹‹ä¸‹æˆ‘ä»¬ä¼šå‘ç°ä¸¤è€…çš„åšæ³•å…¶å®ä¹Ÿæœ‰äº›å…±æ€§ï¼Œå‰é¢æˆ‘ä»¬è¯´äº†Shortcutæ˜¯ç›´æ¥å°†$\epsilon$è½¬æˆEmbeddingåŠ åˆ°$t$çš„Embedddingä¸Šçš„ï¼Œè¿™ä¸ç›¸å½“äºè·ŸAMEDä¸€æ ·éƒ½æ˜¯ä¿®æ”¹$t$å˜›ï¼åªä¸è¿‡AMEDæ˜¯ç›´æ¥ä¿®æ”¹$t$çš„æ•°å€¼ï¼Œè€ŒShortcutä¿®æ”¹çš„æ˜¯$t$çš„Embeddingã€‚</p>
<h2 id="_5">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ä¸ªå•é˜¶æ®µè®­ç»ƒå°±å¯ä»¥å®ç°å•æ­¥ç”Ÿæˆçš„æ‰©æ•£æ¨¡å‹æ–°å·¥ä½œï¼Œå®ƒçš„çªç ´æ€æƒ³æ˜¯å°†æ­¥é•¿ä¹Ÿå½“æˆæ¡ä»¶è¾“å…¥åˆ°æ‰©æ•£æ¨¡å‹ä¸­ï¼Œå¹¶é…ä»¥ä¸€ä¸ªç›´è§‚çš„æ­£åˆ™é¡¹ï¼Œè¿™æ ·åªé€šè¿‡å•é˜¶æ®µè®­ç»ƒå°±å¯ä»¥å¾—åˆ°å•æ­¥ç”Ÿæˆçš„æ‰©æ•£æ¨¡å‹ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10617">https://spaces.ac.cn/archives/10617</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Dec. 15, 2024). ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåä¸ƒï¼‰ï¼šå°†æ­¥é•¿ä½œä¸ºæ¡ä»¶è¾“å…¥ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10617">https://spaces.ac.cn/archives/10617</a></p>
<p>@online{kexuefm-10617,<br />
title={ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåä¸ƒï¼‰ï¼šå°†æ­¥é•¿ä½œä¸ºæ¡ä»¶è¾“å…¥},<br />
author={è‹å‰‘æ—},<br />
year={2024},<br />
month={Dec},<br />
url={\url{https://spaces.ac.cn/archives/10617}},<br />
} </p>
<hr />
<h2 id="_6">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">1. æ ¸å¿ƒæ¦‚å¿µä¸æ•°å­¦æ¡†æ¶</h3>
<h4 id="11-reflow">1.1 ReFlowæ¡†æ¶çš„åŸºç¡€</h4>
<p>ReFlowæ¡†æ¶å…è®¸æˆ‘ä»¬åœ¨å™ªå£°åˆ†å¸ƒ $\boldsymbol{x}_0 \sim p_0(\boldsymbol{x}_0)$ å’Œç›®æ ‡åˆ†å¸ƒ $\boldsymbol{x}_1 \sim p_1(\boldsymbol{x}_1)$ ä¹‹é—´æ„å»ºä»»æ„çš„è¿åŠ¨è½¨è¿¹ã€‚æœ€ç®€å•çš„é€‰æ‹©æ˜¯ç›´çº¿è½¨è¿¹ï¼š</p>
<p>\begin{equation}
\boldsymbol{x}_t = (1-t)\boldsymbol{x}_0 + t \boldsymbol{x}_1, \quad t \in [0,1] \tag{1}
\end{equation}</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼šè¿™ä¸ªçº¿æ€§æ’å€¼å…¬å¼ç¡®ä¿äº†ï¼š
- å½“ $t=0$ æ—¶ï¼Œ$\boldsymbol{x}_0$ æ˜¯çº¯å™ªå£°
- å½“ $t=1$ æ—¶ï¼Œ$\boldsymbol{x}_1$ æ˜¯çœŸå®æ ·æœ¬
- ä¸­é—´æ—¶åˆ» $t \in (0,1)$ æ˜¯ä»å™ªå£°åˆ°çœŸå®æ ·æœ¬çš„å¹³æ»‘è¿‡æ¸¡</p>
<p>å¯¹å¼ (1) å…³äºæ—¶é—´ $t$ æ±‚å¯¼ï¼Œå¾—åˆ°é€Ÿåº¦åœºï¼š</p>
<p>\begin{equation}
\frac{d\boldsymbol{x}_t}{dt} = \boldsymbol{x}_1 - \boldsymbol{x}_0 \tag{2}
\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼š
\begin{equation}
\frac{d\boldsymbol{x}_t}{dt} = \frac{d}{dt}[(1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1] = -\boldsymbol{x}_0 + \boldsymbol{x}_1 = \boldsymbol{x}_1 - \boldsymbol{x}_0 \tag{3}
\end{equation}</p>
<h4 id="12">1.2 é€Ÿåº¦åœºå­¦ä¹ é—®é¢˜</h4>
<p>å¼ (2) ä¸­çš„ODEæ˜¾å¼ä¾èµ–äºç›®æ ‡ $\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1$ï¼Œè¿™åœ¨ç”Ÿæˆé˜¶æ®µæ˜¯ä¸å¯çŸ¥çš„ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å¼•å…¥å‚æ•°åŒ–çš„é€Ÿåº¦åœº $\boldsymbol{v}</em>_0$ã€‚}}(\boldsymbol{x}_t, t)$ æ¥è¿‘ä¼¼ $\boldsymbol{x}_1 - \boldsymbol{x</p>
<p><strong>è®­ç»ƒç›®æ ‡</strong>ï¼š
\begin{equation}
\boldsymbol{\theta}^* = \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\theta}} \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0,\boldsymbol{x}_1\sim p_1, t\sim U(0,1)}\left[\Vert\boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t) - (\boldsymbol{x}_1 - \boldsymbol{x}_0)\Vert^2\right] \tag{4</p>
<p>å…¶ä¸­ $\boldsymbol{x}_t = (1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1$ã€‚</p>
<p><strong>æŸå¤±å‡½æ•°çš„æ•°å­¦æ„ä¹‰</strong>ï¼š
- è¿™æ˜¯ä¸€ä¸ªæœ€å°äºŒä¹˜é—®é¢˜ï¼Œå¯»æ‰¾æœ€ä¼˜çš„é€Ÿåº¦åœºé¢„æµ‹
- æœŸæœ›æ˜¯å¯¹ä¸‰ä¸ªéšæœºå˜é‡å–çš„ï¼šèµ·ç‚¹ $\boldsymbol{x}_0$ï¼Œç»ˆç‚¹ $\boldsymbol{x}_1$ï¼Œä»¥åŠæ—¶é—´ $t$
- $L^2$ èŒƒæ•°ä¿è¯äº†é€Ÿåº¦åœºåœ¨å„ä¸ªæ–¹å‘ä¸Šçš„å‡è¡¡æ‹Ÿåˆ</p>
<p>è®­ç»ƒå®Œæˆåï¼Œç”Ÿæˆè¿‡ç¨‹å˜ä¸ºæ±‚è§£ODEï¼š
\begin{equation}
\frac{d\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t}{dt} = \boldsymbol{v}</em>
\end{equation}}^*}(\boldsymbol{x}_t, t) \tag{5</p>
<h3 id="2">2. æ¬§æ‹‰æ–¹æ³•ä¸æ­¥é•¿é—®é¢˜</h3>
<h4 id="21">2.1 æ¬§æ‹‰ç¦»æ•£åŒ–</h4>
<p>åœ¨å®é™…è®¡ç®—ä¸­ï¼Œæˆ‘ä»¬æ— æ³•ç²¾ç¡®æ±‚è§£è¿ç»­æ—¶é—´çš„ODE (5)ï¼Œè€Œæ˜¯ä½¿ç”¨<strong>æ¬§æ‹‰æ–¹æ³•</strong>è¿›è¡Œç¦»æ•£åŒ–ï¼š</p>
<p>\begin{equation}
\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon} = \boldsymbol{x}_t + \epsilon \cdot \boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t) \tag{6</p>
<p><strong>æ¬§æ‹‰æ–¹æ³•çš„è¯¯å·®åˆ†æ</strong>ï¼š</p>
<p>è®°ç²¾ç¡®è§£ä¸º $\boldsymbol{x}^*(t)$ï¼Œæ¬§æ‹‰æ–¹æ³•çš„å±€éƒ¨æˆªæ–­è¯¯å·®ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{e}<em _boldsymbol_theta="\boldsymbol{\theta">{\text{local}} = \boldsymbol{x}^<em>(t+\epsilon) - [\boldsymbol{x}^</em>(t) + \epsilon \boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}^*(t), t)] \tag{7</p>
<p>é€šè¿‡æ³°å‹’å±•å¼€ï¼š
\begin{equation}
\boldsymbol{x}^<em>(t+\epsilon) = \boldsymbol{x}^</em>(t) + \epsilon \frac{d\boldsymbol{x}^<em>}{dt}\bigg|_t + \frac{\epsilon^2}{2}\frac{d^2\boldsymbol{x}^</em>}{dt^2}\bigg|_t + O(\epsilon^3) \tag{8}
\end{equation}</p>
<p>å› ä¸º $\frac{d\boldsymbol{x}^<em>}{dt} = \boldsymbol{v}_{\boldsymbol{\theta}}(\boldsymbol{x}^</em>, t)$ï¼Œæ‰€ä»¥ï¼š
\begin{equation}
\boldsymbol{e}_{\text{local}} = \frac{\epsilon^2}{2}\frac{d^2\boldsymbol{x}^*}{dt^2}\bigg|_t + O(\epsilon^3) = O(\epsilon^2) \tag{9}
\end{equation}</p>
<p><strong>å…¨å±€è¯¯å·®</strong>ï¼šå‡è®¾éœ€è¦ $N = 1/\epsilon$ æ­¥ä» $t=0$ åˆ° $t=1$ï¼Œå…¨å±€è¯¯å·®ä¸ºï¼š
\begin{equation}
\boldsymbol{e}_{\text{global}} = N \cdot O(\epsilon^2) = \frac{1}{\epsilon} \cdot O(\epsilon^2) = O(\epsilon) \tag{10}
\end{equation}</p>
<p><strong>ç»“è®º</strong>ï¼šæ­¥é•¿ $\epsilon$ è¶Šå°ï¼Œè¯¯å·®è¶Šå°ï¼Œä½†ç”Ÿæˆæ­¥æ•° $N = 1/\epsilon$ è¶Šå¤§ï¼Œè®¡ç®—æˆæœ¬è¶Šé«˜ã€‚</p>
<h4 id="22-">2.2 æ­¥é•¿-ç²¾åº¦æƒè¡¡</h4>
<p>ç”Ÿæˆè´¨é‡å’Œè®¡ç®—æˆæœ¬ä¹‹é—´å­˜åœ¨æ ¹æœ¬çŸ›ç›¾ï¼š</p>
<table>
<thead>
<tr>
<th>æ­¥é•¿ $\epsilon$</th>
<th>ç”Ÿæˆæ­¥æ•° $N$</th>
<th>è¯¯å·®é‡çº§</th>
<th>ç”Ÿæˆè´¨é‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\epsilon = 1$</td>
<td>$N = 1$</td>
<td>$O(1)$</td>
<td>å¾ˆå·®</td>
</tr>
<tr>
<td>$\epsilon = 0.1$</td>
<td>$N = 10$</td>
<td>$O(0.1)$</td>
<td>è¾ƒå¥½</td>
</tr>
<tr>
<td>$\epsilon = 0.01$</td>
<td>$N = 100$</td>
<td>$O(0.01)$</td>
<td>å¾ˆå¥½</td>
</tr>
<tr>
<td>$\epsilon = 0.001$</td>
<td>$N = 1000$</td>
<td>$O(0.001)$</td>
<td>æå¥½</td>
</tr>
</tbody>
</table>
<p><strong>Shortcutæ¨¡å‹çš„æ ¸å¿ƒæ€æƒ³</strong>ï¼šä¸å…¶è¢«åŠ¨æ¥å—æ¬§æ‹‰æ–¹æ³•çš„è¯¯å·®ï¼Œä¸å¦‚ä¸»åŠ¨è®©æ¨¡å‹é€‚åº”ä¸åŒçš„æ­¥é•¿ã€‚</p>
<h3 id="3-shortcut">3. Shortcutæ¨¡å‹ï¼šæ­¥é•¿æ¡ä»¶åŒ–</h3>
<h4 id="31">3.1 æ­¥é•¿æ¡ä»¶é€Ÿåº¦åœº</h4>
<p>ä¼ ç»Ÿé€Ÿåº¦åœº $\boldsymbol{v}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t)$ åªä¾èµ–äºçŠ¶æ€ $\boldsymbol{x}_t$ å’Œæ—¶é—´ $t$ã€‚Shortcutæ¨¡å‹å°†æ­¥é•¿ $\epsilon$ ä¹Ÿä½œä¸ºè¾“å…¥ï¼š</p>
<p>\begin{equation}
\boldsymbol{v}<em>{\boldsymbol{\theta}}(\boldsymbol{x}_t, t, \epsilon): \mathbb{R}^d \times [0,1] \times \mathbb{R}</em>+ \to \mathbb{R}^d \tag{11}
\end{equation}</p>
<p><strong>æ›´æ–°è§„åˆ™</strong>ï¼š
\begin{equation}
\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon} = \boldsymbol{x}_t + \epsilon \cdot \boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t, \epsilon) \tag{12</p>
<p><strong>æ•°å­¦ç›´è§‰</strong>ï¼š
- å½“ $\epsilon \to 0$ï¼Œ$\boldsymbol{v}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t, \epsilon)$ åº”è¯¥æ”¶æ•›åˆ°ç²¾ç¡®çš„ODEé€Ÿåº¦åœº
- å½“ $\epsilon$ è¾ƒå¤§æ—¶ï¼Œæ¨¡å‹å¯ä»¥"é¢„è§"æ›´è¿œçš„æœªæ¥ï¼Œè¾“å‡ºä¿®æ­£åçš„é€Ÿåº¦åœº
- è¿™ç±»ä¼¼äºé«˜é˜¶ODEæ±‚è§£å™¨ï¼Œä½†é€šè¿‡å­¦ä¹ è€Œéæ‰‹å·¥è®¾è®¡</p>
<h4 id="32-ode">3.2 ç¬¬ä¸€ä¸ªæŸå¤±å‡½æ•°ï¼šç²¾ç¡®ODEæŸå¤±</h4>
<p>ä¸ºäº†ä¿è¯ $\epsilon \to 0$ æ—¶çš„ç²¾ç¡®æ€§ï¼Œæˆ‘ä»¬éœ€è¦è®­ç»ƒç²¾ç¡®çš„ODEæ¨¡å‹ï¼š</p>
<p>\begin{equation}
\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">1(\boldsymbol{\theta}) = \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0\sim p_0,\boldsymbol{x}_1\sim p_1, t\sim U(0,1)}\left[\Vert\boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t, 0) - (\boldsymbol{x}_1 - \boldsymbol{x}_0)\Vert^2\right] \tag{13</p>
<p><strong>æ³¨æ„äº‹é¡¹</strong>ï¼š
- è¿™é‡Œæ­¥é•¿è®¾ä¸º $\epsilon = 0$ï¼Œè¡¨ç¤ºæ— é™å°æ­¥é•¿
- è¿™ç¡®ä¿äº†æ¨¡å‹åœ¨æé™æƒ…å†µä¸‹çš„æ­£ç¡®æ€§
- å•ç‹¬è¿™ä¸ªæŸå¤±è¿˜ä¸å¤Ÿï¼Œå› ä¸ºå®ƒæ²¡æœ‰å‘Šè¯‰æ¨¡å‹å¦‚ä½•å¤„ç† $\epsilon &gt; 0$ çš„æƒ…å†µ</p>
<h3 id="4">4. è‡ªæ´½æ€§çº¦æŸï¼šæ ¸å¿ƒåˆ›æ–°</h3>
<h4 id="41">4.1 è‡ªæ´½æ€§æ¡ä»¶çš„æ¨å¯¼</h4>
<p>Shortcutæ¨¡å‹çš„å…³é”®æ´å¯Ÿæ˜¯ï¼š<strong>å¤§æ­¥é•¿åº”è¯¥ç­‰äºå¤šä¸ªå°æ­¥é•¿çš„ç»„åˆ</strong>ã€‚</p>
<p>å…·ä½“åœ°ï¼Œç”¨æ­¥é•¿ $2\epsilon$ èµ°1æ­¥åº”è¯¥ç­‰äºç”¨æ­¥é•¿ $\epsilon$ èµ°2æ­¥ï¼š</p>
<p>\begin{equation}
\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t + 2\epsilon \cdot \boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t, 2\epsilon) = \text{(ç”¨æ­¥é•¿ } \epsilon \text{ èµ°2æ­¥çš„ç»“æœ)} \tag{14</p>
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼ˆä» $t$ åˆ° $t+\epsilon$ï¼‰ï¼š
\begin{equation}
\tilde{\boldsymbol{x}}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon} = \boldsymbol{x}_t + \epsilon \cdot \boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t, \epsilon) \tag{15</p>
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼ˆä» $t+\epsilon$ åˆ° $t+2\epsilon$ï¼‰ï¼š
\begin{equation}
\tilde{\boldsymbol{x}}<em t_epsilon="t+\epsilon">{t+2\epsilon} = \tilde{\boldsymbol{x}}</em>} + \epsilon \cdot \boldsymbol{v<em t_epsilon="t+\epsilon">{\boldsymbol{\theta}}(\tilde{\boldsymbol{x}}</em>
\end{equation}}, t+\epsilon, \epsilon) \tag{16</p>
<p>å°†å¼ (15) ä»£å…¥å¼ (16)ï¼š
\begin{equation}
\begin{aligned}
\tilde{\boldsymbol{x}}<em _boldsymbol_theta="\boldsymbol{\theta">{t+2\epsilon} &amp;= \boldsymbol{x}_t + \epsilon \cdot \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, \epsilon) \
&amp;\quad + \epsilon \cdot \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t + \epsilon \cdot \boldsymbol{v}</em>_t, t, \epsilon), t+\epsilon, \epsilon)
\end{aligned} \tag{17}
\end{equation}}}(\boldsymbol{x</p>
<p><strong>è‡ªæ´½æ€§æ¡ä»¶</strong>ï¼šè¦æ±‚
\begin{equation}
\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t + 2\epsilon \cdot \boldsymbol{v}</em>}}(\boldsymbol{x<em t_2_epsilon="t+2\epsilon">t, t, 2\epsilon) = \tilde{\boldsymbol{x}}</em>
\end{equation}} \tag{18</p>
<p>ä¸¤è¾¹å‡å» $\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t$ å¹¶é™¤ä»¥ $2\epsilon$ï¼š
\begin{equation}
\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, 2\epsilon) = \frac{1}{2}\left[\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, \epsilon) + \boldsymbol{v}</em>
\end{equation}}}(\tilde{\boldsymbol{x}}_{t+\epsilon}, t+\epsilon, \epsilon)\right] \tag{19</p>
<p><strong>æ•°å­¦æ„ä¹‰</strong>ï¼šå¤§æ­¥é•¿çš„é€Ÿåº¦åœºåº”è¯¥æ˜¯ä¸¤ä¸ªå°æ­¥é•¿é€Ÿåº¦åœºçš„å¹³å‡ã€‚è¿™æ˜¯ä¸€ç§<strong>æ—¶é—´ä¸€è‡´æ€§çº¦æŸ</strong>ã€‚</p>
<h4 id="42">4.2 ç¬¬äºŒä¸ªæŸå¤±å‡½æ•°ï¼šè‡ªæ´½æ€§æŸå¤±</h4>
<p>åŸºäºå¼ (19)ï¼Œæˆ‘ä»¬æ„é€ è‡ªæ´½æ€§æŸå¤±ï¼š</p>
<p>\begin{equation}
\mathcal{L}<em _boldsymbol_x="\boldsymbol{x">2(\boldsymbol{\theta}) = \mathbb{E}</em><em _boldsymbol_theta="\boldsymbol{\theta">0,\boldsymbol{x}_1,t,\epsilon}\left[\left\Vert\boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t, 2\epsilon) - \frac{1}{2}\left[\boldsymbol{v}_1 + \boldsymbol{v}_2\right]\right\Vert^2\right] \tag{20</p>
<p>å…¶ä¸­ï¼š
\begin{equation}
\begin{aligned}
\boldsymbol{v}<em _boldsymbol_theta="\boldsymbol{\theta">1 &amp;= \boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, \epsilon) \
\boldsymbol{v}_2 &amp;= \boldsymbol{v}</em>}}(\boldsymbol{x<em t_epsilon="t+\epsilon">t + \epsilon \boldsymbol{v}_1, t+\epsilon, \epsilon) \
\tilde{\boldsymbol{x}}</em>_1
\end{aligned} \tag{21}
\end{equation}} &amp;= \boldsymbol{x}_t + \epsilon \boldsymbol{v</p>
<p><strong>å±•å¼€æŸå¤±å‡½æ•°</strong>ï¼š
\begin{equation}
\begin{aligned}
\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">2 = \mathbb{E}\bigg[&amp;\Vert\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, 2\epsilon)\Vert^2 \
&amp;- \boldsymbol{v}</em>_2] \
&amp;+ \frac{1}{4}\Vert\boldsymbol{v}_1 + \boldsymbol{v}_2\Vert^2\bigg]
\end{aligned} \tag{22}
\end{equation}}}(\boldsymbol{x}_t, t, 2\epsilon) \cdot [\boldsymbol{v}_1 + \boldsymbol{v</p>
<h3 id="5">5. å¤šå°ºåº¦è‡ªæ´½æ€§</h3>
<h4 id="51">5.1 ç¦»æ•£æ­¥é•¿é›†åˆ</h4>
<p>Shortcutæ¨¡å‹ä¸å¯¹æ‰€æœ‰ $\epsilon \in (0,1]$ è¿›è¡Œè®­ç»ƒï¼Œè€Œæ˜¯é€‰æ‹©ç¦»æ•£çš„æ­¥é•¿é›†åˆï¼š</p>
<p>\begin{equation}
\mathcal{E} = {2^{-7}, 2^{-6}, 2^{-5}, 2^{-4}, 2^{-3}, 2^{-2}, 2^{-1}, 2^0} \tag{23}
\end{equation}</p>
<p><strong>é€‰æ‹©ç†ç”±</strong>ï¼š
1. <strong>æŒ‡æ•°é—´éš”</strong>ï¼š$\epsilon_k = 2^{-k}$ è¦†ç›–äº†ä»å°æ­¥é•¿åˆ°å¤§æ­¥é•¿çš„å¹¿æ³›èŒƒå›´
2. <strong>äºŒè¿›åˆ¶å…³ç³»</strong>ï¼š$2\epsilon_k = \epsilon_{k-1}$ï¼Œè‡ªæ´½æ€§æ¡ä»¶è‡ªç„¶æˆç«‹
3. <strong>è®¡ç®—æ•ˆç‡</strong>ï¼šæœ‰é™çš„æ­¥é•¿é›†åˆå¯ä»¥ç”¨Embeddingè¡¨ç¤º</p>
<h4 id="52">5.2 é€’å½’è‡ªæ´½æ€§</h4>
<p>å¯¹äºä»»æ„çš„ $k$ï¼Œæˆ‘ä»¬æœ‰ï¼š
\begin{equation}
\epsilon_{k-1} = 2\epsilon_k \tag{24}
\end{equation}</p>
<p>å› æ­¤è‡ªæ´½æ€§æ¡ä»¶å¯ä»¥é€’å½’åº”ç”¨ï¼š
\begin{equation}
\boldsymbol{v}<em k-1="k-1">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t, \epsilon</em>}) = \frac{1}{2}\left[\boldsymbol{v<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t, \epsilon_k) + \boldsymbol{v}</em>
\end{equation}}}(\tilde{\boldsymbol{x}}_{t+\epsilon_k}, t+\epsilon_k, \epsilon_k)\right] \tag{25</p>
<p><strong>è®­ç»ƒç­–ç•¥</strong>ï¼š
- å¯¹æ¯ä¸ª $\epsilon_k \in {2^{-7}, ..., 2^{-1}}$ï¼Œéšæœºé€‰æ‹©æ—¶é—´ $t \sim U(0, 1-\epsilon_k)$
- è®¡ç®—è‡ªæ´½æ€§æŸå¤± $\mathcal{L}_2$ for æ­¥é•¿å¯¹ $(\epsilon_k, 2\epsilon_k)$
- è¿™ç¡®ä¿äº†æ‰€æœ‰å°ºåº¦ä¸Šçš„ä¸€è‡´æ€§</p>
<h3 id="6">6. æ€»æŸå¤±å‡½æ•°ä¸è®­ç»ƒç®—æ³•</h3>
<h4 id="61">6.1 ç»„åˆæŸå¤±</h4>
<p>æœ€ç»ˆçš„è®­ç»ƒç›®æ ‡æ˜¯ï¼š
\begin{equation}
\mathcal{L}(\boldsymbol{\theta}) = \lambda_1 \mathcal{L}_1(\boldsymbol{\theta}) + \lambda_2 \mathcal{L}_2(\boldsymbol{\theta}) \tag{26}
\end{equation}</p>
<p><strong>æƒé‡é€‰æ‹©</strong>ï¼š
- ç†è®ºä¸Š $\lambda_1 = \lambda_2 = 1$ å³å¯
- ä½†å®é™…ä¸­ $\mathcal{L}_2$ æ¶‰åŠä¸¤æ¬¡å‰å‘ä¼ æ’­ï¼Œè®¡ç®—é‡æ˜¯ $\mathcal{L}_1$ çš„ä¸¤å€
- è®ºæ–‡é‡‡ç”¨ç­–ç•¥ï¼š75% æ ·æœ¬ç”¨äº $\mathcal{L}_1$ï¼Œ25% æ ·æœ¬ç”¨äº $\mathcal{L}_2$
- è¿™ç›¸å½“äºéšå¼åœ°è®¾ç½® $\lambda_1 : \lambda_2 = 3:1$</p>
<h4 id="62-stop-gradient">6.2 Stop GradientæŠ€å·§</h4>
<p>å®é™…å®ç°ä¸­ï¼Œ$\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">2$ è¢«ä¿®æ”¹ä¸ºï¼š
\begin{equation}
\mathcal{L}_2 = \mathbb{E}\left[\left\Vert\boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t, 2\epsilon) - \text{sg}\left[\frac{\boldsymbol{v}_1 + \boldsymbol{v}_2}{2}\right]\right\Vert^2\right] \tag{27</p>
<p>å…¶ä¸­ $\text{sg}[\cdot]$ æ˜¯stop gradientç®—å­ã€‚</p>
<p><strong>åŸå› åˆ†æ</strong>ï¼š
1. <strong>ç›®æ ‡è§†è§’</strong>ï¼šå°† $\frac{\boldsymbol{v}_1 + \boldsymbol{v}_2}{2}$ è§†ä¸ºå›ºå®šçš„"ç›®æ ‡"
2. <strong>è®¡ç®—æ•ˆç‡</strong>ï¼šé¿å…å¯¹ $\boldsymbol{v}_2$ çš„äºŒæ¬¡åå‘ä¼ æ’­ï¼ŒèŠ‚çœå†…å­˜å’Œæ—¶é—´
3. <strong>è®­ç»ƒç¨³å®šæ€§</strong>ï¼šç±»ä¼¼BYOLç­‰è‡ªç›‘ç£å­¦ä¹ æ–¹æ³•ï¼Œé˜²æ­¢æ¢¯åº¦çˆ†ç‚¸</p>
<p><strong>æ¢¯åº¦æµåˆ†æ</strong>ï¼š</p>
<p>ä¸ä½¿ç”¨stop gradientæ—¶ï¼š
\begin{equation}
\frac{\partial \mathcal{L}_2}{\partial \boldsymbol{\theta}} = \frac{\partial}{\partial \boldsymbol{\theta}}\left[\text{æ¨¡å‹é¢„æµ‹}\right] - \frac{\partial}{\partial \boldsymbol{\theta}}\left[\frac{\boldsymbol{v}_1 + \boldsymbol{v}_2}{2}\right] \tag{28}
\end{equation}</p>
<p>ä½¿ç”¨stop gradientåï¼š
\begin{equation}
\frac{\partial \mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">2}{\partial \boldsymbol{\theta}} = \frac{\partial}{\partial \boldsymbol{\theta}}\left[\boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t, 2\epsilon)\right] \tag{29</p>
<h3 id="7-embedding">7. æ­¥é•¿Embeddingçš„å®ç°</h3>
<h4 id="71-embedding">7.1 ç¦»æ•£Embeddingæ–¹æ¡ˆ</h4>
<p>ç”±äºæ­¥é•¿é›†åˆ $\mathcal{E}$ æ˜¯æœ‰é™çš„ï¼ˆ9ä¸ªå€¼ï¼ŒåŒ…æ‹¬0ï¼‰ï¼Œå¯ä»¥ç”¨Embeddingè¡¨ç¤ºï¼š</p>
<p>\begin{equation}
\epsilon \to \mathbf{e}<em _text_emb="\text{emb">{\epsilon} \in \mathbb{R}^{d</em>
\end{equation}}}} \tag{30</p>
<p><strong>å®ç°ç»†èŠ‚</strong>ï¼š
1. å»ºç«‹æ˜ å°„ ${0, 2^{-7}, ..., 2^0} \to {0, 1, ..., 8}$
2. ä½¿ç”¨Embeddingå±‚ï¼š$\mathbf{E} \in \mathbb{R}^{9 \times d_{\text{emb}}}$
3. ç»„åˆæ—¶é—´å’Œæ­¥é•¿çš„Embeddingï¼š
   \begin{equation}
   \mathbf{c}<em _epsilon="\epsilon">{t,\epsilon} = \mathbf{e}_t + \mathbf{e}</em>
   \end{equation}
4. å°† $\mathbf{c}_{t,\epsilon}$ æ³¨å…¥U-Netçš„æ¯ä¸€å±‚} \tag{31</p>
<h4 id="72-embedding">7.2 ä¸æ—¶é—´Embeddingçš„èåˆ</h4>
<p><strong>æ ‡å‡†æ—¶é—´Embedding</strong>ï¼ˆSinusoidalä½ç½®ç¼–ç ï¼‰ï¼š
\begin{equation}
\begin{aligned}
[\mathbf{e}<em 2i="2i">t]</em>\right) \
[\mathbf{e}} &amp;= \sin\left(\frac{t}{10000^{2i/d}<em 2i_1="2i+1">t]</em>\right)
\end{aligned} \tag{32}
\end{equation}} &amp;= \cos\left(\frac{t}{10000^{2i/d}</p>
<p><strong>ç»„åˆæ–¹æ¡ˆ</strong>ï¼š
\begin{equation}
\mathbf{h} = \text{MLP}(\mathbf{e}<em _epsilon="\epsilon">t + \mathbf{e}</em>
\end{equation}}) \tag{33</p>
<h3 id="8">8. æ¨ç†è¿‡ç¨‹åˆ†æ</h3>
<h4 id="81">8.1 å•æ­¥ç”Ÿæˆ</h4>
<p>è®¾æ­¥é•¿ $\epsilon = 1$ï¼Œä»çº¯å™ªå£° $\boldsymbol{x}_0 \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ å‡ºå‘ï¼š</p>
<p>\begin{equation}
\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">1 = \boldsymbol{x}_0 + 1 \cdot \boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_0, 0, 1) \tag{34</p>
<p><strong>ä¸ºä»€ä¹ˆå¯è¡Œ</strong>ï¼š
- è®­ç»ƒæ—¶çš„è‡ªæ´½æ€§çº¦æŸç¡®ä¿äº† $\boldsymbol{v}_{\boldsymbol{\theta}}(\cdot, \cdot, 1)$ èƒ½å¤Ÿ"é¢„è§"æ•´ä¸ªè½¨è¿¹
- å®ƒéšå¼åœ°æ•´åˆäº†å¤šä¸ªå°æ­¥é•¿çš„ä¿¡æ¯</p>
<h4 id="82">8.2 å¤šæ­¥ç”Ÿæˆ</h4>
<p>ä¹Ÿå¯ä»¥ä½¿ç”¨æ›´å°çš„æ­¥é•¿ $\epsilon &lt; 1$ è¿›è¡Œå¤šæ­¥ç”Ÿæˆï¼š</p>
<p>\begin{equation}
\boldsymbol{x}<em k_1="k+1">{t</em>}} = \boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">{t_k} + \epsilon \cdot \boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_{t_k}, t_k, \epsilon), \quad t_k = k\epsilon \tag{35</p>
<p><strong>è´¨é‡-é€Ÿåº¦æƒè¡¡</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>ç”Ÿæˆæ­¥æ•°</th>
<th>æ­¥é•¿ $\epsilon$</th>
<th>FID</th>
<th>NFE</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1</td>
<td>~10</td>
<td>1</td>
</tr>
<tr>
<td>2</td>
<td>0.5</td>
<td>~8</td>
<td>2</td>
</tr>
<tr>
<td>4</td>
<td>0.25</td>
<td>~6</td>
<td>4</td>
</tr>
<tr>
<td>8</td>
<td>0.125</td>
<td>~5</td>
<td>8</td>
</tr>
</tbody>
</table>
<h3 id="9-ode">9. ä¸ä¼ ç»ŸODEæ±‚è§£å™¨çš„å¯¹æ¯”</h3>
<h4 id="91">9.1 æ¬§æ‹‰æ–¹æ³•ï¼ˆä¸€é˜¶ï¼‰</h4>
<p><strong>ä¼ ç»Ÿæ¬§æ‹‰</strong>ï¼š
\begin{equation}
\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon} = \boldsymbol{x}_t + \epsilon \cdot \boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t) \tag{36</p>
<p>å±€éƒ¨è¯¯å·®ï¼š$O(\epsilon^2)$ï¼Œå…¨å±€è¯¯å·®ï¼š$O(\epsilon)$</p>
<p><strong>Shortcut</strong>ï¼š
\begin{equation}
\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon} = \boldsymbol{x}_t + \epsilon \cdot \boldsymbol{v}</em>
\end{equation}}}(\boldsymbol{x}_t, t, \epsilon) \tag{37</p>
<p>é€šè¿‡å­¦ä¹ é€‚åº”æ­¥é•¿ï¼Œå‡å°äº†å›ºå®šæ­¥é•¿å¸¦æ¥çš„ç³»ç»Ÿè¯¯å·®ã€‚</p>
<h4 id="92-heun">9.2 Heunæ–¹æ³•ï¼ˆäºŒé˜¶ï¼‰</h4>
<p><strong>Heunæ–¹æ³•</strong>ï¼ˆé¢„æµ‹-æ ¡æ­£ï¼‰ï¼š
\begin{equation}
\begin{aligned}
\tilde{\boldsymbol{x}}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon} &amp;= \boldsymbol{x}_t + \epsilon \cdot \boldsymbol{v}</em>}}(\boldsymbol{x<em t_epsilon="t+\epsilon">t, t) \
\boldsymbol{x}</em>} &amp;= \boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t + \frac{\epsilon}{2}[\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t) + \boldsymbol{v}</em>, t+\epsilon)]
\end{aligned} \tag{38}
\end{equation}}}(\tilde{\boldsymbol{x}}_{t+\epsilon</p>
<p>å±€éƒ¨è¯¯å·®ï¼š$O(\epsilon^3)$ï¼Œå…¨å±€è¯¯å·®ï¼š$O(\epsilon^2)$</p>
<p><strong>Shortcutçš„éšå¼Heun</strong>ï¼š
\begin{equation}
\boldsymbol{v}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t, 2\epsilon) \approx \frac{1}{2}[\boldsymbol{v}</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t, t, \epsilon) + \boldsymbol{v}</em>
\end{equation}}}(\tilde{\boldsymbol{x}}_{t+\epsilon}, t+\epsilon, \epsilon)] \tag{39</p>
<p>è¿™ä¸Heunæ–¹æ³•çš„æ€æƒ³ç±»ä¼¼ï¼Œä½†æ˜¯é€šè¿‡å­¦ä¹ è€Œéæ‰‹å·¥è®¾è®¡ã€‚</p>
<h3 id="10">10. ç†è®ºä¿è¯ä¸æ”¶æ•›æ€§</h3>
<h4 id="101">10.1 æé™æƒ…å†µ</h4>
<p><strong>å®šç†1</strong>ï¼šå½“ $\epsilon \to 0$ æ—¶ï¼ŒShortcutæ¨¡å‹æ”¶æ•›åˆ°ç²¾ç¡®ODEã€‚</p>
<p><strong>è¯æ˜è‰å›¾</strong>ï¼š
- æŸå¤± $\mathcal{L}<em 0="0" _epsilon="\epsilon" _to="\to">1$ ç¡®ä¿äº† $\lim</em>_0$
- è¿™æ˜¯ç²¾ç¡®ODEçš„é€Ÿåº¦åœº
- å› æ­¤åœ¨æé™ä¸‹ï¼Œæ¨¡å‹æ˜¯æ­£ç¡®çš„}\boldsymbol{v}_{\boldsymbol{\theta}}(\boldsymbol{x}_t, t, \epsilon) = \boldsymbol{x}_1 - \boldsymbol{x</p>
<h4 id="102">10.2 æœ‰é™æ­¥é•¿çš„é€¼è¿‘è´¨é‡</h4>
<p>è®° $\boldsymbol{x}_1^*$ ä¸ºç²¾ç¡®è§£ï¼Œ$\boldsymbol{x}_1^{(\epsilon)}$ ä¸ºæ­¥é•¿ $\epsilon$ çš„è¿‘ä¼¼è§£ã€‚</p>
<p><strong>å®šç†2</strong>ï¼ˆéæ­£å¼ï¼‰ï¼šåœ¨é€‚å½“çš„æ­£åˆ™æ€§æ¡ä»¶ä¸‹ï¼Œ
\begin{equation}
\Vert\boldsymbol{x}_1^{(\epsilon)} - \boldsymbol{x}_1^*\Vert = O(\epsilon^p) \tag{40}
\end{equation}
å…¶ä¸­ $p \geq 1$ï¼Œä¸”å¯èƒ½ $p &gt; 1$ï¼ˆé€šè¿‡è‡ªæ´½æ€§çº¦æŸæå‡é˜¶æ•°ï¼‰ã€‚</p>
<p><strong>ç›´è§‰</strong>ï¼šè‡ªæ´½æ€§çº¦æŸ $\mathcal{L}_2$ å¼ºåˆ¶æ¨¡å‹åœ¨ä¸åŒå°ºåº¦ä¸Šä¿æŒä¸€è‡´ï¼Œè¿™é™ä½äº†ç¦»æ•£åŒ–è¯¯å·®ã€‚</p>
<h3 id="11">11. å®è·µå»ºè®®ä¸è¶…å‚æ•°</h3>
<h4 id="111">11.1 è®­ç»ƒè¶…å‚æ•°</h4>
<ul>
<li><strong>æ‰¹é‡å¤§å°</strong>ï¼š512ï¼ˆå…¶ä¸­75%ç”¨äº $\mathcal{L}_1$ï¼Œ25%ç”¨äº $\mathcal{L}_2$ï¼‰</li>
<li><strong>å­¦ä¹ ç‡</strong>ï¼š$2 \times 10^{-4}$ï¼Œä½¿ç”¨cosineè¡°å‡</li>
<li><strong>è®­ç»ƒæ­¥æ•°</strong>ï¼š300K-500K</li>
<li><strong>æ—¶é—´é‡‡æ ·</strong>ï¼š$t \sim U(0, 1)$ for $\mathcal{L}_1$ï¼›$t \sim U(0, 1-\epsilon)$ for $\mathcal{L}_2$</li>
<li><strong>æ­¥é•¿é‡‡æ ·</strong>ï¼š$\epsilon \sim \text{Uniform}(\mathcal{E} \setminus {0, 1})$ for $\mathcal{L}_2$</li>
</ul>
<h4 id="112">11.2 æ¨ç†è¶…å‚æ•°</h4>
<ul>
<li><strong>å•æ­¥ç”Ÿæˆ</strong>ï¼š$\epsilon = 1$ï¼ŒNFE=1</li>
<li><strong>é«˜è´¨é‡ç”Ÿæˆ</strong>ï¼š$\epsilon = 2^{-3}$ æˆ– $2^{-4}$ï¼ŒNFE=8æˆ–16</li>
<li><strong>å¯ä»¥åŠ¨æ€è°ƒæ•´</strong>ï¼šå‰æœŸç”¨å¤§æ­¥é•¿ï¼ŒåæœŸç”¨å°æ­¥é•¿</li>
</ul>
<h3 id="12_1">12. ä¸ç›¸å…³å·¥ä½œçš„è”ç³»</h3>
<h4 id="121-amed">12.1 AMEDï¼ˆä¸­å€¼å®šç†æ–¹æ³•ï¼‰</h4>
<p>AMEDåŸºäºç§¯åˆ†ä¸­å€¼å®šç†ï¼š
\begin{equation}
\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon} - \boldsymbol{x}_t = \epsilon \cdot \boldsymbol{v}</em>
\end{equation}
å…¶ä¸­ $s \in [t, t+\epsilon]$ éœ€è¦é¢„æµ‹ã€‚}}(\boldsymbol{x}_s, s) \tag{41</p>
<p><strong>å¯¹æ¯”</strong>ï¼š
- AMEDï¼šäº‹åä¿®æ­£ï¼Œéœ€è¦é¢å¤–å°æ¨¡å‹é¢„æµ‹ $s$
- Shortcutï¼šäº‹å…ˆå­¦ä¹ ï¼Œå°† $\epsilon$ ç›´æ¥ä½œä¸ºè¾“å…¥</p>
<h4 id="122-consistency-models">12.2 Consistency Models</h4>
<p>Consistency Modelsç›´æ¥å­¦ä¹ æ˜ å°„ $f: (\boldsymbol{x}_t, t) \to \boldsymbol{x}_0$ã€‚</p>
<p><strong>å¯¹æ¯”</strong>ï¼š
- Consistencyï¼šç›´æ¥é¢„æµ‹ç»ˆç‚¹
- Shortcutï¼šé¢„æµ‹é€Ÿåº¦åœºï¼Œæ›´çµæ´»ï¼ˆå¯å¤šæ­¥å¯å•æ­¥ï¼‰</p>
<h3 id="13">13. å±€é™æ€§ä¸æœªæ¥æ–¹å‘</h3>
<h4 id="131">13.1 å½“å‰å±€é™</h4>
<ol>
<li><strong>ç¦»æ•£æ­¥é•¿é›†åˆ</strong>ï¼šåªè®­ç»ƒäº†æœ‰é™çš„æ­¥é•¿ï¼Œä¸­é—´å€¼éœ€è¦æ’å€¼</li>
<li><strong>æ­¥é•¿èŒƒå›´</strong>ï¼š$[2^{-7}, 1]$ å¯èƒ½ä¸å¤Ÿè¦†ç›–æ‰€æœ‰éœ€æ±‚</li>
<li><strong>è®­ç»ƒæˆæœ¬</strong>ï¼š$\mathcal{L}_2$ éœ€è¦ä¸¤æ¬¡å‰å‘ä¼ æ’­ï¼Œå¢åŠ äº†è®­ç»ƒæ—¶é—´</li>
</ol>
<h4 id="132">13.2 å¯èƒ½çš„æ”¹è¿›</h4>
<p><strong>è¿ç»­æ­¥é•¿Embedding</strong>ï¼š
\begin{equation}
\mathbf{e}_{\epsilon} = \text{MLP}(\log \epsilon) \tag{42}
\end{equation}
å…è®¸ä»»æ„è¿ç»­çš„ $\epsilon \in (0, 1]$ã€‚</p>
<p><strong>è‡ªé€‚åº”æ­¥é•¿</strong>ï¼š
\begin{equation}
\epsilon_{k+1} = f_{\boldsymbol{\phi}}(\boldsymbol{x}_{t_k}, t_k) \tag{43}
\end{equation}
æ ¹æ®å½“å‰çŠ¶æ€åŠ¨æ€é€‰æ‹©æ­¥é•¿ã€‚</p>
<p><strong>é«˜é˜¶è‡ªæ´½æ€§</strong>ï¼š
\begin{equation}
\boldsymbol{v}<em _epsilon="\epsilon">{\boldsymbol{\theta}}(\boldsymbol{x}_t, t, 4\epsilon) = g(\boldsymbol{v}</em>
\end{equation}
å»ºç«‹æ›´å¤æ‚çš„å¤šå°ºåº¦å…³ç³»ã€‚}, \boldsymbol{v}_{2\epsilon}) \tag{44</p>
<h3 id="14">14. æ•°å­¦æ€»ç»“</h3>
<h4 id="141">14.1 æ ¸å¿ƒå…¬å¼å›é¡¾</h4>
<ol>
<li><strong>ç›´çº¿è½¨è¿¹</strong>ï¼š$\boldsymbol{x}_t = (1-t)\boldsymbol{x}_0 + t\boldsymbol{x}_1$</li>
<li><strong>ODEé€Ÿåº¦åœº</strong>ï¼š$\frac{d\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t}{dt} = \boldsymbol{v}</em>_t, t, \epsilon)$}}(\boldsymbol{x</li>
<li><strong>ç²¾ç¡®ODEæŸå¤±</strong>ï¼š$\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">1 = \mathbb{E}[\Vert\boldsymbol{v}</em>_0)\Vert^2]$}}(\boldsymbol{x}_t, t, 0) - (\boldsymbol{x}_1 - \boldsymbol{x</li>
<li><strong>è‡ªæ´½æ€§æŸå¤±</strong>ï¼š$\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">2 = \mathbb{E}[\Vert\boldsymbol{v}</em>\Vert^2]$}}(\boldsymbol{x}_t, t, 2\epsilon) - \frac{\boldsymbol{v}_1 + \boldsymbol{v}_2}{2</li>
<li><strong>æ›´æ–°è§„åˆ™</strong>ï¼š$\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">{t+\epsilon} = \boldsymbol{x}_t + \epsilon \cdot \boldsymbol{v}</em>_t, t, \epsilon)$}}(\boldsymbol{x</li>
</ol>
<h4 id="142">14.2 ç†è®ºæ„ä¹‰</h4>
<p>Shortcutæ¨¡å‹å±•ç¤ºäº†ï¼š
1. <strong>å­¦ä¹ vsè®¾è®¡</strong>ï¼šä¸å…¶è®¾è®¡å¤æ‚çš„ODEæ±‚è§£å™¨ï¼Œä¸å¦‚è®©æ¨¡å‹å­¦ä¹ é€‚åº”ä¸åŒæ­¥é•¿
2. <strong>å¤šå°ºåº¦ä¸€è‡´æ€§</strong>ï¼šè‡ªæ´½æ€§çº¦æŸæ˜¯ä¸€ç§å¼ºå¤§çš„å½’çº³åç½®
3. <strong>å•é˜¶æ®µè®­ç»ƒ</strong>ï¼šæ— éœ€è’¸é¦å³å¯å®ç°å•æ­¥ç”Ÿæˆ</p>
<p>è¿™ä¸ºæ‰©æ•£æ¨¡å‹åŠ é€Ÿå¼€è¾Ÿäº†æ–°çš„èŒƒå¼ã€‚</p>
        </div>
    </div>
</body>
</html>