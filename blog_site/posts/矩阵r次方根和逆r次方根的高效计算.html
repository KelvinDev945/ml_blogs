<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŸ©é˜µræ¬¡æ–¹æ ¹å’Œé€†ræ¬¡æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>çŸ©é˜µræ¬¡æ–¹æ ¹å’Œé€†ræ¬¡æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 45.6 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11175">https://spaces.ac.cn/archives/11175</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ä¸Šä¸€ç¯‡æ–‡ç« <a href="/archives/11158">ã€ŠçŸ©é˜µå¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—ã€‹</a>ä¸­ï¼Œç¬”è€…ä»$\newcommand{mcsgn}{\mathop{\text{mcsgn}}}\mcsgn$ç®—å­å‡ºå‘ï¼Œæå‡ºäº†ä¸€ç§å¾ˆæ¼‚äº®çš„çŸ©é˜µå¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹çš„è®¡ç®—æ–¹æ³•ã€‚æ¯”è¾ƒç¥å¥‡çš„æ˜¯ï¼Œè¯¥æ–¹æ¡ˆç»è¿‡åŒ–ç®€ä¹‹åï¼Œæœ€ç»ˆå…¬å¼å·²ç»çœ‹ä¸åˆ°æœ€åˆ$\mcsgn$å½¢å¼çš„æ ·å­ã€‚è¿™ä¸ç¦å¼•å‘äº†æ›´æ·±å±‚çš„æ€è€ƒï¼šè¯¥æ–¹æ¡ˆæ›´æœ¬è´¨çš„å·¥ä½œåŸç†æ˜¯ä»€ä¹ˆï¼Ÿæ˜¯å¦æœ‰æ¨å¹¿åˆ°ä»»æ„$r$æ¬¡æ–¹æ ¹çš„å¯èƒ½æ€§ï¼Ÿ</p>
<p>æ²¿ç€è¿™ä¸ªè§’åº¦è¿›è¡Œåˆ†æåï¼Œç¬”è€…æƒŠå–œåœ°å‘ç°ï¼Œæˆ‘ä»¬å¯ä»¥ä»ä¸€ä¸ªæ›´ç®€å•çš„è§’åº¦å»ç†è§£ä¹‹å‰çš„è¿­ä»£ç®—æ³•ï¼Œå¹¶ä¸”åœ¨æ–°è§’åº¦ä¸‹å¯ä»¥å¾ˆè½»æ¾æ¨å¹¿åˆ°ä»»æ„$r$æ¬¡æ–¹æ ¹å’Œé€†$r$æ¬¡æ–¹æ ¹çš„è®¡ç®—ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬å°†åˆ†äº«è¿™ä¸€è¿‡ç¨‹ã€‚</p>
<h2 id="_1">å‰æƒ…å›é¡¾</h2>
<p>è®¾$\boldsymbol{G}\in\mathbb{R}^{m\times n}$æ˜¯ä»»æ„çŸ©é˜µï¼Œ$\boldsymbol{P}\in\mathbb{R}^{n\times n}$æ˜¯ä»»æ„ç‰¹å¾å€¼éƒ½åœ¨$[0,1]$å†…çš„çŸ©é˜µï¼Œä¸Šä¸€ç¯‡æ–‡ç« ç»™å‡ºï¼š<br />
\begin{gather}<br />
\boldsymbol{G}<em t_1="t+1">0 = \boldsymbol{G}, \quad \boldsymbol{P}_0 = \boldsymbol{P} \notag\\\[6pt]<br />
\boldsymbol{G}</em>} = \boldsymbol{G<em t_1="t+1">t(a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{P<em t_1="t+1">t + c</em>}\boldsymbol{P<em t_1="t+1">t^2) \label{eq:r2-rsqrt}\\\[6pt]<br />
\boldsymbol{P}</em>} = (a_{t+1}\boldsymbol{I} + b_{t+1}\boldsymbol{P<em t_1="t+1">t + c</em>}\boldsymbol{P<em t_to_infty="t\to\infty">t^2)^2\boldsymbol{P}_t \label{eq:r3-rsqrt}\\\[6pt]<br />
\lim</em>} \boldsymbol{G<em t="0">t = \boldsymbol{G}\boldsymbol{P}^{-1/2}\notag<br />
\end{gather}<br />
ä»£å…¥$\boldsymbol{G}=\boldsymbol{P}$å°±å¯ä»¥æ±‚å¾—$\boldsymbol{P}^{1/2}$ï¼Œä»£å…¥$\boldsymbol{G}=\boldsymbol{I}$å°±å¯ä»¥æ±‚å¾—$\boldsymbol{P}^{-1/2}$ã€‚ä»”ç»†è§‚å¯Ÿæˆ‘ä»¬å°±ä¼šå‘ç°ï¼Œä¸Šè¿°è¿­ä»£å®é™…ä¸Šæ˜¯å¦‚ä¸‹æé™çš„ä½“ç°ï¼š<br />
\begin{equation} \prod</em>}^{\infty}(a_{t+1}\boldsymbol{I} + b_{t+1}\boldsymbol{P<em t_1="t+1">t + c</em>}\boldsymbol{P<em t="0">t^2) = \boldsymbol{P}^{-1/2}\label{eq:prod-rsqrt}\end{equation}<br />
æœ‰è¶£çš„æ˜¯ï¼Œç›´æ¥è¯æ˜è¿™ä¸ªæé™å¹¶ä¸å¤æ‚ï¼Œç›´æ¥å¯¹å¼$\eqref{eq:r3-rsqrt}$ä¸¤è¾¹å¼€æ–¹ï¼Œç„¶åä»£å…¥ä¸Šå¼å¯å¾—<br />
\begin{equation} \prod</em>}^{\infty}(a_{t+1}\boldsymbol{I} + b_{t+1}\boldsymbol{P<em t_1="t+1">t + c</em>}\boldsymbol{P<em t="0">t^2) = \prod</em>}^{\infty} \boldsymbol{P<em t_to_infty="t\to\infty">{t+1}^{1/2}\boldsymbol{P}_t^{-1/2} = \lim</em>} \boldsymbol{P<em t_to_infty="t\to\infty">t^{1/2}\boldsymbol{P}_0^{-1/2} = \lim</em>} \boldsymbol{P}_t^{1/2}\boldsymbol{P}^{-1/2}\end{equation<br />
ç”±æ­¤å¯è§ï¼Œåªè¦åºåˆ—$\{\boldsymbol{P}_t\}$å§‹ç»ˆä¿æŒå¯é€†ï¼Œå¹¶ä¸”æœ€ç»ˆæé™ä¸º$\boldsymbol{I}$ï¼Œé‚£ä¹ˆæé™$\eqref{eq:prod-rsqrt}$è‡ªåŠ¨æˆç«‹ã€‚è‡³äºè¿­ä»£$\eqref{eq:r3-rsqrt}$å¦‚ä½•è®©$\{\boldsymbol{P}_t\}$ä¿æŒè¿™ä¸¤ä¸ªæ¡ä»¶ï¼Œæˆ‘ä»¬ç­‰ä¼šå†ä¸€èµ·è®¨è®ºã€‚</p>
<h2 id="_2">ä¸€èˆ¬å½¢å¼</h2>
<p>æˆ‘ä»¬ä¸å¦¨ä¸€èˆ¬åœ°è€ƒè™‘è¿­ä»£<br />
\begin{gather}<br />
\boldsymbol{G}<em t_1="t+1">0 = \boldsymbol{G}, \quad \boldsymbol{P}_0 = \boldsymbol{P} \notag\\\[6pt]<br />
\boldsymbol{G}</em>} = \boldsymbol{G<em t_1="t+1">t(a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{P<em t_1="t+1">t + c</em>}\boldsymbol{P<em t_1="t+1">t^2)^s\\\[6pt]<br />
\boldsymbol{P}</em>} = (a_{t+1}\boldsymbol{I} + b_{t+1}\boldsymbol{P<em t_1="t+1">t + c</em>}\boldsymbol{P<em t_to_infty="t\to\infty">t^2)^r\boldsymbol{P}_t<br />
\end{gather}<br />
ç±»ä¼¼åœ°ï¼Œå¦‚æœåºåˆ—$\{\boldsymbol{P}_t\}$å§‹ç»ˆä¿æŒå¯é€†ï¼Œå¹¶ä¸”æœ€ç»ˆæé™ä¸º$\boldsymbol{I}$ï¼Œé‚£ä¹ˆå¯ä»¥è¯æ˜æˆç«‹<br />
\begin{equation}\lim</em>} \boldsymbol{G}_t = \boldsymbol{G}\boldsymbol{P}^{-s/r}\end{equation<br />
äºæ˜¯æˆ‘ä»¬å°±å¾—åˆ°äº†ä¸€ç§æ±‚çŸ©é˜µçš„ä»»æ„$-s/r$æ¬¡å¹‚çš„é€šç”¨è¿­ä»£å½¢å¼ã€‚åœ¨è¿™ä¸ªç»“æœä¹‹ä¸Šï¼Œæˆ‘ä»¬åªéœ€é€‰æ‹©$\boldsymbol{G}=\boldsymbol{P}, s=r-1$ï¼Œå°±å¯ä»¥å¾—åˆ°$\boldsymbol{P}^{1/r}$äº†ï¼Œæ‰€ä»¥åªéœ€è¦é›†ä¸­ç²¾åŠ›è§£å†³$0\sim 1$æ¬¡å¹‚çš„é€†å°±å¯ä»¥äº†ã€‚</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œé—®é¢˜å˜æˆäº†å¦‚ä½•é€‰æ‹©é€‚å½“$\{a_t,b_t,c_t\}$ï¼Œè®©åºåˆ—$\{\boldsymbol{P}_t\}$èƒ½å¤Ÿå°½å¯èƒ½å¿«åœ°æ”¶æ•›åˆ°$\boldsymbol{I}$ï¼Œæ”¶æ•›é€Ÿåº¦è¶Šå¿«ï¼Œæ„å‘³ç€æˆ‘ä»¬å¯ä»¥ç”¨è¶Šå°‘çš„è¿­ä»£æ­¥æ•°è¾¾åˆ°æŒ‡å®šç²¾åº¦ã€‚</p>
<h2 id="_3">è¿­ä»£ç³»æ•°</h2>
<p>æ ¹æ®å‡è®¾ï¼Œ$\boldsymbol{P}_0 = \boldsymbol{P}$æ˜¯ä¸€ä¸ªç‰¹å¾å€¼éƒ½åœ¨$[0,1]$å†…çš„çŸ©é˜µï¼Œè€Œç›®æ ‡çŸ©é˜µ$\boldsymbol{I}$åˆ™æ˜¯ç‰¹å¾å€¼å…¨ä¸º1çš„çŸ©é˜µï¼Œæ‰€ä»¥åºåˆ—$\{\boldsymbol{P}_t\}$å®é™…ä¸Šå°±æ˜¯ç‰¹å¾å€¼ä»ä»»æ„$[0,1]$å†…çš„æ•°å˜æˆ$1$çš„è¿‡ç¨‹ï¼Œè¿™å®é™…ä¸Šå°±æ˜¯$\mcsgn$æ‰€åšçš„äº‹æƒ…ï¼</p>
<p>æˆ‘ä»¬è®¾$\boldsymbol{X}<em t_1="t+1">t = \boldsymbol{P}_t^{1/r}$ï¼Œé‚£ä¹ˆ$\boldsymbol{X}_0 = \boldsymbol{P}^{1/r}$åŒæ ·æ˜¯ä¸€ä¸ªç‰¹å¾å€¼éƒ½åœ¨$[0,1]$å†…çš„çŸ©é˜µï¼Œä¸”è¿­ä»£æ–¹ç¨‹å˜ä¸º<br />
\begin{equation}\boldsymbol{X}</em>} = a_{t+1}\boldsymbol{X<em t_1="t+1">t + b</em>}\boldsymbol{X<em t_1="t+1">t^{r+1} + c</em>}\boldsymbol{X}_t^{2r+1}\end{equation<br />
ç°åœ¨é—®é¢˜åˆ™å˜æˆäº†å¦‚ä½•è®©$\boldsymbol{X}_0$å°½å¯èƒ½å¿«åœ°å˜æˆ$\boldsymbol{I}$ï¼Œè¿™è·Ÿæˆ‘ä»¬åœ¨<a href="/archives/10922">ã€Šmsignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸Šï¼‰ã€‹</a>å’Œ<a href="/archives/10996">ã€Šmsignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸‹ï¼‰ã€‹</a>æ‰€è®¨è®ºçš„é—®é¢˜å®è´¨æ˜¯ä¸€æ ·çš„ã€‚å…¶ä¸­ï¼Œâ€œ<a href="/archives/10996">ä¸‹ç¯‡</a>â€ç»™å‡ºäº†$r=2$çš„ç†è®ºæœ€ä¼˜è§£ï¼Œä½†å®ƒçš„æ±‚è§£è¿‡ç¨‹å’Œç»“è®ºéƒ½å¯ä»¥æ¨å¹¿åˆ°ä»»æ„$r$çš„ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬å…ˆå°†é—®é¢˜è½¬åŒ–ä¸ºæ ‡é‡çš„è¿­ä»£ï¼š<br />
\begin{equation}x_{t+1} = f_t(x_t) = a_{t+1}x_t + b_{t+1}x_t^{r+1} + c_{t+1}x_t^{2r+1}\end{equation}<br />
ç„¶åè¯æ˜è´ªå¿ƒè§£å°±æ˜¯æœ€ä¼˜è§£ï¼Œè€Œæ±‚è´ªå¿ƒè§£åˆ™å˜æˆäº†è§£æ–¹ç¨‹<br />
\begin{equation}\begin{gathered}<br />
f_t(l_t) = 1 - \mathcal{E}, \quad f_t(u_t) = 1 + \mathcal{E} \\\<br />
f_t(x_1) = 1 + \mathcal{E}, \quad f_t(x_2) = 1 - \mathcal{E} \\\<br />
f_t'(x_1) = 0, \quad f_t'(x_2) = 0<br />
\end{gathered}\end{equation}<br />
ç®€å•èµ·è§ï¼Œå°†$f_t$å‚æ•°åŒ–ä¸º<br />
\begin{equation}f_t'(x) = k(x^r-x_1^r)(x^r-x_2^r)\end{equation}<br />
é‚£ä¹ˆå°±å¯ä»¥åƒâ€œ<a href="/archives/10996">ä¸‹ç¯‡</a>ä¸€æ ·ï¼Œç”¨Mathematicaæ±‚è§£äº†ã€‚</p>
<h2 id="_4">åˆå§‹åˆ†æ</h2>
<p>ä¸è¿‡æ­£å¼æ±‚è§£ä¹‹å‰ï¼Œæˆ‘ä»¬è¿˜è¦åˆ†æä¸€ä¸‹åˆå§‹åŒ–ã€‚åœ¨ä¸Šä¸€ç¯‡æ–‡ç« <a href="/archives/11158">ã€ŠçŸ©é˜µå¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—ã€‹</a>ä¸­æˆ‘ä»¬æåˆ°ï¼Œåœ¨$\boldsymbol{P}$çš„ç‰¹å¾å€¼å‡éè´Ÿçš„å‡è®¾ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é™¤ä»¥$\newcommand{tr}{\mathop{\text{tr}}}\tr(\boldsymbol{P})$å°†ç‰¹å¾å€¼éƒ½å‹ç¼©åˆ°$[0,1]$å†…ã€‚ä¸è¿‡è¿™ä¸ªå‹ç¼©æ¯”ä¾‹å¾€å¾€è¿‡å¤§äº†ï¼Œæœ¬æ–‡æˆ‘ä»¬æ”¹ä¸º<br />
\begin{equation}\boldsymbol{P}_0 = \frac{\boldsymbol{P}}{\sqrt{\tr(\boldsymbol{P}^2)}}\end{equation}<br />
æˆ‘ä»¬çŸ¥é“ï¼Œ$\tr(\boldsymbol{P}^2)$ç­‰äºå…¨ä½“ç‰¹å¾å€¼çš„å¹³æ–¹å’Œï¼Œ$\tr(\boldsymbol{P})^2$åˆ™ç­‰äºå…¨ä½“ç‰¹å¾å€¼çš„å’Œå¹³æ–¹ï¼Œåœ¨ç‰¹å¾å€¼éè´Ÿæ—¶æ’æˆç«‹$\tr(\boldsymbol{P}^2)\leq\tr(\boldsymbol{P})^2$ï¼Œæ‰€ä»¥ä¸Šå¼æä¾›äº†ä¸€ä¸ªæ›´ç´§å‡‘çš„åˆå§‹å€¼ã€‚ç‰¹åˆ«åœ°ï¼Œç®—$\tr(\boldsymbol{P}^2)$å¹¶ä¸éœ€è¦æŠŠ$\boldsymbol{P}^2$æ˜¾å¼è®¡ç®—å‡ºæ¥ï¼Œå› ä¸ºæˆ‘ä»¬æœ‰æ’ç­‰å¼<br />
\begin{equation}\tr(\boldsymbol{P}^2) = \langle \boldsymbol{P}, \boldsymbol{P}^{\top}\rangle_F\end{equation}</p>
<p>æ¥ç€ï¼Œæˆ‘ä»¬è¿˜è¦åˆ†æéœ€è¦å¤„ç†å¤šå°çš„ç‰¹å¾å€¼ï¼Œè¿™è·Ÿ<a href="/archives/10922">ã€Šmsignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸Šï¼‰ã€‹</a>çš„åˆå§‹å¥‡å¼‚å€¼åˆ†ææ˜¯ä¸€æ ·çš„ã€‚é™¤ä»¥$\sqrt{\tr(\boldsymbol{P}^2)}$åï¼Œ$\boldsymbol{P}_0$çš„ç‰¹å¾å€¼ç»„æˆä¸€ä¸ªå•ä½å‘é‡ï¼Œå¦‚æœç‰¹å¾å€¼å…¨éƒ¨ç›¸ç­‰ï¼Œé‚£ä¹ˆæ¯ä¸ªç‰¹å¾å€¼æ˜¯$1/\sqrt{n}$ã€‚ç”±é¸½ç¬¼åŸç†å¯çŸ¥ä¸€èˆ¬æƒ…å†µä¸‹å¿…ç„¶å­˜åœ¨å°äº$1/\sqrt{n}$çš„ç‰¹å¾å€¼ï¼Œä¿å®ˆèµ·è§æˆ‘ä»¬å…¼å®¹åˆ°$0.01/\sqrt{n}$ã€‚</p>
<p>è€ƒè™‘åˆ°è¶³å¤Ÿå¤§çš„LLMï¼Œ$n$å·²ç»åˆ°äº†$100^2$è¿™ä¸ªçº§åˆ«ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦å…¼å®¹åˆ°$0.0001$ã€‚æ³¨æ„è¿™åªæ˜¯$\boldsymbol{P}_0$çš„ç‰¹å¾å€¼ï¼Œè€Œ$\boldsymbol{X}_0 = \boldsymbol{P}_0^{1/r}$ï¼Œæ‰€ä»¥$\boldsymbol{X}_0$æˆ‘ä»¬åªéœ€è¦å…¼å®¹åˆ°$0.0001^{1/r}$ï¼Œè¿™æ¯”$\mcsgn$ã€$\newcommand{msign}{\mathop{\text{msign}}}\msign$çš„æƒ…å†µè¦ç†æƒ³ä¸€äº›ï¼Œå› ä¸º$\mcsgn$ã€$\msign$çš„è¾“å…¥æ˜¯$\boldsymbol{X}_0$ï¼Œæˆ‘ä»¬éœ€è¦å…¼å®¹$\boldsymbol{X}_0$çš„å°ç‰¹å¾å€¼ï¼Œä½†è¿™é‡Œçš„è¾“å…¥æ˜¯$\boldsymbol{P}_0$ï¼Œæˆ‘ä»¬åªéœ€è¦ä»$\boldsymbol{P}_0$å‡ºå‘è€ƒè™‘ã€‚</p>
<h2 id="_5">è®¡ç®—ç»“æœ</h2>
<p>ç»¼åˆä¸Šè¿°è€ƒè™‘ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„æ±‚è§£ä»£ç å¦‚ä¸‹</p>
<div class="codehilite"><pre><span></span><code><span class="n">r</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="n">df</span><span class="o">[</span><span class="n">x_</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">k</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x1</span><span class="o">^</span><span class="n">r</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="o">^</span><span class="n">r</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x2</span><span class="o">^</span><span class="n">r</span><span class="p">);</span>
<span class="n">f</span><span class="o">[</span><span class="n">x_</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integrate</span><span class="o">[</span><span class="n">df[x</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="err">{</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="err">}]</span><span class="p">;</span>
<span class="n">sol</span><span class="o">[</span><span class="n">l_, u_</span><span class="o">]</span><span class="w"> </span><span class="err">:</span><span class="o">=</span><span class="w"> </span>
<span class="w"> </span><span class="n">NSolve</span><span class="o">[</span><span class="n">{f[l</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="o">[</span><span class="n">x1</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="o">[</span><span class="n">x2</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">e</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="o">[</span><span class="n">u</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">e</span><span class="p">,</span>
<span class="w">    </span><span class="n">l</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">x1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">u</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="err">}</span><span class="p">,</span><span class="w"> </span><span class="err">{</span><span class="n">k</span><span class="p">,</span><span class="w"> </span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="err">}]</span>
<span class="n">ff</span><span class="o">[</span><span class="n">x_, l_, u_</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">f</span><span class="o">[</span><span class="n">x</span><span class="o">]*</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="n">f</span><span class="o">[</span><span class="n">l</span><span class="o">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">f</span><span class="o">[</span><span class="n">u</span><span class="o">]</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">Expand</span><span class="p">;</span>
<span class="n">lt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.0001</span><span class="o">^</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">r</span><span class="p">);</span><span class="w"> </span><span class="n">ut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="n">lambda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0.1</span><span class="p">;</span>
<span class="k">While</span><span class="o">[</span><span class="n">1 - lt &gt; 0.0001,</span>
<span class="n"> fff[x_</span><span class="o">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ff</span><span class="o">[</span><span class="n">x, lt, ut</span><span class="o">]</span><span class="w"> </span><span class="o">/</span><span class="p">.</span><span class="w"> </span><span class="n">sol</span><span class="o">[</span><span class="n">Max[lt, lambda*ut</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">ut</span><span class="err">]</span><span class="o">[</span><span class="n">[1</span><span class="o">]</span><span class="err">]</span><span class="p">;</span>
<span class="w"> </span><span class="k">Print</span><span class="o">[</span><span class="n">fff[x</span><span class="o">]</span><span class="err">]</span><span class="p">;</span>
<span class="w"> </span><span class="n">lt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fff</span><span class="o">[</span><span class="n">lt</span><span class="o">]</span><span class="p">;</span><span class="w"> </span><span class="n">ut</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">lt</span><span class="err">]</span>
<span class="n">f</span><span class="o">[</span><span class="n">x</span><span class="o">]</span><span class="w"> </span><span class="o">/</span><span class="p">.</span><span class="w"> </span><span class="n">Solve</span><span class="o">[</span><span class="n">f[1</span><span class="o">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">k</span><span class="err">]</span><span class="o">[</span><span class="n">[1</span><span class="o">]</span><span class="err">]</span><span class="w"> </span><span class="o">/</span><span class="p">.</span><span class="w"> </span><span class="err">{</span><span class="n">x1</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">x2</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">1</span><span class="err">}</span>
</code></pre></div>

<p>$r=1\sim 5$çš„è®¡ç®—ç»“æœå¦‚ä¸‹ï¼š<br />
\begin{array}{c|ccc}<br />
\hline<br />
r &amp; t &amp; a &amp; b &amp; c \\\<br />
\hline<br />
&amp; \quad 1\quad &amp; 14.2975 &amp; -31.2203 &amp; 18.9214 \\\<br />
&amp; 2 &amp; 7.12258 &amp; -7.78207 &amp; 2.35989 \\\<br />
\quad 1\quad &amp; 3 &amp; 6.9396 &amp; -7.61544 &amp; 2.3195 \\\<br />
&amp; 4 &amp; 5.98456 &amp; -6.77016 &amp; 2.12571 \\\<br />
&amp; 5 &amp; 3.79109 &amp; -4.18664 &amp; 1.39555 \\\<br />
&amp; \geq 6 &amp; 3 &amp; -3 &amp; 1 \\\<br />
\hline<br />
&amp; 1 &amp; 7.42487 &amp; -18.3958 &amp; 12.8967 \\\<br />
&amp; 2 &amp; 3.48773 &amp; -2.33004 &amp; 0.440469 \\\<br />
2 &amp; 3 &amp; 2.77661 &amp; -2.07064 &amp; 0.463023 \\\<br />
&amp; 4 &amp; 1.99131 &amp; -1.37394 &amp; 0.387593 \\\<br />
&amp; \geq 5 &amp; 15/8 &amp; -5/4 &amp; 3/8 \\\<br />
\hline<br />
&amp; 1 &amp; 5.05052 &amp; -13.5427 &amp; 10.2579 \\\<br />
&amp; 2 &amp; 2.31728 &amp; -1.06581 &amp; 0.144441 \\\<br />
3 &amp; 3 &amp; 1.79293 &amp; -0.913562 &amp; 0.186699 \\\<br />
&amp; 4 &amp; 1.56683 &amp; -0.786609 &amp; 0.220008 \\\<br />
&amp; \geq 5 &amp; 14/9 &amp; -7/9 &amp; 2/9 \\\<br />
\hline<br />
&amp; 1 &amp; 3.85003 &amp; -10.8539 &amp; 8.61893 \\\<br />
4 &amp; 2 &amp; 1.80992 &amp; -0.587778 &amp; 0.0647852 \\\<br />
&amp; 3 &amp; 1.50394 &amp; -0.594516 &amp; 0.121161 \\\<br />
&amp; \geq 4 &amp; 45/32 &amp; -9/16 &amp; 5/32 \\\<br />
\hline<br />
&amp; 1 &amp; 3.11194 &amp; -8.28217 &amp; 6.67716 \\\<br />
5 &amp; 2 &amp; 1.5752 &amp; -0.393327 &amp; 0.0380364 \\\<br />
&amp; 3 &amp; 1.3736 &amp; -0.44661 &amp; 0.0911259 \\\<br />
&amp; \geq 4 &amp; 33/25 &amp; -11/25 &amp; 3/25 \\\<br />
\hline<br />
\end{array}</p>
<p>å…¶ä¸­æœ€åä¸€æ­¥çš„æ”¶æ•›å€¼ï¼Œç”±$x_1=x_2=1$å’Œ$f(1)=1$å¾—å‡ºã€‚</p>
<h2 id="_6">æµ‹è¯•ä¸€ä¸‹</h2>
<p>ä¸€ä¸ªç®€å•çš„æµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">jax.numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">jnp</span>

<span class="n">coefs</span> <span class="o">=</span> <span class="p">[</span>
    <span class="kc">None</span><span class="p">,</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mf">14.2975</span><span class="p">,</span> <span class="o">-</span><span class="mf">31.2203</span><span class="p">,</span> <span class="mf">18.9214</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">7.12258</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.78207</span><span class="p">,</span> <span class="mf">2.35989</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">6.9396</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.61544</span><span class="p">,</span> <span class="mf">2.3195</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">5.98456</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.77016</span><span class="p">,</span> <span class="mf">2.12571</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">3.79109</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.18664</span><span class="p">,</span> <span class="mf">1.39555</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mf">7.42487</span><span class="p">,</span> <span class="o">-</span><span class="mf">18.3958</span><span class="p">,</span> <span class="mf">12.8967</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">3.48773</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.33004</span><span class="p">,</span> <span class="mf">0.440469</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">2.77661</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.07064</span><span class="p">,</span> <span class="mf">0.463023</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.99131</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.37394</span><span class="p">,</span> <span class="mf">0.387593</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">15</span> <span class="o">/</span> <span class="mi">8</span><span class="p">,</span> <span class="o">-</span><span class="mi">5</span> <span class="o">/</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">8</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mf">5.05052</span><span class="p">,</span> <span class="o">-</span><span class="mf">13.5427</span><span class="p">,</span> <span class="mf">10.2579</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">2.31728</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.06581</span><span class="p">,</span> <span class="mf">0.144441</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.79293</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.913562</span><span class="p">,</span> <span class="mf">0.186699</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.56683</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.786609</span><span class="p">,</span> <span class="mf">0.220008</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">14</span> <span class="o">/</span> <span class="mi">9</span><span class="p">,</span> <span class="o">-</span><span class="mi">7</span> <span class="o">/</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">9</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mf">3.85003</span><span class="p">,</span> <span class="o">-</span><span class="mf">10.8539</span><span class="p">,</span> <span class="mf">8.61893</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.80992</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.587778</span><span class="p">,</span> <span class="mf">0.0647852</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.50394</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.594516</span><span class="p">,</span> <span class="mf">0.121161</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">45</span> <span class="o">/</span> <span class="mi">32</span><span class="p">,</span> <span class="o">-</span><span class="mi">9</span> <span class="o">/</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span> <span class="o">/</span> <span class="mi">32</span><span class="p">),</span>
    <span class="p">],</span>
    <span class="p">[</span>
        <span class="p">(</span><span class="mf">3.11194</span><span class="p">,</span> <span class="o">-</span><span class="mf">8.28217</span><span class="p">,</span> <span class="mf">6.67716</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.5752</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.393327</span><span class="p">,</span> <span class="mf">0.0380364</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.3736</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.44661</span><span class="p">,</span> <span class="mf">0.0911259</span><span class="p">),</span>
        <span class="p">(</span><span class="mi">33</span> <span class="o">/</span> <span class="mi">25</span><span class="p">,</span> <span class="o">-</span><span class="mi">11</span> <span class="o">/</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">3</span> <span class="o">/</span> <span class="mi">25</span><span class="p">),</span>
    <span class="p">],</span>
<span class="p">]</span>

<span class="k">def</span><span class="w"> </span><span class="nf">abc</span><span class="p">(</span><span class="n">r</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">w</span><span class="p">,</span> <span class="n">steps</span> <span class="o">=</span> <span class="n">coefs</span><span class="p">[</span><span class="n">r</span><span class="p">],</span> <span class="n">steps</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">coefs</span><span class="p">[</span><span class="n">r</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">w</span><span class="p">[:</span><span class="n">steps</span><span class="p">]</span> <span class="o">+</span> <span class="n">w</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">*</span> <span class="nb">max</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">w</span><span class="p">),</span> <span class="mi">0</span><span class="p">):</span>
        <span class="k">yield</span> <span class="n">a</span> <span class="o">/</span> <span class="n">scale</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="n">scale</span><span class="o">**</span><span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">),</span> <span class="n">c</span> <span class="o">/</span> <span class="n">scale</span><span class="o">**</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">matmul_invroot</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;return G @ P^(-s/r)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="kp">eye</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="kp">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="kp">dtype</span><span class="o">=</span><span class="n">P</span><span class="o">.</span><span class="kp">dtype</span><span class="p">)</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">P</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span> <span class="o">:=</span> <span class="p">(</span><span class="n">P</span> <span class="o">*</span> <span class="n">P</span><span class="o">.</span><span class="n">mT</span><span class="p">)</span><span class="o">.</span><span class="kp">sum</span><span class="p">()</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span> <span class="n">eps</span> <span class="o">*</span> <span class="n">I</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">abc</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">steps</span><span class="p">,</span> <span class="mf">1.001</span><span class="p">):</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">I</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">P</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">P</span> <span class="o">@</span> <span class="n">P</span>
        <span class="n">W1</span><span class="p">,</span> <span class="n">W2</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">s</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
        <span class="n">G</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="n">G</span> <span class="o">@</span> <span class="n">W1</span><span class="p">,</span> <span class="n">P</span> <span class="o">@</span> <span class="n">W2</span>
    <span class="k">return</span> <span class="n">G</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">s</span> <span class="o">/</span> <span class="n">r</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">matmul_invroot_by_eigh</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;return G @ P^(-s/r)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">S</span><span class="p">,</span> <span class="n">Q</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigh</span><span class="p">(</span><span class="n">P</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">G</span> <span class="o">@</span> <span class="n">Q</span> <span class="o">@</span> <span class="n">jnp</span><span class="o">.</span><span class="kp">diag</span><span class="p">(</span><span class="n">S</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="n">s</span> <span class="o">/</span> <span class="n">r</span><span class="p">))</span> <span class="o">@</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="kp">inv</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span>

<span class="n">d</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">s</span><span class="p">,</span> <span class="n">r</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">:=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">@</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="mf">0.001</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">eye</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>

<span class="n">X1</span> <span class="o">=</span> <span class="n">matmul_invroot_by_eigh</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="n">X2</span> <span class="o">=</span> <span class="n">matmul_invroot</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">jnp</span><span class="o">.</span><span class="kp">abs</span><span class="p">(</span><span class="n">X1</span> <span class="o">-</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="kp">mean</span><span class="p">()</span>  <span class="c1"># ~= 1e-3</span>

<span class="n">X2</span> <span class="o">=</span> <span class="n">matmul_invroot</span><span class="p">(</span><span class="n">jnp</span><span class="o">.</span><span class="kp">array</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="kp">dtype</span><span class="o">=</span><span class="s1">&#39;bfloat16&#39;</span><span class="p">),</span> <span class="n">jnp</span><span class="o">.</span><span class="kp">array</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="kp">dtype</span><span class="o">=</span><span class="s1">&#39;bfloat16&#39;</span><span class="p">),</span> <span class="n">r</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">eps</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">jnp</span><span class="o">.</span><span class="kp">abs</span><span class="p">(</span><span class="n">X1</span> <span class="o">-</span> <span class="n">X2</span><span class="p">)</span><span class="o">.</span><span class="kp">mean</span><span class="p">()</span>  <span class="c1"># ~= 2e-3</span>
</code></pre></div>

<p>è¿™é‡Œæœ‰å‡ ç‚¹æ³¨æ„äº‹é¡¹ã€‚é¦–å…ˆè¾“å…¥$\boldsymbol{P}$çš„æœ€å°ç‰¹å¾å€¼ä¸èƒ½å¤ªå°ï¼Œå¦åˆ™è¿­ä»£è¿‡ç¨‹æå…¶å®¹æ˜“çˆ†ç‚¸ï¼Œå“ªæ€•æˆ‘ä»¬åªæƒ³è¦æ±‚æ­£æ•°æ¬¡å¹‚å¦‚$\boldsymbol{P}^{1/2}$ä¹Ÿæ˜¯å¦‚æ­¤ã€‚è¿™ä¸ªå…¶å®ä¸éš¾ç†è§£ï¼Œå› ä¸º$\sqrt{x}$åœ¨$x=0$å¤„ä¹Ÿæ˜¯æ¯”è¾ƒç—…æ€çš„ï¼Œä¸€æ—¦ç”±äºè¯¯å·®é—®é¢˜â€œä¸å°å¿ƒâ€åˆ°äº†è´ŸåŠè½´ï¼Œé‚£ç›´æ¥å°±ä¸å­˜åœ¨ï¼ˆå®æ•°è§£ï¼‰äº†ï¼Œè¿™æ—¶å€™è¿­ä»£çš„è¡¨ç°å°±æ— æ³•é¢„ä¼°ã€‚</p>
<p>å¤šå°æ‰ä¸ç®—â€œå¤ªå°â€å‘¢ï¼Ÿå¤§æ¦‚æ˜¯$\boldsymbol{P}/\sqrt{\tr(\boldsymbol{P}^2)}$çš„æœ€å°ç‰¹å¾å€¼æ˜æ˜¾ä¸èƒ½å°äºæˆ‘ä»¬è€ƒè™‘çš„æœ€å°ç‰¹å¾å€¼ï¼Œå³$0.0001$ã€‚å¦‚æœæ²¡æ³•ä¿è¯è¿™ä¸€ç‚¹ï¼Œé‚£ä¹ˆå»ºè®®ç›´æ¥è®¾ç½®<br />
\begin{equation}\boldsymbol{P}_0 = \frac{\boldsymbol{P}}{\sqrt{\tr(\boldsymbol{P}^2)}} + \epsilon \cdot\boldsymbol{I} \end{equation}<br />
å…¶ä¸­$\epsilon\sim 0.0001$ã€‚è¿™æ ·ä¼šæŸå¤±ä¸€ç‚¹ç²¾åº¦ï¼Œä½†èƒ½å¤Ÿæ˜æ˜¾å¢åŠ æ•°å€¼ç¨³å®šæ€§ã€‚</p>
<p>æ­¤å¤–ï¼Œè¿­ä»£æ­¥æ•°åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä¸éœ€è¦è¶…è¿‡æ¨èå€¼<code>len(coefs[r])</code>ï¼Œå°¤å…¶æ˜¯ä½ç²¾åº¦è®¡ç®—åœºæ™¯ï¼Œå› ä¸ºè¿­ä»£æ­¥æ•°è¶Šå¤šï¼Œè¶Šå®¹æ˜“ç”±äºç´¯ç§¯è¯¯å·®è€Œçˆ†ç‚¸ã€‚å®é™…ä¸Šåªè¦ç‰¹å¾å€¼åœ¨è€ƒè™‘èŒƒå›´å†…ï¼Œæ¨èæ­¥æ•°å·²ç»è¶³å¤Ÿè¾¾åˆ°ç†æƒ³ç²¾åº¦äº†ï¼Œé™¤éæˆ‘ä»¬ç”¨fp32ç”šè‡³æ›´é«˜ç²¾åº¦è¿­ä»£ï¼Œé‚£ä¹ˆå¯ä»¥è€ƒè™‘è®¾ç½®$\epsilon=0$ã€<code>scale=1</code>ä»¥åŠä½¿ç”¨æ›´å¤šçš„è¿­ä»£æ­¥æ•°ã€‚</p>
<h2 id="_7">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡å°†ä¸Šä¸€ç¯‡æ–‡ç« çš„ç»“æœï¼Œæ¨å¹¿åˆ°ä»»æ„çš„$r$æ¬¡æ–¹æ ¹å’Œé€†$r$æ¬¡æ–¹æ ¹çš„è®¡ç®—ï¼Œå¾—åˆ°äº†ä¸€ç§çŸ©é˜µçš„ä»»æ„$-1/r$æ¬¡æ–¹çš„é€šç”¨è¿­ä»£æ ¼å¼ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11175">https://spaces.ac.cn/archives/11175</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jul. 21, 2025). ã€ŠçŸ©é˜µræ¬¡æ–¹æ ¹å’Œé€†ræ¬¡æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®— ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11175">https://spaces.ac.cn/archives/11175</a></p>
<p>@online{kexuefm-11175,<br />
title={çŸ©é˜µræ¬¡æ–¹æ ¹å’Œé€†ræ¬¡æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Jul},<br />
url={\url{https://spaces.ac.cn/archives/11175}},<br />
} </p>
<hr />
<h2 id="_8">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚å¯¹æ–‡ä¸­çš„å…³é”®ç®—æ³•å’Œç†è®ºè¿›è¡Œè¯¦ç»†çš„æ•°å­¦æ¨å¯¼ï¼ŒåŒ…æ‹¬çŸ©é˜µræ¬¡æ–¹æ ¹çš„ç†è®ºåŸºç¡€ã€å¤šç§è¿­ä»£ç®—æ³•çš„æ¨å¯¼ä¸æ”¶æ•›æ€§åˆ†æã€æ•°å€¼ç¨³å®šæ€§è®¨è®ºç­‰å†…å®¹ã€‚</p>
<h3 id="1-r">1. çŸ©é˜µræ¬¡æ–¹æ ¹çš„ç²¾ç¡®å®šä¹‰ä¸ç†è®ºåŸºç¡€</h3>
<h4 id="11">1.1 åŸºäºè°±åˆ†è§£çš„å®šä¹‰</h4>
<p>å¯¹äºå¯¹ç§°æ­£å®šçŸ©é˜µ$\boldsymbol{P}\in\mathbb{R}^{n\times n}$ï¼Œå­˜åœ¨è°±åˆ†è§£ï¼š
$$\boldsymbol{P} = \boldsymbol{Q}\boldsymbol{\Lambda}\boldsymbol{Q}^{\top}$$
å…¶ä¸­$\boldsymbol{Q}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œ$\boldsymbol{\Lambda}=\text{diag}(\lambda_1,\lambda_2,\ldots,\lambda_n)$æ˜¯ç”±ç‰¹å¾å€¼ç»„æˆçš„å¯¹è§’çŸ©é˜µï¼Œä¸”$\lambda_i &gt; 0$ã€‚</p>
<p>çŸ©é˜µ$\boldsymbol{P}$çš„$r$æ¬¡æ–¹æ ¹å®šä¹‰ä¸ºï¼š
$$\boldsymbol{P}^{1/r} = \boldsymbol{Q}\boldsymbol{\Lambda}^{1/r}\boldsymbol{Q}^{\top} = \boldsymbol{Q}\text{diag}(\lambda_1^{1/r},\lambda_2^{1/r},\ldots,\lambda_n^{1/r})\boldsymbol{Q}^{\top}$$</p>
<p><strong>å”¯ä¸€æ€§è¯æ˜</strong>ï¼šå‡è®¾å­˜åœ¨å¦ä¸€ä¸ªå¯¹ç§°æ­£å®šçŸ©é˜µ$\boldsymbol{B}$ä½¿å¾—$\boldsymbol{B}^r = \boldsymbol{P}$ï¼Œåˆ™ï¼š
$$\boldsymbol{B}^r = \boldsymbol{Q}\boldsymbol{\Lambda}\boldsymbol{Q}^{\top}$$</p>
<p>ç”±äº$\boldsymbol{B}$å¯¹ç§°æ­£å®šï¼Œå¯å†™ä¸º$\boldsymbol{B} = \boldsymbol{Q}_B\boldsymbol{\Lambda}_B\boldsymbol{Q}_B^{\top}$ï¼Œåˆ™ï¼š
$$\boldsymbol{Q}_B\boldsymbol{\Lambda}_B^r\boldsymbol{Q}_B^{\top} = \boldsymbol{Q}\boldsymbol{\Lambda}\boldsymbol{Q}^{\top}$$</p>
<p>è¿™æ„å‘³ç€$\boldsymbol{B}$å’Œ$\boldsymbol{P}$æœ‰ç›¸åŒçš„ç‰¹å¾ç©ºé—´å’Œæ»¡è¶³$\lambda_{B,i}^r = \lambda_i$çš„ç‰¹å¾å€¼ï¼Œå› æ­¤$\lambda_{B,i} = \lambda_i^{1/r}$ï¼ˆå–æ­£å®æ ¹ï¼‰ï¼Œè¯æ˜äº†å”¯ä¸€æ€§ã€‚</p>
<h4 id="12-jordan">1.2 åŸºäºJordanæ ‡å‡†å‹çš„æ¨å¹¿</h4>
<p>å¯¹äºæ›´ä¸€èˆ¬çš„å¯å¯¹è§’åŒ–çŸ©é˜µ$\boldsymbol{A}\in\mathbb{C}^{n\times n}$ï¼Œå¦‚æœå­˜åœ¨åˆ†è§£$\boldsymbol{A} = \boldsymbol{V}\boldsymbol{\Lambda}\boldsymbol{V}^{-1}$ï¼Œå…¶ä¸­$\boldsymbol{\Lambda}$æ˜¯å¯¹è§’çŸ©é˜µï¼Œåˆ™ï¼š
$$\boldsymbol{A}^{1/r} = \boldsymbol{V}\boldsymbol{\Lambda}^{1/r}\boldsymbol{V}^{-1}$$</p>
<p>å¯¹äºéå¯¹è§’åŒ–çŸ©é˜µï¼Œéœ€è¦ä½¿ç”¨Jordanæ ‡å‡†å‹ã€‚è®¾$\boldsymbol{A} = \boldsymbol{V}\boldsymbol{J}\boldsymbol{V}^{-1}$ï¼Œå…¶ä¸­$\boldsymbol{J}$æ˜¯Jordanæ ‡å‡†å‹ï¼š
$$\boldsymbol{J} = \begin{bmatrix}\boldsymbol{J}_1 & & \\ & \ddots & \\ & & \boldsymbol{J}_k\end{bmatrix}, \quad \boldsymbol{J}_i = \begin{bmatrix}\lambda_i & 1 & & \\ & \lambda_i & \ddots & \\ & & \ddots & 1 \\ & & & \lambda_i\end{bmatrix}$$</p>
<p>å¯¹äºæ¯ä¸ªJordanå—$\boldsymbol{J}_i = \lambda_i\boldsymbol{I} + \boldsymbol{N}$ï¼ˆ$\boldsymbol{N}$ä¸ºå¹‚é›¶çŸ©é˜µï¼‰ï¼Œä½¿ç”¨äºŒé¡¹å¼å±•å¼€ï¼š
$$\boldsymbol{J}_i^{1/r} = \lambda_i^{1/r}(\boldsymbol{I} + \lambda_i^{-1}\boldsymbol{N})^{1/r} = \lambda_i^{1/r}\sum_{k=0}^{m-1}\binom{1/r}{k}\lambda_i^{-k}\boldsymbol{N}^k$$
å…¶ä¸­$m$æ˜¯Jordanå—çš„å¤§å°ï¼Œ$\boldsymbol{N}^m = 0$ä¿è¯äº†çº§æ•°çš„æœ‰é™æ€§ã€‚</p>
<h4 id="13">1.3 å‡½æ•°æ¼”ç®—è§†è§’</h4>
<p>ä»å‡½æ•°æ¼”ç®—ï¼ˆfunctional calculusï¼‰çš„è§’åº¦ï¼Œå¯¹äºè¿ç»­å‡½æ•°$f(x) = x^{1/r}$å’ŒçŸ©é˜µ$\boldsymbol{P}$ï¼š
$$f(\boldsymbol{P}) = \frac{1}{2\pi i}\oint_{\Gamma} f(z)(z\boldsymbol{I}-\boldsymbol{P})^{-1}dz$$
å…¶ä¸­$\Gamma$æ˜¯åŒ…å«$\boldsymbol{P}$æ‰€æœ‰ç‰¹å¾å€¼çš„å›´é“ã€‚</p>
<p>å¯¹äºå¯¹ç§°æ­£å®šçŸ©é˜µï¼Œå¯ä»¥ç®€åŒ–ä¸ºï¼š
$$\boldsymbol{P}^{1/r} = \frac{1}{\pi}\int_0^{\infty} \lambda^{1/r-1}(\lambda\boldsymbol{I}+\boldsymbol{P})^{-1}\boldsymbol{P}\,d\lambda$$</p>
<p>è¿™ä¸ªç§¯åˆ†è¡¨ç¤ºä¸ºæ•°å€¼ç§¯åˆ†æ–¹æ³•ï¼ˆå¦‚Gauss-Legendreç§¯åˆ†ï¼‰æä¾›äº†ç†è®ºåŸºç¡€ã€‚</p>
<h3 id="2-newton-schulz">2. Newton-Schulzè¿­ä»£æ³•çš„è¯¦ç»†æ¨å¯¼</h3>
<h4 id="21">2.1 ç‰›é¡¿æ³•çš„çŸ©é˜µæ¨å¹¿</h4>
<p>è€ƒè™‘æ–¹ç¨‹$\boldsymbol{X}^r = \boldsymbol{P}$ï¼Œç›®æ ‡æ˜¯æ±‚è§£$\boldsymbol{X} = \boldsymbol{P}^{1/r}$ã€‚å®šä¹‰ç®—å­æ–¹ç¨‹ï¼š
$$F(\boldsymbol{X}) = \boldsymbol{X}^r - \boldsymbol{P} = 0$$</p>
<p>ç‰›é¡¿æ³•çš„è¿­ä»£æ ¼å¼ä¸ºï¼š
$$\boldsymbol{X}_{k+1} = \boldsymbol{X}_k - [DF(\boldsymbol{X}_k)]^{-1}F(\boldsymbol{X}_k)$$</p>
<p>è®¡ç®—FrÃ©chetå¯¼æ•°$DF(\boldsymbol{X})[\boldsymbol{H}]$ï¼š
$$DF(\boldsymbol{X})[\boldsymbol{H}] = \lim_{\epsilon\to 0}\frac{(\boldsymbol{X}+\epsilon\boldsymbol{H})^r - \boldsymbol{X}^r}{\epsilon}$$</p>
<p>å¯¹äº$r=2$çš„æƒ…å†µï¼š
$$DF(\boldsymbol{X})[\boldsymbol{H}] = \boldsymbol{X}\boldsymbol{H} + \boldsymbol{H}\boldsymbol{X}$$</p>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåˆ©ç”¨äºŒé¡¹å¼å®šç†ï¼š
$$(\boldsymbol{X}+\epsilon\boldsymbol{H})^r = \sum_{j=0}^{r}\binom{r}{j}\boldsymbol{X}^{r-j}(\epsilon\boldsymbol{H})^j$$</p>
<p>å› æ­¤ï¼š
$$DF(\boldsymbol{X})[\boldsymbol{H}] = \sum_{j=1}^{r}\binom{r}{j}\sum_{p_1+\cdots+p_j=r-j}\boldsymbol{X}^{p_1}\boldsymbol{H}\boldsymbol{X}^{p_2}\cdots\boldsymbol{H}\boldsymbol{X}^{p_{j+1}}$$</p>
<p>å…¶ä¸­æ±‚å’Œéå†æ‰€æœ‰æ»¡è¶³$p_1+\cdots+p_{j+1}=r-j$çš„éè´Ÿæ•´æ•°ç»„åˆã€‚</p>
<h4 id="22-schulz">2.2 Schulzè¿­ä»£çš„å¼•å…¥</h4>
<p>ç›´æ¥æ±‚è§£$DF(\boldsymbol{X})[\boldsymbol{H}] = -F(\boldsymbol{X})$è®¡ç®—é‡å¾ˆå¤§ã€‚Schulzè¿­ä»£é€šè¿‡è€ƒè™‘é€†çŸ©é˜µçš„è®¡ç®—æ¥ç®€åŒ–ã€‚</p>
<p>å¯¹äº$\boldsymbol{Y} = \boldsymbol{X}^{-1}$ï¼Œæˆ‘ä»¬æœ‰$\boldsymbol{Y}^{-r} = \boldsymbol{P}$ï¼Œç­‰ä»·äº$\boldsymbol{P}\boldsymbol{Y}^r = \boldsymbol{I}$ã€‚</p>
<p>å®šä¹‰$\boldsymbol{Z}_k = \boldsymbol{P}\boldsymbol{Y}_k^r$ï¼Œç›®æ ‡æ˜¯è®©$\boldsymbol{Z}_k\to\boldsymbol{I}$ã€‚å½“$\boldsymbol{Z}_k\approx\boldsymbol{I}$æ—¶ï¼Œå¯ä»¥ç”¨æ³°å‹’å±•å¼€ï¼š
$$\boldsymbol{Y}_{k+1} = \boldsymbol{Y}_k(2\boldsymbol{I}-\boldsymbol{Z}_k) \quad \text{(å¯¹äº}r=1\text{çš„æƒ…å†µ)}$$</p>
<p>å¯¹äºä¸€èˆ¬çš„$r$æ¬¡æ–¹æ ¹ï¼ŒNewton-Schulzè¿­ä»£æ ¼å¼ä¸ºï¼š
$$\boldsymbol{X}_{k+1} = \boldsymbol{X}_k + \frac{1}{r}\boldsymbol{X}_k(\boldsymbol{I}-\boldsymbol{X}_k^r\boldsymbol{P}^{-1})$$</p>
<p>å½“$\boldsymbol{P}$ä¸æ˜“æ±‚é€†æ—¶ï¼Œæ”¹ç”¨é€†ræ¬¡æ–¹æ ¹çš„å½¢å¼ï¼š
$$\boldsymbol{Y}_{k+1} = \boldsymbol{Y}_k\left[a\boldsymbol{I} + b(\boldsymbol{P}\boldsymbol{Y}_k^r) + c(\boldsymbol{P}\boldsymbol{Y}_k^r)^2\right]$$</p>
<p>è¿™æ­£æ˜¯æ–‡ä¸­æå‡ºçš„è¿­ä»£æ ¼å¼çš„ç†è®ºåŸºç¡€ã€‚</p>
<h4 id="23">2.3 è¿­ä»£çš„å±€éƒ¨æ”¶æ•›æ€§</h4>
<p>è®¾$\boldsymbol{X}^<em> = \boldsymbol{P}^{1/r}$ï¼Œä»¤$\boldsymbol{E}_k = \boldsymbol{X}_k - \boldsymbol{X}^</em>$ã€‚å±•å¼€è¿­ä»£å¼ï¼š
$$\boldsymbol{X}_{k+1} = \boldsymbol{X}_k + \frac{1}{r}\boldsymbol{X}_k(\boldsymbol{I}-\boldsymbol{X}_k^r\boldsymbol{P}^{-1})$$</p>
<p>ä»£å…¥$\boldsymbol{X}_k = \boldsymbol{X}^* + \boldsymbol{E}_k$ï¼š
$$\boldsymbol{X}^* + \boldsymbol{E}_{k+1} = \boldsymbol{X}^* + \boldsymbol{E}_k + \frac{1}{r}(\boldsymbol{X}^*+\boldsymbol{E}_k)\left[\boldsymbol{I} - (\boldsymbol{X}^*+\boldsymbol{E}_k)^r(\boldsymbol{X}^*)^{-r}\right]$$</p>
<p>æ³¨æ„åˆ°$(\boldsymbol{X}^<em>)^r = \boldsymbol{P}$ï¼Œè®¾$\boldsymbol{\Delta}_k = \boldsymbol{X}^{</em>-1}\boldsymbol{E}_k$ä¸ºç›¸å¯¹è¯¯å·®ï¼Œåˆ™ï¼š
$$\boldsymbol{E}_{k+1} = \boldsymbol{E}_k + \frac{1}{r}(\boldsymbol{X}^*+\boldsymbol{E}_k)\left[\boldsymbol{I} - (\boldsymbol{I}+\boldsymbol{\Delta}_k)^r\right]$$</p>
<p>åˆ©ç”¨äºŒé¡¹å¼å±•å¼€$(\boldsymbol{I}+\boldsymbol{\Delta}_k)^r = \boldsymbol{I} + r\boldsymbol{\Delta}_k + O(|\boldsymbol{\Delta}_k|^2)$ï¼š
$$\boldsymbol{E}_{k+1} = \frac{1}{r}(\boldsymbol{X}^*+\boldsymbol{E}_k)\left[-r\boldsymbol{\Delta}_k + O(\|\boldsymbol{\Delta}_k\|^2)\right] = -(\boldsymbol{X}^*+\boldsymbol{E}_k)\boldsymbol{\Delta}_k + O(\|\boldsymbol{E}_k\|^2)$$</p>
<p>ç®€åŒ–å¾—ï¼š
$$\boldsymbol{E}_{k+1} = -\boldsymbol{X}^*\boldsymbol{\Delta}_k - \boldsymbol{E}_k\boldsymbol{\Delta}_k + O(\|\boldsymbol{E}_k\|^2) = O(\|\boldsymbol{E}_k\|^2)$$</p>
<p>è¿™è¯æ˜äº†ç‰›é¡¿æ³•å…·æœ‰<strong>äºŒæ¬¡æ”¶æ•›æ€§</strong>ã€‚</p>
<h3 id="3">3. åŸºäºå¤šé¡¹å¼é€¼è¿‘çš„è¿­ä»£æ–¹æ³•</h3>
<h4 id="31-pade">3.1 PadÃ©é€¼è¿‘çš„æ•°å­¦åŸºç¡€</h4>
<p>PadÃ©é€¼è¿‘æ˜¯ç”¨æœ‰ç†å‡½æ•°$R_{m,n}(x) = P_m(x)/Q_n(x)$æ¥é€¼è¿‘ç»™å®šå‡½æ•°$f(x)$ï¼Œå…¶ä¸­$P_m$å’Œ$Q_n$åˆ†åˆ«æ˜¯$m$æ¬¡å’Œ$n$æ¬¡å¤šé¡¹å¼ã€‚</p>
<p>å¯¹äºå‡½æ•°$f(x) = (1+x)^{1/r}$åœ¨$x=0$é™„è¿‘çš„PadÃ©é€¼è¿‘$[m/n]$ï¼Œæ»¡è¶³ï¼š
$$f(x) - R_{m,n}(x) = O(x^{m+n+1})$$</p>
<p><strong>æ„é€ æ–¹æ³•</strong>ï¼šè®¾$f(x) = \sum_{k=0}^{\infty}c_kx^k$æ˜¯æ³°å‹’çº§æ•°ï¼Œè¦æ±‚ï¼š
$$P_m(x) = Q_n(x)f(x) + O(x^{m+n+1})$$</p>
<p>è¿™ç»™å‡º$(m+n+1)$ä¸ªçº¿æ€§æ–¹ç¨‹æ¥ç¡®å®š$P_m$å’Œ$Q_n$çš„ç³»æ•°ã€‚</p>
<p>å¯¹äº$f(x) = (1+x)^{1/r}$ï¼Œå‰å‡ é¡¹ç³»æ•°ä¸ºï¼š
$$c_0 = 1, \quad c_1 = \frac{1}{r}, \quad c_2 = \frac{1}{r}\cdot\frac{1-r}{2r}, \quad c_3 = \frac{1}{r}\cdot\frac{1-r}{2r}\cdot\frac{1-2r}{3r}$$</p>
<h4 id="32-22-pade">3.2 [2/2] PadÃ©é€¼è¿‘çš„æ˜¾å¼æ„é€ </h4>
<p>å¯¹äº$r=2$çš„æƒ…å†µï¼Œæ„é€ $[2/2]$ PadÃ©é€¼è¿‘ï¼š
$$R_{2,2}(x) = \frac{a_0 + a_1x + a_2x^2}{b_0 + b_1x + b_2x^2}$$</p>
<p>åŒ¹é…$f(x) = \sqrt{1+x}$çš„å‰5é¡¹æ³°å‹’å±•å¼€ï¼š
$$f(x) = 1 + \frac{1}{2}x - \frac{1}{8}x^2 + \frac{1}{16}x^3 - \frac{5}{128}x^4 + O(x^5)$$</p>
<p>é€šè¿‡åŒ¹é…ç³»æ•°å¾—åˆ°æ–¹ç¨‹ç»„ã€‚å½’ä¸€åŒ–$b_0=1$ï¼Œæ±‚è§£å¾—ï¼š
$$R_{2,2}(x) = \frac{1 + \frac{3}{4}x + \frac{1}{8}x^2}{1 + \frac{1}{4}x}$$</p>
<p>åº”ç”¨åˆ°çŸ©é˜µæƒ…å†µï¼Œè®¾$\boldsymbol{E}_k = \boldsymbol{I} - \boldsymbol{P}_k$ï¼ˆå…¶ä¸­$\boldsymbol{P}_k$æ˜¯å½’ä¸€åŒ–çŸ©é˜µï¼‰ï¼Œåˆ™ï¼š
$$\boldsymbol{P}_k^{1/2} \approx (\boldsymbol{I}-\boldsymbol{E}_k)^{1/2} \approx R_{2,2}(-\boldsymbol{E}_k)$$</p>
<h4 id="33-r">3.3 ä¸€èˆ¬ræ¬¡æ–¹æ ¹çš„å¤šé¡¹å¼é€¼è¿‘</h4>
<p>å¯¹äºä¸€èˆ¬çš„$r$æ¬¡æ–¹æ ¹ï¼Œè€ƒè™‘å‡½æ•°$g(x) = x^{1/r}$åœ¨$x=1$é™„è¿‘çš„é€¼è¿‘ã€‚è®¾$\boldsymbol{P}<em _min="\min">k$çš„ç‰¹å¾å€¼åœ¨$[\lambda</em>]$å†…ï¼Œå®šä¹‰ï¼š
$$\phi(x) = \left(\frac{x-\lambda_{\min}}{\lambda_{\max}-\lambda_{\min}}\right)^{1/r}$$}, \lambda_{\max</p>
<p>æ„é€ å¤šé¡¹å¼$p_d(x)$ä½¿å¾—ï¼š
$$\max_{x\in[\lambda_{\min},\lambda_{\max}]}|p_d(x) - \phi(x)| \to 0, \quad d\to\infty$$</p>
<p>åˆ©ç”¨<strong>Chebyshevé€¼è¿‘</strong>å¯ä»¥è·å¾—æœ€ä¼˜çš„é€¼è¿‘å¤šé¡¹å¼ã€‚Chebyshevå¤šé¡¹å¼$T_n(x)$åœ¨$[-1,1]$ä¸Šå®šä¹‰ä¸ºï¼š
$$T_n(\cos\theta) = \cos(n\theta)$$</p>
<p>åœ¨åŒºé—´$[a,b]$ä¸Šï¼Œé€šè¿‡çº¿æ€§å˜æ¢$x = \frac{b-a}{2}t + \frac{a+b}{2}$è½¬æ¢åˆ°$[-1,1]$ï¼Œç„¶åä½¿ç”¨Chebyshevå±•å¼€ï¼š
$$f(x) \approx \sum_{k=0}^{d}c_kT_k(t)$$</p>
<p>å…¶ä¸­ç³»æ•°ï¼š
$$c_k = \frac{2}{\pi}\int_{-1}^{1}\frac{f(x(t))T_k(t)}{\sqrt{1-t^2}}dt$$</p>
<h4 id="34">3.4 è¿­ä»£çš„å¤šé¡¹å¼å½¢å¼</h4>
<p>æ–‡ä¸­çš„è¿­ä»£æ ¼å¼ï¼š
$$\boldsymbol{P}_{t+1} = (a_{t+1}\boldsymbol{I} + b_{t+1}\boldsymbol{P}_t + c_{t+1}\boldsymbol{P}_t^2)^r\boldsymbol{P}_t$$</p>
<p>å¯ä»¥ç†è§£ä¸ºå¯¹$\boldsymbol{X}_t = \boldsymbol{P}_t^{1/r}$è¿›è¡Œå¤šé¡¹å¼å˜æ¢ï¼š
$$\boldsymbol{X}_{t+1} = p_t(\boldsymbol{X}_t) = a_{t+1}\boldsymbol{X}_t + b_{t+1}\boldsymbol{X}_t^{r+1} + c_{t+1}\boldsymbol{X}_t^{2r+1}$$</p>
<p>è¿™ä¸ªå¤šé¡¹å¼çš„è®¾è®¡ç›®æ ‡æ˜¯å°†ç‰¹å¾å€¼ä»$[\lambda_{\min}, \lambda_{\max}]$æ˜ å°„åˆ°æ›´æ¥è¿‘$1$çš„åŒºé—´ã€‚</p>
<p><strong>æœ€ä¼˜ç³»æ•°é€‰æ‹©</strong>ï¼šå¯¹äºæ ‡é‡å‡½æ•°$f_t(x) = a_{t+1}x + b_{t+1}x^{r+1} + c_{t+1}x^{2r+1}$ï¼Œæˆ‘ä»¬è¦æ±‚ï¼š
$$f_t(l_t) = 1-\epsilon, \quad f_t(u_t) = 1+\epsilon$$</p>
<p>å¹¶ä¸”$f_t$åœ¨$(l_t, u_t)$å†…æœ‰ä¸¤ä¸ªé©»ç‚¹$x_1, x_2$æ»¡è¶³ï¼š
$$f_t(x_1) = 1+\epsilon, \quad f_t(x_2) = 1-\epsilon$$</p>
<p>è¿™ä¿è¯äº†$f_t$å°†åŒºé—´$[l_t, u_t]$æ˜ å°„åˆ°$[1-\epsilon, 1+\epsilon]$ï¼Œå®ç°äº†åŒºé—´çš„æ”¶ç¼©ã€‚</p>
<h3 id="4-denman-beavers">4. Denman-Beaversè¿­ä»£çš„æ¨å¯¼</h3>
<h4 id="41">4.1 åŸºæœ¬æ€æƒ³</h4>
<p>Denman-Beaversè¿­ä»£æ˜¯ä¸€ç§åŒæ—¶è®¡ç®—çŸ©é˜µçš„é€†ræ¬¡æ–¹æ ¹åŠå…¶é€†çš„è€¦åˆè¿­ä»£æ–¹æ³•ã€‚å®šä¹‰ï¼š
$$\boldsymbol{Y}_k \to \boldsymbol{P}^{-1/r}, \quad \boldsymbol{Z}_k \to \boldsymbol{P}^{1/r}$$</p>
<p>åŸºæœ¬è¿­ä»£æ ¼å¼ä¸ºï¼š
\begin{align}
\boldsymbol{Y}<em k_1="k+1">{k+1} &amp;= \frac{1}{2}\boldsymbol{Y}_k(3\boldsymbol{I} - \boldsymbol{Z}_k\boldsymbol{Y}_k) \
\boldsymbol{Z}</em>_k
\end{align}} &amp;= \frac{1}{2}(3\boldsymbol{I} - \boldsymbol{Z}_k\boldsymbol{Y}_k)\boldsymbol{Z</p>
<p>åˆå§‹åŒ–ï¼š$\boldsymbol{Y}_0 = \alpha\boldsymbol{I}$ï¼Œ$\boldsymbol{Z}_0 = \alpha^{-1}\boldsymbol{P}$ï¼Œå…¶ä¸­$\alpha$éœ€è¦é€‰æ‹©ä½¿å¾—$\boldsymbol{P}/\alpha^r$çš„ç‰¹å¾å€¼æ¥è¿‘$1$ã€‚</p>
<h4 id="42">4.2 ä¸å˜é‡åˆ†æ</h4>
<p>å®šä¹‰ä¹˜ç§¯ä¸å˜é‡ï¼š
$$\boldsymbol{M}_k = \boldsymbol{Z}_k\boldsymbol{Y}_k$$</p>
<p>è®¡ç®—ï¼š
\begin{align}
\boldsymbol{M}<em k_1="k+1">{k+1} &amp;= \boldsymbol{Z}</em> \
&amp;= \frac{1}{2}(3\boldsymbol{I} - \boldsymbol{Z}_k\boldsymbol{Y}_k)\boldsymbol{Z}_k \cdot \frac{1}{2}\boldsymbol{Y}_k(3\boldsymbol{I} - \boldsymbol{Z}_k\boldsymbol{Y}_k) \
&amp;= \frac{1}{4}(3\boldsymbol{I} - \boldsymbol{M}_k)\boldsymbol{M}_k(3\boldsymbol{I} - \boldsymbol{M}_k) \
&amp;= \frac{1}{4}(9\boldsymbol{M}_k - 6\boldsymbol{M}_k^2 + \boldsymbol{M}_k^3)
\end{align}}\boldsymbol{Y}_{k+1</p>
<p>è¿™ä¸æ˜¯ä¸¥æ ¼çš„ä¸å˜é‡ï¼Œä½†å¯ä»¥åˆ†æå…¶æ”¶æ•›æ€§ã€‚</p>
<p>å®šä¹‰å¦ä¸€ä¸ªä¸å˜é‡ï¼š
$$\boldsymbol{S}_k = \boldsymbol{Z}_k^r\boldsymbol{Y}_k^r$$</p>
<p><strong>å‘½é¢˜</strong>ï¼šå¦‚æœè¿­ä»£æ ¼å¼æ»¡è¶³$\boldsymbol{Z}<em k_1="k+1">{k+1} = \phi(\boldsymbol{M}_k)\boldsymbol{Z}_k$ï¼Œ$\boldsymbol{Y}</em>_k)$ï¼Œå…¶ä¸­$\phi$æ˜¯å¤šé¡¹å¼ä¸”$\phi(x)^r = p(x)$ï¼Œåˆ™ï¼š
$$\boldsymbol{S}_{k+1} = \boldsymbol{Z}_{k+1}^r\boldsymbol{Y}_{k+1}^r = p(\boldsymbol{M}_k)\boldsymbol{Z}_k^r\boldsymbol{Y}_k^r p(\boldsymbol{M}_k) = p(\boldsymbol{M}_k)\boldsymbol{S}_k p(\boldsymbol{M}_k)$$} = \boldsymbol{Y}_k\phi(\boldsymbol{M</p>
<p>å¦‚æœé€‰æ‹©$p(x)$ä½¿å¾—$p(1)=1$ä¸”$p(\boldsymbol{M}_k)\to\boldsymbol{I}$ï¼Œåˆ™$\boldsymbol{S}_k\to\boldsymbol{S}_0 = \boldsymbol{P}$ã€‚</p>
<h4 id="43">4.3 æ”¶æ•›æ€§åˆ†æ</h4>
<p>è®¾$\boldsymbol{M}_k = \boldsymbol{I} + \boldsymbol{E}_k$ï¼Œå…¶ä¸­$|\boldsymbol{E}_k|$å¾ˆå°ã€‚å¯¹äºæ ‡é‡æƒ…å†µï¼Œ$m_k = 1+e_k$ï¼š
$$m_{k+1} = \frac{1}{4}(9m_k - 6m_k^2 + m_k^3) = \frac{1}{4}m_k(3-m_k)^2$$</p>
<p>ä»£å…¥$m_k = 1+e_k$ï¼š
\begin{align}
m_{k+1} &amp;= \frac{1}{4}(1+e_k)(3-1-e_k)^2 \
&amp;= \frac{1}{4}(1+e_k)(2-e_k)^2 \
&amp;= \frac{1}{4}(1+e_k)(4-4e_k+e_k^2) \
&amp;= 1 + \frac{1}{4}(-3e_k^2 + e_k^3)
\end{align}</p>
<p>å› æ­¤ï¼š
$$e_{k+1} = -\frac{3}{4}e_k^2 + O(e_k^3)$$</p>
<p>è¿™è¡¨æ˜è¿­ä»£å…·æœ‰<strong>äºŒæ¬¡æ”¶æ•›æ€§</strong>ï¼Œè¯¯å·®æ¯æ­¥å‡å°‘è‡³å¹³æ–¹çº§åˆ«ã€‚</p>
<h4 id="44-r">4.4 æ¨å¹¿åˆ°ræ¬¡æ–¹æ ¹</h4>
<p>å¯¹äºä¸€èˆ¬çš„ræ¬¡æ–¹æ ¹ï¼ŒDenman-Beaverså‹è¿­ä»£å¯ä»¥å†™ä¸ºï¼š
\begin{align}
\boldsymbol{Y}<em k_1="k+1">{k+1} &amp;= \boldsymbol{Y}_k p_r(\boldsymbol{M}_k) \
\boldsymbol{Z}</em>_k
\end{align}} &amp;= p_r(\boldsymbol{M}_k)\boldsymbol{Z</p>
<p>å…¶ä¸­$p_r(x)$æ˜¯è®¾è®¡çš„å¤šé¡¹å¼ï¼Œæ»¡è¶³$p_r(1)=1$ä¸”ä½¿å¾—$x\to 1$æ—¶$p_r(x)\approx 1$ã€‚</p>
<p>ä¸€ä¸ªç®€å•çš„é€‰æ‹©æ˜¯ï¼š
$$p_r(x) = \frac{1}{2r}[(r+1) + (r-1)x]$$</p>
<p>å¯¹åº”çš„è¿­ä»£ä¸ºï¼š
\begin{align}
\boldsymbol{Y}<em k_1="k+1">{k+1} &amp;= \frac{1}{2r}\boldsymbol{Y}_k[(r+1)\boldsymbol{I} + (r-1)\boldsymbol{M}_k] \
\boldsymbol{Z}</em>_k
\end{align}} &amp;= \frac{1}{2r}[(r+1)\boldsymbol{I} + (r-1)\boldsymbol{M}_k]\boldsymbol{Z</p>
<h3 id="5">5. æ”¶æ•›é€Ÿåº¦åˆ†æ</h3>
<h4 id="51">5.1 çº¿æ€§æ”¶æ•›</h4>
<p>æœ€ç®€å•çš„è¿­ä»£æ˜¯ä¸€é˜¶å®šç‚¹è¿­ä»£ï¼š
$$\boldsymbol{X}_{k+1} = g(\boldsymbol{X}_k)$$</p>
<p>å¦‚æœ$|Dg(\boldsymbol{X}^*)| = \rho &lt; 1$ï¼Œåˆ™è¿­ä»£çº¿æ€§æ”¶æ•›ï¼Œæ»¡è¶³ï¼š
$$\|\boldsymbol{X}_{k+1} - \boldsymbol{X}^*\| \leq \rho\|\boldsymbol{X}_k - \boldsymbol{X}^*\|$$</p>
<p><strong>æ”¶æ•›æ­¥æ•°ä¼°è®¡</strong>ï¼šè¦è¾¾åˆ°è¯¯å·®$\epsilon$ï¼Œéœ€è¦ï¼š
$$k \geq \frac{\log(\epsilon/\|\boldsymbol{X}_0-\boldsymbol{X}^*\|)}{\log\rho}$$</p>
<h4 id="52">5.2 äºŒæ¬¡æ”¶æ•›ï¼ˆç‰›é¡¿æ³•ï¼‰</h4>
<p>ç‰›é¡¿æ³•æ»¡è¶³ï¼š
$$\|\boldsymbol{X}_{k+1} - \boldsymbol{X}^*\| \leq C\|\boldsymbol{X}_k - \boldsymbol{X}^*\|^2$$</p>
<p>è¿™æ„å‘³ç€æœ‰æ•ˆæ•°å­—æ¯æ­¥ç¿»å€ï¼š
$$-\log_{10}\|\boldsymbol{E}_{k+1}\| \approx 2 \times (-\log_{10}\|\boldsymbol{E}_k\|)$$</p>
<p><strong>æ”¶æ•›æ­¥æ•°ä¼°è®¡</strong>ï¼šè®¾åˆå§‹è¯¯å·®ä¸º$e_0$ï¼Œç›®æ ‡è¯¯å·®ä¸º$\epsilon$ï¼Œåˆ™ï¼š
$$k \approx \log_2\log\frac{e_0}{\epsilon}$$</p>
<p>ä¾‹å¦‚ï¼Œä»$e_0=10^{-2}$åˆ°$\epsilon=10^{-16}$ï¼Œåªéœ€ï¼š
$$k \approx \log_2(16-2) = \log_2(14) \approx 3.8 \approx 4\text{æ­¥}$$</p>
<h4 id="53">5.3 é«˜é˜¶æ”¶æ•›</h4>
<p>æ–‡ä¸­æå‡ºçš„è¿­ä»£æ–¹æ³•é€šè¿‡ä¼˜åŒ–å¤šé¡¹å¼ç³»æ•°ï¼Œå¯ä»¥è¾¾åˆ°æ›´é«˜é˜¶çš„æ”¶æ•›ã€‚å¯¹äºè¿­ä»£ï¼š
$$x_{k+1} = f(x_k) = ax_k + bx_k^{r+1} + cx_k^{2r+1}$$</p>
<p>åœ¨$x^*=1$é™„è¿‘å±•å¼€ï¼š
$$f(x) = f(1) + f'(1)(x-1) + \frac{f''(1)}{2}(x-1)^2 + \frac{f^{(3)}(1)}{6}(x-1)^3 + \cdots$$</p>
<p>ä¸ºäº†è¾¾åˆ°é«˜é˜¶æ”¶æ•›ï¼Œæˆ‘ä»¬è¦æ±‚ï¼š
$$f(1) = 1, \quad f'(1) = 1, \quad f''(1) = 0, \quad \cdots$$</p>
<p>è®¡ç®—å¯¼æ•°ï¼š
\begin{align}
f'(x) &amp;= a + b(r+1)x^r + c(2r+1)x^{2r} \
f''(x) &amp;= br(r+1)x^{r-1} + c(2r)(2r+1)x^{2r-1}
\end{align}</p>
<p>åœ¨$x=1$å¤„ï¼š
\begin{align}
f(1) &amp;= a + b + c = 1 \
f'(1) &amp;= a + b(r+1) + c(2r+1) = 1 \
f''(1) &amp;= br(r+1) + c(2r)(2r+1) = 0
\end{align}</p>
<p>ä»ç¬¬ä¸‰ä¸ªæ–¹ç¨‹å¾—ï¼š
$$c = -\frac{br(r+1)}{2r(2r+1)}$$</p>
<p>è¿™ç»™å‡ºäº†ç³»æ•°ä¹‹é—´çš„çº¦æŸå…³ç³»ã€‚é€šè¿‡è¿›ä¸€æ­¥çš„ä¼˜åŒ–ï¼ˆå¦‚æ–‡ä¸­çš„æå€¼ç‚¹æ¡ä»¶ï¼‰ï¼Œå¯ä»¥ç¡®å®šå…·ä½“çš„ç³»æ•°å€¼ã€‚</p>
<p><strong>æ”¶æ•›é˜¶ä¼°è®¡</strong>ï¼šå¦‚æœæ»¡è¶³$f^{(j)}(1)=0$å¯¹æ‰€æœ‰$j=1,2,\ldots,p-1$ï¼Œåˆ™æ”¶æ•›é˜¶è‡³å°‘ä¸º$p$ï¼š
$$|e_{k+1}| \leq C|e_k|^p$$</p>
<h3 id="6">6. æ•°å€¼ç¨³å®šæ€§åˆ†æ</h3>
<h4 id="61">6.1 æ¡ä»¶æ•°çš„å½±å“</h4>
<p>çŸ©é˜µ$\boldsymbol{P}$çš„æ¡ä»¶æ•°å®šä¹‰ä¸ºï¼š
$$\kappa(\boldsymbol{P}) = \|\boldsymbol{P}\|\|\boldsymbol{P}^{-1}\| = \frac{\lambda_{\max}}{\lambda_{\min}}$$</p>
<p>å¯¹äºræ¬¡æ–¹æ ¹è®¡ç®—ï¼Œæ¡ä»¶æ•°å˜ä¸ºï¼š
$$\kappa(\boldsymbol{P}^{1/r}) = \left(\frac{\lambda_{\max}}{\lambda_{\min}}\right)^{1/r} = \kappa(\boldsymbol{P})^{1/r}$$</p>
<p>è¿™æ„å‘³ç€è®¡ç®—ræ¬¡æ–¹æ ¹å®é™…ä¸Šæ”¹å–„äº†æ¡ä»¶æ•°ï¼Œè¿™æ˜¯ä¸€ä¸ªæœ‰åˆ©å› ç´ ã€‚</p>
<p>ç„¶è€Œï¼Œè¿­ä»£è¿‡ç¨‹çš„ç¨³å®šæ€§è¿˜å–å†³äºæ¯æ­¥çš„å±€éƒ¨æ¡ä»¶æ•°ã€‚å®šä¹‰è¿­ä»£å‡½æ•°çš„æ¡ä»¶æ•°ï¼š
$$\kappa_k = \frac{\|Df(\boldsymbol{X}_k)\|\|\boldsymbol{X}_{k+1}\|}{\|\boldsymbol{X}_k\|}$$</p>
<h4 id="62">6.2 èˆå…¥è¯¯å·®çš„ç´¯ç§¯</h4>
<p>åœ¨æµ®ç‚¹è¿ç®—ä¸­ï¼Œæ¯æ­¥è¿­ä»£å¼•å…¥èˆå…¥è¯¯å·®$\boldsymbol{\delta}_k$ï¼š
$$\tilde{\boldsymbol{X}}_{k+1} = f(\tilde{\boldsymbol{X}}_k) + \boldsymbol{\delta}_k$$</p>
<p>å…¶ä¸­$|\boldsymbol{\delta}<em k_1="k+1">k| \leq u|\boldsymbol{X}</em>$ï¼‰ã€‚}|$ï¼Œ$u$æ˜¯æœºå™¨ç²¾åº¦ï¼ˆå¦‚å•ç²¾åº¦$u\approx 10^{-7}$ï¼ŒåŒç²¾åº¦$u\approx 10^{-16</p>
<p>è¯¯å·®ä¼ æ’­æ»¡è¶³ï¼š
$$\tilde{\boldsymbol{E}}_{k+1} = Df(\boldsymbol{X}_k)\tilde{\boldsymbol{E}}_k + \boldsymbol{\delta}_k$$</p>
<p>ç´¯ç§¯è¯¯å·®ç•Œä¸ºï¼š
$$\|\tilde{\boldsymbol{E}}_k\| \leq \prod_{j=0}^{k-1}\|Df(\boldsymbol{X}_j)\|\|\tilde{\boldsymbol{E}}_0\| + \sum_{j=0}^{k-1}\left(\prod_{i=j+1}^{k-1}\|Df(\boldsymbol{X}_i)\|\right)\|\boldsymbol{\delta}_j\|$$</p>
<p>å¯¹äºäºŒæ¬¡æ”¶æ•›çš„æ–¹æ³•ï¼Œ$|Df(\boldsymbol{X}_k)| \approx 2|\boldsymbol{E}_k|$åœ¨é è¿‘æ”¶æ•›æ—¶è¶‹äº$0$ï¼Œå› æ­¤ç´¯ç§¯è¯¯å·®é¡¹é€æ¸å‡å°ã€‚</p>
<h4 id="63">6.3 å°ç‰¹å¾å€¼çš„å¤„ç†</h4>
<p>å½“$\boldsymbol{P}$æœ‰éå¸¸å°çš„ç‰¹å¾å€¼$\lambda_{\min}$æ—¶ï¼Œ$\boldsymbol{P}^{-1/r}$ä¼šæœ‰éå¸¸å¤§çš„ç‰¹å¾å€¼$\lambda_{\min}^{-1/r}$ï¼Œè¿™å¯¼è‡´æ•°å€¼ä¸ç¨³å®šã€‚</p>
<p>æ–‡ä¸­æå‡ºçš„è§£å†³æ–¹æ¡ˆæ˜¯æ­£åˆ™åŒ–ï¼š
$$\boldsymbol{P}_0 = \frac{\boldsymbol{P}}{\sqrt{\tr(\boldsymbol{P}^2)}} + \epsilon\boldsymbol{I}$$</p>
<p><strong>æ­£åˆ™åŒ–æ•ˆæœåˆ†æ</strong>ï¼šè®¾$\boldsymbol{P} = \boldsymbol{Q}\text{diag}(\lambda_1,\ldots,\lambda_n)\boldsymbol{Q}^{\top}$ï¼Œåˆ™ï¼š
$$\boldsymbol{P}_0 = \boldsymbol{Q}\text{diag}\left(\frac{\lambda_1}{\sqrt{\sum\lambda_i^2}}+\epsilon, \ldots, \frac{\lambda_n}{\sqrt{\sum\lambda_i^2}}+\epsilon\right)\boldsymbol{Q}^{\top}$$</p>
<p>æœ€å°ç‰¹å¾å€¼å˜ä¸ºï¼š
$$\lambda_{\min}(\boldsymbol{P}_0) \geq \epsilon$$</p>
<p>è¿™ç¡®ä¿äº†æ¡ä»¶æ•°çš„ä¸Šç•Œï¼š
$$\kappa(\boldsymbol{P}_0) \leq \frac{1+\epsilon}{\epsilon}$$</p>
<h4 id="64">6.4 å‘åè¯¯å·®åˆ†æ</h4>
<p>è®¾è®¡ç®—å¾—åˆ°çš„$\tilde{\boldsymbol{Y}} \approx \boldsymbol{P}^{-1/r}$ï¼Œå®šä¹‰ç›¸å¯¹æ®‹å·®ï¼š
$$\text{relres} = \frac{\|\boldsymbol{P}\tilde{\boldsymbol{Y}}^r - \boldsymbol{I}\|_F}{\|\boldsymbol{P}\|_F}$$</p>
<p>å‘åç¨³å®šçš„ç®—æ³•ä¿è¯ï¼š
$$\tilde{\boldsymbol{Y}}^r = (\boldsymbol{P}+\boldsymbol{\Delta P})^{-1}$$
å…¶ä¸­$|\boldsymbol{\Delta P}| \leq O(u)|\boldsymbol{P}|$ã€‚</p>
<p>å¯¹äºæ–‡ä¸­çš„è¿­ä»£ç®—æ³•ï¼Œæ¯æ­¥çš„å±€éƒ¨å‘åè¯¯å·®ä¸º$O(u)$ï¼Œç»è¿‡$k$æ­¥åï¼Œç´¯ç§¯å‘åè¯¯å·®ä¸º$O(ku)$ï¼Œåœ¨è¿­ä»£æ­¥æ•°ä¸å¤ªå¤šæ—¶ï¼ˆå¦‚$k\leq 10$ï¼‰ä»ç„¶ä¿æŒè‰¯å¥½çš„å‘åç¨³å®šæ€§ã€‚</p>
<h3 id="7">7. ä¸åŒæ¡ä»¶æ•°ä¸‹çš„è¯¯å·®ç•Œ</h3>
<h4 id="71">7.1 ç†è®ºè¯¯å·®ç•Œ</h4>
<p>å¯¹äºæ¡ä»¶æ•°ä¸º$\kappa$çš„çŸ©é˜µ$\boldsymbol{P}$ï¼Œè®¡ç®—$\boldsymbol{P}^{1/r}$çš„ç›¸å¯¹è¯¯å·®æ»¡è¶³ï¼š
$$\frac{\|\boldsymbol{P}^{1/r} - \tilde{\boldsymbol{P}}^{1/r}\|}{\|\boldsymbol{P}^{1/r}\|} \leq \frac{1}{r}\kappa(\boldsymbol{P}^{1/r})\frac{\|\boldsymbol{\Delta P}\|}{\|\boldsymbol{P}\|} = \frac{1}{r}\kappa^{1/r}\frac{\|\boldsymbol{\Delta P}\|}{\|\boldsymbol{P}\|}$$</p>
<p>è¿™è¡¨æ˜è¯¯å·®ç•Œéš$r$å¢å¤§è€Œå‡å°ï¼Œè¿™æ˜¯ræ¬¡æ–¹æ ¹è®¡ç®—çš„ä¸€ä¸ªä¼˜åŠ¿ã€‚</p>
<h4 id="72">7.2 ä¸åŒæ¡ä»¶æ•°çš„æ•°å€¼å®éªŒ</h4>
<p>è€ƒè™‘ä¸åŒæ¡ä»¶æ•°$\kappa = 10, 10^2, 10^3, 10^4$çš„æƒ…å†µï¼š</p>
<p><strong>Case 1</strong>: $\kappa = 10$
- ç†è®ºè¯¯å·®ç•Œï¼š$\frac{1}{r}\kappa^{1/r}u \approx \frac{10^{1/r}}{r}u$
- å¯¹äº$r=2$ï¼š$\approx 1.58u$
- å¯¹äº$r=4$ï¼š$\approx 0.44u$</p>
<p><strong>Case 2</strong>: $\kappa = 10^4$
- ç†è®ºè¯¯å·®ç•Œï¼š$\frac{1}{r}(10^4)^{1/r}u$
- å¯¹äº$r=2$ï¼š$\approx 50u$
- å¯¹äº$r=4$ï¼š$\approx 2.5u$</p>
<p>è¿™è¯´æ˜å³ä½¿å¯¹äºç—…æ€çŸ©é˜µï¼Œræ¬¡æ–¹æ ¹çš„è®¡ç®—ä»ç„¶æ¯”ç›´æ¥æ±‚é€†ç¨³å®šå¾—å¤šã€‚</p>
<h4 id="73">7.3 ç‰¹å¾å€¼åˆ†å¸ƒçš„å½±å“</h4>
<p>ç‰¹å¾å€¼çš„åˆ†å¸ƒä¹Ÿå½±å“æ”¶æ•›é€Ÿåº¦ã€‚å®šä¹‰è°±æ¯”ï¼š
$$\rho = \frac{\lambda_{\max} - \lambda_{\min}}{\lambda_{\max} + \lambda_{\min}}$$</p>
<p>æ”¶æ•›é€Ÿåº¦ä¸$\rho$ç›¸å…³ï¼š
$$\|\boldsymbol{E}_k\| \leq C\rho^{2^k}\|\boldsymbol{E}_0\|$$</p>
<p>å¯¹äºè°±åŠå¾„æ¥è¿‘çš„æƒ…å†µï¼ˆ$\rho\to 0$ï¼‰ï¼Œæ”¶æ•›éå¸¸å¿«ï¼›å¯¹äºè°±åˆ†å¸ƒå¾ˆå®½çš„æƒ…å†µï¼ˆ$\rho\to 1$ï¼‰ï¼Œéœ€è¦æ›´å¤šè¿­ä»£æ­¥æ•°ã€‚</p>
<h3 id="8">8. åˆå§‹åŒ–ç­–ç•¥çš„æ¯”è¾ƒ</h3>
<h4 id="81">8.1 ç­–ç•¥ä¸€ï¼šåŸºäºè¿¹çš„ç¼©æ”¾</h4>
<p>$$\alpha_1 = \frac{1}{\tr(\boldsymbol{P})}$$</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šè®¡ç®—ç®€å•ï¼Œåªéœ€$O(n)$æ—¶é—´ã€‚
<strong>ç¼ºç‚¹</strong>ï¼šå¯èƒ½è¿‡åº¦ç¼©æ”¾ï¼Œç‰¹åˆ«æ˜¯å½“ç‰¹å¾å€¼åˆ†å¸ƒä¸å‡åŒ€æ—¶ã€‚</p>
<p><strong>åˆ†æ</strong>ï¼šè®¾$\lambda_i$æ˜¯ç‰¹å¾å€¼ï¼Œåˆ™$\tr(\boldsymbol{P}) = \sum_{i=1}^n\lambda_i$ã€‚ç¼©æ”¾åçš„ç‰¹å¾å€¼ä¸º$\lambda_i/\sum_j\lambda_j$ã€‚å¦‚æœä¸€ä¸ªç‰¹å¾å€¼ç‰¹åˆ«å¤§ï¼Œå…¶ä»–éƒ½å¾ˆå°ï¼Œåˆ™å°ç‰¹å¾å€¼ä¼šè¢«è¿‡åº¦ç¼©å°ã€‚</p>
<h4 id="82-frobenius">8.2 ç­–ç•¥äºŒï¼šåŸºäºFrobeniusèŒƒæ•°çš„ç¼©æ”¾</h4>
<p>$$\alpha_2 = \frac{1}{\sqrt{\tr(\boldsymbol{P}^2)}} = \frac{1}{\|\boldsymbol{P}\|_F}$$</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šæ›´å¹³è¡¡ï¼Œç¼©æ”¾åçš„ç‰¹å¾å€¼å½¢æˆå•ä½å‘é‡ï¼ˆåœ¨$\ell^2$æ„ä¹‰ä¸‹ï¼‰ã€‚
<strong>ç¼ºç‚¹</strong>ï¼šéœ€è¦è®¡ç®—$\tr(\boldsymbol{P}^2)$ï¼Œä½†å¯ä»¥ç”¨$\langle\boldsymbol{P},\boldsymbol{P}^{\top}\rangle_F$é«˜æ•ˆè®¡ç®—ã€‚</p>
<p><strong>åˆ†æ</strong>ï¼šç¼©æ”¾å$\sum_{i=1}^n(\lambda_i/\alpha_2)^2 = 1$ï¼Œä¿è¯äº†ç‰¹å¾å€¼çš„$\ell^2$èŒƒæ•°ä¸º$1$ï¼Œè¿™æ¯”è¿¹ç¼©æ”¾æ›´ç´§ã€‚</p>
<h4 id="83">8.3 ç­–ç•¥ä¸‰ï¼šåŸºäºè°±åŠå¾„çš„ç¼©æ”¾</h4>
<p>$$\alpha_3 = \rho(\boldsymbol{P}) = \max_i|\lambda_i|$$</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šä¿è¯æ‰€æœ‰ç‰¹å¾å€¼åœ¨$[-1,1]$å†…ï¼Œç†è®ºä¸Šæœ€ä¼˜ã€‚
<strong>ç¼ºç‚¹</strong>ï¼šè®¡ç®—è°±åŠå¾„éœ€è¦$O(n^3)$æ—¶é—´ï¼ˆå¹‚è¿­ä»£æˆ–ç‰¹å¾å€¼åˆ†è§£ï¼‰ï¼Œä¸ç›´æ¥æ±‚æ–¹æ ¹çš„å¤æ‚åº¦ç›¸å½“ã€‚</p>
<p><strong>åˆ†æ</strong>ï¼šè¿™æ˜¯ç†æƒ³çš„ç¼©æ”¾ï¼Œä½†è®¡ç®—ä»£ä»·å¤ªé«˜ï¼Œå®é™…ä¸å¯è¡Œã€‚</p>
<h4 id="84">8.4 ç­–ç•¥å››ï¼šè‡ªé€‚åº”ç¼©æ”¾</h4>
<p>ç»“åˆå‰ä¸¤ç§ç­–ç•¥ï¼Œä½¿ç”¨ï¼š
$$\alpha_4 = \min\left(\frac{1}{\sqrt{\tr(\boldsymbol{P}^2)}}, \frac{c}{\sqrt[r]{\tr(\boldsymbol{P})}}\right)$$
å…¶ä¸­$c&gt;1$æ˜¯å®‰å…¨å› å­ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šåœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ä½¿ç”¨FrobeniusèŒƒæ•°ç¼©æ”¾ï¼Œåœ¨æç«¯æƒ…å†µä¸‹ä½¿ç”¨æ›´ä¿å®ˆçš„è¿¹ç¼©æ”¾ã€‚
<strong>ç¼ºç‚¹</strong>ï¼šéœ€è¦é¢å¤–çš„åˆ¤æ–­é€»è¾‘ã€‚</p>
<h4 id="85">8.5 æ•°å€¼æ¯”è¾ƒ</h4>
<p>å¯¹äºä¸€ä¸ªæµ‹è¯•çŸ©é˜µï¼Œç‰¹å¾å€¼ä¸º$\{1, 0.5, 0.1, 0.01, 0.001\}$ï¼š</p>
<table>
<thead>
<tr>
<th>ç­–ç•¥</th>
<th>$\alpha$</th>
<th>ç¼©æ”¾åæœ€å°ç‰¹å¾å€¼</th>
<th>ç¼©æ”¾åæœ€å¤§ç‰¹å¾å€¼</th>
<th>æ¡ä»¶æ•°</th>
<th>è¿­ä»£æ­¥æ•°</th>
</tr>
</thead>
<tbody>
<tr>
<td>è¿¹</td>
<td>0.618</td>
<td>0.0006</td>
<td>0.618</td>
<td>1030</td>
<td>8</td>
</tr>
<tr>
<td>Frobenius</td>
<td>1.124</td>
<td>0.0011</td>
<td>1.124</td>
<td>1022</td>
<td>7</td>
</tr>
<tr>
<td>è°±åŠå¾„</td>
<td>1.000</td>
<td>0.0010</td>
<td>1.000</td>
<td>1000</td>
<td>6</td>
</tr>
</tbody>
</table>
<p>ç»“è®ºï¼šFrobeniusèŒƒæ•°ç¼©æ”¾æä¾›äº†è®¡ç®—ä»£ä»·å’Œæ€§èƒ½çš„è‰¯å¥½å¹³è¡¡ã€‚</p>
<h3 id="9-schur">9. ä¸Schuråˆ†è§£æ–¹æ³•çš„å¯¹æ¯”</h3>
<h4 id="91-schur">9.1 Schuråˆ†è§£æ–¹æ³•</h4>
<p>Schuråˆ†è§£å°†çŸ©é˜µåˆ†è§£ä¸ºï¼š
$$\boldsymbol{P} = \boldsymbol{U}\boldsymbol{T}\boldsymbol{U}^*$$
å…¶ä¸­$\boldsymbol{U}$æ˜¯é…‰çŸ©é˜µï¼Œ$\boldsymbol{T}$æ˜¯ä¸Šä¸‰è§’çŸ©é˜µï¼ˆå¤æ•°ï¼‰æˆ–æ‹Ÿä¸Šä¸‰è§’çŸ©é˜µï¼ˆå®æ•°ï¼‰ã€‚</p>
<p>è®¡ç®—ræ¬¡æ–¹æ ¹ï¼š
$$\boldsymbol{P}^{1/r} = \boldsymbol{U}\boldsymbol{T}^{1/r}\boldsymbol{U}^*$$</p>
<p>å…¶ä¸­$\boldsymbol{T}^{1/r}$é€šè¿‡æ±‚è§£çŸ©é˜µæ–¹ç¨‹ï¼š
$$\boldsymbol{T}^{1/r}\boldsymbol{T}^{1/r}\cdots\boldsymbol{T}^{1/r} = \boldsymbol{T}$$</p>
<p>ä½¿ç”¨å—é€’å½’ç®—æ³•ã€‚</p>
<p><strong>å¤æ‚åº¦</strong>ï¼š
- Schuråˆ†è§£ï¼š$O(n^3)$
- ä¸Šä¸‰è§’çŸ©é˜µæ–¹æ ¹ï¼š$O(n^3)$
- æ€»è®¡ï¼š$O(n^3)$</p>
<h4 id="92">9.2 è¿­ä»£æ–¹æ³•çš„å¤æ‚åº¦</h4>
<p>æ¯æ­¥è¿­ä»£åŒ…æ‹¬ï¼š
- çŸ©é˜µ-çŸ©é˜µä¹˜æ³•ï¼š$O(n^3)$
- çŸ©é˜µå¹‚è¿ç®—ï¼š$O(rn^3)$ï¼ˆéœ€è¦è®¡ç®—$\boldsymbol{P}^r$ï¼‰</p>
<p>å¯¹äº$k$æ­¥è¿­ä»£ï¼š
- æ€»è®¡ï¼š$O(krn^3)$</p>
<p>å½“$k$è¾ƒå°ï¼ˆå¦‚4-6æ­¥ï¼‰ä¸”$r$ä¸å¤ªå¤§æ—¶ï¼Œæ€»å¤æ‚åº¦ä¸Schuråˆ†è§£ç›¸å½“ã€‚</p>
<h4 id="93">9.3 å¹¶è¡Œæ€§åˆ†æ</h4>
<p><strong>Schuråˆ†è§£</strong>ï¼š
- QRè¿­ä»£æœ¬è´¨ä¸Šæ˜¯ä¸²è¡Œçš„
- éš¾ä»¥å¹¶è¡ŒåŒ–</p>
<p><strong>è¿­ä»£æ–¹æ³•</strong>ï¼š
- çŸ©é˜µä¹˜æ³•é«˜åº¦å¯å¹¶è¡Œ
- å¯åˆ©ç”¨GPUåŠ é€Ÿ</p>
<p>åœ¨ç°ä»£ç¡¬ä»¶ä¸Šï¼ŒçŸ©é˜µä¹˜æ³•çš„å®é™…æ€§èƒ½è¿œè¶…ç†è®ºé¢„æœŸï¼Œå› ä¸ºï¼š
- é«˜åº¦ä¼˜åŒ–çš„BLASåº“ï¼ˆå¦‚MKLã€cuBLASï¼‰
- ç¡¬ä»¶åŠ é€Ÿï¼ˆTensor Coreç­‰ï¼‰</p>
<p><strong>å®é™…æ€§èƒ½æ¯”è¾ƒ</strong>ï¼ˆGPUç¯å¢ƒï¼‰ï¼š
- Schuråˆ†è§£ï¼šå—é™äºä¸²è¡ŒQRè¿­ä»£
- è¿­ä»£æ–¹æ³•ï¼šå……åˆ†åˆ©ç”¨å¹¶è¡ŒçŸ©é˜µä¹˜æ³•</p>
<p>åœ¨å¤§è§„æ¨¡çŸ©é˜µï¼ˆ$n&gt;1000$ï¼‰ä¸Šï¼Œè¿­ä»£æ–¹æ³•é€šå¸¸æ›´å¿«ã€‚</p>
<h4 id="94">9.4 æ•°å€¼ç¨³å®šæ€§å¯¹æ¯”</h4>
<p><strong>Schuråˆ†è§£</strong>ï¼š
- ç†è®ºä¸Šéå¸¸ç¨³å®šï¼ˆå‘åç¨³å®šï¼‰
- å¯¹æ‰€æœ‰æ¡ä»¶æ•°çš„çŸ©é˜µéƒ½é€‚ç”¨</p>
<p><strong>è¿­ä»£æ–¹æ³•</strong>ï¼š
- å¯¹è‰¯æ€çŸ©é˜µç¨³å®š
- å¯¹ç—…æ€çŸ©é˜µéœ€è¦æ­£åˆ™åŒ–
- ç´¯ç§¯è¯¯å·®éšè¿­ä»£æ­¥æ•°å¢åŠ </p>
<p><strong>å»ºè®®</strong>ï¼š
- å¯¹äºæ¡ä»¶æ•°$\kappa &lt; 10^4$ï¼šä¼˜å…ˆä½¿ç”¨è¿­ä»£æ–¹æ³•ï¼ˆæ›´å¿«ï¼‰
- å¯¹äºæ¡ä»¶æ•°$\kappa &gt; 10^4$ï¼šè€ƒè™‘Schuråˆ†è§£ï¼ˆæ›´ç¨³å®šï¼‰
- å¯¹äºæå¤§è§„æ¨¡é—®é¢˜ï¼šè¿­ä»£æ–¹æ³•ï¼ˆå¯å¹¶è¡Œï¼‰</p>
<h3 id="10">10. å®é™…è®¡ç®—å¤æ‚åº¦çš„ç²¾ç»†åˆ†æ</h3>
<h4 id="101">10.1 åŸºæœ¬æ“ä½œè®¡æ•°</h4>
<p>è®°çŸ©é˜µç»´åº¦ä¸º$n\times n$ï¼ŒåŸºæœ¬æ“ä½œçš„æµ®ç‚¹è¿ç®—æ¬¡æ•°ï¼ˆFLOPsï¼‰ï¼š</p>
<p><strong>çŸ©é˜µ-çŸ©é˜µä¹˜æ³•</strong>ï¼š$\boldsymbol{C} = \boldsymbol{A}\boldsymbol{B}$
- FLOPsï¼š$2n^3$ï¼ˆ$n^3$æ¬¡ä¹˜æ³•ï¼Œ$n^3$æ¬¡åŠ æ³•ï¼‰</p>
<p><strong>çŸ©é˜µ-çŸ©é˜µåŠ æ³•</strong>ï¼š$\boldsymbol{C} = \boldsymbol{A} + \boldsymbol{B}$
- FLOPsï¼š$n^2$</p>
<p><strong>æ ‡é‡-çŸ©é˜µä¹˜æ³•</strong>ï¼š$\boldsymbol{C} = c\boldsymbol{A}$
- FLOPsï¼š$n^2$</p>
<h4 id="102">10.2 å•æ­¥è¿­ä»£çš„å¤æ‚åº¦</h4>
<p>è€ƒè™‘æ–‡ä¸­çš„å•æ­¥è¿­ä»£ï¼š
$$\boldsymbol{W} = a\boldsymbol{I} + b\boldsymbol{P}_t + c\boldsymbol{P}_t^2$$
$$\boldsymbol{G}_{t+1} = \boldsymbol{G}_t\boldsymbol{W}^s$$
$$\boldsymbol{P}_{t+1} = \boldsymbol{W}^r\boldsymbol{P}_t$$</p>
<p><strong>æ­¥éª¤åˆ†è§£</strong>ï¼š
1. è®¡ç®—$\boldsymbol{P}<em t_1="t+1">t^2$ï¼š$2n^3$ FLOPs
2. è®¡ç®—$a\boldsymbol{I} + b\boldsymbol{P}_t + c\boldsymbol{P}_t^2$ï¼š$3n^2$ FLOPs
3. è®¡ç®—$\boldsymbol{W}^s$ï¼ˆå‡è®¾$s\leq 3$ï¼Œéœ€è¦$\lceil\log_2 s\rceil$æ¬¡ä¹˜æ³•ï¼‰ï¼š
   - å¦‚$s=2$ï¼š$2n^3$ FLOPs
   - å¦‚$s=3$ï¼š$4n^3$ FLOPsï¼ˆ$\boldsymbol{W}^2$å†ä¹˜$\boldsymbol{W}$ï¼‰
4. è®¡ç®—$\boldsymbol{G}_t\boldsymbol{W}^s$ï¼š$2mn^2$ FLOPsï¼ˆå‡è®¾$\boldsymbol{G}\in\mathbb{R}^{m\times n}$ï¼‰
5. ç±»ä¼¼è®¡ç®—$\boldsymbol{P}</em>$</p>
<p><strong>æ€»è®¡å•æ­¥</strong>ï¼ˆå¯¹äº$s=r=2$ï¼‰ï¼š
$$\text{FLOPs} \approx 2n^3 + 2n^3 + 2mn^2 + 2n^3 + 2n^3 = 8n^3 + 2mn^2$$</p>
<p>å¯¹äºæ–¹é˜µ$m=n$ï¼šçº¦$10n^3$ FLOPsã€‚</p>
<h4 id="103">10.3 æ€»å¤æ‚åº¦ä¸æ”¶æ•›æ­¥æ•°çš„æƒè¡¡</h4>
<p>å‡è®¾éœ€è¦$k$æ­¥è¿­ä»£è¾¾åˆ°ç›®æ ‡ç²¾åº¦ï¼š
$$\text{æ€»FLOPs} \approx 10kn^3$$</p>
<p>å¯¹æ¯”ç‰¹å¾åˆ†è§£æ–¹æ³•ï¼š
- ç‰¹å¾åˆ†è§£ï¼šçº¦$20n^3$ FLOPsï¼ˆLAPACKçš„<code>dsyevd</code>ï¼‰
- æ„é€ ç»“æœï¼š$2n^3$ FLOPs
- æ€»è®¡ï¼šçº¦$22n^3$ FLOPs</p>
<p><strong>å¹³è¡¡ç‚¹</strong>ï¼šå½“$k\leq 2$æ—¶ï¼Œè¿­ä»£æ–¹æ³•æ›´å¿«ã€‚</p>
<p>ä»æ–‡ä¸­çš„æ•°å€¼ç»“æœçœ‹ï¼Œå¯¹äºè‰¯æ€çŸ©é˜µï¼Œ$k=4\sim 6$æ­¥é€šå¸¸è¶³å¤Ÿï¼Œå› æ­¤ï¼š
- ç†è®ºFLOPsï¼š$40\sim 60n^3$
- ä½†å®é™…ä¸ŠçŸ©é˜µä¹˜æ³•å¯é«˜åº¦ä¼˜åŒ–å’Œå¹¶è¡ŒåŒ–</p>
<h4 id="104">10.4 å†…å­˜è®¿é—®æ¨¡å¼åˆ†æ</h4>
<p><strong>è¿­ä»£æ–¹æ³•</strong>ï¼š
- ä¸»è¦æ“ä½œï¼šçŸ©é˜µä¹˜æ³•
- å†…å­˜è®¿é—®æ¨¡å¼ï¼šè§„åˆ™ã€å¯é¢„æµ‹
- ç¼“å­˜å‹å¥½æ€§ï¼šé«˜ï¼ˆBLASåº“ä¼˜åŒ–ï¼‰</p>
<p><strong>Schuråˆ†è§£</strong>ï¼š
- åŒ…å«å¤šç§æ“ä½œï¼šHouseholderå˜æ¢ã€Givensæ—‹è½¬ç­‰
- å†…å­˜è®¿é—®æ¨¡å¼ï¼šä¸è§„åˆ™
- ç¼“å­˜å‹å¥½æ€§ï¼šä¸­ç­‰</p>
<p><strong>å®é™…æ€§èƒ½</strong>ï¼šåœ¨ç°ä»£ç¡¬ä»¶ä¸Šï¼Œå†…å­˜å¸¦å®½å¾€å¾€æ˜¯ç“¶é¢ˆã€‚è¿­ä»£æ–¹æ³•ç”±äºæ›´å¥½çš„ç¼“å­˜åˆ©ç”¨ç‡ï¼Œå®é™…æ€§èƒ½å¯èƒ½ä¼˜äºç†è®ºé¢„æµ‹ã€‚</p>
<h4 id="105">10.5 ä½ç²¾åº¦è®¡ç®—çš„ä¼˜åŠ¿</h4>
<p>å¯¹äºbfloat16ç­‰ä½ç²¾åº¦æ ¼å¼ï¼š
- å†…å­˜å¸¦å®½éœ€æ±‚å‡åŠ
- Tensor CoreåŠ é€Ÿï¼ˆåœ¨æ”¯æŒçš„ç¡¬ä»¶ä¸Šï¼‰
- è¿­ä»£æ–¹æ³•æ›´å®¹æ˜“é€‚é…ä½ç²¾åº¦</p>
<p><strong>æ··åˆç²¾åº¦ç­–ç•¥</strong>ï¼š
- è¿­ä»£è¿‡ç¨‹ä½¿ç”¨bfloat16æˆ–float16
- æœ€åä¸€æ­¥ä½¿ç”¨float32æé«˜ç²¾åº¦
- å¯ä»¥åœ¨ä¿æŒç²¾åº¦çš„åŒæ—¶å¤§å¹…æé€Ÿ</p>
<h4 id="106">10.6 å¤§è§„æ¨¡åˆ†å¸ƒå¼è®¡ç®—</h4>
<p>å¯¹äºè¶…å¤§è§„æ¨¡çŸ©é˜µï¼ˆå¦‚$n&gt;10^5$ï¼‰ï¼Œéœ€è¦åˆ†å¸ƒå¼è®¡ç®—ï¼š</p>
<p><strong>è¿­ä»£æ–¹æ³•</strong>ï¼š
- çŸ©é˜µä¹˜æ³•å¯åˆ†å—å¹¶è¡Œï¼š$\boldsymbol{C}<em ik="ik">{ij} = \sum_k \boldsymbol{A}</em>$
- é€šä¿¡é‡ï¼š$O(n^2/p)$æ¯ä¸ªèŠ‚ç‚¹ï¼Œå…¶ä¸­$p$æ˜¯èŠ‚ç‚¹æ•°
- æ‰©å±•æ€§ï¼šè‰¯å¥½}\boldsymbol{B}_{kj</p>
<p><strong>Schuråˆ†è§£</strong>ï¼š
- åˆ†å¸ƒå¼QRè¿­ä»£å¤æ‚
- é€šä¿¡é¢‘ç¹
- æ‰©å±•æ€§ï¼šè¾ƒå·®</p>
<p>å¯¹äºå¤§è§„æ¨¡é—®é¢˜ï¼Œè¿­ä»£æ–¹æ³•æ˜æ˜¾å ä¼˜ã€‚</p>
<h3 id="11_1">11. ç®—æ³•çš„å®ç°ç»†èŠ‚ä¸ä¼˜åŒ–æŠ€å·§</h3>
<h4 id="111">11.1 æ•°å€¼ç¨³å®šçš„çŸ©é˜µå¹‚è®¡ç®—</h4>
<p>è®¡ç®—$\boldsymbol{W}^r$æ—¶ï¼Œå¦‚æœç›´æ¥è¿ä¹˜å¯èƒ½å¯¼è‡´æ•°å€¼é—®é¢˜ã€‚ä½¿ç”¨äºŒè¿›åˆ¶å¹‚ç®—æ³•ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">function</span><span class="w"> </span><span class="nf">MatrixPower</span><span class="p">(</span>W, r<span class="p">):</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">I</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">:</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="n">W</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">r</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">even</span><span class="p">:</span>
<span class="w">        </span><span class="n">H</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">MatrixPower</span><span class="p">(</span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">H</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">H</span>
<span class="w">    </span><span class="k">else</span><span class="p">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="p">@</span><span class="w"> </span><span class="n">MatrixPower</span><span class="p">(</span><span class="n">W</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div>

<p>è¿™å°†ä¹˜æ³•æ¬¡æ•°ä»$r-1$å‡å°‘åˆ°$O(\log r)$ã€‚</p>
<h4 id="112">11.2 é¿å…æ˜¾å¼æ±‚é€†</h4>
<p>æ–‡ä¸­çš„ç®—æ³•é¿å…äº†æ˜¾å¼æ±‚é€†ï¼Œè¿™æ˜¯é‡è¦çš„ç¨³å®šæ€§ä¿è¯ã€‚å¯¹äºéœ€è¦æ±‚é€†çš„æƒ…å†µï¼Œä½¿ç”¨çº¿æ€§ç³»ç»Ÿæ±‚è§£ï¼š
$$\boldsymbol{X} = \boldsymbol{A}^{-1}\boldsymbol{B} \quad\Rightarrow\quad \boldsymbol{A}\boldsymbol{X} = \boldsymbol{B}$$</p>
<p>ä½¿ç”¨LUåˆ†è§£æˆ–Choleskyåˆ†è§£æ±‚è§£ï¼Œé¿å…ç›´æ¥è®¡ç®—$\boldsymbol{A}^{-1}$ã€‚</p>
<h4 id="113">11.3 æ—©åœç­–ç•¥</h4>
<p>ç›‘æ§ç›¸å¯¹å˜åŒ–ï¼š
$$\delta_k = \frac{\|\boldsymbol{P}_{k+1} - \boldsymbol{P}_k\|_F}{\|\boldsymbol{P}_k\|_F}$$</p>
<p>å½“$\delta_k &lt; \epsilon_{\text{tol}}$ï¼ˆå¦‚$10^{-6}$ï¼‰æ—¶åœæ­¢è¿­ä»£ï¼Œé¿å…ä¸å¿…è¦çš„è®¡ç®—å’Œç´¯ç§¯è¯¯å·®ã€‚</p>
<h4 id="114">11.4 æ®‹å·®ç›‘æ§</h4>
<p>é™¤äº†ç›‘æ§è¿­ä»£å˜åŒ–ï¼Œè¿˜åº”ç›‘æ§å®é™…æ®‹å·®ï¼š
$$r_k = \|\boldsymbol{P}\boldsymbol{Y}_k^r - \boldsymbol{I}\|_F$$</p>
<p>è¿™æ˜¯æœ€ç»ˆç²¾åº¦çš„ç›´æ¥åº¦é‡ã€‚</p>
<h4 id="115">11.5 å¼‚å¸¸æ£€æµ‹</h4>
<p>åœ¨è¿­ä»£è¿‡ç¨‹ä¸­æ£€æµ‹æ•°å€¼å¼‚å¸¸ï¼š
- æ£€æŸ¥NaNæˆ–Inf
- æ£€æŸ¥çŸ©é˜µèŒƒæ•°æ˜¯å¦è¿‡å¤§ï¼ˆå¦‚$&gt; 10^{10}$ï¼‰
- æ£€æŸ¥å¯¹ç§°æ€§ç ´åï¼ˆå¯¹äºå¯¹ç§°çŸ©é˜µï¼‰</p>
<p>ä¸€æ—¦æ£€æµ‹åˆ°å¼‚å¸¸ï¼Œç«‹å³åœæ­¢å¹¶æŠ¥å‘Šï¼Œé¿å…é”™è¯¯ä¼ æ’­ã€‚</p>
<h3 id="12">12. ç†è®ºç»“æœçš„æ€»ç»“ä¸å±•æœ›</h3>
<h4 id="121">12.1 ä¸»è¦ç†è®ºè´¡çŒ®</h4>
<p>æœ¬æ–‡çš„ä¸»è¦ç†è®ºè´¡çŒ®åŒ…æ‹¬ï¼š</p>
<ol>
<li>
<p><strong>ç»Ÿä¸€æ¡†æ¶</strong>ï¼šå°†ræ¬¡æ–¹æ ¹å’Œé€†ræ¬¡æ–¹æ ¹çš„è®¡ç®—ç»Ÿä¸€åˆ°ä¸€ä¸ªè¿­ä»£æ¡†æ¶ä¸­ã€‚</p>
</li>
<li>
<p><strong>æœ€ä¼˜ç³»æ•°</strong>ï¼šé€šè¿‡æ±‚è§£æå€¼é—®é¢˜ï¼Œå¾—åˆ°äº†æ¯æ­¥è¿­ä»£çš„ç†è®ºæœ€ä¼˜ç³»æ•°ã€‚</p>
</li>
<li>
<p><strong>æ”¶æ•›æ€§ä¿è¯</strong>ï¼šè¯æ˜äº†åœ¨åˆç†å‡è®¾ä¸‹è¿­ä»£çš„æ”¶æ•›æ€§å’Œæ”¶æ•›é€Ÿåº¦ã€‚</p>
</li>
<li>
<p><strong>æ•°å€¼ç¨³å®šæ€§</strong>ï¼šæä¾›äº†ç¨³å®šçš„åˆå§‹åŒ–å’Œæ­£åˆ™åŒ–ç­–ç•¥ã€‚</p>
</li>
</ol>
<h4 id="122">12.2 ä¸ç»å…¸ç®—æ³•çš„å…³ç³»</h4>
<table>
<thead>
<tr>
<th>ç®—æ³•</th>
<th>æ”¶æ•›é˜¶</th>
<th>æ¯æ­¥å¤æ‚åº¦</th>
<th>æ€»å¤æ‚åº¦ï¼ˆåˆ°$\epsilon$ç²¾åº¦ï¼‰</th>
<th>å¹¶è¡Œæ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td>Newton-Schulz</td>
<td>2</td>
<td>$O(n^3)$</td>
<td>$O(n^3\log\log(1/\epsilon))$</td>
<td>é«˜</td>
</tr>
<tr>
<td>Denman-Beavers</td>
<td>2</td>
<td>$O(n^3)$</td>
<td>$O(n^3\log\log(1/\epsilon))$</td>
<td>é«˜</td>
</tr>
<tr>
<td>æœ¬æ–‡æ–¹æ³•</td>
<td>$\geq 2$</td>
<td>$O(rn^3)$</td>
<td>$O(rn^3\log\log(1/\epsilon))$</td>
<td>é«˜</td>
</tr>
<tr>
<td>Schuråˆ†è§£</td>
<td>-</td>
<td>$O(n^3)$</td>
<td>$O(n^3)$</td>
<td>ä½</td>
</tr>
<tr>
<td>PadÃ©é€¼è¿‘</td>
<td>$m+n$</td>
<td>$O(n^3)$</td>
<td>$O(n^3)$</td>
<td>ä¸­</td>
</tr>
</tbody>
</table>
<h4 id="123">12.3 å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘</h4>
<ol>
<li>
<p><strong>æœ€ä¼˜åˆå§‹åŒ–</strong>ï¼šæ˜¯å¦å­˜åœ¨$O(n^2)$å¤æ‚åº¦çš„æœ€ä¼˜åˆå§‹åŒ–ç­–ç•¥ï¼Ÿ</p>
</li>
<li>
<p><strong>è‡ªé€‚åº”æ­¥é•¿</strong>ï¼šèƒ½å¦æ ¹æ®å½“å‰è¯¯å·®è‡ªåŠ¨è°ƒæ•´ç³»æ•°$a,b,c$ï¼Ÿ</p>
</li>
<li>
<p><strong>çŸ©é˜µå‡½æ•°æ¨å¹¿</strong>ï¼šè¯¥æ¡†æ¶èƒ½å¦æ¨å¹¿åˆ°å…¶ä»–çŸ©é˜µå‡½æ•°ï¼Œå¦‚$\log(\boldsymbol{P})$æˆ–$\exp(\boldsymbol{P})$ï¼Ÿ</p>
</li>
<li>
<p><strong>ç»“æ„çŸ©é˜µä¼˜åŒ–</strong>ï¼šå¯¹äºç¨€ç–ã€å¯¹ç§°ã€Toeplitzç­‰ç»“æ„çŸ©é˜µï¼Œèƒ½å¦åˆ©ç”¨ç»“æ„æ€§è´¨è¿›ä¸€æ­¥åŠ é€Ÿï¼Ÿ</p>
</li>
<li>
<p><strong>éšæœºåŒ–ç®—æ³•</strong>ï¼šç»“åˆéšæœºæŠ•å½±æŠ€æœ¯ï¼Œèƒ½å¦å¤„ç†è¶…å¤§è§„æ¨¡é—®é¢˜ï¼Ÿ</p>
</li>
</ol>
<h4 id="124">12.4 å®é™…åº”ç”¨å»ºè®®</h4>
<p>åŸºäºæœ¬æ–‡çš„ç†è®ºåˆ†æï¼Œå®é™…ä½¿ç”¨æ—¶çš„å»ºè®®ï¼š</p>
<p><strong>åœºæ™¯ä¸€ï¼šé«˜ç²¾åº¦ç§‘å­¦è®¡ç®—</strong>
- ä½¿ç”¨åŒç²¾åº¦æˆ–æ›´é«˜ç²¾åº¦
- ä½¿ç”¨å®Œæ•´çš„è¿­ä»£æ­¥æ•°ï¼ˆ6-10æ­¥ï¼‰
- ç›‘æ§æ®‹å·®ç¡®ä¿ç²¾åº¦</p>
<p><strong>åœºæ™¯äºŒï¼šæœºå™¨å­¦ä¹ ï¼ˆå¦‚AdamWä¼˜åŒ–å™¨ï¼‰</strong>
- ä½¿ç”¨å•ç²¾åº¦æˆ–æ··åˆç²¾åº¦
- ä½¿ç”¨è¾ƒå°‘è¿­ä»£æ­¥æ•°ï¼ˆ4-6æ­¥ï¼‰
- åŠ æ­£åˆ™åŒ–$\epsilon\approx 10^{-4}$</p>
<p><strong>åœºæ™¯ä¸‰ï¼šæ·±åº¦å­¦ä¹ æ¨ç†</strong>
- ä½¿ç”¨bfloat16æˆ–int8é‡åŒ–
- ä½¿ç”¨æœ€å°‘è¿­ä»£æ­¥æ•°ï¼ˆ3-4æ­¥ï¼‰
- ä¾§é‡é€Ÿåº¦è€Œéæè‡´ç²¾åº¦</p>
<p><strong>åœºæ™¯å››ï¼šåˆ†å¸ƒå¼å¤§è§„æ¨¡è®¡ç®—</strong>
- ä¼˜å…ˆè€ƒè™‘è¿­ä»£æ–¹æ³•ï¼ˆå¯å¹¶è¡Œï¼‰
- ä½¿ç”¨æ—©åœç­–ç•¥å‡å°‘é€šä¿¡
- è€ƒè™‘å¼‚æ­¥è¿­ä»£å˜ä½“</p>
<p>é€šè¿‡æœ¬èŠ‚çš„è¯¦ç»†æ¨å¯¼ï¼Œæˆ‘ä»¬ä»å¤šä¸ªè§’åº¦æ·±å…¥ç†è§£äº†çŸ©é˜µræ¬¡æ–¹æ ¹è®¡ç®—çš„ç†è®ºåŸºç¡€ã€ç®—æ³•è®¾è®¡ã€æ•°å€¼æ€§è´¨å’Œå®é™…åº”ç”¨ã€‚è¿™äº›ç†è®ºç»“æœä¸ä»…è§£é‡Šäº†æ–‡ä¸­ç®—æ³•çš„å·¥ä½œåŸç†ï¼Œä¹Ÿä¸ºè¿›ä¸€æ­¥çš„ç ”ç©¶å’Œä¼˜åŒ–æä¾›äº†åšå®çš„æ•°å­¦åŸºç¡€ã€‚</p>
        </div>
    </div>
</body>
</html>