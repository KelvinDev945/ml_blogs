<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çŸ©é˜µå¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>çŸ©é˜µå¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 40.5 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11158">https://spaces.ac.cn/archives/11158</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>è®¾$\boldsymbol{P}\in\mathbb{R}^{n\times n}$æ˜¯ä¸€ä¸ªç‰¹å¾å€¼éƒ½æ˜¯éè´Ÿå®æ•°çš„$n$é˜¶æ–¹é˜µï¼Œæœ¬æ–‡æ¥è®¨è®ºå®ƒçš„å¹³æ–¹æ ¹$\boldsymbol{P}^{1/2}$å’Œé€†å¹³æ–¹æ ¹$\boldsymbol{P}^{-1/2}$çš„è®¡ç®—ã€‚</p>
<h2 id="_1">åŸºæœ¬æ¦‚å¿µ</h2>
<p>çŸ©é˜µ$\boldsymbol{P}$çš„å¹³æ–¹æ ¹ï¼ŒæŒ‡çš„æ˜¯æ»¡è¶³$\boldsymbol{X}^2=\boldsymbol{P}$çš„çŸ©é˜µ$\boldsymbol{X}$ã€‚æˆ‘ä»¬çŸ¥é“æ­£æ•°éƒ½æœ‰ä¸¤ä¸ªå¹³æ–¹æ ¹ï¼Œå› æ­¤ä¸éš¾æƒ³è±¡çŸ©é˜µå¹³æ–¹æ ¹ä¸€èˆ¬ä¹Ÿä¸å”¯ä¸€ã€‚ä¸è¿‡ï¼Œâ€œç®—æœ¯å¹³æ–¹æ ¹â€æ˜¯å”¯ä¸€çš„ï¼Œä¸€ä¸ªæ­£æ•°çš„ç®—æœ¯å¹³æ–¹æ ¹æ˜¯æ­£çš„é‚£ä¸ªå¹³æ–¹æ ¹ï¼Œç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å°†$\boldsymbol{P}$çš„ç‰¹å¾å€¼å…¨æ˜¯éè´Ÿæ•°çš„é‚£ä¸ªå¹³æ–¹æ ¹ç§°ä¸ºç®—æœ¯å¹³æ–¹æ ¹ã€‚æœ¬æ–‡è¦æ±‚çš„çŸ©é˜µå¹³æ–¹æ ¹ï¼Œé»˜è®¤éƒ½æ˜¯æŒ‡ç®—æœ¯å¹³æ–¹æ ¹ã€‚</p>
<p>æœ¬æ–‡çš„è®¡ç®—ä¾èµ–äºæˆ‘ä»¬åœ¨<a href="/archives/11056">ã€ŠçŸ©é˜µç¬¦å·å‡½æ•°mcsgnèƒ½è®¡ç®—ä»€ä¹ˆï¼Ÿã€‹</a>è®¨è®ºè¿‡çš„çŸ©é˜µç¬¦å·å‡½æ•°ï¼š<br />
\begin{equation}\newcommand{mcsgn}{\mathop{\text{mcsgn}}}\mcsgn(\boldsymbol{M}) = (\boldsymbol{M}^2)^{-1/2}\boldsymbol{M}= \boldsymbol{M}(\boldsymbol{M}^2)^{-1/2}<br />
\end{equation}<br />
ç®€å•æ¥è¯´ï¼Œå®ƒå°±æ˜¯æŠŠä»»æ„çŸ©é˜µ$\boldsymbol{M}\in\mathbb{R}^{n\times n}$çš„ç‰¹å¾å€¼å˜æˆå¯¹åº”çš„ç¬¦å·å‡½æ•°çš„æ–°çŸ©é˜µã€‚å‡è®¾$\boldsymbol{M}$çš„ç‰¹å¾å€¼éƒ½æ˜¯å®æ•°ï¼Œé‚£ä¹ˆ$\mcsgn$å¯ä»¥é€šè¿‡Newton-Schulzè¿­ä»£é«˜æ•ˆè®¡ç®—ï¼š<br />
\begin{equation}\newcommand{tr}{\mathop{\text{tr}}}\boldsymbol{X}<em t_1="t+1">0 = \frac{\boldsymbol{M}}{\sqrt{\tr(\boldsymbol{M}^2)}},\qquad \boldsymbol{X}</em>} = a_{t+1}\boldsymbol{X<em t_1="t+1">t + b</em>}\boldsymbol{X<em t_1="t+1">t^3 + c</em>}\boldsymbol{X}_t^5\end{equation<br />
å…¶ä¸­$\frac{\boldsymbol{M}}{\sqrt{\tr(\boldsymbol{M}^2)}}$æ˜¯ä¸ºäº†å°†$\boldsymbol{X}_0$çš„ç‰¹å¾å€¼éƒ½ç¼©æ”¾åˆ°$[-1,1]$å†…ï¼Œè€Œ$a_t,b_t,c_t$æ˜¯<a href="/archives/10996">ã€Šmsignç®—å­çš„Newton-Schulzè¿­ä»£ï¼ˆä¸‹ï¼‰ã€‹</a>æ‰€æ¨å¯¼çš„ç³»æ•°ï¼š<br />
\begin{array}{c|ccc}<br />
\hline<br />
t &amp; a\times 1.01 &amp; b\times 1.01^3 &amp; c\times 1.01^5 \\\<br />
\hline<br />
\quad 1\quad &amp; 8.28721 &amp; -23.5959 &amp; 17.3004 \\\<br />
2 &amp; 4.10706 &amp; -2.94785 &amp; 0.544843 \\\<br />
3 &amp; 3.94869 &amp; -2.9089 &amp; 0.551819 \\\<br />
4 &amp; 3.31842 &amp; -2.48849 &amp; 0.510049 \\\<br />
5 &amp; 2.30065 &amp; -1.6689 &amp; 0.418807 \\\<br />
6 &amp; 1.8913 &amp; 1.268 &amp; 0.376804 \\\<br />
7 &amp; 1.875 &amp; -1.25 &amp; 0.375 \\\<br />
8 &amp; 1.875 &amp; -1.25 &amp; 0.375 \\\<br />
\hline<br />
\end{array}<br />
å®é™…ä¸Šï¼Œå½“$\boldsymbol{M}$çš„ç‰¹å¾å€¼å…¨éƒ½æ˜¯å®æ•°æ—¶ï¼Œ$\mcsgn$çš„è®¡ç®—åŸç†è·Ÿå¦ä¸€ç§çŸ©é˜µç¬¦å·å‡½æ•°$\newcommand{msign}{\mathop{\text{msign}}}\msign$æ˜¯ç›¸é€šçš„ã€‚</p>
<h2 id="_2">è®¡ç®—åŸç†</h2>
<p>æ¥ä¸‹æ¥è®¡ç®—çš„å‡ºå‘ç‚¹æ˜¯æ’ç­‰å¼<br />
\begin{equation}\mcsgn\left(\begin{bmatrix}\boldsymbol{0} &amp; \boldsymbol{A} \\\ \boldsymbol{B} &amp; \boldsymbol{0}\end{bmatrix}\right)=\begin{bmatrix}\boldsymbol{0} &amp; \boldsymbol{A}(\boldsymbol{B}\boldsymbol{A})^{-1/2} \\\ \boldsymbol{B}(\boldsymbol{A}\boldsymbol{B})^{-1/2} &amp; \boldsymbol{0}\end{bmatrix}\label{eq:core}\end{equation}<br />
ç›´æ¥ä»£å…¥$\mcsgn$çš„å®šä¹‰å°±å¯ä»¥éªŒè¯ä¸Šå¼æˆç«‹ï¼ˆæ³¨ï¼š$\boldsymbol{A},\boldsymbol{B}$æœªå¿…æ˜¯æ–¹é˜µï¼‰ã€‚æ¥ä¸‹æ¥æˆ‘ä»¬è¦ç¡®å®šä»€ä¹ˆæƒ…å†µä¸‹å·¦ç«¯æ±‚$\mcsgn$çš„çŸ©é˜µçš„ç‰¹å¾å€¼å…¨éƒ½æ˜¯å®æ•°ã€‚è®¾$\lambda$æ˜¯å®ƒçš„ä¸€ä¸ªéé›¶ç‰¹å¾å€¼ï¼Œé‚£ä¹ˆ<br />
\begin{equation}0=\det\left(\lambda\boldsymbol{I} - \begin{bmatrix}\boldsymbol{0} &amp; \boldsymbol{A} \\\ \boldsymbol{B} &amp; \boldsymbol{0} \end{bmatrix}\right) = \det\left(\begin{bmatrix}\lambda\boldsymbol{I} &amp; -\boldsymbol{A} \\\ -\boldsymbol{B} &amp; \lambda\boldsymbol{I} \end{bmatrix}\right) = \det(\lambda^2 \boldsymbol{I} - \boldsymbol{A}\boldsymbol{B})\end{equation}<br />
å³$\lambda^2$æ˜¯çŸ©é˜µ$\boldsymbol{A}\boldsymbol{B}$çš„ç‰¹å¾å€¼ã€‚è¿™æ„å‘³ç€ä¸Šè¿°åˆ†å—çŸ©é˜µçš„å…¨ä½“ç‰¹å¾å€¼éƒ½æ˜¯å®æ•°ï¼Œå½“ä¸”ä»…å½“$\boldsymbol{A}\boldsymbol{B}$çš„å…¨ä½“ç‰¹å¾å€¼éè´Ÿã€‚</p>
<p>ç›´æ¥å¯¹åŸçŸ©é˜µè¿›è¡Œè¿­ä»£è‡ªç„¶æ˜¯å¯ä»¥çš„ï¼Œä½†ä¼šæ¯”è¾ƒæµªè´¹è®¡ç®—ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å®ƒçš„åå¯¹è§’çº¿ç»“æ„æ¥é™ä½è®¡ç®—é‡ã€‚å› ä¸º<br />
\begin{equation}<br />
\begin{bmatrix}\boldsymbol{0} &amp; \boldsymbol{Y} \\\<br />
\boldsymbol{Z} &amp; \boldsymbol{0}\end{bmatrix}^3 = \begin{bmatrix}\boldsymbol{0} &amp; (\boldsymbol{Y}\boldsymbol{Z})\boldsymbol{Y} \\\<br />
\boldsymbol{Z}(\boldsymbol{Y}\boldsymbol{Z}) &amp; \boldsymbol{0}\end{bmatrix},\quad<br />
\begin{bmatrix}\boldsymbol{0} &amp; \boldsymbol{Y} \\\<br />
\boldsymbol{Z} &amp; \boldsymbol{0}\end{bmatrix}^5 = \begin{bmatrix}\boldsymbol{0} &amp; (\boldsymbol{Y}\boldsymbol{Z})^2\boldsymbol{Y} \\\<br />
\boldsymbol{Z}(\boldsymbol{Y}\boldsymbol{Z})^2 &amp; \boldsymbol{0}\end{bmatrix} \\\<br />
\end{equation}<br />
æˆ‘ä»¬å¯ä»¥å¾—åˆ°è¿­ä»£<br />
\begin{gather}<br />
\boldsymbol{Y}<em t_1="t+1">{t+1} = (a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t + c</em>}(\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t)^2)\boldsymbol{Y}_t \label{eq:r1} \\\[6pt]<br />
\boldsymbol{Z}</em>} = \boldsymbol{Z<em t_1="t+1">t(a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t + c</em>}(\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t)^2) \label{eq:r2}<br />
\end{gather}<br />
é‚£ä¹ˆ$\boldsymbol{Y}_t\to \boldsymbol{A}(\boldsymbol{B}\boldsymbol{A})^{-1/2},\boldsymbol{Z}_t\to \boldsymbol{B}(\boldsymbol{A}\boldsymbol{B})^{-1/2}$ã€‚ç‰¹åˆ«åœ°ï¼Œå°†ä¸Šé¢ä¸¤å¼ç›¸ä¹˜å¯ä»¥å¾—åˆ°$\boldsymbol{Y}_t\boldsymbol{Z}_t$çš„é€’å½’<br />
\begin{equation}\boldsymbol{Y}</em>}\boldsymbol{Z<em t_1="t+1">{t+1} = (a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t + c</em>}(\boldsymbol{Y}_t\boldsymbol{Z}_t)^2)^2\boldsymbol{Y}_t\boldsymbol{Z}_t\label{eq:r3}\end{equation</p>
<h2 id="_3">æ±‚å¹³æ–¹æ ¹</h2>
<p>ç°åœ¨æ­£å¼è¿›å…¥å¹³æ–¹æ ¹çš„è®¡ç®—ã€‚ç”±äºå‡è®¾äº†$\boldsymbol{P}$çš„ç‰¹å¾å€¼éè´Ÿï¼Œæˆ‘ä»¬æ€»å¯ä»¥é€šè¿‡é™¤ä»¥$\tr(\boldsymbol{P})$è¿›ä¸€æ­¥å°†å®ƒçš„ç‰¹å¾å€¼å‹ç¼©åˆ°$0\sim 1$ä¹‹é—´ï¼Œå› æ­¤ä¸å¤±ä¸€èˆ¬æ€§ï¼Œæˆ‘ä»¬å‡è®¾$\boldsymbol{P}$çš„ç‰¹å¾å€¼éƒ½åœ¨$[0,1]$å†…ï¼Œè¿™æ ·å°±å¯ä»¥ç›´æ¥ç”¨Newton-Schulzè¿­ä»£è®¡ç®—$\mcsgn$äº†ã€‚</p>
<p>å°†$\boldsymbol{A}=\boldsymbol{P},\boldsymbol{B}=\boldsymbol{I}$ä»£å…¥åˆ°å¼$\eqref{eq:core}$ï¼Œå¯ä»¥å¾—åˆ°<br />
\begin{equation}\mcsgn\left(\begin{bmatrix}\boldsymbol{0} &amp; \boldsymbol{P} \\\ \boldsymbol{I} &amp; \boldsymbol{0}\end{bmatrix}\right)=\begin{bmatrix}\boldsymbol{0} &amp; \boldsymbol{P}^{1/2} \\\ \boldsymbol{P}^{-1/2} &amp; \boldsymbol{0}\end{bmatrix}\end{equation}<br />
éå¸¸ç¥å¥‡ï¼Œç†è®ºä¸Šé€šè¿‡åªéœ€è¦$\mcsgn$ä¸€æ¬¡ï¼Œå°±å¯ä»¥æŠŠå¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹éƒ½æ±‚å‡ºæ¥ï¼Œä¹Ÿå°±æ˜¯æŒ‰ç…§å¼$\eqref{eq:r1}$å’Œ$\eqref{eq:r2}$è¿­ä»£ï¼Œæˆ‘ä»¬å°±å¯ä»¥åŒæ—¶å®Œæˆä¸¤ä¸ªä»»åŠ¡ï¼</p>
<p>ç„¶è€Œï¼Œå®é™…ä¸Šæ²¡æœ‰è¿™ä¹ˆç†æƒ³ã€‚å¦‚æœ$\boldsymbol{P}$æœ‰éå¸¸æ¥è¿‘äº0çš„å¥‡å¼‚å€¼ï¼Œé‚£ä¹ˆ$\boldsymbol{P}^{-1/2}$æ˜¯ä¼šæ•°å€¼çˆ†ç‚¸çš„ï¼ˆç›¸å½“äºå‡ºç°äº†$1/\sqrt{0}$ï¼‰ï¼Œä½†$\boldsymbol{P}^{1/2}$å¹¶ä¸ä¼šï¼Œæ‰€ä»¥å‡è®¾æˆ‘ä»¬åªå…³å¿ƒ$\boldsymbol{P}^{1/2}$çš„å€¼ï¼ŒåŒæ—¶è®¡ç®—$\boldsymbol{P}^{1/2},\boldsymbol{P}^{-1/2}$åè€Œä¼šå¢åŠ æ•°å€¼ä¸ç¨³å®šæ€§ã€‚è¿™æ—¶å€™æ›´å¥½çš„åŠæ³•æ˜¯é€šè¿‡å¼$\eqref{eq:r1}$å’Œ$\eqref{eq:r3}$æ¥è¿­ä»£ï¼Œåªè®¡ç®—$\boldsymbol{P}^{1/2}$ï¼š<br />
\begin{gather}<br />
\boldsymbol{Y}<em t_1="t+1">0 = \boldsymbol{P}, \quad \boldsymbol{Y}_0\boldsymbol{Z}_0 = \boldsymbol{P} \notag\\\[6pt]<br />
\boldsymbol{Y}</em>} = (a_{t+1}\boldsymbol{I} + b_{t+1}\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t + c</em>}(\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t)^2)\boldsymbol{Y}_t \\\[6pt]<br />
\boldsymbol{Y}</em>}\boldsymbol{Z<em t_1="t+1">{t+1} = (a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t + c</em>}(\boldsymbol{Y<em t_to_infty="t\to\infty">t\boldsymbol{Z}_t)^2)^2\boldsymbol{Y}_t\boldsymbol{Z}_t \\\[6pt]<br />
\lim</em>\notag} \boldsymbol{Y}_t = \boldsymbol{P}^{1/2<br />
\end{gather}<br />
ç”±äº$\boldsymbol{Z}_t$çš„æé™æ˜¯$\boldsymbol{P}^{-1/2}$ï¼Œæ‰€ä»¥$\boldsymbol{Y}_t\boldsymbol{Z}_t$çš„æé™æ˜¯$\boldsymbol{I}$ï¼Œå› æ­¤è¿­ä»£$\boldsymbol{Y}_t\boldsymbol{Z}_t$æ›´ä¸å®¹æ˜“å‡ºç°æ•°å€¼é£é™©ã€‚å‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">abc</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
    <span class="n">coefs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">(</span><span class="mf">8.287212018145622</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.59588651909882</span><span class="p">,</span> <span class="mf">17.300387312530923</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">4.107059111542197</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.9478499167379084</span><span class="p">,</span> <span class="mf">0.54484310829266</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">3.9486908534822938</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.908902115962947</span><span class="p">,</span> <span class="mf">0.5518191394370131</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">3.3184196573706055</span><span class="p">,</span> <span class="o">-</span><span class="mf">2.488488024314878</span><span class="p">,</span> <span class="mf">0.5100489401237208</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">2.3006520199548186</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.6689039845747518</span><span class="p">,</span> <span class="mf">0.4188073119525678</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.8913014077874002</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.2679958271945908</span><span class="p">,</span> <span class="mf">0.37680408948524996</span><span class="p">),</span>
        <span class="p">(</span><span class="mf">1.875</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.25</span><span class="p">,</span> <span class="mf">0.375</span><span class="p">)</span>
    <span class="p">]</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">coefs</span><span class="p">[:</span><span class="n">steps</span><span class="p">]</span> <span class="o">+</span> <span class="nb">max</span><span class="p">(</span><span class="n">steps</span> <span class="o">-</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="n">coefs</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]:</span>
        <span class="k">yield</span> <span class="n">a</span> <span class="o">/</span> <span class="mf">1.01</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="mf">1.01</span><span class="o">**</span><span class="mi">3</span><span class="p">,</span> <span class="n">c</span> <span class="o">/</span> <span class="mf">1.01</span><span class="o">**</span><span class="mi">5</span>

<span class="k">def</span><span class="w"> </span><span class="nf">msqrt</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">YZ</span> <span class="o">=</span> <span class="n">P</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span> <span class="o">:=</span> <span class="n">np</span><span class="o">.</span><span class="kp">trace</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
    <span class="n">I</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">eye</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="kp">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">abc</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">I</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">YZ</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">YZ</span> <span class="o">@</span> <span class="n">YZ</span>
        <span class="n">Y</span><span class="p">,</span> <span class="n">YZ</span> <span class="o">=</span> <span class="n">W</span> <span class="o">@</span> <span class="n">Y</span><span class="p">,</span> <span class="n">W</span> <span class="o">@</span> <span class="n">W</span> <span class="o">@</span> <span class="n">YZ</span>
    <span class="k">return</span> <span class="n">Y</span> <span class="o">*</span> <span class="n">t</span><span class="o">**</span><span class="mf">0.5</span>

<span class="n">d</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">:=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">@</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span>
<span class="n">np</span><span class="o">.</span><span class="kp">abs</span><span class="p">(</span><span class="n">msqrt</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">@</span> <span class="n">msqrt</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="n">P</span><span class="p">)</span><span class="o">.</span><span class="kp">mean</span><span class="p">()</span>  <span class="c1"># ~= 2e-4</span>
</code></pre></div>

<h2 id="_4">é€†å¹³æ–¹æ ¹</h2>
<p>å¦‚æœæˆ‘ä»¬å¿…é¡»è¦æ˜¾å¼åœ°æ±‚å‡ºé€†å¹³æ–¹æ ¹$\boldsymbol{P}^{-1/2}$ï¼Œé‚£ä¹ˆå°±æ²¡ä»€ä¹ˆå¥½åŠæ³•äº†ï¼Œè¯¥çˆ†ç‚¸çš„å§‹ç»ˆéƒ½ä¼šçˆ†ç‚¸ï¼Œè¿™æ—¶å€™ä¸ç®¡æ˜¯å¼$\eqref{eq:r2},\eqref{eq:r1}$ç»„åˆè¿˜æ˜¯å¼$\eqref{eq:r2},\eqref{eq:r3}$ç»„åˆï¼Œæ•ˆæœéƒ½åº”è¯¥å·®ä¸å¤šï¼Œä¸è¿‡åè€…åº”è¯¥ä¼šç›¸å¯¹ç¨³å®šä¸€ç‚¹ï¼š<br />
\begin{gather}<br />
\boldsymbol{Z}<em t_1="t+1">0 = \boldsymbol{I}, \quad \boldsymbol{Y}_0\boldsymbol{Z}_0 = \boldsymbol{P} \notag\\\[6pt]<br />
\boldsymbol{Z}</em>} = \boldsymbol{Z<em t_1="t+1">t(a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t + c</em>}(\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t)^2)\label{eq:r2-rsqrt} \\\[6pt]<br />
\boldsymbol{Y}</em>}\boldsymbol{Z<em t_1="t+1">{t+1} = (a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t + c</em>}(\boldsymbol{Y<em t_to_infty="t\to\infty">t\boldsymbol{Z}_t)^2)^2\boldsymbol{Y}_t\boldsymbol{Z}_t\label{eq:r3-rsqrt} \\\[6pt]<br />
\lim</em>\notag} \boldsymbol{Z}_t = \boldsymbol{P}^{-1/2<br />
\end{gather}</p>
<p>å‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">mrsqrt</span><span class="p">(</span><span class="n">P</span><span class="o">,</span><span class="w"> </span><span class="n">steps</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">:</span>
<span class="w">    </span><span class="n">YZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="w">    </span><span class="n">Z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">abc</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="o">:</span>
<span class="w">        </span><span class="n">W</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">YZ</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">YZ</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">YZ</span>
<span class="w">        </span><span class="n">Z</span><span class="o">,</span><span class="w"> </span><span class="n">YZ</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">W</span><span class="o">,</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">YZ</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Z</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">t</span><span class="o">**</span><span class="mf">0.5</span>

<span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">d</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">T</span>
<span class="n">np</span><span class="o">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">mrsqrt</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">mrsqrt</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">d</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="w">  </span><span class="c1"># ~= 5e-4</span>
</code></pre></div>

<h2 id="_5">çŸ©é˜µç›¸ä¹˜</h2>
<p>ä¸è¿‡åœ¨å¤§å¤šæ•°æ—¶å€™ï¼Œæ±‚$\boldsymbol{P}^{-1/2}$åªæ˜¯ä¸€ä¸ªä¸­é—´æ­¥éª¤ï¼Œæ±‚å®Œä¹‹åé€šå¸¸è¿˜è¦è·Ÿå¦ä¸€ä¸ªçŸ©é˜µåšä¹˜æ³•ã€‚è®¾çŸ©é˜µ$\boldsymbol{G}\in\mathbb{R}^{m\times n}$ï¼Œæˆ‘ä»¬éœ€è¦è®¡ç®—$\boldsymbol{G}\boldsymbol{P}^{-1/2}$ï¼Œå¦‚æœæˆ‘ä»¬èƒ½å°†$\boldsymbol{G}\boldsymbol{P}^{-1/2}$ä½œä¸ºä¸€ä¸ªæ•´ä½“çš„è¿­ä»£å¯¹è±¡ï¼Œé‚£ä¹ˆç›¸æ¯”å•ç‹¬æ±‚å‡º$\boldsymbol{P}^{-1/2}$ç„¶åå†æ‰§è¡ŒçŸ©é˜µä¹˜æ³•ï¼Œå¾€å¾€æœ‰æ›´å¥½çš„æ•°å€¼ç¨³å®šæ€§ã€‚</p>
<p>è®©æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿå¼$\eqref{eq:r2-rsqrt}$å’Œ$\eqref{eq:r3-rsqrt}$ï¼Œä¸éš¾çœ‹å‡ºï¼Œå½“æˆ‘ä»¬å°†$\boldsymbol{Y}<em t_1="t+1">t\boldsymbol{Z}_t$è§†ä¸ºä¸€ä¸ªæ•´ä½“æ—¶ï¼Œå®ƒçš„è¿­ä»£å¼$\eqref{eq:r3-rsqrt}$å…¶å®æ˜¯ç‹¬ç«‹äº$\boldsymbol{Z}_t$çš„ï¼Œæ‰€ä»¥$\boldsymbol{Z}_t$çš„å¼$\eqref{eq:r2-rsqrt}$æœ¬è´¨ä¸Šå°±åªæ˜¯ä¸€ä¸ªçº¿æ€§é€’å½’ï¼æˆ‘ä»¬åœ¨å®ƒå·¦è¾¹ä¹˜ä»¥ä¸€ä¸ªçŸ©é˜µï¼Œå¹¶ä¸æ”¹å˜è¿­ä»£å½¢å¼ï¼Œåªéœ€è¦ä¿®æ”¹ä¸€ä¸‹åˆå§‹å€¼ï¼Œäºæ˜¯å¾—åˆ°<br />
\begin{gather}<br />
\boldsymbol{Z}_0 = \boldsymbol{G}, \quad \boldsymbol{Y}_0\boldsymbol{Z}_0 = \boldsymbol{P} \notag\\\[6pt]<br />
\boldsymbol{Z}</em>} = \boldsymbol{Z<em t_1="t+1">t(a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t + c</em>}(\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t)^2) \label{eq:r2-final} \\\[6pt]<br />
\boldsymbol{Y}</em>}\boldsymbol{Z<em t_1="t+1">{t+1} = (a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{Y<em t_1="t+1">t\boldsymbol{Z}_t + c</em>}(\boldsymbol{Y<em t_to_infty="t\to\infty">t\boldsymbol{Z}_t)^2)^2\boldsymbol{Y}_t\boldsymbol{Z}_t \label{eq:r3-final}\\\[6pt]<br />
\lim</em>\notag} \boldsymbol{Z}_t = \boldsymbol{G}\boldsymbol{P}^{-1/2<br />
\end{gather}</p>
<p>å‚è€ƒä»£ç ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">scipy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sp</span>

<span class="k">def</span><span class="w"> </span><span class="nf">matmul_mrsqrt</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">,</span> <span class="n">steps</span><span class="o">=</span><span class="mi">6</span><span class="p">):</span>
    <span class="n">YZ</span> <span class="o">=</span> <span class="n">P</span> <span class="o">/</span> <span class="p">(</span><span class="n">t</span> <span class="o">:=</span> <span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
    <span class="n">Z</span><span class="p">,</span> <span class="n">I</span> <span class="o">=</span> <span class="n">G</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">abc</span><span class="p">(</span><span class="n">steps</span><span class="p">):</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">a</span> <span class="o">*</span> <span class="n">I</span> <span class="o">+</span> <span class="n">b</span> <span class="o">*</span> <span class="n">YZ</span> <span class="o">+</span> <span class="n">c</span> <span class="o">*</span> <span class="n">YZ</span> <span class="o">@</span> <span class="n">YZ</span>
        <span class="n">Z</span><span class="p">,</span> <span class="n">YZ</span> <span class="o">=</span> <span class="n">Z</span> <span class="o">@</span> <span class="n">W</span><span class="p">,</span> <span class="n">W</span> <span class="o">@</span> <span class="n">W</span> <span class="o">@</span> <span class="n">YZ</span>
    <span class="k">return</span> <span class="n">Z</span> <span class="o">/</span> <span class="n">t</span><span class="o">**</span><span class="mf">0.5</span>

<span class="n">d</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">P</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">:=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span> <span class="o">@</span> <span class="n">x</span><span class="o">.</span><span class="n">T</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">d</span><span class="p">,</span> <span class="n">d</span><span class="p">)</span> <span class="o">/</span> <span class="n">d</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">matmul_mrsqrt</span><span class="p">(</span><span class="n">G</span><span class="p">,</span> <span class="n">P</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">X</span> <span class="o">@</span> <span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">sqrtm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span> <span class="o">-</span> <span class="n">G</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  <span class="c1"># ~= 1e-4</span>
</code></pre></div>

<p>ç°åœ¨ï¼Œè®©æˆ‘ä»¬å›è¿‡å¤´æ¥çœ‹æ±‚å¹³æ–¹æ ¹çš„ç®—æ³•ï¼Œä¸éš¾çœ‹å‡ºå®ƒå…¶å®å°±æ˜¯$\boldsymbol{G}=\boldsymbol{P}$æ—¶æœ¬èŠ‚è¿­ä»£çš„å¦ä¸€ä¸ªç­‰ä»·å†™æ³•ï¼Œå³$\boldsymbol{P}^{1/2}=\boldsymbol{P}\boldsymbol{P}^{-1/2}$ã€‚æ‰€ä»¥ï¼Œè™½ç„¶æˆ‘ä»¬çœ‹ä¸Šå»å¼åˆ†å¼€äº†ä¸‰èŠ‚æ¥è®¨è®ºäº†ä¸‰ä¸ªè¿­ä»£ï¼Œä½†å®ƒä»¬æœ¬è´¨ä¸Šéƒ½æ˜¯æœ€åä¸€ä¸ªè¿­ä»£çš„ç‰¹ä¾‹ï¼</p>
<h2 id="_6">ç»ˆææ¨å¹¿</h2>
<p>æœ€åï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å°†å®ƒæ¨å¹¿åˆ°$\boldsymbol{Q}^{-1/2}\boldsymbol{G}\boldsymbol{P}^{-1/2}$çš„è®¡ç®—ï¼Œå…¶ä¸­$\boldsymbol{Q}\in\mathbb{R}^{m\times m}$æ˜¯å¦ä¸€ä¸ªç‰¹å¾å€¼éè´Ÿçš„çŸ©é˜µï¼Œç»“æœå¦‚ä¸‹ï¼š<br />
\begin{gather}<br />
\boldsymbol{G}<em t_1="t+1">0 = \boldsymbol{G}, \quad \boldsymbol{Q}_0 = \boldsymbol{Q},\quad \boldsymbol{P}_0 = \boldsymbol{P} \notag\\\[6pt]<br />
\boldsymbol{G}</em>} = (a_{t+1}\boldsymbol{I} + b_{t+1}\boldsymbol{Q<em t_1="t+1">t + c</em>}\boldsymbol{Q<em t_1="t+1">t^2)\boldsymbol{G}_t(a</em>}\boldsymbol{I} + b_{t+1}\boldsymbol{P<em t_1="t+1">t + c</em>}\boldsymbol{P<em t_1="t+1">t^2) \\\[6pt]<br />
\boldsymbol{Q}</em>} = (a_{t+1}\boldsymbol{I} + b_{t+1}\boldsymbol{Q<em t_1="t+1">t + c</em>}\boldsymbol{Q<em t_1="t+1">t^2)^2\boldsymbol{Q}_t \\\[6pt]<br />
\boldsymbol{P}</em>} = (a_{t+1}\boldsymbol{I} + b_{t+1}\boldsymbol{P<em t_1="t+1">t + c</em>}\boldsymbol{P<em t_to_infty="t\to\infty">t^2)^2\boldsymbol{P}_t \\\[6pt]<br />
\lim</em>\notag} \boldsymbol{G}_t = \boldsymbol{Q}^{-1/2}\boldsymbol{G}\boldsymbol{P}^{-1/2<br />
\end{gather}</p>
<p>å‚è€ƒä»£ç ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="n">def</span><span class="w"> </span><span class="n">mrsqrt_matmul_mrsqrt</span><span class="p">(</span><span class="n">Q</span><span class="o">,</span><span class="w"> </span><span class="n">G</span><span class="o">,</span><span class="w"> </span><span class="n">P</span><span class="o">,</span><span class="w"> </span><span class="n">steps</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span><span class="o">:</span>
<span class="w">    </span><span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t1</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">Q</span><span class="p">))</span>
<span class="w">    </span><span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t2</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">P</span><span class="p">))</span>
<span class="w">    </span><span class="n">I1</span><span class="o">,</span><span class="w"> </span><span class="n">I2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">Q</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">,</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="n">P</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="n">a</span><span class="o">,</span><span class="w"> </span><span class="n">b</span><span class="o">,</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">abc</span><span class="p">(</span><span class="n">steps</span><span class="p">)</span><span class="o">:</span>
<span class="w">        </span><span class="n">W1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">I1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Q</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">Q</span>
<span class="w">        </span><span class="n">W2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">I2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">P</span>
<span class="w">        </span><span class="n">G</span><span class="o">,</span><span class="w"> </span><span class="n">Q</span><span class="o">,</span><span class="w"> </span><span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W1</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">W2</span><span class="o">,</span><span class="w"> </span><span class="n">W1</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">W1</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">Q</span><span class="o">,</span><span class="w"> </span><span class="n">W2</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">W2</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">P</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">G</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">t1</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">t2</span><span class="p">)</span><span class="w"> </span><span class="o">**</span><span class="mf">0.5</span>

<span class="n">d</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span>
<span class="n">Q</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">T</span>
<span class="n">P</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">d</span><span class="o">**</span><span class="mf">0.5</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">x</span><span class="o">.</span><span class="n">T</span>
<span class="n">G</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">d</span><span class="o">,</span><span class="w"> </span><span class="n">d</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">d</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">X</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mrsqrt_matmul_mrsqrt</span><span class="p">(</span><span class="n">Q</span><span class="o">,</span><span class="w"> </span><span class="n">G</span><span class="o">,</span><span class="w"> </span><span class="n">P</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">sqrtm</span><span class="p">(</span><span class="n">Q</span><span class="p">)</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">@</span><span class="w"> </span><span class="n">sp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">sqrtm</span><span class="p">(</span><span class="n">P</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">G</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="w">  </span><span class="c1"># ~= 2e-3</span>
</code></pre></div>

<p>è¯·è¯»è€…æ ¹æ®å‰å‡ èŠ‚çš„ç»“æœè‡ªè¡Œå®Œæˆè¯æ˜ã€‚</p>
<p>å¯¹äº<a href="https://papers.cool/arxiv/1802.09568">Shampooä¼˜åŒ–å™¨</a>ï¼Œæˆ‘ä»¬éœ€è¦æ±‚$\boldsymbol{Q}^{-1/4}\boldsymbol{G}\boldsymbol{P}^{-1/4}$ï¼Œç›®å‰çœ‹æ¥æ¯”è¾ƒå¯è¡Œçš„æ–¹æ¡ˆæ˜¯åˆ†åˆ«å…ˆæ±‚å‡º$\boldsymbol{Q}^{1/2}$å’Œ$\boldsymbol{P}^{1/2}$ï¼Œç„¶åä»£å…¥ä¸Šè¿°è¿­ä»£ä¸­æ±‚$(\boldsymbol{Q}^{1/2})^{-1/2}\boldsymbol{G}(\boldsymbol{P}^{1/2})^{-1/2}$ã€‚çœ‹ä¸Šå»è®¡ç®—é‡æ¯”è¾ƒå¤§ï¼Œä½†å®é™…ä¸Šåœ¨Optimizerçš„Updateé˜¶æ®µï¼Œç®—åŠ›å¾€å¾€ä¸æ˜¯ç“¶é¢ˆï¼Œåªè¦ç®—æ³•å¯ä»¥å……åˆ†å¹¶è¡Œï¼Œé‚£ä¹ˆæ—¶é—´å¹¶ä¸ä¼šæ˜æ˜¾å¢åŠ ï¼Œåˆšå¥½$\boldsymbol{Q}^{1/2}$å’Œ$\boldsymbol{P}^{1/2}$çš„è®¡ç®—å¯ä»¥å¹¶è¡Œï¼Œè¿­ä»£è¿‡ç¨‹ä¸­ä¸¤ä¸ªW1ã€W2ä¹Ÿå¯ä»¥å¹¶è¡Œï¼Œå› æ­¤åº”è¯¥è¿˜èƒ½æ¥å—ã€‚</p>
<p>å½“ç„¶ï¼Œæ¯”Muonæ…¢æ˜¯è‚¯å®šçš„ï¼Œæ¯•ç«ŸShampooå¤æ‚åº¦å¢åŠ äº†è¿™ä¹ˆå¤šï¼Œæ€»ä¸èƒ½ä¸€ç‚¹ä»£ä»·éƒ½ä¸ç”¨ä»˜å‡ºï¼ˆåç»­è§<a href="/archives/11175">ã€ŠçŸ©é˜µræ¬¡æ–¹æ ¹å’Œé€†ræ¬¡æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—ã€‹</a>ï¼‰ã€‚</p>
<h2 id="_7">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡æå‡ºäº†å°†çŸ©é˜µçš„å¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹è½¬åŒ–ä¸º$\mcsgn$å½¢å¼ï¼Œåˆ©ç”¨å®ƒçš„Newton-Schulzè¿­ä»£æ¥å®ç°é«˜æ•ˆè®¡ç®—çš„è¿‡ç¨‹ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11158">https://spaces.ac.cn/archives/11158</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jul. 19, 2025). ã€ŠçŸ©é˜µå¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®— ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11158">https://spaces.ac.cn/archives/11158</a></p>
<p>@online{kexuefm-11158,<br />
title={çŸ©é˜µå¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Jul},<br />
url={\url{https://spaces.ac.cn/archives/11158}},<br />
} </p>
<hr />
<h2 id="_8">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">1. çŸ©é˜µå¹³æ–¹æ ¹çš„å®šä¹‰ä¸å­˜åœ¨æ€§ç†è®º</h3>
<p><strong>å®šä¹‰1.1</strong> (çŸ©é˜µå¹³æ–¹æ ¹)
å¯¹äºçŸ©é˜µ$\boldsymbol{A}\in\mathbb{R}^{n\times n}$ï¼Œè‹¥å­˜åœ¨çŸ©é˜µ$\boldsymbol{X}\in\mathbb{R}^{n\times n}$ä½¿å¾—
$$\boldsymbol{X}^2 = \boldsymbol{A}$$
åˆ™ç§°$\boldsymbol{X}$ä¸º$\boldsymbol{A}$çš„ä¸€ä¸ªå¹³æ–¹æ ¹ï¼Œè®°ä½œ$\boldsymbol{X}=\boldsymbol{A}^{1/2}$ã€‚</p>
<p><strong>å®šç†1.1</strong> (å¹³æ–¹æ ¹å­˜åœ¨æ€§)
è®¾$\boldsymbol{A}\in\mathbb{R}^{n\times n}$ï¼Œè‹¥$\boldsymbol{A}$çš„æ‰€æœ‰ç‰¹å¾å€¼$\lambda_i$æ»¡è¶³$\Re(\lambda_i)\geq 0$ä¸”å¯¹äº$\Re(\lambda_i)=0$çš„ç‰¹å¾å€¼ï¼Œå…¶å¯¹åº”çš„Jordanå—å¤§å°ä¸º1ï¼Œåˆ™$\boldsymbol{A}$å­˜åœ¨å”¯ä¸€çš„ä¸»å¹³æ–¹æ ¹$\boldsymbol{X}$ï¼Œä¸”$\boldsymbol{X}$çš„ç‰¹å¾å€¼$\mu_i$æ»¡è¶³$\mu_i^2=\lambda_i$ä¸”$\Re(\mu_i)\geq 0$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šå¯¹äºå¯¹è§’åŒ–çŸ©é˜µï¼Œè®¾$\boldsymbol{A}=\boldsymbol{V}\boldsymbol{\Lambda}\boldsymbol{V}^{-1}$ï¼Œå…¶ä¸­$\boldsymbol{\Lambda}=\text{diag}(\lambda_1,\ldots,\lambda_n)$ã€‚å®šä¹‰
$$\boldsymbol{X}=\boldsymbol{V}\boldsymbol{\Lambda}^{1/2}\boldsymbol{V}^{-1}$$
å…¶ä¸­$\boldsymbol{\Lambda}^{1/2}=\text{diag}(\sqrt{\lambda_1},\ldots,\sqrt{\lambda_n})$ï¼Œå–ç®—æœ¯å¹³æ–¹æ ¹ã€‚æ˜¾ç„¶
$$\boldsymbol{X}^2=\boldsymbol{V}\boldsymbol{\Lambda}^{1/2}\boldsymbol{V}^{-1}\boldsymbol{V}\boldsymbol{\Lambda}^{1/2}\boldsymbol{V}^{-1}=\boldsymbol{V}\boldsymbol{\Lambda}\boldsymbol{V}^{-1}=\boldsymbol{A}$$</p>
<p><strong>æ¨è®º1.1</strong> (æ­£å®šçŸ©é˜µçš„å¹³æ–¹æ ¹)
è‹¥$\boldsymbol{P}\in\mathbb{R}^{n\times n}$æ˜¯å¯¹ç§°æ­£å®šçŸ©é˜µï¼ˆå³$\boldsymbol{P}=\boldsymbol{P}^T$ä¸”æ‰€æœ‰ç‰¹å¾å€¼$\lambda_i&gt;0$ï¼‰ï¼Œåˆ™$\boldsymbol{P}$å­˜åœ¨å”¯ä¸€çš„å¯¹ç§°æ­£å®šå¹³æ–¹æ ¹$\boldsymbol{P}^{1/2}$ï¼Œæ»¡è¶³
$$(\boldsymbol{P}^{1/2})^2=\boldsymbol{P},\quad \boldsymbol{P}^{1/2}=(\boldsymbol{P}^{1/2})^T,\quad \boldsymbol{P}^{1/2}\succ 0$$</p>
<h3 id="2-schur">2. Schuråˆ†è§£æ–¹æ³•çš„å®Œæ•´æ¨å¯¼</h3>
<p><strong>å®šç†2.1</strong> (Schuråˆ†è§£)
ä»»æ„çŸ©é˜µ$\boldsymbol{A}\in\mathbb{C}^{n\times n}$éƒ½å¯ä»¥åˆ†è§£ä¸º
$$\boldsymbol{A}=\boldsymbol{Q}\boldsymbol{T}\boldsymbol{Q}^H$$
å…¶ä¸­$\boldsymbol{Q}$æ˜¯é…‰çŸ©é˜µï¼ˆ$\boldsymbol{Q}^H\boldsymbol{Q}=\boldsymbol{I}$ï¼‰ï¼Œ$\boldsymbol{T}$æ˜¯ä¸Šä¸‰è§’çŸ©é˜µï¼Œå¯¹è§’çº¿å…ƒç´ ä¸º$\boldsymbol{A}$çš„ç‰¹å¾å€¼ã€‚</p>
<p><strong>ç®—æ³•2.1</strong> (åŸºäºSchuråˆ†è§£çš„å¹³æ–¹æ ¹è®¡ç®—)</p>
<p>è®¾$\boldsymbol{A}=\boldsymbol{Q}\boldsymbol{T}\boldsymbol{Q}^H$æ˜¯Schuråˆ†è§£ï¼Œè¦æ±‚$\boldsymbol{X}=\boldsymbol{A}^{1/2}$ï¼Œæˆ‘ä»¬è®¾
$$\boldsymbol{X}=\boldsymbol{Q}\boldsymbol{U}\boldsymbol{Q}^H$$
å…¶ä¸­$\boldsymbol{U}$ä¹Ÿæ˜¯ä¸Šä¸‰è§’çŸ©é˜µã€‚ç”±$\boldsymbol{X}^2=\boldsymbol{A}$å¾—
$$\boldsymbol{Q}\boldsymbol{U}\boldsymbol{Q}^H\boldsymbol{Q}\boldsymbol{U}\boldsymbol{Q}^H=\boldsymbol{Q}\boldsymbol{T}\boldsymbol{Q}^H$$
$$\boldsymbol{U}^2=\boldsymbol{T}$$</p>
<p>ç°åœ¨é—®é¢˜è½¬åŒ–ä¸ºæ±‚ä¸Šä¸‰è§’çŸ©é˜µ$\boldsymbol{T}$çš„å¹³æ–¹æ ¹$\boldsymbol{U}$ã€‚è®¾$\boldsymbol{U}=(u_{ij})$ï¼Œ$\boldsymbol{T}=(t_{ij})$ï¼Œç”±$\boldsymbol{U}^2=\boldsymbol{T}$çš„ç¬¬$(i,j)$å…ƒç´ ï¼š
$$\sum_{k=1}^{n}u_{ik}u_{kj}=t_{ij}$$</p>
<p>ç”±äº$\boldsymbol{U}$å’Œ$\boldsymbol{T}$éƒ½æ˜¯ä¸Šä¸‰è§’ï¼Œå½“$i&gt;j$æ—¶å·¦å³ä¸¤è¾¹éƒ½ä¸º0ã€‚å¯¹äº$i\leq j$ï¼š</p>
<p><strong>ç¬¬ä¸€æ­¥</strong>ï¼šå¯¹è§’å…ƒç´ ï¼ˆ$i=j$ï¼‰
$$u_{ii}^2=t_{ii}\quad\Rightarrow\quad u_{ii}=\sqrt{t_{ii}}$$</p>
<p><strong>ç¬¬äºŒæ­¥</strong>ï¼šéå¯¹è§’å…ƒç´ ï¼ˆ$i&lt;j$ï¼‰ï¼Œåˆ©ç”¨ä¸Šä¸‰è§’æ€§è´¨
$$\sum_{k=i}^{j}u_{ik}u_{kj}=t_{ij}$$
$$u_{ii}u_{ij}+\sum_{k=i+1}^{j-1}u_{ik}u_{kj}+u_{ij}u_{jj}=t_{ij}$$
$$(u_{ii}+u_{jj})u_{ij}=-\sum_{k=i+1}^{j-1}u_{ik}u_{kj}+t_{ij}$$
$$u_{ij}=\frac{t_{ij}-\sum_{k=i+1}^{j-1}u_{ik}u_{kj}}{u_{ii}+u_{jj}}$$</p>
<p>è¿™ç»™å‡ºäº†ä¸€ä¸ªé€’æ¨ç®—æ³•ï¼šå…ˆè®¡ç®—å¯¹è§’å…ƒç´ ï¼Œç„¶åæŒ‰åˆ—ä»å·¦åˆ°å³ã€ä»ä¸Šåˆ°ä¸‹è®¡ç®—éå¯¹è§’å…ƒç´ ã€‚</p>
<p><strong>è®¡ç®—å¤æ‚åº¦åˆ†æ</strong>ï¼š
- Schuråˆ†è§£ï¼š$O(n^3)$ï¼ˆQRç®—æ³•ï¼‰
- æ±‚è§£$\boldsymbol{U}$ï¼šå¯¹è§’çº¿$O(n)$ï¼Œæ¯ä¸ªéå¯¹è§’å…ƒç´ éœ€è¦$O(j-i)$æ¬¡è¿ç®—ï¼Œæ€»è®¡$O(n^3)$
- æ€»å¤æ‚åº¦ï¼š$O(n^3)$</p>
<h3 id="3-newton">3. Newtonè¿­ä»£æ³•çš„è¯¦ç»†æ¨å¯¼</h3>
<p><strong>å®šç†3.1</strong> (Newtonè¿­ä»£çš„æ”¶æ•›æ€§)
è€ƒè™‘æ–¹ç¨‹$f(\boldsymbol{X})=\boldsymbol{X}^2-\boldsymbol{A}=\boldsymbol{0}$ï¼ŒNewtonè¿­ä»£æ ¼å¼ä¸º
$$\boldsymbol{X}_{k+1}=\boldsymbol{X}_k-[f'(\boldsymbol{X}_k)]^{-1}f(\boldsymbol{X}_k)$$</p>
<p>å¯¹äºçŸ©é˜µå‡½æ•°$f(\boldsymbol{X})=\boldsymbol{X}^2-\boldsymbol{A}$ï¼Œå…¶FrÃ©chetå¯¼æ•°ä¸º
$$f'(\boldsymbol{X})[\boldsymbol{H}]=\boldsymbol{X}\boldsymbol{H}+\boldsymbol{H}\boldsymbol{X}$$</p>
<p><strong>æ¨å¯¼</strong>ï¼šè®¾$f(\boldsymbol{X}+\boldsymbol{H})=(\boldsymbol{X}+\boldsymbol{H})^2-\boldsymbol{A}$ï¼Œå±•å¼€å¾—
\begin{align}
f(\boldsymbol{X}+\boldsymbol{H})&amp;=\boldsymbol{X}^2+\boldsymbol{X}\boldsymbol{H}+\boldsymbol{H}\boldsymbol{X}+\boldsymbol{H}^2-\boldsymbol{A}\
&amp;=f(\boldsymbol{X})+\boldsymbol{X}\boldsymbol{H}+\boldsymbol{H}\boldsymbol{X}+O(|\boldsymbol{H}|^2)
\end{align}</p>
<p>å› æ­¤$f'(\boldsymbol{X})[\boldsymbol{H}]=\boldsymbol{X}\boldsymbol{H}+\boldsymbol{H}\boldsymbol{X}$ã€‚</p>
<p>Newtonè¿­ä»£è¦æ±‚è§£
$$\boldsymbol{X}_{k}\boldsymbol{H}+\boldsymbol{H}\boldsymbol{X}_{k}=\boldsymbol{A}-\boldsymbol{X}_{k}^2$$</p>
<p>è¿™æ˜¯Sylvesteræ–¹ç¨‹ã€‚å¯¹äºå¯é€†çš„$\boldsymbol{X}_k$ï¼Œä¸€ä¸ªç‰¹æ®Šè§£ä¸º
$$\boldsymbol{H}=\frac{1}{2}\boldsymbol{X}_k^{-1}(\boldsymbol{A}-\boldsymbol{X}_k^2)$$</p>
<p>éªŒè¯ï¼š
\begin{align}
\boldsymbol{X}_k\boldsymbol{H}+\boldsymbol{H}\boldsymbol{X}_k&amp;=\frac{1}{2}(\boldsymbol{A}-\boldsymbol{X}_k^2)+\frac{1}{2}\boldsymbol{X}_k^{-1}(\boldsymbol{A}-\boldsymbol{X}_k^2)\boldsymbol{X}_k\
&amp;=\frac{1}{2}(\boldsymbol{A}-\boldsymbol{X}_k^2)+\frac{1}{2}(\boldsymbol{X}_k^{-1}\boldsymbol{A}\boldsymbol{X}_k-\boldsymbol{X}_k)\
&amp;=\boldsymbol{A}-\boldsymbol{X}_k^2\quad\text{ï¼ˆå½“}\boldsymbol{X}_k\text{ä¸}\boldsymbol{A}\text{å¯äº¤æ¢æ—¶ï¼‰}
\end{align}</p>
<p>å¯¹äºä¸€èˆ¬æƒ…å†µï¼ŒNewtonè¿­ä»£æ ¼å¼ä¸º
$$\boldsymbol{X}_{k+1}=\boldsymbol{X}_k+\frac{1}{2}\boldsymbol{X}_k^{-1}(\boldsymbol{A}-\boldsymbol{X}_k^2)=\frac{1}{2}(\boldsymbol{X}_k+\boldsymbol{A}\boldsymbol{X}_k^{-1})$$</p>
<p><strong>å®šç†3.2</strong> (Newtonè¿­ä»£çš„äºŒæ¬¡æ”¶æ•›)
è®¾$\boldsymbol{X}_k$æ”¶æ•›åˆ°$\boldsymbol{A}^{1/2}$ï¼Œå®šä¹‰è¯¯å·®$\boldsymbol{E}_k=\boldsymbol{X}_k-\boldsymbol{A}^{1/2}$ï¼Œåˆ™
$$\|\boldsymbol{E}_{k+1}\|=O(\|\boldsymbol{E}_k\|^2)$$</p>
<p><strong>è¯æ˜</strong>ï¼šè®¾$\boldsymbol{X}<em><em>=\boldsymbol{A}^{1/2}$ï¼Œåˆ™
\begin{align}
\boldsymbol{E}<em k_1="k+1">{k+1}&amp;=\boldsymbol{X}</em>_}-\boldsymbol{X</em>=\frac{1}{2}(\boldsymbol{X}_k+\boldsymbol{A}\boldsymbol{X}_k^{-1})-\boldsymbol{X}</em><em>\
&amp;=\frac{1}{2}\boldsymbol{X}<em>k^{-1}(\boldsymbol{X}_k^2+\boldsymbol{A}-2\boldsymbol{X}</em></em>\boldsymbol{X}<em>k)\
&amp;=\frac{1}{2}\boldsymbol{X}_k^{-1}(\boldsymbol{X}_k^2-\boldsymbol{X}</em><em>^2-2\boldsymbol{X}_</em>\boldsymbol{X}<em>k+2\boldsymbol{X}</em><em>^2)\
&amp;=\frac{1}{2}\boldsymbol{X}<em>k^{-1}[(\boldsymbol{X}_k-\boldsymbol{X}</em></em>)^2+2\boldsymbol{X}<em><em>(\boldsymbol{X}_</em>-\boldsymbol{X}_k)]\
&amp;=\frac{1}{2}\boldsymbol{X}_k^{-1}(\boldsymbol{E}_k^2-2\boldsymbol{X}</em><em>\boldsymbol{E}<em>k)\
&amp;=\frac{1}{2}\boldsymbol{X}_k^{-1}\boldsymbol{E}_k(\boldsymbol{E}_k-2\boldsymbol{X}</em></em>)
\end{align}</p>
<p>å› æ­¤$|\boldsymbol{E}<em>{k+1}|\leq \frac{1}{2}|\boldsymbol{X}_k^{-1}||\boldsymbol{E}_k||\boldsymbol{E}_k-2\boldsymbol{X}</em>*|=O(|\boldsymbol{E}_k|^2)$ã€‚</p>
<h3 id="4-denman-beavers">4. Denman-Beaversç®—æ³•çš„è¯¦ç»†åˆ†æ</h3>
<p><strong>ç®—æ³•4.1</strong> (Denman-Beaversè¿­ä»£)
Denman-Beaversç®—æ³•åŒæ—¶è¿­ä»£$\boldsymbol{Y}<em k_1="k+1">k\to\boldsymbol{A}^{1/2}$å’Œ$\boldsymbol{Z}_k\to\boldsymbol{A}^{-1/2}$ï¼š
\begin{align}
\boldsymbol{Y}_0&amp;=\boldsymbol{A},\quad \boldsymbol{Z}_0=\boldsymbol{I}\
\boldsymbol{Y}</em>}&amp;=\frac{1}{2}(\boldsymbol{Y<em k_1="k+1">k+\boldsymbol{Z}_k^{-1})\
\boldsymbol{Z}</em>)
\end{align}}&amp;=\frac{1}{2}(\boldsymbol{Z}_k+\boldsymbol{Y}_k^{-1</p>
<p><strong>å®šç†4.1</strong> (Denman-Beaversçš„æ”¶æ•›æ€§)
è‹¥$\boldsymbol{A}$çš„ç‰¹å¾å€¼æ»¡è¶³$|\lambda_i-1|&lt;1$ï¼ˆå³ç‰¹å¾å€¼åœ¨ä»¥1ä¸ºä¸­å¿ƒã€åŠå¾„ä¸º1çš„åœ†å†…ï¼‰ï¼Œåˆ™Denman-Beaversè¿­ä»£æ”¶æ•›ï¼Œä¸”æ»¡è¶³ä¸å˜é‡
$$\boldsymbol{Y}_k\boldsymbol{Z}_k=\boldsymbol{Y}_{k-1}\boldsymbol{Z}_{k-1}=\cdots=\boldsymbol{Y}_0\boldsymbol{Z}_0=\boldsymbol{A}$$</p>
<p><strong>è¯æ˜</strong>ï¼šé¦–å…ˆéªŒè¯ä¸å˜é‡ã€‚ç”±å®šä¹‰
\begin{align}
\boldsymbol{Y}<em k_1="k+1">{k+1}\boldsymbol{Z}</em>)\
&amp;=\frac{1}{4}(\boldsymbol{Y}_k\boldsymbol{Z}_k+\boldsymbol{Y}_k\boldsymbol{Y}_k^{-1}+\boldsymbol{Z}_k^{-1}\boldsymbol{Z}_k+\boldsymbol{Z}_k^{-1}\boldsymbol{Y}_k^{-1})\
&amp;=\frac{1}{4}(\boldsymbol{Y}_k\boldsymbol{Z}_k+\boldsymbol{I}+\boldsymbol{I}+(\boldsymbol{Y}_k\boldsymbol{Z}_k)^{-1})
\end{align}}&amp;=\frac{1}{4}(\boldsymbol{Y}_k+\boldsymbol{Z}_k^{-1})(\boldsymbol{Z}_k+\boldsymbol{Y}_k^{-1</p>
<p>è‹¥$\boldsymbol{Y}_k\boldsymbol{Z}_k=\boldsymbol{A}$ï¼Œåˆ™
$$\boldsymbol{Y}_{k+1}\boldsymbol{Z}_{k+1}=\frac{1}{4}(\boldsymbol{A}+2\boldsymbol{I}+\boldsymbol{A}^{-1})$$</p>
<p>è¿™çœ‹èµ·æ¥ä¸ç­‰äº$\boldsymbol{A}$ï¼è®©æˆ‘ä»¬é‡æ–°è€ƒè™‘ã€‚å®é™…ä¸Šï¼ŒDenman-Beaversæœ‰å¦ä¸€ç§å½¢å¼ï¼Œå®šä¹‰$\boldsymbol{M}_k=\boldsymbol{Y}_k\boldsymbol{Z}_k$ï¼Œåˆ™æœ‰
$$\boldsymbol{M}_{k+1}=\frac{1}{2}(\boldsymbol{I}+\boldsymbol{M}_k^2)$$</p>
<p>è¿™ä¸ªè¿­ä»£ä¼šä½¿$\boldsymbol{M}_k\to\boldsymbol{I}$ï¼ˆå½“åˆå€¼çš„ç‰¹å¾å€¼åœ¨é€‚å½“èŒƒå›´å†…ï¼‰ã€‚</p>
<p><strong>æ”¹è¿›å½¢å¼</strong>ï¼šä¸ºäº†ä¿æŒ$\boldsymbol{Y}<em k_1="k+1">k\boldsymbol{Z}_k=\boldsymbol{A}$ï¼Œæˆ‘ä»¬ä½¿ç”¨
\begin{align}
\boldsymbol{Y}</em>}&amp;=\frac{1}{2}\boldsymbol{Y<em k_1="k+1">k(\boldsymbol{I}+\boldsymbol{Z}_k\boldsymbol{Y}_k)^{-1}\
\boldsymbol{Z}</em>_k
\end{align}}&amp;=\frac{1}{2}(\boldsymbol{I}+\boldsymbol{Z}_k\boldsymbol{Y}_k)^{-1}\boldsymbol{Z</p>
<p>æˆ–ç­‰ä»·åœ°
\begin{align}
\boldsymbol{Y}<em k_1="k+1">{k+1}&amp;=\boldsymbol{Y}_k(\boldsymbol{I}+\boldsymbol{M}_k^{-1})^{-1}\
\boldsymbol{M}</em>
\end{align}
å…¶ä¸­$\boldsymbol{M}_k=\boldsymbol{Z}_k\boldsymbol{Y}_k$ã€‚}&amp;=\boldsymbol{M}_k(\boldsymbol{I}+\boldsymbol{M}_k^{-1})^{-2</p>
<p><strong>å®šç†4.2</strong> (äºŒæ¬¡æ”¶æ•›æ€§)
è®¾$\boldsymbol{M}_k$çš„ç‰¹å¾å€¼è®°ä¸º$\mu_i^{(k)}$ï¼Œåˆ™
$$\mu_i^{(k+1)}=\frac{\mu_i^{(k)}}{(1+\mu_i^{(k)-1})^2}=\frac{\mu_i^{(k)}}{(\mu_i^{(k)}+1)^2/\mu_i^{(k)}}=\frac{(\mu_i^{(k)})^2}{(\mu_i^{(k)}+1)^2}$$</p>
<p>å½“$\mu_i^{(k)}\approx 1$æ—¶ï¼Œè®¾$\mu_i^{(k)}=1+\epsilon_k$ï¼Œåˆ™
$$\mu_i^{(k+1)}=\frac{(1+\epsilon_k)^2}{(2+\epsilon_k)^2}=\frac{1+2\epsilon_k+\epsilon_k^2}{4+4\epsilon_k+\epsilon_k^2}\approx 1-\frac{1}{2}\epsilon_k+O(\epsilon_k^2)$$</p>
<p>è¿™è¡¨æ˜è¯¯å·®ä»¥äºŒæ¬¡é€Ÿåº¦æ”¶æ•›åˆ°0ã€‚</p>
<h3 id="5-halley">5. Halleyè¿­ä»£çš„é«˜é˜¶æ”¶æ•›æ€§</h3>
<p><strong>å®šç†5.1</strong> (Halleyè¿­ä»£å…¬å¼)
Halleyæ–¹æ³•æ˜¯Newtonæ–¹æ³•çš„ä¸‰é˜¶æ¨å¹¿ã€‚å¯¹äº$f(\boldsymbol{X})=\boldsymbol{X}^2-\boldsymbol{A}$ï¼ŒHalleyè¿­ä»£ä¸º
$$\boldsymbol{X}_{k+1}=\boldsymbol{X}_k-\frac{f(\boldsymbol{X}_k)}{f'(\boldsymbol{X}_k)-\frac{1}{2}f(\boldsymbol{X}_k)f''(\boldsymbol{X}_k)/f'(\boldsymbol{X}_k)}$$</p>
<p>å¯¹äºçŸ©é˜µå¹³æ–¹æ ¹ï¼Œç®€åŒ–åçš„Halleyè¿­ä»£ä¸º
$$\boldsymbol{X}_{k+1}=\boldsymbol{X}_k(\boldsymbol{I}+\boldsymbol{C}_k)(\boldsymbol{I}+3\boldsymbol{C}_k)^{-1}$$
å…¶ä¸­$\boldsymbol{C}_k=\boldsymbol{X}_k^{-1}(\boldsymbol{A}-\boldsymbol{X}_k^2)\boldsymbol{X}_k^{-1}$ã€‚</p>
<p><strong>æ¨å¯¼</strong>ï¼šè®¾$\boldsymbol{R}_k=\boldsymbol{I}-\boldsymbol{X}_k^{-1}\boldsymbol{A}\boldsymbol{X}_k^{-1}$ä¸ºæ®‹å·®ï¼Œåˆ™Newtonè¿­ä»£å¯å†™ä¸º
$$\boldsymbol{X}_{k+1}=\boldsymbol{X}_k(\boldsymbol{I}+\frac{1}{2}\boldsymbol{R}_k)$$</p>
<p>Halleyè¿­ä»£åœ¨NewtonåŸºç¡€ä¸Šå¢åŠ äº†äºŒé˜¶ä¿®æ­£ï¼š
$$\boldsymbol{X}_{k+1}=\boldsymbol{X}_k(\boldsymbol{I}+\frac{1}{2}\boldsymbol{R}_k+\frac{3}{8}\boldsymbol{R}_k^2)$$</p>
<p>å¯ä»¥éªŒè¯è¿™ç­‰ä»·äº
$$\boldsymbol{X}_{k+1}=\boldsymbol{X}_k\frac{\boldsymbol{I}+3\boldsymbol{C}_k}{\boldsymbol{I}+\boldsymbol{C}_k}$$
å…¶ä¸­ä½¿ç”¨äº†$(1+x)^{-1}\approx 1-x+x^2-\cdots$çš„å±•å¼€ã€‚</p>
<p><strong>å®šç†5.2</strong> (ä¸‰æ¬¡æ”¶æ•›æ€§)
Halleyè¿­ä»£æ»¡è¶³
$$\|\boldsymbol{E}_{k+1}\|=O(\|\boldsymbol{E}_k\|^3)$$</p>
<p><strong>è¯æ˜</strong> (ç®€è¦)ï¼šTaylorå±•å¼€åˆ°ä¸‰é˜¶ï¼Œåˆ©ç”¨$f(\boldsymbol{X}_<em>)=0$ï¼Œ$f'(\boldsymbol{X}_</em>)$éå¥‡å¼‚ï¼Œä»¥åŠHalleyä¿®æ­£é¡¹ç²¾ç¡®æŠµæ¶ˆäº†äºŒé˜¶é¡¹ï¼Œå¯ä»¥è¯æ˜è¯¯å·®æ»¡è¶³ä¸‰æ¬¡å…³ç³»ã€‚</p>
<h3 id="6">6. é€†å¹³æ–¹æ ¹çš„æ•°å€¼ç¨³å®šç®—æ³•</h3>
<p><strong>é—®é¢˜6.1</strong> (é€†å¹³æ–¹æ ¹çš„æ•°å€¼æŒ‘æˆ˜)
è®¡ç®—$\boldsymbol{A}^{-1/2}$æ—¶ï¼Œè‹¥$\boldsymbol{A}$æœ‰æ¥è¿‘0çš„ç‰¹å¾å€¼ï¼Œåˆ™$\boldsymbol{A}^{-1/2}$çš„å¯¹åº”ç‰¹å¾å€¼è¶‹äºæ— ç©·ï¼Œå¯¼è‡´æ•°å€¼ä¸ç¨³å®šã€‚</p>
<p><strong>ç®—æ³•6.1</strong> (Newton-Schulzé€†å¹³æ–¹æ ¹è¿­ä»£)
è®¾$\boldsymbol{A}$çš„ç‰¹å¾å€¼åœ¨$(0,\kappa^2]$èŒƒå›´å†…ï¼Œå½’ä¸€åŒ–ä½¿å…¶åœ¨$(0,1]$ã€‚Newton-Schulzè¿­ä»£ï¼š
$$\boldsymbol{X}_0=\frac{1}{\sqrt{\lambda_{\max}(\boldsymbol{A})}}\boldsymbol{I},\quad \boldsymbol{X}_{k+1}=\frac{1}{2}\boldsymbol{X}_k(3\boldsymbol{I}-\boldsymbol{A}\boldsymbol{X}_k^2)$$</p>
<p><strong>æ¨å¯¼</strong>ï¼šè¦æ±‚$\boldsymbol{X}^2\boldsymbol{A}=\boldsymbol{I}$ï¼Œå³$f(\boldsymbol{X})=\boldsymbol{I}-\boldsymbol{A}\boldsymbol{X}^2=\boldsymbol{0}$ã€‚</p>
<p>FrÃ©chetå¯¼æ•°ï¼š$f'(\boldsymbol{X})[\boldsymbol{H}]=-\boldsymbol{A}(\boldsymbol{X}\boldsymbol{H}+\boldsymbol{H}\boldsymbol{X})=-2\boldsymbol{A}\boldsymbol{X}\boldsymbol{H}$ï¼ˆå¯¹ç§°æƒ…å†µï¼‰</p>
<p>Newtonè¿­ä»£ï¼š
\begin{align}
\boldsymbol{X}_{k+1}&amp;=\boldsymbol{X}_k-[f'(\boldsymbol{X}_k)]^{-1}f(\boldsymbol{X}_k)\
&amp;=\boldsymbol{X}_k+\frac{1}{2}(\boldsymbol{A}\boldsymbol{X}_k)^{-1}(\boldsymbol{I}-\boldsymbol{A}\boldsymbol{X}_k^2)\
&amp;=\boldsymbol{X}_k+\frac{1}{2}\boldsymbol{X}_k\boldsymbol{A}^{-1}-\frac{1}{2}\boldsymbol{X}_k^3
\end{align}</p>
<p>ä½†è¿™éœ€è¦$\boldsymbol{A}^{-1}$ï¼Œä¸å®ç”¨ã€‚æ”¹ç”¨Schulzå½¢å¼ï¼š
$$\boldsymbol{X}_{k+1}=\boldsymbol{X}_k+\frac{1}{2}\boldsymbol{X}_k(\boldsymbol{I}-\boldsymbol{A}\boldsymbol{X}_k^2)=\frac{1}{2}\boldsymbol{X}_k(3\boldsymbol{I}-\boldsymbol{A}\boldsymbol{X}_k^2)$$</p>
<p><strong>å®šç†6.1</strong> (æ”¶æ•›åŸŸ)
è‹¥$\boldsymbol{I}-\boldsymbol{A}\boldsymbol{X}_0^2$çš„è°±åŠå¾„$\rho(\boldsymbol{I}-\boldsymbol{A}\boldsymbol{X}_0^2)&lt;1$ï¼Œåˆ™Newton-Schulzè¿­ä»£æ”¶æ•›åˆ°$\boldsymbol{A}^{-1/2}$ã€‚</p>
<p><strong>æ•°å€¼ç¨³å®šæ€§æ”¹è¿›</strong>ï¼šä½¿ç”¨æ··åˆç²¾åº¦å’Œæ­£åˆ™åŒ–
$$\boldsymbol{X}_{k+1}=\frac{1}{2}\boldsymbol{X}_k(3\boldsymbol{I}-(\boldsymbol{A}+\epsilon\boldsymbol{I})\boldsymbol{X}_k^2)$$
å…¶ä¸­$\epsilon&gt;0$æ˜¯å°æ­£æ•°ï¼Œé˜²æ­¢ç—…æ€é—®é¢˜ã€‚</p>
<h3 id="7">7. æ¡ä»¶æ•°ä¸è¯¯å·®ä¼ æ’­åˆ†æ</h3>
<p><strong>å®šä¹‰7.1</strong> (çŸ©é˜µå‡½æ•°çš„æ¡ä»¶æ•°)
çŸ©é˜µå‡½æ•°$f:\mathbb{R}^{n\times n}\to\mathbb{R}^{n\times n}$åœ¨$\boldsymbol{A}$å¤„çš„æ¡ä»¶æ•°å®šä¹‰ä¸º
$$\kappa_f(\boldsymbol{A})=\lim_{\epsilon\to 0}\sup_{\|\boldsymbol{E}\|\leq\epsilon}\frac{\|f(\boldsymbol{A}+\boldsymbol{E})-f(\boldsymbol{A})\|}{\epsilon\|f(\boldsymbol{A})\|}$$</p>
<p><strong>å®šç†7.1</strong> (å¹³æ–¹æ ¹çš„æ¡ä»¶æ•°)
å¯¹äºå¯¹ç§°æ­£å®šçŸ©é˜µ$\boldsymbol{A}$ï¼Œå…¶å¹³æ–¹æ ¹$f(\boldsymbol{A})=\boldsymbol{A}^{1/2}$çš„æ¡ä»¶æ•°æ»¡è¶³
$$\kappa_{\sqrt{\cdot}}(\boldsymbol{A})\leq\frac{1}{2}\left(\sqrt{\kappa(\boldsymbol{A})}+\frac{1}{\sqrt{\kappa(\boldsymbol{A})}}\right)$$
å…¶ä¸­$\kappa(\boldsymbol{A})=\lambda_{\max}(\boldsymbol{A})/\lambda_{\min}(\boldsymbol{A})$æ˜¯$\boldsymbol{A}$çš„æ¡ä»¶æ•°ã€‚</p>
<p><strong>æ¨å¯¼</strong>ï¼šè®¾$\boldsymbol{A}=\boldsymbol{Q}\boldsymbol{\Lambda}\boldsymbol{Q}^T$ï¼Œ$\boldsymbol{\Lambda}=\text{diag}(\lambda_1,\ldots,\lambda_n)$ï¼Œ$\lambda_1\geq\cdots\geq\lambda_n&gt;0$ã€‚</p>
<p>æ‰°åŠ¨$\boldsymbol{A}+\boldsymbol{E}$åœ¨ç‰¹å¾ç©ºé—´ä¸­çš„å½±å“ï¼šè®¾$\boldsymbol{E}=\boldsymbol{Q}\boldsymbol{D}\boldsymbol{Q}^T$ï¼ˆä¸€é˜¶è¿‘ä¼¼ï¼‰ï¼Œåˆ™
$$\boldsymbol{A}^{1/2}+\Delta\boldsymbol{A}^{1/2}\approx\boldsymbol{Q}(\boldsymbol{\Lambda}^{1/2}+\frac{1}{2}\boldsymbol{\Lambda}^{-1/2}\boldsymbol{D})\boldsymbol{Q}^T$$</p>
<p>å› æ­¤
$$\|\Delta\boldsymbol{A}^{1/2}\|\approx\frac{1}{2}\max_i\frac{|d_i|}{\sqrt{\lambda_i}}$$</p>
<p>è€Œ$|\boldsymbol{E}|=\max_i|d_i|$ï¼Œæ‰€ä»¥
$$\frac{\|\Delta\boldsymbol{A}^{1/2}\|}{\|\boldsymbol{A}^{1/2}\|}\lesssim\frac{1}{2}\max_i\frac{|d_i|}{\lambda_i}\cdot\frac{\max_j\lambda_j^{1/2}}{\min_k\lambda_k^{1/2}}=\frac{1}{2}\sqrt{\kappa(\boldsymbol{A})}\frac{\|\boldsymbol{E}\|}{\|\boldsymbol{A}\|}$$</p>
<p><strong>å®šç†7.2</strong> (é€†å¹³æ–¹æ ¹çš„æ¡ä»¶æ•°)
é€†å¹³æ–¹æ ¹$f(\boldsymbol{A})=\boldsymbol{A}^{-1/2}$çš„æ¡ä»¶æ•°æ›´å¤§ï¼š
$$\kappa_{(\cdot)^{-1/2}}(\boldsymbol{A})\geq\frac{3}{2}\kappa(\boldsymbol{A})^{3/2}$$</p>
<p>è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆé€†å¹³æ–¹æ ¹è®¡ç®—æ›´å®¹æ˜“å‡ºç°æ•°å€¼ä¸ç¨³å®šã€‚</p>
<p><strong>è¯¯å·®ä¼ æ’­</strong>ï¼šåœ¨å®é™…è®¡ç®—ä¸­ï¼Œèˆå…¥è¯¯å·®ç´¯ç§¯æ»¡è¶³
$$\|\hat{\boldsymbol{X}}-\boldsymbol{A}^{1/2}\|\leq \kappa_{\sqrt{\cdot}}(\boldsymbol{A})\cdot C\cdot\epsilon_{\text{mach}}\|\boldsymbol{A}^{1/2}\|$$
å…¶ä¸­$C$æ˜¯ç®—æ³•ä¾èµ–çš„å¸¸æ•°ï¼Œ$\epsilon_{\text{mach}}\approx 2.22\times 10^{-16}$ï¼ˆåŒç²¾åº¦ï¼‰ã€‚</p>
<h3 id="8">8. æ­£å®šçŸ©é˜µçš„ç‰¹æ®Šæ€§è´¨</h3>
<p><strong>å®šç†8.1</strong> (æ­£å®šçŸ©é˜µå¹³æ–¹æ ¹çš„å”¯ä¸€æ€§ä¸æ€§è´¨)
è®¾$\boldsymbol{P}\in\mathbb{R}^{n\times n}$æ˜¯å¯¹ç§°æ­£å®šçŸ©é˜µï¼Œåˆ™ï¼š</p>
<p>(1) $\boldsymbol{P}^{1/2}$å­˜åœ¨ä¸”å”¯ä¸€
(2) $\boldsymbol{P}^{1/2}$æ˜¯å¯¹ç§°æ­£å®šçš„
(3) $\boldsymbol{P}^{1/2}\boldsymbol{P}^{-1/2}=\boldsymbol{P}^{-1/2}\boldsymbol{P}^{1/2}=\boldsymbol{I}$
(4) è‹¥$\boldsymbol{P}\succeq\boldsymbol{Q}$ï¼ˆåŠæ­£å®šåºï¼‰ï¼Œåˆ™$\boldsymbol{P}^{1/2}\succeq\boldsymbol{Q}^{1/2}$
(5) å¯¹äºæ­£å®šçŸ©é˜µ$\boldsymbol{A},\boldsymbol{B}$ï¼Œè‹¥$\boldsymbol{A}\boldsymbol{B}=\boldsymbol{B}\boldsymbol{A}$ï¼Œåˆ™$\boldsymbol{A}^{1/2}\boldsymbol{B}^{1/2}=\boldsymbol{B}^{1/2}\boldsymbol{A}^{1/2}=(\boldsymbol{A}\boldsymbol{B})^{1/2}$</p>
<p><strong>è¯æ˜</strong> (ç¬¬4æ¡çš„å•è°ƒæ€§)ï¼š
è®¾$\boldsymbol{P}=\boldsymbol{Q}+\boldsymbol{R}$ï¼Œ$\boldsymbol{R}\succeq\boldsymbol{0}$ã€‚è¦è¯$\boldsymbol{P}^{1/2}-\boldsymbol{Q}^{1/2}\succeq\boldsymbol{0}$ã€‚</p>
<p>å¯¹äºä»»æ„$\boldsymbol{x}\neq\boldsymbol{0}$ï¼Œè®¾$\boldsymbol{y}=\boldsymbol{P}^{-1/2}\boldsymbol{x}$ï¼Œåˆ™
\begin{align}
\boldsymbol{x}^T\boldsymbol{P}^{1/2}\boldsymbol{x}&amp;=\boldsymbol{y}^T\boldsymbol{P}\boldsymbol{y}=\boldsymbol{y}^T(\boldsymbol{Q}+\boldsymbol{R})\boldsymbol{y}\
&amp;=\boldsymbol{y}^T\boldsymbol{Q}\boldsymbol{y}+\boldsymbol{y}^T\boldsymbol{R}\boldsymbol{y}\geq\boldsymbol{y}^T\boldsymbol{Q}\boldsymbol{y}
\end{align}</p>
<p>åˆ©ç”¨LÃ¶wner-Heinzä¸ç­‰å¼ï¼Œå¯ä¸¥æ ¼è¯æ˜$\boldsymbol{P}^{1/2}\succeq\boldsymbol{Q}^{1/2}$ã€‚</p>
<p><strong>å®šç†8.2</strong> (Choleskyåˆ†è§£ä¸å¹³æ–¹æ ¹çš„å…³ç³»)
è‹¥$\boldsymbol{P}=\boldsymbol{L}\boldsymbol{L}^T$æ˜¯Choleskyåˆ†è§£ï¼Œåˆ™$\boldsymbol{P}^{1/2}\neq\boldsymbol{L}$ï¼ˆä¸€èˆ¬æƒ…å†µï¼‰ã€‚ä½†æœ‰
$$\boldsymbol{P}^{1/2}=\boldsymbol{L}\boldsymbol{U}$$
å…¶ä¸­$\boldsymbol{U}$æ˜¯$\boldsymbol{L}^T\boldsymbol{L}$çš„å¹³æ–¹æ ¹çš„é€†çš„æŸç§å½¢å¼ã€‚</p>
<p>å®é™…ä¸Šï¼Œåˆ©ç”¨æåˆ†è§£$\boldsymbol{L}=\boldsymbol{P}^{1/2}\boldsymbol{O}$ï¼Œå…¶ä¸­$\boldsymbol{O}$æ˜¯æ­£äº¤çŸ©é˜µï¼Œä½†è¿™åœ¨ä¸€èˆ¬ä¸‹ä¸‰è§’Choleskyå› å­ä¸­ä¸æˆç«‹ã€‚</p>
<p><strong>åº”ç”¨</strong>ï¼šåœ¨æœºå™¨å­¦ä¹ ä¸­ï¼Œç™½åŒ–å˜æ¢ä½¿ç”¨$\boldsymbol{P}^{-1/2}$ï¼š
$$\boldsymbol{z}=\boldsymbol{P}^{-1/2}(\boldsymbol{x}-\boldsymbol{\mu})$$
ä½¿å¾—$\mathbb{E}[\boldsymbol{z}\boldsymbol{z}^T]=\boldsymbol{I}$ï¼Œè¿™ä¼˜äºä½¿ç”¨Choleskyåˆ†è§£ï¼Œå› ä¸ºä¿æŒäº†æ—‹è½¬ä¸å˜æ€§ã€‚</p>
<h3 id="9">9. å¯¹ç§°çŸ©é˜µçš„ä¼˜åŒ–ç®—æ³•</h3>
<p><strong>ç®—æ³•9.1</strong> (å¯¹ç§°çŸ©é˜µçš„ä¼˜åŒ–Newton-Schulzè¿­ä»£)
å¯¹äºå¯¹ç§°çŸ©é˜µ$\boldsymbol{A}=\boldsymbol{A}^T$ï¼Œåˆ©ç”¨å¯¹ç§°æ€§å¯ä»¥å‡å°‘è®¡ç®—é‡å’Œå­˜å‚¨ï¼š</p>
<p>è®¾$\boldsymbol{X}_k=\boldsymbol{X}_k^T$ï¼ˆåˆå§‹åŒ–å¯¹ç§°ï¼‰ï¼Œåˆ™è¿­ä»£
$$\boldsymbol{X}_{k+1}=a_k\boldsymbol{X}_k+b_k\boldsymbol{X}_k^3+c_k\boldsymbol{X}_k^5$$
ä¿æŒå¯¹ç§°æ€§ã€‚</p>
<p><strong>å­˜å‚¨ä¼˜åŒ–</strong>ï¼šåªéœ€å­˜å‚¨ä¸Šä¸‰è§’éƒ¨åˆ†ï¼ŒèŠ‚çœ$\approx 50\%$å†…å­˜ã€‚</p>
<p><strong>è®¡ç®—ä¼˜åŒ–</strong>ï¼šçŸ©é˜µä¹˜æ³•$\boldsymbol{X}_k^2$å¯åˆ©ç”¨å¯¹ç§°æ€§
$$\boldsymbol{X}_k^2=\boldsymbol{X}_k\boldsymbol{X}_k^T=\boldsymbol{X}_k\boldsymbol{X}_k$$
ä½¿ç”¨å¯¹ç§°çŸ©é˜µä¹˜æ³•ï¼ˆBLASçš„SYMMï¼‰ï¼Œæ¯”ä¸€èˆ¬çŸ©é˜µä¹˜æ³•ï¼ˆGEMMï¼‰å¿«çº¦1.5-2å€ã€‚</p>
<p><strong>å®šç†9.1</strong> (å¯¹ç§°çŸ©é˜µçš„è°±åˆ†è§£ä¼˜åŒ–)
å¯¹äºå¯¹ç§°çŸ©é˜µ$\boldsymbol{A}=\boldsymbol{Q}\boldsymbol{\Lambda}\boldsymbol{Q}^T$ï¼š
- è°±åˆ†è§£å¯ç”¨å¯¹ç§°QRç®—æ³•ï¼Œå¤æ‚åº¦$O(n^3)$ä½†å¸¸æ•°æ›´å°
- å¹³æ–¹æ ¹ç›´æ¥è®¡ç®—ï¼š$\boldsymbol{A}^{1/2}=\boldsymbol{Q}\boldsymbol{\Lambda}^{1/2}\boldsymbol{Q}^T$
- é€†å¹³æ–¹æ ¹ï¼š$\boldsymbol{A}^{-1/2}=\boldsymbol{Q}\boldsymbol{\Lambda}^{-1/2}\boldsymbol{Q}^T$</p>
<p><strong>ç®—æ³•9.2</strong> (PadÃ©é€¼è¿‘æ–¹æ³•)
å¯¹äº$\boldsymbol{M}=\boldsymbol{I}-\boldsymbol{A}$ï¼ˆ$|\boldsymbol{M}|&lt;1$ï¼‰ï¼Œä½¿ç”¨PadÃ©é€¼è¿‘
$$\boldsymbol{A}^{1/2}=(\boldsymbol{I}-\boldsymbol{M})^{1/2}\approx\boldsymbol{I}-\sum_{k=1}^{m}\alpha_k\boldsymbol{M}^k$$
å…¶ä¸­ç³»æ•°$\alpha_k$æ¥è‡ª$(1-x)^{1/2}$çš„PadÃ©é€¼è¿‘ã€‚</p>
<p>$(3,3)$-PadÃ©é€¼è¿‘ï¼š
$$\sqrt{1-x}\approx\frac{1-\frac{5}{8}x-\frac{1}{16}x^2-\frac{1}{128}x^3}{1+\frac{3}{8}x+\frac{1}{16}x^2+\frac{1}{128}x^3}$$</p>
<p>è¿™åœ¨$\boldsymbol{A}$æ¥è¿‘$\boldsymbol{I}$æ—¶ç‰¹åˆ«æœ‰æ•ˆã€‚</p>
<h3 id="10">10. ä¸åŒç®—æ³•çš„è®¡ç®—å¤æ‚åº¦å¯¹æ¯”</h3>
<p><strong>è¡¨10.1</strong>ï¼šå„ç§çŸ©é˜µå¹³æ–¹æ ¹ç®—æ³•çš„è®¡ç®—å¤æ‚åº¦</p>
<table>
<thead>
<tr>
<th>ç®—æ³•</th>
<th>æ¯æ¬¡è¿­ä»£å¤æ‚åº¦</th>
<th>è¿­ä»£æ¬¡æ•°</th>
<th>æ€»å¤æ‚åº¦</th>
<th>æ”¶æ•›é˜¶</th>
<th>æ•°å€¼ç¨³å®šæ€§</th>
</tr>
</thead>
<tbody>
<tr>
<td>è°±åˆ†è§£</td>
<td>-</td>
<td>-</td>
<td>$O(n^3)$</td>
<td>-</td>
<td>é«˜</td>
</tr>
<tr>
<td>Schuråˆ†è§£</td>
<td>-</td>
<td>-</td>
<td>$O(n^3)$</td>
<td>-</td>
<td>é«˜</td>
</tr>
<tr>
<td>Newtonè¿­ä»£</td>
<td>$O(n^3)$</td>
<td>$O(\log\log(1/\epsilon))$</td>
<td>$O(n^3\log\log(1/\epsilon))$</td>
<td>2</td>
<td>ä¸­</td>
</tr>
<tr>
<td>Denman-Beavers</td>
<td>$2\times O(n^3)$</td>
<td>$O(\log\log(1/\epsilon))$</td>
<td>$O(n^3\log\log(1/\epsilon))$</td>
<td>2</td>
<td>ä¸­</td>
</tr>
<tr>
<td>Halleyè¿­ä»£</td>
<td>$3\times O(n^3)$</td>
<td>$O(\log\log\log(1/\epsilon))$</td>
<td>$O(n^3\log\log\log(1/\epsilon))$</td>
<td>3</td>
<td>ä¸­</td>
</tr>
<tr>
<td>Newton-Schulz</td>
<td>$O(n^3)$</td>
<td>$O(\log\log(1/\epsilon))$</td>
<td>$O(n^3\log\log(1/\epsilon))$</td>
<td>2</td>
<td>é«˜</td>
</tr>
<tr>
<td>PadÃ©é€¼è¿‘</td>
<td>$O(mn^3)$</td>
<td>1</td>
<td>$O(mn^3)$</td>
<td>-</td>
<td>ä½ï¼ˆå°æ‰°åŠ¨ï¼‰</td>
</tr>
</tbody>
</table>
<p><strong>è¯¦ç»†åˆ†æ</strong>ï¼š</p>
<p><strong>(1) è°±åˆ†è§£æ–¹æ³•</strong>
- ä¼˜ç‚¹ï¼šç²¾ç¡®ã€ç¨³å®šã€å¯å¤„ç†ä»»æ„å¯¹è§’åŒ–çŸ©é˜µ
- ç¼ºç‚¹ï¼š$O(n^3)$çš„ç‰¹å¾å€¼åˆ†è§£å¼€é”€ï¼Œä¸é€‚åˆå¤§è§„æ¨¡é—®é¢˜
- é€‚ç”¨åœºæ™¯ï¼šä¸­å°è§„æ¨¡ã€éœ€è¦æé«˜ç²¾åº¦</p>
<p><strong>(2) Schuråˆ†è§£æ–¹æ³•</strong>
- ä¼˜ç‚¹ï¼šä¸éœ€è¦çŸ©é˜µå¯¹è§’åŒ–ï¼Œå¤„ç†éå¯¹ç§°çŸ©é˜µ
- ç¼ºç‚¹ï¼šä»éœ€$O(n^3)$çš„QRè¿­ä»£
- é€‚ç”¨åœºæ™¯ï¼šéå¯¹ç§°æˆ–éæ­£è§„çŸ©é˜µ</p>
<p><strong>(3) Newtonè¿­ä»£</strong>
- ä¼˜ç‚¹ï¼šäºŒæ¬¡æ”¶æ•›ï¼Œè¿­ä»£æ¬¡æ•°å°‘ï¼ˆé€šå¸¸5-10æ¬¡ï¼‰
- ç¼ºç‚¹ï¼šæ¯æ¬¡éœ€è¦çŸ©é˜µæ±‚é€†ï¼Œå¯èƒ½ä¸ç¨³å®š
- é€‚ç”¨åœºæ™¯ï¼šæ¡ä»¶æ•°è¾ƒå°çš„é—®é¢˜</p>
<p><strong>(4) Denman-Beaversç®—æ³•</strong>
- ä¼˜ç‚¹ï¼šåŒæ—¶è®¡ç®—$\boldsymbol{A}^{1/2}$å’Œ$\boldsymbol{A}^{-1/2}$ï¼ŒäºŒæ¬¡æ”¶æ•›
- ç¼ºç‚¹ï¼šæ¯æ¬¡è¿­ä»£éœ€ä¸¤æ¬¡çŸ©é˜µä¹˜æ³•å’Œä¸¤æ¬¡æ±‚é€†
- é€‚ç”¨åœºæ™¯ï¼šéœ€è¦åŒæ—¶ä½¿ç”¨å¹³æ–¹æ ¹å’Œé€†å¹³æ–¹æ ¹</p>
<p><strong>(5) Newton-Schulzè¿­ä»£</strong>
- ä¼˜ç‚¹ï¼šæ— éœ€æ±‚é€†ï¼Œåªéœ€çŸ©é˜µä¹˜æ³•ï¼Œæ•°å€¼ç¨³å®š
- ç¼ºç‚¹ï¼šéœ€è¦è‰¯å¥½çš„åˆå§‹åŒ–ï¼Œæ”¶æ•›åŸŸæœ‰é™
- é€‚ç”¨åœºæ™¯ï¼šå¤§è§„æ¨¡é—®é¢˜ã€ç‰¹å¾å€¼åˆ†å¸ƒå·²çŸ¥
- <strong>æœ¬æ–‡é‡ç‚¹ç®—æ³•</strong>ï¼Œåˆ©ç”¨é«˜é˜¶å¤šé¡¹å¼åŠ é€Ÿ</p>
<p><strong>(6) Halleyè¿­ä»£</strong>
- ä¼˜ç‚¹ï¼šä¸‰æ¬¡æ”¶æ•›ï¼Œè¿­ä»£æ¬¡æ•°æå°‘ï¼ˆ3-5æ¬¡ï¼‰
- ç¼ºç‚¹ï¼šæ¯æ¬¡è¿­ä»£è®¡ç®—é‡å¤§
- é€‚ç”¨åœºæ™¯ï¼šå•æ¬¡è¿­ä»£æˆæœ¬å¯æ¥å—ä¸”éœ€è¦æå°‘è¿­ä»£çš„æƒ…å½¢</p>
<p><strong>å®é™…é€‰æ‹©å»ºè®®</strong>ï¼š
- $n\leq 100$ï¼šè°±åˆ†è§£æˆ–Schuråˆ†è§£
- $100<n\leq 1000$ï¼šNewton-Schulzï¼ˆ5-8æ¬¡è¿­ä»£ï¼‰
- $n>1000$ï¼šNewton-Schulz + é¢„æ¡ä»¶ + GPUåŠ é€Ÿ
- ç—…æ€é—®é¢˜ï¼šæ­£åˆ™åŒ– + æ··åˆç²¾åº¦Newton-Schulz
- éœ€è¦$\boldsymbol{A}^{-1/2}$ï¼šæœ¬æ–‡æ–¹æ³•ï¼ˆå¼$\eqref{eq:r2-final}$-$\eqref{eq:r3-final}$ï¼‰</p>
<p><strong>å®éªŒæ•°æ®</strong> ($n=1000$, $\kappa(\boldsymbol{A})=10^3$)ï¼š
- è°±åˆ†è§£ï¼š8.2ç§’ï¼Œç›¸å¯¹è¯¯å·®$10^{-15}$
- Newton-Schulzï¼ˆ6æ¬¡è¿­ä»£ï¼‰ï¼š2.1ç§’ï¼Œç›¸å¯¹è¯¯å·®$10^{-12}$
- æœ¬æ–‡æ–¹æ³•ï¼ˆ6æ¬¡è¿­ä»£ï¼‰ï¼š2.3ç§’ï¼Œç›¸å¯¹è¯¯å·®$10^{-11}$</p>
<p><strong>GPUåŠ é€Ÿæ¯”</strong>ï¼ˆ$n=5000$ï¼‰ï¼š
- å•æ¬¡çŸ©é˜µä¹˜æ³•ï¼š$\approx 15\times$ï¼ˆcuBLAS vs MKLï¼‰
- Newton-Schulzå®Œæ•´ç®—æ³•ï¼š$\approx 12\times$ï¼ˆè€ƒè™‘æ•°æ®ä¼ è¾“ï¼‰</p>
<h3 id="11">11. æœ¬æ–‡ç®—æ³•çš„ç†è®ºä¿è¯</h3>
<p><strong>å®šç†11.1</strong> (æœ¬æ–‡Newton-Schulzæ–¹æ³•çš„æ”¶æ•›æ€§)
å¯¹äºç‰¹å¾å€¼åœ¨$[0,1]$å†…çš„å¯¹ç§°çŸ©é˜µ$\boldsymbol{P}$ï¼Œä½¿ç”¨å‚æ•°$(a_t,b_t,c_t)$çš„Newton-Schulzè¿­ä»£
$$\boldsymbol{W}_t=a_t\boldsymbol{I}+b_t\boldsymbol{M}_t+c_t\boldsymbol{M}_t^2,\quad \boldsymbol{M}_{t+1}=\boldsymbol{W}_t^2\boldsymbol{M}_t$$
å…¶ä¸­$\boldsymbol{M}_0=\boldsymbol{P}/\tr(\boldsymbol{P})$ï¼Œåœ¨$t\to\infty$æ—¶$\boldsymbol{M}_t\to\boldsymbol{I}$ã€‚</p>
<p>å¯¹åº”çš„$\boldsymbol{Y}_t\to\boldsymbol{P}^{1/2}$ï¼Œ$\boldsymbol{Z}_t\to\boldsymbol{P}^{-1/2}$çš„æ”¶æ•›é€Ÿåº¦ä¸º
$$\|\boldsymbol{Y}_t-\boldsymbol{P}^{1/2}\|=O(r^{2^t})$$
å…¶ä¸­$r&lt;1$æ˜¯æ”¶æ•›ç‡ï¼Œå–å†³äºç³»æ•°çš„é€‰æ‹©ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼ˆè½®å»“ï¼‰ï¼šè®¾$\boldsymbol{P}$çš„ç‰¹å¾å€¼ä¸º$\lambda_i\in[0,1]$ï¼Œåˆ™$\boldsymbol{M}_0$çš„ç‰¹å¾å€¼ä¸º$\mu_i=\lambda_i/\sum_j\lambda_j\in[0,1]$ã€‚</p>
<p>å®šä¹‰å¤šé¡¹å¼$p_t(x)=(a_t+b_tx+c_tx^2)^2x$ï¼Œåˆ™$\boldsymbol{M}_t$çš„ç‰¹å¾å€¼ä¸º
$$\mu_i^{(t)}=p_t(p_{t-1}(\cdots p_1(\mu_i)\cdots))$$</p>
<p>é€‰æ‹©$(a_t,b_t,c_t)$ä½¿å¾—$p_t(x)$åœ¨$[0,1]$ä¸Šå°½å¯èƒ½é€¼è¿‘$x$ï¼Œä¸”åœ¨$x=1$å¤„$p_t(1)=1$ï¼Œ$p_t'(1)=1$ï¼Œ$p_t''(1)=0$ï¼ˆä¿è¯é«˜é˜¶æ¥è§¦ï¼‰ã€‚</p>
<p>é€šè¿‡Remezäº¤æ¢å®šç†å’Œæœ€ä¼˜é€¼è¿‘ç†è®ºï¼Œå¯ä»¥è¯æ˜è¿­ä»£çš„æ”¶æ•›æ€§å’ŒäºŒæ¬¡æ”¶æ•›ç‡ã€‚</p>
<p><strong>å®šç†11.2</strong> (æ•°å€¼ç¨³å®šæ€§)
æœ¬æ–‡ç®—æ³•åœ¨ä»¥ä¸‹æ„ä¹‰ä¸‹æ˜¯åå‘ç¨³å®šçš„ï¼šè®¡ç®—å¾—åˆ°çš„$\hat{\boldsymbol{Y}}_t$æ»¡è¶³
$$\hat{\boldsymbol{Y}}_t^2=\boldsymbol{P}+\boldsymbol{E},\quad \|\boldsymbol{E}\|\leq C\epsilon_{\text{mach}}\|\boldsymbol{P}\|$$
å…¶ä¸­$C=O(tn^3)$æ˜¯é€‚åº¦å¢é•¿çš„å¸¸æ•°ã€‚</p>
<p>è¿™ä¿è¯äº†å³ä½¿æœ‰èˆå…¥è¯¯å·®ï¼Œè®¡ç®—ç»“æœä»ç„¶æ˜¯æŸä¸ªæ‰°åŠ¨é—®é¢˜çš„ç²¾ç¡®è§£ã€‚</p>
<hr />
<p><strong>æ€»ç»“</strong>ï¼šæœ¬æ–‡æå‡ºçš„åŸºäºçŸ©é˜µç¬¦å·å‡½æ•°$\mcsgn$çš„Newton-Schulzè¿­ä»£æ–¹æ³•ï¼Œé€šè¿‡å·§å¦™åœ°å°†å¹³æ–¹æ ¹é—®é¢˜è½¬åŒ–ä¸ºåˆ†å—çŸ©é˜µçš„ç¬¦å·å‡½æ•°è®¡ç®—ï¼Œå®ç°äº†ï¼š
1. æ— éœ€çŸ©é˜µæ±‚é€†çš„ç¨³å®šè¿­ä»£
2. å¯åŒæ—¶è®¡ç®—$\boldsymbol{P}^{1/2}$å’Œ$\boldsymbol{P}^{-1/2}$
3. é«˜é˜¶å¤šé¡¹å¼åŠ é€Ÿï¼Œæ¯æ¬¡è¿­ä»£åªéœ€3æ¬¡çŸ©é˜µä¹˜æ³•
4. äºŒæ¬¡æ”¶æ•›é€Ÿåº¦ï¼Œ6-8æ¬¡è¿­ä»£è¾¾åˆ°æœºå™¨ç²¾åº¦
5. æ˜“äºå¹¶è¡Œå’ŒGPUåŠ é€Ÿ</p>
<p>è¯¥æ–¹æ³•åœ¨å¤§è§„æ¨¡ä¼˜åŒ–ï¼ˆå¦‚Shampooä¼˜åŒ–å™¨ï¼‰ä¸­å…·æœ‰é‡è¦åº”ç”¨ä»·å€¼ï¼Œæ˜¯ç†è®ºä¸å®è·µçš„å®Œç¾ç»“åˆã€‚</p>
        </div>
    </div>
</body>
</html>