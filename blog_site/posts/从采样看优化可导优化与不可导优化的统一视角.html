<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»é‡‡æ ·çœ‹ä¼˜åŒ–ï¼šå¯å¯¼ä¼˜åŒ–ä¸ä¸å¯å¯¼ä¼˜åŒ–çš„ç»Ÿä¸€è§†è§’</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ä»é‡‡æ ·çœ‹ä¼˜åŒ–ï¼šå¯å¯¼ä¼˜åŒ–ä¸ä¸å¯å¯¼ä¼˜åŒ–çš„ç»Ÿä¸€è§†è§’</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-12-31 | ğŸ“„ å¤§å°: 16.6 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/7521">https://spaces.ac.cn/archives/7521</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ä¸å°‘è¯»è€…éƒ½åº”è¯¥çŸ¥é“ï¼ŒæŸå¤±å‡½æ•°ä¸è¯„æµ‹æŒ‡æ ‡çš„ä¸ä¸€è‡´æ€§æ˜¯æœºå™¨å­¦ä¹ çš„å…¸å‹ç°è±¡ä¹‹ä¸€ï¼Œæ¯”å¦‚åˆ†ç±»é—®é¢˜ä¸­æŸå¤±å‡½æ•°ç”¨äº¤å‰ç†µï¼Œè¯„æµ‹æŒ‡æ ‡åˆ™æ˜¯å‡†ç¡®ç‡æˆ–è€…F1ï¼Œåˆæ¯”å¦‚æ–‡æœ¬ç”Ÿæˆä¸­æŸå¤±å‡½æ•°æ˜¯teacher-forcingå½¢å¼çš„äº¤å‰ç†µï¼Œè¯„æµ‹æŒ‡æ ‡åˆ™æ˜¯BLEUã€ROUGEç­‰ã€‚ç†æƒ³æƒ…å†µä¸‹ï¼Œå½“ç„¶æ˜¯è¯„æµ‹ä»€ä¹ˆæŒ‡æ ‡ï¼Œæˆ‘ä»¬å°±å»ä¼˜åŒ–è¿™ä¸ªæŒ‡æ ‡ï¼Œç„¶è€Œè¯„æµ‹æŒ‡æ ‡é€šå¸¸éƒ½æ˜¯ä¸å¯å¯¼çš„ï¼Œè€Œæˆ‘ä»¬å¤šæ•°éƒ½æ˜¯ä½¿ç”¨åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–å™¨ï¼Œè¿™å°±è¦æ±‚æœ€å°åŒ–çš„ç›®æ ‡å¿…é¡»æ˜¯å¯å¯¼çš„ï¼Œè¿™æ˜¯ä¸ä¸€è‡´æ€§çš„æ¥æºã€‚</p>
<p>å‰äº›å¤©åœ¨arxivåˆ·åˆ°äº†ä¸€ç¯‡åä¸º<a href="https://papers.cool/arxiv/2006.03158">ã€ŠMLE-guided parameter search for task loss minimization in neural sequence modelingã€‹</a>çš„è®ºæ–‡ï¼Œé¡¾åæ€ä¹‰ï¼Œå®ƒæ˜¯ç ”ç©¶å¦‚ä½•ç›´æ¥ä¼˜åŒ–æ–‡æœ¬ç”Ÿæˆçš„è¯„æµ‹æŒ‡æ ‡çš„ã€‚ç»è¿‡é˜…è¯»ï¼Œç¬”è€…å‘ç°è¿™ç¯‡è®ºæ–‡å¾ˆæœ‰ä»·å€¼ï¼Œäº‹å®ä¸Šå®ƒæä¾›äº†ä¸€ç§ä¼˜åŒ–è¯„æµ‹æŒ‡æ ‡çš„æ–°æ€è·¯ï¼Œé€‚ç”¨èŒƒå›´å¹¶ä¸å±€é™äºæ–‡æœ¬ç”Ÿæˆä¸­ã€‚ä¸ä»…å¦‚æ­¤ï¼Œå®ƒç”šè‡³è¿˜åŒ…å«äº†ä¸€ç§ç†è§£å¯å¯¼ä¼˜åŒ–ä¸ä¸å¯å¯¼ä¼˜åŒ–çš„ç»Ÿä¸€è§†è§’ã€‚</p>
<h2 id="_1">é‡‡æ ·è§†è§’</h2>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‡‡æ ·çš„è§†è§’æ¥é‡æ–°çœ‹å¾…ä¼˜åŒ–é—®é¢˜ï¼šè®¾æ¨¡å‹å½“å‰å‚æ•°ä¸º$\theta$ï¼Œä¼˜åŒ–ç›®æ ‡ä¸º$l(\theta)$ï¼Œæˆ‘ä»¬å¸Œæœ›å†³å®šä¸‹ä¸€æ­¥çš„æ›´æ–°é‡$\Delta\theta$ï¼Œä¸ºæ­¤ï¼Œæˆ‘ä»¬å…ˆæ„å»ºåˆ†å¸ƒ<br />
\begin{equation}p(\Delta\theta|\theta)=\frac{e^{-[l(\theta + \Delta\theta) - l(\theta)]/\alpha}}{Z(\theta)},\quad Z(\theta) = \int e^{-[l(\theta + \Delta\theta) - l(\theta)]/\alpha} d(\Delta\theta)\end{equation}<br />
å…¶ä¸­$\alpha &gt; 0$æ˜¯ä¸€ä¸ªè¶…å‚æ•°ã€‚è¿™ä¸ªåˆ†å¸ƒçš„æ„ä¹‰å¾ˆæ˜æ˜¾ï¼Œå°±æ˜¯å°†$\Delta\theta$è§†ä¸ºä¸€ä¸ªéšæœºå˜é‡ï¼Œè€Œä½¿å¾—$l(\theta + \Delta\theta)$è¶Šå°çš„$\Delta\theta$å‡ºç°æ¦‚ç‡åˆ™è¶Šå¤§ã€‚æœ‰äº†è¿™ä¸ªåˆ†å¸ƒä¹‹åï¼Œæˆ‘ä»¬å®šä¹‰ä¸‹ä¸€æ­¥çš„æ›´æ–°é‡ä¸ºå®ƒçš„æœŸæœ›<br />
\begin{equation}\Delta\theta_* = \int p(\Delta\theta|\theta)\Delta\theta d(\Delta\theta) = \mathbb{E}_{\Delta\theta\sim p(\Delta\theta|\theta)}[\Delta\theta]\label{eq:delta}\end{equation}</p>
<p>åœ¨è¿™ä¸ªè§†è§’é‡Œè¾¹ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å¯¹$l(\theta)$çš„å¯å¯¼æ€§åšå‡è®¾ï¼Œå› æ­¤ä¸Šè¿°å®šä¹‰å¯¹äºå¯å¯¼å’Œä¸å¯å¯¼çš„ä¼˜åŒ–éƒ½æ˜¯é€šç”¨çš„ã€‚å¦å¤–ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°ƒèŠ‚$\alpha$æ¥æ§åˆ¶æ›´æ–°çš„ç¨³å®šæ€§ï¼Œå½“$\alpha\to 0$æ—¶ï¼Œç”±$p(\Delta\theta|\theta)$çš„å®šä¹‰å¯çŸ¥åªæœ‰ä½¿å¾—$l(\theta + \Delta\theta)$æœ€å°çš„$\Delta\theta$çš„æ¦‚ç‡æ‰ä¸ä¸º0ï¼Œè¿™æ„å‘³ç€$\Delta\theta_<em>$å°±æ˜¯ä¸‹é™å¾—æœ€å¿«çš„æ–¹å‘ï¼›å½“$\alpha\to +\infty$æ—¶ï¼Œ$p(\Delta\theta|\theta)$è¶‹äºå‡åŒ€åˆ†å¸ƒï¼Œæ‰€ä»¥$\Delta\theta_</em>$è¶‹äº0ï¼Œä¹Ÿå°±æ˜¯æœ€ç¨³ã€‚é€šè¿‡é€‰æ‹©ä¸€ä¸ªé€‚åˆçš„$\alpha$ï¼Œç†è®ºä¸Šå¯ä»¥è®©ä¼˜åŒ–è¿‡ç¨‹åœ¨â€œå¿«â€ä¸â€œç¨³â€ä¹‹é—´è¾¾åˆ°ä¸€ä¸ªå¥½çš„å¹³è¡¡ï¼Œè¿™åœ¨ç›´è§‰ä¸Šèƒ½å–å¾—æ³›åŒ–æ€§èƒ½æ›´å¥½çš„ç»“æœã€‚</p>
<p>å½“ç„¶ï¼Œåˆ°ç›®å‰ä¸ºæ­¢çš„å®šä¹‰è¿˜æ˜¯ç†è®ºä¸Šçš„ï¼Œæˆ‘ä»¬è¿˜ä¸çŸ¥é“$p(\Delta\theta|\theta)$çš„è§£æå½¢å¼ï¼Œä¹Ÿä¸çŸ¥é“å¦‚ä½•ä»é‡Œè¾¹é‡‡æ ·ï¼Œæ›´ä¸ç”¨è¯´ç®—å®ƒçš„æœŸæœ›å€¼çš„ã€‚ä¸‹é¢æˆ‘ä»¬å°†ä¼šçœ‹åˆ°ï¼Œè¿™ä¸ªç†è®ºå½¢å¼æ˜¯å¦‚ä½•é€æ­¥å®è·µåˆ°å¯å¯¼åœºæ™¯å’Œä¸å¯å¯¼åœºæ™¯çš„ã€‚</p>
<h2 id="_2">å¯å¯¼ç›®æ ‡</h2>
<p>å¯¹äºå¯å¯¼çš„$l(\theta)$ï¼Œæˆ‘ä»¬è™½ç„¶ä¸èƒ½ç²¾ç¡®æ±‚å‡º$p(\Delta\theta|\theta)$æ¥ï¼Œä½†æ˜¯æˆ‘ä»¬å¯ä»¥åšæ³°å‹’å±•å¼€å¾—åˆ°ä¸€ä¸ªè¿‘ä¼¼åˆ†å¸ƒï¼Œè¿›è€Œå»ä¼°ç®—$\Delta\theta_*$ã€‚ç»“æœæ˜¾ç¤ºï¼Œå±•å¼€åˆ°ä¸€é˜¶ã€äºŒé˜¶è¿‘ä¼¼ï¼Œæˆ‘ä»¬åˆ†åˆ«å¯ä»¥å¾—åˆ°æ¢¯åº¦ä¸‹é™æ³•å’Œç‰›é¡¿æ³•ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ¢¯åº¦ä¸‹é™å’Œç‰›é¡¿æ³•æŸç§æ„ä¹‰ä¸Šéƒ½åªæ˜¯è¯¥è§†è§’ä¸‹çš„ä¸€ä¸ªç‰¹ä¾‹ã€‚</p>
<h3 id="_3">æ¢¯åº¦ä¸‹é™</h3>
<p>ä½œä¸ºç¬¬ä¸€æ¬¡å°è¯•ï¼Œæˆ‘ä»¬å‡è®¾$l(\theta)$æ˜¯ä¸€é˜¶å¯å¯¼çš„ï¼Œé‚£ä¹ˆç”±æ³°å‹’å±•å¼å¯ä»¥å¾—åˆ°<br />
\begin{equation}l(\theta + \Delta\theta) - l(\theta)\approx \Delta\theta^{\top}\nabla_{\theta}l(\theta)\end{equation}<br />
è¿™ä¹Ÿå°±æ˜¯$p(\Delta\theta|\theta)\sim e^{-\Delta\theta^{\top}\nabla_{\theta}l(\theta)/\alpha}$ï¼Œå¦‚æœ$\Delta\theta$æ— çº¦æŸï¼Œé‚£ä¹ˆæ˜¯æ— æ³•å®Œæˆå½’ä¸€åŒ–çš„ï¼Œæˆ‘ä»¬ä¸å¦¨é™åˆ¶$\Vert\Delta\theta\Vert\leq \epsilon$ï¼Œå¹¶ä¸”è®°$\nabla_{\theta}l(\theta)=g$ï¼Œé‚£ä¹ˆ<br />
\begin{equation}p(\Delta\theta|\theta) = \frac{e^{-\Delta\theta^{\top}g/\alpha}}{Z(g)},\quad Z(g)=\int_{\Vert\Delta\theta\Vert\leq\epsilon}e^{-\Delta\theta^{\top}g/\alpha}d(\Delta\theta)\end{equation}<br />
è€Œå¾ˆæ˜æ˜¾$\Delta\theta_<em> = -\alpha\nabla_g \ln Z(g)$ï¼Œæ‰€ä»¥å…³é”®æ˜¯æ±‚å‡º$Z(g)$ã€‚è®¾$\Delta\theta$ä¸$g$çš„å¤¹è§’ä¸º$\eta$ï¼Œé‚£ä¹ˆ<br />
\begin{equation}Z(g)=\int_{\Vert\Delta\theta\Vert\leq\epsilon}e^{-\Vert\Delta\theta\Vert\times\Vert g\Vert \times (\cos\eta) / \alpha}d(\Delta\theta)\end{equation}<br />
è¿™æ˜¯ä¸€ä¸ªåœ¨é«˜ç»´è¶…çƒå†…çš„ç§¯åˆ†ï¼Œç”±äºå„å‘åŒæ€§çš„å­˜åœ¨ï¼Œæ‰€ä»¥å½“æ¨¡é•¿$\Vert g\Vert$å›ºå®šåï¼Œæ•´ä¸ªç§¯åˆ†ç»“æœä¹Ÿå°±å›ºå®šäº†ï¼Œä¹Ÿå°±æ˜¯è¯´$Z(g)$åªè·Ÿ$g$çš„æ¨¡é•¿æœ‰å…³ï¼Œè·Ÿå®ƒçš„æ–¹å‘æ— å…³ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥è®°ä¸º$Z(\Vert g\Vert)$ã€‚æˆ‘ä»¬ä¸éœ€è¦çŸ¥é“$Z(\Vert g\Vert)$çš„å…·ä½“å½¢å¼ï¼ŒçŸ¥é“å®ƒä»…ä»…æ˜¯æ¨¡é•¿$\Vert g\Vert$çš„å‡½æ•°å°±è¡Œäº†ï¼Œè¿™æ—¶å€™<br />
\begin{equation}\Delta\theta_</em> = -\alpha\nabla_g \ln Z(g)= - \frac{Z'(\Vert g\Vert)}{Z(\Vert g\Vert)}\alpha\nabla_g\Vert g\Vert = - \frac{Z'(\Vert g\Vert)}{Z(\Vert g\Vert)}\frac{\alpha g}{\Vert g\Vert}\end{equation}<br />
æ‰€ä»¥$\Delta\theta_<em>$çš„æ–¹å‘å°±æ˜¯$-g$çš„æ–¹å‘ï¼Œä¹Ÿå°±æ˜¯æ¢¯åº¦çš„åæ–¹å‘ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯¼å‡º</em><em>æ¢¯åº¦ä¸‹é™</em>* äº†ï¼Œå¯ä»¥è¯´å®ƒæ˜¯å¼$\eqref{eq:delta}$çš„ä¸€é˜¶è¿‘ä¼¼ã€‚å¦å¤–ï¼Œå…·ä½“ç®—å‡º$Z(g)$ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œåªä¸è¿‡å®ƒå¹¶éåˆç­‰å‡½æ•°ï¼Œè¿‡ç¨‹å¯ä»¥å‚è€ƒstackexchangeä¸Šçš„è®¨è®º <a href="https://math.stackexchange.com/questions/3310890/integral-of-exp-over-the-unit-ball">Integral of exp over the unit ball</a>ã€‚</p>
<h3 id="_4">ç‰›é¡¿æ³•</h3>
<p>å¦‚æœ$l(\theta)$æ˜¯äºŒé˜¶å¯å¯¼çš„ï¼Œé‚£ä¹ˆå¯ä»¥å±•å¼€åˆ°äºŒé˜¶<br />
\begin{equation}l(\theta + \Delta\theta) - l(\theta)\approx \Delta\theta^{\top}\nabla_{\theta}l(\theta) + \frac{1}{2}\Delta\theta^{\top}\nabla_{\theta}^2 l(\theta) \Delta\theta\end{equation}<br />
è®°$g=\nabla_{\theta}l(\theta),\mathcal{H}=\nabla_{\theta}^2 l(\theta)$ï¼Œæˆ‘ä»¬å°±æœ‰<br />
\begin{equation}\begin{aligned}<br />
\log p(\Delta\theta|\theta)\sim&amp;\, -\Delta\theta^{\top}g - \frac{1}{2}\Delta\theta^{\top} \mathcal{H} \Delta\theta\\\<br />
=&amp;\, - \frac{1}{2}\left(\Delta\theta+\mathcal{H}^{-1}g\right)^{\top}\mathcal{H}\left(\Delta\theta+\mathcal{H}^{-1}g\right)+ \frac{1}{2}g^{\top} \mathcal{H}^{-1} g<br />
\end{aligned}\end{equation}<br />
å¾ˆæ˜æ˜¾ï¼Œå› ä¸º$p(\Delta\theta|\theta)$çš„æŒ‡æ•°éƒ¨åˆ†å…³äº$\theta$æ˜¯äºŒæ¬¡çš„ï¼Œæ‰€ä»¥$p(\Delta\theta|\theta)$æ˜¯ä¸€ä¸ªé«˜æ–¯åˆ†å¸ƒï¼Œè€Œä¸Šå¼åˆ™æ„å‘³ç€è¯¥é«˜æ–¯åˆ†å¸ƒçš„å‡å€¼ä¸º$-\mathcal{H}^{-1}g$ã€åæ–¹å·®çŸ©é˜µä¸º$\mathcal{H}^{-1}$ï¼Œæ‰€ä»¥$\Delta\theta_<em>=-\mathcal{H}^{-1}g$ï¼Œè¿™ä¸ªç»“æœå¯¹åº”çš„å°±æ˜¯</em><em>ç‰›é¡¿æ³•</em>* äº†ï¼Œå› æ­¤å¯ä»¥è¯´ç‰›é¡¿æ³•æ˜¯å¼$\eqref{eq:delta}$çš„äºŒé˜¶è¿‘ä¼¼ã€‚</p>
<h2 id="_5">ä¸å¯å¯¼ç›®æ ‡</h2>
<p>å¯¹äºä¸å¯å¯¼çš„$l(\theta)$ï¼Œä¸Šè¿°çš„æ³°å‹’å±•å¼€è¿‘ä¼¼ä¹Ÿå°±æ— æ³•åšåˆ°äº†ï¼Œç†è®ºä¸Šæˆ‘ä»¬åªèƒ½é€šè¿‡ç›´æ¥é‡‡æ ·çš„æ–¹å¼å»ä¼°ç®—$\Delta\theta_*$äº†ï¼Œè€ŒåŸè®ºæ–‡åˆ™æå‡ºï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é‡è¦æ€§é‡‡æ ·æ¥æé«˜é‡‡æ ·æ•ˆç‡å’Œä¼°ç®—ç²¾åº¦ï¼Œè¿™å°±æ˜¯è®ºæ–‡çš„æ ¸å¿ƒæ€æƒ³å’Œä¸»è¦è´¡çŒ®äº†ã€‚</p>
<h3 id="_6">é‡è¦æ€§é‡‡æ ·</h3>
<p>è¿™é‡Œå…ˆä¸€èˆ¬åŒ–åœ°ç®€ä»‹ä¸€ä¸‹é‡è¦æ€§é‡‡æ ·ï¼ˆImportance Samplingï¼‰æ¦‚å¿µã€‚è®¾æœ‰æ¦‚ç‡åˆ†å¸ƒ$p(x)$ï¼Œä»¥åŠå‡½æ•°$f(x)$ï¼Œæˆ‘ä»¬è¦ä¼°ç®—<br />
\begin{equation}\int p(x)f(x)dx = \mathbb{E}<em i="1">{x\sim p(x)}[f(x)]\end{equation}<br />
è¿™ä¹Ÿè¦æ±‚æˆ‘ä»¬ä»$p(x)$ä¸­é‡‡æ ·å‡ºè‹¥å¹²ä¸ªæ ·æœ¬$x_1,x_2,\dots,x_n$å‡ºæ¥ï¼Œç„¶åå»ç®—$\frac{1}{n}\sum\limits</em>^n f(x_i)$ã€‚ç„¶è€Œï¼Œè¿™é‡Œè¾¹å¯èƒ½å­˜åœ¨ä¸¤ä¸ªå›°éš¾ï¼š</p>
<blockquote>
<p>1ã€æˆ‘ä»¬å¯èƒ½æ ¹æœ¬ä¸çŸ¥é“æ€ä¹ˆä»$p(x)$é‡Œè¾¹é‡‡æ ·ï¼›</p>
<p>2ã€å°±ç®—æˆ‘ä»¬çŸ¥é“æ€ä¹ˆä»$p(x)$ä¸­é‡‡æ ·ï¼Œä½†å¯¹äºç±»ä¼¼<a href="/archives/5253">å˜åˆ†è‡ªç¼–ç å™¨</a>çš„åœºæ™¯ï¼Œ$p(x)$æ˜¯å¸¦å‚æ•°çš„ï¼Œéœ€è¦ä¿ç•™æ¢¯åº¦ï¼Œè€Œç›´æ¥é‡‡æ ·è®¡ç®—ä¸ä¸€å®šèƒ½åšåˆ°è¿™ä¸€ç‚¹ã€‚</p>
</blockquote>
<p>è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ–è®¸é‡è¦æ€§é‡‡æ ·èƒ½å¸®åŠ©æˆ‘ä»¬ï¼Œå®ƒéœ€è¦æˆ‘ä»¬æ‰¾åˆ°ä¸€ä¸ªæ—¢çŸ¥é“æ¦‚ç‡å¯†åº¦çš„è¡¨è¾¾å¼ã€åˆæ–¹ä¾¿é‡‡æ ·çš„åˆ†å¸ƒ$q(x)$ï¼Œç„¶åä½œå¦‚ä¸‹æ”¹å†™ï¼š<br />
\begin{equation}\int p(x)f(x)dx = \int q(x)\left[\frac{p(x)}{q(x)}f(x)\right]dx = \mathbb{E}_{x\sim q(x)}\left[\frac{p(x)}{q(x)}f(x)\right]\label{eq:is}\end{equation}<br />
è¿™æ—¶å€™é‡‡æ ·è½¬ç§»åˆ°äº†$q(x)$ä¸Šï¼Œè€Œæ ¹æ®æˆ‘ä»¬çš„å‡è®¾ï¼Œ$q(x)$é‡‡æ ·æ˜¯å®¹æ˜“è¿›è¡Œçš„ï¼Œå¹¶ä¸”$q(x)$çš„è§£æå¼å·²ç»çŸ¥é“ï¼Œæ‰€ä»¥$\frac{p(x)}{q(x)}f(x)$ä¹Ÿæ˜¯å¯ä»¥è®¡ç®—çš„ï¼Œå¦‚æœ$p(x)$æœ‰å‚æ•°éœ€è¦è®¡ç®—æ¢¯åº¦ï¼Œé‚£ä¹ˆå®ƒçš„æ¢¯åº¦ä¹Ÿå¾—åˆ°äº†ä¿ç•™ã€‚å¾ˆæ˜æ˜¾ï¼Œå¦‚æœ$q(x)$è¶Šæ¥è¿‘$p(x)$ï¼Œä¼°ç®—æ•ˆç‡å°±è¶Šé«˜ï¼Œ$q(x)$ä»£è¡¨ç€å¯¹$p(x)$å„ä¸ªæ ·æœ¬çš„â€œé‡è¦æ€§â€çš„ä¸€ç§å…ˆéªŒä¼°è®¡ï¼Œå› æ­¤è¿™ç§æ€è·¯å°±ç§°ä¸ºé‡è¦æ€§é‡‡æ ·ã€‚</p>
<p>è¿™æ ·ä¸€æ¥ï¼Œå‡è®¾$x_1,x_2,\dots,x_n\sim q(x)$ï¼Œæˆ‘ä»¬å°±æœ‰<br />
\begin{equation}\mathbb{E}<em i="1">{x\sim p(x)}[f(x)]\approx \frac{1}{n}\sum</em>}^n \frac{p(x_i)}{q(x_i)}f(x_i)\label{eq:is-2}\end{equation<br />
ä¸è¿‡ï¼Œè¿˜æœ‰ä¸€ä¸ªå°é—®é¢˜ï¼Œå¼$\eqref{eq:is}$æˆ–å¼$\eqref{eq:is-2}$éƒ½è¦æ±‚æˆ‘ä»¬çŸ¥é“$p(x)$çš„ç²¾ç¡®è¡¨è¾¾å¼ï¼Œæœ‰æ—¶å€™è¿™ä¸€ç‚¹æˆ‘ä»¬ä¹Ÿä¸èƒ½åšåˆ°ï¼Œæ¯”å¦‚å‰é¢çš„$p(\Delta\theta|\theta)$æˆ‘ä»¬åªçŸ¥é“å®ƒæ­£æ¯”äº$e^{-[l(\theta + \Delta\theta) - l(\theta)]/\alpha}$ï¼Œå…¶å½’ä¸€åŒ–å› å­æ˜¯æ²¡æ³•ç›´æ¥ç®—å‡ºæ¥çš„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å€ŸåŠ©å…³ç³»å¼<br />
\begin{equation}1=\int p(x)dx=\int q(x)\left[\frac{p(x)}{q(x)}\right]dx=\mathbb{E}<em i="1">{x\sim q(x)}\left[\frac{p(x)}{q(x)}\right]\approx\frac{1}{n}\sum</em>}^n \frac{p(x_i)}{q(x_i)}\end{equation<br />
ä¹Ÿå°±æ˜¯è¯´$\left[\frac{1}{n}\frac{p(x_1)}{q(x_1)},\frac{1}{n}\frac{p(x_2)}{q(x_2)},\dots,\frac{1}{n}\frac{p(x_n)}{q(x_n)}\right]$åº”å½“æ˜¯è¿‘ä¼¼å½’ä¸€åŒ–çš„ï¼Œå¦‚æœæˆ‘ä»¬åªçŸ¥é“$p(x)\sim \rho(x)$è€Œä¸çŸ¥é“å½’ä¸€åŒ–å› å­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ‰‹åŠ¨å®Œæˆå½’ä¸€åŒ–ï¼Œæ­¤æ—¶å¼$\eqref{eq:is-2}$å˜ä¸º<br />
\begin{equation}\mathbb{E}<em i="1">{x\sim p(x)}[f(x)]\approx \sum</em>}^n \frac{\rho(x_i)\big/q(x_i)}{\sum\limits_{i=1}^n \rho(x_i)\big/q(x_i)}f(x_i)\label{eq:is-3}\end{equation<br />
è¿™å°±çœå»äº†å½’ä¸€åŒ–å› å­çš„è®¡ç®—ã€‚</p>
<h3 id="_7">å€ŸåŠ›å¯å¯¼</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬æ‰€éœ€è¦çš„æ•°å­¦å·¥å…·éƒ½å·²ç»å‡†å¤‡é½å…¨äº†ï¼Œå¯ä»¥æ­£å¼è¿æ¥æˆ‘ä»¬çš„ä¸å¯å¯¼ç›®æ ‡äº†ã€‚å‡è®¾æ˜¯$l(\theta)$æ˜¯è¯„æµ‹æŒ‡æ ‡ï¼Œæ¯”å¦‚æ˜¯å¹³å‡æ­£ç¡®ç‡ã€å¹³å‡BLEUç­‰ï¼Œå®ƒæ˜¯æˆ‘ä»¬éœ€è¦ä¼˜åŒ–çš„æœ€ç»ˆç›®æ ‡ï¼Œä½†å®ƒæ˜¯ä¸å¯å¯¼çš„ã€‚ä¸è¿‡åœ¨å¤§å¤šæ•°åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬éƒ½èƒ½æ‰¾åˆ°ä¸€ä¸ªå¯å¯¼çš„ï¼ˆè¿‘ä¼¼çš„ï¼‰ä¼˜åŒ–ç›®æ ‡$\tilde{l}(\theta)$ï¼Œè€Œé€šå¸¸æˆ‘ä»¬éƒ½æ˜¯ç›´æ¥ç”¨æ¢¯åº¦ä¸‹é™ä¼˜åŒ–$\tilde{l}(\theta)$ï¼Œè¿™å°±é€ æˆäº†ä¼˜åŒ–ç›®æ ‡ä¸è¯„æµ‹æŒ‡æ ‡çš„ä¸ä¸€è‡´æ€§ã€‚</p>
<p>ä½†ä¸å¾—ä¸è¯´ï¼Œå¾ˆå¤šæ—¶å€™$\tilde{l}(\theta)$ç¡®å®æ˜¯$l(\theta)$çš„ä¸€ä¸ªè‰¯å¥½è¿‘ä¼¼ï¼Œæ¢è¨€ä¹‹$-\nabla_{\theta}\tilde{l}(\theta)$ç¡®å®æŒ‡å‡ºäº†ä¸€ä¸ªæ¯”è¾ƒé è°±ï¼ˆä½†ä¸æ˜¯æœ€ä¼˜ï¼‰çš„æ›´æ–°æ–¹å‘ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥å€ŸåŠ©é‡è¦æ€§é‡‡æ ·äº†ã€‚æ„å»º$q(\Delta\theta|\theta)$ä¸ºæ­£æ€åˆ†å¸ƒ$\mathcal{N}(\Delta\theta; -\nabla_{\theta}\tilde{l}(\theta), \sigma^2)$ï¼Œæ ¹æ®é‡è¦æ€§é‡‡æ ·çš„å¼$\eqref{eq:is-3}$ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}<br />
\Delta\theta_*=\mathbb{E}<em i="1">{\Delta\theta\sim q(\Delta\theta|\theta)}\left[\frac{p(\Delta\theta|\theta)}{q(\Delta\theta|\theta)}\Delta\theta\right]\approx\sum</em>\Delta\theta_i}^n \frac{e^{-[l(\theta + \Delta\theta_i) - l(\theta)]/\alpha}\big/\mathcal{N}(\Delta\theta_i; -\nabla_{\theta}\tilde{l}(\theta), \sigma^2)}{\sum\limits_{i=1}^n e^{-[l(\theta + \Delta\theta_i) - l(\theta)]/\alpha}\big/\mathcal{N}(\Delta\theta_i; -\nabla_{\theta}\tilde{l}(\theta), \sigma^2)<br />
\label{eq:sg}\end{equation}<br />
å…¶ä¸­$\Delta\theta_1,\Delta\theta_2,\dots,\Delta\theta_n\sim\mathcal{N}(\Delta\theta; -\nabla_{\theta}\tilde{l}(\theta), \sigma^2)$ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œ$q(\Delta\theta|\theta)$è¿˜å¯ä»¥ä½¿ç”¨æ··åˆæ¨¡å‹ï¼ŒåŸè®ºæ–‡ä½¿ç”¨çš„æ˜¯ï¼š<br />
\begin{equation}q(\Delta\theta|\theta)=\lambda \mathcal{N}(\Delta\theta; 0, \sigma^2) + (1-\lambda)\mathcal{N}(\Delta\theta; -\nabla_{\theta}\tilde{l}(\theta), \sigma^2)\end{equation}<br />
å¤§å®¶å¯èƒ½æ¯”è¾ƒå…³å¿ƒé‡‡æ ·æ•°ç›®ï¼ŒåŸè®ºæ–‡åœ¨æ–‡æœ¬ç”Ÿæˆä»»åŠ¡ä¸­é€‰æ‹©äº†$n=4$ï¼Œç»“æœå°±æœ‰æ˜æ˜¾çš„æ”¹å–„äº†ï¼Œè¯´æ˜æœ‰äº†$q(\Delta\theta|\theta)$çš„â€œæŒ‡å¼•â€åï¼Œ$n$ä¸éœ€è¦å¤ªå¤§ã€‚</p>
<h3 id="_8">ç­–ç•¥æ¢¯åº¦</h3>
<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦ç›´æ¥ä¼˜åŒ–è¯„æµ‹æŒ‡æ ‡ï¼Œå¸¸è§çš„æ–¹æ³•æ˜¯é€šè¿‡å¼ºåŒ–å­¦ä¹ ä¸­çš„â€œç­–ç•¥æ¢¯åº¦ï¼ˆPolicy Gradientï¼‰â€ï¼Œæ‰€ä»¥çœ‹åˆ°è¿™é‡Œçš„è¯»è€…ä¹Ÿè®¸ä¼šæœ‰ç–‘é—®ï¼šä¸Šè¿°æ–¹æ³•è·Ÿç­–ç•¥æ¢¯åº¦æœ‰ä»€ä¹ˆåŒºåˆ«å—ï¼Ÿå­°ä¼˜å­°åŠ£ï¼Ÿ</p>
<p>å‡è®¾å•ä¸ªæ ·æœ¬çš„è¯„æµ‹æŒ‡æ ‡ä¸º$l(y_t,y_p)$ï¼Œå…¶ä¸­$y_t$æ˜¯çœŸå®æ ‡ç­¾ï¼Œ$y_p$æ˜¯é¢„æµ‹ç»“æœï¼Œé‚£ä¹ˆæ€»çš„å¹³å‡æŒ‡æ ‡ä¸º<br />
\begin{equation}l(\theta)=\mathbb{E}<em _theta="\theta">{(x_t,y_t)\sim\mathcal{D}}\left[l\left(y_t, \mathop{\text{argmax}}_y p</em>}(y|x_t)\right)\right]\end{equation<br />
ä¸å¯å¯¼æºäº$\mathop{\text{argmax}}$æ“ä½œï¼Œè€Œç­–ç•¥æ¢¯åº¦å°†å…¶å˜ä¸º<br />
\begin{equation}\tilde{l}(\theta)=\mathbb{E}<em p__theta="p_{\theta" y_sim="y\sim">{(x_t,y_t)\sim\mathcal{D}}\left[\mathbb{E}</em>}(y|x_t)}\left[l\left(y_t,y\right)\right]\right]\end{equation<br />
ç„¶ååˆ©ç”¨ï¼ˆå‚è€ƒ<a href="/archives/6705#%E8%83%8C%E5%90%8E%E7%9A%84%E6%95%85%E4%BA%8B">ã€Šæ¼«è°ˆé‡å‚æ•°ï¼šä»æ­£æ€åˆ†å¸ƒåˆ°Gumbel Softmaxã€‹</a>ï¼‰<br />
\begin{equation}\nabla_{\theta}\int p_{\theta}(x)f(x)dx = \int f(x)\nabla_{\theta}p_{\theta}(x)dx =\int p_{\theta}(x)f(x)\nabla_{\theta}\log p_{\theta}(x)dx\end{equation}<br />
å¾—åˆ°<br />
\begin{equation}\nabla_{\theta}\tilde{l}(\theta)=\mathbb{E}<em p__theta="p_{\theta" y_sim="y\sim">{(x_t,y_t)\sim\mathcal{D}}\left[\mathbb{E}</em>}(y|x_t)}\left[l\left(y_t,y\right)\nabla_{\theta}\log p_{\theta}(y|x_t)\right]\right]\label{eq:pg}\end{equation<br />
è¿™å°±æ˜¯ç­–ç•¥æ¢¯åº¦çš„ä¸€èˆ¬å½¢å¼ï¼Œä¹Ÿç§°ä¸ºREINFORCEä¼°è®¡ã€‚</p>
<p>å¼$\eqref{eq:sg}$å’Œå¼$\eqref{eq:pg}$æ˜¯ä¸¤ç§ä»ä¸åŒçš„è§’åº¦å¾—å‡ºçš„æ›´æ–°æ–¹å‘ï¼Œå®ƒä»¬çš„åŒºåˆ«åœ¨å“ªå‘¢ï¼Ÿå¯ä»¥çœ‹åˆ°ï¼Œæ ¸å¿ƒçš„åŒºåˆ«åœ¨äºé‡‡æ ·å¯¹è±¡ï¼šå¼$\eqref{eq:sg}$çš„é‡‡æ ·æ˜¯$\mathbb{E}<em p__theta="p_{\theta" y_sim="y\sim">{\Delta\theta\sim q(\Delta\theta|\theta)}$ï¼Œ$\eqref{eq:pg}$çš„é‡‡æ ·æ˜¯$\mathbb{E}</em>$åˆ™æ˜¯â€œåªéœ€ä¸€ç»„å‚æ•°ã€ä½†è¦é‡‡æ ·è¾“å‡ºå¤šä¸ªæ ·æœ¬â€æ¥è®¡ç®—æ›´æ–°é‡ã€‚}(y|x_t)}$ã€‚æ‰€ä»¥åŸè®ºæ–‡æä¾›çš„å¼$\eqref{eq:sg}$æ˜¯â€œé‡‡æ ·å¤šç»„å‚æ•°ã€æ¯ç»„å‚æ•°è¾“å‡ºä¸€ä¸ªæ ·æœ¬â€æ¥è®¡ç®—æ›´æ–°é‡ï¼Œç­–ç•¥æ¢¯åº¦çš„å¼$\eqref{eq:pg</p>
<p>ä»è®¡ç®—é‡æ¥çœ‹ï¼Œåº”å½“æ˜¯ç­–ç•¥æ¢¯åº¦è®¡ç®—é‡å°‘ä¸€äº›ï¼Œå› ä¸º$\mathbb{E}<em _theta="\theta">{y\sim p</em>$åˆ™è‡ªå§‹è‡³ç»ˆéƒ½è¯•å›¾ç›´æ¥ä¼˜åŒ–è¯„æµ‹æŒ‡æ ‡ï¼Œå¹¶ä¸”å€ŸåŠ©å¯å¯¼ç›®æ ‡æ¥å®ç°é‡è¦æ€§é‡‡æ ·ï¼Œç»“åˆäº†å¯å¯¼ä¼˜åŒ–å’Œä¸å¯å¯¼ä¼˜åŒ–çš„ä¼˜åŠ¿ã€‚}(y|x_t)}$è¿™ä¸€æ­¥é‡‡æ ·å¤šä¸ªæ ·æœ¬å¯ä»¥å¹¶è¡Œæ¥ï¼›å½“ç„¶ï¼Œç†è®ºä¸Š$\mathbb{E}_{\Delta\theta\sim q(\Delta\theta|\theta)}$é‡‡æ ·å¤šç»„å‚æ•°æ¥é¢„æµ‹å„è‡ªçš„æ ·æœ¬ä¹Ÿå¯ä»¥å¹¶è¡Œæ¥ï¼Œä½†å¹¶ä¸å¥½å†™ã€‚ä¸è¿‡ï¼Œç­–ç•¥æ¢¯åº¦çš„é—®é¢˜ä¹Ÿä¸å°‘ï¼Œå…¸å‹é—®é¢˜å°±æ˜¯æ¢¯åº¦ä¼°è®¡çš„æ–¹å·®å¤ªå¤§ï¼Œæ‰€ä»¥éƒ½éœ€è¦æ™®é€šçš„ä¼¼ç„¶ç›®æ ‡æ¥é¢„è®­ç»ƒåˆ°å·®ä¸å¤šäº†ï¼Œç„¶åæ‰ç”¨ç­–ç•¥æ¢¯åº¦æ¥å¾®è°ƒï¼›è€ŒåŸè®ºæ–‡çš„å¼$\eqref{eq:sg</p>
<h2 id="_9">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†ä¸€ä¸ªç†è§£ä¼˜åŒ–ç®—æ³•çš„æ–°è§†è§’ï¼Œåœ¨è¯¥è§†è§’ä¹‹ä¸‹å¯å¯¼å’Œä¸å¯å¯¼ç›®æ ‡çš„ä¼˜åŒ–å¾—åˆ°äº†ç»Ÿä¸€ï¼šå¯¹äºå¯å¯¼çš„ç›®æ ‡å‡½æ•°ï¼Œåœ¨è¯¥è§†è§’ä¹‹ä¸‹åˆ†åˆ«åšä¸€é˜¶å’ŒäºŒé˜¶å±•å¼€ï¼Œæˆ‘ä»¬åˆ†åˆ«å¯ä»¥å¾—åˆ°æ¢¯åº¦ä¸‹é™æ³•å’Œç‰›é¡¿æ³•ï¼›è€Œå¯¹äºä¸å¯å¯¼çš„ç›®æ ‡å‡½æ•°ï¼Œæˆ‘ä»¬å€ŸåŠ©å¯å¯¼è¿‘ä¼¼æ¥è¿›è¡Œé‡è¦æ€§é‡‡æ ·ï¼ŒåŒæ ·ä¹Ÿå¯ä»¥å®Œæˆä¸å¯å¯¼çš„ç›®æ ‡ä¼˜åŒ–ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/7521">https://spaces.ac.cn/archives/7521</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Jun. 23, 2020). ã€Šä»é‡‡æ ·çœ‹ä¼˜åŒ–ï¼šå¯å¯¼ä¼˜åŒ–ä¸ä¸å¯å¯¼ä¼˜åŒ–çš„ç»Ÿä¸€è§†è§’ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/7521">https://spaces.ac.cn/archives/7521</a></p>
<p>@online{kexuefm-7521,<br />
title={ä»é‡‡æ ·çœ‹ä¼˜åŒ–ï¼šå¯å¯¼ä¼˜åŒ–ä¸ä¸å¯å¯¼ä¼˜åŒ–çš„ç»Ÿä¸€è§†è§’},<br />
author={è‹å‰‘æ—},<br />
year={2020},<br />
month={Jun},<br />
url={\url{https://spaces.ac.cn/archives/7521}},<br />
} </p>
<hr />
<h2 id="_10">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>TODO: æ·»åŠ è¯¦ç»†çš„æ•°å­¦å…¬å¼æ¨å¯¼å’Œæ³¨é‡Š</p>
        </div>
    </div>
</body>
</html>