<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NystrÃ¶mformerï¼šåŸºäºçŸ©é˜µåˆ†è§£çš„çº¿æ€§åŒ–Attentionæ–¹æ¡ˆ</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>NystrÃ¶mformerï¼šåŸºäºçŸ©é˜µåˆ†è§£çš„çº¿æ€§åŒ–Attentionæ–¹æ¡ˆ</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-12-31 | ğŸ“„ å¤§å°: 21.3 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8180">https://spaces.ac.cn/archives/8180</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>æ ‡å‡†Attentionçš„$\mathcal{O}(n^2)$å¤æ‚åº¦å¯çœŸæ˜¯è®©ç ”ç©¶äººå‘˜å¤´å¤§ã€‚å‰æ®µæ—¶é—´æˆ‘ä»¬åœ¨åšæ–‡<a href="/archives/7921">ã€ŠPerformerï¼šç”¨éšæœºæŠ•å½±å°†Attentionçš„å¤æ‚åº¦çº¿æ€§åŒ–ã€‹</a>ä¸­ä»‹ç»äº†Googleçš„Performeræ¨¡å‹ï¼Œå®ƒé€šè¿‡éšæœºæŠ•å½±çš„æ–¹å¼å°†æ ‡å‡†Attentionè½¬åŒ–ä¸ºçº¿æ€§Attentionã€‚æ— ç‹¬æœ‰å¶ï¼Œå‰äº›å¤©Arxivä¸Šæ”¾å‡ºäº†AAAI 2021çš„ä¸€ç¯‡è®ºæ–‡<a href="https://papers.cool/arxiv/2102.03902">ã€ŠNystrÃ¶mformer: A NystrÃ¶m-Based Algorithm for Approximating Self-Attentionã€‹</a>ï¼Œé‡Œè¾¹åˆæå‡ºäº†ä¸€ç§ä»å¦ä¸€ä¸ªè§’åº¦æŠŠæ ‡å‡†Attentionçº¿æ€§åŒ–çš„æ–¹æ¡ˆã€‚</p>
<p>è¯¥æ–¹æ¡ˆå†™çš„æ˜¯NystrÃ¶m-Basedï¼Œé¡¾åæ€ä¹‰æ˜¯åˆ©ç”¨äº†NystrÃ¶mæ–¹æ³•æ¥è¿‘ä¼¼æ ‡å‡†Attentionçš„ã€‚ä½†æ˜¯å¦ç™½è¯´ï¼Œåœ¨çœ‹åˆ°è¿™ç¯‡è®ºæ–‡ä¹‹å‰ï¼Œç¬”è€…ä¹Ÿå®Œå…¨æ²¡å¬è¯´è¿‡NystrÃ¶mæ–¹æ³•ï¼Œè€Œçºµè§‚æ•´ç¯‡è®ºæ–‡ï¼Œé‡Œè¾¹ä¹Ÿå…¨æ˜¯ç¬”è€…ä¸€çœ¼çœ‹ä¸Šå»æ„Ÿè§‰å¾ˆèŒ«ç„¶çš„çŸ©é˜µåˆ†è§£æ¨å¯¼ï¼Œç†è§£èµ·æ¥é¢‡ä¸ºå›°éš¾ã€‚ä¸è¿‡æœ‰è¶£çš„æ˜¯ï¼Œå°½ç®¡ä½œè€…çš„æ¨å¯¼å¾ˆå¤æ‚ï¼Œä½†ç¬”è€…å‘ç°æœ€ç»ˆçš„ç»“æœå¯ä»¥é€šè¿‡ä¸€ä¸ªç›¸å¯¹æ¥è¯´æ›´ç®€æ˜çš„æ–¹å¼æ¥ç†è§£ï¼Œé‚å°†ç¬”è€…å¯¹NystrÃ¶mformerçš„ç†è§£æ•´ç†åœ¨æ­¤ï¼Œä¾›å¤§å®¶å‚è€ƒã€‚</p>
<h2 id="_1">ç®€å•çš„å›é¡¾</h2>
<p>å¦‚æœè¯»è€…å¯¹çº¿æ€§Attentionè¿˜ä¸æ˜¯å¾ˆäº†è§£ï¼Œé‚£ä¹ˆå»ºè®®å…ˆé€šè¯»ä¸€ä¸‹<a href="/archives/7546">ã€Šçº¿æ€§Attentionçš„æ¢ç´¢ï¼šAttentionå¿…é¡»æœ‰ä¸ªSoftmaxå—ï¼Ÿã€‹</a>å’Œ<a href="/archives/7921">ã€ŠPerformerï¼šç”¨éšæœºæŠ•å½±å°†Attentionçš„å¤æ‚åº¦çº¿æ€§åŒ–ã€‹</a>ã€‚æ€»çš„æ¥è¯´ï¼Œçº¿æ€§Attentionæ˜¯é€šè¿‡çŸ©é˜µä¹˜æ³•çš„ç»“åˆå¾‹æ¥é™ä½Attentionçš„å¤æ‚åº¦ã€‚</p>
<h3 id="attention">æ ‡å‡†Attention</h3>
<p>æ ‡å‡†çš„Scaled-Dot Attentionå†™æˆçŸ©é˜µå½¢å¼å°±æ˜¯ï¼ˆæœ‰æ—¶å€™æŒ‡æ•°éƒ¨åˆ†è¿˜ä¼šå¤šä¸ªç¼©æ”¾å› å­ï¼Œè¿™é‡Œæˆ‘ä»¬å°±ä¸æ˜¾å¼å†™å‡ºæ¥äº†ï¼‰ï¼š<br />
\begin{equation}Attention(\boldsymbol{Q},\boldsymbol{K},\boldsymbol{V}) = softmax\left(\boldsymbol{Q}\boldsymbol{K}^{\top}\right)\boldsymbol{V}\end{equation}<br />
è¿™é‡Œ$\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}\in\mathbb{R}^{n\times d}$ï¼ˆå¯¹åº”Self Attentionï¼‰ã€‚æ­¤å¤–ï¼Œ <em>æœ¬æ–‡çš„æ‰€æœ‰softmaxï¼Œéƒ½æ˜¯å¯¹çŸ©é˜µçš„ç¬¬äºŒä¸ªç»´åº¦åšå½’ä¸€åŒ–</em> ã€‚</p>
<p>åœ¨ä¸Šå¼ä¸­ï¼Œ$\boldsymbol{Q}\boldsymbol{K}^{\top}$è¿™ä¸€æ­¥å¿…é¡»è¦å…ˆç®—å‡ºæ¥ï¼Œç„¶åæ‰èƒ½ç®—softmaxï¼Œå®ƒå¯¼è‡´äº†æˆ‘ä»¬ä¸èƒ½ä½¿ç”¨çŸ©é˜µä¹˜æ³•çš„ç»“åˆå¾‹ã€‚è€Œ$\boldsymbol{Q}\boldsymbol{K}^{\top}$æ˜¯$n^2$ä¸ªå‘é‡çš„å†…ç§¯ï¼Œå› æ­¤æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦éƒ½æ˜¯$\mathcal{O}(n^2)$ã€‚</p>
<h3 id="attention_1">çº¿æ€§Attention</h3>
<p>è€Œçº¿æ€§Attentionæ¯”è¾ƒæœ´ç´ çš„åšæ³•å°±æ˜¯<br />
\begin{equation}\left(\phi(\boldsymbol{Q})\varphi(\boldsymbol{K})^{\top}\right)\boldsymbol{V}=\phi(\boldsymbol{Q})\left(\varphi(\boldsymbol{K})^{\top}\boldsymbol{V}\right)\end{equation}<br />
å…¶ä¸­$\phi,\varphi$æ˜¯å€¼åŸŸéè´Ÿçš„æ¿€æ´»å‡½æ•°ã€‚ä¸ºäº†æ–¹ä¾¿å¯¹æ¯”ï¼Œä¸Šå¼è¿˜æ²¡æœ‰æ˜¾å¼åœ°å†™å‡ºå½’ä¸€åŒ–å› å­ï¼Œåªçªå‡ºäº†ä¸»è¦è®¡ç®—é‡çš„éƒ¨åˆ†ã€‚ä¸Šå¼å·¦ç«¯çš„å¤æ‚åº¦ä¾ç„¶æ˜¯$\mathcal{O}(n^2)$çš„ï¼Œç”±äºçŸ©é˜µä¹˜æ³•æ»¡è¶³ç»“åˆå¾‹ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆç®—åé¢ä¸¤ä¸ªçŸ©é˜µçš„ä¹˜æ³•ï¼Œè¿™æ ·æ•´ä½“å¤æ‚åº¦å°±é™ä¸º$\mathcal{O}(n)$äº†ã€‚</p>
<p>ä¸Šå¼æ˜¯ç›´æ¥å°†Attentionå®šä¹‰ä¸ºä¸¤ä¸ªçŸ©é˜µçš„ä¹˜æ³•æ¥åˆ©ç”¨ä¹˜æ³•ç»“åˆå¾‹çš„ï¼Œä¹Ÿå¯ä»¥å°†æ ‡å‡†Attentionï¼ˆè¿‘ä¼¼åœ°ï¼‰è½¬åŒ–ä¸ºçŸ©é˜µçš„ä¹˜æ³•æ¥åˆ©ç”¨ç»“åˆå¾‹ï¼Œå¦‚ä¸‹ä¸€èŠ‚æåˆ°çš„Performerï¼›æ­¤å¤–ï¼Œç›¸ä¹˜çŸ©é˜µä¹Ÿä¸ä¸€å®šæ˜¯ä¸¤ä¸ªï¼Œæ¯”å¦‚æœ¬æ–‡è¦ä»‹ç»çš„NystrÃ¶mformerå°±æ˜¯å°†æ³¨æ„åŠ›è¡¨ç¤ºä¸ºä¸‰ä¸ªçŸ©é˜µç›¸ä¹˜çš„ã€‚</p>
<h3 id="performer">Performer</h3>
<p>å¯¹äºPerformeræ¥è¯´ï¼Œå®ƒæ˜¯é€šè¿‡éšæœºæŠ•å½±æ¥æ‰¾åˆ°çŸ©é˜µ$\tilde{\boldsymbol{Q}},\tilde{\boldsymbol{K}}\in\mathbb{R}^{n\times m}$ä½¿å¾—softmaxä¸­çš„$e^{\boldsymbol{Q}\boldsymbol{K}^{\top}}\approx \tilde{\boldsymbol{Q}}\tilde{\boldsymbol{K}}^{\top}$ï¼Œè¿™æ ·ä¸€æ¥æ ‡å‡†Attentionå°±å¯ä»¥è¿‘ä¼¼ä¸ºä¸Šä¸€èŠ‚çš„çº¿æ€§Attentionæ¥ç®—äº†ï¼Œç»†èŠ‚è¯·çœ‹ä¹‹å‰çš„åšæ–‡<a href="/archives/7921">ã€ŠPerformerï¼šç”¨éšæœºæŠ•å½±å°†Attentionçš„å¤æ‚åº¦çº¿æ€§åŒ–ã€‹</a>ã€‚</p>
<p>å¦‚æœå¯¹SVMå’Œæ ¸æ–¹æ³•ç­‰æ¯”è¾ƒç†Ÿæ‚‰çš„è¯»è€…å¯èƒ½ä¼šè”æƒ³åˆ°ï¼Œè¿™ä¸ªåšæ³•å…¶å®å°±æ˜¯æ ¸å‡½æ•°çš„æ€æƒ³ï¼Œå³ä½ç»´ç©ºé—´ä¸­ä¸¤ä¸ªå‘é‡çš„æ ¸å‡½æ•°å¯ä»¥æ˜ å°„ä¸ºé«˜ç»´ç©ºé—´ä¸­ä¸¤ä¸ªå‘é‡çš„å†…ç§¯ã€‚å®ƒä¹Ÿå¯ä»¥è·ŸLSHï¼ˆLocality Sensitive Hashingï¼‰è”ç³»èµ·æ¥ã€‚</p>
<h2 id="nystromformer">NystrÃ¶mformer</h2>
<p>åœ¨è¿™éƒ¨åˆ†å†…å®¹ä¸­ï¼Œæˆ‘ä»¬ä»¥ä¸€ä¸ªç®€å•çš„ <em>åŒé‡softmaxå½¢å¼çš„çº¿æ€§Attention</em> ä¸ºå‡ºå‘ç‚¹ï¼Œé€æ­¥å¯»æ‰¾æ›´åŠ æ¥è¿‘æ ‡å‡†Attentionçš„çº¿æ€§Attentionï¼Œä»è€Œå¾—åˆ°NystrÃ¶mformerã€‚</p>
<p><a href="/usr/uploads/2021/02/3812836940.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="NystroÌˆmformerç»“æ„ç¤ºæ„å›¾ã€‚è¯»è€…å¯ä»¥è¯»å®Œä¸‹é¢å‡ èŠ‚åå†æ¥å¯¹ç…§ç€ç†è§£è¿™ä¸ªå›¾ã€‚" src="/usr/uploads/2021/02/3812836940.png" /></a></p>
<p>NystroÌˆmformerç»“æ„ç¤ºæ„å›¾ã€‚è¯»è€…å¯ä»¥è¯»å®Œä¸‹é¢å‡ èŠ‚åå†æ¥å¯¹ç…§ç€ç†è§£è¿™ä¸ªå›¾ã€‚</p>
<h3 id="softmax">åŒé‡Softmax</h3>
<p>åœ¨æ–‡ç« <a href="/archives/7546">ã€Šçº¿æ€§Attentionçš„æ¢ç´¢ï¼šAttentionå¿…é¡»æœ‰ä¸ªSoftmaxå—ï¼Ÿã€‹</a>ä¸­æˆ‘ä»¬æåˆ°äº†ä¸€ç§æ¯”è¾ƒæœ‰æ„æ€çš„çº¿æ€§Attentionï¼Œå®ƒä½¿ç”¨äº†åŒé‡softmaxæ¥æ„å»ºAttentionçŸ©é˜µï¼š<br />
\begin{equation}\left(softmax(\boldsymbol{Q}) softmax\left(\boldsymbol{K}^{\top}\right)\right)\boldsymbol{V}=softmax(\boldsymbol{Q})\left(softmax\left(\boldsymbol{K}^{\top}\right)\boldsymbol{V}\right)\label{eq:2sm}\end{equation}<br />
å¯ä»¥è¯æ˜è¿™æ ·æ„é€ å‡ºæ¥çš„AttentionçŸ©é˜µè‡ªåŠ¨æ»¡è¶³å½’ä¸€åŒ–è¦æ±‚ï¼Œä¸å¾—ä¸è¯´è¿™æ˜¯ä¸€ç§ç®€å•æ¼‚äº®çš„çº¿æ€§Attentionæ–¹æ¡ˆã€‚</p>
<p>ä¸è¿‡ï¼Œç›´æ¥å¯¹$\boldsymbol{Q},\boldsymbol{K}^{\top}$åšsoftmaxä¼¼ä¹æœ‰ç‚¹å¥‡æ€ªï¼Œæ€»æ„Ÿè§‰æ²¡æœ‰ç»è¿‡ç›¸ä¼¼åº¦ï¼ˆå†…ç§¯ï¼‰å¯¹æ¯”å°±ç›´æ¥softmaxä¼šæœ‰å“ªé‡Œä¸å¯¹åŠ²ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒNystrÃ¶mformerå…ˆåˆ†åˆ«å°†$\boldsymbol{Q},\boldsymbol{K}$è§†ä¸º$n$ä¸ª$d$ç»´å‘é‡ï¼Œç„¶åèšæˆ$m$ç±»æ¥å¾—åˆ°$m$ä¸ªèšç±»ä¸­å¿ƒæ„æˆçš„çŸ©é˜µ$\tilde{\boldsymbol{Q}},\tilde{\boldsymbol{K}}\in\mathbb{R}^{m\times d}$ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹è¿°å…¬å¼æ¥å®šä¹‰Attentionï¼š<br />
\begin{equation}\left(softmax\left(\boldsymbol{Q}\tilde{\boldsymbol{K}} ^{\top}\right)softmax\left(\tilde{\boldsymbol{Q}}\boldsymbol{K}^{\top}\right)\right)\boldsymbol{V} = softmax\left(\boldsymbol{Q} \tilde{\boldsymbol{K}}^{\top}\right)\left(softmax\left(\tilde{\boldsymbol{Q}}\boldsymbol{K}^{\top}\right)\boldsymbol{V}\right)\label{eq:2sm2}\end{equation}<br />
å…·ä½“çš„èšç±»è¿‡ç¨‹æˆ‘ä»¬ç¨åå†æ¥è®¨è®ºã€‚ç°åœ¨ï¼Œsoftmaxçš„å¯¹è±¡æ˜¯å†…ç§¯çš„ç»“æœï¼Œå…·æœ‰æ¯”è¾ƒé²œæ˜çš„ç‰©ç†æ„ä¹‰ï¼Œå› æ­¤å¯ä»¥è®¤ä¸ºä¸Šå¼æ¯”å‰é¢çš„å¼$\eqref{eq:2sm}$æ›´ä¸ºåˆç†ã€‚å¦‚æœæˆ‘ä»¬é€‰å®šä¸€ä¸ªæ¯”è¾ƒå°çš„$m$ï¼Œé‚£ä¹ˆä¸Šå¼å³ç«¯çš„å¤æ‚åº¦åªæ˜¯çº¿æ€§åœ°ä¾èµ–äº$n$ï¼Œå› æ­¤å®ƒä¹Ÿæ˜¯ä¸€ä¸ªçº¿æ€§Attentionã€‚</p>
<h3 id="_2">å‘æ ‡å‡†é è¿‘</h3>
<p>çº¯ç²¹ä»æ”¹è¿›å¼$\eqref{eq:2sm}$çš„è§’åº¦æ¥çœ‹ï¼Œå¼$\eqref{eq:2sm2}$å·²ç»è¾¾åˆ°ç›®æ ‡äº†ï¼Œä¸è¿‡NystrÃ¶mformerå¹¶ä¸å±€é™äºæ­¤ï¼Œå®ƒè¿˜å¸Œæœ›æ”¹è¿›åçš„ç»“æœä¸æ ‡å‡†Attentionæ›´åŠ æ¥è¿‘ã€‚ä¸ºæ­¤ï¼Œè§‚å¯Ÿåˆ°å¼$\eqref{eq:2sm2}$çš„æ³¨æ„åŠ›çŸ©é˜µ$softmax\left(\boldsymbol{Q}\tilde{\boldsymbol{K}}^{\top}\right)softmax\left(\tilde{\boldsymbol{Q}}\boldsymbol{K}^{\top}\right)$æ˜¯ä¸€ä¸ª$n\times m$çš„çŸ©é˜µä¹˜ä»¥ä¸€ä¸ª$m\times n$çš„çŸ©é˜µï¼Œä¸ºäº†å¾®è°ƒç»“æœï¼Œåˆä¸è‡³äºå¢åŠ è¿‡å¤šçš„å¤æ‚åº¦ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘åœ¨ä¸­é—´æ’å…¥ä¸€ä¸ª$m\times m$çš„çŸ©é˜µ$\boldsymbol{M}$ï¼š<br />
\begin{equation}softmax\left(\boldsymbol{Q}\tilde{\boldsymbol{K}} ^{\top}\right) \,\boldsymbol{M}\, softmax\left(\tilde{\boldsymbol{Q}}\boldsymbol{K}^{\top}\right)\end{equation}<br />
å¦‚ä½•é€‰æ‹©$\boldsymbol{M}$å‘¢ï¼Ÿä¸€ä¸ªåˆç†çš„è¦æ±‚æ˜¯å½“$m=n$æ—¶åº”å½“å®Œå…¨ç­‰ä»·äºæ ‡å‡†Attentionï¼Œæ­¤æ—¶$\tilde{\boldsymbol{Q}}=\boldsymbol{Q}, \tilde{\boldsymbol{K}}=\boldsymbol{K}$ï¼Œæ¨å‡º<br />
\begin{equation}\boldsymbol{M} = \left(softmax\left(\boldsymbol{Q}\boldsymbol{K}^{\top}\right)\right)^{-1} = \left(softmax\left(\tilde{\boldsymbol{Q}}\tilde{\boldsymbol{K}}^{\top}\right)\right)^{-1}\end{equation}<br />
å¯¹äºä¸€èˆ¬çš„$m$ï¼Œ$\left(softmax\left(\tilde{\boldsymbol{Q}}\tilde{\boldsymbol{K}}^{\top}\right)\right)^{-1}$æ°å¥½æ˜¯ä¸€ä¸ª$m\times m$çŸ©é˜µï¼Œå› æ­¤é€‰å®ƒä½œä¸º$\boldsymbol{M}$è‡³å°‘åœ¨çŸ©é˜µè¿ç®—ä¸Šæ˜¯åˆç†çš„ï¼Œè€Œæ ¹æ®$m=n$æ—¶çš„ç‰¹æ®Šæƒ…å†µæˆ‘ä»¬åˆ™â€œå¤§èƒ†åœ°â€æ¨æµ‹é€‰å®ƒä½œä¸º$\boldsymbol{M}$èƒ½è®©æ–°çš„Attentionæœºåˆ¶æ›´æ¥è¿‘æ ‡å‡†Attentionï¼Œå› æ­¤NystrÃ¶mformeræœ€ç»ˆé€‰æ‹©çš„æ˜¯<br />
\begin{equation}softmax\left(\boldsymbol{Q}\tilde{\boldsymbol{K}} ^{\top}\right) \, \left(softmax\left(\tilde{\boldsymbol{Q}}\tilde{\boldsymbol{K}}^{\top}\right)\right)^{-1} \, softmax\left(\tilde{\boldsymbol{Q}}\boldsymbol{K}^{\top}\right)\end{equation}<br />
ä½œä¸ºAttentionçŸ©é˜µï¼Œå®ƒæ˜¯ä¸‰ä¸ªå°çŸ©é˜µçš„ä¹˜ç§¯ï¼Œå› æ­¤é€šè¿‡çŸ©é˜µä¹˜æ³•çš„ç»“åˆå¾‹å°±èƒ½è½¬åŒ–ä¸ºçº¿æ€§Attentionã€‚</p>
<p>ä¸è¿‡ï¼Œè¿˜æœ‰ä¸€ä¸ªç†è®ºä¸Šçš„å°ç»†èŠ‚éœ€è¦è¡¥å……ä¸€ä¸‹ï¼Œé‚£å°±æ˜¯ä¸Šå¼æ¶‰åŠåˆ°çŸ©é˜µçš„æ±‚é€†ï¼Œè€Œ$softmax\left(\tilde{\boldsymbol{Q}}\tilde{\boldsymbol{K}}^{\top}\right)$æœªå¿…æ˜¯å¯é€†çš„ã€‚å½“ç„¶ï¼Œä»å®è·µä¸Šæ¥çœ‹ï¼Œä¸€ä¸ªå®æ•°çš„æ–¹é˜µä¸å¯é€†çš„æ¦‚ç‡å‡ ä¹ä¸ºé›¶ï¼ˆä¸å¯é€†æ„å‘³ç€è¡Œåˆ—å¼ä¸¥æ ¼ç­‰äº0ï¼Œä»æ¦‚ç‡ä¸Šæ¥çœ‹ä¸ç­‰äº0è‡ªç„¶æ¯”ç­‰äº0çš„æ¦‚ç‡å¤§å¾—å¤šï¼‰ï¼Œå› æ­¤è¿™ç§æƒ…å†µåœ¨å…·ä½“å®éªŒä¸­å¯ä»¥ä¸è€ƒè™‘ï¼Œä½†ç†è®ºä¸Šè¿˜æ˜¯å¾—å®Œå–„çš„ã€‚è¿™ä¸ªå…¶å®ä¹Ÿç®€å•ï¼Œå¦‚æœæ˜¯ä¸å¯é€†çš„çŸ©é˜µï¼Œé‚£å°±æ¢æˆâ€œä¼ªé€†â€å°±å¥½ï¼ˆè®°å·ä¸º$^{\dagger}$ï¼‰ï¼Œå®ƒå¯¹ä»»æ„çŸ©é˜µéƒ½å­˜åœ¨ï¼Œå¹¶ä¸”å½“çŸ©é˜µå¯é€†æ—¶ä¼ªé€†è·Ÿé€†ç›¸ç­‰ã€‚</p>
<p>å› æ­¤ï¼Œæœ€ç»ˆçš„NystrÃ¶mformerçš„AttentionçŸ©é˜µå½¢å¼ä¸º<br />
\begin{equation}softmax\left(\boldsymbol{Q}\tilde{\boldsymbol{K}} ^{\top}\right) \, \left(softmax\left(\tilde{\boldsymbol{Q}}\tilde{\boldsymbol{K}}^{\top}\right)\right)^{\dagger} \, softmax\left(\tilde{\boldsymbol{Q}}\boldsymbol{K}^{\top}\right)\label{eq:2sm3}\end{equation}</p>
<h3 id="_3">è¿­ä»£æ±‚é€†é˜µ</h3>
<p>ä»ç†è®ºä¸Šçœ‹ï¼Œå¼$\eqref{eq:2sm3}$å·²ç»è¾¾åˆ°ç›®æ ‡äº†ï¼Œä¸è¿‡è½å®åˆ°å®è·µä¸Šè¿˜éœ€è¦å¤„ç†å¥½ä¸€äº›ç»†èŠ‚é—®é¢˜ï¼Œæ¯”å¦‚ä¸Šè¿°ä¼ªé€†æ€ä¹ˆæ±‚ã€‚ä¼ªé€†åˆå«å¹¿ä¹‰é€†ã€Moore-Penroseé€†ç­‰ï¼Œæ ‡å‡†çš„æ±‚æ³•æ˜¯é€šè¿‡SVDæ¥æ±‚ï¼Œè®¾çŸ©é˜µ$\boldsymbol{A}$çš„SVDåˆ†è§£ä¸º$\boldsymbol{U} \boldsymbol{\Lambda} \boldsymbol{V}^{\top}$ï¼Œé‚£ä¹ˆå®ƒçš„ä¼ªé€†ä¸º<br />
\begin{equation}\boldsymbol{A}^{\dagger} = \boldsymbol{V} \boldsymbol{\Lambda}^{\dagger} \boldsymbol{U}^{\top}\end{equation}<br />
å…¶ä¸­å¯¹è§’é˜µ$\boldsymbol{\Lambda}$çš„ä¼ªé€†$\boldsymbol{\Lambda}^{\dagger}$ç­‰äºå°†å®ƒå¯¹è§’çº¿æ‰€æœ‰éé›¶å€¼å–å€’æ•°æ‰€å¾—åˆ°çš„æ–°å¯¹è§’é˜µã€‚SVDçš„æ±‚æ³•è™½ç„¶ç†è®ºä¸Šæ¯”è¾ƒç®€å•æ˜“æ‡‚ï¼Œä½†è®¡ç®—é‡è¿˜æ˜¯æ¯”è¾ƒå¤§çš„ï¼Œè€Œä¸”ä¹Ÿä¸å®¹æ˜“æ±‚æ¢¯åº¦ï¼Œå› æ­¤å¹¶ä¸æ˜¯å®ç°ä¼ªé€†çš„ç†æƒ³æ–¹å¼ã€‚</p>
<p>NystrÃ¶mformeré‡‡ç”¨äº†è¿­ä»£æ±‚é€†çš„è¿‘ä¼¼æ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œå®ƒé‡‡ç”¨äº†è®ºæ–‡<a href="https://www.researchgate.net/publication/220562466_Chebyshev-type_methods_and_preconditioning_techniques">ã€ŠChebyshev-type methods and preconditioning techniquesã€‹</a>æä¾›çš„è¿­ä»£ç®—æ³•ï¼š</p>
<blockquote>
<p>è‹¥åˆå§‹çŸ©é˜µ$\boldsymbol{V}<em n_1="n+1">0$æ»¡è¶³$\Vert \boldsymbol{I} - \boldsymbol{A} \boldsymbol{V}_0\Vert &lt; 1$ï¼Œé‚£ä¹ˆå¯¹äºä¸‹è¿°è¿­ä»£æ ¼å¼ \begin{equation}\begin{aligned} \boldsymbol{V}</em>} =&amp;\,\left[\boldsymbol{I} + \frac{1}{4}\left(\boldsymbol{I} - \boldsymbol{V<em n_to_infty="n\to\infty">n \boldsymbol{A}\right)\left(3 \boldsymbol{I} - \boldsymbol{V}_n \boldsymbol{A}\right)^2\right] \boldsymbol{V}_n \\\ =&amp;\,\frac{1}{4} \boldsymbol{V}_n (13 \boldsymbol{I} âˆ’ \boldsymbol{A} \boldsymbol{V}_n (15 \boldsymbol{I} âˆ’ \boldsymbol{A} \boldsymbol{V}_n (7 \boldsymbol{I} âˆ’ \boldsymbol{A} \boldsymbol{V}_n))) \end{aligned}\end{equation} æˆç«‹$\lim\limits</em>$ã€‚ } \boldsymbol{V}_n = \boldsymbol{A}^{\dagger</p>
</blockquote>
<p>è¿™é‡Œçš„$\Vert\cdot\Vert$å¯ä»¥æ˜¯ä»»æ„ä¸€ç§çŸ©é˜µèŒƒæ•°ï¼Œæ»¡è¶³æ¡ä»¶çš„ä¸€ä¸ªæ¯”è¾ƒç®€å•çš„åˆå§‹å€¼å¯ä»¥æ˜¯<br />
\begin{equation}\boldsymbol{V}<em _infty="\infty">0 = \frac{\boldsymbol{A}^{\top}}{\Vert\boldsymbol{A}\Vert_1 \Vert\boldsymbol{A}\Vert</em>}} = \frac{\boldsymbol{A}^{\top}}{\left(\max\limits_j\sum\limits_i |A_{i,j}|\right)\left(\max\limits_i\sum\limits_j |A_{i,j}|\right)}\end{equation<br />
åœ¨NystrÃ¶mformerè®ºæ–‡ä¸­ï¼Œä½œè€…ç›´æ¥ç”¨ä¸Šè¿°åˆå§‹å€¼å’Œè¿­ä»£æ ¼å¼è¿›è¡Œè¿­ä»£ï¼Œå°†è¿­ä»£6æ¬¡çš„ç»“æœæ¥ä»£æ›¿$\boldsymbol{A}^{\dagger}$ã€‚è¿­ä»£6æ¬¡çœ‹ä¸Šå»å¾ˆå¤šï¼Œä½†äº‹å®ä¸Šè®ºæ–‡æ‰€é€‰å–çš„$m$æ¯”è¾ƒå°ï¼ˆè®ºæ–‡å†™çš„æ˜¯64ï¼‰ï¼Œè¿­ä»£è¿‡ç¨‹ä¸­åˆåªæ¶‰åŠåˆ°çŸ©é˜µä¹˜æ³•ï¼Œå› æ­¤è¿­ä»£è®¡ç®—é‡ä¸ä¼šå¤ªå¤§ï¼Œè€Œä¸”åªæœ‰ä¹˜æ³•çš„è¯æ±‚æ¢¯åº¦å°±å¾ˆè½»æ¾äº†ã€‚è¿™æ ·æ±‚ä¼ªé€†çš„é—®é¢˜å°±ç®—æ˜¯è§£å†³äº†ï¼Œè®ºæ–‡å°†è¿™ä¸ªè¿­ä»£è¿‡ç¨‹ç®€å†™ä¸ºpINVã€‚</p>
<h3 id="_4">æ± åŒ–å½“èšç±»</h3>
<p>è¿˜éœ€è¦è§£å†³çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯èšç±»æ–¹æ³•çš„é€‰æ‹©ï¼Œæ¯”è¾ƒç›´æ¥çš„æƒ³æ³•è‡ªç„¶å°±æ˜¯ç›´æ¥å¥—ç”¨K-Meansäº†ã€‚ç„¶è€Œï¼ŒåŒå‰é¢æ±‚ä¼ªé€†æ‰€é¢ä¸´çš„é—®é¢˜ä¸€æ ·ï¼Œåœ¨è®¾è®¡æ¨¡å‹æ—¶ä¸ä»…è¦è€ƒè™‘å‰å‘è®¡ç®—ï¼Œè¿˜éœ€è¦è€ƒè™‘åå‘ä¼ æ’­çš„æ±‚æ¢¯åº¦ï¼Œç›´æ¥å¥—ç”¨K-Meansæ¶‰åŠåˆ°$\mathop{\text{argmin}}$æ“ä½œï¼Œæ— æ³•æ±‚å‡ºæœ‰æ„ä¹‰çš„æ¢¯åº¦ï¼Œéœ€è¦å°†å®ƒâ€œè½¯åŒ–â€æ‰èƒ½åµŒå…¥åˆ°æ¨¡å‹ä¸­ï¼Œè¿™ä¸€ç³»åˆ—æ“ä½œä¸‹æ¥ï¼Œå…¶å®å°±ç›¸å½“äºèƒ¶å›Šç½‘ç»œçš„â€œåŠ¨æ€è·¯ç”±â€è¿‡ç¨‹ï¼Œç»†èŠ‚æˆ‘ä»¬åœ¨<a href="/archives/5112">ã€Šå†æ¥ä¸€é¡¿è´ºå²å®´ï¼šä»K-Meansåˆ°Capsuleã€‹</a>è®¨è®ºè¿‡ã€‚è¿™ä¸ªæ–¹æ¡ˆçš„ä¸»è¦é—®é¢˜æ˜¯K-Meansæ˜¯ä¸€ä¸ªè¿­ä»£è¿‡ç¨‹ï¼Œéœ€è¦è¿­ä»£å‡ æ¬¡æ‰èƒ½ä¿è¯æ•ˆæœï¼Œè¿™å¯¼è‡´è®¡ç®—é‡æ˜æ˜¾åŠ å¤§ï¼Œä¸æ˜¯ç‰¹åˆ«ç†æƒ³ã€‚</p>
<p>NystrÃ¶mformeré€‰äº†ä¸€ä¸ªéå¸¸ç®€å•çš„æ–¹æ¡ˆï¼šå‡è®¾åºåˆ—é•¿åº¦$n$æ˜¯$m$çš„æ•´æ•°å€ï¼ˆå¦‚æœä¸æ˜¯ï¼Œpaddingé›¶å‘é‡ï¼‰ï¼Œé‚£ä¹ˆå°†$\boldsymbol{Q},\boldsymbol{K}$çš„æ¯$n/m$ä¸ªå‘é‡æ±‚å¹³å‡ä½œä¸º$\tilde{\boldsymbol{Q}}, \tilde{\boldsymbol{K}}$çš„æ¯ä¸ªå‘é‡ã€‚è¿™ä¸ªæ“ä½œå«åšAdaptive Average Poolingï¼ˆåŸè®ºæ–‡ç§°ä¸ºSegment-Meansï¼Œç®€ç§°sMEANSï¼‰ï¼Œå³æ˜¯ä¸€ç§å¹³å‡æ± åŒ–æ–¹æ³•ï¼Œé€šè¿‡è‡ªé€‚åº”çª—å£å¤§å°ä½¿å¾—å¹³å‡æ± åŒ–åçš„ç‰¹å¾çŸ©é˜µå…·æœ‰å›ºå®šçš„å½¢çŠ¶ã€‚NystrÃ¶mformerçš„å®éªŒè¡¨æ˜ï¼Œä¸éœ€è¦æ¯”è¾ƒå¤æ‚çš„èšç±»æ–¹æ³•ï¼Œå°±è¿™æ ·ä½¿ç”¨ç®€å•çš„è‡ªé€‚åº”æ± åŒ–å°±å¯ä»¥å–å¾—éå¸¸æœ‰ç«äº‰åŠ›çš„æ•ˆæœäº†ï¼Œè€Œä¸”åªéœ€è¦é€‰æ‹©$m=64$ï¼Œè·Ÿæ˜ å°„å‰çš„$d$æ˜¯ä¸€èˆ¬å¤§å°ï¼Œè¿™æ¯”Performerè¦é€‰æ‹©æ¯”$d$å¤§å‡ å€çš„$m$è¦å¥½å¾—å¤šäº†ã€‚</p>
<p>ä¸è¿‡ï¼Œè‡ªé€‚åº”æ± åŒ–çš„ä¸€ä¸ªæ˜æ˜¾ç¼ºç‚¹æ˜¯ä¼šâ€œç³…åˆâ€æ¯ä¸€ä¸ªåŒºé—´çš„ä¿¡æ¯ï¼Œå¯¼è‡´å®ƒä¸èƒ½é˜²æ­¢æœªæ¥ä¿¡æ¯æ³„æ¼è€Œä¸èƒ½åšè‡ªå›å½’ç”Ÿæˆï¼ˆè¯­è¨€æ¨¡å‹æˆ–è€…Seq2Seqçš„è§£ç å™¨ï¼‰ï¼Œè¿™åŸºæœ¬æ˜¯ä»»ä½•å¸¦æœ‰PoolingæŠ€æœ¯çš„æ¨¡å‹çš„ç¼ºç‚¹ã€‚</p>
<h2 id="_5">å®éªŒä¸åˆ†æ</h2>
<p>è¿™é‡Œæˆ‘ä»¬æ±‡æ€»ä¸€ä¸‹NystrÃ¶mformerçš„å®éªŒç»“æœï¼Œå¹¶ä¸”åˆ†äº«ä¸€ä¸‹ç¬”è€…å¯¹å®ƒçš„ä¸€äº›çœ‹æ³•å’Œæ€è€ƒã€‚</p>
<h3 id="_6">æ€§èƒ½ä¸æ•ˆæœ</h3>
<p>å¯èƒ½å—é™äºç®—åŠ›ï¼ŒåŸè®ºæ–‡åšçš„å®éªŒä¸ç®—ç‰¹åˆ«ä¸°å¯Œï¼Œä¸»è¦æ˜¯å°†smallå’Œbaseç‰ˆæœ¬çš„BERTé‡Œè¾¹çš„æ ‡å‡†Attentionæ›¿æ¢ä¸ºNystrÃ¶mformerè¿›è¡Œå¯¹æ¯”å®éªŒï¼Œå®éªŒç»“æœä¸»è¦æ˜¯ä¸‹é¢ä¸¤ä¸ªå›¾ã€‚å…¶ä¸­ä¸€ä¸ªæ˜¯é¢„è®­ç»ƒæ•ˆæœå›¾ï¼Œå…¶ä¸­æ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯NystrÃ¶mformeråœ¨MLMä»»åŠ¡ä¸Šçš„æ•ˆæœæ¯”æ ‡å‡†Attentionè¿˜è¦ä¼˜ï¼›å¦å¤–æ˜¯åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šçš„å¾®è°ƒæ•ˆæœï¼Œæ˜¾ç¤ºå‡ºè·Ÿæ ‡å‡†Attentionï¼ˆå³BERTï¼‰æ¯”è¿˜æ˜¯æœ‰ç«äº‰åŠ›çš„ã€‚  </p>
<p><a href="/usr/uploads/2021/02/3955448968.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="NystroÌˆmformeråœ¨é¢„è®­ç»ƒä»»åŠ¡ï¼ˆMLMå’ŒSOPï¼‰ä¸Šçš„æ•ˆæœ" src="/usr/uploads/2021/02/3955448968.png" /></a></p>
<p>NystroÌˆmformeråœ¨é¢„è®­ç»ƒä»»åŠ¡ï¼ˆMLMå’ŒSOPï¼‰ä¸Šçš„æ•ˆæœ</p>
<p><a href="/usr/uploads/2021/02/224692033.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="NystroÌˆmformeråœ¨ä¸‹æ¸¸ä»»åŠ¡çš„å¾®è°ƒæ•ˆæœ" src="/usr/uploads/2021/02/224692033.png" /></a></p>
<p>NystroÌˆmformeråœ¨ä¸‹æ¸¸ä»»åŠ¡çš„å¾®è°ƒæ•ˆæœ</p>
<p>ä¸è¿‡ï¼ŒåŸè®ºæ–‡å¹¶æ²¡æœ‰æ¯”è¾ƒNystrÃ¶mformerè·ŸåŒç±»æ¨¡å‹çš„æ•ˆæœå·®å¼‚ï¼Œåªæ˜¯æä¾›ä¸‹é¢çš„ä¸€å¼ å¤æ‚åº¦å¯¹æ¯”å›¾ï¼Œå› æ­¤æ— æ³•æ›´å¥½åœ°çªå‡ºNystrÃ¶mformerçš„ç«äº‰åŠ›ï¼š  </p>
<p><a href="/usr/uploads/2021/02/1447501421.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="ä¸åŒæ¨¡å‹çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦å¯¹æ¯”å›¾" src="/usr/uploads/2021/02/1447501421.png" /></a></p>
<p>ä¸åŒæ¨¡å‹çš„æ—¶é—´å’Œç©ºé—´å¤æ‚åº¦å¯¹æ¯”å›¾</p>
<h3 id="_7">ä¸ªäººçš„æ€è€ƒ</h3>
<p>æ€»çš„æ¥è¯´ï¼ŒNystrÃ¶mformerå¯¹æ ‡å‡†Attentionè¿›è¡Œè¿‘ä¼¼çº¿æ€§åŒ–çš„æ€è·¯è¿˜æ˜¯æ¯”è¾ƒæ–°é¢–çš„ï¼Œå€¼å¾—å­¦ä¹ ä¸å‚è€ƒã€‚ä¸è¿‡ä¼ªé€†éƒ¨åˆ†çš„å¤„ç†æ€»æ„Ÿè§‰æœ‰ç‚¹ä¸å¤§è‡ªç„¶ï¼Œè¿™éƒ¨åˆ†å¯èƒ½æ˜¯æœªæ¥çš„ä¸€ä¸ªæ”¹è¿›ç‚¹ï¼Œå¦‚æœå¯ä»¥åšåˆ°ä¸ç”¨è¿‘ä¼¼ï¼Œé‚£å°±æ¯”è¾ƒå®Œç¾äº†ã€‚è¿˜æœ‰ï¼Œå¦‚ä½•å®šé‡åœ°ä¼°è®¡NystrÃ¶mformerä¸æ ‡å‡†Attentionçš„è¯¯å·®ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå€¼å¾—æ€è€ƒçš„ç†è®ºé—®é¢˜ã€‚</p>
<p>ä»å®éªŒä¸Šæ¥çœ‹ï¼ŒNystrÃ¶mformerè·Ÿæ ‡å‡†Attentionç›¸æ¯”è¿˜æ˜¯æ˜¾å¾—æœ‰ç«äº‰åŠ›çš„ï¼Œå°¤å…¶æ˜¯MLMçš„ç»“æœæ¯”æ ‡å‡†Attentionè¿˜å¥½ï¼Œæ˜¾ç¤ºäº†NystrÃ¶mformerçš„æ½œåŠ›ã€‚æ­¤å¤–ï¼Œå‰é¢è¯´åˆ°åŒ…å«äº†Poolingå¯¼è‡´ä¸èƒ½åšè‡ªå›å½’ç”Ÿæˆæ˜¯NystrÃ¶mformerçš„ä¸€ä¸ªæ˜¾è‘—ç¼ºç‚¹ï¼Œä¸çŸ¥é“æœ‰æ²¡æœ‰åŠæ³•å¯ä»¥å¼¥è¡¥ï¼Œåæ­£ç¬”è€…ç›®å‰æ˜¯æ²¡æœ‰æƒ³åˆ°å¥½çš„æ–¹å‘ã€‚</p>
<p>è·ŸPerformerç›¸æ¯”ï¼ŒNystrÃ¶mformerå»é™¤äº†çº¿æ€§åŒ–è¿‡ç¨‹ä¸­çš„éšæœºæ€§ï¼Œå› ä¸ºPerformeræ˜¯é€šè¿‡éšæœºæŠ•å½±æ¥è¾¾åˆ°çº¿æ€§åŒ–çš„ï¼Œè¿™å¿…ç„¶ä¼šå¸¦æ¥éšæœºæ€§ï¼Œå¯¹äºæŸäº›æœ‰å¼ºè¿«ç—‡çš„è¯»è€…æ¥è¯´ï¼Œè¿™ä¸ªéšæœºæ€§å¯èƒ½æ˜¯éš¾ä»¥æ¥å—çš„å­˜åœ¨ï¼Œè€ŒNystrÃ¶mformeråˆ™ä¸å­˜åœ¨è¿™ç§éšæœºæ€§ï¼Œå› æ­¤ä¹Ÿç®—æ˜¯ä¸€ä¸ªäº®ç‚¹ã€‚</p>
<h3 id="nystrom">NystrÃ¶mæ–¹æ³•</h3>
<p>å¯èƒ½æœ‰äº›è¯»è€…è¿˜æ˜¯æƒ³å­¦ä¹ ä¸€ä¸‹NystrÃ¶mæ–¹æ³•ï¼Œè¿™é‡Œç¨å¾®è¡¥å……ä¸€ä¸‹ã€‚è¦ç†è§£NystrÃ¶mæ–¹æ³•ï¼Œéœ€è¦å…ˆç®€å•è®¤è¯†ä¸€ä¸‹çŸ©é˜µçš„CURåˆ†è§£ã€‚</p>
<p>å¤§å®¶å¯èƒ½éƒ½å¬è¯´è¿‡çŸ©é˜µçš„SVDåˆ†è§£ï¼Œæ ¼å¼ä¸º$\boldsymbol{A}=\boldsymbol{U} \boldsymbol{\Lambda} \boldsymbol{V}^{\top}$ï¼Œå…¶ä¸­$\boldsymbol{U},\boldsymbol{V}$æ˜¯æ­£äº¤çŸ©é˜µè€Œ$\boldsymbol{\Lambda}$æ˜¯å¯¹è§’çŸ©é˜µã€‚è¦æ³¨æ„$\boldsymbol{U},\boldsymbol{V}$æ˜¯æ­£äº¤çŸ©é˜µæ„å‘³ç€å®ƒä»¬æ˜¯ç¨ å¯†çš„ï¼Œé‚£ä¹ˆå½“$\boldsymbol{A}$å¾ˆå¤§çš„æ—¶å€™SVDçš„è®¡ç®—æˆæœ¬å’Œå‚¨å­˜æˆæœ¬éƒ½å¾ˆå¤§ï¼ˆå“ªæ€•æ˜¯åšäº†è¿‘ä¼¼ï¼‰ã€‚ç°åœ¨å‡è®¾$\boldsymbol{A}$å¾ˆå¤§ä½†å¾ˆç¨€ç–ï¼Œé‚£ä¹ˆå®ƒçš„SVDåˆ†è§£æ¯”åŸå§‹çŸ©é˜µè¿˜ä¸åˆ’ç®—å¾—å¤šå¾—å¤šã€‚ä¸ºæ­¤ï¼ŒCURåˆ†è§£åº”è¿è€Œç”Ÿï¼Œå®ƒå¸Œæœ›ä»åŸçŸ©é˜µä¸­é€‰æ‹©$k$åˆ—ç»„æˆçŸ©é˜µ$\boldsymbol{C}$ã€é€‰æ‹©$k$è¡Œç»„æˆçŸ©é˜µ$\boldsymbol{R}$ï¼Œå¹¶æ’å…¥ä¸€ä¸ª$k\times k$çš„çŸ©é˜µ$\boldsymbol{U}$ï¼Œä½¿å¾—<br />
\begin{equation}\boldsymbol{A} \approx \boldsymbol{C}\boldsymbol{U}\boldsymbol{R}\end{equation}<br />
ç”±äº$\boldsymbol{C},\boldsymbol{R}$éƒ½æ˜¯åŸå¥å­çš„ä¸€éƒ¨åˆ†ï¼Œå› æ­¤ä¹Ÿç»§æ‰¿äº†ç¨€ç–æ€§ã€‚å…³äºCURåˆ†è§£ï¼Œè¯»è€…è¿˜å¯ä»¥å‚è€ƒæ–¯å¦ç¦çš„CS246è¯¾ç¨‹çš„<a href="https://web.stanford.edu/class/cs246/slides/06-dim_red.pdf">ã€ŠDimensionality Reductionã€‹</a>ä¸€èŠ‚ã€‚è·ŸSVDä¸åŒçš„æ˜¯ï¼ŒCURåˆ†è§£åœ¨ç¬”è€…çœ‹æ¥æ›´å¤šçš„æ˜¯ä¸€ç§åˆ†è§£æ€æƒ³è€Œä¸æ˜¯å…·ä½“çš„åˆ†è§£ç®—æ³•ï¼Œå®ƒæœ‰ä¸åŒçš„å®ç°æ–¹å¼ï¼Œæ¯”å¦‚NystrÃ¶mæ–¹æ³•ä¹Ÿç®—æ˜¯å…¶ä¸­ä¸€ç§ï¼Œåˆ†è§£å½¢å¼ä¸º<br />
\begin{equation}\begin{pmatrix}\boldsymbol{A} &amp; \boldsymbol{B} \\\ \boldsymbol{C} &amp; \boldsymbol{D}\end{pmatrix} \approx \begin{pmatrix}\boldsymbol{A} &amp; \boldsymbol{B} \\\ \boldsymbol{C} &amp; \boldsymbol{C}\boldsymbol{A}^{\dagger}\boldsymbol{B}\end{pmatrix} = \begin{pmatrix}\boldsymbol{A} \\\ \boldsymbol{C}\end{pmatrix} \boldsymbol{A}^{\dagger} \begin{pmatrix}\boldsymbol{A} &amp; \boldsymbol{B}\end{pmatrix}\end{equation}<br />
å…¶ä¸­$\begin{pmatrix}\boldsymbol{A} \\\ \boldsymbol{C}\end{pmatrix}$å’Œ$\begin{pmatrix}\boldsymbol{A} &amp; \boldsymbol{B}\end{pmatrix}$é€‰å‡ºæ¥çš„åˆ—çŸ©é˜µå’Œè¡ŒçŸ©é˜µï¼Œè¿™é‡Œä¸ºäº†æ–¹ä¾¿æè¿°ï¼Œå‡è®¾äº†ç»è¿‡æ’åˆ—åé€‰å‡ºæ¥çš„è¡Œåˆ—å‡æ’åœ¨çŸ©é˜µå‰é¢ã€‚NystrÃ¶mformerå…¶å®ä¹Ÿæ²¡æœ‰ç›´æ¥ç”¨NystrÃ¶mæ–¹æ³•ï¼ˆäº‹å®ä¸Šä¹Ÿç›´æ¥å¥—ç”¨ä¸äº†ï¼ŒåŸè®ºæ–‡æœ‰æè¿°ï¼‰ï¼Œè€Œæ˜¯å€Ÿé‰´äº†NystrÃ¶mæ–¹æ³•çš„åˆ†è§£æ€æƒ³è€Œå·²ã€‚</p>
<p>å…³äºNystrÃ¶mæ–¹æ³•ï¼ŒåŸè®ºæ–‡ä¸»è¦å¼•ç”¨çš„æ˜¯<a href="https://papers.cool/arxiv/1303.4207">ã€ŠImproving CUR Matrix Decomposition and the NystrÃ¶m Approximation via Adaptive Samplingã€‹</a>ï¼Œä½†å¹¶ä¸æ¨èæ–°æ‰‹è¯»è¿™ç¯‡è®ºæ–‡ï¼Œè€Œæ¨èè¯»<a href="https://papers.cool/arxiv/1305.0203">ã€ŠMatrix Compression using the Nystro Ìˆm Methodã€‹</a>å’Œ<a href="https://www.researchgate.net/publication/49459305_Using_the_Nystroem_Method_to_Speed_Up_Kernel_Machines">ã€ŠUsing the NystrÃ¶m Method to Speed Up Kernel Machinesã€‹</a>ã€‚</p>
<p>è¦ç‰¹åˆ«è¯´æ˜çš„æ˜¯ï¼Œå¯¹äºCURåˆ†è§£å’ŒNystrÃ¶mæ–¹æ³•ï¼Œç¬”è€…ä¹Ÿæ˜¯æ–°å­¦çš„ï¼Œå¯èƒ½æœ‰ç†è§£ä¸å½“çš„åœ°æ–¹ï¼Œè¯·è¯»è€…è‡ªè¡Œç”„åˆ«ç†è§£ï¼Œä¹Ÿæ¬¢è¿ç†Ÿæ‚‰ç›¸å…³ç†è®ºçš„è¯»è€…äº¤æµæŒ‡æ­£ã€‚</p>
<h2 id="_8">æ¥ä¸€ä¸ªå°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†æå‡Transformeræ•ˆç‡çš„ä¸€ä¸ªæ–°å·¥ä½œNystrÃ¶mformerï¼Œå®ƒå€Ÿé‰´äº†NystrÃ¶mæ–¹æ³•çš„æ€æƒ³æ¥æ„å»ºä¸€ä¸ªèƒ½é€¼è¿‘æ ‡å‡†Attentionçš„çº¿æ€§Attentionï¼Œç±»ä¼¼æ€æƒ³çš„å·¥ä½œè¿˜æœ‰Performerï¼Œä¸¤è€…ç›¸æ¯”å„æœ‰è‡ªå·±çš„ä¼˜ç¼ºç‚¹ï¼Œéƒ½æ˜¯å€¼å¾—å­¦ä¹ çš„å·¥ä½œã€‚æœ¬æ–‡åˆ†äº«äº†ç¬”è€…è‡ªå·±å¯¹NystrÃ¶mformerçš„ç†è§£ï¼Œçªƒè®¤ä¸ºè¿™ç§é€”å¾„æ›´åŠ æ˜“æ‡‚ä¸€äº›ï¼Œå¦‚æœ‰è°¬è¯¯ï¼Œè‚¯è¯·è¯»è€…æŒ‡æ­£ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8180">https://spaces.ac.cn/archives/8180</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Feb. 16, 2021). ã€ŠNystrÃ¶mformerï¼šåŸºäºçŸ©é˜µåˆ†è§£çš„çº¿æ€§åŒ–Attentionæ–¹æ¡ˆ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8180">https://spaces.ac.cn/archives/8180</a></p>
<p>@online{kexuefm-8180,<br />
title={NystrÃ¶mformerï¼šåŸºäºçŸ©é˜µåˆ†è§£çš„çº¿æ€§åŒ–Attentionæ–¹æ¡ˆ},<br />
author={è‹å‰‘æ—},<br />
year={2021},<br />
month={Feb},<br />
url={\url{https://spaces.ac.cn/archives/8180}},<br />
} </p>
<hr />
<h2 id="_9">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>TODO: æ·»åŠ è¯¦ç»†çš„æ•°å­¦å…¬å¼æ¨å¯¼å’Œæ³¨é‡Š</p>
        </div>
    </div>
</body>
</html>