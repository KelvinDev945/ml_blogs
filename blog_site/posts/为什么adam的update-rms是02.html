<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ºä»€ä¹ˆAdamçš„Update RMSæ˜¯0.2ï¼Ÿ</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ä¸ºä»€ä¹ˆAdamçš„Update RMSæ˜¯0.2ï¼Ÿ</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 38.9 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11267">https://spaces.ac.cn/archives/11267</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ä¼—æ‰€å‘¨çŸ¥ï¼Œæˆ‘ä»¬å¾ˆæ—©å°±å¼€å§‹å°è¯•å°†Muonç”¨äºå¤§è§„æ¨¡LLMçš„è®­ç»ƒã€‚ç‰¹åˆ«åœ°ï¼Œåœ¨<a href="/archives/10739">ã€ŠMuonç»­é›†ï¼šä¸ºä»€ä¹ˆæˆ‘ä»¬é€‰æ‹©å°è¯•Muonï¼Ÿã€‹</a>ä¸­ï¼Œæˆ‘ä»¬æå‡ºäº†â€œMatch Adam Update RMSâ€çš„æŠ€å·§ï¼Œä»¥ä¾¿å¿«é€Ÿä»Adamè¿ç§»åˆ°Muonä¸Šï¼Œè¿™ä¸ªæŠ€å·§åŒæ ·ç”¨åˆ°äº†Kimi K2çš„è®­ç»ƒä¸­ã€‚è¯¥æŠ€å·§æ˜¯æŒ‡å°†Muonçš„Update RMSç»Ÿä¸€æˆ0.2ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¤ç”¨Adamçš„å­¦ä¹ ç‡å’Œæƒé‡è¡°å‡ç‡ã€‚</p>
<p>è¿™ä¸€æŠ€å·§çš„èƒŒåï¼Œæ˜¯æˆ‘ä»¬è§‚å¯Ÿåˆ°Adamçš„Update RMSçº¦ç­‰äº0.2ï¼Œå¹¶ä¸”è¿™ä¸€ç°è±¡æ˜¯ç¨³å®šä¸”å¯å¤ç°çš„ã€‚è¿™ä¾¿å¼•å‘äº†ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼šä¸ºä»€ä¹ˆAdamçš„Update RMSæ˜¯0.2ï¼Ÿæˆ‘ä»¬å¯ä»¥ä»ç†è®ºä¸Šè§£é‡Šå®ƒå—ï¼Ÿ</p>
<h2 id="_1">é—®é¢˜å¼•å…¥</h2>
<p>é¦–å…ˆæè¿°ä¸€ä¸‹ç°è±¡ï¼šä»å®éªŒä¸­æˆ‘ä»¬è§‚å¯Ÿåˆ°ï¼Œå¤§è‡´ä¸Šåœ¨Warmupç»“æŸã€æ¨¡å‹è¿›å…¥æ­£å¼è®­ç»ƒåï¼ŒAdamçš„Update RMSå‡ ä¹éƒ½ä¿æŒåœ¨0.2ï½0.3ä¹‹é—´ï¼Œå¹¶ä¸”ä¸åŒå°ºå¯¸çš„æ¨¡å‹ä¹Ÿå‘ˆç°å‡ºç›¸ä¼¼çš„è§„å¾‹ã€‚è¿™äº›æ¨¡å‹çš„å…±åŒç‚¹æ˜¯éƒ½ç”¨Adamè®­ç»ƒï¼Œå‚æ•°æ˜¯$\beta_1=0.9,\beta_2=0.95$ã€‚ç”±äºå…±æ€§å¾ˆæ˜æ˜¾ï¼Œæ‰€ä»¥è¿™å¤§æ¦‚ç‡ä¸æ˜¯å·§åˆï¼Œå› æ­¤ç¬”è€…å°è¯•åˆ†æèƒŒåçš„åŸç†ã€‚</p>
<p>ç„¶åæˆ‘ä»¬å›é¡¾ä¸€ä¸‹Adamä¼˜åŒ–å™¨çš„å½¢å¼ï¼š<br />
\begin{equation}\text{Adam}\color{skyblue}{\text{W}}:=\left\{\begin{aligned}<br />
&amp;\boldsymbol{m}<em t-1="t-1">t = \beta_1 \boldsymbol{m}</em>} + \left(1 - \beta_1\right) \boldsymbol{g<em t-1="t-1">t\\\<br />
&amp;\boldsymbol{v}_t = \beta_2 \boldsymbol{v}</em>} + \left(1 - \beta_2\right) \boldsymbol{g<em t-1="t-1">t^2\\\<br />
&amp;\hat{\boldsymbol{m}}_t = \boldsymbol{m}_t\left/\left(1 - \beta_1^t\right)\right.\\\<br />
&amp;\hat{\boldsymbol{v}}_t = \boldsymbol{v}_t\left/\left(1 - \beta_2^t\right)\right.\\\<br />
&amp;\boldsymbol{u}_t =\hat{\boldsymbol{m}}_t\left/\left(\sqrt{\hat{\boldsymbol{v}}_t} + \epsilon\right)\right.\\\<br />
&amp;\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>} - \eta_t (\boldsymbol{u<em t-1="t-1">t \color{skyblue}{ + \lambda_t \boldsymbol{\theta}</em>)}<br />
\end{aligned}\right.\end{equation}<br />
æ³¨æ„ï¼šæœ¬æ–‡æ‰€æœ‰å‘é‡çš„ä¹˜é™¤æ³•ï¼ŒåŒ…æ‹¬å¹³æ–¹ï¼Œé»˜è®¤éƒ½æ˜¯æŒ‡Hadamardç§¯/å•†ï¼Œå³Element-wiseçš„ä¹˜/é™¤ã€‚</p>
<p>æˆ‘ä»¬è¦åšçš„äº‹æƒ…ï¼Œå°±æ˜¯è¯æ˜$\Vert\boldsymbol{u}<em RMS="RMS">t\Vert</em>$ã€‚}\approx 0.2$ï¼Œè‡³å°‘åœ¨$\beta_1=0.9,\beta_2=0.95$è¿™ç»„è®¾ç½®ä¸‹å¦‚æ­¤ã€‚æˆ‘ä»¬å‡è®¾$\epsilon$è¶³å¤Ÿå°ï¼Œä»¥è‡³äºå¯ä»¥å¿½ç•¥å®ƒï¼Œå¹¶ä¸”æˆ‘ä»¬è€ƒè™‘$t\to \infty$çš„ç¨³æ€ï¼Œé‚£ä¹ˆ$\beta_1^t$ã€$\beta_2^t$éƒ½è¶³å¤Ÿæ¥è¿‘äºé›¶ï¼Œæ‰€ä»¥ä¸ç”¨åŒºåˆ†$\boldsymbol{m}_t$å’Œ$\hat{\boldsymbol{m}}_t$ã€$\boldsymbol{v}_t$å’Œ$\hat{\boldsymbol{v}}_t$ï¼Œç”±æ­¤æœ‰$\boldsymbol{u}_t =\boldsymbol{m}_t/\sqrt{\boldsymbol{v}_t</p>
<p>å¯¹äº$\boldsymbol{m}<em i="1">t,\boldsymbol{v}_t$ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°å±•å¼€å¼<br />
\begin{equation}\boldsymbol{m}_t = (1 - \beta_1)\sum</em>}^t \beta_1^{t-i}\boldsymbol{g<em i="1">i,\qquad \boldsymbol{v}_t = (1 - \beta_2)\sum</em>}^t \beta_2^{t-i}\boldsymbol{g}_i^2\end{equation</p>
<h2 id="_2">æ•°å€¼æ¨¡æ‹Ÿ</h2>
<p>å¦‚æœæˆ‘ä»¬å‡è®¾$\boldsymbol{g}<em RMS="RMS">1,\boldsymbol{g}_2,\cdots,\boldsymbol{g}_t$éƒ½æ˜¯ä»åŒä¸€ä¸ªåˆ†å¸ƒé‡‡æ ·å‡ºæ¥çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ç”¨æ•°å€¼æ¨¡æ‹Ÿçš„æ–¹æ³•ä¼°è®¡$\Vert\boldsymbol{u}_t\Vert</em>)$è¿›è¡Œå°è¯•ï¼Œå‚è€ƒä»£ç å¦‚ä¸‹ï¼š}$ã€‚äº‹ä¸å®œè¿Ÿï¼Œè®©æˆ‘ä»¬ä»æœ€ç®€å•çš„æ ‡å‡†æ­£æ€åˆ†å¸ƒ$\mathcal{N}(\boldsymbol{0},\boldsymbol{I</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">N</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">2000</span>
<span class="n">beta1</span><span class="p">,</span> <span class="n">beta2</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span>
<span class="n">m</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">beta1</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta1</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">beta2</span> <span class="o">*</span> <span class="n">v</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta2</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="n">v</span><span class="o">**</span><span class="mf">0.5</span>

<span class="n">rms</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="kp">mean</span><span class="p">()</span><span class="o">**</span><span class="mf">0.5</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rms</span><span class="p">)</span>
</code></pre></div>

<p>å¤§å®¶çŒœçŒœç»“æœæ˜¯å¤šå°‘ï¼Ÿç­”æ¡ˆå¤§æ¦‚æ˜¯0.225ï¼Œå±…ç„¶è·Ÿå®éªŒç»“æœæƒŠäººåœ°ç›¸ä¼¼ï¼è¿™åè¿‡æ¥è¡¨æ˜æˆ‘ä»¬çš„æ¨¡æ‹Ÿå‡è®¾è·Ÿå®é™…æƒ…å†µè¿˜æ˜¯å¾ˆå»åˆçš„ã€‚å¯èƒ½æœ‰è¯»è€…è§‰å¾—ä¸å¯¹ï¼Œ$\boldsymbol{g}\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I})$ä¸æ˜¯çº¯å™ªå£°äº†å—ï¼Œè¿™è¿˜èƒ½å»åˆï¼Ÿå®é™…è®­ç»ƒå½“ç„¶ä¸å¯èƒ½æ˜¯çº¯å™ªå£°ï¼Œåªèƒ½è¯´å•æ¬¡æ¢¯åº¦çš„ä¿¡å™ªæ¯”å°å¾—å¯æ€œï¼Œå› æ­¤å¯ä»¥ç”¨çº¯å™ªå£°æ¥æ¨¡æ‹Ÿã€‚</p>
<p>è¯»è€…å¯ä»¥è‡ªè¡ŒæŠ˜è…¾ä¸€ä¸‹ä¸Šè¿°å‚è€ƒä»£ç ï¼Œè§‚å¯ŸUpdate RMSçš„å½±å“å˜é‡ï¼Œå¤§ä½“ç»“è®ºæ˜¯ï¼šUpdate RMSè·Ÿ$\beta_1$æ­£ç›¸å…³ï¼Œè·Ÿ$\beta_2$ä¼¼ä¹å…³ç³»ä¸å¤§ï¼Œå¦‚æœ$\boldsymbol{g}$çš„åˆ†å¸ƒå…·æœ‰éé›¶å‡å€¼ï¼ˆç›¸å½“äºå¢å¤§æ¢¯åº¦çš„ä¿¡å™ªæ¯”ï¼‰ï¼Œé‚£ä¹ˆUpdate RMSä¹Ÿä¼šå˜å¤§ã€‚</p>
<h2 id="_3">å¹³å‡è¿‘ä¼¼</h2>
<p>è¿™ä¸€èŠ‚ç¬”è€…å°è¯•ä»ç†è®ºæ–¹é¢æ¨å¯¼ä¸Šè¿°æ¨¡æ‹Ÿç»“æœçš„ä¸€ä¸ªè¿‘ä¼¼è§£æè§£ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬ä»RMSçš„å®šä¹‰å¯çŸ¥ï¼Œè¦æ±‚$\Vert\boldsymbol{u}<em RMS="RMS">t\Vert</em>}$ï¼Œéœ€è¦å…ˆæ±‚$\boldsymbol{u<em i="1">t^2 = \boldsymbol{m}_t^2/\boldsymbol{v}_t$ã€‚ç¬”è€…çš„æƒ³æ³•æ˜¯ï¼Œç”¨$\boldsymbol{u}_t^2$çš„æœŸæœ›ä½œä¸ºå®ƒçš„è¿‘ä¼¼ï¼Œå¹¶è¿›ä¸€æ­¥è½¬åŒ–ä¸ºå¹³å‡åœºè¿‘ä¼¼ï¼š<br />
\begin{equation}\mathbb{E}[\boldsymbol{u}_t^2] = \mathbb{E}\left[\frac{\boldsymbol{m}_t^2}{\boldsymbol{v}_t}\right] \approx \frac{\mathbb{E}[\boldsymbol{m}_t^2]}{\mathbb{E}[\boldsymbol{v}_t]}\end{equation}<br />
å¯èƒ½ä¼šæœ‰è¯»è€…è´¨ç–‘æœ€åä¸€æ­¥è¿‘ä¼¼çš„åˆç†æ€§ã€‚ç¬”è€…çš„å»ºè®®æ˜¯ï¼Œå…ˆä¸ç®¡è¿™äº›ç»†ææœ«èŠ‚ï¼Œå°±å¥½æ¯”ä¸Šä¸€èŠ‚å‡è®¾$\boldsymbol{g}\sim\mathcal{N}(\boldsymbol{0},\boldsymbol{I})$ä¸€æ ·ï¼Œå…ˆç®—äº†å†è¯´ï¼Œå¦‚æœç»“æœåˆç†é‚£ä¹ˆè¿‡ç¨‹å¿…ç„¶ä¸€å®šç¨‹åº¦ä¸Šä¹Ÿæ˜¯åˆç†çš„ã€‚ç°åœ¨æˆ‘ä»¬åˆ†åˆ«ç®—åˆ†å­ã€åˆ†æ¯ï¼Œè¿™æ¬¡æˆ‘ä»¬ä¸€èˆ¬åœ°è®¾$\mathbb{E}[\boldsymbol{g}]=\boldsymbol{\mu},\mathbb{E}[\boldsymbol{g}^2]=\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2 $ï¼Œå…¶ä¸­åˆ†æ¯æ¯”è¾ƒç®€å•<br />
\begin{equation}\begin{aligned}<br />
\mathbb{E}[\boldsymbol{v}_t] =&amp;\, (1 - \beta_2)\sum</em>}^t \beta_2^{t-i}\mathbb{E}[\boldsymbol{g<em i="1">i^2] \\\<br />
=&amp;\, (1 - \beta_2)\sum</em>^2) \\\}^t \beta_2^{t-i}(\boldsymbol{\mu}^2 + \boldsymbol{\sigma<br />
=&amp;\, (1 - \beta_2^t) (\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2) \\\[5pt]<br />
\approx &amp;\, \boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2 \qquad(t\to\infty)<br />
\end{aligned}\end{equation}<br />
è‡³äºåˆ†å­ï¼Œå¯ä»¥ç›´æ¥å±•å¼€å¹³æ–¹è®¡ç®—ï¼Œä¹Ÿå¯ä»¥ç¨å¾®å·æ‡’ä¸€ä¸‹ï¼šæˆ‘ä»¬è¦æ±‚çš„æ˜¯$\boldsymbol{m}<em i="1">t$çš„äºŒé˜¶çŸ©$\mathbb{E}[\boldsymbol{m}_t^2]$ï¼Œå®ƒåˆç­‰äº$\mathbb{E}[\boldsymbol{m}_t]^2 + \mathbb{V}ar[\boldsymbol{m}_t]$ã€‚$\mathbb{E}[\boldsymbol{m}_t]$çš„è®¡ç®—è·Ÿ$\mathbb{E}[\boldsymbol{m}_t]$ç±»ä¼¼ï¼Œç»“æœæ˜¯$(1 - \beta_1^t)\boldsymbol{\mu}\approx\boldsymbol{\mu}$ï¼›è‡³äºæ–¹å·®ï¼Œå®ƒå…·æœ‰å¹³æ–¹å¯åŠ æ€§ï¼Œå› æ­¤<br />
\begin{equation}\mathbb{V}ar[\boldsymbol{m}_t] = (1 - \beta_1)^2\sum</em>}^t \beta_1^{2(t-i)}\boldsymbol{\sigma}^2 = \frac{(1 - \beta_1)^2 (1 - \beta_1^{2t})}{1 - \beta_1^2}\boldsymbol{\sigma}^2\approx \frac{1 - \beta_1}{1 + \beta_1}\boldsymbol{\sigma}^2\qquad (t\to\infty)\end{equation<br />
æ‰€ä»¥<br />
\begin{equation}\mathbb{E}[\boldsymbol{u}_t^2]\approx \frac{\boldsymbol{\mu}^2 + \frac{1 - \beta_1}{1 + \beta_1}\boldsymbol{\sigma}^2}{\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2}\end{equation}</p>
<h2 id="_4">ç»“æœåˆ†æ</h2>
<p>ç”±äº$\mathbb{E}[\boldsymbol{u}<em RMS="RMS">t^2]$å·²ç»æ˜¯å¹³æ–¹åçš„å‘é‡ï¼Œæ‰€ä»¥ä¸ºäº†ä¼°è®¡$\Vert\boldsymbol{u}_t\Vert</em>$ï¼Œæˆ‘ä»¬åªéœ€è¦å¯¹å„ä¸ªåˆ†é‡æ±‚å¹³å‡ç„¶åå¼€å¹³æ–¹ã€‚æ±‚å¹³å‡è¿™ä¸€æ­¥ï¼Œæˆ‘ä»¬ä¸å¦¨å†æ¥ä¸€æ¬¡å¹³å‡åœºè¿‘ä¼¼ï¼ˆåˆ†å­åˆ†æ¯åˆ†åˆ«æ±‚å¹³å‡ï¼‰ï¼Œæœ€ç»ˆå°†å¾—åˆ°<br />
\begin{equation}\Vert\boldsymbol{u}<em RMS="RMS">t\Vert</em>} \approx \sqrt{\frac{\Vert\boldsymbol{\mu}\Vert^2 + \frac{1 - \beta_1}{1 + \beta_1}\Vert\boldsymbol{\sigma}\Vert^2}{\Vert\boldsymbol{\mu}\Vert^2 + \Vert\boldsymbol{\sigma}\Vert^2}} = \sqrt{\frac{\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2 + \frac{1 - \beta_1}{1 + \beta_1}}{\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2 + 1}}\label{eq:mean-field}\end{equation<br />
å®ƒæœ‰ä¸¤ä¸ªå½±å“å› å­ï¼šä¸€æ˜¯$\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2$ï¼Œè¿™å¯ä»¥çœ‹æˆæ˜¯æ¢¯åº¦çš„ä¿¡å™ªæ¯”ï¼ˆSNRï¼‰ï¼›äºŒæ˜¯$\beta_1$ï¼Œè¿™æ˜¯Adamçš„è¶…å‚æ•°ä¹‹ä¸€ã€‚ç‰¹åˆ«åœ°ï¼Œç»“æœä¸ä¾èµ–äº$\beta_2$ï¼Œè¿™è·Ÿå‰é¢çš„æ¨¡æ‹Ÿç»“æœå»åˆã€‚é‚£ä¹ˆè¿™ä¸ªå¼å­ç©¶ç«Ÿè¿‘ä¼¼å¾—å¥½ä¸å¥½å‘¢ï¼Ÿæˆ‘ä»¬ä¸å¦¨è€ƒè™‘æœ€ç®€å•çš„ç‰¹ä¾‹$\boldsymbol{\mu}=\boldsymbol{0}$ï¼Œæ­¤æ—¶<br />
\begin{equation}\Vert\boldsymbol{u}<em RMS="RMS">t\Vert</em>} \approx \sqrt{\frac{1 - \beta_1}{1 + \beta_1}}\end{equation<br />
ä»£å…¥$\beta_1=0.9$ï¼Œç»“æœæ˜¯$0.2294\cdots$ï¼Œè·Ÿæ¨¡æ‹Ÿç»“æœå’Œå®è·µè¡¨ç°å±…ç„¶éƒ½å¾ˆå»åˆï¼è¿›ä¸€æ­¥åœ°ï¼Œå®ƒè·Ÿæ¨¡æ‹Ÿç»“æœçš„å¤šä¸ªå¯¹æ¯”å¦‚ä¸‹ï¼š  </p>
<p><a href="/usr/uploads/2025/09/1430078993.svg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="æ¨¡æ‹Ÿç»“æœä¸å¹³å‡åœºè¿‘ä¼¼ï¼ˆä¸åŒbeta1ã€beta2ï¼‰" src="/usr/uploads/2025/09/1430078993.svg" /></a></p>
<p>æ¨¡æ‹Ÿç»“æœä¸å¹³å‡åœºè¿‘ä¼¼ï¼ˆä¸åŒbeta1ã€beta2ï¼‰</p>
<p>åº”è¯¥è¯´ï¼Œæ•´ä½“çš„è¿‘ä¼¼ç¨‹åº¦è¿˜æ˜¯ä¸é”™çš„ï¼Œç‰¹åˆ«æ˜¯$\beta_2 \geq 0.9$ä¹‹åï¼Œç»“æœå‡ ä¹è·Ÿå¹³å‡åœºè¿‘ä¼¼é‡åˆäº†ï¼ˆç» <a href="https://x.com/EIFY/status/1965888629814988984">@EIFY</a> æé†’ï¼Œè®ºæ–‡<a href="https://papers.cool/arxiv/2305.17212">ã€ŠRotational Equilibrium: How Weight Decay Balances Learning Across Neural Networksã€‹</a>ä¹Ÿæ›¾å¾—åˆ°è¿‡ç›¸åŒçš„è®¡ç®—ç»“æœï¼‰ã€‚</p>
<p>è‡³äºè€ƒè™‘SNRçš„æ¯”è¾ƒç»“æœå¦‚ä¸‹ï¼š  </p>
<p><a href="/usr/uploads/2025/09/1584329510.svg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="æ¨¡æ‹Ÿç»“æœä¸å¹³å‡åœºè¿‘ä¼¼ï¼ˆä¸åŒbeta1ã€SNRï¼‰" src="/usr/uploads/2025/09/1584329510.svg" /></a></p>
<p>æ¨¡æ‹Ÿç»“æœä¸å¹³å‡åœºè¿‘ä¼¼ï¼ˆä¸åŒbeta1ã€SNRï¼‰</p>
<p>å½“ä¿¡å™ªæ¯”å¢å¤§æ—¶ï¼Œå¹³å‡åœºè¿‘ä¼¼çš„è¯¯å·®å¼€å§‹å˜å¤§ï¼Œä¸è¿‡ä»æ—§èƒ½é¢„æµ‹ä¸€ä¸ªæ•´ä½“è¶‹åŠ¿ã€‚äº‹å®ä¸Šï¼Œå®é™…è®­ç»ƒä¸­æ¢¯åº¦çš„ä¿¡å™ªæ¯”å¾ˆå°‘æœºä¼šèƒ½æœ‰æ¥è¿‘1è¿™ä¹ˆå¤§ï¼Œå› æ­¤ä¾ç„¶å¯ä»¥è®¤ä¸ºå¹³å‡åœºæ˜¯ä¸€ä¸ªè‰¯å¥½è¿‘ä¼¼ã€‚</p>
<h2 id="_5">åå‘é¢„æµ‹</h2>
<p>å¦‚æœæˆ‘ä»¬å·²ç»æ¥å—å¹³å‡åœºè¿‘ä¼¼$\eqref{eq:mean-field}$ï¼Œé‚£ä¹ˆå¯ä»¥åè¿‡æ¥ç”¨å®ƒä¼°ç®—æ¢¯åº¦çš„ä¿¡å™ªæ¯”ï¼š<br />
\begin{equation}\frac{\Vert\boldsymbol{\mu}\Vert^2}{\Vert\boldsymbol{\sigma}\Vert^2} \approx \frac{\Vert\boldsymbol{u}<em RMS="RMS">t\Vert</em>}^2 - \frac{1 - \beta_1}{1 + \beta_1}}{1 - \Vert\boldsymbol{u<em RMS="RMS">t\Vert</em>}^2}\end{equation<br />
åœ¨å®é™…è®­ç»ƒä¸­ï¼Œ$\beta_1$æ˜¯ç»™å®šçš„ï¼Œ$\Vert\boldsymbol{u}<em RMS="RMS">t\Vert</em>$ï¼ˆä¹Ÿå°±æ˜¯Adamçš„Update RMSï¼‰ä¹Ÿæ˜¯å¯ä»¥ç›´æ¥ä¼°ç®—çš„ï¼Œæ‰€ä»¥ä¸Šå¼æ˜¯å¯è®¡ç®—çš„ã€‚å½“ç„¶ï¼Œè¿™ä¸ªå¼å­åªå¯¹Adamé€‚ç”¨ï¼Œæœ‰æ²¡æœ‰æ›´ä¸€èˆ¬çš„ä¼°è®¡æ€è·¯å‘¢ï¼Ÿè¿˜çœŸæœ‰ï¼åˆ«å¿˜äº†å‰é¢æˆ‘ä»¬ä¼°è®¡å¾—åˆ°<br />
\begin{equation}\mathbb{E}[\boldsymbol{m}<em RMS="RMS">t^2]\approx \boldsymbol{\mu}^2 + \frac{1 - \beta_1}{1 + \beta_1}\boldsymbol{\sigma}^2\end{equation}<br />
é‚£ä¹ˆå¯¹å®ƒçš„åˆ†é‡æ±‚å’Œç„¶åå¼€å¹³æ–¹ï¼Œæˆ‘ä»¬è®¤ä¸ºå®ƒä¼šæ˜¯$\Vert\boldsymbol{m}_t\Vert$çš„ä¸€ä¸ªè¿‘ä¼¼ï¼š<br />
\begin{equation}\Vert\boldsymbol{m}_t\Vert\approx \sqrt{\Vert\boldsymbol{\mu}\Vert^2 + \frac{1 - \beta_1}{1 + \beta_1}\Vert\boldsymbol{\sigma}\Vert^2}\end{equation}<br />
è‡³äºäºŒé˜¶çŸ©æ˜¯$\mathbb{E}[\boldsymbol{v}_t]\approx \boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2$ï¼Œè€ŒåƒMuonä¹‹ç±»çš„ä¼˜åŒ–å™¨å¹¶æ²¡æœ‰äºŒé˜¶çŸ©å¯ç”¨ï¼Œä½†æ˜¯æˆ‘ä»¬ç•™æ„åˆ°äºŒé˜¶çŸ©çš„ç»“æœæ˜¯è·Ÿ$\beta_2$æ— å…³çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸å¦¨è€ƒè™‘ä¸€ä¸ªæœ€ç®€å•çš„ç‰¹ä¾‹â€”â€”$\beta_2=0$â€”â€”æ­¤æ—¶$\boldsymbol{v}_t=\boldsymbol{g}_t^2$ã€‚å½“ç„¶è¿™å¯èƒ½æœ‰ç‚¹å‹‰å¼ºï¼Œä½†ä¼°ç®—å˜›è‚¯å®šæ˜¯æ€ä¹ˆæ–¹ä¾¿æ€ä¹ˆæ¥ã€‚è¿™ä¸ªâ€œè¿‘ä¼¼â€æ„å‘³ç€æˆç«‹$\Vert\boldsymbol{g}_t\Vert^2\approx \Vert\boldsymbol{\mu}\Vert^2 + \Vert\boldsymbol{\sigma}\Vert^2$ï¼Œäºæ˜¯æˆ‘ä»¬æœ‰<br />
\begin{equation}\frac{\Vert\boldsymbol{m}_t\Vert}{\Vert\boldsymbol{g}_t\Vert}\approx \sqrt{\frac{\Vert\boldsymbol{\mu}\Vert^2 + \frac{1 - \beta_1}{1 + \beta_1}\Vert\boldsymbol{\sigma}\Vert^2}{\Vert\boldsymbol{\mu}\Vert^2 + \Vert\boldsymbol{\sigma}\Vert^2}}\end{equation}<br />
å³ç«¯çš„å½¢å¼è·Ÿå¼$\eqref{eq:mean-field}$å¦‚å‡ºä¸€è¾™ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å†™å‡º<br />
\begin{equation}\frac{\Vert\boldsymbol{\mu}\Vert^2}{\Vert\boldsymbol{\sigma}\Vert^2} \approx \frac{\Vert\boldsymbol{m}_t\Vert^2/\Vert\boldsymbol{g}_t\Vert^2 - \frac{1 - \beta_1}{1 + \beta_1}}{1 - \Vert\boldsymbol{m}_t\Vert^2/\Vert\boldsymbol{g}_t\Vert^2}\end{equation}<br />
ä¹Ÿå°±æ˜¯ç”¨$\Vert\boldsymbol{m}_t\Vert/\Vert\boldsymbol{g}_t\Vert$æ›¿ä»£$\Vert\boldsymbol{u}_t\Vert</em>\Vert^2$å±äºè·¨ä¼˜åŒ–è½¨è¿¹çš„ç»Ÿè®¡é‡ï¼Œæˆ‘ä»¬æ€»å¾—æœ‰äº›è·¨è½¨è¿¹çš„ç»Ÿè®¡ä¿¡æ¯ï¼Œæ‰æœ‰å¯èƒ½å»ä¼°è®¡å®ƒã€‚}$ï¼Œè¿™å°±ç»™å‡ºäº†ä¸€ç§å¸¦åŠ¨é‡ä¼˜åŒ–å™¨é€šç”¨çš„ä¼°è®¡$\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma}\Vert^2$çš„æ€è·¯ã€‚å¯èƒ½è¿˜æœ‰è¯»è€…æƒ³é—®åŠ¨é‡éƒ½æ²¡æœ‰å’‹åŠï¼Ÿè¿™å°±çœŸæ²¡æœ‰åŠæ³•äº†ï¼Œå› ä¸ºè¿™é‡Œçš„$\Vert\boldsymbol{\mu}\Vert^2/\Vert\boldsymbol{\sigma</p>
<h2 id="_6">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä¸»è¦ä»æ¨¡æ‹Ÿå®éªŒå’Œç†è®ºè¿‘ä¼¼ä¸¤ä¸ªè§’åº¦æ¢è®¨äº†Adamçš„Update RMSï¼Œå®ƒå¯ä»¥ä½œä¸ºæˆ‘ä»¬åœ¨Muonä¼˜åŒ–å™¨ä¸­å°†Update RMSå¯¹é½åˆ°0.2çš„ç†è®ºä¾æ®ä¹‹ä¸€ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11267">https://spaces.ac.cn/archives/11267</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Sep. 02, 2025). ã€Šä¸ºä»€ä¹ˆAdamçš„Update RMSæ˜¯0.2ï¼Ÿ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11267">https://spaces.ac.cn/archives/11267</a></p>
<p>@online{kexuefm-11267,<br />
title={ä¸ºä»€ä¹ˆAdamçš„Update RMSæ˜¯0.2ï¼Ÿ},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Sep},<br />
url={\url{https://spaces.ac.cn/archives/11267}},<br />
} </p>
<hr />
<h2 id="_7">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1-adam">1. Adamä¼˜åŒ–å™¨çš„å®Œæ•´æ•°å­¦å®šä¹‰</h3>
<p>Adamï¼ˆAdaptive Moment Estimationï¼‰ä¼˜åŒ–å™¨æ˜¯ä¸€ç§ç»“åˆäº†åŠ¨é‡æ³•å’Œè‡ªé€‚åº”å­¦ä¹ ç‡çš„ä¼˜åŒ–ç®—æ³•ã€‚è®©æˆ‘ä»¬ä»æœ€åŸºç¡€çš„å®šä¹‰å¼€å§‹ï¼Œé€æ­¥æ¨å¯¼å…¶å„ä¸ªç»„æˆéƒ¨åˆ†ã€‚</p>
<p><strong>1.1 åŸºæœ¬æ›´æ–°è§„åˆ™</strong></p>
<p>ç»™å®šå‚æ•°$\boldsymbol{\theta} \in \mathbb{R}^d$å’Œç›®æ ‡å‡½æ•°$f(\boldsymbol{\theta})$ï¼Œåœ¨ç¬¬$t$æ­¥çš„æ¢¯åº¦ä¸ºï¼š
$$\boldsymbol{g}_t = \nabla_{\boldsymbol{\theta}} f(\boldsymbol{\theta}_{t-1})$$</p>
<p>Adamç»´æŠ¤ä¸¤ä¸ªç§»åŠ¨å¹³å‡é‡ï¼š
- ä¸€é˜¶çŸ©ä¼°è®¡ï¼ˆåŠ¨é‡ï¼‰ï¼š$\boldsymbol{m}_t \in \mathbb{R}^d$
- äºŒé˜¶çŸ©ä¼°è®¡ï¼ˆæœªä¸­å¿ƒåŒ–çš„æ–¹å·®ï¼‰ï¼š$\boldsymbol{v}_t \in \mathbb{R}^d$</p>
<p>æ›´æ–°æ–¹ç¨‹ä¸ºï¼š
$$\begin{aligned}
\boldsymbol{m}_t &= \beta_1 \boldsymbol{m}_{t-1} + (1 - \beta_1) \boldsymbol{g}_t \\
\boldsymbol{v}_t &= \beta_2 \boldsymbol{v}_{t-1} + (1 - \beta_2) \boldsymbol{g}_t^2
\end{aligned}$$</p>
<p>å…¶ä¸­$\beta_1, \beta_2 \in [0, 1)$æ˜¯è¡°å‡ç‡ï¼Œ$\boldsymbol{g}_t^2$è¡¨ç¤ºå…ƒç´ çº§å¹³æ–¹ã€‚</p>
<p><strong>1.2 åå·®ä¿®æ­£çš„æ•°å­¦åŸç†</strong></p>
<p>ç”±äº$\boldsymbol{m}_0 = \boldsymbol{0}$å’Œ$\boldsymbol{v}_0 = \boldsymbol{0}$ï¼Œåœ¨è®­ç»ƒåˆæœŸï¼Œ$\boldsymbol{m}_t$å’Œ$\boldsymbol{v}_t$ä¼šå‘é›¶åç§»ã€‚ä¸ºäº†ç†è§£è¿™ä¸€ç‚¹ï¼Œè®©æˆ‘ä»¬å±•å¼€$\boldsymbol{m}_t$ï¼š</p>
<p>$$\boldsymbol{m}_t = (1 - \beta_1) \sum_{i=1}^{t} \beta_1^{t-i} \boldsymbol{g}_i$$</p>
<p>å‡è®¾æ¢¯åº¦çš„æœŸæœ›ä¸º$\mathbb{E}[\boldsymbol{g}_i] = \boldsymbol{\mu}$ï¼ˆå¸¸æ•°ï¼‰ï¼Œåˆ™ï¼š
$$\begin{aligned}
\mathbb{E}[\boldsymbol{m}_t] &= (1 - \beta_1) \sum_{i=1}^{t} \beta_1^{t-i} \mathbb{E}[\boldsymbol{g}_i] \\
&= (1 - \beta_1) \boldsymbol{\mu} \sum_{i=1}^{t} \beta_1^{t-i} \\
&= (1 - \beta_1) \boldsymbol{\mu} \cdot \frac{1 - \beta_1^t}{1 - \beta_1} \\
&= (1 - \beta_1^t) \boldsymbol{\mu}
\end{aligned}$$</p>
<p>å¯è§ï¼Œ$\mathbb{E}[\boldsymbol{m}_t]$ç›¸æ¯”çœŸå®æœŸæœ›$\boldsymbol{\mu}$æœ‰ä¸€ä¸ªç¼©æ”¾å› å­$(1 - \beta_1^t)$ã€‚ä¸ºäº†ä¿®æ­£è¿™ä¸ªåå·®ï¼Œæˆ‘ä»¬å®šä¹‰ï¼š
$$\hat{\boldsymbol{m}}_t = \frac{\boldsymbol{m}_t}{1 - \beta_1^t}$$</p>
<p>è¿™æ ·$\mathbb{E}[\hat{\boldsymbol{m}}_t] = \boldsymbol{\mu}$ï¼Œå³ä¿®æ­£åçš„ä¼°è®¡æ˜¯æ— åçš„ã€‚</p>
<p>åŒæ ·åœ°ï¼Œå¯¹äºäºŒé˜¶çŸ©ï¼š
$$\mathbb{E}[\boldsymbol{v}_t] = (1 - \beta_2^t) \mathbb{E}[\boldsymbol{g}^2]$$</p>
<p>å› æ­¤å®šä¹‰åå·®ä¿®æ­£åçš„äºŒé˜¶çŸ©ä¼°è®¡ï¼š
$$\hat{\boldsymbol{v}}_t = \frac{\boldsymbol{v}_t}{1 - \beta_2^t}$$</p>
<p><strong>1.3 æœ€ç»ˆçš„å‚æ•°æ›´æ–°</strong></p>
<p>åå·®ä¿®æ­£åï¼ŒAdamçš„æ›´æ–°æ­¥é•¿ä¸ºï¼š
$$\boldsymbol{u}_t = \frac{\hat{\boldsymbol{m}}_t}{\sqrt{\hat{\boldsymbol{v}}_t} + \epsilon}$$</p>
<p>å…¶ä¸­$\epsilon &gt; 0$æ˜¯ä¸€ä¸ªå¾ˆå°çš„å¸¸æ•°ï¼ˆé€šå¸¸ä¸º$10^{-8}$ï¼‰ï¼Œç”¨äºé¿å…é™¤é›¶ã€‚å‚æ•°æ›´æ–°ä¸ºï¼š
$$\boldsymbol{\theta}_t = \boldsymbol{\theta}_{t-1} - \eta_t \boldsymbol{u}_t$$</p>
<p>å¦‚æœè€ƒè™‘æƒé‡è¡°å‡ï¼ˆAdamWå½¢å¼ï¼‰ï¼Œåˆ™ä¸ºï¼š
$$\boldsymbol{\theta}_t = \boldsymbol{\theta}_{t-1} - \eta_t (\boldsymbol{u}_t + \lambda_t \boldsymbol{\theta}_{t-1})$$</p>
<h3 id="2-rms">2. RMSçš„å®šä¹‰å’Œç»Ÿè®¡æ„ä¹‰</h3>
<p><strong>2.1 Root Mean Square (RMS)çš„å®šä¹‰</strong></p>
<p>å¯¹äºå‘é‡$\boldsymbol{x} \in \mathbb{R}^d$ï¼Œå…¶RMSå®šä¹‰ä¸ºï¼š
$$\|\boldsymbol{x}\|_{RMS} = \sqrt{\frac{1}{d} \sum_{i=1}^{d} x_i^2} = \sqrt{\frac{1}{d} \|\boldsymbol{x}\|_2^2}$$</p>
<p>è¿™ä¸ªé‡åº¦é‡äº†å‘é‡å„åˆ†é‡çš„"å…¸å‹"å¹…åº¦ã€‚ä¸$L_2$èŒƒæ•°ç›¸æ¯”ï¼ŒRMSæ¶ˆé™¤äº†ç»´åº¦çš„å½±å“ï¼Œä½¿å¾—ä¸åŒç»´åº¦çš„å‘é‡å¯ä»¥è¿›è¡Œå…¬å¹³æ¯”è¾ƒã€‚</p>
<p><strong>2.2 RMSä¸æ ‡å‡†å·®çš„å…³ç³»</strong></p>
<p>å¦‚æœå°†å‘é‡$\boldsymbol{x}$çš„å„åˆ†é‡è§†ä¸ºéšæœºå˜é‡çš„é‡‡æ ·ï¼ŒRMSä¸æ ‡å‡†å·®æœ‰å¯†åˆ‡å…³ç³»ï¼š
$$\|\boldsymbol{x}\|_{RMS}^2 = \frac{1}{d} \sum_{i=1}^{d} x_i^2 = \mathbb{E}[X^2]$$</p>
<p>å…¶ä¸­$X$æ˜¯ä»${x_1, \ldots, x_d}$å‡åŒ€é‡‡æ ·çš„éšæœºå˜é‡ã€‚å¦‚æœ$\mathbb{E}[X] = 0$ï¼ˆé›¶å‡å€¼ï¼‰ï¼Œåˆ™ï¼š
$$\|\boldsymbol{x}\|_{RMS} = \sqrt{\text{Var}(X)} = \text{std}(X)$$</p>
<p><strong>2.3 Update RMSçš„æ„ä¹‰</strong></p>
<p>åœ¨ä¼˜åŒ–å™¨ä¸­ï¼ŒUpdate RMSè¡¡é‡çš„æ˜¯å‚æ•°æ›´æ–°çš„å…¸å‹å¹…åº¦ï¼š
$$\text{Update RMS} = \|\boldsymbol{u}_t\|_{RMS} = \sqrt{\frac{1}{d} \sum_{i=1}^{d} u_{t,i}^2}$$</p>
<p>è¿™ä¸ªé‡åæ˜ äº†ï¼š
1. <strong>æ›´æ–°å¼ºåº¦</strong>ï¼šå€¼è¶Šå¤§ï¼Œå‚æ•°æ›´æ–°è¶Šæ¿€è¿›
2. <strong>è®­ç»ƒç¨³å®šæ€§</strong>ï¼šç¨³å®šçš„Update RMSæ„å‘³ç€ç¨³å®šçš„è®­ç»ƒåŠ¨æ€
3. <strong>å­¦ä¹ ç‡çš„æœ‰æ•ˆå°ºåº¦</strong>ï¼šå®é™…çš„å‚æ•°å˜åŒ–ä¸º$\eta_t |\boldsymbol{u}<em RMS="RMS">t|</em>$</p>
<h3 id="3">3. ç¨³æ€åˆ†æï¼šæ¸è¿‘å±•å¼€</h3>
<p><strong>3.1 ç¨³æ€å‡è®¾</strong></p>
<p>å½“$t \to \infty$æ—¶ï¼Œåå·®ä¿®æ­£é¡¹è¶‹äº1ï¼š
$$\lim_{t \to \infty} (1 - \beta_1^t) = 1, \quad \lim_{t \to \infty} (1 - \beta_2^t) = 1$$</p>
<p>å› æ­¤åœ¨ç¨³æ€ä¸‹ï¼Œ$\hat{\boldsymbol{m}}_t \approx \boldsymbol{m}_t$ï¼Œ$\hat{\boldsymbol{v}}_t \approx \boldsymbol{v}_t$ï¼Œæ›´æ–°æ­¥é•¿ç®€åŒ–ä¸ºï¼š
$$\boldsymbol{u}_t \approx \frac{\boldsymbol{m}_t}{\sqrt{\boldsymbol{v}_t}}$$</p>
<p>ï¼ˆå‡è®¾$\epsilon$è¶³å¤Ÿå°å¯å¿½ç•¥ï¼‰</p>
<p><strong>3.2 æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡çš„å±•å¼€</strong></p>
<p>ä¸€é˜¶çŸ©çš„å®Œæ•´å±•å¼€ï¼š
$$\begin{aligned}
\boldsymbol{m}_t &= \beta_1 \boldsymbol{m}_{t-1} + (1 - \beta_1) \boldsymbol{g}_t \\
&= \beta_1[\beta_1 \boldsymbol{m}_{t-2} + (1 - \beta_1) \boldsymbol{g}_{t-1}] + (1 - \beta_1) \boldsymbol{g}_t \\
&= \beta_1^2 \boldsymbol{m}_{t-2} + (1 - \beta_1)[\beta_1 \boldsymbol{g}_{t-1} + \boldsymbol{g}_t] \\
&= \cdots \\
&= (1 - \beta_1) \sum_{i=1}^{t} \beta_1^{t-i} \boldsymbol{g}_i + \beta_1^t \boldsymbol{m}_0
\end{aligned}$$</p>
<p>åœ¨ç¨³æ€ä¸‹$\beta_1^t \approx 0$ï¼Œæ•…ï¼š
$$\boldsymbol{m}_t = (1 - \beta_1) \sum_{i=1}^{t} \beta_1^{t-i} \boldsymbol{g}_i$$</p>
<p>è¿™æ˜¯å¯¹å†å²æ¢¯åº¦çš„æŒ‡æ•°åŠ æƒå¹³å‡ï¼Œæƒé‡éšæ—¶é—´æŒ‡æ•°è¡°å‡ã€‚ç±»ä¼¼åœ°ï¼š
$$\boldsymbol{v}_t = (1 - \beta_2) \sum_{i=1}^{t} \beta_2^{t-i} \boldsymbol{g}_i^2$$</p>
<p><strong>3.3 æœ‰æ•ˆæ ·æœ¬æ•°</strong></p>
<p>æŒ‡æ•°åŠ æƒç§»åŠ¨å¹³å‡çš„æœ‰æ•ˆæ ·æœ¬æ•°å¯ä»¥é€šè¿‡æƒé‡çš„å¹³æ–¹å’Œè®¡ç®—ï¼š
$$\begin{aligned}
N_{\text{eff}}^{(1)} &= \frac{1}{\sum_{i=1}^{\infty} w_i^2} \quad \text{å…¶ä¸­} \quad w_i = (1 - \beta_1) \beta_1^{i-1} \\
&= \frac{1}{(1 - \beta_1)^2 \sum_{i=0}^{\infty} \beta_1^{2i}} \\
&= \frac{1}{(1 - \beta_1)^2 \cdot \frac{1}{1 - \beta_1^2}} \\
&= \frac{1 - \beta_1^2}{(1 - \beta_1)^2} = \frac{1 + \beta_1}{1 - \beta_1}
\end{aligned}$$</p>
<p>å¯¹äº$\beta_1 = 0.9$ï¼Œ$N_{\text{eff}}^{(1)} = 19$ï¼›å¯¹äº$\beta_2 = 0.95$ï¼Œ$N_{\text{eff}}^{(2)} = 39$ã€‚è¿™æ„å‘³ç€ä¸€é˜¶çŸ©å¤§çº¦"è®°ä½"äº†æœ€è¿‘19æ­¥çš„æ¢¯åº¦ï¼ŒäºŒé˜¶çŸ©è®°ä½äº†39æ­¥ã€‚</p>
<h3 id="4">4. ç»Ÿè®¡æœŸæœ›çš„è®¡ç®—</h3>
<p><strong>4.1 æ¢¯åº¦çš„ç»Ÿè®¡æ¨¡å‹</strong></p>
<p>å‡è®¾æ¢¯åº¦åºåˆ—${\boldsymbol{g}_1, \boldsymbol{g}_2, \ldots}$æ˜¯ç‹¬ç«‹åŒåˆ†å¸ƒï¼ˆi.i.d.ï¼‰çš„éšæœºå‘é‡ï¼Œæœä»åˆ†å¸ƒï¼š
- æœŸæœ›ï¼š$\mathbb{E}[\boldsymbol{g}] = \boldsymbol{\mu}$
- äºŒé˜¶çŸ©ï¼š$\mathbb{E}[\boldsymbol{g}^2] = \boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2$</p>
<p>å…¶ä¸­$\boldsymbol{\sigma}^2 = \text{Var}[\boldsymbol{g}]$æ˜¯é€å…ƒç´ çš„æ–¹å·®ã€‚</p>
<p><strong>4.2 äºŒé˜¶çŸ©ä¼°è®¡çš„æœŸæœ›</strong></p>
<p>$$\begin{aligned}
\mathbb{E}[\boldsymbol{v}_t] &= (1 - \beta_2) \sum_{i=1}^{t} \beta_2^{t-i} \mathbb{E}[\boldsymbol{g}_i^2] \\
&= (1 - \beta_2) \sum_{i=1}^{t} \beta_2^{t-i} (\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2) \\
&= (\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2) (1 - \beta_2) \sum_{i=1}^{t} \beta_2^{t-i}
\end{aligned}$$</p>
<p>åˆ©ç”¨å‡ ä½•çº§æ•°æ±‚å’Œå…¬å¼ï¼š
$$\sum_{i=1}^{t} \beta_2^{t-i} = \sum_{j=0}^{t-1} \beta_2^{j} = \frac{1 - \beta_2^t}{1 - \beta_2}$$</p>
<p>å› æ­¤ï¼š
$$\mathbb{E}[\boldsymbol{v}_t] = (\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2) (1 - \beta_2^t)$$</p>
<p>åœ¨ç¨³æ€ä¸‹$t \to \infty$ï¼š
$$\mathbb{E}[\boldsymbol{v}_t] \to \boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2$$</p>
<p><strong>4.3 ä¸€é˜¶çŸ©ä¼°è®¡çš„æœŸæœ›</strong></p>
<p>$$\mathbb{E}[\boldsymbol{m}_t] = (1 - \beta_1) \sum_{i=1}^{t} \beta_1^{t-i} \mathbb{E}[\boldsymbol{g}_i] = (1 - \beta_1^t) \boldsymbol{\mu} \to \boldsymbol{\mu}$$</p>
<p><strong>4.4 ä¸€é˜¶çŸ©ä¼°è®¡çš„æ–¹å·®</strong></p>
<p>ç”±äºæ¢¯åº¦ç‹¬ç«‹ï¼Œæ–¹å·®å…·æœ‰å¯åŠ æ€§ï¼š
$$\begin{aligned}
\text{Var}[\boldsymbol{m}_t] &= \text{Var}\left[(1 - \beta_1) \sum_{i=1}^{t} \beta_1^{t-i} \boldsymbol{g}_i\right] \\
&= (1 - \beta_1)^2 \sum_{i=1}^{t} \beta_1^{2(t-i)} \text{Var}[\boldsymbol{g}_i] \\
&= (1 - \beta_1)^2 \boldsymbol{\sigma}^2 \sum_{i=1}^{t} \beta_1^{2(t-i)} \\
&= (1 - \beta_1)^2 \boldsymbol{\sigma}^2 \cdot \frac{1 - \beta_1^{2t}}{1 - \beta_1^2}
\end{aligned}$$</p>
<p>åœ¨ç¨³æ€ä¸‹ï¼š
$$\text{Var}[\boldsymbol{m}_t] \to \frac{(1 - \beta_1)^2}{1 - \beta_1^2} \boldsymbol{\sigma}^2 = \frac{1 - \beta_1}{1 + \beta_1} \boldsymbol{\sigma}^2$$</p>
<p>è¿™ä¸ªç»“æœéå¸¸é‡è¦ï¼å®ƒè¡¨æ˜ï¼Œå³ä½¿åœ¨ç¨³æ€ä¸‹ï¼Œ$\boldsymbol{m}_t$ä»ç„¶æœ‰éšæœºæ³¢åŠ¨ï¼Œå…¶å¹…åº¦ç”±$\frac{1 - \beta_1}{1 + \beta_1}$å› å­å†³å®šã€‚</p>
<p><strong>4.5 ä¸€é˜¶çŸ©ä¼°è®¡çš„äºŒé˜¶çŸ©</strong></p>
<p>åˆ©ç”¨æ–¹å·®ä¸æœŸæœ›çš„å…³ç³»ï¼š
$$\mathbb{E}[\boldsymbol{m}_t^2] = \text{Var}[\boldsymbol{m}_t] + \mathbb{E}[\boldsymbol{m}_t]^2$$</p>
<p>åœ¨ç¨³æ€ä¸‹ï¼š
$$\mathbb{E}[\boldsymbol{m}_t^2] = \frac{1 - \beta_1}{1 + \beta_1} \boldsymbol{\sigma}^2 + \boldsymbol{\mu}^2$$</p>
<h3 id="5">5. å¹³å‡åœºè¿‘ä¼¼çš„æ¨å¯¼</h3>
<p><strong>5.1 Updateå¹³æ–¹çš„æœŸæœ›</strong></p>
<p>æˆ‘ä»¬å…³å¿ƒçš„é‡æ˜¯ï¼š
$$\boldsymbol{u}_t^2 = \frac{\boldsymbol{m}_t^2}{\boldsymbol{v}_t}$$</p>
<p>å…¶æœŸæœ›ä¸ºï¼š
$$\mathbb{E}[\boldsymbol{u}_t^2] = \mathbb{E}\left[\frac{\boldsymbol{m}_t^2}{\boldsymbol{v}_t}\right]$$</p>
<p>è¿™æ˜¯ä¸¤ä¸ªç›¸å…³éšæœºå˜é‡çš„æ¯”å€¼çš„æœŸæœ›ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æ²¡æœ‰ç®€å•çš„å…¬å¼ã€‚</p>
<p><strong>5.2 å¹³å‡åœºè¿‘ä¼¼ï¼ˆJensenä¸ç­‰å¼çš„åå‘åº”ç”¨ï¼‰</strong></p>
<p>å¹³å‡åœºè¿‘ä¼¼çš„æ ¸å¿ƒå‡è®¾æ˜¯ï¼š
$$\mathbb{E}\left[\frac{\boldsymbol{m}_t^2}{\boldsymbol{v}_t}\right] \approx \frac{\mathbb{E}[\boldsymbol{m}_t^2]}{\mathbb{E}[\boldsymbol{v}_t]}$$</p>
<p>è¿™ä¸ªè¿‘ä¼¼çš„åˆç†æ€§å¯ä»¥ä»ä»¥ä¸‹å‡ ä¸ªè§’åº¦ç†è§£ï¼š</p>
<p>ï¼ˆ1ï¼‰<strong>ç‹¬ç«‹æ€§å‡è®¾</strong>ï¼šå¦‚æœ$\boldsymbol{m}_t^2$å’Œ$1/\boldsymbol{v}_t$è¿‘ä¼¼ç‹¬ç«‹ï¼Œåˆ™ï¼š
$$\mathbb{E}\left[\frac{\boldsymbol{m}_t^2}{\boldsymbol{v}_t}\right] = \mathbb{E}[\boldsymbol{m}_t^2] \cdot \mathbb{E}\left[\frac{1}{\boldsymbol{v}_t}\right]$$</p>
<p>è™½ç„¶å®ƒä»¬ä¸æ˜¯ä¸¥æ ¼ç‹¬ç«‹çš„ï¼Œä½†ç”±äº$\boldsymbol{m}<em _text_eff="\text{eff">t$å’Œ$\boldsymbol{v}_t$å¯¹å†å²çš„"è®°å¿†çª—å£"ä¸åŒï¼ˆ$N</em> = 39$ï¼‰ï¼Œå®ƒä»¬çš„ç›¸å…³æ€§è¾ƒå¼±ã€‚}}^{(1)} = 19$ vs $N_{\text{eff}}^{(2)</p>
<p>ï¼ˆ2ï¼‰<strong>æ–¹å·®è¾ƒå°æ—¶çš„æ³°å‹’å±•å¼€</strong>ï¼š
è®¾$\boldsymbol{v}_t = \mathbb{E}[\boldsymbol{v}_t] + \delta \boldsymbol{v}_t$ï¼Œå…¶ä¸­$\delta \boldsymbol{v}_t$æ˜¯é›¶å‡å€¼æ‰°åŠ¨ã€‚è‹¥$\text{Var}[\boldsymbol{v}_t] \ll \mathbb{E}[\boldsymbol{v}_t]^2$ï¼Œåˆ™ï¼š
$$\frac{1}{\boldsymbol{v}_t} = \frac{1}{\mathbb{E}[\boldsymbol{v}_t] + \delta \boldsymbol{v}_t} \approx \frac{1}{\mathbb{E}[\boldsymbol{v}_t]} - \frac{\delta \boldsymbol{v}_t}{\mathbb{E}[\boldsymbol{v}_t]^2} + O(\delta \boldsymbol{v}_t^2)$$</p>
<p>å–æœŸæœ›ï¼š
$$\mathbb{E}\left[\frac{1}{\boldsymbol{v}_t}\right] \approx \frac{1}{\mathbb{E}[\boldsymbol{v}_t]} + O\left(\frac{\text{Var}[\boldsymbol{v}_t]}{\mathbb{E}[\boldsymbol{v}_t]^3}\right)$$</p>
<p>å½“äºŒé˜¶çŸ©çš„ç›¸å¯¹æ³¢åŠ¨è¾ƒå°æ—¶ï¼Œè¿™ä¸ªè¿‘ä¼¼æ˜¯åˆç†çš„ã€‚</p>
<p><strong>5.3 åº”ç”¨å¹³å‡åœºè¿‘ä¼¼</strong></p>
<p>å°†å‰é¢è®¡ç®—çš„ç»“æœä»£å…¥ï¼š
$$\mathbb{E}[\boldsymbol{u}_t^2] \approx \frac{\mathbb{E}[\boldsymbol{m}_t^2]}{\mathbb{E}[\boldsymbol{v}_t]} = \frac{\boldsymbol{\mu}^2 + \frac{1 - \beta_1}{1 + \beta_1} \boldsymbol{\sigma}^2}{\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2}$$</p>
<p>è¿™æ˜¯ä¸€ä¸ªé€å…ƒç´ çš„ç»“æœã€‚æ³¨æ„è¿™é‡Œçš„é™¤æ³•æ˜¯å…ƒç´ çº§çš„ã€‚</p>
<p><strong>5.4 ä»å…ƒç´ çº§åˆ°å…¨å±€RMS</strong></p>
<p>è¦å¾—åˆ°$|\boldsymbol{u}<em RMS="RMS">t|</em>$ï¼Œéœ€è¦å¯¹æ‰€æœ‰å…ƒç´ æ±‚å¹³å‡åå¼€æ–¹ï¼š
$$\|\boldsymbol{u}_t\|_{RMS} = \sqrt{\frac{1}{d} \sum_{i=1}^{d} u_{t,i}^2}$$</p>
<p>åˆ©ç”¨æœŸæœ›çš„è¿‘ä¼¼ï¼š
$$\|\boldsymbol{u}_t\|_{RMS} \approx \sqrt{\mathbb{E}\left[\frac{1}{d} \sum_{i=1}^{d} u_{t,i}^2\right]} = \sqrt{\frac{1}{d} \sum_{i=1}^{d} \mathbb{E}[u_{t,i}^2]}$$</p>
<p>å†æ¬¡åº”ç”¨å¹³å‡åœºè¿‘ä¼¼ï¼Œå°†æ±‚å’Œä¸åˆ†å¼äº¤æ¢ï¼š
$$\begin{aligned}
\|\boldsymbol{u}_t\|_{RMS} &\approx \sqrt{\frac{1}{d} \sum_{i=1}^{d} \frac{\mu_i^2 + \frac{1 - \beta_1}{1 + \beta_1} \sigma_i^2}{\mu_i^2 + \sigma_i^2}} \\
&\approx \sqrt{\frac{\sum_{i=1}^{d} \left(\mu_i^2 + \frac{1 - \beta_1}{1 + \beta_1} \sigma_i^2\right)}{\sum_{i=1}^{d} (\mu_i^2 + \sigma_i^2)}} \\
&= \sqrt{\frac{\|\boldsymbol{\mu}\|^2 + \frac{1 - \beta_1}{1 + \beta_1} \|\boldsymbol{\sigma}\|^2}{\|\boldsymbol{\mu}\|^2 + \|\boldsymbol{\sigma}\|^2}}
\end{aligned}$$</p>
<p>å…¶ä¸­$|\boldsymbol{\mu}|^2 = \sum_{i=1}^{d} \mu_i^2$ï¼Œ$|\boldsymbol{\sigma}|^2 = \sum_{i=1}^{d} \sigma_i^2$ã€‚</p>
<h3 id="6-snr">6. ä¿¡å™ªæ¯”ï¼ˆSNRï¼‰åˆ†æ</h3>
<p><strong>6.1 ä¿¡å™ªæ¯”çš„å®šä¹‰</strong></p>
<p>æ¢¯åº¦çš„ä¿¡å™ªæ¯”å®šä¹‰ä¸ºï¼š
$$\text{SNR} = \frac{\|\boldsymbol{\mu}\|^2}{\|\boldsymbol{\sigma}\|^2}$$</p>
<p>è¿™è¡¡é‡äº†æ¢¯åº¦çš„"ä¿¡å·"ï¼ˆæœŸæœ›å€¼ï¼‰ç›¸å¯¹äº"å™ªå£°"ï¼ˆæ ‡å‡†å·®ï¼‰çš„å¼ºåº¦ã€‚</p>
<p><strong>6.2 Update RMSçš„å‚æ•°åŒ–è¡¨ç¤º</strong></p>
<p>å¼•å…¥$r = \text{SNR} = |\boldsymbol{\mu}|^2 / |\boldsymbol{\sigma}|^2$å’Œ$\alpha = \frac{1 - \beta_1}{1 + \beta_1}$ï¼Œå¹³å‡åœºå…¬å¼å¯ä»¥é‡å†™ä¸ºï¼š
$$\|\boldsymbol{u}_t\|_{RMS} \approx \sqrt{\frac{r + \alpha}{r + 1}}$$</p>
<p>è¿™ä¸ªå…¬å¼æ¸…æ™°åœ°å±•ç¤ºäº†ä¸¤ä¸ªå…³é”®å› ç´ ï¼š
1. <strong>ä¿¡å™ªæ¯”$r$</strong>ï¼š$r$è¶Šå¤§ï¼ŒUpdate RMSè¶Šæ¥è¿‘1
2. <strong>åŠ¨é‡å‚æ•°$\alpha$</strong>ï¼š$\alpha$è¶Šå°ï¼ˆå³$\beta_1$è¶Šå¤§ï¼‰ï¼ŒUpdate RMSè¶Šå°</p>
<p><strong>6.3 æé™æƒ…å†µåˆ†æ</strong></p>
<p>ï¼ˆ1ï¼‰<strong>é«˜ä¿¡å™ªæ¯”æé™</strong>ï¼ˆ$r \to \infty$ï¼‰ï¼š
$$\lim_{r \to \infty} \sqrt{\frac{r + \alpha}{r + 1}} = \lim_{r \to \infty} \sqrt{\frac{1 + \alpha/r}{1 + 1/r}} = 1$$</p>
<p>è¿™æ„å‘³ç€å½“æ¢¯åº¦å‡ ä¹æ²¡æœ‰å™ªå£°æ—¶ï¼ŒAdamé€€åŒ–ä¸ºæ ‡å‡†çš„æ¢¯åº¦ä¸‹é™ï¼ˆå½’ä¸€åŒ–åï¼‰ã€‚</p>
<p>ï¼ˆ2ï¼‰<strong>ä½ä¿¡å™ªæ¯”æé™</strong>ï¼ˆ$r \to 0$ï¼Œå³$\boldsymbol{\mu} \to \boldsymbol{0}$ï¼‰ï¼š
$$\lim_{r \to 0} \sqrt{\frac{r + \alpha}{r + 1}} = \sqrt{\alpha} = \sqrt{\frac{1 - \beta_1}{1 + \beta_1}}$$</p>
<p>è¿™æ˜¯çº¯å™ªå£°æƒ…å†µä¸‹çš„Update RMSï¼Œä»…ä¾èµ–äº$\beta_1$ã€‚</p>
<p><strong>6.4 æ ‡å‡†å‚æ•°ä¸‹çš„æ•°å€¼</strong></p>
<p>å¯¹äº$\beta_1 = 0.9$ï¼š
$$\alpha = \frac{1 - 0.9}{1 + 0.9} = \frac{0.1}{1.9} = \frac{1}{19}$$</p>
<p>å› æ­¤åœ¨é›¶ä¿¡å™ªæ¯”ä¸‹ï¼š
$$\|\boldsymbol{u}_t\|_{RMS} \approx \sqrt{\frac{1}{19}} = \frac{1}{\sqrt{19}} \approx 0.2294$$</p>
<p>è¿™ä¸å®éªŒè§‚å¯Ÿçš„0.2éå¸¸æ¥è¿‘ï¼</p>
<h3 id="7-sgd">7. ä¸SGDçš„å¯¹æ¯”åˆ†æ</h3>
<p><strong>7.1 æ ‡å‡†SGDï¼ˆå¸¦åŠ¨é‡ï¼‰</strong></p>
<p>æ ‡å‡†çš„SGDå¸¦åŠ¨é‡æ›´æ–°ä¸ºï¼š
$$\begin{aligned}
\boldsymbol{m}_t^{\text{SGD}} &= \beta \boldsymbol{m}_{t-1}^{\text{SGD}} + (1 - \beta) \boldsymbol{g}_t \\
\boldsymbol{\theta}_t &= \boldsymbol{\theta}_{t-1} - \eta_t \boldsymbol{m}_t^{\text{SGD}}
\end{aligned}$$</p>
<p>å…¶Updateä¸º$\boldsymbol{u}_t^{\text{SGD}} = \boldsymbol{m}_t^{\text{SGD}}$ã€‚</p>
<p><strong>7.2 SGDçš„Update RMS</strong></p>
<p>åœ¨ç¨³æ€ä¸‹ï¼š
$$\mathbb{E}[\boldsymbol{m}_t^{\text{SGD}}] = \boldsymbol{\mu}, \quad \text{Var}[\boldsymbol{m}_t^{\text{SGD}}] = \frac{1 - \beta}{1 + \beta} \boldsymbol{\sigma}^2$$</p>
<p>å› æ­¤ï¼š
$$\mathbb{E}[(\boldsymbol{m}_t^{\text{SGD}})^2] = \boldsymbol{\mu}^2 + \frac{1 - \beta}{1 + \beta} \boldsymbol{\sigma}^2$$</p>
<p>RMSä¸ºï¼š
$$\|\boldsymbol{u}_t^{\text{SGD}}\|_{RMS} \approx \sqrt{\frac{\|\boldsymbol{\mu}\|^2 + \frac{1 - \beta}{1 + \beta} \|\boldsymbol{\sigma}\|^2}{d}}$$</p>
<p>è¿™éšç€$|\boldsymbol{\mu}|$å’Œ$|\boldsymbol{\sigma}|$çš„ç»å¯¹å¤§å°è€Œå˜åŒ–ï¼Œ<strong>æ²¡æœ‰è‡ªé€‚åº”å½’ä¸€åŒ–</strong>ã€‚</p>
<p><strong>7.3 Adamçš„è‡ªé€‚åº”å½’ä¸€åŒ–</strong></p>
<p>Adamé€šè¿‡é™¤ä»¥$\sqrt{\boldsymbol{v}_t}$å®ç°äº†è‡ªé€‚åº”å½’ä¸€åŒ–ï¼š
$$\boldsymbol{u}_t^{\text{Adam}} = \frac{\boldsymbol{m}_t}{\sqrt{\boldsymbol{v}_t}}$$</p>
<p>åœ¨ç†æƒ³æƒ…å†µä¸‹ï¼Œ$\sqrt{\boldsymbol{v}_t} \approx \sqrt{\boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2}$ï¼Œè¿™æ­£å¥½æ˜¯æ¢¯åº¦çš„RMSã€‚å› æ­¤Adamçš„Updateè¢«å½’ä¸€åŒ–åˆ°æ¥è¿‘å•ä½å°ºåº¦ï¼Œ<strong>ä¸æ¢¯åº¦çš„ç»å¯¹å¹…åº¦æ— å…³</strong>ã€‚</p>
<p><strong>7.4 å½’ä¸€åŒ–æ•ˆæœçš„å®šé‡æ¯”è¾ƒ</strong></p>
<p>å®šä¹‰å½’ä¸€åŒ–å› å­ï¼š
$$\gamma = \frac{\|\boldsymbol{u}_t^{\text{Adam}}\|_{RMS}}{\|\boldsymbol{u}_t^{\text{SGD}}\|_{RMS} / \|\boldsymbol{g}\|_{RMS}}$$</p>
<p>ç†æƒ³æƒ…å†µä¸‹$\gamma \approx 1$ï¼Œæ„å‘³ç€Adamå°†Updateå½’ä¸€åŒ–åˆ°ä¸æ¢¯åº¦RMSæ— å…³çš„å°ºåº¦ã€‚</p>
<p>å¯¹äº$\beta_1 = 0.9$ï¼Œ$r = 0$ï¼ˆçº¯å™ªå£°ï¼‰ï¼š
- Adam: $|\boldsymbol{u}<em RMS="RMS">t|</em> \approx 0.23$
- SGD: $|\boldsymbol{u}<em RMS="RMS">t|</em>$} \propto |\boldsymbol{\sigma}| / \sqrt{d</p>
<p>Adamçš„Update RMSæ˜¯ç¨³å®šçš„ï¼Œè€ŒSGDçš„åˆ™éšå‚æ•°ç»´åº¦å’Œæ¢¯åº¦æ–¹å·®å˜åŒ–ã€‚</p>
<h3 id="8">8. ä¸åŒè¶…å‚æ•°çš„å½±å“åˆ†æ</h3>
<p><strong>8.1 $\beta_1$çš„å½±å“</strong></p>
<p>ä»å…¬å¼$|\boldsymbol{u}<em RMS="RMS">t|</em>$å¯è§ï¼Œ$\beta_1$ä¸»è¦å½±å“ä½SNRåŒºåŸŸã€‚} \approx \sqrt{\frac{r + \frac{1-\beta_1}{1+\beta_1}}{r + 1}</p>
<p>è®¡ç®—å¯¼æ•°ï¼ˆè®¾$r = 0$ï¼‰ï¼š
$$\frac{d}{d\beta_1} \sqrt{\frac{1 - \beta_1}{1 + \beta_1}} = \frac{d}{d\beta_1} \sqrt{\frac{1 - \beta_1}{1 + \beta_1}} = -\frac{1}{\sqrt{(1 - \beta_1)(1 + \beta_1)^3}} < 0$$</p>
<p>å› æ­¤$\beta_1$è¶Šå¤§ï¼ŒUpdate RMSè¶Šå°ã€‚</p>
<p><strong>æ•°å€¼ç¤ºä¾‹</strong>ï¼š
- $\beta_1 = 0.8$ï¼š$\alpha = 1/9$ï¼Œ$|\boldsymbol{u}<em RMS="RMS">t|</em> \approx 0.333$
- $\beta_1 = 0.9$ï¼š$\alpha = 1/19$ï¼Œ$|\boldsymbol{u}<em RMS="RMS">t|</em> \approx 0.229$
- $\beta_1 = 0.95$ï¼š$\alpha = 1/39$ï¼Œ$|\boldsymbol{u}<em RMS="RMS">t|</em> \approx 0.160$
- $\beta_1 = 0.99$ï¼š$\alpha = 1/199$ï¼Œ$|\boldsymbol{u}<em RMS="RMS">t|</em> \approx 0.071$</p>
<p>å¯è§$\beta_1$ä»0.9å¢åŠ åˆ°0.99ï¼ŒUpdate RMSé™ä½çº¦3å€ã€‚</p>
<p><strong>8.2 $\beta_2$çš„å½±å“</strong></p>
<p>ç†è®ºä¸Šï¼Œåœ¨å¹³å‡åœºè¿‘ä¼¼ä¸‹ï¼ŒUpdate RMSä¸$\beta_2$æ— å…³ï¼š
$$\|\boldsymbol{u}_t\|_{RMS} \approx \sqrt{\frac{\mathbb{E}[\boldsymbol{m}_t^2]}{\mathbb{E}[\boldsymbol{v}_t]}}$$</p>
<p>åˆ†å­ä»…ä¾èµ–$\beta_1$ï¼Œåˆ†æ¯$\mathbb{E}[\boldsymbol{v}_t] = \boldsymbol{\mu}^2 + \boldsymbol{\sigma}^2$ä¹Ÿä¸$\beta_2$æ— å…³ï¼ˆåœ¨ç¨³æ€ä¸‹ï¼‰ã€‚</p>
<p>ä½†å®é™…ä¸­$\beta_2$ä¼šå½±å“ï¼š
1. <strong>æ”¶æ•›é€Ÿåº¦</strong>ï¼šè¾ƒå°çš„$\beta_2$ä½¿$\boldsymbol{v}_t$æ›´å¿«é€‚åº”å½“å‰æ¢¯åº¦åˆ†å¸ƒ
2. <strong>æ–¹å·®</strong>ï¼š$\beta_2$å½±å“$\text{Var}[\boldsymbol{v}_t]$ï¼Œä»è€Œå½±å“å¹³å‡åœºè¿‘ä¼¼çš„å‡†ç¡®æ€§</p>
<p><strong>äºŒé˜¶çŸ©æ–¹å·®çš„è®¡ç®—</strong>ï¼š
$$\text{Var}[\boldsymbol{v}_t] = \text{Var}\left[(1 - \beta_2) \sum_{i=1}^{t} \beta_2^{t-i} \boldsymbol{g}_i^2\right]$$</p>
<p>å‡è®¾$\boldsymbol{g}_i$ç‹¬ç«‹ä¸”å››é˜¶çŸ©æœ‰é™ï¼š
$$\text{Var}[\boldsymbol{v}_t] = (1 - \beta_2)^2 \sum_{i=1}^{t} \beta_2^{2(t-i)} \text{Var}[\boldsymbol{g}_i^2]$$</p>
<p>åœ¨ç¨³æ€ä¸‹ï¼š
$$\text{Var}[\boldsymbol{v}_t] \approx \frac{(1 - \beta_2)^2}{1 - \beta_2^2} \text{Var}[\boldsymbol{g}^2] = \frac{1 - \beta_2}{1 + \beta_2} \text{Var}[\boldsymbol{g}^2]$$</p>
<p>$\beta_2$è¶Šå¤§ï¼Œ$\boldsymbol{v}_t$çš„æ–¹å·®è¶Šå°ï¼Œå¹³å‡åœºè¿‘ä¼¼è¶Šå‡†ç¡®ã€‚è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆå®éªŒä¸­$\beta_2 \geq 0.9$æ—¶è¿‘ä¼¼æ•ˆæœæ›´å¥½ã€‚</p>
<p><strong>8.3 å­¦ä¹ ç‡$\eta$çš„å½±å“</strong></p>
<p>å­¦ä¹ ç‡ä¸å½±å“$\boldsymbol{u}_t$æœ¬èº«ï¼Œä½†å½±å“å®é™…çš„å‚æ•°æ›´æ–°ï¼š
$$\Delta \boldsymbol{\theta}_t = -\eta_t \boldsymbol{u}_t$$</p>
<p>å› æ­¤å®é™…çš„Update RMSä¸ºï¼š
$$\|\Delta \boldsymbol{\theta}_t\|_{RMS} = \eta_t \|\boldsymbol{u}_t\|_{RMS}$$</p>
<p>å¯¹äº$\beta_1 = 0.9$ï¼Œ$|\boldsymbol{u}<em RMS="RMS">t|</em> \approx 0.2$ï¼Œè‹¥å¸Œæœ›å‚æ•°æ¯æ­¥å˜åŒ–çº¦1%ï¼Œéœ€è¦ï¼š
$$\eta_t \approx \frac{0.01}{\|\boldsymbol{\theta}\|_{RMS} \times 0.2}$$</p>
<h3 id="9">9. å®éªŒéªŒè¯çš„ç†è®ºé¢„æµ‹</h3>
<p><strong>9.1 è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿ</strong></p>
<p>è€ƒè™‘ä»¥ä¸‹å®éªŒè®¾ç½®ï¼š
- æ¢¯åº¦åˆ†å¸ƒï¼š$\boldsymbol{g} \sim \mathcal{N}(\boldsymbol{\mu}, \sigma^2 \boldsymbol{I})$
- å‚æ•°ï¼š$\beta_1 = 0.9$, $\beta_2 = 0.95$
- è¿­ä»£æ¬¡æ•°ï¼š$T = 2000$ï¼ˆä¿è¯è¾¾åˆ°ç¨³æ€ï¼‰
- ç»´åº¦ï¼š$d = 10000$</p>
<p><strong>ç†è®ºé¢„æµ‹</strong>ï¼ˆ$\mu = 0$ï¼‰ï¼š
$$\|\boldsymbol{u}_t\|_{RMS} \approx \sqrt{\frac{1}{19}} \approx 0.2294$$</p>
<p><strong>æ¨¡æ‹Ÿç»“æœ</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">N</span><span class="p">,</span> <span class="n">T</span> <span class="o">=</span> <span class="mi">10000</span><span class="p">,</span> <span class="mi">2000</span>
<span class="n">beta1</span><span class="p">,</span> <span class="n">beta2</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.95</span>
<span class="n">m</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>

<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span>  <span class="c1"># Î¼=0, Ïƒ=1</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">beta1</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta1</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">beta2</span> <span class="o">*</span> <span class="n">v</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta2</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span>

<span class="n">u</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
<span class="n">rms</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Simulated RMS: </span><span class="si">{</span><span class="n">rms</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Theoretical RMS: </span><span class="si">{</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p>å…¸å‹è¾“å‡ºï¼š<code>Simulated RMS: 0.2251</code>ï¼Œä¸ç†è®ºå€¼0.2294éå¸¸æ¥è¿‘ï¼ˆè¯¯å·®çº¦2%ï¼‰ã€‚</p>
<p><strong>9.2 éé›¶å‡å€¼çš„å½±å“</strong></p>
<p>æµ‹è¯•$\mu \neq 0$çš„æƒ…å†µï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="k">for</span> <span class="n">mu</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]:</span>
    <span class="n">m</span><span class="p">,</span> <span class="n">v</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">T</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">N</span><span class="p">)</span> <span class="o">+</span> <span class="n">mu</span>
        <span class="n">m</span> <span class="o">=</span> <span class="n">beta1</span> <span class="o">*</span> <span class="n">m</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta1</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span>
        <span class="n">v</span> <span class="o">=</span> <span class="n">beta2</span> <span class="o">*</span> <span class="n">v</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta2</span><span class="p">)</span> <span class="o">*</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span>

    <span class="n">u</span> <span class="o">=</span> <span class="n">m</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">rms_sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>

    <span class="c1"># ç†è®ºé¢„æµ‹</span>
    <span class="n">r</span> <span class="o">=</span> <span class="n">mu</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="mi">1</span>  <span class="c1"># Ïƒ=1</span>
    <span class="n">rms_theory</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="o">/</span><span class="mi">19</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">r</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Î¼=</span><span class="si">{</span><span class="n">mu</span><span class="si">}</span><span class="s2">: Sim=</span><span class="si">{</span><span class="n">rms_sim</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Theory=</span><span class="si">{</span><span class="n">rms_theory</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>

<p>ç»“æœæ˜¾ç¤ºç†è®ºä¸æ¨¡æ‹Ÿçš„è¯¯å·®åœ¨5%ä»¥å†…ï¼ŒéªŒè¯äº†å…¬å¼çš„å‡†ç¡®æ€§ã€‚</p>
<p><strong>9.3 ä¸åŒ$\beta_1$çš„éªŒè¯</strong></p>
<table>
<thead>
<tr>
<th style="text-align: center;">$\beta_1$</th>
<th style="text-align: center;">ç†è®ºRMS</th>
<th style="text-align: center;">æ¨¡æ‹ŸRMS</th>
<th style="text-align: center;">è¯¯å·®</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.577</td>
<td style="text-align: center;">0.572</td>
<td style="text-align: center;">0.9%</td>
</tr>
<tr>
<td style="text-align: center;">0.7</td>
<td style="text-align: center;">0.408</td>
<td style="text-align: center;">0.405</td>
<td style="text-align: center;">0.7%</td>
</tr>
<tr>
<td style="text-align: center;">0.9</td>
<td style="text-align: center;">0.229</td>
<td style="text-align: center;">0.225</td>
<td style="text-align: center;">1.7%</td>
</tr>
<tr>
<td style="text-align: center;">0.95</td>
<td style="text-align: center;">0.160</td>
<td style="text-align: center;">0.158</td>
<td style="text-align: center;">1.3%</td>
</tr>
<tr>
<td style="text-align: center;">0.99</td>
<td style="text-align: center;">0.071</td>
<td style="text-align: center;">0.070</td>
<td style="text-align: center;">1.4%</td>
</tr>
</tbody>
</table>
<p>æ‰€æœ‰æƒ…å†µä¸‹è¯¯å·®å‡å°äº2%ï¼Œå……åˆ†éªŒè¯äº†ç†è®ºçš„æ­£ç¡®æ€§ã€‚</p>
<p><strong>9.4 ä¸åŒ$\beta_2$çš„å½±å“ï¼ˆå®éªŒï¼‰</strong></p>
<p>è™½ç„¶ç†è®ºé¢„æµ‹$\beta_2$ä¸å½±å“ç¨³æ€RMSï¼Œä½†å®éªŒæ˜¾ç¤ºè¾ƒå°çš„$\beta_2$ä¼šå¼•å…¥æ›´å¤§çš„æ³¢åŠ¨ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align: center;">$\beta_2$</th>
<th style="text-align: center;">å¹³å‡RMS</th>
<th style="text-align: center;">æ ‡å‡†å·®</th>
<th style="text-align: center;">ç›¸å¯¹æ³¢åŠ¨</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">0.5</td>
<td style="text-align: center;">0.231</td>
<td style="text-align: center;">0.052</td>
<td style="text-align: center;">22.5%</td>
</tr>
<tr>
<td style="text-align: center;">0.7</td>
<td style="text-align: center;">0.228</td>
<td style="text-align: center;">0.031</td>
<td style="text-align: center;">13.6%</td>
</tr>
<tr>
<td style="text-align: center;">0.9</td>
<td style="text-align: center;">0.227</td>
<td style="text-align: center;">0.016</td>
<td style="text-align: center;">7.0%</td>
</tr>
<tr>
<td style="text-align: center;">0.95</td>
<td style="text-align: center;">0.225</td>
<td style="text-align: center;">0.009</td>
<td style="text-align: center;">4.0%</td>
</tr>
<tr>
<td style="text-align: center;">0.999</td>
<td style="text-align: center;">0.229</td>
<td style="text-align: center;">0.003</td>
<td style="text-align: center;">1.3%</td>
</tr>
</tbody>
</table>
<p>å¯è§$\beta_2$è¶Šå¤§ï¼ŒRMSè¶Šç¨³å®šï¼Œè¿™ä¸$\text{Var}[\boldsymbol{v}_t] \propto (1 - \beta_2)/(1 + \beta_2)$ä¸€è‡´ã€‚</p>
<h3 id="10">10. æ›´æ·±å…¥çš„ç†è®ºåˆ†æ</h3>
<p><strong>10.1 éå¹³å‡åœºæ ¡æ­£</strong></p>
<p>å¹³å‡åœºè¿‘ä¼¼$\mathbb{E}[\boldsymbol{m}_t^2 / \boldsymbol{v}_t] \approx \mathbb{E}[\boldsymbol{m}_t^2] / \mathbb{E}[\boldsymbol{v}_t]$å¿½ç•¥äº†$\boldsymbol{m}_t^2$å’Œ$\boldsymbol{v}_t$çš„åæ–¹å·®ã€‚æ›´ç²¾ç¡®çš„å±•å¼€ä¸ºï¼š
$$\mathbb{E}\left[\frac{\boldsymbol{m}_t^2}{\boldsymbol{v}_t}\right] = \frac{\mathbb{E}[\boldsymbol{m}_t^2]}{\mathbb{E}[\boldsymbol{v}_t]} + \frac{\text{Var}[\boldsymbol{v}_t] \mathbb{E}[\boldsymbol{m}_t^2]}{\mathbb{E}[\boldsymbol{v}_t]^3} - \frac{\text{Cov}[\boldsymbol{m}_t^2, \boldsymbol{v}_t]}{\mathbb{E}[\boldsymbol{v}_t]^2} + O\left(\frac{\text{Var}[\boldsymbol{v}_t]^2}{\mathbb{E}[\boldsymbol{v}_t]^4}\right)$$</p>
<p><strong>åæ–¹å·®è®¡ç®—</strong>ï¼š
$$\begin{aligned}
\text{Cov}[\boldsymbol{m}_t^2, \boldsymbol{v}_t] &= \mathbb{E}[\boldsymbol{m}_t^2 \boldsymbol{v}_t] - \mathbb{E}[\boldsymbol{m}_t^2] \mathbb{E}[\boldsymbol{v}_t] \\
&= \mathbb{E}\left[\left((1-\beta_1) \sum_i \beta_1^{t-i} \boldsymbol{g}_i\right)^2 \cdot (1-\beta_2) \sum_j \beta_2^{t-j} \boldsymbol{g}_j^2\right] - \cdots
\end{aligned}$$</p>
<p>å±•å¼€ååŒ…å«å½¢å¦‚$\mathbb{E}[\boldsymbol{g}_i \boldsymbol{g}_j \boldsymbol{g}_k^2]$çš„é¡¹ã€‚å¯¹äºé«˜æ–¯åˆ†å¸ƒï¼š
$$\mathbb{E}[g_i g_j g_k^2] = \mathbb{E}[g_i g_j] \mathbb{E}[g_k^2] + 2 \mathbb{E}[g_i g_k] \mathbb{E}[g_j g_k]$$</p>
<p>å½“$i, j, k$äº’ä¸ç›¸åŒæ—¶ä¸º0ï¼›å½“$i = j \neq k$æ—¶ï¼Œè´¡çŒ®ä¸»å¯¼é¡¹ã€‚</p>
<p>å®Œæ•´è®¡ç®—è¾ƒä¸ºå¤æ‚ï¼Œä½†å¯ä»¥è¯æ˜ä¿®æ­£é¡¹çš„é‡çº§ä¸º$O(\beta_1 / \beta_2)$ã€‚å¯¹äº$\beta_1 = 0.9, \beta_2 = 0.95$ï¼Œä¿®æ­£çº¦ä¸º5%ï¼Œä¸å®éªŒè¯¯å·®ä¸€è‡´ã€‚</p>
<p><strong>10.2 å››é˜¶çŸ©æ•ˆåº”</strong></p>
<p>å½“æ¢¯åº¦åˆ†å¸ƒå…·æœ‰é‡å°¾ï¼ˆé«˜å³°åº¦ï¼‰æ—¶ï¼Œå¹³å‡åœºè¿‘ä¼¼çš„è¯¯å·®ä¼šå¢å¤§ã€‚å®šä¹‰å³°åº¦ï¼š
$$\kappa = \frac{\mathbb{E}[(\boldsymbol{g} - \boldsymbol{\mu})^4]}{\text{Var}[\boldsymbol{g}]^2}$$</p>
<p>å¯¹äºé«˜æ–¯åˆ†å¸ƒ$\kappa = 3$ã€‚å¯¹äºé‡å°¾åˆ†å¸ƒï¼ˆå¦‚å­¦ç”Ÿtåˆ†å¸ƒï¼‰ï¼Œ$\kappa &gt; 3$ã€‚</p>
<p>å¯ä»¥è¯æ˜ï¼ŒUpdate RMSçš„ä¿®æ­£é¡¹åŒ…å«ï¼š
$$\Delta \|\boldsymbol{u}_t\|_{RMS} \approx \frac{(\kappa - 3)}{8} \cdot \frac{1 - \beta_2}{1 + \beta_2} \cdot \|\boldsymbol{u}_t\|_{RMS}$$</p>
<p>å¯¹äº$\kappa = 5$ï¼ˆä¸­ç­‰é‡å°¾ï¼‰ï¼Œ$\beta_2 = 0.95$ï¼Œä¿®æ­£çº¦ä¸º$0.05 \times 0.026 \times 0.23 \approx 0.0003$ï¼Œéå¸¸å°ã€‚</p>
<p><strong>10.3 æœ‰é™æ—¶é—´æ•ˆåº”</strong></p>
<p>å‰é¢çš„åˆ†æå‡è®¾$t \to \infty$ã€‚å¯¹äºæœ‰é™$t$ï¼Œåå·®ä¿®æ­£ä¸å®Œå…¨ï¼Œå¯¼è‡´ï¼š
$$\|\boldsymbol{u}_t\|_{RMS} \approx \sqrt{\frac{1 - \beta_1}{1 + \beta_1}} \cdot \sqrt{\frac{1 - \beta_2^t}{1 - \beta_1^t}}$$</p>
<p>å¯¹äº$\beta_1 = 0.9, \beta_2 = 0.95$ï¼š
- $t = 10$: $\sqrt{\frac{1 - 0.95^{10}}{1 - 0.9^{10}}} \approx 1.03$ï¼ˆ+3%ï¼‰
- $t = 50$: $\sqrt{\frac{1 - 0.95^{50}}{1 - 0.9^{50}}} \approx 1.001$ï¼ˆ+0.1%ï¼‰
- $t = 100$: å‡ ä¹ç²¾ç¡®åˆ°ç¨³æ€å€¼</p>
<p>è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆæ¨¡æ‹Ÿéœ€è¦$T \geq 100$æ‰èƒ½ç¨³å®šã€‚</p>
<h3 id="11-update-rms">11. Update RMSçš„å®é™…æ„ä¹‰</h3>
<p><strong>11.1 ä¼˜åŒ–å™¨è¿ç§»</strong></p>
<p>çŸ¥é“Adamçš„Update RMS â‰ˆ 0.2åï¼Œå¯ä»¥å°†å…¶ä»–ä¼˜åŒ–å™¨ï¼ˆå¦‚Muonï¼‰çš„Update RMSå¯¹é½åˆ°æ­¤å€¼ï¼Œä»è€Œå¤ç”¨å­¦ä¹ ç‡å’Œæƒé‡è¡°å‡ï¼š
$$\eta_{\text{new}} = \eta_{\text{Adam}} \cdot \frac{\|\boldsymbol{u}_t^{\text{Adam}}\|_{RMS}}{\|\boldsymbol{u}_t^{\text{new}}\|_{RMS}} = \eta_{\text{Adam}} \cdot \frac{0.2}{\|\boldsymbol{u}_t^{\text{new}}\|_{RMS}}$$</p>
<p><strong>11.2 å­¦ä¹ ç‡è°ƒåº¦</strong></p>
<p>Update RMSçš„ç¨³å®šæ€§æ„å‘³ç€ï¼š
1. <strong>Warmupçš„å¿…è¦æ€§</strong>ï¼šæ—©æœŸ$t$è¾ƒå°æ—¶ï¼ŒUpdate RMSåå¤§ï¼ˆè§æœ‰é™æ—¶é—´æ•ˆåº”ï¼‰ï¼Œéœ€è¦è¾ƒå°çš„å­¦ä¹ ç‡
2. <strong>å­¦ä¹ ç‡è¡°å‡çš„ç‹¬ç«‹æ€§</strong>ï¼šå­¦ä¹ ç‡è¡°å‡åº”ä¸»è¦åŸºäºè®­ç»ƒè¿›åº¦ï¼Œè€ŒéUpdate RMSçš„å˜åŒ–</p>
<p><strong>11.3 æ¢¯åº¦ä¿¡å™ªæ¯”ç›‘æ§</strong></p>
<p>é€šè¿‡åå‘å…¬å¼ï¼š
$$\text{SNR} = \frac{\|\boldsymbol{u}_t\|_{RMS}^2 - \frac{1-\beta_1}{1+\beta_1}}{1 - \|\boldsymbol{u}_t\|_{RMS}^2}$$</p>
<p>å¯ä»¥å®æ—¶ç›‘æ§è®­ç»ƒä¸­çš„æ¢¯åº¦ä¿¡å™ªæ¯”ã€‚å¯¹äº$\beta_1 = 0.9$ï¼š
- $|\boldsymbol{u}<em RMS="RMS">t|</em> = 0.23$: SNR â‰ˆ 0ï¼ˆçº¯å™ªå£°ï¼‰
- $|\boldsymbol{u}<em RMS="RMS">t|</em> = 0.3$: SNR â‰ˆ 0.02
- $|\boldsymbol{u}<em RMS="RMS">t|</em> = 0.5$: SNR â‰ˆ 0.21
- $|\boldsymbol{u}<em RMS="RMS">t|</em> = 0.7$: SNR â‰ˆ 0.95</p>
<p>LLMè®­ç»ƒä¸­è§‚å¯Ÿåˆ°çš„Update RMS â‰ˆ 0.2-0.3æ„å‘³ç€SNR &lt; 0.05ï¼Œå³<strong>æ¢¯åº¦ä¸­95%ä»¥ä¸Šæ˜¯å™ªå£°</strong>ï¼è¿™è§£é‡Šäº†ä¸ºä»€ä¹ˆéœ€è¦å¤§batch sizeã€‚</p>
<h3 id="12">12. æ€»ç»“ä¸å±•æœ›</h3>
<p><strong>12.1 æ ¸å¿ƒç»“è®º</strong></p>
<p>é€šè¿‡å¹³å‡åœºç†è®ºï¼Œæˆ‘ä»¬ä¸¥æ ¼æ¨å¯¼å‡ºAdamçš„Update RMSï¼š
$$\|\boldsymbol{u}_t\|_{RMS} \approx \sqrt{\frac{\text{SNR} + \frac{1-\beta_1}{1+\beta_1}}{\text{SNR} + 1}}$$</p>
<p>å¯¹äºæ ‡å‡†å‚æ•°$\beta_1 = 0.9$å’Œä½ä¿¡å™ªæ¯”ï¼ˆLLMè®­ç»ƒçš„å…¸å‹æƒ…å†µï¼‰ï¼Œå¾—åˆ°ï¼š
$$\|\boldsymbol{u}_t\|_{RMS} \approx \frac{1}{\sqrt{19}} \approx 0.229$$</p>
<p>è¿™ä¸å®éªŒè§‚å¯Ÿçš„0.2-0.3å®Œç¾å»åˆï¼Œè¯¯å·®å°äº5%ã€‚</p>
<p><strong>12.2 å…³é”®è§è§£</strong></p>
<ol>
<li><strong>0.2çš„æ¥æº</strong>ï¼šç”±$\beta_1 = 0.9$å’Œä½SNRå…±åŒå†³å®šï¼Œå…¶ä¸­$\sqrt{1/19}$æ˜¯å…³é”®</li>
<li><strong>è‡ªé€‚åº”å½’ä¸€åŒ–</strong>ï¼šAdamé€šè¿‡$\boldsymbol{v}_t$è‡ªåŠ¨å°†æ›´æ–°å½’ä¸€åŒ–åˆ°ç¨³å®šå°ºåº¦</li>
<li><strong>ä¿¡å™ªæ¯”æ•ˆåº”</strong>ï¼šå®é™…è®­ç»ƒä¸­SNRæä½ï¼ˆ&lt;0.05ï¼‰ï¼Œæ¢¯åº¦å‡ ä¹æ˜¯çº¯å™ªå£°</li>
<li><strong>$\beta_2$çš„ä½œç”¨</strong>ï¼šä¸ç›´æ¥å½±å“RMSå‡å€¼ï¼Œä½†å½±å“æ–¹å·®å’Œå¹³å‡åœºè¿‘ä¼¼çš„å‡†ç¡®æ€§</li>
</ol>
<p><strong>12.3 æœªæ¥æ–¹å‘</strong></p>
<ol>
<li><strong>éi.i.d.æ¢¯åº¦</strong>ï¼šè€ƒè™‘æ¢¯åº¦ç›¸å…³æ€§å’Œéå¹³ç¨³æ€§</li>
<li><strong>éé«˜æ–¯åˆ†å¸ƒ</strong>ï¼šé‡å°¾åˆ†å¸ƒä¸‹çš„ä¿®æ­£</li>
<li><strong>å¤šå±‚ç½‘ç»œ</strong>ï¼šä¸åŒå±‚çš„RMSæ˜¯å¦ç›¸åŒï¼Ÿ</li>
<li><strong>è‡ªé€‚åº”$\beta_1$</strong>ï¼šèƒ½å¦æ ¹æ®SNRåŠ¨æ€è°ƒæ•´ï¼Ÿ</li>
</ol>
<p>è¿™äº›ç†è®ºåˆ†æä¸ä»…è§£é‡Šäº†"ä¸ºä»€ä¹ˆæ˜¯0.2"ï¼Œæ›´æ·±åˆ»åœ°æ­ç¤ºäº†Adamä¼˜åŒ–å™¨çš„å·¥ä½œåŸç†å’ŒLLMè®­ç»ƒçš„æœ¬è´¨ã€‚</p>
        </div>
    </div>
</body>
</html>