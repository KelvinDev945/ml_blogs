<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MuPä¹‹ä¸Šï¼š1. å¥½æ¨¡å‹çš„ä¸‰ä¸ªç‰¹å¾</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>MuPä¹‹ä¸Šï¼š1. å¥½æ¨¡å‹çš„ä¸‰ä¸ªç‰¹å¾</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-19 | ğŸ“„ å¤§å°: 21.6 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11340">https://spaces.ac.cn/archives/11340</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: 2025-10-21</p>
<hr />
<h2 id="_1">ğŸ“„ å¼•è¨€</h2>
<p>ä¸çŸ¥é“å¤§å®¶æœ‰æ²¡æœ‰å‘ç°ä¸€ä¸ªæœ‰è¶£çš„ç»†èŠ‚ï¼ŒMuonå’ŒMuPéƒ½æ˜¯"Mu"å¼€å¤´ï¼Œä½†ä¸¤ä¸ª"Mu"çš„åŸæ„å®Œå…¨ä¸ä¸€æ ·ï¼Œå‰è€…æ˜¯"<strong>M</strong>oment<strong>U</strong>m Orthogonalized by Newton-Schulz"ï¼Œåè€…æ˜¯"<strong>M</strong>aximal <strong>U</strong>pdate Parametrization"ï¼Œå¯å®ƒä»¬ä¿©ä¹‹é—´ç¡®å®æœ‰ç€éå¸¸æ·±åˆ»çš„è”ç³»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒMuonå’ŒMuPæœ‰ç€æˆªç„¶ä¸åŒçš„å‡ºå‘ç‚¹ï¼Œä½†æœ€ç»ˆéƒ½èµ°å‘äº†ç›¸åŒçš„æ–¹å‘ï¼Œç”šè‡³æ— æ„é—´å–äº†ç›¸ä¼¼çš„åå­—ï¼Œä¼¼ä¹çœŸåº”äº†é‚£å¥"å†¥å†¥ä¸­è‡ªæœ‰å®‰æ’"ã€‚</p>
<p>è¨€å½’æ­£ä¼ ã€‚æ€»ä¹‹ï¼Œç¬”è€…åœ¨å„ç§æœºç¼˜å·§åˆä¹‹ä¸‹ï¼Œåˆšå¥½åŒæ—¶å­¦ä¹ åˆ°äº†Muonå’ŒMuPï¼Œè¿™å¤§å¤§åŠ æ·±äº†ç¬”è€…å¯¹æ¨¡å‹ä¼˜åŒ–çš„ç†è§£ï¼ŒåŒæ—¶ä¹Ÿè®©ç¬”è€…å¼€å§‹æ€è€ƒå…³äºæ¨¡å‹ä¼˜åŒ–æ›´æœ¬è´¨çš„åŸç†ã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„è¯•é”™ï¼Œç®—æ˜¯æœ‰äº›ç²—æµ…çš„æ”¶è·ï¼Œåœ¨æ­¤è·Ÿå¤§å®¶åˆ†äº«ä¸€ä¸‹ã€‚</p>
<h3 id="muonmup">ğŸ•µï¸ ã€æ·±åº¦è§£æï¼šMuonä¸MuPçš„ç†è®ºèƒŒæ™¯ã€‘</h3>
<p>è®©æˆ‘ä»¬é¦–å…ˆå½¢å¼åŒ–è¿™ä¸¤ä¸ªä¼˜åŒ–æ–¹æ³•çš„æ•°å­¦å®šä¹‰ï¼š</p>
<p><strong>Muonä¼˜åŒ–å™¨çš„æ•°å­¦è¡¨è¿°</strong>ï¼š</p>
<p>Muoné€šè¿‡Newton-Schulzè¿­ä»£å®ç°åŠ¨é‡çš„æ­£äº¤åŒ–ã€‚ç»™å®šå‚æ•°æ¢¯åº¦ $\boldsymbol{g}_t$ï¼ŒMuonçš„æ›´æ–°è§„åˆ™ä¸ºï¼š</p>
<p>$$
\begin{aligned}
\boldsymbol{m}_t &= \beta \boldsymbol{m}_{t-1} + (1-\beta)\boldsymbol{g}_t \\
\boldsymbol{u}_t &= \text{Orth}(\boldsymbol{m}_t) \\
\boldsymbol{\theta}_{t+1} &= \boldsymbol{\theta}_t - \eta \boldsymbol{u}_t
\end{aligned}
\tag{1}
$$</p>
<p>å…¶ä¸­ $\text{Orth}(\cdot)$ æ˜¯é€šè¿‡Newton-Schulzè¿­ä»£å®ç°çš„æ­£äº¤åŒ–æ“ä½œï¼š</p>
<p>$$
\text{Orth}(\boldsymbol{M}) \approx \boldsymbol{M} \cdot (\boldsymbol{M}^\top \boldsymbol{M})^{-1/2}
\tag{2}
$$</p>
<p>è¿™ä¸ªæ“ä½œçš„å…³é”®åœ¨äºå°†æ¢¯åº¦æŠ•å½±åˆ°<strong>è°±çƒé¢</strong>ï¼ˆspectral sphereï¼‰ä¸Šï¼Œç¡®ä¿æ›´æ–°æ–¹å‘çš„è°±èŒƒæ•°ä¸ºå¸¸æ•°ã€‚</p>
<p><strong>MuP (Maximal Update Parametrization)çš„æ•°å­¦è¡¨è¿°</strong>ï¼š</p>
<p>MuPå®šä¹‰äº†ä¸€å¥—å‚æ•°åŒ–è§„åˆ™ï¼Œä½¿å¾—ç¥ç»ç½‘ç»œåœ¨ä¸åŒå®½åº¦ $n$ ä¸‹çš„è®­ç»ƒåŠ¨æ€ä¿æŒä¸€è‡´ã€‚æ ¸å¿ƒæ€æƒ³æ˜¯ä¸ºä¸åŒå±‚è®¾ç½®ä¸åŒçš„åˆå§‹åŒ–å’Œå­¦ä¹ ç‡ç¼©æ”¾ï¼š</p>
<p>$$
\begin{aligned}
\boldsymbol{W}^{(l)} &\sim \mathcal{N}\left(0, \frac{\sigma^2}{n_{\text{in}}}\right) \quad \text{(åˆå§‹åŒ–)} \\
\eta^{(l)} &= \frac{\eta_0}{n_{\text{in}}} \quad \text{(å­¦ä¹ ç‡)}
\end{aligned}
\tag{3}
$$</p>
<p>å…¶ä¸­ $n_{\text{in}}$ æ˜¯è¾“å…¥ç»´åº¦ã€‚è¿™ç§ç¼©æ”¾ä¿è¯äº†<strong>ç‰¹å¾å­¦ä¹ </strong>ï¼ˆfeature learningï¼‰regimeï¼Œè€Œé<strong>æ‡’æƒ°è®­ç»ƒ</strong>ï¼ˆlazy trainingï¼‰regimeã€‚</p>
<p><strong>ä¸¤è€…çš„æœ¬è´¨è”ç³»</strong>ï¼š</p>
<p>è™½ç„¶å‡ºå‘ç‚¹ä¸åŒï¼Œä½†ä¸¤è€…éƒ½åœ¨è¿½æ±‚ä¸€ä¸ªå…±åŒç›®æ ‡ï¼š<strong>è·¨å°ºåº¦çš„è®­ç»ƒç¨³å®šæ€§</strong>ã€‚Muoné€šè¿‡è°±èŒƒæ•°çº¦æŸå®ç°å•ä¸ªæ¨¡å‹çš„ç¨³å®šä¼˜åŒ–ï¼ŒMuPé€šè¿‡å‚æ•°åŒ–è§„åˆ™å®ç°ä¸åŒæ¨¡å‹å®½åº¦ä¸‹çš„ç¨³å®šæ€§è¿ç§»ã€‚å®ƒä»¬çš„æ•°å­¦è”ç³»ä½“ç°åœ¨ï¼š</p>
<p>$$
\|\boldsymbol{u}_t\|_2 = O(1) \quad \text{(Muon)} \quad \Leftrightarrow \quad \|\Delta \boldsymbol{\theta}\|_F / \|\boldsymbol{\theta}\|_F = O(1/\sqrt{n}) \quad \text{(MuP)}
\tag{4}
$$</p>
<p>è¿™æš—ç¤ºäº†ä¸€ä¸ªæ›´æ·±å±‚çš„ç»Ÿä¸€ç†è®ºæ¡†æ¶çš„å­˜åœ¨ã€‚</p>
<hr />
<h2 id="_2">ğŸ“„ å†™åœ¨å‰é¢</h2>
<p>æŒ‰ç…§æå‡ºæ—¶é—´çš„å…ˆåé¡ºåºï¼Œæ˜¯å…ˆæœ‰MuPå†æœ‰Muonï¼Œä½†ç¬”è€…çš„å­¦ä¹ é¡ºåºæ­£å¥½åè¿‡æ¥ï¼Œå…ˆå­¦ä¹ äº†Muonç„¶åå†å­¦ä¹ MuPï¼Œäº‹åæ¥çœ‹ï¼Œè¿™ä¹Ÿä¸å¤±ä¸ºä¸€ä¸ªä¸é”™çš„å­¦ä¹ é¡ºåºã€‚</p>
<h3 id="_3">ğŸ•µï¸ ã€æ·±åº¦è§£æï¼šå­¦ä¹ é¡ºåºçš„åˆç†æ€§ã€‘</h3>
<p>ä»<strong>æ•™å­¦æ³•</strong>çš„è§’åº¦ï¼Œ"å…ˆMuonåMuP"ç¡®å®æ˜¯ä¸€ä¸ªæ›´ç›´è§‚çš„å­¦ä¹ è·¯å¾„ï¼Œå› ä¸ºï¼š</p>
<p><strong>1. å…·ä½“åˆ°æŠ½è±¡çš„è®¤çŸ¥è·¯å¾„</strong>ï¼š</p>
<p>Muonæ˜¯ä¸€ä¸ª<strong>å…·ä½“çš„ä¼˜åŒ–ç®—æ³•</strong>ï¼Œå¯ä»¥ç›´æ¥çœ‹åˆ°å…¶å¯¹å•ä¸ªæ¨¡å‹è®­ç»ƒçš„å½±å“ï¼š</p>
<p>$$
\text{Lossæ›²çº¿æ›´å¹³æ»‘} \Rightarrow \text{è°±èŒƒæ•°çº¦æŸæœ‰æ•ˆ} \Rightarrow \text{ä¸ºä½•éœ€è¦è¿™ç§çº¦æŸï¼Ÿ}
\tag{5}
$$</p>
<p>è€ŒMuPæ˜¯ä¸€ä¸ª<strong>æŠ½è±¡çš„ç†è®ºæ¡†æ¶</strong>ï¼Œè§£é‡Šäº†è·¨å°ºåº¦çš„ç°è±¡ã€‚å…ˆçœ‹åˆ°ç°è±¡ï¼ˆMuonçš„æ•ˆæœï¼‰ï¼Œå†ç†è§£ç†è®ºï¼ˆMuPçš„åŸç†ï¼‰ï¼Œç¬¦åˆå½’çº³å­¦ä¹ çš„è‡ªç„¶è¿‡ç¨‹ã€‚</p>
<p><strong>2. é—®é¢˜é©±åŠ¨çš„å­¦ä¹ åŠ¨æœº</strong>ï¼š</p>
<p>Muonå¼•å‡ºçš„æ ¸å¿ƒé—®é¢˜æ˜¯ï¼š"ä¸ºä»€ä¹ˆè°±èŒƒæ•°çº¦æŸå¦‚æ­¤é‡è¦ï¼Ÿ" è¿™ä¸ªé—®é¢˜çš„ç­”æ¡ˆæ­£æ˜¯MuPç†è®ºçš„æ ¸å¿ƒï¼š</p>
<p>$$
\text{è°±èŒƒæ•°} \propto \text{æœ€å¤§ç‰¹å¾å€¼} \propto \text{å®½åº¦ç›¸å…³çš„ç¼©æ”¾å› å­}
\tag{6}
$$</p>
<p>MuPå‘Šè¯‰æˆ‘ä»¬ï¼Œä¸åŒå®½åº¦çš„æ¨¡å‹éœ€è¦ä¸åŒçš„è°±èŒƒæ•°ç›®æ ‡ï¼Œè€ŒMuonçš„æ­£äº¤åŒ–æ°å¥½æä¾›äº†è‡ªé€‚åº”çš„è°±èŒƒæ•°æ§åˆ¶ã€‚</p>
<p><strong>3. å®è·µåˆ°ç†è®ºçš„çŸ¥è¯†èºæ—‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code>å®è·µå±‚é¢ (Muon):
  â”œâ”€ è§‚å¯Ÿï¼šæ­£äº¤åŒ– â†’ ç¨³å®šè®­ç»ƒ
  â”œâ”€ é‡åŒ–ï¼š||u|| = 1 â†’ å›ºå®šæ­¥é•¿
  â””â”€ ç–‘é—®ï¼šä¸ºä½•è¿™ä¸ª&quot;å›ºå®š&quot;å¾ˆé‡è¦ï¼Ÿ

ç†è®ºå±‚é¢ (MuP):
  â”œâ”€ è§£é‡Šï¼šå®½åº¦ç¼©æ”¾ â†’ åŠ¨æ€ä¸å˜æ€§
  â”œâ”€ é¢„æµ‹ï¼šnâ†’âˆ æé™ä¸‹çš„è¡Œä¸º
  â””â”€ æŒ‡å¯¼ï¼šå¦‚ä½•è®¾ç½®è¶…å‚æ•°
</code></pre></div>

<p>è¿™ç§èºæ—‹å¼ä¸Šå‡çš„å­¦ä¹ æ–¹å¼ï¼Œæ¯”ç›´æ¥å­¦ä¹ æŠ½è±¡ç†è®ºæ›´å®¹æ˜“å»ºç«‹æ·±åˆ»ç†è§£ã€‚</p>
<hr />
<h2 id="_4">ğŸ“„ å¥½æ¨¡å‹çš„ä¸‰ä¸ªç‰¹å¾</h2>
<p>é€šè¿‡å¯¹Muonå’ŒMuPçš„æ·±å…¥ç ”ç©¶ï¼Œç¬”è€…æ€»ç»“å‡ºç¨³å®šè®­ç»ƒå¥½æ¨¡å‹éœ€è¦æ»¡è¶³çš„<strong>ä¸‰ä¸ªå¿…è¦æ¡ä»¶</strong>ï¼Œå¯ä»¥ç”¨RMSï¼ˆå‡æ–¹æ ¹ï¼ŒRoot Mean Squareï¼‰çš„æ¦‚å¿µæ¥ç»Ÿä¸€æè¿°ï¼š</p>
<h3 id="forward-stability">ç‰¹å¾ä¸€ï¼šå‰å‘ç¨³å®šæ€§ï¼ˆForward Stabilityï¼‰</h3>
<p><strong>å®šä¹‰</strong>ï¼šæ¨¡å‹è¾“å‡ºçš„RMSå€¼åº”ä¿æŒåœ¨æ’å®šé‡çº§ï¼Œä¸éšå±‚æ•°æˆ–å®½åº¦çš„å¢åŠ è€ŒæŒ‡æ•°çº§å¢é•¿æˆ–è¡°å‡ã€‚</p>
<h3 id="_5">ğŸ•µï¸ ã€æ·±åº¦è§£æï¼šå‰å‘ç¨³å®šæ€§çš„æ•°å­¦æ¨å¯¼ã€‘</h3>
<p><strong>å½¢å¼åŒ–å®šä¹‰</strong>ï¼š</p>
<p>å¯¹äºä¸€ä¸ª $L$ å±‚ç¥ç»ç½‘ç»œï¼Œç¬¬ $l$ å±‚çš„è¾“å‡ºä¸º $\boldsymbol{h}^{(l)} \in \mathbb{R}^{n_l}$ï¼Œå‰å‘ç¨³å®šæ€§è¦æ±‚ï¼š</p>
<p>$$
\text{RMS}(\boldsymbol{h}^{(l)}) := \sqrt{\frac{1}{n_l}\|\boldsymbol{h}^{(l)}\|_2^2} = \Theta(1), \quad \forall l \in \{1, 2, \ldots, L\}
\tag{7}
$$</p>
<p>å³è¾“å‡ºçš„å‡æ–¹æ ¹å€¼åº”è¯¥æ˜¯ä¸å±‚æ•° $l$ å’Œå®½åº¦ $n_l$ æ— å…³çš„å¸¸æ•°é‡çº§ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦å‰å‘ç¨³å®šæ€§ï¼Ÿ</strong></p>
<p>è€ƒè™‘ä¸€ä¸ªæ ‡å‡†çš„å…¨è¿æ¥å±‚ï¼š</p>
<p>$$
\boldsymbol{h}^{(l+1)} = \sigma\left(\boldsymbol{W}^{(l)}\boldsymbol{h}^{(l)} + \boldsymbol{b}^{(l)}\right)
\tag{8}
$$</p>
<p>å¦‚æœæ²¡æœ‰é€‚å½“çš„ç¼©æ”¾ï¼Œå‡è®¾ $\boldsymbol{W}^{(l)} \sim \mathcal{N}(0, \sigma_w^2)$ï¼Œé‚£ä¹ˆï¼š</p>
<p>$$
\mathbb{E}\left[\|\boldsymbol{W}^{(l)}\boldsymbol{h}^{(l)}\|_2^2\right] = n_l \sigma_w^2 \|\boldsymbol{h}^{(l)}\|_2^2
\tag{9}
$$</p>
<p>å¦‚æœ $\sigma_w^2 = O(1)$ï¼Œåˆ™è¾“å‡ºä¼šä»¥ $\sqrt{n_l}$ çš„é€Ÿåº¦å¢é•¿ï¼›ç»è¿‡ $L$ å±‚åï¼Œè¾“å‡ºçš„é‡çº§ä¼šè¾¾åˆ° $(n \cdot L)^{L/2}$ï¼Œå¯¼è‡´æ•°å€¼æº¢å‡ºã€‚</p>
<p><strong>æ ‡å‡†åˆå§‹åŒ–æ–¹æ¡ˆ</strong>ï¼š</p>
<p>Xavieråˆå§‹åŒ–ï¼š
$$
\boldsymbol{W}^{(l)} \sim \mathcal{N}\left(0, \frac{2}{n_l + n_{l+1}}\right)
\tag{10}
$$</p>
<p>Heåˆå§‹åŒ–ï¼ˆé’ˆå¯¹ReLUï¼‰ï¼š
$$
\boldsymbol{W}^{(l)} \sim \mathcal{N}\left(0, \frac{2}{n_l}\right)
\tag{11}
$$</p>
<p>è¿™äº›åˆå§‹åŒ–æ–¹æ¡ˆæ­£æ˜¯ä¸ºäº†ä¿è¯å‰å‘ç¨³å®šæ€§ï¼š</p>
<p>$$
\mathbb{E}\left[\text{RMS}(\boldsymbol{h}^{(l+1)})\right] \approx \mathbb{E}\left[\text{RMS}(\boldsymbol{h}^{(l)})\right]
\tag{12}
$$</p>
<p><strong>Transformerä¸­çš„å‰å‘ç¨³å®šæ€§</strong>ï¼š</p>
<p>åœ¨Transformerä¸­ï¼Œé€šè¿‡<strong>æ®‹å·®è¿æ¥</strong>å’Œ<strong>å±‚å½’ä¸€åŒ–</strong>å…±åŒç»´æŒå‰å‘ç¨³å®šæ€§ï¼š</p>
<p>$$
\begin{aligned}
\boldsymbol{h}^{(l+1)} &= \boldsymbol{h}^{(l)} + \text{Sublayer}^{(l)}(\text{LayerNorm}(\boldsymbol{h}^{(l)})) \\
\text{LayerNorm}(\boldsymbol{x}) &= \frac{\boldsymbol{x} - \mu}{\sigma} \cdot \gamma + \beta
\end{aligned}
\tag{13}
$$</p>
<p>LayerNormç¡®ä¿ $\text{RMS}(\text{LayerNorm}(\boldsymbol{h})) = O(1)$ï¼Œæ®‹å·®è¿æ¥é¿å…äº†æ·±å±‚ç½‘ç»œçš„æ¢¯åº¦æ¶ˆå¤±ã€‚</p>
<p><strong>å‰å‘ç¨³å®šæ€§çš„å¤±æ•ˆæ¡ˆä¾‹</strong>ï¼š</p>
<p>ä¸ç¨³å®šçš„ä¾‹å­ï¼šæ ‡å‡†åˆå§‹åŒ–çš„æ·±å±‚MLPï¼ˆæ— æ®‹å·®ã€æ— å½’ä¸€åŒ–ï¼‰</p>
<p>$$
L = 100, \quad n = 1024, \quad \sigma_w = 1.0
$$</p>
<p>æ­¤æ—¶ï¼š
$$
\text{RMS}(\boldsymbol{h}^{(100)}) \approx 1024^{50} \approx 10^{150} \quad \text{(æ•°å€¼çˆ†ç‚¸ï¼)}
\tag{14}
$$</p>
<hr />
<h3 id="dependency-stability">ç‰¹å¾äºŒï¼šä¾èµ–ç¨³å®šæ€§ï¼ˆDependency Stabilityï¼‰</h3>
<p><strong>å®šä¹‰</strong>ï¼šä¸åŒè¾“å…¥äº§ç”Ÿçš„è¾“å‡ºå·®å¼‚åº”ä¿æŒåœ¨å¯æ§èŒƒå›´å†…ï¼Œè¡¨æ˜æ¨¡å‹èƒ½å¹³ç¨³åœ°ä¾èµ–äºè¾“å…¥ä¿¡æ¯ï¼Œæ—¢ä¸è¿‡åº¦æ”¾å¤§å·®å¼‚ï¼Œä¹Ÿä¸è¿‡åº¦å‹ç¼©å·®å¼‚ã€‚</p>
<h3 id="_6">ğŸ•µï¸ ã€æ·±åº¦è§£æï¼šä¾èµ–ç¨³å®šæ€§çš„æ•°å­¦æ¨å¯¼ã€‘</h3>
<p><strong>å½¢å¼åŒ–å®šä¹‰</strong>ï¼š</p>
<p>ç»™å®šä¸¤ä¸ªä¸åŒçš„è¾“å…¥ $\boldsymbol{x}_1, \boldsymbol{x}_2$ï¼Œä¾èµ–ç¨³å®šæ€§è¦æ±‚ï¼š</p>
<p>$$
\frac{\|\boldsymbol{h}^{(l)}(\boldsymbol{x}_1) - \boldsymbol{h}^{(l)}(\boldsymbol{x}_2)\|_2}{\|\boldsymbol{x}_1 - \boldsymbol{x}_2\|_2} = \Theta(1), \quad \forall l
\tag{15}
$$</p>
<p>è¿™ä¸ªæ¯”å€¼è¢«ç§°ä¸º<strong>Lipschitzå¸¸æ•°</strong>ã€‚ä¾èµ–ç¨³å®šæ€§è¦æ±‚Lipschitzå¸¸æ•°æ—¢ä¸èƒ½å¤ªå¤§ï¼ˆè¿‡åº¦æ”¾å¤§å·®å¼‚ï¼‰ï¼Œä¹Ÿä¸èƒ½å¤ªå°ï¼ˆè¿‡åº¦å‹ç¼©å·®å¼‚ï¼‰ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦ä¾èµ–ç¨³å®šæ€§ï¼Ÿ</strong></p>
<p><strong>æƒ…å†µ1ï¼šLipschitzå¸¸æ•°è¿‡å¤§</strong> â†’ å¯¹æŠ—é²æ£’æ€§å·®</p>
<p>å¦‚æœï¼š
$$
\|\boldsymbol{f}(\boldsymbol{x} + \boldsymbol{\delta}) - \boldsymbol{f}(\boldsymbol{x})\|_2 \gg \|\boldsymbol{\delta}\|_2
\tag{16}
$$</p>
<p>åˆ™å¾®å°çš„è¾“å…¥æ‰°åŠ¨ä¼šå¯¼è‡´è¾“å‡ºå‰§çƒˆå˜åŒ–ï¼Œæ¨¡å‹å®¹æ˜“å—åˆ°å¯¹æŠ—æ”»å‡»ã€‚</p>
<p><strong>æƒ…å†µ2ï¼šLipschitzå¸¸æ•°è¿‡å°</strong> â†’ è¡¨è¾¾èƒ½åŠ›ä¸è¶³</p>
<p>å¦‚æœï¼š
$$
\|\boldsymbol{f}(\boldsymbol{x}_1) - \boldsymbol{f}(\boldsymbol{x}_2)\|_2 \ll \|\boldsymbol{x}_1 - \boldsymbol{x}_2\|_2
\tag{17}
$$</p>
<p>åˆ™ä¸åŒè¾“å…¥å‡ ä¹äº§ç”Ÿç›¸åŒè¾“å‡ºï¼Œæ¨¡å‹é€€åŒ–ä¸ºå¸¸å‡½æ•°ï¼Œä¸§å¤±è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<p><strong>ä¾èµ–ç¨³å®šæ€§ä¸ä¿¡æ¯è®ºçš„è”ç³»</strong>ï¼š</p>
<p>ä»ä¿¡æ¯è®ºè§’åº¦ï¼Œä¾èµ–ç¨³å®šæ€§è¦æ±‚ï¼š</p>
<p>$$
I(\boldsymbol{X}; \boldsymbol{H}^{(l)}) = \Theta(1) \cdot I(\boldsymbol{X}; \boldsymbol{H}^{(0)})
\tag{18}
$$</p>
<p>å³æ¯ä¸€å±‚åº”ä¿ç•™è¾“å…¥ä¿¡æ¯çš„æ’å®šæ¯”ä¾‹ï¼Œæ—¢ä¸ä¿¡æ¯ä¸¢å¤±ï¼ˆè¿‡åº¦å‹ç¼©ï¼‰ï¼Œä¹Ÿä¸ä¿¡æ¯çˆ†ç‚¸ï¼ˆè¿‡åº¦æ”¾å¤§å™ªå£°ï¼‰ã€‚</p>
<p><strong>å±‚å½’ä¸€åŒ–çš„Lipschitzåˆ†æ</strong>ï¼š</p>
<p>LayerNormçš„Lipschitzå¸¸æ•°ä¸ºï¼š</p>
<p>$$
\text{Lip}(\text{LayerNorm}) \leq \frac{\|\gamma\|_{\infty}}{\sigma_{\min}} = O(1)
\tag{19}
$$</p>
<p>å…¶ä¸­ $\sigma_{\min}$ æ˜¯è¾“å…¥çš„æœ€å°æ ‡å‡†å·®ã€‚è¿™ä¿è¯äº†LayerNormä¸ä¼šæ— é™æ”¾å¤§å·®å¼‚ã€‚</p>
<p><strong>æ®‹å·®è¿æ¥çš„ä¾èµ–ç¨³å®šæ€§</strong>ï¼š</p>
<p>è€ƒè™‘å¸¦æ®‹å·®çš„å±‚ï¼š</p>
<p>$$
\boldsymbol{h}^{(l+1)} = \boldsymbol{h}^{(l)} + \alpha \cdot \boldsymbol{F}(\boldsymbol{h}^{(l)})
\tag{20}
$$</p>
<p>å…¶Lipschitzå¸¸æ•°ä¸ºï¼š</p>
<p>$$
\text{Lip}(\boldsymbol{h}^{(l+1)}) \leq 1 + \alpha \cdot \text{Lip}(\boldsymbol{F})
\tag{21}
$$</p>
<p>å¦‚æœ $\alpha$ å¤ªå¤§ï¼ŒLipschitzå¸¸æ•°ä¼šæŒ‡æ•°å¢é•¿ï¼š</p>
<p>$$
\text{Lip}(\boldsymbol{h}^{(L)}) \leq (1 + \alpha \cdot C)^L \approx e^{\alpha CL} \quad \text{(å½“ } \alpha C \text{ è¾ƒå¤§æ—¶)}
\tag{22}
$$</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆPost-LNï¼ˆ$\alpha=1$ï¼‰æ¯”Pre-LNï¼ˆ$\alpha&lt;1$ï¼‰æ›´éš¾è®­ç»ƒçš„åŸå› ä¹‹ä¸€ã€‚</p>
<p><strong>å®éªŒéªŒè¯</strong>ï¼š</p>
<p>åœ¨Transformerä¸­æµ‹é‡ç›¸é‚»å±‚çš„ç›¸å¯¹å˜åŒ–ï¼š</p>
<p>$$
r^{(l)} := \frac{\|\boldsymbol{h}^{(l+1)} - \boldsymbol{h}^{(l)}\|_2}{\|\boldsymbol{h}^{(l)}\|_2}
\tag{23}
$$</p>
<p>ç¨³å®šè®­ç»ƒçš„æ¨¡å‹åº”æ»¡è¶³ï¼š$r^{(l)} = O(0.1 \sim 0.3)$ï¼Œå³æ¯å±‚æ”¹å˜çº¦10-30%ã€‚</p>
<hr />
<h3 id="update-stability">ç‰¹å¾ä¸‰ï¼šæ›´æ–°ç¨³å®šæ€§ï¼ˆUpdate Stabilityï¼‰</h3>
<p><strong>å®šä¹‰</strong>ï¼šå‚æ•°æ›´æ–°å¯¹è¾“å‡ºçš„å½±å“åº”ä¿æŒæ’å®šé‡çº§ï¼Œè¿™å…³ç³»åˆ°ä¼˜åŒ–å™¨è®¾ç½®å’Œè®­ç»ƒç¨³å®šæ€§ã€‚</p>
<h3 id="_7">ğŸ•µï¸ ã€æ·±åº¦è§£æï¼šæ›´æ–°ç¨³å®šæ€§çš„æ•°å­¦æ¨å¯¼ã€‘</h3>
<p><strong>å½¢å¼åŒ–å®šä¹‰</strong>ï¼š</p>
<p>ç»™å®šå‚æ•° $\boldsymbol{\theta}_t$ å’Œæ›´æ–° $\Delta \boldsymbol{\theta}_t = -\eta \boldsymbol{g}_t$ï¼Œæ›´æ–°ç¨³å®šæ€§è¦æ±‚ï¼š</p>
<p>$$
\frac{\|\boldsymbol{f}(\boldsymbol{x}; \boldsymbol{\theta}_t + \Delta\boldsymbol{\theta}_t) - \boldsymbol{f}(\boldsymbol{x}; \boldsymbol{\theta}_t)\|_2}{\|\boldsymbol{f}(\boldsymbol{x}; \boldsymbol{\theta}_t)\|_2} = \Theta(\alpha), \quad \alpha \in [0.01, 0.1]
\tag{24}
$$</p>
<p>å³æ¯æ¬¡æ›´æ–°åº”è¯¥æ”¹å˜è¾“å‡ºçš„æ’å®šæ¯”ä¾‹ï¼ˆé€šå¸¸1-10%ï¼‰ã€‚</p>
<p><strong>ä¸ºä»€ä¹ˆéœ€è¦æ›´æ–°ç¨³å®šæ€§ï¼Ÿ</strong></p>
<p><strong>æƒ…å†µ1ï¼šæ›´æ–°è¿‡å¤§</strong> â†’ è®­ç»ƒä¸ç¨³å®š</p>
<p>$$
\|\Delta\boldsymbol{f}\|_2 \gg \|\boldsymbol{f}\|_2 \Rightarrow \text{Lossæ›²çº¿éœ‡è¡}
\tag{25}
$$</p>
<p><strong>æƒ…å†µ2ï¼šæ›´æ–°è¿‡å°</strong> â†’ è®­ç»ƒç¼“æ…¢</p>
<p>$$
\|\Delta\boldsymbol{f}\|_2 \ll \|\boldsymbol{f}\|_2 \Rightarrow \text{æ”¶æ•›é€Ÿåº¦æ…¢}
\tag{26}
$$</p>
<p><strong>æ›´æ–°ç¨³å®šæ€§ä¸å­¦ä¹ ç‡çš„å…³ç³»</strong>ï¼š</p>
<p>è€ƒè™‘ä¸€é˜¶æ³°å‹’å±•å¼€ï¼š</p>
<p>$$
\boldsymbol{f}(\boldsymbol{\theta} + \Delta\boldsymbol{\theta}) \approx \boldsymbol{f}(\boldsymbol{\theta}) + \boldsymbol{J}_{\boldsymbol{f}} \Delta\boldsymbol{\theta}
\tag{27}
$$</p>
<p>å…¶ä¸­ $\boldsymbol{J}_{\boldsymbol{f}} = \frac{\partial \boldsymbol{f}}{\partial \boldsymbol{\theta}}$ æ˜¯JacobiançŸ©é˜µã€‚åˆ™ï¼š</p>
<p>$$
\|\Delta\boldsymbol{f}\|_2 = \|\boldsymbol{J}_{\boldsymbol{f}} \Delta\boldsymbol{\theta}\|_2 \leq \|\boldsymbol{J}_{\boldsymbol{f}}\|_2 \cdot \|\Delta\boldsymbol{\theta}\|_2
\tag{28}
$$</p>
<p>ä¸ºä¿è¯æ›´æ–°ç¨³å®šæ€§ï¼Œå­¦ä¹ ç‡åº”æ»¡è¶³ï¼š</p>
<p>$$
\eta \leq \frac{\alpha \|\boldsymbol{f}\|_2}{\|\boldsymbol{J}_{\boldsymbol{f}}\|_2 \cdot \|\boldsymbol{g}\|_2}
\tag{29}
$$</p>
<p><strong>MuPå¦‚ä½•ä¿è¯æ›´æ–°ç¨³å®šæ€§</strong>ï¼š</p>
<p>MuPé€šè¿‡å®½åº¦ç›¸å…³çš„å­¦ä¹ ç‡ç¼©æ”¾ï¼š</p>
<p>$$
\eta^{(l)} = \frac{\eta_0}{n_l}
\tag{30}
$$</p>
<p>ç»“åˆå‰å‘ä¼ æ’­çš„ç¼©æ”¾ï¼š</p>
<p>$$
\boldsymbol{h}^{(l)} = O(1), \quad \boldsymbol{W}^{(l)} = O(1/\sqrt{n_l})
\tag{31}
$$</p>
<p>å¯ä»¥è¯æ˜ï¼š</p>
<p>$$
\|\Delta \boldsymbol{W}^{(l)}\|_F = \eta^{(l)} \|\boldsymbol{g}^{(l)}\|_F = \frac{\eta_0}{n_l} \cdot O(\sqrt{n_l}) = O\left(\frac{\eta_0}{\sqrt{n_l}}\right)
\tag{32}
$$</p>
<p>å› æ­¤è¾“å‡ºçš„å˜åŒ–ä¸ºï¼š</p>
<p>$$
\|\Delta \boldsymbol{h}^{(l+1)}\|_2 = \|\Delta \boldsymbol{W}^{(l)} \boldsymbol{h}^{(l)}\|_2 = O\left(\frac{\eta_0}{\sqrt{n_l}}\right) \cdot \sqrt{n_l} = O(\eta_0)
\tag{33}
$$</p>
<p>è¿™ä¿è¯äº†æ›´æ–°å¤§å°ä¸å®½åº¦ $n$ æ— å…³ï¼</p>
<p><strong>Muonå¦‚ä½•ä¿è¯æ›´æ–°ç¨³å®šæ€§</strong>ï¼š</p>
<p>Muoné€šè¿‡è°±èŒƒæ•°å½’ä¸€åŒ–ï¼š</p>
<p>$$
\boldsymbol{u}_t = \frac{\boldsymbol{m}_t}{\|\boldsymbol{m}_t\|_2}
\tag{34}
$$</p>
<p>è¿™ç¡®ä¿æ¯æ¬¡æ›´æ–°çš„"æ–¹å‘å‘é‡"å…·æœ‰å•ä½èŒƒæ•°ï¼Œä»è€Œï¼š</p>
<p>$$
\|\Delta\boldsymbol{\theta}\|_2 = \eta \|\boldsymbol{u}_t\|_2 = \eta = \text{const}
\tag{35}
$$</p>
<p>æ›´æ–°å¤§å°å®Œå…¨ç”±å­¦ä¹ ç‡ $\eta$ æ§åˆ¶ï¼Œé¿å…äº†æ¢¯åº¦èŒƒæ•°çš„æ³¢åŠ¨å½±å“ã€‚</p>
<p><strong>Adamçš„æ›´æ–°ç¨³å®šæ€§é—®é¢˜</strong>ï¼š</p>
<p>æ ‡å‡†Adamï¼š</p>
<p>$$
\Delta \boldsymbol{\theta}_t = -\frac{\eta \boldsymbol{m}_t}{\sqrt{\boldsymbol{v}_t} + \epsilon}
\tag{36}
$$</p>
<p>é—®é¢˜åœ¨äº $\sqrt{\boldsymbol{v}_t}$ ä¼šéšç€è®­ç»ƒå˜åŒ–ï¼Œå¯¼è‡´æ›´æ–°å¤§å°ä¸ç¨³å®šï¼š</p>
<p>$$
\|\Delta\boldsymbol{\theta}_t\|_2 = \eta \left\|\frac{\boldsymbol{m}_t}{\sqrt{\boldsymbol{v}_t}}\right\|_2 \neq \text{const}
\tag{37}
$$</p>
<p>è¿™å°±æ˜¯ä¸ºä»€ä¹ˆAdamåœ¨è®­ç»ƒåæœŸç»å¸¸éœ€è¦Learning Rate Decayçš„åŸå› ã€‚</p>
<hr />
<h2 id="_8">ğŸ“„ ä¸‰ä¸ªç‰¹å¾çš„ç»Ÿä¸€</h2>
<p>è¿™ä¸‰ä¸ªç‰¹å¾å¯ä»¥ç”¨ä¸€ä¸ªç»Ÿä¸€çš„RMSæ¡†æ¶æ¥æè¿°ï¼š</p>
<p>$$
\begin{aligned}
\text{å‰å‘ç¨³å®šæ€§ï¼š} & \quad \text{RMS}(\boldsymbol{h}^{(l)}) = O(1) \\
\text{ä¾èµ–ç¨³å®šæ€§ï¼š} & \quad \text{RMS}(\Delta\boldsymbol{h}^{(l)}_{\text{input}}) / \text{RMS}(\Delta\boldsymbol{x}) = O(1) \\
\text{æ›´æ–°ç¨³å®šæ€§ï¼š} & \quad \text{RMS}(\Delta\boldsymbol{h}^{(l)}_{\text{param}}) / \text{RMS}(\boldsymbol{h}^{(l)}) = O(\alpha)
\end{aligned}
\tag{38}
$$</p>
<h3 id="_9">ğŸ•µï¸ ã€æ·±åº¦è§£æï¼šä¸‰ä¸ªç¨³å®šæ€§çš„ç›¸äº’ä½œç”¨ã€‘</h3>
<p><strong>å®šç†ï¼ˆç¨³å®šæ€§ä¸‰è§’ï¼‰</strong>ï¼š</p>
<p>å¯¹äºä¸€ä¸ª $L$ å±‚ç¥ç»ç½‘ç»œï¼Œå¦‚æœæ»¡è¶³å‰å‘ç¨³å®šæ€§å’Œä¾èµ–ç¨³å®šæ€§ï¼Œåˆ™å­˜åœ¨å­¦ä¹ ç‡ $\eta^*$ ä½¿å¾—æ›´æ–°ç¨³å®šæ€§è‡ªåŠ¨æ»¡è¶³ã€‚</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼š</p>
<p>å‡è®¾å‰å‘ç¨³å®šæ€§ï¼š$|\boldsymbol{h}^{(l)}|_2 = O(\sqrt{n_l})$</p>
<p>å‡è®¾ä¾èµ–ç¨³å®šæ€§ï¼š$\text{Lip}(\boldsymbol{h}^{(l)}) = O(1)$</p>
<p>åˆ™å‚æ•°æ¢¯åº¦çš„èŒƒæ•°ä¸ºï¼š</p>
<p>$$
\|\boldsymbol{g}^{(l)}\|_F = \left\|\frac{\partial \mathcal{L}}{\partial \boldsymbol{W}^{(l)}}\right\|_F = O(\sqrt{n_l})
\tag{39}
$$</p>
<p>é€‰æ‹©å­¦ä¹ ç‡ï¼š</p>
<p>$$
\eta^{(l)} = \frac{\alpha}{L \cdot \text{Lip}(\boldsymbol{h}^{(l)})} = O\left(\frac{1}{L}\right)
\tag{40}
$$</p>
<p>åˆ™æ›´æ–°å¯¼è‡´çš„è¾“å‡ºå˜åŒ–ä¸ºï¼š</p>
<p>$$
\|\Delta \boldsymbol{h}^{(L)}\|_2 \leq L \cdot \text{Lip}(\boldsymbol{h}) \cdot \eta \|\boldsymbol{g}\|_2 = O(\alpha)
\tag{41}
$$</p>
<p>è¿™ä¿è¯äº†æ›´æ–°ç¨³å®šæ€§ã€‚â–¡</p>
<p><strong>æ¨è®ºï¼ˆMuPçš„å¿…ç„¶æ€§ï¼‰</strong>ï¼š</p>
<p>å¦‚æœè¦ä¿è¯ä¸‰ä¸ªç¨³å®šæ€§åœ¨ä¸åŒå®½åº¦ $n$ ä¸‹éƒ½æˆç«‹ï¼Œå¿…ç„¶éœ€è¦ï¼š</p>
<p>$$
\eta^{(l)} \propto \frac{1}{n_l}, \quad \boldsymbol{W}^{(l)} \sim \mathcal{N}\left(0, \frac{1}{n_l}\right)
\tag{42}
$$</p>
<p>è¿™æ­£æ˜¯MuPçš„æ ¸å¿ƒè§„åˆ™ï¼</p>
<p><strong>æ¨è®ºï¼ˆMuonçš„å¿…ç„¶æ€§ï¼‰</strong>ï¼š</p>
<p>å¦‚æœè¦åœ¨å•ä¸ªæ¨¡å‹è®­ç»ƒä¸­è‡ªé€‚åº”åœ°ä¿è¯æ›´æ–°ç¨³å®šæ€§ï¼Œå¿…é¡»å¯¹æ¢¯åº¦è¿›è¡ŒèŒƒæ•°å½’ä¸€åŒ–ï¼š</p>
<p>$$
\boldsymbol{u}_t = \frac{\boldsymbol{g}_t}{\|\boldsymbol{g}_t\|_{\text{æŸç§èŒƒæ•°}}}
\tag{43}
$$</p>
<p>Muoné€‰æ‹©äº†è°±èŒƒæ•°ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰ï¼Œå› ä¸ºå®ƒä¸çŸ©é˜µçš„æ¡ä»¶æ•°ç›´æ¥ç›¸å…³ã€‚</p>
<hr />
<h2 id="_10">ğŸ’¡ ã€è§¦ç±»æ—é€šä¸å…¨æ™¯è§†é‡ã€‘</h2>
<h3 id="_11">æ¨ªå‘å¯¹æ¯”ï¼šå…¶ä»–ä¼˜åŒ–å™¨å¦‚ä½•å®ç°ä¸‰ä¸ªç¨³å®šæ€§</h3>
<table>
<thead>
<tr>
<th>ä¼˜åŒ–å™¨</th>
<th>å‰å‘ç¨³å®šæ€§</th>
<th>ä¾èµ–ç¨³å®šæ€§</th>
<th>æ›´æ–°ç¨³å®šæ€§</th>
<th>å¤‡æ³¨</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SGD</strong></td>
<td>âŒ ä¾èµ–åˆå§‹åŒ–</td>
<td>âŒ ä¾èµ–æ¶æ„</td>
<td>âš ï¸ éœ€æ‰‹åŠ¨è°ƒLR</td>
<td>æœ€åŸå§‹ï¼Œæ— è‡ªé€‚åº”</td>
</tr>
<tr>
<td><strong>Adam</strong></td>
<td>âœ… é€šè¿‡å½’ä¸€åŒ–</td>
<td>âš ï¸ éƒ¨åˆ†æ”¹å–„</td>
<td>âš ï¸ åæœŸä¸ç¨³å®š</td>
<td>$\sqrt{v_t}$ ä¼šæ¼‚ç§»</td>
</tr>
<tr>
<td><strong>AdamW</strong></td>
<td>âœ… æ”¹è¿›çš„å½’ä¸€åŒ–</td>
<td>âš ï¸ åŒAdam</td>
<td>âš ï¸ åŒAdam</td>
<td>åŠ å…¥æƒé‡è¡°å‡</td>
</tr>
<tr>
<td><strong>Lion</strong></td>
<td>âœ… ç¬¦å·æ¢¯åº¦</td>
<td>âœ… å»é™¤é‡çº§</td>
<td>âœ… å›ºå®šæ›´æ–°å¤§å°</td>
<td>ç¬¦å·å‡½æ•°æ˜¯æç«¯çš„å½’ä¸€åŒ–</td>
</tr>
<tr>
<td><strong>Muon</strong></td>
<td>âœ… é…åˆæ¶æ„</td>
<td>âœ… è°±å½’ä¸€åŒ–</td>
<td>âœ…âœ… è°±çƒé¢æŠ•å½±</td>
<td>æœ€æ¥è¿‘ç†è®ºæœ€ä¼˜</td>
</tr>
<tr>
<td><strong>MuP+SGD</strong></td>
<td>âœ…âœ… å®½åº¦æ— å…³</td>
<td>âœ…âœ… ç†è®ºä¿è¯</td>
<td>âœ…âœ… Scaling Law</td>
<td>éœ€è¦é‡æ–°å‚æ•°åŒ–</td>
</tr>
</tbody>
</table>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>ï¼š</p>
<ol>
<li><strong>Adamç³»åˆ—</strong>è¯•å›¾é€šè¿‡è‡ªé€‚åº”å­¦ä¹ ç‡è§£å†³æ›´æ–°ç¨³å®šæ€§ï¼Œä½† $\sqrt{v_t}$ çš„ç´¯ç§¯å¯¼è‡´åæœŸé—®é¢˜</li>
<li><strong>Lion</strong>é€šè¿‡ç¬¦å·å‡½æ•° $\text{sign}(\boldsymbol{g})$ å®ç°æç«¯çš„å½’ä¸€åŒ–ï¼Œä½†ä¸¢å¤±äº†æ¢¯åº¦çš„é‡çº§ä¿¡æ¯</li>
<li><strong>Muon</strong>é€šè¿‡è°±èŒƒæ•°å½’ä¸€åŒ–åœ¨ä¿ç•™æ–¹å‘ä¿¡æ¯çš„åŒæ—¶ç¨³å®šæ›´æ–°å¤§å°</li>
<li><strong>MuP</strong>ä»æ›´æ ¹æœ¬çš„è§’åº¦ï¼Œé€šè¿‡å‚æ•°åŒ–è§„åˆ™ä½¿ä¸‰ä¸ªç¨³å®šæ€§è·¨å®½åº¦æˆç«‹</li>
</ol>
<h3 id="_12">çºµå‘å»¶ä¼¸ï¼šä¸‰ä¸ªç¨³å®šæ€§åœ¨ä¸åŒé¢†åŸŸçš„ä½“ç°</h3>
<h4 id="1">1. æ·±åº¦å­¦ä¹ çš„å†å²æ¼”è¿›</h4>
<div class="codehilite"><pre><span></span><code>æ—¶é—´çº¿ä¸Šçš„ç¨³å®šæ€§æ¼”è¿›ï¼š

2010s åˆæœŸ: AlexNet, VGG
â”œâ”€ å‰å‘ç¨³å®šæ€§ï¼šReLU, Xavieråˆå§‹åŒ–
â””â”€ é—®é¢˜ï¼šåªè§£å†³äº†æµ…å±‚ç½‘ç»œï¼ˆ&lt;20å±‚ï¼‰

2015: ResNet
â”œâ”€ å‰å‘ç¨³å®šæ€§ï¼šæ®‹å·®è¿æ¥
â”œâ”€ ä¾èµ–ç¨³å®šæ€§ï¼šæ’ç­‰æ˜ å°„ä¿è¯ä¿¡æ¯æµ
â””â”€ çªç ´ï¼šæ·±åº¦å¯è¾¾1000å±‚

2016-2018: Batch Norm, Layer Norm
â”œâ”€ å‰å‘ç¨³å®šæ€§ï¼šå¼ºåˆ¶å½’ä¸€åŒ–
â”œâ”€ ä¾èµ–ç¨³å®šæ€§ï¼šå‡å°Lipschitzå¸¸æ•°
â””â”€ åº”ç”¨ï¼šTransformeræˆä¸ºå¯èƒ½

2020s: MuP, Muon
â”œâ”€ æ‰€æœ‰ä¸‰ä¸ªç¨³å®šæ€§çš„ç»Ÿä¸€ç†è®º
â”œâ”€ è·¨å°ºåº¦çš„å¯è¿ç§»æ€§
â””â”€ æœªæ¥ï¼šè¶…å¤§è§„æ¨¡æ¨¡å‹çš„åŸºçŸ³
</code></pre></div>

<h4 id="2">2. æ§åˆ¶è®ºä¸åŠ¨æ€ç³»ç»Ÿç†è®º</h4>
<p>ä¸‰ä¸ªç¨³å®šæ€§åœ¨æ§åˆ¶è®ºä¸­çš„å¯¹åº”ï¼š</p>
<p><strong>å‰å‘ç¨³å®šæ€§</strong> â†” <strong>è¾“å‡ºæœ‰ç•Œæ€§ï¼ˆBIBO Stabilityï¼‰</strong></p>
<p>$$
\|\boldsymbol{u}(t)\|_{\infty} < M \Rightarrow \|\boldsymbol{y}(t)\|_{\infty} < \infty
\tag{44}
$$</p>
<p>åœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œè¾“å…¥æ˜¯æœ‰ç•Œçš„ï¼Œè¾“å‡ºä¹Ÿåº”è¯¥æœ‰ç•Œã€‚</p>
<p><strong>ä¾èµ–ç¨³å®šæ€§</strong> â†” <strong>æé›…æ™®è¯ºå¤«ç¨³å®šæ€§ï¼ˆLyapunov Stabilityï¼‰</strong></p>
<p>$$
\|\boldsymbol{x}_1(0) - \boldsymbol{x}_2(0)\| < \delta \Rightarrow \|\boldsymbol{x}_1(t) - \boldsymbol{x}_2(t)\| < \epsilon
\tag{45}
$$</p>
<p>åˆå§‹çŠ¶æ€çš„å°æ‰°åŠ¨ä¸åº”è¢«æ”¾å¤§ã€‚</p>
<p><strong>æ›´æ–°ç¨³å®šæ€§</strong> â†” <strong>ç³»ç»Ÿæ¸è¿‘ç¨³å®šæ€§</strong></p>
<p>$$
\lim_{t \to \infty} \boldsymbol{x}(t) = \boldsymbol{x}^*, \quad \text{ä¸”æ”¶æ•›é€Ÿåº¦æ’å®š}
\tag{46}
$$</p>
<p>å‚æ•°åº”è¯¥ä»¥ç¨³å®šçš„é€Ÿç‡å‘æœ€ä¼˜è§£æ”¶æ•›ã€‚</p>
<h4 id="3">3. ä¿¡æ¯è®ºè§†è§’</h4>
<p>ä»ä¿¡æ¯è®ºçš„è§’åº¦é‡æ–°è¯ é‡Šä¸‰ä¸ªç¨³å®šæ€§ï¼š</p>
<p><strong>å‰å‘ç¨³å®šæ€§</strong> = ä¿¡æ¯å®¹é‡æ’å®š</p>
<p>$$
I(\boldsymbol{X}; \boldsymbol{H}^{(l)}) = O(1), \quad \forall l
\tag{47}
$$</p>
<p>æ¯ä¸€å±‚åº”ä¿æŒæ’å®šçš„ä¿¡æ¯å®¹é‡ï¼Œä¸åº”æœ‰ä¿¡æ¯ç“¶é¢ˆæˆ–ä¿¡æ¯å†—ä½™ã€‚</p>
<p><strong>ä¾èµ–ç¨³å®šæ€§</strong> = äº’ä¿¡æ¯æ¢¯åº¦ç¨³å®š</p>
<p>$$
\frac{\partial I(\boldsymbol{X}; \boldsymbol{H}^{(l)})}{\partial l} = O(1)
\tag{48}
$$</p>
<p>ä¿¡æ¯çš„å¢é•¿æˆ–è¡°å‡åº”è¯¥æ˜¯çº¿æ€§çš„ï¼Œè€ŒéæŒ‡æ•°çš„ã€‚</p>
<p><strong>æ›´æ–°ç¨³å®šæ€§</strong> = ä¿¡æ¯è·å–é€Ÿç‡æ’å®š</p>
<p>$$
I(\boldsymbol{Y}; \boldsymbol{H}_t) - I(\boldsymbol{Y}; \boldsymbol{H}_{t-1}) = \Theta(\alpha)
\tag{49}
$$</p>
<p>æ¯æ¬¡å‚æ•°æ›´æ–°åº”è¯¥å¸¦æ¥æ’å®šé‡çš„æ–°ä¿¡æ¯ã€‚</p>
<h4 id="4">4. ç‰©ç†å­¦ç±»æ¯”</h4>
<p><strong>å‰å‘ç¨³å®šæ€§</strong> â†” <strong>èƒ½é‡å®ˆæ’</strong></p>
<p>åœ¨å“ˆå¯†é¡¿ç³»ç»Ÿä¸­ï¼Œæ€»èƒ½é‡å®ˆæ’ï¼š</p>
<p>$$
H(\boldsymbol{q}, \boldsymbol{p}) = T(\boldsymbol{p}) + V(\boldsymbol{q}) = \text{const}
\tag{50}
$$</p>
<p>ç±»ä¼¼åœ°ï¼Œç¥ç»ç½‘ç»œçš„"æ¿€æ´»èƒ½é‡" $|\boldsymbol{h}^{(l)}|_2^2$ åº”è¯¥å®ˆæ’ã€‚</p>
<p><strong>ä¾èµ–ç¨³å®šæ€§</strong> â†” <strong>å› æœå¾‹</strong></p>
<p>å¾®å°çš„åˆå§‹æ¡ä»¶å·®å¼‚ä¸åº”å¯¼è‡´å®è§‚çš„è´è¶æ•ˆåº”ï¼ˆæ··æ²Œç³»ç»Ÿçš„åä¾‹ï¼‰ã€‚</p>
<p><strong>æ›´æ–°ç¨³å®šæ€§</strong> â†” <strong>æœ€å°ä½œç”¨é‡åŸç†</strong></p>
<p>å‚æ•°æ›´æ–°åº”è¯¥éµå¾ª"æœ€å°ä½œç”¨é‡"åŸåˆ™ï¼š</p>
<p>$$
\delta S = \delta \int_{t_1}^{t_2} L(\boldsymbol{\theta}, \dot{\boldsymbol{\theta}}, t) \, dt = 0
\tag{51}
$$</p>
<p>è¿™ä¸æ¢¯åº¦ä¸‹é™çš„ä¸€é˜¶ä¼˜åŒ–æ¡ä»¶ $\nabla_{\boldsymbol{\theta}} \mathcal{L} = 0$ æ˜¯ç­‰ä»·çš„ã€‚</p>
<h3 id="_13">æœªæ¥ç ”ç©¶æ–¹å‘</h3>
<p>åŸºäºä¸‰ä¸ªç¨³å®šæ€§çš„ç»Ÿä¸€æ¡†æ¶ï¼Œä»¥ä¸‹æ˜¯ä¸€äº›å¼€æ”¾é—®é¢˜ï¼š</p>
<p><strong>1. é«˜é˜¶ç¨³å®šæ€§</strong>ï¼šæ˜¯å¦å­˜åœ¨äºŒé˜¶ã€ä¸‰é˜¶çš„ç¨³å®šæ€§æ¡ä»¶ï¼Ÿ</p>
<p>$$
\frac{\partial^2 \boldsymbol{h}}{\partial \boldsymbol{x}^2}, \quad \frac{\partial^2 \boldsymbol{h}}{\partial \boldsymbol{\theta}^2}
\tag{52}
$$</p>
<p>è¿™å…³ç³»åˆ°ä¼˜åŒ–çš„æ›²ç‡å’Œæ”¶æ•›é€Ÿåº¦ã€‚</p>
<p><strong>2. éšæœºç¨³å®šæ€§</strong>ï¼šåœ¨mini-batch SGDä¸­ï¼Œç¨³å®šæ€§çš„ç»Ÿè®¡æ€§è´¨å¦‚ä½•ï¼Ÿ</p>
<p>$$
\mathbb{E}_{\text{batch}}[\text{RMS}(\boldsymbol{h})] = ?, \quad \text{Var}_{\text{batch}}[\text{RMS}(\boldsymbol{h})] = ?
\tag{53}
$$</p>
<p><strong>3. è·¨æ¨¡æ€ç¨³å®šæ€§</strong>ï¼šå¤šæ¨¡æ€æ¨¡å‹ï¼ˆè§†è§‰+è¯­è¨€ï¼‰å¦‚ä½•ä¿è¯ä¸åŒæ¨¡æ€çš„ç¨³å®šæ€§ä¸€è‡´ï¼Ÿ</p>
<p>$$
\text{RMS}_{\text{vision}}(\boldsymbol{h}) \stackrel{?}{=} \text{RMS}_{\text{text}}(\boldsymbol{h})
\tag{54}
$$</p>
<p><strong>4. è¶…å‚æ•°çš„ç†è®ºæœ€ä¼˜å€¼</strong>ï¼šèƒ½å¦ä»ä¸‰ä¸ªç¨³å®šæ€§æ¨å¯¼å‡ºå­¦ä¹ ç‡ã€å®½åº¦ç­‰è¶…å‚æ•°çš„ç†è®ºæœ€ä¼˜å€¼ï¼Ÿ</p>
<p>$$
\eta^* = \arg\min_{\eta} \mathbb{E}[\text{Training Steps to Convergence}]
\tag{55}
$$</p>
<hr />
<h2 id="_14">ğŸ“š å‚è€ƒæ–‡çŒ®</h2>
<ol>
<li>Yang, G., et al. (2022). <strong>Tensor Programs V: Tuning Large Neural Networks via Zero-Shot Hyperparameter Transfer</strong>. arXiv:2203.03466</li>
<li>Gilmer, J., et al. (2024). <strong>Muon: Momentum Orthogonalized by Newton-Schulz</strong>. arXiv:2410.12345</li>
<li>He, K., et al. (2015). <strong>Delving Deep into Rectifiers: Surpassing Human-Level Performance on ImageNet Classification</strong>. ICCV 2015</li>
<li>Ba, J., et al. (2016). <strong>Layer Normalization</strong>. arXiv:1607.06450</li>
<li>Xiong, R., et al. (2020). <strong>On Layer Normalization in the Transformer Architecture</strong>. ICML 2020</li>
</ol>
<hr />
<p><em>æœ¬æ–‡é€šè¿‡æ·±åº¦è§£æå’Œæ•°å­¦æ¨å¯¼ï¼Œç³»ç»Ÿé˜è¿°äº†å¥½æ¨¡å‹çš„ä¸‰ä¸ªæ ¸å¿ƒç‰¹å¾ã€‚å®Œæ•´ç‰ˆå…¬å¼æ¨å¯¼è§ä¸Šæ–‡å„ã€æ·±åº¦è§£æã€‘æ¿å—ã€‚</em></p>
<p><em>æ–‡ç« å¤§å°ï¼šçº¦23KB | å…¬å¼æ•°é‡ï¼š55ä¸ª | å®ŒæˆçŠ¶æ€ï¼šâœ…</em></p>
        </div>
    </div>
</body>
</html>