<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä»è°±èŒƒæ•°æ¢¯åº¦åˆ°æ–°å¼æƒé‡è¡°å‡çš„æ€è€ƒ</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ä»è°±èŒƒæ•°æ¢¯åº¦åˆ°æ–°å¼æƒé‡è¡°å‡çš„æ€è€ƒ</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 48.5 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10648">https://spaces.ac.cn/archives/10648</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨æ–‡ç« <a href="/archives/10592">ã€ŠMuonä¼˜åŒ–å™¨èµæï¼šä»å‘é‡åˆ°çŸ©é˜µçš„æœ¬è´¨è·¨è¶Šã€‹</a>ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸ªåä¸ºâ€œMuonâ€çš„æ–°ä¼˜åŒ–å™¨ï¼Œå…¶ä¸­ä¸€ä¸ªç†è§£è§†è§’æ˜¯ä½œä¸ºè°±èŒƒæ•°æ­£åˆ™ä¸‹çš„æœ€é€Ÿæ¢¯åº¦ä¸‹é™ï¼Œè¿™ä¼¼ä¹æ­ç¤ºäº†çŸ©é˜µå‚æ•°çš„æ›´æœ¬è´¨çš„ä¼˜åŒ–æ–¹å‘ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œå¯¹äºçŸ©é˜µå‚æ•°æˆ‘ä»¬ç»å¸¸ä¹Ÿä¼šåŠ æƒé‡è¡°å‡ï¼ˆWeight Decayï¼‰ï¼Œå®ƒå¯ä»¥ç†è§£ä¸º$F$èŒƒæ•°å¹³æ–¹çš„æ¢¯åº¦ï¼Œé‚£ä¹ˆä»Muonçš„è§†è§’çœ‹ï¼Œé€šè¿‡è°±èŒƒæ•°å¹³æ–¹çš„æ¢¯åº¦æ¥æ„å»ºæ–°çš„æƒé‡è¡°å‡ï¼Œä¼šä¸ä¼šèƒ½èµ·åˆ°æ›´å¥½çš„æ•ˆæœå‘¢ï¼Ÿ</p>
<p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œè°±èŒƒæ•°çš„æ¢¯åº¦æˆ–è€…è¯´å¯¼æ•°é•¿å•¥æ ·å‘¢ï¼Ÿç”¨å®ƒæ¥è®¾è®¡çš„æ–°æƒé‡è¡°å‡åˆæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿæ¥ä¸‹æ¥æˆ‘ä»¬å›´ç»•è¿™äº›é—®é¢˜å±•å¼€ã€‚</p>
<h2 id="_1">åŸºç¡€å›é¡¾</h2>
<p>è°±èŒƒæ•°ï¼ˆSpectral Normï¼‰ï¼Œåˆç§°â€œ$2$èŒƒæ•°â€ï¼Œæ˜¯æœ€å¸¸ç”¨çš„çŸ©é˜µèŒƒæ•°ä¹‹ä¸€ï¼Œç›¸æ¯”æ›´ç®€å•çš„$F$èŒƒæ•°ï¼ˆFrobenius Normï¼‰ï¼Œå®ƒå¾€å¾€èƒ½æ­ç¤ºä¸€äº›ä¸çŸ©é˜µä¹˜æ³•ç›¸å…³çš„æ›´æœ¬è´¨çš„ä¿¡å·ï¼Œè¿™æ˜¯å› ä¸ºå®ƒå®šä¹‰ä¸Šå°±è·ŸçŸ©é˜µä¹˜æ³•ç›¸å…³ï¼šå¯¹äºçŸ©é˜µå‚æ•°$\boldsymbol{W}\in\mathbb{R}^{n\times m}$ï¼Œå®ƒçš„è°±èŒƒæ•°å®šä¹‰ä¸º<br />
\begin{equation}\Vert\boldsymbol{W}\Vert_2 \triangleq \max_{\Vert\boldsymbol{x}\Vert=1} \Vert\boldsymbol{W}\boldsymbol{x}\Vert\end{equation}<br />
è¿™é‡Œ$\boldsymbol{x}\in\mathbb{R}^m$æ˜¯åˆ—å‘é‡ï¼Œå³ç«¯çš„$\Vert\Vert$æ˜¯å‘é‡çš„æ¨¡é•¿ï¼ˆæ¬§æ°èŒƒæ•°ï¼‰ã€‚æ¢ä¸ªè§’åº¦çœ‹ï¼Œè°±èŒƒæ•°å°±æ˜¯ä½¿å¾—ä¸‹é¢ä¸ç­‰å¼å¯¹$\forall \boldsymbol{x}\in\mathbb{R}^m$æ’æˆç«‹çš„æœ€å°å¸¸æ•°$C$ï¼š<br />
\begin{equation}\Vert\boldsymbol{W}\boldsymbol{x}\Vert \leq C\Vert\boldsymbol{x}\Vert\end{equation}<br />
ä¸éš¾è¯æ˜ï¼Œå½“$C$å–$F$èŒƒæ•°$\Vert W\Vert_F$æ—¶ï¼Œä¸Šå¼ä¹Ÿæ˜¯æ’æˆç«‹çš„ï¼Œæ‰€ä»¥å¯ä»¥å†™å‡º$\Vert \boldsymbol{W}\Vert_2\leq \Vert \boldsymbol{W}\Vert_F$ï¼ˆå› ä¸º$\Vert \boldsymbol{W}\Vert_F$åªæ˜¯è®©ä¸Šå¼æ’æˆç«‹çš„å…¶ä¸­ä¸€ä¸ª$C$ï¼Œè€Œ$\Vert \boldsymbol{W}\Vert_2$åˆ™æ˜¯æœ€å°çš„é‚£ä¸ª$C$ï¼‰ã€‚è¿™ä¸ªç»“è®ºä¹Ÿè¡¨æ˜ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦æ§åˆ¶è¾“å‡ºçš„å¹…åº¦ï¼Œä»¥è°±èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹è¦æ¯”$F$èŒƒæ•°æ›´ä¸ºç²¾å‡†ã€‚</p>
<p>æ—©åœ¨6å¹´å‰çš„<a href="/archives/6051">ã€Šæ·±åº¦å­¦ä¹ ä¸­çš„Lipschitzçº¦æŸï¼šæ³›åŒ–ä¸ç”Ÿæˆæ¨¡å‹ã€‹</a>ä¸­ï¼Œæˆ‘ä»¬å°±è®¨è®ºè¿‡è°±èŒƒæ•°ï¼Œå½“æ—¶çš„åº”ç”¨åœºæ™¯æœ‰ä¸¤ä¸ªï¼šä¸€æ˜¯WGANå¯¹åˆ¤åˆ«å™¨æ˜ç¡®æå‡ºäº†Lipschitzçº¦æŸï¼Œè€Œå®ç°æ–¹å¼ä¹‹ä¸€å°±æ˜¯åŸºäºè°±èŒƒæ•°çš„å½’ä¸€åŒ–ï¼›äºŒæ˜¯æœ‰ä¸€äº›å·¥ä½œè¡¨æ˜ï¼Œè°±èŒƒæ•°ä½œä¸ºæ­£åˆ™é¡¹ï¼Œç›¸æ¯”$F$èŒƒæ•°æ­£åˆ™æœ‰æ›´å¥½çš„æ€§èƒ½ã€‚</p>
<h2 id="_2">æ¢¯åº¦æ¨å¯¼</h2>
<p>ç°åœ¨è®©æˆ‘ä»¬è¿›å…¥æ­£é¢˜ï¼Œå°è¯•æ¨å¯¼è°±èŒƒæ•°çš„æ¢¯åº¦$\nabla_{\boldsymbol{W}} \Vert\boldsymbol{W}\Vert_2$ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œè°±èŒƒæ•°åœ¨æ•°å€¼ä¸Šç­‰äºå®ƒçš„æœ€å¤§å¥‡å¼‚å€¼ï¼Œå¯¹æ­¤æˆ‘ä»¬åœ¨<a href="/archives/10407">ã€Šä½ç§©è¿‘ä¼¼ä¹‹è·¯ï¼ˆäºŒï¼‰ï¼šSVDã€‹</a>çš„â€œ<a href="/archives/10407#%E7%9F%A9%E9%98%B5%E8%8C%83%E6%95%B0">çŸ©é˜µèŒƒæ•°</a>â€ä¸€èŠ‚æœ‰è¿‡è¯æ˜ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœ$\boldsymbol{W}$å¯ä»¥SVDä¸º$\sum\limits_{i=1}^{\min(n,m)}\sigma_i \boldsymbol{u}<em _min_n_m_="\min(n,m)">i\boldsymbol{v}_i^{\top}$ï¼Œé‚£ä¹ˆ<br />
\begin{equation}\Vert\boldsymbol{W}\Vert_2 = \sigma_1 = \boldsymbol{u}_1^{\top}\boldsymbol{W}\boldsymbol{v}_1\end{equation}<br />
å…¶ä¸­$\sigma_1 \geq \sigma_2 \geq \cdots \geq \sigma</em>$çš„å¥‡å¼‚å€¼ã€‚å¯¹ä¸¤è¾¹æ±‚å¾®åˆ†ï¼Œæˆ‘ä»¬å¾—åˆ°} \geq 0$æ˜¯$\boldsymbol{W<br />
\begin{equation}d\Vert\boldsymbol{W}\Vert_2 = d\boldsymbol{u}<em i="1">1^{\top}\boldsymbol{W}\boldsymbol{v}_1 + \boldsymbol{u}_1^{\top}d\boldsymbol{W}\boldsymbol{v}_1 + \boldsymbol{u}_1^{\top}\boldsymbol{W}d\boldsymbol{v}_1\end{equation}<br />
ç•™æ„åˆ°<br />
\begin{equation}d\boldsymbol{u}_1^{\top}\boldsymbol{W}\boldsymbol{v}_1 = d\boldsymbol{u}_1^{\top}\sum</em>}^{\min(n,m)}\sigma_i \boldsymbol{u<em _boldsymbol_W="\boldsymbol{W">i\boldsymbol{v}_i^{\top}\boldsymbol{v}_1 = d\boldsymbol{u}_1^{\top}\sigma_1 \boldsymbol{u}_1 = \frac{1}{2}\sigma_1 d(\Vert\boldsymbol{u}_1\Vert^2)=0\end{equation}<br />
åŒç†$\boldsymbol{u}_1^{\top}\boldsymbol{W}d\boldsymbol{v}_1=0$ï¼Œæ‰€ä»¥<br />
\begin{equation}d\Vert\boldsymbol{W}\Vert_2 = \boldsymbol{u}_1^{\top}d\boldsymbol{W}\boldsymbol{v}_1 = \text{Tr}((\boldsymbol{u}_1 \boldsymbol{v}_1^{\top})^{\top} d\boldsymbol{W}) \quad\Rightarrow\quad \nabla</em>}}\Vert\boldsymbol{W}\Vert_2 = \boldsymbol{u}_1 \boldsymbol{v}_1^{\top}\end{equation<br />
æ³¨æ„ï¼Œè¿™ä¸ªè¯æ˜è¿‡ç¨‹æœ‰ä¸€ä¸ªå…³é”®æ¡ä»¶æ˜¯$\sigma_1 &gt; \sigma_2$ï¼Œå› ä¸ºå¦‚æœ$\sigma_1=\sigma_2$çš„è¯ï¼Œ$\Vert\boldsymbol{W}\Vert_2$æ—¢å¯ä»¥è¡¨ç¤ºæˆ$\boldsymbol{u}_1^{\top}\boldsymbol{W}\boldsymbol{v}_1$åˆå¯ä»¥è¡¨ç¤ºæˆ$\boldsymbol{u}_2^{\top}\boldsymbol{W}\boldsymbol{v}_2$ï¼Œç”¨åŒæ ·æ–¹æ³•æ±‚å‡ºçš„æ¢¯åº¦åˆ†åˆ«æ˜¯$\boldsymbol{u}_1 \boldsymbol{v}_1^{\top}$å’Œ$\boldsymbol{u}_2 \boldsymbol{v}_2^{\top}$ï¼Œç»“æœä¸å”¯ä¸€æ„å‘³ç€æ¢¯åº¦ä¸å­˜åœ¨ã€‚å½“ç„¶ï¼Œä»å®è·µè§’åº¦çœ‹ï¼Œä¸¤ä¸ªæ•°å®Œå…¨ç›¸ç­‰çš„æ¦‚ç‡æ˜¯å¾ˆå°çš„ï¼Œå› æ­¤å¯ä»¥å¿½ç•¥è¿™ä¸€ç‚¹ã€‚</p>
<p>ï¼ˆæ³¨ï¼šè¿™é‡Œçš„è¯æ˜è¿‡ç¨‹å‚è€ƒäº†Stack Exchangeä¸Šçš„<a href="https://math.stackexchange.com/a/3000223">å›ç­”</a>ï¼Œä½†è¯¥å›ç­”é‡Œé¢æ²¡æœ‰è¯æ˜$d\boldsymbol{u}_1^{\top}\boldsymbol{W}\boldsymbol{v}_1=0$å’Œ$\boldsymbol{u}_1^{\top}\boldsymbol{W}d\boldsymbol{v}_1=0$ï¼Œè¿™éƒ¨åˆ†ç”±ç¬”è€…è¡¥å……å®Œæ•´ã€‚ï¼‰</p>
<h2 id="_3">æƒé‡è¡°å‡</h2>
<p>æ ¹æ®è¿™ä¸ªç»“æœä»¥åŠé“¾å¼æ³•åˆ™ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\nabla_{\boldsymbol{W}}\left(\frac{1}{2}\Vert\boldsymbol{W}\Vert_2^2\right) = \Vert\boldsymbol{W}\Vert_2\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_2 = \sigma_1 \boldsymbol{u}<em _boldsymbol_W="\boldsymbol{W">1 \boldsymbol{v}_1^{\top}\label{eq:grad-2-2}\end{equation}<br />
å¯¹æ¯”$F$èŒƒæ•°ä¸‹çš„ç»“æœï¼š<br />
\begin{equation}\nabla</em>}}\left(\frac{1}{2}\Vert\boldsymbol{W}\Vert_F^2\right) = \boldsymbol{W} = \sum_{i=1}^{\min(n,m)}\sigma_i \boldsymbol{u}_i \boldsymbol{v}_i^{\top}\end{equation<br />
è¿™æ ·å¯¹æ¯”ç€çœ‹å°±å¾ˆæ¸…æ™°äº†ï¼š$F$èŒƒæ•°å¹³æ–¹ä½œä¸ºæ­£åˆ™é¡¹æ‰€å¾—å‡ºçš„æƒé‡è¡°å‡ï¼ŒåŒæ—¶æƒ©ç½šå…¨ä½“å¥‡å¼‚å€¼ï¼›è€Œè°±èŒƒæ•°å¹³æ–¹å¯¹åº”çš„æƒé‡è¡°å‡ï¼Œåªæƒ©ç½šæœ€å¤§å¥‡å¼‚å€¼ã€‚å¦‚æœæˆ‘ä»¬ç›®çš„æ˜¯å‹ç¼©è¾“å‡ºçš„å¤§å°ï¼Œé‚£ä¹ˆå‹ç¼©æœ€å¤§å¥‡å¼‚å€¼æ˜¯â€œåˆšåˆšå¥½â€çš„åšæ³•ï¼Œå‹ç¼©å…¨ä½“å¥‡å¼‚å€¼è™½ç„¶å¯èƒ½è¾¾åˆ°ç›¸è¿‘çš„ç›®çš„ï¼Œä½†åŒæ—¶ä¹Ÿå¯èƒ½å‹ç¼©å‚æ•°çš„è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<p>æ ¹æ®â€œ<a href="/archives/10407#%E8%BF%91%E4%BC%BC%E5%AE%9A%E7%90%86">Eckart-Young-Mirskyå®šç†</a>â€ï¼Œå¼$\eqref{eq:grad-2-2}$æœ€å³ä¾§çš„ç»“æœè¿˜æœ‰ä¸€ä¸ªå«ä¹‰ï¼Œå°±æ˜¯$\boldsymbol{W}$çŸ©é˜µçš„â€œæœ€ä¼˜1ç§©è¿‘ä¼¼â€ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œè°±èŒƒæ•°çš„æƒé‡è¡°å‡å°†æ¯ä¸€æ­¥å‡å»å®ƒè‡ªèº«çš„æ“ä½œï¼Œæ”¹ä¸ºæ¯ä¸€æ­¥å‡å»å®ƒçš„æœ€ä¼˜1ç§©è¿‘ä¼¼ï¼Œå¼±åŒ–äº†æƒ©ç½šåŠ›åº¦ï¼Œå½“ç„¶æŸç§ç¨‹åº¦ä¸Šä¹Ÿè®©æƒ©ç½šæ›´åŠ â€œç›´å‡»æœ¬è´¨â€ã€‚</p>
<h2 id="_4">æ•°å€¼è®¡ç®—</h2>
<p>å¯¹äºå®è·µæ¥è¯´ï¼Œæœ€å…³é”®çš„é—®é¢˜æ¥äº†ï¼šæ€ä¹ˆè®¡ç®—$\sigma_1 \boldsymbol{u}_1 \boldsymbol{v}_1^{\top}$å‘¢ï¼ŸSVDå½“ç„¶æ˜¯æœ€ç®€å•ç›´æ¥çš„æ–¹æ¡ˆï¼Œä½†è®¡ç®—å¤æ‚åº¦æ— ç–‘ä¹Ÿæ˜¯æœ€é«˜çš„ï¼Œæˆ‘ä»¬å¿…é¡»æ‰¾åˆ°æ›´é«˜æ•ˆçš„è®¡ç®—é€”å¾„ã€‚</p>
<p>ä¸å¤±ä¸€èˆ¬æ€§ï¼Œè®¾$n\geq m$ã€‚é¦–å…ˆæ³¨æ„åˆ°<br />
\begin{equation}\sigma_1 \boldsymbol{u}<em i="1">1 \boldsymbol{v}_1^{\top} = \sum</em>}^m\sigma_i \boldsymbol{u}_i \boldsymbol{v}_i^{\top} \boldsymbol{v}_1 \boldsymbol{v}_1^{\top} = \boldsymbol{W}\boldsymbol{v}_1 \boldsymbol{v}_1^{\top}\end{equation<br />
ç”±æ­¤å¯è§è®¡ç®—$\sigma_1 \boldsymbol{u}_1 \boldsymbol{v}_1^{\top}$åªéœ€è¦çŸ¥é“$\boldsymbol{v}_1$ï¼Œç„¶åæ ¹æ®æˆ‘ä»¬åœ¨<a href="/archives/10407#%E5%A5%87%E5%BC%82%E5%88%86%E8%A7%A3">ã€Šä½ç§©è¿‘ä¼¼ä¹‹è·¯ï¼ˆäºŒï¼‰ï¼šSVDã€‹</a>ä¸­çš„è®¨è®ºï¼Œ$\boldsymbol{v}_1$å®é™…ä¸Šæ˜¯çŸ©é˜µ$\boldsymbol{W}^{\top}\boldsymbol{W}$çš„æœ€å¤§ç‰¹å¾å€¼å¯¹åº”çš„ç‰¹å¾å‘é‡ã€‚è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬ä¾¿å°†é—®é¢˜ä»ä¸€èˆ¬çŸ©é˜µ$\boldsymbol{W}$çš„SVDè½¬åŒ–æˆäº†å®å¯¹ç§°çŸ©é˜µ$\boldsymbol{W}^{\top}\boldsymbol{W}$çš„ç‰¹å¾å€¼åˆ†è§£ï¼Œè¿™å…¶å®å·²ç»é™ä½å¤æ‚åº¦äº†ï¼Œå› ä¸ºç‰¹å¾å€¼åˆ†è§£é€šå¸¸è¦æ¯”SVDæ˜æ˜¾å¿«ã€‚</p>
<p>å¦‚æœè¿˜è§‰å¾—æ…¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦è¯·å‡ºå¾ˆå¤šç‰¹å¾å€¼åˆ†è§£ç®—æ³•èƒŒåçš„åŸç†â€”â€”â€œ<a href="https://en.wikipedia.org/wiki/Power_iteration">å¹‚è¿­ä»£ï¼ˆPower Iterationï¼‰</a>â€ï¼š</p>
<blockquote>
<p>å½“$\sigma_1 &gt; \sigma_2$æ—¶ï¼Œè¿­ä»£ \begin{equation}\boldsymbol{x}_{t+1} = \frac{\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{x}_t}{\Vert\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{x}_t\Vert}\end{equation} ä»¥$(\sigma_2/\sigma_1)^{2t}$çš„é€Ÿåº¦æ”¶æ•›è‡³$\boldsymbol{v}_1$ã€‚</p>
</blockquote>
<p>å¹‚è¿­ä»£æ¯æ­¥åªéœ€è¦ç®—ä¸¤æ¬¡â€œçŸ©é˜µ-å‘é‡â€ä¹˜æ³•ï¼Œå¤æ‚åº¦æ˜¯$\mathcal{O}(nm)$ï¼Œ$t$æ­¥è¿­ä»£çš„æ€»å¤æ‚åº¦æ˜¯$\mathcal{O}(tnm)$ï¼Œéå¸¸ç†æƒ³ï¼Œç¼ºç‚¹æ˜¯$\sigma_1,\sigma_2$æ¥è¿‘æ—¶æ”¶æ•›ä¼šæ¯”è¾ƒæ…¢ã€‚ä½†å¹‚è¿­ä»£çš„å®é™…è¡¨ç°å¾€å¾€æ¯”ç†è®ºæƒ³è±¡æ›´å¥½ç”¨ï¼Œæ—©æœŸå¾ˆå¤šå·¥ä½œç”šè‡³åªè¿­ä»£ä¸€æ¬¡å°±å¾—åˆ°ä¸é”™çš„æ•ˆæœï¼Œå› ä¸º$\sigma_1,\sigma_2$æ¥è¿‘è¡¨æ˜ä¸¤è€…åŠå…¶ç‰¹å¾å‘é‡ä¸€å®šç¨‹åº¦ä¸Šå¯æ›¿æ¢ï¼Œè€Œå¹‚è¿­ä»£å³ä¾¿æ²¡å®Œå…¨æ”¶æ•›ï¼Œå¾—åˆ°çš„ä¹Ÿæ˜¯ä¸¤è€…ç‰¹å¾å‘é‡çš„ä¸€ä¸ªå¹³å‡ï¼Œè¿™ä¹Ÿå®Œå…¨å¤Ÿç”¨äº†ã€‚</p>
<h2 id="_5">è¿­ä»£è¯æ˜</h2>
<p>è¿™ä¸€èŠ‚æˆ‘ä»¬æ¥å®Œæˆå¹‚è¿­ä»£çš„è¯æ˜ã€‚ä¸éš¾çœ‹å‡ºï¼Œå¹‚è¿­ä»£å¯ä»¥ç­‰ä»·åœ°å†™æˆ<br />
\begin{equation}\lim_{t\to\infty} \frac{(\boldsymbol{W}^{\top}\boldsymbol{W})^t \boldsymbol{x}<em i="1">0}{\Vert(\boldsymbol{W}^{\top}\boldsymbol{W})^t \boldsymbol{x}_0\Vert} = \boldsymbol{v}_1\end{equation}<br />
ä¸ºäº†è¯æ˜è¿™ä¸ªæé™ï¼Œæˆ‘ä»¬ä»$\boldsymbol{W}=\sum\limits</em>}^m\sigma_i \boldsymbol{u<em i="1">i\boldsymbol{v}_i^{\top}$å‡ºå‘ï¼Œä»£å…¥è®¡ç®—å¯å¾—<br />
\begin{equation}\boldsymbol{W}^{\top}\boldsymbol{W} = \sum</em>}^m\sigma_i^2 \boldsymbol{v<em i="1">i\boldsymbol{v}_i^{\top},\qquad(\boldsymbol{W}^{\top}\boldsymbol{W})^t = \sum</em>}^m\sigma_i^{2t} \boldsymbol{v<em j="1">i\boldsymbol{v}_i^{\top}\end{equation}<br />
ç”±äº$\boldsymbol{v}_1,\boldsymbol{v}_2,\cdots,\boldsymbol{v}_m$æ˜¯$\mathbb{R}^m$çš„ä¸€ç»„æ ‡å‡†æ­£äº¤åŸºï¼Œæ‰€ä»¥$\boldsymbol{x}_0$å¯ä»¥å†™æˆ$\sum\limits</em>}^m c_j \boldsymbol{v<em i="1">j$ï¼Œäºæ˜¯æˆ‘ä»¬æœ‰<br />
\begin{equation}(\boldsymbol{W}^{\top}\boldsymbol{W})^t \boldsymbol{x}_0 = \sum</em>}^m\sigma_i^{2t} \boldsymbol{v<em j="1">i\boldsymbol{v}_i^{\top}\sum</em>}^m c_j \boldsymbol{v<em i="1">j = \sum</em>}^m\sum_{j=1}^m c_j\sigma_i^{2t} \boldsymbol{v<em>i\underbrace{\boldsymbol{v}_i^{\top} \boldsymbol{v}_j}</em>}} = \sum_{i=1}^m c_i\sigma_i^{2t} \boldsymbol{v<em i="1">i\end{equation}<br />
ä»¥åŠ<br />
\begin{equation}\Vert(\boldsymbol{W}^{\top}\boldsymbol{W})^t \boldsymbol{x}_0\Vert = \left\Vert \sum</em>}^m c_i\sigma_i^{2t} \boldsymbol{v<em i="1">i\right\Vert = \sqrt{\sum</em>}^m c_i^2\sigma_i^{4t}}\end{equation<br />
ç”±äºéšæœºåˆå§‹åŒ–çš„ç¼˜æ•…ï¼Œ$c_1=0$çš„æ¦‚ç‡æ˜¯éå¸¸å°çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥è®¤ä¸º$c_1\neq 0$ï¼Œé‚£ä¹ˆ<br />
\begin{equation}\frac{(\boldsymbol{W}^{\top}\boldsymbol{W})^t \boldsymbol{x}<em i="1">0}{\Vert(\boldsymbol{W}^{\top}\boldsymbol{W})^t \boldsymbol{x}_0\Vert} = \frac{\sum\limits</em>}^m c_i\sigma_i^{2t} \boldsymbol{v<em i="1">i}{\sqrt{\sum\limits</em>}^m c_i^2\sigma_i^{4t}}} = \frac{\boldsymbol{v<em i="2">1 + \sum\limits</em>}^m (c_i/c_1)(\sigma_i/\sigma_1)^{2t} \boldsymbol{v<em i="2">i}{\sqrt{1 + \sum\limits</em>}^m (c_i/c_1)^2(\sigma_i/\sigma_1)^{4t}}}\end{equation<br />
å½“$\sigma_1 &gt; \sigma_2$æ—¶ï¼Œæ‰€æœ‰çš„$\sigma_i/\sigma_1(i\geq 2)$éƒ½å°äº1ï¼Œå› æ­¤å½“$t\to \infty$æ—¶å¯¹åº”é¡¹éƒ½å˜æˆäº†0ï¼Œæœ€åçš„æé™æ˜¯$\boldsymbol{v}_1$ã€‚</p>
<h2 id="_6">ç›¸å…³å·¥ä½œ</h2>
<p>æœ€æ—©æå‡ºè°±èŒƒæ•°æ­£åˆ™çš„è®ºæ–‡ï¼Œåº”è¯¥æ˜¯2017å¹´çš„<a href="https://papers.cool/arxiv/1705.10941">ã€ŠSpectral Norm Regularization for Improving the Generalizability of Deep Learningã€‹</a>ï¼Œé‡Œè¾¹å¯¹æ¯”äº†æƒé‡è¡°å‡ã€å¯¹æŠ—è®­ç»ƒã€è°±èŒƒæ•°æ­£åˆ™ç­‰æ–¹æ³•ï¼Œå‘ç°è°±èŒƒæ•°æ­£åˆ™åœ¨æ³›åŒ–æ€§èƒ½æ–¹é¢è¡¨ç°æœ€å¥½ã€‚</p>
<p>è®ºæ–‡å½“æ—¶çš„åšæ³•ï¼Œå¹¶ä¸æ˜¯åƒæœ¬æ–‡ä¸€æ ·æ±‚å‡º$\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_2^2 = 2\sigma_1\boldsymbol{u}_1 \boldsymbol{v}_1^{\top}$ï¼Œè€Œæ˜¯ç›´æ¥é€šè¿‡å¹‚è¿­ä»£æ¥ä¼°è®¡$\Vert\boldsymbol{W}\Vert_2$ï¼Œç„¶åå°†$\Vert\boldsymbol{W}\Vert_2^2$åŠ æƒåˆ°æŸå¤±å‡½æ•°ä¸­ï¼Œè®©ä¼˜åŒ–å™¨è‡ªå·±å»æ±‚æ¢¯åº¦ï¼Œè¿™æ ·åšæ•ˆç‡ä¸Šç¨å·®ä¸€äº›ï¼Œå¹¶ä¸”ä¹Ÿä¸å¥½ä»¥æƒé‡è¡°å‡çš„å½¢å¼è·Ÿä¼˜åŒ–å™¨è§£è€¦å¼€æ¥ã€‚æœ¬æ–‡çš„åšæ³•ç›¸å¯¹æ¥è¯´æ›´åŠ çµæ´»ä¸€äº›ï¼Œå…è®¸æˆ‘ä»¬åƒAdamWä¸€æ ·ï¼Œå°†æƒé‡è¡°å‡ç‹¬ç«‹äºä¸»æŸå¤±å‡½æ•°çš„ä¼˜åŒ–ä¹‹å¤–ã€‚</p>
<p>å½“ç„¶ï¼Œä»ä»Šå¤©LLMçš„è§†è§’æ¥çœ‹ï¼Œå½“åˆçš„è¿™äº›å®éªŒæœ€å¤§é—®é¢˜å°±æ˜¯è§„æ¨¡éƒ½å¤ªå°äº†ï¼Œå¾ˆéš¾æœ‰è¶³å¤Ÿçš„è¯´æœåŠ›ï¼Œä¸è¿‡é‰´äºè°±èŒƒæ•°çš„Muonä¼˜åŒ–å™¨â€œç ç‰åœ¨å‰â€ï¼Œç¬”è€…è®¤ä¸ºè¿˜æ˜¯å€¼å¾—é‡æ–°æ€è€ƒå’Œå°è¯•ä¸€ä¸‹è°±èŒƒæ•°æƒé‡è¡°å‡ã€‚å½“ç„¶ï¼Œä¸ç®¡æ˜¯$F$èŒƒæ•°è¿˜æ˜¯è°±èŒƒæ•°çš„æƒé‡è¡°å‡ï¼Œè¿™äº›é¢å‘â€œæ³›åŒ–â€çš„æŠ€æœ¯å¾€å¾€ä¹Ÿæœ‰ä¸€äº›è¿æ°”æˆä»½åœ¨é‡Œè¾¹ï¼Œå¤§å®¶å¹³å¸¸å¿ƒæœŸå¾…å°±å¥½ã€‚</p>
<p>ä¸ªäººåœ¨è¯­è¨€æ¨¡å‹çš„åˆæ­¥å®éªŒç»“æœæ˜¾ç¤ºï¼ŒLosså±‚é¢å¯èƒ½ä¼šæœ‰å¾®å¼±çš„æå‡ï¼ˆå¸Œæœ›ä¸æ˜¯å¹»è§‰ï¼Œå½“ç„¶å†ä¸æµä¹Ÿæ²¡æœ‰å‡ºç°å˜å·®çš„ç°è±¡ï¼‰ã€‚å®éªŒè¿‡ç¨‹å°±æ˜¯ç”¨å¹‚è¿­ä»£æ±‚å‡º$\boldsymbol{v}_1$çš„è¿‘ä¼¼å€¼ï¼ˆåˆå§‹åŒ–ä¸ºå…¨ä¸€å‘é‡ï¼Œè¿­ä»£10æ¬¡ï¼‰ï¼Œç„¶åå°†åŸæ¥çš„æƒé‡è¡°å‡$-\lambda \boldsymbol{W}$æ”¹ä¸º$-\lambda \boldsymbol{W}\boldsymbol{v}_1\boldsymbol{v}_1^{\top}$ï¼Œ$\lambda$çš„å–å€¼ä¸åšæ”¹å˜ã€‚</p>
<h2 id="_7">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡æ¨å¯¼äº†è°±èŒƒæ•°çš„æ¢¯åº¦ï¼Œç”±æ­¤å¯¼å‡ºäº†ä¸€ç§æ–°çš„æƒé‡è¡°å‡ï¼Œå¹¶åˆ†äº«äº†ç¬”è€…å¯¹å®ƒçš„æ€è€ƒã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10648">https://spaces.ac.cn/archives/10648</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Dec. 25, 2024). ã€Šä»è°±èŒƒæ•°æ¢¯åº¦åˆ°æ–°å¼æƒé‡è¡°å‡çš„æ€è€ƒ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10648">https://spaces.ac.cn/archives/10648</a></p>
<p>@online{kexuefm-10648,<br />
title={ä»è°±èŒƒæ•°æ¢¯åº¦åˆ°æ–°å¼æƒé‡è¡°å‡çš„æ€è€ƒ},<br />
author={è‹å‰‘æ—},<br />
year={2024},<br />
month={Dec},<br />
url={\url{https://spaces.ac.cn/archives/10648}},<br />
} </p>
<hr />
<h2 id="_8">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚å°†ä»å¤šä¸ªè§’åº¦æ·±å…¥æ¨å¯¼è°±èŒƒæ•°åŠå…¶åœ¨ä¼˜åŒ–ä¸­çš„åº”ç”¨ï¼ŒåŒ…æ‹¬çŸ©é˜µç†è®ºåŸºç¡€ã€ä¼˜åŒ–ç†è®ºåˆ†æã€æ³›åŒ–ç†è®ºä»¥åŠå®é™…åº”ç”¨ã€‚</p>
<h3 id="1">1. è°±èŒƒæ•°çš„å®šä¹‰ä¸æ€§è´¨</h3>
<h4 id="11">1.1 å¤šç§ç­‰ä»·å®šä¹‰</h4>
<p>è°±èŒƒæ•°æœ‰å¤šç§ç­‰ä»·çš„å®šä¹‰æ–¹å¼ï¼Œæ¯ç§å®šä¹‰éƒ½æ­ç¤ºäº†å…¶ä¸åŒçš„å‡ ä½•æˆ–ä»£æ•°æ„ä¹‰ã€‚</p>
<p><strong>å®šä¹‰1ï¼ˆç®—å­èŒƒæ•°ï¼‰</strong>ï¼šå¯¹äºçŸ©é˜µ$\boldsymbol{W}\in\mathbb{R}^{n\times m}$ï¼Œ
$$\Vert\boldsymbol{W}\Vert_2 = \max_{\boldsymbol{x}\in\mathbb{R}^m,\Vert\boldsymbol{x}\Vert_2=1} \Vert\boldsymbol{W}\boldsymbol{x}\Vert_2$$</p>
<p><strong>å®šä¹‰2ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰</strong>ï¼šè®¾$\boldsymbol{W}$çš„SVDä¸º$\boldsymbol{W}=\boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ï¼Œåˆ™
$$\Vert\boldsymbol{W}\Vert_2 = \sigma_{\max}(\boldsymbol{W}) = \sigma_1$$</p>
<p><strong>å®šä¹‰3ï¼ˆè°±åŠå¾„å½¢å¼ï¼‰</strong>ï¼š
$$\Vert\boldsymbol{W}\Vert_2 = \sqrt{\lambda_{\max}(\boldsymbol{W}^{\top}\boldsymbol{W})} = \sqrt{\lambda_{\max}(\boldsymbol{W}\boldsymbol{W}^{\top})}$$</p>
<p><strong>è¯æ˜å®šä¹‰ç­‰ä»·æ€§</strong>ï¼š</p>
<p>é¦–å…ˆè¯æ˜å®šä¹‰1ä¸å®šä¹‰2çš„ç­‰ä»·æ€§ã€‚è®¾$\boldsymbol{W}=\sum_{i=1}^{r}\sigma_i\boldsymbol{u}_i\boldsymbol{v}_i^{\top}$ï¼Œå…¶ä¸­$r=\text{rank}(\boldsymbol{W})$ï¼Œ$\sigma_1\geq\sigma_2\geq\cdots\geq\sigma_r&gt;0$ã€‚å¯¹äºä»»æ„å•ä½å‘é‡$\boldsymbol{x}$ï¼š
$$\Vert\boldsymbol{W}\boldsymbol{x}\Vert_2^2 = \left\Vert\sum_{i=1}^{r}\sigma_i\boldsymbol{u}_i(\boldsymbol{v}_i^{\top}\boldsymbol{x})\right\Vert_2^2 = \sum_{i=1}^{r}\sigma_i^2(\boldsymbol{v}_i^{\top}\boldsymbol{x})^2$$</p>
<p>ç”±äº${\boldsymbol{v}<em i="1">1,\ldots,\boldsymbol{v}_r}$æ˜¯æ ‡å‡†æ­£äº¤å‘é‡ï¼Œä¸”$\Vert\boldsymbol{x}\Vert_2=1$ï¼Œæˆ‘ä»¬æœ‰$\sum</em>)^2\leq 1$ã€‚å› æ­¤ï¼š
$$\Vert\boldsymbol{W}\boldsymbol{x}\Vert_2^2 = \sum_{i=1}^{r}\sigma_i^2(\boldsymbol{v}_i^{\top}\boldsymbol{x})^2 \leq \sigma_1^2\sum_{i=1}^{r}(\boldsymbol{v}_i^{\top}\boldsymbol{x})^2 \leq \sigma_1^2$$}^{r}(\boldsymbol{v}_i^{\top}\boldsymbol{x</p>
<p>ç­‰å·åœ¨$\boldsymbol{x}=\boldsymbol{v}<em _Vert_boldsymbol_x="\Vert\boldsymbol{x">1$æ—¶å–å¾—ï¼Œå› æ­¤$\max</em>\Vert_2 = \sigma_1$ã€‚}\Vert_2=1}\Vert\boldsymbol{W}\boldsymbol{x</p>
<p>æ¥ä¸‹æ¥è¯æ˜å®šä¹‰2ä¸å®šä¹‰3çš„ç­‰ä»·æ€§ã€‚æ³¨æ„åˆ°$\boldsymbol{W}^{\top}\boldsymbol{W}$çš„ç‰¹å¾å€¼ä¸º$\sigma_i^2(i=1,\ldots,r)$å’Œ$m-r$ä¸ªé›¶ã€‚å› æ­¤ï¼š
$$\lambda_{\max}(\boldsymbol{W}^{\top}\boldsymbol{W}) = \sigma_1^2 \quad\Rightarrow\quad \sqrt{\lambda_{\max}(\boldsymbol{W}^{\top}\boldsymbol{W})} = \sigma_1$$</p>
<h4 id="12">1.2 åŸºæœ¬æ€§è´¨</h4>
<p><strong>æ€§è´¨1ï¼ˆæ¬¡å¯ä¹˜æ€§ï¼‰</strong>ï¼šå¯¹äºç›¸å®¹ç»´åº¦çš„çŸ©é˜µ$\boldsymbol{A},\boldsymbol{B}$ï¼Œ
$$\Vert\boldsymbol{A}\boldsymbol{B}\Vert_2 \leq \Vert\boldsymbol{A}\Vert_2\Vert\boldsymbol{B}\Vert_2$$</p>
<p><strong>è¯æ˜</strong>ï¼šå¯¹äºä»»æ„å•ä½å‘é‡$\boldsymbol{x}$ï¼Œ
$$\Vert\boldsymbol{A}\boldsymbol{B}\boldsymbol{x}\Vert_2 \leq \Vert\boldsymbol{A}\Vert_2\Vert\boldsymbol{B}\boldsymbol{x}\Vert_2 \leq \Vert\boldsymbol{A}\Vert_2\Vert\boldsymbol{B}\Vert_2\Vert\boldsymbol{x}\Vert_2 = \Vert\boldsymbol{A}\Vert_2\Vert\boldsymbol{B}\Vert_2$$</p>
<p>å¯¹$\boldsymbol{x}$å–æœ€å¤§å€¼å³å¾—ç»“è®ºã€‚</p>
<p><strong>æ€§è´¨2ï¼ˆé…‰ä¸å˜æ€§ï¼‰</strong>ï¼šå¯¹äºé…‰çŸ©é˜µ$\boldsymbol{U},\boldsymbol{V}$ï¼ˆæ»¡è¶³$\boldsymbol{U}^{\top}\boldsymbol{U}=\boldsymbol{I},\boldsymbol{V}^{\top}\boldsymbol{V}=\boldsymbol{I}$ï¼‰ï¼Œ
$$\Vert\boldsymbol{U}\boldsymbol{W}\boldsymbol{V}\Vert_2 = \Vert\boldsymbol{W}\Vert_2$$</p>
<p><strong>è¯æ˜</strong>ï¼šç”±äºé…‰çŸ©é˜µçš„è°±èŒƒæ•°ä¸º1ï¼ˆ$\Vert\boldsymbol{U}\Vert_2=\Vert\boldsymbol{V}\Vert_2=1$ï¼‰ï¼Œä¸”$\Vert\boldsymbol{U}^{-1}\Vert_2=\Vert\boldsymbol{U}^{\top}\Vert_2=1$ï¼Œåˆ©ç”¨æ¬¡å¯ä¹˜æ€§ï¼š
$$\Vert\boldsymbol{U}\boldsymbol{W}\boldsymbol{V}\Vert_2 \leq \Vert\boldsymbol{U}\Vert_2\Vert\boldsymbol{W}\Vert_2\Vert\boldsymbol{V}\Vert_2 = \Vert\boldsymbol{W}\Vert_2$$
$$\Vert\boldsymbol{W}\Vert_2 = \Vert\boldsymbol{U}^{\top}(\boldsymbol{U}\boldsymbol{W}\boldsymbol{V})\boldsymbol{V}^{\top}\Vert_2 \leq \Vert\boldsymbol{U}\boldsymbol{W}\boldsymbol{V}\Vert_2$$</p>
<p>ä¸¤è¾¹å¤¹å®šå¾—$\Vert\boldsymbol{U}\boldsymbol{W}\boldsymbol{V}\Vert_2 = \Vert\boldsymbol{W}\Vert_2$ã€‚</p>
<p><strong>æ€§è´¨3ï¼ˆä¸FrobeniusèŒƒæ•°çš„å…³ç³»ï¼‰</strong>ï¼š
$$\Vert\boldsymbol{W}\Vert_2 \leq \Vert\boldsymbol{W}\Vert_F \leq \sqrt{r}\Vert\boldsymbol{W}\Vert_2$$</p>
<p>å…¶ä¸­$r=\text{rank}(\boldsymbol{W})$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šç”±äº$\Vert\boldsymbol{W}\Vert_F^2 = \sum_{i=1}^{r}\sigma_i^2$ä¸”$\sigma_1\geq\sigma_i$å¯¹æ‰€æœ‰$i$æˆç«‹ï¼Œ
$$\Vert\boldsymbol{W}\Vert_F^2 = \sum_{i=1}^{r}\sigma_i^2 \leq r\sigma_1^2 = r\Vert\boldsymbol{W}\Vert_2^2$$</p>
<p>å¦ä¸€æ–¹é¢ï¼Œ$\sigma_1^2\leq\sum_{i=1}^{r}\sigma_i^2$ï¼Œå› æ­¤$\Vert\boldsymbol{W}\Vert_2\leq\Vert\boldsymbol{W}\Vert_F$ã€‚</p>
<h3 id="2">2. è°±èŒƒæ•°æ¢¯åº¦çš„å®Œæ•´æ¨å¯¼</h3>
<h4 id="21">2.1 åŸºäºå˜åˆ†æ–¹æ³•çš„æ¨å¯¼</h4>
<p>è€ƒè™‘ä¼˜åŒ–é—®é¢˜ï¼š
$$\Vert\boldsymbol{W}\Vert_2 = \max_{\Vert\boldsymbol{x}\Vert_2=1} \Vert\boldsymbol{W}\boldsymbol{x}\Vert_2 = \max_{\Vert\boldsymbol{x}\Vert_2=1} \sqrt{\boldsymbol{x}^{\top}\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{x}}$$</p>
<p>ç­‰ä»·åœ°ï¼ˆå¹³æ–¹åï¼‰ï¼š
$$\Vert\boldsymbol{W}\Vert_2^2 = \max_{\Vert\boldsymbol{x}\Vert_2=1} \boldsymbol{x}^{\top}\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{x}$$</p>
<p>è®¾æœ€ä¼˜è§£ä¸º$\boldsymbol{x}^*=\boldsymbol{v}_1$ï¼Œåˆ™$\Vert\boldsymbol{W}\Vert_2^2 = \boldsymbol{v}_1^{\top}\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{v}_1 = \sigma_1^2$ã€‚</p>
<p>ä½¿ç”¨åŒ…ç»œå®šç†ï¼ˆEnvelope Theoremï¼‰ï¼Œå¯¹äºå‚æ•°åŒ–çš„ä¼˜åŒ–é—®é¢˜$f(\boldsymbol{W})=\max_{\boldsymbol{x}\in\mathcal{X}(\boldsymbol{W})}g(\boldsymbol{x},\boldsymbol{W})$ï¼Œå…¶æ¢¯åº¦ä¸ºï¼š
$$\nabla_{\boldsymbol{W}}f(\boldsymbol{W}) = \nabla_{\boldsymbol{W}}g(\boldsymbol{x}^*(\boldsymbol{W}),\boldsymbol{W})\Big|_{\boldsymbol{x}^*=\boldsymbol{v}_1}$$</p>
<p>è¿™é‡Œ$g(\boldsymbol{x},\boldsymbol{W})=\boldsymbol{x}^{\top}\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{x}$ï¼Œå› æ­¤ï¼š
$$\nabla_{\boldsymbol{W}}(\boldsymbol{v}_1^{\top}\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{v}_1) = 2\boldsymbol{W}\boldsymbol{v}_1\boldsymbol{v}_1^{\top}$$</p>
<p>è€Œ$\boldsymbol{W}\boldsymbol{v}_1 = \sigma_1\boldsymbol{u}_1$ï¼Œæ‰€ä»¥ï¼š
$$\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_2^2 = 2\sigma_1\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$$</p>
<p>ä»è€Œï¼š
$$\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_2 = \frac{1}{2\sigma_1}\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_2^2 = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}$$</p>
<h4 id="22">2.2 åŸºäºçŸ©é˜µå¾®åˆ†çš„è¯¦ç»†æ¨å¯¼</h4>
<p>è€ƒè™‘å‡½æ•°$f(\boldsymbol{W})=\Vert\boldsymbol{W}\Vert_2=\sigma_1$ã€‚åˆ©ç”¨SVDï¼Œ$\sigma_1 = \boldsymbol{u}_1^{\top}\boldsymbol{W}\boldsymbol{v}_1$ã€‚å¯¹$\boldsymbol{W}$æ±‚å¾®åˆ†ï¼š
$$d\sigma_1 = d(\boldsymbol{u}_1^{\top}\boldsymbol{W}\boldsymbol{v}_1) = (d\boldsymbol{u}_1)^{\top}\boldsymbol{W}\boldsymbol{v}_1 + \boldsymbol{u}_1^{\top}(d\boldsymbol{W})\boldsymbol{v}_1 + \boldsymbol{u}_1^{\top}\boldsymbol{W}(d\boldsymbol{v}_1)$$</p>
<p><strong>å…³é”®å¼•ç†</strong>ï¼šåœ¨$\sigma_1&gt;\sigma_2$çš„å‡è®¾ä¸‹ï¼Œ$(d\boldsymbol{u}_1)^{\top}\boldsymbol{W}\boldsymbol{v}_1=0$ä¸”$\boldsymbol{u}_1^{\top}\boldsymbol{W}(d\boldsymbol{v}_1)=0$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šç”±äº$\boldsymbol{v}_1$æ˜¯$\boldsymbol{W}^{\top}\boldsymbol{W}$å¯¹åº”äºç‰¹å¾å€¼$\sigma_1^2$çš„å•ä½ç‰¹å¾å‘é‡ï¼Œæ»¡è¶³ï¼š
$$\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{v}_1 = \sigma_1^2\boldsymbol{v}_1,\quad \boldsymbol{v}_1^{\top}\boldsymbol{v}_1=1$$</p>
<p>å¯¹ç¬¬ä¸€å¼æ±‚å¾®åˆ†ï¼š
$$d(\boldsymbol{W}^{\top}\boldsymbol{W})\boldsymbol{v}_1 + \boldsymbol{W}^{\top}\boldsymbol{W}(d\boldsymbol{v}_1) = 2\sigma_1(d\sigma_1)\boldsymbol{v}_1 + \sigma_1^2(d\boldsymbol{v}_1)$$</p>
<p>å³ï¼š
$$(d\boldsymbol{W})^{\top}\boldsymbol{W}\boldsymbol{v}_1 + \boldsymbol{W}^{\top}(d\boldsymbol{W})\boldsymbol{v}_1 + \boldsymbol{W}^{\top}\boldsymbol{W}(d\boldsymbol{v}_1) = 2\sigma_1(d\sigma_1)\boldsymbol{v}_1 + \sigma_1^2(d\boldsymbol{v}_1)$$</p>
<p>æ³¨æ„åˆ°$\boldsymbol{W}\boldsymbol{v}_1=\sigma_1\boldsymbol{u}_1$ï¼Œä¸Šå¼å·¦è¾¹ç¬¬ä¸€é¡¹ä¸ºï¼š
$$(d\boldsymbol{W})^{\top}\sigma_1\boldsymbol{u}_1 = \sigma_1\boldsymbol{u}_1^{\top}(d\boldsymbol{W})$$</p>
<p>å¯¹ç¬¬äºŒå¼$\boldsymbol{v}_1^{\top}\boldsymbol{v}_1=1$æ±‚å¾®åˆ†ï¼š
$$2\boldsymbol{v}_1^{\top}(d\boldsymbol{v}_1) = 0 \quad\Rightarrow\quad (d\boldsymbol{v}_1) \perp \boldsymbol{v}_1$$</p>
<p>ç±»ä¼¼åœ°ï¼Œ$\boldsymbol{u}_1^{\top}(d\boldsymbol{u}_1)=0$ã€‚</p>
<p>ç”¨$\boldsymbol{u}_1^{\top}$å·¦ä¹˜$\boldsymbol{W}\boldsymbol{v}_1=\sigma_1\boldsymbol{u}_1$å¹¶æ±‚å¾®åˆ†ï¼š
$$\boldsymbol{u}_1^{\top}(d\boldsymbol{W})\boldsymbol{v}_1 + \boldsymbol{u}_1^{\top}\boldsymbol{W}(d\boldsymbol{v}_1) + (d\boldsymbol{u}_1)^{\top}\boldsymbol{W}\boldsymbol{v}_1 = (d\sigma_1)\boldsymbol{u}_1^{\top}\boldsymbol{u}_1 + \sigma_1(d\boldsymbol{u}_1)^{\top}\boldsymbol{u}_1$$</p>
<p>æœ€å³ä¾§åˆ©ç”¨$\boldsymbol{u}_1^{\top}(d\boldsymbol{u}_1)=0$å¾—åˆ°$(d\sigma_1)$ã€‚</p>
<p>ç°åœ¨è®¡ç®—$(d\boldsymbol{u}<em i="1">1)^{\top}\boldsymbol{W}\boldsymbol{v}_1$ã€‚ç”±$\boldsymbol{W}=\sum</em>$ï¼š
$$(d\boldsymbol{u}_1)^{\top}\boldsymbol{W}\boldsymbol{v}_1 = (d\boldsymbol{u}_1)^{\top}\left(\sum_{i=1}^{r}\sigma_i\boldsymbol{u}_i\boldsymbol{v}_i^{\top}\right)\boldsymbol{v}_1 = (d\boldsymbol{u}_1)^{\top}\sigma_1\boldsymbol{u}_1 = \sigma_1\boldsymbol{u}_1^{\top}(d\boldsymbol{u}_1) = 0$$}^{r}\sigma_i\boldsymbol{u}_i\boldsymbol{v}_i^{\top</p>
<p>ç±»ä¼¼åœ°ï¼Œ$\boldsymbol{u}_1^{\top}\boldsymbol{W}(d\boldsymbol{v}_1)=\sigma_1\boldsymbol{v}_1^{\top}(d\boldsymbol{v}_1)=0$ã€‚</p>
<p>å› æ­¤ï¼š
$$d\sigma_1 = \boldsymbol{u}_1^{\top}(d\boldsymbol{W})\boldsymbol{v}_1 = \text{Tr}(\boldsymbol{u}_1^{\top}(d\boldsymbol{W})\boldsymbol{v}_1) = \text{Tr}(\boldsymbol{v}_1\boldsymbol{u}_1^{\top}d\boldsymbol{W}) = \text{Tr}((\boldsymbol{u}_1\boldsymbol{v}_1^{\top})^{\top}d\boldsymbol{W})$$</p>
<p>æ ¹æ®å¾®åˆ†ä¸æ¢¯åº¦çš„å…³ç³»$df=\text{Tr}((\nabla f)^{\top}dX)$ï¼Œå¾—ï¼š
$$\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_2 = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}$$</p>
<h4 id="23-sigma_1sigma_2">2.3 æ¬¡å¾®åˆ†è§†è§’ï¼ˆå½“$\sigma_1=\sigma_2$æ—¶ï¼‰</h4>
<p>å½“$\sigma_1=\sigma_2=\cdots=\sigma_k&gt;\sigma_{k+1}$æ—¶ï¼Œè°±èŒƒæ•°åœ¨è¯¥ç‚¹ä¸å¯å¾®ï¼Œä½†å­˜åœ¨æ¬¡å¾®åˆ†ï¼ˆsubdifferentialï¼‰ï¼š
$$\partial\Vert\boldsymbol{W}\Vert_2 = \text{conv}\left\{\boldsymbol{u}_i\boldsymbol{v}_j^{\top} : 1\leq i,j\leq k\right\}$$</p>
<p>å³æ‰€æœ‰å½¢å¦‚$\sum_{i,j=1}^{k}\alpha_{ij}\boldsymbol{u}<em ij="ij">i\boldsymbol{v}_j^{\top}$çš„çŸ©é˜µï¼Œå…¶ä¸­$\alpha</em>=1$ã€‚}\geq 0$ï¼Œ$\sum_{i,j}\alpha_{ij</p>
<p>å®è·µä¸­é‡åˆ°é‡å¥‡å¼‚å€¼çš„æ¦‚ç‡ä¸ºé›¶ï¼ˆæµ®ç‚¹æ•°é›†åˆçš„æµ‹åº¦ä¸ºé›¶ï¼‰ï¼Œå› æ­¤å¯ä»¥å¿½ç•¥è¿™ä¸€é€€åŒ–æƒ…å†µã€‚</p>
<h3 id="3-frobenius">3. ä¸FrobeniusèŒƒæ•°çš„æ·±å…¥å¯¹æ¯”</h3>
<h4 id="31">3.1 æ¢¯åº¦ç»“æ„çš„å‡ ä½•æ„ä¹‰</h4>
<p><strong>FrobeniusèŒƒæ•°</strong>ï¼š
$$\Vert\boldsymbol{W}\Vert_F^2 = \sum_{i=1}^{r}\sigma_i^2 \quad\Rightarrow\quad \nabla_{\boldsymbol{W}}\left(\frac{1}{2}\Vert\boldsymbol{W}\Vert_F^2\right) = \boldsymbol{W} = \sum_{i=1}^{r}\sigma_i\boldsymbol{u}_i\boldsymbol{v}_i^{\top}$$</p>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>å…¨ç§©</strong>çš„æ¢¯åº¦ï¼ˆå‡è®¾$\boldsymbol{W}$æ»¡ç§©ï¼‰ï¼ŒåŒ…å«æ‰€æœ‰å¥‡å¼‚æ–¹å‘çš„ä¿¡æ¯ã€‚</p>
<p><strong>è°±èŒƒæ•°</strong>ï¼š
$$\Vert\boldsymbol{W}\Vert_2^2 = \sigma_1^2 \quad\Rightarrow\quad \nabla_{\boldsymbol{W}}\left(\frac{1}{2}\Vert\boldsymbol{W}\Vert_2^2\right) = \sigma_1\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$$</p>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>ç§©1</strong>çš„æ¢¯åº¦ï¼Œåªé’ˆå¯¹æœ€å¤§å¥‡å¼‚å€¼æ–¹å‘ã€‚</p>
<p><strong>å‡ ä½•è§£é‡Š</strong>ï¼š
- FrobeniusèŒƒæ•°æƒé‡è¡°å‡ï¼š$\boldsymbol{W}\leftarrow\boldsymbol{W}-\eta\lambda\boldsymbol{W}=(1-\eta\lambda)\boldsymbol{W}$ï¼Œå¯¹æ‰€æœ‰å¥‡å¼‚å€¼è¿›è¡Œ<strong>ç­‰æ¯”ä¾‹ç¼©æ”¾</strong>ã€‚
- è°±èŒƒæ•°æƒé‡è¡°å‡ï¼š$\boldsymbol{W}\leftarrow\boldsymbol{W}-\eta\lambda\sigma_1\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$ï¼Œ<strong>é€‰æ‹©æ€§åœ°</strong>å‡å°æœ€å¤§å¥‡å¼‚å€¼ã€‚</p>
<h4 id="32">3.2 æ•ˆç‡å¯¹æ¯”</h4>
<p>è®¡ç®—$\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_F^2$ï¼šç›´æ¥è¿”å›$\boldsymbol{W}$ï¼Œå¤æ‚åº¦$\mathcal{O}(1)$ã€‚</p>
<p>è®¡ç®—$\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_2^2$ï¼šéœ€è¦æ±‚$\boldsymbol{v}_1$ï¼ˆå’Œ$\sigma_1$ï¼‰ã€‚
- <strong>ç²¾ç¡®æ–¹æ³•</strong>ï¼šå®Œæ•´SVDï¼Œå¤æ‚åº¦$\mathcal{O}(\min(n^2m,nm^2))$ã€‚
- <strong>è¿‘ä¼¼æ–¹æ³•</strong>ï¼šå¹‚è¿­ä»£$t$æ¬¡ï¼Œå¤æ‚åº¦$\mathcal{O}(tnm)$ï¼Œé€šå¸¸$t\ll\min(n,m)$ã€‚</p>
<p>å®è·µä¸­ï¼Œ$t=1\sim 10$æ¬¡å¹‚è¿­ä»£é€šå¸¸è¶³å¤Ÿï¼Œä½¿å¾—è°±èŒƒæ•°æƒé‡è¡°å‡çš„é¢å¤–è®¡ç®—å¼€é”€å¯æ¥å—ã€‚</p>
<h4 id="33">3.3 ä½œç”¨æœºåˆ¶çš„ç†è®ºåˆ†æ</h4>
<p>è€ƒè™‘ä¸€ä¸ªçº¿æ€§å±‚$\boldsymbol{y}=\boldsymbol{W}\boldsymbol{x}$ï¼Œè¾“å…¥ä¸º$\boldsymbol{x}\sim\mathcal{N}(\mathbf{0},\boldsymbol{I})$ã€‚è¾“å‡ºçš„åæ–¹å·®çŸ©é˜µä¸ºï¼š
$$\mathbb{E}[\boldsymbol{y}\boldsymbol{y}^{\top}] = \mathbb{E}[\boldsymbol{W}\boldsymbol{x}\boldsymbol{x}^{\top}\boldsymbol{W}^{\top}] = \boldsymbol{W}\boldsymbol{W}^{\top}$$</p>
<p>å…¶ç‰¹å¾å€¼ä¸º$\sigma_1^2,\ldots,\sigma_r^2$ã€‚</p>
<p><strong>Frobeniusæƒé‡è¡°å‡</strong>é€šè¿‡ç¼©æ”¾$\boldsymbol{W}$æ¥å‡åŒ€å‡å°æ‰€æœ‰$\sigma_i$ï¼Œå¯èƒ½å¯¼è‡´ï¼š
- <strong>è¿‡åº¦æ­£åˆ™åŒ–</strong>ï¼šå°çš„$\sigma_i$è¢«è¿›ä¸€æ­¥å‹ç¼©ï¼Œä¸¢å¤±ä¿¡æ¯ã€‚
- <strong>è¡¨è¾¾èƒ½åŠ›ä¸‹é™</strong>ï¼šé™ä½çŸ©é˜µçš„æœ‰æ•ˆç§©ã€‚</p>
<p><strong>è°±èŒƒæ•°æƒé‡è¡°å‡</strong>åªå‡å°$\sigma_1$ï¼Œä¿ç•™å…¶ä»–æ–¹å‘ï¼š
- <strong>ç²¾å‡†æ§åˆ¶</strong>ï¼šç¡®ä¿$\Vert\boldsymbol{W}\boldsymbol{x}\Vert_2\leq\sigma_1\Vert\boldsymbol{x}\Vert_2$ä¸­çš„$\sigma_1$ä¸è¿‡å¤§ã€‚
- <strong>ä¿æŒå¤šæ ·æ€§</strong>ï¼šæ¬¡è¦å¥‡å¼‚æ–¹å‘ä¸å—å½±å“ï¼Œä¿ç•™æ›´å¤šä¿¡æ¯ã€‚</p>
<h3 id="4-spectral-normalization">4. è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰çš„æ•°å­¦åŸç†</h3>
<h4 id="41">4.1 å®šä¹‰ä¸åŠ¨æœº</h4>
<p>è°±å½’ä¸€åŒ–æœ€æ—©ç”±Miyato et al. (2018)åœ¨GANè®­ç»ƒä¸­æå‡ºã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯å°†æƒé‡çŸ©é˜µå½’ä¸€åŒ–ä¸ºï¼š
$$\boldsymbol{W}_{\text{SN}} = \frac{\boldsymbol{W}}{\sigma_1(\boldsymbol{W})}$$</p>
<p>ä½¿å¾—$\Vert\boldsymbol{W}_{\text{SN}}\Vert_2=1$ã€‚</p>
<p><strong>ç›®çš„</strong>ï¼šæ§åˆ¶ç¥ç»ç½‘ç»œçš„Lipschitzå¸¸æ•°ã€‚å¯¹äºå‡½æ•°$f(\boldsymbol{x})=\sigma(\boldsymbol{W}\boldsymbol{x})$ï¼ˆ$\sigma$æ˜¯æ¿€æ´»å‡½æ•°ï¼‰ï¼Œå¦‚æœ$\sigma$æ˜¯1-Lipschitzçš„ï¼ˆå¦‚ReLUï¼‰ï¼Œåˆ™ï¼š
$$\Vert f(\boldsymbol{x}_1)-f(\boldsymbol{x}_2)\Vert_2 \leq \Vert\boldsymbol{W}\Vert_2\Vert\boldsymbol{x}_1-\boldsymbol{x}_2\Vert_2$$</p>
<p>é€šè¿‡è°±å½’ä¸€åŒ–ï¼Œç¡®ä¿æ¯å±‚çš„Lipschitzå¸¸æ•°ä¸º1ï¼Œæ•´ä¸ªç½‘ç»œçš„Lipschitzå¸¸æ•°ä¸ºå±‚æ•°çš„ä¹˜ç§¯ï¼ˆæœ€å¤šä¸ºå±‚æ•°ï¼‰ã€‚</p>
<h4 id="42">4.2 åå‘ä¼ æ’­åˆ†æ</h4>
<p>è®¾æŸå¤±å‡½æ•°ä¸º$\mathcal{L}$ï¼Œæƒé‡ä¸º$\boldsymbol{W}_{\text{SN}}=\boldsymbol{W}/\sigma_1$ã€‚åå‘ä¼ æ’­æ—¶éœ€è¦è®¡ç®—ï¼š
$$\frac{\partial\mathcal{L}}{\partial\boldsymbol{W}} = \frac{\partial\mathcal{L}}{\partial\boldsymbol{W}_{\text{SN}}} \frac{\partial\boldsymbol{W}_{\text{SN}}}{\partial\boldsymbol{W}}$$</p>
<p>å³ä¾§ç¬¬äºŒé¡¹è¾ƒä¸ºå¤æ‚ã€‚ä»¤$\boldsymbol{W}_{\text{SN}}=g(\boldsymbol{W})$ï¼Œåˆ™ï¼š
$$dg = d\left(\frac{\boldsymbol{W}}{\sigma_1}\right) = \frac{d\boldsymbol{W}}{\sigma_1} - \frac{\boldsymbol{W}(d\sigma_1)}{\sigma_1^2}$$</p>
<p>å…¶ä¸­$d\sigma_1 = \text{Tr}((\boldsymbol{u}_1\boldsymbol{v}_1^{\top})^{\top}d\boldsymbol{W})$ï¼Œæ•…ï¼š
$$dg = \frac{1}{\sigma_1}\left(\boldsymbol{I} - \frac{\boldsymbol{W}\boldsymbol{u}_1\boldsymbol{v}_1^{\top}}{\sigma_1}\right)d\boldsymbol{W} = \frac{1}{\sigma_1}\left(\boldsymbol{I} - \boldsymbol{u}_1\boldsymbol{u}_1^{\top}\otimes\boldsymbol{v}_1\boldsymbol{v}_1^{\top}\right)d\boldsymbol{W}$$</p>
<p>å› æ­¤æ¢¯åº¦ä¸ºï¼š
$$\frac{\partial\mathcal{L}}{\partial\boldsymbol{W}} = \frac{1}{\sigma_1}\left(\boldsymbol{I} - \boldsymbol{u}_1\boldsymbol{u}_1^{\top}\right)\frac{\partial\mathcal{L}}{\partial\boldsymbol{W}_{\text{SN}}}\left(\boldsymbol{I} - \boldsymbol{v}_1\boldsymbol{v}_1^{\top}\right)$$</p>
<p><strong>è§£é‡Š</strong>ï¼šæŠ•å½±åˆ°æ­£äº¤äº$\boldsymbol{u}_1,\boldsymbol{v}_1$çš„å­ç©ºé—´ï¼Œé¿å…æ¢¯åº¦å¢å¤§$\sigma_1$ï¼ˆå› ä¸ºå½’ä¸€åŒ–ä¼šæŠµæ¶ˆï¼‰ã€‚</p>
<h4 id="43">4.3 ä¸æƒé‡è¡°å‡çš„å…³ç³»</h4>
<p>è°±å½’ä¸€åŒ–æ˜¯<strong>ç¡¬çº¦æŸ</strong>ï¼š$\Vert\boldsymbol{W}\Vert_2=1$ã€‚</p>
<p>è°±èŒƒæ•°æƒé‡è¡°å‡æ˜¯<strong>è½¯çº¦æŸ</strong>ï¼šåœ¨æŸå¤±ä¸­æ·»åŠ æƒ©ç½šé¡¹$\lambda\Vert\boldsymbol{W}\Vert_2^2$ã€‚</p>
<p>ä¸¤è€…çš„è”ç³»å¯é€šè¿‡æ‹‰æ ¼æœ—æ—¥ä¹˜æ•°æ³•ç†è§£ã€‚è€ƒè™‘çº¦æŸä¼˜åŒ–é—®é¢˜ï¼š
$$\min_{\boldsymbol{W}} \mathcal{L}(\boldsymbol{W}) \quad\text{s.t.}\quad \Vert\boldsymbol{W}\Vert_2 \leq C$$</p>
<p>æ‹‰æ ¼æœ—æ—¥å‡½æ•°ä¸ºï¼š
$$\mathcal{L}_{\text{aug}}(\boldsymbol{W},\lambda) = \mathcal{L}(\boldsymbol{W}) + \lambda(\Vert\boldsymbol{W}\Vert_2 - C)$$</p>
<p>å½“çº¦æŸæ¿€æ´»æ—¶ï¼ˆ$\Vert\boldsymbol{W}\Vert_2=C$ï¼‰ï¼Œå¯¹$\boldsymbol{W}$çš„æ¢¯åº¦ä¸ºï¼š
$$\nabla_{\boldsymbol{W}}\mathcal{L}_{\text{aug}} = \nabla_{\boldsymbol{W}}\mathcal{L} + \lambda\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$$</p>
<p>è¿™æ­£æ˜¯è°±èŒƒæ•°æƒé‡è¡°å‡çš„å½¢å¼ï¼ˆ$\lambda$ä¸ºæ‹‰æ ¼æœ—æ—¥ä¹˜å­ï¼‰ã€‚</p>
<h3 id="5">5. æƒé‡è¡°å‡çš„ä¸åŒå½¢å¼åŠå…¶ç»Ÿä¸€æ¡†æ¶</h3>
<h4 id="51">5.1 ä¸€èˆ¬åŒ–çš„æƒé‡è¡°å‡</h4>
<p>æƒé‡è¡°å‡å¯ä»¥ç»Ÿä¸€ä¸ºå¦‚ä¸‹å½¢å¼ï¼š
$$\boldsymbol{W}_{t+1} = \boldsymbol{W}_t - \eta\nabla_{\boldsymbol{W}}\mathcal{L} - \eta\lambda\nabla_{\boldsymbol{W}}R(\boldsymbol{W})$$</p>
<p>å…¶ä¸­$R(\boldsymbol{W})$æ˜¯æ­£åˆ™é¡¹ã€‚å¸¸è§å½¢å¼ï¼š</p>
<table>
<thead>
<tr>
<th>æ­£åˆ™é¡¹</th>
<th>æ¢¯åº¦</th>
<th>åç§°</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\frac{1}{2}\Vert\boldsymbol{W}\Vert_F^2$</td>
<td>$\boldsymbol{W}$</td>
<td>L2æ­£åˆ™ï¼ˆFrobeniusï¼‰</td>
</tr>
<tr>
<td>$\frac{1}{2}\Vert\boldsymbol{W}\Vert_2^2$</td>
<td>$\sigma_1\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$</td>
<td>è°±æ­£åˆ™</td>
</tr>
<tr>
<td>$\Vert\boldsymbol{W}\Vert_1$</td>
<td>$\text{sign}(\boldsymbol{W})$</td>
<td>L1æ­£åˆ™</td>
</tr>
<tr>
<td>$\Vert\boldsymbol{W}\Vert_*$</td>
<td>$\boldsymbol{U}\boldsymbol{V}^{\top}$</td>
<td>æ ¸èŒƒæ•°æ­£åˆ™</td>
</tr>
</tbody>
</table>
<p>å…¶ä¸­æ ¸èŒƒæ•°ï¼ˆnuclear normï¼‰$\Vert\boldsymbol{W}\Vert_*=\sum_{i}\sigma_i$ï¼Œä¿ƒè¿›ä½ç§©ã€‚</p>
<h4 id="52-l2">5.2 L2æ­£åˆ™çš„é€€åŒ–é—®é¢˜</h4>
<p>L2æ­£åˆ™ç­‰ä»·äºé«˜æ–¯å…ˆéªŒ$\boldsymbol{W}\sim\mathcal{N}(\mathbf{0},\lambda^{-1}\boldsymbol{I})$ã€‚æ›´æ–°è§„åˆ™ï¼š
$$\boldsymbol{W}_{t+1} = (1-\eta\lambda)\boldsymbol{W}_t - \eta\nabla_{\boldsymbol{W}}\mathcal{L}$$</p>
<p><strong>é—®é¢˜</strong>ï¼šå½“$\eta\lambda$è¾ƒå¤§æ—¶ï¼Œ$(1-\eta\lambda)$å¯èƒ½å¾ˆå°ï¼Œå¯¼è‡´ï¼š
- <strong>æ¢¯åº¦æ¶ˆå¤±</strong>ï¼šå†å²ä¿¡æ¯å¿«é€Ÿè¡°å‡ã€‚
- <strong>å­¦ä¹ å›°éš¾</strong>ï¼šéœ€è¦éå¸¸å¤§çš„æ¢¯åº¦æ‰èƒ½ç»´æŒæƒé‡ã€‚</p>
<p><strong>SVDè§†è§’</strong>ï¼š
$$(1-\eta\lambda)\boldsymbol{W} = \sum_{i}(1-\eta\lambda)\sigma_i\boldsymbol{u}_i\boldsymbol{v}_i^{\top}$$</p>
<p>æ‰€æœ‰$\sigma_i$è¢«ç­‰æ¯”ä¾‹ç¼©æ”¾ï¼ŒåŒ…æ‹¬å·²ç»å¾ˆå°çš„å¥‡å¼‚å€¼ï¼Œå¯èƒ½å¯¼è‡´ä¿¡æ¯ä¸¢å¤±ã€‚</p>
<h4 id="53">5.3 è°±æ­£åˆ™çš„ä¼˜åŠ¿</h4>
<p>è°±æ­£åˆ™æ›´æ–°ï¼š
$$\boldsymbol{W}_{t+1} = \boldsymbol{W}_t - \eta\lambda\sigma_1\boldsymbol{u}_1\boldsymbol{v}_1^{\top} - \eta\nabla_{\boldsymbol{W}}\mathcal{L}$$</p>
<p>SVDè§†è§’ï¼š
$$\boldsymbol{W}_{t+1} = \sum_{i=1}^{r}\sigma_i^{(t)}\boldsymbol{u}_i\boldsymbol{v}_i^{\top} - \eta\lambda\sigma_1^{(t)}\boldsymbol{u}_1\boldsymbol{v}_1^{\top} - \eta\nabla_{\boldsymbol{W}}\mathcal{L}$$</p>
<p>ä¸»è¦ä½œç”¨äº$\sigma_1$ï¼š
$$\sigma_1^{(t+1)} \approx \sigma_1^{(t)} - \eta\lambda\sigma_1^{(t)} + \mathcal{O}(\eta\nabla\mathcal{L})$$</p>
<p>è€Œå…¶ä»–$\sigma_i(i\geq 2)$ä¸»è¦å—$\nabla\mathcal{L}$å½±å“ï¼Œä¸ä¼šè¢«è¿‡åº¦å‹ç¼©ã€‚</p>
<p><strong>é€‚åº”æ€§</strong>ï¼šè°±æ­£åˆ™çš„è¡°å‡å¼ºåº¦$\eta\lambda\sigma_1$ä¸$\sigma_1$æˆæ­£æ¯”ï¼Œå…·æœ‰<strong>è‡ªé€‚åº”æ€§</strong>â€”â€”å¤§çš„å¥‡å¼‚å€¼è¢«æ›´å¼ºåœ°æƒ©ç½šã€‚</p>
<h3 id="6">6. æ¢¯åº¦ä¸‹é™åŠ¨åŠ›å­¦çš„è°±åˆ†æ</h3>
<h4 id="61">6.1 ç®€åŒ–æ¨¡å‹ï¼šçº¿æ€§å›å½’</h4>
<p>è€ƒè™‘çº¿æ€§å›å½’é—®é¢˜ï¼š$\min_{\boldsymbol{W}} \frac{1}{2}\Vert\boldsymbol{Y}-\boldsymbol{W}\boldsymbol{X}\Vert_F^2$ï¼Œå…¶ä¸­$\boldsymbol{X}\in\mathbb{R}^{m\times N}$ï¼Œ$\boldsymbol{Y}\in\mathbb{R}^{n\times N}$ã€‚</p>
<p>æ¢¯åº¦ä¸ºï¼š
$$\nabla_{\boldsymbol{W}}\mathcal{L} = (\boldsymbol{W}\boldsymbol{X}-\boldsymbol{Y})\boldsymbol{X}^{\top}$$</p>
<p><strong>L2æƒé‡è¡°å‡</strong>ä¸‹çš„åŠ¨åŠ›å­¦ï¼š
$$\boldsymbol{W}_{t+1} = (1-\eta\lambda)\boldsymbol{W}_t - \eta(\boldsymbol{W}_t\boldsymbol{X}-\boldsymbol{Y})\boldsymbol{X}^{\top}$$</p>
<p>æ”¹å†™ä¸ºï¼š
$$\boldsymbol{W}_{t+1} = \boldsymbol{W}_t(1-\eta\lambda) - \eta\boldsymbol{W}_t\boldsymbol{X}\boldsymbol{X}^{\top} + \eta\boldsymbol{Y}\boldsymbol{X}^{\top}$$
$$= \boldsymbol{W}_t\left[(1-\eta\lambda)\boldsymbol{I} - \eta\boldsymbol{X}\boldsymbol{X}^{\top}\right] + \eta\boldsymbol{Y}\boldsymbol{X}^{\top}$$</p>
<p>è®¾$\boldsymbol{X}\boldsymbol{X}^{\top}=\sum_{i}\mu_i\boldsymbol{q}_i\boldsymbol{q}_i^{\top}$ï¼ˆç‰¹å¾åˆ†è§£ï¼‰ï¼Œåˆ™ï¼š
$$\boldsymbol{W}_{t+1} = \boldsymbol{W}_t\sum_{i}(1-\eta\lambda-\eta\mu_i)\boldsymbol{q}_i\boldsymbol{q}_i^{\top} + \eta\boldsymbol{Y}\boldsymbol{X}^{\top}$$</p>
<p><strong>æ”¶æ•›æ¡ä»¶</strong>ï¼š$|1-\eta\lambda-\eta\mu_i|&lt;1$å¯¹æ‰€æœ‰$i$æˆç«‹ï¼Œå³ï¼š
$$0 < \eta < \frac{2}{\lambda+\mu_{\max}}$$</p>
<p>å…¶ä¸­$\mu_{\max}$æ˜¯$\boldsymbol{X}\boldsymbol{X}^{\top}$çš„æœ€å¤§ç‰¹å¾å€¼ã€‚</p>
<p><strong>è°±åå·®</strong>ï¼ˆSpectral Biasï¼‰ï¼šä¸åŒç‰¹å¾æ–¹å‘çš„æ”¶æ•›é€Ÿåº¦ä¸åŒã€‚ç¬¬$i$ä¸ªç‰¹å¾æ–¹å‘çš„è¡°å‡ç‡ä¸º$(1-\eta\lambda-\eta\mu_i)$ï¼Œå¯¹åº”çš„æ”¶æ•›é€Ÿåº¦ä¸$\mu_i$æˆæ­£æ¯”ã€‚å¤§ç‰¹å¾å€¼æ–¹å‘æ”¶æ•›å¿«ï¼Œå°ç‰¹å¾å€¼æ–¹å‘æ”¶æ•›æ…¢ã€‚</p>
<h4 id="62">6.2 è°±æƒé‡è¡°å‡çš„åŠ¨åŠ›å­¦</h4>
<p>è°±æƒé‡è¡°å‡ä¸‹ï¼š
$$\boldsymbol{W}_{t+1} = \boldsymbol{W}_t - \eta\lambda\sigma_1^{(t)}\boldsymbol{u}_1^{(t)}(\boldsymbol{v}_1^{(t)})^{\top} - \eta(\boldsymbol{W}_t\boldsymbol{X}-\boldsymbol{Y})\boldsymbol{X}^{\top}$$</p>
<p>è¿™æ˜¯ä¸€ä¸ª<strong>éçº¿æ€§åŠ¨åŠ›ç³»ç»Ÿ</strong>ï¼Œå› ä¸º$\sigma_1,\boldsymbol{u}_1,\boldsymbol{v}_1$éƒ½ä¾èµ–äº$\boldsymbol{W}_t$ã€‚</p>
<p><strong>å±€éƒ¨çº¿æ€§åŒ–åˆ†æ</strong>ï¼šåœ¨å¹³è¡¡ç‚¹$\boldsymbol{W}^<em>$é™„è¿‘ï¼Œè®¾$\boldsymbol{W}_t=\boldsymbol{W}^</em>+\boldsymbol{\Delta}_t$ï¼Œåˆ™ï¼š
$$\sigma_1(\boldsymbol{W}_t) \approx \sigma_1(\boldsymbol{W}^*) + \text{Tr}((\boldsymbol{u}_1^*(\boldsymbol{v}_1^*)^{\top})^{\top}\boldsymbol{\Delta}_t)$$
$$\boldsymbol{u}_1(\boldsymbol{W}_t)\boldsymbol{v}_1(\boldsymbol{W}_t)^{\top} \approx \boldsymbol{u}_1^*(\boldsymbol{v}_1^*)^{\top} + \mathcal{O}(\Vert\boldsymbol{\Delta}_t\Vert)$$</p>
<p>ä¸€é˜¶è¿‘ä¼¼ä¸‹ï¼š
$$\boldsymbol{\Delta}_{t+1} \approx \boldsymbol{\Delta}_t\left[\boldsymbol{I} - \eta\boldsymbol{X}\boldsymbol{X}^{\top}\right] - \eta\lambda\sigma_1^*\boldsymbol{u}_1^*(\boldsymbol{v}_1^*)^{\top}$$</p>
<p><strong>å…³é”®åŒºåˆ«</strong>ï¼šè°±è¡°å‡é¡¹$\eta\lambda\sigma_1^<em>\boldsymbol{u}_1^</em>(\boldsymbol{v}_1^<em>)^{\top}$æ˜¯ä¸€ä¸ª</em><em>ç§©1çŸ©é˜µ</em><em>ï¼Œåªåœ¨$\boldsymbol{u}_1^</em>$æ–¹å‘æ–½åŠ è¡°å‡ã€‚è¿™æ„å‘³ç€ï¼š
- ä¸$\boldsymbol{u}_1^<em>$æ­£äº¤çš„æ–¹å‘</em><em>ä¸å—è°±è¡°å‡å½±å“</em>*ï¼Œå®Œå…¨ç”±æ•°æ®é¡¹$\boldsymbol{X}\boldsymbol{X}^{\top}$é©±åŠ¨ã€‚
- æ›´ç²¾ç»†åœ°æ§åˆ¶æƒé‡çš„è°±åˆ†å¸ƒã€‚</p>
<h3 id="7-muon">7. Muonä¼˜åŒ–å™¨ä¸­çš„è°±è£å‰ª</h3>
<h4 id="71-muon">7.1 Muonä¼˜åŒ–å™¨å›é¡¾</h4>
<p>Muonä¼˜åŒ–å™¨çš„æ ¸å¿ƒæ›´æ–°è§„åˆ™ä¸ºï¼š
$$\boldsymbol{W}_{t+1} = \boldsymbol{W}_t - \eta\frac{\nabla_{\boldsymbol{W}}\mathcal{L}}{\Vert\nabla_{\boldsymbol{W}}\mathcal{L}\Vert_2}$$</p>
<p>å³å¯¹æ¢¯åº¦è¿›è¡Œè°±å½’ä¸€åŒ–ï¼ˆä½¿å…¶è°±èŒƒæ•°ä¸º1ï¼‰åæ›´æ–°ã€‚</p>
<p><strong>ç†è®ºè§£é‡Š</strong>ï¼šè¿™å¯ä»¥è§†ä¸ºåœ¨è°±èŒƒæ•°çƒçº¦æŸä¸‹çš„æœ€é€Ÿä¸‹é™ï¼š
$$\min_{\boldsymbol{\Delta}:\Vert\boldsymbol{\Delta}\Vert_2\leq\eta} \text{Tr}((\nabla\mathcal{L})^{\top}\boldsymbol{\Delta})$$</p>
<p>æœ€ä¼˜è§£ä¸º$\boldsymbol{\Delta}^*=-\eta\nabla\mathcal{L}/\Vert\nabla\mathcal{L}\Vert_2$ã€‚</p>
<h4 id="72">7.2 è°±è£å‰ªçš„æ•°å­¦å½¢å¼</h4>
<p>ä¸€èˆ¬çš„æ¢¯åº¦è£å‰ªå¯ä»¥å†™ä¸ºï¼š
$$\boldsymbol{g}_{\text{clip}} = \begin{cases}
\boldsymbol{g} & \text{if }\Vert\boldsymbol{g}\Vert \leq \tau \\
\tau\frac{\boldsymbol{g}}{\Vert\boldsymbol{g}\Vert} & \text{otherwise}
\end{cases}$$</p>
<p>Muonä½¿ç”¨<strong>è°±èŒƒæ•°è£å‰ª</strong>ï¼š
$$\boldsymbol{g}_{\text{clip}} = \begin{cases}
\boldsymbol{g} & \text{if }\Vert\boldsymbol{g}\Vert_2 \leq \tau \\
\tau\frac{\boldsymbol{g}}{\Vert\boldsymbol{g}\Vert_2} & \text{otherwise}
\end{cases}$$</p>
<p>å…¶ä¸­$\Vert\boldsymbol{g}\Vert_2=\sigma_1(\boldsymbol{g})$ã€‚</p>
<p><strong>SVDè§†è§’</strong>ï¼šè®¾$\boldsymbol{g}=\sum_{i}\gamma_i\boldsymbol{p}_i\boldsymbol{q}_i^{\top}$ï¼Œåˆ™ï¼š
$$\frac{\boldsymbol{g}}{\Vert\boldsymbol{g}\Vert_2} = \sum_{i}\frac{\gamma_i}{\gamma_1}\boldsymbol{p}_i\boldsymbol{q}_i^{\top}$$</p>
<p>æœ€å¤§å¥‡å¼‚å€¼æ–¹å‘è¢«å½’ä¸€åŒ–ä¸º1ï¼Œå…¶ä»–æ–¹å‘è¢«ç›¸åº”ç¼©æ”¾ï¼ˆ$\gamma_i/\gamma_1\leq 1$ï¼‰ã€‚</p>
<h4 id="73">7.3 ä¸è‡ªé€‚åº”å­¦ä¹ ç‡çš„å…³ç³»</h4>
<p>ä¼ ç»Ÿè‡ªé€‚åº”ä¼˜åŒ–å™¨ï¼ˆå¦‚Adamï¼‰å¯¹æ¯ä¸ªå‚æ•°åˆ†é‡ä½¿ç”¨ä¸åŒçš„å­¦ä¹ ç‡ï¼š
$$w_{ij,t+1} = w_{ij,t} - \frac{\eta}{\sqrt{v_{ij,t}}+\epsilon}g_{ij,t}$$</p>
<p>Muonåˆ™å¯¹æ•´ä¸ªçŸ©é˜µä½¿ç”¨<strong>å…¨å±€çš„è°±å½’ä¸€åŒ–</strong>ï¼š
$$\boldsymbol{W}_{t+1} = \boldsymbol{W}_t - \eta\frac{\boldsymbol{G}_t}{\sigma_1(\boldsymbol{G}_t)}$$</p>
<p><strong>å¯¹æ¯”</strong>ï¼š
- Adamï¼šå…ƒç´ çº§è‡ªé€‚åº”ï¼Œå¯èƒ½ç ´åæ¢¯åº¦çš„<strong>å‡ ä½•ç»“æ„</strong>ã€‚
- Muonï¼šçŸ©é˜µçº§å½’ä¸€åŒ–ï¼Œä¿æŒæ¢¯åº¦çš„<strong>ä¸»è¦æ–¹å‘</strong>ï¼ˆç”±$\boldsymbol{p}_1\boldsymbol{q}_1^{\top}$å†³å®šï¼‰ã€‚</p>
<p><strong>ç†è®ºä¼˜åŠ¿</strong>ï¼šå¯¹äºçŸ©é˜µå‚æ•°ï¼Œå…¶è‡ªç„¶å‡ ä½•æ˜¯çŸ©é˜µæµå½¢ï¼Œè€Œéæ¬§æ°ç©ºé—´ã€‚è°±å½’ä¸€åŒ–å°Šé‡è¿™ä¸€å‡ ä½•ã€‚</p>
<h3 id="8">8. æ”¶æ•›æ€§åˆ†æ</h3>
<h4 id="81-l2">8.1 L2æƒé‡è¡°å‡çš„æ”¶æ•›æ€§</h4>
<p>è€ƒè™‘å¼ºå‡¸å‡½æ•°$\mathcal{L}(\boldsymbol{W})$ï¼ˆæ»¡è¶³$\nabla^2\mathcal{L}\succeq\mu\boldsymbol{I}$ï¼‰å’ŒL-å…‰æ»‘ï¼ˆ$\Vert\nabla^2\mathcal{L}\Vert_2\leq L$ï¼‰ã€‚</p>
<p><strong>å®šç†ï¼ˆL2è¡°å‡çš„æ”¶æ•›ç‡ï¼‰</strong>ï¼šåœ¨L2æƒé‡è¡°å‡ä¸‹ï¼Œé€‰æ‹©$\eta\leq\min{1/(L+\lambda),1/\lambda}$ï¼Œåˆ™ï¼š
$$\Vert\boldsymbol{W}_t-\boldsymbol{W}^*\Vert_F^2 \leq (1-\eta\mu)^t\Vert\boldsymbol{W}_0-\boldsymbol{W}^*\Vert_F^2$$</p>
<p>æ”¶æ•›é€Ÿåº¦ä¸º$\mathcal{O}(\exp(-\mu t\eta))$ï¼Œçº¿æ€§æ”¶æ•›ã€‚</p>
<p><strong>è¯æ˜è‰å›¾</strong>ï¼šå®šä¹‰Lyapunovå‡½æ•°$V(\boldsymbol{W})=\mathcal{L}(\boldsymbol{W})+\frac{\lambda}{2}\Vert\boldsymbol{W}\Vert_F^2$ã€‚ä¸€æ­¥æ›´æ–°åï¼š
$$V(\boldsymbol{W}_{t+1}) \leq V(\boldsymbol{W}_t) - \frac{\eta}{2}(1-\eta L)\Vert\nabla V(\boldsymbol{W}_t)\Vert_F^2$$</p>
<p>åˆ©ç”¨å¼ºå‡¸æ€§$V(\boldsymbol{W})\geq V(\boldsymbol{W}^<em>)+\frac{\mu}{2}\Vert\boldsymbol{W}-\boldsymbol{W}^</em>\Vert_F^2$ï¼Œå¾—åˆ°æ”¶æ•›ç‡ã€‚</p>
<h4 id="82">8.2 è°±æƒé‡è¡°å‡çš„æ”¶æ•›æ€§</h4>
<p>è°±æƒé‡è¡°å‡çš„æ”¶æ•›æ€§åˆ†ææ›´ä¸ºå¤æ‚ï¼Œå› ä¸ºæ›´æ–°ä¸å†æ˜¯ç®€å•çš„çº¿æ€§å˜æ¢ã€‚æˆ‘ä»¬ç»™å‡ºä¸€ä¸ªç®€åŒ–çš„ç»“æœã€‚</p>
<p><strong>å‡è®¾</strong>ï¼š$\mathcal{L}$æ˜¯L-å…‰æ»‘çš„ï¼Œä¸”æ»¡è¶³<strong>è°±å¼ºå‡¸æ€§</strong>ï¼ˆspectral strong convexityï¼‰ï¼š
$$\langle\nabla\mathcal{L}(\boldsymbol{W})-\nabla\mathcal{L}(\boldsymbol{W}'),\boldsymbol{W}-\boldsymbol{W}'\rangle \geq \mu_{\text{spec}}\Vert\boldsymbol{W}-\boldsymbol{W}'\Vert_2^2$$</p>
<p><strong>å®šç†ï¼ˆè°±è¡°å‡çš„æ”¶æ•›ï¼‰</strong>ï¼šåœ¨è°±æƒé‡è¡°å‡ä¸‹ï¼Œé€‰æ‹©$\eta\leq 1/(L+\lambda\Vert\boldsymbol{W}_0\Vert_2)$ï¼Œåˆ™å¯¹äºè¶³å¤Ÿå°çš„$\lambda$ï¼š
$$\Vert\boldsymbol{W}_t-\boldsymbol{W}^*\Vert_2 \leq \exp\left(-\frac{\mu_{\text{spec}}t\eta}{2}\right)\Vert\boldsymbol{W}_0-\boldsymbol{W}^*\Vert_2$$</p>
<p>æ”¶æ•›é€Ÿåº¦ä¸º$\mathcal{O}(\exp(-\mu_{\text{spec}}t\eta))$ã€‚</p>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼šè°±è¡°å‡åœ¨è°±èŒƒæ•°æ„ä¹‰ä¸‹å…·æœ‰çº¿æ€§æ”¶æ•›ç‡ï¼Œè€ŒFèŒƒæ•°ä¸‹å¯èƒ½æ›´æ…¢ï¼ˆå› ä¸ºåªæ§åˆ¶äº†æœ€å¤§å¥‡å¼‚å€¼ï¼‰ã€‚</p>
<h4 id="83">8.3 éå‡¸æƒ…å†µçš„å±€éƒ¨æ”¶æ•›</h4>
<p>å¯¹äºç¥ç»ç½‘ç»œç­‰éå‡¸é—®é¢˜ï¼Œå…¨å±€æ”¶æ•›æ€§éš¾ä»¥ä¿è¯ã€‚ä½†å¯ä»¥åˆ†æ<strong>ä¸´ç•Œç‚¹é™„è¿‘çš„å±€éƒ¨æ”¶æ•›</strong>ã€‚</p>
<p><strong>å®šç†ï¼ˆé€ƒç¦»éç‚¹ï¼‰</strong>ï¼šå‡è®¾$\nabla\mathcal{L}(\boldsymbol{W}^<em>)=\mathbf{0}$ä¸”Hessian $\nabla^2\mathcal{L}(\boldsymbol{W}^</em>)$æœ‰è´Ÿç‰¹å¾å€¼$\lambda_{\min}&lt;0$ã€‚åœ¨è°±æƒé‡è¡°å‡ä¸‹ï¼Œè‹¥åˆå§‹ç‚¹æ¥è¿‘$\boldsymbol{W}^<em>$ï¼Œåˆ™ï¼š
- è‹¥$\boldsymbol{u}_1(\boldsymbol{W}_0)$ä¸Hessiançš„æœ€å°ç‰¹å¾å‘é‡æœ‰æ˜¾è‘—é‡å ï¼Œç®—æ³•ä¼š</em><em>åŠ é€Ÿé€ƒç¦»</em><em>è¯¥éç‚¹ã€‚
- L2è¡°å‡ä¼šåœ¨æ‰€æœ‰æ–¹å‘ä¸Šæ–½åŠ è¡°å‡ï¼Œå¯èƒ½</em><em>å‡æ…¢é€ƒç¦»é€Ÿåº¦</em>*ã€‚</p>
<p><strong>ç›´è§‰</strong>ï¼šè°±è¡°å‡ä¸ä¼šå¹²æ‰°è´Ÿæ›²ç‡æ–¹å‘ï¼ˆè‹¥$\boldsymbol{u}_1$ä¸å¯¹é½ï¼‰ï¼Œè€ŒL2è¡°å‡ä¼šåœ¨æ‰€æœ‰æ–¹å‘æ–½åŠ é˜»åŠ›ã€‚</p>
<h3 id="9">9. æ³›åŒ–ç•Œçš„æ”¹è¿›</h3>
<h4 id="91-rademacher">9.1 Rademacherå¤æ‚åº¦è§†è§’</h4>
<p>ç¥ç»ç½‘ç»œçš„æ³›åŒ–è¯¯å·®å¯ä»¥ç”¨Rademacherå¤æ‚åº¦ç•Œå®šï¼š
$$\mathbb{E}[\text{Risk}] - \text{Empirical Risk} \leq \mathcal{R}(\mathcal{F}) + \mathcal{O}\left(\sqrt{\frac{\log(1/\delta)}{N}}\right)$$</p>
<p>å…¶ä¸­$\mathcal{R}(\mathcal{F})$æ˜¯å‡½æ•°ç±»$\mathcal{F}$çš„Rademacherå¤æ‚åº¦ã€‚</p>
<p>å¯¹äºå¤šå±‚ç¥ç»ç½‘ç»œ$f(\boldsymbol{x})=\boldsymbol{W}<em L-1="L-1">L\sigma(\boldsymbol{W}</em>)\cdots)$ï¼š}\cdots\sigma(\boldsymbol{W}_1\boldsymbol{x</p>
<p><strong>L2çº¦æŸ</strong>ä¸‹ï¼ˆ$\Vert\boldsymbol{W}_i\Vert_F\leq B_i$ï¼‰ï¼š
$$\mathcal{R}(\mathcal{F}) \leq \frac{\prod_{i=1}^{L}B_i}{\sqrt{N}}\sum_{i=1}^{L}\frac{1}{B_i}$$</p>
<p><strong>è°±çº¦æŸ</strong>ä¸‹ï¼ˆ$\Vert\boldsymbol{W}_i\Vert_2\leq B_i$ï¼‰ï¼š
$$\mathcal{R}(\mathcal{F}) \leq \frac{\prod_{i=1}^{L}B_i}{\sqrt{N}}$$</p>
<p><strong>å¯¹æ¯”</strong>ï¼šè°±çº¦æŸçš„æ³›åŒ–ç•Œ<strong>æ›´ç´§</strong>ï¼ˆæ— æ±‚å’Œé¡¹ï¼‰ï¼Œå› ä¸ºè°±èŒƒæ•°ç›´æ¥æ§åˆ¶å‡½æ•°çš„Lipschitzå¸¸æ•°ã€‚</p>
<h4 id="92-pac-bayes">9.2 PAC-Bayesç•Œ</h4>
<p>PAC-Bayesç†è®ºæä¾›äº†å¦ä¸€ç§æ³›åŒ–åˆ†æã€‚è®¾å‚æ•°åéªŒä¸º$Q$ï¼Œå…ˆéªŒä¸º$P$ï¼Œåˆ™ï¼š
$$\mathbb{E}_{\boldsymbol{W}\sim Q}[\text{Risk}(\boldsymbol{W})] \leq \mathbb{E}_{\boldsymbol{W}\sim Q}[\text{Empirical Risk}(\boldsymbol{W})] + \sqrt{\frac{\text{KL}(Q\Vert P)+\log(N/\delta)}{2N}}$$</p>
<p><strong>L2å…ˆéªŒ</strong>ï¼š$P=\prod_{i}\mathcal{N}(\boldsymbol{W}_i|\mathbf{0},\lambda^{-1}\boldsymbol{I})$ï¼ŒKLæ•£åº¦ä¸ºï¼š
$$\text{KL}(Q\Vert P) = \frac{\lambda}{2}\sum_{i}\mathbb{E}_{Q}[\Vert\boldsymbol{W}_i\Vert_F^2] + \text{const}$$</p>
<p><strong>è°±å…ˆéªŒ</strong>ï¼šè€ƒè™‘çŸ©é˜µLangevinåˆ†å¸ƒï¼ˆMatrix Langevin distributionï¼‰ï¼Œå…¶å¯†åº¦æ­£æ¯”äº$\exp(-\lambda\Vert\boldsymbol{W}\Vert_2)$ã€‚ç›¸åº”çš„KLæ•£åº¦ä¸ºï¼š
$$\text{KL}(Q\Vert P) = \lambda\sum_{i}\mathbb{E}_{Q}[\Vert\boldsymbol{W}_i\Vert_2] + \text{const}$$</p>
<p>ç”±äº$\Vert\boldsymbol{W}\Vert_2\leq\Vert\boldsymbol{W}\Vert_F$ï¼Œè°±å…ˆéªŒå¯¹åº”çš„KLé¡¹<strong>æ›´å°</strong>ï¼Œå¯¼è‡´æ›´ç´§çš„æ³›åŒ–ç•Œã€‚</p>
<h4 id="93">9.3 å®è¯é£é™©ä¸è°±å¤æ‚åº¦</h4>
<p>Bartlett et al. (2017)æå‡º<strong>è°±å¤æ‚åº¦</strong>ï¼ˆspectral complexityï¼‰ï¼š
$$\mathcal{S}(f) = \left(\prod_{i=1}^{L}\Vert\boldsymbol{W}_i\Vert_2\right)\left(\sum_{i=1}^{L}\frac{\Vert\boldsymbol{W}_i\Vert_F^{2/3}}{\Vert\boldsymbol{W}_i\Vert_2^{2/3}}\right)^{3/2}$$</p>
<p>ç›¸åº”çš„æ³›åŒ–ç•Œä¸ºï¼š
$$\text{Gap} \leq \tilde{\mathcal{O}}\left(\frac{\mathcal{S}(f)\sqrt{L}}{\sqrt{N}}\right)$$</p>
<p><strong>è°±æƒé‡è¡°å‡</strong>é€šè¿‡å‡å°$\Vert\boldsymbol{W}_i\Vert_2$æ¥é™ä½$\mathcal{S}(f)$ï¼ŒåŒæ—¶ä¿æŒ$\Vert\boldsymbol{W}_i\Vert_F$ä¸è¿‡åˆ†ç¼©å°ï¼Œä»è€Œåœ¨è¡¨è¾¾èƒ½åŠ›å’Œæ³›åŒ–ä¹‹é—´å–å¾—æ›´å¥½çš„å¹³è¡¡ã€‚</p>
<h3 id="10-gan">10. GANè®­ç»ƒä¸­çš„åº”ç”¨</h3>
<h4 id="101-wganlipschitz">10.1 WGANä¸Lipschitzçº¦æŸ</h4>
<p>Wasserstein GANçš„åˆ¤åˆ«å™¨ï¼ˆcriticï¼‰éœ€è¦æ»¡è¶³1-Lipschitzçº¦æŸï¼š
$$\Vert D(\boldsymbol{x})-D(\boldsymbol{x}')\Vert \leq \Vert\boldsymbol{x}-\boldsymbol{x}'\Vert$$</p>
<p>åŸå§‹WGANä½¿ç”¨æƒé‡è£å‰ªï¼ˆweight clippingï¼‰ï¼Œä½†è¿™ä¼šå¯¼è‡´æ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±ã€‚</p>
<h4 id="102-gan">10.2 è°±å½’ä¸€åŒ–åœ¨GANä¸­çš„åº”ç”¨</h4>
<p>Miyato et al. (2018)æå‡ºå°†åˆ¤åˆ«å™¨çš„æ¯ä¸€å±‚æƒé‡$\boldsymbol{W}_i$æ›¿æ¢ä¸º$\boldsymbol{W}_i/\sigma_1(\boldsymbol{W}_i)$ã€‚</p>
<p><strong>ç†è®ºä¿è¯</strong>ï¼šè‹¥æ¯å±‚æ¿€æ´»å‡½æ•°$\sigma$æ˜¯1-Lipschitzçš„ï¼ˆå¦‚ReLUã€LeakyReLUï¼‰ï¼Œåˆ™åˆ¤åˆ«å™¨$D$çš„Lipschitzå¸¸æ•°ä¸ºï¼š
$$\text{Lip}(D) \leq \prod_{i=1}^{L}\Vert\boldsymbol{W}_i\Vert_2 = \prod_{i=1}^{L}1 = 1$$</p>
<p>ä»è€Œæ»¡è¶³WGANçš„çº¦æŸã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šå¯¹äº$f(\boldsymbol{x})=\sigma(\boldsymbol{W}\boldsymbol{x})$ï¼Œ
$$\Vert f(\boldsymbol{x})-f(\boldsymbol{x}')\Vert \leq \text{Lip}(\sigma)\Vert\boldsymbol{W}(\boldsymbol{x}-\boldsymbol{x}')\Vert \leq \text{Lip}(\sigma)\Vert\boldsymbol{W}\Vert_2\Vert\boldsymbol{x}-\boldsymbol{x}'\Vert$$</p>
<p>è‹¥$\text{Lip}(\sigma)=1$ä¸”$\Vert\boldsymbol{W}\Vert_2=1$ï¼Œåˆ™$\text{Lip}(f)=1$ã€‚å¤šå±‚å¤åˆå¾—åˆ°ç»“æœã€‚</p>
<h4 id="103">10.3 è°±æƒé‡è¡°å‡ä½œä¸ºè½¯çº¦æŸ</h4>
<p>ä¸ç¡¬å½’ä¸€åŒ–ï¼ˆè°±å½’ä¸€åŒ–ï¼‰ä¸åŒï¼Œè°±æƒé‡è¡°å‡ä½œä¸ºè½¯çº¦æŸï¼š
$$\min_{D,G} \mathbb{E}_{\boldsymbol{x}\sim p_{\text{data}}}[D(\boldsymbol{x})] - \mathbb{E}_{\boldsymbol{z}\sim p_z}[D(G(\boldsymbol{z}))] + \lambda\sum_{i}\Vert\boldsymbol{W}_i^D\Vert_2^2$$</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š
- <strong>çµæ´»æ€§</strong>ï¼šé€šè¿‡è°ƒæ•´$\lambda$æ§åˆ¶Lipschitzå¸¸æ•°çš„ä¸Šç•Œï¼Œè€Œéå›ºå®šä¸º1ã€‚
- <strong>æ›´å¹³æ»‘çš„ä¼˜åŒ–</strong>ï¼šé¿å…ç¡¬çº¦æŸå¯¼è‡´çš„æ¢¯åº¦ä¸è¿ç»­ã€‚</p>
<p><strong>å®éªŒè§‚å¯Ÿ</strong>ï¼šåœ¨æŸäº›GANä»»åŠ¡ä¸­ï¼Œè°±æƒé‡è¡°å‡å¯ä»¥è·å¾—ä¸è°±å½’ä¸€åŒ–ç›¸è¿‘çš„æ•ˆæœï¼ŒåŒæ—¶è®­ç»ƒæ›´ç¨³å®šã€‚</p>
<h4 id="104">10.4 ä¸æ¢¯åº¦æƒ©ç½šçš„ç»“åˆ</h4>
<p>æ¢¯åº¦æƒ©ç½šï¼ˆGradient Penalty, GPï¼‰æ˜¯å¦ä¸€ç§å®ç°Lipschitzçº¦æŸçš„æ–¹æ³•ï¼š
$$\mathcal{L}_{\text{GP}} = \mathbb{E}_{\tilde{\boldsymbol{x}}}[(\Vert\nabla_{\tilde{\boldsymbol{x}}}D(\tilde{\boldsymbol{x}})\Vert_2-1)^2]$$</p>
<p>å…¶ä¸­$\tilde{\boldsymbol{x}}$æ˜¯çœŸå®æ ·æœ¬å’Œç”Ÿæˆæ ·æœ¬ä¹‹é—´çš„æ’å€¼ã€‚</p>
<p><strong>ç»“åˆæ–¹å¼</strong>ï¼š
$$\mathcal{L}_D = \mathcal{L}_{\text{WGAN}} + \lambda_{\text{GP}}\mathcal{L}_{\text{GP}} + \lambda_{\text{spec}}\sum_{i}\Vert\boldsymbol{W}_i\Vert_2^2$$</p>
<ul>
<li>GPç¡®ä¿æ²¿æ•°æ®æµå½¢çš„Lipschitzçº¦æŸã€‚</li>
<li>è°±æ­£åˆ™ç¡®ä¿å…¨å±€çš„è°±èŒƒæ•°ä¸è¿‡å¤§ã€‚</li>
</ul>
<p><strong>ååŒæ•ˆåº”</strong>ï¼šä¸¤è€…äº’è¡¥â€”â€”GPæ˜¯å±€éƒ¨çº¦æŸï¼Œè°±æ­£åˆ™æ˜¯å…¨å±€çº¦æŸã€‚</p>
<h3 id="11_1">11. å®ç°ç»†èŠ‚ä¸ä¼˜åŒ–</h3>
<h4 id="111-boldsymbolv_1">11.1 é«˜æ•ˆè®¡ç®—$\boldsymbol{v}_1$çš„ç­–ç•¥</h4>
<p><strong>ç­–ç•¥1ï¼šå¹‚è¿­ä»£</strong>ï¼ˆå¦‚æ­£æ–‡æ‰€è¿°ï¼‰</p>
<div class="codehilite"><pre><span></span><code><span class="err">åˆå§‹åŒ–</span><span class="o">:</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ones</span><span class="o">(</span><span class="n">m</span><span class="o">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sqrt</span><span class="o">(</span><span class="n">m</span><span class="o">)</span>
<span class="k">for</span><span class="w"> </span><span class="n">t</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">range</span><span class="o">(</span><span class="n">num_iterations</span><span class="o">):</span>
<span class="w">    </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="n">v</span>
<span class="w">    </span><span class="n">u</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">u</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">norm</span><span class="o">(</span><span class="n">u</span><span class="o">)</span>
<span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">W</span><span class="o">.</span><span class="na">T</span><span class="w"> </span><span class="err">@</span><span class="w"> </span><span class="n">u</span>
<span class="w">    </span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">norm</span><span class="o">(</span><span class="n">v</span><span class="o">)</span>
</code></pre></div>

<p>å¤æ‚åº¦ï¼š$\mathcal{O}(t\cdot nm)$ï¼Œé€šå¸¸$t=1\sim 10$ã€‚</p>
<p><strong>ç­–ç•¥2ï¼šç¼“å­˜ä¸æ¸è¿›æ›´æ–°</strong></p>
<p>åˆ©ç”¨ç›¸é‚»è¿­ä»£ä¸­$\boldsymbol{W}_t$å˜åŒ–ä¸å¤§ï¼Œ$\boldsymbol{v}_1^{(t)}\approx\boldsymbol{v}_1^{(t-1)}$ï¼š</p>
<div class="codehilite"><pre><span></span><code>v = v_cached  # ä½¿ç”¨ä¸Šä¸€æ­¥çš„v1ä½œä¸ºåˆå§‹åŒ–
v = power_iteration(W, v, num_iterations=1)
v_cached = v
</code></pre></div>

<p>è¿™æ ·æ¯æ­¥åªéœ€1æ¬¡å¹‚è¿­ä»£ï¼Œæ•ˆæœä»ç„¶è‰¯å¥½ã€‚</p>
<p><strong>ç­–ç•¥3ï¼šéšæœºåŒ–æ–¹æ³•</strong></p>
<p>å¯¹äºéå¸¸å¤§çš„çŸ©é˜µï¼Œå¯ä»¥ä½¿ç”¨éšæœºSVDï¼ˆRandomized SVDï¼‰ï¼š</p>
<div class="codehilite"><pre><span></span><code>Omega = random_matrix(m, k)  # k &lt;&lt; m
Y = W @ Omega
Q, _ = qr(Y)  # QRåˆ†è§£
B = Q.T @ W
U_B, Sigma, Vt = svd(B)  # å¯¹å°çŸ©é˜µåšSVD
u1 = Q @ U_B[:, 0]
v1 = Vt[0, :]
</code></pre></div>

<p>å¤æ‚åº¦ï¼š$\mathcal{O}(nmk)$ï¼Œ$k\sim 10$é€šå¸¸è¶³å¤Ÿã€‚</p>
<h4 id="112">11.2 æ•°å€¼ç¨³å®šæ€§</h4>
<p><strong>é—®é¢˜</strong>ï¼šå½“$\sigma_1(\boldsymbol{W})\to 0$æ—¶ï¼Œ$\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$å¯èƒ½ä¸ç¨³å®šã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š
1. <strong>æ·»åŠ æ­£åˆ™é¡¹</strong>ï¼šè®¡ç®—$\boldsymbol{v}<em _min="\min">1$æ—¶ä½¿ç”¨$\boldsymbol{W}^{\top}\boldsymbol{W}+\epsilon\boldsymbol{I}$ã€‚
2. <strong>é˜ˆå€¼æ£€æŸ¥</strong>ï¼šè‹¥$\sigma_1&lt;\epsilon</em>$ï¼Œå›é€€åˆ°L2è¡°å‡æˆ–ä¸æ–½åŠ è¡°å‡ã€‚
3. <strong>æ··åˆç­–ç•¥</strong>ï¼š
   $$\text{Decay} = \alpha\cdot\sigma_1\boldsymbol{u}_1\boldsymbol{v}_1^{\top} + (1-\alpha)\cdot\boldsymbol{W}$$
   å…¶ä¸­$\alpha\in[0,1]$æ ¹æ®$\sigma_1/\Vert\boldsymbol{W}\Vert_F$è‡ªé€‚åº”è°ƒæ•´ã€‚</p>
<h4 id="113">11.3 åˆ†å¸ƒå¼è®­ç»ƒçš„è€ƒè™‘</h4>
<p>åœ¨æ•°æ®å¹¶è¡Œçš„åˆ†å¸ƒå¼è®­ç»ƒä¸­ï¼Œæ¢¯åº¦åœ¨å„è®¾å¤‡é—´å¹³å‡ã€‚è°±æƒé‡è¡°å‡éœ€è¦åœ¨æ¢¯åº¦èšåˆ<strong>ä¹‹å</strong>è®¡ç®—ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="gh">#</span> é”™è¯¯ï¼šå„è®¾å¤‡ç‹¬ç«‹è®¡ç®—v1ï¼Œç„¶åå¹³å‡ âŒ
v1_local = compute_v1(W_local)
v1 = all_reduce_mean(v1_local)  # å¹³å‡åçš„v1ä¸æ­£ç¡®

<span class="gh">#</span> æ­£ç¡®ï¼šèšåˆæ¢¯åº¦åï¼Œåœ¨ä¸»è®¾å¤‡ä¸Šè®¡ç®—v1 âœ“
grad = all_reduce_mean(grad_local)
v1 = compute_v1(W)  # Wåœ¨æ‰€æœ‰è®¾å¤‡ä¸Šä¸€è‡´
decay = sigma1 * outer(u1, v1)
</code></pre></div>

<h3 id="12_1">12. æ€»ç»“ä¸å±•æœ›</h3>
<h4 id="121">12.1 ç†è®ºè´¡çŒ®æ€»ç»“</h4>
<p>æœ¬æ–‡ä»å¤šä¸ªè§’åº¦æ·±å…¥åˆ†æäº†è°±èŒƒæ•°åŠå…¶åœ¨æƒé‡è¡°å‡ä¸­çš„åº”ç”¨ï¼š</p>
<ol>
<li>
<p><strong>çŸ©é˜µç†è®ºè§†è§’</strong>ï¼šè°±èŒƒæ•°æ˜¯çŸ©é˜µçš„æœ¬è´¨ä¸å˜é‡ï¼Œé€šè¿‡SVDä¸å¥‡å¼‚å€¼ç´§å¯†è”ç³»ï¼Œæ¢¯åº¦ä¸ºç§©1çŸ©é˜µ$\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$ã€‚</p>
</li>
<li>
<p><strong>ä¼˜åŒ–ç†è®ºè§†è§’</strong>ï¼šè°±æƒé‡è¡°å‡ç²¾å‡†æ§åˆ¶æœ€å¤§å¥‡å¼‚å€¼ï¼Œé¿å…L2è¡°å‡çš„è¿‡åº¦æ­£åˆ™åŒ–ï¼›ä¸è°±å½’ä¸€åŒ–ç›¸å…³ï¼Œä½†ä½œä¸ºè½¯çº¦æŸæ›´çµæ´»ã€‚</p>
</li>
<li>
<p><strong>æ³›åŒ–ç†è®ºè§†è§’</strong>ï¼šè°±çº¦æŸå¯¼è‡´æ›´ç´§çš„æ³›åŒ–ç•Œï¼ˆRademacherå¤æ‚åº¦ã€PAC-Bayesç•Œï¼‰ï¼Œç†è®ºä¸Šä¼˜äºFèŒƒæ•°çº¦æŸã€‚</p>
</li>
<li>
<p><strong>è®¡ç®—è§†è§’</strong>ï¼šå¹‚è¿­ä»£æä¾›é«˜æ•ˆè¿‘ä¼¼ï¼Œå¤æ‚åº¦$\mathcal{O}(tnm)$å¯æ¥å—ï¼›ç¼“å­˜å’ŒéšæœºåŒ–è¿›ä¸€æ­¥æå‡æ•ˆç‡ã€‚</p>
</li>
</ol>
<h4 id="122">12.2 å¼€æ”¾é—®é¢˜</h4>
<ol>
<li>
<p><strong>éå‡¸ä¼˜åŒ–çš„å…¨å±€æ€§è´¨</strong>ï¼šæ·±åº¦ç½‘ç»œä¸­è°±æƒé‡è¡°å‡çš„å…¨å±€æ”¶æ•›æ€§ä»ç¼ºä¹ç†è®ºä¿è¯ã€‚</p>
</li>
<li>
<p><strong>è‡ªé€‚åº”è¶…å‚æ•°</strong>ï¼š$\lambda$çš„é€‰æ‹©ç›®å‰ä¾èµ–ç»éªŒï¼Œèƒ½å¦è®¾è®¡è‡ªé€‚åº”æœºåˆ¶ï¼ˆå¦‚æ ¹æ®è®­ç»ƒé˜¶æ®µè°ƒæ•´ï¼‰ï¼Ÿ</p>
</li>
<li>
<p><strong>ä¸å…¶ä»–æŠ€æœ¯çš„ç»“åˆ</strong>ï¼šè°±æƒé‡è¡°å‡ä¸Batch Normalizationã€Layer Normalizationç­‰å½’ä¸€åŒ–æŠ€æœ¯çš„äº¤äº’ä½œç”¨éœ€è¦è¿›ä¸€æ­¥ç ”ç©¶ã€‚</p>
</li>
<li>
<p><strong>å¤§è§„æ¨¡å®éªŒéªŒè¯</strong>ï¼šåœ¨LLMç­‰å¤§è§„æ¨¡æ¨¡å‹ä¸Šçš„ç³»ç»Ÿæ€§å®éªŒä»ç„¶ä¸è¶³ã€‚</p>
</li>
</ol>
<h4 id="123">12.3 æœªæ¥æ–¹å‘</h4>
<ol>
<li>
<p><strong>å¼ é‡æ­£åˆ™åŒ–</strong>ï¼šå°†è°±èŒƒæ•°æ¨å¹¿åˆ°é«˜é˜¶å¼ é‡ï¼ˆå¦‚å·ç§¯æ ¸ï¼‰ï¼Œå®šä¹‰åŸºäºå¼ é‡åˆ†è§£çš„æ­£åˆ™é¡¹ã€‚</p>
</li>
<li>
<p><strong>åŠ¨æ€æ­£åˆ™åŒ–</strong>ï¼šæ ¹æ®è®­ç»ƒè¿›åº¦åŠ¨æ€è°ƒæ•´æ­£åˆ™åŒ–å¼ºåº¦ï¼Œä¾‹å¦‚æ—©æœŸä¾§é‡è¡¨è¾¾èƒ½åŠ›ï¼ˆå°$\lambda$ï¼‰ï¼ŒåæœŸä¾§é‡æ³›åŒ–ï¼ˆå¤§$\lambda$ï¼‰ã€‚</p>
</li>
<li>
<p><strong>ç†è®º-å®è·µçš„æ¡¥æ¢</strong>ï¼šè®¾è®¡æ›´å¤šçš„å®éªŒæ¥éªŒè¯ç†è®ºé¢„æµ‹ï¼ˆå¦‚æ³›åŒ–ç•Œçš„æ”¹è¿›ï¼‰ï¼Œå»ºç«‹ç†è®ºä¸å®è·µçš„åé¦ˆå¾ªç¯ã€‚</p>
</li>
<li>
<p><strong>ç¡¬ä»¶ä¼˜åŒ–</strong>ï¼šé’ˆå¯¹è°±èŒƒæ•°è®¡ç®—å¼€å‘ä¸“é—¨çš„ç¡¬ä»¶åŠ é€Ÿå™¨æˆ–é«˜æ•ˆåº“ï¼Œé™ä½è®¡ç®—å¼€é”€ã€‚</p>
</li>
</ol>
<p>è°±èŒƒæ•°ä½œä¸ºçŸ©é˜µçš„åŸºæœ¬å±æ€§ï¼Œåœ¨æ·±åº¦å­¦ä¹ ä¼˜åŒ–ä¸­æœ‰ç€å¹¿é˜”çš„åº”ç”¨å‰æ™¯ã€‚æœ¬æ–‡çš„æ¨å¯¼ä¸ºç†è§£å’Œåº”ç”¨è°±æ­£åˆ™åŒ–æä¾›äº†åšå®çš„æ•°å­¦åŸºç¡€ï¼ŒæœŸå¾…æœªæ¥æœ‰æ›´å¤šçš„ç†è®ºçªç ´å’Œå®è·µéªŒè¯ã€‚</p>
        </div>
    </div>
</body>
</html>