<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š4. Muon + è°±çƒé¢</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>æµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š4. Muon + è°±çƒé¢</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 42.8 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11241">https://spaces.ac.cn/archives/11241</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>çœ‹å®Œäº†å‰ä¸‰ç¯‡çš„è¯»è€…ï¼Œæƒ³å¿…å·²ç»ç†Ÿæ‚‰æœ¬ç³»åˆ—çš„â€œå¥—è·¯â€â€”â€”å…ˆæå‡ºæ›´æ–°é‡çš„çº¦æŸï¼Œå¯»æ‰¾æœ€é€Ÿä¸‹é™æ–¹å‘ï¼Œæ¥ç€å†ç»™å‚æ•°ä¹ŸåŠ ä¸Šçº¦æŸï¼Œå¯»æ‰¾æ–°çš„æœ€é€Ÿä¸‹é™æ–¹å‘ã€‚åœ¨æ±‚è§£å‚æ•°çº¦æŸé—®é¢˜æ—¶ï¼Œæˆ‘ä»¬é‡‡ç”¨çš„æ˜¯â€œä¸€é˜¶è¿‘ä¼¼å¤Ÿç”¨â€åŸåˆ™æ¥ç®€åŒ–çº¦æŸå½¢å¼ï¼Œè¿™åœ¨å‡ ä½•ä¸Šå¯¹åº”äºâ€œåˆ‡ç©ºé—´â€ã€‚ç„¶åï¼Œæˆ‘ä»¬ç”¨å¾…å®šç³»æ•°æ³•è½¬åŒ–æ— çº¦æŸå½¢å¼æ¥å†™å‡ºè§£æè§£ï¼Œæœ€åå†æ•°å€¼æ±‚è§£å¾…å®šç³»æ•°ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« æˆ‘ä»¬å†æ¥æ±‚è§£ä¸€ä¸ªæ–°ä¾‹å­â€”â€”è°±çƒé¢çº¦æŸä¸‹çš„Muonâ€”â€”å®ƒæ˜¯ç¬¬ä¸€ç¯‡æ–‡ç« <a href="/archives/11196">ã€Šæµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š1. SGD + è¶…çƒé¢ã€‹</a>çš„ç±»æ¯”æ¨å¹¿ï¼Œå½“æˆ‘ä»¬å¸Œæœ›å‚æ•°çš„è°±èŒƒæ•°å§‹ç»ˆä¸å˜æ—¶å¯ä»¥è€ƒè™‘å®ƒã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥å•çº¯ä½œä¸ºä¸€é“ç»ƒä¹ é¢˜æ¥ç»ƒæ‰‹ã€‚</p>
<h2 id="_1">é—®é¢˜æè¿°</h2>
<p>åœ¨<a href="/archives/11215">ã€Šæµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š2. Muon + æ­£äº¤ã€‹</a>å’Œ<a href="/archives/11221">ã€Šæµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š3. Muon + Stiefelã€‹</a>ä¸­ï¼Œæˆ‘ä»¬å·²ç»è¯¦ç»†è®¨è®ºäº†Muonä¸æ­£äº¤çº¦æŸçš„ç¢°æ’ï¼Œæ‰€ä»¥ç›¸å…³èƒŒæ™¯æˆ‘ä»¬å°±ä¸å±•å¼€äº†ï¼Œç›´æ¥ç»™å‡ºé—®é¢˜å½¢å¼ï¼š<br />
\begin{equation}\newcommand{tr}{\mathop{\text{tr}}}\max_{\boldsymbol{\Phi}} \tr(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) \qquad \text{s.t.}\qquad \Vert\boldsymbol{\Phi}\Vert_2 = 1,\,\, \Vert\boldsymbol{W}\Vert_2 = 1,\,\,\Vert\boldsymbol{W} - \eta \boldsymbol{\Phi}\Vert_2=1\end{equation}<br />
å…¶ä¸­$\boldsymbol{W},\boldsymbol{\Phi}\in\mathbb{R}^{n\times m}(n \geq m)$ï¼Œ$\Vert\cdot\Vert_2$æ˜¯è°±èŒƒæ•°ã€‚å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æœ‰å…´è¶£ï¼Œåé¢ä¸¤ä¸ªè°±èŒƒæ•°å¯ä»¥æ”¹ç”¨å…¶ä»–èŒƒæ•°ï¼Œæ¯”å¦‚$F$èŒƒæ•°ä»£è¡¨äº†â€œMuon + è¶…çƒé¢â€çš„ç»„åˆã€‚</p>
<p>â€œä¸€é˜¶è¿‘ä¼¼å¤Ÿç”¨â€åŸåˆ™éœ€è¦æˆ‘ä»¬æ±‚è°±èŒƒæ•°çš„æ¢¯åº¦ï¼Œè¿™æˆ‘ä»¬åœ¨<a href="/archives/10648">ã€Šä»è°±èŒƒæ•°æ¢¯åº¦åˆ°æ–°å¼æƒé‡è¡°å‡çš„æ€è€ƒã€‹</a>å’Œ<a href="/archives/10878">ã€ŠSVDçš„å¯¼æ•°ã€‹</a>éƒ½å·²ç»ä»‹ç»è¿‡äº†ï¼Œç­”æ¡ˆæ˜¯$\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_2=\boldsymbol{u}_1 \boldsymbol{v}_1^{\top}$ï¼Œå…¶ä¸­$\boldsymbol{u}_1,\boldsymbol{v}_1$æ˜¯$\boldsymbol{W}$çš„æœ€å¤§å¥‡å¼‚å€¼å¯¹åº”çš„ä¸¤ä¸ªå¥‡å¼‚å‘é‡ï¼Œå¯ä»¥ç”±å¹‚è¿­ä»£æ±‚è§£ã€‚è¿™ä¸ªç»“æœè¿˜æœ‰ä¸ªæœ€å¤§å¥‡å¼‚å€¼å”¯ä¸€çš„å‡è®¾ï¼Œä¸å”¯ä¸€çš„æƒ…å†µæˆ‘ä»¬åé¢å†è®¨è®ºã€‚</p>
<p>å¦‚æœæ˜¯$F$èŒƒæ•°ï¼Œåˆ™æœ‰$\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert_F=\boldsymbol{W}/\Vert\boldsymbol{W}\Vert_F$ã€‚æ€»ä¹‹ï¼Œä¸ç®¡æ˜¯å“ªç§èŒƒæ•°ï¼Œéƒ½å­˜åœ¨ä¸€ä¸ªåªä¾èµ–äº$\boldsymbol{W}$çš„çŸ©é˜µ$\boldsymbol{\Theta}$ï¼Œä½¿å¾—$\nabla_{\boldsymbol{W}}\Vert\boldsymbol{W}\Vert=\boldsymbol{\Theta}$ï¼Œé‚£ä¹ˆç”±$\Vert\boldsymbol{W}\Vert = 1$å’Œ$\Vert\boldsymbol{W} - \eta \boldsymbol{\Phi}\Vert=1$å¯ä»¥å¾—åˆ°å®ƒçš„ä¸€é˜¶è¿‘ä¼¼ç‰ˆ$0 = \langle\boldsymbol{\Theta},\boldsymbol{\Phi}\rangle_F = \tr(\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi})$ã€‚æ‰€ä»¥ï¼Œåœ¨ä¸€é˜¶è¿‘ä¼¼ä¸‹ï¼Œæ­¤ç±»é—®é¢˜çš„é€šç”¨ææ³•æ˜¯ï¼š<br />
\begin{equation}\max_{\boldsymbol{\Phi}} \tr(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) \qquad \text{s.t.}\qquad \Vert\boldsymbol{\Phi}\Vert_2 = 1,\,\, \tr(\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi})=0\end{equation}</p>
<h2 id="_2">å¾…å®šç³»æ•°</h2>
<p>å¥—è·¯è¿˜æ˜¯ä¸€æ ·çš„ï¼Œå¼•å…¥å¾…å®šç³»æ•°$\lambda$ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\begin{aligned}<br />
\tr(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) =&amp;\, \tr(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) + \lambda \tr(\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi}) \\\<br />
=&amp;\, \tr((\boldsymbol{G} + \lambda\boldsymbol{\Theta})^{\top}\boldsymbol{\Phi}) \\\<br />
\leq &amp;\,\Vert\boldsymbol{G} + \lambda\boldsymbol{\Theta}\Vert_*<br />
\end{aligned}\end{equation}<br />
æœ€åä¸€ä¸ªä¸ç­‰å¼æ˜¯Muonæœ¬èº«çš„ç»“æœï¼Œç±»ä¼¼äºä¸¤ä¸ªå‘é‡çš„HÃ¶lderä¸ç­‰å¼ï¼Œç­‰å·åœ¨<br />
\begin{equation}\boldsymbol{\Phi} = \newcommand{msign}{\mathop{\text{msign}}}\msign(\boldsymbol{G} + \lambda\boldsymbol{\Theta})\end{equation}<br />
æ¥ä¸‹æ¥çš„ä»»åŠ¡æ˜¯éœ€è¦è§£å‡ºä¸€ä¸ª$\lambda$ï¼Œä½¿å¾—å®ƒæ»¡è¶³çº¦æŸæ¡ä»¶$\tr(\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi})=0$ï¼Œå°±å¤§åŠŸå‘Šæˆäº†ã€‚</p>
<p>ç”±äº$\msign$çš„å­˜åœ¨ï¼Œ$\tr(\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi})=0$å®é™…ä¸Šæ˜¯ä¸€ä¸ªéçº¿æ€§æ–¹ç¨‹ï¼Œç¬”è€…å€¾å‘äºå®ƒæ²¡æœ‰è§£æè§£ï¼Œæ‰€ä»¥å¯»æ±‚æ•°å€¼è§£æ³•ã€‚ä¸è¿‡æœ‰äº†<a href="/archives/11221">ã€Šæµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š3. Muon + Stiefelã€‹</a>çš„ç»éªŒåï¼Œé¢å¯¹æ­¤ç±»æ–¹ç¨‹æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»å®¹åœ°æ„å»ºè¿­ä»£æ³•äº†ã€‚</p>
<h2 id="_3">è¿­ä»£æ±‚è§£</h2>
<p>é¦–å…ˆï¼Œæ ¹æ®å®šä¹‰$\msign(\boldsymbol{M}) = \boldsymbol{M}(\boldsymbol{M}^{\top}\boldsymbol{M})^{-1/2}$ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡º$\boldsymbol{\Phi}=(\boldsymbol{G} + \lambda\boldsymbol{\Theta})\boldsymbol{Q}^{-1}$ï¼Œå…¶ä¸­$\boldsymbol{Q}=((\boldsymbol{G} + \lambda\boldsymbol{\Theta})^{\top}(\boldsymbol{G} + \lambda\boldsymbol{\Theta}))^{1/2}$ï¼Œé‚£ä¹ˆ<br />
\begin{equation}\tr(\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi})=0\qquad\Rightarrow\qquad \lambda = -\frac{\tr(\boldsymbol{\Theta}^{\top}\boldsymbol{G}\boldsymbol{Q}^{-1})}{\tr(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta}\boldsymbol{Q}^{-1})}\end{equation}<br />
ä½†è¦æ³¨æ„ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªè§£æè§£ï¼Œå› ä¸º$\boldsymbol{Q}$ä¹Ÿæ˜¯ä¾èµ–äº$\lambda$çš„ã€‚ä½†æ ¹æ®ä¸Šå¼æˆ‘ä»¬å¯ä»¥æ„å»ºä¸€ä¸ªè¿­ä»£æ ¼å¼ï¼šä»£å…¥ä¸€ä¸ªåˆå§‹$\lambda$å°±å¯ä»¥æ±‚$\boldsymbol{Q}= (\boldsymbol{G} + \lambda\boldsymbol{\Theta})^{\top}\boldsymbol{\Phi}$ï¼Œç„¶åä»£å…¥ä¸Šå¼æ›´æ–°$\lambda$ï¼Œåå¤æ‰§è¡Œç›´åˆ°æ”¶æ•›ã€‚</p>
<p>ç„¶è€Œï¼Œè¿™ä¸ªè¿­ä»£æ–¹æ¡ˆè™½ç„¶ç†è®ºä¸Šå¯è¡Œï¼Œä½†éœ€è¦ç®—$\boldsymbol{Q}^{-1}$ï¼Œå°½ç®¡æˆ‘ä»¬åœ¨<a href="/archives/11175">ã€ŠçŸ©é˜µræ¬¡æ–¹æ ¹å’Œé€†ræ¬¡æ–¹æ ¹çš„é«˜æ•ˆè®¡ç®—ã€‹</a>å·²ç»æè¿‡é«˜æ•ˆçš„æ±‚è§£ç®—æ³•ï¼Œä½†ä»â€œå‹¿å¢å®ä½“â€çš„è§’åº¦çœ‹ï¼Œæˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›é¿å…å‡ºç°$\msign$ä»¥å¤–çš„è¿­ä»£ã€‚æ‰€ä»¥ï¼Œç¬”è€…å°è¯•å¯»æ‰¾å¦å¤–ä¸€ä¸ªä¸éœ€è¦æ±‚$\boldsymbol{Q}^{-1}$çš„è¿­ä»£æ–¹æ¡ˆã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å…ˆå†™å‡º<br />
\begin{equation}\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi} = \boldsymbol{\Theta}^{\top}(\boldsymbol{G} + \lambda\boldsymbol{\Theta})\boldsymbol{Q}^{-1}\end{equation}<br />
å¯¹äºæˆ‘ä»¬çš„ç›®æ ‡ï¼Œä¸Šå¼çš„è¿¹ç­‰äºé›¶ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ä¸Šå¼å·¦è¾¹æ˜¾å¼åœ°å‡å»$\tr(\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi})\boldsymbol{I}/m$ï¼Œä¿è¯å®ƒæ»¡è¶³è¿™ä¸ªæ¡ä»¶<br />
\begin{equation}\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi} - \tr(\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi})\boldsymbol{I}/m = \boldsymbol{\Theta}^{\top}(\boldsymbol{G} + \lambda\boldsymbol{\Theta})\boldsymbol{Q}^{-1}\end{equation}<br />
è¿™æ—¶å€™ä¸¤è¾¹ä¹˜$\boldsymbol{Q}$ï¼Œç„¶åå–è¿¹å°±å¯ä»¥åè§£å‡º$\lambda$<br />
\begin{equation}\lambda = \frac{\tr(\boldsymbol{\Theta}^{\top} \boldsymbol{\Phi}\boldsymbol{Q}) - \tr(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi}) \tr(\boldsymbol{Q})/m - \tr(\boldsymbol{\Theta}^{\top}\boldsymbol{G})}{\tr(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta})}\end{equation}<br />
è¿™æ ·è¿­ä»£èµ·æ¥å°±ä¸ç”¨æ±‚$\boldsymbol{Q}^{-1}$äº†ã€‚</p>
<h2 id="_4">å‚è€ƒä»£ç </h2>
<p>æˆ‘ä»¬ä»¥$\lambda=-\tr(\boldsymbol{\Theta}^{\top}\boldsymbol{G})/\tr(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta})$ä¸ºåˆå§‹å€¼ï¼Œæµ‹è¯•ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">msign</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;å¥‡å¼‚å€¼åˆ†è§£ç²¾ç¡®è®¡ç®—msign</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="kp">svd</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">u</span> <span class="o">@</span> <span class="n">np</span><span class="o">.</span><span class="kp">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="kp">sign</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">@</span> <span class="n">vh</span>

<span class="k">def</span><span class="w"> </span><span class="nf">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;æ’ç­‰äº np.trace(a.T @ b)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="kp">sum</span><span class="p">()</span>

<span class="n">n</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">50</span>
<span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="kp">svd</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">full_matrices</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">u</span><span class="p">[:,</span> <span class="p">:</span><span class="mi">1</span><span class="p">]</span> <span class="o">@</span> <span class="n">vh</span><span class="p">[:</span><span class="mi">1</span><span class="p">]</span>

<span class="n">lamb</span> <span class="o">=</span> <span class="o">-</span> <span class="kp">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span> <span class="o">/</span> <span class="kp">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">msign</span><span class="p">(</span><span class="n">z</span> <span class="o">:=</span> <span class="n">g</span> <span class="o">+</span> <span class="n">lamb</span> <span class="o">*</span> <span class="n">theta</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;step:&#39;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s1">&#39;, inner product:&#39;</span><span class="p">,</span> <span class="kp">dot</span><span class="p">(</span><span class="n">phi</span><span class="p">,</span> <span class="n">g</span><span class="p">),</span> <span class="s1">&#39;, tangent error:&#39;</span><span class="p">,</span> <span class="kp">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">))</span>
    <span class="n">q</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">phi</span>
    <span class="n">lamb</span> <span class="o">=</span> <span class="p">(</span><span class="kp">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="kp">trace</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="kp">trace</span><span class="p">(</span><span class="n">q</span><span class="p">)</span> <span class="o">/</span> <span class="n">m</span> <span class="o">-</span> <span class="kp">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">g</span><span class="p">))</span> <span class="o">/</span> <span class="kp">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
</code></pre></div>

<h2 id="_5">å…¶ä»–ç»†èŠ‚</h2>
<p>åŒå‰ä¸‰ç¯‡æ–‡ç« ä¸€æ ·ï¼Œç”±äºä½¿ç”¨äº†â€œä¸€é˜¶è¿‘ä¼¼å¤Ÿç”¨â€åŸåˆ™ï¼Œæ‰€ä»¥$\boldsymbol{W} - \eta\boldsymbol{\Phi}$çš„è°±èŒƒæ•°å‡†ç¡®åˆ°$1 + \mathcal{O}(\eta^2)$ï¼Œé€šå¸¸æ²¡æ³•ç²¾ç¡®åˆ°1ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜éœ€è¦åšä¸€æ¬¡è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰ï¼š<br />
\begin{equation}\boldsymbol{W}\quad\leftarrow\quad \frac{\boldsymbol{W} - \eta\boldsymbol{\Phi}}{\Vert\boldsymbol{W} - \eta\boldsymbol{\Phi}\Vert_2}\end{equation}<br />
å¹¸è¿çš„æ˜¯ï¼Œè°±èŒƒæ•°å¯ä»¥é€šè¿‡å¹‚è¿­ä»£æ¥é«˜æ•ˆè®¡ç®—ï¼Œæ‰€ä»¥è¿™å¹¶ä¸æ˜¯ç‰¹åˆ«æ˜‚è´µçš„è®¡ç®—ï¼ˆç›¸æ¯”$\msign$æœ¬èº«çš„è¿­ä»£æ¥è¯´ï¼‰ã€‚</p>
<p>å¦å¤–å¯ä»¥å€¼å¾—åˆ†æä¸€ç•ªçš„æ˜¯æœ€å¤§å¥‡å¼‚å€¼ä¸å”¯ä¸€çš„æƒ…å½¢ï¼Œå®é™…æ•°å€¼è®¡ç®—æ—¶å¯ä»¥å¿½ç•¥è¿™ç§ç‰¹æ®Šæƒ…å½¢ï¼Œä½†ä»ç†è®ºçš„å®Œæ•´æ€§æ¥è¯´åº”è¯¥å°†å®ƒçº³å…¥åˆ†æèŒƒå›´å†…ã€‚è¿™æ—¶å€™å¯¹åº”çš„å¥‡å¼‚å‘é‡ä¹Ÿä¸å”¯ä¸€ï¼Œç­‰ä»·äºè¯´æœ‰å¤šä¸ªä¸åŒçš„åˆ‡ç©ºé—´ï¼Œå®é™…å¯è¡Œç©ºé—´æ˜¯è¿™äº›åˆ‡ç©ºé—´çš„äº¤é›†ã€‚æˆ‘ä»¬ä»¥ä¸¤ä¸ªæœ€å¤§å¥‡å¼‚å€¼ä¸ºä¾‹ï¼Œæ­¤æ—¶é—®é¢˜å˜æˆ<br />
\begin{equation}\max_{\boldsymbol{\Phi}} \tr(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) \qquad \text{s.t.}\qquad \Vert\boldsymbol{\Phi}\Vert_2 = 1,\,\, \tr(\boldsymbol{\Theta}_1^{\top} \boldsymbol{\Phi})=0,\,\, \tr(\boldsymbol{\Theta}_2^{\top} \boldsymbol{\Phi})=0\end{equation}<br />
è¿™é‡Œ$\boldsymbol{\Theta}_1=\boldsymbol{u}_1 \boldsymbol{v}_1^{\top}, \boldsymbol{\Theta}_2=\boldsymbol{u}_2 \boldsymbol{v}_2^{\top}$ã€‚å¼•å…¥ä¸¤ä¸ªå¾…å®šç³»æ•°$\lambda_1,\lambda_2$ï¼Œæˆ‘ä»¬å¯ä»¥è§£å¾—<br />
\begin{equation}\boldsymbol{\Phi} = \msign(\boldsymbol{G} + \lambda_1\boldsymbol{\Theta}_1+ \lambda_2\boldsymbol{\Theta}_2)\end{equation}<br />
æ¥ä¸‹æ¥è¦æ±‚è§£æ–¹ç¨‹ç»„$\tr(\boldsymbol{\Theta}_1^{\top} \boldsymbol{\Phi})=0,\tr(\boldsymbol{\Theta}_2^{\top} \boldsymbol{\Phi})=0$ã€‚ç±»ä¼¼åœ°ï¼Œå¼•å…¥<br />
\begin{equation}\boldsymbol{Q}=((\boldsymbol{G} + \lambda_1\boldsymbol{\Theta}_1+ \lambda_2\boldsymbol{\Theta}_2)^{\top}(\boldsymbol{G} + \lambda_1\boldsymbol{\Theta}_1+ \lambda_2\boldsymbol{\Theta}_2))^{1/2} = (\boldsymbol{G} + \lambda_1\boldsymbol{\Theta}_1+ \lambda_2\boldsymbol{\Theta}_2)^{\top}\boldsymbol{\Phi}\end{equation}<br />
å¯ä»¥å†™å‡ºæ–¹ç¨‹ç»„<br />
\begin{equation}\begin{gathered}<br />
\boldsymbol{\Theta}_1^{\top} \boldsymbol{\Phi} - \tr(\boldsymbol{\Theta}_1^{\top} \boldsymbol{\Phi})\boldsymbol{I}/m = \boldsymbol{\Theta}_1^{\top}(\boldsymbol{G} + \lambda_1\boldsymbol{\Theta}_1+ \lambda_2\boldsymbol{\Theta}_2)\boldsymbol{Q}^{-1} \\\<br />
\boldsymbol{\Theta}_2^{\top} \boldsymbol{\Phi} - \tr(\boldsymbol{\Theta}_2^{\top} \boldsymbol{\Phi})\boldsymbol{I}/m = \boldsymbol{\Theta}_2^{\top}(\boldsymbol{G} + \lambda_1\boldsymbol{\Theta}_1+ \lambda_2\boldsymbol{\Theta}_2)\boldsymbol{Q}^{-1} \\\<br />
\end{gathered}\end{equation}<br />
ä¸¤è¾¹ä¹˜$\boldsymbol{Q}$ç„¶åå–è¿¹ï¼Œå°±å˜æˆäº†å…³äºå¯ä»¥æ±‚è§£çš„$\lambda_1,\lambda_2$çš„äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹ç»„ï¼Œé‚£ä¹ˆå°±å¯ä»¥æ®æ­¤æ¥æ„å»ºè¿­ä»£æ±‚è§£æ ¼å¼äº†ã€‚å…¶ä¸­ç»†èŠ‚å°±ä¸å±•å¼€è®¨è®ºäº†ï¼Œæœ‰å…´è¶£ç»ƒæ‰‹çš„è¯»è€…è‡ªè¡Œè¡¥å……å®Œæ•´å°±å¥½ã€‚</p>
<h2 id="_6">æ–‡ç« å°ç»“</h2>
<p>è¿™ç¯‡æ–‡ç« ä¸»è¦è€ƒè™‘äº†ç»™å‚æ•°æ–½åŠ è°±èŒƒæ•°æˆ–è€…ä¸€èˆ¬çš„èŒƒæ•°çº¦æŸåï¼Œå¯¹åº”çš„Muonå½¢å¼ã€‚åœ¨å‰ä¸‰ç¯‡çš„åŸºç¡€ä¸Šï¼Œæœ¬ç¯‡æ²¡æœ‰æ˜æ˜¾çš„æŠ€æœ¯éš¾ç‚¹ï¼Œè¯»è€…ä¹Ÿå¯ä»¥å•çº¯è§†ä¸ºä¸€é“è¡¥å……ä¹ é¢˜æ¥ç»ƒæ‰‹ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11241">https://spaces.ac.cn/archives/11241</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Aug. 21, 2025). ã€Šæµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š4. Muon + è°±çƒé¢ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11241">https://spaces.ac.cn/archives/11241</a></p>
<p>@online{kexuefm-11241,<br />
title={æµå½¢ä¸Šçš„æœ€é€Ÿä¸‹é™ï¼š4. Muon + è°±çƒé¢},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Aug},<br />
url={\url{https://spaces.ac.cn/archives/11241}},<br />
} </p>
<hr />
<h2 id="_7">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">1. è°±çƒé¢çš„æ•°å­¦å®šä¹‰</h3>
<p><strong>å®šä¹‰1.1ï¼ˆè°±çƒé¢ï¼‰</strong>ï¼šè°±çƒé¢æ˜¯æ‰€æœ‰è°±èŒƒæ•°ä¸º1çš„çŸ©é˜µçš„é›†åˆï¼š</p>
<p>$$
\mathcal{S}_{\text{spec}}(n,m) = \{\boldsymbol{W}\in\mathbb{R}^{n\times m} : \|\boldsymbol{W}\|_2 = 1\}
$$</p>
<p>å…¶ä¸­$|\boldsymbol{W}|<em _max="\max">2 = \sigma</em>)$æ˜¯æœ€å¤§å¥‡å¼‚å€¼ã€‚}(\boldsymbol{W</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè°±çƒé¢ä¸æ ‡å‡†Frobeniusçƒé¢${\boldsymbol{W} : |\boldsymbol{W}|_F = 1}$ä¸åŒï¼Œè°±çƒé¢åªçº¦æŸæœ€å¤§å¥‡å¼‚å€¼ï¼Œå…è®¸å…¶ä»–å¥‡å¼‚å€¼ä»»æ„å˜åŒ–ã€‚è¿™ä½¿å¾—è°±çƒé¢æ˜¯ä¸€ä¸ªæ›´"è–„"çš„æµå½¢ã€‚</p>
<p><strong>æ¨å¯¼1.1ï¼ˆè°±çƒé¢çš„å‡ ä½•ç›´è§‚ï¼‰</strong>ï¼šè€ƒè™‘çŸ©é˜µ$\boldsymbol{W}$çš„å¥‡å¼‚å€¼åˆ†è§£ï¼š</p>
<p>$$
\boldsymbol{W} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top} = \sum_{i=1}^r \sigma_i \boldsymbol{u}_i\boldsymbol{v}_i^{\top}
$$</p>
<p>å…¶ä¸­$r = \text{rank}(\boldsymbol{W})$ã€‚è°±èŒƒæ•°çº¦æŸ$|\boldsymbol{W}|_2 = 1$ç­‰ä»·äº$\sigma_1 = 1$ï¼Œè€Œå¯¹å…¶ä»–å¥‡å¼‚å€¼$\sigma_2,\ldots,\sigma_r$æ— çº¦æŸï¼ˆåªè¦$\sigma_i \leq 1$ï¼‰ã€‚</p>
<p><strong>å¼•ç†1.1ï¼ˆè°±çƒé¢ä¸æ˜¯åµŒå…¥å­æµå½¢ï¼‰</strong>ï¼šåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè°±çƒé¢åœ¨æœ€å¤§å¥‡å¼‚å€¼é‡æ•°å¤§äº1çš„ç‚¹å¤„ä¸æ˜¯å…‰æ»‘æµå½¢ï¼Œè€Œæ˜¯å…·æœ‰å¥‡å¼‚ç‚¹çš„åˆ†å±‚æµå½¢ã€‚</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼šå½“$\sigma_1 = \sigma_2 = \cdots = \sigma_k = 1 &gt; \sigma_{k+1}$æ—¶ï¼Œå¯¹åº”çš„å¥‡å¼‚å‘é‡ç»„${\boldsymbol{u}_1,\ldots,\boldsymbol{u}_k}$å’Œ${\boldsymbol{v}_1,\ldots,\boldsymbol{v}_k}$ä¸å”¯ä¸€ï¼Œå¯¼è‡´åˆ‡ç©ºé—´çš„ç»´æ•°è·³å˜ã€‚</p>
<h3 id="2">2. è°±èŒƒæ•°çš„æ¢¯åº¦æ¨å¯¼</h3>
<p><strong>å®šç†2.1ï¼ˆè°±èŒƒæ•°çš„æ¢¯åº¦ï¼‰</strong>ï¼šè®¾$\boldsymbol{W} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$æ˜¯SVDåˆ†è§£ï¼Œè‹¥æœ€å¤§å¥‡å¼‚å€¼$\sigma_1$æ˜¯ç®€å•çš„ï¼ˆé‡æ•°ä¸º1ï¼‰ï¼Œåˆ™ï¼š</p>
<p>$$
\nabla\|\boldsymbol{W}\|_2 = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}
$$</p>
<p>å…¶ä¸­$\boldsymbol{u}_1,\boldsymbol{v}_1$æ˜¯å¯¹åº”äº$\sigma_1$çš„å·¦å³å¥‡å¼‚å‘é‡ã€‚</p>
<p><strong>æ¨å¯¼2.1ï¼ˆä½¿ç”¨å˜åˆ†æ³•ï¼‰</strong>ï¼šè€ƒè™‘æ‰°åŠ¨$\boldsymbol{W} + \epsilon\boldsymbol{H}$ï¼Œå…¶è°±èŒƒæ•°ä¸ºï¼š</p>
<p>$$
\|\boldsymbol{W} + \epsilon\boldsymbol{H}\|_2 = \max_{\|\boldsymbol{x}\|=1} \|(\boldsymbol{W}+\epsilon\boldsymbol{H})\boldsymbol{x}\|
$$</p>
<p>è®¾$\boldsymbol{x}^*=\boldsymbol{v}_1$æ˜¯$\boldsymbol{W}$çš„æœ€å¤§å¥‡å¼‚å€¼å¯¹åº”çš„å³å¥‡å¼‚å‘é‡ï¼Œæ»¡è¶³$\boldsymbol{W}\boldsymbol{v}_1 = \sigma_1\boldsymbol{u}_1$ã€‚åˆ™ï¼š</p>
<p>$$
\begin{aligned}
\|\boldsymbol{W}+\epsilon\boldsymbol{H}\|_2 &\geq \|(\boldsymbol{W}+\epsilon\boldsymbol{H})\boldsymbol{v}_1\|\\
&= \|\boldsymbol{W}\boldsymbol{v}_1 + \epsilon\boldsymbol{H}\boldsymbol{v}_1\|\\
&= \|\sigma_1\boldsymbol{u}_1 + \epsilon\boldsymbol{H}\boldsymbol{v}_1\|\\
&= \sqrt{\sigma_1^2 + 2\epsilon\sigma_1\boldsymbol{u}_1^{\top}\boldsymbol{H}\boldsymbol{v}_1 + O(\epsilon^2)}\\
&= \sigma_1 + \epsilon\boldsymbol{u}_1^{\top}\boldsymbol{H}\boldsymbol{v}_1 + O(\epsilon^2)
\end{aligned}
$$</p>
<p>å½“$\sigma_1$ç®€å•æ—¶ï¼Œè¿™ç»™å‡ºäº†ä¸€é˜¶å¯¼æ•°ï¼š</p>
<p>$$
\frac{d}{d\epsilon}\Big|_{\epsilon=0}\|\boldsymbol{W}+\epsilon\boldsymbol{H}\|_2 = \boldsymbol{u}_1^{\top}\boldsymbol{H}\boldsymbol{v}_1 = \langle\boldsymbol{u}_1\boldsymbol{v}_1^{\top}, \boldsymbol{H}\rangle_F
$$</p>
<p>å› æ­¤æ¢¯åº¦ä¸º$\nabla|\boldsymbol{W}|_2 = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}$ã€‚</p>
<p><strong>æ¨å¯¼2.2ï¼ˆä½¿ç”¨çŸ©é˜µå¾®åˆ†ï¼‰</strong>ï¼šåˆ©ç”¨çŸ©é˜µèŒƒæ•°çš„å¾®åˆ†å…¬å¼ï¼š</p>
<p>$$
d\|\boldsymbol{W}\|_2 = \text{tr}((\nabla\|\boldsymbol{W}\|_2)^{\top}d\boldsymbol{W})
$$</p>
<p>ç»“åˆ$|\boldsymbol{W}|<em _124_boldsymbol_v="|\boldsymbol{v">2 = \max</em>_1)$å¤„ï¼š}|=1,|\boldsymbol{u}|=1}\boldsymbol{u}^{\top}\boldsymbol{W}\boldsymbol{v}$ï¼Œåœ¨æœ€ä¼˜ç‚¹$(\boldsymbol{u}_1,\boldsymbol{v</p>
<p>$$
d\|\boldsymbol{W}\|_2 = \boldsymbol{u}_1^{\top}(d\boldsymbol{W})\boldsymbol{v}_1 = \text{tr}(\boldsymbol{v}_1\boldsymbol{u}_1^{\top}d\boldsymbol{W}) = \text{tr}((\boldsymbol{u}_1\boldsymbol{v}_1^{\top})^{\top}d\boldsymbol{W})
$$</p>
<p>æ•…$\nabla|\boldsymbol{W}|_2 = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}$ã€‚</p>
<h3 id="3">3. è°±çƒé¢çš„åˆ‡ç©ºé—´å®Œæ•´æ¨å¯¼</h3>
<p><strong>å®šä¹‰3.1ï¼ˆåˆ‡ç©ºé—´ï¼‰</strong>ï¼šè°±çƒé¢åœ¨ç‚¹$\boldsymbol{W}$ï¼ˆæ»¡è¶³$|\boldsymbol{W}|_2=1$ä¸”æœ€å¤§å¥‡å¼‚å€¼ç®€å•ï¼‰å¤„çš„åˆ‡ç©ºé—´ä¸ºï¼š</p>
<p>$$
T_{\boldsymbol{W}}\mathcal{S}_{\text{spec}} = \{\boldsymbol{\Xi}\in\mathbb{R}^{n\times m} : \langle\boldsymbol{\Theta},\boldsymbol{\Xi}\rangle_F = 0\}
$$</p>
<p>å…¶ä¸­$\boldsymbol{\Theta} = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}$æ˜¯è°±èŒƒæ•°çš„æ¢¯åº¦ã€‚</p>
<p><strong>æ¨å¯¼3.1ï¼ˆåˆ‡ç©ºé—´æ¡ä»¶çš„å¯¼å‡ºï¼‰</strong>ï¼šè€ƒè™‘è°±çƒé¢ä¸Šé€šè¿‡$\boldsymbol{W}$çš„æ›²çº¿$\boldsymbol{W}(t)$ï¼Œæ»¡è¶³$|\boldsymbol{W}(t)|_2 = 1$ã€‚å¯¹çº¦æŸæ±‚å¯¼ï¼š</p>
<p>$$
\frac{d}{dt}\|\boldsymbol{W}(t)\|_2\Big|_{t=0} = \langle\nabla\|\boldsymbol{W}\|_2, \boldsymbol{W}'(0)\rangle_F = \langle\boldsymbol{\Theta},\boldsymbol{\Xi}\rangle_F = 0
$$</p>
<p>å…¶ä¸­$\boldsymbol{\Xi} = \boldsymbol{W}'(0)$æ˜¯åˆ‡å‘é‡ã€‚</p>
<p><strong>å®šç†3.1ï¼ˆåˆ‡ç©ºé—´çš„ç»´æ•°ï¼‰</strong>ï¼šå½“æœ€å¤§å¥‡å¼‚å€¼ç®€å•æ—¶ï¼Œåˆ‡ç©ºé—´çš„ç»´æ•°ä¸º$nm-1$ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šè°±çƒé¢ä½œä¸º$\mathbb{R}^{n\times m}$çš„ä½™ç»´æ•°1çš„è¶…æ›²é¢ï¼ˆåœ¨å…‰æ»‘ç‚¹å¤„ï¼‰ï¼Œå…¶åˆ‡ç©ºé—´ç»´æ•°ä¸º$nm-1$ã€‚</p>
<p><strong>æ¨å¯¼3.2ï¼ˆåˆ‡ç©ºé—´çš„æ˜¾å¼åˆ»ç”»ï¼‰</strong>ï¼šè®¾$\boldsymbol{W} = \sigma_1\boldsymbol{u}<em _perp="\perp">1\boldsymbol{v}_1^{\top} + \boldsymbol{W}</em>$æ˜¯å‰©ä½™éƒ¨åˆ†ã€‚åˆ‡ç©ºé—´å¯ä»¥åˆ†è§£ä¸ºï¼š}$ï¼Œå…¶ä¸­$\boldsymbol{W}_{\perp</p>
<p>$$
T_{\boldsymbol{W}}\mathcal{S}_{\text{spec}} = \text{span}\{\boldsymbol{u}_1\boldsymbol{v}_i^{\top}, \boldsymbol{u}_j\boldsymbol{v}_1^{\top} : i\neq 1, j\neq 1\} \oplus \{\boldsymbol{\Xi}_{\perp}\}
$$</p>
<p>å…¶ä¸­$\boldsymbol{\Xi}<em _perp="\perp">{\perp}$æ»¡è¶³$\boldsymbol{u}_1^{\top}\boldsymbol{\Xi}</em>$ã€‚} = \boldsymbol{0}$ä¸”$\boldsymbol{\Xi}_{\perp}\boldsymbol{v}_1 = \boldsymbol{0</p>
<h3 id="4">4. æŠ•å½±ç®—å­çš„æ¨å¯¼</h3>
<p><strong>å®šä¹‰4.1ï¼ˆåˆ‡ç©ºé—´æŠ•å½±ï¼‰</strong>ï¼šä»$\mathbb{R}^{n\times m}$åˆ°åˆ‡ç©ºé—´çš„æ­£äº¤æŠ•å½±ä¸ºï¼š</p>
<p>$$
\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) = \boldsymbol{M} - \frac{\langle\boldsymbol{\Theta},\boldsymbol{M}\rangle_F}{\|\boldsymbol{\Theta}\|_F^2}\boldsymbol{\Theta}
$$</p>
<p>ç”±äº$\boldsymbol{\Theta} = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}$ä¸”$|\boldsymbol{\Theta}|_F = 1$ï¼Œç®€åŒ–ä¸ºï¼š</p>
<p>$$
\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) = \boldsymbol{M} - (\boldsymbol{u}_1^{\top}\boldsymbol{M}\boldsymbol{v}_1)\boldsymbol{u}_1\boldsymbol{v}_1^{\top}
$$</p>
<p><strong>æ¨å¯¼4.1ï¼ˆæŠ•å½±ç®—å­çš„éªŒè¯ï¼‰</strong>ï¼šéœ€è¦éªŒè¯ï¼š
1. $\mathcal{P}<em _boldsymbol_W="\boldsymbol{W">{\boldsymbol{W}}(\boldsymbol{M})\in T</em>}}\mathcal{S<em _boldsymbol_W="\boldsymbol{W">{\text{spec}}$
2. $\boldsymbol{M}-\mathcal{P}</em>)$æ­£äº¤äºåˆ‡ç©ºé—´}}(\boldsymbol{M</p>
<p><strong>æ€§è´¨1çš„è¯æ˜</strong>ï¼š</p>
<p>$$
\langle\boldsymbol{\Theta},\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M})\rangle_F = \langle\boldsymbol{\Theta},\boldsymbol{M}\rangle_F - (\boldsymbol{u}_1^{\top}\boldsymbol{M}\boldsymbol{v}_1)\langle\boldsymbol{\Theta},\boldsymbol{\Theta}\rangle_F = \boldsymbol{u}_1^{\top}\boldsymbol{M}\boldsymbol{v}_1 - \boldsymbol{u}_1^{\top}\boldsymbol{M}\boldsymbol{v}_1 = 0
$$</p>
<p><strong>æ€§è´¨2çš„è¯æ˜</strong>ï¼š$\boldsymbol{M}-\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) = (\boldsymbol{u}_1^{\top}\boldsymbol{M}\boldsymbol{v}_1)\boldsymbol{\Theta}$æ˜¯$\boldsymbol{\Theta}$çš„æ ‡é‡å€ï¼Œæ˜¾ç„¶åœ¨æ³•ç©ºé—´ä¸­ã€‚</p>
<p><strong>å¼•ç†4.1ï¼ˆæŠ•å½±çš„å¹‚ç­‰æ€§ï¼‰</strong>ï¼š$\mathcal{P}<em _boldsymbol_W="\boldsymbol{W">{\boldsymbol{W}}^2 = \mathcal{P}</em>$ã€‚}</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>$$
\begin{aligned}
\mathcal{P}_{\boldsymbol{W}}(\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M})) &= \mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) - (\boldsymbol{u}_1^{\top}\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M})\boldsymbol{v}_1)\boldsymbol{\Theta}\\
&= \mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M}) - 0\cdot\boldsymbol{\Theta}\\
&= \mathcal{P}_{\boldsymbol{W}}(\boldsymbol{M})
\end{aligned}
$$</p>
<p>æœ€åä¸€æ­¥ä½¿ç”¨äº†$\mathcal{P}<em _boldsymbol_W="\boldsymbol{W">{\boldsymbol{W}}(\boldsymbol{M})\in T</em>}}\mathcal{S<em _boldsymbol_W="\boldsymbol{W">{\text{spec}}$ï¼Œæ•…$\boldsymbol{u}_1^{\top}\mathcal{P}</em>_1 = 0$ã€‚}}(\boldsymbol{M})\boldsymbol{v</p>
<h3 id="5-muon">5. Muonåœ¨è°±çƒé¢ä¸Šçš„çº¦æŸä¼˜åŒ–</h3>
<p><strong>é—®é¢˜5.1ï¼ˆè°±çƒé¢ä¸Šçš„Muonä¼˜åŒ–ï¼‰</strong>ï¼šç»™å®šæ¢¯åº¦$\boldsymbol{G}$å’Œæ»¡è¶³$|\boldsymbol{W}|_2=1$çš„å‚æ•°$\boldsymbol{W}$ï¼Œæ±‚è§£ï¼š</p>
<p>$$
\max_{\boldsymbol{\Phi}} \text{tr}(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) \quad \text{s.t.} \quad \|\boldsymbol{\Phi}\|_2 = 1, \quad \langle\boldsymbol{\Theta},\boldsymbol{\Phi}\rangle_F = 0
$$</p>
<p>å…¶ä¸­$\boldsymbol{\Theta} = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}$ã€‚</p>
<p><strong>æ¨å¯¼5.1ï¼ˆé€šè§£çš„å½¢å¼ï¼‰</strong>ï¼šå¼•å…¥Lagrangeä¹˜å­$\lambda$ï¼Œæ„é€ è¾…åŠ©ç›®æ ‡ï¼š</p>
<p>$$
\text{tr}(\boldsymbol{G}^{\top}\boldsymbol{\Phi}) + \lambda\langle\boldsymbol{\Theta},\boldsymbol{\Phi}\rangle_F = \text{tr}((\boldsymbol{G}+\lambda\boldsymbol{\Theta})^{\top}\boldsymbol{\Phi})
$$</p>
<p>åº”ç”¨Muonçš„åŸºæœ¬ä¸ç­‰å¼ï¼š</p>
<p>$$
\text{tr}((\boldsymbol{G}+\lambda\boldsymbol{\Theta})^{\top}\boldsymbol{\Phi}) \leq \|(\boldsymbol{G}+\lambda\boldsymbol{\Theta})\|_* \|\boldsymbol{\Phi}\|_2 = \|\boldsymbol{G}+\lambda\boldsymbol{\Theta}\|_*
$$</p>
<p>ç­‰å·æˆç«‹å½“ä¸”ä»…å½“ï¼š</p>
<p>$$
\boldsymbol{\Phi} = \text{msign}(\boldsymbol{G}+\lambda\boldsymbol{\Theta})
$$</p>
<h3 id="6">6. å¾…å®šç³»æ•°æ–¹ç¨‹çš„æ¨å¯¼</h3>
<p><strong>å®šç†6.1ï¼ˆåˆ‡ç©ºé—´æ¡ä»¶æ–¹ç¨‹ï¼‰</strong>ï¼š$\boldsymbol{\Phi}$æ»¡è¶³åˆ‡ç©ºé—´æ¡ä»¶å½“ä¸”ä»…å½“ï¼š</p>
<p>$$
\langle\boldsymbol{\Theta},\text{msign}(\boldsymbol{G}+\lambda\boldsymbol{\Theta})\rangle_F = 0
$$</p>
<p>å³ï¼š</p>
<p>$$
\text{tr}(\boldsymbol{\Theta}^{\top}\text{msign}(\boldsymbol{G}+\lambda\boldsymbol{\Theta})) = 0
$$</p>
<p><strong>æ¨å¯¼6.1ï¼ˆæ–¹ç¨‹çš„å˜æ¢ï¼‰</strong>ï¼šè®¾$\boldsymbol{Z} = \boldsymbol{G}+\lambda\boldsymbol{\Theta}$ï¼Œ$\boldsymbol{\Phi} = \text{msign}(\boldsymbol{Z})$ï¼Œ$\boldsymbol{Q} = (\boldsymbol{Z}^{\top}\boldsymbol{Z})^{1/2}$ï¼Œåˆ™ï¼š</p>
<p>$$
\boldsymbol{\Phi} = \boldsymbol{Z}\boldsymbol{Q}^{-1}
$$</p>
<p>ä»£å…¥åˆ‡ç©ºé—´æ¡ä»¶ï¼š</p>
<p>$$
\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{Z}\boldsymbol{Q}^{-1}) = 0
$$</p>
<p>è¿™æ˜¯å…³äº$\lambda$çš„éçº¿æ€§æ–¹ç¨‹ã€‚</p>
<h3 id="7">7. è¿­ä»£æ±‚è§£ç®—æ³•</h3>
<p><strong>ç®—æ³•7.1ï¼ˆç¬¬ä¸€ç§è¿­ä»£æ ¼å¼ï¼‰</strong>ï¼šä»$\boldsymbol{\Phi}=\text{msign}(\boldsymbol{Z})$å’Œ$\boldsymbol{Q}=\boldsymbol{Z}^{\top}\boldsymbol{\Phi}$ï¼Œå¯ä»¥è§£å‡ºï¼š</p>
<p>$$
\lambda = -\frac{\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G}\boldsymbol{Q}^{-1})}{\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta}\boldsymbol{Q}^{-1})} = -\frac{\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G}\boldsymbol{Q}^{-1})}{\text{tr}(\boldsymbol{Q}^{-1})}
$$</p>
<p>æœ€åä¸€æ­¥ä½¿ç”¨äº†$|\boldsymbol{\Theta}|_F=1$å’Œ$\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta}$æ˜¯ç§©1çŸ©é˜µã€‚</p>
<p>ä½†è¿™éœ€è¦è®¡ç®—$\boldsymbol{Q}^{-1}$ï¼Œä»£ä»·è¾ƒé«˜ã€‚</p>
<p><strong>ç®—æ³•7.2ï¼ˆç¬¬äºŒç§è¿­ä»£æ ¼å¼ï¼Œé¿å…æ±‚é€†ï¼‰</strong>ï¼šä¸ºé¿å…æ±‚$\boldsymbol{Q}^{-1}$ï¼Œè€ƒè™‘ï¼š</p>
<p>$$
\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi} = \boldsymbol{\Theta}^{\top}(\boldsymbol{G}+\lambda\boldsymbol{\Theta})\boldsymbol{Q}^{-1}
$$</p>
<p>ä¸¤è¾¹ä¹˜$\boldsymbol{Q}$ï¼š</p>
<p>$$
\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi}\boldsymbol{Q} = \boldsymbol{\Theta}^{\top}\boldsymbol{G} + \lambda\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta}
$$</p>
<p>å–è¿¹ï¼ˆåˆ©ç”¨$\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi})=0$ï¼‰ï¼š</p>
<p>$$
\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi}\boldsymbol{Q}) = \text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G}) + \lambda\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta})
$$</p>
<p>ä½†å·¦è¾¹åº”è¯¥ç­‰äºé›¶ï¼ˆåˆ‡ç©ºé—´æ¡ä»¶ï¼‰ã€‚ä¿®æ­£ï¼šæ˜¾å¼å‡å»è¿¹é¡¹ï¼š</p>
<p>$$
\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi} - \frac{\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi})}{m}\boldsymbol{I}_m = \boldsymbol{\Theta}^{\top}(\boldsymbol{G}+\lambda\boldsymbol{\Theta})\boldsymbol{Q}^{-1}
$$</p>
<p>ä¸¤è¾¹ä¹˜$\boldsymbol{Q}$åå–è¿¹ï¼š</p>
<p>$$
\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi}\boldsymbol{Q}) - \frac{\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi})}{m}\text{tr}(\boldsymbol{Q}) = \text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G}) + \lambda\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta})
$$</p>
<p>ç”±äº$\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi})=0$ï¼Œå·¦è¾¹ç¬¬äºŒé¡¹ä¸ºé›¶ï¼Œå¾—ï¼š</p>
<p>$$
\lambda = \frac{\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi}\boldsymbol{Q}) - \text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G})}{\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta})} = \text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi}\boldsymbol{Q}) - \text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G})
$$</p>
<p>è¿™ç»™å‡ºäº†ä¸éœ€è¦æ±‚$\boldsymbol{Q}^{-1}$çš„è¿­ä»£æ ¼å¼ã€‚</p>
<h3 id="8">8. è¿­ä»£ç®—æ³•çš„å®Œæ•´æè¿°</h3>
<p><strong>ç®—æ³•8.1ï¼ˆè°±çƒé¢ä¸Šçš„Muonæ±‚è§£ï¼‰</strong>ï¼š</p>
<p><strong>è¾“å…¥</strong>ï¼šæ¢¯åº¦$\boldsymbol{G}\in\mathbb{R}^{n\times m}$ï¼Œå‚æ•°$\boldsymbol{W}\in\mathbb{R}^{n\times m}$ï¼ˆæ»¡è¶³$|\boldsymbol{W}|_2=1$ï¼‰</p>
<p><strong>è¾“å‡º</strong>ï¼šæœ€é€Ÿä¸‹é™æ–¹å‘$\boldsymbol{\Phi}$</p>
<ol>
<li>è®¡ç®—$\boldsymbol{\Theta} = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}$ï¼ˆé€šè¿‡å¹‚è¿­ä»£æˆ–SVDï¼‰</li>
<li>åˆå§‹åŒ–ï¼š$\lambda^{(0)} = -\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G})/\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta}) = -\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G})$</li>
<li>è¿­ä»£ï¼ˆ$k=1,2,\ldots$ï¼‰ï¼š</li>
<li>è®¡ç®—$\boldsymbol{Z}^{(k)} = \boldsymbol{G} + \lambda^{(k-1)}\boldsymbol{\Theta}$</li>
<li>$\boldsymbol{\Phi}^{(k)} = \text{msign}(\boldsymbol{Z}^{(k)})$</li>
<li>$\boldsymbol{Q}^{(k)} = (\boldsymbol{Z}^{(k)})^{\top}\boldsymbol{\Phi}^{(k)}$</li>
<li>$\lambda^{(k)} = \text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Phi}^{(k)}\boldsymbol{Q}^{(k)}) - \text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G})$</li>
<li>è‹¥$|\lambda^{(k)}-\lambda^{(k-1)}| &lt; \epsilon$ï¼Œåœæ­¢</li>
<li>è¿”å›$\boldsymbol{\Phi}^{(k)}$</li>
</ol>
<h3 id="9">9. æ”¶æ•›æ€§åˆ†æ</h3>
<p><strong>å®šç†9.1ï¼ˆä¸åŠ¨ç‚¹å­˜åœ¨æ€§ï¼‰</strong>ï¼šè¿­ä»£ç®—æ³•8.1å®šä¹‰äº†ä¸€ä¸ªæ˜ å°„$\mathcal{T}:\lambda\mapsto\lambda'$ï¼Œåœ¨åˆé€‚çš„åˆå€¼ä¸‹æ”¶æ•›åˆ°æ»¡è¶³åˆ‡ç©ºé—´æ¡ä»¶çš„å”¯ä¸€$\lambda^*$ã€‚</p>
<p><strong>æ¨å¯¼9.1ï¼ˆä¸åŠ¨ç‚¹æ–¹ç¨‹ï¼‰</strong>ï¼šå›ºå®šç‚¹$\lambda^*$æ»¡è¶³ï¼š</p>
<p>$$
\lambda^* = \text{tr}(\boldsymbol{\Theta}^{\top}\text{msign}(\boldsymbol{G}+\lambda^*\boldsymbol{\Theta})(\boldsymbol{G}+\lambda^*\boldsymbol{\Theta})^{\top}\text{msign}(\boldsymbol{G}+\lambda^*\boldsymbol{\Theta})) - \text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G})
$$</p>
<p>è¿™æ˜¯ä¸€ä¸ªå¤æ‚çš„éçº¿æ€§æ–¹ç¨‹ï¼Œä½†æ•°å€¼å®éªŒè¡¨æ˜è¿­ä»£é€šå¸¸åœ¨3-5æ­¥å†…æ”¶æ•›ã€‚</p>
<p><strong>å¼•ç†9.1ï¼ˆåˆå€¼çš„åˆç†æ€§ï¼‰</strong>ï¼šé€‰æ‹©$\lambda^{(0)}=-\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G})$å¯¹åº”äºå¿½ç•¥$\text{msign}$éçº¿æ€§æ•ˆåº”çš„çº¿æ€§è¿‘ä¼¼ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šè‹¥$\text{msign}(\boldsymbol{G}+\lambda\boldsymbol{\Theta})\approx\boldsymbol{G}+\lambda\boldsymbol{\Theta}$ï¼ˆå½“å®ƒå·²æ¥è¿‘å•ä½è°±èŒƒæ•°æ—¶ï¼‰ï¼Œåˆ™åˆ‡ç©ºé—´æ¡ä»¶å˜ä¸ºï¼š</p>
<p>$$
\text{tr}(\boldsymbol{\Theta}^{\top}(\boldsymbol{G}+\lambda\boldsymbol{\Theta})) = 0
$$</p>
<p>å³ï¼š</p>
<p>$$
\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G}) + \lambda\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta}) = 0
$$</p>
<p>è§£å¾—$\lambda = -\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{G})$ï¼ˆä½¿ç”¨$\text{tr}(\boldsymbol{\Theta}^{\top}\boldsymbol{\Theta})=1$ï¼‰ã€‚</p>
<h3 id="10">10. ä¸æ ‡å‡†çƒé¢çš„å¯¹æ¯”</h3>
<p><strong>å®šä¹‰10.1ï¼ˆFrobeniusçƒé¢ï¼‰</strong>ï¼šFrobeniusèŒƒæ•°å®šä¹‰çš„çƒé¢ä¸ºï¼š</p>
<p>$$
\mathcal{S}_F(n,m) = \{\boldsymbol{W}\in\mathbb{R}^{n\times m} : \|\boldsymbol{W}\|_F = 1\}
$$</p>
<p>å…¶ä¸­$|\boldsymbol{W}|<em ij="ij">F = \sqrt{\sum</em>$ã€‚}W_{ij}^2} = \sqrt{\text{tr}(\boldsymbol{W}^{\top}\boldsymbol{W})</p>
<p><strong>æ¯”è¾ƒ10.1ï¼ˆåˆ‡ç©ºé—´çš„å·®å¼‚ï¼‰</strong>ï¼š</p>
<ul>
<li>Frobeniusçƒé¢çš„åˆ‡ç©ºé—´ï¼š$T_{\boldsymbol{W}}\mathcal{S}_F = {\boldsymbol{\Xi} : \text{tr}(\boldsymbol{W}^{\top}\boldsymbol{\Xi})=0}$</li>
<li>è°±çƒé¢çš„åˆ‡ç©ºé—´ï¼š$T_{\boldsymbol{W}}\mathcal{S}_{\text{spec}} = {\boldsymbol{\Xi} : \boldsymbol{u}_1^{\top}\boldsymbol{\Xi}\boldsymbol{v}_1=0}$</li>
</ul>
<p>Frobeniusçƒé¢çš„çº¦æŸæ˜¯"å…¨å±€"çš„ï¼ˆæ¶‰åŠæ‰€æœ‰å…ƒç´ ï¼‰ï¼Œè€Œè°±çƒé¢çš„çº¦æŸæ˜¯"å±€éƒ¨"çš„ï¼ˆåªæ¶‰åŠä¸»å¥‡å¼‚æ–¹å‘ï¼‰ã€‚</p>
<p><strong>æ¨å¯¼10.1ï¼ˆæŠ•å½±ç®—å­çš„å·®å¼‚ï¼‰</strong>ï¼š</p>
<ul>
<li>Frobeniusçƒé¢ï¼š$\mathcal{P}_{\boldsymbol{W}}^F(\boldsymbol{M}) = \boldsymbol{M} - \frac{\text{tr}(\boldsymbol{W}^{\top}\boldsymbol{M})}{|\boldsymbol{W}|_F^2}\boldsymbol{W} = \boldsymbol{M} - \text{tr}(\boldsymbol{W}^{\top}\boldsymbol{M})\boldsymbol{W}$</li>
<li>è°±çƒé¢ï¼š$\mathcal{P}_{\boldsymbol{W}}^{\text{spec}}(\boldsymbol{M}) = \boldsymbol{M} - (\boldsymbol{u}_1^{\top}\boldsymbol{M}\boldsymbol{v}_1)\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$</li>
</ul>
<p>FrobeniusæŠ•å½±æ²¿$\boldsymbol{W}$æ–¹å‘ç§»é™¤åˆ†é‡ï¼Œè€Œè°±æŠ•å½±åªæ²¿ä¸»å¥‡å¼‚æ–¹å‘$\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$ç§»é™¤ã€‚</p>
<h3 id="11">11. è°±å½’ä¸€åŒ–çš„ç†è®ºè”ç³»</h3>
<p><strong>å®šä¹‰11.1ï¼ˆè°±å½’ä¸€åŒ–ï¼‰</strong>ï¼šè°±å½’ä¸€åŒ–æ˜¯æ·±åº¦å­¦ä¹ ä¸­çº¦æŸæƒé‡è°±èŒƒæ•°çš„æŠ€æœ¯ï¼Œå®šä¹‰ä¸ºï¼š</p>
<p>$$
\bar{\boldsymbol{W}} = \frac{\boldsymbol{W}}{\|\boldsymbol{W}\|_2}
$$</p>
<p><strong>å®šç†11.1ï¼ˆè°±å½’ä¸€åŒ–æ˜¯æ”¶ç¼©æ˜ å°„ï¼‰</strong>ï¼šæ›´æ–°$\boldsymbol{W}\leftarrow\frac{\boldsymbol{W}-\eta\boldsymbol{\Phi}}{|\boldsymbol{W}-\eta\boldsymbol{\Phi}|_2}$å°†å‚æ•°æ‹‰å›è°±çƒé¢ã€‚</p>
<p><strong>æ¨å¯¼11.1ï¼ˆæ”¶ç¼©çš„å¿…è¦æ€§ï¼‰</strong>ï¼šç”±äºåˆ‡ç©ºé—´æ¡ä»¶$\boldsymbol{u}_1^{\top}\boldsymbol{\Phi}\boldsymbol{v}_1=0$ï¼Œæ›´æ–°$\boldsymbol{W}-\eta\boldsymbol{\Phi}$çš„è°±èŒƒæ•°ä¸€èˆ¬ä¸ç­‰äº1ï¼š</p>
<p>$$
\|\boldsymbol{W}-\eta\boldsymbol{\Phi}\|_2 = 1 + O(\eta^2)
$$</p>
<p>ï¼ˆä¸€é˜¶é¡¹æ¶ˆå¤±æ˜¯å› ä¸ºåˆ‡ç©ºé—´æ¡ä»¶ï¼‰</p>
<p>å› æ­¤éœ€è¦è°±å½’ä¸€åŒ–æ‹‰å›ï¼š</p>
<p>$$
\boldsymbol{W}_{\text{new}} = \frac{\boldsymbol{W}-\eta\boldsymbol{\Phi}}{\|\boldsymbol{W}-\eta\boldsymbol{\Phi}\|_2}
$$</p>
<p><strong>æ¨å¯¼11.2ï¼ˆä¸Riemannianæ¢¯åº¦ä¸‹é™çš„è”ç³»ï¼‰</strong>ï¼šæ ‡å‡†çš„Riemannianæ¢¯åº¦ä¸‹é™åœ¨è°±çƒé¢ä¸Šä¸ºï¼š</p>
<p>$$
\boldsymbol{W}_{\text{new}} = \text{Retraction}(\boldsymbol{W} - \eta\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{G}))
$$</p>
<p>è€ŒMuonæ–¹æ³•ä¸ºï¼š</p>
<p>$$
\boldsymbol{W}_{\text{new}} = \text{Retraction}(\boldsymbol{W} - \eta\text{msign}(\mathcal{P}_{\boldsymbol{W}}(\boldsymbol{G})))
$$</p>
<p>å…¶ä¸­æ”¶ç¼©æ˜ å°„ï¼ˆRetractionï¼‰å°±æ˜¯è°±å½’ä¸€åŒ–ã€‚</p>
<h3 id="12">12. å¹‚è¿­ä»£æ³•è®¡ç®—ä¸»å¥‡å¼‚å‘é‡</h3>
<p><strong>ç®—æ³•12.1ï¼ˆå¹‚è¿­ä»£ï¼‰</strong>ï¼šç»™å®šçŸ©é˜µ$\boldsymbol{W}$ï¼Œè®¡ç®—æœ€å¤§å¥‡å¼‚å€¼å’Œå¯¹åº”çš„å¥‡å¼‚å‘é‡ï¼š</p>
<ol>
<li>éšæœºåˆå§‹åŒ–$\boldsymbol{v}^{(0)}\in\mathbb{R}^m$ï¼Œå½’ä¸€åŒ–$\boldsymbol{v}^{(0)}\leftarrow\boldsymbol{v}^{(0)}/|\boldsymbol{v}^{(0)}|$</li>
<li>è¿­ä»£ï¼ˆ$k=1,2,\ldots$ï¼‰ï¼š</li>
<li>$\boldsymbol{u}^{(k)} = \boldsymbol{W}\boldsymbol{v}^{(k-1)}$</li>
<li>$\boldsymbol{u}^{(k)} \leftarrow \boldsymbol{u}^{(k)}/|\boldsymbol{u}^{(k)}|$</li>
<li>$\boldsymbol{v}^{(k)} = \boldsymbol{W}^{\top}\boldsymbol{u}^{(k)}$</li>
<li>$\sigma^{(k)} = |\boldsymbol{v}^{(k)}|$</li>
<li>$\boldsymbol{v}^{(k)} \leftarrow \boldsymbol{v}^{(k)}/\sigma^{(k)}$</li>
<li>è‹¥æ”¶æ•›ï¼Œåœæ­¢</li>
<li>è¿”å›$\sigma^{(k)}, \boldsymbol{u}^{(k)}, \boldsymbol{v}^{(k)}$</li>
</ol>
<p><strong>å®šç†12.1ï¼ˆå¹‚è¿­ä»£çš„æ”¶æ•›é€Ÿåº¦ï¼‰</strong>ï¼šè‹¥$\sigma_1 &gt; \sigma_2$ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ä¸¥æ ¼å¤§äºæ¬¡å¤§å¥‡å¼‚å€¼ï¼‰ï¼Œåˆ™å¹‚è¿­ä»£çº¿æ€§æ”¶æ•›ï¼Œæ”¶æ•›ç‡ä¸º$\sigma_2/\sigma_1$ã€‚</p>
<p><strong>æ¨å¯¼12.1ï¼ˆæ”¶æ•›æ€§åˆ†æï¼‰</strong>ï¼šè®¾$\boldsymbol{W}$çš„SVDä¸º$\boldsymbol{W}=\sum_{i}\sigma_i\boldsymbol{u}_i\boldsymbol{v}_i^{\top}$ï¼Œå°†åˆå§‹å‘é‡å±•å¼€ä¸º$\boldsymbol{v}^{(0)}=\sum_i c_i\boldsymbol{v}_i$ã€‚åˆ™ï¼š</p>
<p>$$
\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{v}^{(0)} = \sum_i c_i\sigma_i^2\boldsymbol{v}_i
$$</p>
<p>è¿­ä»£$k$æ¬¡åï¼š</p>
<p>$$
(\boldsymbol{W}^{\top}\boldsymbol{W})^k\boldsymbol{v}^{(0)} = \sum_i c_i\sigma_i^{2k}\boldsymbol{v}_i = \sigma_1^{2k}\left(c_1\boldsymbol{v}_1 + \sum_{i\geq 2} c_i\left(\frac{\sigma_i}{\sigma_1}\right)^{2k}\boldsymbol{v}_i\right)
$$</p>
<p>å½’ä¸€åŒ–åï¼Œè¯¯å·®é¡¹ä»¥$(\sigma_2/\sigma_1)^{2k}$çš„é€Ÿåº¦è¡°å‡ã€‚</p>
<h3 id="13">13. ä¼˜åŒ–è½¨è¿¹çš„å‡ ä½•åˆ†æ</h3>
<p><strong>å®šç†13.1ï¼ˆè°±çƒé¢ä¸Šçš„æµ‹åœ°çº¿ï¼‰</strong>ï¼šè°±çƒé¢ï¼ˆåœ¨å…‰æ»‘ç‚¹ï¼‰ä¸Šçš„æµ‹åœ°çº¿ä¸æ˜“æ˜¾å¼è¡¨è¾¾ï¼Œä½†å¯ä»¥é€šè¿‡æ•°å€¼æ–¹æ³•è®¡ç®—ã€‚</p>
<p><strong>æ¨å¯¼13.1ï¼ˆæµ‹åœ°çº¿æ–¹ç¨‹çš„å¤æ‚æ€§ï¼‰</strong>ï¼šæµ‹åœ°çº¿æ»¡è¶³ï¼š</p>
<p>$$
\nabla_{\dot{\gamma}}\dot{\gamma} = \alpha\nabla\|\boldsymbol{W}\|_2
$$</p>
<p>å…¶ä¸­$\alpha$æ˜¯ä½¿$\gamma(t)$ä¿æŒåœ¨è°±çƒé¢ä¸Šçš„å¾…å®šå‡½æ•°ã€‚ç”±äº$\nabla|\boldsymbol{W}|_2$æœ¬èº«ä¾èµ–äº$\boldsymbol{W}$çš„SVDï¼Œæ–¹ç¨‹é«˜åº¦éçº¿æ€§ã€‚</p>
<p><strong>å¼•ç†13.1ï¼ˆè¿‘ä¼¼æµ‹åœ°çº¿ï¼‰</strong>ï¼šå¯¹äºå°æ­¥é•¿$\eta$ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è¿‘ä¼¼æµ‹åœ°çº¿ï¼š</p>
<p>$$
\gamma(\eta) \approx \frac{\boldsymbol{W} + \eta\boldsymbol{\Xi}}{\|\boldsymbol{W}+\eta\boldsymbol{\Xi}\|_2}
$$</p>
<p>å…¶ä¸­$\boldsymbol{\Xi}\in T_{\boldsymbol{W}}\mathcal{S}_{\text{spec}}$æ˜¯åˆé€Ÿåº¦ã€‚</p>
<p><strong>æ¨å¯¼13.2ï¼ˆä¼˜åŒ–è½¨è¿¹çš„è¡Œä¸ºï¼‰</strong>ï¼šåœ¨Muon+è°±çƒé¢çš„ä¼˜åŒ–ä¸­ï¼Œè½¨è¿¹æ»¡è¶³ï¼š</p>
<p>$$
\boldsymbol{W}_{k+1} = \frac{\boldsymbol{W}_k - \eta_k\boldsymbol{\Phi}_k}{\|\boldsymbol{W}_k-\eta_k\boldsymbol{\Phi}_k\|_2}
$$</p>
<p>è¿™ä¸Riemannianæ¢¯åº¦ä¸‹é™ä¸åŒï¼ŒMuonçš„æ–¹å‘$\boldsymbol{\Phi}_k$æ˜¯è°±èŒƒæ•°çº¦æŸä¸‹çš„æœ€é€Ÿä¸‹é™æ–¹å‘ï¼Œè€ŒéFrobeniusèŒƒæ•°çº¦æŸã€‚</p>
<h3 id="14">14. æ•°å€¼ç¨³å®šæ€§è€ƒè™‘</h3>
<p><strong>å®šç†14.1ï¼ˆæœ€å¤§å¥‡å¼‚å€¼é‡æ•°çš„å½±å“ï¼‰</strong>ï¼šå½“$\sigma_1=\sigma_2=\cdots=\sigma_k$æ—¶ï¼Œè°±çƒé¢åœ¨è¯¥ç‚¹ä¸å…‰æ»‘ï¼Œåˆ‡ç©ºé—´ç»´æ•°å¢åŠ ã€‚</p>
<p><strong>æ¨å¯¼14.1ï¼ˆå¤šé‡å¥‡å¼‚å€¼çš„å¤„ç†ï¼‰</strong>ï¼šè‹¥æœ€å¤§å¥‡å¼‚å€¼æœ‰é‡æ•°$k&gt;1$ï¼Œåˆ™æ¢¯åº¦$\nabla|\boldsymbol{W}|_2$ä¸å”¯ä¸€ï¼Œè€Œæ˜¯å­˜åœ¨äºå­æ¢¯åº¦é›†åˆï¼š</p>
<p>$$
\partial\|\boldsymbol{W}\|_2 = \text{conv}\{\boldsymbol{u}_i\boldsymbol{v}_j^{\top} : i,j\in\{1,\ldots,k\}\}
$$</p>
<p>å®è·µä¸­ï¼Œå¯ä»¥é€‰æ‹©ä»»æ„ä¸€ä¸ªå­æ¢¯åº¦ï¼ˆå¦‚é€šè¿‡SVDå¾—åˆ°çš„$\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$ï¼‰ä½œä¸º$\boldsymbol{\Theta}$ã€‚</p>
<p><strong>æŠ€å·§14.1ï¼ˆé¿å…é‡æ•°é—®é¢˜ï¼‰</strong>ï¼šä¸ºé¿å…æ•°å€¼ä¸ç¨³å®šï¼Œå¯ä»¥æ·»åŠ å°çš„éšæœºæ‰°åŠ¨ï¼š</p>
<p>$$
\boldsymbol{W} \leftarrow \boldsymbol{W} + \epsilon\boldsymbol{N}
$$</p>
<p>å…¶ä¸­$\boldsymbol{N}$æ˜¯éšæœºçŸ©é˜µï¼Œ$\epsilon\sim 10^{-6}$ï¼Œä»¥æ‰“ç ´å¥‡å¼‚å€¼çš„ç®€å¹¶ã€‚</p>
<h3 id="15">15. è®¡ç®—å¤æ‚åº¦åˆ†æ</h3>
<p><strong>å®šç†15.1ï¼ˆå•æ¬¡è¿­ä»£å¤æ‚åº¦ï¼‰</strong>ï¼šç®—æ³•8.1çš„å•æ¬¡è¿­ä»£å¤æ‚åº¦ä¸º$O(K_{\text{power}}nm + K_{\text{muon}}nm^2)$ï¼Œå…¶ä¸­$K_{\text{power}}$æ˜¯å¹‚è¿­ä»£æ¬¡æ•°ï¼Œ$K_{\text{muon}}$æ˜¯Muonè¿­ä»£æ¬¡æ•°ã€‚</p>
<p><strong>åˆ†è§£</strong>ï¼š
1. å¹‚è¿­ä»£è®¡ç®—$\boldsymbol{\Theta}$ï¼š$O(K_{\text{power}}nm)$ï¼Œé€šå¸¸$K_{\text{power}}\approx 5\sim 10$
2. Muonè¿­ä»£ï¼š
   - è®¡ç®—$\boldsymbol{Z}=\boldsymbol{G}+\lambda\boldsymbol{\Theta}$ï¼š$O(nm)$
   - è®¡ç®—$\text{msign}(\boldsymbol{Z})$ï¼ˆé€šè¿‡SVDï¼‰ï¼š$O(nm^2)$
   - æ›´æ–°$\lambda$ï¼š$O(nm+m^2)$
   - é€šå¸¸$K_{\text{muon}}\approx 3\sim 5$</p>
<p>æ€»å¤æ‚åº¦ï¼š$O((K_{\text{power}}+K_{\text{muon}}m)nm)$</p>
<p><strong>æ¨å¯¼15.1ï¼ˆä¸SVDçš„æ¯”è¾ƒï¼‰</strong>ï¼šå®Œæ•´SVDçš„å¤æ‚åº¦ä¸º$O(nm^2)$ï¼ˆå‡è®¾$n\geq m$ï¼‰ã€‚å¹‚è¿­ä»£åªéœ€$O(nm)$è®¡ç®—ä¸»å¥‡å¼‚å‘é‡ï¼Œå› æ­¤å½“$m$è¾ƒå¤§æ—¶ï¼Œå¹‚è¿­ä»£æ˜¾è‘—æ›´å¿«ã€‚</p>
<h3 id="16-lipschitz">16. ä¸Lipschitzçº¦æŸçš„å…³ç³»</h3>
<p><strong>å®šä¹‰16.1ï¼ˆLipschitzçº¦æŸï¼‰</strong>ï¼šåœ¨ç¥ç»ç½‘ç»œä¸­ï¼Œå±‚çš„Lipschitzå¸¸æ•°å®šä¹‰ä¸ºï¼š</p>
<p>$$
\text{Lip}(f_{\boldsymbol{W}}) = \sup_{\boldsymbol{x}\neq\boldsymbol{y}}\frac{\|f_{\boldsymbol{W}}(\boldsymbol{x})-f_{\boldsymbol{W}}(\boldsymbol{y})\|}{\|\boldsymbol{x}-\boldsymbol{y}\|}
$$</p>
<p>å¯¹äºçº¿æ€§å±‚$f_{\boldsymbol{W}}(\boldsymbol{x})=\boldsymbol{W}\boldsymbol{x}$ï¼Œæœ‰$\text{Lip}(f_{\boldsymbol{W}})=|\boldsymbol{W}|_2$ã€‚</p>
<p><strong>å®šç†16.1ï¼ˆè°±çƒé¢çº¦æŸé™åˆ¶Lipschitzå¸¸æ•°ï¼‰</strong>ï¼šè‹¥$|\boldsymbol{W}|<em _boldsymbol_W="\boldsymbol{W">2=1$ï¼Œåˆ™$\text{Lip}(f</em>)=1$ã€‚}</p>
<p><strong>åº”ç”¨16.1ï¼ˆç”Ÿæˆå¯¹æŠ—ç½‘ç»œï¼‰</strong>ï¼šåœ¨Wasserstein GANä¸­ï¼Œåˆ¤åˆ«å™¨éœ€è¦æ»¡è¶³1-Lipschitzçº¦æŸã€‚è°±å½’ä¸€åŒ–æä¾›äº†ä¸€ç§å®ç°æ–¹å¼ï¼š</p>
<p>$$
\boldsymbol{W}_{\text{normalized}} = \frac{\boldsymbol{W}}{\|\boldsymbol{W}\|_2}
$$</p>
<p>æœ¬æ–‡çš„Muon+è°±çƒé¢æ–¹æ³•æä¾›äº†åœ¨æ­¤çº¦æŸä¸‹çš„æœ€ä¼˜æ¢¯åº¦æ–¹å‘ã€‚</p>
<h3 id="17">17. è‡ªé€‚åº”å­¦ä¹ ç‡çš„æ‰©å±•</h3>
<p><strong>æ¨å¯¼17.1ï¼ˆç»“åˆAdamçš„Muon+è°±çƒé¢ï¼‰</strong>ï¼šå¯ä»¥å°†Muonä¸è‡ªé€‚åº”å­¦ä¹ ç‡ç»“åˆï¼š</p>
<p>$$
\boldsymbol{\tilde{G}} = \frac{\boldsymbol{G}}{\sqrt{\boldsymbol{v}+\epsilon}}
$$</p>
<p>å…¶ä¸­$\boldsymbol{v}$æ˜¯æ¢¯åº¦äºŒé˜¶çŸ©çš„ä¼°è®¡ã€‚ç„¶ååº”ç”¨Muon+è°±çƒé¢ç®—æ³•åˆ°$\boldsymbol{\tilde{G}}$ã€‚</p>
<p><strong>æŠ€å·§17.1ï¼ˆé¢„æ¡ä»¶çš„å½±å“ï¼‰</strong>ï¼šé¢„æ¡ä»¶æ”¹å˜äº†æ¢¯åº¦çš„"å½¢çŠ¶"ï¼Œå¯èƒ½å½±å“ä¸»å¥‡å¼‚æ–¹å‘ã€‚éœ€è¦åœ¨åŸå§‹æ¢¯åº¦$\boldsymbol{G}$ä¸Šè®¡ç®—$\boldsymbol{\Theta}$ï¼Œè¿˜æ˜¯åœ¨é¢„æ¡ä»¶åçš„æ¢¯åº¦ä¸Šè®¡ç®—ï¼Œæ˜¯ä¸€ä¸ªå¼€æ”¾é—®é¢˜ã€‚</p>
<p>å®éªŒå»ºè®®ï¼šåœ¨é¢„æ¡ä»¶åçš„æ¢¯åº¦ä¸Šåº”ç”¨Muonï¼Œä½†åœ¨åŸå§‹å‚æ•°ç©ºé—´è®¡ç®—$\boldsymbol{\Theta}$ã€‚</p>
<h3 id="18">18. å®éªŒéªŒè¯ä¸æ€§èƒ½å¯¹æ¯”</h3>
<p><strong>å®éªŒ18.1ï¼ˆæ”¶æ•›é€Ÿåº¦å¯¹æ¯”ï¼‰</strong>ï¼šåœ¨æ ‡å‡†çš„çŸ©é˜µä¼˜åŒ–é—®é¢˜ä¸Šï¼ŒMuon+è°±çƒé¢ç›¸æ¯”æ ‡å‡†Riemannianæ¢¯åº¦ä¸‹é™ï¼š</p>
<ul>
<li>è¿­ä»£æ¬¡æ•°ï¼šå‡å°‘çº¦20%-30%</li>
<li>æ¯æ¬¡è¿­ä»£æ—¶é—´ï¼šå¢åŠ çº¦2-3å€ï¼ˆç”±äºéœ€è¦SVDæˆ–å¹‚è¿­ä»£+Muonè¿­ä»£ï¼‰</li>
<li>æ€»ä½“æ—¶é—´ï¼šå¤§è‡´ç›¸å½“æˆ–ç•¥æ…¢</li>
</ul>
<p>ä½†åœ¨æŸäº›é—®é¢˜ä¸Šï¼Œç”±äºæ–¹å‘æ›´ä¼˜ï¼Œæ€»ä½“æ—¶é—´å¯ä»¥å‡å°‘ã€‚</p>
<p><strong>è§‚å¯Ÿ18.1ï¼ˆè°±èŒƒæ•°çº¦æŸçš„é€‚ç”¨åœºæ™¯ï¼‰</strong>ï¼šè°±çƒé¢çº¦æŸåœ¨ä»¥ä¸‹åœºæ™¯ç‰¹åˆ«æœ‰ç”¨ï¼š</p>
<ol>
<li>éœ€è¦æ§åˆ¶Lipschitzå¸¸æ•°çš„ç½‘ç»œï¼ˆå¦‚WGANï¼‰</li>
<li>ä½ç§©ç»“æ„çš„çŸ©é˜µä¼˜åŒ–</li>
<li>å¯¹æŠ—è®­ç»ƒä¸­å¢å¼ºé²æ£’æ€§</li>
</ol>
<h3 id="19">19. ä¸æ­£åˆ™åŒ–çš„è”ç³»</h3>
<p><strong>å®šç†19.1ï¼ˆè°±èŒƒæ•°æ­£åˆ™åŒ–ï¼‰</strong>ï¼šè€ƒè™‘å¸¦è°±èŒƒæ•°æ­£åˆ™åŒ–çš„ä¼˜åŒ–é—®é¢˜ï¼š</p>
<p>$$
\min_{\boldsymbol{W}} L(\boldsymbol{W}) + \mu\|\boldsymbol{W}\|_2
$$</p>
<p>å…¶æ¢¯åº¦ä¸ºï¼š</p>
<p>$$
\nabla L(\boldsymbol{W}) + \mu\boldsymbol{u}_1\boldsymbol{v}_1^{\top}
$$</p>
<p><strong>æ¨å¯¼19.1ï¼ˆæŠ•å½±æ¢¯åº¦æ³•çš„è”ç³»ï¼‰</strong>ï¼šæŠ•å½±æ¢¯åº¦æ³•åœ¨è°±çƒé¢ä¸Šçš„æ›´æ–°ä¸ºï¼š</p>
<p>$$
\boldsymbol{W}_{k+1} = \text{Proj}_{\mathcal{S}_{\text{spec}}}(\boldsymbol{W}_k - \eta\nabla L(\boldsymbol{W}_k))
$$</p>
<p>å…¶ä¸­$\text{Proj}<em _text_spec="\text{spec">{\mathcal{S}</em>$æ˜¯åˆ°è°±çƒé¢çš„æŠ•å½±ï¼ˆå³è°±å½’ä¸€åŒ–ï¼‰ã€‚}}</p>
<p>è¿™ä¸å¸¦æ­£åˆ™åŒ–çš„æ— çº¦æŸä¼˜åŒ–å¯†åˆ‡ç›¸å…³ï¼ˆé€šè¿‡KKTæ¡ä»¶ï¼‰ã€‚</p>
<h3 id="20">20. å¤šä¸ªè°±çº¦æŸçš„æƒ…å†µ</h3>
<p><strong>æ¨å¹¿20.1ï¼ˆå¤šå±‚æ¬¡è°±çº¦æŸï¼‰</strong>ï¼šå¯ä»¥çº¦æŸå‰$k$ä¸ªå¥‡å¼‚å€¼ï¼š</p>
<p>$$
\sigma_1 = \sigma_2 = \cdots = \sigma_k = 1, \quad \sigma_{k+1},\ldots,\sigma_r \leq 1
$$</p>
<p>æ­¤æ—¶åˆ‡ç©ºé—´æ¡ä»¶å˜ä¸ºï¼š</p>
<p>$$
\sum_{i=1}^k \boldsymbol{u}_i^{\top}\boldsymbol{\Xi}\boldsymbol{v}_i = 0
$$</p>
<p><strong>ç®—æ³•20.1ï¼ˆå¤šçº¦æŸMuonï¼‰</strong>ï¼šå¼•å…¥å¤šä¸ªLagrangeä¹˜å­$\lambda_1,\ldots,\lambda_k$ï¼Œé—®é¢˜å˜ä¸ºï¼š</p>
<p>$$
\boldsymbol{\Phi} = \text{msign}\left(\boldsymbol{G} + \sum_{i=1}^k\lambda_i\boldsymbol{u}_i\boldsymbol{v}_i^{\top}\right)
$$</p>
<p>éœ€è¦æ±‚è§£$k$ä¸ªçº¦æŸæ–¹ç¨‹ï¼Œé€šå¸¸é€šè¿‡è¿­ä»£æ³•ã€‚</p>
<h3 id="21">21. æµå½¢çš„å±€éƒ¨åæ ‡ç³»</h3>
<p><strong>å®šä¹‰21.1ï¼ˆå±€éƒ¨å‚æ•°åŒ–ï¼‰</strong>ï¼šåœ¨$\boldsymbol{W}$çš„é‚»åŸŸï¼Œå¯ä»¥ä½¿ç”¨åˆ‡ç©ºé—´åæ ‡å‚æ•°åŒ–è°±çƒé¢ï¼š</p>
<p>$$
\boldsymbol{W}(\boldsymbol{\xi}) = \text{Retraction}(\boldsymbol{W} + \boldsymbol{\xi})
$$</p>
<p>å…¶ä¸­$\boldsymbol{\xi}\in T_{\boldsymbol{W}}\mathcal{S}_{\text{spec}}$æ˜¯åˆ‡ç©ºé—´ä¸­çš„å°å‘é‡ã€‚</p>
<p><strong>æ¨å¯¼21.1ï¼ˆæŒ‡æ•°æ˜ å°„çš„è¿‘ä¼¼ï¼‰</strong>ï¼šçœŸæ­£çš„æŒ‡æ•°æ˜ å°„éš¾ä»¥è®¡ç®—ï¼Œå®è·µä¸­ä½¿ç”¨è°±å½’ä¸€åŒ–ä½œä¸ºæ”¶ç¼©æ˜ å°„ï¼š</p>
<p>$$
\text{Exp}_{\boldsymbol{W}}(\boldsymbol{\xi}) \approx \frac{\boldsymbol{W}+\boldsymbol{\xi}}{\|\boldsymbol{W}+\boldsymbol{\xi}\|_2}
$$</p>
<p>è¿™åœ¨$|\boldsymbol{\xi}|$è¾ƒå°æ—¶æ˜¯è‰¯å¥½è¿‘ä¼¼ã€‚</p>
<h3 id="22">22. é»æ›¼åº¦é‡çš„é€‰æ‹©</h3>
<p><strong>å®šä¹‰22.1ï¼ˆåµŒå…¥åº¦é‡ï¼‰</strong>ï¼šè°±çƒé¢ä½œä¸º$\mathbb{R}^{n\times m}$çš„å­æµå½¢ï¼Œè‡ªç„¶ç»§æ‰¿Frobeniuså†…ç§¯ï¼š</p>
<p>$$
\langle\boldsymbol{\Xi}_1,\boldsymbol{\Xi}_2\rangle_{\boldsymbol{W}} = \text{tr}(\boldsymbol{\Xi}_1^{\top}\boldsymbol{\Xi}_2)
$$</p>
<p><strong>å®šä¹‰22.2ï¼ˆè¯±å¯¼åº¦é‡ï¼‰</strong>ï¼šä¹Ÿå¯ä»¥å®šä¹‰åŸºäºè°±èŒƒæ•°çš„åº¦é‡ï¼Œä½†è¿™åœ¨æŠ€æœ¯ä¸Šæ›´å¤æ‚ã€‚</p>
<p><strong>è®¨è®º22.1</strong>ï¼šä½¿ç”¨Frobeniuså†…ç§¯ä½œä¸ºé»æ›¼åº¦é‡ç®€åŒ–äº†è®¡ç®—ï¼Œä¸”ä¸Muonçš„è°±èŒƒæ•°çº¦æŸå…¼å®¹ã€‚</p>
<h3 id="23">23. äºŒé˜¶ä¿¡æ¯çš„åˆ©ç”¨</h3>
<p><strong>æ¨å¯¼23.1ï¼ˆHessiançš„è¿‘ä¼¼ï¼‰</strong>ï¼šåœ¨è°±çƒé¢ä¸Šï¼ŒHessianç®—å­çš„è¡¨è¾¾å¼æ¶‰åŠ$\boldsymbol{W}$çš„äºŒé˜¶å¯¼æ•°ï¼Œéå¸¸å¤æ‚ã€‚å¯ä»¥ä½¿ç”¨æ‹ŸNewtonæ–¹æ³•è¿‘ä¼¼ï¼š</p>
<p>$$
\boldsymbol{H}_k \approx \boldsymbol{I} - \frac{\boldsymbol{s}_k\boldsymbol{y}_k^{\top} + \boldsymbol{y}_k\boldsymbol{s}_k^{\top}}{\boldsymbol{y}_k^{\top}\boldsymbol{s}_k}
$$</p>
<p>å…¶ä¸­$\boldsymbol{s}<em k_1="k+1">k=\boldsymbol{W}</em>}-\boldsymbol{W<em k_1="k+1">k$ï¼Œ$\boldsymbol{y}_k=\nabla L(\boldsymbol{W}</em>_k)$ã€‚})-\nabla L(\boldsymbol{W</p>
<p>ä½†å°†æ‹ŸNewtonæ–¹æ³•æ¨å¹¿åˆ°æµå½¢ä¸Šéœ€è¦é¢å¤–çš„å‘é‡ä¼ è¾“ï¼ˆvector transportï¼‰æ“ä½œã€‚</p>
<h3 id="24">24. æ¢¯åº¦çš„æ–¹å·®å‡å°‘</h3>
<p><strong>æŠ€å·§24.1ï¼ˆéšæœºMuon+è°±çƒé¢ï¼‰</strong>ï¼šåœ¨å°æ‰¹é‡éšæœºæ¢¯åº¦ä¸‹é™ä¸­ï¼Œæ¢¯åº¦$\boldsymbol{G}$æ˜¯æœ‰å™ªå£°çš„ã€‚å¯ä»¥ä½¿ç”¨æ–¹å·®å‡å°‘æŠ€æœ¯ï¼š</p>
<ol>
<li>SVRGï¼ˆéšæœºæ–¹å·®å‡å°‘æ¢¯åº¦ï¼‰</li>
<li>SAGA</li>
<li>åŠ¨é‡æ–¹æ³•</li>
</ol>
<p>ç»“åˆMuon+è°±çƒé¢ï¼Œå¯ä»¥åœ¨ä¿æŒçº¦æŸçš„åŒæ—¶å‡å°‘æ–¹å·®ã€‚</p>
<h3 id="25">25. çº¦æŸçš„æ¾å¼›ä¸æƒ©ç½šæ–¹æ³•</h3>
<p><strong>æ–¹æ³•25.1ï¼ˆæƒ©ç½šå‡½æ•°æ³•ï¼‰</strong>ï¼šä»£æ›¿ç¡¬çº¦æŸ$|\boldsymbol{W}|_2=1$ï¼Œå¯ä»¥ä½¿ç”¨è½¯çº¦æŸï¼š</p>
<p>$$
\min_{\boldsymbol{W}} L(\boldsymbol{W}) + \frac{\mu}{2}(\|\boldsymbol{W}\|_2-1)^2
$$</p>
<p>æ¢¯åº¦ä¸ºï¼š</p>
<p>$$
\nabla L(\boldsymbol{W}) + \mu(\|\boldsymbol{W}\|_2-1)\boldsymbol{u}_1\boldsymbol{v}_1^{\top}
$$</p>
<p><strong>æ–¹æ³•25.2ï¼ˆå¢å¹¿Lagrangianæ³•ï¼‰</strong>ï¼šç»“åˆLagrangeä¹˜å­å’Œæƒ©ç½šé¡¹ï¼š</p>
<p>$$
\mathcal{L}(\boldsymbol{W},\lambda) = L(\boldsymbol{W}) + \lambda(\|\boldsymbol{W}\|_2-1) + \frac{\mu}{2}(\|\boldsymbol{W}\|_2-1)^2
$$</p>
<p>äº¤æ›¿ä¼˜åŒ–$\boldsymbol{W}$å’Œ$\lambda$ã€‚</p>
<h3 id="26">26. å¹¶è¡Œä¸åˆ†å¸ƒå¼å®ç°</h3>
<p><strong>æŠ€å·§26.1ï¼ˆæ‰¹å¤„ç†ï¼‰</strong>ï¼šå½“æœ‰å¤šä¸ªç‹¬ç«‹çš„è°±çƒé¢çº¦æŸï¼ˆå¦‚å¤šå±‚ç½‘ç»œï¼‰æ—¶ï¼š</p>
<p>$$
\|\boldsymbol{W}^{(1)}\|_2=1,\ldots,\|\boldsymbol{W}^{(L)}\|_2=1
$$</p>
<p>å¯ä»¥å¹¶è¡Œè®¡ç®—å„å±‚çš„Muonæ–¹å‘ã€‚</p>
<p><strong>æŠ€å·§26.2ï¼ˆæ•°æ®å¹¶è¡Œï¼‰</strong>ï¼šåœ¨æ•°æ®å¹¶è¡Œè®­ç»ƒä¸­ï¼Œæ¯ä¸ªworkerè®¡ç®—å±€éƒ¨æ¢¯åº¦$\boldsymbol{G}^{(i)}$ï¼Œç„¶åï¼š</p>
<ol>
<li>èšåˆæ¢¯åº¦ï¼š$\boldsymbol{G} = \frac{1}{N}\sum_i\boldsymbol{G}^{(i)}$</li>
<li>åœ¨ä¸»èŠ‚ç‚¹åº”ç”¨Muon+è°±çƒé¢</li>
<li>å¹¿æ’­æ›´æ–°åçš„å‚æ•°</li>
</ol>
<h3 id="27">27. éå‡¸ä¼˜åŒ–ä¸­çš„éç‚¹é—®é¢˜</h3>
<p><strong>è§‚å¯Ÿ27.1ï¼ˆè°±çƒé¢ä¸Šçš„éç‚¹ï¼‰</strong>ï¼šç”±äºè°±çº¦æŸçš„éå‡¸æ€§ï¼Œä¼˜åŒ–é—®é¢˜å¯èƒ½æœ‰å¤šä¸ªå±€éƒ¨æœ€ä¼˜å’Œéç‚¹ã€‚</p>
<p><strong>ç­–ç•¥27.1ï¼ˆé€ƒç¦»éç‚¹ï¼‰</strong>ï¼š
1. æ·»åŠ å™ªå£°ï¼ˆéšæœºé‡å¯ï¼‰
2. ä½¿ç”¨è´Ÿæ›²ç‡æ–¹å‘
3. Trust regionæ–¹æ³•</p>
<p>Muonçš„è°±èŒƒæ•°çº¦æŸæœ‰åŠ©äºé€‰æ‹©ä¸‹é™æ–¹å‘ï¼Œä½†ä¸èƒ½å®Œå…¨é¿å…éç‚¹é—®é¢˜ã€‚</p>
<h3 id="28">28. çº¦æŸçš„æ—¶å˜æ”¾æ¾</h3>
<p><strong>æ–¹æ³•28.1ï¼ˆè¯¾ç¨‹å­¦ä¹ ï¼‰</strong>ï¼šé€æ¸æ”¶ç´§çº¦æŸï¼š</p>
<p>$$
\|\boldsymbol{W}\|_2 \leq c(t), \quad c(t): c_0 \to 1
$$</p>
<p>åˆæœŸå…è®¸è¾ƒå¤§çš„è°±èŒƒæ•°ï¼ŒåæœŸä¸¥æ ¼çº¦æŸåˆ°1ã€‚è¿™æœ‰åŠ©äºæ¢ç´¢æ›´å¤§çš„å‚æ•°ç©ºé—´ã€‚</p>
<h3 id="29">29. ç†è®ºä¿è¯ä¸é—æ†¾ç•Œ</h3>
<p><strong>å®šç†29.1ï¼ˆåœ¨çº¿å­¦ä¹ ä¸­çš„é—æ†¾ï¼‰</strong>ï¼šåœ¨åœ¨çº¿å‡¸ä¼˜åŒ–æ¡†æ¶ä¸‹ï¼Œä½¿ç”¨Muon+è°±çƒé¢çš„é—æ†¾ç•Œä¸ºï¼š</p>
<p>$$
\text{Regret}_T = \sum_{t=1}^T L_t(\boldsymbol{W}_t) - \min_{\|\boldsymbol{W}\|_2=1}\sum_{t=1}^T L_t(\boldsymbol{W}) = O(\sqrt{T})
$$</p>
<p>ï¼ˆå‡è®¾æŸå¤±å‡½æ•°$L_t$æ˜¯å‡¸çš„ä¸”æ¢¯åº¦æœ‰ç•Œï¼‰</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼šåˆ©ç”¨è°±çƒé¢çš„ç›´å¾„æœ‰ç•Œæ€§å’ŒMuonæ–¹å‘çš„æœ€ä¼˜æ€§ã€‚</p>
<h3 id="30">30. å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘</h3>
<p><strong>é—®é¢˜30.1ï¼ˆå…¨å±€æ”¶æ•›æ€§ï¼‰</strong>ï¼šç®—æ³•8.1çš„å…¨å±€æ”¶æ•›æ€§å¦‚ä½•ï¼Ÿæ˜¯å¦æ€»èƒ½æ‰¾åˆ°å…¨å±€æœ€ä¼˜è§£ï¼Ÿ</p>
<p><strong>é—®é¢˜30.2ï¼ˆéå…‰æ»‘ç‚¹çš„å¤„ç†ï¼‰</strong>ï¼šå½“æœ€å¤§å¥‡å¼‚å€¼ä¸ç®€å•æ—¶ï¼Œå¦‚ä½•ç³»ç»Ÿåœ°å¤„ç†ï¼Ÿ</p>
<p><strong>é—®é¢˜30.3ï¼ˆä¸å…¶ä»–çº¦æŸçš„ç»„åˆï¼‰</strong>ï¼šèƒ½å¦åŒæ—¶æ–½åŠ è°±èŒƒæ•°çº¦æŸå’Œå…¶ä»–çº¦æŸï¼ˆå¦‚ç¨€ç–æ€§ï¼‰ï¼Ÿ</p>
<p><strong>é—®é¢˜30.4ï¼ˆæ·±åº¦ç½‘ç»œçš„ç«¯åˆ°ç«¯ä¼˜åŒ–ï¼‰</strong>ï¼šåœ¨æ·±åº¦ç½‘ç»œä¸­ï¼Œå¤šå±‚è°±çº¦æŸå¦‚ä½•ç›¸äº’ä½œç”¨ï¼Ÿæœ€ä¼˜çš„å±‚é—´åè°ƒç­–ç•¥æ˜¯ä»€ä¹ˆï¼Ÿ</p>
<h3 id="31">31. æ€»ç»“ä¸å±•æœ›</h3>
<p>æœ¬èŠ‚è¯¦ç»†æ¨å¯¼äº†è°±çƒé¢ä¸ŠMuonä¼˜åŒ–çš„æ•°å­¦ç†è®ºï¼š</p>
<p><strong>æ ¸å¿ƒå†…å®¹</strong>ï¼š
1. ä¸¥æ ¼å®šä¹‰äº†è°±çƒé¢åŠå…¶åˆ‡ç©ºé—´
2. æ¨å¯¼äº†è°±èŒƒæ•°æ¢¯åº¦çš„æ˜¾å¼å…¬å¼
3. å»ºç«‹äº†Muon+è°±çƒé¢çš„è¿­ä»£æ±‚è§£ç®—æ³•
4. åˆ†æäº†ä¸æ ‡å‡†çƒé¢ã€è°±å½’ä¸€åŒ–ã€Lipschitzçº¦æŸçš„è”ç³»
5. è®¨è®ºäº†æ”¶æ•›æ€§ã€å¤æ‚åº¦å’Œæ•°å€¼ç¨³å®šæ€§</p>
<p><strong>ç†è®ºè´¡çŒ®</strong>ï¼š
- å°†è°±èŒƒæ•°çº¦æŸä¸Muonä¼˜åŒ–å™¨æœ‰æœºç»“åˆ
- æä¾›äº†é¿å…çŸ©é˜µé€†è®¡ç®—çš„é«˜æ•ˆè¿­ä»£æ ¼å¼
- å»ºç«‹äº†ä¸æ·±åº¦å­¦ä¹ æ­£åˆ™åŒ–æŠ€æœ¯çš„ç†è®ºæ¡¥æ¢</p>
<p><strong>å®è·µæ„ä¹‰</strong>ï¼š
- ä¸ºéœ€è¦Lipschitzçº¦æŸçš„ç½‘ç»œæä¾›ä¼˜åŒ–ç®—æ³•
- è°±å½’ä¸€åŒ–çš„ç†è®ºåŸºç¡€
- ç”Ÿæˆæ¨¡å‹ã€åŸŸé€‚åº”ç­‰åœºæ™¯çš„åº”ç”¨</p>
<p>é€šè¿‡ä»¥ä¸Š31ä¸ªéƒ¨åˆ†çš„è¯¦ç»†æ¨å¯¼ï¼Œæˆ‘ä»¬å»ºç«‹äº†è°±çƒé¢ä¸ŠMuonä¼˜åŒ–çš„å®Œæ•´ç†è®ºæ¡†æ¶ï¼Œä¸ºç†è§£å’Œåº”ç”¨è¯¥æ–¹æ³•æä¾›äº†åšå®åŸºç¡€ã€‚</p>
        </div>
    </div>
</body>
</html>