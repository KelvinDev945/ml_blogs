<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biasé¡¹çš„ç¥å¥‡ä½œç”¨ï¼šRoPE + Bias = æ›´å¥½çš„é•¿åº¦å¤–æ¨æ€§</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>Biasé¡¹çš„ç¥å¥‡ä½œç”¨ï¼šRoPE + Bias = æ›´å¥½çš„é•¿åº¦å¤–æ¨æ€§</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 36.6 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9577">https://spaces.ac.cn/archives/9577</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ä¸‡ä¸‡æ²¡æƒ³åˆ°ï¼ŒBiasé¡¹èƒ½è·ŸTransformerçš„é•¿åº¦å¤–æ¨æ€§è”ç³»åœ¨ä¸€èµ·ï¼</p>
<p>é•¿åº¦å¤–æ¨æ€§æ˜¯æˆ‘ä»¬å¸Œæœ›Transformerå…·æœ‰çš„ä¸€ä¸ªç†æƒ³æ€§è´¨ï¼Œç¬”è€…æ›¾åœ¨<a href="/archives/9431">ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š7ã€é•¿åº¦å¤–æ¨æ€§ä¸å±€éƒ¨æ³¨æ„åŠ›ã€‹</a>ã€<a href="/archives/9444">ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š8ã€é•¿åº¦å¤–æ¨æ€§ä¸ä½ç½®é²æ£’æ€§ã€‹</a>ç³»ç»Ÿåœ°ä»‹ç»è¿‡è¿™ä¸€é—®é¢˜ã€‚è‡³äºBiasé¡¹ï¼ˆåç½®é¡¹ï¼‰ï¼Œç›®å‰çš„ä¸»æµè§‚ç‚¹æ˜¯å½“æ¨¡å‹è¶³å¤Ÿå¤§æ—¶ï¼ŒBiasé¡¹ä¸ä¼šæœ‰ä»€ä¹ˆç‰¹åˆ«çš„ä½œç”¨ï¼Œæ‰€ä»¥å¾ˆå¤šæ¨¡å‹é€‰æ‹©å»æ‰Biasé¡¹ï¼Œå…¶ä¸­ä»£è¡¨æ˜¯Googleçš„<a href="/archives/7867">T5</a>å’Œ<a href="https://papers.cool/arxiv/2204.02311">PaLM</a>ï¼Œæˆ‘ä»¬åé¢åšçš„<a href="/archives/8998">RoFormerV2</a>å’Œ<a href="/archives/9052">GAU-Î±</a>ä¹Ÿæ²¿ç”¨äº†è¿™ä¸ªåšæ³•ã€‚</p>
<p>é‚£ä¹ˆï¼Œè¿™ä¸¤ä¸ªçœ‹ä¸Šå»â€œé£ç‰›é©¬ä¸ç›¸åŠâ€çš„ä¸œè¥¿ï¼Œç©¶ç«Ÿæ˜¯æ€ä¹ˆè”ç³»èµ·æ¥çš„å‘¢ï¼ŸBiasé¡¹çœŸçš„å¯ä»¥å¢å¼ºTransformerçš„é•¿åº¦å¤–æ¨æ€§ï¼Ÿä¸”å¬ç¬”è€…æ…¢æ…¢é“æ¥ã€‚</p>
<h2 id="_1">éšè—å½©è›‹</h2>
<p>é¦–å…ˆï¼Œä¸ºä»€ä¹ˆä¼šæƒ³åˆ°è€ƒå¯ŸBiasé¡¹å’Œé•¿åº¦å¤–æ¨æ€§çš„è”ç³»å‘¢ï¼Ÿè¿™æ˜¯å› ä¸ºç¬”è€…å‰å‡ å¤©åœ¨é‡æ¸©GAUçš„è®ºæ–‡<a href="https://papers.cool/arxiv/2202.10447">ã€ŠTransformer Quality in Linear Timeã€‹</a>æ—¶ï¼Œå‘ç°äº†ä¹‹å‰æ²¡æœ‰åœ¨æ„çš„ä¸€ä¸ªâ€œéšè—å½©è›‹â€â€”â€”åŠ æ€§ç›¸å¯¹ä½ç½®ç¼–ç ï¼Œå…¶ä¼ªä»£ç ä¸º  </p>
<p><a href="/usr/uploads/2023/04/1959476500.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="GAUçš„åŠ æ€§ç›¸å¯¹ä½ç½®ç¼–ç çš„ä¼ªä»£ç " src="/usr/uploads/2023/04/1959476500.png" /></a></p>
<p>GAUçš„åŠ æ€§ç›¸å¯¹ä½ç½®ç¼–ç çš„ä¼ªä»£ç </p>
<p>è¿™é‡Œæˆ‘ä»¬ä¸»è¦çœ‹$n\geq 512$çš„éƒ¨åˆ†ï¼Œå¦‚æœå†™æˆå…¬å¼ï¼Œå¤§è‡´æ˜¯<br />
\begin{equation}\boldsymbol{q}_m^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n \quad\to\quad \boldsymbol{q}_m^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n+ \boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{b}\label{eq:rel-bias}\end{equation}<br />
å…¶ä¸­$\boldsymbol{\mathcal{R}}_m,\boldsymbol{\mathcal{R}}_n$æ˜¯RoPEçš„æ—‹è½¬çŸ©é˜µï¼Œ$\boldsymbol{a},\boldsymbol{b}$æ˜¯ä¸¤ä¸ªå¯å­¦ä¹ å‚æ•°ã€‚</p>
<p>è¿™ä¸ªåŠ æ€§ç›¸å¯¹ä½ç½®ç¼–ç å…¶å®ä¹‹å‰ä¹Ÿç•™æ„åˆ°äº†ï¼Œä½†å½“æ—¶çš„è¯„ä»·åªæ˜¯â€œä¸ç†è§£ä¸ºä»€ä¹ˆåŒæ—¶ç”¨å‡ ç§ä½ç½®ç¼–ç â€ï¼Œè€Œæœ€è¿‘ç¬”è€…ä¸€ç›´åœ¨æ€è€ƒé•¿åº¦å¤–æ¨æ€§é—®é¢˜ï¼Œæ‰€ä»¥å¯¹è¿™ä¸ªå½¢å¼å°±æ¯”è¾ƒæ•æ„Ÿäº†ã€‚å¯ä»¥è¯æ˜ï¼Œå½“$\boldsymbol{a}=\boldsymbol{b}=[\sqrt{\lambda},0,\sqrt{\lambda},0,\cdots,\sqrt{\lambda},0]^{\top}$æ—¶ï¼Œç»“æœæ­£å¥½æ˜¯<a href="/archives/9431">ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š7ã€é•¿åº¦å¤–æ¨æ€§ä¸å±€éƒ¨æ³¨æ„åŠ›ã€‹</a>ä»‹ç»çš„èƒ½æ”¹å–„é•¿åº¦å¤–æ¨æ€§çš„Sandwich ï¼Œå…¶åŸç†å°±æ˜¯$\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{b}$å‘ˆç°å‡ºå…³äº$|m-n|$é€’å‡çš„è¶‹åŠ¿ï¼ŒåŠ åˆ°æ³¨æ„åŠ›çŸ©é˜µä¸Šåï¼Œèƒ½å¤Ÿèµ·åˆ°å±€éƒ¨åŒ–æ³¨æ„åŠ›çš„ä½œç”¨ï¼Œè€Œæ ¹æ®<a href="/archives/9431">ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š7ã€é•¿åº¦å¤–æ¨æ€§ä¸å±€éƒ¨æ³¨æ„åŠ›ã€‹</a>ï¼Œæ³¨æ„åŠ›å±€éƒ¨åŒ–æ˜¯è¯­è¨€æ¨¡å‹å¤–æ¨æ€§çš„å…³é”®ã€‚</p>
<p>æ‰€ä»¥ç¬”è€…ä¸ç¦çŒœæµ‹ï¼Œéš¾é“åŸè®ºæ–‡ä¸­çš„è¿™ä¸ªåŠ æ€§ç›¸å¯¹ä½ç½®ç¼–ç ï¼Œå°±æ˜¯ç”¨æ¥å¢å¼ºé•¿åº¦å¤–æ¨æ€§çš„ï¼ŸGAUçš„ä½œè€…ç«Ÿç„¶å¦‚æ­¤æœ‰å…ˆè§ä¹‹æ˜ï¼Œæ—©åœ¨Sandwichä¹‹å‰å°±æå‡ºäº†ç±»ä¼¼çš„æƒ³æ³•æ¥è§£å†³é•¿åº¦å¤–æ¨æ€§é—®é¢˜ï¼Ÿ</p>
<h2 id="_2">æ¢æˆåç½®</h2>
<p>ä¸è¿‡ï¼Œå¯¹äºç¬”è€…æ¥è¯´ï¼Œè¿™ç§å¾€AttentionçŸ©é˜µä¸Šé¢å¤–åŠ ä¸Šä¸€é¡¹æ¥å¢å¼ºé•¿åº¦å¤–æ¨æ€§çš„æ–¹æ¡ˆéƒ½æ˜¾å¾—ä¸å¤Ÿä¼˜é›…ï¼Œæ‰€ä»¥ä¸ç®¡åŸä½œè€…æ„å›¾å¦‚ä½•ä»¥åŠå®é™…æ•ˆæœå¦‚ä½•ï¼Œç¬”è€…éƒ½ä¸å€¾å‘è¿™æ ·åšã€‚æœ‰ä»€ä¹ˆç±»ä¼¼çš„ä½†å‡ ä¹â€œæ— æ„Ÿâ€çš„æ–¹æ¡ˆå‘¢ï¼Ÿç¬”è€…è€ƒè™‘åˆ°ï¼Œå¦‚æœ$\boldsymbol{a}$ã€$\boldsymbol{b}$åˆ†åˆ«æ˜¯$\boldsymbol{q}_m,\boldsymbol{k}_n$çš„Biasé¡¹ï¼Œæˆ–è®¸å¯ä»¥èµ·åˆ°ç±»ä¼¼çš„æ•ˆæœï¼Œå³è€ƒè™‘<br />
\begin{equation}\boldsymbol{q}_m^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n \quad\to\quad (\boldsymbol{q}_m + \boldsymbol{a})^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n(\boldsymbol{k}_n + \boldsymbol{b})\end{equation}<br />
å¾ˆæ˜æ˜¾ï¼Œå•çº¯å¢åŠ ä¸€ä¸ªBiasé¡¹ï¼Œä¸ç®¡ä»å½¢å¼ä¸Šè¿˜æ˜¯è®¡ç®—é‡ä¸Šçœ‹éƒ½å‡ ä¹æ˜¯â€œæ— æ„Ÿâ€çš„ï¼Œå¦‚æœè¿™æ ·å°±èƒ½å¢å¼ºé•¿åº¦å¤–æ¨æ€§ï¼Œæ— ç–‘æ˜¯ä¸€ä¸ªå¾ˆæ¼‚äº®çš„æ–¹æ¡ˆã€‚æ˜¯å¦å¯è¡Œå‘¢ï¼Ÿæˆ‘ä»¬å…ˆæ¥çœ‹å±•å¼€åçš„ç»“æœï¼š<br />
\begin{equation}\boldsymbol{q}_m^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n + \boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n + \boldsymbol{q}_m^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{b} + \boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{b} \label{eq:bias}\end{equation}<br />
å…¶ä¸­ç¬¬ä¸€é¡¹å’Œç¬¬å››é¡¹æ­£å¥½å¯¹åº”å…¬å¼$\eqref{eq:rel-bias}$ï¼Œå®ƒä»¬éƒ½æ˜¯æˆ‘ä»¬æƒ³è¦çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³çœ‹çœ‹ç¬¬äºŒé¡¹å’Œç¬¬ä¸‰é¡¹èµ·åˆ°ä»€ä¹ˆä½œç”¨ï¼Œå¦‚æœå®ƒä»¬ä¸ä¼šæœ‰ä»€ä¹ˆæ˜æ˜¾çš„æ•ˆåº”ï¼Œé‚£ä¹ˆç›´æ¥åŠ ä¸ŠBiasé¡¹çš„åšæ³•ï¼Œè‡³å°‘æ˜¯â€œæœ‰å¸Œæœ›â€èƒ½å¤Ÿå–å¾—è·Ÿå¼$\eqref{eq:rel-bias}$æˆ–è€…Sandwichç›¸ä¼¼çš„å¤–æ¨æ•ˆæœã€‚</p>
<p>ç¬”è€…æ˜¯è¿™æ ·æƒ³çš„ï¼šä½œä¸ºAttentionçš„Queryå’ŒKeyï¼Œ$\boldsymbol{q}<em n-m="n-m">m$ã€$\boldsymbol{k}_n$åº”è¯¥æ˜¯æ¯”è¾ƒâ€œå„å‘åŒæ€§â€çš„ï¼Œå³å®ƒä»¬çš„æ–¹å‘æ¯”è¾ƒå‡åŒ€ï¼Œæ¥è¿‘çƒé¢ä¸Šå‡åŒ€é‡‡æ ·ï¼Œè€Œ$\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n=\boldsymbol{\mathcal{R}}</em>$è¿™ä¸¤é¡¹ï¼Œå°±ç›¸å½“äºä»å„å‘åŒæ€§åˆ†å¸ƒé‡‡æ ·å‡ºæ¥çš„å‘é‡ï¼Œè·Ÿä¸€ä¸ªå›ºå®šå‘é‡çš„å†…ç§¯ï¼Œæ ¹æ®æˆ‘ä»¬åœ¨}$åªæ˜¯ä¸€ä¸ªæ­£äº¤å˜æ¢ï¼Œå®ƒä¸æ”¹å˜$\boldsymbol{q}_m$ã€$\boldsymbol{k}_n$çš„å„å‘åŒæ€§æ€§è´¨ï¼Œé‚£ä¹ˆ$\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n $ã€$\boldsymbol{q}_m^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{b<a href="/archives/7076">ã€Šnç»´ç©ºé—´ä¸‹ä¸¤ä¸ªéšæœºå‘é‡çš„å¤¹è§’åˆ†å¸ƒã€‹</a>ä¸­çš„è®¨è®ºï¼Œè¿™æ ·çš„ä¸¤ä¸ªå‘é‡å¤¹è§’åº”è¯¥æ˜¯å¾ˆæ¥è¿‘90åº¦çš„ï¼Œæ¢è¨€ä¹‹è¿™ä¸ªå†…ç§¯çš„æœŸæœ›åº”è¯¥æ˜¯0ï¼Œæ‰€ä»¥ç¬¬äºŒé¡¹å’Œç¬¬ä¸‰é¡¹çš„æ•ˆåº”ç†è®ºä¸Šæ²¡æœ‰å‰©ä½™ä¸¤é¡¹é‚£ä¹ˆå¼ºã€‚</p>
<p>å½“ç„¶ï¼Œè¿™ä»…ä»…æ˜¯çŒœæµ‹ï¼Œå®é™…å®ƒä¼šè®­ç»ƒæˆæ€æ ·ï¼Œåªèƒ½é€šè¿‡å®éªŒæ¥ç¡®å®šã€‚æ‰€ä»¥äº‹ä¸å®œè¿Ÿï¼Œç¬”è€…ç«‹åˆ»è¿›è¡Œäº†å®éªŒã€‚</p>
<h2 id="_3">å®éªŒç»“æœ</h2>
<p>è¿™æ¬¡ç¬”è€…é€‰äº†è¯­è¨€æ¨¡å‹ä»»åŠ¡è¿›è¡Œå®éªŒï¼Œæ¨¡å‹æ¶æ„è¿˜æ˜¯ä¹‹å‰çš„<a href="/archives/9052">GAU-Î±</a>ï¼Œè®­ç»ƒé•¿åº¦å’Œbatch_sizeéƒ½æ˜¯512ï¼Œä¼˜åŒ–å™¨æ˜¯<a href="/archives/9512">Tiger</a>ï¼Œä¸¤ä¸ªæ¨¡å‹çš„å”¯ä¸€å·®åˆ«å°±æ˜¯Qã€Kçš„Biasæ˜¯å¦å¼€å¯ï¼ˆå…¶ä»–Biasä»è¢«å»æ‰ï¼‰ã€‚</p>
<p>å¤–æ¨æ•ˆæœä¸Šçš„å¯¹æ¯”ï¼š<br />
$$\begin{array}{c}  
\text{ä¸åŒæµ‹è¯•é•¿åº¦ä¸‹çš„LMå‡†ç¡®ç‡} \\\  
{\begin{array}{c|cccc}  
\hline  
& 512 & 1024 & 2048 & 4096 \\\  
\hline  
\text{w/o Bias} & 52.37\% & 33.15\% & 22.85\% & 17.87\% \\\  
\text{w/ Bias} & 52.75\% & 50.99\% & 45.25\% & 39.55\% \\\  
\hline  
\end{array}}  
\end{array}$$<br />
å¯ä»¥çœ‹åˆ°ï¼ŒBiasé¡¹ç¡®å®ä¸æ€ä¹ˆå½±å“è®­ç»ƒæ•ˆæœï¼ˆ512é•¿åº¦ï¼‰ï¼Œä½†å´åœ¨é•¿åº¦å¤–æ¨æ€§ä¸Šé¢æ˜æ˜¾æ‹‰å¼€äº†å·®è·ï¼Œçœ‹ä¼¼æ¯«æ— å­˜åœ¨æ„Ÿçš„Biasé¡¹å±…ç„¶æœ‰æ­¤ç¥å¥‡ä½œç”¨ï¼å½“ç„¶ï¼Œè¦æ˜¯é‡è·‘å‡ æ¬¡å®éªŒï¼Œå¤–æ¨æ€§çš„ç»“æœå¯èƒ½ä¼šæœ‰æ˜æ˜¾çš„æ³¢åŠ¨ï¼Œæ¯•ç«Ÿé•¿åº¦å¤–æ¨æ€§å±äºâ€œèµ é€åŠŸèƒ½â€ï¼Œå¹¶ä¸æ˜¯æˆ‘ä»¬ä¸»åŠ¨è§¦å‘çš„ã€‚</p>
<p>ä¸ºäº†éªŒè¯å‰©ä¸‹ç”Ÿæ•ˆæœºåˆ¶æ˜¯å¦å¦‚æˆ‘ä»¬çŒœæµ‹ï¼Œç¬”è€…å¯è§†åŒ–äº†å¼$\eqref{eq:bias}$çš„å››é¡¹åœ¨æŸä¸ªæ ·æœ¬æŸä¸€å±‚çš„å˜åŒ–è§„å¾‹ï¼š  </p>
<p><a href="/usr/uploads/2023/04/83521782.svg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="åŠ ä¸ŠBiasåå››é¡¹å†…ç§¯å¯¹æ¯”" src="/usr/uploads/2023/04/83521782.svg" /></a></p>
<p>åŠ ä¸ŠBiasåå››é¡¹å†…ç§¯å¯¹æ¯”</p>
<p>å¯ä»¥çœ‹åˆ°ï¼Œç¬¬4é¡¹ç¡®ç¡®å®å®å‘ˆç°è¡°å‡è¶‹åŠ¿ï¼Œå¹¶ä¸”å…¶å¤§å°å æ®äº†ä¸»å¯¼åœ°ä½ï¼Œå°†è¿™å››é¡¹å åŠ èµ·æ¥ï¼Œä¸æ²¡æœ‰åŠ Biasçš„æ¨¡å‹å¯¹æ¯”å¦‚ä¸‹ï¼š  </p>
<p><a href="/usr/uploads/2023/04/2535762443.svg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="æœ‰æ— Biasçš„AttentionçŸ©é˜µå¯¹æ¯”" src="/usr/uploads/2023/04/2535762443.svg" /></a></p>
<p>æœ‰æ— Biasçš„AttentionçŸ©é˜µå¯¹æ¯”</p>
<p>æ²¡æœ‰Biasçš„æ¨¡å‹ï¼ˆè“è‰²ï¼‰ï¼ŒAttentionåœ¨è®­ç»ƒé•¿åº¦ï¼ˆ512ï¼‰èŒƒå›´å†…ç¡®å®ä¹Ÿå‘ˆç°å‡ºè¡°å‡è¶‹åŠ¿ï¼Œä½†é•¿åº¦å¢åŠ ä¹‹åå°±ä¸Šå‡äº†ï¼Œæ²¡æœ‰æ˜æ˜¾çš„å±€éƒ¨æ€§ï¼Œè¿™å°±æ˜¯å®ƒå¤–æ¨æ€§ä¸å¤Ÿå¥½çš„åŸå› ï¼›ç›¸åï¼Œè·Ÿå‰é¢çš„çŒœæµ‹ä¸€è‡´ï¼Œå¸¦æœ‰Biasé¡¹çš„æ¨¡å‹ï¼ˆæ©™è‰²ï¼‰çš„æ³¨æ„åŠ›çŸ©é˜µå‘ˆç°æ›´æ˜æ˜¾çš„è¡°å‡è¶‹åŠ¿ï¼Œæ¢è¨€ä¹‹å®ƒçš„å±€éƒ¨åŒ–æ•ˆåº”æ›´åŠ å¼ºï¼Œä»è€Œæœ‰æ›´å¥½çš„å¤–æ¨æ€§èƒ½ã€‚éœ€è¦æŒ‡å‡ºçš„æ˜¯ï¼ŒåŠ ä¸ŠBiasçš„æ¨¡å‹å¹¶ä¸æ˜¯æ¯ä¸€å±‚çš„Attentionéƒ½æœ‰è¿™ä¹ˆæ˜æ˜¾çš„è¡°å‡è¶‹åŠ¿ï¼Œæ€»ä½“æ¥è¯´å‰é¢çš„å±‚è¡°å‡è¶‹åŠ¿æ›´æ˜æ˜¾äº›ï¼Œåé¢çš„å±‚è¡°å‡è¶‹åŠ¿æ›´å¼±äº›ï¼Œè¯´æ˜è¶Šé è¿‘è¾“å…¥çš„å±‚è¶Šå…³æ³¨å±€éƒ¨ä¿¡æ¯ï¼Œè¿™è·Ÿ<a href="https://papers.cool/arxiv/2210.10340">ã€ŠThe Devil in Linear Transformerã€‹</a>çš„ç»“è®ºä¸€è‡´ã€‚</p>
<p><strong>ã€æ³¨ï¼šåæ¥ç»è¿‡åå¤æµ‹è¯•å‘ç°ï¼Œå‘ç°æ­¤ç¯‡æ–‡ç« çš„é•¿åº¦å¤–æ¨ç»“æœå¯å¤ç°æ€§æ¯”è¾ƒä¸ç¨³å®šï¼ˆå¯èƒ½è·Ÿæ¨¡å‹ç»“æ„ã€è¶…å‚æ•°ç­‰ç´§å¯†ç›¸å…³ï¼‰ï¼Œè¯·è‡ªè¡Œæ–Ÿé…Œä½¿ç”¨ã€‚ã€‘</strong></p>
<h2 id="_4">å»¶ä¼¸æ€è€ƒ</h2>
<p>è¿™æ—¶å€™é—®é¢˜å°±æ¥äº†ï¼šä¹‹å‰åšé•¿åº¦å¤–æ¨æ€§çš„å·¥ä½œä¸æ˜¯éƒ½éªŒè¯äº†RoPEçš„å¤–æ¨æ€§ä¸å¤§å¥½äº†å—ï¼Ÿéš¾é“å®ƒä»¬éƒ½æ²¡åŠ Biasï¼Ÿä¸ºæ­¤ï¼Œç¬”è€…ç‰¹æ„å»è€ƒè¯äº†ä¸€ä¸‹ï¼Œæœç„¶â€ä¸å‡ºæ‰€æ–™â€ï¼šâ€œå¼€å±±ä¹‹ä½œâ€ALIBIå’Œæœ€è¿‘çš„XPOSéƒ½æ˜¯æ²¡æœ‰åŠ Biasé¡¹çš„ï¼Œè€ŒKERPLEå’ŒSandwichåˆ™æ˜¯åŠ äº†Biasé¡¹çš„ã€‚ä¹‹å‰ç¬”è€…åœ¨è¯»è®ºæ–‡çš„æ—¶å€™ï¼Œå°±ä¸€ç›´æ„Ÿè§‰KERPLEå’ŒSandwichä¸­çš„RoPEå¤–æ¨æ•ˆæœä¼¼ä¹æ¯”ALIBIå’ŒXPOSä¸­çš„å¥½ï¼Œç°åœ¨å¯ä»¥è‚¯å®šè¿™åº”è¯¥ä¸æ˜¯é”™è§‰äº†ï¼Œæ—¢ç„¶KERPLEå’ŒSandwichéƒ½åŠ äº†Biasï¼Œé‚£ä¹ˆæ ¹æ®æœ¬æ–‡çš„ç»“è®ºï¼ŒRoPEæ˜¯å¯èƒ½å‘ˆç°å‡ºæ›´å¥½çš„é•¿åº¦å¤–æ¨æ€§çš„ã€‚</p>
<p>å¯èƒ½æœ‰è¯»è€…æƒ³èµ·ï¼Œä¹‹å‰ä¸æ˜¯è¯´Attentionçš„Keyçš„Biaså¯ä»¥å»æ‰å—ï¼Ÿéš¾é“è¿™é‡Œä¹Ÿå¯ä»¥å»æ‰ï¼Ÿå…³äºè¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥å‚è€ƒçŸ¥ä¹çš„æé—®<a href="https://www.zhihu.com/question/506218961">ã€Šä¸ºä»€ä¹ˆæœ‰çš„ Vision Transformer ä¸­çš„ key ä¸éœ€è¦ bias ï¼Ÿã€‹</a>ï¼Œäº‹å®ä¸Šï¼Œâ€œå¯ä»¥å»æ‰Keyçš„Biasâ€è¿™ä¸ªç»“è®ºï¼Œæ˜¯é’ˆå¯¹æ²¡æœ‰RoPEçš„Attentionçš„ï¼Œç”±äºSoftmaxçš„å­˜åœ¨ï¼ŒåŠ ä¸Šçš„biaså¯ä»¥çº¦æ‰ï¼š<br />
\begin{equation}\frac{e^{\boldsymbol{q}\cdot(\boldsymbol{k}_n + \boldsymbol{b})}}{\sum\limits_n e^{\boldsymbol{q}\cdot(\boldsymbol{k}_n + \boldsymbol{b})}} = \frac{e^{\boldsymbol{q}\cdot\boldsymbol{k}_n}e^{\boldsymbol{q}\cdot\boldsymbol{b}}}{\sum\limits_n e^{\boldsymbol{q}\cdot\boldsymbol{k}_n} e^{\boldsymbol{q}\cdot\boldsymbol{b}}}= \frac{e^{\boldsymbol{q}\cdot\boldsymbol{k}_n}}{\sum\limits_n e^{\boldsymbol{q}\cdot\boldsymbol{k}_n}}\end{equation}<br />
ç„¶è€Œï¼Œè¿™ä¸ªâ€œå¯ä»¥çº¦æ‰â€ä¾èµ–äº$\boldsymbol{b}$è·Ÿ$n$æ— å…³ï¼Œä½†ä»å¼$\eqref{eq:bias}$æˆ‘ä»¬å°±çŸ¥é“ï¼Œç»è¿‡RoPEåï¼Œ$\boldsymbol{b}$ä¹Ÿç®—æ˜¯$m,n$çš„å‡½æ•°äº†ï¼Œå®é™…ä¸Šæ˜¯æ— æ³•çº¦æ‰çš„ï¼Œå› æ­¤å¯¹äºåŠ äº†RoPEçš„æ¨¡å‹ï¼ŒBiasé¡¹å»æ‰å‰åä¼šæœ‰ä¸ä¸€æ ·çš„æ•ˆæœã€‚</p>
<p>è¿˜æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯ä¸ºä»€ä¹ˆè¦è´¹åŠ›æ¢ç´¢é•¿åº¦å¤–æ¨æ€§å‘¢ï¼Ÿç›´æ¥åœ¨æ›´é•¿çš„æ ·æœ¬ä¸‹å¾®è°ƒæ¨¡å‹ä¸è¡Œå—ï¼Ÿäº‹å®ä¸Šï¼Œå³ä¾¿æ˜¯å¯¹äºæŠ±æœ‰è¿™æ ·æƒ³æ³•çš„è¯»è€…ï¼Œé•¿åº¦å¤–æ¨æ€§ä¹Ÿæ˜¯æœ‰å¥½å¤„çš„ã€‚æŠ›å¼€ç®—åŠ›ä¸è¯´ï¼Œæ›´å¥½çš„é•¿åº¦å¤–æ¨æ€§æ„å‘³ç€åœ¨å¾®è°ƒçš„æ—¶å€™ä¸é¢„è®­ç»ƒå·®è·æ›´å°ï¼Œäºæ˜¯å¾®è°ƒæ›´ä¸å®¹æ˜“å‘ç”Ÿç¾éš¾æ€§é—å¿˜ï¼Œè¿™å¯¹äºå½“å‰çš„LLMæ›´ä¸ºé‡è¦äº†ã€‚å½“ç„¶ï¼Œè¿˜å¯ä»¥å‘æ•£ä¸€ä¸‹ï¼Œæœ€ç†æƒ³çš„ç»“æœæ˜¯ï¼šåœ¨çŸ­æ–‡æœ¬å­¦ä¹ çš„æ¨¡å‹ï¼Œèƒ½å¤Ÿåˆ‡æ¢åˆ°é•¿æ–‡æœ¬åœºæ™¯è€Œæ— æŸæ•ˆæœç”šè‡³æ•ˆæœæ›´ä¼˜ã€‚</p>
<h2 id="_5">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡åˆ†äº«äº†ç¬”è€…å‘ç°çš„ä¸€ä¸ªâ€œä¸‡ä¸‡æ²¡æƒ³åˆ°â€çš„æœ‰è¶£ç»“è®ºï¼šBiasé¡¹èƒ½å¢å¼ºRoPEæ¨¡å‹çš„é•¿åº¦å¤–æ¨æ€§ï¼çœ‹ä¸Šå»æ¯«æ— å­˜åœ¨æ„Ÿçš„Biasé¡¹ï¼Œå±…ç„¶èƒ½è·ŸTransformerçš„é•¿åº¦å¤–æ¨æ€§è”ç³»åœ¨ä¸€èµ·ï¼Œè®©äººä¸å¾—ä¸æ„Ÿå¹ç»†èŠ‚çš„é‡è¦æ€§â€”â€”ç»†ææœ«èŠ‚æœ‰æ—¶å€™ä¹Ÿèƒ½å‘æŒ¥å…³é”®ä½œç”¨ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9577">https://spaces.ac.cn/archives/9577</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Apr. 03, 2023). ã€ŠBiasé¡¹çš„ç¥å¥‡ä½œç”¨ï¼šRoPE + Bias = æ›´å¥½çš„é•¿åº¦å¤–æ¨æ€§ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9577">https://spaces.ac.cn/archives/9577</a></p>
<p>@online{kexuefm-9577,<br />
title={Biasé¡¹çš„ç¥å¥‡ä½œç”¨ï¼šRoPE + Bias = æ›´å¥½çš„é•¿åº¦å¤–æ¨æ€§},<br />
author={è‹å‰‘æ—},<br />
year={2023},<br />
month={Apr},<br />
url={\url{https://spaces.ac.cn/archives/9577}},<br />
} </p>
<hr />
<h2 id="_6">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1-attention">1. Attentionæœºåˆ¶çš„åŸºç¡€æ•°å­¦åŸç†</h3>
<p><strong>Scaled Dot-Product Attentionçš„æ ‡å‡†å½¢å¼</strong>ï¼š</p>
<p>å¯¹äºæŸ¥è¯¢çŸ©é˜µ$\boldsymbol{Q} \in \mathbb{R}^{n \times d}$ã€é”®çŸ©é˜µ$\boldsymbol{K} \in \mathbb{R}^{n \times d}$å’Œå€¼çŸ©é˜µ$\boldsymbol{V} \in \mathbb{R}^{n \times d_v}$ï¼ŒAttentionæœºåˆ¶å®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
\text{Attention}(\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}) = \text{softmax}\left(\frac{\boldsymbol{Q}\boldsymbol{K}^{\top}}{\sqrt{d}}\right)\boldsymbol{V} \tag{1}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™é‡Œ$n$æ˜¯åºåˆ—é•¿åº¦ï¼Œ$d$æ˜¯éšè—ç»´åº¦ï¼Œ$\sqrt{d}$æ˜¯ç¼©æ”¾å› å­ï¼Œç”¨äºæ§åˆ¶ç‚¹ç§¯çš„æ–¹å·®ã€‚</p>
<p><strong>é€å…ƒç´ å±•å¼€</strong>ï¼š</p>
<p>å¯¹äºä½ç½®$m$çš„æŸ¥è¯¢å’Œä½ç½®$n$çš„é”®ï¼Œå®ƒä»¬çš„æ³¨æ„åŠ›å¾—åˆ†ä¸ºï¼š</p>
<p>\begin{equation}
s_{mn} = \frac{\boldsymbol{q}<em i="1">m \cdot \boldsymbol{k}_n}{\sqrt{d}} = \frac{1}{\sqrt{d}}\sum</em>
\end{equation}}^d q_{m,i} k_{n,i} \tag{2</p>
<p><strong>Softmaxå½’ä¸€åŒ–</strong>ï¼š</p>
<p>\begin{equation}
\alpha_{mn} = \frac{\exp(s_{mn})}{\sum_{j=1}^N \exp(s_{mj})} \tag{3}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šSoftmaxç¡®ä¿å¯¹æ¯ä¸ªæŸ¥è¯¢ä½ç½®$m$ï¼Œæ‰€æœ‰æ³¨æ„åŠ›æƒé‡$\alpha_{mn}$çš„å’Œä¸º1ï¼Œå³$\sum_{j=1}^N \alpha_{mj} = 1$ã€‚</p>
<p><strong>è¾“å‡ºè®¡ç®—</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{o}<em n="1">m = \sum</em>
\end{equation}}^N \alpha_{mn} \boldsymbol{v}_n \tag{4</p>
<h3 id="2">2. ç»å¯¹ä½ç½®ç¼–ç çš„æ•°å­¦è¡¨ç¤º</h3>
<p><strong>æ­£å¼¦ä½ç½®ç¼–ç ï¼ˆSinusoidal Position Encodingï¼‰</strong>ï¼š</p>
<p>å¯¹äºä½ç½®$m$å’Œç»´åº¦$i$ï¼Œä½ç½®ç¼–ç å®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
\text{PE}(m, 2i) = \sin\left(\frac{m}{10000^{2i/d}}\right) \tag{5}
\end{equation}</p>
<p>\begin{equation}
\text{PE}(m, 2i+1) = \cos\left(\frac{m}{10000^{2i/d}}\right) \tag{6}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ç§ç¼–ç ä½¿ç”¨ä¸åŒé¢‘ç‡çš„æ­£å¼¦å’Œä½™å¼¦å‡½æ•°ï¼Œä½¿æ¨¡å‹èƒ½å¤Ÿå­¦ä¹ ç›¸å¯¹ä½ç½®å…³ç³»ã€‚</p>
<p><strong>åŠ æ€§ä½ç½®ç¼–ç </strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{x}_m' = \boldsymbol{x}_m + \text{PE}(m) \tag{7}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{x}_m$æ˜¯ä½ç½®$m$çš„åŸå§‹åµŒå…¥å‘é‡ã€‚</p>
<h3 id="3-rope">3. æ—‹è½¬ä½ç½®ç¼–ç ï¼ˆRoPEï¼‰çš„æ ¸å¿ƒç†è®º</h3>
<p><strong>æ—‹è½¬çŸ©é˜µçš„å®šä¹‰</strong>ï¼š</p>
<p>å¯¹äºäºŒç»´ç©ºé—´ä¸­çš„æ—‹è½¬ï¼Œæ—‹è½¬çŸ©é˜µå®šä¹‰ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{R}(\theta) = \begin{pmatrix}
\cos\theta &amp; -\sin\theta \
\sin\theta &amp; \cos\theta
\end{pmatrix} \tag{8}
\end{equation}</p>
<p><strong>æ—‹è½¬çŸ©é˜µçš„æ€§è´¨</strong>ï¼š</p>
<ol>
<li><strong>æ­£äº¤æ€§</strong>ï¼š$\boldsymbol{R}^{\top}\boldsymbol{R} = \boldsymbol{I}$</li>
<li><strong>è¡Œåˆ—å¼</strong>ï¼š$\det(\boldsymbol{R}) = 1$</li>
<li><strong>å†…ç§¯ä¿æŒ</strong>ï¼š$(\boldsymbol{R}\boldsymbol{a})^{\top}(\boldsymbol{R}\boldsymbol{b}) = \boldsymbol{a}^{\top}\boldsymbol{b}$</li>
</ol>
<p><strong>è¯æ˜å†…ç§¯ä¿æŒæ€§</strong>ï¼š</p>
<p>\begin{equation}
(\boldsymbol{R}\boldsymbol{a})^{\top}(\boldsymbol{R}\boldsymbol{b}) = \boldsymbol{a}^{\top}\boldsymbol{R}^{\top}\boldsymbol{R}\boldsymbol{b} = \boldsymbol{a}^{\top}\boldsymbol{I}\boldsymbol{b} = \boldsymbol{a}^{\top}\boldsymbol{b} \tag{9}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šå†…ç§¯ä¿æŒæ€§æ˜¯RoPEçš„å…³é”®æ€§è´¨ï¼Œå®ƒä¿è¯æ—‹è½¬ä¸æ”¹å˜å‘é‡çš„èŒƒæ•°å’Œå¤¹è§’ã€‚</p>
<p><strong>é«˜ç»´æ—‹è½¬çŸ©é˜µçš„åˆ†å—æ„é€ </strong>ï¼š</p>
<p>å¯¹äº$d$ç»´å‘é‡ï¼ˆ$d$ä¸ºå¶æ•°ï¼‰ï¼Œå°†å…¶åˆ†ä¸º$d/2$ä¸ªäºŒç»´å­ç©ºé—´ï¼Œæ¯ä¸ªå­ç©ºé—´ä½¿ç”¨ä¸åŒçš„æ—‹è½¬è§’åº¦ï¼š</p>
<p>\begin{equation}
\boldsymbol{\mathcal{R}}_m = \begin{pmatrix}
\cos(m\theta_1) &amp; -\sin(m\theta_1) &amp; 0 &amp; 0 &amp; \cdots \
\sin(m\theta_1) &amp; \cos(m\theta_1) &amp; 0 &amp; 0 &amp; \cdots \
0 &amp; 0 &amp; \cos(m\theta_2) &amp; -\sin(m\theta_2) &amp; \cdots \
0 &amp; 0 &amp; \sin(m\theta_2) &amp; \cos(m\theta_2) &amp; \cdots \
\vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots
\end{pmatrix} \tag{10}
\end{equation}</p>
<p>å…¶ä¸­$\theta_i = 10000^{-2i/d}$æ˜¯ç¬¬$i$ä¸ªå­ç©ºé—´çš„åŸºç¡€æ—‹è½¬é¢‘ç‡ã€‚</p>
<h3 id="4-rope">4. RoPEçš„ç›¸å¯¹ä½ç½®æ€§è´¨</h3>
<p><strong>ç›¸å¯¹ä½ç½®ç¼–ç çš„æ¨å¯¼</strong>ï¼š</p>
<p>åº”ç”¨RoPEåï¼Œä½ç½®$m$çš„æŸ¥è¯¢å’Œä½ç½®$n$çš„é”®çš„å†…ç§¯ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{q}<em n-m="n-m">m^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n = \boldsymbol{q}_m^{\top}\boldsymbol{\mathcal{R}}</em>
\end{equation}}\boldsymbol{k}_n \tag{11</p>
<p><strong>è¯æ˜</strong>ï¼šåˆ©ç”¨æ—‹è½¬çŸ©é˜µçš„ç¾¤æ€§è´¨ï¼š</p>
<p>\begin{equation}
\boldsymbol{\mathcal{R}}<em -m="-m">m^{\top}\boldsymbol{\mathcal{R}}_n = \boldsymbol{\mathcal{R}}</em>}\boldsymbol{\mathcal{R}<em n-m="n-m">n = \boldsymbol{\mathcal{R}}</em>
\end{equation}} \tag{12</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ä¸ªæ€§è´¨è¡¨æ˜ï¼ŒRoPEä½¿å¾—Attentionå¾—åˆ†åªä¾èµ–äºç›¸å¯¹ä½ç½®$n-m$ï¼Œè€Œä¸ä¾èµ–äºç»å¯¹ä½ç½®$m$å’Œ$n$ã€‚</p>
<p><strong>å…·ä½“è®¡ç®—ç¤ºä¾‹ï¼ˆäºŒç»´æƒ…å†µï¼‰</strong>ï¼š</p>
<p>è®¾$\boldsymbol{q}_m = [q_1, q_2]^{\top}$ï¼Œ$\boldsymbol{k}_n = [k_1, k_2]^{\top}$ï¼Œæ—‹è½¬è§’åº¦$\theta = 1$ã€‚</p>
<p>ä½ç½®$m=1$çš„æ—‹è½¬çŸ©é˜µï¼š
\begin{equation}
\boldsymbol{\mathcal{R}}_1 = \begin{pmatrix}
\cos(1) &amp; -\sin(1) \
\sin(1) &amp; \cos(1)
\end{pmatrix} \approx \begin{pmatrix}
0.540 &amp; -0.841 \
0.841 &amp; 0.540
\end{pmatrix} \tag{13}
\end{equation}</p>
<p>ä½ç½®$m=3$çš„æ—‹è½¬çŸ©é˜µï¼š
\begin{equation}
\boldsymbol{\mathcal{R}}_3 = \begin{pmatrix}
\cos(3) &amp; -\sin(3) \
\sin(3) &amp; \cos(3)
\end{pmatrix} \approx \begin{pmatrix}
-0.990 &amp; -0.141 \
0.141 &amp; -0.990
\end{pmatrix} \tag{14}
\end{equation}</p>
<p>ç›¸å¯¹æ—‹è½¬çŸ©é˜µï¼š
\begin{equation}
\boldsymbol{\mathcal{R}}_1^{\top}\boldsymbol{\mathcal{R}}_3 = \boldsymbol{\mathcal{R}}_2 = \begin{pmatrix}
\cos(2) &amp; -\sin(2) \
\sin(2) &amp; \cos(2)
\end{pmatrix} \tag{15}
\end{equation}</p>
<h3 id="5-biasattention">5. Biasé¡¹åœ¨æ ‡å‡†Attentionä¸­çš„ä½œç”¨</h3>
<p><strong>ä¸å¸¦ä½ç½®ç¼–ç çš„Attentionä¸Bias</strong>ï¼š</p>
<p>æ ‡å‡†çš„Queryå’ŒKeyè®¡ç®—åŒ…å«Biasé¡¹ï¼š</p>
<p>\begin{equation}
\boldsymbol{q}_m = \boldsymbol{x}_m\boldsymbol{W}_q + \boldsymbol{b}_q \tag{16}
\end{equation}</p>
<p>\begin{equation}
\boldsymbol{k}_n = \boldsymbol{x}_n\boldsymbol{W}_k + \boldsymbol{b}_k \tag{17}
\end{equation}</p>
<p><strong>å†…ç§¯å±•å¼€</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{q}_m \cdot \boldsymbol{k}_n = (\boldsymbol{x}_m\boldsymbol{W}_q + \boldsymbol{b}_q)^{\top}(\boldsymbol{x}_n\boldsymbol{W}_k + \boldsymbol{b}_k) \tag{18}
\end{equation}</p>
<p>\begin{equation}
= \boldsymbol{x}_m\boldsymbol{W}_q\boldsymbol{W}_k^{\top}\boldsymbol{x}_n^{\top} + \boldsymbol{x}_m\boldsymbol{W}_q\boldsymbol{b}_k^{\top} + \boldsymbol{b}_q^{\top}\boldsymbol{W}_k^{\top}\boldsymbol{x}_n^{\top} + \boldsymbol{b}_q^{\top}\boldsymbol{b}_k \tag{19}
\end{equation}</p>
<p><strong>Softmaxçš„å¸¸æ•°æ¶ˆé™¤æ€§è´¨</strong>ï¼š</p>
<p>å¯¹äºæœ€åä¸€é¡¹å¸¸æ•°$\boldsymbol{b}_q^{\top}\boldsymbol{b}_k$ï¼Œåœ¨Softmaxä¸­ä¼šè¢«æ¶ˆé™¤ï¼š</p>
<p>\begin{equation}
\frac{e^{s_n + c}}{\sum_j e^{s_j + c}} = \frac{e^c \cdot e^{s_n}}{e^c \sum_j e^{s_j}} = \frac{e^{s_n}}{\sum_j e^{s_j}} \tag{20}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šå› æ­¤ï¼Œåœ¨æ ‡å‡†Attentionä¸­ï¼ŒKeyçš„Biaså¯ä»¥è¢«çœç•¥ï¼Œå› ä¸ºå®ƒåªä¼šåœ¨æ‰€æœ‰ä½ç½®ä¸ŠåŠ ä¸€ä¸ªå¸¸æ•°ã€‚</p>
<h3 id="6-ropebias">6. RoPEä¸Biasçš„ç»“åˆ</h3>
<p><strong>å¸¦RoPEçš„Queryå’ŒKey</strong>ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{q}}_m = \boldsymbol{\mathcal{R}}_m(\boldsymbol{x}_m\boldsymbol{W}_q + \boldsymbol{b}_q) = \boldsymbol{\mathcal{R}}_m\boldsymbol{q}_m \tag{21}
\end{equation}</p>
<p>\begin{equation}
\tilde{\boldsymbol{k}}_n = \boldsymbol{\mathcal{R}}_n(\boldsymbol{x}_n\boldsymbol{W}_k + \boldsymbol{b}_k) = \boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n \tag{22}
\end{equation}</p>
<p><strong>å†…ç§¯å±•å¼€ï¼ˆå…³é”®æ¨å¯¼ï¼‰</strong>ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{q}}_m^{\top}\tilde{\boldsymbol{k}}_n = (\boldsymbol{q}_m + \boldsymbol{a})^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n(\boldsymbol{k}_n + \boldsymbol{b}) \tag{23}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{a} = \boldsymbol{b}_q$ï¼Œ$\boldsymbol{b} = \boldsymbol{b}_k$ã€‚</p>
<p><strong>å››é¡¹åˆ†è§£</strong>ï¼š</p>
<p>\begin{equation}
= \boldsymbol{q}_m^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n + \boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n + \boldsymbol{q}_m^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{b} + \boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{b} \tag{24}
\end{equation}</p>
<p><strong>é¡¹çš„è§£é‡Š</strong>ï¼š</p>
<ol>
<li><strong>ç¬¬ä¸€é¡¹</strong>ï¼šæ ‡å‡†çš„RoPEé¡¹ï¼Œä¾èµ–äºç›¸å¯¹ä½ç½®$n-m$</li>
<li><strong>ç¬¬äºŒé¡¹</strong>ï¼šBiasä¸Keyçš„äº¤äº’ï¼Œå¼•å…¥æ–°çš„ä½ç½®ä¾èµ–</li>
<li><strong>ç¬¬ä¸‰é¡¹</strong>ï¼šQueryä¸Biasçš„äº¤äº’ï¼Œå¼•å…¥æ–°çš„ä½ç½®ä¾èµ–</li>
<li><strong>ç¬¬å››é¡¹</strong>ï¼šçº¯Biasé¡¹ï¼Œäº§ç”Ÿè¡°å‡çš„ç›¸å¯¹ä½ç½®æ¨¡å¼</li>
</ol>
<h3 id="7">7. ç¬¬å››é¡¹çš„è¡°å‡æ€§è´¨åˆ†æ</h3>
<p><strong>ç›¸å¯¹æ—‹è½¬çš„å‘é‡è¡¨ç¤º</strong>ï¼š</p>
<p>å¯¹äºäºŒç»´å­ç©ºé—´$(i, i+1)$ï¼Œæ—‹è½¬åçš„Biaså‘é‡ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{\mathcal{R}}<em _i:i_1_="[i:i+1]">{n-m}\boldsymbol{b}</em>
\cos((n-m)\theta_i) &amp; -\sin((n-m)\theta_i) \
\sin((n-m)\theta_i) &amp; \cos((n-m)\theta_i)
\end{pmatrix}\begin{pmatrix}
b_i \
b_{i+1}
\end{pmatrix} \tag{25}
\end{equation}} = \begin{pmatrix</p>
<p><strong>Biaså‘é‡çš„ç‰¹æ®Šé€‰æ‹©</strong>ï¼š</p>
<p>å¦‚æœé€‰æ‹©$\boldsymbol{a} = \boldsymbol{b} = [\sqrt{\lambda}, 0, \sqrt{\lambda}, 0, \ldots, \sqrt{\lambda}, 0]^{\top}$ï¼Œåˆ™ï¼š</p>
<p>\begin{equation}
\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}<em i="1">{n-m}\boldsymbol{b} = \sum</em>
\end{equation}}^{d/2} \lambda \cos((n-m)\theta_i) \tag{26</p>
<p><strong>è¡°å‡æ€§è¯æ˜</strong>ï¼š</p>
<p>å½“$|n-m|$å¢å¤§æ—¶ï¼Œç”±äº$\theta_i$çš„ä¸åŒé¢‘ç‡ï¼Œä½™å¼¦é¡¹ä¼šäº§ç”Ÿç›¸ä½æŠµæ¶ˆï¼Œå¯¼è‡´å’Œå€¼è¡°å‡ã€‚</p>
<p><strong>å…·ä½“ç¤ºä¾‹ï¼ˆ$d=4$çš„æƒ…å†µï¼‰</strong>ï¼š</p>
<p>è®¾$\theta_1 = 0.1$ï¼Œ$\theta_2 = 0.01$ï¼Œ$\lambda = 1$ï¼š</p>
<ul>
<li>$n-m=0$ï¼š$\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_0\boldsymbol{b} = 1 \cdot \cos(0) + 1 \cdot \cos(0) = 2$</li>
<li>$n-m=10$ï¼š$\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_{10}\boldsymbol{b} = \cos(1) + \cos(0.1) \approx 1.535$</li>
<li>$n-m=50$ï¼š$\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_{50}\boldsymbol{b} = \cos(5) + \cos(0.5) \approx 0.595$</li>
<li>$n-m=100$ï¼š$\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_{100}\boldsymbol{b} = \cos(10) + \cos(1) \approx -0.304$</li>
</ul>
<p><strong>æ³¨é‡Š</strong>ï¼šå¯ä»¥çœ‹åˆ°ï¼Œéšç€ç›¸å¯¹è·ç¦»å¢å¤§ï¼Œå†…ç§¯å€¼å‘ˆç°è¡°å‡æŒ¯è¡çš„è¶‹åŠ¿ã€‚</p>
<h3 id="8">8. å„å‘åŒæ€§å‡è®¾ä¸ç¬¬äºŒã€ä¸‰é¡¹çš„åˆ†æ</h3>
<p><strong>å„å‘åŒæ€§åˆ†å¸ƒçš„å®šä¹‰</strong>ï¼š</p>
<p>å¦‚æœå‘é‡$\boldsymbol{v}$çš„æ–¹å‘åœ¨å•ä½çƒé¢ä¸Šå‡åŒ€åˆ†å¸ƒï¼Œåˆ™ç§°$\boldsymbol{v}$æœä»å„å‘åŒæ€§åˆ†å¸ƒã€‚</p>
<p><strong>æ•°å­¦è¡¨ç¤º</strong>ï¼š</p>
<p>å¯¹äºå½’ä¸€åŒ–å‘é‡$\boldsymbol{v} = \frac{\boldsymbol{x}}{|\boldsymbol{x}|}$ï¼Œå…¶ä¸­$\boldsymbol{x} \sim \mathcal{N}(\boldsymbol{0}, \boldsymbol{I})$ï¼Œåˆ™$\boldsymbol{v}$åœ¨å•ä½çƒé¢ä¸Šå‡åŒ€åˆ†å¸ƒã€‚</p>
<p><strong>ä¸¤ä¸ªå„å‘åŒæ€§å‘é‡çš„å†…ç§¯æœŸæœ›</strong>ï¼š</p>
<p>å¯¹äºç‹¬ç«‹çš„å„å‘åŒæ€§å‘é‡$\boldsymbol{u}$å’Œ$\boldsymbol{v}$ï¼š</p>
<p>\begin{equation}
\mathbb{E}[\boldsymbol{u}^{\top}\boldsymbol{v}] = 0 \tag{27}
\end{equation}</p>
<p><strong>è¯æ˜</strong>ï¼šç”±å¯¹ç§°æ€§ï¼Œ$\boldsymbol{u}^{\top}\boldsymbol{v}$çš„åˆ†å¸ƒå…³äº0å¯¹ç§°ï¼Œå› æ­¤æœŸæœ›ä¸º0ã€‚</p>
<p><strong>ç¬¬äºŒé¡¹çš„æœŸæœ›åˆ†æ</strong>ï¼š</p>
<p>\begin{equation}
\mathbb{E}[\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}<em n-m="n-m">m^{\top}\boldsymbol{\mathcal{R}}_n\boldsymbol{k}_n] = \mathbb{E}[\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}</em>
\end{equation}}\boldsymbol{k}_n] \tag{28</p>
<p>ç”±äº$\boldsymbol{\mathcal{R}}_{n-m}$æ˜¯æ­£äº¤å˜æ¢ï¼Œå®ƒä¸æ”¹å˜$\boldsymbol{k}_n$çš„å„å‘åŒæ€§æ€§è´¨ï¼Œå› æ­¤ï¼š</p>
<p>\begin{equation}
\mathbb{E}[\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_{n-m}\boldsymbol{k}_n] = \mathbb{E}[\boldsymbol{a}^{\top}\boldsymbol{u}] = 0 \tag{29}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{u} = \boldsymbol{\mathcal{R}}_{n-m}\boldsymbol{k}_n$ä¹Ÿæ˜¯å„å‘åŒæ€§çš„ã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šç¬¬äºŒé¡¹å’Œç¬¬ä¸‰é¡¹çš„æœŸæœ›ä¸º0ï¼Œæ„å‘³ç€å®ƒä»¬ä¸ä¼šäº§ç”Ÿç³»ç»Ÿæ€§çš„åç½®ï¼Œä¸»è¦è´¡çŒ®æ¥è‡ªç¬¬ä¸€é¡¹å’Œç¬¬å››é¡¹ã€‚</p>
<h3 id="9">9. é«˜ç»´çƒé¢ä¸Šçš„å‡ ä½•ç†è§£</h3>
<p><strong>$d$ç»´å•ä½çƒé¢çš„ä½“ç§¯å…ƒ</strong>ï¼š</p>
<p>$d$ç»´å•ä½çƒé¢$S^{d-1}$çš„è¡¨é¢ç§¯ä¸ºï¼š</p>
<p>\begin{equation}
A_{d-1} = \frac{2\pi^{d/2}}{\Gamma(d/2)} \tag{30}
\end{equation}</p>
<p><strong>ä¸¤ä¸ªéšæœºå‘é‡å¤¹è§’çš„æ¦‚ç‡å¯†åº¦</strong>ï¼š</p>
<p>åœ¨$d$ç»´ç©ºé—´ä¸­ï¼Œä¸¤ä¸ªå„å‘åŒæ€§å‘é‡çš„å¤¹è§’$\theta$çš„æ¦‚ç‡å¯†åº¦ä¸ºï¼š</p>
<p>\begin{equation}
p(\theta) = \frac{\Gamma(d/2)}{\sqrt{\pi}\Gamma((d-1)/2)} (\sin\theta)^{d-2}, \quad \theta \in [0, \pi] \tag{31}
\end{equation}</p>
<p><strong>æœŸæœ›å¤¹è§’</strong>ï¼š</p>
<p>\begin{equation}
\mathbb{E}[\theta] = \int_0^{\pi} \theta \cdot p(\theta) d\theta \tag{32}
\end{equation}</p>
<p>å½“$d$å¾ˆå¤§æ—¶ï¼Œ$\mathbb{E}[\theta] \approx \pi/2$ï¼Œå³é«˜ç»´ç©ºé—´ä¸­çš„éšæœºå‘é‡å‡ ä¹æ­£äº¤ã€‚</p>
<p><strong>å†…ç§¯æœŸæœ›çš„è®¡ç®—</strong>ï¼š</p>
<p>\begin{equation}
\mathbb{E}[\boldsymbol{u}^{\top}\boldsymbol{v}] = |\boldsymbol{u}||\boldsymbol{v}|\mathbb{E}[\cos\theta] \tag{33}
\end{equation}</p>
<p>å¯¹äºå½’ä¸€åŒ–å‘é‡ï¼ˆ$|\boldsymbol{u}| = |\boldsymbol{v}| = 1$ï¼‰ï¼š</p>
<p>\begin{equation}
\mathbb{E}[\cos\theta] = \int_0^{\pi} \cos\theta \cdot p(\theta) d\theta = 0 \tag{34}
\end{equation}</p>
<h3 id="10">10. é•¿åº¦å¤–æ¨æ€§çš„ç†è®ºåŸºç¡€</h3>
<p><strong>å¤–æ¨é—®é¢˜çš„å®šä¹‰</strong>ï¼š</p>
<p>æ¨¡å‹åœ¨è®­ç»ƒé•¿åº¦$N_{\text{train}}$ä¸Šè®­ç»ƒï¼Œä½†éœ€è¦åœ¨æµ‹è¯•é•¿åº¦$N_{\text{test}} &gt; N_{\text{train}}$ä¸Šæ¨ç†ã€‚</p>
<p><strong>å¤–æ¨å¤±è´¥çš„åŸå› </strong>ï¼š</p>
<ol>
<li><strong>ä½ç½®ç¼–ç çš„åˆ†å¸ƒåç§»</strong>ï¼šæµ‹è¯•æ—¶çš„ä½ç½®è¶…å‡ºè®­ç»ƒèŒƒå›´</li>
<li><strong>Attentionæ¨¡å¼çš„å´©æºƒ</strong>ï¼šæœªè§è¿‡çš„ç›¸å¯¹è·ç¦»å¯¼è‡´Attentionæƒé‡å¼‚å¸¸</li>
<li><strong>æ•°å€¼ä¸ç¨³å®š</strong>ï¼šå¤§çš„ä½ç½®ç´¢å¼•å¯¼è‡´æ•°å€¼æº¢å‡ºæˆ–ä¸‹æº¢</li>
</ol>
<p><strong>RoPEçš„å¤–æ¨æ€§è´¨</strong>ï¼š</p>
<p>RoPEçš„ç›¸å¯¹ä½ç½®æ€§è´¨ç†è®ºä¸Šæ”¯æŒå¤–æ¨ï¼š</p>
<p>\begin{equation}
\text{score}(m, n) = f(n-m) \tag{35}
\end{equation}</p>
<p>åªè¦ç›¸å¯¹è·ç¦»$n-m$åœ¨åˆç†èŒƒå›´å†…ï¼ŒAttentionå¾—åˆ†å°±åº”è¯¥åˆç†ã€‚</p>
<p><strong>å®é™…å¤–æ¨å›°éš¾</strong>ï¼š</p>
<p>å°½ç®¡æœ‰ç›¸å¯¹ä½ç½®æ€§è´¨ï¼Œå®é™…ä¸­RoPEçš„å¤–æ¨ä»ç„¶å›°éš¾ï¼ŒåŸå› åŒ…æ‹¬ï¼š</p>
<ol>
<li><strong>æ—‹è½¬é¢‘ç‡çš„ä¸åŒ¹é…</strong>ï¼šé«˜é¢‘åˆ†é‡åœ¨é•¿è·ç¦»ä¸ŠæŒ¯è¡å‰§çƒˆ</li>
<li><strong>Attentionåˆ†å¸ƒçš„åç§»</strong>ï¼šè®­ç»ƒæ—¶å­¦åˆ°çš„å±€éƒ¨æ€§æ¨¡å¼åœ¨é•¿åºåˆ—ä¸Šä¸é€‚ç”¨</li>
<li><strong>å±‚é—´ç´¯ç§¯æ•ˆåº”</strong>ï¼šè¯¯å·®åœ¨å¤šå±‚ä¸­ç´¯ç§¯</li>
</ol>
<h3 id="11-bias">11. Biasé¡¹å¢å¼ºå¤–æ¨æ€§çš„æœºåˆ¶</h3>
<p><strong>å±€éƒ¨åŒ–Attentionçš„å¿…è¦æ€§</strong>ï¼š</p>
<p>å¤–æ¨æ€§å¥½çš„æ¨¡å‹åº”è¯¥å…·æœ‰å±€éƒ¨åŒ–çš„Attentionæ¨¡å¼ï¼Œå³ï¼š</p>
<p>\begin{equation}
\alpha_{mn} \text{ åº”éš } |n-m| \text{ å¢å¤§è€Œè¡°å‡} \tag{36}
\end{equation}</p>
<p><strong>Biasé¡¹äº§ç”Ÿçš„è¡°å‡æ•ˆåº”</strong>ï¼š</p>
<p>ç¬¬å››é¡¹$\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}}_{n-m}\boldsymbol{b}$æä¾›äº†ä¸€ä¸ªä¸$|n-m|$ç›¸å…³çš„è¡°å‡é¡¹ï¼š</p>
<p>\begin{equation}
s_{mn} \approx \underbrace{\boldsymbol{q}<em n-m="n-m">m^{\top}\boldsymbol{\mathcal{R}}</em>}\boldsymbol{k<em _text_å†…å®¹ç›¸å…³="\text{å†…å®¹ç›¸å…³">n}</em>}} + \underbrace{\boldsymbol{a}^{\top}\boldsymbol{\mathcal{R}<em _text_è·ç¦»åç½®="\text{è·ç¦»åç½®">{n-m}\boldsymbol{b}}</em>
\end{equation}}} \tag{37</p>
<p><strong>Softmaxåçš„æ•ˆæœ</strong>ï¼š</p>
<p>åŠ å…¥è·ç¦»åç½®åï¼ŒSoftmaxå˜ä¸ºï¼š</p>
<p>\begin{equation}
\alpha_{mn} = \frac{\exp(s_{mn}^{\text{content}} + s_{mn}^{\text{bias}})}{\sum_j \exp(s_{mj}^{\text{content}} + s_{mj}^{\text{bias}})} \tag{38}
\end{equation}</p>
<p>ç”±äº$s_{mn}^{\text{bias}}$éš$|n-m|$è¡°å‡ï¼Œè¿œè·ç¦»çš„$\alpha_{mn}$ä¼šè¢«æŠ‘åˆ¶ã€‚</p>
<p><strong>æ•°å€¼ç¤ºä¾‹</strong>ï¼š</p>
<p>å‡è®¾å†…å®¹å¾—åˆ†å‡åŒ€ï¼š$s_{mn}^{\text{content}} = 1$ï¼Œè·ç¦»åç½®ï¼š$s_{mn}^{\text{bias}} = -0.1|n-m|$</p>
<p>ä¸å¸¦Biasï¼ˆ$m=5$ï¼Œ$N=10$ï¼‰ï¼š
\begin{equation}
\alpha_{5n} = \frac{e^1}{\sum_{j=1}^{10} e^1} = \frac{1}{10} = 0.1 \tag{39}
\end{equation}</p>
<p>å¸¦Biasï¼ˆ$m=5$ï¼Œ$N=10$ï¼‰ï¼š
\begin{equation}
\alpha_{55} = \frac{e^{1+0}}{e^1 + 2e^{0.9} + 2e^{0.8} + 2e^{0.7} + 2e^{0.6}} \approx 0.135 \tag{40}
\end{equation}</p>
<p>\begin{equation}
\alpha_{51} = \frac{e^{1-0.4}}{...} \approx 0.073 \tag{41}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šå¯ä»¥çœ‹åˆ°ï¼ŒBiasé¡¹ä½¿å¾—å¯¹è§’çº¿é™„è¿‘çš„æ³¨æ„åŠ›æƒé‡å¢å¤§ï¼Œè¿œè·ç¦»çš„æƒé‡å‡å°ï¼Œäº§ç”Ÿäº†å±€éƒ¨åŒ–æ•ˆåº”ã€‚</p>
<h3 id="12">12. ç†µä¸æ³¨æ„åŠ›é›†ä¸­åº¦</h3>
<p><strong>ä¿¡æ¯ç†µçš„å®šä¹‰</strong>ï¼š</p>
<p>å¯¹äºæ¦‚ç‡åˆ†å¸ƒ${\alpha_1, \alpha_2, \ldots, \alpha_N}$ï¼Œå…¶é¦™å†œç†µä¸ºï¼š</p>
<p>\begin{equation}
H = -\sum_{n=1}^N \alpha_n \log \alpha_n \tag{42}
\end{equation}</p>
<p><strong>ç†µçš„èŒƒå›´</strong>ï¼š</p>
<ul>
<li>æœ€å°ç†µï¼š$H_{\min} = 0$ï¼ˆå½“æŸä¸ª$\alpha_i = 1$ï¼Œå…¶ä½™ä¸º0æ—¶ï¼‰</li>
<li>æœ€å¤§ç†µï¼š$H_{\max} = \log N$ï¼ˆå½“æ‰€æœ‰$\alpha_i = 1/N$æ—¶ï¼‰</li>
</ul>
<p><strong>å½’ä¸€åŒ–ç†µ</strong>ï¼š</p>
<p>\begin{equation}
\tilde{H} = \frac{H}{\log N} \in [0, 1] \tag{43}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šå½’ä¸€åŒ–ç†µæ¥è¿‘0è¡¨ç¤ºæ³¨æ„åŠ›é«˜åº¦é›†ä¸­ï¼Œæ¥è¿‘1è¡¨ç¤ºæ³¨æ„åŠ›å‡åŒ€åˆ†å¸ƒã€‚</p>
<p><strong>Biaså¯¹ç†µçš„å½±å“</strong>ï¼š</p>
<p>ä¸å¸¦Biasæ—¶ï¼Œå¦‚æœAttentionå¾—åˆ†ç›¸ä¼¼ï¼Œç†µæ¥è¿‘$\log N$ã€‚åŠ å…¥è¡°å‡çš„Biasåï¼ŒAttentionæ›´é›†ä¸­äºå±€éƒ¨ï¼Œç†µå‡å°ã€‚</p>
<p><strong>å¤–æ¨æ—¶çš„ç†µå˜åŒ–</strong>ï¼š</p>
<ul>
<li>è®­ç»ƒé•¿åº¦$N=512$ï¼š$H_{\text{train}} \approx \log(512) \approx 6.2$</li>
<li>æµ‹è¯•é•¿åº¦$N=2048$ï¼ˆæ— Biasï¼‰ï¼š$H_{\text{test}} \approx \log(2048) \approx 7.6$</li>
<li>æµ‹è¯•é•¿åº¦$N=2048$ï¼ˆæœ‰Biasï¼‰ï¼š$H_{\text{test}} \approx 6.5$ï¼ˆæ¥è¿‘è®­ç»ƒæ—¶çš„ç†µï¼‰</li>
</ul>
<p><strong>æ³¨é‡Š</strong>ï¼šBiasé¡¹é€šè¿‡ç»´æŒç†µçš„ç›¸å¯¹ç¨³å®šæ€§ï¼Œå¢å¼ºäº†å¤–æ¨èƒ½åŠ›ã€‚</p>
<h3 id="13">13. è®¡ç®—å¤æ‚åº¦åˆ†æ</h3>
<p><strong>æ ‡å‡†Attentionçš„å¤æ‚åº¦</strong>ï¼š</p>
<p>æ—¶é—´å¤æ‚åº¦ï¼š
\begin{equation}
O(N^2 d + N^2 d_v) = O(N^2 d) \tag{44}
\end{equation}</p>
<p>ç©ºé—´å¤æ‚åº¦ï¼š
\begin{equation}
O(N^2) \text{ï¼ˆå­˜å‚¨AttentionçŸ©é˜µï¼‰} \tag{45}
\end{equation}</p>
<p><strong>RoPEçš„é¢å¤–å¼€é”€</strong>ï¼š</p>
<p>æ—‹è½¬å˜æ¢ï¼š
\begin{equation}
O(Nd) \text{ï¼ˆå¯¹æ¯ä¸ªä½ç½®åº”ç”¨æ—‹è½¬ï¼‰} \tag{46}
\end{equation}</p>
<p><strong>Biasé¡¹çš„é¢å¤–å¼€é”€</strong>ï¼š</p>
<p>BiasåŠ æ³•ï¼š
\begin{equation}
O(Nd) \text{ï¼ˆå¯å¿½ç•¥ä¸è®¡ï¼‰} \tag{47}
\end{equation}</p>
<p><strong>æ€»å¤æ‚åº¦</strong>ï¼š</p>
<p>\begin{equation}
O(N^2 d + Nd) = O(N^2 d) \tag{48}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šBiasé¡¹å‡ ä¹ä¸å¢åŠ è®¡ç®—å¼€é”€ï¼Œæ˜¯ä¸€ç§"å…è´¹"çš„æ”¹è¿›ã€‚</p>
<h3 id="14">14. æ•°å€¼ç¨³å®šæ€§è€ƒè™‘</h3>
<p><strong>RoPEä¸­çš„ä¸‰è§’å‡½æ•°è®¡ç®—</strong>ï¼š</p>
<p>å¯¹äºå¤§çš„ä½ç½®ç´¢å¼•$m$ï¼Œéœ€è¦è®¡ç®—ï¼š</p>
<p>\begin{equation}
\cos(m\theta), \quad \sin(m\theta) \tag{49}
\end{equation}</p>
<p><strong>æ½œåœ¨é—®é¢˜</strong>ï¼š</p>
<p>å½“$m$å¾ˆå¤§æ—¶ï¼Œæµ®ç‚¹æ•°ç²¾åº¦å¯èƒ½å¯¼è‡´$m\theta$çš„è®¡ç®—è¯¯å·®ï¼Œå½±å“ä¸‰è§’å‡½æ•°å€¼ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<p>ä½¿ç”¨å‘¨æœŸæ€§å½’çº¦ï¼š</p>
<p>\begin{equation}
m\theta \mod 2\pi \tag{50}
\end{equation}</p>
<p><strong>Softmaxçš„æ•°å€¼ç¨³å®šå®ç°</strong>ï¼š</p>
<p>æ ‡å‡†æŠ€å·§ï¼šå‡å»æœ€å¤§å€¼</p>
<p>\begin{equation}
\alpha_{mn} = \frac{\exp(s_{mn} - \max_j s_{mj})}{\sum_j \exp(s_{mj} - \max_j s_{mj})} \tag{51}
\end{equation}</p>
<p><strong>Biasé¡¹å¯¹æ•°å€¼ç¨³å®šæ€§çš„å½±å“</strong>ï¼š</p>
<p>Biasé¡¹çš„è¡°å‡ç‰¹æ€§å¯ä»¥ç¼“è§£æç«¯å€¼é—®é¢˜ï¼Œå‡å°$\max_j s_{mj} - \min_j s_{mj}$çš„èŒƒå›´ã€‚</p>
<h3 id="15-bias">15. å¤šå¤´æ³¨æ„åŠ›ä¸­çš„Bias</h3>
<p><strong>å¤šå¤´Attentionçš„å®šä¹‰</strong>ï¼š</p>
<p>\begin{equation}
\text{MultiHead}(\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}) = \text{Concat}(\text{head}_1, \ldots, \text{head}_h)\boldsymbol{W}^O \tag{52}
\end{equation}</p>
<p>å…¶ä¸­ï¼š</p>
<p>\begin{equation}
\text{head}_i = \text{Attention}(\boldsymbol{Q}\boldsymbol{W}_i^Q, \boldsymbol{K}\boldsymbol{W}_i^K, \boldsymbol{V}\boldsymbol{W}_i^V) \tag{53}
\end{equation}</p>
<p><strong>æ¯ä¸ªå¤´çš„ç‹¬ç«‹Bias</strong>ï¼š</p>
<p>æ¯ä¸ªå¤´å¯ä»¥æœ‰ç‹¬ç«‹çš„Biaså‘é‡$\boldsymbol{a}_i, \boldsymbol{b}_i$ï¼š</p>
<p>\begin{equation}
\tilde{\boldsymbol{q}}_m^{(i)} = \boldsymbol{\mathcal{R}}_m(\boldsymbol{q}_m^{(i)} + \boldsymbol{a}_i) \tag{54}
\end{equation}</p>
<p>\begin{equation}
\tilde{\boldsymbol{k}}_n^{(i)} = \boldsymbol{\mathcal{R}}_n(\boldsymbol{k}_n^{(i)} + \boldsymbol{b}_i) \tag{55}
\end{equation}</p>
<p><strong>ä¸åŒå¤´çš„Biaså­¦ä¹ ä¸åŒæ¨¡å¼</strong>ï¼š</p>
<p>ä¸åŒçš„$\boldsymbol{a}_i, \boldsymbol{b}_i$å¯ä»¥å­¦ä¹ ä¸åŒçš„è·ç¦»è¡°å‡æ¨¡å¼ï¼Œå¢å¼ºæ¨¡å‹çš„è¡¨è¾¾èƒ½åŠ›ã€‚</p>
<h3 id="16">16. è®­ç»ƒä¸æ¨ç†çš„å®ç°ç»†èŠ‚</h3>
<p><strong>å‰å‘ä¼ æ’­ä¼ªä»£ç </strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code>def rope_with_bias(Q, K, V, positions, bias_q, bias_k):
    # åº”ç”¨Bias
    Q = Q + bias_q  # shape: (batch, seq_len, d)
    K = K + bias_k

    # è®¡ç®—æ—‹è½¬è§’åº¦
    angles = positions[:, None] * thetas[None, :]  # thetas: (d/2,)

    # åº”ç”¨æ—‹è½¬
    Q_rot = apply_rotation(Q, angles)
    K_rot = apply_rotation(K, angles)

    # è®¡ç®—Attention
    scores = (Q_rot @ K_rot.T) / sqrt(d)
    attn_weights = softmax(scores)
    output = attn_weights @ V

    return output
</code></pre></div>

<p><strong>æ—‹è½¬å˜æ¢çš„é«˜æ•ˆå®ç°</strong>ï¼š</p>
<p>å°†å‘é‡åˆ†ä¸ºä¸¤éƒ¨åˆ†è¿›è¡Œæ—‹è½¬ï¼š</p>
<p>\begin{equation}
\begin{pmatrix} x' \ y' \end{pmatrix} = \begin{pmatrix} \cos\theta &amp; -\sin\theta \ \sin\theta &amp; \cos\theta \end{pmatrix} \begin{pmatrix} x \ y \end{pmatrix} = \begin{pmatrix} x\cos\theta - y\sin\theta \ x\sin\theta + y\cos\theta \end{pmatrix} \tag{56}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šé€šè¿‡å‘é‡åŒ–æ“ä½œï¼Œå¯ä»¥é«˜æ•ˆåœ°å¹¶è¡Œè®¡ç®—æ‰€æœ‰ä½ç½®çš„æ—‹è½¬ã€‚</p>
<h3 id="17">17. å®éªŒéªŒè¯çš„ç†è®ºè§£é‡Š</h3>
<p><strong>å®éªŒè®¾ç½®å›é¡¾</strong>ï¼š</p>
<ul>
<li>è®­ç»ƒé•¿åº¦ï¼š512</li>
<li>æµ‹è¯•é•¿åº¦ï¼š512, 1024, 2048, 4096</li>
<li>æ¨¡å‹ï¼šGAU-Î±</li>
<li>ä»»åŠ¡ï¼šè¯­è¨€æ¨¡å‹ï¼ˆMLMå‡†ç¡®ç‡ï¼‰</li>
</ul>
<p><strong>ç»“æœåˆ†æ</strong>ï¼š</p>
<p>è®­ç»ƒé•¿åº¦ï¼ˆ512ï¼‰ï¼š
- æ— Biasï¼š52.37%
- æœ‰Biasï¼š52.75%</p>
<p><strong>æ³¨é‡Š</strong>ï¼šåœ¨è®­ç»ƒé•¿åº¦ä¸Šï¼Œä¸¤è€…æ€§èƒ½ç›¸å½“ï¼Œè¯´æ˜Biasä¸å½±å“æ­£å¸¸æ€§èƒ½ã€‚</p>
<p>å¤–æ¨åˆ°1024ï¼š
- æ— Biasï¼š33.15%ï¼ˆä¸‹é™19.22ä¸ªç™¾åˆ†ç‚¹ï¼‰
- æœ‰Biasï¼š50.99%ï¼ˆä»…ä¸‹é™1.76ä¸ªç™¾åˆ†ç‚¹ï¼‰</p>
<p><strong>æ³¨é‡Š</strong>ï¼šBiasæ˜¾è‘—æå‡äº†å¤–æ¨æ€§èƒ½ã€‚</p>
<p><strong>ç†è®ºè§£é‡Š</strong>ï¼š</p>
<ol>
<li><strong>å±€éƒ¨åŒ–æ•ˆåº”</strong>ï¼šBiasäº§ç”Ÿçš„è·ç¦»è¡°å‡ä½¿å¾—Attentionä¿æŒå±€éƒ¨åŒ–</li>
<li><strong>ç†µç¨³å®šæ€§</strong>ï¼šAttentionçš„ç†µåœ¨ä¸åŒé•¿åº¦ä¸‹ä¿æŒç›¸å¯¹ç¨³å®š</li>
<li><strong>ç›¸å¯¹ä½ç½®é²æ£’æ€§</strong>ï¼šBiasåŠ å¼ºäº†ç›¸å¯¹ä½ç½®çš„ä½œç”¨ï¼Œå‡å°‘äº†ç»å¯¹ä½ç½®çš„å½±å“</li>
</ol>
<h3 id="18">18. ä¸å…¶ä»–ä½ç½®ç¼–ç æ–¹æ³•çš„æ¯”è¾ƒ</h3>
<p><strong>ALiBiï¼ˆAttention with Linear Biasesï¼‰</strong>ï¼š</p>
<p>ç›´æ¥åœ¨Attentionå¾—åˆ†ä¸ŠåŠ çº¿æ€§åç½®ï¼š</p>
<p>\begin{equation}
s_{mn} = \boldsymbol{q}_m^{\top}\boldsymbol{k}_n - \lambda |m-n| \tag{57}
\end{equation}</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šç®€å•ï¼Œå¤–æ¨æ€§å¥½</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šéœ€è¦é¢å¤–çš„è¶…å‚æ•°$\lambda$ï¼Œä¸”çº¿æ€§è¡°å‡å¯èƒ½ä¸æ˜¯æœ€ä¼˜çš„</p>
<p><strong>T5çš„ç›¸å¯¹ä½ç½®ç¼–ç </strong>ï¼š</p>
<p>ä½¿ç”¨å¯å­¦ä¹ çš„ç›¸å¯¹ä½ç½®åµŒå…¥ï¼š</p>
<p>\begin{equation}
s_{mn} = \boldsymbol{q}<em m-n="m-n">m^{\top}\boldsymbol{k}_n + \boldsymbol{r}</em>
\end{equation}} \tag{58</p>
<p>å…¶ä¸­$\boldsymbol{r}$æ˜¯å¯å­¦ä¹ çš„ç›¸å¯¹ä½ç½®å‘é‡ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šçµæ´»ï¼Œå¯ä»¥å­¦ä¹ å¤æ‚çš„ç›¸å¯¹ä½ç½®æ¨¡å¼</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šå¤–æ¨æ€§å·®ï¼ˆè®­ç»ƒæ—¶æœªè§è¿‡çš„ç›¸å¯¹è·ç¦»æ²¡æœ‰å¯¹åº”çš„åµŒå…¥ï¼‰</p>
<p><strong>RoPE + Biasçš„ä¼˜åŠ¿</strong>ï¼š</p>
<ol>
<li><strong>å…¼å…·ç›¸å¯¹ä½ç½®ç¼–ç å’Œè·ç¦»åç½®çš„ä¼˜ç‚¹</strong></li>
<li><strong>æ— éœ€é¢å¤–è¶…å‚æ•°</strong>ï¼ˆBiasåœ¨è®­ç»ƒä¸­å­¦ä¹ ï¼‰</li>
<li><strong>å¤–æ¨æ€§å¥½</strong>ï¼ˆBiasçš„è¡°å‡æ¨¡å¼è‡ªç„¶å»¶ä¼¸åˆ°é•¿åºåˆ—ï¼‰</li>
</ol>
<h3 id="19-bias">19. Biaså‘é‡çš„åˆå§‹åŒ–ç­–ç•¥</h3>
<p><strong>æ ‡å‡†åˆå§‹åŒ–</strong>ï¼š</p>
<p>é€šå¸¸ä½¿ç”¨é›¶åˆå§‹åŒ–æˆ–å°éšæœºå€¼ï¼š</p>
<p>\begin{equation}
\boldsymbol{b} \sim \mathcal{N}(\boldsymbol{0}, \sigma^2\boldsymbol{I}), \quad \sigma = 0.01 \tag{59}
\end{equation}</p>
<p><strong>Sandwiché£æ ¼åˆå§‹åŒ–</strong>ï¼š</p>
<p>åŸºäºSandwichçš„è®¾è®¡ï¼Œåˆå§‹åŒ–ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{b} = [\sqrt{\lambda}, 0, \sqrt{\lambda}, 0, \ldots]^{\top}, \quad \lambda = 0.1 \tag{60}
\end{equation}</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šç›´æ¥ç¼–ç äº†æœŸæœ›çš„è¡°å‡æ¨¡å¼</p>
<p><strong>ç¼ºç‚¹</strong>ï¼šå¯èƒ½é™åˆ¶æ¨¡å‹çš„å­¦ä¹ èƒ½åŠ›</p>
<p><strong>è‡ªé€‚åº”åˆå§‹åŒ–</strong>ï¼š</p>
<p>æ ¹æ®è®­ç»ƒé•¿åº¦$N_{\text{train}}$è°ƒæ•´ï¼š</p>
<p>\begin{equation}
\lambda = \frac{1}{\log N_{\text{train}}} \tag{61}
\end{equation}</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ä½¿å¾—Biasçš„å½±å“èŒƒå›´ä¸è®­ç»ƒé•¿åº¦åŒ¹é…ã€‚</p>
<h3 id="20">20. æ¢¯åº¦æµä¸è®­ç»ƒåŠ¨åŠ›å­¦</h3>
<p><strong>Biasçš„æ¢¯åº¦</strong>ï¼š</p>
<p>å¯¹äºæŸå¤±å‡½æ•°$\mathcal{L}$ï¼ŒBiasçš„æ¢¯åº¦ä¸ºï¼š</p>
<p>\begin{equation}
\frac{\partial \mathcal{L}}{\partial \boldsymbol{b}} = \sum_{m,n} \frac{\partial \mathcal{L}}{\partial s_{mn}} \frac{\partial s_{mn}}{\partial \boldsymbol{b}} \tag{62}
\end{equation}</p>
<p>å…¶ä¸­ï¼š</p>
<p>\begin{equation}
\frac{\partial s_{mn}}{\partial \boldsymbol{b}} = \boldsymbol{\mathcal{R}}_m^{\top}\boldsymbol{\mathcal{R}}_n(\boldsymbol{a} + \boldsymbol{q}_m) \tag{63}
\end{equation}</p>
<p><strong>æ¢¯åº¦çš„ç›¸å¯¹ä½ç½®ä¾èµ–</strong>ï¼š</p>
<p>ç”±äºæ—‹è½¬çŸ©é˜µçš„ç›¸å¯¹ä½ç½®æ€§è´¨ï¼Œæ¢¯åº¦ä¸»è¦ä¾èµ–äº$\boldsymbol{\mathcal{R}}_{n-m}$ï¼Œä½¿å¾—Biasèƒ½å¤Ÿå­¦ä¹ ä¸ç›¸å¯¹è·ç¦»ç›¸å…³çš„æ¨¡å¼ã€‚</p>
<p><strong>è®­ç»ƒç¨³å®šæ€§</strong>ï¼š</p>
<p>Biasçš„æ¢¯åº¦ä¸Queryã€Keyçš„æ¢¯åº¦åœ¨åŒä¸€é‡çº§ï¼Œä¸ä¼šå¯¼è‡´è®­ç»ƒä¸ç¨³å®šã€‚</p>
<h3 id="21">21. ç†è®ºå±€é™æ€§ä¸æœªæ¥æ–¹å‘</h3>
<p><strong>å½“å‰ç†è®ºçš„å±€é™</strong>ï¼š</p>
<ol>
<li><strong>å„å‘åŒæ€§å‡è®¾ä¸æ€»æ˜¯æˆç«‹</strong>ï¼šå®é™…è®­ç»ƒä¸­ï¼ŒQueryå’ŒKeyå¯èƒ½ä¸æ˜¯å®Œå…¨å„å‘åŒæ€§çš„</li>
<li><strong>è¡°å‡æ¨¡å¼çš„æœ€ä¼˜æ€§æœªè¯æ˜</strong>ï¼šç›®å‰åªæ˜¯ç»éªŒè§‚å¯Ÿï¼Œç¼ºä¹ç†è®ºæœ€ä¼˜æ€§ä¿è¯</li>
<li><strong>å¤šå±‚äº¤äº’çš„å¤æ‚æ€§</strong>ï¼šBiasåœ¨å¤šå±‚Transformerä¸­çš„ç´¯ç§¯æ•ˆåº”å°šæœªå……åˆ†ç ”ç©¶</li>
</ol>
<p><strong>æ”¹è¿›æ–¹å‘</strong>ï¼š</p>
<ol>
<li><strong>è‡ªé€‚åº”Bias</strong>ï¼šæ ¹æ®å±‚æ·±åº¦å’Œä½ç½®åŠ¨æ€è°ƒæ•´Bias</li>
<li><strong>å¯å­¦ä¹ çš„è¡°å‡å‡½æ•°</strong>ï¼šä¸é™äºä½™å¼¦å½¢å¼ï¼Œå­¦ä¹ æ›´å¤æ‚çš„è·ç¦»å‡½æ•°</li>
<li><strong>Biasçš„æ­£åˆ™åŒ–</strong>ï¼šé€šè¿‡æ­£åˆ™åŒ–é¼“åŠ±Biaså­¦ä¹ ç‰¹å®šçš„æ¨¡å¼ï¼ˆå¦‚å•è°ƒè¡°å‡ï¼‰</li>
</ol>
<h3 id="22">22. å®è·µå»ºè®®æ€»ç»“</h3>
<p><strong>ä½•æ—¶ä½¿ç”¨Bias</strong>ï¼š</p>
<ol>
<li><strong>éœ€è¦é•¿åº¦å¤–æ¨çš„åœºæ™¯</strong>ï¼ˆå¦‚é•¿æ–‡æœ¬ç”Ÿæˆï¼‰</li>
<li><strong>ä½¿ç”¨RoPEä½œä¸ºä½ç½®ç¼–ç çš„æ¨¡å‹</strong></li>
<li><strong>æ¨¡å‹åœ¨é•¿åºåˆ—ä¸Šæ€§èƒ½ä¸‹é™æ˜æ˜¾</strong></li>
</ol>
<p><strong>å®ç°æ£€æŸ¥æ¸…å•</strong>ï¼š</p>
<ol>
<li>âœ“ ç¡®ä¿Queryå’ŒKeyçš„Biaséƒ½å¯ç”¨</li>
<li>âœ“ ä½¿ç”¨åˆé€‚çš„åˆå§‹åŒ–ï¼ˆé›¶åˆå§‹åŒ–æˆ–å°éšæœºå€¼ï¼‰</li>
<li>âœ“ åœ¨å¤šå¤´Attentionä¸­ï¼Œæ¯ä¸ªå¤´æœ‰ç‹¬ç«‹çš„Bias</li>
<li>âœ“ ç›‘æ§è®­ç»ƒè¿‡ç¨‹ä¸­Biasçš„èŒƒæ•°å’Œæ¨¡å¼</li>
<li>âœ“ åœ¨ä¸åŒæµ‹è¯•é•¿åº¦ä¸‹è¯„ä¼°æ€§èƒ½</li>
</ol>
<p><strong>è¶…å‚æ•°è°ƒä¼˜</strong>ï¼š</p>
<ul>
<li>Biasåˆå§‹åŒ–çš„æ ‡å‡†å·®ï¼š$\sigma \in [0.001, 0.1]$</li>
<li>å­¦ä¹ ç‡ï¼šä¸å…¶ä»–å‚æ•°ç›¸åŒæˆ–ç¨å°</li>
<li>æ˜¯å¦å…±äº«Queryå’ŒKeyçš„Biasï¼šé€šå¸¸ä¸å…±äº«æ€§èƒ½æ›´å¥½</li>
</ul>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™äº›å»ºè®®åŸºäºå®éªŒç»éªŒï¼Œå…·ä½“åº”ç”¨ä¸­å¯èƒ½éœ€è¦æ ¹æ®ä»»åŠ¡è°ƒæ•´ã€‚</p>
        </div>
    </div>
</body>
</html>