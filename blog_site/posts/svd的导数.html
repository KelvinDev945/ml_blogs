<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SVDçš„å¯¼æ•°</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>SVDçš„å¯¼æ•°</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 56.4 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10878">https://spaces.ac.cn/archives/10878</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>SVDï¼ˆSingular Value Decompositionï¼Œå¥‡å¼‚å€¼åˆ†è§£ï¼‰æ˜¯å¸¸è§çš„çŸ©é˜µåˆ†è§£ç®—æ³•ï¼Œç›¸ä¿¡å¾ˆå¤šè¯»è€…éƒ½å·²ç»å¯¹å®ƒæœ‰æ‰€äº†è§£ï¼Œæ­¤å‰æˆ‘ä»¬åœ¨<a href="/archives/10407">ã€Šä½ç§©è¿‘ä¼¼ä¹‹è·¯ï¼ˆäºŒï¼‰ï¼šSVDã€‹</a>ä¹Ÿä¸“é—¨ä»‹ç»è¿‡å®ƒã€‚ç„¶è€Œï¼Œè¯»è€…æ˜¯å¦æƒ³åˆ°ï¼ŒSVDç«Ÿç„¶è¿˜å¯ä»¥æ±‚å¯¼å‘¢ï¼Ÿç¬”è€…åˆšäº†è§£åˆ°è¿™ä¸€ç»“è®ºæ—¶ä¹Ÿé¢‡æ„Ÿæ„å¤–ï¼Œå› ä¸ºç›´è§‰ä¸Šâ€œåˆ†è§£â€å¾€å¾€éƒ½æ˜¯ä¸å¯å¯¼çš„ã€‚ä½†äº‹å®æ˜¯ï¼ŒSVDåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ç¡®å®å¯å¯¼ï¼Œè¿™æ„å‘³ç€ç†è®ºä¸Šæˆ‘ä»¬å¯ä»¥å°†SVDåµŒå…¥åˆ°æ¨¡å‹ä¸­ï¼Œå¹¶ç”¨åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–å™¨æ¥ç«¯åˆ°ç«¯è®­ç»ƒã€‚</p>
<p>é—®é¢˜æ¥äº†ï¼Œæ—¢ç„¶SVDå¯å¯¼ï¼Œé‚£ä¹ˆå®ƒçš„å¯¼å‡½æ•°é•¿ä»€ä¹ˆæ ·å‘¢ï¼Ÿæ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†å‚è€ƒæ–‡çŒ®<a href="https://j-towns.github.io/papers/svd-derivative.pdf">ã€ŠDifferentiating the Singular Value Decompositionã€‹</a>ï¼Œé€æ­¥æ¨å¯¼SVDçš„æ±‚å¯¼å…¬å¼ã€‚</p>
<h2 id="_1">æ¨å¯¼åŸºç¡€</h2>
<p>å‡è®¾$\boldsymbol{W}$æ˜¯æ»¡ç§©çš„$n\times n$çŸ©é˜µï¼Œä¸”å…¨ä½“å¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰ï¼Œè¿™æ˜¯æ¯”è¾ƒå®¹æ˜“è®¨è®ºçš„æƒ…å½¢ï¼Œåé¢æˆ‘ä»¬ä¹Ÿä¼šè®¨è®ºå“ªäº›æ¡ä»¶å¯ä»¥æ”¾å®½ä¸€ç‚¹ã€‚æ¥ç€ï¼Œæˆ‘ä»¬è®¾$\boldsymbol{W}$çš„SVDä¸ºï¼š<br />
\begin{equation}\boldsymbol{W} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}\end{equation}<br />
æ‰€è°“SVDæ±‚å¯¼ï¼Œå®é™…ä¸Šå°±æ˜¯è®¾æ³•åˆ†åˆ«æ±‚å‡º$\boldsymbol{U},\boldsymbol{\Sigma},\boldsymbol{V}$å…³äº$\boldsymbol{W}$çš„æ¢¯åº¦æˆ–å¾®åˆ†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å…ˆå¯¹ä¸Šå¼ä¸¤è¾¹æ±‚å¾®åˆ†<br />
\begin{equation}d\boldsymbol{W} = (d\boldsymbol{U})\boldsymbol{\Sigma}\boldsymbol{V}^{\top} + \boldsymbol{U}(d\boldsymbol{\Sigma})\boldsymbol{V}^{\top} + \boldsymbol{U}\boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}\end{equation}<br />
å·¦ä¹˜$\boldsymbol{U}^{\top}$ã€å³ä¹˜$\boldsymbol{V}$ï¼Œå¹¶åˆ©ç”¨$\boldsymbol{U}^{\top}\boldsymbol{U} = \boldsymbol{I}, \boldsymbol{V}^{\top}\boldsymbol{V} = \boldsymbol{I}$å¾—åˆ°<br />
\begin{equation}\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V} = \boldsymbol{U}^{\top}(d\boldsymbol{U})\boldsymbol{\Sigma} + d\boldsymbol{\Sigma} + \boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}\boldsymbol{V}\label{eq:core}\end{equation}<br />
è¿™ä¾¿æ˜¯åé¢æ¨å¯¼çš„åŸºç¡€ã€‚æ³¨æ„å¯¹æ’ç­‰å¼$\boldsymbol{U}^{\top}\boldsymbol{U} = \boldsymbol{I}, \boldsymbol{V}^{\top}\boldsymbol{V} = \boldsymbol{I}$ä¸¤ç«¯æ±‚å¾®åˆ†ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å¾—åˆ°<br />
\begin{equation}(d\boldsymbol{U})^{\top}\boldsymbol{U} + \boldsymbol{U}^{\top}(d\boldsymbol{U}) = \boldsymbol{0},\quad (d\boldsymbol{V})^{\top}\boldsymbol{V} + \boldsymbol{V}^{\top}(d\boldsymbol{V}) = \boldsymbol{0}\end{equation}<br />
è¿™è¡¨æ˜$\boldsymbol{U}^{\top}(d\boldsymbol{U})$å’Œ$(d\boldsymbol{V})^{\top}\boldsymbol{V}$éƒ½æ˜¯åå¯¹ç§°çŸ©é˜µã€‚</p>
<h2 id="_2">å¥‡å¼‚å€¼</h2>
<p>åå¯¹ç§°çŸ©é˜µçš„ç‰¹ç‚¹æ˜¯å¯¹è§’çº¿å…ƒç´ éƒ½æ˜¯é›¶ï¼Œè€Œ$\boldsymbol{\Sigma}$æ˜¯å¯¹è§’é˜µï¼Œéå¯¹è§’çº¿å…ƒç´ éƒ½æ˜¯é›¶ï¼Œè¿™å¯å‘æˆ‘ä»¬å¯èƒ½éœ€è¦åˆ†åˆ«å¤„ç†å¤„ç†å¯¹è§’çº¿å’Œéå¯¹è§’çº¿å…ƒç´ ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬å®šä¹‰çŸ©é˜µ$\boldsymbol{I}$å’Œ$\bar{\boldsymbol{I}}$ï¼š$\boldsymbol{I}$å°±æ˜¯å•ä½é˜µï¼Œå³å¯¹è§’çº¿å…ƒç´ å…¨æ˜¯1ï¼Œéå¯¹è§’çº¿å…ƒç´ å…¨æ˜¯0ï¼›$\bar{\boldsymbol{I}}$åˆ™æ˜¯å•ä½é˜µçš„äº’è¡¥é˜µï¼Œå³å¯¹è§’çº¿å…ƒç´ å…¨æ˜¯0ï¼Œè€Œéå¯¹è§’çº¿å…ƒç´ å…¨æ˜¯1ã€‚åˆ©ç”¨$\boldsymbol{I}$ã€$\bar{\boldsymbol{I}}$å’ŒHadamardç§¯$\otimes$ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«æå–å‡ºå¼$\eqref{eq:core}$çš„å¯¹è§’çº¿å’Œéå¯¹è§’çº¿éƒ¨åˆ†ï¼š<br />
\begin{align}<br />
\boldsymbol{I}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}) =&amp;\, \boldsymbol{I}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{U})\boldsymbol{\Sigma} + d\boldsymbol{\Sigma} + \boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}\boldsymbol{V}) = d\boldsymbol{\Sigma} \label{eq:value} \\\[8pt]<br />
\bar{\boldsymbol{I}}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}) =&amp;\, \bar{\boldsymbol{I}}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{U})\boldsymbol{\Sigma} + d\boldsymbol{\Sigma} + \boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}\boldsymbol{V}) = \boldsymbol{U}^{\top}(d\boldsymbol{U})\boldsymbol{\Sigma} + \boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}\boldsymbol{V}\label{eq:vector}<br />
\end{align}<br />
ç°åœ¨æˆ‘ä»¬å…ˆæ¥çœ‹å¼$\eqref{eq:value}$ï¼Œå®ƒå¯ä»¥ç­‰ä»·åœ°å†™æˆ<br />
\begin{equation}d\sigma_i = \boldsymbol{u}_i^{\top}(d\boldsymbol{W})\boldsymbol{v}_i\label{eq:d-sigma}\end{equation}<br />
è¿™å°±æ˜¯ç¬¬$i$ä¸ªå¥‡å¼‚å€¼$\sigma_i$çš„å¾®åˆ†ï¼Œå…¶ä¸­$\boldsymbol{u}_i,\boldsymbol{v}_i$åˆ†åˆ«æ˜¯$\boldsymbol{U},\boldsymbol{V}$çš„ç¬¬$i$åˆ—ã€‚<a href="/archives/10648">ã€Šä»è°±èŒƒæ•°æ¢¯åº¦åˆ°æ–°å¼æƒé‡è¡°å‡çš„æ€è€ƒã€‹</a>ä¸­è®¨è®ºçš„è°±èŒƒæ•°æ¢¯åº¦ï¼Œå®é™…ä¸Šå°±åªæ˜¯è¿™é‡Œ$i=1$æ—¶çš„ç‰¹ä¾‹ã€‚</p>
<h2 id="_3">å¥‡å¼‚å‘é‡</h2>
<p>ç„¶åæˆ‘ä»¬å†æ¥çœ‹å¼$\eqref{eq:vector}$ï¼š<br />
\begin{equation}\bar{\boldsymbol{I}}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}) = \boldsymbol{U}^{\top}(d\boldsymbol{U})\boldsymbol{\Sigma} + \boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}\boldsymbol{V}\label{eq:vector-1}\end{equation}<br />
è½¬ç½®ä¸€ä¸‹<br />
\begin{equation}\begin{aligned}<br />
\bar{\boldsymbol{I}}\otimes(\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}) =&amp;\, \boldsymbol{\Sigma}(d\boldsymbol{U})^{\top}\boldsymbol{U} + \boldsymbol{V}^{\top}(d\boldsymbol{V})\boldsymbol{\Sigma} \\\[6pt]<br />
=&amp;\, -\boldsymbol{\Sigma}\boldsymbol{U}^{\top}(d\boldsymbol{U}) - (d\boldsymbol{V})^{\top}\boldsymbol{V}\boldsymbol{\Sigma}<br />
\end{aligned}\label{eq:vector-2}\end{equation}<br />
ç¬¬äºŒä¸ªç­‰å·åˆ©ç”¨äº†â€œ$\boldsymbol{U}^{\top}(d\boldsymbol{U})$å’Œ$(d\boldsymbol{V})^{\top}\boldsymbol{V}$éƒ½æ˜¯åå¯¹ç§°çŸ©é˜µâ€è¿™ä¸€äº‹å®ã€‚å¼$\eqref{eq:vector-1}$å’Œå¼$\eqref{eq:vector-2}$å°±æ˜¯å…³äº$d\boldsymbol{U},d\boldsymbol{V}$çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼Œæˆ‘ä»¬è¦ä»ä¸­è§£å‡º$d\boldsymbol{U},d\boldsymbol{V}$ã€‚</p>
<p>æ±‚è§£æ€è·¯å°±æ˜¯æ™®é€šçš„æ¶ˆå…ƒæ³•ã€‚é¦–å…ˆï¼Œç”±$\eqref{eq:vector-1}\times\boldsymbol{\Sigma} + \boldsymbol{\Sigma}\times\eqref{eq:vector-2}$å¾—åˆ°<br />
\begin{equation}\bar{\boldsymbol{I}}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}\boldsymbol{\Sigma} + \boldsymbol{\Sigma}\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}) = \boldsymbol{U}^{\top}(d\boldsymbol{U})\boldsymbol{\Sigma}^2 - \boldsymbol{\Sigma}^2\boldsymbol{U}^{\top}(d\boldsymbol{U})\end{equation}<br />
è¿™é‡Œåˆ©ç”¨äº†å¯¹è§’é˜µ$\boldsymbol{\Sigma}$æ»¡è¶³$\boldsymbol{\Sigma}(\bar{\boldsymbol{I}}\otimes \boldsymbol{M}) = \bar{\boldsymbol{I}}\otimes (\boldsymbol{\Sigma}\boldsymbol{M})$ä»¥åŠ$(\bar{\boldsymbol{I}}\otimes \boldsymbol{M})\boldsymbol{\Sigma} = \bar{\boldsymbol{I}}\otimes (\boldsymbol{M}\boldsymbol{\Sigma})$çš„äº‹å®ã€‚æˆ‘ä»¬çŸ¥é“ï¼Œå·¦ï¼ˆå³ï¼‰ä¹˜ä¸€ä¸ªå¯¹è§’é˜µï¼Œç­‰äºçŸ©é˜µçš„æ¯ä¸€è¡Œï¼ˆåˆ—ï¼‰éƒ½ä¹˜ä»¥å¯¹è§’é˜µä¸Šç›¸åº”çš„å…ƒç´ ï¼Œæ‰€ä»¥å¦‚æœæˆ‘ä»¬å®šä¹‰çŸ©é˜µ$\boldsymbol{E}$ï¼Œå…¶ä¸­$\boldsymbol{E}<em i_j="i,j">{i,j} = \sigma_j^2 - \sigma_i^2$ï¼Œé‚£ä¹ˆ$\boldsymbol{U}^{\top}(d\boldsymbol{U})\boldsymbol{\Sigma}^2 - \boldsymbol{\Sigma}^2\boldsymbol{U}^{\top}(d\boldsymbol{U}) = \boldsymbol{E}\otimes (\boldsymbol{U}^{\top}(d\boldsymbol{U}))$ï¼Œäºæ˜¯ä¸Šå¼å¯ä»¥å†™æˆ<br />
\begin{equation}\bar{\boldsymbol{I}}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}\boldsymbol{\Sigma} + \boldsymbol{\Sigma}\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}) = \boldsymbol{E}\otimes (\boldsymbol{U}^{\top}(d\boldsymbol{U}))\label{eq:dU-0}\end{equation}<br />
ç»§è€Œå¯ä»¥è§£å¾—<br />
\begin{equation}d\boldsymbol{U} = \boldsymbol{U}(\boldsymbol{F}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}\boldsymbol{\Sigma} + \boldsymbol{\Sigma}\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}))\label{eq:dU}\end{equation}<br />
ç±»ä¼¼åœ°ï¼Œç”±$\boldsymbol{\Sigma}\times \eqref{eq:vector-1} + \eqref{eq:vector-2}\times \boldsymbol{\Sigma}$è§£å¾—ï¼š<br />
\begin{equation}d\boldsymbol{V} = \boldsymbol{V}(\boldsymbol{F}\otimes(\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}\boldsymbol{\Sigma} + \boldsymbol{\Sigma}\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}))\label{eq:dV}\end{equation}<br />
å¼$\eqref{eq:dU},\eqref{eq:dV}$ä¾¿æ˜¯ç‰¹å¾å‘é‡çš„å¾®åˆ†ã€‚å…¶ä¸­<br />
\begin{equation}\boldsymbol{F}</em>} = \left\{\begin{aligned<br />
&amp;\, 1/(\sigma_j^2 - \sigma_i^2), &amp;\, i\neq j \\\<br />
&amp;\, 0, &amp;\, i = j<br />
\end{aligned}\right.\end{equation}</p>
<h2 id="_4">æ¢¯åº¦ï¼ˆä¸€ï¼‰</h2>
<p>å¾®åˆ†æœ‰äº†ï¼Œæ€ä¹ˆæŠŠæ¢¯åº¦æ±‚å‡ºæ¥å‘¢ï¼Ÿè¿™è¿˜çœŸæœ‰ç‚¹éº»çƒ¦ã€‚å€’ä¸æ˜¯æŠ€æœ¯ä¸Šçš„éº»çƒ¦ï¼Œè€Œæ˜¯è¡¨ç¤ºä¸Šçš„éº»çƒ¦ï¼Œæ¯”å¦‚$\boldsymbol{W},\boldsymbol{U}$æ˜¯ä¸€ä¸ª$n\times n$çŸ©é˜µï¼Œé‚£ä¹ˆ$\boldsymbol{U}$å…³äº$\boldsymbol{W}$çš„å®Œæ•´æ¢¯åº¦å°±æ˜¯ä¸€ä¸ª$n\times n\times n\times n$çš„4é˜¶å¼ é‡ï¼Œè€Œé«˜é˜¶å¼ é‡æ˜¯å¤§å¤šæ•°äººåŒ…æ‹¬ç¬”è€…éƒ½ä¸ç†Ÿæ‚‰çš„å†…å®¹ã€‚</p>
<p>ä¸ºäº†ç»•å¼€é«˜é˜¶å¼ é‡çš„éº»çƒ¦ï¼Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªæ–¹æ¡ˆã€‚é¦–å…ˆï¼Œä»ç¼–ç¨‹è§’åº¦çœ‹ï¼Œæˆ‘ä»¬æ ¹æœ¬æ²¡å¿…è¦æ±‚å‡ºæ¢¯åº¦çš„å½¢å¼ï¼Œè€Œæ˜¯æ ¹æ®å¾®åˆ†çš„ç»“æœå†™å‡ºç­‰ä»·çš„å‰å‘å½¢å¼ï¼Œç„¶åäº¤ç»™æ¡†æ¶çš„è‡ªåŠ¨æ±‚å¯¼å°±è¡Œã€‚æ¯”å¦‚ï¼Œä»å¼$\eqref{eq:d-sigma}$æˆ‘ä»¬å¯ä»¥æ–­å®š$\sigma_i$çš„æ¢¯åº¦ç­‰äº$\newcommand{\sg}[1]{\color{skyblue}{#1}} \sg{\boldsymbol{u}<em _boldsymbol_W="\boldsymbol{W">i}^{\top} \boldsymbol{W} \sg{\boldsymbol{v}_i}$çš„æ¢¯åº¦ï¼Œå³<br />
\begin{equation}\nabla</em>}} \sigma_i = \nabla_{\boldsymbol{W}} (\sg{\boldsymbol{u<em _boldsymbol_W="\boldsymbol{W">i}^{\top} \boldsymbol{W} \sg{\boldsymbol{v}_i})\end{equation}<br />
è¿™é‡Œå°†ç¬¦å·é¢œè‰²æ”¹ä¸º$\sg{\blacksquare}$è‰²ä»£è¡¨stop_gradientç®—å­ï¼Œé¿å…å…¬å¼è¿‡äºè‡ƒè‚¿ã€‚åˆšå¥½$\sigma_i$åˆç­‰äº$\boldsymbol{u}_i^{\top}\boldsymbol{W}\boldsymbol{v}_i$ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æŠŠä»£ç ä¸­å‡ºç°$\sigma_i$çš„åœ°æ–¹ï¼Œéƒ½æ›¿æ¢æˆ$\sg{\boldsymbol{u}_i}^{\top} \boldsymbol{W} \sg{\boldsymbol{v}_i}$ï¼Œé‚£ä¹ˆå°±å¯ä»¥è‡ªåŠ¨è·å¾—æ­£ç¡®çš„æ¢¯åº¦ã€‚ä¸€èˆ¬åœ°ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\nabla</em>}} \boldsymbol{\Sigma} = \nabla_{\boldsymbol{W}} (\boldsymbol{I}\otimes(\sg{\boldsymbol{U}}^{\top} \boldsymbol{W} \sg{\boldsymbol{V}}))\end{equation<br />
å³æ‰€æœ‰$\boldsymbol{\Sigma}$æ¢æˆ$\boldsymbol{I}\otimes(\sg{\boldsymbol{U}}^{\top} \boldsymbol{W} \sg{\boldsymbol{V}})$å³å¯ã€‚</p>
<p>åŒç†ï¼Œä»å¼$\eqref{eq:dU}$æˆ‘ä»¬çŸ¥é“<br />
\begin{equation}\nabla_{\boldsymbol{W}}\boldsymbol{U} = \nabla_{\boldsymbol{W}}(\sg{\boldsymbol{U}}(\sg{\boldsymbol{F}}\otimes(\sg{\boldsymbol{U}}^{\top}\boldsymbol{W}\sg{\boldsymbol{V}\boldsymbol{\Sigma}} + \sg{\boldsymbol{\Sigma}\boldsymbol{V}}^{\top}\boldsymbol{W}^{\top}\sg{\boldsymbol{U}})))\end{equation}<br />
å¯ä»¥éªŒè¯$\boldsymbol{U}(\boldsymbol{F}\otimes(\boldsymbol{U}^{\top}\boldsymbol{W}\boldsymbol{V}\boldsymbol{\Sigma} + \boldsymbol{\Sigma}\boldsymbol{V}^{\top}\boldsymbol{W}^{\top}\boldsymbol{U}))$åˆšå¥½æ˜¯é›¶çŸ©é˜µï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†ä»£ç ä¸­æ‰€æœ‰å‡ºç°$\boldsymbol{U}$çš„åœ°æ–¹ï¼Œéƒ½æ›¿æ¢æˆ<br />
\begin{equation}\boldsymbol{U} \quad \to \quad \sg{\boldsymbol{U}} + \sg{\boldsymbol{U}}(\sg{\boldsymbol{F}}\otimes(\sg{\boldsymbol{U}}^{\top}\boldsymbol{W}\sg{\boldsymbol{V}\boldsymbol{\Sigma}} + \sg{\boldsymbol{\Sigma}\boldsymbol{V}}^{\top}\boldsymbol{W}^{\top}\sg{\boldsymbol{U}}))\end{equation}<br />
é‚£å°±èƒ½ä¿æŒæ­£ç¡®çš„å‰å‘ç»“æœï¼ŒåŒæ—¶è·å¾—æ­£ç¡®çš„æ¢¯åº¦ã€‚åŸºäºåŒæ ·çš„åŸç†ï¼Œ$\boldsymbol{V}$çš„æ›¿æ¢æ ¼å¼æ˜¯<br />
\begin{equation}\boldsymbol{V} \quad \to \quad \sg{\boldsymbol{V}} + \sg{\boldsymbol{V}}(\sg{\boldsymbol{F}}\otimes(\sg{\boldsymbol{V}}^{\top}\boldsymbol{W}^{\top}\sg{\boldsymbol{U}\boldsymbol{\Sigma}} + \sg{\boldsymbol{\Sigma}\boldsymbol{U}}^{\top}\boldsymbol{W}\sg{\boldsymbol{V}}))\end{equation}</p>
<h2 id="_5">æ¢¯åº¦ï¼ˆäºŒï¼‰</h2>
<p>ç¬¬äºŒä¸ªæ–¹æ¡ˆæ˜¯ç›´æ¥æ±‚å‡ºæŸå¤±å‡½æ•°å…³äº$\boldsymbol{W}$çš„æ¢¯åº¦ã€‚å…·ä½“æ¥è¯´ï¼Œå‡è®¾æŸå¤±å‡½æ•°æ˜¯$\boldsymbol{U},\boldsymbol{\Sigma},\boldsymbol{V}$çš„å‡½æ•°ï¼Œè®°ä¸º$\mathcal{L}(\boldsymbol{U},\boldsymbol{\Sigma},\boldsymbol{V})$ï¼Œæˆ‘ä»¬ç›´æ¥æ±‚$\nabla_{\boldsymbol{W}}\mathcal{L}$ï¼Œå®ƒæ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œå¯ä»¥ç”¨$\boldsymbol{U},\boldsymbol{\Sigma},\boldsymbol{V},\nabla_{\boldsymbol{U}}\mathcal{L},\nabla_{\boldsymbol{\Sigma}}\mathcal{L},\nabla_{\boldsymbol{V}}\mathcal{L}$è¡¨ç¤ºå‡ºæ¥ï¼Œè¿™äº›é‡ä¹Ÿéƒ½åªæ˜¯çŸ©é˜µï¼Œæ‰€ä»¥ä¸ç”¨æ¶‰åŠåˆ°é«˜é˜¶å¼ é‡ã€‚</p>
<p>åœ¨ä¸Šä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å·²ç»æ±‚å‡ºäº†å…·æœ‰ç›¸åŒæ¢¯åº¦çš„$\boldsymbol{U},\boldsymbol{\Sigma},\boldsymbol{V}$çš„ç­‰æ•ˆå‡½æ•°ï¼Œé™¤å¼€è¢«stop_gradientçš„éƒ¨åˆ†å¤–ï¼Œè¿™äº›ç­‰æ•ˆå‡½æ•°å…³äº$\boldsymbol{W}$éƒ½æ˜¯çº¿æ€§çš„ï¼Œæ‰€ä»¥æ­¤æ—¶é—®é¢˜æœ¬è´¨ä¸Šå·²ç»å˜æˆäº†çº¿æ€§å¤åˆå‡½æ•°çš„æ¢¯åº¦ã€‚æˆ‘ä»¬ä¹‹å‰åœ¨<a href="/archives/10366#%E7%9F%A9%E9%98%B5%E6%B1%82%E5%AF%BC">ã€Šä½ç§©è¿‘ä¼¼ä¹‹è·¯ï¼ˆä¸€ï¼‰ï¼šä¼ªé€†ã€‹</a>çš„â€œçŸ©é˜µæ±‚å¯¼â€ä¸€èŠ‚ä¾¿å·²ç»è®¨è®ºè¿‡ç›¸å…³æ–¹æ³•ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{align}<br />
\boldsymbol{X} = \boldsymbol{A}\boldsymbol{B}\boldsymbol{C} &amp;\,\quad\Rightarrow\quad \nabla_{\boldsymbol{B}}f(\boldsymbol{X}) = \boldsymbol{A}^{\top}(\nabla_{\boldsymbol{X}}f(\boldsymbol{X}))\boldsymbol{C}^{\top} \\\[8pt]<br />
\boldsymbol{X} = \boldsymbol{A}\boldsymbol{B}^{\top}\boldsymbol{C} &amp;\,\quad\Rightarrow\quad \nabla_{\boldsymbol{B}}f(\boldsymbol{X}) = \boldsymbol{C}(\nabla_{\boldsymbol{X}}f(\boldsymbol{X}))^{\top}\boldsymbol{A} \\\[8pt]<br />
\boldsymbol{X} = \boldsymbol{A}\otimes\boldsymbol{B} &amp;\,\quad\Rightarrow\quad \nabla_{\boldsymbol{B}}f(\boldsymbol{X}) = \boldsymbol{A}\otimes \nabla_{\boldsymbol{X}}f(\boldsymbol{X})<br />
\end{align}<br />
åˆ©ç”¨è¿™äº›åŸºæœ¬å…¬å¼ï¼Œä»¥åŠå¤åˆå‡½æ•°æ±‚å¯¼çš„é“¾å¼æ³•åˆ™ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡º<br />
\begin{equation}\begin{aligned}<br />
\nabla_{\boldsymbol{W}}\mathcal{L} \quad = \qquad &amp;\,\boldsymbol{U}(\boldsymbol{F}\otimes(\boldsymbol{U}^{\top}(\nabla_{\boldsymbol{U}}\mathcal{L}) - (\nabla_{\boldsymbol{U}}\mathcal{L})^{\top}\boldsymbol{U}))\boldsymbol{\Sigma}\boldsymbol{V}^{\top} \\\[6pt]<br />
+ &amp;\,\boldsymbol{U}(\boldsymbol{I}\otimes(\nabla_{\boldsymbol{\Sigma}}\mathcal{L}))\boldsymbol{V}^{\top} \\\[6pt]<br />
+ &amp;\,\boldsymbol{U}\boldsymbol{\Sigma}(\boldsymbol{F}\otimes(\boldsymbol{V}^{\top}(\nabla_{\boldsymbol{V}}\mathcal{L}) - (\nabla_{\boldsymbol{V}}\mathcal{L})^{\top}\boldsymbol{V})))\boldsymbol{V}^{\top}<br />
\end{aligned}\end{equation}<br />
æ•´ä¸ªè¿‡ç¨‹å°±æ˜¯åå¤åœ°åˆ©ç”¨åŸºæœ¬å…¬å¼å’Œé“¾å¼æ³•åˆ™ï¼Œä»¥åŠ$\boldsymbol{F}^{\top} = -\boldsymbol{F}$ï¼ŒåŸåˆ™ä¸Šæ²¡æœ‰éš¾åº¦ï¼Œå°±æ˜¯éœ€è¦è°¨æ…åœ°é›†ä¸­æ³¨æ„åŠ›ï¼Œå»ºè®®è¯»è€…äº²è‡ªåŠ¨æ‰‹å®Œæˆè¿™ä¸ªæ¨å¯¼è¿‡ç¨‹ï¼Œè¿™æ˜¯ä¸€é“ç›¸å½“å®ç”¨çš„çŸ©é˜µæ±‚å¯¼ç»ƒä¹ é¢˜ã€‚æœ€åå¼•å…¥ä¸¤ä¸ªè®°å·<br />
\begin{equation}\newcommand{\sym}[1]{\color{red}{[}#1\color{red}{]<em skew="skew">{sym}}} \newcommand{\skew}[1]{\color{red}{[}#1\color{red}{]</em>}}} \sym{\boldsymbol{X}} = \frac{1}{2}(\boldsymbol{X} + \boldsymbol{X}^{\top}),\qquad \skew{\boldsymbol{X}} = \frac{1}{2}(\boldsymbol{X} - \boldsymbol{X}^{\top})\end{equation<br />
æˆ‘ä»¬å¯ä»¥å°†æ¢¯åº¦ç»“æœç®€å†™æˆ<br />
\begin{equation}\nabla_{\boldsymbol{W}}\mathcal{L} = \boldsymbol{U}\Big(2(\boldsymbol{F}\otimes\skew{\boldsymbol{U}^{\top}(\nabla_{\boldsymbol{U}}\mathcal{L})})\boldsymbol{\Sigma} + \boldsymbol{I}\otimes(\nabla_{\boldsymbol{\Sigma}}\mathcal{L}) + 2\boldsymbol{\Sigma}(\boldsymbol{F}\otimes\skew{\boldsymbol{V}^{\top}(\nabla_{\boldsymbol{V}}\mathcal{L})})\Big)\boldsymbol{V}^{\top}<br />
\label{eq:w-grad-l}\end{equation}</p>
<h2 id="_6">æ¢¯åº¦ï¼ˆä¸‰ï¼‰</h2>
<p>ç°åœ¨å¯ä»¥ç‰›åˆ€å°è¯•ä¸€ä¸‹ï¼Œæ±‚$\boldsymbol{O}=\mathop{\text{msign}}(\boldsymbol{W})=\boldsymbol{U}\boldsymbol{V}^{\top}$çš„æ¢¯åº¦ï¼Œå…¶ä¸­$\mathop{\text{msign}}$çš„æ¦‚å¿µæˆ‘ä»¬åœ¨<a href="/archives/10592">ã€ŠMuonä¼˜åŒ–å™¨èµæï¼šä»å‘é‡åˆ°çŸ©é˜µçš„æœ¬è´¨è·¨è¶Šã€‹</a>ä»‹ç»Muonæ—¶å·²ç»è®¨è®ºè¿‡ã€‚</p>
<p>æ ¹æ®$\mathop{\text{msign}}$çš„å®šä¹‰ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\nabla_{\boldsymbol{U}}\mathcal{L} = (\nabla_{\boldsymbol{O}}\mathcal{L})\boldsymbol{V},\qquad \nabla_{\boldsymbol{V}}\mathcal{L} = (\nabla_{\boldsymbol{O}}\mathcal{L})^{\top} \boldsymbol{U}\end{equation}<br />
ä»£å…¥å¼$\eqref{eq:w-grad-l}$å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
\nabla_{\boldsymbol{W}}\mathcal{L} =&amp;\, 2\boldsymbol{U}\Big((\boldsymbol{F}\otimes\skew{\boldsymbol{U}^{\top}(\nabla_{\boldsymbol{O}}\mathcal{L})\boldsymbol{V}})\boldsymbol{\Sigma} + \boldsymbol{\Sigma}(\boldsymbol{F}\otimes\skew{\boldsymbol{V}^{\top}(\nabla_{\boldsymbol{O}}\mathcal{L})^{\top}\boldsymbol{U}})\Big)\boldsymbol{V}^{\top} \\\[6pt]<br />
=&amp;\, 2\boldsymbol{U}\Big((\boldsymbol{F}\otimes\skew{\boldsymbol{U}^{\top}(\nabla_{\boldsymbol{O}}\mathcal{L})\boldsymbol{V}})\boldsymbol{\Sigma} - \boldsymbol{\Sigma}(\boldsymbol{F}\otimes\skew{\boldsymbol{U}^{\top}(\nabla_{\boldsymbol{O}}\mathcal{L})\boldsymbol{V}})\Big)\boldsymbol{V}^{\top} \\\[6pt]<br />
=&amp;\, 2\boldsymbol{U}\big(\boldsymbol{G}\otimes\skew{\boldsymbol{U}^{\top}(\nabla_{\boldsymbol{O}}\mathcal{L})\boldsymbol{V}}\big)\boldsymbol{V}^{\top}<br />
\end{aligned}\end{equation}<br />
å…¶ä¸­$\boldsymbol{G}_{i,j} = 1/(\sigma_i + \sigma_j)$ã€‚</p>
<h2 id="_7">æ¢¯åº¦ï¼ˆå››ï¼‰</h2>
<p>æœ€åè®©æˆ‘ä»¬æ¥è€ƒè™‘ä¸€ä¸ªå¸¸ç”¨çš„ç‰¹æ®Šä¾‹å­ï¼Œå½“$\boldsymbol{W}$è¿˜æ˜¯æ­£å®šå¯¹ç§°çŸ©é˜µæ—¶ï¼Œå®ƒçš„SVDå…·æœ‰$\boldsymbol{V}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$çš„å½¢å¼ï¼Œå³$\boldsymbol{U}=\boldsymbol{V}$ã€‚æˆ‘ä»¬é‡å¤å‰é¢çš„æ¨å¯¼ï¼Œå…ˆå¯¹ä¸¤è¾¹æ±‚å¾®åˆ†<br />
\begin{equation}d\boldsymbol{W} = (d\boldsymbol{V})\boldsymbol{\Sigma}\boldsymbol{V}^{\top} + \boldsymbol{V}(d\boldsymbol{\Sigma})\boldsymbol{V}^{\top} + \boldsymbol{V}\boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}\end{equation}<br />
ç„¶åå·¦ä¹˜$\boldsymbol{V}^{\top}$ã€å³ä¹˜$\boldsymbol{V}$ï¼š<br />
\begin{equation}\begin{aligned}<br />
\boldsymbol{V}^{\top}(d\boldsymbol{W})\boldsymbol{V} =&amp;\, \boldsymbol{V}^{\top}(d\boldsymbol{V})\boldsymbol{\Sigma} + d\boldsymbol{\Sigma} + \boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}\boldsymbol{V} \\\[6pt]<br />
=&amp;\, \boldsymbol{V}^{\top}(d\boldsymbol{V})\boldsymbol{\Sigma} + d\boldsymbol{\Sigma} - \boldsymbol{\Sigma}\boldsymbol{V}^{\top}(d\boldsymbol{V})<br />
\end{aligned}\end{equation}<br />
ç”±æ­¤å¯è§<br />
\begin{gather}<br />
d\boldsymbol{\Sigma} = \boldsymbol{I}\otimes(\boldsymbol{V}(d\boldsymbol{W})\boldsymbol{V}^{\top}) \\\[8pt]<br />
\boldsymbol{V}^{\top}(d\boldsymbol{V})\boldsymbol{\Sigma} - \boldsymbol{\Sigma}\boldsymbol{V}^{\top}(d\boldsymbol{V}) = \bar{\boldsymbol{I}}\otimes(\boldsymbol{V}(d\boldsymbol{W})\boldsymbol{V}^{\top})<br />
\end{gather}<br />
ç”±ç¬¬äºŒå¼å¯ä»¥è¿›ä¸€æ­¥è§£å¾—<br />
\begin{equation}d\boldsymbol{V} = \boldsymbol{V}(\boldsymbol{K}^{\top}\otimes(\boldsymbol{V}^{\top}(d\boldsymbol{W})\boldsymbol{V}))\end{equation}<br />
å…¶ä¸­<br />
\begin{equation}\boldsymbol{K}<em _boldsymbol_W="\boldsymbol{W">{i,j} = \left\{\begin{aligned}<br />
&amp;\, 1/(\sigma_i - \sigma_j), &amp;\, i\neq j \\\<br />
&amp;\, 0, &amp;\, i = j<br />
\end{aligned}\right.\end{equation}<br />
æ ¹æ®è¿™ä¸ªç»“æœï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\nabla</em>}}\mathcal{L} = \boldsymbol{V}(\boldsymbol{K}^{\top}\otimes(\boldsymbol{V}^{\top}(\nabla_{\boldsymbol{V}}\mathcal{L})) + \boldsymbol{I}\otimes(\nabla_{\boldsymbol{\Sigma}}\mathcal{L}))\boldsymbol{V}^{\top} \end{equation<br />
æ³¨æ„é™·é˜±ï¼ä¸Šå¼å…¶å®æ˜¯é”™è¯¯çš„ï¼Œå®ƒæ˜¯é“¾å¼æ³•åˆ™çš„ç»“æœï¼Œä½†é“¾å¼æ³•åˆ™åªé€‚ç”¨äºæ— çº¦æŸæ±‚å¯¼ï¼Œè€Œè¿™é‡Œå¸¦æœ‰çº¦æŸ$\boldsymbol{W}=\boldsymbol{W}^{\top}$ï¼Œæ­£ç¡®çš„æ¢¯åº¦åº”è¯¥è¿˜è¦åŒ…å«å¯¹ç§°åŒ–ï¼š<br />
\begin{equation}\begin{aligned}<br />
\nabla_{\boldsymbol{W}}\mathcal{L} =&amp;\, \boldsymbol{V}\Big(\sym{\boldsymbol{K}^{\top}\otimes(\boldsymbol{V}^{\top}(\nabla_{\boldsymbol{V}}\mathcal{L}))} + \boldsymbol{I}\otimes(\nabla_{\boldsymbol{\Sigma}}\mathcal{L})\Big)\boldsymbol{V}^{\top} \\\[6pt]<br />
=&amp;\, \boldsymbol{V}\Big(\boldsymbol{K}^{\top}\otimes\skew{\boldsymbol{V}^{\top}(\nabla_{\boldsymbol{V}}\mathcal{L})} + \boldsymbol{I}\otimes(\nabla_{\boldsymbol{\Sigma}}\mathcal{L})\Big)\boldsymbol{V}^{\top}\end{aligned}\end{equation}<br />
å¦ä¸€ä¸ªé™·é˜±æ˜¯ç›´æ¥å°†$\boldsymbol{U}=\boldsymbol{V}$ä»£å…¥å¼$\eqref{eq:w-grad-l}$æ¥æ¨å¯¼ï¼Œè¿™å°†ä¼šå¯¼è‡´$\boldsymbol{K}$é¡¹ç¿»å€ï¼ŒåŸå› æ˜¯å¼$\eqref{eq:w-grad-l}$åŒºåˆ†äº†$\nabla_{\boldsymbol{U}}\mathcal{L}$å’Œ$\nabla_{\boldsymbol{V}}\mathcal{L}$ï¼Œè€Œåœ¨æ­£å®šå¯¹ç§°å‡è®¾ä¸‹ï¼Œ$\boldsymbol{U},\boldsymbol{V}$æ˜¯ç›¸åŒçš„ï¼Œå¯¹$\boldsymbol{V}$æ±‚æ¢¯åº¦å®é™…ä¸Šæ— å½¢ä¸­æ±‚äº†åŸæœ¬çš„$\nabla_{\boldsymbol{U}}\mathcal{L},\nabla_{\boldsymbol{V}}\mathcal{L}$ä¹‹å’Œï¼Œæ‰€ä»¥ä¼šå¯¼è‡´é‡å¤è®¡ç®—ã€‚ç›¸å…³æ–‡çŒ®è¿˜å¯ä»¥å‚è€ƒ<a href="https://openaccess.thecvf.com/content_iccv_2015/html/Ionescu_Matrix_Backpropagation_for_ICCV_2015_paper.html">ã€ŠMatrix Backpropagation for Deep Networks With Structured Layersã€‹</a>ã€‚</p>
<h2 id="_8">æ•°å€¼é—®é¢˜</h2>
<p>å¯èƒ½æœ‰äº›è¯»è€…ç–‘é—®ï¼šæˆ‘åªèƒ½ä¿è¯åˆå§‹åŒ–çŸ©é˜µçš„å¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰ï¼Œæ€ä¹ˆä¿è¯ç»è¿‡è®­ç»ƒåçš„çŸ©é˜µä»ç„¶æ»¡è¶³è¿™ä¸ªæ¡ä»¶å‘¢ï¼Ÿç­”æ¡ˆæ˜¯æ¢¯åº¦è‡ªç„¶ä¼šå¸®æˆ‘ä»¬ä¿è¯ã€‚ä»å¼$\eqref{eq:dU}$å’Œå¼$\eqref{eq:dV}$å¯ä»¥çœ‹å‡ºï¼Œå®ƒçš„æ¢¯åº¦åŒ…å«äº†$\boldsymbol{F}$ï¼Œè€Œç”±$\boldsymbol{F}_{i,j} = \frac{1}{\sigma_j^2 - \sigma_i^2}$å¯çŸ¥ï¼Œä¸€æ—¦ä¸¤ä¸ªå¥‡å¼‚å€¼æ¥è¿‘ï¼Œé‚£ä¹ˆæ¢¯åº¦å°†ä¼šéå¸¸å¤§ï¼Œæ‰€ä»¥ä¼˜åŒ–å™¨ä¼šè‡ªåŠ¨æŠŠå®ƒä»¬æ¨å¼€ã€‚</p>
<p>ä¸è¿‡ï¼Œè¿™ä¸ªç‰¹æ€§ä¹Ÿç»™å®é™…è®­ç»ƒå¸¦æ¥äº†æ•°å€¼ä¸ç¨³å®šæ€§ï¼Œä¸»è¦ä½“ç°åœ¨$\sigma_i,\sigma_j$æ¥è¿‘æ—¶çš„æ¢¯åº¦çˆ†ç‚¸ã€‚å¯¹æ­¤ï¼Œè®ºæ–‡<a href="https://papers.cool/arxiv/1906.09023">ã€ŠBackpropagation-Friendly Eigendecompositionã€‹</a>æå‡ºç”¨â€œå¹‚è¿­ä»£ï¼ˆPower Iterationï¼‰â€æ›¿ä»£ç²¾ç¡®çš„SVDã€‚åæ¥ï¼Œè®ºæ–‡<a href="https://papers.cool/arxiv/2104.03821">ã€ŠRobust Differentiable SVDã€‹</a>è¯æ˜äº†å®ƒç†è®ºä¸Šç­‰äºå¯¹$\boldsymbol{F}_{i,j} = -\frac{1}{ï¼ˆ\sigma_i + \sigma_j)(\sigma_i - \sigma_jï¼‰}$ä¸­çš„$\frac{1}{\sigma_i - \sigma_j}$åšæ³°å‹’è¿‘ä¼¼ï¼ˆå‡è®¾$\sigma_j &lt; \sigma_i$ï¼‰ï¼š<br />
\begin{equation}\frac{1}{\sigma_i - \sigma_j} = \frac{1}{\sigma_i}\frac{1}{1-(\sigma_j/\sigma_i)}\approx \frac{1}{\sigma_i}\left(1 + \left(\frac{\sigma_j}{\sigma_i}\right) + \left(\frac{\sigma_j}{\sigma_i}\right)^2 + \cdots + \left(\frac{\sigma_j}{\sigma_i}\right)^N \right)\end{equation}<br />
ä½¿ç”¨æ³°å‹’è¿‘ä¼¼åï¼Œè‡³å°‘å¯¹äº$\sigma_j \to \sigma_i$çš„æƒ…å†µä¸ä¼šå‡ºç°æ¢¯åº¦çˆ†ç‚¸äº†ã€‚å†åæ¥ï¼Œä½œè€…åœ¨<a href="https://papers.cool/arxiv/2105.02498">ã€ŠWhy Approximate Matrix Square Root Outperforms Accurate SVD in Global Covariance Pooling?ã€‹</a>å°†å…¶æ¨å¹¿åˆ°æ›´ä¸€èˆ¬çš„PadÃ©è¿‘ä¼¼ã€‚è¿™ä¸€ç³»åˆ—å·¥ä½œç¬”è€…å¹¶ä¸æ˜¯å¤ªç†Ÿæ‚‰ï¼Œå› æ­¤å°±ä¸è¿‡å¤šå±•å¼€äº†ã€‚</p>
<p>åªæ˜¯ç¬”è€…æœ‰ä¸€ä¸ªç–‘é—®ï¼Œå¦‚æœåªæ˜¯å•çº¯ä¸ºäº†é¿å…æ•°å€¼çˆ†ç‚¸ï¼Œä¼¼ä¹æ²¡å¿…è¦ä¸Šè¿™äº›å·¥å…·ï¼Œç›´æ¥ç»™$\sigma_j/\sigma_i$åŠ ä¸ªæˆªæ–­ä¸å°±å¥½äº†ï¼Ÿæ¯”å¦‚<br />
\begin{equation}\frac{1}{1-(\sigma_j/\sigma_i)}\approx \frac{1}{1-\min(\sigma_j/\sigma_i, 0.99)}\end{equation}<br />
è¿™æ ·ä¸å°±ç®€å•é¿å…äº†å®ƒè¶‹äºæ— ç©·ï¼Ÿè¿˜æ˜¯ç¬”è€…æœ‰ä»€ä¹ˆè®¤è¯†ä¸åˆ°ä½çš„åœ°æ–¹ï¼Ÿå¦‚æœè¯»è€…äº†è§£ç›¸å…³èƒŒæ™¯ï¼Œæ•¬è¯·åœ¨è¯„è®ºåŒºæŒ‡æ­£ï¼Œè°¢è°¢ã€‚</p>
<h2 id="_9">ä¸€èˆ¬ç»“æœ</h2>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œä¸Šé¢å‡ºç°çš„æ‰€æœ‰çŸ©é˜µéƒ½æ˜¯$n\times n$çŸ©é˜µï¼Œå› ä¸ºè¿™æ˜¯åœ¨æ–‡ç« å¼€å¤´çš„å‡è®¾â€œ$\boldsymbol{W}$æ˜¯æ»¡ç§©çš„$n\times n$çŸ©é˜µï¼Œä¸”å…¨ä½“å¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰â€ä¸‹è¿›è¡Œçš„æ¨å¯¼ã€‚è¿™ä¸€èŠ‚æˆ‘ä»¬æ¥è®¨è®ºè¯¥æ¡ä»¶å¯ä»¥æ”¾å®½åˆ°ä»€ä¹ˆç¨‹åº¦ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼ŒSVDå¯å¯¼çš„æ¡ä»¶æ˜¯â€œå…¨ä½“éé›¶å¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰â€ï¼Œæ¢è¨€ä¹‹ï¼Œæ–¹é˜µå¯ä»¥å»æ‰ï¼Œæ»¡ç§©ä¹Ÿå¯ä»¥å»æ‰ï¼Œä½†æ˜¯éé›¶å¥‡å¼‚å€¼ä»é¡»äº’ä¸ç›¸åŒã€‚å› ä¸ºä¸€æ—¦æœ‰ç›¸ç­‰çš„å¥‡å¼‚å€¼ï¼Œé‚£ä¹ˆSVDå°±ä¸å”¯ä¸€ï¼Œè¿™ä»æ ¹æœ¬ä¸Šç ´åäº†å¯å¯¼æ€§ã€‚å½“ç„¶ï¼Œå¦‚æœåªè¦éƒ¨åˆ†å¯¼æ•°ï¼Œé‚£æˆ‘ä»¬è¿˜å¯ä»¥æ”¾å®½æ¡ä»¶ï¼Œæ¯”å¦‚åªæƒ³è¦è°±èŒƒæ•°å³$\sigma_1$çš„å¯¼æ•°ï¼Œé‚£ä¹ˆåªéœ€è¦$\sigma_1 &gt; \sigma_2$ã€‚</p>
<p>é‚£ä¹ˆï¼Œæ”¾å®½æ¡ä»¶åï¼Œå¾®åˆ†ç»“æœæ€æ ·å˜åŒ–å‘¢ï¼Ÿæˆ‘ä»¬ä¸å¦¨ä¸€èˆ¬åœ°è®¾$\boldsymbol{W}\in\mathbb{R}^{n\times m}$ï¼Œç§©ä¸º$r$ï¼ŒSVDä¸º<br />
\begin{equation}\boldsymbol{W} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top},\quad\boldsymbol{U}\in\mathbb{R}^{n\times n},\boldsymbol{\Sigma}\in\mathbb{R}^{n\times m},\boldsymbol{V}\in\mathbb{R}^{m\times m}\end{equation}<br />
ä¹‹æ‰€ä»¥å…è®¸é›¶å¥‡å¼‚å€¼ï¼Œæ˜¯å› ä¸ºæ­¤æ—¶æˆ‘ä»¬åªå…³å¿ƒ$d\boldsymbol{U}<em :r_=":r]" _:_="[:,">{[:, :r]}$å’Œ$d\boldsymbol{V}</em>}$ï¼Œåœ¨éé›¶å¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰çš„å‡è®¾ä¸‹ï¼Œå®ƒä»¬æ˜¯å¯ä»¥å”¯ä¸€ç¡®å®šçš„ã€‚æˆ‘ä»¬ä»å¼$\eqref{eq:dU-0}$å‡ºå‘ï¼Œç›´åˆ°å¼$\eqref{eq:dU-0}$çš„æ¨å¯¼éƒ½æ˜¯é€šç”¨çš„ï¼Œä»å¼$\eqref{eq:dU-0}$ä¹Ÿå¯ä»¥çœ‹å‡ºä¸ºä»€ä¹ˆè¦æ‹’ç»ç›¸åŒå¥‡å¼‚å€¼ï¼Œå› ä¸º$\sigma_i = \sigma_j$æ—¶$\sigma_j - \sigma_i$å°±æ— æ³•æ±‚é€†äº†ã€‚åœ¨å¼$\eqref{eq:dU-0}$ä¸­åªä¿ç•™è·Ÿ$d\boldsymbol{U<em :r_=":r]" _:_="[:,">{[:, :r]}$ç›¸å…³çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¾—åˆ°<br />
\begin{equation}\bar{\boldsymbol{I}}</em>}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}\boldsymbol{\Sigma<em :r_=":r]" _:_="[:,">{[:, :r]} + \boldsymbol{\Sigma}\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}</em>}) = \boldsymbol{E<em :r_=":r]" _:_="[:,">{[:, :r]}\otimes (\boldsymbol{U}^{\top}(d\boldsymbol{U}</em>}))\end{equation<br />
è¿™é‡Œ$\boldsymbol{E}$çš„å®šä¹‰ä¾ç„¶æ˜¯$\boldsymbol{E}<em :r_=":r]" _:_="[:,">{i,j} = \sigma_j^2 - \sigma_i^2$ï¼Œä½†$\boldsymbol{E}</em>$æ­£å¥½æ’é™¤äº†æ‰€æœ‰0ï¼Œæ‰€ä»¥å¯ä»¥é¡ºåˆ©æ±‚é€†ï¼Œç»“æœæ˜¯<br />
\begin{equation}d\boldsymbol{U}<em :r_=":r]" _:_="[:,">{[:, :r]} = \boldsymbol{U}(\boldsymbol{F}</em>}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}\boldsymbol{\Sigma<em :r_=":r]" _:_="[:,">{[:, :r]} + \boldsymbol{\Sigma}\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}</em>}))\end{equation<br />
è¿›ä¸€æ­¥åœ°ï¼Œåšå¦‚ä¸‹åˆ†å—<br />
\begin{equation}\boldsymbol{U} = \begin{pmatrix}\boldsymbol{U}<em _:_r:_="[:,r:]">{[:,:r]} &amp; \boldsymbol{U}</em>}\end{pmatrix},\quad \boldsymbol{F<em :r_=":r]" _:r_="[:r,">{[:, :r]} = \begin{pmatrix} \boldsymbol{F}</em>} \\\ \boldsymbol{F<em :r_=":r]" _:_="[:,">{[r:, :r]}\end{pmatrix}\end{equation}<br />
å†åŠ ä¸Š$\boldsymbol{V}\boldsymbol{\Sigma}</em>} = \boldsymbol{V<em :r_=":r]" _:r_="[:r,">{[:, :r]}\boldsymbol{\Sigma}</em>$ï¼Œå¯ä»¥å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
d\boldsymbol{U}<em :r_=":r]" _:_="[:,">{[:, :r]} =&amp;\, \boldsymbol{U}</em>}(\boldsymbol{F<em :r_=":r]" _:_="[:,">{[:r, :r]}\otimes(\boldsymbol{U}</em>}^{\top}(d\boldsymbol{W})\boldsymbol{V<em :r_=":r]" _:r_="[:r,">{[:, :r]}\boldsymbol{\Sigma}</em>} + \boldsymbol{\Sigma<em :r_=":r]" _:_="[:,">{[:r, :r]}\boldsymbol{V}</em>}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U<em _:_="[:," r:_="r:]">{[:, :r]})) \\\[6pt]<br />
&amp;\,\qquad + \boldsymbol{U}</em>}(\boldsymbol{F<em _:_="[:," r:_="r:]">{[r:, :r]}\otimes(\boldsymbol{U}</em>}^{\top}(d\boldsymbol{W})\boldsymbol{V<em :r_=":r]" _:r_="[:r,">{[:, :r]}\boldsymbol{\Sigma}</em>))<br />
\end{aligned}\label{eq:dU-r}\end{equation}<br />
æ ¹æ®å‡è®¾ï¼Œå½“$i &gt; r$æ—¶$\sigma_i=0$ï¼Œæ‰€ä»¥$\boldsymbol{F}<em :r_=":r]" _r:_="[r:,">{[r:, :r]}$çš„æ¯ä¸€è¡Œéƒ½æ˜¯$(\sigma_1^{-2},\sigma_2^{-2},\cdots,\sigma_r^{-2})$ï¼Œäºæ˜¯$\boldsymbol{F}</em>}\otimes$ç­‰äºå³ä¹˜$\boldsymbol{\Sigma<em :r_=":r]" _r:_="[r:,">{[:r, :r]}^{-2}$ï¼Œå› æ­¤<br />
\begin{equation}\boldsymbol{F}</em>}\otimes(\boldsymbol{U<em :r_=":r]" _:_="[:,">{[:, r:]}^{\top}(d\boldsymbol{W})\boldsymbol{V}</em>}\boldsymbol{\Sigma<em _:_="[:," r:_="r:]">{[:r, :r]}) = \boldsymbol{U}</em>}^{\top}(d\boldsymbol{W})\boldsymbol{V<em :r_=":r]" _:r_="[:r,">{[:, :r]}\boldsymbol{\Sigma}</em>}^{-1}\end{equation<br />
æœ€ååˆ©ç”¨$\boldsymbol{U}\boldsymbol{U}^{\top} = \boldsymbol{I}$å’Œ$\boldsymbol{U} = (\boldsymbol{U}<em _:_r:_="[:,r:]">{[:,:r]},\boldsymbol{U}</em>})$ï¼Œå¾—åˆ°$\boldsymbol{U<em _:_="[:," r:_="r:]">{[:, r:]}\boldsymbol{U}</em>}^{\top} = \boldsymbol{I} - \boldsymbol{U<em :r_=":r]" _:_="[:,">{[:, :r]}\boldsymbol{U}</em>$å¾—}^{\top}$ï¼Œä»£å…¥å¼$\eqref{eq:dU-r<br />
\begin{equation}\begin{aligned}<br />
d\boldsymbol{U}<em :r_=":r]" _:_="[:,">{[:, :r]} =&amp;\, \boldsymbol{U}</em>}(\boldsymbol{F<em :r_=":r]" _:_="[:,">{[:r, :r]}\otimes(\boldsymbol{U}</em>}^{\top}(d\boldsymbol{W})\boldsymbol{V<em :r_=":r]" _:r_="[:r,">{[:, :r]}\boldsymbol{\Sigma}</em>} + \boldsymbol{\Sigma<em :r_=":r]" _:_="[:,">{[:r, :r]}\boldsymbol{V}</em>}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U<em :r_=":r]" _:_="[:,">{[:, :r]})) \\\[6pt]<br />
&amp;\,\qquad \color{orange}{+ (\boldsymbol{I} - \boldsymbol{U}</em>}\boldsymbol{U<em :r_=":r]" _:_="[:,">{[:, :r]}^{\top})(d\boldsymbol{W})\boldsymbol{V}</em>}\boldsymbol{\Sigma<em _:_="[:," r:_="r:]">{[:r, :r]}^{-1}}<br />
\end{aligned}\end{equation}<br />
è¿™å°±å°†$d\boldsymbol{U}</em>}$è¡¨ç¤ºæˆäº†$\boldsymbol{U<em :r_=":r]" _:r_="[:r,">{[:, :r]},\boldsymbol{\Sigma}</em>},\boldsymbol{V<em :r_=":r]" _:_="[:,">{[:, :r]}$çš„å‡½æ•°ï¼Œåœ¨éé›¶å¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰çš„å‡è®¾ä¸‹ï¼Œä¸‰è€…æ˜¯å”¯ä¸€ç¡®å®šçš„ï¼Œæ‰€ä»¥$d\boldsymbol{U}</em>$å¤šå‡ºäº†æ©™è‰²è¿™ä¸€é¡¹ã€‚ç±»ä¼¼åœ°}$æ˜¯å”¯ä¸€ç¡®å®šçš„ï¼Œç›¸æ¯”å¼$\eqref{eq:dU<br />
\begin{equation}\begin{aligned}<br />
d\boldsymbol{V}<em :r_=":r]" _:_="[:,">{[:, :r]} =&amp;\, \boldsymbol{V}</em>}(\boldsymbol{F<em :r_=":r]" _:_="[:,">{[:r, :r]}\otimes(\boldsymbol{V}</em>}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U<em :r_=":r]" _:r_="[:r,">{[:, :r]}\boldsymbol{\Sigma}</em>} + \boldsymbol{\Sigma<em :r_=":r]" _:_="[:,">{[:r, :r]}\boldsymbol{U}</em>}^{\top}(d\boldsymbol{W})\boldsymbol{V<em :r_=":r]" _:_="[:,">{[:, :r]})) \\\[6pt]<br />
&amp;\,\qquad \color{orange}{+ (\boldsymbol{I} - \boldsymbol{V}</em>}\boldsymbol{V<em :r_=":r]" _:_="[:,">{[:, :r]}^{\top})(d\boldsymbol{W})^{\top}\boldsymbol{U}</em>}\boldsymbol{\Sigma}_{[:r, :r]}^{-1}<br />
\end{aligned}\end{equation}</p>
<h2 id="_10">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡è¾ƒä¸ºè¯¦ç»†åœ°æ¨å¯¼äº†SVDçš„æ±‚å¯¼å…¬å¼ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10878">https://spaces.ac.cn/archives/10878</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Apr. 26, 2025). ã€ŠSVDçš„å¯¼æ•° ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10878">https://spaces.ac.cn/archives/10878</a></p>
<p>@online{kexuefm-10878,<br />
title={SVDçš„å¯¼æ•°},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Apr},<br />
url={\url{https://spaces.ac.cn/archives/10878}},<br />
} </p>
<hr />
<h2 id="_11">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚å°†å¯¹SVDå¯¼æ•°è¿›è¡Œæè¯¦ç»†çš„æ•°å­¦æ¨å¯¼ï¼Œä»å¤šä¸ªè§’åº¦æ·±å…¥ç†è§£è¿™ä¸€é‡è¦ç»“æœã€‚æˆ‘ä»¬å°†æ¶µç›–å¾®ç§¯åˆ†ã€çŸ©é˜µåˆ†æã€æ¢¯åº¦è®¡ç®—ç­‰å¤šä¸ªè§†è§’ï¼Œå¹¶è®¨è®ºé€€åŒ–æƒ…å†µã€æ‰°åŠ¨ç†è®ºã€æ•°å€¼ç¨³å®šæ€§ç­‰å…³é”®é—®é¢˜ã€‚</p>
<h3 id="svd">ä¸€ã€SVDåˆ†è§£çš„å¾®åˆ†ç†è®ºåŸºç¡€</h3>
<h4 id="11">1.1 çŸ©é˜µå¾®åˆ†çš„åŸºæœ¬æ¦‚å¿µ</h4>
<p>å¯¹äºçŸ©é˜µå‡½æ•°$\boldsymbol{W}(t)$ï¼Œå…¶å¾®åˆ†å®šä¹‰ä¸ºï¼š
$$d\boldsymbol{W} = \lim_{\epsilon\to 0}\frac{\boldsymbol{W}(t+\epsilon) - \boldsymbol{W}(t)}{\epsilon}dt$$</p>
<p>è¿™ä¸ªå®šä¹‰å¯ä»¥æ¨å¹¿åˆ°çŸ©é˜µå€¼å‡½æ•°ã€‚å…³é”®æ€§è´¨åŒ…æ‹¬ï¼š</p>
<p><strong>æ€§è´¨1ï¼ˆä¹˜ç§¯æ³•åˆ™ï¼‰</strong>ï¼šå¯¹äºçŸ©é˜µä¹˜ç§¯$\boldsymbol{W} = \boldsymbol{A}\boldsymbol{B}\boldsymbol{C}$ï¼Œæœ‰ï¼š
$$d\boldsymbol{W} = (d\boldsymbol{A})\boldsymbol{B}\boldsymbol{C} + \boldsymbol{A}(d\boldsymbol{B})\boldsymbol{C} + \boldsymbol{A}\boldsymbol{B}(d\boldsymbol{C})$$</p>
<p><strong>æ€§è´¨2ï¼ˆè½¬ç½®æ³•åˆ™ï¼‰</strong>ï¼š$(d\boldsymbol{A})^{\top} = d(\boldsymbol{A}^{\top})$</p>
<p><strong>æ€§è´¨3ï¼ˆæ­£äº¤çº¦æŸï¼‰</strong>ï¼šè‹¥$\boldsymbol{U}^{\top}\boldsymbol{U} = \boldsymbol{I}$ï¼Œå¯¹ä¸¤è¾¹æ±‚å¾®åˆ†ï¼š
$$\boldsymbol{0} = d(\boldsymbol{U}^{\top}\boldsymbol{U}) = (d\boldsymbol{U})^{\top}\boldsymbol{U} + \boldsymbol{U}^{\top}(d\boldsymbol{U})$$</p>
<p>è¿™è¡¨æ˜$\boldsymbol{U}^{\top}(d\boldsymbol{U})$æ˜¯åå¯¹ç§°çŸ©é˜µï¼ˆskew-symmetricï¼‰ï¼Œå³ï¼š
$$[\boldsymbol{U}^{\top}(d\boldsymbol{U})]_{ij} = -[\boldsymbol{U}^{\top}(d\boldsymbol{U})]_{ji}$$</p>
<p>ç‰¹åˆ«åœ°ï¼Œå¯¹è§’çº¿å…ƒç´ å¿…ä¸ºé›¶ï¼š$[\boldsymbol{U}^{\top}(d\boldsymbol{U})]_{ii} = 0$ã€‚</p>
<h4 id="12-svd">1.2 ä»SVDåˆ†è§£åˆ°å¾®åˆ†æ–¹ç¨‹</h4>
<p>ç»™å®šSVDåˆ†è§£$\boldsymbol{W} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ï¼Œå¯¹ä¸¤è¾¹æ±‚å¾®åˆ†ï¼š
$$d\boldsymbol{W} = (d\boldsymbol{U})\boldsymbol{\Sigma}\boldsymbol{V}^{\top} + \boldsymbol{U}(d\boldsymbol{\Sigma})\boldsymbol{V}^{\top} + \boldsymbol{U}\boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}$$</p>
<p><strong>å…³é”®å˜æ¢</strong>ï¼šå·¦ä¹˜$\boldsymbol{U}^{\top}$ï¼Œå³ä¹˜$\boldsymbol{V}$ï¼Œåˆ©ç”¨æ­£äº¤æ€§$\boldsymbol{U}^{\top}\boldsymbol{U} = \boldsymbol{I}$å’Œ$\boldsymbol{V}^{\top}\boldsymbol{V} = \boldsymbol{I}$ï¼š
$$\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V} = \boldsymbol{U}^{\top}(d\boldsymbol{U})\boldsymbol{\Sigma} + d\boldsymbol{\Sigma} + \boldsymbol{\Sigma}(d\boldsymbol{V})^{\top}\boldsymbol{V}$$</p>
<p>è®°$\boldsymbol{\Omega}_U = \boldsymbol{U}^{\top}(d\boldsymbol{U})$å’Œ$\boldsymbol{\Omega}_V = (d\boldsymbol{V})^{\top}\boldsymbol{V}$ï¼Œå®ƒä»¬éƒ½æ˜¯åå¯¹ç§°çŸ©é˜µã€‚ä¸Šå¼å˜ä¸ºï¼š
$$\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V} = \boldsymbol{\Omega}_U\boldsymbol{\Sigma} + d\boldsymbol{\Sigma} + \boldsymbol{\Sigma}\boldsymbol{\Omega}_V$$</p>
<p>è¿™æ˜¯å…³äº$\boldsymbol{\Omega}_U$ã€$d\boldsymbol{\Sigma}$ã€$\boldsymbol{\Omega}_V$çš„Sylvesterå‹æ–¹ç¨‹ã€‚</p>
<h4 id="13">1.3 å¯¹è§’ä¸éå¯¹è§’åˆ†ç¦»æŠ€æœ¯</h4>
<p>åˆ©ç”¨Hadamardç§¯ï¼ˆelement-wise productï¼‰$\otimes$ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†ç¦»æ–¹ç¨‹çš„å¯¹è§’å’Œéå¯¹è§’éƒ¨åˆ†ã€‚</p>
<p>å®šä¹‰ï¼š
- $\boldsymbol{I}$ï¼šå•ä½çŸ©é˜µï¼ˆå¯¹è§’å…ƒç´ ä¸º1ï¼Œéå¯¹è§’å…ƒç´ ä¸º0ï¼‰
- $\bar{\boldsymbol{I}}$ï¼šå•ä½çŸ©é˜µçš„è¡¥ï¼ˆå¯¹è§’å…ƒç´ ä¸º0ï¼Œéå¯¹è§’å…ƒç´ ä¸º1ï¼‰</p>
<p>æ˜¾ç„¶$\boldsymbol{I} + \bar{\boldsymbol{I}} = \boldsymbol{J}$ï¼ˆå…¨1çŸ©é˜µï¼‰ã€‚</p>
<p><strong>å¯¹è§’éƒ¨åˆ†</strong>ï¼šç”±äº$\boldsymbol{\Omega}_U$å’Œ$\boldsymbol{\Omega}_V$çš„å¯¹è§’å…ƒç´ ä¸ºé›¶ï¼Œå¯¹è§’é˜µ$\boldsymbol{\Sigma}$çš„éå¯¹è§’å…ƒç´ ä¸ºé›¶ï¼š
$$\boldsymbol{I}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}) = \boldsymbol{I}\otimes(d\boldsymbol{\Sigma}) = d\boldsymbol{\Sigma}$$</p>
<p>å†™æˆåˆ†é‡å½¢å¼ï¼š
$$d\sigma_i = [\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}]_{ii} = \boldsymbol{u}_i^{\top}(d\boldsymbol{W})\boldsymbol{v}_i$$</p>
<p>è¿™å°±æ˜¯<strong>å¥‡å¼‚å€¼çš„å¾®åˆ†å…¬å¼</strong>ã€‚</p>
<p><strong>éå¯¹è§’éƒ¨åˆ†</strong>ï¼š
$$\bar{\boldsymbol{I}}\otimes(\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}) = \bar{\boldsymbol{I}}\otimes(\boldsymbol{\Omega}_U\boldsymbol{\Sigma} + \boldsymbol{\Sigma}\boldsymbol{\Omega}_V)$$</p>
<p>å±•å¼€ä¸ºåˆ†é‡å½¢å¼ï¼ˆ$i\neq j$ï¼‰ï¼š
$$[\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}]_{ij} = [\boldsymbol{\Omega}_U]_{ij}\sigma_j + \sigma_i[\boldsymbol{\Omega}_V]_{ij}$$</p>
<h3 id="_12">äºŒã€å¥‡å¼‚å€¼æ¢¯åº¦çš„æ·±å…¥åˆ†æ</h3>
<h4 id="21">2.1 å¥‡å¼‚å€¼æ¢¯åº¦çš„å‡ ä½•æ„ä¹‰</h4>
<p>ä»$d\sigma_i = \boldsymbol{u}_i^{\top}(d\boldsymbol{W})\boldsymbol{v}_i$å¯ä»¥ç«‹å³å¾—å‡ºï¼š
$$\frac{\partial \sigma_i}{\partial W_{jk}} = u_{ji}v_{ki}$$</p>
<p>ä»¥çŸ©é˜µå½¢å¼ï¼š
$$\nabla_{\boldsymbol{W}}\sigma_i = \boldsymbol{u}_i\boldsymbol{v}_i^{\top}$$</p>
<p><strong>å‡ ä½•è§£é‡Š</strong>ï¼šè¿™æ˜¯ä¸€ä¸ªç§©1çŸ©é˜µï¼Œå…¶æ–¹å‘ç”±å·¦å³å¥‡å¼‚å‘é‡å¼ æˆã€‚ç‰©ç†æ„ä¹‰æ˜¯ï¼šæ²¿ç€$\boldsymbol{u}_i\boldsymbol{v}_i^{\top}$æ–¹å‘æ‰°åŠ¨çŸ©é˜µ$\boldsymbol{W}$ï¼Œä¼šæœ€å¤§ç¨‹åº¦åœ°å¢åŠ ç¬¬$i$ä¸ªå¥‡å¼‚å€¼ã€‚</p>
<h4 id="22">2.2 è°±èŒƒæ•°çš„æ¢¯åº¦ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰</h4>
<p>è°±èŒƒæ•°å®šä¹‰ä¸º$|\boldsymbol{W}|_2 = \sigma_1 = \max_i \sigma_i$ã€‚å…¶æ¢¯åº¦ä¸ºï¼š
$$\nabla_{\boldsymbol{W}}\|\boldsymbol{W}\|_2 = \boldsymbol{u}_1\boldsymbol{v}_1^{\top}$$</p>
<p>è¿™åœ¨æ·±åº¦å­¦ä¹ ä¸­éå¸¸é‡è¦ï¼Œç‰¹åˆ«æ˜¯åœ¨<strong>è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰</strong>ä¸­ã€‚</p>
<p><strong>åº”ç”¨ï¼šè°±å½’ä¸€åŒ–å±‚</strong></p>
<p>åœ¨GANç­‰æ¨¡å‹ä¸­ï¼Œä¸ºäº†Lipschitzçº¦æŸï¼Œéœ€è¦å¯¹æƒé‡çŸ©é˜µè¿›è¡Œè°±å½’ä¸€åŒ–ï¼š
$$\bar{\boldsymbol{W}} = \frac{\boldsymbol{W}}{\|\boldsymbol{W}\|_2}$$</p>
<p>å…¶æ¢¯åº¦ä¸ºï¼ˆä½¿ç”¨å•†æ³•åˆ™ï¼‰ï¼š
$$\nabla_{\boldsymbol{W}}\mathcal{L}(\bar{\boldsymbol{W}}) = \frac{1}{\sigma_1}(\nabla_{\bar{\boldsymbol{W}}}\mathcal{L}) - \frac{1}{\sigma_1^2}(\nabla_{\bar{\boldsymbol{W}}}\mathcal{L}:\boldsymbol{W})\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$$</p>
<p>å…¶ä¸­$\boldsymbol{A}:\boldsymbol{B} = \text{tr}(\boldsymbol{A}^{\top}\boldsymbol{B})$æ˜¯Frobeniuså†…ç§¯ã€‚</p>
<h4 id="23">2.3 æ ¸èŒƒæ•°çš„æ¢¯åº¦ï¼ˆæ‰€æœ‰å¥‡å¼‚å€¼ä¹‹å’Œï¼‰</h4>
<p>æ ¸èŒƒæ•°ï¼ˆnuclear normï¼‰å®šä¹‰ä¸º$|\boldsymbol{W}|_* = \sum_i \sigma_i$ã€‚å…¶æ¢¯åº¦ä¸ºï¼š
$$\nabla_{\boldsymbol{W}}\|\boldsymbol{W}\|_* = \sum_i \boldsymbol{u}_i\boldsymbol{v}_i^{\top} = \boldsymbol{U}\boldsymbol{V}^{\top}$$</p>
<p>è¿™æ°å¥½æ˜¯çŸ©é˜µçš„"ç¬¦å·å‡½æ•°"$\text{msign}(\boldsymbol{W})$ï¼Œåœ¨ä½ç§©ä¼˜åŒ–ä¸­æ‰®æ¼”é‡è¦è§’è‰²ã€‚</p>
<h3 id="_13">ä¸‰ã€å¥‡å¼‚å‘é‡æ¢¯åº¦çš„æ±‚è§£</h3>
<h4 id="31-sylvester">3.1 Sylvesteræ–¹ç¨‹çš„æ±‚è§£ç­–ç•¥</h4>
<p>å›åˆ°éå¯¹è§’æ–¹ç¨‹ï¼ˆ$i\neq j$ï¼‰ï¼š
$$[\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}]_{ij} = [\boldsymbol{\Omega}_U]_{ij}\sigma_j + \sigma_i[\boldsymbol{\Omega}_V]_{ij}$$</p>
<p><strong>ç›®æ ‡</strong>ï¼šæ±‚è§£$\boldsymbol{\Omega}_U$å’Œ$\boldsymbol{\Omega}_V$ã€‚</p>
<p><strong>æ–¹æ³•1ï¼šç›´æ¥æ¶ˆå…ƒ</strong></p>
<p>åˆ©ç”¨è½¬ç½®å…³ç³»ã€‚å¯¹åŸæ–¹ç¨‹è½¬ç½®ï¼š
$$[\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}]_{ij} = [\boldsymbol{\Omega}_V^{\top}]_{ij}\sigma_j + \sigma_i[\boldsymbol{\Omega}_U^{\top}]_{ij}$$</p>
<p>ç”±åå¯¹ç§°æ€§$\boldsymbol{\Omega}_U^{\top} = -\boldsymbol{\Omega}_U$å’Œ$\boldsymbol{\Omega}_V^{\top} = -\boldsymbol{\Omega}_V$ï¼š
$$[\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}]_{ij} = -[\boldsymbol{\Omega}_V]_{ij}\sigma_j - \sigma_i[\boldsymbol{\Omega}_U]_{ij}$$</p>
<p>ç°åœ¨æˆ‘ä»¬æœ‰ä¸¤ä¸ªæ–¹ç¨‹æ¶ˆé™¤ä¸€ä¸ªæœªçŸ¥æ•°ã€‚</p>
<p><strong>æ¶ˆå»$\boldsymbol{\Omega}_V$</strong>ï¼šåŸæ–¹ç¨‹ä¹˜ä»¥$\sigma_i$åŠ ä¸Šè½¬ç½®æ–¹ç¨‹ä¹˜ä»¥$\sigma_j$ï¼š
$$\sigma_i[\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}]_{ij} + \sigma_j[\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}]_{ij} = [\boldsymbol{\Omega}_U]_{ij}(\sigma_i\sigma_j - \sigma_i\sigma_j) + \sigma_i^2[\boldsymbol{\Omega}_V]_{ij} - \sigma_j^2[\boldsymbol{\Omega}_V]_{ij}$$</p>
<p>ç®€åŒ–ä¸ºï¼š
$$\sigma_i[\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}]_{ij} + \sigma_j[\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}]_{ij} = (\sigma_i^2 - \sigma_j^2)[\boldsymbol{\Omega}_V]_{ij}$$</p>
<p>å› æ­¤ï¼š
$$[\boldsymbol{\Omega}_V]_{ij} = \frac{\sigma_i[\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V}]_{ij} + \sigma_j[\boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}]_{ij}}{\sigma_i^2 - \sigma_j^2}$$</p>
<p>ä»¥çŸ©é˜µå½¢å¼ï¼ˆ$i\neq j$ï¼‰ï¼š
$$\boldsymbol{\Omega}_V = \boldsymbol{F}\otimes(\boldsymbol{\Sigma}\boldsymbol{U}^{\top}(d\boldsymbol{W})\boldsymbol{V} + \boldsymbol{V}^{\top}(d\boldsymbol{W})^{\top}\boldsymbol{U}\boldsymbol{\Sigma})$$</p>
<p>å…¶ä¸­$\boldsymbol{F}<em ii="ii">{ij} = \frac{1}{\sigma_j^2 - \sigma_i^2}$ï¼ˆ$i\neq j$ï¼‰ï¼Œ$\boldsymbol{F}</em> = 0$ã€‚</p>
<p><strong>æ¢å¤$d\boldsymbol{V}$</strong>ï¼šç”±$\boldsymbol{\Omega}_V = (d\boldsymbol{V})^{\top}\boldsymbol{V}$ï¼Œä¸¤è¾¹å³ä¹˜$\boldsymbol{V}^{\top}$ï¼š
$$(d\boldsymbol{V})^{\top} = \boldsymbol{\Omega}_V\boldsymbol{V}^{\top}$$</p>
<p>è½¬ç½®å¾—ï¼š
$$d\boldsymbol{V} = \boldsymbol{V}\boldsymbol{\Omega}_V^{\top}$$</p>
<p>ç±»ä¼¼åœ°å¯å¾—$d\boldsymbol{U} = \boldsymbol{U}\boldsymbol{\Omega}_U^{\top}$ã€‚</p>
<h4 id="32">3.2 çŸ©é˜µä¹˜æ³•çš„ç®€åŒ–è¡¨ç¤º</h4>
<p>æ³¨æ„åˆ°ï¼š
$$\boldsymbol{\Omega}_U\boldsymbol{\Sigma} - \boldsymbol{\Sigma}\boldsymbol{\Omega}_U = \boldsymbol{E}\otimes\boldsymbol{\Omega}_U$$</p>
<p>å…¶ä¸­$\boldsymbol{E}_{ij} = \sigma_j - \sigma_i$ã€‚è¿™æ˜¯å› ä¸ºï¼š
$$[\boldsymbol{\Omega}_U\boldsymbol{\Sigma}]_{ij} = [\boldsymbol{\Omega}_U]_{ij}\sigma_j$$
$$[\boldsymbol{\Sigma}\boldsymbol{\Omega}_U]_{ij} = \sigma_i[\boldsymbol{\Omega}_U]_{ij}$$
$$[\boldsymbol{\Omega}_U\boldsymbol{\Sigma} - \boldsymbol{\Sigma}\boldsymbol{\Omega}_U]_{ij} = (\sigma_j - \sigma_i)[\boldsymbol{\Omega}_U]_{ij}$$</p>
<p>ç±»ä¼¼åœ°ï¼š
$$\boldsymbol{\Omega}_U\boldsymbol{\Sigma}^2 - \boldsymbol{\Sigma}^2\boldsymbol{\Omega}_U = (\sigma_j^2 - \sigma_i^2)\boldsymbol{\Omega}_U = \boldsymbol{E}_2\otimes\boldsymbol{\Omega}_U$$</p>
<p>å…¶ä¸­$\boldsymbol{E}_2 = \boldsymbol{E}\odot\boldsymbol{E}$ï¼ˆè¿™é‡Œ$\odot$è¡¨ç¤ºelement-wiseä¹˜æ³•ï¼Œå®é™…ä¸Šå°±æ˜¯å¹³æ–¹ï¼‰ã€‚</p>
<h3 id="_14">å››ã€é€€åŒ–æƒ…å†µï¼šé‡å¤å¥‡å¼‚å€¼çš„å¤„ç†</h3>
<h4 id="41">4.1 é‡å¤å¥‡å¼‚å€¼çš„ä¸å¯å¯¼æ€§</h4>
<p><strong>å®šç†</strong>ï¼šè‹¥$\boldsymbol{W}$å­˜åœ¨é‡å¤å¥‡å¼‚å€¼ï¼ˆå³$\sigma_i = \sigma_j$å¯¹æŸäº›$i\neq j$ï¼‰ï¼Œåˆ™SVDåˆ†è§£ä¸å”¯ä¸€ï¼Œå¯¼æ•°ä¸å­˜åœ¨ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼šå‡è®¾$\sigma_i = \sigma_j$ï¼Œå¯¹åº”çš„å¥‡å¼‚å‘é‡ä¸º$\boldsymbol{u}_i, \boldsymbol{u}_j$å’Œ$\boldsymbol{v}_i, \boldsymbol{v}_j$ã€‚é‚£ä¹ˆå¯¹ä»»æ„æ­£äº¤çŸ©é˜µ$\boldsymbol{Q}\in\mathbb{R}^{2\times 2}$ï¼š
$$\boldsymbol{W} = \cdots + \sigma_i\boldsymbol{u}_i\boldsymbol{v}_i^{\top} + \sigma_j\boldsymbol{u}_j\boldsymbol{v}_j^{\top} + \cdots$$</p>
<p>å¯ä»¥æ›¿æ¢ä¸ºï¼š
$$\boldsymbol{W} = \cdots + \sigma_i(\boldsymbol{u}_i, \boldsymbol{u}_j)\boldsymbol{Q}\begin{pmatrix}\boldsymbol{v}_i^{\top} \\ \boldsymbol{v}_j^{\top}\end{pmatrix} + \cdots$$</p>
<p>è¿™ç»™å‡ºæ— ç©·å¤šä¸ªç­‰ä»·çš„SVDåˆ†è§£ã€‚ç”±äºåˆ†è§£ä¸å”¯ä¸€ï¼Œå¯¼æ•°æ— æ³•å®šä¹‰ã€‚</p>
<p>ä»å…¬å¼è§’åº¦ï¼Œ$\boldsymbol{F}_{ij} = \frac{1}{\sigma_j^2 - \sigma_i^2}$åœ¨$\sigma_i = \sigma_j$æ—¶å‡ºç°$0/0$å‹ä¸å®šå¼ï¼Œæ— æ³•è®¡ç®—ã€‚</p>
<h4 id="42-weyl">4.2 æ‰°åŠ¨è§†è§’ï¼šWeylä¸ç­‰å¼</h4>
<p><strong>Weylæ‰°åŠ¨å®šç†</strong>ï¼šè®¾$\boldsymbol{W}$å’Œ$\boldsymbol{W} + \boldsymbol{E}$çš„å¥‡å¼‚å€¼åˆ†åˆ«ä¸º$\sigma_1\geq\cdots\geq\sigma_n$å’Œ$\tilde{\sigma}_1\geq\cdots\geq\tilde{\sigma}_n$ï¼Œåˆ™ï¼š
$$|\sigma_i - \tilde{\sigma}_i| \leq \|\boldsymbol{E}\|_2$$</p>
<p>æ›´ç²¾ç¡®çš„Weylä¸ç­‰å¼ï¼š
$$|\sigma_i(\boldsymbol{W}) - \sigma_i(\boldsymbol{W}+\boldsymbol{E})| \leq \sigma_1(\boldsymbol{E})$$</p>
<p><strong>æ¨è®º</strong>ï¼šè‹¥$\sigma_i &gt; \sigma_{i+1}$ä¸”é—´éš™$\delta = \sigma_i - \sigma_{i+1} &gt; 0$ï¼Œé‚£ä¹ˆå½“$|\boldsymbol{E}|_2 &lt; \delta/2$æ—¶ï¼Œæ‰°åŠ¨åçš„ç¬¬$i$ä¸ªå¥‡å¼‚å€¼ä»ç„¶ä¸å…¶ä»–å¥‡å¼‚å€¼åˆ†ç¦»ï¼Œä¿æŒè‰¯å®šæ€§ã€‚</p>
<h4 id="43">4.3 éƒ¨åˆ†å¯¼æ•°çš„å­˜åœ¨æ€§</h4>
<p>å³ä½¿å­˜åœ¨é‡å¤å¥‡å¼‚å€¼ï¼ŒæŸäº›éƒ¨åˆ†å¯¼æ•°ä»ç„¶å­˜åœ¨ï¼š</p>
<p><strong>å‘½é¢˜</strong>ï¼šè‹¥ä»…è¦æ±‚$\nabla_{\boldsymbol{W}}\sigma_1$ï¼ˆæœ€å¤§å¥‡å¼‚å€¼çš„æ¢¯åº¦ï¼‰ï¼Œåˆ™åªéœ€$\sigma_1 &gt; \sigma_2$ï¼Œè€Œä¸éœ€è¦æ‰€æœ‰å¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼š$d\sigma_1 = \boldsymbol{u}<em ij="ij">1^{\top}(d\boldsymbol{W})\boldsymbol{v}_1$çš„æ¨å¯¼åªä¾èµ–äºå¯¹è§’å…ƒç´ ï¼Œä¸æ¶‰åŠ$\boldsymbol{F}</em>$çš„è®¡ç®—ã€‚å³ä½¿$\sigma_2 = \sigma_3$ï¼Œä¹Ÿä¸å½±å“$\sigma_1$çš„æ¢¯åº¦ã€‚</p>
<p>ç±»ä¼¼åœ°ï¼Œå‰$k$ä¸ªå¥‡å¼‚å€¼$\sigma_1,\ldots,\sigma_k$çš„æ¢¯åº¦å­˜åœ¨ï¼Œåªéœ€è¿™$k$ä¸ªå¥‡å¼‚å€¼äº’å¼‚ï¼Œè€Œä¸ç®¡$\sigma_{k+1},\ldots,\sigma_n$æ˜¯å¦é‡å¤ã€‚</p>
<h3 id="_15">äº”ã€éšå‡½æ•°å®šç†çš„åº”ç”¨</h3>
<h4 id="51-svd">5.1 SVDä½œä¸ºéšå‡½æ•°</h4>
<p>å°†SVDè§†ä¸ºéšå‡½æ•°å…³ç³»ï¼š
$$\boldsymbol{G}(\boldsymbol{W}, \boldsymbol{U}, \boldsymbol{\Sigma}, \boldsymbol{V}) = \boldsymbol{W} - \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top} = \boldsymbol{0}$$</p>
<p>åŠ ä¸Šæ­£äº¤çº¦æŸï¼š
$$\boldsymbol{H}_U(\boldsymbol{U}) = \boldsymbol{U}^{\top}\boldsymbol{U} - \boldsymbol{I} = \boldsymbol{0}$$
$$\boldsymbol{H}_V(\boldsymbol{V}) = \boldsymbol{V}^{\top}\boldsymbol{V} - \boldsymbol{I} = \boldsymbol{0}$$</p>
<p><strong>éšå‡½æ•°å®šç†</strong>ï¼šè‹¥JacobiançŸ©é˜µ$\frac{\partial(\boldsymbol{G}, \boldsymbol{H}_U, \boldsymbol{H}_V)}{\partial(\boldsymbol{U}, \boldsymbol{\Sigma}, \boldsymbol{V})}$å¯é€†ï¼Œåˆ™å­˜åœ¨å±€éƒ¨å¾®åˆ†æ˜ å°„ï¼š
$$\boldsymbol{U} = \boldsymbol{U}(\boldsymbol{W}),\quad \boldsymbol{\Sigma} = \boldsymbol{\Sigma}(\boldsymbol{W}),\quad \boldsymbol{V} = \boldsymbol{V}(\boldsymbol{W})$$</p>
<h4 id="52">5.2 å¯é€†æ€§æ¡ä»¶</h4>
<p>Jacobianå¯é€†ç­‰ä»·äºå¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰ã€‚è¿™å¯ä»¥ä»Sylvesteræ–¹ç¨‹çš„å¯è§£æ€§çœ‹å‡ºï¼š</p>
<p>è€ƒè™‘çº¿æ€§æ–¹ç¨‹$\boldsymbol{A}\boldsymbol{X} - \boldsymbol{X}\boldsymbol{B} = \boldsymbol{C}$ï¼Œå…¶è§£å­˜åœ¨ä¸”å”¯ä¸€å½“ä¸”ä»…å½“$\boldsymbol{A}$å’Œ$\boldsymbol{B}$æ— å…¬å…±ç‰¹å¾å€¼ã€‚</p>
<p>åœ¨æˆ‘ä»¬çš„æƒ…å†µä¸‹ï¼Œ$\boldsymbol{A} = \text{diag}(\sigma_1^2,\ldots,\sigma_n^2)$ï¼Œ$\boldsymbol{B} = \text{diag}(\sigma_1^2,\ldots,\sigma_n^2)$ï¼Œå…¬å…±ç‰¹å¾å€¼æ„å‘³ç€$\sigma_i^2 = \sigma_j^2$ï¼Œå³$\sigma_i = \sigma_j$ï¼ˆå› å¥‡å¼‚å€¼éè´Ÿï¼‰ã€‚</p>
<p>å› æ­¤ï¼Œ<strong>å¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰</strong>æ˜¯SVDå¯å¾®çš„å……è¦æ¡ä»¶ã€‚</p>
<h3 id="_16">å…­ã€å˜åˆ†æ³•æ¨å¯¼</h3>
<h4 id="61">6.1 ä¼˜åŒ–è§†è§’</h4>
<p>ä»ä¼˜åŒ–è§’åº¦ç†è§£SVDï¼šæœ€å¤§å¥‡å¼‚å€¼å¯ä»¥å†™æˆä¼˜åŒ–é—®é¢˜ï¼š
$$\sigma_1 = \max_{\|\boldsymbol{u}\|=1, \|\boldsymbol{v}\|=1} \boldsymbol{u}^{\top}\boldsymbol{W}\boldsymbol{v}$$</p>
<p><strong>å˜åˆ†æ³•</strong>ï¼šå¯¹ä¼˜åŒ–é—®é¢˜æ±‚å¯¼ï¼Œè®¾Lagrangianï¼š
$$\mathcal{L}(\boldsymbol{u}, \boldsymbol{v}, \lambda, \mu) = \boldsymbol{u}^{\top}\boldsymbol{W}\boldsymbol{v} - \frac{\lambda}{2}(\boldsymbol{u}^{\top}\boldsymbol{u} - 1) - \frac{\mu}{2}(\boldsymbol{v}^{\top}\boldsymbol{v} - 1)$$</p>
<p>KKTæ¡ä»¶ï¼š
$$\frac{\partial\mathcal{L}}{\partial\boldsymbol{u}} = \boldsymbol{W}\boldsymbol{v} - \lambda\boldsymbol{u} = \boldsymbol{0} \quad\Rightarrow\quad \boldsymbol{W}\boldsymbol{v} = \lambda\boldsymbol{u}$$
$$\frac{\partial\mathcal{L}}{\partial\boldsymbol{v}} = \boldsymbol{W}^{\top}\boldsymbol{u} - \mu\boldsymbol{v} = \boldsymbol{0} \quad\Rightarrow\quad \boldsymbol{W}^{\top}\boldsymbol{u} = \mu\boldsymbol{v}$$</p>
<p>ç”±$\boldsymbol{W}\boldsymbol{v} = \lambda\boldsymbol{u}$å¾—$\boldsymbol{W}^{\top}\boldsymbol{W}\boldsymbol{v} = \lambda\boldsymbol{W}^{\top}\boldsymbol{u} = \lambda\mu\boldsymbol{v}$ï¼Œæ•…$\lambda\mu = \sigma_1^2$ï¼Œ$\lambda = \mu = \sigma_1$ã€‚</p>
<h4 id="62-boldsymbolw">6.2 å¯¹$\boldsymbol{W}$çš„çµæ•åº¦åˆ†æ</h4>
<p>å¯¹KKTæ¡ä»¶å…³äº$\boldsymbol{W}$æ±‚å¾®åˆ†ï¼š
$$d\boldsymbol{W}\cdot\boldsymbol{v} + \boldsymbol{W}\cdot d\boldsymbol{v} = (d\sigma_1)\boldsymbol{u} + \sigma_1(d\boldsymbol{u})$$
$$(d\boldsymbol{W})^{\top}\boldsymbol{u} + \boldsymbol{W}^{\top}(d\boldsymbol{u}) = (d\sigma_1)\boldsymbol{v} + \sigma_1(d\boldsymbol{v})$$</p>
<p>å·¦ä¹˜ç¬¬ä¸€å¼ä»¥$\boldsymbol{u}^{\top}$ï¼š
$$\boldsymbol{u}^{\top}(d\boldsymbol{W})\boldsymbol{v} + \boldsymbol{u}^{\top}\boldsymbol{W}(d\boldsymbol{v}) = d\sigma_1 + \sigma_1\boldsymbol{u}^{\top}(d\boldsymbol{u})$$</p>
<p>ç”±æ­£äº¤çº¦æŸ$\boldsymbol{u}^{\top}(d\boldsymbol{u}) = 0$å’Œ$\boldsymbol{u}^{\top}\boldsymbol{W} = \sigma_1\boldsymbol{v}^{\top}$ï¼š
$$\boldsymbol{u}^{\top}(d\boldsymbol{W})\boldsymbol{v} + \sigma_1\boldsymbol{v}^{\top}(d\boldsymbol{v}) = d\sigma_1$$</p>
<p>åˆ$\boldsymbol{v}^{\top}(d\boldsymbol{v}) = 0$ï¼Œæ•…ï¼š
$$d\sigma_1 = \boldsymbol{u}^{\top}(d\boldsymbol{W})\boldsymbol{v}$$</p>
<p>è¿™å†æ¬¡éªŒè¯äº†å¥‡å¼‚å€¼å¾®åˆ†å…¬å¼ï¼</p>
<h3 id="_17">ä¸ƒã€æ•°å€¼ç¨³å®šæ€§ä¸å®ç°ç®—æ³•</h3>
<h4 id="71">7.1 ç—…æ€é—®é¢˜ï¼šå¥‡å¼‚å€¼æ¥è¿‘çš„æƒ…å†µ</h4>
<p>å½“$\sigma_i\approx\sigma_j$æ—¶ï¼Œ$\boldsymbol{F}_{ij} = \frac{1}{\sigma_j^2 - \sigma_i^2}$ä¼šå˜å¾—æå¤§ï¼Œå¯¼è‡´æ•°å€¼ä¸ç¨³å®šã€‚</p>
<p><strong>é—®é¢˜æ ¹æº</strong>ï¼š$\boldsymbol{F}_{ij}$çš„å¤§å°å†³å®šäº†æ¢¯åº¦çš„magnitudeã€‚å®šä¹‰æ¡ä»¶æ•°ï¼š
$$\kappa_{ij} = \frac{\max(\sigma_i, \sigma_j)}{\|\sigma_i - \sigma_j\|}$$</p>
<p>å½“$\kappa_{ij}\to\infty$æ—¶ï¼Œé—®é¢˜å˜ä¸ºç—…æ€ã€‚</p>
<h4 id="72-taylor">7.2 Taylorè¿‘ä¼¼æ–¹æ³•</h4>
<p>å¯¹äº$\sigma_i &gt; \sigma_j$ï¼Œå¯ä»¥è¿›è¡ŒTaylorå±•å¼€ï¼š
$$\frac{1}{\sigma_i^2 - \sigma_j^2} = \frac{1}{\sigma_i^2}\cdot\frac{1}{1 - (\sigma_j/\sigma_i)^2}$$</p>
<p>è®¾$r = \sigma_j/\sigma_i &lt; 1$ï¼Œåˆ™ï¼š
$$\frac{1}{1 - r^2} = 1 + r^2 + r^4 + \cdots = \sum_{k=0}^{\infty}r^{2k}$$</p>
<p>æˆªæ–­è‡³$N$é˜¶ï¼š
$$\frac{1}{\sigma_i^2 - \sigma_j^2}\approx\frac{1}{\sigma_i^2}\sum_{k=0}^{N}\left(\frac{\sigma_j}{\sigma_i}\right)^{2k}$$</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼šå½“$r$æ¥è¿‘1æ—¶ï¼Œçº§æ•°æ¯é¡¹å¤§å°ç›¸è¿‘ï¼Œä¸ä¼šå‡ºç°å•ä¸ªå·¨å¤§çš„é¡¹ã€‚</p>
<h4 id="73-pade">7.3 PadÃ©è¿‘ä¼¼</h4>
<p>PadÃ©è¿‘ä¼¼æ˜¯æœ‰ç†å‡½æ•°é€¼è¿‘ï¼š
$$\frac{1}{1-r^2}\approx\frac{P_m(r^2)}{Q_n(r^2)}$$</p>
<p>å…¶ä¸­$P_m$å’Œ$Q_n$æ˜¯å¤šé¡¹å¼ã€‚ä¾‹å¦‚$(m, n) = (1, 1)$æ—¶ï¼š
$$\frac{1}{1-r^2}\approx\frac{1 + \alpha r^2}{1 + \beta r^2}$$</p>
<p>é€šè¿‡åŒ¹é…Taylorç³»æ•°ç¡®å®š$\alpha, \beta$ã€‚PadÃ©è¿‘ä¼¼åœ¨æ•´ä¸ªåŒºé—´ä¸Šæ¯”Taylorå¤šé¡¹å¼æ›´ç²¾ç¡®ã€‚</p>
<h4 id="74">7.4 æˆªæ–­ä¸æ­£åˆ™åŒ–</h4>
<p>æœ€ç®€å•çš„æ–¹æ³•æ˜¯æˆªæ–­$\boldsymbol{F}_{ij}$ï¼š
$$\tilde{\boldsymbol{F}}_{ij} = \begin{cases}
\boldsymbol{F}_{ij}, & |\sigma_i^2 - \sigma_j^2| > \epsilon \\
0, & \text{otherwise}
\end{cases}$$</p>
<p>æˆ–ä½¿ç”¨è½¯æˆªæ–­ï¼ˆHuberå‹ï¼‰ï¼š
$$\tilde{\boldsymbol{F}}_{ij} = \frac{\sigma_j^2 - \sigma_i^2}{(\sigma_j^2 - \sigma_i^2)^2 + \epsilon^2}$$</p>
<p>è¿™åœ¨$\sigma_i\approx\sigma_j$æ—¶æä¾›å¹³æ»‘çš„è¿‡æ¸¡ã€‚</p>
<h4 id="75">7.5 å¹‚è¿­ä»£æ–¹æ³•</h4>
<p>å¯¹äºæœ€å¤§å¥‡å¼‚å€¼$\sigma_1$åŠå…¶å¥‡å¼‚å‘é‡$\boldsymbol{u}_1, \boldsymbol{v}_1$ï¼Œå¯ä»¥ç”¨å¹‚è¿­ä»£é¿å…å®Œæ•´SVDï¼š</p>
<p><strong>ç®—æ³•</strong>ï¼š
1. åˆå§‹åŒ–ï¼šéšæœº$\boldsymbol{v}^{(0)}$ï¼Œå½’ä¸€åŒ–
2. è¿­ä»£ï¼š
   $$\boldsymbol{u}^{(k)} = \frac{\boldsymbol{W}\boldsymbol{v}^{(k-1)}}{\|\boldsymbol{W}\boldsymbol{v}^{(k-1)}\|}$$
   $$\boldsymbol{v}^{(k)} = \frac{\boldsymbol{W}^{\top}\boldsymbol{u}^{(k)}}{\|\boldsymbol{W}^{\top}\boldsymbol{u}^{(k)}\|}$$
3. æ”¶æ•›åï¼š$\sigma_1 = |\boldsymbol{W}\boldsymbol{v}^{(\infty)}|$</p>
<p><strong>æ¢¯åº¦è®¡ç®—</strong>ï¼šå°†å¹‚è¿­ä»£åµŒå…¥è®¡ç®—å›¾ï¼Œè‡ªåŠ¨å¾®åˆ†è‡ªç„¶å¤„ç†æ¢¯åº¦ä¼ æ’­ã€‚è¿™é¿å…äº†æ˜¾å¼è®¡ç®—$\boldsymbol{F}_{ij}$ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š
- åªè®¡ç®—éœ€è¦çš„å¥‡å¼‚å€¼/å‘é‡
- æ•°å€¼ç¨³å®šï¼ˆé¿å…è¿‘ä¼¼å¥‡å¼‚å€¼çš„é™¤æ³•ï¼‰
- å¯å¾®ä¸”å¯åµŒå…¥ç«¯åˆ°ç«¯è®­ç»ƒ</p>
<h3 id="_18">å…«ã€æ·±åº¦å­¦ä¹ ä¸­çš„åº”ç”¨</h3>
<h4 id="81-spectral-normalization">8.1 è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼‰</h4>
<p>åœ¨GANä¸­ï¼Œåˆ¤åˆ«å™¨éœ€è¦æ»¡è¶³Lipschitzè¿ç»­æ€§ä»¥ç¨³å®šè®­ç»ƒã€‚å¯¹æƒé‡çŸ©é˜µ$\boldsymbol{W}$ï¼š
$$\bar{\boldsymbol{W}} = \frac{\boldsymbol{W}}{\sigma_1(\boldsymbol{W})}$$</p>
<p>åˆ™$|\bar{\boldsymbol{W}}|_2 = 1$ï¼Œä¿è¯$|f(\boldsymbol{x}) - f(\boldsymbol{y})| \leq |\boldsymbol{x} - \boldsymbol{y}|$ã€‚</p>
<p><strong>åå‘ä¼ æ’­</strong>ï¼š
$$\frac{\partial\mathcal{L}}{\partial\boldsymbol{W}} = \frac{1}{\sigma_1}\frac{\partial\mathcal{L}}{\partial\bar{\boldsymbol{W}}} - \frac{1}{\sigma_1^2}\left(\frac{\partial\mathcal{L}}{\partial\bar{\boldsymbol{W}}}:\boldsymbol{W}\right)\boldsymbol{u}_1\boldsymbol{v}_1^{\top}$$</p>
<p>å…¶ä¸­ç¬¬äºŒé¡¹æ˜¯å¯¹å½’ä¸€åŒ–å› å­çš„ä¿®æ­£ã€‚</p>
<p><strong>å®è·µæŠ€å·§</strong>ï¼š
- ä½¿ç”¨å¹‚è¿­ä»£ä¼°è®¡$\sigma_1$ï¼ˆé€šå¸¸1-2æ¬¡è¿­ä»£è¶³å¤Ÿï¼‰
- åœ¨è®­ç»ƒè¿‡ç¨‹ä¸­å¤ç”¨ä¸Šä¸€æ­¥çš„$\boldsymbol{u}_1, \boldsymbol{v}_1$ä½œä¸ºåˆå§‹å€¼
- ä»…åœ¨åˆ¤åˆ«å™¨ä¸­åº”ç”¨ï¼Œç”Ÿæˆå™¨ä¸éœ€è¦</p>
<h4 id="82">8.2 ä½ç§©æ­£åˆ™åŒ–</h4>
<p>åœ¨çŸ©é˜µåˆ†è§£ã€æ¨èç³»ç»Ÿä¸­ï¼Œå¸¸ç”¨æ ¸èŒƒæ•°æ­£åˆ™åŒ–ï¼š
$$\min_{\boldsymbol{W}} \mathcal{L}(\boldsymbol{W}) + \lambda\|\boldsymbol{W}\|_*$$</p>
<p>æ¢¯åº¦ä¸ºï¼š
$$\nabla_{\boldsymbol{W}}\mathcal{L} + \lambda\boldsymbol{U}\boldsymbol{V}^{\top}$$</p>
<p>è¿™ä¿ƒè¿›$\boldsymbol{W}$çš„ä½ç§©ç»“æ„ã€‚</p>
<h4 id="83-orthogonal-layers">8.3 æ­£äº¤åŒ–å±‚ï¼ˆOrthogonal Layersï¼‰</h4>
<p>åœ¨æŸäº›æ¶æ„ä¸­ï¼ˆå¦‚Transformerçš„attentionï¼‰ï¼Œå¸Œæœ›ä¿æŒæƒé‡æ­£äº¤æ€§ä»¥é¿å…æ¢¯åº¦æ¶ˆå¤±/çˆ†ç‚¸ã€‚</p>
<p>å¯ä»¥å‚æ•°åŒ–ä¸ºï¼š
$$\boldsymbol{W} = \boldsymbol{U}\boldsymbol{V}^{\top}$$</p>
<p>å…¶ä¸­$\boldsymbol{U}, \boldsymbol{V}$æ˜¯æ­£äº¤çŸ©é˜µã€‚é€šè¿‡SVDæŠ•å½±å®ç°ï¼š
$$\boldsymbol{W}_{\text{proj}} = \boldsymbol{U}\boldsymbol{V}^{\top},\quad \text{where } \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top} = \text{SVD}(\boldsymbol{W}_{\text{raw}})$$</p>
<p>æ¢¯åº¦è®¡ç®—éœ€è¦ç”¨åˆ°æœ¬æ–‡æ¨å¯¼çš„å…¬å¼ã€‚</p>
<h3 id="_19">ä¹ã€ä¸ç‰¹å¾å€¼åˆ†è§£å¯¼æ•°çš„å¯¹æ¯”</h3>
<h4 id="91">9.1 å¯¹ç§°çŸ©é˜µçš„ç‰¹æ®Šæƒ…å†µ</h4>
<p>å¯¹äºå¯¹ç§°æ­£å®šçŸ©é˜µ$\boldsymbol{W} = \boldsymbol{W}^{\top}$ï¼ŒSVDé€€åŒ–ä¸ºç‰¹å¾å€¼åˆ†è§£ï¼š
$$\boldsymbol{W} = \boldsymbol{V}\boldsymbol{\Lambda}\boldsymbol{V}^{\top}$$</p>
<p>å…¶ä¸­$\boldsymbol{\Lambda} = \text{diag}(\lambda_1,\ldots,\lambda_n)$æ˜¯ç‰¹å¾å€¼å¯¹è§’é˜µã€‚</p>
<p><strong>å¾®åˆ†æ–¹ç¨‹</strong>ï¼š
$$\boldsymbol{V}^{\top}(d\boldsymbol{W})\boldsymbol{V} = \boldsymbol{V}^{\top}(d\boldsymbol{V})\boldsymbol{\Lambda} + d\boldsymbol{\Lambda} + \boldsymbol{\Lambda}(d\boldsymbol{V})^{\top}\boldsymbol{V}$$</p>
<p>åˆ©ç”¨åå¯¹ç§°æ€§ï¼š
$$\boldsymbol{V}^{\top}(d\boldsymbol{W})\boldsymbol{V} = \boldsymbol{V}^{\top}(d\boldsymbol{V})\boldsymbol{\Lambda} + d\boldsymbol{\Lambda} - \boldsymbol{\Lambda}\boldsymbol{V}^{\top}(d\boldsymbol{V})$$</p>
<p><strong>å¯¹è§’éƒ¨åˆ†</strong>ï¼š
$$d\lambda_i = \boldsymbol{v}_i^{\top}(d\boldsymbol{W})\boldsymbol{v}_i$$</p>
<p><strong>éå¯¹è§’éƒ¨åˆ†</strong>ï¼ˆ$i\neq j$ï¼‰ï¼š
$$[\boldsymbol{V}^{\top}(d\boldsymbol{W})\boldsymbol{V}]_{ij} = [\boldsymbol{V}^{\top}(d\boldsymbol{V})]_{ij}(\lambda_j - \lambda_i)$$</p>
<p>è§£å¾—ï¼š
$$[\boldsymbol{V}^{\top}(d\boldsymbol{V})]_{ij} = \frac{[\boldsymbol{V}^{\top}(d\boldsymbol{W})\boldsymbol{V}]_{ij}}{\lambda_j - \lambda_i}$$</p>
<p>å®šä¹‰$\boldsymbol{K}<em ii="ii">{ij} = \frac{1}{\lambda_j - \lambda_i}$ï¼ˆ$i\neq j$ï¼‰ï¼Œ$\boldsymbol{K}</em> = 0$ï¼Œåˆ™ï¼š
$$d\boldsymbol{V} = \boldsymbol{V}(\boldsymbol{K}^{\top}\otimes(\boldsymbol{V}^{\top}(d\boldsymbol{W})\boldsymbol{V}))$$</p>
<h4 id="92">9.2 å…³é”®åŒºåˆ«</h4>
<table>
<thead>
<tr>
<th>ç‰¹å¾å€¼åˆ†è§£ï¼ˆå¯¹ç§°çŸ©é˜µï¼‰</th>
<th>SVDï¼ˆä¸€èˆ¬çŸ©é˜µï¼‰</th>
</tr>
</thead>
<tbody>
<tr>
<td>$\boldsymbol{W} = \boldsymbol{V}\boldsymbol{\Lambda}\boldsymbol{V}^{\top}$</td>
<td>$\boldsymbol{W} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$</td>
</tr>
<tr>
<td>å•ä¸ªæ­£äº¤çŸ©é˜µ$\boldsymbol{V}$</td>
<td>ä¸¤ä¸ªæ­£äº¤çŸ©é˜µ$\boldsymbol{U}, \boldsymbol{V}$</td>
</tr>
<tr>
<td>$\boldsymbol{K}_{ij} = \frac{1}{\lambda_j - \lambda_i}$</td>
<td>$\boldsymbol{F}_{ij} = \frac{1}{\sigma_j^2 - \sigma_i^2}$</td>
</tr>
<tr>
<td>è¦æ±‚$\lambda_i\neq\lambda_j$</td>
<td>è¦æ±‚$\sigma_i\neq\sigma_j$</td>
</tr>
<tr>
<td>å—çº¦æŸ$\boldsymbol{W} = \boldsymbol{W}^{\top}$</td>
<td>æ— çº¦æŸ</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨æ„</strong>ï¼šåœ¨å¯¹ç§°æƒ…å†µä¸‹ï¼Œå°†$\boldsymbol{U} = \boldsymbol{V}$, $\sigma_i = \lambda_i$ç›´æ¥ä»£å…¥SVDå…¬å¼ä¼š<strong>å¯¼è‡´é”™è¯¯</strong>ï¼Œå› ä¸ºï¼š
1. å¯¹$\boldsymbol{V}$æ±‚å¯¼æ—¶ï¼Œå®é™…ä¸Š$\boldsymbol{U}$å’Œ$\boldsymbol{V}$éƒ½åœ¨å˜ï¼Œå¯¼è‡´é‡å¤è®¡ç®—
2. å¯¹ç§°çº¦æŸ$\boldsymbol{W} = \boldsymbol{W}^{\top}$éœ€è¦é¢å¤–çš„å¯¹ç§°åŒ–æ“ä½œ</p>
<p>æ­£ç¡®åšæ³•æ˜¯ä»å¤´æ¨å¯¼å¯¹ç§°æƒ…å†µï¼Œæˆ–åœ¨æœ€ç»ˆæ¢¯åº¦ä¸Šåº”ç”¨å¯¹ç§°åŒ–$\text{sym}(\cdot) = \frac{1}{2}(\cdot + \cdot^{\top})$ã€‚</p>
<h3 id="_20">åã€ç†è®ºæ·±åŒ–ï¼šæ‰°åŠ¨å±•å¼€ä¸é«˜é˜¶å¯¼æ•°</h3>
<h4 id="101">10.1 ä¸€é˜¶æ‰°åŠ¨ç†è®º</h4>
<p>è€ƒè™‘æ‰°åŠ¨$\boldsymbol{W}(\epsilon) = \boldsymbol{W}_0 + \epsilon\boldsymbol{E}$ï¼Œå…¶SVDä¸º$\boldsymbol{U}(\epsilon)\boldsymbol{\Sigma}(\epsilon)\boldsymbol{V}(\epsilon)^{\top}$ã€‚</p>
<p><strong>Taylorå±•å¼€</strong>ï¼š
$$\sigma_i(\epsilon) = \sigma_i(0) + \epsilon\sigma_i'(0) + O(\epsilon^2)$$
$$\boldsymbol{u}_i(\epsilon) = \boldsymbol{u}_i(0) + \epsilon\boldsymbol{u}_i'(0) + O(\epsilon^2)$$
$$\boldsymbol{v}_i(\epsilon) = \boldsymbol{v}_i(0) + \epsilon\boldsymbol{v}_i'(0) + O(\epsilon^2)$$</p>
<p>ä»$\boldsymbol{W}(\epsilon) = \boldsymbol{U}(\epsilon)\boldsymbol{\Sigma}(\epsilon)\boldsymbol{V}(\epsilon)^{\top}$ï¼š
$$\boldsymbol{W}_0 + \epsilon\boldsymbol{E} = (\boldsymbol{U}_0 + \epsilon\boldsymbol{U}_0')(\boldsymbol{\Sigma}_0 + \epsilon\boldsymbol{\Sigma}_0')(\boldsymbol{V}_0 + \epsilon\boldsymbol{V}_0')^{\top} + O(\epsilon^2)$$</p>
<p>å±•å¼€å¹¶æ¯”è¾ƒ$\epsilon$çš„ç³»æ•°ï¼š
$$\boldsymbol{E} = \boldsymbol{U}_0'\boldsymbol{\Sigma}_0\boldsymbol{V}_0^{\top} + \boldsymbol{U}_0\boldsymbol{\Sigma}_0'\boldsymbol{V}_0^{\top} + \boldsymbol{U}_0\boldsymbol{\Sigma}_0(\boldsymbol{V}_0')^{\top}$$</p>
<p>è¿™ä¸å¾®åˆ†å…¬å¼$d\boldsymbol{W} = (d\boldsymbol{U})\boldsymbol{\Sigma}\boldsymbol{V}^{\top} + \cdots$å®Œå…¨ä¸€è‡´ï¼ˆè¯†åˆ«$d\boldsymbol{U} = \epsilon\boldsymbol{U}_0'$ç­‰ï¼‰ã€‚</p>
<h4 id="102">10.2 äºŒé˜¶å¯¼æ•°</h4>
<p>äºŒé˜¶å¯¼æ•°$\frac{\partial^2\sigma_i}{\partial W_{jk}\partial W_{lm}}$æ¶‰åŠå¥‡å¼‚å‘é‡çš„å¯¼æ•°ï¼Œè®¡ç®—å¤æ‚ã€‚</p>
<p>ä»$\frac{\partial\sigma_i}{\partial W_{jk}} = u_{ji}v_{ki}$æ±‚å¯¼ï¼š
$$\frac{\partial^2\sigma_i}{\partial W_{lm}\partial W_{jk}} = \frac{\partial u_{ji}}{\partial W_{lm}}v_{ki} + u_{ji}\frac{\partial v_{ki}}{\partial W_{lm}}$$</p>
<p>åˆ©ç”¨æœ¬æ–‡æ¨å¯¼çš„$\frac{\partial\boldsymbol{u}_i}{\partial\boldsymbol{W}}$å’Œ$\frac{\partial\boldsymbol{v}_i}{\partial\boldsymbol{W}}$ï¼ˆä»¥4é˜¶å¼ é‡å½¢å¼ï¼‰ï¼Œå¯ä»¥è®¡ç®—å‡ºäºŒé˜¶å¯¼æ•°ã€‚</p>
<p><strong>åº”ç”¨</strong>ï¼šäºŒé˜¶ä¼˜åŒ–æ–¹æ³•ï¼ˆå¦‚Newtonæ³•ï¼‰éœ€è¦HessiançŸ©é˜µã€‚å¯¹äºåŒ…å«SVDçš„ç›®æ ‡å‡½æ•°ï¼Œå¯ä»¥ç”¨äºŒé˜¶å¯¼æ•°æ„é€ ç²¾ç¡®çš„Hessianã€‚</p>
<h3 id="_21">åä¸€ã€æ•°å€¼éªŒè¯ä¸æµ‹è¯•</h3>
<h4 id="111">11.1 æœ‰é™å·®åˆ†æ£€éªŒ</h4>
<p>éªŒè¯æ¢¯åº¦å…¬å¼çš„æ ‡å‡†æ–¹æ³•æ˜¯æœ‰é™å·®åˆ†ï¼š
$$\frac{\partial f}{\partial W_{ij}}\approx\frac{f(\boldsymbol{W} + \epsilon\boldsymbol{E}_{ij}) - f(\boldsymbol{W} - \epsilon\boldsymbol{E}_{ij})}{2\epsilon}$$</p>
<p>å…¶ä¸­$\boldsymbol{E}_{ij}$æ˜¯ç¬¬$(i,j)$ä½ç½®ä¸º1å…¶ä½™ä¸º0çš„çŸ©é˜µã€‚</p>
<p><strong>æµ‹è¯•æ¡ˆä¾‹</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>

<span class="k">def</span><span class="w"> </span><span class="nf">test_svd_gradient</span><span class="p">():</span>
    <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="mi">5</span>
    <span class="n">W</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">Vt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>

    <span class="c1"># è§£ææ¢¯åº¦ï¼šæœ€å¤§å¥‡å¼‚å€¼</span>
    <span class="n">grad_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">U</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">Vt</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:])</span>

    <span class="c1"># æ•°å€¼æ¢¯åº¦</span>
    <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1e-7</span>
    <span class="n">grad_numerical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
            <span class="n">E</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
            <span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="n">s1_plus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">W</span> <span class="o">+</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">E</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">s1_minus</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">W</span> <span class="o">-</span> <span class="n">epsilon</span> <span class="o">*</span> <span class="n">E</span><span class="p">,</span> <span class="n">compute_uv</span><span class="o">=</span><span class="kc">False</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">grad_numerical</span><span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">s1_plus</span> <span class="o">-</span> <span class="n">s1_minus</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">epsilon</span><span class="p">)</span>

    <span class="c1"># æ¯”è¾ƒ</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">grad_analytical</span> <span class="o">-</span> <span class="n">grad_numerical</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Gradient error: </span><span class="si">{</span><span class="n">error</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">error</span> <span class="o">&lt;</span> <span class="mf">1e-5</span>
</code></pre></div>

<h4 id="112">11.2 è‡ªåŠ¨å¾®åˆ†å¯¹æ¯”</h4>
<p>ç°ä»£æ·±åº¦å­¦ä¹ æ¡†æ¶ï¼ˆPyTorch, JAXï¼‰æä¾›è‡ªåŠ¨å¾®åˆ†ã€‚å¯ä»¥å¯¹æ¯”æ‰‹åŠ¨å®ç°ä¸æ¡†æ¶è‡ªåŠ¨è®¡ç®—çš„æ¢¯åº¦ï¼š</p>
<div class="codehilite"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>

<span class="k">def</span><span class="w"> </span><span class="nf">svd_spectral_norm_manual</span><span class="p">(</span><span class="n">W</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;æ‰‹åŠ¨å®ç°è°±å½’ä¸€åŒ–çš„æ¢¯åº¦&quot;&quot;&quot;</span>
    <span class="n">U</span><span class="p">,</span> <span class="n">S</span><span class="p">,</span> <span class="n">V</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
    <span class="n">sigma1</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">u1</span> <span class="o">=</span> <span class="n">U</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">v1</span> <span class="o">=</span> <span class="n">V</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">W_normalized</span> <span class="o">=</span> <span class="n">W</span> <span class="o">/</span> <span class="n">sigma1</span>
    <span class="k">return</span> <span class="n">W_normalized</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">sigma1</span>

<span class="c1"># å¯¹æ¯”è‡ªåŠ¨å¾®åˆ†</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">W_norm_manual</span><span class="p">,</span> <span class="n">u1</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">svd_spectral_norm_manual</span><span class="p">(</span><span class="n">W</span><span class="p">)</span>
<span class="n">loss_manual</span> <span class="o">=</span> <span class="n">W_norm_manual</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">loss_manual</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">grad_manual</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">clone</span><span class="p">()</span>

<span class="c1"># ä½¿ç”¨è‡ªåŠ¨å¾®åˆ†</span>
<span class="n">W</span><span class="o">.</span><span class="n">grad</span><span class="o">.</span><span class="n">zero_</span><span class="p">()</span>
<span class="n">W_norm_auto</span> <span class="o">=</span> <span class="n">W</span> <span class="o">/</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">loss_auto</span> <span class="o">=</span> <span class="n">W_norm_auto</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">loss_auto</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">grad_auto</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">grad</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gradient difference:&quot;</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">grad_manual</span> <span class="o">-</span> <span class="n">grad_auto</span><span class="p">))</span>
</code></pre></div>

<h3 id="_22">åäºŒã€æ€»ç»“ä¸å±•æœ›</h3>
<h4 id="121">12.1 æ ¸å¿ƒè¦ç‚¹å›é¡¾</h4>
<ol>
<li><strong>å¯å¯¼æ¡ä»¶</strong>ï¼šSVDå¯å¯¼å½“ä¸”ä»…å½“æ‰€æœ‰éé›¶å¥‡å¼‚å€¼ä¸¤ä¸¤ä¸ç­‰</li>
<li><strong>å¥‡å¼‚å€¼æ¢¯åº¦</strong>ï¼š$\nabla_{\boldsymbol{W}}\sigma_i = \boldsymbol{u}_i\boldsymbol{v}_i^{\top}$</li>
<li><strong>å¥‡å¼‚å‘é‡æ¢¯åº¦</strong>ï¼šæ¶‰åŠçŸ©é˜µ$\boldsymbol{F}_{ij} = \frac{1}{\sigma_j^2 - \sigma_i^2}$çš„Hadamardç§¯</li>
<li><strong>æ•°å€¼ç¨³å®šæ€§</strong>ï¼šæ¥è¿‘å¥‡å¼‚å€¼å¯¼è‡´æ¢¯åº¦çˆ†ç‚¸ï¼Œéœ€ç”¨Taylor/PadÃ©è¿‘ä¼¼æˆ–å¹‚è¿­ä»£</li>
<li><strong>æ·±åº¦å­¦ä¹ åº”ç”¨</strong>ï¼šè°±å½’ä¸€åŒ–ã€ä½ç§©æ­£åˆ™åŒ–ã€æ­£äº¤åŒ–å±‚</li>
</ol>
<h4 id="122">12.2 ç†è®ºæ„ä¹‰</h4>
<p>SVDæ±‚å¯¼å±•ç¤ºäº†<strong>å¾®åˆ†å‡ ä½•</strong>ä¸<strong>æ•°å€¼çº¿æ€§ä»£æ•°</strong>çš„æ·±åˆ»è”ç³»ï¼š
- SVDå®šä¹‰äº†çŸ©é˜µæµå½¢ä¸Šçš„åæ ‡ç³»
- å¥‡å¼‚å€¼/å‘é‡çš„å˜åŒ–å—Riemannåº¦é‡çº¦æŸ
- æ¢¯åº¦å…¬å¼åæ˜ äº†æµå½¢çš„å‡ ä½•ç»“æ„</p>
<h4 id="123">12.3 å¼€æ”¾é—®é¢˜</h4>
<ol>
<li><strong>è‡ªé€‚åº”æ­£åˆ™åŒ–</strong>ï¼šå¦‚ä½•æ ¹æ®å¥‡å¼‚å€¼é—´éš™è‡ªåŠ¨è°ƒæ•´$\boldsymbol{F}_{ij}$çš„æ­£åˆ™åŒ–å¼ºåº¦ï¼Ÿ</li>
<li><strong>é«˜é˜¶ä¼˜åŒ–</strong>ï¼šå¦‚ä½•é«˜æ•ˆè®¡ç®—SVDçš„HessiançŸ©é˜µç”¨äºäºŒé˜¶ä¼˜åŒ–ï¼Ÿ</li>
<li><strong>éšæœºSVDçš„æ¢¯åº¦</strong>ï¼šå¯¹äºå¤§è§„æ¨¡çŸ©é˜µï¼ŒéšæœºSVDç®—æ³•çš„æ¢¯åº¦å¦‚ä½•è®¡ç®—ï¼Ÿ</li>
<li><strong>éå‡¸ä¼˜åŒ–</strong>ï¼šå«SVDé¡¹çš„éå‡¸ä¼˜åŒ–é—®é¢˜çš„å…¨å±€æ”¶æ•›æ€§å¦‚ä½•ä¿è¯ï¼Ÿ</li>
</ol>
<h4 id="124">12.4 å®è·µå»ºè®®</h4>
<ul>
<li><strong>ä¼˜å…ˆä½¿ç”¨æ¡†æ¶è‡ªåŠ¨å¾®åˆ†</strong>ï¼šé™¤éå¯¹æ€§èƒ½æœ‰æè‡´è¦æ±‚ï¼Œå¦åˆ™è®©PyTorch/JAXå¤„ç†SVDæ¢¯åº¦</li>
<li><strong>ç›‘æ§æ¡ä»¶æ•°</strong>ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­è·Ÿè¸ª$\min_{i\neq j}|\sigma_i - \sigma_j|$ï¼Œè¿‡å°æ—¶è°ƒæ•´æ­£åˆ™åŒ–</li>
<li><strong>å¹‚è¿­ä»£è¶³å¤Ÿç”¨</strong>ï¼šå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œ1-2æ¬¡å¹‚è¿­ä»£å³å¯è·å¾—è¶³å¤Ÿç²¾ç¡®çš„$\sigma_1, \boldsymbol{u}_1, \boldsymbol{v}_1$</li>
<li><strong>é¿å…å®Œæ•´SVD</strong>ï¼šå¦‚æœåªéœ€è¦å°‘æ•°å¥‡å¼‚å€¼ï¼Œä½¿ç”¨Lanczosæˆ–Arnoldiè¿­ä»£è€Œéå®Œæ•´åˆ†è§£</li>
</ul>
<p>é€šè¿‡æœ¬èŠ‚çš„è¯¦ç»†æ¨å¯¼ï¼Œæˆ‘ä»¬ä»å¤šä¸ªè§’åº¦ç†è§£äº†SVDå¯¼æ•°çš„æœ¬è´¨ï¼ŒæŒæ¡äº†ç†è®ºåŸºç¡€ã€æ•°å€¼ç®—æ³•å’Œå®é™…åº”ç”¨ã€‚è¿™äº›çŸ¥è¯†ä¸ä»…åœ¨æ·±åº¦å­¦ä¹ ä¸­é‡è¦ï¼Œåœ¨ä¼˜åŒ–ã€ä¿¡å·å¤„ç†ã€æ§åˆ¶ç†è®ºç­‰é¢†åŸŸä¹Ÿæœ‰å¹¿æ³›åº”ç”¨ã€‚</p>
        </div>
    </div>
</body>
</html>