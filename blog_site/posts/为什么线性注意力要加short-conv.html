<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸ºä»€ä¹ˆçº¿æ€§æ³¨æ„åŠ›è¦åŠ Short C...</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ä¸ºä»€ä¹ˆçº¿æ€§æ³¨æ„åŠ›è¦åŠ Short C...</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 40.2 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/11320">https://spaces.ac.cn/archives/11320</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å¦‚æœè¯»è€…æœ‰å…³æ³¨æ¨¡å‹æ¶æ„æ–¹é¢çš„è¿›å±•ï¼Œé‚£ä¹ˆå°±ä¼šå‘ç°ï¼Œæ¯”è¾ƒæ–°çš„çº¿æ€§Attentionï¼ˆå‚è€ƒ<a href="/archives/11033">ã€Šçº¿æ€§æ³¨æ„åŠ›ç®€å²ï¼šä»æ¨¡ä»¿ã€åˆ›æ–°åˆ°åå“ºã€‹</a>ï¼‰æ¨¡å‹éƒ½ç»™$\boldsymbol{Q},\boldsymbol{K},\boldsymbol{V}$åŠ ä¸Šäº†Short Convï¼Œæ¯”å¦‚ä¸‹å›¾æ‰€ç¤ºçš„<a href="https://papers.cool/arxiv/2406.06484">DeltaNet</a>ï¼š  </p>
<p><a href="/usr/uploads/2025/10/175536171.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="DeltaNetä¸­çš„Short Conv" src="/usr/uploads/2025/10/175536171.png" /></a></p>
<p>DeltaNetä¸­çš„Short Conv</p>
<p>ä¸ºä»€ä¹ˆè¦åŠ è¿™ä¸ªShort Convå‘¢ï¼Ÿç›´è§‚ç†è§£å¯èƒ½æ˜¯å¢åŠ æ¨¡å‹æ·±åº¦ã€å¢å¼ºæ¨¡å‹çš„Token-Mixingèƒ½åŠ›ç­‰ï¼Œè¯´ç™½äº†å°±æ˜¯è¡¥å¿çº¿æ€§åŒ–å¯¼è‡´çš„è¡¨è¾¾èƒ½åŠ›ä¸‹é™ã€‚è¿™ä¸ªè¯´æ³•å½“ç„¶æ˜¯å¤§å·®ä¸å·®ï¼Œä½†å®ƒå±äºâ€œä¸‡èƒ½æ¨¡ç‰ˆâ€å¼çš„å›ç­”ï¼Œæˆ‘ä»¬æ›´æƒ³å¯¹å®ƒçš„ç”Ÿæ•ˆæœºåˆ¶æœ‰æ›´å‡†ç¡®çš„è®¤çŸ¥ã€‚</p>
<p>æ¥ä¸‹æ¥ï¼Œç¬”è€…å°†ç»™å‡ºè‡ªå·±çš„ä¸€ä¸ªç†è§£ï¼ˆæ›´å‡†ç¡®è¯´åº”è¯¥æ˜¯çŒœæµ‹ï¼‰ã€‚</p>
<h2 id="_1">æµ‹è¯•è®­ç»ƒ</h2>
<p>ä»<a href="/archives/11033">ã€Šçº¿æ€§æ³¨æ„åŠ›ç®€å²ï¼šä»æ¨¡ä»¿ã€åˆ›æ–°åˆ°åå“ºã€‹</a>æˆ‘ä»¬çŸ¥é“ï¼Œç›®å‰çš„æ–°å¼çº¿æ€§AttentionèƒŒåçš„æ ¸å¿ƒæ€æƒ³éƒ½æ˜¯<a href="https://papers.cool/arxiv/2407.04620">TTTï¼ˆTest Time Trainingï¼‰</a>æˆ–è€…è¯´Online Learningã€‚TTTåŸºäºä¼˜åŒ–å™¨æ›´æ–°ä¸RNNè¿­ä»£çš„ç›¸ä¼¼æ€§ï¼Œé€šè¿‡ä¼˜åŒ–å™¨æ¥æ„å»ºï¼ˆä¸ä¸€å®šæ˜¯çº¿æ€§çš„ï¼‰RNNæ¨¡å‹ï¼Œè¯¸å¦‚DeltaNetã€GDNã€Combaç­‰çº¿æ€§Attentionéƒ½å¯ä»¥çœ‹æˆå®ƒçš„ç‰¹ä¾‹ã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼ŒTTTå°†$\boldsymbol{K},\boldsymbol{V}$è§†ä¸ºæˆå¯¹çš„è¯­æ–™$(\boldsymbol{k}<em t-1="t-1">1, \boldsymbol{v}_1),(\boldsymbol{k}_2, \boldsymbol{v}_2),\cdots,(\boldsymbol{k}_t, \boldsymbol{v}_t)$ï¼Œæˆ‘ä»¬ç”¨å®ƒè®­ç»ƒä¸€ä¸ªæ¨¡å‹$\boldsymbol{v} = \boldsymbol{f}(\boldsymbol{S}_t;\boldsymbol{k})$ï¼Œç„¶åè¾“å‡º$\boldsymbol{o}_t = \boldsymbol{f}(\boldsymbol{S}_t;\boldsymbol{q}_t)$ï¼Œå…¶ä¸­$\boldsymbol{S}_t$æ˜¯æ¨¡å‹å‚æ•°ï¼Œç”¨SGDæ›´æ–°ï¼š<br />
\begin{equation} \boldsymbol{S}_t = \boldsymbol{S}</em>} - \eta_t\nabla_{\boldsymbol{S<em t-1="t-1">{t-1}}\mathcal{L}(\boldsymbol{f}(\boldsymbol{S}</em>};\boldsymbol{k<em t-1="t-1">t), \boldsymbol{v}_t)\end{equation}<br />
å½“ç„¶ï¼Œå¦‚æœæˆ‘ä»¬æ„¿æ„ï¼Œä¹Ÿå¯ä»¥è€ƒè™‘å…¶ä»–ä¼˜åŒ–å™¨ï¼Œæ¯”å¦‚<a href="https://papers.cool/arxiv/2505.23884">ã€ŠTest-Time Training Done Rightã€‹</a>å°è¯•äº†Muonä¼˜åŒ–å™¨ã€‚é™¤äº†å¯ä»¥æ”¹å˜ä¼˜åŒ–å™¨å¤–ï¼Œå¯ä»¥çµæ´»æ”¹å˜çš„åœ°æ–¹è¿˜æœ‰æ¨¡å‹$\boldsymbol{v} = \boldsymbol{f}(\boldsymbol{S}_t;\boldsymbol{k})$çš„æ¶æ„ä»¥åŠæŸå¤±å‡½æ•°$\mathcal{L}(\boldsymbol{f}(\boldsymbol{S}</em>_t)$ã€‚æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è€ƒè™‘ä»¥Chunkä¸ºå•ä½çš„Mini-batch TTTã€‚};\boldsymbol{k}_t), \boldsymbol{v</p>
<p>ä¸éš¾æƒ³è±¡ï¼Œç†è®ºä¸ŠTTTçš„çµæ´»æ€§éå¸¸é«˜ï¼Œå¯ä»¥æ„å»ºä»»æ„å¤æ‚çš„RNNæ¨¡å‹ã€‚å½“æ¶æ„é€‰æ‹©çº¿æ€§æ¨¡å‹$\boldsymbol{v} = \boldsymbol{S}_t\boldsymbol{k}$ä¸”æŸå¤±å‡½æ•°é€‰æ‹©å¹³æ–¹è¯¯å·®æ—¶ï¼Œç»“æœå¯¹åº”DeltaNetï¼›å¦‚æœæˆ‘ä»¬åŠ ä¸Šä¸€äº›æ­£åˆ™é¡¹ï¼Œé‚£ä¹ˆå¯ä»¥è¡ç”Ÿå‡ºGDNç­‰å˜ä½“ã€‚</p>
<h2 id="_2">çµé­‚æ‹·é—®</h2>
<p>å°†TTTæ”¾åœ¨å‰é¢ï¼Œä¸»è¦æ˜¯æƒ³è¡¨æ˜ï¼Œå½“å‰ä¸»æµçš„çº¿æ€§Attentionçš„åº•å±‚é€»è¾‘è·ŸTTTä¸€æ ·ï¼Œæ ¸å¿ƒéƒ½æ˜¯è¯­æ–™å¯¹$(\boldsymbol{k}_1, \boldsymbol{v}_1),(\boldsymbol{k}_2, \boldsymbol{v}_2),\cdots,(\boldsymbol{k}_t, \boldsymbol{v}_t)$çš„Online Learningã€‚è¿™å°±å¾ˆè‡ªç„¶åœ°å¼•ç”³å‡ºä¸€ä¸ªç–‘é—®ï¼šä¸ºä»€ä¹ˆè¦è¿™æ ·åšï¼Ÿè¿™æ ·åšç©¶ç«Ÿå­¦å‡ºä¸ªä»€ä¹ˆæ¥ï¼Ÿ</p>
<p>è¦å›ç­”è¿™ä¸ªé—®é¢˜ï¼Œé¦–å…ˆå¾—åæ€ä¸€ä¸‹â€œæˆ‘ä»¬ç©¶ç«Ÿæƒ³è¦ä»€ä¹ˆâ€ã€‚æŒ‰ç…§Softmax Attentionçš„ç‰¹ç‚¹ï¼Œæˆ‘ä»¬æƒ³è¦çš„åº”è¯¥æ˜¯æ ¹æ®$(\boldsymbol{k}_1, \boldsymbol{v}_1),(\boldsymbol{k}_2, \boldsymbol{v}_2),\cdots,(\boldsymbol{k}_t, \boldsymbol{v}_t)$å’Œ$\boldsymbol{q}_t$ç®—å‡ºä¸€ä¸ª$\boldsymbol{o}_t$æ¥ï¼Œè¿™ä¸ªè¿‡ç¨‹ç†æƒ³æƒ…å†µä¸‹åº”è¯¥ä¾èµ–äºå…¨ä½“$(\boldsymbol{k},\boldsymbol{v})$ã€‚åŒæ—¶ï¼Œæˆ‘ä»¬è¿˜å¸Œæœ›èƒ½å¸¸æ•°å¤æ‚åº¦å®ç°è¿™ä¸ªç›®æ ‡ï¼Œæ‰€ä»¥ä¸€ä¸ªç›´è§‚æƒ³æ³•æ˜¯å…ˆå°†$(\boldsymbol{k},\boldsymbol{v})$å‹ç¼©æˆï¼ˆä¸$t$æ— å…³çš„ï¼‰å›ºå®šå¤§å°çš„Stateï¼Œç„¶åå†è¯»å–è¿™ä¸ªStateã€‚</p>
<p>æ€ä¹ˆå®ç°è¿™ä¸ªå‹ç¼©å‘¢ï¼ŸTTTçš„æƒ³æ³•æ˜¯ï¼šè®¾è®¡ä¸€ä¸ªæ¨¡å‹$\boldsymbol{v} = \boldsymbol{f}(\boldsymbol{S}_t;\boldsymbol{k})$ï¼Œç„¶åç”¨è¿™äº›$(\boldsymbol{k},\boldsymbol{v})$å¯¹å»â€œè®­ç»ƒâ€è¿™ä¸ªæ¨¡å‹ï¼Œè®­ç»ƒå®Œæˆåï¼Œæ¨¡å‹æŸç§æ„ä¹‰ä¸Šå°±â€œèƒŒä¸‹â€äº†è¿™äº›$(\boldsymbol{k},\boldsymbol{v})$å¯¹ï¼Œè¿™å°±ç›¸å½“äºå°±å…¨ä½“$(\boldsymbol{k},\boldsymbol{v})$å‹ç¼©åˆ°äº†å›ºå®šå¤§å°çš„æ¨¡å‹æƒé‡$\boldsymbol{S}_t$ä¸­ã€‚è‡³äº$\boldsymbol{q}<br />
_t$æ€ä¹ˆåˆ©ç”¨$\boldsymbol{S}_t$ï¼Œç›´æ¥å°†å®ƒä»£å…¥æ¨¡å‹ä¸­å¾—åˆ°$\boldsymbol{o}<br />
_t = \boldsymbol{f}(\boldsymbol{S}_t;\boldsymbol{q}_t)$æ˜¯ä¸€ä¸ªæ¯”è¾ƒè‡ªç„¶çš„é€‰æ‹©ï¼Œä½†åŸåˆ™ä¸Šæˆ‘ä»¬ä¹Ÿå¯ä»¥è®¾è®¡åˆ«çš„åˆ©ç”¨æ–¹å¼ã€‚</p>
<p>ä¹Ÿå°±æ˜¯è¯´ï¼ŒTTTçš„æ ¸å¿ƒä»»åŠ¡æ˜¯åˆ©ç”¨ <em>â€œè®­ç»ƒæ¨¡å‹â€çº¦ç­‰äºâ€œèƒŒè¯µè®­ç»ƒé›†â€</em> è¿™ä»¶äº‹æƒ…ï¼Œæ¥å®ç°$\boldsymbol{K},\boldsymbol{V}$çš„å‹ç¼©ã€‚ç„¶è€Œï¼Œ <em>â€œè®­ç»ƒæ¨¡å‹â€çº¦ç­‰äºâ€œèƒŒè¯µè®­ç»ƒé›†â€</em> è¿™ä»¶äº‹æƒ…å¹¶ä¸æ˜¯é‚£ä¹ˆå¹³å‡¡ï¼Œå®ƒæœ‰ä¸€äº›å‰ææ¡ä»¶ã€‚</p>
<h2 id="_3">é”®å€¼åŒæº</h2>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œå¦‚æœæˆ‘ä»¬å–$\boldsymbol{K}=\boldsymbol{V}$ï¼Œé‚£ä¹ˆTTTè¿™å¥—æ¡†æ¶ç†è®ºä¸Šå°±å¤±æ•ˆäº†ï¼Œå› ä¸ºè¿™æ—¶å€™æ¨¡å‹$\boldsymbol{v} = \boldsymbol{f}(\boldsymbol{S}_t;\boldsymbol{k})$çš„æœ€ä¼˜è§£å°±æ˜¯æ’ç­‰å˜æ¢ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¹³å‡¡è§£ï¼Œè¿™ç›¸å½“äºæ²¡è®°ä½ä»»ä½•ä¸œè¥¿ã€‚åƒDeltaNetè¿™ç§åœ¨çº¿æ›´æ–°çš„æˆ–è®¸è¿˜èƒ½æŠ¢æ•‘ä¸€ä¸‹ï¼Œè€Œåƒ<a href="https://papers.cool/arxiv/2506.05233">MesaNet</a>è¿™ç§åŸºäºå‡†ç¡®è§£çš„å°±çœŸçš„ç›´æ¥è¾“å‡ºå•ä½é˜µ$\boldsymbol{I}$äº†ã€‚</p>
<p>å¯èƒ½æœ‰è¯»è€…ä¼šåé—®ï¼šå¥½ç«¯ç«¯åœ°ä¸ºå•¥è¦è€ƒè™‘$\boldsymbol{K}=\boldsymbol{V}$è¿™ç§ä¸ç§‘å­¦çš„é€‰æ‹©å‘¢ï¼Ÿçš„ç¡®ï¼Œ$\boldsymbol{K}=\boldsymbol{V}$æ˜¯æ¯”è¾ƒæç«¯çš„é€‰æ‹©ï¼Œè¿™é‡Œåªæ˜¯ä½œä¸ºä¸€ä¸ªä¾‹å­ï¼Œè¯´æ˜ <em>â€œè®­ç»ƒæ¨¡å‹â€çº¦ç­‰äºâ€œèƒŒè¯µè®­ç»ƒé›†â€</em> å¹¶ä¸æ˜¯éšæ„æˆç«‹çš„ã€‚å…¶æ¬¡ï¼Œæˆ‘ä»¬åœ¨<a href="/archives/10907">ã€ŠTransformerå‡çº§ä¹‹è·¯ï¼š20ã€MLAå¥½åœ¨å“ªé‡Œ?ï¼ˆä¸Šï¼‰ã€‹</a>å·²ç»éªŒè¯è¿‡ï¼Œå¯¹äºSoftmax Attentionæ¥è¯´ï¼Œ$\boldsymbol{K}=\boldsymbol{V}$ä¹Ÿèƒ½å–å¾—ä¸é”™çš„ç»“æœã€‚</p>
<p>è¿™è¯´æ˜ï¼Œ$\boldsymbol{K}=\boldsymbol{V}$å¹¶ä¸æ˜¯Attentionæœºåˆ¶çš„æœ¬è´¨éšœç¢ï¼Œä½†åœ¨TTTæ¡†æ¶é‡Œè¾¹å®ƒå´èƒ½å¯¼è‡´æ¨¡å‹å¤±æ•ˆï¼Œè¿™æ˜¯å› ä¸º$\boldsymbol{K},\boldsymbol{V}$å®Œå…¨é‡åˆï¼Œé‚£ä¹ˆå®ƒä»¬ä¿©ä¹‹é—´çš„å›å½’å°±æ²¡æœ‰ä¸œè¥¿å¯å­¦äº†ã€‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œ$\boldsymbol{K},\boldsymbol{V}$çš„ä¿¡æ¯é‡åˆåº¦è¶Šé«˜ï¼Œé‚£ä¹ˆå®ƒä»¬ä¹‹é—´å¯å­¦çš„ä¸œè¥¿å°±è¶Šå°‘ï¼Œæ¢è¨€ä¹‹TTTå¯¹â€œè®­ç»ƒé›†â€çš„è®°å¿†ç¨‹åº¦å°±è¶Šä½ã€‚</p>
<p>åœ¨ä¸€èˆ¬çš„Attentionæœºåˆ¶ä¸­ï¼Œ$\boldsymbol{q}_t,\boldsymbol{k}_t,\boldsymbol{v}_t$éƒ½æ˜¯ç”±åŒä¸€ä¸ªè¾“å…¥$\boldsymbol{x}_t$ç»è¿‡ä¸åŒçš„çº¿æ€§æŠ•å½±å¾—åˆ°çš„ï¼Œæ¢å¥è¯è¯´$\boldsymbol{k}_t,\boldsymbol{v}_t$å…·æœ‰ç›¸åŒçš„æºå¤´$\boldsymbol{x}_t$ï¼Œè¿™å°±å§‹ç»ˆæœ‰ç§â€œè‡ªå·±é¢„æµ‹è‡ªå·±â€çš„æ„Ÿè§‰ï¼Œå¯å­¦çš„ä¸œè¥¿æœ‰é™ã€‚</p>
<h2 id="_4">å·ç§¯æ•‘åœº</h2>
<p>æ€ä¹ˆè®©TTTåœ¨é”®å€¼åŒæºç”šè‡³$\boldsymbol{K}=\boldsymbol{V}$æ—¶èƒ½å­¦å‡ºæ›´æœ‰ä»·å€¼çš„ç»“æœå‘¢ï¼Ÿå…¶å®ç­”æ¡ˆå¾ˆæ—©å°±æœ‰äº†â€”â€”å¯ä»¥è¿½æº¯åˆ°Word2Vecç”šè‡³æ›´æ—©çš„å¹´ä»£â€”â€”é‚£å°±æ˜¯ä¸è¦â€œé¢„æµ‹è‡ªå·±â€ï¼Œè€Œæ˜¯â€œé¢„æµ‹å‘¨å›´â€ã€‚</p>
<p>ä»¥<a href="https://papers.cool/arxiv/1301.3781">Word2Vec</a>ä¸ºä¾‹ï¼Œæˆ‘ä»¬çŸ¥é“å®ƒçš„è®­ç»ƒæ–¹å¼æ˜¯â€œä¸­å¿ƒè¯é¢„æµ‹ä¸Šä¸‹æ–‡â€ï¼›ä¹‹å‰æµè¡Œçš„<a href="https://papers.cool/arxiv/1810.04805">BERT</a>ï¼Œé¢„è®­ç»ƒæ–¹å¼æ˜¯MLMï¼Œå®ƒæ˜¯æŸäº›è¯Maskæ‰æ¥é¢„æµ‹è¿™äº›è¯ï¼Œå¯ä»¥è¯´æ˜¯â€œä¸Šä¸‹æ–‡é¢„æµ‹ä¸­å¿ƒè¯â€ï¼›ç°åœ¨ä¸»æµçš„LLMï¼Œè®­ç»ƒä»»åŠ¡åˆ™æ˜¯NTPï¼ˆNext Token Predictï¼‰ï¼Œæ ¹æ®ä¸Šæ–‡é¢„æµ‹ä¸‹ä¸€ä¸ªè¯ã€‚å¾ˆæ˜æ˜¾ï¼Œå®ƒä»¬çš„å…±åŒç‰¹ç‚¹éƒ½æ˜¯ä¸é¢„æµ‹è‡ªå·±ï¼Œè€Œæ˜¯é¢„æµ‹å‘¨å›´ã€‚</p>
<p>æ‰€ä»¥ï¼Œæƒ³è¦æ”¹è¿›TTTï¼Œé‚£ä¹ˆå°±è¦æ”¹å˜$(\boldsymbol{k}<em t-1="t-1">t,\boldsymbol{v}_t)$è¿™æ ·çš„â€œè‡ªå·±é¢„æµ‹è‡ªå·±â€çš„é…å¯¹æ–¹å¼ï¼Œè€ƒè™‘åˆ°å½“å‰LLMä»¥NTPä¸ºä¸»ï¼Œåœ¨TTTä¸­æˆ‘ä»¬ä¹Ÿå¯ä»¥è€ƒè™‘NTPï¼Œæ¯”å¦‚$(\boldsymbol{k}</em>},\boldsymbol{v<em t-1="t-1">t)$æ¥æ„å»ºè¯­æ–™å¯¹ï¼Œå³ç”¨$\boldsymbol{k}</em>$ä¹Ÿèƒ½å­¦å‡ºéå¹³å‡¡çš„ç»“æœã€‚æ­¤æ—¶TTTå†…å¤–éƒ½æ˜¯NTPä»»åŠ¡ï¼Œå…·æœ‰æ¼‚äº®çš„ä¸€è‡´æ€§ã€‚}$æ¥é¢„æµ‹$\boldsymbol{v}_t$ï¼Œè¿™æ ·å³ä¾¿$\boldsymbol{K}=\boldsymbol{V</p>
<p>ä¸è¿‡ï¼Œåªç”¨$\boldsymbol{k}<em t-1="t-1">{t-1}$é¢„æµ‹$\boldsymbol{v}_t$çš„è¯ï¼Œä¼¼ä¹æŠŠ$\boldsymbol{k}_t$æµªè´¹æ‰äº†ï¼Œæ‰€ä»¥è¿›ä¸€æ­¥çš„æƒ³æ³•æ˜¯æŠŠ$\boldsymbol{k}</em>}$å’Œ$\boldsymbol{k<em t-1="t-1">t$ä»¥æŸç§æ–¹å¼æ··åˆèµ·æ¥å†é¢„æµ‹$\boldsymbol{v}_t$ã€‚åˆ°è¿™é‡Œï¼Œå¤§å®¶å¯èƒ½ååº”è¿‡æ¥äº†ï¼Œâ€œæŠŠ$\boldsymbol{k}</em>$åŠ Short Convï¼Œæ˜¯å°†TTTçš„è®­ç»ƒç›®æ ‡ä»â€œé¢„æµ‹è‡ªå·±â€è½¬åŒ–ä¸ºNTPï¼Œè®©TTTè‡³å°‘æœ‰èƒ½åŠ›å­¦å‡ºä¸€ä¸ªn-gramæ¨¡å‹ã€‚}$å’Œ$\boldsymbol{k}_t$ä»¥æŸç§æ–¹å¼æ··åˆèµ·æ¥â€è¿™ä¸å°±ç›¸å½“äºkernel_size=2çš„Convå˜›ï¼æ‰€ä»¥ï¼Œç»™$\boldsymbol{K</p>
<p>è‡³äºç»™$\boldsymbol{Q},\boldsymbol{V}$åŠ Short Convï¼Œåˆ™å®Œå…¨æ˜¯é¡ºå¸¦çš„ï¼Œæ ¹æ®é£æ¥é˜ï¼ˆFLAç¾¤ï¼‰çš„æ¶ˆæ¯ï¼Œç»™$\boldsymbol{Q},\boldsymbol{V}$åŠ è™½ç„¶ä¹Ÿæœ‰ä¸€ç‚¹ä½œç”¨ï¼Œä½†è¿œä¸å¦‚ç»™$\boldsymbol{K}$åŠ Short Convå¸¦æ¥çš„æå‡ï¼Œè¿™ä¹Ÿç®—æ˜¯ä½è¯äº†æˆ‘ä»¬çš„çŒœæµ‹ã€‚</p>
<h2 id="_5">æ–‡ç« å°ç»“</h2>
<p>è¿™ç¯‡æ–‡ç« å¯¹â€œä¸ºä»€ä¹ˆçº¿æ€§æ³¨æ„åŠ›è¦åŠ Short Convâ€è¿™ä¸ªé—®é¢˜ç»™å‡ºäº†ä¸€ä¸ªé—­é—¨é€ è½¦çš„ç†è§£ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/11320">https://spaces.ac.cn/archives/11320</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Oct. 05, 2025). ã€Šä¸ºä»€ä¹ˆçº¿æ€§æ³¨æ„åŠ›è¦åŠ Short Convï¼Ÿ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/11320">https://spaces.ac.cn/archives/11320</a></p>
<p>@online{kexuefm-11320,<br />
title={ä¸ºä»€ä¹ˆçº¿æ€§æ³¨æ„åŠ›è¦åŠ Short Convï¼Ÿ},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Oct},<br />
url={\url{https://spaces.ac.cn/archives/11320}},<br />
} </p>
<hr />
<hr />
<h2 id="_6">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">1. æ ‡å‡†æ³¨æ„åŠ›æœºåˆ¶çš„æ•°å­¦å®šä¹‰</h3>
<p>æ ‡å‡†çš„è‡ªæ³¨æ„åŠ›ï¼ˆSelf-Attentionï¼‰æœºåˆ¶å¯ä»¥å½¢å¼åŒ–è¡¨ç¤ºä¸ºï¼š</p>
<p>$$
\text{Attention}(\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}) = \text{softmax}\left(\frac{\boldsymbol{Q}\boldsymbol{K}^T}{\sqrt{d_k}}\right)\boldsymbol{V}
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™é‡Œ $\boldsymbol{Q} \in \mathbb{R}^{n \times d_k}$ æ˜¯æŸ¥è¯¢çŸ©é˜µï¼Œ$\boldsymbol{K} \in \mathbb{R}^{n \times d_k}$ æ˜¯é”®çŸ©é˜µï¼Œ$\boldsymbol{V} \in \mathbb{R}^{n \times d_v}$ æ˜¯å€¼çŸ©é˜µï¼Œå…¶ä¸­ $n$ æ˜¯åºåˆ—é•¿åº¦ï¼Œ$d_k$ å’Œ $d_v$ åˆ†åˆ«æ˜¯é”®å’Œå€¼çš„ç»´åº¦ã€‚æ¸©åº¦ç³»æ•° $\sqrt{d_k}$ ç”¨äºæ§åˆ¶softmaxå‡½æ•°çš„å°–é”ç¨‹åº¦ã€‚</p>
<h3 id="2">2. æ ‡å‡†æ³¨æ„åŠ›çš„è®¡ç®—å¤æ‚åº¦åˆ†æ</h3>
<p>å¯¹äºåºåˆ—é•¿åº¦ä¸º $n$ çš„è¾“å…¥ï¼Œæ ‡å‡†æ³¨æ„åŠ›æœºåˆ¶çš„è®¡ç®—å¤æ‚åº¦åˆ†è§£å¦‚ä¸‹ï¼š</p>
<p><strong>æ­¥éª¤1ï¼šè®¡ç®—æ³¨æ„åŠ›å¾—åˆ†çŸ©é˜µ</strong></p>
<p>$$
\boldsymbol{S} = \boldsymbol{Q}\boldsymbol{K}^T \in \mathbb{R}^{n \times n}
$$</p>
<p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼šçŸ©é˜µä¹˜æ³• $\boldsymbol{Q}\boldsymbol{K}^T$ éœ€è¦è®¡ç®— $n \times n$ ä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éœ€è¦ $d_k$ æ¬¡ä¹˜æ³•å’ŒåŠ æ³•ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2 d_k)$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º $O(n^2)$ã€‚</p>
<p><strong>æ­¥éª¤2ï¼šåº”ç”¨softmaxå½’ä¸€åŒ–</strong></p>
<p>$$
\boldsymbol{A}_{i,j} = \frac{\exp(\boldsymbol{S}_{i,j}/\sqrt{d_k})}{\sum_{k=1}^n \exp(\boldsymbol{S}_{i,k}/\sqrt{d_k})}
$$</p>
<p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼šå¯¹äº $n \times n$ çš„çŸ©é˜µï¼Œsoftmaxæ“ä½œéœ€è¦ $O(n^2)$ çš„æ—¶é—´å¤æ‚åº¦ã€‚</p>
<p><strong>æ­¥éª¤3ï¼šåŠ æƒæ±‚å’Œ</strong></p>
<p>$$
\boldsymbol{O} = \boldsymbol{A}\boldsymbol{V} \in \mathbb{R}^{n \times d_v}
$$</p>
<p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼šçŸ©é˜µä¹˜æ³• $\boldsymbol{A}\boldsymbol{V}$ çš„æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2 d_v)$ã€‚</p>
<p><strong>æ€»ä½“å¤æ‚åº¦</strong>ï¼šæ ‡å‡†æ³¨æ„åŠ›çš„æ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(n^2(d_k + d_v))$ï¼Œç©ºé—´å¤æ‚åº¦ä¸º $O(n^2)$ã€‚å½“åºåˆ—é•¿åº¦ $n$ å¾ˆå¤§æ—¶ï¼Œè¿™ç§äºŒæ¬¡å¤æ‚åº¦æˆä¸ºä¸»è¦ç“¶é¢ˆã€‚</p>
<h3 id="3">3. çº¿æ€§æ³¨æ„åŠ›çš„åŸºæœ¬æ€æƒ³</h3>
<p>çº¿æ€§æ³¨æ„åŠ›çš„æ ¸å¿ƒæ€æƒ³æ˜¯é€šè¿‡ç‰¹å¾æ˜ å°„å‡½æ•° $\phi(\cdot)$ å°†æ³¨æ„åŠ›æœºåˆ¶çº¿æ€§åŒ–ï¼Œé¿å…æ˜¾å¼è®¡ç®— $n \times n$ çš„æ³¨æ„åŠ›çŸ©é˜µã€‚</p>
<p><strong>æ ¸æŠ€å·§ï¼ˆKernel Trickï¼‰çš„åº”ç”¨</strong>ï¼š</p>
<p>å‡è®¾å­˜åœ¨ç‰¹å¾æ˜ å°„ $\phi: \mathbb{R}^{d_k} \to \mathbb{R}^{d_\phi}$ï¼Œä½¿å¾—ï¼š</p>
<p>$$
\exp\left(\frac{\boldsymbol{q}_i^T \boldsymbol{k}_j}{\sqrt{d_k}}\right) \approx \phi(\boldsymbol{q}_i)^T \phi(\boldsymbol{k}_j)
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ä¸ªè¿‘ä¼¼æ˜¯çº¿æ€§æ³¨æ„åŠ›çš„å…³é”®ã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥å°†æ³¨æ„åŠ›æƒé‡çš„è®¡ç®—è½¬åŒ–ä¸ºç‰¹å¾ç©ºé—´ä¸­çš„å†…ç§¯è®¡ç®—ã€‚</p>
<h3 id="4">4. çº¿æ€§æ³¨æ„åŠ›çš„æ•°å­¦æ¨å¯¼</h3>
<p>æ ‡å‡†æ³¨æ„åŠ›çš„ç¬¬ $i$ ä¸ªè¾“å‡ºå‘é‡å¯ä»¥å†™æˆï¼š</p>
<p>$$
\boldsymbol{o}_i = \frac{\sum_{j=1}^n \exp(\boldsymbol{q}_i^T \boldsymbol{k}_j) \boldsymbol{v}_j}{\sum_{j=1}^n \exp(\boldsymbol{q}_i^T \boldsymbol{k}_j)}
$$</p>
<p><strong>å¼•å…¥ç‰¹å¾æ˜ å°„åçš„çº¿æ€§åŒ–</strong>ï¼š</p>
<p>ä½¿ç”¨ç‰¹å¾æ˜ å°„ $\phi(\cdot)$ è¿‘ä¼¼ï¼Œæˆ‘ä»¬å¾—åˆ°ï¼š</p>
<p>$$
\boldsymbol{o}_i \approx \frac{\sum_{j=1}^n \phi(\boldsymbol{q}_i)^T \phi(\boldsymbol{k}_j) \boldsymbol{v}_j}{\sum_{j=1}^n \phi(\boldsymbol{q}_i)^T \phi(\boldsymbol{k}_j)}
$$</p>
<p><strong>å…³é”®çš„ä»£æ•°å˜æ¢</strong>ï¼š</p>
<p>åˆ©ç”¨çº¿æ€§ä»£æ•°çš„ç»“åˆå¾‹ï¼Œæˆ‘ä»¬å¯ä»¥é‡æ–°ç»„åˆæ±‚å’Œé¡ºåºï¼š</p>
<p>$$
\boldsymbol{o}_i = \frac{\phi(\boldsymbol{q}_i)^T \left(\sum_{j=1}^n \phi(\boldsymbol{k}_j) \boldsymbol{v}_j^T\right)}{\phi(\boldsymbol{q}_i)^T \left(\sum_{j=1}^n \phi(\boldsymbol{k}_j)\right)}
$$</p>
<p><strong>å®šä¹‰ç´¯ç§¯çŸ©é˜µ</strong>ï¼š</p>
<p>ä»¤ $\boldsymbol{S} = \sum_{j=1}^n \phi(\boldsymbol{k}<em>j) \boldsymbol{v}_j^T \in \mathbb{R}^{d</em>\phi \times d_v}$ å’Œ $\boldsymbol{z} = \sum_{j=1}^n \phi(\boldsymbol{k}<em>j) \in \mathbb{R}^{d</em>\phi}$ï¼Œåˆ™ï¼š</p>
<p>$$
\boldsymbol{o}_i = \frac{\phi(\boldsymbol{q}_i)^T \boldsymbol{S}}{\phi(\boldsymbol{q}_i)^T \boldsymbol{z}}
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ä¸ªé‡æ–°ç»„åˆæ˜¯çº¿æ€§æ³¨æ„åŠ›èƒ½å¤Ÿé™ä½å¤æ‚åº¦çš„å…³é”®ã€‚æ³¨æ„ $\boldsymbol{S}$ å’Œ $\boldsymbol{z}$ åªéœ€è¦è®¡ç®—ä¸€æ¬¡ï¼Œç„¶åå¯ä»¥è¢«æ‰€æœ‰æŸ¥è¯¢ä½ç½®é‡ç”¨ã€‚</p>
<h3 id="5">5. çº¿æ€§æ³¨æ„åŠ›çš„å¤æ‚åº¦åˆ†æ</h3>
<p><strong>è®¡ç®— $\boldsymbol{S}$ çš„å¤æ‚åº¦</strong>ï¼š</p>
<p>$$
\boldsymbol{S} = \sum_{j=1}^n \phi(\boldsymbol{k}_j) \boldsymbol{v}_j^T
$$</p>
<ul>
<li>æ¯ä¸ª $\phi(\boldsymbol{k}<em>j) \boldsymbol{v}_j^T$ æ˜¯ $d</em>\phi \times d_v$ çš„çŸ©é˜µï¼Œéœ€è¦ $O(d_\phi d_v)$ æ—¶é—´</li>
<li>æ€»å…±éœ€è¦ç´¯åŠ  $n$ æ¬¡ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä¸º $O(n d_\phi d_v)$</li>
</ul>
<p><strong>è®¡ç®— $\boldsymbol{z}$ çš„å¤æ‚åº¦</strong>ï¼š</p>
<p>$$
\boldsymbol{z} = \sum_{j=1}^n \phi(\boldsymbol{k}_j)
$$</p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ä¸º $O(n d_\phi)$</li>
</ul>
<p><strong>è®¡ç®—æ‰€æœ‰è¾“å‡ºçš„å¤æ‚åº¦</strong>ï¼š</p>
<p>å¯¹äºæ¯ä¸ªæŸ¥è¯¢ä½ç½® $i$ï¼š</p>
<p>$$
\boldsymbol{o}_i = \frac{\phi(\boldsymbol{q}_i)^T \boldsymbol{S}}{\phi(\boldsymbol{q}_i)^T \boldsymbol{z}}
$$</p>
<ul>
<li>$\phi(\boldsymbol{q}<em>i)^T \boldsymbol{S}$ éœ€è¦ $O(d</em>\phi d_v)$ æ—¶é—´</li>
<li>$\phi(\boldsymbol{q}<em>i)^T \boldsymbol{z}$ éœ€è¦ $O(d</em>\phi)$ æ—¶é—´</li>
<li>å¯¹äº $n$ ä¸ªä½ç½®ï¼Œæ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(n d_\phi d_v)$</li>
</ul>
<p><strong>æ€»ä½“å¤æ‚åº¦</strong>ï¼šçº¿æ€§æ³¨æ„åŠ›çš„æ€»æ—¶é—´å¤æ‚åº¦ä¸º $O(n d_\phi (d_v + d_k))$ï¼Œç›¸æ¯”æ ‡å‡†æ³¨æ„åŠ›çš„ $O(n^2 d_k)$ï¼Œä»åºåˆ—é•¿åº¦çš„äºŒæ¬¡å¤æ‚åº¦é™ä½åˆ°çº¿æ€§å¤æ‚åº¦ã€‚</p>
<h3 id="6">6. å¸¸ç”¨çš„ç‰¹å¾æ˜ å°„å‡½æ•°</h3>
<p><strong>ELUç‰¹å¾æ˜ å°„</strong>ï¼ˆPerformersï¼‰ï¼š</p>
<p>$$
\phi(\boldsymbol{x}) = \text{elu}(\boldsymbol{x}) + 1
$$</p>
<p>å…¶ä¸­ $\text{elu}(x) = \begin{cases} x &amp; \text{if } x &gt; 0 \ e^x - 1 &amp; \text{if } x \leq 0 \end{cases}$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šåŠ 1æ˜¯ä¸ºäº†ä¿è¯æ‰€æœ‰å…ƒç´ éè´Ÿï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿æ³¨æ„åŠ›æƒé‡çš„éè´Ÿæ€§ã€‚</p>
<p><strong>éšæœºç‰¹å¾æ˜ å°„</strong>ï¼ˆPerformersï¼‰ï¼š</p>
<p>$$
\phi(\boldsymbol{x}) = \frac{1}{\sqrt{m}} \left[\cos(\boldsymbol{\omega}_1^T \boldsymbol{x}), \sin(\boldsymbol{\omega}_1^T \boldsymbol{x}), \ldots, \cos(\boldsymbol{\omega}_m^T \boldsymbol{x}), \sin(\boldsymbol{\omega}_m^T \boldsymbol{x})\right]^T
$$</p>
<p>å…¶ä¸­ $\boldsymbol{\omega}_i \sim \mathcal{N}(0, \boldsymbol{I})$ æ˜¯ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒä¸­éšæœºé‡‡æ ·çš„å‘é‡ã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™æ˜¯åŸºäºéšæœºå‚…é‡Œå¶ç‰¹å¾çš„æ˜ å°„ï¼Œç†è®ºä¸Šå¯ä»¥ä»»æ„ç²¾ç¡®åœ°è¿‘ä¼¼é«˜æ–¯æ ¸å‡½æ•°ã€‚</p>
<p><strong>ReLUç‰¹å¾æ˜ å°„</strong>ï¼ˆLinear Attentionï¼‰ï¼š</p>
<p>$$
\phi(\boldsymbol{x}) = \text{ReLU}(\boldsymbol{x}) = \max(0, \boldsymbol{x})
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™æ˜¯æœ€ç®€å•çš„ç‰¹å¾æ˜ å°„ï¼Œè®¡ç®—æ•ˆç‡é«˜ï¼Œä½†è¿‘ä¼¼ç²¾åº¦ç›¸å¯¹è¾ƒä½ã€‚</p>
<h3 id="7">7. å› æœçº¿æ€§æ³¨æ„åŠ›çš„æ¨å¯¼</h3>
<p>åœ¨è‡ªå›å½’åœºæ™¯ä¸­ï¼Œä½ç½® $i$ çš„è¾“å‡ºåªèƒ½ä¾èµ–äºä½ç½® $j \leq i$ çš„ä¿¡æ¯ã€‚å› æœçº¿æ€§æ³¨æ„åŠ›å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<p>$$
\boldsymbol{o}_i = \frac{\sum_{j=1}^i \phi(\boldsymbol{q}_i)^T \phi(\boldsymbol{k}_j) \boldsymbol{v}_j}{\sum_{j=1}^i \phi(\boldsymbol{q}_i)^T \phi(\boldsymbol{k}_j)}
$$</p>
<p><strong>é€’æ¨å½¢å¼çš„æ¨å¯¼</strong>ï¼š</p>
<p>å®šä¹‰ç´¯ç§¯çŠ¶æ€ï¼š</p>
<p>$$
\boldsymbol{S}_i = \sum_{j=1}^i \phi(\boldsymbol{k}_j) \boldsymbol{v}_j^T, \quad \boldsymbol{z}_i = \sum_{j=1}^i \phi(\boldsymbol{k}_j)
$$</p>
<p>åˆ™æœ‰é€’æ¨å…³ç³»ï¼š</p>
<p>$$
\begin{aligned}
\boldsymbol{S}_i &= \boldsymbol{S}_{i-1} + \phi(\boldsymbol{k}_i) \boldsymbol{v}_i^T \\
\boldsymbol{z}_i &= \boldsymbol{z}_{i-1} + \phi(\boldsymbol{k}_i)
\end{aligned}
$$</p>
<p>è¾“å‡ºå¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<p>$$
\boldsymbol{o}_i = \frac{\phi(\boldsymbol{q}_i)^T \boldsymbol{S}_i}{\phi(\boldsymbol{q}_i)^T \boldsymbol{z}_i}
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ç§é€’æ¨å½¢å¼ä½¿å¾—å› æœçº¿æ€§æ³¨æ„åŠ›å¯ä»¥é«˜æ•ˆåœ°å®ç°æµå¼æ¨ç†ï¼Œæ¯ä¸ªæ—¶é—´æ­¥åªéœ€è¦ $O(d_\phi d_v)$ çš„è®¡ç®—é‡ã€‚</p>
<h3 id="8">8. çº¿æ€§æ³¨æ„åŠ›çš„å±€é™æ€§ï¼šç¼ºä¹å±€éƒ¨å»ºæ¨¡èƒ½åŠ›</h3>
<p><strong>é—®é¢˜é™ˆè¿°</strong>ï¼šçº¿æ€§æ³¨æ„åŠ›é€šè¿‡å…¨å±€ç´¯ç§¯çš„æ–¹å¼è®¡ç®—æ³¨æ„åŠ›ï¼Œå¯¼è‡´å®ƒåœ¨å»ºæ¨¡å±€éƒ¨ä¾èµ–å…³ç³»æ—¶èƒ½åŠ›ä¸è¶³ã€‚</p>
<p><strong>æ•°å­¦åˆ†æ</strong>ï¼š</p>
<p>æ ‡å‡†æ³¨æ„åŠ›çš„æƒé‡çŸ©é˜µ $\boldsymbol{A} \in \mathbb{R}^{n \times n}$ æ˜¯ç¨ å¯†çš„ï¼Œç¬¬ $i$ è¡Œçš„æƒé‡åˆ†å¸ƒå¯ä»¥æ˜¯ä»»æ„çš„æ¦‚ç‡åˆ†å¸ƒï¼š</p>
<p>$$
\boldsymbol{A}_{i,:} = \text{softmax}(\boldsymbol{q}_i^T \boldsymbol{K}^T) \in \Delta^{n-1}
$$</p>
<p>å…¶ä¸­ $\Delta^{n-1}$ è¡¨ç¤º $(n-1)$ ç»´å•çº¯å½¢ï¼ˆæ¦‚ç‡å•çº¯å½¢ï¼‰ã€‚</p>
<p><strong>çº¿æ€§æ³¨æ„åŠ›çš„æƒé‡åˆ†å¸ƒ</strong>ï¼š</p>
<p>å¯¹äºçº¿æ€§æ³¨æ„åŠ›ï¼Œæƒé‡å®é™…ä¸Šæ˜¯ï¼š</p>
<p>$$
\alpha_{i,j} = \frac{\phi(\boldsymbol{q}_i)^T \phi(\boldsymbol{k}_j)}{\sum_{k=1}^n \phi(\boldsymbol{q}_i)^T \phi(\boldsymbol{k}_k)}
$$</p>
<p><strong>å±€éƒ¨æ€§ç¼ºå¤±çš„è¯æ˜</strong>ï¼š</p>
<p>è€ƒè™‘ä½ç½® $i$ å¯¹å…¶ç›¸é‚»ä½ç½® $i-1$ å’Œ $i+1$ çš„æ³¨æ„åŠ›æƒé‡ã€‚åœ¨æ ‡å‡†æ³¨æ„åŠ›ä¸­ï¼Œå¯ä»¥é€šè¿‡è°ƒæ•´ $\boldsymbol{q}<em i-1="i-1">i$ã€$\boldsymbol{k}</em>$ ä½¿å¾—ï¼š}$ã€$\boldsymbol{k}_{i+1</p>
<p>$$
\alpha_{i,i-1} + \alpha_{i,i+1} \approx 1
$$</p>
<p>å³å‡ ä¹æ‰€æœ‰æ³¨æ„åŠ›é›†ä¸­åœ¨ç›¸é‚»ä½ç½®ã€‚</p>
<p>ä½†åœ¨çº¿æ€§æ³¨æ„åŠ›ä¸­ï¼Œç”±äºç‰¹å¾æ˜ å°„ $\phi$ é€šå¸¸æ˜¯é€å…ƒç´ çš„éçº¿æ€§å‡½æ•°ï¼Œå®ƒéš¾ä»¥äº§ç”Ÿè¿™ç§å°–é”çš„å±€éƒ¨æ³¨æ„åŠ›åˆ†å¸ƒã€‚ç‰¹åˆ«æ˜¯ï¼Œ$\phi(\boldsymbol{q}<em k="1">i)^T \phi(\boldsymbol{k}_j)$ çš„å€¼å—åˆ°å…¨å±€å½’ä¸€åŒ–é¡¹ $\sum</em>_k)$ çš„å½±å“ï¼Œéš¾ä»¥å®ç°é«˜åº¦å±€éƒ¨åŒ–çš„æƒé‡åˆ†é…ã€‚}^n \phi(\boldsymbol{q}_i)^T \phi(\boldsymbol{k</p>
<h3 id="9-short-conv">9. çŸ­å·ç§¯ï¼ˆShort Convï¼‰çš„æ•°å­¦å®šä¹‰</h3>
<p>çŸ­å·ç§¯æ˜¯ä¸€ç§å·ç§¯æ ¸å¤§å°è¾ƒå°çš„ä¸€ç»´å·ç§¯æ“ä½œï¼Œé€šå¸¸æ ¸å¤§å° $k \in {3, 5, 7}$ã€‚</p>
<p><strong>ä¸€ç»´å·ç§¯çš„æ•°å­¦è¡¨ç¤º</strong>ï¼š</p>
<p>å¯¹äºè¾“å…¥åºåˆ— $\boldsymbol{X} = [\boldsymbol{x}_1, \boldsymbol{x}_2, \ldots, \boldsymbol{x}_n] \in \mathbb{R}^{n \times d}$ï¼Œå·ç§¯æ“ä½œå®šä¹‰ä¸ºï¼š</p>
<p>$$
\boldsymbol{y}_i = \sum_{j=-(k-1)/2}^{(k-1)/2} \boldsymbol{W}_j \boldsymbol{x}_{i+j} + \boldsymbol{b}
$$</p>
<p>å…¶ä¸­ $\boldsymbol{W}_j \in \mathbb{R}^{d \times d}$ æ˜¯ç¬¬ $j$ ä¸ªä½ç½®çš„å·ç§¯æ ¸æƒé‡ï¼Œ$\boldsymbol{b} \in \mathbb{R}^d$ æ˜¯åç½®é¡¹ã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™é‡Œå‡è®¾å·ç§¯æ ¸å¤§å° $k$ æ˜¯å¥‡æ•°ï¼Œä¸­å¿ƒåœ¨ä½ç½®0ã€‚å¯¹äºè¾¹ç•Œä½ç½®ï¼Œé€šå¸¸ä½¿ç”¨paddingç­–ç•¥ã€‚</p>
<h3 id="10">10. æ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„æ•°å­¦è¡¨ç¤º</h3>
<p>åœ¨å®è·µä¸­ï¼Œä¸ºäº†é™ä½è®¡ç®—é‡ï¼ŒçŸ­å·ç§¯é€šå¸¸ä½¿ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼ˆDepthwise Separable Convolutionï¼‰å®ç°ã€‚</p>
<p><strong>æ·±åº¦å·ç§¯ï¼ˆDepthwise Convolutionï¼‰</strong>ï¼š</p>
<p>$$
\boldsymbol{y}_i^{(c)} = \sum_{j=-(k-1)/2}^{(k-1)/2} w_j^{(c)} \boldsymbol{x}_{i+j}^{(c)} + b^{(c)}
$$</p>
<p>å…¶ä¸­ $c \in {1, 2, \ldots, d}$ æ˜¯é€šé“ç´¢å¼•ï¼Œæ¯ä¸ªé€šé“ç‹¬ç«‹åº”ç”¨ä¸€ç»´å·ç§¯ã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šæ·±åº¦å·ç§¯å°†æ ‡å‡†å·ç§¯çš„ $O(k d^2)$ å‚æ•°é‡é™ä½åˆ° $O(k d)$ã€‚</p>
<p><strong>é€ç‚¹å·ç§¯ï¼ˆPointwise Convolutionï¼‰</strong>ï¼š</p>
<p>$$
\boldsymbol{z}_i = \boldsymbol{W}_p \boldsymbol{y}_i + \boldsymbol{b}_p
$$</p>
<p>å…¶ä¸­ $\boldsymbol{W}_p \in \mathbb{R}^{d \times d}$ æ˜¯é€ç‚¹å·ç§¯çš„æƒé‡çŸ©é˜µã€‚</p>
<p><strong>å®Œæ•´çš„æ·±åº¦å¯åˆ†ç¦»å·ç§¯</strong>ï¼š</p>
<p>$$
\text{ShortConv}(\boldsymbol{X}) = \boldsymbol{W}_p \cdot \text{DepthwiseConv}(\boldsymbol{X}) + \boldsymbol{b}_p
$$</p>
<p><strong>å¤æ‚åº¦åˆ†æ</strong>ï¼šæ·±åº¦å¯åˆ†ç¦»å·ç§¯çš„å‚æ•°é‡ä¸º $O(kd + d^2)$ï¼Œè®¡ç®—é‡ä¸º $O(n(kd + d^2))$ï¼Œç›¸æ¯”æ ‡å‡†å·ç§¯çš„ $O(kd^2)$ å‚æ•°é‡æ˜¾è‘—é™ä½ã€‚</p>
<h3 id="11">11. å› æœå·ç§¯çš„æ•°å­¦æ€§è´¨</h3>
<p>åœ¨è‡ªå›å½’æ¨¡å‹ä¸­ï¼Œéœ€è¦ä½¿ç”¨å› æœå·ç§¯ï¼ˆCausal Convolutionï¼‰ç¡®ä¿ä½ç½® $i$ çš„è¾“å‡ºä¸ä¾èµ–äºæœªæ¥ä½ç½®ã€‚</p>
<p><strong>å› æœå·ç§¯çš„å®šä¹‰</strong>ï¼š</p>
<p>$$
\boldsymbol{y}_i = \sum_{j=0}^{k-1} \boldsymbol{W}_j \boldsymbol{x}_{i-j}
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šä¸æ ‡å‡†å·ç§¯ä¸åŒï¼Œå› æœå·ç§¯åªå‘å·¦çœ‹ï¼ˆåªä¾èµ–å†å²ä¿¡æ¯ï¼‰ï¼Œå·ç§¯æ ¸ä»å½“å‰ä½ç½®å‘å·¦å»¶ä¼¸ $k-1$ ä¸ªä½ç½®ã€‚</p>
<p><strong>å› æœæ€§çš„å½¢å¼åŒ–å®šä¹‰</strong>ï¼š</p>
<p>å®šä¹‰å‡½æ•° $f: \mathbb{R}^{n \times d} \to \mathbb{R}^{n \times d}$ æ˜¯å› æœçš„ï¼Œå½“ä¸”ä»…å½“ï¼š</p>
<p>$$
\forall i \in \{1, \ldots, n\}, \quad f(\boldsymbol{X})_i = g(\boldsymbol{x}_1, \ldots, \boldsymbol{x}_i)
$$</p>
<p>å³ä½ç½® $i$ çš„è¾“å‡ºåªä¾èµ–äºä½ç½® $1$ åˆ° $i$ çš„è¾“å…¥ã€‚</p>
<p><strong>å› æœå·ç§¯çš„å› æœæ€§è¯æ˜</strong>ï¼š</p>
<p>å¯¹äºå› æœå·ç§¯ $\boldsymbol{y}<em j="0">i = \sum</em>}^{k-1} \boldsymbol{W<em i-j="i-j">j \boldsymbol{x}</em>}$ï¼Œæ˜¾ç„¶ $\boldsymbol{y<em i-k_1="i-k+1">i$ åªä¾èµ–äº $\boldsymbol{x}</em>_i$ï¼Œæ»¡è¶³å› æœæ€§å®šä¹‰ã€‚}, \ldots, \boldsymbol{x</p>
<h3 id="12">12. å·ç§¯çš„æ„Ÿå—é‡åˆ†æ</h3>
<p><strong>å•å±‚å·ç§¯çš„æ„Ÿå—é‡</strong>ï¼š</p>
<p>å¯¹äºæ ¸å¤§å°ä¸º $k$ çš„å·ç§¯å±‚ï¼Œæ¯ä¸ªè¾“å‡ºä½ç½®çš„æ„Ÿå—é‡ï¼ˆreceptive fieldï¼‰å¤§å°ä¸º $k$ã€‚</p>
<p>$$
\text{RF}_1 = k
$$</p>
<p><strong>å¤šå±‚å·ç§¯çš„æ„Ÿå—é‡</strong>ï¼š</p>
<p>å¯¹äº $L$ å±‚æ ¸å¤§å°ä¸º $k$ çš„å·ç§¯ç½‘ç»œï¼Œæ„Ÿå—é‡å‘ˆçº¿æ€§å¢é•¿ï¼š</p>
<p>$$
\text{RF}_L = 1 + L(k-1)
$$</p>
<p><strong>æ¨å¯¼è¿‡ç¨‹</strong>ï¼š</p>
<ul>
<li>ç¬¬1å±‚ï¼šæ„Ÿå—é‡ä¸º $k$</li>
<li>ç¬¬2å±‚ï¼šæ¯ä¸ªä½ç½®çœ‹åˆ°ç¬¬1å±‚çš„ $k$ ä¸ªä½ç½®ï¼Œè€Œç¬¬1å±‚æ¯ä¸ªä½ç½®çœ‹åˆ°è¾“å…¥çš„ $k$ ä¸ªä½ç½®ï¼Œå› æ­¤æ€»æ„Ÿå—é‡ä¸º $k + (k-1) = 2k - 1$</li>
<li>ç¬¬ $L$ å±‚ï¼šé€’æ¨å¯å¾— $\text{RF}_L = k + (L-1)(k-1) = 1 + L(k-1)$</li>
</ul>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™è¯´æ˜å·ç§¯ç½‘ç»œçš„æ„Ÿå—é‡å¢é•¿ç›¸å¯¹ç¼“æ…¢ï¼Œè¦è¦†ç›–é•¿è·ç¦»ä¾èµ–éœ€è¦å †å å¤šå±‚æˆ–ä½¿ç”¨æ‰©å¼ å·ç§¯ï¼ˆdilated convolutionï¼‰ã€‚</p>
<h3 id="13-short-conv">13. Short Convçš„å±€éƒ¨å»ºæ¨¡èƒ½åŠ›</h3>
<p>çŸ­å·ç§¯å¤©ç„¶å…·æœ‰å±€éƒ¨å»ºæ¨¡èƒ½åŠ›ï¼Œè¿™ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>
<p><strong>ä½ç½®ç›¸å…³çš„æƒé‡åˆ†é…</strong>ï¼š</p>
<p>å¯¹äºä½ç½® $i$ï¼Œå…¶è¾“å‡º $\boldsymbol{y}_i$ å¯¹ä¸åŒä½ç½®è¾“å…¥çš„æƒé‡æ˜¯å›ºå®šçš„ï¼š</p>
<p>$$
\frac{\partial \boldsymbol{y}_i}{\partial \boldsymbol{x}_{i+j}} = \begin{cases} \boldsymbol{W}_j & \text{if } |j| \leq (k-1)/2 \\ \boldsymbol{0} & \text{otherwise} \end{cases}
$$</p>
<p><strong>å±€éƒ¨æ€§çš„æ•°å­¦åˆ»ç”»</strong>ï¼š</p>
<p>å®šä¹‰å±€éƒ¨æ€§åº¦é‡ä¸ºéé›¶æ¢¯åº¦çš„èŒƒå›´ï¼š</p>
<p>$$
\text{Locality}(\text{ShortConv}) = k
$$</p>
<p>ç›¸æ¯”ä¹‹ä¸‹ï¼Œå…¨å±€æ³¨æ„åŠ›çš„å±€éƒ¨æ€§åº¦é‡ä¸ºï¼š</p>
<p>$$
\text{Locality}(\text{Attention}) = n
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šçŸ­å·ç§¯çš„å±€éƒ¨æ€§åº¦é‡ä¸åºåˆ—é•¿åº¦ $n$ æ— å…³ï¼Œè¿™ä½¿å¾—å®ƒåœ¨å»ºæ¨¡å±€éƒ¨æ¨¡å¼æ—¶æ›´åŠ é«˜æ•ˆå’Œç¨³å®šã€‚</p>
<h3 id="14">14. çº¿æ€§æ³¨æ„åŠ›çš„è¡¨è¾¾èƒ½åŠ›é™åˆ¶</h3>
<p><strong>æ³›å‡½åˆ†æè§†è§’</strong>ï¼š</p>
<p>å°†æ³¨æ„åŠ›æœºåˆ¶è§†ä¸ºä¸€ä¸ªä»è¾“å…¥åºåˆ—åˆ°è¾“å‡ºåºåˆ—çš„æ˜ å°„ï¼š</p>
<p>$$
\mathcal{F}: (\mathbb{R}^d)^n \to (\mathbb{R}^d)^n
$$</p>
<p>æ ‡å‡†æ³¨æ„åŠ›å¯ä»¥è¡¨ç¤ºä»»æ„çš„æ’åˆ—ä¸å˜å‡½æ•°ï¼ˆpermutation-invariant functionï¼‰ï¼Œä½†çº¿æ€§æ³¨æ„åŠ›ç”±äºå…¶è¿‘ä¼¼æ€§è´¨ï¼Œè¡¨è¾¾èƒ½åŠ›å—åˆ°é™åˆ¶ã€‚</p>
<p><strong>çº¿æ€§æ³¨æ„åŠ›çš„è¡¨è¾¾èƒ½åŠ›ç•Œ</strong>ï¼š</p>
<p>è®¾ $f$ æ˜¯æ ‡å‡†æ³¨æ„åŠ›å®ç°çš„å‡½æ•°ï¼Œ$\tilde{f}$ æ˜¯çº¿æ€§æ³¨æ„åŠ›çš„è¿‘ä¼¼ï¼Œåˆ™å­˜åœ¨è¯¯å·®ç•Œï¼š</p>
<p>$$
\|\mathcal{F}(\boldsymbol{X}) - \tilde{\mathcal{F}}(\boldsymbol{X})\|_F \leq C \cdot \epsilon(\phi)
$$</p>
<p>å…¶ä¸­ $\epsilon(\phi)$ æ˜¯ç‰¹å¾æ˜ å°„ $\phi$ å¯¹softmaxæ ¸çš„è¿‘ä¼¼è¯¯å·®ï¼Œ$C$ æ˜¯ä¾èµ–äºè¾“å…¥çš„å¸¸æ•°ã€‚</p>
<p><strong>è¿‘ä¼¼è¯¯å·®çš„æ¥æº</strong>ï¼š</p>
<ol>
<li><strong>æ ¸å‡½æ•°è¿‘ä¼¼è¯¯å·®</strong>ï¼š$\exp(\boldsymbol{q}^T \boldsymbol{k}) \approx \phi(\boldsymbol{q})^T \phi(\boldsymbol{k})$ çš„è¿‘ä¼¼è¯¯å·®</li>
<li><strong>æ³¨æ„åŠ›åˆ†å¸ƒè¯¯å·®</strong>ï¼šè¿‘ä¼¼åçš„æ³¨æ„åŠ›åˆ†å¸ƒä¸çœŸå®åˆ†å¸ƒçš„åå·®</li>
<li><strong>è¾“å‡ºåŠ æƒè¯¯å·®</strong>ï¼šè¯¯å·®åœ¨åŠ æƒæ±‚å’Œè¿‡ç¨‹ä¸­çš„ç´¯ç§¯</li>
</ol>
<h3 id="15-short-conv">15. Short Convè¡¥å¿çº¿æ€§æ³¨æ„åŠ›çš„ç†è®ºä¾æ®</h3>
<p><strong>äº’è¡¥æ€§åŸç†</strong>ï¼š</p>
<p>çº¿æ€§æ³¨æ„åŠ›æ“…é•¿å…¨å±€ä¿¡æ¯èšåˆï¼Œä½†ç¼ºä¹å±€éƒ¨å»ºæ¨¡èƒ½åŠ›ï¼›çŸ­å·ç§¯æ“…é•¿å±€éƒ¨ç‰¹å¾æå–ï¼Œä½†æ„Ÿå—é‡æœ‰é™ã€‚ä¸¤è€…çš„ç»“åˆå¯ä»¥å®ç°ä¼˜åŠ¿äº’è¡¥ã€‚</p>
<p><strong>æ•°å­¦è¡¨ç¤º</strong>ï¼š</p>
<p>ç»“åˆåçš„æœºåˆ¶å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<p>$$
\boldsymbol{O} = \text{LinearAttention}(\text{ShortConv}(\boldsymbol{Q}), \text{ShortConv}(\boldsymbol{K}), \text{ShortConv}(\boldsymbol{V}))
$$</p>
<p>æˆ–è€…ï¼š</p>
<p>$$
\boldsymbol{O} = \text{ShortConv}(\text{LinearAttention}(\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}))
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šå‰è€…æ˜¯åœ¨æ³¨æ„åŠ›ä¹‹å‰åº”ç”¨çŸ­å·ç§¯ï¼ˆpre-convï¼‰ï¼Œåè€…æ˜¯åœ¨æ³¨æ„åŠ›ä¹‹ååº”ç”¨ï¼ˆpost-convï¼‰ã€‚å®è·µä¸­é€šå¸¸ä½¿ç”¨pre-convï¼Œå› ä¸ºå®ƒå¯ä»¥è®©æ³¨æ„åŠ›æœºåˆ¶å¤„ç†å·²ç»è¿‡å±€éƒ¨å¢å¼ºçš„ç‰¹å¾ã€‚</p>
<h3 id="16">16. è”åˆæœºåˆ¶çš„è¡¨è¾¾èƒ½åŠ›åˆ†æ</h3>
<p><strong>å®šç†</strong>ï¼ˆè”åˆæœºåˆ¶çš„è¡¨è¾¾èƒ½åŠ›ï¼‰ï¼š</p>
<p>è®¾ $\mathcal{F}<em _text_conv="\text{conv">{\text{linear}}$ æ˜¯çº¿æ€§æ³¨æ„åŠ›çš„å‡½æ•°ç©ºé—´ï¼Œ$\mathcal{F}</em>$ æ˜¯çŸ­å·ç§¯çš„å‡½æ•°ç©ºé—´ï¼Œåˆ™è”åˆæœºåˆ¶çš„å‡½æ•°ç©ºé—´æ»¡è¶³ï¼š}</p>
<p>$$
\mathcal{F}_{\text{linear}} \cup \mathcal{F}_{\text{conv}} \subseteq \mathcal{F}_{\text{joint}} \subseteq \mathcal{F}_{\text{linear}} \otimes \mathcal{F}_{\text{conv}}
$$</p>
<p>å…¶ä¸­ $\otimes$ è¡¨ç¤ºå‡½æ•°ç©ºé—´çš„å¼ é‡ç§¯ã€‚</p>
<p><strong>è¯æ˜æ€è·¯</strong>ï¼š</p>
<ol>
<li>
<p><strong>åŒ…å«æ€§</strong>ï¼šè”åˆæœºåˆ¶å¯ä»¥é€šè¿‡é€‚å½“çš„å‚æ•°è®¾ç½®é€€åŒ–ä¸ºçº¯çº¿æ€§æ³¨æ„åŠ›æˆ–çº¯çŸ­å·ç§¯ï¼Œå› æ­¤ $\mathcal{F}<em _text_conv="\text{conv">{\text{linear}} \cup \mathcal{F}</em>$}} \subseteq \mathcal{F}_{\text{joint}</p>
</li>
<li>
<p><strong>æœ‰ç•Œæ€§</strong>ï¼šè”åˆæœºåˆ¶çš„è¾“å‡ºå¯ä»¥åˆ†è§£ä¸ºä¸¤éƒ¨åˆ†çš„ç»„åˆï¼Œå› æ­¤ $\mathcal{F}<em _text_linear="\text{linear">{\text{joint}} \subseteq \mathcal{F}</em>$}} \otimes \mathcal{F}_{\text{conv}</p>
</li>
</ol>
<p><strong>æ³¨é‡Š</strong>ï¼šè¿™ä¸ªå®šç†è¯´æ˜è”åˆæœºåˆ¶çš„è¡¨è¾¾èƒ½åŠ›è‡³å°‘ä¸å°äºå•ç‹¬ä½¿ç”¨ä»»ä¸€æœºåˆ¶ï¼Œä¸”å¯èƒ½æ›´å¼ºã€‚</p>
<h3 id="17-short-conv">17. é¢‘åŸŸåˆ†æï¼šShort Convçš„é¢‘ç‡å“åº”</h3>
<p><strong>ç¦»æ•£æ—¶é—´å‚…é‡Œå¶å˜æ¢ï¼ˆDTFTï¼‰</strong>ï¼š</p>
<p>å¯¹äºå·ç§¯æ ¸ $\boldsymbol{w} = [w_0, w_1, \ldots, w_{k-1}]$ï¼Œå…¶é¢‘ç‡å“åº”ä¸ºï¼š</p>
<p>$$
H(\omega) = \sum_{j=0}^{k-1} w_j e^{-i\omega j}
$$</p>
<p>å…¶ä¸­ $\omega \in [0, 2\pi]$ æ˜¯è§’é¢‘ç‡ã€‚</p>
<p><strong>çŸ­å·ç§¯çš„é¢‘ç‡ç‰¹æ€§</strong>ï¼š</p>
<p>å¯¹äºæ ¸å¤§å° $k=3$ çš„çŸ­å·ç§¯ $[w_{-1}, w_0, w_1]$ï¼Œé¢‘ç‡å“åº”ä¸ºï¼š</p>
<p>$$
H(\omega) = w_0 + w_1 e^{-i\omega} + w_{-1} e^{i\omega} = w_0 + 2\text{Re}(w_1 e^{-i\omega})
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šçŸ­å·ç§¯é€šå¸¸è¡¨ç°ä¸ºä½é€šæ»¤æ³¢å™¨æˆ–å¸¦é€šæ»¤æ³¢å™¨ï¼Œèƒ½å¤Ÿå¹³æ»‘é«˜é¢‘å™ªå£°å¹¶ä¿ç•™ä½é¢‘è¶‹åŠ¿ä¿¡æ¯ã€‚</p>
<h3 id="18">18. çº¿æ€§æ³¨æ„åŠ›çš„é¢‘ç‡ç‰¹æ€§</h3>
<p><strong>çº¿æ€§æ³¨æ„åŠ›åœ¨é¢‘åŸŸçš„è¡¨ç¤º</strong>ï¼š</p>
<p>çº¿æ€§æ³¨æ„åŠ›çš„è¾“å‡ºå¯ä»¥å†™æˆï¼š</p>
<p>$$
\boldsymbol{O} = \text{diag}^{-1}(\boldsymbol{\Phi}_Q \boldsymbol{\Phi}_K^T \mathbf{1}) \cdot \boldsymbol{\Phi}_Q \boldsymbol{\Phi}_K^T \boldsymbol{V}
$$</p>
<p>å…¶ä¸­ $\boldsymbol{\Phi}_Q = [\phi(\boldsymbol{q}_1), \ldots, \phi(\boldsymbol{q}_n)]^T$ï¼Œ$\mathbf{1}$ æ˜¯å…¨1å‘é‡ã€‚</p>
<p><strong>é¢‘åŸŸç‰¹æ€§</strong>ï¼š</p>
<p>çº¿æ€§æ³¨æ„åŠ›çš„é¢‘ç‡å“åº”æ˜¯è¾“å…¥ç›¸å…³çš„ï¼Œä¸åƒå·ç§¯é‚£æ ·æœ‰å›ºå®šçš„é¢‘ç‡å“åº”å‡½æ•°ã€‚å¯¹äºç‰¹å¾æ˜ å°„ $\phi(\boldsymbol{x}) = \text{ReLU}(\boldsymbol{x})$ï¼Œçº¿æ€§æ³¨æ„åŠ›å€¾å‘äºä¿ç•™æ‰€æœ‰é¢‘ç‡æˆåˆ†ï¼Œä½†é«˜é¢‘æˆåˆ†å¯èƒ½ç”±äºå½’ä¸€åŒ–è€Œè¢«å‰Šå¼±ã€‚</p>
<p><strong>äº’è¡¥æ€§çš„é¢‘åŸŸè§£é‡Š</strong>ï¼š</p>
<ul>
<li>çŸ­å·ç§¯ï¼šæä¾›å›ºå®šçš„é¢‘ç‡æ»¤æ³¢ï¼Œå¼ºåŒ–å±€éƒ¨å¹³æ»‘æ€§</li>
<li>çº¿æ€§æ³¨æ„åŠ›ï¼šæä¾›å†…å®¹è‡ªé€‚åº”çš„å…¨å±€ä¿¡æ¯æ•´åˆ</li>
</ul>
<p>ä¸¤è€…ç»“åˆå¯ä»¥åœ¨é¢‘åŸŸä¸Šå®ç°æ›´å…¨é¢çš„ä¿¡å·å¤„ç†ã€‚</p>
<h3 id="19">19. è®¡ç®—å¤æ‚åº¦çš„ä¸¥æ ¼å¯¹æ¯”</h3>
<p><strong>æ ‡å‡†æ³¨æ„åŠ›</strong>ï¼š</p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼š$O(n^2 d)$</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼š$O(n^2 + nd)$</li>
</ul>
<p><strong>çº¿æ€§æ³¨æ„åŠ›</strong>ï¼š</p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼š$O(nd_\phi d)$</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼š$O(d_\phi d + nd)$</li>
</ul>
<p><strong>Short Conv</strong>ï¼š</p>
<ul>
<li>æ—¶é—´å¤æ‚åº¦ï¼š$O(nkd)$ï¼ˆæ·±åº¦å¯åˆ†ç¦»ï¼‰æˆ– $O(nkd^2)$ï¼ˆæ ‡å‡†å·ç§¯ï¼‰</li>
<li>ç©ºé—´å¤æ‚åº¦ï¼š$O(kd + nd)$</li>
</ul>
<p><strong>è”åˆæœºåˆ¶ï¼ˆLinear Attention + Short Convï¼‰</strong>ï¼š</p>
<p>å‡è®¾åœ¨Qã€Kã€Vä¸Šéƒ½åº”ç”¨Short Convï¼Œç„¶åè¿›è¡Œçº¿æ€§æ³¨æ„åŠ›ï¼š</p>
<p>$$
\begin{aligned}
\text{æ—¶é—´å¤æ‚åº¦} &= 3 \times O(nkd) + O(nd_\phi d) \\
&= O(n(3kd + d_\phi d)) \\
&= O(nd(3k + d_\phi))
\end{aligned}
$$</p>
<p><strong>å¤æ‚åº¦å¯¹æ¯”è¡¨</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æœºåˆ¶</th>
<th>æ—¶é—´å¤æ‚åº¦</th>
<th>åºåˆ—é•¿åº¦ä¾èµ–</th>
</tr>
</thead>
<tbody>
<tr>
<td>æ ‡å‡†æ³¨æ„åŠ›</td>
<td>$O(n^2 d)$</td>
<td>äºŒæ¬¡</td>
</tr>
<tr>
<td>çº¿æ€§æ³¨æ„åŠ›</td>
<td>$O(nd_\phi d)$</td>
<td>çº¿æ€§</td>
</tr>
<tr>
<td>Short Conv</td>
<td>$O(nkd)$</td>
<td>çº¿æ€§</td>
</tr>
<tr>
<td>è”åˆæœºåˆ¶</td>
<td>$O(nd(3k + d_\phi))$</td>
<td>çº¿æ€§</td>
</tr>
</tbody>
</table>
<p><strong>æ³¨é‡Š</strong>ï¼šè”åˆæœºåˆ¶ä¿æŒäº†çº¿æ€§å¤æ‚åº¦ï¼Œä»…å¢åŠ äº†ä¸€ä¸ªè¾ƒå°çš„å¸¸æ•°å› å­ $3k$ï¼Œé€šå¸¸ $k \in {3, 5, 7}$ã€‚</p>
<h3 id="20-deltanet">20. DeltaNetä¸­çš„å…·ä½“å®ç°</h3>
<p>DeltaNetä¸­çš„è”åˆæœºåˆ¶å¯ä»¥è¡¨ç¤ºä¸ºï¼š</p>
<p>$$
\begin{aligned}
\tilde{\boldsymbol{Q}} &= \text{ShortConv}(\boldsymbol{Q}) \\
\tilde{\boldsymbol{K}} &= \text{ShortConv}(\boldsymbol{K}) \\
\tilde{\boldsymbol{V}} &= \text{ShortConv}(\boldsymbol{V}) \\
\boldsymbol{O} &= \text{LinearAttention}(\tilde{\boldsymbol{Q}}, \tilde{\boldsymbol{K}}, \tilde{\boldsymbol{V}})
\end{aligned}
$$</p>
<p><strong>Short Convçš„å‚æ•°åŒ–</strong>ï¼š</p>
<p>DeltaNetä½¿ç”¨æ·±åº¦å¯åˆ†ç¦»å·ç§¯ï¼Œå¯¹äºç»´åº¦ $d$ çš„è¾“å…¥ï¼š</p>
<p>$$
\text{ShortConv}(\boldsymbol{X})_i = \boldsymbol{W}_p \left( \bigoplus_{c=1}^d \sum_{j=0}^{k-1} w_j^{(c)} x_{i-j}^{(c)} \right)
$$</p>
<p>å…¶ä¸­ $\bigoplus$ è¡¨ç¤ºé€šé“æ‹¼æ¥ï¼Œ$\boldsymbol{W}_p \in \mathbb{R}^{d \times d}$ æ˜¯é€ç‚¹å·ç§¯æƒé‡ã€‚</p>
<p><strong>çº¿æ€§æ³¨æ„åŠ›çš„å‚æ•°åŒ–</strong>ï¼š</p>
<p>DeltaNetä½¿ç”¨é—¨æ§æœºåˆ¶å’Œç‰¹æ®Šçš„ç‰¹å¾æ˜ å°„ï¼š</p>
<p>$$
\phi(\boldsymbol{x}) = \text{swish}(\boldsymbol{x}) \cdot \boldsymbol{g}
$$</p>
<p>å…¶ä¸­ $\boldsymbol{g} = \sigma(\boldsymbol{W}_g \boldsymbol{x} + \boldsymbol{b}_g)$ æ˜¯é—¨æ§å‘é‡ï¼Œ$\text{swish}(x) = x \cdot \sigma(x)$ã€‚</p>
<h3 id="21-short-conv">21. å› æœæ©ç ä¸Short Convçš„ç»“åˆ</h3>
<p>åœ¨è‡ªå›å½’ç”Ÿæˆä¸­ï¼Œéœ€è¦åŒæ—¶è€ƒè™‘å› æœæ€§çº¦æŸï¼š</p>
<p><strong>å› æœShort Conv + å› æœçº¿æ€§æ³¨æ„åŠ›</strong>ï¼š</p>
<p>$$
\begin{aligned}
\tilde{\boldsymbol{q}}_i &= \sum_{j=0}^{k-1} \boldsymbol{W}_j^Q \boldsymbol{q}_{i-j} \\
\tilde{\boldsymbol{k}}_i &= \sum_{j=0}^{k-1} \boldsymbol{W}_j^K \boldsymbol{k}_{i-j} \\
\tilde{\boldsymbol{v}}_i &= \sum_{j=0}^{k-1} \boldsymbol{W}_j^V \boldsymbol{v}_{i-j} \\
\boldsymbol{S}_i &= \boldsymbol{S}_{i-1} + \phi(\tilde{\boldsymbol{k}}_i) \tilde{\boldsymbol{v}}_i^T \\
\boldsymbol{z}_i &= \boldsymbol{z}_{i-1} + \phi(\tilde{\boldsymbol{k}}_i) \\
\boldsymbol{o}_i &= \frac{\phi(\tilde{\boldsymbol{q}}_i)^T \boldsymbol{S}_i}{\phi(\tilde{\boldsymbol{q}}_i)^T \boldsymbol{z}_i}
\end{aligned}
$$</p>
<p><strong>é€’æ¨è®¡ç®—çš„çŠ¶æ€ç»´æŠ¤</strong>ï¼š</p>
<p>éœ€è¦ç»´æŠ¤çš„çŠ¶æ€åŒ…æ‹¬ï¼š</p>
<ol>
<li>çº¿æ€§æ³¨æ„åŠ›çš„ç´¯ç§¯çŸ©é˜µ $\boldsymbol{S}<em>i \in \mathbb{R}^{d</em>\phi \times d_v}$</li>
<li>çº¿æ€§æ³¨æ„åŠ›çš„å½’ä¸€åŒ–å‘é‡ $\boldsymbol{z}<em>i \in \mathbb{R}^{d</em>\phi}$</li>
<li>çŸ­å·ç§¯çš„å†å²ç¼“å­˜ $[\boldsymbol{q}<em i-k_1="i-k+1">{i-k+1}, \ldots, \boldsymbol{q}_i]$, $[\boldsymbol{k}</em>}, \ldots, \boldsymbol{k<em i-k_1="i-k+1">i]$, $[\boldsymbol{v}</em>_i]$}, \ldots, \boldsymbol{v</li>
</ol>
<p><strong>çŠ¶æ€ç©ºé—´å¤æ‚åº¦</strong>ï¼š</p>
<p>$$
\text{Space} = O(d_\phi d_v + d_\phi + 3kd) = O(d_\phi d_v + kd)
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šç›¸æ¯”çº¯çº¿æ€§æ³¨æ„åŠ›ï¼Œè”åˆæœºåˆ¶ä»…å¢åŠ äº† $O(kd)$ çš„çŠ¶æ€å­˜å‚¨ï¼Œé€šå¸¸ $k$ å¾ˆå°ï¼ˆ3-7ï¼‰ï¼Œå› æ­¤å¢åŠ çš„å¼€é”€å¯æ¥å—ã€‚</p>
<h3 id="22">22. è®­ç»ƒç¨³å®šæ€§åˆ†æ</h3>
<p><strong>æ¢¯åº¦æµåˆ†æ</strong>ï¼š</p>
<p>å¯¹äºæŸå¤±å‡½æ•° $\mathcal{L}$ï¼Œå…¶å…³äºè¾“å…¥ $\boldsymbol{X}$ çš„æ¢¯åº¦å¯ä»¥é€šè¿‡é“¾å¼æ³•åˆ™è®¡ç®—ï¼š</p>
<p>$$
\frac{\partial \mathcal{L}}{\partial \boldsymbol{X}} = \frac{\partial \mathcal{L}}{\partial \boldsymbol{O}} \frac{\partial \boldsymbol{O}}{\partial \tilde{\boldsymbol{V}}} \frac{\partial \tilde{\boldsymbol{V}}}{\partial \boldsymbol{V}} \frac{\partial \boldsymbol{V}}{\partial \boldsymbol{X}} + \text{å…¶ä»–è·¯å¾„}
$$</p>
<p><strong>Short Convå¯¹æ¢¯åº¦æµçš„å½±å“</strong>ï¼š</p>
<p>çŸ­å·ç§¯æä¾›äº†é¢å¤–çš„æ¢¯åº¦ä¼ æ’­è·¯å¾„ï¼Œå¯ä»¥ç¼“è§£çº¿æ€§æ³¨æ„åŠ›å¯èƒ½å­˜åœ¨çš„æ¢¯åº¦æ¶ˆå¤±é—®é¢˜ã€‚å…·ä½“åœ°ï¼Œå¯¹äº $L$ å±‚ç½‘ç»œï¼Œæ¢¯åº¦çš„èŒƒæ•°æ»¡è¶³ï¼š</p>
<p>$$
\left\|\frac{\partial \mathcal{L}}{\partial \boldsymbol{X}^{(1)}}\right\| \geq \frac{\|\frac{\partial \mathcal{L}}{\partial \boldsymbol{X}^{(L)}}\|}{C^L}
$$</p>
<p>å…¶ä¸­ $C$ æ˜¯ä¾èµ–äºæ¿€æ´»å‡½æ•°å’Œå½’ä¸€åŒ–æ–¹å¼çš„å¸¸æ•°ã€‚çŸ­å·ç§¯çš„å¼•å…¥å¯ä»¥å‡å° $C$ï¼Œä»è€Œæ”¹å–„æ¢¯åº¦ä¼ æ’­ã€‚</p>
<h3 id="23-short-conv">23. ä½ç½®ç¼–ç ä¸Short Convçš„äº¤äº’</h3>
<p><strong>ç›¸å¯¹ä½ç½®ä¿¡æ¯çš„éšå¼ç¼–ç </strong>ï¼š</p>
<p>çŸ­å·ç§¯é€šè¿‡å…¶å›ºå®šçš„å·ç§¯æ ¸æƒé‡éšå¼åœ°ç¼–ç äº†ç›¸å¯¹ä½ç½®ä¿¡æ¯ã€‚å¯¹äºä½ç½® $i$ å’Œ $i+j$ï¼Œå®ƒä»¬é€šè¿‡å·ç§¯æ ¸ $\boldsymbol{W}_j$ äº§ç”Ÿç›´æ¥çš„ä¿¡æ¯äº¤äº’ã€‚</p>
<p><strong>ä¸æ˜¾å¼ä½ç½®ç¼–ç çš„æ¯”è¾ƒ</strong>ï¼š</p>
<p>æ˜¾å¼ä½ç½®ç¼–ç ï¼ˆå¦‚RoPEï¼‰ï¼š</p>
<p>$$
\boldsymbol{q}_i^T \boldsymbol{k}_j = (\boldsymbol{R}_i \boldsymbol{q}_i)^T (\boldsymbol{R}_j \boldsymbol{k}_j) = \boldsymbol{q}_i^T \boldsymbol{R}_{i-j}^T \boldsymbol{k}_j
$$</p>
<p>Short Convéšå¼ä½ç½®ç¼–ç ï¼š</p>
<p>$$
\tilde{\boldsymbol{x}}_i = \sum_{j=-(k-1)/2}^{(k-1)/2} \boldsymbol{W}_j \boldsymbol{x}_{i+j}
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šä¸¤ç§æ–¹å¼éƒ½ç¼–ç äº†ç›¸å¯¹ä½ç½®ï¼Œä½†æœºåˆ¶ä¸åŒã€‚Short Convçš„ä½ç½®ä¿¡æ¯æ˜¯"ç¡¬ç¼–ç "çš„ï¼ˆå›ºå®šæƒé‡ï¼‰ï¼Œè€Œæ³¨æ„åŠ›æœºåˆ¶ä¸­çš„ä½ç½®ç¼–ç æ˜¯é€šè¿‡è°ƒåˆ¶æ³¨æ„åŠ›æƒé‡æ¥å®ç°çš„ã€‚</p>
<h3 id="24">24. é•¿è·ç¦»ä¾èµ–çš„å»ºæ¨¡èƒ½åŠ›</h3>
<p><strong>æœ‰æ•ˆå»ºæ¨¡è·ç¦»</strong>ï¼š</p>
<p>å®šä¹‰æœ‰æ•ˆå»ºæ¨¡è·ç¦»ä¸ºæ¨¡å‹èƒ½å¤Ÿæœ‰æ•ˆåˆ©ç”¨çš„æœ€å¤§è·ç¦»ä¾èµ–ï¼š</p>
<p>$$
D_{\text{eff}} = \max\{|i-j| : \frac{\partial \boldsymbol{o}_i}{\partial \boldsymbol{x}_j} > \epsilon\}
$$</p>
<p>å…¶ä¸­ $\epsilon$ æ˜¯ä¸€ä¸ªå°çš„é˜ˆå€¼ã€‚</p>
<p><strong>ä¸åŒæœºåˆ¶çš„æœ‰æ•ˆè·ç¦»</strong>ï¼š</p>
<ol>
<li><strong>æ ‡å‡†æ³¨æ„åŠ›</strong>ï¼š$D_{\text{eff}} = O(n)$ï¼Œå¯ä»¥å»ºæ¨¡ä»»æ„è·ç¦»çš„ä¾èµ–</li>
<li><strong>çº¿æ€§æ³¨æ„åŠ›</strong>ï¼š$D_{\text{eff}} = O(n)$ï¼Œä½†å¯¹è¿œè·ç¦»ä¾èµ–çš„å»ºæ¨¡èƒ½åŠ›å¼±äºæ ‡å‡†æ³¨æ„åŠ›</li>
<li><strong>Short Conv</strong>ï¼š$D_{\text{eff}} = O(k)$ï¼Œä»…èƒ½å»ºæ¨¡å±€éƒ¨ä¾èµ–</li>
<li><strong>è”åˆæœºåˆ¶</strong>ï¼š$D_{\text{eff}} = O(n)$ï¼Œç»“åˆäº†çº¿æ€§æ³¨æ„åŠ›çš„å…¨å±€è¦†ç›–å’ŒShort Convçš„å±€éƒ¨å¼ºåŒ–</li>
</ol>
<p><strong>å®šé‡åˆ†æ</strong>ï¼š</p>
<p>å¯¹äºè·ç¦» $d$ çš„ä¾èµ–ï¼Œå…¶æ¢¯åº¦çš„è¡°å‡ç‡ä¸ºï¼š</p>
<p>$$
\left\|\frac{\partial \boldsymbol{o}_i}{\partial \boldsymbol{x}_{i-d}}\right\| \sim \begin{cases}
\alpha^d & \text{çº¿æ€§æ³¨æ„åŠ›} \\
0 & \text{Short Conv (if } d > k\text{)} \\
\beta^d & \text{è”åˆæœºåˆ¶}
\end{cases}
$$</p>
<p>å…¶ä¸­ $\beta &lt; \alpha &lt; 1$ï¼Œè¯´æ˜è”åˆæœºåˆ¶æœ‰æ›´å¥½çš„é•¿è·ç¦»ä¾èµ–å»ºæ¨¡èƒ½åŠ›ã€‚</p>
<h3 id="25">25. å®éªŒéªŒè¯ï¼šåˆæˆä»»åŠ¡</h3>
<p><strong>é•¿è·ç¦»å¤åˆ¶ä»»åŠ¡ï¼ˆLong Range Copyï¼‰</strong>ï¼š</p>
<p>è¾“å…¥åºåˆ—å½¢å¼ä¸º $[x_1, \ldots, x_k, 0, \ldots, 0]$ï¼Œç›®æ ‡æ˜¯åœ¨æœ«å°¾è¾“å‡º $[x_1, \ldots, x_k]$ã€‚</p>
<p>ä»»åŠ¡éš¾åº¦éšç€ä¸­é—´0çš„é•¿åº¦ $n$ å¢åŠ è€Œå¢åŠ ã€‚</p>
<p><strong>æ€§èƒ½åº¦é‡</strong>ï¼š</p>
<p>å‡†ç¡®ç‡å®šä¹‰ä¸ºæ­£ç¡®å¤åˆ¶çš„tokenæ¯”ä¾‹ï¼š</p>
<p>$$
\text{Acc} = \frac{1}{k} \sum_{i=1}^k \mathbb{1}[\hat{y}_i = x_i]
$$</p>
<p><strong>ç†è®ºé¢„æµ‹</strong>ï¼š</p>
<ul>
<li>æ ‡å‡†æ³¨æ„åŠ›ï¼š$\text{Acc} \approx 1$ï¼ˆå‡ ä¹å®Œç¾ï¼‰</li>
<li>çº¯çº¿æ€§æ³¨æ„åŠ›ï¼š$\text{Acc} = 0.6 \sim 0.8$ï¼ˆæ€§èƒ½ä¸‹é™ï¼‰</li>
<li>çº¯Short Convï¼š$\text{Acc} \approx 0$ï¼ˆæ— æ³•å»ºæ¨¡é•¿è·ç¦»ä¾èµ–ï¼‰</li>
<li>è”åˆæœºåˆ¶ï¼š$\text{Acc} = 0.85 \sim 0.95$ï¼ˆæ˜¾è‘—æ”¹å–„ï¼‰</li>
</ul>
<h3 id="26-inductive-bias">26. å½’çº³åç½®ï¼ˆInductive Biasï¼‰åˆ†æ</h3>
<p><strong>å·ç§¯çš„å½’çº³åç½®</strong>ï¼š</p>
<ol>
<li><strong>å±€éƒ¨æ€§ï¼ˆLocalityï¼‰</strong>ï¼šç›¸é‚»ä½ç½®å…·æœ‰ç›¸å…³æ€§</li>
<li><strong>å¹³ç§»ç­‰å˜æ€§ï¼ˆTranslation Equivarianceï¼‰</strong>ï¼š$f(\text{shift}(\boldsymbol{X})) = \text{shift}(f(\boldsymbol{X}))$</li>
<li><strong>å‚æ•°å…±äº«ï¼ˆParameter Sharingï¼‰</strong>ï¼šæ‰€æœ‰ä½ç½®ä½¿ç”¨ç›¸åŒçš„å·ç§¯æ ¸</li>
</ol>
<p><strong>çº¿æ€§æ³¨æ„åŠ›çš„å½’çº³åç½®</strong>ï¼š</p>
<ol>
<li><strong>æ’åˆ—ç­‰å˜æ€§ï¼ˆPermutation Equivarianceï¼‰</strong>ï¼šè¾“å‡ºé¡ºåºéšè¾“å…¥é¡ºåºå˜åŒ–</li>
<li><strong>å…¨å±€èšåˆï¼ˆGlobal Aggregationï¼‰</strong>ï¼šæ¯ä¸ªä½ç½®éƒ½èƒ½è®¿é—®å…¨å±€ä¿¡æ¯</li>
<li><strong>å†…å®¹ä¾èµ–ï¼ˆContent Dependenceï¼‰</strong>ï¼šæƒé‡ä¾èµ–äºè¾“å…¥å†…å®¹</li>
</ol>
<p><strong>è”åˆæœºåˆ¶çš„å½’çº³åç½®</strong>ï¼š</p>
<p>ç»“åˆäº†ä¸¤è€…çš„ä¼˜ç‚¹ï¼š</p>
<p>$$
\text{Inductive Bias}_{\text{joint}} = \text{Locality} + \text{Global} + \text{Content}
$$</p>
<p>è¿™ä½¿å¾—æ¨¡å‹æ—¢èƒ½æ•æ‰å±€éƒ¨æ¨¡å¼ï¼Œåˆèƒ½è¿›è¡Œå…¨å±€ä¿¡æ¯æ•´åˆã€‚</p>
<h3 id="27">27. å‚æ•°æ•ˆç‡åˆ†æ</h3>
<p><strong>å‚æ•°æ•°é‡å¯¹æ¯”</strong>ï¼š</p>
<p>å‡è®¾è¾“å…¥ç»´åº¦ä¸º $d$ï¼Œå¤´æ•°ä¸º $h$ï¼Œæ¯å¤´ç»´åº¦ä¸º $d_h = d/h$ã€‚</p>
<p><strong>æ ‡å‡†æ³¨æ„åŠ›çš„å‚æ•°</strong>ï¼š</p>
<p>$$
\begin{aligned}
\text{Params}_{\text{attn}} &= 3 \times (d \times d) + (d \times d) \\
&= 4d^2
\end{aligned}
$$</p>
<p>åŒ…æ‹¬ $\boldsymbol{W}_Q, \boldsymbol{W}_K, \boldsymbol{W}_V, \boldsymbol{W}_O$ã€‚</p>
<p><strong>çº¿æ€§æ³¨æ„åŠ›çš„å‚æ•°</strong>ï¼ˆä¸æ ‡å‡†æ³¨æ„åŠ›ç›¸åŒï¼‰ï¼š</p>
<p>$$
\text{Params}_{\text{linear}} = 4d^2
$$</p>
<p><strong>Short Convçš„å‚æ•°</strong>ï¼ˆæ·±åº¦å¯åˆ†ç¦»ï¼‰ï¼š</p>
<p>$$
\begin{aligned}
\text{Params}_{\text{conv}} &= k \times d + (d \times d) \\
&= kd + d^2
\end{aligned}
$$</p>
<p><strong>è”åˆæœºåˆ¶çš„å‚æ•°</strong>ï¼š</p>
<p>$$
\begin{aligned}
\text{Params}_{\text{joint}} &= 4d^2 + 3 \times (kd + d^2) \\
&= 7d^2 + 3kd \\
&= d^2(7 + \frac{3k}{d})
\end{aligned}
$$</p>
<p><strong>å‚æ•°å¢é•¿ç‡</strong>ï¼š</p>
<p>$$
\frac{\text{Params}_{\text{joint}}}{\text{Params}_{\text{attn}}} = \frac{7d^2 + 3kd}{4d^2} = 1.75 + \frac{3k}{4d}
$$</p>
<p>å¯¹äºå…¸å‹å€¼ $d=512, k=5$ï¼Œå‚æ•°å¢é•¿çº¦ä¸º $1.75 + 0.03 = 1.78$ å€ã€‚</p>
<p><strong>æ³¨é‡Š</strong>ï¼šè™½ç„¶å‚æ•°é‡å¢åŠ äº†çº¦75%ï¼Œä½†è¿™ä¸ªå¢åŠ æ˜¯å¯æ§çš„ï¼Œè€Œä¸”æ¢æ¥äº†æ˜¾è‘—çš„å»ºæ¨¡èƒ½åŠ›æå‡ã€‚</p>
<h3 id="28-flash-linear-attentionshort-conv">28. Flash Linear Attentionä¸Short Conv</h3>
<p><strong>Flash Linear Attentionçš„æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>
<p>é€šè¿‡åˆ†å—è®¡ç®—å’Œåœ¨çº¿æ›´æ–°æ¥å‡å°‘å†…å­˜å ç”¨ï¼š</p>
<p>$$
\boldsymbol{S}^{(b)} = \boldsymbol{S}^{(b-1)} + \sum_{i \in \text{block } b} \phi(\boldsymbol{k}_i) \boldsymbol{v}_i^T
$$</p>
<p><strong>ä¸Short Convçš„å…¼å®¹æ€§</strong>ï¼š</p>
<p>Short Convå¯ä»¥åœ¨å—çº§åˆ«åº”ç”¨ï¼Œä¸å½±å“Flash Linear Attentionçš„åˆ†å—ç­–ç•¥ï¼š</p>
<p>$$
\begin{aligned}
\tilde{\boldsymbol{K}}^{(b)} &= \text{ShortConv}(\boldsymbol{K}^{(b-1:b+1)}) \\
\tilde{\boldsymbol{V}}^{(b)} &= \text{ShortConv}(\boldsymbol{V}^{(b-1:b+1)}) \\
\boldsymbol{S}^{(b)} &= \boldsymbol{S}^{(b-1)} + \sum_{i \in \text{block } b} \phi(\tilde{\boldsymbol{k}}_i) \tilde{\boldsymbol{v}}_i^T
\end{aligned}
$$</p>
<p><strong>æ³¨é‡Š</strong>ï¼šç”±äºShort Convçš„æ„Ÿå—é‡è¾ƒå°ï¼Œåªéœ€è¦è·¨è¶Šç›¸é‚»å—çš„è¾¹ç•Œå³å¯æ­£ç¡®è®¡ç®—å·ç§¯ã€‚</p>
<h3 id="29-short-conv">29. å¤šå¤´æ³¨æ„åŠ›ä¸­çš„Short Conv</h3>
<p><strong>å¤šå¤´çº¿æ€§æ³¨æ„åŠ›</strong>ï¼š</p>
<p>$$
\text{MultiHead}(\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}) = \text{Concat}(\text{head}_1, \ldots, \text{head}_h) \boldsymbol{W}_O
$$</p>
<p>å…¶ä¸­ï¼š</p>
<p>$$
\text{head}_i = \text{LinearAttention}(\boldsymbol{Q}\boldsymbol{W}_i^Q, \boldsymbol{K}\boldsymbol{W}_i^K, \boldsymbol{V}\boldsymbol{W}_i^V)
$$</p>
<p><strong>å¼•å…¥Short Convçš„ä¸¤ç§æ–¹å¼</strong>ï¼š</p>
<p><strong>æ–¹å¼1ï¼šå¤´å†…å·ç§¯</strong>ï¼ˆåœ¨æ¯ä¸ªå¤´å†…ç‹¬ç«‹åº”ç”¨ï¼‰ï¼š</p>
<p>$$
\text{head}_i = \text{LinearAttention}(\text{ShortConv}(\boldsymbol{Q}\boldsymbol{W}_i^Q), \text{ShortConv}(\boldsymbol{K}\boldsymbol{W}_i^K), \text{ShortConv}(\boldsymbol{V}\boldsymbol{W}_i^V))
$$</p>
<p><strong>æ–¹å¼2ï¼šå¤´é—´å·ç§¯</strong>ï¼ˆåœ¨æŠ•å½±ä¹‹å‰åº”ç”¨ï¼‰ï¼š</p>
<p>$$
\text{head}_i = \text{LinearAttention}(\text{ShortConv}(\boldsymbol{Q})\boldsymbol{W}_i^Q, \text{ShortConv}(\boldsymbol{K})\boldsymbol{W}_i^K, \text{ShortConv}(\boldsymbol{V})\boldsymbol{W}_i^V)
$$</p>
<p><strong>æ¯”è¾ƒ</strong>ï¼š</p>
<ul>
<li>å¤´å†…å·ç§¯ï¼šæ¯ä¸ªå¤´æœ‰ç‹¬ç«‹çš„å·ç§¯å‚æ•°ï¼Œè¡¨è¾¾èƒ½åŠ›æ›´å¼ºï¼Œä½†å‚æ•°é‡æ›´å¤§</li>
<li>å¤´é—´å·ç§¯ï¼šæ‰€æœ‰å¤´å…±äº«å·ç§¯å‚æ•°ï¼Œå‚æ•°æ•ˆç‡æ›´é«˜</li>
</ul>
<p>å®è·µä¸­é€šå¸¸ä½¿ç”¨å¤´é—´å·ç§¯ï¼ˆæ–¹å¼2ï¼‰ï¼Œåœ¨å‚æ•°æ•ˆç‡å’Œæ€§èƒ½ä¹‹é—´å–å¾—å¹³è¡¡ã€‚</p>
<h3 id="30-short-conv">30. ç†è®ºæ€»ç»“ï¼šä¸ºä»€ä¹ˆéœ€è¦Short Conv</h3>
<p><strong>æ ¸å¿ƒè®ºç‚¹</strong>ï¼š</p>
<p>çº¿æ€§æ³¨æ„åŠ›é€šè¿‡ç‰¹å¾æ˜ å°„çº¿æ€§åŒ–æ³¨æ„åŠ›æœºåˆ¶ï¼Œå®ç°äº† $O(nd)$ çš„çº¿æ€§å¤æ‚åº¦ï¼Œä½†ç‰ºç‰²äº†ä»¥ä¸‹èƒ½åŠ›ï¼š</p>
<ol>
<li><strong>ç²¾ç¡®çš„æ³¨æ„åŠ›æƒé‡åˆ†é…</strong>ï¼šç‰¹å¾æ˜ å°„ $\phi(\boldsymbol{q})^T \phi(\boldsymbol{k})$ æ— æ³•å®Œç¾è¿‘ä¼¼ $\exp(\boldsymbol{q}^T \boldsymbol{k})$</li>
<li><strong>å°–é”çš„å±€éƒ¨æ³¨æ„åŠ›</strong>ï¼šéš¾ä»¥äº§ç”Ÿé«˜åº¦é›†ä¸­åœ¨å°‘æ•°ä½ç½®çš„æ³¨æ„åŠ›åˆ†å¸ƒ</li>
<li><strong>ä½ç½®æ•æ„Ÿçš„å»ºæ¨¡</strong>ï¼šå…¨å±€ç´¯ç§¯çš„æ–¹å¼å‰Šå¼±äº†å¯¹å±€éƒ¨ä½ç½®å…³ç³»çš„æ•æ„Ÿæ€§</li>
</ol>
<p><strong>Short Convçš„è¡¥å¿æœºåˆ¶</strong>ï¼š</p>
<p>Short Convé€šè¿‡ä»¥ä¸‹æ–¹å¼è¡¥å¿è¿™äº›ä¸è¶³ï¼š</p>
<ol>
<li><strong>å¢å¼ºå±€éƒ¨ç‰¹å¾</strong>ï¼šåœ¨æ³¨æ„åŠ›ä¹‹å‰æå–å±€éƒ¨æ¨¡å¼ï¼Œä½¿å¾—çº¿æ€§æ³¨æ„åŠ›å¤„ç†çš„æ˜¯å·²ç»è¿‡å±€éƒ¨å¢å¼ºçš„ç‰¹å¾</li>
<li><strong>æä¾›ä½ç½®ä¿¡æ¯</strong>ï¼šå·ç§¯æ ¸çš„å›ºå®šæƒé‡éšå¼ç¼–ç äº†ç›¸å¯¹ä½ç½®ä¿¡æ¯</li>
<li><strong>å¹³æ»‘ç‰¹å¾è¡¨ç¤º</strong>ï¼šé€šè¿‡å±€éƒ¨å¹³å‡å‡å°‘å™ªå£°ï¼Œä½¿å¾—çº¿æ€§æ³¨æ„åŠ›çš„å…¨å±€èšåˆæ›´åŠ ç¨³å®š</li>
</ol>
<p><strong>æ•°å­¦è¡¨è¾¾</strong>ï¼š</p>
<p>è”åˆæœºåˆ¶çš„è¡¨è¾¾èƒ½åŠ›å¯ä»¥è¿‘ä¼¼è¡¨ç¤ºä¸ºï¼š</p>
<p>$$
\mathcal{F}_{\text{joint}}(\boldsymbol{X}) \approx \mathcal{F}_{\text{attn}}(\boldsymbol{X}) + \epsilon(\boldsymbol{X})
$$</p>
<p>å…¶ä¸­ $\epsilon(\boldsymbol{X})$ æ˜¯ç›¸å¯¹æ ‡å‡†æ³¨æ„åŠ›çš„è¿‘ä¼¼è¯¯å·®ã€‚é€šè¿‡å¼•å…¥Short Convï¼Œæˆ‘ä»¬æœ‰ï¼š</p>
<p>$$
\|\epsilon(\boldsymbol{X})\|_{\text{with conv}} < \|\epsilon(\boldsymbol{X})\|_{\text{without conv}}
$$</p>
<p><strong>å®è·µæ„ä¹‰</strong>ï¼š</p>
<p>è¿™ä¸ªç†è®ºåˆ†æè§£é‡Šäº†ä¸ºä»€ä¹ˆè¿‘æœŸçš„é«˜æ•ˆTransformeræ¨¡å‹ï¼ˆå¦‚DeltaNetã€Mambaç­‰ï¼‰éƒ½é‡‡ç”¨äº†çº¿æ€§æ³¨æ„åŠ›+çŸ­å·ç§¯çš„ç»„åˆæ¶æ„ã€‚è¿™ä¸ä»…ä»…æ˜¯ç»éªŒæ€§çš„è®¾è®¡ï¼Œè€Œæ˜¯æœ‰æ·±åˆ»çš„ç†è®ºæ”¯æ’‘ã€‚</p>
<p><strong>ç»“è®º</strong>ï¼š</p>
<p>Short Convæ˜¯çº¿æ€§æ³¨æ„åŠ›ä¸å¯æˆ–ç¼ºçš„è¡¥å……æœºåˆ¶ï¼Œå®ƒé€šè¿‡æä¾›å±€éƒ¨å»ºæ¨¡èƒ½åŠ›ã€ä½ç½®ä¿¡æ¯ç¼–ç å’Œç‰¹å¾å¹³æ»‘ï¼Œä½¿å¾—çº¿æ€§æ³¨æ„åŠ›èƒ½å¤Ÿåœ¨ä¿æŒçº¿æ€§å¤æ‚åº¦çš„åŒæ—¶ï¼Œæ¥è¿‘æ ‡å‡†æ³¨æ„åŠ›çš„è¡¨è¾¾èƒ½åŠ›ã€‚è¿™ç§äº’è¡¥æ€§è®¾è®¡æ˜¯æ„å»ºé«˜æ•ˆä¸”å¼ºå¤§çš„Transformeræ¨¡å‹çš„å…³é”®ã€‚</p>
        </div>
    </div>
</body>
</html>