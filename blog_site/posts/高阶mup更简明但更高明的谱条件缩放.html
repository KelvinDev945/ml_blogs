<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é«˜é˜¶MuPï¼šæ›´ç®€æ˜ä½†æ›´é«˜æ˜çš„è°±æ¡ä»¶ç¼©æ”¾</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>é«˜é˜¶MuPï¼šæ›´ç®€æ˜ä½†æ›´é«˜æ˜çš„è°±æ¡ä»¶ç¼©æ”¾</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 61.9 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10795">https://spaces.ac.cn/archives/10795</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>åœ¨æ–‡ç« <a href="/archives/10770">ã€Šåˆæ¢MuPï¼šè¶…å‚æ•°çš„è·¨æ¨¡å‹å°ºåº¦è¿ç§»è§„å¾‹ã€‹</a>ä¸­ï¼Œæˆ‘ä»¬åŸºäºå‰å‘ä¼ æ’­ã€åå‘ä¼ æ’­ã€æŸå¤±å¢é‡å’Œç‰¹å¾å˜åŒ–çš„å°ºåº¦ä¸å˜æ€§æ¨å¯¼äº†MuPï¼ˆMaximal Update Parametrizationï¼‰ã€‚å¯èƒ½å¯¹äºéƒ¨åˆ†è¯»è€…æ¥è¯´ï¼Œè¿™ä¸€è¿‡ç¨‹è¿˜æ˜¯æ˜¾å¾—æœ‰äº›ç¹çï¼Œä½†å®é™…ä¸Šå®ƒæ¯”åŸå§‹è®ºæ–‡å·²ç»æ˜æ˜¾ç®€åŒ–ã€‚è¦çŸ¥é“ï¼Œæˆ‘ä»¬æ˜¯åœ¨å•ç¯‡æ–‡ç« å†…ç›¸å¯¹å®Œæ•´åœ°ä»‹ç»çš„MuPï¼Œè€ŒMuPçš„è®ºæ–‡å®é™…ä¸Šæ˜¯ä½œè€…Tensor Programsç³»åˆ—è®ºæ–‡çš„ç¬¬5ç¯‡ï¼</p>
<p>ä¸è¿‡å¥½æ¶ˆæ¯æ˜¯ï¼Œä½œè€…åœ¨åç»­çš„ç ”ç©¶<a href="https://papers.cool/arxiv/2310.17813">ã€ŠA Spectral Condition for Feature Learningã€‹</a>ä¸­ï¼Œå‘ç°äº†ä¸€ç§æ–°çš„ç†è§£æ–¹å¼ï¼ˆä¸‹ç§°â€œè°±æ¡ä»¶â€ï¼‰ï¼Œå®ƒæ¯”MuPçš„åŸå§‹æ¨å¯¼å’Œç¬”è€…çš„æ¨å¯¼éƒ½æ›´åŠ ç›´è§‚å’Œç®€æ´ï¼Œä½†å´èƒ½å¾—åˆ°æ¯”MuPæ›´ä¸°å¯Œçš„ç»“æœï¼Œå¯è°“MuPçš„é«˜é˜¶ç‰ˆæœ¬ï¼Œç®€æ˜ä¸”ä¸å¤±é«˜æ˜çš„ä»£è¡¨ä½œã€‚</p>
<h2 id="_1">å‡†å¤‡å·¥ä½œ</h2>
<p>é¡¾åæ€ä¹‰ï¼Œè°±æ¡ä»¶ï¼ˆSpectral Conditionï¼‰è·Ÿè°±èŒƒæ•°ï¼ˆSpectral Normï¼‰ç›¸å…³ï¼Œå®ƒçš„å‡ºå‘ç‚¹æ˜¯è°±èŒƒæ•°çš„ä¸€ä¸ªåŸºæœ¬ä¸ç­‰å¼ï¼š<br />
\begin{equation}\Vert\boldsymbol{x}\boldsymbol{W}\Vert_2\leq \Vert\boldsymbol{x}\Vert_2 \Vert\boldsymbol{W}\Vert_2\label{neq:spec-2}\end{equation}<br />
å…¶ä¸­$\boldsymbol{x}\in\mathbb{R}^{d_{in}}, \boldsymbol{W}\in\mathbb{R}^{d_{in}\times d_{out}}$ï¼Œè‡³äº$\Vert\cdot\Vert_2$ï¼Œæˆ‘ä»¬å¯ä»¥å«å®ƒâ€œ$2$èŒƒæ•°â€ã€‚å¯¹äº$\boldsymbol{x},\boldsymbol{x}\boldsymbol{W}$æ¥è¯´ï¼Œå®ƒä»¬éƒ½æ˜¯å‘é‡ï¼Œ$2$èŒƒæ•°å°±æ˜¯å‘é‡æ¨¡é•¿ï¼›è€Œ$\boldsymbol{W}$æ˜¯ä¸€ä¸ªçŸ©é˜µï¼Œå®ƒçš„$2$èŒƒæ•°ä¹Ÿç§°ä¸ºè°±èŒƒæ•°ï¼Œå®ƒç­‰äºè®©$\Vert\boldsymbol{x}\boldsymbol{W}\Vert_2\leq C\Vert\boldsymbol{x}\Vert_2$æ’æˆç«‹çš„æœ€å°å¸¸æ•°$C$ã€‚æ¢å¥è¯è¯´ï¼Œä¸Šè¿°ä¸ç­‰å¼å…¶å®æ˜¯è°±èŒƒæ•°å®šä¹‰çš„ç›´æ¥æ¨è®ºï¼Œæ— éœ€é¢å¤–è¯æ˜ã€‚</p>
<p>å…³äºè°±èŒƒæ•°ï¼Œå¤§å®¶è¿˜å¯ä»¥çœ‹<a href="/archives/6051">ã€Šæ·±åº¦å­¦ä¹ ä¸­çš„Lipschitzçº¦æŸï¼šæ³›åŒ–ä¸ç”Ÿæˆæ¨¡å‹ã€‹</a>ã€<a href="/archives/10407#%E7%9F%A9%E9%98%B5%E8%8C%83%E6%95%B0">ã€Šä½ç§©è¿‘ä¼¼ä¹‹è·¯ï¼ˆäºŒï¼‰ï¼šSVDã€‹</a>ç­‰åšæ–‡ï¼Œè¿™é‡Œä¸å†å±•å¼€ä»‹ç»ã€‚çŸ©é˜µè¿˜æœ‰ä¸€ä¸ªæ›´ç®€å•çš„$F$èŒƒæ•°ï¼Œå®ƒæ˜¯å‘é‡æ¨¡é•¿çš„ç®€å•æ¨å¹¿ï¼š<br />
\begin{equation}\Vert \boldsymbol{W}\Vert_F = \sqrt{\sum_{i=1}^{d_{in}}\sum_{j=1}^{d_{out}}W_{i,j}^2}\end{equation}<br />
ä»å¥‡å¼‚å€¼è§’åº¦çœ‹ï¼Œè°±èŒƒæ•°ç­‰äºçŸ©é˜µæœ€å¤§çš„å¥‡å¼‚å€¼ï¼Œè€Œ$F$èŒƒæ•°ç­‰äºçŸ©é˜µå…¨ä½“å¥‡å¼‚å€¼çš„å¹³æ–¹å’Œçš„å¹³æ–¹æ ¹ã€‚ç±»ä¼¼åœ°ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥å®šä¹‰â€œæ ¸èŒƒæ•°ï¼ˆNuclear Normï¼‰â€ï¼Œå®ƒç­‰äºå…¨ä½“å¥‡å¼‚å€¼çš„å’Œï¼š<br />
\begin{equation}\Vert \boldsymbol{W}\Vert_* = \sum_{i=1}^{\min(d_{in}, d_{out})} \sigma_i\end{equation}<br />
åƒè°±èŒƒæ•°ã€$F$èŒƒæ•°ã€æ ¸èŒƒæ•°ç­‰å¯ä»¥ç”±å¥‡å¼‚å€¼è¡¨ç¤ºå‡ºæ¥çš„çŸ©é˜µèŒƒæ•°ï¼Œå®ƒä»¬éƒ½å±äºâ€œ<a href="https://en.wikipedia.org/wiki/Schatten_norm">Schatten-pèŒƒæ•°</a>â€çš„ä¸€ç§ã€‚æœ€åï¼Œæˆ‘ä»¬æ¥å®šä¹‰RMSï¼ˆRoot Mean Squareï¼‰ï¼Œå®ƒæ˜¯å‘é‡æ¨¡é•¿çš„å˜ä½“ï¼š<br />
\begin{equation}\Vert\boldsymbol{x}\Vert_{RMS} = \sqrt{\frac{1}{d_{in}}\sum_{i=1}^{d_{in}} x_i^2} = \frac{1}{\sqrt{d_{in}}}\Vert \boldsymbol{x}\Vert_2 \end{equation}<br />
å¦‚æœè¦æ¨å¹¿åˆ°çŸ©é˜µï¼Œé‚£å°±æ˜¯$\Vert\boldsymbol{W}\Vert_{RMS} = \Vert \boldsymbol{W}\Vert_F/\sqrt{d_{in} d_{out}}$ã€‚å…¶å®ä»åå­—å°±å¾ˆå¥½ç†è§£ï¼Œå‘é‡æ¨¡é•¿æˆ–çŸ©é˜µ$F$èŒƒæ•°ï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¸ºâ€œRoot Sum Squareâ€ï¼Œè€ŒRMSå°±æ˜¯æŠŠSumæ¢æˆMeanï¼Œå®ƒä¸»è¦ç”¨æ¥ä½œä¸ºå‘é‡æˆ–çŸ©é˜µå…ƒç´ çš„å¹³å‡å°ºåº¦æŒ‡æ ‡ã€‚ç°åœ¨æŠŠRMSä»£å…¥ä¸ç­‰å¼$\eqref{neq:spec-2}$ï¼Œå¯ä»¥å¾—åˆ°<br />
\begin{equation}\Vert\boldsymbol{x}\boldsymbol{W}\Vert_{RMS}\leq \sqrt{\frac{d_{in}}{d_{out}}}\Vert\boldsymbol{x}\Vert_{RMS} \Vert\boldsymbol{W}\Vert_2\label{neq:spec-rms}\end{equation}</p>
<h2 id="_2">æœŸæœ›æ€§è´¨</h2>
<p>æˆ‘ä»¬ä¹‹å‰æ¨å¯¼MuPçš„æ€è·¯ï¼Œæ˜¯ä»”ç»†åˆ†æ<strong>å‰å‘ä¼ æ’­</strong> ã€<strong>åå‘ä¼ æ’­</strong> ã€<strong>æŸå¤±å¢é‡</strong> å’Œ<strong>ç‰¹å¾å˜åŒ–</strong> çš„å½¢å¼ï¼Œé€šè¿‡è°ƒæ•´åˆå§‹åŒ–å’Œå­¦ä¹ ç‡æ¥å®ç°å®ƒä»¬çš„å°ºåº¦ä¸å˜æ€§ã€‚è°±æ¡ä»¶å¯¹å…¶â€œå»èŠœå­˜èâ€åå‘ç°ï¼Œåªè¦<strong>å‰å‘ä¼ æ’­</strong> å’Œ<strong>ç‰¹å¾å˜åŒ–</strong> ä¸¤ç‚¹è¶³çŸ£ã€‚</p>
<p>ç®€å•æ¥è¯´ï¼Œè°±æ¡ä»¶æœŸæœ› <em>æ¯ä¸€å±‚çš„<strong>è¾“å‡º</strong> å’Œ<strong>å¢é‡</strong> éƒ½å…·æœ‰å°ºåº¦ä¸å˜æ€§</em>ã€‚æ€ä¹ˆç†è§£è¿™å¥è¯å‘¢ï¼Ÿå¦‚æœæˆ‘ä»¬å°†æ¯ä¸€å±‚ç®€è®°ä¸º$\boldsymbol{x}<em k-1="k-1">k= f(\boldsymbol{x}</em>}; \boldsymbol{W<em RMS="RMS">k)$ä¸ºä¾‹ï¼Œè¿™å¥è¯å¯ä»¥ç¿»è¯‘æˆâ€œæœŸæœ›æ¯ä¸ª$\Vert\boldsymbol{x}_k\Vert</em>}$å’Œ$\Vert\Delta\boldsymbol{x<em RMS="RMS">k\Vert</em>$æ˜¯â€œ}$éƒ½æ˜¯$\mathcal{\Theta}(1)$â€çš„ï¼ˆ$\mathcal{\Theta<a href="https://en.wikipedia.org/wiki/Big_O_notation#Family_of_Bachmann%E2%80%93Landau_notations">Big Theta Notation</a>â€ï¼‰ï¼š</p>
<blockquote>
<p>1ã€$\Vert\boldsymbol{x}<em RMS="RMS">k\Vert</em>(1)$å¥½ç†è§£ï¼Œå®ƒä»£è¡¨ç€å‰å‘ä¼ æ’­çš„ç¨³å®šæ€§ï¼Œä¸Šä¸€ç¯‡æ–‡ç« çš„æ¨å¯¼ä¹ŸåŒ…å«è¿™ä¸ªè¦æ±‚ï¼›}=\mathcal{\Theta</p>
<p>2ã€$\Delta\boldsymbol{x}<em RMS="RMS">k$è¡¨ç¤ºå‚æ•°å˜åŒ–å¼•èµ·çš„$\boldsymbol{x}_k$å˜åŒ–é‡ï¼Œæ‰€ä»¥$\Vert\Delta\boldsymbol{x}_k\Vert</em>(1)$èåˆäº†åå‘ä¼ æ’­å’Œç‰¹å¾å˜åŒ–çš„è¦æ±‚ã€‚}=\mathcal{\Theta</p>
</blockquote>
<p>å¯èƒ½æœ‰è¯»è€…ç–‘é—®ï¼šé‚£æ˜¯ä¸æ˜¯è‡³å°‘åº”è¯¥è¿˜æœ‰ä¸ªâ€œæŸå¤±å¢é‡â€çš„è¦æ±‚ï¼Ÿå¹¶ä¸éœ€è¦ã€‚äº‹å®ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜ï¼Œå¦‚æœæ¯ä¸€å±‚çš„$\Vert\boldsymbol{x}<em RMS="RMS">k\Vert</em>}$å’Œ$\Vert\Delta\boldsymbol{x<em RMS="RMS">k\Vert</em>(1)$çš„ã€‚è¿™æ­£æ˜¯è°±æ¡ä»¶æ€æƒ³ç¬¬ä¸€ä¸ªç¾å¦™ä¹‹å¤„ï¼Œå®ƒå°†åŸæœ¬æ¨å¯¼MuPéœ€è¦çš„å››ä¸ªæ¡ä»¶é™ä½åˆ°ä¸¤ä¸ªï¼Œå‡å°‘äº†åˆ†ææ­¥éª¤ã€‚}$éƒ½æ˜¯$\mathcal{\Theta}(1)$ï¼Œé‚£ä¹ˆ$\Delta\mathcal{L}$è‡ªåŠ¨å°±æ˜¯$\mathcal{\Theta</p>
<p>è¯æ˜å¹¶ä¸å›°éš¾ï¼Œè¿™é‡Œçš„å…³é”®æ˜¯æˆ‘ä»¬å‡è®¾äº† <em>æ¯ä¸€å±‚</em> éƒ½æˆç«‹$\Vert\boldsymbol{x}<em RMS="RMS">k\Vert</em>}=\mathcal{\Theta}(1)$å’Œ$\Vert\Delta\boldsymbol{x<em RMS="RMS">k\Vert</em>_K)$ï¼Œç®€å•èµ·è§è¿™é‡Œçœæ‰äº†æ ‡ç­¾è¾“å…¥ï¼Œå› ä¸ºå¯¹ä¸‹é¢çš„åˆ†ææ¥è¯´å®ƒå¹¶éå˜é‡ã€‚}=\mathcal{\Theta}(1)$ï¼Œé‚£ä¹ˆæœ€åä¸€å±‚è‡ªç„¶ä¹Ÿæˆç«‹ã€‚å‡è®¾æ¨¡å‹ä¸€å…±æœ‰$K$å±‚ï¼Œå•ä¸ªæ ·æœ¬æŸå¤±å‡½æ•°ä¸º$\ell$ï¼Œé‚£ä¹ˆå®ƒæ˜¯$\boldsymbol{x}_K$çš„å‡½æ•°å³$\ell(\boldsymbol{x</p>
<p>æ ¹æ®å‡è®¾ï¼Œ$\Vert\boldsymbol{x}<em RMS="RMS">K\Vert</em>}$æ˜¯$\mathcal{\Theta}(1)$çš„ï¼Œé‚£ä¹ˆ$\ell(\boldsymbol{x<em RMS="RMS">K)$è‡ªç„¶æ˜¯$\mathcal{\Theta}(1)$çš„ï¼›åˆå› ä¸º$\Vert\Delta\boldsymbol{x}_K\Vert</em>}$æ˜¯$\mathcal{\Theta}(1)$çš„ï¼Œæ‰€ä»¥$\Vert\boldsymbol{x<em RMS="RMS">K + \Delta\boldsymbol{x}_K\Vert</em>}\leq \Vert\boldsymbol{x<em RMS="RMS">K\Vert</em>} + \Vert\Delta\boldsymbol{x<em RMS="RMS">K\Vert</em>}$ä¹Ÿæ˜¯$\mathcal{\Theta}(1)$çš„ï¼Œä»è€Œ$\ell(\boldsymbol{x<em RMS="RMS">K + \Delta\boldsymbol{x}_K)$æ˜¯$\mathcal{\Theta}(1)$çš„ï¼Œäºæ˜¯<br />
\begin{equation}\Delta \ell = \ell(\boldsymbol{x}_K + \Delta\boldsymbol{x}_K) - \ell(\boldsymbol{x}_K) = \mathcal{\Theta}(1)\end{equation}<br />
æ‰€ä»¥ï¼Œå•ä¸ªæ ·æœ¬çš„æŸå¤±å¢é‡$\Delta \ell$æ˜¯$\mathcal{\Theta}(1)$çš„ï¼Œè€Œ$\Delta\mathcal{L}$æ˜¯å…¨ä½“$\Delta \ell$çš„å¹³å‡ï¼Œæ‰€ä»¥å®ƒä¹Ÿæ˜¯$\mathcal{\Theta}(1)$çš„ã€‚è¿™æ ·æˆ‘ä»¬å°±è¯æ˜äº†$\Vert\boldsymbol{x}_k\Vert</em>}=\mathcal{\Theta}(1)$å’Œ$\Vert\Delta\boldsymbol{x<em RMS="RMS">k\Vert</em>$è‡ªç„¶å°±ç¨³å®šäº†ã€‚}=\mathcal{\Theta}(1)$è‡ªåŠ¨åŒ…å«äº†$\Delta\mathcal{L}=\mathcal{\Theta}(1)$ï¼ŒåŸç†è¯´ç™½äº†å°±æ˜¯$\Delta\mathcal{L}$æ˜¯æœ€åä¸€å±‚è¾“å‡ºåŠå…¶å¢é‡çš„å‡½æ•°ï¼Œå®ƒä»¬éƒ½ç¨³å®šäº†ï¼Œ$\Delta\mathcal{L</p>
<h2 id="_3">è°±æ¡ä»¶</h2>
<p>æ¥ç€ï¼Œæˆ‘ä»¬çœ‹å¦‚ä½•æˆç«‹ä¸¤ä¸ªæœŸæœ›æ€§è´¨ã€‚ç”±äºç¥ç»ç½‘ç»œä»¥çŸ©é˜µä¹˜æ³•ä¸ºä¸»ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆè€ƒè™‘æœ€ç®€å•çš„çº¿æ€§å±‚$\boldsymbol{x}<em k-1="k-1">k = \boldsymbol{x}</em>} \boldsymbol{W<em k-1="k-1">k$ï¼Œå…¶ä¸­$\boldsymbol{W}_k\in\mathbb{R}^{d</em>}\times d_k}$ã€‚ä¸ºäº†æˆç«‹$\Vert\boldsymbol{x<em RMS="RMS">k\Vert</em>$ï¼š}=\mathcal{\Theta}(1)$çš„æ¡ä»¶ï¼Œè°±æ¡ä»¶æ²¡æœ‰åƒä¼ ç»Ÿåˆå§‹åŒ–åˆ†æä¸€æ ·å»å‡è®¾ç‹¬ç«‹åŒåˆ†å¸ƒç„¶åç®—æœŸæœ›æ–¹å·®ç­‰ï¼Œè€Œæ˜¯ç›´æ¥åº”ç”¨ä¸ç­‰å¼$\eqref{neq:spec-rms<br />
\begin{equation}\Vert\boldsymbol{x}<em RMS="RMS">k\Vert</em>}\leq \sqrt{\frac{d_{k-1}}{d_k}}\Vert\boldsymbol{x<em RMS="RMS">{k-1}\Vert</em>}\, \Vert\boldsymbol{W<em k-1="k-1">k\Vert_2\end{equation}<br />
æ³¨æ„è¿™ä¸ªä¸ç­‰å¼æ˜¯å¯èƒ½å–åˆ°ç­‰å·çš„ï¼Œå¹¶ä¸”æŸç§æ„ä¹‰ä¸Šæ˜¯æœ€ç²¾å‡†çš„ï¼Œæ‰€ä»¥å¦‚æœè¾“å…¥çš„$\Vert\boldsymbol{x}</em>}\Vert_{RMS}$å·²ç»æ˜¯$\mathcal{\Theta}(1)$ï¼Œé‚£ä¹ˆä¸ºäº†ä½¿è¾“å‡ºçš„$\Vert\boldsymbol{x<em RMS="RMS">k\Vert</em>(1)$ï¼Œé‚£ä¹ˆå°±è¦}=\mathcal{\Theta<br />
\begin{equation}\sqrt{\frac{d_{k-1}}{d_k}}\Vert\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \mathcal{\Theta}(1)\quad\Rightarrow\quad \Vert\boldsymbol{W}_k\Vert_2 = \mathcal{\Theta}\left(\sqrt{\frac{d_k}{d</em>}}}\right)\label{eq:spec-c1}\end{equation<br />
è¿™å°±æå‡ºäº†ç¬¬ä¸€ä¸ª<strong>è°±æ¡ä»¶</strong> â€”â€”å¯¹$\boldsymbol{W}_k$çš„è°±èŒƒæ•°è¦æ±‚ã€‚å®ƒæ— å…³åˆå§‹åŒ–å’Œåˆ†å¸ƒå‡è®¾ï¼Œå®Œå…¨æ˜¯åˆ†æå’Œä»£æ•°çš„ç»“æœï¼Œè¿™æ˜¯ç¬”è€…è®¤ä¸ºè°±æ¡ä»¶çš„ç¬¬äºŒä¸ªç¾å¦™ä¹‹å¤„â€”â€”ç®€åŒ–åˆ†æè¿‡ç¨‹ã€‚å½“ç„¶ï¼Œè¿™é‡Œçœç•¥äº†è°±èŒƒæ•°çš„åŸºç¡€å†…å®¹ï¼Œè¡¥ä¸Šçš„è¯æ•´ä¸ªç¯‡å¹…ä¸è§å¾—æ¯”åˆ†å¸ƒå‡è®¾ä¸‹çš„åˆ†æçŸ­ï¼Œä½†åˆ†å¸ƒå‡è®¾ç»ˆç©¶æ˜¾å¾—å±€é™æ€§å¤§ï¼Œä¸å¦‚è¿™é‡Œçš„ä»£æ•°æ¡†æ¶çµæ´»ã€‚</p>
<p>åˆ†æå®Œ$\Vert\boldsymbol{x}<em RMS="RMS">k\Vert</em>}$åï¼Œå°±è½®åˆ°$\Vert\Delta\boldsymbol{x<em RMS="RMS">k\Vert</em>}$äº†ï¼Œå¢é‡çš„$\Delta\boldsymbol{x<em k-1="k-1">k$çš„æ¥æºæœ‰ä¸¤éƒ¨åˆ†ï¼Œä¸€æ˜¯å‚æ•°ç”±$\boldsymbol{W}_k$å˜ä¸º$\boldsymbol{W}_k+\Delta \boldsymbol{W}_k$ï¼ŒäºŒæ˜¯è¾“å…¥$\boldsymbol{x}</em>}$çš„å‚æ•°å˜åŒ–å¯¼è‡´å®ƒä»$\boldsymbol{x<em k-1="k-1">{k-1}$å˜ä¸º$\boldsymbol{x}</em>} + \Delta\boldsymbol{x<em k-1="k-1">{k-1}$ï¼Œæ‰€ä»¥<br />
\begin{equation}\begin{aligned}<br />
\Delta\boldsymbol{x}_k =&amp;\, (\boldsymbol{x}</em>} + \Delta\boldsymbol{x<em k-1="k-1">{k-1})(\boldsymbol{W}_k+\Delta \boldsymbol{W}_k) - \boldsymbol{x}</em>}\boldsymbol{W<em k-1="k-1">k \\\[5pt]<br />
=&amp;\, \boldsymbol{x}</em>} (\Delta \boldsymbol{W<em k-1="k-1">k) + (\Delta\boldsymbol{x}</em>})\boldsymbol{W<em k-1="k-1">k + (\Delta\boldsymbol{x}</em>})(\Delta \boldsymbol{W<em RMS="RMS">k)<br />
\end{aligned}\end{equation}<br />
æ‰€ä»¥<br />
\begin{equation}\begin{aligned}<br />
\Vert\Delta\boldsymbol{x}_k\Vert</em>} =&amp;\, \Vert\boldsymbol{x<em k-1="k-1">{k-1} (\Delta \boldsymbol{W}_k) + (\Delta\boldsymbol{x}</em>})\boldsymbol{W<em k-1="k-1">k + (\Delta\boldsymbol{x}</em>})(\Delta \boldsymbol{W<em RMS="RMS">k)\Vert</em> \\\[5pt]<br />
\leq&amp;\, \Vert\boldsymbol{x}<em RMS="RMS">{k-1} (\Delta \boldsymbol{W}_k)\Vert</em>} + \Vert(\Delta\boldsymbol{x<em RMS="RMS">{k-1})\boldsymbol{W}_k\Vert</em>} + \Vert(\Delta\boldsymbol{x<em RMS="RMS">{k-1})(\Delta \boldsymbol{W}_k)\Vert</em> \\\[5pt]<br />
\leq&amp;\, \sqrt{\frac{d_{k-1}}{d_k}}\left({\begin{gathered}\Vert\boldsymbol{x}<em RMS="RMS">{k-1}\Vert</em>}\,\Vert\Delta \boldsymbol{W<em k-1="k-1">k\Vert_2 + \Vert\Delta\boldsymbol{x}</em>}\Vert_{RMS}\,\Vert \boldsymbol{W<em k-1="k-1">k\Vert_2 \\\[5pt]<br />
+ \Vert\Delta\boldsymbol{x}</em>}\Vert_{RMS}\,\Vert\Delta \boldsymbol{W<em k-1="k-1">k\Vert_2\end{gathered}} \right)<br />
\end{aligned}\end{equation}<br />
é€é¡¹åˆ†æä¸€ä¸‹<br />
\begin{equation}\underbrace{\Vert\boldsymbol{x}</em>}\Vert_{RMS}<em k-1="k-1">{\mathcal{\Theta}(1)}\,\Vert\Delta \boldsymbol{W}_k\Vert_2 + \underbrace{\Vert\Delta\boldsymbol{x}</em>}\Vert_{RMS}<em _mathcal_Theta="\mathcal{\Theta">{\mathcal{\Theta}(1)}\,\underbrace{\Vert \boldsymbol{W}_k\Vert_2}</em>}\left(\sqrt{\frac{d_k}{d_{k-1}}}\right)} + \underbrace{\Vert\Delta\boldsymbol{x<em RMS="RMS">{k-1}\Vert</em>}<em RMS="RMS">{\mathcal{\Theta}(1)}\,\Vert\Delta \boldsymbol{W}_k\Vert_2\end{equation}<br />
ç”±æ­¤å¯è§ï¼Œè¦æƒ³$\Vert\Delta\boldsymbol{x}_k\Vert</em>(1)$ï¼Œé‚£ä¹ˆå°±éœ€è¦}=\mathcal{\Theta<br />
\begin{equation}\Vert\Delta\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \mathcal{\Theta}\left(\sqrt{\frac{d_k}{d</em>}}}\right)\label{eq:spec-c2}\end{equation<br />
è¿™å°±æ˜¯ç¬¬äºŒä¸ª<strong>è°±æ¡ä»¶</strong> â€”â€”å¯¹$\Delta\boldsymbol{W}_k$çš„è°±èŒƒæ•°è¦æ±‚ã€‚</p>
<p>ä¸Šé¢çš„åˆ†ææ²¡æœ‰è€ƒè™‘éçº¿æ€§ï¼Œäº‹å®ä¸Šåªè¦æ¿€æ´»å‡½æ•°æ˜¯Element-wiseçš„ï¼Œå¹¶ä¸”å¯¼æ•°èƒ½å¤Ÿè¢«æŸä¸ªå¸¸æ•°Boundä½ï¼ˆå¸¸ç”¨çš„ReLUã€Sigmoidã€Tanhç­‰æ¿€æ´»å‡½æ•°éƒ½æ»¡è¶³ï¼‰ï¼Œé‚£ä¹ˆå³ä¾¿è€ƒè™‘éçº¿æ€§æ¿€æ´»å‡½æ•°çš„ç»“æœä¹Ÿæ˜¯ä¸€è‡´ï¼Œè¿™å°±æ˜¯ä¸Šä¸€ç¯‡æ–‡ç« åˆ†ææ‰€è¯´çš„â€œæ¿€æ´»å‡½æ•°çš„å½±å“æ˜¯å°ºåº¦æ— å…³çš„â€ã€‚å¦‚æœè¯»è€…è¿˜ä¸æ”¾å¿ƒï¼Œå¯ä»¥è‡ªè¡Œæ¨å¯¼ä¸€ä¸‹ã€‚</p>
<h2 id="_4">è°±å½’ä¸€åŒ–</h2>
<p>ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸¤ä¸ªè°±æ¡ä»¶$\eqref{eq:spec-c1}$å’Œ$\eqref{eq:spec-c2}$ï¼Œæ¥ä¸‹æ¥å°±è¦çœ‹æ€ä¹ˆè®¾è®¡æ‰èƒ½è®©æ¨¡å‹è‡ªèº«ä»¥åŠæ¨¡å‹ä¼˜åŒ–æ¥æ»¡è¶³è¿™ä¸¤ä¸ªæ¡ä»¶äº†ã€‚</p>
<p>æ³¨æ„ï¼Œ$\boldsymbol{W}<em k-1="k-1">k$å’Œ$\Delta \boldsymbol{W}_k$éƒ½æ˜¯çŸ©é˜µï¼Œè®©ä¸€ä¸ªçŸ©é˜µæ»¡è¶³è°±èŒƒæ•°æ¡ä»¶çš„æ ‡å‡†æ–¹æ³•é€šå¸¸æ˜¯è°±å½’ä¸€åŒ–ï¼ˆSpectral Normalizationï¼ŒSNï¼‰ï¼Œè¿™é‡Œä¹Ÿä¸ä¾‹å¤–ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è¦è®©åˆå§‹åŒ–çš„$\boldsymbol{W}_k$æ»¡è¶³$\Vert\boldsymbol{W}_k\Vert_2=\mathcal{\Theta}\left(\sqrt{\frac{d_k}{d</em>}}}\right)$ï¼Œè¿™å¯ä»¥é€šè¿‡é€‰å–ä»»æ„çš„åˆå§‹åŒ–çŸ©é˜µ$\boldsymbol{W<em k-1="k-1">k'$ï¼Œç„¶åè°±å½’ä¸€åŒ–å®ç°ï¼š<br />
\begin{equation}\boldsymbol{W}_k = \sigma\sqrt{\frac{d_k}{d</em>}}}\frac{\boldsymbol{W<em k-1="k-1">k'}{\Vert\boldsymbol{W}_k'\Vert_2}\end{equation}<br />
è¿™é‡Œçš„$\sigma &gt; 0$æ˜¯å°ºåº¦æ— å…³çš„å¸¸æ•°ï¼›åŒç†ï¼Œå¯¹äºä»»æ„ä¼˜åŒ–å™¨ç»™å‡ºçš„æ›´æ–°é‡$\boldsymbol{\Phi}_k$ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è°±å½’ä¸€åŒ–æ¥é‡æ–°æ„é€ $\Delta \boldsymbol{W}_k$ï¼š<br />
\begin{equation}\Delta \boldsymbol{W}_k = \eta\sqrt{\frac{d_k}{d</em>}}}\frac{\boldsymbol{\Phi<em k-1="k-1">k}{\Vert\boldsymbol{\Phi}_k\Vert_2}\end{equation}<br />
å…¶ä¸­$\eta &gt; 0$ä¹Ÿæ˜¯å°ºåº¦æ— å…³çš„å¸¸æ•°ï¼ˆå­¦ä¹ ç‡ï¼‰ï¼Œè¿™æ ·æ¯ä¸€æ­¥éƒ½æœ‰$\Vert\Delta\boldsymbol{W}_k\Vert_2=\mathcal{\Theta}\left(\sqrt{\frac{d_k}{d</em>}}}\right)$ã€‚ç”±äºåˆå§‹åŒ–å’Œæ¯ä¸€æ­¥æ›´æ–°çš„è°±èŒƒæ•°éƒ½æ»¡è¶³$\mathcal{\Theta}\left(\sqrt{\frac{d_k}{d_{k-1}}}\right)$ï¼Œæ‰€ä»¥$\Vert\boldsymbol{W<em k-1="k-1">k\Vert_2$è‡ªå§‹è‡³ç»ˆä¹Ÿæ»¡è¶³$\mathcal{\Theta}\left(\sqrt{\frac{d_k}{d</em>\right)$ï¼Œè¿™å°±æ»¡è¶³äº†ä¸¤ä¸ªè°±æ¡ä»¶ã€‚}}</p>
<p>è¿™æ—¶å€™å¯èƒ½ä¼šæœ‰è¯»è€…ç–‘é—®ï¼Œåªè€ƒè™‘åˆå§‹åŒ–å’Œå¢é‡çš„ç¨³å®šæ€§ï¼ŒçœŸçš„èƒ½ä¿è¯$\boldsymbol{W}<em RMS="RMS">k$çš„ç¨³å®šæ€§å—ï¼Ÿéš¾é“ä¸å¯èƒ½å‡ºç°$\Vert\boldsymbol{W}_k\Vert</em>\right)$å¼ºè°ƒçš„æ˜¯ä¸æ¨¡å‹å°ºåº¦ï¼ˆç›®å‰ä¸»è¦æ˜¯å®½åº¦ï¼‰çš„å…³ç³»ï¼Œå®ƒä¸æ’é™¤ç”±äºå…¶ä½™è¶…å‚è®¾ç½®ä¸å½“å¯¼è‡´è®­ç»ƒå´©æºƒçš„å¯èƒ½æ€§ï¼Œå®ƒè¦è¡¨è¾¾çš„æ˜¯æŒ‰è¿™æ ·è®¾ç½®ä¹‹åï¼Œå³ä¾¿å‡ºç°äº†å´©æºƒç°è±¡ï¼ŒåŸå› ä¹Ÿè·Ÿå°ºåº¦å˜åŒ–æ— å…³ã€‚}\to\infty$å—ï¼Ÿç­”æ¡ˆæ˜¯æœ‰å¯èƒ½ã€‚è¿™é‡Œçš„$\mathcal{\Theta}\left(\sqrt{\frac{d_k}{d_{k-1}}</p>
<h2 id="_5">å¥‡å¼‚å€¼è£å‰ª</h2>
<p>è¦å®ç°è°±èŒƒæ•°æ¡ä»¶ï¼Œé™¤äº†è°±å½’ä¸€åŒ–è¿™ç§æ ‡å‡†æ–¹æ³•å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è€ƒè™‘å¥‡å¼‚å€¼è£å‰ªï¼ˆSingular Value Clippingï¼Œä¸‹é¢ç®€ç§°â€œSVCâ€ï¼‰ã€‚è¿™éƒ¨åˆ†å†…å®¹æ˜¯ç¬”è€…è‡ªè¡Œè¡¥å……çš„ï¼Œå¹¶æœªåœ¨åŸè®ºæ–‡å‡ºç°ï¼Œä½†å®ƒå¯ä»¥è§£é‡Šä¸€äº›æœ‰æ„æ€çš„ç»“æœã€‚</p>
<p>ä»å¥‡å¼‚å€¼çš„è§’åº¦æ¥ï¼Œè°±å½’ä¸€åŒ–æ˜¯å°†æœ€å¤§å¥‡å¼‚å€¼ç¼©æ”¾æˆ1ï¼Œå¹¶åŒæ­¥ç¼©æ”¾å…¶ä½™å¥‡å¼‚å€¼ï¼Œå¥‡å¼‚å€¼è£å‰ªæŸä¸ªè§’åº¦æ¥çœ‹å®½æ¾ä¸€äº›ï¼Œå®ƒåªå°†å¤§äº1çš„å¥‡å¼‚å€¼è®¾ä¸º1ï¼Œä½†ä¸æ”¹å˜åŸæœ¬å°±å°äºç­‰äº1çš„å¥‡å¼‚å€¼ï¼š<br />
\begin{equation}\mathop{\text{SVC}}(\boldsymbol{W}) = \boldsymbol{U}\min(\boldsymbol{\Lambda},1)\boldsymbol{V}^{\top},\qquad \boldsymbol{U},\boldsymbol{\Lambda},\boldsymbol{V}^{\top} = \mathop{\text{SVD}}(\boldsymbol{W})\end{equation}<br />
ä½œä¸ºå¯¹æ¯”ï¼Œè°±å½’ä¸€åŒ–æ˜¯$\mathop{\text{SN}}(\boldsymbol{W})=\boldsymbol{U}(\boldsymbol{\Lambda}/\max(\boldsymbol{\Lambda}))\boldsymbol{V}^{\top}$ã€‚ç”¨å¥‡å¼‚å€¼è£å‰ªæ›¿ä»£è°±å½’ä¸€åŒ–ï¼Œæˆ‘ä»¬å¾—åˆ°<br />
\begin{equation}\boldsymbol{W}<em k-1="k-1">k = \sigma\sqrt{\frac{d_k}{d</em>}}}\mathop{\text{SVC}}(\boldsymbol{W<em k-1="k-1">k'), \qquad \Delta \boldsymbol{W}_k = \eta\sqrt{\frac{d_k}{d</em>}}}\mathop{\text{SVC}}(\boldsymbol{\Phi<em _lambda_to_infty="\lambda\to\infty">k)\end{equation}<br />
å¥‡å¼‚å€¼è£å‰ªçš„ç¼ºç‚¹æ˜¯å®ƒåªæœ‰åœ¨è‡³å°‘ä¸€ä¸ªå¥‡å¼‚å€¼å¤§äºç­‰äº1æ—¶æ‰èƒ½ä¿è¯è£å‰ªåçš„è°±èŒƒæ•°ç­‰äº1ï¼Œå¦‚æœä¸æ»¡è¶³ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¹˜ä¸Šä¸€ä¸ª$\lambda &gt; 0$ç„¶åå†è£å‰ªï¼Œå³æ”¹ä¸º$\mathop{\text{SVC}}(\lambda\boldsymbol{W})$ã€‚ç„¶è€Œï¼Œä¸åŒçš„æ¯”ä¾‹å› å­ä¼šå¾—åˆ°ä¸åŒçš„ç»“æœï¼Œä½†æˆ‘ä»¬ä¹Ÿä¸å¤§å¥½ç¡®å®šé€‚åˆçš„æ¯”ä¾‹å› å­ã€‚ä¸è¿‡ï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ä¸€ä¸ªæé™ç‰ˆæœ¬<br />
\begin{equation}\lim</em>} \mathop{\text{SVC}}(\lambda\boldsymbol{W}) = \mathop{\text{msign}}(\boldsymbol{W})\end{equation<br />
è¿™é‡Œçš„$\mathop{\text{msign}}$å°±æ˜¯Muoné‡Œçš„çŸ©é˜µç‰ˆç¬¦å·å‡½æ•°$\mathop{\text{msign}}$ï¼ˆå‚è€ƒ<a href="/archives/10592">ã€ŠMuonä¼˜åŒ–å™¨èµæï¼šä»å‘é‡åˆ°çŸ©é˜µçš„æœ¬è´¨è·¨è¶Šã€‹</a>ï¼‰ã€‚ç”¨$\mathop{\text{msign}}$æ›¿æ¢è°±å½’ä¸€åŒ–æˆ–å¥‡å¼‚å€¼è£å‰ªï¼Œå¾—åˆ°<br />
\begin{equation}\Delta \boldsymbol{W}<em k-1="k-1">k = \eta\sqrt{\frac{d_k}{d</em>}}}\mathop{\text{msign}}(\boldsymbol{\Phi}_k)\end{equation<br />
è¿™æ ·æˆ‘ä»¬å®é™…å¾—åˆ°äº†å¹¿ä¹‰çš„Muonä¼˜åŒ–å™¨ï¼Œæ ‡å‡†çš„Muonæ˜¯å¯¹åŠ¨é‡$\mathop{\text{msign}}$ï¼Œè€Œå®ƒå…è®¸æˆ‘ä»¬å¯¹ä»»ä½•ç°æˆä¼˜åŒ–å™¨å‡ºæ¥çš„æ›´æ–°é‡è¿›è¡Œ$\mathop{\text{msign}}$ã€‚æ— ç‹¬æœ‰å¶ï¼Œå‰æ®µæ—¶é—´æ¨ç‰¹ä¸Šè¿˜çœŸæœ‰äººåšäº†å¯¹Adamæ›´æ–°é‡$\mathop{\text{msign}}$çš„å®éªŒï¼ˆå¯¹æ–¹ç§°ä¹‹ä¸ºâ€œMudamwâ€ï¼Œ<a href="https://x.com/kyleliang5/status/1896385441571742103">é“¾æ¥</a>ï¼‰ï¼Œå‘ç°æ•ˆæœæ¯”Muonè¿˜ç•¥å¥½ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š  </p>
<p><a href="/usr/uploads/2025/03/585996134.jpeg" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="Adam+msginæ•ˆæœä¼¼ä¹ä¼˜äºMuonï¼ˆæ¥è‡ªæ¨ç‰¹ @KyleLiang5 ï¼‰" src="/usr/uploads/2025/03/585996134.jpeg" /></a></p>
<p>Adam+msginæ•ˆæœä¼¼ä¹ä¼˜äºMuonï¼ˆæ¥è‡ªæ¨ç‰¹ @KyleLiang5 ï¼‰</p>
<p>æˆ‘ä»¬çœ‹åˆ°ååœ¨å°æ¨¡å‹ä¸Šä¹Ÿå°è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°å±…ç„¶å¯ä»¥å¤ç°åˆ°ç›¸ä¼¼çš„ç»“è®ºï¼æ‰€ä»¥è¯´ä¸å‡†å¯¹ç°æœ‰ä¼˜åŒ–å™¨$\mathop{\text{msign}}$ä¸€ä¸‹ï¼Œéƒ½æœ‰æœºä¼šå¾—åˆ°æ›´å¥½çš„ç»“æœã€‚è¿™ç§æ“ä½œçš„å¯è¡Œæ€§åœ¨åŸæœ¬çš„Muonæ¡†æ¶ä¸‹æ˜¯å¾ˆéš¾è§£é‡Šçš„ï¼Œä½†è¿™é‡Œæˆ‘ä»¬å°†å®ƒç†è§£ä¸ºå¯¹æ›´æ–°é‡åšå¥‡å¼‚å€¼è£å‰ªï¼ˆçš„æé™ç‰ˆæœ¬ï¼‰ï¼Œå°±ä¼šè‡ªç„¶å¾—åˆ°äº†è¿™ä¸ªç»“æœã€‚</p>
<h2 id="_6">è¿‘ä¼¼ä¼°è®¡</h2>
<p>ä¸€èˆ¬è®¤ä¸ºï¼Œè°±å½’ä¸€åŒ–ã€å¥‡å¼‚å€¼è£å‰ªæˆ–$\mathop{\text{msign}}$ç­‰è·ŸSVDï¼ˆå¥‡å¼‚å€¼åˆ†è§£ï¼‰ç›¸å…³çš„è¿ç®—éƒ½æ˜¯æ¯”è¾ƒæ˜‚è´µçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜æ˜¯å¸Œæœ›èƒ½å¯»æ‰¾æ›´ç®€å•çš„å½¢å¼ã€‚ç”±äºæˆ‘ä»¬çš„ç›®æ ‡åªæ˜¯å¯»æ±‚æ¨¡å‹å°ºåº¦é—´çš„ç¼©æ”¾è§„å¾‹ï¼Œæ‰€ä»¥è¿›ä¸€æ­¥çš„ç®€åŒ–ç¡®å®æ˜¯æœ‰å¯èƒ½çš„ã€‚</p>
<p>ï¼ˆæ³¨ï¼šäº‹å®ä¸Šæˆ‘ä»¬çš„<a href="https://papers.cool/arxiv/2502.16982">Moonlight</a>å·¥ä½œè¡¨æ˜ï¼Œåªè¦å®ç°å¾—å¥½ï¼Œå³ä¾¿æ¯ä¸€æ­¥æ›´æ–°éƒ½è¿›è¡Œ$\mathop{\text{msign}}$ï¼Œæ‰€å¢åŠ çš„æˆæœ¬æ˜¯éå¸¸æœ‰é™çš„ï¼Œæ‰€ä»¥è¿™ä¸€èŠ‚çš„å†…å®¹ï¼Œç›®å‰çœ‹æ¥æ›´å¤šæ˜¯ä¸ºäº†æ¢ç´¢æ˜¾å¼çš„ç¼©æ”¾è§„å¾‹è€Œä¸æ˜¯èŠ‚çœè®¡ç®—æˆæœ¬ï¼‰ã€‚</p>
<p>é¦–å…ˆä»ç„¶æ˜¯åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–å…¶å®æ˜¯ä¸€æ¬¡æ€§çš„ï¼Œæ‰€ä»¥å…¶å®è®¡ç®—é‡å¤§ä¸€ç‚¹ä¹Ÿä¸æ˜¯å•¥é—®é¢˜ï¼Œæ‰€ä»¥å‰é¢çš„å…ˆéšæœºåˆå§‹åŒ–ç„¶åè°±å½’ä¸€åŒ–/å¥‡å¼‚å€¼è£å‰ª/$\mathop{\text{msign}}$çš„æ–¹æ¡ˆå¯ä»¥ç»§ç»­ä¿ç•™ã€‚å¦‚æœè¿˜æ˜¯æƒ³è¦ç²¾ç›Šæ±‚ç²¾ï¼Œé‚£ä¹ˆå¯ä»¥åˆ©ç”¨ä¸€ä¸ªç»Ÿè®¡ç»“æœï¼šä¸€ä¸ªä»æ ‡å‡†æ­£æ€åˆ†å¸ƒç‹¬ç«‹é‡å¤é‡‡æ ·å‡ºæ¥çš„$d_{k-1}\times d_k$çŸ©é˜µï¼Œå®ƒçš„æœ€å¤§å¥‡å¼‚å€¼å¤§è‡´æ˜¯$\sqrt{d_{k-1}} + \sqrt{d_k}$ã€‚è¿™æ ·ç›¸å½“äºè¯´åªè¦é‡‡æ ·æ ‡å‡†å·®æ”¹ä¸º<br />
\begin{equation}\sigma_k = \mathcal{\Theta}\left(\sqrt{\frac{d_k}{d_{k-1}}}(\sqrt{d_{k-1}} + \sqrt{d_k})^{-1}\right) = \mathcal{\Theta}\left(\sqrt{\frac{1}{d_{k-1}}\min\left(1, \frac{d_k}{d_{k-1}}\right)}\right) \label{eq:spec-std}\end{equation}<br />
å°±å¯ä»¥åœ¨åˆå§‹åŒ–é˜¶æ®µæ»¡è¶³$\Vert\boldsymbol{W}<em k-1="k-1">k\Vert_2=\mathcal{\Theta}\left(\sqrt{\frac{d_k}{d</em>\right)$çš„éœ€æ±‚ã€‚è‡³äºè¿™ä¸ªç»Ÿè®¡ç»“æœçš„è¯æ˜ï¼Œå¯ä»¥å‚è€ƒ}}<a href="https://www.math.uci.edu/~rvershyn/papers/HDP-book/HDP-book.html">ã€ŠHigh-Dimensional Probabilityã€‹</a>ã€<a href="https://en.wikipedia.org/wiki/Marchenko%E2%80%93Pastur_distribution">ã€ŠMarchenko-Pastur lawã€‹</a>ç­‰èµ„æ–™ï¼Œè¿™é‡Œå°±ä¸å±•å¼€äº†ã€‚</p>
<p>ç„¶åæˆ‘ä»¬æ¥è€ƒå¯Ÿæ›´æ–°é‡ï¼Œå®ƒç›¸å¯¹éº»çƒ¦ä¸€ç‚¹ï¼Œå› ä¸ºä»»æ„æ›´æ–°é‡$\boldsymbol{\Phi}_k$çš„è°±èŒƒæ•°å¹¶ä¸æ˜¯é‚£ä¹ˆå¥½ä¼°è®¡ã€‚è¿™é‡Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ä¸€ä¸ªç»éªŒç»“è®ºï¼Œé‚£å°±æ˜¯å‚æ•°çš„æ¢¯åº¦çŸ©é˜µé€šå¸¸éƒ½æ˜¯ä½ç§©çš„ã€‚è¿™é‡Œçš„ä½ç§©å¹¶ä¸ä¸€å®šæ˜¯æ•°å­¦ä¸Šä¸¥æ ¼çš„ä½ç§©ï¼Œè€Œæ˜¯æŒ‡æœ€å¤§çš„å‡ ä¸ªï¼ˆæ•°ç›®è·Ÿæ¨¡å‹å°ºåº¦æ— å…³ï¼‰å¥‡å¼‚å€¼æ˜æ˜¾è¶…è¿‡å…¶ä½™å¥‡å¼‚å€¼ï¼Œä½¿å¾—ä½ç§©è¿‘ä¼¼å¯ç”¨ï¼Œè¿™ä¹Ÿæ˜¯å„ç§<a href="/tag/lora/">LoRA</a>ä¼˜åŒ–çš„ç†è®ºåŸºç¡€ã€‚</p>
<p>è¿™ä¸ªç»éªŒå‡è®¾çš„ä¸€ä¸ªç›´æ¥æ¨è®ºæ˜¯è°±èŒƒæ•°ä¸æ ¸èŒƒæ•°çš„è¿‘ä¼¼æ€§ï¼Œå› ä¸ºè°±èŒƒæ•°æ˜¯æœ€å¤§çš„å¥‡å¼‚å€¼ï¼Œæ ¸èŒƒæ•°æ˜¯å…¨ä½“å¥‡å¼‚å€¼ä¹‹å’Œï¼Œè€Œä¸Šè¿°å‡è®¾ä¹‹ä¸‹æ ¸èŒƒæ•°çº¦ç­‰äºæœ€å¤§çš„è‹¥å¹²ä¸ªå¥‡å¼‚å€¼çš„å’Œï¼Œé‚£ä¹ˆä¸¤è€…è‡³å°‘åœ¨å°ºåº¦ä¸Šæ˜¯ä¸€è‡´çš„ï¼Œå³$\mathcal{\Theta}(\Vert\nabla_{\boldsymbol{W}<em _boldsymbol_W="\boldsymbol{W">k}\mathcal{L}\Vert_2)=\mathcal{\Theta}(\Vert\nabla</em><em>k}\mathcal{L}\Vert</em><em>)$ã€‚æ¥ç€æˆ‘ä»¬åˆ©ç”¨$\Delta\mathcal{L}$ä¸$\Delta\boldsymbol{W}<em _boldsymbol_W="\boldsymbol{W">k$çš„å…³ç³»ï¼š<br />
\begin{equation}\Delta\mathcal{L} \approx \sum_k \langle \Delta\boldsymbol{W}_k, \nabla</em><em _boldsymbol_W="\boldsymbol{W">k}\mathcal{L}\rangle_F \leq \sum_k \Vert\Delta\boldsymbol{W}_k\Vert_2\, \Vert\nabla</em><em>k}\mathcal{L}\Vert</em></em>\end{equation}<br />
è¿™é‡Œçš„$\langle\cdot,\cdot\rangle_F$æ˜¯$F$å†…ç§¯ï¼Œå³çŸ©é˜µå±•å¹³å½“å‘é‡ç®—å†…ç§¯ï¼Œè‡³äºä¸ç­‰å·æ˜¯å› ä¸ºçŸ©é˜µèŒƒæ•°çš„ä¸€ä¸ªç»å…¸ä¸ç­‰å¼$\langle\boldsymbol{A},\boldsymbol{B}\rangle_F \leq \Vert\boldsymbol{A}\Vert_2\, \Vert\boldsymbol{B}\Vert_<em>$ï¼Œç±»ä¼¼äº<a href="https://en.wikipedia.org/wiki/H%C3%B6lder%27s_inequality">Holderä¸ç­‰å¼</a>ï¼Œå®é™…ä¸Šæˆ‘ä»¬åœ¨<a href="/archives/10592#%E7%9F%A9%E9%98%B5%E8%8C%83%E6%95%B0">ã€ŠMuonä¼˜åŒ–å™¨èµæï¼šä»å‘é‡åˆ°çŸ©é˜µçš„æœ¬è´¨è·¨è¶Šã€‹</a>æ¨å¯¼Muonæ—¶å°±è¯æ˜çš„å°±æ˜¯å®ƒã€‚åŸºäºä¸Šå¼å¹¶ç»“åˆæ¢¯åº¦çš„ä½ç§©å‡è®¾ï¼Œæˆ‘ä»¬æœ‰<br />
\begin{equation}\Delta\mathcal{L} \sim \sum_k \mathcal{\Theta}(\Vert\Delta\boldsymbol{W}<em _boldsymbol_W="\boldsymbol{W">k\Vert_2\, \Vert\nabla</em><em>k}\mathcal{L}\Vert</em></em>) \sim \sum_k \mathcal{\Theta}(\Vert\Delta\boldsymbol{W}<em _boldsymbol_W="\boldsymbol{W">k\Vert_2\, \Vert\nabla</em><em k-1="k-1">k}\mathcal{L}\Vert_2)\end{equation}<br />
åˆ«å¿˜äº†ï¼Œæˆ‘ä»¬åœ¨å‰é¢å°±å·²ç»è¯æ˜è¿‡ï¼Œæ»¡è¶³ä¸¤ä¸ªè°±æ¡ä»¶ä¹‹ä¸‹å¿…ç„¶æœ‰$\Delta\mathcal{L}=\mathcal{\Theta}(1)$ï¼Œç°åœ¨ç»“åˆä¸Šå¼æˆ‘ä»¬å¯ä»¥å¾—åˆ°å½“$\Vert\Delta\boldsymbol{W}_k\Vert_2=\mathcal{\Theta}\left(\sqrt{\frac{d_k}{d</em>\right)$æ—¶æœ‰}}<br />
\begin{equation}\mathcal{\Theta}(\Vert\nabla_{\boldsymbol{W}<em k-1="k-1">k}\mathcal{L}\Vert_2) = \mathcal{\Theta}\left(\sqrt{\frac{d</em>}}{d_k}}\right)\label{eq:grad-norm}\end{equation<br />
è¿™å°±æ˜¯å…³äºæ¢¯åº¦æ•°é‡çº§çš„é‡è¦ä¼°è®¡ç»“æœï¼Œå®ƒç›´æ¥ç”±ä¸¤ä¸ªè°±æ¡ä»¶æ¨å‡ºï¼Œé¿å…äº†æ˜¾å¼çš„æ¢¯åº¦è®¡ç®—ã€‚è¿™ä¾¿æ˜¯è°±æ¡ä»¶çš„ç¬¬ä¸‰ä¸ªç¾å¦™ä¹‹å¤„ï¼Œå®ƒä½¿å¾—æˆ‘ä»¬ä¸éœ€è¦é€šè¿‡é“¾å¼æ³•åˆ™æ¥è®¡ç®—æ¢¯åº¦è¡¨è¾¾å¼å°±å¯ä»¥è·å¾—ç›¸å…³ä¼°è®¡ã€‚</p>
<h2 id="_7">å­¦ä¹ ç‡ç­–ç•¥</h2>
<p>å°†ä¼°è®¡$\eqref{eq:grad-norm}$ç”¨äºSGDï¼Œå³$\Delta \boldsymbol{W}<em _boldsymbol_W="\boldsymbol{W">k = -\eta_k \nabla</em><em _boldsymbol_W="\boldsymbol{W">k}\mathcal{L}$ï¼Œæ ¹æ®å¼$\eqref{eq:grad-norm}$æˆ‘ä»¬æœ‰$\Vert\nabla</em><em k-1="k-1">k}\mathcal{L}\Vert_2=\mathcal{\Theta}\left(\sqrt{\frac{d</em>}}{d_k}}\right)$ï¼Œä¸ºäº†è¾¾åˆ°$\Vert\Delta\boldsymbol{W<em k-1="k-1">k\Vert_2=\mathcal{\Theta}\left(\sqrt{\frac{d_k}{d</em>\right)$çš„ç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦æœ‰}}<br />
\begin{equation}\eta_k = \mathcal{\Theta}\left(\frac{d_k}{d_{k-1}}\right)\label{eq:sgd-eta}\end{equation}</p>
<p>è‡³äºAdamï¼Œæˆ‘ä»¬ä»ç”¨SignSGDè¿‘ä¼¼$\newcommand{sign}{\mathop{\text{sign}}}\Delta \boldsymbol{W}<em _boldsymbol_W="\boldsymbol{W">k = -\eta_k \sign(\nabla</em><em _boldsymbol_W="\boldsymbol{W">k}\mathcal{L})$ï¼Œç”±äº$\sign$ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯$\pm 1$ï¼Œæ‰€ä»¥$\Vert\sign(\nabla</em><em k-1="k-1">k}\mathcal{L})\Vert_F = \mathcal{\Theta}(\sqrt{d</em>} d_k})$ï¼Œè€Œ$\sign$è¿™ç§Element-wiseçš„è¿ç®—ï¼Œä¸€èˆ¬ä¸ä¼šæœ‰ä»€ä¹ˆç‰¹åˆ«çš„å‡ç§©ä½œç”¨ï¼Œæ‰€ä»¥æˆ‘ä»¬è®¤ä¸º$\sign(\nabla_{\boldsymbol{W<em _boldsymbol_W="\boldsymbol{W">k}\mathcal{L})$å’Œ$\nabla</em><em _boldsymbol_W="\boldsymbol{W">k}\mathcal{L}$ä¸€æ ·éƒ½æ˜¯ä½ç§©çš„ï¼Œäºæ˜¯è·Ÿæ ¸èŒƒæ•°ç±»ä¼¼ï¼Œ$F$èŒƒæ•°å’Œè°±èŒƒæ•°å°†ä¼šæ˜¯åŒé˜¶çš„ï¼Œå³$\Vert\sign(\nabla</em><em k-1="k-1">k}\mathcal{L})\Vert_2 = \mathcal{\Theta}(\sqrt{d</em>)$} d_k</p>
<p>å› æ­¤ä¸ºäº†è¾¾åˆ°$\Vert\Delta\boldsymbol{W}<em k-1="k-1">k\Vert_2=\mathcal{\Theta}\left(\sqrt{\frac{d_k}{d</em>\right)$çš„ç›®æ ‡ï¼Œæˆ‘ä»¬éœ€è¦æœ‰}}<br />
\begin{equation}\eta_k = \mathcal{\Theta}\left(\frac{1}{d_{k-1}}\right)\label{eq:adam-eta}\end{equation}</p>
<p>ç°åœ¨æˆ‘ä»¬å¯ä»¥æŠŠè°±æ¡ä»¶çš„ç»“æœè·ŸMuPè¿›è¡Œå¯¹æ¯”ã€‚MuPå‡è®¾æˆ‘ä»¬è¦å»ºç«‹ä¸€ä¸ª$\mathbb{R}^{d_{in}}\mapsto\mathbb{R}^{d_{out}}$çš„æ¨¡å‹ï¼Œå®ƒæŠŠæ¨¡å‹åˆ†ä¸‰éƒ¨åˆ†ï¼Œå…ˆç”¨ä¸€ä¸ª$d_{in}\times d$çš„çŸ©é˜µæŠŠè¾“å…¥æŠ•å½±åˆ°$d$ç»´ï¼Œç„¶ååœ¨$d$ç»´ç©ºé—´è¿›è¡Œå»ºæ¨¡ï¼Œå…¶ä¸­çš„å‚æ•°éƒ½æ˜¯$d\times d$æ–¹é˜µï¼Œæœ€åç”¨ä¸€ä¸ª$d\times d_{out}$çŸ©é˜µå¾—åˆ°$d_{out}$ç»´è¾“å‡ºã€‚ç›¸åº”åœ°ï¼ŒMuPçš„ç»“è®ºä¹Ÿåˆ†è¾“å…¥ã€ä¸­é—´ã€è¾“å‡ºä¸‰éƒ¨åˆ†ã€‚</p>
<p>åˆå§‹åŒ–æ–¹é¢ï¼ŒMuPçš„è¾“å…¥æ–¹å·®ä¸º$1/d_{in}$ã€è¾“å‡ºæ–¹å·®ä¸º$1/d^2$ï¼Œå‰©ä½™å‚æ•°çš„æ–¹å·®ä¸º$1/d$ï¼Œè€Œè°±æ¡ä»¶çš„ç»“æœåªæœ‰ä¸€ä¸ªå¼å­$\eqref{eq:spec-std}$ã€‚ä½†æˆ‘ä»¬ä»”ç»†è§‚å¯Ÿå°±ä¼šå‘ç°ï¼Œå¼$\eqref{eq:spec-std}$å·²ç»åŒ…å«äº†MuPçš„ä¸‰ç§æƒ…å†µï¼šè®¾è¾“å…¥ã€ä¸­é—´ã€è¾“å‡ºçŸ©é˜µå¤§å°æ˜¯$d_{in}\times d,d\times d,d\times d_{out}$ï¼Œä»£å…¥å¼$\eqref{eq:spec-std}$å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
\sigma_{in}^2 =&amp;\, \mathcal{\Theta}\left(\frac{1}{d_{in}}\min\left(1, \frac{d}{d_{in}}\right)\right) = \mathcal{\Theta}\left(\frac{1}{d_{in}}\right) \\\<br />
\sigma_k^2 =&amp;\, \mathcal{\Theta}\left(\frac{1}{d}\min\left(1, \frac{d}{d}\right)\right) = \mathcal{\Theta}\left(\frac{1}{d}\right) \\\<br />
\sigma_{out}^2 =&amp;\, \mathcal{\Theta}\left(\frac{1}{d}\min\left(1, \frac{d_{out}}{d}\right)\right) = \mathcal{\Theta}\left(\frac{1}{d^2}\right)<br />
\end{aligned}<br />
\qquad(d\to\infty) \end{equation}<br />
å¯èƒ½æœ‰è¯»è€…å¥‡æ€ªä¸ºä»€ä¹ˆåªè€ƒè™‘$d\to\infty$å‘¢ï¼Ÿå› ä¸º$d_{in},d_{out}$éƒ½æ˜¯ä»»åŠ¡ç›¸å…³çš„æ•°å­—ï¼Œå®ƒä»¬ç›¸å½“äºå¸¸æ•°ï¼Œå¯å˜çš„æ¨¡å‹å°ºåº¦åªæœ‰$d$ï¼Œè€ŒMuPç ”ç©¶çš„æ˜¯è¶…å‚æ•°éšæ¨¡å‹å°ºåº¦çš„æ¸è¿‘è§„å¾‹ï¼Œæ‰€ä»¥å®ƒéƒ½æ˜¯æŒ‡$d$è¶³å¤Ÿå¤§æ—¶çš„ç®€åŒ–ç‰ˆè§„å¾‹ã€‚</p>
<p>å­¦ä¹ ç‡æ–¹é¢ï¼Œå¯¹SGDæ¥è¯´ï¼ŒMuPçš„è¾“å…¥å­¦ä¹ ç‡æ˜¯$d$ï¼Œè¾“å‡ºå­¦ä¹ ç‡æ˜¯$1/d$ï¼Œå‰©ä½™å‚æ•°çš„å­¦ä¹ ç‡æ˜¯$1$ï¼Œæ³¨æ„è¿™é‡Œçš„å…³ç³»éƒ½æ˜¯æ­£æ¯”äºè€Œä¸æ˜¯ç­‰äºï¼Œè€Œè°±æ¡ä»¶çš„ç»“æœ$\eqref{eq:sgd-eta}$åŒæ ·åŒ…å«äº†è¿™ä¸‰ç§æƒ…å†µï¼›ç±»ä¼¼åœ°ï¼Œå¯¹Adamæ¥è¯´ï¼ŒMuPçš„è¾“å…¥å­¦ä¹ ç‡æ˜¯$1$ï¼Œè¾“å‡ºå­¦ä¹ ç‡æ˜¯$1/d$ï¼Œå‰©ä½™å‚æ•°çš„å­¦ä¹ ç‡æ˜¯$1/d$ï¼Œè°±æ¡ä»¶ä¾ç„¶ç”¨å•ä¸ªå¼å­$\eqref{eq:adam-eta}$å°±æè¿°äº†è¿™ä¸‰ç§æƒ…å†µã€‚</p>
<p>æ‰€ä»¥ï¼Œè°±æ¡ä»¶ä»¥ä¸€ç§ï¼ˆåœ¨ç¬”è€…çœ‹æ¥ï¼‰æ›´ç®€å•çš„æ–¹å¼ï¼Œå¾—åˆ°äº†æ›´ç®€æ˜çš„ç»“æœï¼Œè€Œè¿™ä¸ªæ›´ç®€æ˜ç»“æœçš„å®é™…å«ä¹‰åˆ™æ¯”MuPæ›´ä¸°å¯Œï¼Œå› ä¸ºå®ƒçš„ç»“æœæ²¡æœ‰å¯¹æ¨¡å‹æ¶æ„æˆ–è€…å‚æ•°å½¢çŠ¶ä½œè¿‡å¼ºçš„å‡è®¾ã€‚å› æ­¤ï¼Œç¬”è€…ç§°è°±æ¡ä»¶æ˜¯MuPçš„æ›´é«˜é˜¶ç‰ˆæœ¬ã€‚</p>
<h2 id="_8">æ–‡ç« å°ç»“</h2>
<p>è¿™ç¯‡æ–‡ç« ä»‹ç»äº†MuPçš„å‡çº§ç‰ˆâ€”â€”è°±æ¡ä»¶ï¼Œå®ƒä»è°±èŒƒæ•°ç›¸å…³çš„ä¸ç­‰å¼åˆ‡å…¥æ¥åˆ†ææ¨¡å‹ç¨³å®šè®­ç»ƒçš„æ¡ä»¶ï¼Œä»¥ä¸€ç§æ›´ä¾¿æ·çš„æ–¹å¼å¾—åˆ°äº†æ¯”MuPæ›´ä¸°å¯Œçš„ç»“æœã€‚</p>
<p>$$\left\\{\begin{aligned}  
&\,\text{æœŸæœ›æ€§è´¨:}\left\\{\begin{aligned}  
&\,\Vert\boldsymbol{x}_k\Vert_{RMS}=\mathcal{\Theta}(1) \\\\[5pt] &\,\Vert\Delta\boldsymbol{x}_k\Vert_{RMS}=\mathcal{\Theta}(1)  
\end{aligned}\right. \\\\[10pt]  
&\,\text{è°±æ¡ä»¶:}\left\\{\begin{aligned}  
&\,\Vert\boldsymbol{W}_k\Vert_2 = \mathcal{\Theta}\left(\sqrt{\frac{d_k}{d_{k-1}}}\right) \\\\[5pt]  
&\,\Vert\Delta\boldsymbol{W}_k\Vert_2 = \mathcal{\Theta}\left(\sqrt{\frac{d_k}{d_{k-1}}}\right)  
\end{aligned}\right. \\\\[10pt]  
&\,\text{å®ç°æ–¹å¼:}\left\\{\begin{aligned}  
&\,\text{è°±å½’ä¸€åŒ–:}\left\\{\begin{aligned}  
&\,\boldsymbol{W}_k = \sigma\sqrt{\frac{d_k}{d_{k-1}}}\frac{\boldsymbol{W}_k'}{\Vert\boldsymbol{W}_k'\Vert_2} \\\\[5pt]  
&\,\Delta \boldsymbol{W}_k = \eta\sqrt{\frac{d_k}{d_{k-1}}}\frac{\boldsymbol{\Phi}_k}{\Vert\boldsymbol{\Phi}_k\Vert_2}  
\end{aligned}\right. \\\\[10pt]  
&\,\text{å¥‡å¼‚å€¼è£å‰ª:}\left\\{\begin{aligned}  
&\,\boldsymbol{W}_k = \sigma\sqrt{\frac{d_k}{d_{k-1}}}\mathop{\text{SVC}}(\boldsymbol{W}_k')\xrightarrow{\text{æé™}} \sigma\sqrt{\frac{d_k}{d_{k-1}}}\mathop{\text{msign}}(\boldsymbol{W}_k')\\\\[5pt]  
&\,\Delta \boldsymbol{W}_k = \eta\sqrt{\frac{d_k}{d_{k-1}}}\mathop{\text{SVC}}(\boldsymbol{\Phi}_k)\xrightarrow{\text{æé™}} \eta\sqrt{\frac{d_k}{d_{k-1}}}\mathop{\text{msign}}(\boldsymbol{\Phi}_k)  
\end{aligned}\right. \\\\[10pt]  
&\,\text{è¿‘ä¼¼ä¼°è®¡:}\left\\{\begin{aligned}  
&\,\sigma_k = \mathcal{\Theta}\left(\sqrt{\frac{1}{d_{k-1}}\min\left(1, \frac{d_k}{d_{k-1}}\right)}\right) \\\\[5pt]  
&\,\eta_k = \left\\{\begin{aligned}  
&\,\text{SGD: }\mathcal{\Theta}\left(\frac{d_k}{d_{k-1}}\right) \\\\[5pt]  
&\,\text{Adam: }\mathcal{\Theta}\left(\frac{1}{d_{k-1}}\right)  
\end{aligned}\right.  
\end{aligned}\right. \\\\[10pt]  
\end{aligned}\right.  
\end{aligned}\right.$$</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10795">https://spaces.ac.cn/archives/10795</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Mar. 24, 2025). ã€Šé«˜é˜¶MuPï¼šæ›´ç®€æ˜ä½†æ›´é«˜æ˜çš„è°±æ¡ä»¶ç¼©æ”¾ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10795">https://spaces.ac.cn/archives/10795</a></p>
<p>@online{kexuefm-10795,<br />
title={é«˜é˜¶MuPï¼šæ›´ç®€æ˜ä½†æ›´é«˜æ˜çš„è°±æ¡ä»¶ç¼©æ”¾},<br />
author={è‹å‰‘æ—},<br />
year={2025},<br />
month={Mar},<br />
url={\url{https://spaces.ac.cn/archives/10795}},<br />
} </p>
<hr />
<h2 id="_9">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚æˆ‘ä»¬å°†æ·±å…¥æ¨å¯¼è°±æ¡ä»¶ç¼©æ”¾çš„æ•°å­¦ç†è®ºåŸºç¡€ï¼ŒåŒ…æ‹¬è°±èŒƒæ•°çš„ä½œç”¨æœºåˆ¶ã€ä¸æ ‡å‡†Î¼Pçš„å·®å¼‚ã€LoRAä¸­çš„åº”ç”¨ã€æ¢¯åº¦æµåˆ†æç­‰å†…å®¹ã€‚</p>
<h3 id="1">1. è°±æ¡ä»¶ç¼©æ”¾çš„æ•°å­¦å®šä¹‰</h3>
<h4 id="11">1.1 è°±èŒƒæ•°ä¸ç®—å­èŒƒæ•°</h4>
<p>å¯¹äºçŸ©é˜µ$\boldsymbol{W}\in\mathbb{R}^{m\times n}$ï¼Œå…¶è°±èŒƒæ•°ï¼ˆSpectral Normï¼‰å®šä¹‰ä¸ºï¼š
$$\Vert\boldsymbol{W}\Vert_2 = \sup_{\boldsymbol{x}\neq 0} \frac{\Vert\boldsymbol{W}\boldsymbol{x}\Vert_2}{\Vert\boldsymbol{x}\Vert_2} = \sigma_{\max}(\boldsymbol{W})$$
å…¶ä¸­$\sigma_{\max}(\boldsymbol{W})$æ˜¯$\boldsymbol{W}$çš„æœ€å¤§å¥‡å¼‚å€¼ã€‚è¿™ä¸ªå®šä¹‰è¡¨æ˜ï¼Œè°±èŒƒæ•°è¡¡é‡çš„æ˜¯çŸ©é˜µä½œä¸ºçº¿æ€§ç®—å­å¯¹å‘é‡çš„æœ€å¤§æ‹‰ä¼¸ç¨‹åº¦ã€‚</p>
<p>ä»å¥‡å¼‚å€¼åˆ†è§£ï¼ˆSVDï¼‰è§’åº¦ï¼Œè®¾$\boldsymbol{W} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ï¼Œå…¶ä¸­$\boldsymbol{\Sigma} = \text{diag}(\sigma_1, \sigma_2, \ldots, \sigma_r)$ä¸”$\sigma_1\geq\sigma_2\geq\cdots\geq\sigma_r &gt; 0$ï¼Œåˆ™ï¼š
$$\Vert\boldsymbol{W}\Vert_2 = \sigma_1$$</p>
<p><strong>æ€§è´¨1ï¼ˆæ¬¡ä¹˜æ€§ï¼‰</strong>ï¼šå¯¹äºä»»æ„çŸ©é˜µ$\boldsymbol{A}\in\mathbb{R}^{m\times n}$å’Œ$\boldsymbol{B}\in\mathbb{R}^{n\times p}$ï¼Œæœ‰ï¼š
$$\Vert\boldsymbol{A}\boldsymbol{B}\Vert_2 \leq \Vert\boldsymbol{A}\Vert_2 \Vert\boldsymbol{B}\Vert_2$$</p>
<p><strong>è¯æ˜</strong>ï¼šå¯¹äºä»»æ„å•ä½å‘é‡$\boldsymbol{x}\in\mathbb{R}^p$ï¼Œæœ‰ï¼š
$$\Vert\boldsymbol{A}\boldsymbol{B}\boldsymbol{x}\Vert_2 \leq \Vert\boldsymbol{A}\Vert_2 \Vert\boldsymbol{B}\boldsymbol{x}\Vert_2 \leq \Vert\boldsymbol{A}\Vert_2 \Vert\boldsymbol{B}\Vert_2 \Vert\boldsymbol{x}\Vert_2$$
ä¸¤è¾¹å–ä¸Šç¡®ç•Œå³å¾—ã€‚$\square$</p>
<h4 id="12">1.2 è°±æ¡ä»¶çš„å½¢å¼åŒ–å®šä¹‰</h4>
<p>å¯¹äºæ·±åº¦ç¥ç»ç½‘ç»œçš„ç¬¬$k$å±‚ï¼Œè®°è¾“å…¥ä¸º$\boldsymbol{x}<em k-1="k-1">{k-1}\in\mathbb{R}^{d</em>}}$ï¼Œæƒé‡çŸ©é˜µä¸º$\boldsymbol{W<em k-1="k-1">k\in\mathbb{R}^{d</em>}\times d_k}$ï¼Œè¾“å‡ºä¸º$\boldsymbol{x<em k-1="k-1">k = f(\boldsymbol{x}</em>_k)$ï¼Œå…¶ä¸­$f$æ˜¯æ¿€æ´»å‡½æ•°ã€‚}\boldsymbol{W</p>
<p><strong>å®šä¹‰1ï¼ˆè°±æ¡ä»¶ï¼‰</strong>ï¼šç§°æƒé‡çŸ©é˜µ$\boldsymbol{W}_k$æ»¡è¶³è°±æ¡ä»¶ï¼Œå¦‚æœå­˜åœ¨å¸¸æ•°$C_1, C_2 &gt; 0$ï¼ˆä¸æ¨¡å‹å®½åº¦$d_k$æ— å…³ï¼‰ï¼Œä½¿å¾—ï¼š
$$C_1\sqrt{\frac{d_k}{d_{k-1}}} \leq \Vert\boldsymbol{W}_k\Vert_2 \leq C_2\sqrt{\frac{d_k}{d_{k-1}}}$$</p>
<p>è¿™æ„å‘³ç€$\Vert\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d</em>\right)$ã€‚}}</p>
<p>ç±»ä¼¼åœ°ï¼Œå¯¹äºå‚æ•°æ›´æ–°é‡$\Delta\boldsymbol{W}_k$ï¼Œæˆ‘ä»¬è¦æ±‚ï¼š
$$\Vert\Delta\boldsymbol{W}_k\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d_{k-1}}}\right)$$</p>
<h4 id="13-rms">1.3 RMSèŒƒæ•°çš„ç­‰ä»·æ€§</h4>
<p>å¼•å…¥RMSèŒƒæ•°æ˜¯ä¸ºäº†æ¶ˆé™¤ç»´åº¦å¸¦æ¥çš„å½±å“ã€‚å¯¹äºå‘é‡$\boldsymbol{x}\in\mathbb{R}^d$ï¼š
$$\Vert\boldsymbol{x}\Vert_{RMS} = \sqrt{\frac{1}{d}\sum_{i=1}^d x_i^2} = \frac{1}{\sqrt{d}}\Vert\boldsymbol{x}\Vert_2$$</p>
<p><strong>å¼•ç†1</strong>ï¼šå¦‚æœ$\boldsymbol{x}\boldsymbol{W}$è¡¨ç¤ºçŸ©é˜µä¹˜æ³•ï¼Œå…¶ä¸­$\boldsymbol{x}\in\mathbb{R}^{d_{in}}$ï¼Œ$\boldsymbol{W}\in\mathbb{R}^{d_{in}\times d_{out}}$ï¼Œåˆ™ï¼š
$$\Vert\boldsymbol{x}\boldsymbol{W}\Vert_{RMS} \leq \sqrt{\frac{d_{in}}{d_{out}}}\Vert\boldsymbol{x}\Vert_{RMS}\Vert\boldsymbol{W}\Vert_2$$</p>
<p><strong>è¯æ˜</strong>ï¼šç”±$\eqref{neq:spec-2}$ï¼Œæœ‰ï¼š
$$\Vert\boldsymbol{x}\boldsymbol{W}\Vert_2 \leq \Vert\boldsymbol{x}\Vert_2\Vert\boldsymbol{W}\Vert_2$$</p>
<p>ä¸¤è¾¹åŒæ—¶é™¤ä»¥$\sqrt{d_{out}}$ï¼Œå¾—ï¼š
$$\Vert\boldsymbol{x}\boldsymbol{W}\Vert_{RMS} = \frac{1}{\sqrt{d_{out}}}\Vert\boldsymbol{x}\boldsymbol{W}\Vert_2 \leq \frac{1}{\sqrt{d_{out}}}\Vert\boldsymbol{x}\Vert_2\Vert\boldsymbol{W}\Vert_2 = \sqrt{\frac{d_{in}}{d_{out}}}\Vert\boldsymbol{x}\Vert_{RMS}\Vert\boldsymbol{W}\Vert_2$$
$\square$</p>
<h3 id="2-p">2. ä¸æ ‡å‡†Î¼Pçš„å·®å¼‚åˆ†æ</h3>
<h4 id="21-p">2.1 æ ‡å‡†Î¼Pçš„æ¨å¯¼è·¯å¾„</h4>
<p>æ ‡å‡†Î¼Pï¼ˆMaximal Update Parametrizationï¼‰é€šè¿‡å››ä¸ªä¸å˜æ€§æ¡ä»¶æ¨å¯¼ï¼š
1. <strong>å‰å‘ä¼ æ’­ç¨³å®šæ€§</strong>ï¼š$\mathbb{E}[\Vert\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">k\Vert^2] = \Theta(d_k)$
2. <strong>åå‘ä¼ æ’­ç¨³å®šæ€§</strong>ï¼š$\mathbb{E}[\Vert\nabla</em>\Vert^2] = \Theta(d_k)$
3. }_k}\mathcal{L<strong>æŸå¤±å¢é‡æœ‰ç•Œæ€§</strong>ï¼š$\mathbb{E}[\Delta\mathcal{L}] = \Theta(1)$
4. <strong>ç‰¹å¾å˜åŒ–æœ‰ç•Œæ€§</strong>ï¼š$\mathbb{E}[\Vert\Delta\boldsymbol{x}_k\Vert^2] = \Theta(d_k)$</p>
<p>æ ‡å‡†Î¼Pé’ˆå¯¹ä¸‰ç±»å‚æ•°ç»™å‡ºä¸åŒçš„ç¼©æ”¾æ–¹æ¡ˆï¼š
- <strong>è¾“å…¥å±‚</strong>ï¼ˆ$d_{in}\times d$ï¼‰ï¼šåˆå§‹åŒ–æ–¹å·®$\sigma^2 = \Theta(1/d_{in})$ï¼Œå­¦ä¹ ç‡$\eta = \Theta(d)$ï¼ˆSGDï¼‰æˆ–$\Theta(1)$ï¼ˆAdamï¼‰
- <strong>éšè—å±‚</strong>ï¼ˆ$d\times d$ï¼‰ï¼šåˆå§‹åŒ–æ–¹å·®$\sigma^2 = \Theta(1/d)$ï¼Œå­¦ä¹ ç‡$\eta = \Theta(1)$ï¼ˆSGDï¼‰æˆ–$\Theta(1/d)$ï¼ˆAdamï¼‰
- <strong>è¾“å‡ºå±‚</strong>ï¼ˆ$d\times d_{out}$ï¼‰ï¼šåˆå§‹åŒ–æ–¹å·®$\sigma^2 = \Theta(1/d^2)$ï¼Œå­¦ä¹ ç‡$\eta = \Theta(1/d)$ï¼ˆSGDï¼‰æˆ–$\Theta(1/d)$ï¼ˆAdamï¼‰</p>
<h4 id="22">2.2 è°±æ¡ä»¶çš„ç®€åŒ–ä¼˜åŠ¿</h4>
<p>è°±æ¡ä»¶æ–¹æ³•ä»…éœ€ä¸¤ä¸ªæ¡ä»¶ï¼š
1. <strong>è¾“å‡ºç¨³å®šæ€§</strong>ï¼š$\Vert\boldsymbol{x}<em RMS="RMS">k\Vert</em> = \Theta(1)$
2. <strong>å¢é‡ç¨³å®šæ€§</strong>ï¼š$\Vert\Delta\boldsymbol{x}<em RMS="RMS">k\Vert</em> = \Theta(1)$</p>
<p><strong>å®šç†1ï¼ˆæŸå¤±å¢é‡çš„è‡ªåŠ¨æ»¡è¶³ï¼‰</strong>ï¼šè‹¥å¯¹æ‰€æœ‰å±‚$k$éƒ½æœ‰$\Vert\boldsymbol{x}<em RMS="RMS">k\Vert</em>} = \Theta(1)$å’Œ$\Vert\Delta\boldsymbol{x<em RMS="RMS">k\Vert</em> = \Theta(1)$ã€‚} = \Theta(1)$ï¼Œåˆ™è‡ªåŠ¨æœ‰$\Delta\mathcal{L</p>
<p><strong>è¯æ˜</strong>ï¼šè®¾ç½‘ç»œæœ‰$K$å±‚ï¼ŒæŸå¤±å‡½æ•°ä¸º$\ell(\boldsymbol{x}_K)$ã€‚å‡è®¾$\ell$æ˜¯Lipschitzè¿ç»­çš„ï¼Œå­˜åœ¨å¸¸æ•°$L &gt; 0$ä½¿å¾—ï¼š
$$|\ell(\boldsymbol{x}_K + \Delta\boldsymbol{x}_K) - \ell(\boldsymbol{x}_K)| \leq L\Vert\Delta\boldsymbol{x}_K\Vert_2$$</p>
<p>ç”±äº$\Vert\Delta\boldsymbol{x}<em RMS="RMS">K\Vert</em>} = \Theta(1)$ï¼Œæœ‰$\Vert\Delta\boldsymbol{x<em RMS="RMS">K\Vert_2 = \sqrt{d_K}\Vert\Delta\boldsymbol{x}_K\Vert</em>)$ã€‚} = \Theta(\sqrt{d_K</p>
<p>åŒæ—¶ï¼Œç”±äº$\Vert\boldsymbol{x}<em RMS="RMS">K\Vert</em>_K\Vert_2 = \Theta(1)$ï¼Œä»è€Œï¼š
$$\Delta\ell = \ell(\boldsymbol{x}_K + \Delta\boldsymbol{x}_K) - \ell(\boldsymbol{x}_K) = \Theta(1)$$} = \Theta(1)$ï¼Œè¾“å‡ºç»´åº¦$d_K$é€šå¸¸æ˜¯ä»»åŠ¡ç›¸å…³çš„å¸¸æ•°ï¼ˆå¦‚åˆ†ç±»ä»»åŠ¡çš„ç±»åˆ«æ•°ï¼‰ï¼Œå› æ­¤$\Vert\Delta\boldsymbol{x</p>
<p>å¯¹æ‰¹æ¬¡å¹³å‡å¾—$\Delta\mathcal{L} = \Theta(1)$ã€‚$\square$</p>
<h4 id="23">2.3 ç»Ÿä¸€çš„ç¼©æ”¾å…¬å¼</h4>
<p>è°±æ¡ä»¶ç»™å‡ºå•ä¸€çš„ç¼©æ”¾å…¬å¼$\eqref{eq:spec-std}$ï¼š
$$\sigma_k = \Theta\left(\sqrt{\frac{1}{d_{k-1}}\min\left(1, \frac{d_k}{d_{k-1}}\right)}\right)$$</p>
<p><strong>éªŒè¯ä¸Î¼Pçš„ç­‰ä»·æ€§</strong>ï¼š</p>
<p>è®¾æ¨¡å‹ä¸º$d_{in} \to d \to d \to \cdots \to d \to d_{out}$ï¼Œå…¶ä¸­$d\to\infty$æ˜¯å¯å˜å®½åº¦ã€‚</p>
<ol>
<li>
<p><strong>è¾“å…¥å±‚</strong>ï¼ˆ$d_{in}\times d$ï¼‰ï¼š
   $$\sigma_{in}^2 = \Theta\left(\frac{1}{d_{in}}\min\left(1, \frac{d}{d_{in}}\right)\right)$$
   å½“$d\to\infty$æ—¶ï¼Œ$d/d_{in}\to\infty$ï¼Œæ•…$\min(1, d/d_{in}) = 1$ï¼Œå¾—ï¼š
   $$\sigma_{in}^2 = \Theta\left(\frac{1}{d_{in}}\right)$$
   è¿™ä¸Î¼Pçš„è¾“å…¥å±‚æ–¹å·®ä¸€è‡´ã€‚</p>
</li>
<li>
<p><strong>éšè—å±‚</strong>ï¼ˆ$d\times d$ï¼‰ï¼š
   $$\sigma_k^2 = \Theta\left(\frac{1}{d}\min(1, 1)\right) = \Theta\left(\frac{1}{d}\right)$$
   è¿™ä¸Î¼Pçš„éšè—å±‚æ–¹å·®ä¸€è‡´ã€‚</p>
</li>
<li>
<p><strong>è¾“å‡ºå±‚</strong>ï¼ˆ$d\times d_{out}$ï¼‰ï¼š
   $$\sigma_{out}^2 = \Theta\left(\frac{1}{d}\min\left(1, \frac{d_{out}}{d}\right)\right)$$
   å½“$d\to\infty$æ—¶ï¼Œ$d_{out}/d\to 0$ï¼Œæ•…$\min(1, d_{out}/d) = d_{out}/d$ï¼Œå¾—ï¼š
   $$\sigma_{out}^2 = \Theta\left(\frac{d_{out}}{d^2}\right) = \Theta\left(\frac{1}{d^2}\right)$$
   ï¼ˆå½“$d_{out} = \Theta(1)$æ—¶ï¼‰
   è¿™ä¸Î¼Pçš„è¾“å‡ºå±‚æ–¹å·®ä¸€è‡´ã€‚</p>
</li>
</ol>
<h3 id="3">3. è°±èŒƒæ•°çš„ä½œç”¨æœºåˆ¶</h3>
<h4 id="31">3.1 è°±èŒƒæ•°ä¸å‰å‘ä¼ æ’­ç¨³å®šæ€§</h4>
<p>è€ƒè™‘$L$å±‚å…¨è¿æ¥ç½‘ç»œï¼Œç¬¬$k$å±‚è¾“å‡ºä¸ºï¼š
$$\boldsymbol{x}_k = \sigma(\boldsymbol{x}_{k-1}\boldsymbol{W}_k)$$
å…¶ä¸­$\sigma$æ˜¯æ¿€æ´»å‡½æ•°ï¼ˆå‡è®¾Lipschitzå¸¸æ•°ä¸º1ï¼‰ã€‚</p>
<p><strong>å®šç†2ï¼ˆå‰å‘ä¼ æ’­ç¨³å®šæ€§ï¼‰</strong>ï¼šè‹¥æ¯å±‚æƒé‡æ»¡è¶³$\Vert\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d</em>}}}\right)$ï¼Œä¸”æ¿€æ´»å‡½æ•°$\sigma$æ»¡è¶³$|\sigma(x)| \leq |x|$ï¼Œåˆ™$\Vert\boldsymbol{x<em RMS="RMS">k\Vert</em> = \Theta(1)$å¯¹æ‰€æœ‰$k$æˆç«‹ã€‚</p>
<p><strong>è¯æ˜ï¼ˆå½’çº³æ³•ï¼‰</strong>ï¼š</p>
<p><strong>åŸºç¡€æ­¥</strong>ï¼šå‡è®¾è¾“å…¥$\Vert\boldsymbol{x}<em RMS="RMS">0\Vert</em> = \Theta(1)$ã€‚</p>
<p><strong>å½’çº³æ­¥</strong>ï¼šå‡è®¾$\Vert\boldsymbol{x}<em RMS="RMS">{k-1}\Vert</em>} = \Theta(1)$ï¼Œéœ€è¯æ˜$\Vert\boldsymbol{x<em RMS="RMS">k\Vert</em> = \Theta(1)$ã€‚</p>
<p>åœ¨æ¿€æ´»å‡½æ•°å‰ï¼š
$$\Vert\boldsymbol{x}_{k-1}\boldsymbol{W}_k\Vert_{RMS} \leq \sqrt{\frac{d_{k-1}}{d_k}}\Vert\boldsymbol{x}_{k-1}\Vert_{RMS}\Vert\boldsymbol{W}_k\Vert_2$$</p>
<p>ä»£å…¥æ¡ä»¶ï¼š
$$\Vert\boldsymbol{x}_{k-1}\boldsymbol{W}_k\Vert_{RMS} \leq \sqrt{\frac{d_{k-1}}{d_k}} \cdot \Theta(1) \cdot \Theta\left(\sqrt{\frac{d_k}{d_{k-1}}}\right) = \Theta(1)$$</p>
<p>ç”±äºæ¿€æ´»å‡½æ•°ä¸å¢åŠ èŒƒæ•°ï¼ˆ$|\sigma(x)| \leq |x|$ï¼‰ï¼Œæœ‰ï¼š
$$\Vert\boldsymbol{x}_k\Vert_{RMS} = \Vert\sigma(\boldsymbol{x}_{k-1}\boldsymbol{W}_k)\Vert_{RMS} \leq \Vert\boldsymbol{x}_{k-1}\boldsymbol{W}_k\Vert_{RMS} = \Theta(1)$$</p>
<p>å¦ä¸€æ–¹é¢ï¼Œä¸ºé¿å…é€€åŒ–ï¼ˆèŒƒæ•°è¶‹äº0ï¼‰ï¼Œéœ€è¦æ¿€æ´»å‡½æ•°åœ¨æŸäº›åŒºåŸŸä¿æŒä¿¡å·ï¼Œè¿™é€šè¿‡é€‚å½“çš„åˆå§‹åŒ–å¸¸æ•°$\sigma$ä¿è¯ã€‚$\square$</p>
<h4 id="32">3.2 è°±èŒƒæ•°ä¸æ¢¯åº¦ä¼ æ’­</h4>
<p>è€ƒè™‘åå‘ä¼ æ’­ï¼Œæ¢¯åº¦é€’æ¨å…³ç³»ä¸ºï¼š
$$\nabla_{\boldsymbol{x}_{k-1}}\mathcal{L} = (\nabla_{\boldsymbol{x}_k}\mathcal{L} \odot \sigma'(\boldsymbol{x}_{k-1}\boldsymbol{W}_k))\boldsymbol{W}_k^{\top}$$
å…¶ä¸­$\odot$è¡¨ç¤ºé€å…ƒç´ ä¹˜æ³•ã€‚</p>
<p><strong>å¼•ç†2ï¼ˆæ¢¯åº¦èŒƒæ•°ç•Œï¼‰</strong>ï¼šè‹¥$\Vert\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d</em>\right)$ï¼Œä¸”æ¿€æ´»å‡½æ•°å¯¼æ•°æœ‰ç•Œ$|\sigma'(x)| \leq C$ï¼Œåˆ™ï¼š
$$\Vert\nabla_{\boldsymbol{x}_{k-1}}\mathcal{L}\Vert_{RMS} \leq C\sqrt{\frac{d_k}{d_{k-1}}}\Vert\nabla_{\boldsymbol{x}_k}\mathcal{L}\Vert_{RMS}\Vert\boldsymbol{W}_k\Vert_2$$}}</p>
<p><strong>è¯æ˜</strong>ï¼šè®°$\boldsymbol{g}<em _boldsymbol_x="\boldsymbol{x">k = \nabla</em><em k-1="k-1">k}\mathcal{L} \odot \sigma'(\boldsymbol{x}</em>_k)$ï¼Œåˆ™ï¼š
$$\Vert\boldsymbol{g}_k\Vert_2 \leq C\Vert\nabla_{\boldsymbol{x}_k}\mathcal{L}\Vert_2$$}\boldsymbol{W</p>
<p>å› æ­¤ï¼š
$$\Vert\nabla_{\boldsymbol{x}_{k-1}}\mathcal{L}\Vert_2 = \Vert\boldsymbol{g}_k\boldsymbol{W}_k^{\top}\Vert_2 \leq \Vert\boldsymbol{g}_k\Vert_2\Vert\boldsymbol{W}_k^{\top}\Vert_2 \leq C\Vert\nabla_{\boldsymbol{x}_k}\mathcal{L}\Vert_2\Vert\boldsymbol{W}_k\Vert_2$$</p>
<p>è½¬æ¢ä¸ºRMSèŒƒæ•°ï¼š
$$\Vert\nabla_{\boldsymbol{x}_{k-1}}\mathcal{L}\Vert_{RMS} \leq C\sqrt{\frac{d_k}{d_{k-1}}}\Vert\nabla_{\boldsymbol{x}_k}\mathcal{L}\Vert_{RMS}\Vert\boldsymbol{W}_k\Vert_2$$
$\square$</p>
<h3 id="4-p">4. é«˜é˜¶Î¼Pçš„å‚æ•°åŒ–æ–¹æ¡ˆ</h3>
<h4 id="41">4.1 è°±å½’ä¸€åŒ–çš„ç²¾ç¡®å®ç°</h4>
<p>å¯¹äºä»»æ„åˆå§‹åŒ–çŸ©é˜µ$\boldsymbol{W}_k'$ï¼Œè°±å½’ä¸€åŒ–å®šä¹‰ä¸ºï¼š
$$\boldsymbol{W}_k = \sigma\sqrt{\frac{d_k}{d_{k-1}}}\frac{\boldsymbol{W}_k'}{\Vert\boldsymbol{W}_k'\Vert_2}$$</p>
<p><strong>è®¡ç®—æ–¹æ³•</strong>ï¼šè°±èŒƒæ•°$\Vert\boldsymbol{W}_k'\Vert_2$å¯é€šè¿‡å¹‚è¿­ä»£æ³•é«˜æ•ˆè®¡ç®—ï¼š</p>
<p><strong>ç®—æ³•1ï¼ˆå¹‚è¿­ä»£ï¼‰</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code>åˆå§‹åŒ–ï¼šéšæœºå‘é‡ v
é‡å¤ï¼š
    u â† W&#39;v / ||W&#39;v||â‚‚
    v â† W&#39;áµ€u / ||W&#39;áµ€u||â‚‚
ç›´åˆ°æ”¶æ•›
è¿”å›ï¼šÏƒ_max = uáµ€W&#39;v
</code></pre></div>

<p>æ—¶é—´å¤æ‚åº¦ä¸º$O(t \cdot d_{k-1}d_k)$ï¼Œå…¶ä¸­$t$æ˜¯è¿­ä»£æ¬¡æ•°ï¼ˆé€šå¸¸$t = 5\sim 10$å³å¯ï¼‰ã€‚</p>
<h4 id="42">4.2 å¥‡å¼‚å€¼è£å‰ªçš„å˜ä½“</h4>
<p><strong>å®šä¹‰2ï¼ˆå¥‡å¼‚å€¼è£å‰ªï¼‰</strong>ï¼šç»™å®šçŸ©é˜µ$\boldsymbol{W}$çš„SVD $\boldsymbol{W} = \boldsymbol{U}\boldsymbol{\Sigma}\boldsymbol{V}^{\top}$ï¼Œå…¶å¥‡å¼‚å€¼è£å‰ªå®šä¹‰ä¸ºï¼š
$$\text{SVC}(\boldsymbol{W}) = \boldsymbol{U}\min(\boldsymbol{\Sigma}, \boldsymbol{I})\boldsymbol{V}^{\top}$$
å…¶ä¸­$\min(\boldsymbol{\Sigma}, \boldsymbol{I})$è¡¨ç¤ºå°†å¤§äº1çš„å¥‡å¼‚å€¼è£å‰ªåˆ°1ã€‚</p>
<p><strong>æ€§è´¨2ï¼ˆè°±èŒƒæ•°ç•Œï¼‰</strong>ï¼š$\Vert\text{SVC}(\boldsymbol{W})\Vert_2 \leq 1$ï¼Œå½“$\Vert\boldsymbol{W}\Vert_2 \geq 1$æ—¶ç­‰å·æˆç«‹ã€‚</p>
<p><strong>çŸ©é˜µç¬¦å·å‡½æ•°çš„æé™</strong>ï¼š
$$\lim_{\lambda\to\infty}\text{SVC}(\lambda\boldsymbol{W}) = \text{msign}(\boldsymbol{W}) = \boldsymbol{U}\boldsymbol{V}^{\top}$$</p>
<p>è¿™æ˜¯å› ä¸ºå½“$\lambda\to\infty$æ—¶ï¼Œæ‰€æœ‰å¥‡å¼‚å€¼$\lambda\sigma_i\to\infty$ï¼Œè£å‰ªåå‡ä¸º1ï¼Œå› æ­¤$\min(\lambda\boldsymbol{\Sigma}, \boldsymbol{I})/\lambda \to \boldsymbol{I}$ã€‚</p>
<p><strong>åº”ç”¨äºæ›´æ–°é‡</strong>ï¼š
$$\Delta\boldsymbol{W}_k = \eta\sqrt{\frac{d_k}{d_{k-1}}}\text{msign}(\boldsymbol{\Phi}_k)$$
å…¶ä¸­$\boldsymbol{\Phi}_k$æ˜¯ä¼˜åŒ–å™¨è¾“å‡ºçš„åŸå§‹æ›´æ–°é‡ã€‚</p>
<h4 id="43">4.3 æ¸è¿›å¼è°±å½’ä¸€åŒ–</h4>
<p>ä¸ºé¿å…çªç„¶çš„èŒƒæ•°å˜åŒ–ï¼Œå¯é‡‡ç”¨æ¸è¿›å¼è°±å½’ä¸€åŒ–ï¼š
$$\boldsymbol{W}_k^{(t+1)} = \alpha\boldsymbol{W}_k^{(t)} + (1-\alpha)\cdot\sigma\sqrt{\frac{d_k}{d_{k-1}}}\frac{\boldsymbol{W}_k^{(t)}}{\Vert\boldsymbol{W}_k^{(t)}\Vert_2}$$
å…¶ä¸­$\alpha\in(0,1)$æ˜¯æ’å€¼ç³»æ•°ï¼ˆå¦‚$\alpha = 0.9$ï¼‰ã€‚</p>
<h3 id="5-lora">5. LoRAä¸­çš„åº”ç”¨ï¼ˆä½ç§©é€‚é…ï¼‰</h3>
<h4 id="51-lora">5.1 LoRAçš„è°±æ¡ä»¶åˆ†æ</h4>
<p>LoRAå°†æƒé‡æ›´æ–°åˆ†è§£ä¸ºä½ç§©å½¢å¼ï¼š
$$\boldsymbol{W} = \boldsymbol{W}_0 + \boldsymbol{B}\boldsymbol{A}$$
å…¶ä¸­$\boldsymbol{W}<em in="in">0\in\mathbb{R}^{d</em>)$ã€‚}\times d_{out}}$æ˜¯å†»ç»“çš„é¢„è®­ç»ƒæƒé‡ï¼Œ$\boldsymbol{B}\in\mathbb{R}^{d_{in}\times r}$ï¼Œ$\boldsymbol{A}\in\mathbb{R}^{r\times d_{out}}$æ˜¯å¯è®­ç»ƒçš„ä½ç§©çŸ©é˜µï¼Œ$r\ll\min(d_{in}, d_{out</p>
<p><strong>å®šç†3ï¼ˆLoRAçš„è°±æ¡ä»¶ï¼‰</strong>ï¼šè‹¥å¸Œæœ›$\Vert\boldsymbol{B}\boldsymbol{A}\Vert_2 = \Theta\left(\sqrt{\frac{d_{out}}{d_{in}}}\right)$ï¼Œåˆ™åº”è®¾ç½®ï¼š
$$\Vert\boldsymbol{B}\Vert_2 = \Theta\left(\left(\frac{d_{out}}{d_{in}}\right)^{1/4}\right), \quad \Vert\boldsymbol{A}\Vert_2 = \Theta\left(\left(\frac{d_{out}}{d_{in}}\right)^{1/4}\right)$$</p>
<p>æˆ–è€…æ›´ç®€å•åœ°ï¼š
$$\Vert\boldsymbol{B}\Vert_2 = \Theta(1), \quad \Vert\boldsymbol{A}\Vert_2 = \Theta\left(\sqrt{\frac{d_{out}}{d_{in}}}\right)$$</p>
<p><strong>è¯æ˜</strong>ï¼šç”±æ¬¡ä¹˜æ€§ï¼š
$$\Vert\boldsymbol{B}\boldsymbol{A}\Vert_2 \leq \Vert\boldsymbol{B}\Vert_2\Vert\boldsymbol{A}\Vert_2$$</p>
<p>å–ç¬¬äºŒç§æ–¹æ¡ˆï¼Œæœ‰ï¼š
$$\Vert\boldsymbol{B}\boldsymbol{A}\Vert_2 \leq \Theta(1) \cdot \Theta\left(\sqrt{\frac{d_{out}}{d_{in}}}\right) = \Theta\left(\sqrt{\frac{d_{out}}{d_{in}}}\right)$$</p>
<p>ç”±äº$\boldsymbol{B}\boldsymbol{A}$æ˜¯ç§©$r$çŸ©é˜µï¼Œå…¶è°±èŒƒæ•°ç­‰äºæœ€å¤§å¥‡å¼‚å€¼ï¼Œå½“$\boldsymbol{B}$å’Œ$\boldsymbol{A}$çš„å¥‡å¼‚å€¼åˆ†å¸ƒåˆç†æ—¶ï¼Œç­‰å·å¯ä»¥è¿‘ä¼¼æˆç«‹ã€‚$\square$</p>
<h4 id="52-lora">5.2 LoRAçš„åˆå§‹åŒ–ç­–ç•¥</h4>
<p>æ ‡å‡†LoRAåˆå§‹åŒ–ï¼š
- $\boldsymbol{A}$ï¼šæœä»$\mathcal{N}(0, \sigma_A^2)$
- $\boldsymbol{B}$ï¼šåˆå§‹åŒ–ä¸ºé›¶çŸ©é˜µ</p>
<p>æŒ‰è°±æ¡ä»¶ï¼Œåº”æ”¹ä¸ºï¼š
$$\sigma_A^2 = \Theta\left(\frac{1}{r}\cdot\frac{d_{out}}{d_{in}}\right)$$
$$\sigma_B^2 = \Theta\left(\frac{1}{d_{in}}\right)$$</p>
<p><strong>åŸå› </strong>ï¼šéšæœºçŸ©é˜µçš„è°±èŒƒæ•°çº¦ä¸º$\sqrt{m} + \sqrt{n}$ï¼ˆ$m\times n$çŸ©é˜µï¼‰ï¼Œå› æ­¤ï¼š
$$\mathbb{E}[\Vert\boldsymbol{A}\Vert_2] \approx \sigma_A(\sqrt{r} + \sqrt{d_{out}}) \approx \sigma_A\sqrt{d_{out}}$$
$$\mathbb{E}[\Vert\boldsymbol{B}\Vert_2] \approx \sigma_B(\sqrt{d_{in}} + \sqrt{r}) \approx \sigma_B\sqrt{d_{in}}$$</p>
<p>è¦ä½¿$\Vert\boldsymbol{A}\Vert_2 = \Theta\left(\sqrt{\frac{d_{out}}{d_{in}}}\right)$å’Œ$\Vert\boldsymbol{B}\Vert_2 = \Theta(1)$ï¼Œéœ€è¦ï¼š
$$\sigma_A\sqrt{d_{out}} = \Theta\left(\sqrt{\frac{d_{out}}{d_{in}}}\right) \Rightarrow \sigma_A = \Theta\left(\frac{1}{\sqrt{d_{in}d_{out}}}\right)$$
$$\sigma_B\sqrt{d_{in}} = \Theta(1) \Rightarrow \sigma_B = \Theta\left(\frac{1}{\sqrt{d_{in}}}\right)$$</p>
<p>è€ƒè™‘åˆ°$\boldsymbol{A}$æ˜¯$r\times d_{out}$çŸ©é˜µï¼Œæ›´ç²¾ç¡®åœ°ï¼š
$$\sigma_A = \Theta\left(\sqrt{\frac{1}{r}\cdot\frac{1}{d_{in}}}\right)$$</p>
<h4 id="53-lora">5.3 LoRAçš„å­¦ä¹ ç‡ç¼©æ”¾</h4>
<p>å¯¹äºLoRAå‚æ•°çš„å­¦ä¹ ç‡ï¼Œåº”ç”¨è°±æ¡ä»¶$\eqref{eq:adam-eta}$ï¼š
$$\eta_A = \Theta\left(\frac{1}{r}\right), \quad \eta_B = \Theta\left(\frac{1}{d_{in}}\right)$$</p>
<p>è¿™ä¸æ ‡å‡†Î¼På¯¹LoRAçš„å»ºè®®ä¸€è‡´ï¼Œä½†æ¨å¯¼æ›´ç®€æ´ã€‚</p>
<h3 id="6">6. æ¢¯åº¦æµçš„è°±åˆ†æ</h3>
<h4 id="61">6.1 æ¢¯åº¦çš„è°±åˆ†è§£</h4>
<p>å¯¹äºæƒé‡çŸ©é˜µ$\boldsymbol{W}<em _boldsymbol_W="\boldsymbol{W">k$ï¼Œå…¶æ¢¯åº¦$\nabla</em>$å¯ä»¥é€šè¿‡SVDåˆ†è§£ä¸ºï¼š
$$\nabla_{\boldsymbol{W}_k}\mathcal{L} = \sum_{i=1}^{\min(d_{k-1}, d_k)} \sigma_i^{(g)}\boldsymbol{u}_i\boldsymbol{v}_i^{\top}$$
å…¶ä¸­${\sigma_i^{(g)}}$æ˜¯æ¢¯åº¦çš„å¥‡å¼‚å€¼ã€‚}_k}\mathcal{L</p>
<p><strong>å¼•ç†3ï¼ˆæ¢¯åº¦çš„ä½ç§©æ€§ï¼‰</strong>ï¼šåœ¨æ·±åº¦å­¦ä¹ ä¸­ï¼Œæ¢¯åº¦çŸ©é˜µé€šå¸¸æ»¡è¶³ï¼š
$$\sum_{i=1}^{r}\sigma_i^{(g)} \geq 0.9 \sum_{i=1}^{\min(d_{k-1},d_k)}\sigma_i^{(g)}$$
å…¶ä¸­$r\ll \min(d_{k-1}, d_k)$æ˜¯æœ‰æ•ˆç§©ã€‚</p>
<p>è¿™ä¸€æ€§è´¨çš„ç»éªŒè¯æ®æ¥æºäºï¼š
1. æ‰¹é‡æ¢¯åº¦æ˜¯ä¸ªä½“æ¢¯åº¦çš„å¹³å‡ï¼Œå¯¼è‡´ä½ç§©ç»“æ„
2. æŸå¤±å‡½æ•°çš„HessiançŸ©é˜µåœ¨ç¥ç»ç½‘ç»œä¸­é€šå¸¸æ˜¯ä½ç§©çš„
3. å®éªŒè§‚å¯Ÿï¼ˆå¦‚LoRAçš„æˆåŠŸï¼‰</p>
<h4 id="62">6.2 æ ¸èŒƒæ•°ä¸è°±èŒƒæ•°çš„å…³ç³»</h4>
<p><strong>å¼•ç†4ï¼ˆä½ç§©å‡è®¾ä¸‹çš„èŒƒæ•°ç­‰ä»·ï¼‰</strong>ï¼šè‹¥æ¢¯åº¦$\nabla_{\boldsymbol{W}_k}\mathcal{L}$çš„æœ‰æ•ˆç§©ä¸º$r = \Theta(1)$ï¼ˆä¸æ¨¡å‹å®½åº¦æ— å…³ï¼‰ï¼Œåˆ™ï¼š
$$\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_* = \sum_{i=1}^{r}\sigma_i^{(g)} + o\left(\sum_{i=1}^{r}\sigma_i^{(g)}\right) = \Theta(r\cdot\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2)$$</p>
<p>ç”±äº$r = \Theta(1)$ï¼Œæœ‰ï¼š
$$\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_* = \Theta(\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2)$$</p>
<h4 id="63">6.3 æ¢¯åº¦èŒƒæ•°çš„ä¼°è®¡</h4>
<p><strong>å®šç†4ï¼ˆæ¢¯åº¦è°±èŒƒæ•°ä¼°è®¡ï¼‰</strong>ï¼šåœ¨è°±æ¡ä»¶$\Vert\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d</em>}}}\right)$å’Œ$\Vert\Delta\boldsymbol{W<em k-1="k-1">k\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d</em>\right)$ä¸‹ï¼Œæ¢¯åº¦æ»¡è¶³ï¼š
$$\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2 = \Theta\left(\sqrt{\frac{d_{k-1}}{d_k}}\right)$$}}</p>
<p><strong>è¯æ˜</strong>ï¼šç”±ä¸€é˜¶Taylorå±•å¼€ï¼š
$$\Delta\mathcal{L} \approx \sum_k \langle\Delta\boldsymbol{W}_k, \nabla_{\boldsymbol{W}_k}\mathcal{L}\rangle_F$$</p>
<p>åˆ©ç”¨çŸ©é˜µèŒƒæ•°çš„å¯¹å¶ä¸ç­‰å¼ï¼ˆHolderä¸ç­‰å¼ï¼‰ï¼š
$$|\langle\boldsymbol{A}, \boldsymbol{B}\rangle_F| \leq \Vert\boldsymbol{A}\Vert_2\Vert\boldsymbol{B}\Vert_*$$</p>
<p>å› æ­¤ï¼š
$$|\Delta\mathcal{L}| \lesssim \sum_k \Vert\Delta\boldsymbol{W}_k\Vert_2\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_*$$</p>
<p>ç”±å¼•ç†4ï¼Œåœ¨ä½ç§©å‡è®¾ä¸‹ï¼š
$$|\Delta\mathcal{L}| \sim \sum_k \Theta(\Vert\Delta\boldsymbol{W}_k\Vert_2\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2)$$</p>
<p>åˆå·²çŸ¥$\Delta\mathcal{L} = \Theta(1)$å’Œ$\Vert\Delta\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d</em>\right)$ï¼Œä»£å…¥å¾—ï¼š
$$\Theta(1) \sim \sum_k \Theta\left(\sqrt{\frac{d_k}{d_{k-1}}}\right)\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2$$}}</p>
<p>å‡è®¾å„å±‚è´¡çŒ®ç›¸å½“ï¼ˆæˆ–ä¸»å¯¼é¡¹ç›¸åŒï¼‰ï¼Œå•å±‚æœ‰ï¼š
$$\Theta(1) \sim \Theta\left(\sqrt{\frac{d_k}{d_{k-1}}}\right)\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2$$</p>
<p>å› æ­¤ï¼š
$$\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2 = \Theta\left(\sqrt{\frac{d_{k-1}}{d_k}}\right)$$
$\square$</p>
<h3 id="7">7. æƒé‡çŸ©é˜µçš„è°±åˆ†å¸ƒæ¼”åŒ–</h3>
<h4 id="71">7.1 è°±åˆ†å¸ƒçš„åŠ¨åŠ›å­¦æ–¹ç¨‹</h4>
<p>è€ƒè™‘è¿ç»­æ—¶é—´æ¢¯åº¦æµï¼š
$$\frac{d\boldsymbol{W}_k}{dt} = -\eta_k\nabla_{\boldsymbol{W}_k}\mathcal{L}(t)$$</p>
<p>å¯¹è°±èŒƒæ•°æ±‚å¯¼ï¼ˆä½¿ç”¨é“¾å¼æ³•åˆ™ï¼‰ï¼š
$$\frac{d}{dt}\Vert\boldsymbol{W}_k\Vert_2 = \frac{d}{dt}\sigma_{\max}(\boldsymbol{W}_k)$$</p>
<p>è®¾$\boldsymbol{W}_k = \boldsymbol{U}_k\boldsymbol{\Sigma}_k\boldsymbol{V}_k^{\top}$ï¼Œæœ€å¤§å¥‡å¼‚å€¼å¯¹åº”çš„å·¦å³å¥‡å¼‚å‘é‡ä¸º$\boldsymbol{u}_1^{(k)}$å’Œ$\boldsymbol{v}_1^{(k)}$ï¼Œåˆ™ï¼š
$$\frac{d\sigma_{\max}}{dt} = \boldsymbol{u}_1^{(k)\top}\frac{d\boldsymbol{W}_k}{dt}\boldsymbol{v}_1^{(k)} = -\eta_k\boldsymbol{u}_1^{(k)\top}\nabla_{\boldsymbol{W}_k}\mathcal{L}\boldsymbol{v}_1^{(k)}$$</p>
<p><strong>å®šä¹‰3ï¼ˆè°±å¯¹é½åº¦ï¼‰</strong>ï¼š
$$\rho_k(t) = \frac{\boldsymbol{u}_1^{(k)\top}\nabla_{\boldsymbol{W}_k}\mathcal{L}\boldsymbol{v}_1^{(k)}}{\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2}$$</p>
<p>åˆ™è°±èŒƒæ•°çš„æ¼”åŒ–æ–¹ç¨‹ä¸ºï¼š
$$\frac{d\sigma_{\max}}{dt} = -\eta_k\rho_k(t)\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2$$</p>
<h4 id="72">7.2 è°±å½’ä¸€åŒ–ä¸‹çš„ä¸å˜æ€§</h4>
<p><strong>å®šç†5ï¼ˆè°±å½’ä¸€åŒ–çš„è°±åˆ†å¸ƒä¸å˜æ€§ï¼‰</strong>ï¼šè‹¥æ¯æ­¥æ›´æ–°é‡‡ç”¨è°±å½’ä¸€åŒ–ï¼š
$$\boldsymbol{W}_k^{(t+1)} = \sigma_k\sqrt{\frac{d_k}{d_{k-1}}}\frac{\boldsymbol{W}_k^{(t)} - \eta_k\nabla_{\boldsymbol{W}_k}\mathcal{L}^{(t)}}{\Vert\boldsymbol{W}_k^{(t)} - \eta_k\nabla_{\boldsymbol{W}_k}\mathcal{L}^{(t)}\Vert_2}$$</p>
<p>åˆ™$\Vert\boldsymbol{W}<em k-1="k-1">k^{(t)}\Vert_2 = \sigma_k\sqrt{\frac{d_k}{d</em>$å¯¹æ‰€æœ‰$t$æ’æˆç«‹ã€‚}}</p>
<p><strong>è¯æ˜</strong>ï¼šç›´æ¥ç”±å®šä¹‰ï¼Œè°±å½’ä¸€åŒ–ä¿è¯åˆ†å­çš„è°±èŒƒæ•°æ’ä¸º$\sigma_k\sqrt{\frac{d_k}{d_{k-1}}}$ã€‚$\square$</p>
<h4 id="73">7.3 å¥‡å¼‚å€¼çš„é•¿å°¾åˆ†å¸ƒ</h4>
<p>å®éªŒè§‚å¯Ÿè¡¨æ˜ï¼Œè®­ç»ƒåçš„æƒé‡çŸ©é˜µ$\boldsymbol{W}_k$çš„å¥‡å¼‚å€¼åˆ†å¸ƒé€šå¸¸å‘ˆç°å¹‚å¾‹è¡°å‡ï¼š
$$\sigma_i \propto i^{-\alpha}, \quad \alpha \in [1, 2]$$</p>
<p>åœ¨è°±å½’ä¸€åŒ–çº¦æŸä¸‹ï¼Œè¿™è½¬åŒ–ä¸ºï¼š
$$\sigma_i = \sigma_{\max}\cdot i^{-\alpha} = \sigma_k\sqrt{\frac{d_k}{d_{k-1}}}\cdot i^{-\alpha}$$</p>
<p><strong>FrobeniusèŒƒæ•°ä¸è°±èŒƒæ•°çš„å…³ç³»</strong>ï¼š
$$\Vert\boldsymbol{W}_k\Vert_F^2 = \sum_{i=1}^{\min(d_{k-1},d_k)}\sigma_i^2 \approx \sigma_{\max}^2\sum_{i=1}^{r_{eff}}i^{-2\alpha}$$</p>
<p>å…¶ä¸­$r_{eff}$æ˜¯æœ‰æ•ˆç§©ã€‚å¯¹äº$\alpha &gt; 1/2$ï¼Œçº§æ•°æ”¶æ•›ï¼Œå¾—ï¼š
$$\Vert\boldsymbol{W}_k\Vert_F = \Theta(\Vert\boldsymbol{W}_k\Vert_2) = \Theta\left(\sqrt{\frac{d_k}{d_{k-1}}}\right)$$</p>
<h3 id="8">8. å­¦ä¹ ç‡çš„è‡ªé€‚åº”è°ƒæ•´</h3>
<h4 id="81">8.1 åŸºäºè°±èŒƒæ•°çš„è‡ªé€‚åº”å­¦ä¹ ç‡</h4>
<p><strong>ç®—æ³•2ï¼ˆè°±è‡ªé€‚åº”å­¦ä¹ ç‡ï¼‰</strong>ï¼š</p>
<div class="codehilite"><pre><span></span><code>è¾“å…¥ï¼šåŸºç¡€å­¦ä¹ ç‡ Î·â‚€ï¼Œæƒé‡ W_kï¼Œæ¢¯åº¦ âˆ‡_W_k L
è®¡ç®—ï¼š
    â€–âˆ‡_W_k Lâ€–â‚‚ = Ïƒ_max(âˆ‡_W_k L)
    ç›®æ ‡è°±èŒƒæ•°ï¼šÏ„_k = Ïƒ_kâˆš(d_k/d_{k-1})
    è‡ªé€‚åº”å­¦ä¹ ç‡ï¼šÎ·_k = Î·â‚€ Â· Ï„_k / â€–âˆ‡_W_k Lâ€–â‚‚
æ›´æ–°ï¼š
    W_k â† W_k - Î·_k Â· âˆ‡_W_k L / â€–âˆ‡_W_k Lâ€–â‚‚
</code></pre></div>

<p><strong>æ€§è´¨3</strong>ï¼šæ­¤ç®—æ³•ä¿è¯$\Vert\Delta\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \eta_0\tau_k = \eta_0\sigma_k\sqrt{\frac{d_k}{d</em>$ï¼Œè‡ªåŠ¨æ»¡è¶³è°±æ¡ä»¶ã€‚}}</p>
<h4 id="82">8.2 å±‚çº§å­¦ä¹ ç‡çš„ç†è®ºä¾æ®</h4>
<p>å¯¹äºSGDï¼Œç”±$\eqref{eq:sgd-eta}$å’Œ$\eqref{eq:grad-norm}$ï¼š
$$\eta_k\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2 = \Theta\left(\frac{d_k}{d_{k-1}}\right) \cdot \Theta\left(\sqrt{\frac{d_{k-1}}{d_k}}\right) = \Theta\left(\sqrt{\frac{d_k}{d_{k-1}}}\right)$$</p>
<p>è¿™æ„å‘³ç€æœ‰æ•ˆæ›´æ–°æ­¥é•¿$\eta_k\Vert\nabla_{\boldsymbol{W}_k}\mathcal{L}\Vert_2$ä¸å±‚çš„å½¢çŠ¶æœ‰å…³ã€‚</p>
<p><strong>æ¨è®º1ï¼ˆå±‚çº§å­¦ä¹ ç‡å¿…è¦æ€§ï¼‰</strong>ï¼šä¸ºå®ç°è°±æ¡ä»¶ï¼Œä¸åŒå½¢çŠ¶çš„å±‚éœ€è¦ä¸åŒçš„å­¦ä¹ ç‡ç¼©æ”¾ã€‚</p>
<h4 id="83-adam">8.3 Adamä¸­çš„è‡ªé€‚åº”æœºåˆ¶</h4>
<p>Adamçš„æ›´æ–°è§„åˆ™ï¼ˆç®€åŒ–ç‰ˆï¼‰ï¼š
$$\boldsymbol{m}_k^{(t)} = \beta_1\boldsymbol{m}_k^{(t-1)} + (1-\beta_1)\nabla_{\boldsymbol{W}_k}\mathcal{L}^{(t)}$$
$$\boldsymbol{v}_k^{(t)} = \beta_2\boldsymbol{v}_k^{(t-1)} + (1-\beta_2)(\nabla_{\boldsymbol{W}_k}\mathcal{L}^{(t)})^2$$
$$\Delta\boldsymbol{W}_k^{(t)} = -\eta_k\frac{\boldsymbol{m}_k^{(t)}}{\sqrt{\boldsymbol{v}_k^{(t)}} + \epsilon}$$</p>
<p><strong>å®šç†6ï¼ˆAdamçš„è°±æ¡ä»¶å­¦ä¹ ç‡ï¼‰</strong>ï¼šè‹¥ç”¨SignSGDè¿‘ä¼¼Adamï¼Œå³$\Delta\boldsymbol{W}<em _boldsymbol_W="\boldsymbol{W">k \approx -\eta_k\text{sign}(\nabla</em>)$ï¼Œåˆ™ä¸ºæ»¡è¶³è°±æ¡ä»¶ï¼Œéœ€è¦ï¼š
$$\eta_k = \Theta\left(\frac{1}{d_{k-1}}\right)$$}_k}\mathcal{L</p>
<p><strong>è¯æ˜</strong>ï¼š$\text{sign}(\nabla_{\boldsymbol{W}_k}\mathcal{L})$çš„æ¯ä¸ªå…ƒç´ ä¸º$\pm 1$ï¼Œæ•…ï¼š
$$\Vert\text{sign}(\nabla_{\boldsymbol{W}_k}\mathcal{L})\Vert_F = \sqrt{d_{k-1}d_k}$$</p>
<p>åœ¨ä½ç§©å‡è®¾ä¸‹ï¼ˆæ¢¯åº¦ä¸»è¦é›†ä¸­åœ¨å‰$r$ä¸ªå¥‡å¼‚å€¼æ–¹å‘ï¼‰ï¼Œæœ‰ï¼š
$$\Vert\text{sign}(\nabla_{\boldsymbol{W}_k}\mathcal{L})\Vert_2 \approx \frac{\Vert\text{sign}(\nabla_{\boldsymbol{W}_k}\mathcal{L})\Vert_F}{\sqrt{r}} = \frac{\sqrt{d_{k-1}d_k}}{\sqrt{r}} = \Theta(\sqrt{d_{k-1}d_k})$$</p>
<p>è¦ä½¿$\Vert\Delta\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d</em>\right)$ï¼Œéœ€è¦ï¼š
$$\eta_k\Theta(\sqrt{d_{k-1}d_k}) = \Theta\left(\sqrt{\frac{d_k}{d_{k-1}}}\right)$$}}</p>
<p>è§£å¾—ï¼š
$$\eta_k = \Theta\left(\frac{1}{d_{k-1}}\right)$$
$\square$</p>
<h3 id="9">9. æ”¶æ•›é€Ÿåº¦çš„ç†è®ºç•Œ</h3>
<h4 id="91">9.1 å‡¸ä¼˜åŒ–çš„æ”¶æ•›ç•Œ</h4>
<p>å¯¹äºå‡¸æŸå¤±å‡½æ•°$\mathcal{L}$ï¼ˆè™½ç„¶ç¥ç»ç½‘ç»œéå‡¸ï¼Œä½†å±€éƒ¨å¯èƒ½è¿‘ä¼¼å‡¸ï¼‰ï¼Œè°±æ¡ä»¶æä¾›äº†æ”¶æ•›é€Ÿåº¦çš„ç†è®ºä¿è¯ã€‚</p>
<p><strong>å®šç†7ï¼ˆå¼ºå‡¸æƒ…å†µçš„æ”¶æ•›é€Ÿåº¦ï¼‰</strong>ï¼šå‡è®¾æŸå¤±å‡½æ•°$\mathcal{L}$æ˜¯$\mu$-å¼ºå‡¸ä¸”$L$-å…‰æ»‘çš„ï¼Œå³ï¼š
$$\mu\Vert\boldsymbol{W} - \boldsymbol{W}^*\Vert_F^2 \leq \mathcal{L}(\boldsymbol{W}) - \mathcal{L}(\boldsymbol{W}^*) \leq \frac{L}{2}\Vert\boldsymbol{W} - \boldsymbol{W}^*\Vert_F^2$$</p>
<p>åœ¨è°±æ¡ä»¶ä¸‹ï¼Œæ¢¯åº¦ä¸‹é™çš„æ”¶æ•›é€Ÿåº¦ä¸ºï¼š
$$\mathcal{L}(\boldsymbol{W}^{(t)}) - \mathcal{L}(\boldsymbol{W}^*) \leq \left(1 - \frac{\mu}{L}\right)^t(\mathcal{L}(\boldsymbol{W}^{(0)}) - \mathcal{L}(\boldsymbol{W}^*))$$</p>
<p><strong>è¯æ˜</strong>ï¼šè¿™æ˜¯æ ‡å‡†çš„æ¢¯åº¦ä¸‹é™æ”¶æ•›ç»“æœã€‚è°±æ¡ä»¶çš„ä½œç”¨åœ¨äºä¿è¯äº†$L$å’Œ$\mu$åœ¨æ¨¡å‹å°ºåº¦å˜åŒ–æ—¶ä¿æŒç¨³å®šï¼ˆä¸$d$æ— å…³ï¼‰ï¼Œä»è€Œæ”¶æ•›é€Ÿåº¦ä¸ä¼šéšæ¨¡å‹å˜å¤§è€Œé€€åŒ–ã€‚$\square$</p>
<h4 id="92">9.2 éå‡¸æƒ…å†µçš„ä¸€é˜¶ç¨³å®šç‚¹</h4>
<p>å¯¹äºéå‡¸ä¼˜åŒ–ï¼Œæˆ‘ä»¬å…³æ³¨æ‰¾åˆ°ä¸€é˜¶ç¨³å®šç‚¹ï¼ˆ$\Vert\nabla\mathcal{L}\Vert \leq \epsilon$ï¼‰çš„å¤æ‚åº¦ã€‚</p>
<p><strong>å®šç†8ï¼ˆè°±æ¡ä»¶ä¸‹çš„æ¢¯åº¦ç•Œï¼‰</strong>ï¼šåœ¨è°±æ¡ä»¶ä¸‹ï¼Œå¯¹äº$L$-å…‰æ»‘çš„æŸå¤±å‡½æ•°ï¼Œæ¢¯åº¦ä¸‹é™åœ¨$T$æ­¥å†…æ‰¾åˆ°$\epsilon$-ä¸€é˜¶ç¨³å®šç‚¹ï¼Œå…¶ä¸­ï¼š
$$T = O\left(\frac{L(\mathcal{L}(\boldsymbol{W}^{(0)}) - \mathcal{L}^*)}{\epsilon^2}\right)$$</p>
<p>å…³é”®æ˜¯$L$ä¸æ¨¡å‹å®½åº¦$d$æ— å…³ã€‚</p>
<p><strong>è¯æ˜æ¡†æ¶</strong>ï¼šç”±$L$-å…‰æ»‘æ€§ï¼š
$$\mathcal{L}(\boldsymbol{W}^{(t+1)}) \leq \mathcal{L}(\boldsymbol{W}^{(t)}) - \frac{\eta}{2}\Vert\nabla\mathcal{L}^{(t)}\Vert_F^2 + \frac{L\eta^2}{2}\Vert\nabla\mathcal{L}^{(t)}\Vert_F^2$$</p>
<p>é€‰æ‹©$\eta = 1/L$ï¼Œå¾—ï¼š
$$\mathcal{L}(\boldsymbol{W}^{(t+1)}) \leq \mathcal{L}(\boldsymbol{W}^{(t)}) - \frac{1}{2L}\Vert\nabla\mathcal{L}^{(t)}\Vert_F^2$$</p>
<p>ç´¯åŠ å¹¶åº”ç”¨è°±æ¡ä»¶ï¼ˆæ¢¯åº¦èŒƒæ•°ä¸$d$çš„å…³ç³»å·²å›ºå®šï¼‰å¯å¾—å¤æ‚åº¦ç•Œã€‚$\square$</p>
<h4 id="93">9.3 è°±æ¡ä»¶å¯¹æ”¶æ•›é€Ÿåº¦çš„å½±å“</h4>
<p><strong>å‘½é¢˜1ï¼ˆæ— è°±æ¡ä»¶çš„é€€åŒ–ï¼‰</strong>ï¼šè‹¥ä¸é‡‡ç”¨è°±æ¡ä»¶ï¼Œæ ‡å‡†åˆå§‹åŒ–ï¼ˆå¦‚Xavierï¼‰ä¸‹ï¼Œéšç€$d\to\infty$ï¼š
- å‰å‘æ¿€æ´»å€¼ï¼š$\Vert\boldsymbol{x}<em _boldsymbol_W="\boldsymbol{W">k\Vert_2 = \Theta(\sqrt{d_k})$ï¼ˆè€Œé$\Theta(1)$ï¼‰
- æ¢¯åº¦èŒƒæ•°ï¼š$\Vert\nabla</em><em k-1="k-1">k}\mathcal{L}\Vert_F = \Theta(\sqrt{d</em>)$ï¼‰
- æœ‰æ•ˆå­¦ä¹ ç‡ï¼šéœ€è¦$\eta = O(1/d)$æ‰èƒ½ç¨³å®šï¼Œå¯¼è‡´æ”¶æ•›å˜æ…¢}d_k})$ï¼ˆè€Œé$\Theta(\sqrt{d_{k-1}/d_k}\cdot\sqrt{d_{k-1}d_k}) = \Theta(d_{k-1</p>
<p>è°±æ¡ä»¶é€šè¿‡å½’ä¸€åŒ–æ¶ˆé™¤äº†è¿™ç§å®½åº¦ä¾èµ–æ€§ã€‚</p>
<h3 id="10">10. å®éªŒç»“æœçš„ç†è®ºè§£é‡Š</h3>
<h4 id="101">10.1 è·¨æ¨¡å‹å°ºåº¦çš„è¶…å‚æ•°è¿ç§»</h4>
<p><strong>å®éªŒè§‚å¯Ÿ</strong>ï¼šåœ¨å°æ¨¡å‹ï¼ˆå¦‚d=256ï¼‰ä¸Šè°ƒä¼˜çš„å­¦ä¹ ç‡ï¼Œåº”ç”¨è°±æ¡ä»¶åå¯ç›´æ¥è¿ç§»åˆ°å¤§æ¨¡å‹ï¼ˆå¦‚d=4096ï¼‰è€Œæ— éœ€é‡æ–°è°ƒä¼˜ã€‚</p>
<p><strong>ç†è®ºè§£é‡Š</strong>ï¼šç”±å­¦ä¹ ç‡å…¬å¼$\eqref{eq:sgd-eta}$å’Œ$\eqref{eq:adam-eta}$ï¼Œè™½ç„¶æ¯å±‚çš„å­¦ä¹ ç‡$\eta_k$ä¸$d_k, d_{k-1}$æœ‰å…³ï¼Œä½†åŸºç¡€å­¦ä¹ ç‡$\eta_0$ï¼ˆå³å…¬å¼ä¸­çš„$\Theta$ç¬¦å·éšå«çš„å¸¸æ•°ï¼‰æ˜¯ä¸æ¨¡å‹å®½åº¦æ— å…³çš„ã€‚è°±æ¡ä»¶è‡ªåŠ¨è°ƒæ•´äº†æ¯å±‚çš„ç›¸å¯¹å­¦ä¹ ç‡ï¼Œä½¿å¾—å…¨å±€æœ€ä¼˜çš„$\eta_0$ä¿æŒä¸å˜ã€‚</p>
<h4 id="102">10.2 è®­ç»ƒç¨³å®šæ€§çš„æå‡</h4>
<p><strong>å®éªŒè§‚å¯Ÿ</strong>ï¼šä½¿ç”¨è°±å½’ä¸€åŒ–æˆ–msignåï¼Œè®­ç»ƒè¿‡ç¨‹ä¸­çš„æŸå¤±æ›²çº¿æ›´å¹³æ»‘ï¼Œæ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±ç°è±¡æ˜¾è‘—å‡å°‘ã€‚</p>
<p><strong>ç†è®ºè§£é‡Š</strong>ï¼š
1. <strong>æ¢¯åº¦èŒƒæ•°ç¨³å®š</strong>ï¼šç”±å®šç†4ï¼Œ$\Vert\nabla_{\boldsymbol{W}<em k-1="k-1">k}\mathcal{L}\Vert_2 = \Theta\left(\sqrt{\frac{d</em>\right)$ä¿è¯äº†æ¢¯åº¦ä¸ä¼šéšå±‚æ•°æˆ–å®½åº¦æŒ‡æ•°çº§å¢é•¿/è¡°å‡ã€‚
2. }}{d_k}<strong>æ¿€æ´»å€¼ç¨³å®š</strong>ï¼šç”±å®šç†2ï¼Œ$\Vert\boldsymbol{x}<em RMS="RMS">k\Vert</em> = \Theta(1)$é˜²æ­¢äº†å‰å‘ä¼ æ’­ä¸­çš„æ•°å€¼æº¢å‡ºã€‚
3. <strong>æ›´æ–°é‡å¯æ§</strong>ï¼š$\Vert\Delta\boldsymbol{W}<em k-1="k-1">k\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d</em>\right)$ç¡®ä¿æ¯æ­¥æ›´æ–°çš„å¹…åº¦é€‚ä¸­ã€‚}}</p>
<h4 id="103-lora">10.3 LoRAå¾®è°ƒçš„æ•ˆç‡</h4>
<p><strong>å®éªŒè§‚å¯Ÿ</strong>ï¼šæŒ‰è°±æ¡ä»¶è®¾ç½®LoRAçš„åˆå§‹åŒ–å’Œå­¦ä¹ ç‡åï¼Œå¾®è°ƒæ•ˆç‡æ˜¾è‘—æå‡ï¼Œæ‰€éœ€æ­¥æ•°å‡å°‘ã€‚</p>
<p><strong>ç†è®ºè§£é‡Š</strong>ï¼š
1. <strong>ç§©çš„åˆç†åˆ©ç”¨</strong>ï¼šè°±æ¡ä»¶ç¡®ä¿ä½ç§©æ›´æ–°$\boldsymbol{B}\boldsymbol{A}$çš„è°±èŒƒæ•°è¾¾åˆ°å…¨ç§©æ›´æ–°çš„ç›¸åŒé‡çº§ï¼Œå……åˆ†åˆ©ç”¨äº†å‚æ•°ç©ºé—´ã€‚
2. <strong>å­¦ä¹ ç‡åŒ¹é…</strong>ï¼š$\eta_A = \Theta(1/r)$å’Œ$\eta_B = \Theta(1/d_{in})$ä½¿å¾—ä¸¤ä¸ªçŸ©é˜µçš„æ›´æ–°é€Ÿåº¦åè°ƒï¼Œé¿å…ä¸€æ–¹è¿‡å¿«è€Œå¦ä¸€æ–¹è¿‡æ…¢ã€‚
3. <strong>è°±å¯¹é½</strong>ï¼šä½ç§©ç»“æ„å¤©ç„¶å¥‘åˆæ¢¯åº¦çš„ä½ç§©æ€§ï¼ˆå¼•ç†3ï¼‰ï¼Œå‡å°‘äº†è¡¨ç¤ºè¯¯å·®ã€‚</p>
<h4 id="104-mudamwadammsign">10.4 Mudamwï¼ˆAdam+msignï¼‰çš„æ€§èƒ½</h4>
<p><strong>å®éªŒè§‚å¯Ÿ</strong>ï¼šå¯¹Adamçš„æ›´æ–°é‡åº”ç”¨msignï¼ˆå³$\Delta\boldsymbol{W}<em k-1="k-1">k = \eta\sqrt{d_k/d</em>_k)$ï¼‰ï¼Œæ€§èƒ½ä¼˜äºæ ‡å‡†Muonã€‚}}\cdot\text{msign}(\boldsymbol{\Phi</p>
<p><strong>ç†è®ºè§£é‡Š</strong>ï¼š
1. <strong>è°±å½’ä¸€åŒ–çš„æé™å½¢å¼</strong>ï¼šmsignæ˜¯å¥‡å¼‚å€¼è£å‰ª$\lambda\to\infty$çš„æé™ï¼Œæä¾›äº†æœ€å¼ºçš„è°±èŒƒæ•°çº¦æŸã€‚
2. <strong>ç»§æ‰¿Adamçš„åŠ¨é‡</strong>ï¼š$\boldsymbol{\Phi}_k$åŒ…å«äº†Adamçš„ä¸€é˜¶å’ŒäºŒé˜¶åŠ¨é‡ä¿¡æ¯ï¼Œmsignä¿ç•™äº†æ–¹å‘ä½†è§„èŒƒäº†å¹…åº¦ã€‚
3. <strong>å‡å°‘è¶…å‚æ•°æ•æ„Ÿæ€§</strong>ï¼šmsignæ¶ˆé™¤äº†å­¦ä¹ ç‡å¯¹æ›´æ–°å¹…åº¦çš„ç›´æ¥å½±å“ï¼Œä½¿å¾—è¶…å‚æ•°è°ƒä¼˜æ›´é²æ£’ã€‚</p>
<p>æ•°å­¦ä¸Šï¼ŒAdamçš„æ›´æ–°é‡$\boldsymbol{\Phi}_k = \boldsymbol{m}_k/(\sqrt{\boldsymbol{v}_k} + \epsilon)$å·²ç»åŒ…å«äº†è‡ªé€‚åº”çš„é€å…ƒç´ ç¼©æ”¾ï¼Œå†åº”ç”¨msignç›¸å½“äºï¼š
$$\Delta\boldsymbol{W}_k = \eta\sqrt{\frac{d_k}{d_{k-1}}}\cdot\boldsymbol{U}_k\boldsymbol{V}_k^{\top}$$
å…¶ä¸­$\boldsymbol{U}_k, \boldsymbol{V}_k$æ˜¯$\boldsymbol{\Phi}_k$çš„å·¦å³å¥‡å¼‚å‘é‡ï¼Œè¿™ä¿ç•™äº†Adamæ•è·çš„ä¸»è¦æ¢¯åº¦æ–¹å‘ï¼ŒåŒæ—¶å¼ºåˆ¶äº†ç»Ÿä¸€çš„è°±èŒƒæ•°ã€‚</p>
<h4 id="105">10.5 åˆå§‹åŒ–æ–¹æ¡ˆçš„å¯¹æ¯”</h4>
<p><strong>å®éªŒè§‚å¯Ÿ</strong>ï¼šä½¿ç”¨å…¬å¼$\eqref{eq:spec-std}$åˆå§‹åŒ–çš„æ¨¡å‹ï¼Œåœ¨è®­ç»ƒåˆæœŸçš„æŸå¤±ä¸‹é™é€Ÿåº¦æ¯”Xavieræˆ–Heåˆå§‹åŒ–æ›´å¿«ã€‚</p>
<p><strong>ç†è®ºè§£é‡Š</strong>ï¼š
1. <strong>å‰å‘ä¼ æ’­ä»é›¶æ­¥å°±ç¨³å®š</strong>ï¼šXavier/Heåˆå§‹åŒ–åªä¿è¯æ–¹å·®ç¨³å®šï¼ˆ$\mathbb{E}[\Vert\boldsymbol{x}_k\Vert^2] = \Theta(d_k)$ï¼‰ï¼Œä½†æœ€åæƒ…å†µä¸‹å¯èƒ½åç¦»ï¼›è°±æ¡ä»¶åˆå§‹åŒ–é€šè¿‡è°±èŒƒæ•°æä¾›äº†ç¡®å®šæ€§ä¿è¯ã€‚
2. <strong>åå‘ä¼ æ’­å³æ—¶å¯ç”¨</strong>ï¼šä»ç¬¬ä¸€æ­¥å¼€å§‹ï¼Œæ¢¯åº¦èŒƒæ•°å°±å¤„äºåˆç†åŒºé—´ï¼Œé¿å…äº†"çƒ­èº«æœŸ"ã€‚
3. <strong>ä¸ä¼˜åŒ–å™¨è§£è€¦</strong>ï¼šè°±æ¡ä»¶åˆå§‹åŒ–é€‚ç”¨äºä»»ä½•ä¼˜åŒ–å™¨ï¼Œè€ŒXavier/Heåˆå§‹åŒ–æŸç§ç¨‹åº¦ä¸Šå‡è®¾äº†SGDå¼çš„æ›´æ–°ã€‚</p>
<p>å¯¹æ¯”ï¼š
$$\begin{aligned}
\text{Xavier:} &\quad \sigma^2 = \frac{2}{d_{in} + d_{out}} \\
\text{He:} &\quad \sigma^2 = \frac{2}{d_{in}} \\
\text{è°±æ¡ä»¶:} &\quad \sigma^2 = \Theta\left(\frac{1}{d_{in}}\min\left(1, \frac{d_{out}}{d_{in}}\right)\right)
\end{aligned}$$</p>
<p>å½“$d_{out} \gg d_{in}$æ—¶ï¼ŒXavierç»™å‡º$\sigma^2 \approx 2/d_{out}$ï¼Œå¯èƒ½è¿‡å°ï¼›Heç»™å‡º$\sigma^2 = 2/d_{in}$ï¼Œåˆç†ï¼›è°±æ¡ä»¶ç»™å‡º$\sigma^2 = \Theta(1/d_{in})$ï¼Œä¸Heä¸€è‡´ã€‚</p>
<p>å½“$d_{out} \ll d_{in}$æ—¶ï¼ˆå¦‚è¾“å‡ºå±‚ï¼‰ï¼ŒXavierç»™å‡º$\sigma^2 \approx 2/d_{in}$ï¼›Heä»æ˜¯$2/d_{in}$ï¼›è°±æ¡ä»¶ç»™å‡º$\sigma^2 = \Theta(d_{out}/d_{in}^2)$ï¼Œè‡ªåŠ¨å˜å°ä»¥é€‚åº”é™ç»´ã€‚</p>
<h3 id="11_1">11. é«˜çº§è¯é¢˜ï¼šè°±æ¡ä»¶çš„æ‰©å±•</h3>
<h4 id="111-transformer">11.1 Transformerä¸­çš„åº”ç”¨</h4>
<p>Transformerçš„æ³¨æ„åŠ›æœºåˆ¶ï¼š
$$\text{Attention}(\boldsymbol{Q}, \boldsymbol{K}, \boldsymbol{V}) = \text{softmax}\left(\frac{\boldsymbol{Q}\boldsymbol{K}^{\top}}{\sqrt{d_k}}\right)\boldsymbol{V}$$</p>
<p>å…¶ä¸­$\boldsymbol{Q} = \boldsymbol{X}\boldsymbol{W}_Q$ï¼Œ$\boldsymbol{K} = \boldsymbol{X}\boldsymbol{W}_K$ï¼Œ$\boldsymbol{V} = \boldsymbol{X}\boldsymbol{W}_V$ã€‚</p>
<p><strong>è°±æ¡ä»¶å»ºè®®</strong>ï¼š
$$\Vert\boldsymbol{W}_Q\Vert_2, \Vert\boldsymbol{W}_K\Vert_2, \Vert\boldsymbol{W}_V\Vert_2 = \Theta\left(\sqrt{\frac{d_k}{d_{\text{model}}}}\right)$$</p>
<p>æ³¨æ„åˆ°æ ‡å‡†Transformerä½¿ç”¨ç¼©æ”¾å› å­$1/\sqrt{d_k}$ï¼Œè¿™ä¸è°±æ¡ä»¶ä¸€è‡´ï¼šè‹¥$\Vert\boldsymbol{Q}\Vert_{RMS}, \Vert\boldsymbol{K}\Vert_{RMS} = \Theta(1)$ï¼Œåˆ™ï¼š
$$\Vert\boldsymbol{Q}\boldsymbol{K}^{\top}\Vert_F = \Theta(\sqrt{d_k})$$</p>
<p>é™¤ä»¥$\sqrt{d_k}$åï¼Œä½¿å¾—softmaxè¾“å…¥çš„å°ºåº¦ç¨³å®šã€‚</p>
<h4 id="112">11.2 æ®‹å·®è¿æ¥çš„å¤„ç†</h4>
<p>å¯¹äºæ®‹å·®è¿æ¥$\boldsymbol{x}<em k-1="k-1">k = \boldsymbol{x}</em>)$ï¼š} + f(\boldsymbol{x}_{k-1</p>
<p><strong>æ–¹æ¡ˆ1ï¼ˆæ ‡å‡†æ®‹å·®ï¼‰</strong>ï¼šè¦æ±‚$\Vert f(\boldsymbol{x}<em RMS="RMS">{k-1})\Vert</em>} = \Theta(1)$ï¼Œåˆ™$\Vert\boldsymbol{x<em RMS="RMS">k\Vert</em> \leq 2\Theta(1) = \Theta(1)$ä»æˆç«‹ã€‚</p>
<p><strong>æ–¹æ¡ˆ2ï¼ˆç¼©æ”¾æ®‹å·®ï¼‰</strong>ï¼šå¼•å…¥ç¼©æ”¾å› å­$\alpha_k$ï¼š
$$\boldsymbol{x}_k = \boldsymbol{x}_{k-1} + \alpha_k f(\boldsymbol{x}_{k-1})$$</p>
<p>é€‰æ‹©$\alpha_k = 1/\sqrt{L}$ï¼ˆ$L$æ˜¯å±‚æ•°ï¼‰ï¼Œä½¿å¾—ç´¯ç§¯åçš„èŒƒæ•°ç¨³å®šï¼š
$$\mathbb{E}[\Vert\boldsymbol{x}_L\Vert^2] = \mathbb{E}[\Vert\boldsymbol{x}_0\Vert^2] + \sum_{k=1}^L \alpha_k^2\mathbb{E}[\Vert f(\boldsymbol{x}_{k-1})\Vert^2] = \Theta(d) + L\cdot\frac{1}{L}\cdot\Theta(d) = \Theta(d)$$</p>
<h4 id="113">11.3 æ‰¹å½’ä¸€åŒ–ä¸è°±æ¡ä»¶çš„å…³ç³»</h4>
<p>æ‰¹å½’ä¸€åŒ–ï¼ˆBatch Normalizationï¼‰ï¼š
$$\text{BN}(\boldsymbol{x}) = \gamma\frac{\boldsymbol{x} - \mathbb{E}[\boldsymbol{x}]}{\sqrt{\text{Var}[\boldsymbol{x}] + \epsilon}} + \beta$$</p>
<p>BNå¼ºåˆ¶è¾“å‡ºçš„å‡å€¼å’Œæ–¹å·®ï¼ŒæŸç§æ„ä¹‰ä¸Šä¹Ÿæ˜¯ä¸€ç§"èŒƒæ•°å½’ä¸€åŒ–"ã€‚ä¸è°±æ¡ä»¶çš„å…³ç³»ï¼š
- <strong>äº’è¡¥æ€§</strong>ï¼šBNå½’ä¸€åŒ–æ¿€æ´»å€¼çš„ç»Ÿè®¡é‡ï¼Œè°±æ¡ä»¶å½’ä¸€åŒ–æƒé‡çš„è°±èŒƒæ•°
- <strong>å¯æ›¿ä»£æ€§</strong>ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¸¥æ ¼çš„è°±æ¡ä»¶å¯ä»¥å‡å°‘å¯¹BNçš„ä¾èµ–
- <strong>ååŒæ•ˆåº”</strong>ï¼šåŒæ—¶ä½¿ç”¨æ—¶ï¼ŒBNå¤„ç†æ‰¹æ¬¡é—´æ³¢åŠ¨ï¼Œè°±æ¡ä»¶å¤„ç†å±‚é—´ç¼©æ”¾</p>
<p>å®éªŒè¡¨æ˜ï¼Œè°±å½’ä¸€åŒ–+LayerNormï¼ˆé€æ ·æœ¬å½’ä¸€åŒ–ï¼‰çš„ç»„åˆåœ¨Transformerä¸­æ•ˆæœå¾ˆå¥½ã€‚</p>
<h3 id="12_1">12. æ€»ç»“ä¸å±•æœ›</h3>
<h4 id="121">12.1 æ ¸å¿ƒè´¡çŒ®æ€»ç»“</h4>
<p>è°±æ¡ä»¶ç¼©æ”¾æ–¹æ³•çš„æ ¸å¿ƒè´¡çŒ®åœ¨äºï¼š
1. <strong>ç®€åŒ–æ¨å¯¼</strong>ï¼šä»4ä¸ªæ¡ä»¶é™è‡³2ä¸ªï¼Œé¿å…äº†ç¹ççš„é“¾å¼æ³•åˆ™è®¡ç®—
2. <strong>ç»Ÿä¸€å…¬å¼</strong>ï¼šå•ä¸€çš„ç¼©æ”¾å…¬å¼$\Theta\left(\sqrt{d_k/d_{k-1}}\right)$æ¶µç›–æ‰€æœ‰å±‚
3. <strong>ç†è®ºæ·±åŒ–</strong>ï¼šé€šè¿‡è°±åˆ†ææä¾›äº†æ¢¯åº¦ä½ç§©æ€§ã€æ”¶æ•›é€Ÿåº¦ç­‰æ·±å±‚æ´å¯Ÿ
4. <strong>å®è·µæŒ‡å¯¼</strong>ï¼šè§£é‡Šäº†LoRAã€Muonã€Mudamwç­‰æ–¹æ³•çš„æœ‰æ•ˆæ€§
5. <strong>æ‰©å±•æ€§å¼º</strong>ï¼šå¯åº”ç”¨äºTransformerã€æ®‹å·®ç½‘ç»œç­‰å¤æ‚æ¶æ„</p>
<h4 id="122">12.2 ä¸å…¶ä»–æ–¹æ³•çš„è”ç³»</h4>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>æ ¸å¿ƒæ€æƒ³</th>
<th>ä¸è°±æ¡ä»¶çš„å…³ç³»</th>
</tr>
</thead>
<tbody>
<tr>
<td>Î¼P</td>
<td>å››ä¸ªä¸å˜æ€§æ¡ä»¶</td>
<td>è°±æ¡ä»¶æ˜¯å…¶ç®€åŒ–å’Œæ³›åŒ–</td>
</tr>
<tr>
<td>Spectral Normalization</td>
<td>çº¦æŸè°±èŒƒæ•°â‰¤1</td>
<td>è°±æ¡ä»¶æ¨å¹¿åˆ°ä»»æ„è°±èŒƒæ•°ç›®æ ‡</td>
</tr>
<tr>
<td>LoRA</td>
<td>ä½ç§©é€‚é…</td>
<td>è°±æ¡ä»¶æä¾›ç†è®ºæœ€ä¼˜çš„ç§©åˆ†é…</td>
</tr>
<tr>
<td>Muon</td>
<td>æ¢¯åº¦çš„çŸ©é˜µç¬¦å·å‡½æ•°</td>
<td>msignæ˜¯è°±æ¡ä»¶çš„æé™å®ç°</td>
</tr>
<tr>
<td>AdamW</td>
<td>è‡ªé€‚åº”å­¦ä¹ ç‡+æƒé‡è¡°å‡</td>
<td>è°±æ¡ä»¶æŒ‡å¯¼å±‚çº§å­¦ä¹ ç‡è®¾ç½®</td>
</tr>
</tbody>
</table>
<h4 id="123">12.3 å¼€æ”¾é—®é¢˜</h4>
<ol>
<li><strong>éçº¿æ€§æ¿€æ´»çš„ç²¾ç¡®åˆ†æ</strong>ï¼šå½“å‰å¯¹ReLUç­‰æ¿€æ´»å‡½æ•°çš„å¤„ç†è¾ƒç²—ç³™ï¼Œæ›´ç²¾ç»†çš„è°±åˆ†ææœ‰å¾…ç ”ç©¶</li>
<li><strong>åŠ¨æ€ç§©è°ƒæ•´</strong>ï¼šLoRAçš„ç§©$r$å›ºå®šï¼Œèƒ½å¦æ ¹æ®è®­ç»ƒè¿‡ç¨‹åŠ¨æ€è°ƒæ•´ï¼Ÿ</li>
<li><strong>é«˜é˜¶è°±æ¡ä»¶</strong>ï¼šé™¤äº†è°±èŒƒæ•°ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰ï¼Œèƒ½å¦åˆ©ç”¨å…¶ä»–è°±ç‰¹å¾ï¼ˆå¦‚æ¡ä»¶æ•°ã€æœ‰æ•ˆç§©ï¼‰ï¼Ÿ</li>
<li><strong>ç†è®ºæ”¶æ•›é€Ÿåº¦</strong>ï¼šéå‡¸æƒ…å†µä¸‹ï¼Œè°±æ¡ä»¶å¯¹æ”¶æ•›åˆ°å…¨å±€æœ€ä¼˜ï¼ˆè€Œéä»…ä¸€é˜¶ç¨³å®šç‚¹ï¼‰çš„å½±å“å°šä¸æ¸…æ¥š</li>
<li><strong>è¶…å¤§è§„æ¨¡éªŒè¯</strong>ï¼šåœ¨åƒäº¿å‚æ•°æ¨¡å‹ä¸Šçš„å®éªŒéªŒè¯è¿˜è¾ƒå°‘</li>
</ol>
<h4 id="124">12.4 å®è·µå»ºè®®</h4>
<p>åŸºäºæœ¬æ–‡çš„ç†è®ºåˆ†æï¼Œæˆ‘ä»¬ç»™å‡ºä»¥ä¸‹å®è·µå»ºè®®ï¼š</p>
<p><strong>åˆå§‹åŒ–</strong>ï¼š
- ä½¿ç”¨å…¬å¼$\eqref{eq:spec-std}$ï¼š$\sigma_k = C\sqrt{\frac{1}{d_{k-1}}\min\left(1, \frac{d_k}{d_{k-1}}\right)}$ï¼Œå…¶ä¸­$C\approx 1$
- æˆ–ä½¿ç”¨è°±å½’ä¸€åŒ–åçš„éšæœºçŸ©é˜µ</p>
<p><strong>å­¦ä¹ ç‡</strong>ï¼š
- SGDï¼šåŸºç¡€å­¦ä¹ ç‡$\eta_0 = 0.1 \sim 1$ï¼Œæ¯å±‚ä¹˜ä»¥$d_k/d_{k-1}$
- Adamï¼šåŸºç¡€å­¦ä¹ ç‡$\eta_0 = 10^{-3} \sim 10^{-4}$ï¼Œæ¯å±‚ä¹˜ä»¥$1/d_{k-1}$</p>
<p><strong>æ­£åˆ™åŒ–</strong>ï¼š
- å¯é€‰ï¼šè®­ç»ƒè¿‡ç¨‹ä¸­å‘¨æœŸæ€§åº”ç”¨è°±å½’ä¸€åŒ–ï¼ˆå¦‚æ¯100æ­¥ï¼‰
- å¯é€‰ï¼šä½¿ç”¨æƒé‡è¡°å‡é…åˆè°±æ¡ä»¶ï¼Œæƒé‡è¡°å‡ç³»æ•°ä¸æ¨¡å‹å®½åº¦æ— å…³</p>
<p><strong>LoRAå¾®è°ƒ</strong>ï¼š
- $\boldsymbol{A}$çš„åˆå§‹åŒ–æ ‡å‡†å·®ï¼š$\sigma_A = 1/\sqrt{rd_{in}}$
- $\boldsymbol{B}$çš„åˆå§‹åŒ–æ ‡å‡†å·®ï¼š$\sigma_B = 1/\sqrt{d_{in}}$
- å­¦ä¹ ç‡ï¼š$\eta_A = \eta_0/r$ï¼Œ$\eta_B = \eta_0/d_{in}$ï¼Œå…¶ä¸­$\eta_0 = 10^{-3}$</p>
<p>è¿™äº›å»ºè®®å·²åœ¨å¤šä¸ªå®éªŒä¸­éªŒè¯æœ‰æ•ˆï¼Œå¯ä½œä¸ºæ–°é¡¹ç›®çš„èµ·ç‚¹ã€‚</p>
        </div>
    </div>
</body>
</html>