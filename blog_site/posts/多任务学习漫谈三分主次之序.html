<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šä»»åŠ¡å­¦ä¹ æ¼«è°ˆï¼ˆä¸‰ï¼‰ï¼šåˆ†ä¸»æ¬¡ä¹‹åº</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>å¤šä»»åŠ¡å­¦ä¹ æ¼«è°ˆï¼ˆä¸‰ï¼‰ï¼šåˆ†ä¸»æ¬¡ä¹‹åº</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2026-01-05 | ğŸ“„ å¤§å°: 45.9 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8907">https://spaces.ac.cn/archives/8907</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å¤šä»»åŠ¡å­¦ä¹ æ˜¯ä¸€ä¸ªå¾ˆå®½æ³›çš„å‘½é¢˜ï¼Œä¸åŒåœºæ™¯ä¸‹å¤šä»»åŠ¡å­¦ä¹ çš„ç›®æ ‡ä¸å°½ç›¸åŒã€‚åœ¨<a href="/archives/8870">ã€Šå¤šä»»åŠ¡å­¦ä¹ æ¼«è°ˆï¼ˆä¸€ï¼‰ï¼šä»¥æŸå¤±ä¹‹åã€‹</a>å’Œ<a href="/archives/8896">ã€Šå¤šä»»åŠ¡å­¦ä¹ æ¼«è°ˆï¼ˆäºŒï¼‰ï¼šè¡Œæ¢¯åº¦ä¹‹äº‹ã€‹</a>ä¸­ï¼Œæˆ‘ä»¬å°†å¤šä»»åŠ¡å­¦ä¹ çš„ç›®æ ‡ç†è§£ä¸ºâ€œåšå¥½æ¯ä¸€ä¸ªä»»åŠ¡â€ï¼Œå…·ä½“è¡¨ç°æ˜¯â€œå°½é‡å¹³ç­‰åœ°å¤„ç†æ¯ä¸€ä¸ªä»»åŠ¡â€ï¼Œæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºâ€œå¹³è¡Œå‹å¤šä»»åŠ¡å­¦ä¹ â€ã€‚ç„¶è€Œï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰å¤šä»»åŠ¡å­¦ä¹ çš„ç›®æ ‡éƒ½æ˜¯å¦‚æ­¤ï¼Œåœ¨å¾ˆå¤šåœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬ä¸»è¦è¿˜æ˜¯æƒ³å­¦å¥½æŸä¸€ä¸ªä¸»ä»»åŠ¡ï¼Œå…¶ä½™ä»»åŠ¡éƒ½åªæ˜¯è¾…åŠ©ï¼Œå¸Œæœ›é€šè¿‡å¢åŠ å…¶ä»–ä»»åŠ¡çš„å­¦ä¹ æ¥æå‡ä¸»ä»»åŠ¡çš„æ•ˆæœç½¢äº†ï¼Œæ­¤ç±»åœºæ™¯æˆ‘ä»¬å¯ä»¥ç§°ä¸ºâ€œä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ â€ã€‚</p>
<p>åœ¨è¿™ä¸ªèƒŒæ™¯ä¸‹ï¼Œå¦‚æœè¿˜æ˜¯æ²¿ç”¨å¹³è¡Œå‹å¤šä»»åŠ¡å­¦ä¹ çš„â€œåšå¥½æ¯ä¸€ä¸ªä»»åŠ¡â€çš„å­¦ä¹ æ–¹æ¡ˆï¼Œé‚£ä¹ˆå°±å¯èƒ½ä¼šæ˜æ˜¾é™ä½ä¸»ä»»åŠ¡çš„æ•ˆæœäº†ã€‚æ‰€ä»¥æœ¬æ–‡ç»§ç»­æ²¿ç€â€œè¡Œæ¢¯åº¦ä¹‹äº‹â€çš„æƒ³æ³•ï¼Œæ¢ç´¢ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ çš„è®­ç»ƒæ–¹æ¡ˆã€‚</p>
<h2 id="_1">ç›®æ ‡å½¢å¼</h2>
<p>åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬å‡è®¾è¯»è€…å·²ç»é˜…è¯»å¹¶ä¸”åŸºæœ¬ç†è§£<a href="/archives/8896">ã€Šå¤šä»»åŠ¡å­¦ä¹ æ¼«è°ˆï¼ˆäºŒï¼‰ï¼šè¡Œæ¢¯åº¦ä¹‹äº‹ã€‹</a>é‡Œè¾¹çš„æ€æƒ³å’Œæ–¹æ³•ï¼Œé‚£ä¹ˆåœ¨æ¢¯åº¦è§†è§’ä¸‹ï¼Œè®©æŸä¸ªæŸå¤±å‡½æ•°ä¿æŒä¸‹é™çš„å¿…è¦æ¡ä»¶æ˜¯æ›´æ–°é‡ä¸å…¶æ¢¯åº¦å¤¹è§’è‡³å°‘å¤§äº90åº¦ï¼Œè¿™æ˜¯è´¯ç©¿å…¨æ–‡çš„è®¾è®¡æ€æƒ³ã€‚</p>
<h3 id="_2">çº¦æŸä¼˜åŒ–</h3>
<p>ç°åœ¨å‡è®¾ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ åœºæ™¯ä¸‹ï¼Œæˆ‘ä»¬æœ‰$n+1$ä¸ªä»»åŠ¡çš„æŸå¤±å‡½æ•°ï¼Œåˆ†åˆ«ä¸º$\mathcal{L}_0,\mathcal{L}_1,\cdots,\mathcal{L}_n$ï¼Œå…¶ä¸­$\mathcal{L}_0$æ˜¯ä¸»ä»»åŠ¡æŸå¤±ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒè¶Šå°è¶Šå¥½ï¼›è€Œ$\mathcal{L}_1,\cdots,\mathcal{L}_n$æ˜¯è¾…åŠ©æŸå¤±ï¼Œç›¸å½“äºæ­£åˆ™é¡¹ï¼Œæˆ‘ä»¬åªå¸Œæœ›å®ƒåœ¨è®­ç»ƒè¿‡ç¨‹ä¸­ä¸è¦å¾€ä¸Šå‡çš„æ–¹å‘èµ°ï¼Œä½†ä¸ä¸€å®šè¦â€œæ‹¼äº†å‘½åœ°å˜å°â€ã€‚</p>
<p>æ²¿ç”¨<a href="/archives/8896">ã€Šå¤šä»»åŠ¡å­¦ä¹ æ¼«è°ˆï¼ˆäºŒï¼‰ï¼šè¡Œæ¢¯åº¦ä¹‹äº‹ã€‹</a>çš„è®°å·ï¼Œæˆ‘ä»¬è®°æ¯ä¸€æ­¥çš„æ›´æ–°é‡ä¸º$\Delta\boldsymbol{\theta}=-\eta\boldsymbol{u}$ï¼Œæ—¢ç„¶æˆ‘ä»¬ä»¥$\mathcal{L}<em _boldsymbol_u="\boldsymbol{u">0$ä¸ºä¸»ä»»åŠ¡ï¼Œé‚£ä¹ˆè‡ªç„¶å¸Œæœ›æœ€å¤§åŒ–$\boldsymbol{u}$ä¸$\boldsymbol{g}_0$çš„å†…ç§¯ï¼Œå¯ä»¥è®¾è®¡ä¼˜åŒ–ç›®æ ‡ä¸º<br />
\begin{equation}\max</em>}} \langle\boldsymbol{u},\boldsymbol{g<em _boldsymbol_theta="\boldsymbol{\theta">0\rangle - \frac{1}{2}\Vert\boldsymbol{u}\Vert^2\end{equation}<br />
è¿™é‡Œ$\boldsymbol{g}_i = \nabla</em>}}\mathcal{L<em _boldsymbol_u="\boldsymbol{u">i$æ˜¯å¯¹åº”æŸå¤±çš„æ¢¯åº¦ã€‚å¦‚æœæ²¡æœ‰å…¶ä»–çº¦æŸï¼Œé‚£ä¹ˆå°†ä¼šè§£å¾—$\boldsymbol{u} = \boldsymbol{g}_0$ï¼Œè¿™å°±æ˜¯æ™®é€šçš„æ¢¯åº¦ä¸‹é™ã€‚ä½†äº‹å®ä¸Šæˆ‘ä»¬è¿˜æœ‰è¾…åŠ©ä»»åŠ¡$\mathcal{L}_1,\cdots,\mathcal{L}_n$ï¼Œæˆ‘ä»¬å¸Œæœ›å®ƒä»¬ä¸è¦å¾€ä¸Šå‡çš„æ–¹å‘èµ°ï¼Œæ‰€ä»¥è‡³å°‘è¿˜è¦ä¿è¯$\langle\boldsymbol{u},\boldsymbol{g}_1\rangle\geq 0,\cdots,\langle\boldsymbol{u},\boldsymbol{g}_n\rangle\geq 0$ï¼Œå®ƒä»¬æ˜¯ä¼˜åŒ–çš„çº¦æŸæ¡ä»¶ï¼Œä»è€Œæ€»çš„ç›®æ ‡æ˜¯<br />
\begin{equation}\max</em>}} \langle\boldsymbol{u},\boldsymbol{g}_0\rangle - \frac{1}{2}\Vert\boldsymbol{u}\Vert^2\quad\text{s.t.}\,\, \langle\boldsymbol{u},\boldsymbol{g}_1\rangle\geq 0,\cdots,\langle\boldsymbol{u},\boldsymbol{g}_n\rangle\geq 0\end{equation<br />
æ±‚è§£è¿™ä¸ªçº¦æŸä¼˜åŒ–é—®é¢˜ï¼Œå°±å¯ä»¥å¾—åˆ°æ»¡è¶³æ¡ä»¶çš„æ›´æ–°é‡ã€‚</p>
<h3 id="_3">æ‹‰æ°ä¹˜å­</h3>
<p>æ±‚è§£è¿™ç§å¸¦çº¦æŸä¼˜åŒ–é—®é¢˜çš„æ ‡å‡†æ–¹æ¡ˆæ˜¯æ‹‰æ ¼æœ—æ—¥ä¹˜å­æ³•ï¼Œç®€ç§°â€œæ‹‰æ°ä¹˜å­â€ï¼Œå®ƒå°†çº¦æŸæ¡ä»¶æ•´åˆåˆ°ç›®æ ‡å‡½æ•°ä¸­ï¼Œè½¬åŒ–ä¸ºä¸€ä¸ªmin-maxé—®é¢˜ï¼š<br />
\begin{equation}\max_{\boldsymbol{u}} \min_{\lambda_i\geq 0}\langle\boldsymbol{u},\boldsymbol{g}_0\rangle - \frac{1}{2}\Vert\boldsymbol{u}\Vert^2 + \sum_i \lambda_i \langle\boldsymbol{u},\boldsymbol{g}_i\rangle\label{eq:q-1}\end{equation}</p>
<p>è¿™é‡Œçº¦å®šå¯¹$i$çš„æ±‚å’Œæ˜¯ä»$1$åˆ°$n$ã€‚æ€ä¹ˆç†è§£è¿™ä¸ªè½¬æ¢å‘¢ï¼Ÿå‡å¦‚$\langle\boldsymbol{u},\boldsymbol{g}<em 0="0" _lambda_i_geq="\lambda_i\geq">i\rangle &gt; 0$ï¼Œé‚£ä¹ˆ$\min\limits</em>}$è¿™ä¸€æ­¥å°±åªèƒ½å¾—åˆ°$\lambda_i=0$ï¼Œå› ä¸ºåªæœ‰$\lambda_i=0$èƒ½ä½¿å¾—å®ƒå–æœ€å°ï¼Œæ­¤æ—¶$\lambda_i \langle\boldsymbol{u},\boldsymbol{g<em 0="0" _lambda_i_geq="\lambda_i\geq">i\rangle=0$ï¼›å¦‚æœ$\langle\boldsymbol{u},\boldsymbol{g}_i\rangle=0$ï¼Œé‚£ä¹ˆè‡ªç„¶åœ°$\lambda_i \langle\boldsymbol{u},\boldsymbol{g}_i\rangle=0$ï¼›å¦‚æœ$\langle\boldsymbol{u},\boldsymbol{g}_i\rangle &lt; 0$ï¼Œé‚£ä¹ˆ$\min\limits</em>_i\rangle=0$ã€‚è¿™æ„å‘³ç€min-maxçš„ä¼˜åŒ–ç»“æœè·ŸåŸæ¥å¸¦çº¦æŸçš„maxä¼˜åŒ–å®Œå…¨ç­‰ä»·ã€‚}$è¿™ä¸€æ­¥å°±ä¼šå¾—åˆ°$\lambda_i\to\infty$ï¼Œæ­¤æ—¶$\lambda_i \langle\boldsymbol{u},\boldsymbol{g}_i\rangle\to -\infty$ã€‚ä½†æ˜¯åˆ«å¿˜äº†ï¼Œ$\boldsymbol{u}$çš„ä¼˜åŒ–æ˜¯å–$\max$çš„ï¼Œæ‰€ä»¥åœ¨$0$ä¸$-\infty$ä¹‹é—´ï¼Œå®ƒè‡ªç„¶ä¼šé€‰æ‹©$0$ï¼Œä¹Ÿå°±æ˜¯å®Œæˆè¯¥min-maxä¼˜åŒ–åï¼Œå¿…ç„¶è‡ªåŠ¨åœ°æœ‰$\langle\boldsymbol{u},\boldsymbol{g}_i\rangle \geq 0$ä»¥åŠ$\lambda_i \langle\boldsymbol{u},\boldsymbol{g</p>
<p>ä¸ºäº†æ–¹ä¾¿åé¢çš„æ¨å¯¼ï¼Œè¿™é‡Œå¼•å…¥è·Ÿä¸Šä¸€ç¯‡æ–‡ç« ç±»ä¼¼çš„è®°å·ï¼š<br />
\begin{equation}\mathbb{Q}^n=\left\{(\lambda_1,\cdots,\lambda_n)\left|\lambda_1,\cdots,\lambda_n\geq 0\right.\right\},\quad\tilde{\boldsymbol{g}}(\lambda) = \sum_i \lambda_i \boldsymbol{g}<em _boldsymbol_u="\boldsymbol{u">i\end{equation}<br />
é‚£ä¹ˆå¼$\eqref{eq:q-1}$å¯ä»¥è®°ä¸º<br />
\begin{equation}\max</em>}} \min_{\lambda\in\mathbb{Q}^n}\langle\boldsymbol{u},\boldsymbol{g}_0 + \tilde{\boldsymbol{g}}(\lambda)\rangle - \frac{1}{2}\Vert\boldsymbol{u}\Vert^2\label{eq:q-2}\end{equation</p>
<h2 id="_4">æ±‚è§£ç®—æ³•</h2>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å°†ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ çš„æ›´æ–°æ–¹å‘æ±‚è§£è½¬åŒ–ä¸ºäº†ä¸€ä¸ªmin-maxé—®é¢˜$\eqref{eq:q-2}$ã€‚æ¥ä¸‹æ¥ï¼Œè·Ÿä¸Šä¸€ç¯‡æ–‡ç« çš„æ–¹å¼ç±»ä¼¼ï¼Œæˆ‘ä»¬å…ˆé€šè¿‡Minimaxå®šç†æ¥äº¤æ¢$\max$å’Œ$\min$çš„æ¬¡åºï¼Œç„¶åè¿›ä¸€æ­¥é€šè¿‡Frank-Wolfeç®—æ³•ç»™å‡ºæ±‚è§£æ–¹å¼ï¼Œæœ€åæˆ‘ä»¬ä¼šæ¯”è¾ƒå®ƒè·Ÿå®ƒè·Ÿä¸Šä¸€ç¯‡æ–‡ç« ç»“æœçš„å¼‚åŒã€‚</p>
<h3 id="_5">äº¤æ¢æ¬¡åº</h3>
<p>æ³¨æ„åˆ°é—®é¢˜$\eqref{eq:q-2}$çš„$\max$å’Œ$\min$æ˜¯æœ‰æ¬¡åºçš„ï¼Œæ­£å¸¸æ¥è¯´å¿…é¡»è¦å…ˆå®Œæˆ$\min$è¿™ä¸€æ­¥åæ‰èƒ½å†åš$\max$è¿™ä¸€æ­¥ï¼Œè´¸ç„¶äº¤æ¢æ¬¡åºå¯èƒ½ä¼šå¾—åˆ°é”™è¯¯çš„ç»“æœã€‚ç„¶è€Œï¼Œ$\min$è¿™ä¸€æ­¥æ˜¯æœ‰çº¦æŸçš„ä¼˜åŒ–ï¼Œè€Œ$\max$è¿™ä¸€æ­¥æ˜¯æ— çº¦æŸçš„ï¼Œå› æ­¤ç›¸å¯¹æ¥è¯´$\max$ç¡®å®ç®€å•ä¸€äº›ã€‚å¦‚æœæˆ‘ä»¬èƒ½äº¤æ¢æ¬¡åºï¼Œå…ˆè¿›è¡Œ$\max$è¿™ä¸€æ­¥ï¼Œé‚£ä¹ˆé—®é¢˜å°±å¯ä»¥å¾—åˆ°ç®€åŒ–ã€‚</p>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦å…ˆåˆ¤æ–­ä¸¤è€…çš„æ¬¡åºèƒ½å¦äº¤æ¢ã€‚å¹¸è¿çš„æ˜¯ï¼Œå†¯Â·è¯ºä¾æ›¼æå‡ºäº†ç¾å¦™çš„<a href="https://en.wikipedia.org/wiki/Minimax_theorem">Minimaxå®šç†</a>ï¼Œå®ƒå‘Šè¯‰æˆ‘ä»¬å¦‚æœ$\min$å’Œ$\max$çš„å‚æ•°å¯è¡ŒåŸŸéƒ½æ˜¯ä¸€ä¸ªå‡¸é›†ï¼Œå¹¶ä¸”ç›®æ ‡å‡½æ•°å…³äº$\min$çš„å‚æ•°æ˜¯å‡¸çš„ã€å…³äº$\max$çš„å‚æ•°æ˜¯å‡¹çš„ï¼Œé‚£ä¹ˆ$\min$å’Œ$\max$çš„æ¬¡åºå°±å¯ä»¥äº¤æ¢ã€‚æ›´å¹¸è¿çš„æ˜¯ï¼Œå®¹æ˜“çœ‹å‡ºé—®é¢˜$\eqref{eq:q-2}$æ»¡è¶³Minimaxå®šç†çš„æ¡ä»¶ï¼Œä»è€Œå®ƒç­‰ä»·äº<br />
\begin{equation}\min_{\lambda\in\mathbb{Q}^n}\max_{\boldsymbol{u}} \langle\boldsymbol{u},\boldsymbol{g}<em _lambda_in_mathbb_Q="\lambda\in\mathbb{Q">0 + \tilde{\boldsymbol{g}}(\lambda)\rangle - \frac{1}{2}\Vert\boldsymbol{u}\Vert^2 =\min</em>}^n}\frac{1}{2}\Vert\boldsymbol{g}_0 + \tilde{\boldsymbol{g}}(\lambda)\Vert^2\label{eq:q-3}\end{equation<br />
è¿™æ ·æˆ‘ä»¬å°±å°†é—®é¢˜ç®€åŒ–ä¸ºåªæœ‰$\min$æ“ä½œäº†ï¼Œå…¶ä¸­ç­‰å·å³è¾¹æ˜¯å› ä¸ºå·¦è¾¹çš„ç›®æ ‡å‡½æ•°åªæ˜¯å…³äº$\boldsymbol{u}$çš„äºŒæ¬¡å‡½æ•°ï¼Œå®ƒçš„æœ€å¤§å€¼åœ¨$\boldsymbol{u}^* = \boldsymbol{g}_0 + \tilde{\boldsymbol{g}}(\lambda)$å–åˆ°ï¼Œä»£å…¥å³å¾—ç­‰å·å³è¾¹ç»“æœã€‚</p>
<h3 id="_6">ç®€å•æƒ…å½¢</h3>
<p>ç°åœ¨é—®é¢˜å˜æˆäº†æ±‚$\boldsymbol{g}<em 0="0" _gamma_geq="\gamma\geq">0$ä¸$\boldsymbol{g}_1,\cdots,\boldsymbol{g}_n$çš„æœ€å°æ¨¡é•¿çš„åŠ æƒå åŠ ã€‚æŒ‰ç…§æƒ¯ä¾‹ï¼Œæˆ‘ä»¬å…ˆè¯•ç€è§£å†³æœ€ç®€å•çš„æƒ…å½¢ï¼Œå³$n=1$æ—¶çš„$\min\limits</em>_1\Vert^2$ï¼Œå®ƒæœ‰ç€å½¢è±¡çš„å‡ ä½•æ„ä¹‰å’Œç®€å•çš„è§£æè§£ã€‚}\Vert\boldsymbol{g}_0 + \gamma\boldsymbol{g</p>
<p><a href="/usr/uploads/2022/02/2790703575.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="ç®€å•ä¾‹å­çš„ç²¾ç¡®è§£" src="/usr/uploads/2022/02/2790703575.png" /></a></p>
<p>ç®€å•ä¾‹å­çš„ç²¾ç¡®è§£</p>
<p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå…±æœ‰ä¸¤ç§æƒ…å½¢ï¼šç¬¬ä¸€ç§æƒ…å½¢æ˜¯$\langle\boldsymbol{g}_0,\boldsymbol{g}_1\rangle\geq 0$ï¼Œè¿™è¯´æ˜$\boldsymbol{g}_0$ä¸$\boldsymbol{g}_1$æœ¬å°±ä¸å†²çªï¼Œæ‰€ä»¥ç›´æ¥å–$\gamma=0$å°±è¡Œï¼›ç¬¬äºŒç§æƒ…å½¢æ˜¯$\langle\boldsymbol{g}_0,\boldsymbol{g}_1\rangle &lt; 0$ï¼Œä»ä¸Šé¢å³å›¾å¯ä»¥çœ‹å‡ºï¼Œ$\Vert\boldsymbol{g}_0 + \gamma\boldsymbol{g}_1\Vert^2$çš„æœ€å°å€¼åœ¨$\boldsymbol{g}_0 + \gamma\boldsymbol{g}_1$ä¸$\boldsymbol{g}_1$å‚ç›´æ—¶å–åˆ°ï¼Œäºæ˜¯ç”±$\langle \boldsymbol{g}_0 + \gamma\boldsymbol{g}_1,\boldsymbol{g}_1\rangle=0$è§£å¾—$\gamma = -\frac{\langle \boldsymbol{g}_0,\boldsymbol{g}_1\rangle}{\Vert\boldsymbol{g}_1\Vert^2}$ã€‚æœ€åï¼Œå½“$\Vert\boldsymbol{g}_1\Vert\neq 0$æ—¶ï¼Œä¹Ÿå¯ä»¥ç»Ÿä¸€å†™æˆ<br />
\begin{equation}\gamma = \frac{\text{relu}(-\langle \boldsymbol{g}_0,\boldsymbol{g}_1\rangle)}{\Vert\boldsymbol{g}_1\Vert^2}\label{eq:gamma}\end{equation}</p>
<h3 id="_7">è¿­ä»£æ±‚è§£</h3>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å¤„ç†ä¸€èˆ¬æƒ…å½¢ï¼Œå…¶æ€æƒ³ä¾ç„¶æºè‡ª<a href="https://en.wikipedia.org/wiki/Frank%E2%80%93Wolfe_algorithm">Frank-Wolfeç®—æ³•</a>ã€‚</p>
<p>é¦–å…ˆï¼Œæˆ‘ä»¬é€šè¿‡$\tau = \mathop{\text{argmin}}\limits_i \langle \boldsymbol{g}<em _tau="\tau">i, \boldsymbol{g}_0 + \tilde{\boldsymbol{g}}(\lambda^{(k)})\rangle$æ‰¾å‡ºä¸‹ä¸€æ­¥æ›´æ–°çš„å¯è¡Œæ–¹å‘$e</em>}$ã€‚æ¥ç€ï¼Œæˆ‘ä»¬è¿›è¡Œä¸€ç»´æœç´¢ï¼Œä½†è·Ÿä¹‹å‰ä¸åŒçš„æ˜¯ï¼Œè¿™æ¬¡ä¸æ˜¯åœ¨$\lambda^{(k)}$ä¸$e_{\tau}$ä¹‹é—´æ’å€¼æœç´¢ï¼Œè€Œæ˜¯ç›´æ¥é‡æ–°ç¡®å®š$\boldsymbol{g<em _tau="\tau">{\tau}$å¯¹åº”çš„ç³»æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬ç›´æ¥åœ¨$\tilde{\boldsymbol{g}}(\lambda^{(k)})$ä¸­æŠŠ$\boldsymbol{g}</em>$å¯¹åº”çš„ç³»æ•°ã€‚}$éƒ¨åˆ†åˆ æ‰ï¼Œç„¶åé‡æ–°ç”¨$n=1$æƒ…å½¢çš„ç®—æ³•é‡æ–°è®¡ç®—$\boldsymbol{g}_{\tau</p>
<p>ç”±æ­¤ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸‹è¿°è¿­ä»£è¿‡ç¨‹ï¼š<br />
\begin{equation}\left\{\begin{aligned}<br />
&amp;\tau = \mathop{\text{argmin}}<em _gamma="\gamma">i \langle \boldsymbol{g}_i, \boldsymbol{g}_0+\tilde{\boldsymbol{g}}(\lambda^{(k)})\rangle\\\<br />
&amp;\gamma = \mathop{\text{argmin}}</em>} \left\Vert\boldsymbol{g<em _tau="\tau">0 + \tilde{\boldsymbol{g}}(\lambda^{(k)} - \lambda^{(k)}</em>} e_{\tau} + \gamma e_{\tau})\right\Vert^2 = \mathop{\text{argmin}<em _tau="\tau">{\gamma} \left\Vert\boldsymbol{g}_0 + \tilde{\boldsymbol{g}}(\lambda^{(k)}) - \lambda^{(k)}</em>}\boldsymbol{g<em _tau="\tau">{\tau} + \gamma \boldsymbol{g}</em>\right\Vert^2\\\<br />
&amp;\lambda^{(k+1)} = \lambda^{(k)} - \lambda^{(k)}<em _tau="\tau">{\tau} e</em>} + \gamma e_{\tau<br />
\end{aligned}\right.\end{equation}</p>
<h3 id="_8">ä¸¤ç›¸æ¯”è¾ƒ</h3>
<p>è‡³æ­¤ï¼Œæˆ‘ä»¬å®Œæˆäº†æœ¬æ–‡æ‰€æ¢ç©¶çš„ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ çš„æ±‚è§£ã€‚å¯¹äºè®¤çœŸæ¨å¯¼è¿‡ä¸¤ç¯‡æ–‡ç« çš„æ•°å­¦ç»“æœçš„åŒå­¦æ¥è¯´ï¼Œå®šç„¶ä¼šæ„Ÿè§‰åˆ°å¹³è¡Œå‹å’Œä¸»æ¬¡å‹çš„æ–¹æ³•å’Œç»“æœéƒ½éå¸¸ç›¸ä¼¼ã€‚äº‹å®ä¸Šç¡®å®å¦‚æ­¤ï¼Œå®ƒä»¬æœ‰è¯¸å¤šç›¸ä¼¼ä¹‹å¤„ï¼Œä½†ç»†å¾®ä¹‹å¤„åˆæœ‰ä¸åŒã€‚</p>
<p>ä¸ºäº†åŠ æ·±å¤§å®¶çš„ç†è§£ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸¤ç§å¤šä»»åŠ¡å­¦ä¹ çš„å¼‚åŒå¯¹æ¯”å¦‚ä¸‹ï¼š<br />
$$\small  
\begin{array}{c|c|c}  
\hline  
& \text{å¹³è¡Œå‹å¤šä»»åŠ¡å­¦ä¹ (å‰æ–‡)} & \text{ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ (æœ¬æ–‡)} \\\  
\hline  
\text{ç›®æ ‡æ¦‚è¿°} & \text{å­¦å¥½æ¯ä¸€ä¸ªä»»åŠ¡} & \text{å­¦å¥½ä¸»ä»»åŠ¡ï¼Œä½†ä¸è®©è¾…ä»»åŠ¡å˜å·®} \\\  
\hline  
\text{å¢é‡æ ¼å¼} & \Delta\boldsymbol{\theta} = -\eta\boldsymbol{u} & \Delta\boldsymbol{\theta} = -\eta\boldsymbol{u} \\\  
\hline  
\text{æ•°å­¦å®šä¹‰} & \max\limits_{\boldsymbol{u}}\min\limits_i \langle \boldsymbol{g}_i, \boldsymbol{u}\rangle - \frac{1}{2}\Vert \boldsymbol{u}\Vert^2 & {\begin{array}{l}\max\limits_{\boldsymbol{u}} \langle\boldsymbol{u},\boldsymbol{g}_0\rangle - \frac{1}{2}\Vert\boldsymbol{u}\Vert^2 \\\ \text{s.t.}\,\, \langle\boldsymbol{u},\boldsymbol{g}_1\rangle\geq 0,\cdots,\langle\boldsymbol{u},\boldsymbol{g}_n\rangle\geq 0\end{array}} \\\  
\hline  
\text{å¯¹å¶ç»“æœ} & \min\limits_{\alpha\in\mathbb{P}^n}^{\,^\,}\Vert\tilde{\boldsymbol{g}}(\alpha)\Vert^2 & \min\limits_{\lambda\in\mathbb{Q}^n}\Vert\boldsymbol{g}_0 + \tilde{\boldsymbol{g}}(\lambda)\Vert^2 \\\  
\hline  
\text{æ–¹å‘å‘é‡} & \boldsymbol{u}=\tilde{\boldsymbol{g}}(\alpha)=\sum\limits_i^{\,^\,} \alpha_i \boldsymbol{g}_i & \boldsymbol{u}=\boldsymbol{g}_0+\tilde{\boldsymbol{g}}(\lambda)=\boldsymbol{g}_0 + \sum\limits_i \lambda_i \boldsymbol{g}_i \\\  
\hline  
\text{å¯è¡Œç©ºé—´} & \mathbb{P}^n = \left\\{(\alpha_1,\cdots,\alpha_n)\left|\forall\alpha_i\geq 0, \sum\limits_i \alpha_i = 1\right.\right\\} & \mathbb{Q}^n=\left\\{(\lambda_1,\cdots,\lambda_n)\left|\forall\lambda_i\geq 0\right.\right\\} \\\  
\hline  
\text{è¿­ä»£æ­¥éª¤} & \left\\{\begin{aligned}  
&\tau = \mathop{\text{argmin}}_i \langle \boldsymbol{g}_i, \tilde{\boldsymbol{g}}(\alpha^{(k)})\rangle\\\  
&\gamma = \mathop{\text{argmin}}_{\gamma} \left\Vert(1-\gamma)\tilde{\boldsymbol{g}}(\alpha^{(k)}) + \gamma \boldsymbol{g}_{\tau}\right\Vert^2\\\  
&\alpha^{(k+1)} = (1-\gamma)\alpha^{(k)} + \gamma e_{\tau}  
\end{aligned}\right. & \left\\{\begin{aligned}  
&\tau = \mathop{\text{argmin}}_i \langle \boldsymbol{g}_i, \boldsymbol{g}_0+\tilde{\boldsymbol{g}}(\lambda^{(k)})\rangle\\\  
&\gamma = \mathop{\text{argmin}}_{\gamma} \left\Vert\boldsymbol{g}_0 + \tilde{\boldsymbol{g}}(\lambda^{(k)}) - \lambda^{(k)}_{\tau}\boldsymbol{g}_{\tau} + \gamma \boldsymbol{g}_{\tau}\right\Vert^2\\\  
&\lambda^{(k+1)} = \lambda^{(k)} - \lambda^{(k)}_{\tau} e_{\tau} + \gamma e_{\tau}  
\end{aligned}\right. \\\  
\hline  
\end{array}$$</p>
<p>ç»è¿‡è¿™æ ·å¯¹æ¯”ï¼Œæˆ‘ä»¬ä¹Ÿä¸éš¾å°†ç»“æœæ¨å¹¿åˆ°æœ‰$n$ä¸ªä¸»ä»»åŠ¡ã€$m$ä¸ªè¾…ä»»åŠ¡çš„æ··åˆå‹å¤šä»»åŠ¡å­¦ä¹ ï¼Œå…¶å¯¹å¶ç»“æœæ˜¯ï¼š<br />
\begin{equation}\min_{\alpha\in\mathbb{P}^n,\lambda\in\mathbb{Q}^m}\Vert\tilde{\boldsymbol{g}}(\alpha) + \tilde{\boldsymbol{g}}(\lambda)\Vert^2\end{equation}<br />
è‡³äºå…·ä½“çš„è¿­ä»£ç®—æ³•ï¼Œè¯·å¤§å®¶è‡ªè¡Œæ€è€ƒï½</p>
<h2 id="_9">åº”ç”¨æ€è€ƒ</h2>
<p>åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡å‡ ä¸ªä¾‹å­è¯´æ˜ï¼Œå¾ˆå¤šå¸¸è§çš„é—®é¢˜éƒ½å¯ä»¥å¯¹åº”åˆ°è¿™ç§æœ‰ä¸»æ¬¡ä¹‹åˆ†çš„å¤šä»»åŠ¡å­¦ä¹ ä¸­ï¼ŒæŸç§æ„ä¹‰ä¸Šæ¥è¯´ï¼Œä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ å¯èƒ½æ¯”å¹³è¡Œå‹å¤šä»»åŠ¡å­¦ä¹ æ›´ä¸ºå¸¸è§ã€‚</p>
<h3 id="_10">æ­£åˆ™æŸå¤±</h3>
<p>æœ€å¸¸è§çš„ä¾‹å­å¯èƒ½æ˜¯å¾€ä»»åŠ¡æŸå¤±å‡½æ•°é‡Œè¾¹åŠ å…¥çš„æ­£åˆ™é¡¹ï¼Œæ¯”å¦‚L2æ­£åˆ™ï¼š<br />
\begin{equation}\mathcal{L}(\boldsymbol{\theta}) + \frac{\lambda}{2}\Vert\boldsymbol{\theta}\Vert^2\end{equation}<br />
å¦‚æœæˆ‘ä»¬å°†$\mathcal{L}(\boldsymbol{\theta})$å’Œ$\frac{1}{2}\Vert\boldsymbol{\theta}\Vert^2$çœ‹æˆæ˜¯ä¸¤ä¸ªä»»åŠ¡çš„æŸå¤±ï¼Œé‚£ä¹ˆè¿™ä¹Ÿå¯ä»¥è§†ä¸ºä¸€ä¸ªå¤šä»»åŠ¡å­¦ä¹ é—®é¢˜ã€‚å¾ˆæ˜¾ç„¶ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰æƒ³è¦$\frac{1}{2}\Vert\boldsymbol{\theta}\Vert^2$è¶Šå°è¶Šå¥½ï¼Œè€Œåªæ˜¯å¸Œæœ›$\frac{1}{2}\Vert\boldsymbol{\theta}\Vert^2$çš„åŠ å…¥èƒ½å¤Ÿæé«˜$\mathcal{L}(\boldsymbol{\theta})$çš„æ³›åŒ–æ€§èƒ½ï¼Œæ‰€ä»¥è¿™å°±æ— æ³•å¯¹åº”ä¸Šå¹³è¡Œå‹å¤šä»»åŠ¡å­¦ä¹ ï¼Œè€Œæ›´è´´è¿‘ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ äº†ã€‚</p>
<p>L2æ­£åˆ™é¡¹$\frac{1}{2}\Vert\boldsymbol{\theta}\Vert^2$çš„æ¢¯åº¦æ¯”è¾ƒç®€å•ï¼Œå°±æ˜¯$\boldsymbol{\theta}$ã€‚é‚£ä¹ˆï¼Œå¥—ç”¨æœ¬æ–‡çš„ç»“æœ$\eqref{eq:gamma}$ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®æ”¹ä¼˜åŒ–å™¨ï¼Œå°†æ¢¯åº¦é¡¹æ”¹ä¸º<br />
\begin{equation}\boldsymbol{g} + \frac{\text{relu}(-\langle \boldsymbol{g},\boldsymbol{\theta}\rangle)}{\Vert\boldsymbol{\theta}\Vert^2}\end{equation}<br />
è¿™æ ·å°±å¯ä»¥å®ç°å¾€æ¨¡å‹é‡Œè¾¹åŠ å…¥L2æ­£åˆ™ä½†åˆä¸ç”¨è°ƒæ­£åˆ™é¡¹ç³»æ•°$\lambda$äº†ã€‚å½“ç„¶ï¼Œä¹Ÿå¯ä»¥åƒAdamWé‚£æ ·ç›´æ¥å¯¹åŸæœ¬çš„æ›´æ–°é‡è¿›è¡Œå¤„ç†ï¼Œå®ç°è§£è€¦å½¢å¼çš„æƒé‡è¡°å‡ï¼ˆDecoupled Weight Decayï¼‰ã€‚</p>
<p>å½“ç„¶ï¼Œé™¤äº†è¿™ç§å¯¹å‚æ•°çš„ç›´æ¥æ­£åˆ™å¤–ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–å½¢å¼çš„è¾…åŠ©æŸå¤±ï¼Œæ¯”å¦‚æœ‰å¾€åˆ†ç±»æ¨¡å‹åŠ å…¥å¯¹æ¯”å­¦ä¹ æŸå¤±çš„ã€æœ‰å¾€ç”Ÿæˆæ¨¡å‹åŠ å…¥é•¿åº¦æƒ©ç½šçš„ï¼Œç­‰ç­‰ã€‚è¿™äº›åšæ³•å¤šå¤šå°‘å°‘éƒ½å¯ä»¥å¯¹åº”ä¸Šä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ ä¸­ï¼Œå› æ­¤å¯ä»¥å°è¯•å¥—ç”¨æœ¬æ–‡çš„ç»“æœã€‚å¦‚æœè§‰å¾—å®Œæ•´æ¢¯åº¦çš„è®¡ç®—é‡è¾ƒå¤§ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥è·Ÿä¸Šä¸€ç¯‡æ–‡ç« ä¸€æ ·ï¼Œå¯¹â€œ<a href="/archives/8896#%E5%85%B1%E4%BA%AB%E7%BC%96%E7%A0%81">å…±äº«ç¼–ç </a>â€çš„æƒ…å½¢è¿›è¡Œè¿‘ä¼¼æ¥é™ä½è®¡ç®—é‡ã€‚</p>
<h3 id="_11">å¸¦å™ªå­¦ä¹ </h3>
<p>æ­¤å¤–ï¼Œæœ‰ä¸€ç§å¸¸è§çš„è®­ç»ƒåœºæ™¯ï¼Œå¤§å®¶å¯èƒ½æ²¡æ„è¯†åˆ°å®ƒæ˜¯ä¸€ä¸ªå¤šä»»åŠ¡å­¦ä¹ é—®é¢˜ï¼Œä½†å®ƒæœ¬è´¨ä¸Šç¡®å®ä¹Ÿå¯ä»¥è§†ä¸ºå¤šä»»åŠ¡å­¦ä¹ é—®é¢˜æ¥ç†è§£ï¼Œé‚£å°±æ˜¯â€œå¸¦å™ªå­¦ä¹ â€ã€‚</p>
<p>å‡è®¾å¯¹äºåŒä¸€ç§ä»»åŠ¡ï¼Œæˆ‘ä»¬åªæœ‰å°‘é‡ç²¾æ ‡çš„å¹²å‡€æ•°æ®ï¼Œä½†åŒæ—¶æœ‰å¤§é‡çš„å™ªå£°æ•°æ®ã€‚ç”±äºå™ªå£°æ•°æ®è¾ƒå¤šï¼Œæ‰€ä»¥æˆ‘ä»¬å€¾å‘äºä»¥å™ªå£°æ•°æ®ä¸ºä¸»è¿›è¡Œå­¦ä¹ ï¼Œå‡è®¾å¯¹åº”çš„æŸå¤±ä¸º$\mathcal{L}_0$ã€‚ç„¶è€Œï¼Œç”±äºæ•°æ®ä¸­å­˜åœ¨å™ªå£°ï¼Œå› æ­¤çº¯ç²¹æœ€å°åŒ–$\mathcal{L}_0$æœªå¿…èƒ½å¾—åˆ°ç†æƒ³çš„æ¨¡å‹ï¼Œå®ƒå¯èƒ½æŠŠé”™è¯¯çš„æ ‡æ³¨ä¹ŸèƒŒä¸‹æ¥äº†ã€‚è¿™æ—¶ï¼Œå¹²å‡€æ•°æ®å°±å¯ä»¥æ´¾ä¸Šç”¨åœºäº†ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å¹²å‡€æ•°æ®ç®—ä¸€ä¸ªæŸå¤±$\mathcal{L}_1$ã€‚ç”±äºå¹²å‡€æ•°æ®çš„å™ªå£°è¾ƒå°‘ï¼Œå¯ä»¥è®¤ä¸º$\mathcal{L}_1$æ¯”$\mathcal{L}_0$æ›´èƒ½åæ˜ æ¨¡å‹çš„çœŸå®æ€§èƒ½ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥å¢åŠ ä¸€ä¸ªé™åˆ¶ï¼š</p>
<blockquote>
<p>ä¸ç®¡æ€ä¹ˆæœ€å°åŒ–$\mathcal{L}_0$ï¼Œéƒ½ä¸èƒ½è®©$\mathcal{L}_1$ä¸Šå‡ã€‚æ¢å¥è¯è¯´ï¼Œä½ å¯ä»¥ç”¨å™ªå£°æ•°æ®è®­ç»ƒï¼Œä½†ä¸èƒ½è®©å¹²å‡€æ•°æ®çš„æ•ˆæœå˜å·®ã€‚</p>
</blockquote>
<p>è¿™åˆšå¥½å°±æ˜¯ä»¥$\mathcal{L}_0$ä¸ºä¸»ã€$\mathcal{L}_1$ä¸ºè¾…çš„ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ é—®é¢˜ï¼</p>
<p>æ— ç‹¬æœ‰å¶ï¼Œå»å¹´Googleçš„ä¸€ç¯‡è®ºæ–‡<a href="https://papers.cool/arxiv/2102.13549">ã€ŠGradient-guided Loss Masking for Neural Machine Translationã€‹</a>ä¹Ÿç»™å‡ºäº†ç±»ä¼¼åšæ³•ï¼Œä½†ç»†èŠ‚ç•¥æœ‰ä¸åŒã€‚å®ƒæ˜¯é€šè¿‡ç®—æ¯ä¸ªå™ªå£°æ ·æœ¬å¯¹å‚æ•°çš„æ¢¯åº¦ï¼Œåªä¿ç•™ä¸å¹²å‡€æ•°æ®æ¢¯åº¦$\nabla_{\boldsymbol{\theta}} \mathcal{L}_1$å¤¹è§’å°äº90åº¦ï¼ˆå†…ç§¯å¤§äº0ï¼‰çš„æ ·æœ¬ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¤§å®¶éƒ½æ˜¯ä»¥ä¸å¹²å‡€æ•°æ®æ¢¯åº¦çš„å†…ç§¯ä¸ºåˆ¤æ–­ä¾æ®ï¼Œä¸åŒçš„æ˜¯ï¼Œä¸»æ¬¡å‹å¤šä»»åŠ¡ä¸­ï¼Œå¦‚æœå†…ç§¯å°äº0ï¼Œåˆ™å¯¹æ›´æ–°é‡åšä¸€ä¸ªä¿®æ­£ï¼Œè€Œåœ¨Googleçš„æ–‡ç« ä¸­ï¼Œåˆ™æ˜¯ç›´æ¥åˆ æ‰å¯¹åº”çš„æ ·æœ¬ã€‚</p>
<h2 id="_12">æœ¬æ–‡å°ç»“</h2>
<p>æœ¬æ–‡å°†å‰ä¸€ç¯‡æ–‡ç« çš„å¹³è¡Œå‹å¤šä»»åŠ¡å­¦ä¹ çš„ç»“æœæ¨å¹¿åˆ°äº†â€œä¸»æ¬¡å‹â€å¤šä»»åŠ¡å­¦ä¹ ï¼Œå³å¤šä»»åŠ¡å­¦ä¹ çš„ç›®æ ‡ä¸å†æ˜¯åšå¥½æ‰€æœ‰çš„ä»»åŠ¡ï¼Œè€Œæ˜¯ä»¥æŸä¸ªä»»åŠ¡ä¸ºä¸»ã€å…¶ä½™ä»»åŠ¡ä¸ºè¾…ï¼Œå…¶ç»“æœè·ŸåŸæ¥çš„å¹³è¡Œå‹å¤šä»»åŠ¡å­¦ä¹ æœ‰ä¸å°‘ç›¸ä¼¼ä¹‹å¤„ï¼Œä½†ç»†å¾®ä¹‹å¤„åˆä¸å°½ç›¸åŒï¼Œæœ€åä»‹ç»äº†ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ çš„ä¸€äº›ç»å…¸ä¾‹å­ï¼Œå¦‚æ­£åˆ™é¡¹ã€å¸¦å™ªå­¦ä¹ ç­‰ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8907">https://spaces.ac.cn/archives/8907</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Feb. 14, 2022). ã€Šå¤šä»»åŠ¡å­¦ä¹ æ¼«è°ˆï¼ˆä¸‰ï¼‰ï¼šåˆ†ä¸»æ¬¡ä¹‹åº ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8907">https://spaces.ac.cn/archives/8907</a></p>
<p>@online{kexuefm-8907,<br />
title={å¤šä»»åŠ¡å­¦ä¹ æ¼«è°ˆï¼ˆä¸‰ï¼‰ï¼šåˆ†ä¸»æ¬¡ä¹‹åº},<br />
author={è‹å‰‘æ—},<br />
year={2022},<br />
month={Feb},<br />
url={\url{https://spaces.ac.cn/archives/8907}},<br />
} </p>
<hr />
<h2 id="_13">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<h3 id="1">1. çº¦æŸä¼˜åŒ–é—®é¢˜çš„æ•°å­¦åŸºç¡€</h3>
<p><strong>é—®é¢˜è®¾å®š</strong>ï¼šä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ </p>
<p>ä¸»ä»»åŠ¡ï¼š$\mathcal{L}_0(\theta)$ - å¸Œæœ›æœ€å°åŒ–
è¾…åŠ©ä»»åŠ¡ï¼š$\mathcal{L}_1(\theta), \ldots, \mathcal{L}_n(\theta)$ - å¸Œæœ›ä¸ä¸Šå‡</p>
<p><strong>ä¼˜åŒ–ç›®æ ‡</strong>ï¼š</p>
<p>\begin{equation}
\min_{\theta} \mathcal{L}_0(\theta) \quad \text{s.t.} \quad \mathcal{L}_i(\theta) \leq \mathcal{L}_i(\theta_0), \quad i = 1,\ldots,n
\tag{1}
\end{equation}</p>
<p>å…¶ä¸­$\theta_0$æ˜¯åˆå§‹å‚æ•°ã€‚</p>
<p><strong>ä¸€é˜¶è¿‘ä¼¼</strong>ï¼š</p>
<p>åœ¨å½“å‰ç‚¹$\theta$å¤„ï¼Œä½¿ç”¨ä¸€é˜¶Taylorå±•å¼€ï¼š
\begin{equation}
\mathcal{L}_i(\theta + \Delta\theta) \approx \mathcal{L}_i(\theta) + \langle \nabla \mathcal{L}_i(\theta), \Delta\theta \rangle
\tag{2}
\end{equation}</p>
<p>è¦ä½¿$\mathcal{L}_i$ä¸ä¸Šå‡ï¼š
\begin{equation}
\langle \nabla \mathcal{L}_i(\theta), \Delta\theta \rangle \leq 0
\tag{3}
\end{equation}</p>
<p>å–$\Delta\theta = -\eta \boldsymbol{u}$ï¼ˆ$\eta &gt; 0$ï¼‰ï¼Œåˆ™æ¡ä»¶å˜ä¸ºï¼š
\begin{equation}
\langle \nabla \mathcal{L}_i(\theta), \boldsymbol{u} \rangle \geq 0, \quad i = 1,\ldots,n
\tag{4}
\end{equation}</p>
<p><strong>ä¸»ä»»åŠ¡æœ€å¤§åŒ–</strong>ï¼š</p>
<p>åŒæ—¶ï¼Œä¸ºäº†æœ€å¤§åŒ–ä¸»ä»»åŠ¡çš„ä¸‹é™ï¼š
\begin{equation}
\max_{\boldsymbol{u}} \langle \nabla \mathcal{L}_0(\theta), \boldsymbol{u} \rangle - \frac{1}{2}|\boldsymbol{u}|^2
\tag{5}
\end{equation}</p>
<p>æ­£åˆ™é¡¹$\frac{1}{2}|\boldsymbol{u}|^2$é˜²æ­¢$|\boldsymbol{u}| \to \infty$ã€‚</p>
<h3 id="2-lagrange">2. Lagrangeå¯¹å¶ç†è®º</h3>
<p><strong>åŸé—®é¢˜ï¼ˆPrimalï¼‰</strong>ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\max_{\boldsymbol{u}} \quad &amp; f_0(\boldsymbol{u}) = \langle \boldsymbol{g}_0, \boldsymbol{u} \rangle - \frac{1}{2}|\boldsymbol{u}|^2 \
\text{s.t.} \quad &amp; g_i(\boldsymbol{u}) = \langle \boldsymbol{g}_i, \boldsymbol{u} \rangle \geq 0, \quad i = 1,\ldots,n
\end{aligned}
\tag{6}
\end{equation}</p>
<p><strong>Lagrangianå‡½æ•°</strong>ï¼š</p>
<p>\begin{equation}
\mathcal{L}(\boldsymbol{u}, \boldsymbol{\lambda}) = f_0(\boldsymbol{u}) + \sum_{i=1}^n \lambda_i g_i(\boldsymbol{u})
\tag{7}
\end{equation}</p>
<p>å…¶ä¸­$\lambda_i \geq 0$æ˜¯Lagrangeä¹˜å­ã€‚</p>
<p><strong>å¯¹å¶å‡½æ•°</strong>ï¼š</p>
<p>\begin{equation}
d(\boldsymbol{\lambda}) = \max_{\boldsymbol{u}} \mathcal{L}(\boldsymbol{u}, \boldsymbol{\lambda}) = \max_{\boldsymbol{u}} \left[\langle \boldsymbol{g}_0 + \sum_i \lambda_i \boldsymbol{g}_i, \boldsymbol{u} \rangle - \frac{1}{2}|\boldsymbol{u}|^2\right]
\tag{8}
\end{equation}</p>
<p>å¯¹$\boldsymbol{u}$æ±‚å¯¼å¹¶ä»¤å…¶ä¸ºé›¶ï¼š
\begin{equation}
\nabla_{\boldsymbol{u}} \mathcal{L} = \boldsymbol{g}_0 + \sum_i \lambda_i \boldsymbol{g}_i - \boldsymbol{u} = 0
\tag{9}
\end{equation}</p>
<p>è§£å¾—ï¼š
\begin{equation}
\boldsymbol{u}^*(\boldsymbol{\lambda}) = \boldsymbol{g}_0 + \sum_i \lambda_i \boldsymbol{g}_i
\tag{10}
\end{equation}</p>
<p>ä»£å…¥å¾—ï¼š
\begin{equation}
d(\boldsymbol{\lambda}) = \langle \boldsymbol{u}^<em>, \boldsymbol{u}^</em> \rangle - \frac{1}{2}|\boldsymbol{u}^*|^2 = \frac{1}{2}|\boldsymbol{g}_0 + \sum_i \lambda_i \boldsymbol{g}_i|^2
\tag{11}
\end{equation}</p>
<p><strong>å¯¹å¶é—®é¢˜ï¼ˆDualï¼‰</strong>ï¼š</p>
<p>\begin{equation}
\min_{\lambda_i \geq 0} d(\boldsymbol{\lambda}) = \min_{\lambda_i \geq 0} \frac{1}{2}\left|\boldsymbol{g}<em i="1">0 + \sum</em>_i\right|^2
\tag{12}
\end{equation}}^n \lambda_i \boldsymbol{g</p>
<h3 id="3-kkt">3. KKTæ¡ä»¶ä¸äº’è¡¥æ¾å¼›æ€§</h3>
<p><strong>KKTå¿…è¦æ¡ä»¶</strong>ï¼š</p>
<p>è‹¥$(\boldsymbol{u}^<em>, \boldsymbol{\lambda}^</em>)$æ˜¯æœ€ä¼˜è§£ï¼Œåˆ™æ»¡è¶³ï¼š</p>
<ol>
<li><strong>ç¨³å®šæ€§</strong>ï¼š$\nabla_{\boldsymbol{u}} \mathcal{L}(\boldsymbol{u}^<em>, \boldsymbol{\lambda}^</em>) = 0$</li>
<li><strong>åŸå§‹å¯è¡Œæ€§</strong>ï¼š$\langle \boldsymbol{g}_i, \boldsymbol{u}^* \rangle \geq 0, \forall i$</li>
<li><strong>å¯¹å¶å¯è¡Œæ€§</strong>ï¼š$\lambda_i^* \geq 0, \forall i$</li>
<li><strong>äº’è¡¥æ¾å¼›æ€§</strong>ï¼š$\lambda_i^<em> \langle \boldsymbol{g}_i, \boldsymbol{u}^</em> \rangle = 0, \forall i$</li>
</ol>
<p><strong>äº’è¡¥æ¾å¼›æ€§è§£é‡Š</strong>ï¼š</p>
<p>å¯¹æ¯ä¸ªçº¦æŸ$i$ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š
- <strong>éæ¿€æ´»çº¦æŸ</strong>ï¼š$\langle \boldsymbol{g}_i, \boldsymbol{u}^<em> \rangle &gt; 0 \implies \lambda_i^</em> = 0$ï¼ˆçº¦æŸä¸ç´§ï¼Œä¹˜å­ä¸º0ï¼‰
- <strong>æ¿€æ´»çº¦æŸ</strong>ï¼š$\langle \boldsymbol{g}_i, \boldsymbol{u}^<em> \rangle = 0 \implies \lambda_i^</em> \geq 0$ï¼ˆçº¦æŸç´§ï¼Œä¹˜å­éè´Ÿï¼‰</p>
<p><strong>å‡ ä½•æ„ä¹‰</strong>ï¼š</p>
<p>æ¿€æ´»çº¦æŸå¯¹åº”çš„$\boldsymbol{g}_i$ä¸æœ€ä¼˜æ–¹å‘$\boldsymbol{u}^*$æ­£äº¤ï¼Œè¿™äº›ä»»åŠ¡çš„æ¢¯åº¦"æ‹‰ä½"äº†ä¸»ä»»åŠ¡ï¼Œé˜²æ­¢å…¶è¿‡åº¦ä¸‹é™è€Œå¯¼è‡´è¾…åŠ©ä»»åŠ¡ä¸Šå‡ã€‚</p>
<h3 id="4">4. å•è¾…åŠ©ä»»åŠ¡çš„è§£æè§£</h3>
<p><strong>é—®é¢˜</strong>ï¼š$n = 1$çš„æƒ…å†µ</p>
<p>\begin{equation}
\min_{\gamma \geq 0} f(\gamma) = \frac{1}{2}|\boldsymbol{g}_0 + \gamma \boldsymbol{g}_1|^2
\tag{13}
\end{equation}</p>
<p><strong>å±•å¼€</strong>ï¼š</p>
<p>\begin{equation}
\begin{aligned}
f(\gamma) &amp;= \frac{1}{2}|\boldsymbol{g}_0|^2 + \gamma \langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle + \frac{\gamma^2}{2}|\boldsymbol{g}_1|^2 \
&amp;= \frac{a}{2}\gamma^2 + b\gamma + c
\end{aligned}
\tag{14}
\end{equation}</p>
<p>å…¶ä¸­ï¼š
- $a = |\boldsymbol{g}_1|^2$
- $b = \langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle$
- $c = \frac{1}{2}|\boldsymbol{g}_0|^2$</p>
<p><strong>æ±‚å¯¼</strong>ï¼š</p>
<p>\begin{equation}
f'(\gamma) = a\gamma + b = |\boldsymbol{g}_1|^2 \gamma + \langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle
\tag{15}
\end{equation}</p>
<p>ä»¤$f'(\gamma) = 0$ï¼š
\begin{equation}
\gamma_{unconstrained} = -\frac{\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle}{|\boldsymbol{g}_1|^2}
\tag{16}
\end{equation}</p>
<p><strong>åˆ†æƒ…å†µè®¨è®º</strong>ï¼š</p>
<p><strong>æƒ…å†µ1</strong>ï¼š$\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle \geq 0$ï¼ˆæ— å†²çªï¼‰</p>
<p>æ­¤æ—¶$\gamma_{unconstrained} \leq 0$ï¼Œä½†çº¦æŸè¦æ±‚$\gamma \geq 0$ï¼Œå› æ­¤ï¼š
\begin{equation}
\gamma^* = 0
\tag{17}
\end{equation}</p>
<p><strong>æƒ…å†µ2</strong>ï¼š$\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle &lt; 0$ï¼ˆæœ‰å†²çªï¼‰</p>
<p>æ­¤æ—¶$\gamma_{unconstrained} &gt; 0$ï¼Œæ»¡è¶³çº¦æŸï¼Œå› æ­¤ï¼š
\begin{equation}
\gamma^* = -\frac{\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle}{|\boldsymbol{g}_1|^2}
\tag{18}
\end{equation}</p>
<p><strong>ç»Ÿä¸€è¡¨è¾¾å¼</strong>ï¼š</p>
<p>\begin{equation}
\gamma^* = \frac{\max(0, -\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle)}{|\boldsymbol{g}_1|^2} = \frac{\text{ReLU}(-\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle)}{|\boldsymbol{g}_1|^2}
\tag{19}
\end{equation}</p>
<p><strong>æœ€ä¼˜æ–¹å‘</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{u}^<em> = \boldsymbol{g}_0 + \gamma^</em> \boldsymbol{g}_1 = \boldsymbol{g}_0 + \frac{\text{ReLU}(-\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle)}{|\boldsymbol{g}_1|^2} \boldsymbol{g}_1
\tag{20}
\end{equation}</p>
<h3 id="5">5. å‡ ä½•è§£é‡Š</h3>
<p><strong>å‘é‡æŠ•å½±</strong>ï¼š</p>
<p>å½“$\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle &lt; 0$æ—¶ï¼Œè§£å¯ä»¥ç†è§£ä¸ºï¼š</p>
<p>\begin{equation}
\boldsymbol{u}^* = \boldsymbol{g}<em _boldsymbol_g="\boldsymbol{g">0 - \text{proj}</em>_0)
\tag{21}
\end{equation}}_1}^{-}(\boldsymbol{g</p>
<p>å…¶ä¸­$\text{proj}_{\boldsymbol{g}_1}^{-}$è¡¨ç¤º$\boldsymbol{g}_0$åœ¨$\boldsymbol{g}_1$ä¸Šçš„è´ŸæŠ•å½±åˆ†é‡ã€‚</p>
<p><strong>å‚ç›´æ€§</strong>ï¼š</p>
<p>åœ¨æœ€ä¼˜ç‚¹ï¼Œæœ‰ï¼š
\begin{equation}
\langle \boldsymbol{u}^<em>, \boldsymbol{g}_1 \rangle = \langle \boldsymbol{g}_0 + \gamma^</em> \boldsymbol{g}_1, \boldsymbol{g}_1 \rangle = \langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle + \gamma^* |\boldsymbol{g}_1|^2 = 0
\tag{22}
\end{equation}</p>
<p>è¿™è¯´æ˜æœ€ä¼˜æ–¹å‘$\boldsymbol{u}^*$ä¸$\boldsymbol{g}_1$æ­£äº¤ï¼</p>
<p><strong>ç‰©ç†æ„ä¹‰</strong>ï¼š</p>
<ul>
<li>$\boldsymbol{g}_0$ï¼šä¸»ä»»åŠ¡çš„"åŸå§‹"æ¢¯åº¦æ–¹å‘</li>
<li>$\gamma^* \boldsymbol{g}_1$ï¼šè¾…åŠ©ä»»åŠ¡çš„"ä¿®æ­£"é¡¹</li>
<li>$\boldsymbol{u}^*$ï¼šä¿®æ­£åçš„å®é™…æ›´æ–°æ–¹å‘</li>
</ul>
<p>ä¿®æ­£é¡¹å°†åŸå§‹æ¢¯åº¦ä¸­ä¸è¾…åŠ©ä»»åŠ¡å†²çªçš„éƒ¨åˆ†å»é™¤ã€‚</p>
<h3 id="6-frank-wolfe">6. Frank-Wolfeç®—æ³•æ¨å¯¼</h3>
<p><strong>ç›®æ ‡å‡½æ•°</strong>ï¼š</p>
<p>\begin{equation}
\min_{\boldsymbol{\lambda} \in \mathbb{R}<em i="1">+^n} f(\boldsymbol{\lambda}) = \frac{1}{2}\left|\boldsymbol{g}_0 + \sum</em>_i\right|^2
\tag{23}
\end{equation}}^n \lambda_i \boldsymbol{g</p>
<p><strong>çº¿æ€§åŒ–</strong>ï¼š</p>
<p>åœ¨å½“å‰ç‚¹$\boldsymbol{\lambda}^{(k)}$å¤„ï¼Œçº¿æ€§åŒ–ç›®æ ‡å‡½æ•°ï¼š
\begin{equation}
f(\boldsymbol{\lambda}) \approx f(\boldsymbol{\lambda}^{(k)}) + \langle \nabla f(\boldsymbol{\lambda}^{(k)}), \boldsymbol{\lambda} - \boldsymbol{\lambda}^{(k)} \rangle
\tag{24}
\end{equation}</p>
<p><strong>æ¢¯åº¦è®¡ç®—</strong>ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\nabla f(\boldsymbol{\lambda}) &amp;= \nabla \left[\frac{1}{2}\left|\boldsymbol{g}_0 + \sum_i \lambda_i \boldsymbol{g}_i\right|^2\right] \
&amp;= \left(\boldsymbol{g}_0 + \sum_i \lambda_i \boldsymbol{g}_i\right)^T \begin{pmatrix} \boldsymbol{g}_1 \ \vdots \ \boldsymbol{g}_n \end{pmatrix}
\end{aligned}
\tag{25}
\end{equation}</p>
<p>å³ï¼š
\begin{equation}
\frac{\partial f}{\partial \lambda_i} = \langle \boldsymbol{g}_0 + \sum_j \lambda_j \boldsymbol{g}_j, \boldsymbol{g}_i \rangle = \langle \boldsymbol{u}^{(k)}, \boldsymbol{g}_i \rangle
\tag{26}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{u}^{(k)} = \boldsymbol{g}_0 + \sum_j \lambda_j^{(k)} \boldsymbol{g}_j$ã€‚</p>
<p><strong>æ–¹å‘é€‰æ‹©</strong>ï¼š</p>
<p>Frank-Wolfeé€‰æ‹©åœ¨å¯è¡ŒåŸŸé¡¶ç‚¹$\boldsymbol{e}<em i="i">\tau$å¤„æœ€å°åŒ–çº¿æ€§åŒ–ç›®æ ‡ï¼š
\begin{equation}
\tau = \mathop{\arg\min}</em>_i \rangle
\tag{27}
\end{equation}} \langle \nabla f(\boldsymbol{\lambda}^{(k)}), \boldsymbol{e}_i \rangle = \mathop{\arg\min}_i \langle \boldsymbol{u}^{(k)}, \boldsymbol{g</p>
<p><strong>æ­¥é•¿ä¼˜åŒ–</strong>ï¼š</p>
<p>ä¸æ ‡å‡†Frank-Wolfeä¸åŒï¼Œæˆ‘ä»¬ç›´æ¥é‡æ–°è®¡ç®—$\lambda_\tau$ï¼š</p>
<p>è®¾æ›´æ–°åï¼š
\begin{equation}
\boldsymbol{\lambda}^{(k+1)} = \boldsymbol{\lambda}^{(k)} - \lambda_\tau^{(k)} \boldsymbol{e}<em>\tau + \gamma \boldsymbol{e}</em>\tau
\tag{28}
\end{equation}</p>
<p>åˆ™ï¼š
\begin{equation}
\boldsymbol{u}^{(k+1)} = \boldsymbol{g}<em _neq="\neq" _tau="\tau" i="i">0 + \sum</em>} \lambda_i^{(k)} \boldsymbol{g<em>i + \gamma \boldsymbol{g}</em>\tau = \boldsymbol{u}^{(k)} - \lambda_\tau^{(k)} \boldsymbol{g}<em>\tau + \gamma \boldsymbol{g}</em>\tau
\tag{29}
\end{equation}</p>
<p>ä¼˜åŒ–$\gamma$ï¼š
\begin{equation}
\gamma^* = \mathop{\arg\min}<em>{\gamma \geq 0} \left|\boldsymbol{u}^{(k)} - \lambda</em>\tau^{(k)} \boldsymbol{g}<em>\tau + \gamma \boldsymbol{g}</em>\tau\right|^2
\tag{30}
\end{equation}</p>
<p>è®¾$\tilde{\boldsymbol{u}} = \boldsymbol{u}^{(k)} - \lambda_\tau^{(k)} \boldsymbol{g}<em>\tau$ï¼Œåˆ™ï¼š
\begin{equation}
\gamma^* = \frac{\text{ReLU}(-\langle \tilde{\boldsymbol{u}}, \boldsymbol{g}</em>\tau \rangle)}{|\boldsymbol{g}_\tau|^2}
\tag{31}
\end{equation}</p>
<h3 id="7">7. æ”¶æ•›æ€§åˆ†æ</h3>
<p><strong>å®šç†7.1 (æ”¶æ•›é€Ÿåº¦)</strong></p>
<p>Frank-Wolfeç®—æ³•å¯¹ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ æ”¶æ•›é€Ÿåº¦ä¸º$O(1/k)$ï¼š
\begin{equation}
f(\boldsymbol{\lambda}^{(k)}) - f(\boldsymbol{\lambda}^*) \leq \frac{C}{k}
\tag{32}
\end{equation}</p>
<p>å…¶ä¸­$C$æ˜¯ä¾èµ–äº$|\boldsymbol{g}_i|$çš„å¸¸æ•°ã€‚</p>
<p><strong>è¯æ˜è¦ç‚¹</strong>ï¼š</p>
<p>å®šä¹‰ä¼˜åŒ–gapï¼š
\begin{equation}
g_k = f(\boldsymbol{\lambda}^{(k)}) - f^*
\tag{33}
\end{equation}</p>
<p>åˆ©ç”¨å‡¸å‡½æ•°çš„æ€§è´¨å’ŒFrank-Wolfeçš„ä¸‹é™å¼•ç†ï¼š
\begin{equation}
g_{k+1} \leq (1 - \gamma_k) g_k + \frac{L\gamma_k^2}{2}
\tag{34}
\end{equation}</p>
<p>å…¶ä¸­$L$æ˜¯Lipschitzå¸¸æ•°ã€‚é€‰æ‹©$\gamma_k = \frac{2}{k+2}$å¯è¯å¾—ç»“æœã€‚$\square$</p>
<h3 id="8">8. ä¸å¹³è¡Œå‹å¤šä»»åŠ¡å­¦ä¹ çš„å¯¹æ¯”</h3>
<p><strong>ç›¸ä¼¼ç‚¹</strong>ï¼š</p>
<ol>
<li>éƒ½åŸºäºæ¢¯åº¦è§†è§’</li>
<li>éƒ½ä½¿ç”¨Frank-Wolfeæ¡†æ¶</li>
<li>éƒ½æœ‰$O(1/k)$æ”¶æ•›é€Ÿåº¦</li>
</ol>
<p><strong>ä¸åŒç‚¹</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>ç»´åº¦</th>
<th>å¹³è¡Œå‹</th>
<th>ä¸»æ¬¡å‹</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¼˜åŒ–ç©ºé—´</td>
<td>å•çº¯å½¢$\mathbb{P}^n$</td>
<td>éè´Ÿè±¡é™$\mathbb{R}_+^n$</td>
</tr>
<tr>
<td>æƒé‡å½’ä¸€åŒ–</td>
<td>$\sum \alpha_i = 1$</td>
<td>æ— å½’ä¸€åŒ–çº¦æŸ</td>
</tr>
<tr>
<td>ç›®æ ‡</td>
<td>å¹³è¡¡æ‰€æœ‰ä»»åŠ¡</td>
<td>ä¸»ä»»åŠ¡ä¼˜å…ˆ</td>
</tr>
<tr>
<td>æ¢¯åº¦ç»„åˆ</td>
<td>$\sum \alpha_i \boldsymbol{g}_i$</td>
<td>$\boldsymbol{g}_0 + \sum \lambda_i \boldsymbol{g}_i$</td>
</tr>
</tbody>
</table>
<p><strong>ä»£æ•°ç»“æ„</strong>ï¼š</p>
<p>å¹³è¡Œå‹å¯¹åº”<strong>å‡¸ç»„åˆ</strong>ï¼ˆconvex combinationï¼‰ï¼š
\begin{equation}
\boldsymbol{u} = \sum_i \alpha_i \boldsymbol{g}_i, \quad \alpha_i \geq 0, \sum_i \alpha_i = 1
\tag{35}
\end{equation}</p>
<p>ä¸»æ¬¡å‹å¯¹åº”<strong>é”¥ç»„åˆ</strong>ï¼ˆconic combinationï¼‰ï¼š
\begin{equation}
\boldsymbol{u} = \boldsymbol{g}_0 + \sum_i \lambda_i \boldsymbol{g}_i, \quad \lambda_i \geq 0
\tag{36}
\end{equation}</p>
<h3 id="9-l2">9. L2æ­£åˆ™åŒ–çš„åº”ç”¨</h3>
<p><strong>é—®é¢˜è®¾å®š</strong>ï¼š</p>
<p>ä¸»ä»»åŠ¡ï¼š$\mathcal{L}(\theta)$
è¾…åŠ©ä»»åŠ¡ï¼š$\frac{1}{2}|\theta|^2$ï¼ˆL2æ­£åˆ™ï¼‰</p>
<p><strong>æ¢¯åº¦</strong>ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\boldsymbol{g}<em>0 &amp;= \nabla</em>\theta \mathcal{L}(\theta) \
\boldsymbol{g}<em>1 &amp;= \nabla</em>\theta \frac{1}{2}|\theta|^2 = \theta
\end{aligned}
\tag{37}
\end{equation}</p>
<p><strong>ä¿®æ­£æ¢¯åº¦</strong>ï¼š</p>
<p>æ ¹æ®å¼(20)ï¼š
\begin{equation}
\boldsymbol{u}^* = \boldsymbol{g}_0 + \frac{\text{ReLU}(-\langle \boldsymbol{g}_0, \theta \rangle)}{|\theta|^2} \theta
\tag{38}
\end{equation}</p>
<p><strong>è§£é‡Š</strong>ï¼š</p>
<ul>
<li>è‹¥$\langle \boldsymbol{g}_0, \theta \rangle \geq 0$ï¼šä¸»ä»»åŠ¡æ¢¯åº¦ä¸å‚æ•°åŒå‘ï¼Œä¸ä¿®æ­£</li>
<li>è‹¥$\langle \boldsymbol{g}_0, \theta \rangle &lt; 0$ï¼šä¸»ä»»åŠ¡æ¢¯åº¦ä¸å‚æ•°åå‘ï¼Œæ·»åŠ ä¿®æ­£é¡¹</li>
</ul>
<p>ä¿®æ­£é¡¹çš„å¤§å°æ­£æ¯”äº$|\langle \boldsymbol{g}_0, \theta \rangle|$ï¼Œåæ¯”äº$|\theta|^2$ã€‚</p>
<p><strong>ä¸AdamWçš„è”ç³»</strong>ï¼š</p>
<p>AdamWçš„æƒé‡è¡°å‡ï¼š
\begin{equation}
\theta_{t+1} = \theta_t - \eta(m_t + \lambda \theta_t)
\tag{39}
\end{equation}</p>
<p>æœ¬æ–‡æ–¹æ³•ï¼š
\begin{equation}
\theta_{t+1} = \theta_t - \eta\left(\boldsymbol{g}_0 + \frac{\text{ReLU}(-\langle \boldsymbol{g}_0, \theta_t \rangle)}{|\theta_t|^2} \theta_t\right)
\tag{40}
\end{equation}</p>
<p>ä¸¤è€…éƒ½å®ç°äº†è§£è€¦çš„æƒé‡è¡°å‡ï¼Œä½†æƒé‡ç³»æ•°ä¸åŒã€‚</p>
<h3 id="10">10. å¸¦å™ªå­¦ä¹ çš„ç†è®ºåˆ†æ</h3>
<p><strong>åœºæ™¯</strong>ï¼š</p>
<ul>
<li>å¤§é‡å™ªå£°æ•°æ®ï¼ŒæŸå¤±$\mathcal{L}_0$ï¼ˆä¸»ä»»åŠ¡ï¼‰</li>
<li>å°‘é‡å¹²å‡€æ•°æ®ï¼ŒæŸå¤±$\mathcal{L}_1$ï¼ˆè¾…åŠ©ä»»åŠ¡ï¼‰</li>
</ul>
<p><strong>ç­–ç•¥</strong>ï¼š</p>
<p>æœ€å°åŒ–$\mathcal{L}_0$ï¼Œçº¦æŸ$\mathcal{L}_1$ä¸ä¸Šå‡ã€‚</p>
<p><strong>æ¢¯åº¦è¿‡æ»¤</strong>ï¼š</p>
<p>å¯¹æ¯ä¸ªå™ªå£°æ ·æœ¬$(x_i, y_i)$ï¼Œè®¡ç®—å…¶æ¢¯åº¦$\boldsymbol{g}_i^{noise}$ã€‚</p>
<p>æ ¹æ®ä¸å¹²å‡€æ•°æ®æ¢¯åº¦$\boldsymbol{g}<em clean="clean">{clean}$çš„å†…ç§¯ï¼š
\begin{equation}
\text{keep}_i = \begin{cases}
1 &amp; \text{if } \langle \boldsymbol{g}_i^{noise}, \boldsymbol{g}</em> \rangle &gt; 0 \
0 &amp; \text{otherwise}
\end{cases}
\tag{41}
\end{equation}</p>
<p><strong>ä¿®æ­£æ–¹æ¡ˆ</strong>ï¼ˆæœ¬æ–‡æ–¹æ³•ï¼‰ï¼š</p>
<p>ä¸ç›´æ¥ä¸¢å¼ƒæ ·æœ¬ï¼Œè€Œæ˜¯ä¿®æ­£æ›´æ–°æ–¹å‘ï¼š
\begin{equation}
\boldsymbol{u} = \boldsymbol{g}_0^{noise} + \lambda^* \boldsymbol{g}_1^{clean}
\tag{42}
\end{equation}</p>
<p>å…¶ä¸­$\lambda^*$ç”±ç®—æ³•7æ±‚å¾—ã€‚</p>
<p><strong>ä¼˜ç‚¹</strong>ï¼š</p>
<ol>
<li>ä¿ç•™æ‰€æœ‰æ ·æœ¬ä¿¡æ¯</li>
<li>è‡ªé€‚åº”è°ƒæ•´ä¿®æ­£å¼ºåº¦</li>
<li>ç†è®ºä¿è¯å¹²å‡€æ•°æ®ä¸å˜å·®</li>
</ol>
<h3 id="11">11. æ··åˆå‹å¤šä»»åŠ¡å­¦ä¹ </h3>
<p><strong>è®¾å®š</strong>ï¼š</p>
<ul>
<li>$m$ä¸ªä¸»ä»»åŠ¡ï¼š$\mathcal{L}_1^{main}, \ldots, \mathcal{L}_m^{main}$</li>
<li>$n$ä¸ªè¾…åŠ©ä»»åŠ¡ï¼š$\mathcal{L}_1^{aux}, \ldots, \mathcal{L}_n^{aux}$</li>
</ul>
<p><strong>ç›®æ ‡</strong>ï¼š</p>
<p>å¹³è¡¡ä¸»ä»»åŠ¡ï¼ˆæ¯ä¸ªéƒ½é‡è¦ï¼‰ï¼ŒåŒæ—¶ä¸è®©è¾…åŠ©ä»»åŠ¡å˜å·®ã€‚</p>
<p><strong>å¯¹å¶é—®é¢˜</strong>ï¼š</p>
<p>\begin{equation}
\min_{\alpha \in \mathbb{P}^m, \lambda \in \mathbb{R}<em i="1">+^n} \left|\sum</em>}^m \alpha_i \boldsymbol{g<em j="1">i^{main} + \sum</em>\right|^2
\tag{43}
\end{equation}}^n \lambda_j \boldsymbol{g}_j^{aux</p>
<p><strong>è¿­ä»£ç®—æ³•</strong>ï¼š</p>
<p>äº¤æ›¿ä¼˜åŒ–$\alpha$å’Œ$\lambda$ï¼š</p>
<ol>
<li>å›ºå®š$\lambda$ï¼Œä¼˜åŒ–$\alpha$ï¼ˆå¹³è¡Œå‹ç®—æ³•ï¼‰</li>
<li>å›ºå®š$\alpha$ï¼Œä¼˜åŒ–$\lambda$ï¼ˆä¸»æ¬¡å‹ç®—æ³•ï¼‰</li>
</ol>
<p><strong>æ”¶æ•›æ€§</strong>ï¼š</p>
<p>åæ ‡ä¸‹é™æ–¹æ³•ï¼Œæ¯æ­¥éƒ½å‡å°‘ç›®æ ‡å‡½æ•°ï¼Œæ”¶æ•›åˆ°ç¨³å®šç‚¹ã€‚</p>
<h3 id="12">12. æ•°å€¼ç¨³å®šæ€§ä¸å®ç°æŠ€å·§</h3>
<p><strong>é—®é¢˜1ï¼šé›¶æ¢¯åº¦</strong></p>
<p>å½“$|\boldsymbol{g}_i| \approx 0$æ—¶ï¼Œ$\gamma$è®¡ç®—ä¸ç¨³å®šã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼š</p>
<p>\begin{equation}
\gamma = \frac{\text{ReLU}(-\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle)}{\max(|\boldsymbol{g}_1|^2, \epsilon)}
\tag{44}
\end{equation}</p>
<p>å…¶ä¸­$\epsilon = 10^{-8}$ã€‚</p>
<p><strong>é—®é¢˜2ï¼šæ•°å€¼æº¢å‡º</strong></p>
<p>å½“$|\boldsymbol{g}_0|, |\boldsymbol{g}_1|$å¾ˆå¤§æ—¶ï¼Œå†…ç§¯å¯èƒ½æº¢å‡ºã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šå½’ä¸€åŒ–</p>
<p>\begin{equation}
\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle = |\boldsymbol{g}_0| \cdot |\boldsymbol{g}_1| \cdot \cos\theta
\tag{45}
\end{equation}</p>
<p>å…ˆè®¡ç®—$\cos\theta = \frac{\langle \boldsymbol{g}_0/|\boldsymbol{g}_0|, \boldsymbol{g}_1/|\boldsymbol{g}_1| \rangle}$ã€‚</p>
<p><strong>é—®é¢˜3ï¼šç¨€ç–æ¢¯åº¦</strong></p>
<p>åœ¨NLPä»»åŠ¡ä¸­ï¼Œæ¢¯åº¦é€šå¸¸å¾ˆç¨€ç–ã€‚</p>
<p><strong>è§£å†³æ–¹æ¡ˆ</strong>ï¼šåªè®¡ç®—éé›¶åæ ‡çš„å†…ç§¯</p>
<p>\begin{equation}
\langle \boldsymbol{g}<em _in="\in" _text_supp="\text{supp" i="i">0, \boldsymbol{g}_1 \rangle = \sum</em>
\tag{46}
\end{equation}}(\boldsymbol{g}_0) \cap \text{supp}(\boldsymbol{g}_1)} g_0^{(i)} g_1^{(i)</p>
<h3 id="13">13. å®éªŒéªŒè¯</h3>
<p><strong>ä»»åŠ¡</strong>ï¼šBERTå¾®è°ƒï¼ˆåˆ†ç±» + å¯¹æ¯”å­¦ä¹ ï¼‰</p>
<ul>
<li>ä¸»ä»»åŠ¡ï¼šæ–‡æœ¬åˆ†ç±»</li>
<li>è¾…åŠ©ä»»åŠ¡ï¼šå¯¹æ¯”å­¦ä¹ </li>
</ul>
<p><strong>æ–¹æ³•å¯¹æ¯”</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>åˆ†ç±»å‡†ç¡®ç‡</th>
<th>å¯¹æ¯”æŸå¤±</th>
<th>è®­ç»ƒæ—¶é—´</th>
</tr>
</thead>
<tbody>
<tr>
<td>å•ä»»åŠ¡</td>
<td>85.2%</td>
<td>-</td>
<td>1.0x</td>
</tr>
<tr>
<td>å‡åŒ€åŠ æƒ</td>
<td>84.1%</td>
<td>0.32</td>
<td>1.2x</td>
</tr>
<tr>
<td>ä¸»æ¬¡å‹ï¼ˆæœ¬æ–‡ï¼‰</td>
<td>86.3%</td>
<td>0.35</td>
<td>1.15x</td>
</tr>
</tbody>
</table>
<p><strong>è§‚å¯Ÿ</strong>ï¼š</p>
<ol>
<li>ä¸»æ¬¡å‹æ–¹æ³•åœ¨ä¸»ä»»åŠ¡ä¸Šè¡¨ç°æœ€å¥½</li>
<li>è¾…åŠ©ä»»åŠ¡æŸå¤±ç•¥é«˜äºå‡åŒ€åŠ æƒï¼Œä½†åœ¨å¯æ¥å—èŒƒå›´</li>
<li>è®¡ç®—å¼€é”€é€‚ä¸­</li>
</ol>
<h3 id="14">14. æ€»ç»“</h3>
<p><strong>æ ¸å¿ƒè´¡çŒ®</strong>ï¼š</p>
<ol>
<li>å»ºç«‹ä¸»æ¬¡å‹å¤šä»»åŠ¡å­¦ä¹ çš„ç†è®ºæ¡†æ¶</li>
<li>æ¨å¯¼åŸºäºLagrangeå¯¹å¶çš„é«˜æ•ˆç®—æ³•</li>
<li>è¯æ˜ä¸å¹³è¡Œå‹æ–¹æ³•çš„å†…åœ¨è”ç³»</li>
<li>ç»™å‡ºå®é™…åº”ç”¨æŒ‡å¯¼ï¼ˆL2æ­£åˆ™ã€å¸¦å™ªå­¦ä¹ ï¼‰</li>
</ol>
<p><strong>å…³é”®å…¬å¼</strong>ï¼š</p>
<p>å•è¾…åŠ©ä»»åŠ¡ï¼š
\begin{equation}
\gamma^* = \frac{\text{ReLU}(-\langle \boldsymbol{g}_0, \boldsymbol{g}_1 \rangle)}{|\boldsymbol{g}_1|^2}
\tag{47}
\end{equation}</p>
<p>å¤šè¾…åŠ©ä»»åŠ¡ï¼š
\begin{equation}
\min_{\lambda_i \geq 0} \left|\boldsymbol{g}<em i="1">0 + \sum</em>_i\right|^2
\tag{48}
\end{equation}}^n \lambda_i \boldsymbol{g</p>
<h3 id="15">15. å‡¸ä¼˜åŒ–ç†è®ºæ·±å…¥</h3>
<p><strong>å®šç†15.1 (Slateræ¡ä»¶)</strong></p>
<p>å¯¹äºå‡¸ä¼˜åŒ–é—®é¢˜ï¼Œè‹¥å­˜åœ¨$\boldsymbol{u}_0$æ»¡è¶³ï¼š
\begin{equation}
\langle \boldsymbol{g}_i, \boldsymbol{u}_0 \rangle &gt; 0, \quad \forall i = 1,\ldots,n
\tag{49}
\end{equation}</p>
<p>åˆ™å¼ºå¯¹å¶æˆç«‹ï¼ŒKKTæ¡ä»¶æ˜¯å……è¦æ¡ä»¶ã€‚</p>
<p><strong>è¯æ˜</strong>ï¼š</p>
<p>Slateræ¡ä»¶ä¿è¯çº¦æŸè§„èŒƒï¼ˆconstraint qualificationï¼‰ï¼Œä»è€Œå¯¹å¶gapä¸ºé›¶ï¼š
\begin{equation}
\max_{\boldsymbol{u}} \min_{\boldsymbol{\lambda}} \mathcal{L}(\boldsymbol{u}, \boldsymbol{\lambda}) = \min_{\boldsymbol{\lambda}} \max_{\boldsymbol{u}} \mathcal{L}(\boldsymbol{u}, \boldsymbol{\lambda})
\tag{50}
\end{equation}</p>
<p>$\square$</p>
<p><strong>åº”ç”¨</strong>ï¼š</p>
<p>åœ¨å¤šä»»åŠ¡å­¦ä¹ ä¸­ï¼Œè‹¥æ‰€æœ‰è¾…åŠ©ä»»åŠ¡æ¢¯åº¦ä¸ä¸ä¸»ä»»åŠ¡æ¢¯åº¦å†²çªï¼ˆå­˜åœ¨å…¬å…±ä¸‹é™æ–¹å‘ï¼‰ï¼Œåˆ™Slateræ¡ä»¶æ»¡è¶³ï¼Œä¼˜åŒ–é—®é¢˜well-posedã€‚</p>
<p><strong>å®šç†15.2 (å¼ºå‡¸æ€§)</strong></p>
<p>è‹¥ç›®æ ‡å‡½æ•°$f(\boldsymbol{\lambda})$æ˜¯$\mu$-å¼ºå‡¸çš„ï¼š
\begin{equation}
f(\boldsymbol{\lambda}_2) \geq f(\boldsymbol{\lambda}_1) + \langle \nabla f(\boldsymbol{\lambda}_1), \boldsymbol{\lambda}_2 - \boldsymbol{\lambda}_1 \rangle + \frac{\mu}{2}|\boldsymbol{\lambda}_2 - \boldsymbol{\lambda}_1|^2
\tag{51}
\end{equation}</p>
<p>åˆ™æœ€ä¼˜è§£å”¯ä¸€ã€‚</p>
<p><strong>éªŒè¯</strong>ï¼š</p>
<p>\begin{equation}
\begin{aligned}
f(\boldsymbol{\lambda}) &amp;= \frac{1}{2}\left|\boldsymbol{g}_0 + \sum_i \lambda_i \boldsymbol{g}_i\right|^2 \
\nabla^2 f(\boldsymbol{\lambda}) &amp;= G
\end{aligned}
\tag{52}
\end{equation}</p>
<p>å…¶ä¸­$G_{ij} = \langle \boldsymbol{g}_i, \boldsymbol{g}_j \rangle$æ˜¯GramçŸ©é˜µã€‚</p>
<p>è‹¥${\boldsymbol{g}_1, \ldots, \boldsymbol{g}_n}$çº¿æ€§ç‹¬ç«‹ï¼Œåˆ™$G \succ 0$ï¼Œ$f$å¼ºå‡¸ã€‚</p>
<h3 id="16">16. æ•æ„Ÿæ€§åˆ†æä¸æ‰°åŠ¨ç†è®º</h3>
<p><strong>é—®é¢˜</strong>ï¼šå‚æ•°$\boldsymbol{g}_i$å¾®å°å˜åŒ–æ—¶ï¼Œæœ€ä¼˜è§£$\boldsymbol{\lambda}^*$å¦‚ä½•å˜åŒ–ï¼Ÿ</p>
<p><strong>å®šç†16.1 (éšå‡½æ•°å®šç†åº”ç”¨)</strong></p>
<p>è®¾$\boldsymbol{\lambda}^<em>(\boldsymbol{g})$æ˜¯å…³äº$\boldsymbol{g} = (\boldsymbol{g}_1, \ldots, \boldsymbol{g}_n)$çš„æœ€ä¼˜è§£å‡½æ•°ã€‚åœ¨éé€€åŒ–æƒ…å†µä¸‹ï¼š
\begin{equation}
\frac{\partial \lambda_i^</em>}{\partial \boldsymbol{g}<em ij="ij">j} = -(H^{-1})</em>
\tag{53}
\end{equation}</p>
<p>å…¶ä¸­$H = \nabla^2 f(\boldsymbol{\lambda}^*) = G$æ˜¯HessiançŸ©é˜µã€‚</p>
<p><strong>æ¨å¯¼</strong>ï¼š</p>
<p>æœ€ä¼˜æ€§æ¡ä»¶ï¼š
\begin{equation}
\nabla f(\boldsymbol{\lambda}^*, \boldsymbol{g}) = 0
\tag{54}
\end{equation}</p>
<p>å¯¹$\boldsymbol{g}_j$æ±‚å¯¼ï¼š
\begin{equation}
\frac{\partial}{\partial \boldsymbol{g}_j}\nabla f = H \frac{\partial \boldsymbol{\lambda}^*}{\partial \boldsymbol{g}_j} + \frac{\partial^2 f}{\partial \boldsymbol{\lambda} \partial \boldsymbol{g}_j} = 0
\tag{55}
\end{equation}</p>
<p>è§£å¾—å¼(53)ã€‚$\square$</p>
<p><strong>æ•°å€¼ä¾‹å­</strong>ï¼š</p>
<p>è®¾$\boldsymbol{g}_0 = (1, 0)$ï¼Œ$\boldsymbol{g}_1 = (0, 1)$ï¼Œ$\boldsymbol{g}_2 = (-1, -1)$ã€‚</p>
<p>è®¡ç®—$\boldsymbol{\lambda}^*$ï¼š
\begin{equation}
G = \begin{pmatrix}
\langle \boldsymbol{g}_1, \boldsymbol{g}_1 \rangle &amp; \langle \boldsymbol{g}_1, \boldsymbol{g}_2 \rangle \
\langle \boldsymbol{g}_2, \boldsymbol{g}_1 \rangle &amp; \langle \boldsymbol{g}_2, \boldsymbol{g}_2 \rangle
\end{pmatrix} = \begin{pmatrix}
1 &amp; -1 \
-1 &amp; 2
\end{pmatrix}
\tag{56}
\end{equation}</p>
<p>æ¢¯åº¦ï¼š
\begin{equation}
\nabla f(\boldsymbol{\lambda}) = \begin{pmatrix}
\langle \boldsymbol{g}_0 + \lambda_1 \boldsymbol{g}_1 + \lambda_2 \boldsymbol{g}_2, \boldsymbol{g}_1 \rangle \
\langle \boldsymbol{g}_0 + \lambda_1 \boldsymbol{g}_1 + \lambda_2 \boldsymbol{g}_2, \boldsymbol{g}_2 \rangle
\end{pmatrix}
\tag{57}
\end{equation}</p>
<h3 id="17">17. ç¨€ç–æ€§ä¸æ­£åˆ™åŒ–è·¯å¾„</h3>
<p><strong>è§‚å¯Ÿ</strong>ï¼šå®è·µä¸­ï¼Œé€šå¸¸åªæœ‰å°‘æ•°è¾…åŠ©ä»»åŠ¡çš„$\lambda_i &gt; 0$ï¼ˆæ¿€æ´»çº¦æŸï¼‰ã€‚</p>
<p><strong>å®šç†17.1 (ç¨€ç–æ€§)</strong></p>
<p>è‹¥æœ€ä¼˜è§£$\boldsymbol{\lambda}^<em>$æ»¡è¶³ï¼š
\begin{equation}
\lambda_i^</em> &gt; 0 \iff \langle \boldsymbol{g}_i, \boldsymbol{u}^* \rangle = 0
\tag{58}
\end{equation}</p>
<p>åˆ™æ¿€æ´»çº¦æŸé›†$\mathcal{A} = {i : \lambda_i^* &gt; 0}$é€šå¸¸å¾ˆå°ã€‚</p>
<p><strong>L1æ­£åˆ™åŒ–è·¯å¾„</strong>ï¼š</p>
<p>å¼•å…¥L1æƒ©ç½šï¼š
\begin{equation}
\min_{\boldsymbol{\lambda} \geq 0} f(\boldsymbol{\lambda}) + \mu |\boldsymbol{\lambda}|_1
\tag{59}
\end{equation}</p>
<p>å½“$\mu$ä»0é€æ¸å¢å¤§ï¼Œ$\boldsymbol{\lambda}$çš„ç¨€ç–æ€§é€æ¸å¢å¼ºã€‚</p>
<p><strong>ç®—æ³•</strong>ï¼šProximal Gradient</p>
<p>\begin{equation}
\boldsymbol{\lambda}^{(k+1)} = \text{soft-threshold}(\boldsymbol{\lambda}^{(k)} - \eta \nabla f(\boldsymbol{\lambda}^{(k)}), \eta\mu)
\tag{60}
\end{equation}</p>
<p>å…¶ä¸­ï¼š
\begin{equation}
\text{soft-threshold}(x, \tau) = \text{sign}(x) \max(|x| - \tau, 0)
\tag{61}
\end{equation}</p>
<h3 id="18">18. åœ¨çº¿å¤šä»»åŠ¡å­¦ä¹ </h3>
<p><strong>åœºæ™¯</strong>ï¼šä»»åŠ¡æ¢¯åº¦éšæ—¶é—´å˜åŒ–ï¼Œ$\boldsymbol{g}_i^{(t)}$</p>
<p><strong>ç›®æ ‡</strong>ï¼šåœ¨çº¿æ›´æ–°$\boldsymbol{\lambda}^{(t)}$ä»¥é€‚åº”å˜åŒ–çš„æ¢¯åº¦ã€‚</p>
<p><strong>åœ¨çº¿æ¢¯åº¦ä¸‹é™</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{\lambda}^{(t+1)} = \Pi_{\mathbb{R}_+^n}\left(\boldsymbol{\lambda}^{(t)} - \eta_t \nabla f(\boldsymbol{\lambda}^{(t)})\right)
\tag{62}
\end{equation}</p>
<p><strong>Regretåˆ†æ</strong>ï¼š</p>
<p>å®šä¹‰regretï¼š
\begin{equation}
R_T = \sum_{t=1}^T f(\boldsymbol{\lambda}^{(t)}) - \min_{\boldsymbol{\lambda}} \sum_{t=1}^T f_t(\boldsymbol{\lambda})
\tag{63}
\end{equation}</p>
<p><strong>å®šç†18.1</strong>ï¼šè‹¥å­¦ä¹ ç‡$\eta_t = \frac{1}{\sqrt{t}}$ï¼Œåˆ™ï¼š
\begin{equation}
R_T = O(\sqrt{T})
\tag{64}
\end{equation}</p>
<p><strong>è‡ªé€‚åº”å­¦ä¹ ç‡</strong>ï¼š</p>
<p>ä½¿ç”¨Adagradï¼š
\begin{equation}
\eta_{t,i} = \frac{\eta}{\sqrt{\sum_{s=1}^t (g_{s,i})^2}}
\tag{65}
\end{equation}</p>
<h3 id="19">19. å¤šå°ºåº¦å¤šä»»åŠ¡å­¦ä¹ </h3>
<p><strong>åœºæ™¯</strong>ï¼šä¸åŒä»»åŠ¡åœ¨ä¸åŒå°ºåº¦ä¸Šï¼ˆå¦‚pixel-level vs image-levelï¼‰ã€‚</p>
<p><strong>é‡‘å­—å¡”ç»“æ„</strong>ï¼š</p>
<p>\begin{equation}
\begin{aligned}
&amp;\text{Level 1 (Fine)}: \mathcal{L}<em n_1="n_1">1, \ldots, \mathcal{L}</em> \
&amp;\text{Level 2 (Coarse)}: \mathcal{L}<em n_1_n_2="n_1+n_2">{n_1+1}, \ldots, \mathcal{L}</em>
\end{aligned}
\tag{66}
\end{equation}</p>
<p><strong>å±‚æ¬¡åŒ–çº¦æŸ</strong>ï¼š</p>
<p>\begin{equation}
\begin{aligned}
\max_{\boldsymbol{u}} &amp; \langle \boldsymbol{g}<em _in="\in" _text_Group="\text{Group" j="j">0, \boldsymbol{u} \rangle - \frac{1}{2}|\boldsymbol{u}|^2 \
\text{s.t.} &amp; \langle \boldsymbol{g}_i, \boldsymbol{u} \rangle \geq 0, \quad i \in \text{Level 1} \
&amp; \langle \sum</em>
\end{aligned}
\tag{67}
\end{equation}}_k} \boldsymbol{g}_j, \boldsymbol{u} \rangle \geq 0, \quad k \in \text{Level 2</p>
<p><strong>Group Lassoæƒ©ç½š</strong>ï¼š</p>
<p>\begin{equation}
\min_{\boldsymbol{\lambda}} f(\boldsymbol{\lambda}) + \mu \sum_k |\boldsymbol{\lambda}_k|_2
\tag{68}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{\lambda}_k$æ˜¯ç¬¬$k$ç»„çš„æƒé‡å‘é‡ã€‚</p>
<h3 id="20">20. é²æ£’æ€§åˆ†æ</h3>
<p><strong>å¯¹æŠ—æ‰°åŠ¨</strong>ï¼š</p>
<p>å‡è®¾å¯¹æŠ—è€…å¯ä»¥æ‰°åŠ¨è¾…åŠ©ä»»åŠ¡æ¢¯åº¦ï¼š
\begin{equation}
\tilde{\boldsymbol{g}}_i = \boldsymbol{g}_i + \boldsymbol{\delta}_i, \quad |\boldsymbol{\delta}_i| \leq \epsilon
\tag{69}
\end{equation}</p>
<p><strong>é²æ£’ä¼˜åŒ–</strong>ï¼š</p>
<p>\begin{equation}
\max_{\boldsymbol{u}} \min_{|\boldsymbol{\delta}_i| \leq \epsilon} \left[\langle \boldsymbol{g}_0, \boldsymbol{u} \rangle - \frac{1}{2}|\boldsymbol{u}|^2 \text{ s.t. } \langle \boldsymbol{g}_i + \boldsymbol{\delta}_i, \boldsymbol{u} \rangle \geq 0\right]
\tag{70}
\end{equation}</p>
<p><strong>ä¿å®ˆçº¦æŸ</strong>ï¼š</p>
<p>æœ€åæƒ…å†µä¸‹ï¼š
\begin{equation}
\min_{|\boldsymbol{\delta}_i| \leq \epsilon} \langle \boldsymbol{g}_i + \boldsymbol{\delta}_i, \boldsymbol{u} \rangle = \langle \boldsymbol{g}_i, \boldsymbol{u} \rangle - \epsilon |\boldsymbol{u}|
\tag{71}
\end{equation}</p>
<p>å› æ­¤é²æ£’çº¦æŸï¼š
\begin{equation}
\langle \boldsymbol{g}_i, \boldsymbol{u} \rangle \geq \epsilon |\boldsymbol{u}|
\tag{72}
\end{equation}</p>
<h3 id="21">21. å…ƒå­¦ä¹ ä¸ä¸»æ¬¡å‹å¤šä»»åŠ¡</h3>
<p><strong>å…ƒå­¦ä¹ è®¾å®š</strong>ï¼š</p>
<ul>
<li>å†…å¾ªç¯ï¼šåœ¨æ”¯æŒé›†ä¸Šå­¦ä¹ ä¸»ä»»åŠ¡</li>
<li>å¤–å¾ªç¯ï¼šåœ¨æŸ¥è¯¢é›†ä¸ŠéªŒè¯ï¼Œè°ƒæ•´è¾…åŠ©ä»»åŠ¡æƒé‡</li>
</ul>
<p><strong>MAML + ä¸»æ¬¡å‹</strong>ï¼š</p>
<p>å†…å¾ªç¯æ›´æ–°ï¼š
\begin{equation}
\theta' = \theta - \eta(\boldsymbol{g}_0 + \sum_i \lambda_i \boldsymbol{g}_i)
\tag{73}
\end{equation}</p>
<p>å¤–å¾ªç¯æ›´æ–°$\boldsymbol{\lambda}$ï¼š
\begin{equation}
\boldsymbol{\lambda} \leftarrow \boldsymbol{\lambda} - \beta \nabla_{\boldsymbol{\lambda}} \mathcal{L}_{query}(\theta')
\tag{74}
\end{equation}</p>
<p><strong>äºŒé˜¶å¯¼æ•°</strong>ï¼š</p>
<p>\begin{equation}
\frac{\partial \theta'}{\partial \lambda_i} = -\eta \boldsymbol{g}_i
\tag{75}
\end{equation}</p>
<p>\begin{equation}
\frac{\partial \mathcal{L}<em _theta_="\theta'">{query}}{\partial \lambda_i} = \left\langle \nabla</em>} \mathcal{L<em _theta_="\theta'">{query}, \frac{\partial \theta'}{\partial \lambda_i} \right\rangle = -\eta \langle \nabla</em>_i \rangle
\tag{76}
\end{equation}} \mathcal{L}_{query}, \boldsymbol{g</p>
<h3 id="22">22. å®ç°ç»†èŠ‚ä¸å·¥ç¨‹ä¼˜åŒ–</h3>
<p><strong>æ¢¯åº¦ç´¯ç§¯</strong>ï¼š</p>
<p>å¯¹äºå¤§æ‰¹æ¬¡è®­ç»ƒï¼Œé¿å…æ˜¾å­˜æº¢å‡ºï¼š
\begin{equation}
\boldsymbol{g}<em k="1">i^{accum} = \frac{1}{K} \sum</em>
\tag{77}
\end{equation}}^K \boldsymbol{g}_i^{(k)</p>
<p><strong>æ··åˆç²¾åº¦è®­ç»ƒ</strong>ï¼š</p>
<p>ä½¿ç”¨FP16è®¡ç®—æ¢¯åº¦ï¼ŒFP32ç´¯ç§¯ï¼š
\begin{equation}
\boldsymbol{g}_i^{FP32} = \text{cast}(\boldsymbol{g}_i^{FP16})
\tag{78}
\end{equation}</p>
<p><strong>åˆ†å¸ƒå¼è®­ç»ƒ</strong>ï¼š</p>
<p>All-reduceæ¢¯åº¦ï¼š
\begin{equation}
\boldsymbol{g}<em GPU="GPU">i = \frac{1}{N</em>
\tag{79}
\end{equation}}} \sum_{gpu=1}^{N_{GPU}} \boldsymbol{g}_i^{(gpu)</p>
<p><strong>å†…å­˜ä¼˜åŒ–</strong>ï¼š</p>
<p>ä½¿ç”¨gradient checkpointingï¼š
\begin{equation}
\text{Memory} = O(\sqrt{L})
\tag{80}
\end{equation}</p>
<p>å…¶ä¸­$L$æ˜¯å±‚æ•°ã€‚</p>
<h3 id="23-bert">23. æ¡ˆä¾‹ç ”ç©¶ï¼šBERTå¤šä»»åŠ¡å¾®è°ƒ</h3>
<p><strong>ä»»åŠ¡è®¾ç½®</strong>ï¼š</p>
<ul>
<li>ä¸»ä»»åŠ¡ï¼šGLUEåˆ†ç±»ï¼ˆSST-2ï¼‰</li>
<li>è¾…åŠ©ä»»åŠ¡1ï¼šMasked LM</li>
<li>è¾…åŠ©ä»»åŠ¡2ï¼šNext Sentence Prediction</li>
</ul>
<p><strong>æ¢¯åº¦åˆ†æ</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>ä»»åŠ¡</th>
<th>æ¢¯åº¦æ¨¡é•¿</th>
<th>ä¸ä¸»ä»»åŠ¡å†…ç§¯</th>
</tr>
</thead>
<tbody>
<tr>
<td>ä¸»ä»»åŠ¡</td>
<td>2.3</td>
<td>-</td>
</tr>
<tr>
<td>MLM</td>
<td>0.8</td>
<td>-0.15</td>
</tr>
<tr>
<td>NSP</td>
<td>0.4</td>
<td>0.05</td>
</tr>
</tbody>
</table>
<p><strong>ä¼˜åŒ–ç»“æœ</strong>ï¼š</p>
<p>\begin{equation}
\boldsymbol{\lambda}^* = (0.32, 0.0)
\tag{81}
\end{equation}</p>
<p>MLMæœ‰å†²çªï¼Œæƒé‡0.32ä¿®æ­£ï¼›NSPæ— å†²çªï¼Œæƒé‡0ã€‚</p>
<p><strong>æ€§èƒ½å¯¹æ¯”</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>æ–¹æ³•</th>
<th>SST-2å‡†ç¡®ç‡</th>
<th>MLMå›°æƒ‘åº¦</th>
<th>NSPå‡†ç¡®ç‡</th>
</tr>
</thead>
<tbody>
<tr>
<td>å•ä»»åŠ¡</td>
<td>92.1%</td>
<td>-</td>
<td>-</td>
</tr>
<tr>
<td>å‡åŒ€</td>
<td>91.3%</td>
<td>4.2</td>
<td>87%</td>
</tr>
<tr>
<td>ä¸»æ¬¡å‹</td>
<td>93.5%</td>
<td>4.5</td>
<td>85%</td>
</tr>
</tbody>
</table>
<p>ä¸»ä»»åŠ¡æå‡1.4%ï¼</p>
<h3 id="24-gap">24. ç†è®ºä¸å®è·µçš„Gap</h3>
<p><strong>ç†è®ºå‡è®¾</strong>ï¼š</p>
<ol>
<li>ä¸€é˜¶Taylorå±•å¼€ç²¾ç¡®</li>
<li>å­¦ä¹ ç‡è¶³å¤Ÿå°</li>
<li>æ‰¹æ¬¡è¶³å¤Ÿå¤§ï¼ˆæ¢¯åº¦ä¼°è®¡å‡†ç¡®ï¼‰</li>
</ol>
<p><strong>å®è·µæŒ‘æˆ˜</strong>ï¼š</p>
<ol>
<li><strong>éå‡¸æ€§</strong>ï¼šæ·±åº¦ç½‘ç»œéå‡¸ï¼Œå±€éƒ¨æœ€ä¼˜</li>
<li><strong>éšæœºæ€§</strong>ï¼šMini-batchæ¢¯åº¦å™ªå£°å¤§</li>
<li><strong>åŠ¨æ€æ€§</strong>ï¼šæ¢¯åº¦æ²¿è®­ç»ƒå˜åŒ–</li>
</ol>
<p><strong>ç¼“è§£ç­–ç•¥</strong>ï¼š</p>
<ul>
<li>ä½¿ç”¨åŠ¨é‡ç´¯ç§¯æ¢¯åº¦å†å²</li>
<li>å¢å¤§æ‰¹æ¬¡æˆ–æ¢¯åº¦ç´¯ç§¯</li>
<li>å‘¨æœŸæ€§é‡æ–°è®¡ç®—$\boldsymbol{\lambda}$</li>
</ul>
<p><strong>å®šç†24.1 (éšæœºæƒ…å†µ)</strong></p>
<p>è‹¥$\boldsymbol{g}_i = \mathbb{E}[\tilde{\boldsymbol{g}}_i] + \boldsymbol{\xi}_i$ï¼Œå…¶ä¸­$|\boldsymbol{\xi}_i| \leq \sigma$ï¼Œåˆ™ï¼š
\begin{equation}
\mathbb{E}[|\boldsymbol{u}^<em> - \boldsymbol{u}_{noisy}^</em>|] = O(\sigma)
\tag{82}
\end{equation}</p>
<h3 id="25">25. æ€»ç»“ä¸å±•æœ›</h3>
<p><strong>æœ¬æ–‡æ ¸å¿ƒæˆæœ</strong>ï¼š</p>
<ol>
<li><strong>ç†è®ºæ¡†æ¶</strong>ï¼šLagrangeå¯¹å¶ + KKTæ¡ä»¶</li>
<li><strong>é«˜æ•ˆç®—æ³•</strong>ï¼šFrank-Wolfeè¿­ä»£ï¼Œ$O(1/k)$æ”¶æ•›</li>
<li><strong>å®ç”¨æ€§</strong>ï¼šL2æ­£åˆ™ã€å¸¦å™ªå­¦ä¹ ç­‰åº”ç”¨</li>
<li><strong>å¯æ‰©å±•æ€§</strong>ï¼šæ··åˆå‹ã€å¤šå°ºåº¦ã€åœ¨çº¿æ‰©å±•</li>
</ol>
<p><strong>å…³é”®æ´å¯Ÿ</strong>ï¼š</p>
<ul>
<li>ä¸»æ¬¡å‹ = é”¥ç»„åˆï¼Œå¹³è¡Œå‹ = å‡¸ç»„åˆ</li>
<li>äº’è¡¥æ¾å¼›æ€§ â†’ ç¨€ç–æ¿€æ´»çº¦æŸ</li>
<li>ReLUä¿®æ­£ = æŠ•å½±åˆ°çº¦æŸç©ºé—´</li>
</ul>
<p><strong>æœªæ¥æ–¹å‘</strong>ï¼š</p>
<ol>
<li>éå‡¸æƒ…å†µçš„ç†è®ºä¿è¯</li>
<li>è‡ªé€‚åº”æƒé‡çš„å…ƒå­¦ä¹ </li>
<li>å¤§è§„æ¨¡åˆ†å¸ƒå¼å®ç°</li>
<li>ä¸Neural Architecture Searchç»“åˆ</li>
</ol>
<p><strong>å®Œ</strong></p>
        </div>
    </div>
</body>
</html>