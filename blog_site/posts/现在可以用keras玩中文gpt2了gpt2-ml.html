<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç°åœ¨å¯ä»¥ç”¨Kerasç©ä¸­æ–‡GPT2äº†ï¼ˆGPT2_MLï¼‰</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç°åœ¨å¯ä»¥ç”¨Kerasç©ä¸­æ–‡GPT2äº†ï¼ˆGPT2_MLï¼‰</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-12-31 | ğŸ“„ å¤§å°: 8.9 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/7292">https://spaces.ac.cn/archives/7292</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>å‰æ®µæ—¶é—´ç•™æ„åˆ°æœ‰å¤§ç‰›å¼€æºäº†ä¸€ä¸ªä¸­æ–‡çš„GPT2æ¨¡å‹ï¼Œæ˜¯æœ€å¤§çš„15äº¿å‚æ•°è§„æ¨¡çš„ï¼Œçœ‹ä½œè€…ç»™çš„demoï¼Œç”Ÿæˆæ•ˆæœè¿˜æ˜¯è›®æƒŠè‰³çš„ï¼Œå°±æƒ³ç€åŠ è½½åˆ°è‡ªå·±çš„<a href="https://github.com/bojone/bert4keras">bert4keras</a>æ¥ç©ç©ã€‚ä¸è¿‡æ—©æœŸçš„bert4kerasæ•´ä½“æ¶æ„å†™å¾—æ¯”è¾ƒâ€œæ­»â€ï¼Œé›†æˆå¤šä¸ªä¸åŒçš„æ¨¡å‹å¾ˆä¸æ–¹ä¾¿ã€‚å‰ä¸¤å‘¨ç»ˆäºçœ‹ä¸ä¸‹å»äº†ï¼ŒæŠŠbert4kerasçš„æ•´ä½“ç»“æ„é‡å†™äº†ä¸€éï¼Œç°åœ¨çš„bert4kerasæ€»èƒ½ç®—æ¯”è¾ƒçµæ´»åœ°ç¼–å†™å„ç§Transformerç»“æ„çš„æ¨¡å‹äº†ï¼Œæ¯”å¦‚<strong>GPT2</strong> ã€<strong>T5</strong> ç­‰éƒ½å·²ç»é›†æˆåœ¨é‡Œè¾¹äº†ã€‚</p>
<h2 id="gpt2">GPT2ç§‘æ™®</h2>
<p>GPTï¼Œç›¸ä¿¡å¾ˆå¤šè¯»è€…éƒ½å¬è¯´è¿‡å®ƒäº†ï¼Œç®€å•æ¥è¯´ï¼Œå®ƒå°±æ˜¯ä¸€ä¸ªåŸºäºTransformerç»“æ„çš„è¯­è¨€æ¨¡å‹ï¼Œæºè‡ªè®ºæ–‡<a href="https://s3-us-west-2.amazonaws.com/openai-assets/research-covers/language-unsupervised/language_understanding_paper.pdf">ã€ŠGPTï¼šImproving Language Understanding by Generative Pre-Trainingã€‹</a>ï¼Œä½†å®ƒåˆä¸æ˜¯ä¸ºäº†åšè¯­è¨€æ¨¡å‹è€Œç”Ÿï¼Œå®ƒæ˜¯é€šè¿‡è¯­è¨€æ¨¡å‹æ¥é¢„è®­ç»ƒè‡ªèº«ï¼Œç„¶ååœ¨ä¸‹æ¸¸ä»»åŠ¡å¾®è°ƒï¼Œæé«˜ä¸‹æ¸¸ä»»åŠ¡çš„è¡¨ç°ã€‚å®ƒæ˜¯â€œTransformer + é¢„è®­ç»ƒ + å¾®è°ƒâ€è¿™ç§æ¨¡å¼çš„å…ˆé©±è€…ï¼Œç›¸å¯¹è€Œè¨€ï¼ŒBERTéƒ½ç®—æ˜¯å®ƒçš„â€œåè¾ˆâ€ï¼Œè€ŒGPT2ï¼Œåˆ™æ˜¯GPTçš„å‡çº§ç‰ˆâ€”â€”æ¨¡å‹æ›´å¤§ï¼Œè®­ç»ƒæ•°æ®æ›´å¤šâ€”â€”æ¨¡å‹æœ€å¤§ç‰ˆçš„å‚æ•°é‡è¾¾åˆ°äº†15äº¿ã€‚</p>
<h2 id="_1">ä¸­æ–‡ç‰ˆ</h2>
<p>çœ‹è¿‡GPT2çš„ç§‘æ™®æ¨æ–‡çš„è¯»è€…ï¼Œå¤šæ•°éƒ½ä¼šè¢«å®ƒçš„ç”Ÿæˆæ•ˆæœæ‰€æƒŠè‰³ã€‚ä¸è¿‡å†å¥½ä¹Ÿæ˜¯åˆ«äººå®¶çš„è¯­è¨€ï¼ŒOpenAIå¹¶æ²¡æœ‰å¸®å¿™è®­ç»ƒä¸­æ–‡ç‰ˆã€‚ä¸è¿‡å¥½æ¶ˆæ¯æ˜¯ï¼Œä¸€ä¸ªå«<a href="https://github.com/imcaspar/gpt2-ml">GPT2_ML</a>çš„é¡¹ç›®å¼€æºäº†ä¸€ä¸ªä¸­æ–‡ç‰ˆçš„GPT2ï¼Œè€Œä¸”è¿˜æ˜¯æœ€å¤§çš„15äº¿å‚æ•°çº§åˆ«çš„æ¨¡å‹ã€‚</p>
<p>ç›®å‰bert4kerasé›†æˆçš„GPT2ï¼Œæ­£æ˜¯GPT2_MLé¡¹ç›®ç»™å‡ºçš„ï¼Œè€Œä¸æ˜¯OpenAIçš„é‚£ä¸ªï¼Œæ¯•ç«Ÿbert4kerasä¼˜å…ˆæœåŠ¡ä¸­æ–‡ç‰ˆã€‚å€¼å¾—æŒ‡å‡ºçš„æ˜¯ï¼ŒGPT2_MLçš„æ¨¡å‹ç»“æ„ï¼Œè·ŸOpenAIç‰ˆçš„GPT2ç»“æ„å¹¶ä¸ä¸€æ ·ï¼Œä¹Ÿè·ŸBERTçš„ç»“æ„æœ‰æ‰€ä¸åŒï¼Œä¸‰è€…çš„Blockå¯¹æ¯”å¦‚ä¸‹ï¼š  </p>
<p><a href="/usr/uploads/2020/03/2257367993.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="å®˜æ–¹GPT2çš„Blockç¤ºæ„å›¾" src="/usr/uploads/2020/03/2257367993.png" /></a></p>
<p>å®˜æ–¹GPT2çš„Blockç¤ºæ„å›¾</p>
<p><a href="/usr/uploads/2020/03/3372936810.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="BERTçš„Blockç¤ºæ„å›¾" src="/usr/uploads/2020/03/3372936810.png" /></a></p>
<p>BERTçš„Blockç¤ºæ„å›¾</p>
<p><a href="/usr/uploads/2020/03/2373952967.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="GPT2_MLçš„Blockç¤ºæ„å›¾" src="/usr/uploads/2020/03/2373952967.png" /></a></p>
<p>GPT2_MLçš„Blockç¤ºæ„å›¾</p>
<h2 id="_2">æµ‹è¯•ä¸€ä¸‹</h2>
<p>é¦–å…ˆï¼Œä¸‹è½½æ¨¡å‹æƒé‡ï¼Œåœ°å€ä¸ºï¼š</p>
<blockquote>
<p>é“¾æ¥: <a href="https://pan.baidu.com/s/1OXBd16o82SpIzu57kwA8Mg">https://pan.baidu.com/s/1OXBd16o82SpIzu57kwA8Mg</a> æå–ç : q79r<br />
 å…¶ä¸­ï¼Œä¸»æ–‡ä»¶â€œmodel.ckpt-100000.data-00000-of-00001â€è¿˜å¯ä»¥ä»<a href="https://drive.google.com/file/d/1IzWpQ6I2IgfV7CldZvFJnZ9byNDZdO4n">Google Drive</a>ä¸‹è½½ã€‚ä¸‹è½½å®Œæˆåè¯·æ£€æŸ¥ä¸€ä¸‹model.ckpt-100000.data-00000-of-00001çš„SHA256ï¼ˆ4a6e5124df8db7ac2bdd902e6191b807a6983a7f5d09fb10ce011f9a073b183eï¼‰ã€‚ </p>
</blockquote>
<p>ç„¶åå®‰è£…ä¸ä½äº0.6.0ç‰ˆæœ¬çš„bert4kerasï¼ˆå½“å‰æœ€æ–°ç‰ˆï¼‰ï¼Œå°±å¯ä»¥è·‘ä¸‹è¿°æµ‹è¯•ä»£ç äº†ï¼ˆå¦‚æœå› ä¸ºç‰ˆæœ¬è¿­ä»£åŸå› å¯¼è‡´ä¸‹è¿°ä»£ç å·²ç»è¿‡æœŸï¼Œé‚£ä¹ˆè¯·åˆ° <a href="https://github.com/bojone/bert4keras/blob/master/examples/basic_language_model_gpt2_ml.py">basic_language_model_gpt2_ml.py</a> æŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬ï¼‰ï¼š</p>
<div class="codehilite"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="ch">#! -*- coding: utf-8 -*-</span>
<span class="c1"># åŸºæœ¬æµ‹è¯•ï¼šä¸­æ–‡GPT2æ¨¡å‹</span>
<span class="c1"># ä»‹ç»é“¾æ¥ï¼šhttps://kexue.fm/archives/7292</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bert4keras.models</span><span class="w"> </span><span class="kn">import</span> <span class="n">build_transformer_model</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bert4keras.tokenizers</span><span class="w"> </span><span class="kn">import</span> <span class="n">Tokenizer</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bert4keras.snippets</span><span class="w"> </span><span class="kn">import</span> <span class="n">AutoRegressiveDecoder</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">bert4keras.snippets</span><span class="w"> </span><span class="kn">import</span> <span class="n">uniout</span>


<span class="n">config_path</span> <span class="o">=</span> <span class="s1">&#39;/root/gpt2/config.json&#39;</span>
<span class="n">checkpoint_path</span> <span class="o">=</span> <span class="s1">&#39;/root/gpt2/model.ckpt-100000&#39;</span>
<span class="n">dict_path</span> <span class="o">=</span> <span class="s1">&#39;/root/gpt2/vocab.txt&#39;</span>

<span class="n">tokenizer</span> <span class="o">=</span> <span class="n">Tokenizer</span><span class="p">(</span><span class="n">dict_path</span><span class="p">,</span>
                      <span class="n">token_start</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">token_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">do_lower_case</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># å»ºç«‹åˆ†è¯å™¨</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">build_transformer_model</span><span class="p">(</span><span class="n">config_path</span><span class="o">=</span><span class="n">config_path</span><span class="p">,</span>
                                <span class="n">checkpoint_path</span><span class="o">=</span><span class="n">checkpoint_path</span><span class="p">,</span>
                                <span class="n">model</span><span class="o">=</span><span class="s1">&#39;gpt2_ml&#39;</span><span class="p">)</span>  <span class="c1"># å»ºç«‹æ¨¡å‹ï¼ŒåŠ è½½æƒé‡</span>


<span class="k">class</span><span class="w"> </span><span class="nc">ArticleCompletion</span><span class="p">(</span><span class="n">AutoRegressiveDecoder</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;åŸºäºéšæœºé‡‡æ ·çš„æ–‡ç« ç»­å†™</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nd">@AutoRegressiveDecoder</span><span class="o">.</span><span class="n">set_rtype</span><span class="p">(</span><span class="s1">&#39;probas&#39;</span><span class="p">)</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">,</span> <span class="n">output_ids</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
        <span class="n">token_ids</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">concatenate</span><span class="p">([</span><span class="n">inputs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">output_ids</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">token_ids</span><span class="p">)[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">topk</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
        <span class="n">token_ids</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="kp">random_sample</span><span class="p">([</span><span class="n">token_ids</span><span class="p">],</span> <span class="n">n</span><span class="p">,</span> <span class="n">topk</span><span class="p">)</span>  <span class="c1"># åŸºäºéšæœºé‡‡æ ·</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">text</span> <span class="o">+</span> <span class="n">tokenizer</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span> <span class="k">for</span> <span class="n">ids</span> <span class="ow">in</span> <span class="n">results</span><span class="p">]</span>


<span class="n">article_completion</span> <span class="o">=</span> <span class="n">ArticleCompletion</span><span class="p">(</span><span class="n">start_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                       <span class="n">end_id</span><span class="o">=</span><span class="mi">511</span><span class="p">,</span>  <span class="c1"># 511æ˜¯ä¸­æ–‡å¥å·</span>
                                       <span class="n">maxlen</span><span class="o">=</span><span class="mi">256</span><span class="p">,</span>
                                       <span class="n">minlen</span><span class="o">=</span><span class="mi">128</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">article_completion</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="sa">u</span><span class="s1">&#39;ä»Šå¤©å¤©æ°”ä¸é”™&#39;</span><span class="p">))</span>
</code></pre></div></td></tr></table></div>

<p>éƒ¨åˆ†ç»“æœï¼š</p>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>article_completion.generate(u'ä»Šå¤©å¤©æ°”ä¸é”™')<br />
 [u'ä»Šå¤©å¤©æ°”ä¸é”™ï¼Œå¯ä»¥å»è·‘æ­¥ã€‚æ˜¨æ™šçœ‹äº†ä¸€ä¸ªå…³äºè·‘æ­¥çš„çºªå½•ç‰‡ï¼Œé‡Œé¢çš„å¥³ä¸»è®²è¿°çš„æ˜¯ä¸€ä¸ªå¥³å­©å­çš„æˆé•¿ï¼Œå¾ˆåŠ±å¿—ï¼Œä¹Ÿå¾ˆç¾ä¸½ã€‚æˆ‘ä¹Ÿæƒ³è·‘ï¼Œä½†æ˜¯æˆ‘ä¸çŸ¥é“è·‘æ­¥è¦ç©¿è¿åŠ¨é‹ï¼Œæ‰€ä»¥å°±ä¹°äº†ä¸€åŒè¿åŠ¨é‹ã€‚è¿™ä¸ªçºªå½•ç‰‡æ˜¯å…³äºè¿åŠ¨é‹çš„ï¼Œæœ‰ä¸€ é›†è®²äº†ä¸€ä¸ªå¥³å­©å­ï¼Œä»å°å­¦å¼€å§‹å°±æ²¡æœ‰ç©¿è¿‡è¿åŠ¨é‹ï¼Œåˆ°äº†é«˜ä¸­æ‰å¼€å§‹å°è¯•è·‘æ­¥ã€‚']</p>
<p>article_completion.generate(u'åŒåä¸€')<br />
 [u'åŒåä¸€é©¬ä¸Šå°±è¦åˆ°äº†ï¼ä½ è¿˜åœ¨ä¸ºåŒ11çš„ç‰©æµé…é€è€Œæ‹…å¿ƒå—ï¼Ÿä½ è¿˜åœ¨ä¸ºæ²¡æ—¶é—´å»ä»“åº“å–è´§è€Œå‘æ„å—ï¼Ÿä½ è¿˜åœ¨ä¸ºä¸çŸ¥é“æ€ä¹ˆä¹°åˆ°ä¾¿å®œè´§è€Œå‘æ„å—ï¼Ÿä½ è¿˜åœ¨ä¸ºä¹°ä¸åˆ°å¿ƒä»ªçš„äº§å“è€Œæ‡Šæ¼å—ï¼Ÿé‚£ä¹ˆï¼ŒåŒåä¸€å°±æ¥äº†ï¼ä»Šå¤©å°ç¼–å¸¦ä½ æ¥çœ‹çœ‹è¿™äº› å¿«é€’ï¼Œéƒ½æ˜¯æ€ä¹ˆé€è´§çš„ï¼1. ç‰©æµé…é€å¿«é€’å…¬å¸çš„é…é€ï¼Œä¸»è¦æ˜¯ç”±å¿«é€’å…¬å¸è´Ÿè´£ï¼Œå¿«é€’å…¬å¸è´Ÿè´£æ´¾ä»¶ï¼Œç‰©æµæœåŠ¡ã€‚']</p>
<p>article_completion.generate(u'ç§‘å­¦ç©ºé—´')<br />
 [u'ç§‘å­¦ç©ºé—´ç«™ç§‘å­¦ç©ºé—´ç«™ï¼ˆè‹±æ–‡ï¼šscience space stationï¼‰ï¼Œæ˜¯ä¸­åäººæ°‘å…±å’Œå›½çš„ä¸€ä¸ªç©ºé—´ç«™ã€‚è¯¥ç©ºé—´ç«™æ˜¯ä¸­å›½ç§‘å­¦é™¢å¤§è¿ç‰©ç†ç ”ç©¶æ‰€ç ”åˆ¶ï¼Œä¸»è¦ç ”å‘å’Œä½¿ç”¨ä¸­å›½ç§‘å­¦é™¢å¤§è¿ç‰©ç†ç ”ç©¶æ‰€çš„æ ¸èƒ½åŠ¨åŠ›ç©ºé—´ç«™ã€‚ç§‘å­¦ç©ºé—´ç«™ä½äºåŒ—äº¬å¸‚æµ·æ·€åŒºï¼Œè·ç¦»åœ°é¢393ç±³ï¼Œæ€»å»ºç­‘é¢ç§¯çº¦ä¸º1ä¸‡å¹³æ–¹ç±³ï¼Œæ€»æŠ•èµ„çº¦ä¸º5äº¿å…ƒäººæ°‘å¸ã€‚ç§‘å­¦ç©ºé—´ç«™äº2018å¹´12æœˆ26æ—¥å¼€å§‹åŠ¨å·¥ï¼Œ2021å¹´6æœˆå»ºæˆå¹¶æŠ•å…¥ä½¿ç”¨ã€‚']</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p>æ˜¯ä¸æ˜¯æ„Ÿè§‰è¿˜æŒºå¥½çš„ï¼Ÿ</p>
<h2 id="finetune">æƒ³Finetuneï¼Ÿ</h2>
<p>çœ‹åˆ°è¿™æ•ˆæœï¼Œä¼°è®¡ä¸å°‘è¯»è€…çš„æƒ³æ³•å°±æ˜¯ï¼šæ€ä¹ˆç”¨åˆ°æˆ‘è‡ªå·±çš„æ¨¡å‹ä¸Šï¼Œèƒ½ä¸èƒ½åœ¨æˆ‘è‡ªå·±çš„ä»»åŠ¡ä¸Šfinetuneä¸€ä¸‹ï¼Ÿ</p>
<p>ä¸å¥½æ„æ€ï¼Œå‘Šè¯‰å¤§å®¶ä¸€ä¸ªæ¯”è¾ƒæ‚²è§‚çš„ç»“æœï¼šç¬”è€…ç”¨Adamä¼˜åŒ–å™¨åœ¨å…¬å¸çš„22Gæ˜¾å­˜çš„TITAN RTXä¸Šæµ‹è¯•finetuneè¿™ä¸ªå‚æ•°è§„æ¨¡æ¥è¿‘15äº¿çš„GPT2ï¼Œå‘ç°batch_size=1éƒ½æ²¡æ³•è·‘èµ·æ¥...æœ€åå‘ç°ï¼Œåªæœ‰åœ¨AdaFactorä¼˜åŒ–å™¨ä¸‹ï¼Œæ‰èƒ½Finetuneå¾—åŠ¨å®ƒã€‚</p>
<p>å…³äºAdaFactorï¼Œåé¢æœ‰æœºä¼šå†å†™æ–‡ç« è®¨è®ºã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/7292">https://spaces.ac.cn/archives/7292</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Mar. 16, 2020). ã€Šç°åœ¨å¯ä»¥ç”¨Kerasç©ä¸­æ–‡GPT2äº†ï¼ˆGPT2_MLï¼‰ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/7292">https://spaces.ac.cn/archives/7292</a></p>
<p>@online{kexuefm-7292,<br />
title={ç°åœ¨å¯ä»¥ç”¨Kerasç©ä¸­æ–‡GPT2äº†ï¼ˆGPT2_MLï¼‰},<br />
author={è‹å‰‘æ—},<br />
year={2020},<br />
month={Mar},<br />
url={\url{https://spaces.ac.cn/archives/7292}},<br />
} </p>
<hr />
<h2 id="_3">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>TODO: æ·»åŠ è¯¦ç»†çš„æ•°å­¦å…¬å¼æ¨å¯¼å’Œæ³¨é‡Š</p>
        </div>
    </div>
</body>
</html>