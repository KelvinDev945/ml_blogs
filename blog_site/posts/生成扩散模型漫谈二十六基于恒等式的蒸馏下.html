<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåå…­ï¼‰ï¼šåŸºäºæ’ç­‰å¼çš„è’¸é¦ï¼ˆä¸‹ï¼‰</title>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    line-height: 1.6; color: #333; max-width: 900px; margin: 0 auto; padding: 20px; background: #f5f5f5;
}
.container { background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
header { border-bottom: 2px solid #e0e0e0; padding-bottom: 20px; margin-bottom: 30px; }
h1 { color: #2c3e50; margin-bottom: 10px; font-size: 2em; }
.meta { color: #666; font-size: 0.9em; margin-bottom: 20px; }
.content { margin-top: 30px; overflow-wrap: break-word; }
.content h2 { color: #34495e; margin-top: 30px; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 5px; }
.content p { margin-bottom: 15px; }
.content pre { background: #f8f8f8; padding: 15px; border-radius: 5px; overflow-x: auto; border-left: 3px solid #3498db; margin: 15px 0; }
.content code { background: #f8f8f8; padding: 2px 5px; border-radius: 3px; font-family: monospace; font-size: 0.9em; }
.content blockquote { border-left: 4px solid #3498db; padding-left: 20px; margin: 20px 0; color: #555; font-style: italic; }
.content table { border-collapse: collapse; width: 100%; margin: 20px 0; }
.content th, .content td { border: 1px solid #ddd; padding: 10px; text-align: left; }
.back-link { display: inline-block; margin-bottom: 20px; color: #3498db; text-decoration: none; font-weight: 500; }
</style>
    
<script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\(', '\)']],
            displayMath: [['$$', '$$'], ['\[', '\]']],
            processEscapes: true
        }
    };
</script>
<script id="MathJax-script" async src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>

</head>
<body>
    <div class="container">
        <a href="../index.html" class="back-link">â† è¿”å›é¦–é¡µ</a>
        <header>
            <h1>ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåå…­ï¼‰ï¼šåŸºäºæ’ç­‰å¼çš„è’¸é¦ï¼ˆä¸‹ï¼‰</h1>
            <div class="meta">ğŸ“… æœ€åæ›´æ–°: 2025-11-26 | ğŸ“„ å¤§å°: 56.4 KB</div>
        </header>
        <div class="content">
            <p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/10567">https://spaces.ac.cn/archives/10567</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>ç»§ç»­å›åˆ°æˆ‘ä»¬çš„æ‰©æ•£ç³»åˆ—ã€‚åœ¨<a href="/archives/10085">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåäº”ï¼‰ï¼šåŸºäºæ’ç­‰å¼çš„è’¸é¦ï¼ˆä¸Šï¼‰ã€‹</a>ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†SiDï¼ˆScore identity Distillationï¼‰ï¼Œè¿™æ˜¯ä¸€ç§ä¸éœ€è¦çœŸå®æ•°æ®ã€ä¹Ÿä¸éœ€è¦ä»æ•™å¸ˆæ¨¡å‹é‡‡æ ·çš„æ‰©æ•£æ¨¡å‹è’¸é¦æ–¹æ¡ˆï¼Œå…¶å½¢å¼ç±»ä¼¼GANï¼Œä½†æœ‰ç€æ¯”GANæ›´å¥½çš„è®­ç»ƒç¨³å®šæ€§ã€‚</p>
<p>SiDçš„æ ¸å¿ƒæ˜¯é€šè¿‡æ’ç­‰å˜æ¢æ¥ä¸ºå­¦ç”Ÿæ¨¡å‹æ„å»ºæ›´å¥½çš„æŸå¤±å‡½æ•°ï¼Œè¿™ä¸€ç‚¹æ˜¯å¼€åˆ›æ€§çš„ï¼ŒåŒæ—¶ä¹Ÿé—ç•™äº†ä¸€äº›é—®é¢˜ã€‚æ¯”å¦‚ï¼ŒSiDå¯¹æŸå¤±å‡½æ•°çš„æ’ç­‰å˜æ¢æ˜¯ä¸å®Œå…¨çš„ï¼Œå¦‚æœå®Œå…¨å˜æ¢ä¼šå¦‚ä½•ï¼Ÿå¦‚ä½•ä»ç†è®ºä¸Šè§£é‡ŠSiDå¼•å…¥çš„$\lambda$çš„å¿…è¦æ€§ï¼Ÿä¸Šä¸ªæœˆæ”¾å‡ºçš„<a href="https://papers.cool/arxiv/2410.19310">ã€ŠFlow Generator Matchingã€‹</a>ï¼ˆç®€ç§°FGMï¼‰æˆåŠŸä»æ›´æœ¬è´¨çš„æ¢¯åº¦è§’åº¦è§£é‡Šäº†$\lambda=0.5$çš„é€‰æ‹©ï¼Œè€Œå—åˆ°FGMå¯å‘ï¼Œç¬”è€…åˆ™è¿›ä¸€æ­¥å‘ç°äº†$\lambda = 1$çš„ä¸€ç§è§£é‡Šã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†è¯¦ç»†ä»‹ç»SiDçš„ä¸Šè¿°ç†è®ºè¿›å±•ã€‚</p>
<h2 id="_1">æ€æƒ³å›é¡¾</h2>
<p>æ ¹æ®ä¸Šä¸€ç¯‡æ–‡ç« çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“SiDå®ç°è’¸é¦çš„æ€æƒ³æ˜¯â€œç›¸è¿‘çš„åˆ†å¸ƒï¼Œå®ƒä»¬è®­ç»ƒå‡ºæ¥çš„å»å™ªæ¨¡å‹ä¹Ÿæ˜¯ç›¸è¿‘çš„â€ï¼Œç”¨å…¬å¼è¡¨ç¤ºå°±æ˜¯<br />
\begin{align}<br />
&amp;\text{æ•™å¸ˆæ‰©æ•£æ¨¡å‹:}\quad\boldsymbol{\varphi}^<em> = \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\varphi}} \mathbb{E}</em><em _boldsymbol_varphi="\boldsymbol{\varphi">0\sim \tilde{p}(\boldsymbol{x}_0),\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\Vert\boldsymbol{\epsilon}</em> \\\[8pt]}}(\boldsymbol{x}_t,t) - \boldsymbol{\varepsilon}\Vert^2\right]\label{eq:tloss<br />
&amp;\text{å­¦ç”Ÿæ‰©æ•£æ¨¡å‹:}\quad\boldsymbol{\psi}^</em> = \mathop{\text{argmin}}<em _boldsymbol_z="\boldsymbol{z">{\boldsymbol{\psi}} \mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\Vert\boldsymbol{\epsilon<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{\psi}}(\boldsymbol{x}_t^{(g)},t) - \boldsymbol{\varepsilon}\Vert^2\right]\label{eq:dloss}\\\[8pt]<br />
&amp;\text{å­¦ç”Ÿç”Ÿæˆæ¨¡å‹:}\quad\boldsymbol{\theta}^<em> = \mathop{\text{argmin}}<em _boldsymbol_z="\boldsymbol{z">{\boldsymbol{\theta}} \underbrace{\mathbb{E}</em>^},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\Vert\boldsymbol{\epsilon}_{\boldsymbol{\varphi</em>}(\boldsymbol{x}_t^{(g)},t) - \boldsymbol{\epsilon}</em>}^*}(\boldsymbol{x<em _mathcal_L="\mathcal{L">t^{(g)},t)\Vert^2\right]}</em><em _boldsymbol_theta="\boldsymbol{\theta">1}\label{eq:gloss-1}<br />
\end{align}<br />
è¿™é‡Œè®°å·æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬é€ä¸€è§£é‡Šã€‚ç¬¬ä¸€ä¸ªæŸå¤±å‡½æ•°å°±æ˜¯æˆ‘ä»¬è¦è’¸é¦çš„æ‰©æ•£æ¨¡å‹çš„è®­ç»ƒç›®æ ‡ï¼Œå…¶ä¸­$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ä»£è¡¨åŠ å™ªæ ·æœ¬ï¼Œ$\bar{\alpha}_t,\bar{\beta}_t$æ˜¯noise scheduleï¼Œ$\boldsymbol{x}_0$æ˜¯è®­ç»ƒæ ·æœ¬ï¼›ç¬¬äºŒä¸ªæŸå¤±å‡½æ•°åˆ™æ˜¯ç”¨å­¦ç”Ÿæ¨¡å‹ç”Ÿæˆçš„æ•°æ®æ¥è®­ç»ƒçš„æ‰©æ•£æ¨¡å‹ï¼Œå…¶ä¸­$\boldsymbol{x}_t^{(g)}=\bar{\alpha}_t\boldsymbol{g}</em>}}(\boldsymbol{z}) + \bar{\beta<em _boldsymbol_theta="\boldsymbol{\theta">t\boldsymbol{\varepsilon}$ï¼Œè¿™é‡Œçš„$\boldsymbol{g}</em>$ï¼›ç¬¬ä¸‰ä¸ªæŸå¤±å‡½æ•°ï¼Œåˆ™æ˜¯è¯•å›¾é€šè¿‡æ‹‰è¿‘çœŸå®æ•°æ®å’Œå­¦ç”Ÿæ•°æ®æ‰€è®­ç»ƒçš„æ‰©æ•£æ¨¡å‹çš„å·®è·ï¼Œæ¥è®­ç»ƒå­¦ç”Ÿç”Ÿæˆæ¨¡å‹ï¼ˆç”Ÿæˆå™¨ï¼‰ã€‚}}(\boldsymbol{z})$ä»£è¡¨å­¦ç”Ÿæ¨¡å‹çš„ç”Ÿæˆæ ·æœ¬ï¼Œä¹Ÿè®°ä¸º$\boldsymbol{x}_0^{(g)</p>
<p>è¿™é‡Œçš„æ•™å¸ˆæ¨¡å‹æ˜¯å¯ä»¥æå‰è®­ç»ƒå¥½çš„ï¼Œè€Œä¸¤ä¸ªå­¦ç”Ÿæ¨¡å‹çš„è®­ç»ƒåªéœ€è¦æ•™å¸ˆæ¨¡å‹æœ¬èº«ï¼Œå¹¶ä¸éœ€è¦ç”¨åˆ°è®­ç»ƒæ•™å¸ˆæ¨¡å‹çš„æ•°æ®ï¼Œæ‰€ä»¥ä½œä¸ºä¸€ç§è’¸é¦æ–¹å¼æ¥çœ‹SiDæ˜¯data-freeçš„ï¼›ä¸¤ä¸ªå­¦ç”Ÿæ¨¡å‹åˆ™æ˜¯ç±»ä¼¼GANé‚£æ ·çš„äº¤æ›¿è®­ç»ƒï¼Œé€æ­¥æé«˜ç”Ÿæˆå™¨çš„ç”Ÿæˆè´¨é‡ã€‚å°±ç¬”è€…æ‰€é˜…è¯»è¿‡çš„æ–‡çŒ®æ¥çœ‹ï¼Œè¿™ç§è®­ç»ƒæ€æƒ³æœ€æ—©å‡ºè‡ªè®ºæ–‡<a href="https://papers.cool/arxiv/2001.02728">ã€ŠLearning Generative Models using Denoising Density Estimatorsã€‹</a>ï¼Œæˆ‘ä»¬åœ¨<a href="/archives/7038">ã€Šä»å»å™ªè‡ªç¼–ç å™¨åˆ°ç”Ÿæˆæ¨¡å‹ã€‹</a>ä¹Ÿæœ‰è¿‡ç›¸å…³ä»‹ç»ã€‚</p>
<p>ç„¶è€Œï¼Œå°½ç®¡çœ‹ä¸Šå»æ²¡ä»€ä¹ˆæ¯›ç—…ï¼Œä½†å®é™…æƒ…å†µæ˜¯å¼$\eqref{eq:dloss}$å’Œå¼$\eqref{eq:gloss-1}$çš„äº¤æ›¿è®­ç»ƒéå¸¸å®¹æ˜“å´©æºƒï¼Œä»¥è‡³äºå‡ ä¹ä¸èƒ½å‡ºæ•ˆæœã€‚è¿™æ˜¯å› ä¸ºç†è®ºå’Œå®è·µä¸Šçš„ä¸¤ä¸ªgapï¼š</p>
<blockquote>
<p>1ã€ç†è®ºä¸Šè¦æ±‚å…ˆæ±‚å‡ºå¼$\eqref{eq:dloss}$çš„æœ€ä¼˜è§£ï¼Œç„¶åæ‰å»ä¼˜åŒ–å¼$\eqref{eq:gloss-1}$ï¼Œä½†å®é™…ä¸Šä»è®­ç»ƒæˆæœ¬è€ƒè™‘ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å°†å®ƒè®­ç»ƒåˆ°æœ€ä¼˜å°±å»ä¼˜åŒ–å¼$\eqref{eq:gloss-1}$äº†ï¼›</p>
<p>2ã€ç†è®ºä¸Š$\boldsymbol{\psi}^<em>$éš$\boldsymbol{\theta}$è€Œå˜ï¼Œå³åº”è¯¥å†™æˆ$\boldsymbol{\psi}^</em>(\boldsymbol{\theta})$ï¼Œä»è€Œåœ¨ä¼˜åŒ–å¼$\eqref{eq:gloss-1}$æ—¶åº”è¯¥å¤šå‡ºä¸€é¡¹$\boldsymbol{\psi}^<em>(\boldsymbol{\theta})$å¯¹$\boldsymbol{\theta}$çš„æ¢¯åº¦ï¼Œä½†å®é™…ä¸Šåœ¨ä¼˜åŒ–å¼$\eqref{eq:gloss-1}$æ—¶æˆ‘ä»¬éƒ½åªå½“$\boldsymbol{\psi}^</em>$æ˜¯å¸¸æ•°ã€‚</p>
</blockquote>
<p>ç¬¬1ä¸ªé—®é¢˜å…¶å®è¿˜å¥½ï¼Œå› ä¸ºéšç€è®­ç»ƒçš„æ¨è¿›$\boldsymbol{\psi}$æ€»èƒ½æ…¢æ…¢é€¼è¿‘ç†è®ºæœ€ä¼˜çš„$\boldsymbol{\psi}^*$ï¼Œä½†ç¬¬2ä¸ªé—®é¢˜éå¸¸å›°éš¾ä¸”æœ¬è´¨ï¼Œå¯ä»¥è¯´GANçš„è®­ç»ƒä¸ç¨³å®šæ€§åŒæ ·ä¹Ÿæœ‰è¿™ä¸ªé—®é¢˜çš„â€œåŠŸåŠ³â€ã€‚è€ŒSiDå’ŒFGMçš„æ ¸å¿ƒè´¡çŒ®ï¼Œæ­£æ˜¯è¯•å›¾è§£å†³ç¬¬2ä¸ªé—®é¢˜ã€‚</p>
<h2 id="_2">æ’ç­‰å˜æ¢</h2>
<p>SiDçš„æƒ³æ³•æ˜¯é€šè¿‡æ’ç­‰å˜æ¢æ¥å‡å°‘ç”Ÿæˆå™¨æŸå¤±å‡½æ•°$\eqref{eq:gloss-1}$å¯¹$\boldsymbol{\psi}^*$çš„ä¾èµ–ï¼Œä»è€Œå¼±åŒ–ç¬¬2ä¸ªé—®é¢˜ã€‚è¿™ä¸€æƒ³æ³•ç¡®å®æ˜¯å¼€åˆ›æ€§çš„ï¼Œåé¢å·²ç»æœ‰ä¸å°‘å·¥ä½œå›´ç»•ç€SiDå±•å¼€ï¼ŒåŒ…æ‹¬ä¸‹é¢è¦ä»‹ç»çš„FGMä¹Ÿç®—æ˜¯å…¶ä¸­ä¹‹ä¸€ã€‚</p>
<p>æ’ç­‰å˜æ¢çš„æ ¸å¿ƒï¼Œæ˜¯å¦‚ä¸‹æ’ç­‰å¼ï¼š<br />
\begin{equation}\mathbb{E}<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{x}_0\sim \tilde{p}(\boldsymbol{x}_0),\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t,t)\right\rangle\right] = \mathbb{E}</em><em _boldsymbol_varphi="\boldsymbol{\varphi">0\sim \tilde{p}(\boldsymbol{x}_0),\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\varepsilon}\right\rangle\right]\label{eq:id}\end{equation}<br />
ç®€å•æ¥è¯´å°±æ˜¯$\boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}<em _boldsymbol_varphi="\boldsymbol{\varphi">t,t)$å¯ä»¥æ›¿æ¢æˆ$\boldsymbol{\varepsilon}$ã€‚è¿™é‡Œçš„$\boldsymbol{\epsilon}</em>}^*}(\boldsymbol{x<em>t,t)$æ˜¯å¼$\eqref{eq:tloss}$çš„ç†è®ºæœ€ä¼˜è§£ï¼Œè€Œ$\boldsymbol{f}(\boldsymbol{x}_t,t)$æ˜¯ä»»æ„ _åªä¾èµ–äº$\boldsymbol{x}_t$å’Œ$t$</em> çš„å‘é‡å‡½æ•°ã€‚æ³¨æ„â€œåªä¾èµ–äº$\boldsymbol{x}_t$å’Œ$t$â€æ˜¯æ’ç­‰å¼æˆç«‹çš„å¿…è¦æ¡ä»¶ï¼Œä¸€æ—¦$\boldsymbol{f}$æºæ‚äº†ç‹¬ç«‹çš„$\boldsymbol{x}_0$æˆ–$\boldsymbol{\varepsilon}$ï¼Œé‚£ä¹ˆæ’ç­‰å¼å°±æœªå¿…æˆç«‹äº†ï¼Œæ‰€ä»¥åº”ç”¨è¯¥æ’ç­‰å¼ä¹‹å‰éœ€è¦ä»”ç»†æ£€æŸ¥è¿™ä¸€ç‚¹ã€‚</p>
<p>ä¸Šä¸€ç¯‡æ–‡ç« æˆ‘ä»¬å·²ç»ç»™å‡ºäº†è¯¥æ’ç­‰å¼çš„è¯æ˜ï¼Œä¸è¿‡ç°åœ¨çœ‹æ¥é‚£ä¸ªè¯æ˜æ˜¾å¾—æœ‰ç‚¹è¿‚å›ï¼Œè¿™é‡Œç»™å‡ºä¸€ä¸ªæ›´ç›´æ¥ç‚¹çš„è¯æ˜ï¼š</p>
<blockquote>
<p><strong>è¯æ˜ï¼š</strong> å°†ç›®æ ‡$\eqref{eq:tloss}$ç­‰ä»·åœ°æ”¹å†™æˆ<br />
 \begin{equation}\boldsymbol{\varphi}^<em> = \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\varphi}} \mathbb{E}</em><em _boldsymbol_varepsilon="\boldsymbol{\varepsilon">t\sim p(\boldsymbol{x}_t)}\Big[\mathbb{E}</em>}\sim p(\boldsymbol{\varepsilon}|\boldsymbol{x<em _boldsymbol_varphi="\boldsymbol{\varphi">t)}\left[\Vert\boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_mu="\boldsymbol{\mu">t,t) - \boldsymbol{\varepsilon}\Vert^2\right]\Big]\end{equation}<br />
 æ ¹æ®$\mathbb{E}[\boldsymbol{x}] = \mathop{\text{argmin}}\limits</em>}}\mathbb{E<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{x}}\left[\Vert \boldsymbol{\mu} - \boldsymbol{x}\Vert^2\right]$ï¼ˆä¸ç†Ÿæ‚‰å¯ä»¥æ±‚å¯¼è¯ä¸€ä¸‹ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºä¸Šå¼çš„ç†è®ºæœ€ä¼˜è§£æ˜¯<br />
 \begin{equation}\boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}<em _boldsymbol_varepsilon="\boldsymbol{\varepsilon">t,t) = \mathbb{E}</em>}\sim p(\boldsymbol{\varepsilon}|\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t)}[\boldsymbol{\varepsilon}]\end{equation}<br />
 æ‰€ä»¥<br />
 \begin{equation}\begin{aligned}<br />
 \mathbb{E}</em><em _boldsymbol_varphi="\boldsymbol{\varphi">0\sim \tilde{p}(\boldsymbol{x}_0),\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t,t)\right\rangle\right]=&amp;\, \mathbb{E}</em><em _boldsymbol_varphi="\boldsymbol{\varphi">t\sim p(\boldsymbol{x}_t)}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t,t)\right\rangle\right] \\\<br />
 =&amp;\, \mathbb{E}</em><em _boldsymbol_varepsilon="\boldsymbol{\varepsilon">t\sim p(\boldsymbol{x}_t)}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \mathbb{E}</em>}\sim p(\boldsymbol{\varepsilon}|\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t)}[\boldsymbol{\varepsilon}]\right\rangle\right] \\\<br />
 =&amp;\, \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t\sim p(\boldsymbol{x}_t),\boldsymbol{\varepsilon}\sim p(\boldsymbol{\varepsilon}|\boldsymbol{x}_t)}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\varepsilon}\right\rangle\right] \\\<br />
 =&amp;\, \mathbb{E}</em>\right\rangle\right]}_0\sim \tilde{p}(\boldsymbol{x}_0),\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\varepsilon<br />
 \end{aligned}\end{equation}<br />
 è¯æ¯•ã€‚è¯æ˜è¿‡ç¨‹çš„â€œå¿…ç»ä¹‹è·¯â€æ˜¯ç¬¬ä¸€ä¸ªç­‰å·ï¼Œè¿™éœ€è¦ç”¨åˆ°â€œ$\boldsymbol{f}(\boldsymbol{x}_t,t)$åªä¾èµ–äº$\boldsymbol{x}_t$å’Œ$t$â€è¿™ä¸ªæ¡ä»¶ã€‚</p>
</blockquote>
<p>æ’ç­‰å¼$\eqref{eq:id}$çš„å…³é”®æ˜¯$\boldsymbol{\epsilon}<em _boldsymbol_z="\boldsymbol{z">{\boldsymbol{\varphi}^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t,t)$çš„æœ€ä¼˜æ€§ï¼Œè€Œç›®æ ‡$\eqref{eq:tloss}$å’Œ$\eqref{eq:dloss}$å½¢å¼æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥åŒæ ·çš„ç»“è®ºä¹Ÿé€‚ç”¨äº$\boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t,t)$ï¼Œåˆ©ç”¨å®ƒæˆ‘ä»¬å°±å¯ä»¥å°†$\eqref{eq:gloss-1}$å˜æ¢æˆ<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\Vert\boldsymbol{\epsilon<em _boldsymbol_z="\boldsymbol{z">{\boldsymbol{\varphi}^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t) - \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t)\Vert^2\right] \\\[8pt]<br />
=&amp;\,\mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\bigg[\Big\langle\boldsymbol{\epsilon<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{\varphi}^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t) - \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t),\boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t) - \underbrace{\boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}<em _text_å¯ä»¥æ›¿æ¢ä¸º="\text{å¯ä»¥æ›¿æ¢ä¸º">t^{(g)},t)}</em>\Big\rangle\bigg] \\\[5pt]}\boldsymbol{\varepsilon}<br />
=&amp;\,\mathbb{E}<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\left\langle\boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t) - \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}<em _boldsymbol_varphi="\boldsymbol{\varphi">t^{(g)},t),\boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}_t^{(g)},t) - \boldsymbol{\varepsilon}\right\rangle\right]\triangleq \mathcal{L}_2<br />
\end{aligned}\label{eq:gloss-2}\end{equation}<br />
æœ€åçš„å½¢å¼å°±æ˜¯SiDæ‰€æçš„ç”Ÿæˆå™¨æŸå¤±å‡½æ•°$\mathcal{L}_2$ï¼Œå®ƒæ˜¯SiDæˆåŠŸè®­ç»ƒçš„å…³é”®ï¼Œæˆ‘ä»¬å¯ä»¥ç†è§£ä¸ºå®ƒé€šè¿‡æ’ç­‰å˜æ¢æå‰é¢„ä¼°äº†$\boldsymbol{\psi}^</em>$çš„å€¼ï¼ŒåŒæ—¶å¼±åŒ–äº†å¯¹$\boldsymbol{\psi}^*$çš„ä¾èµ–ï¼Œä»è€Œä»¥å®ƒä¸ºæŸå¤±å‡½æ•°è®­ç»ƒç”Ÿæˆå™¨æ¯”$\mathcal{L}_1$æœ‰ç€æ›´å¥½çš„æ•ˆæœã€‚</p>
<p>SiDçš„é—ç•™é—®é¢˜æ˜¯ï¼š</p>
<blockquote>
<p>1ã€$\mathcal{L}<em _boldsymbol_z="\boldsymbol{z">2$çš„æ’ç­‰å˜æ¢å¹¶ä¸å½»åº•ï¼Œå°†$\mathcal{L}_2$å±•å¼€ä¼šå‘ç°é‡Œè¾¹è¿˜æœ‰ä¸€é¡¹$\mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle\boldsymbol{\epsilon<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{\varphi}^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t),\boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t)\rangle]$ï¼Œè¿™ä¸€é¡¹çš„$\boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t)$åŒæ ·å¯ä»¥æ›¿æ¢ä¸º$\boldsymbol{\varepsilon}$ï¼Œé‚£ä¹ˆé—®é¢˜å°±æ˜¯å®Œæ•´çš„å˜æ¢å³ä¸‹å¼ä¼šæ˜¯ä¸€ä¸ªæ¯”$\mathcal{L}_2$æ›´å¥½çš„é€‰æ‹©å—ï¼Ÿ<br />
 \begin{equation}\mathcal{L}_3 = \mathbb{E}</em>^},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\Vert\boldsymbol{\epsilon}_{\boldsymbol{\varphi</em>}\Vert^2 - 2\langle\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t),\boldsymbol{\varepsilon}\rangle + \langle \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t)\boldsymbol{\varepsilon}\rangle\right]\label{eq:gloss-3}\end{equation}</p>
<p>2ã€å®é™…ä¸ŠSiDæœ€ç»ˆç”¨çš„æŸå¤±ä¸æ˜¯$\mathcal{L}_2$ä¹Ÿä¸æ˜¯$\mathcal{L}_1$ï¼Œè€Œæ˜¯$\mathcal{L}_2 - \lambda\mathcal{L}_1$ï¼Œå…¶ä¸­$\lambda &gt; 0$ï¼Œå¹¶ä¸”å®éªŒå‘ç°$\lambda$çš„æœ€ä¼˜å€¼åœ¨$1$é™„è¿‘ï¼ŒæŸäº›ä»»åŠ¡ç”šè‡³åœ¨$\lambda=1.2$è¡¨ç°æœ€å¥½ï¼Œè¿™æ˜¯éå¸¸è®©äººå›°æƒ‘çš„ï¼Œå› ä¸º$\mathcal{L}_1,\mathcal{L}_2$æ˜¯ç†è®ºä¸Šç›¸ç­‰çš„ï¼Œæ‰€ä»¥$\lambda &gt; 1$ä¼¼ä¹åœ¨åå‘ä¼˜åŒ–$\mathcal{L}_1$ï¼Ÿè¿™ä¸å°±è·Ÿå‡ºå‘ç‚¹ç›¸åäº†ï¼Ÿæ˜¾ç„¶è¿™è¿«åˆ‡éœ€è¦ä¸€ä¸ªç†è®ºè§£é‡Šã€‚</p>
</blockquote>
<h2 id="_3">ç›´é¢æ¢¯åº¦</h2>
<p>å†æ¥å›é¡¾ä¸€ä¸‹ï¼Œæˆ‘ä»¬é¢ä¸´çš„æ ¹æœ¬å›°éš¾æ˜¯ï¼šç†è®ºä¸Š$\boldsymbol{\psi}^<em>$æ˜¯$\boldsymbol{\theta}$çš„å‡½æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬åœ¨æ±‚$\nabla_{\boldsymbol{\theta}} \mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">1$æˆ–$\nabla</em>}} \mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">2$æ—¶ï¼Œéœ€è¦æƒ³åŠæ³•æ±‚$\nabla</em>^}}\boldsymbol{\psi</em>$ï¼Œä½†å®è·µä¸­æˆ‘ä»¬è‡³å¤šå¯ä»¥å¾—åˆ°$\mathcal{L}<em _boldsymbol_psi="\boldsymbol{\psi">i^{\color{skyblue}{(\text{sg})}} \triangleq \mathcal{L}_i|</em>^<em> \to \color{skyblue}{\text{sg}[}\boldsymbol{\psi}^</em>\color{skyblue}{]}}$ï¼Œå…¶ä¸­$\color{skyblue}{\text{sg}}$æ˜¯stop gradientçš„æ„æ€ï¼Œå³æ— æ³•è·å–$\boldsymbol{\psi}^*$å…³äº$\boldsymbol{\theta}$çš„æ¢¯åº¦ï¼Œæ‰€ä»¥ä¸è®º$\mathcal{L}_1,\mathcal{L}_2,\mathcal{L}_3$ï¼Œå®ƒä»¬åœ¨å®è·µä¸­çš„æ¢¯åº¦éƒ½æ˜¯æœ‰åçš„ã€‚</p>
<p>è¿™æ—¶å€™å°±è½®åˆ°FGMç™»åœºäº†ï¼Œå®ƒçš„æƒ³æ³•æ›´è´´è¿‘æœ¬è´¨ï¼šæŸå¤±$\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">1,\mathcal{L}_2,\mathcal{L}_3$éƒ½åªå…³æ³¨åˆ°äº†æŸå¤±å±‚é¢çš„ç›¸ç­‰æ€§ï¼Œä½†å¯¹äºä¼˜åŒ–å™¨æ¥è¯´æˆ‘ä»¬éœ€è¦çš„æ˜¯æ¢¯åº¦å±‚é¢çš„ç›¸ç­‰ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•æ‰¾ä¸€ä¸ªæ–°çš„æŸå¤±å‡½æ•°$\mathcal{L}_4$ï¼Œä½¿å¾—å®ƒæ»¡è¶³<br />
\begin{equation}\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">4(\boldsymbol{\theta}, \color{skyblue}{\text{sg}[}\boldsymbol{\psi}^<em>\color{skyblue}{]})= \nabla_{\boldsymbol{\theta}}\mathcal{L}_{1/2/3}(\boldsymbol{\theta}, \boldsymbol{\psi}^</em>)\end{equation}<br />
å³$\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">4^{\color{skyblue}{(\text{sg})}} = \nabla</em>_4$ä¸ºæŸå¤±å‡½æ•°æ—¶ï¼Œå°±å¯ä»¥å®ç°æ— åçš„ä¼˜åŒ–æ•ˆæœäº†ã€‚}}\mathcal{L}_{1/2/3}$ï¼Œé‚£ä¹ˆä»¥$\mathcal{L</p>
<p>FGMçš„æ¨å¯¼åŒæ ·åŸºäºæ’ç­‰å¼$\eqref{eq:id}$ï¼Œä¸è¿‡å®ƒçš„åŸå§‹æ¨å¯¼æœ‰ç‚¹ç¹çï¼Œå¯¹äºæœ¬æ–‡æ¥è¯´å¯ä»¥ç›´æ¥ä»$\mathcal{L}<em _boldsymbol_z="\boldsymbol{z">3$å³å¼$\eqref{eq:gloss-3}$å‡ºå‘ï¼Œå®ƒè·Ÿ$\boldsymbol{\psi}^<em>$ç›¸å…³çš„é¡¹å°±åªå‰©ä¸‹$\mathbb{E}<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t),\boldsymbol{\varepsilon}\rangle]$ï¼Œæˆ‘ä»¬ç›´æ¥æŠŠå®ƒçš„æ¢¯åº¦ç®—å‡ºæ¥ï¼Œæ–¹æ³•å°†â€œå…ˆæ’ç­‰å˜æ¢åæ±‚æ¢¯åº¦â€å’Œâ€œå…ˆæ±‚æ¢¯åº¦åæ’ç­‰å˜æ¢â€åˆ†åˆ«åº”ç”¨äº$\mathbb{E}</em>,t)\Vert^2]$æ“ä½œä¸€éï¼Œå¯¹æ¯”å®ƒä»¬çš„ç»“æœã€‚},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\Vert\boldsymbol{\epsilon}_{\boldsymbol{\psi}^*}(\boldsymbol{x}_t^{(g)</p>
<p>å…ˆæ’ç­‰å˜æ¢åæ±‚æ¢¯åº¦ï¼š<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\nabla_{\boldsymbol{\theta}}\mathbb{E}<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\Vert\boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)},t)\Vert^2] \\\[5pt]<br />
=&amp;\, \nabla</em>}}\mathbb{E<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t),\boldsymbol{\varepsilon}\rangle] = \mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle \nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon<em _boldsymbol_z="\boldsymbol{z">{\boldsymbol{\psi}^<em>}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t),\boldsymbol{\varepsilon}\rangle] \\\[5pt]<br />
=&amp;\, \mathbb{E}</em>^},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle \nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\color{skyblue}{\text{sg}[}\boldsymbol{\psi</em>\color{skyblue}{]}}(\boldsymbol{x}_t^{(g)},t),\boldsymbol{\varepsilon}\rangle] + \mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle \nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon<em _boldsymbol_z="\boldsymbol{z">{\boldsymbol{\psi}^<em>}(\color{skyblue}{\text{sg}[}\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}\color{skyblue}{]},t),\boldsymbol{\varepsilon}\rangle]<br />
\end{aligned}\label{eq:g-grad-1}\end{equation}<br />
å…ˆæ±‚æ¢¯åº¦åæ’ç­‰å˜æ¢ï¼š<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\nabla</em>}}\mathbb{E<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\Vert\boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t)\Vert^2] \\\[8pt]<br />
=&amp;\, \mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\nabla_{\boldsymbol{\theta}}\Vert\boldsymbol{\epsilon<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{\psi}^<em>}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t)\Vert^2] = 2\mathbb{E}</em>^},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\boldsymbol{\psi</em>}(\boldsymbol{x}_t^{(g)},t), \boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t)\rangle] \\\[8pt]<br />
=&amp;\, 2\mathbb{E}</em>^},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\color{skyblue}{\text{sg}[}\boldsymbol{\psi</em>\color{skyblue}{]}}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t), \boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t)\rangle] + \underbrace{2\mathbb{E}</em>^},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\boldsymbol{\psi</em>}(\color{skyblue}{\text{sg}[}\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)}\color{skyblue}{]},t), \boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _text_å¯ä»¥åº”ç”¨å¼="\text{å¯ä»¥åº”ç”¨å¼">t^{(g)},t)\rangle]}</em> \\\[5pt]}\eqref{eq:id}<br />
=&amp;\, 2\mathbb{E}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle\nabla</em>^}}\boldsymbol{\epsilon}_{\color{skyblue}{\text{sg}[}\boldsymbol{\psi</em>\color{skyblue}{]}}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t), \boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t)\rangle] + 2\mathbb{E}</em>^},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\boldsymbol{\psi</em>}(\color{skyblue}{\text{sg}[}\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)}\color{skyblue}{]},t), \boldsymbol{\varepsilon}\rangle]<br />
\end{aligned}\label{eq:g-grad-2}\end{equation}<br />
è¿™é‡Œè¦æ³¨æ„ç¬¬ä¸‰ä¸ªç­‰å·ï¼Œåªæœ‰$\boldsymbol{\epsilon}</em>^<em>}(\color{skyblue}{\text{sg}[}\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}\color{skyblue}{]},t)$è¿™ä¸€é¡¹æ‰å¯ä»¥åº”ç”¨æ’ç­‰å¼$\eqref{eq:id}$ï¼Œå› ä¸º$\nabla</em>^}}\boldsymbol{\epsilon}_{\color{skyblue}{\text{sg}[}\boldsymbol{\psi</em>\color{skyblue}{]}}(\boldsymbol{x}_t^{(g)},t)$çš„$\boldsymbol{x}_t^{(g)}$è¦å¯¹$\boldsymbol{\theta}$æ±‚æ¢¯åº¦ï¼Œæ±‚å®Œæ¢¯åº¦åå°±ä¸ä¸€å®šæ˜¯$\boldsymbol{x}_t^{(g)}$çš„å‡½æ•°äº†ï¼Œæ‰€ä»¥ä¸æ»¡è¶³åº”ç”¨å¼$\eqref{eq:id}$çš„æ¡ä»¶ã€‚</p>
<p>ç°åœ¨å¯¹äº$\nabla_{\boldsymbol{\theta}}\mathbb{E}<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\Vert\boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)},t)\Vert^2]$æˆ‘ä»¬æœ‰ä¸¤ä¸ªç»“æœï¼Œå°†å¼$\eqref{eq:g-grad-1}$ä¹˜ä»¥2ç„¶åå‡å»å¼$\eqref{eq:g-grad-2}$å¾—åˆ°<br />
\begin{equation}\begin{aligned}<br />
&amp;\,\nabla</em>}}\mathbb{E<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)},t),\boldsymbol{\varepsilon}\rangle] = \nabla</em>}}\mathbb{E<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\Vert\boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t)\Vert^2] = \eqref{eq:g-grad-1}\times 2 - \eqref{eq:g-grad-2} \\\[5pt]<br />
=&amp;\,2 \mathbb{E}</em>^},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle \nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\color{skyblue}{\text{sg}[}\boldsymbol{\psi</em>\color{skyblue}{]}}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t),\boldsymbol{\varepsilon}\rangle] - 2\mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon<em _boldsymbol_theta="\boldsymbol{\theta">{\color{skyblue}{\text{sg}[}\boldsymbol{\psi}^<em>\color{skyblue}{]}}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t), \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t)\rangle] \\\[5pt]<br />
=&amp;\,2 \nabla</em>}}\mathbb{E<em _color_skyblue="\color{skyblue">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle \boldsymbol{\epsilon}</em>^}{\text{sg}[}\boldsymbol{\psi<em>\color{skyblue}{]}}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)},t),\boldsymbol{\varepsilon}\rangle] - \nabla</em>}}\mathbb{E<em _color_skyblue="\color{skyblue">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\Vert\boldsymbol{\epsilon}</em>^}{\text{sg}[}\boldsymbol{\psi</em>\color{skyblue}{]}}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)},t)\Vert^2] \\\[5pt]<br />
=&amp;\,\nabla</em>}}\mathbb{E<em _color_skyblue="\color{skyblue">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[2\langle \boldsymbol{\epsilon}</em>^}{\text{sg}[}\boldsymbol{\psi<em>\color{skyblue}{]}}(\boldsymbol{x}<em _color_skyblue="\color{skyblue">t^{(g)},t),\boldsymbol{\varepsilon}\rangle - \Vert\boldsymbol{\epsilon}</em>^}{\text{sg}[}\boldsymbol{\psi</em>\color{skyblue}{]}}(\boldsymbol{x}<em _boldsymbol_z="\boldsymbol{z">t^{(g)},t)\Vert^2]<br />
\end{aligned}\end{equation}<br />
ç•™æ„æœ€åè¢«æ±‚æ¢¯åº¦çš„å¼å­ï¼Œå®ƒæ‰€æœ‰çš„$\boldsymbol{\psi}^<em>$éƒ½è¢«åŠ ä¸Šäº†$\color{skyblue}{\text{sg}}$ï¼Œè¯´æ˜æˆ‘ä»¬ä¸ç”¨è®¾æ³•æ±‚å®ƒå…³äº$\boldsymbol{\theta}$çš„æ¢¯åº¦äº†ï¼Œä½†å®ƒçš„æ¢¯åº¦ç­‰äº$\mathbb{E}<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}[\langle \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t),\boldsymbol{\varepsilon}\rangle]$çš„å‡†ç¡®æ¢¯åº¦ï¼Œæ‰€ä»¥ç”¨å®ƒæ¥æ›¿æ¢æ‰$\mathcal{L}_3$çš„å¯¹åº”é¡¹ï¼Œæˆ‘ä»¬å°±å¾—åˆ°äº†$\mathcal{L}_4$ï¼š<br />
\begin{equation}\mathcal{L}_4^{\color{skyblue}{(\text{sg})}} = \mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})}\left[\Vert\boldsymbol{\epsilon<em _color_skyblue="\color{skyblue">{\boldsymbol{\varphi}^<em>}\Vert^2 - 2\langle\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^</em>}(\boldsymbol{x}_t^{(g)},t),\boldsymbol{\varepsilon}\rangle + 2\langle \boldsymbol{\epsilon}</em>^}{\text{sg}[}\boldsymbol{\psi<em>\color{skyblue}{]}}(\boldsymbol{x}<em _color_skyblue="\color{skyblue">t^{(g)},t),\boldsymbol{\varepsilon}\rangle - \Vert\boldsymbol{\epsilon}</em>^}{\text{sg}[}\boldsymbol{\psi</em>\color{skyblue}{]}}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)},t)\Vert^2\right]\end{equation}<br />
è¿™å°±æ˜¯FGMçš„æœ€ç»ˆç»“æœï¼Œå®ƒåªä¾èµ–äº$\color{skyblue}{\text{sg}[}\boldsymbol{\psi}^*\color{skyblue}{]}$ï¼Œä½†æˆç«‹$\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">4^{\color{skyblue}{(\text{sg})}}=\nabla</em>)$ï¼Œæ‰€ä»¥FGMç›¸å½“äºä»æ¢¯åº¦è§’åº¦è‚¯å®šäº†SiDçš„$\lambda=0.5$çš„é€‰æ‹©ã€‚}}\mathcal{L}_{1/2/3}$ã€‚å†ä»”ç»†è§‚å¯Ÿä¸€ä¸‹ï¼Œå°±ä¼šå‘ç°æˆç«‹$\mathcal{L}_4^{\color{skyblue}{(\text{sg})}}=2\mathcal{L}_2^{\color{skyblue}{(\text{sg})}}-\mathcal{L}_1^{\color{skyblue}{(\text{sg})}}=2(\mathcal{L}_2^{\color{skyblue}{(\text{sg})}}-0.5\times \mathcal{L}_1^{\color{skyblue}{(\text{sg})}</p>
<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼ŒFGMåŸè®ºæ–‡çš„æè¿°æ˜¯åœ¨ODEå¼æ‰©æ•£æ¡†æ¶ï¼ˆflow matchingï¼‰å†…è¿›è¡Œçš„ï¼Œä½†æ­£å¦‚ç¬”è€…åœ¨ä¸Šä¸€ç¯‡æ–‡ç« æ‰€è¯´ï¼Œä¸ç®¡æ˜¯SiDè¿˜æ˜¯FGMï¼Œå®ƒå®é™…å¹¶æ²¡æœ‰ç”¨åˆ°æ‰©æ•£æ¨¡å‹çš„è¿­ä»£ç”Ÿæˆè¿‡ç¨‹ï¼Œè€Œæ˜¯åªç”¨åˆ°äº†æ‰©æ•£æ¨¡å‹æ‰€è®­ç»ƒçš„å»å™ªæ¨¡å‹ï¼Œæ‰€ä»¥ä¸ç®¡æ˜¯ODEã€SDEè¿˜æ˜¯DDPMæ¡†æ¶éƒ½åªæ˜¯è¡¨è±¡ï¼Œå®ƒçš„å»å™ªæ¨¡å‹æ‰æ˜¯æœ¬è´¨ï¼Œæ‰€ä»¥æœ¬æ–‡å¯ä»¥æ¥ç€ä¸Šä¸€ç¯‡SiDçš„è®°å·æ¥ä»‹ç»FGMã€‚</p>
<h2 id="_4">å¹¿ä¹‰æ•£åº¦</h2>
<p>FGMå·²ç»æˆåŠŸåœ°æ±‚å‡ºäº†æœ€æœ¬è´¨çš„æ¢¯åº¦ï¼Œä½†è¿™åªèƒ½è§£é‡ŠSiDçš„$\lambda=0.5$ï¼Œè¿™æ„å‘³ç€å¦‚æœæˆ‘ä»¬éœ€è¦è§£é‡Šå…¶ä»–$\lambda$å€¼çš„å¯è¡Œæ€§ï¼Œå°±å¿…é¡»ä¿®æ”¹å‡ºå‘ç‚¹äº†ã€‚ä¸ºæ­¤ï¼Œæˆ‘ä»¬å›åˆ°åŸç‚¹ï¼Œåæ€ä¸€ä¸‹ç”Ÿæˆå™¨çš„ç›®æ ‡$\eqref{eq:gloss-1}$ã€‚</p>
<p>ç†Ÿæ‚‰æ‰©æ•£æ¨¡å‹çš„è¯»è€…åº”è¯¥éƒ½çŸ¥é“ï¼Œå¼$\eqref{eq:tloss}$çš„ç†è®ºæœ€ä¼˜è§£è¿˜å¯ä»¥å†™æˆ$\boldsymbol{\epsilon}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\varphi}^<em>}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t,t)=-\bar{\beta}_t\nabla</em><em _boldsymbol_psi="\boldsymbol{\psi">t}\log p(\boldsymbol{x}_t)$ï¼ŒåŒç†å¼$\eqref{eq:dloss}$çš„æœ€ä¼˜è§£åˆ™æ˜¯$\boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t)=-\bar{\beta}_t\nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}}\log p</em>}}(\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)})$ï¼Œè¿™é‡Œçš„$p(\boldsymbol{x}_t)$ã€$p</em>)$åˆ†åˆ«æ˜¯çœŸå®æ•°æ®ã€ç”Ÿæˆå™¨æ•°æ®åŠ å™ªçš„åˆ†å¸ƒï¼Œå¦‚æœä¸äº†è§£è¿™ä¸ªç»“æœï¼Œå¯ä»¥å‚è€ƒ}}(\boldsymbol{x}_t^{(g)<a href="/archives/9209">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäº”ï¼‰ï¼šä¸€èˆ¬æ¡†æ¶ä¹‹SDEç¯‡ã€‹</a>ã€<a href="/archives/9509">ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåå…«ï¼‰ï¼šå¾—åˆ†åŒ¹é… = æ¡ä»¶å¾—åˆ†åŒ¹é…ã€‹</a>ç­‰ä»‹ç»ã€‚</p>
<p>å°†è¿™ä¸¤ä¸ªç†è®ºæœ€ä¼˜è§£ä»£å›å¼$\eqref{eq:gloss-1}$ï¼Œæˆ‘ä»¬ä¼šå‘ç°ç”Ÿæˆå™¨å®é™…ä¸Šåœ¨è¯•å›¾æœ€å°åŒ–Fisheræ•£åº¦ï¼š<br />
\begin{equation}\begin{aligned}<br />
\mathcal{F}(p, p_{\boldsymbol{\theta}}) =&amp;\, \mathbb{E}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})} \left[\Vert \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}}\log p</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t^{(g)}) - \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}}\log p(\boldsymbol{x}_t^{(g)})\Vert^2\right] \\\<br />
=&amp;\, \int p</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t^{(g)}) \left\Vert \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}}\log p</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t^{(g)}) - \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}}\log p(\boldsymbol{x}_t^{(g)})\right\Vert^2 d\boldsymbol{x}_t^{(g)}<br />
\end{aligned}\end{equation}<br />
æˆ‘ä»¬è¦åæ€çš„äº‹æƒ…ï¼Œå°±æ˜¯Fisheræ•£åº¦çš„åˆç†æ€§å’Œæ”¹è¿›ç‚¹ã€‚å¯ä»¥çœ‹åˆ°ï¼ŒFisheræ•£åº¦é‡Œè¾¹$p</em>$å‡ºç°äº†ä¸¤æ¬¡ï¼Œç°åœ¨æˆ‘ä»¬æ¥è¯·è¯»è€…æ€è€ƒä¸€ä¸ªé—®é¢˜ï¼š}<strong>è¿™ä¸¤å¤„$p_{\boldsymbol{\theta}}$ä¸­å“ªä¸€å¤„æ›´é‡è¦å‘¢ï¼Ÿ</strong></p>
<p>ç­”æ¡ˆæ˜¯<strong>ç¬¬äºŒå¤„</strong> ã€‚ä¸ºäº†ç†è§£è¿™ä¸ªäº‹å®ï¼Œæˆ‘ä»¬ä¸å¦¨è€ƒè™‘ä¸¤ç§æƒ…å†µï¼š <em _boldsymbol_theta="\boldsymbol{\theta">1ã€å›ºå®šç¬¬ä¸€å¤„$p</em>$ã€‚}}$ï¼Œåªä¼˜åŒ–ç¬¬äºŒå¤„$p_{\boldsymbol{\theta}}$ï¼›2ã€å›ºå®šç¬¬äºŒå¤„$p_{\boldsymbol{\theta}}$ï¼Œåªä¼˜åŒ–ç¬¬ä¸€å¤„$p_{\boldsymbol{\theta}<em _boldsymbol_theta="\boldsymbol{\theta"> å®ƒä»¬çš„ç»“æœæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿç¬¬ä¸€ç§æƒ…å†µå¤§æ¦‚ç‡ä¸ä¼šæœ‰ä»€ä¹ˆå˜åŒ–ï¼Œå³ä¾ç„¶èƒ½å­¦åˆ°$p</em>=p$ï¼Œäº‹å®ä¸Šç”±äºFisheræ•£åº¦å¸¦æœ‰$\Vert\Vert^2$ï¼Œæ‰€ä»¥ä¸‹é¢æ›´ä¸€èˆ¬çš„ç»“è®ºå‡ ä¹æ˜¯æ˜¾ç„¶æˆç«‹çš„ï¼š}</p>
<blockquote>
<p>åªè¦$r(\boldsymbol{x})$æ˜¯ä¸€ä¸ªå¤„å¤„ä¸ä¸ºé›¶çš„åˆ†å¸ƒï¼Œé‚£ä¹ˆ$p(\boldsymbol{x})=q(\boldsymbol{x})$ä¾ç„¶æ˜¯å¦‚ä¸‹å¹¿ä¹‰Fisheræ•£åº¦çš„ç†è®ºæœ€ä¼˜è§£ï¼š \begin{equation}\mathcal{F}(p,q|r) = \int r(\boldsymbol{x}) \Vert \nabla_{\boldsymbol{x}} p(\boldsymbol{x}) - \nabla_{\boldsymbol{x}} q(\boldsymbol{x})\Vert^2 d\boldsymbol{x}\end{equation}</p>
</blockquote>
<p>è¯´ç®€å•ç‚¹ï¼Œå°±æ˜¯ç¬¬ä¸€å¤„$p_{\boldsymbol{\theta}}$æ ¹æœ¬ä¸é‡è¦ï¼Œæ¢æˆå…¶ä»–åˆ†å¸ƒéƒ½è¡Œï¼Œå•é $\Vert\Vert^2$å°±èƒ½ä¿è¯ä¸¤ä¸ªåˆ†å¸ƒç›¸ç­‰ã€‚ä½†ç¬¬äºŒç§æƒ…å†µå°±ä¸ä¸€æ ·äº†ï¼Œå›ºå®šç¬¬äºŒå¤„$p_{\boldsymbol{\theta}}$åªä¼˜åŒ–ç¬¬ä¸€å¤„$p_{\boldsymbol{\theta}}$çš„ç†è®ºæœ€ä¼˜è§£æ˜¯<br />
\begin{equation}p_{\boldsymbol{\theta}}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t^{(g)}) = \delta(\boldsymbol{x}_t^{(g)} - \boldsymbol{x}_t^<em>),\quad \boldsymbol{x}_t^</em> = \mathop{\text{argmin}}</em><em _boldsymbol_x="\boldsymbol{x">t^{(g)}} \,\left\Vert \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}}\log p</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t^{(g)}) - \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}}\log p(\boldsymbol{x}_t^{(g)})\right\Vert^2\end{equation}<br />
å…¶ä¸­$\delta$æ˜¯ç‹„æ‹‰å…‹deltaåˆ†å¸ƒï¼Œå³æ¨¡å‹åªéœ€è¦ç”Ÿæˆè®©$\Vert\Vert^2$æœ€å°çš„é‚£ä¸ªæ ·æœ¬ï¼Œå°±å¯ä»¥è®©æŸå¤±æœ€å°ï¼Œè¿™è¯´ç™½äº†å°±æ˜¯æ¨¡å¼åç¼©ï¼ˆMode Collapseï¼‰ï¼æ‰€ä»¥ï¼ŒFisheræ•£åº¦ä¸­çš„ç¬¬ä¸€å¤„$p</em>$çš„ä½œç”¨ä¸å•å•æ˜¯æ¬¡è¦çš„ï¼Œç”šè‡³è¿˜å¯èƒ½æ˜¯è´Ÿé¢çš„ã€‚}</p>
<p>è¿™å¯å‘æˆ‘ä»¬ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨åŸºäºæ¢¯åº¦çš„ä¼˜åŒ–å™¨æ¥è®­ç»ƒæ¨¡å‹æ—¶ï¼Œç¬¬ä¸€å¤„$p_{\boldsymbol{\theta}}$çš„æ¢¯åº¦å¹²è„†ä¸è¦è¿˜ä¼šæ›´å¥½ï¼Œå³ä¸‹è¿°å½¢å¼çš„Fisheræ•£åº¦æ˜¯ä¸€ä¸ªæ›´å¥½çš„é€‰æ‹©<br />
\begin{equation}\begin{aligned}<br />
\mathcal{F}^+(p, p_{\boldsymbol{\theta}}) =&amp;\, \int p_{\color{skyblue}{\text{sg}[}\boldsymbol{\theta}\color{skyblue}{]}}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t^{(g)}) \left\Vert \nabla</em><em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}}\log p</em>}}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t^{(g)}) - \nabla</em><em _boldsymbol_z="\boldsymbol{z">t^{(g)}}\log p(\boldsymbol{x}_t^{(g)})\right\Vert^2 d\boldsymbol{x}_t^{(g)} \\\[5pt]<br />
=&amp;\, \mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})} \left[\Vert \nabla_{\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}}\log p</em>}}(\color{skyblue}{\text{sg}[}\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t^{(g)}\color{skyblue}{]}) - \nabla</em><em _boldsymbol_z="\boldsymbol{z">t^{(g)}}\log p(\color{skyblue}{\text{sg}[}\boldsymbol{x}_t^{(g)}\color{skyblue}{]})\Vert^2\right] \\\[5pt]<br />
\propto&amp;\, \underbrace{\mathbb{E}</em>},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})} \left[\Vert \boldsymbol{\epsilon<em _mathcal_L="\mathcal{L">{\boldsymbol{\varphi}^<em>}(\color{skyblue}{\text{sg}[}\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)}\color{skyblue}{]},t) - \boldsymbol{\epsilon}</em>^</em>}(\color{skyblue}{\text{sg}[}\boldsymbol{x}_t^{(g)}\color{skyblue}{]},t)\Vert^2\right]}</em><em _boldsymbol_theta="\boldsymbol{\theta">5}<br />
\end{aligned}\end{equation}<br />
ä¹Ÿå°±æ˜¯è¯´ï¼Œè¿™é‡Œçš„$\mathcal{L}_5$ææœ‰å¯èƒ½ä¼šæ˜¯ä¸€ä¸ªæ¯”$\mathcal{L}_1$æ›´å¥½çš„å‡ºå‘ç‚¹ï¼Œå®ƒæ•°å€¼ä¸Šè·Ÿ$\mathcal{L}_1$æ˜¯ç›¸ç­‰çš„ï¼Œä½†å°‘äº†ä¸€éƒ¨åˆ†æ¢¯åº¦ï¼š<br />
\begin{equation}\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">5 = \nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">1 - \nabla</em>}}\underbrace{\mathbb{E<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{z},\boldsymbol{\varepsilon}\sim\mathcal{N}(\boldsymbol{0}, \boldsymbol{I})} \left[\Vert \boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _color_skyblue="\color{skyblue">t^{(g)},t) - \boldsymbol{\epsilon}</em>^}{\text{sg}[}\boldsymbol{\psi</em>\color{skyblue}{]}}(\boldsymbol{x}<em _text_åˆšå¥½æ˜¯="\text{åˆšå¥½æ˜¯">t^{(g)},t)\Vert^2\right]}</em>}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">1^{\color{skyblue}{(\text{sg})}}}\end{equation}<br />
å…¶ä¸­$\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">1$å·²ç»ç”±FGMç®—å‡ºæ¥äº†ï¼Œå®ƒç­‰äº$\nabla</em>$ä½œä¸ºé¢å¤–çš„æƒ©ç½šé¡¹ï¼Œè¿›ä¸€æ­¥é™ä½æ¨¡å¼åç¼©çš„é£é™©ï¼Œå½“ç„¶è¿™é‡ŒçœŸå°±æ˜¯å•çº¯çš„æƒ©ç½šé¡¹ï¼Œæ‰€ä»¥æƒé‡å°±ä¸èƒ½å¤ªå¤§äº†ï¼Œæ ¹æ®SiDçš„å®éªŒç»“æœï¼Œ$\lambda=1.5$çš„æ—¶å€™å·²ç»å¼€å§‹è®­å´©äº†ã€‚}}(2\mathcal{L}_2^{\color{skyblue}{(\text{sg})}}-\mathcal{L}_1^{\color{skyblue}{(\text{sg})}})$ï¼Œå› æ­¤ä»¥$\mathcal{L}_5$ä¸ºå‡ºå‘ç‚¹ï¼Œæˆ‘ä»¬å®è·µä¸­çš„æŸå¤±å‡½æ•°æ˜¯$2\mathcal{L}_2^{\color{skyblue}{(\text{sg})}}-\mathcal{L}_1^{\color{skyblue}{(\text{sg})}}-\mathcal{L}_1^{\color{skyblue}{(\text{sg})}}=2(\mathcal{L}_2^{\color{skyblue}{(\text{sg})}}-\mathcal{L}_1^{\color{skyblue}{(\text{sg})}})$ï¼Œè¿™å°±è§£é‡Šäº†$\lambda=1$çš„é€‰æ‹©ã€‚è‡³äº$\lambda$ç¨å¤§äº1çš„é€‰æ‹©ï¼Œåˆ™æ›´ä¸ºæç«¯ä¸€äº›ï¼Œå®ƒç›¸å½“äºåœ¨$\mathcal{L}_5$çš„åŸºç¡€ä¸Šå°†$-\mathcal{L}_1^{\color{skyblue}{(\text{sg})}</p>
<p>é¡ºä¾¿è¯´ä¸€ä¸‹ï¼ŒFGMä¹‹å‰ä½œè€…è¿˜æœ‰ä¸ªä½œå“<a href="https://papers.cool/arxiv/2410.16794">ã€ŠOne-Step Diffusion Distillation through Score Implicit Matchingã€‹</a>ï¼Œé‡Œè¾¹ä¹Ÿæå‡ºäº†ç±»ä¼¼çš„å¯¹ç¬¬ä¸€å¤„$p_{\boldsymbol{\theta}}$æ”¹ä¸º$p_{\color{skyblue}{\text{sg}[}\boldsymbol{\theta}\color{skyblue}{]}}$çš„åšæ³•ï¼Œä½†æ²¡æœ‰æ˜ç¡®åœ°ä»Fisheræ•£åº¦çš„åŸå§‹å½¢å¼å‡ºå‘è®¨è®ºè¯¥æ“ä½œçš„åˆç†æ€§ï¼Œç¨æ¬ å®Œæ•´ã€‚</p>
<h2 id="_5">æ–‡ç« å°ç»“</h2>
<p>æœ¬æ–‡ä»‹ç»äº†SiDï¼ˆScore identity Distillationï¼‰çš„åç»­ç†è®ºè¿›å±•ï¼Œä¸»è¦å†…å®¹æ˜¯ä»æ¢¯åº¦è§†è§’è§£é‡Šäº†SiDä¸­çš„$\lambda$å‚æ•°è®¾ç½®ï¼Œæ ¸å¿ƒéƒ¨åˆ†æ˜¯ç”±FGMï¼ˆFlow Generator Matchingï¼‰å‘ç°çš„å‡†ç¡®ä¼°è®¡SiDæ¢¯åº¦çš„å·§å¦™æ€è·¯ï¼Œè¿™è‚¯å®šäº†$\lambda=0.5$çš„é€‰æ‹©ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šï¼Œç¬”è€…æ‹“å±•äº†Fisheræ•£åº¦çš„æ¦‚å¿µï¼Œä»è€Œè§£é‡Šäº†$\lambda=1$çš„å–å€¼ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/10567">https://spaces.ac.cn/archives/10567</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Nov. 22, 2024). ã€Šç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåå…­ï¼‰ï¼šåŸºäºæ’ç­‰å¼çš„è’¸é¦ï¼ˆä¸‹ï¼‰ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/10567">https://spaces.ac.cn/archives/10567</a></p>
<p>@online{kexuefm-10567,<br />
title={ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆäºŒåå…­ï¼‰ï¼šåŸºäºæ’ç­‰å¼çš„è’¸é¦ï¼ˆä¸‹ï¼‰},<br />
author={è‹å‰‘æ—},<br />
year={2024},<br />
month={Nov},<br />
url={\url{https://spaces.ac.cn/archives/10567}},<br />
} </p>
<hr />
<h2 id="_6">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</h2>
<p>æœ¬èŠ‚å¯¹SiDå’ŒFGMçš„æ ¸å¿ƒæ•°å­¦åŸç†è¿›è¡Œè¯¦ç»†æ¨å¯¼,æ·±å…¥ç†è§£åŸºäºæ’ç­‰å¼çš„æ‰©æ•£æ¨¡å‹è’¸é¦æ–¹æ³•ã€‚</p>
<h3 id="sid">ä¸€ã€SiDåŸºç¡€æ¡†æ¶å›é¡¾</h3>
<h4 id="11">1.1 ä¸‰ä¸ªæ ¸å¿ƒæŸå¤±å‡½æ•°</h4>
<p><strong>æ•™å¸ˆæ‰©æ•£æ¨¡å‹</strong>çš„è®­ç»ƒç›®æ ‡:
\begin{equation}
\boldsymbol{\varphi}^* = \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\varphi}} \mathbb{E}</em><em _boldsymbol_varphi="\boldsymbol{\varphi">0\sim \tilde{p},\boldsymbol{\varepsilon}\sim\mathcal{N}}\left[\Vert\boldsymbol{\epsilon}</em>
\end{equation}}}(\boldsymbol{x}_t,t) - \boldsymbol{\varepsilon}\Vert^2\right] \tag{1.1</p>
<p>å…¶ä¸­$\boldsymbol{x}_t = \bar{\alpha}_t\boldsymbol{x}_0 + \bar{\beta}_t\boldsymbol{\varepsilon}$ã€‚</p>
<p><strong>å­¦ç”Ÿæ‰©æ•£æ¨¡å‹</strong>çš„è®­ç»ƒç›®æ ‡:
\begin{equation}
\boldsymbol{\psi}^* = \mathop{\text{argmin}}<em _boldsymbol_z="\boldsymbol{z">{\boldsymbol{\psi}} \mathbb{E}</em>
\end{equation}},\boldsymbol{\varepsilon}}\left[\Vert\boldsymbol{\epsilon}_{\boldsymbol{\psi}}(\boldsymbol{x}_t^{(g)},t) - \boldsymbol{\varepsilon}\Vert^2\right] \tag{1.2</p>
<p>å…¶ä¸­$\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)} = \bar{\alpha}_t\boldsymbol{g}</em>$ã€‚}}(\boldsymbol{z}) + \bar{\beta}_t\boldsymbol{\varepsilon</p>
<p><strong>æœ´ç´ ç”Ÿæˆå™¨æŸå¤±</strong> $\mathcal{L}<em _boldsymbol_z="\boldsymbol{z">1$:
\begin{equation}
\mathcal{L}_1 = \mathbb{E}</em>^},\boldsymbol{\varepsilon}}\left[\Vert\boldsymbol{\epsilon}_{\boldsymbol{\varphi<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)},t) - \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)},t)\Vert^2\right] \tag{1.3}
\end{equation}</p>
<h4 id="12">1.2 è®­ç»ƒä¸ç¨³å®šæ€§çš„æ ¹æº</h4>
<p><strong>é—®é¢˜1 - æœªè¾¾æœ€ä¼˜</strong>:
å®è·µä¸­$\boldsymbol{\psi}$å¹¶æœªè¾¾åˆ°ç†è®ºæœ€ä¼˜$\boldsymbol{\psi}^*$å³å¼€å§‹ä¼˜åŒ–ç”Ÿæˆå™¨ã€‚</p>
<p><strong>é—®é¢˜2 - æ¢¯åº¦ç¼ºå¤±</strong>:
ç†è®ºä¸Š$\boldsymbol{\psi}^<em>$ä¾èµ–äº$\boldsymbol{\theta}$,åº”è®°ä¸º$\boldsymbol{\psi}^</em>(\boldsymbol{\theta})$ã€‚ä¼˜åŒ–$\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">1$æ—¶åº”åŒ…å«:
\begin{equation}
\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">1 = \nabla</em>}}\mathcal{L<em _boldsymbol_psi="\boldsymbol{\psi">1\big|</em>^<em>\text{å›ºå®š}} + \underbrace{\frac{\partial\mathcal{L}_1}{\partial\boldsymbol{\psi}^</em>}\frac{\partial\boldsymbol{\psi}^*}{\partial\boldsymbol{\theta}}}_{\text{å®è·µä¸­ç¼ºå¤±}} \tag{1.4}
\end{equation}</p>
<h3 id="_7">äºŒã€æ’ç­‰å¼çš„ä¸¥æ ¼è¯æ˜</h3>
<h4 id="21">2.1 æ ¸å¿ƒæ’ç­‰å¼é™ˆè¿°</h4>
<p><strong>å®šç†</strong>: è®¾$\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^*}$æ˜¯å…¬å¼(1.1)çš„æœ€ä¼˜è§£,$\boldsymbol{f}(\boldsymbol{x}_t,t)$æ˜¯ä»…ä¾èµ–äº$(\boldsymbol{x}_t,t)$çš„ä»»æ„å‘é‡å‡½æ•°,åˆ™:</p>
<p>\begin{equation}
\mathbb{E}<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{x}_0,\boldsymbol{\varepsilon}}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\epsilon}</em>}^*}(\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t,t)\right\rangle\right] = \mathbb{E}</em>
\end{equation}}_0,\boldsymbol{\varepsilon}}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\varepsilon}\right\rangle\right] \tag{2.1</p>
<h4 id="22">2.2 è¯¦ç»†è¯æ˜</h4>
<p><strong>è¯æ˜</strong>:</p>
<p><strong>æ­¥éª¤1</strong> - æ”¹å†™ä¼˜åŒ–ç›®æ ‡:
\begin{align}
\boldsymbol{\varphi}^* &amp;= \mathop{\text{argmin}}<em _boldsymbol_x="\boldsymbol{x">{\boldsymbol{\varphi}} \mathbb{E}</em><em _boldsymbol_varphi="\boldsymbol{\varphi">0,\boldsymbol{\varepsilon}}\left[\Vert\boldsymbol{\epsilon}</em>}}(\boldsymbol{x<em _boldsymbol_varphi="\boldsymbol{\varphi">t,t) - \boldsymbol{\varepsilon}\Vert^2\right] \tag{2.2}\
&amp;= \mathop{\text{argmin}}</em>}} \mathbb{E<em _boldsymbol_varepsilon="\boldsymbol{\varepsilon">{\boldsymbol{x}_t}\Big[\mathbb{E}</em>}|\boldsymbol{x<em _boldsymbol_varphi="\boldsymbol{\varphi">t}\left[\Vert\boldsymbol{\epsilon}</em>
\end{align}}}(\boldsymbol{x}_t,t) - \boldsymbol{\varepsilon}\Vert^2\right]\Big] \tag{2.3</p>
<p><strong>æ­¥éª¤2</strong> - åº”ç”¨MSEæœ€ä¼˜æ€§:</p>
<p>å¯¹å›ºå®šçš„$\boldsymbol{x}<em _boldsymbol_varepsilon="\boldsymbol{\varepsilon">t$,æœ€å°åŒ–$\mathbb{E}</em>}|\boldsymbol{x<em _boldsymbol_varphi="\boldsymbol{\varphi">t}[\Vert\boldsymbol{\epsilon}</em>\Vert^2]$çš„æœ€ä¼˜è§£æ˜¯:
\begin{equation}
\boldsymbol{\epsilon}}} - \boldsymbol{\varepsilon<em _boldsymbol_varepsilon="\boldsymbol{\varepsilon">{\boldsymbol{\varphi}^*}(\boldsymbol{x}_t,t) = \mathbb{E}</em>
\end{equation}}|\boldsymbol{x}_t}[\boldsymbol{\varepsilon}] \tag{2.4</p>
<p>è¿™æ˜¯å› ä¸ºå¯¹ä»»æ„éšæœºå˜é‡$X$å’Œå¸¸æ•°$c$:
\begin{equation}
\mathop{\text{argmin}}_c \mathbb{E}[(X-c)^2] = \mathbb{E}[X] \tag{2.5}
\end{equation}</p>
<p><strong>æ­¥éª¤3</strong> - åº”ç”¨æ¡ä»¶æœŸæœ›æ€§è´¨:</p>
<p>åˆ©ç”¨å…¬å¼(2.4):
\begin{align}
&amp;\mathbb{E}<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{x}_0,\boldsymbol{\varepsilon}}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t,t)\right\rangle\right] \tag{2.6}\
=&amp;\, \mathbb{E}</em><em _boldsymbol_varphi="\boldsymbol{\varphi">t}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}<em _boldsymbol_x="\boldsymbol{x">t,t)\right\rangle\right] \tag{2.7}\
=&amp;\, \mathbb{E}</em><em _boldsymbol_varepsilon="\boldsymbol{\varepsilon">t}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \mathbb{E}</em>}|\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t}[\boldsymbol{\varepsilon}]\right\rangle\right] \tag{2.8}\
=&amp;\, \mathbb{E}</em><em _boldsymbol_varepsilon="\boldsymbol{\varepsilon">t}\left[\mathbb{E}</em>}|\boldsymbol{x<em _boldsymbol_x="\boldsymbol{x">t}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\varepsilon}\right\rangle\right]\right] \tag{2.9}\
=&amp;\, \mathbb{E}</em><em _boldsymbol_x="\boldsymbol{x">t,\boldsymbol{\varepsilon}|\boldsymbol{x}_t}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\varepsilon}\right\rangle\right] \tag{2.10}\
=&amp;\, \mathbb{E}</em>
\end{align}}_0,\boldsymbol{\varepsilon}}\left[\left\langle\boldsymbol{f}(\boldsymbol{x}_t,t), \boldsymbol{\varepsilon}\right\rangle\right] \tag{2.11</p>
<p><strong>å…³é”®</strong>: ä»(2.8)åˆ°(2.9)åˆ©ç”¨äº†$\boldsymbol{f}$åªä¾èµ–$\boldsymbol{x}_t$çš„å‡è®¾,å¯ä»¥ç§»å‡ºæ¡ä»¶æœŸæœ›ã€‚$\square$</p>
<h4 id="23">2.3 æ’ç­‰å¼çš„é€‚ç”¨æ¡ä»¶</h4>
<p>æ’ç­‰å¼æˆç«‹çš„<strong>å¿…è¦æ¡ä»¶</strong>:
1. $\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^<em>}$å¿…é¡»æ˜¯æœ€ä¼˜è§£(æˆ–è¶³å¤Ÿæ¥è¿‘)
2. $\boldsymbol{f}(\boldsymbol{x}_t,t)$</em><em>ä¸èƒ½</em>*æ˜¾å¼ä¾èµ–$\boldsymbol{x}_0$æˆ–$\boldsymbol{\varepsilon}$</p>
<p><strong>åä¾‹</strong>: å¦‚æœ$\boldsymbol{f} = \boldsymbol{x}<em _boldsymbol_varphi="\boldsymbol{\varphi">0$,åˆ™:
\begin{align}
\text{å·¦è¾¹} &amp;= \mathbb{E}[\langle\boldsymbol{x}_0, \boldsymbol{\epsilon}</em>
\end{align}}^*}(\boldsymbol{x}_t)\rangle] \neq \mathbb{E}[\langle\boldsymbol{x}_0, \boldsymbol{\varepsilon}\rangle] = 0 = \text{å³è¾¹} \tag{2.12</p>
<h3 id="sid_1">ä¸‰ã€SiDçš„æ’ç­‰å˜æ¢æ¨å¯¼</h3>
<h4 id="31-mathcall_1mathcall_2">3.1 ä»$\mathcal{L}_1$åˆ°$\mathcal{L}_2$</h4>
<p><strong>åŸå§‹æŸå¤±</strong>:
\begin{equation}
\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">1 = \mathbb{E}\left[\Vert\boldsymbol{\epsilon}</em>^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)}) - \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)})\Vert^2\right] \tag{3.1}
\end{equation}</p>
<p><strong>æ­¥éª¤1</strong> - å±•å¼€å¹³æ–¹:
\begin{align}
\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">1 &amp;= \mathbb{E}\Big[\langle\boldsymbol{\epsilon}</em>^<em>} - \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}, \boldsymbol{\epsilon}<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{\varphi}^<em>} - \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\rangle\Big] \tag{3.2}\
&amp;= \mathbb{E}\Big[\Vert\boldsymbol{\epsilon}</em>^<em>}\Vert^2 - 2\langle\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^</em>}, \boldsymbol{\epsilon}_{\boldsymbol{\psi}^<em>}\rangle + \Vert\boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\Vert^2\Big] \tag{3.3}
\end{align}</p>
<p><strong>æ­¥éª¤2</strong> - æ£€æŸ¥æ’ç­‰å¼é€‚ç”¨æ€§:</p>
<p>åœ¨ç¬¬äºŒé¡¹ä¸­:
- $\boldsymbol{f} = \boldsymbol{\epsilon}<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{\varphi}^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)}) - \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)})$
- è¯¥å‡½æ•°ä»…ä¾èµ–$\boldsymbol{x}_t^{(g)}$,æ»¡è¶³æ¡ä»¶!
- å¯å¯¹$\boldsymbol{\epsilon}</em>$åº”ç”¨æ’ç­‰å¼}^*</p>
<p><strong>æ­¥éª¤3</strong> - åº”ç”¨æ’ç­‰å¼:
\begin{align}
&amp;\mathbb{E}\left[\langle\boldsymbol{\epsilon}<em _boldsymbol_psi="\boldsymbol{\psi">{\boldsymbol{\varphi}^<em>} - \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}, \boldsymbol{\epsilon}</em>^<em>}\rangle\right] \tag{3.4}\
=&amp;\, \mathbb{E}\left[\langle\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^</em>} - \boldsymbol{\epsilon}_{\boldsymbol{\psi}^*}, \boldsymbol{\varepsilon}\rangle\right] \tag{3.5}
\end{align}</p>
<p><strong>æœ€ç»ˆç»“æœ</strong> $\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">2$:
\begin{align}
\mathcal{L}_2 &amp;= \mathbb{E}\Big[\Vert\boldsymbol{\epsilon}</em>^<em>}\Vert^2 - 2\langle\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^</em>} - \boldsymbol{\epsilon}<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{\psi}^<em>}, \boldsymbol{\varepsilon}\rangle + \Vert\boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\Vert^2\Big] \tag{3.6}\
&amp;= \mathbb{E}\Big[\langle\boldsymbol{\epsilon}</em>^<em>} - \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}, \boldsymbol{\epsilon}_{\boldsymbol{\varphi}^*} - \boldsymbol{\varepsilon}\rangle\Big] \tag{3.7}
\end{align}</p>
<h4 id="32-mathcall_2">3.2 ä¸ºä»€ä¹ˆ$\mathcal{L}_2$æ›´å¥½?</h4>
<p><strong>ç›´è§‰ç†è§£</strong>:</p>
<p>$\mathcal{L}_2$å°†å¯¹$\boldsymbol{\psi}^<em>$çš„ä¾èµ–ä»$\boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}$æ›¿æ¢ä¸º$\boldsymbol{\varepsilon}$:
- $\boldsymbol{\varepsilon}$æ˜¯å·²çŸ¥çš„éšæœºå™ªå£°
- ä¸éœ€è¦è®¡ç®—$\boldsymbol{\psi}^*$å…³äº$\boldsymbol{\theta}$çš„æ¢¯åº¦
- éƒ¨åˆ†è§£å†³äº†é—®é¢˜2</p>
<p><strong>æ•°å­¦åˆ†æ</strong>:</p>
<p>å±•å¼€$\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">2$:
\begin{align}
\mathcal{L}_2 &amp;= \mathbb{E}\Big[\langle\boldsymbol{\epsilon}</em>^<em>}, \boldsymbol{\epsilon}_{\boldsymbol{\varphi}^</em>} - \boldsymbol{\varepsilon}\rangle - \langle\boldsymbol{\epsilon}<em _boldsymbol_varphi="\boldsymbol{\varphi">{\boldsymbol{\psi}^<em>}, \boldsymbol{\epsilon}_{\boldsymbol{\varphi}^</em>} - \boldsymbol{\varepsilon}\rangle\Big] \tag{3.8}\
&amp;= \underbrace{\mathbb{E}[\Vert\boldsymbol{\epsilon}</em>^<em>}\Vert^2 - \langle\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^</em>}, \boldsymbol{\varepsilon}\rangle]}<em _boldsymbol_varphi="\boldsymbol{\varphi">{\text{ä¸}\boldsymbol{\psi}^<em>\text{æ— å…³}} - \mathbb{E}[\langle\boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}, \boldsymbol{\epsilon}</em>
\end{align}}^*} - \boldsymbol{\varepsilon}\rangle] \tag{3.9</p>
<h3 id="fgm">å››ã€FGMçš„æ¢¯åº¦ç²¾ç¡®ä¼°è®¡</h3>
<h4 id="41">4.1 é—®é¢˜çš„ç²¾ç¡®é™ˆè¿°</h4>
<p><strong>ç›®æ ‡</strong>: æ‰¾åˆ°æŸå¤±$\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">4^{(\text{sg})}$ä½¿å¾—:
\begin{equation}
\nabla</em>^}}\mathcal{L}_4(\boldsymbol{\theta}, \text{sg}[\boldsymbol{\psi<em>]) = \nabla_{\boldsymbol{\theta}}\mathcal{L}_{1/2/3}(\boldsymbol{\theta}, \boldsymbol{\psi}^</em>) \tag{4.1}
\end{equation}</p>
<p>å…¶ä¸­$\text{sg}[\cdot]$è¡¨ç¤ºåœæ­¢æ¢¯åº¦(stop gradient)ã€‚</p>
<h4 id="42-mathcall_3">4.2 å®Œæ•´å˜æ¢çš„$\mathcal{L}_3$</h4>
<p>é¦–å…ˆå®Œæˆ$\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">2$çš„å‰©ä½™å˜æ¢:
\begin{equation}
\mathcal{L}_3 = \mathbb{E}\left[\Vert\boldsymbol{\epsilon}</em>^<em>}\Vert^2 - 2\langle\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^</em>}, \boldsymbol{\varepsilon}\rangle + \langle\boldsymbol{\epsilon}_{\boldsymbol{\psi}^*}, \boldsymbol{\varepsilon}\rangle\right] \tag{4.2}
\end{equation}</p>
<p>è¿™é‡Œå°†$\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">2$ä¸­çš„$\langle\boldsymbol{\epsilon}</em>^<em>}, \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\rangle$ä¹Ÿæ›¿æ¢ä¸º$\langle\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^*}, \boldsymbol{\varepsilon}\rangle$ã€‚</p>
<h4 id="43">4.3 å…ˆæ’ç­‰å˜æ¢åæ±‚æ¢¯åº¦</h4>
<p>å¯¹$\mathbb{E}[\Vert\boldsymbol{\epsilon}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\psi}^<em>}\Vert^2]$åº”ç”¨æ’ç­‰å¼åæ±‚å¯¼:
\begin{align}
&amp;\nabla_{\boldsymbol{\theta}}\mathbb{E}[\Vert\boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\Vert^2] \tag{4.3}\
=&amp;\, \nabla</em>^}}\mathbb{E}[\langle\boldsymbol{\epsilon}_{\boldsymbol{\psi<em>}, \boldsymbol{\varepsilon}\rangle] \quad\text{(æ’ç­‰å˜æ¢)} \tag{4.4}\
=&amp;\, \mathbb{E}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}, \boldsymbol{\varepsilon}\rangle] \tag{4.5}
\end{align}</p>
<p><strong>åˆ†è§£æ¢¯åº¦</strong>:
\begin{align}
\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}<em _text_å¯¹="\text{å¯¹">{\boldsymbol{\psi}^<em>}(\boldsymbol{x}<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}) &amp;= \underbrace{\nabla</em>^}}\boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi</em>]}(\boldsymbol{x}_t^{(g)})}</em>}\boldsymbol{x<em _boldsymbol_theta="\boldsymbol{\theta">t^{(g)}\text{æ±‚å¯¼}} + \underbrace{\nabla</em>^}}\boldsymbol{\epsilon}_{\boldsymbol{\psi<em>}(\text{sg}[\boldsymbol{x}<em _text_å¯¹="\text{å¯¹">t^{(g)}])}</em>^}\boldsymbol{\psi</em>\text{æ±‚å¯¼}} \tag{4.6}
\end{align}</p>
<p>å› æ­¤:
\begin{equation}
\text{(4.5)} = \mathbb{E}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi}^<em>]}, \boldsymbol{\varepsilon}\rangle] + \mathbb{E}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}(\text{sg}[\boldsymbol{x}_t^{(g)}]), \boldsymbol{\varepsilon}\rangle] \tag{4.7}
\end{equation}</p>
<h4 id="44">4.4 å…ˆæ±‚æ¢¯åº¦åæ’ç­‰å˜æ¢</h4>
<p>ç›´æ¥å¯¹$\mathbb{E}[\Vert\boldsymbol{\epsilon}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\psi}^<em>}\Vert^2]$æ±‚å¯¼:
\begin{align}
&amp;\nabla_{\boldsymbol{\theta}}\mathbb{E}[\Vert\boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\Vert^2] \tag{4.8}\
=&amp;\, \mathbb{E}[2\langle\nabla</em>}}\boldsymbol{\epsilon<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\psi}^<em>}, \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\rangle] \tag{4.9}\
=&amp;\, 2\mathbb{E}[\langle\nabla</em>}}\boldsymbol{\epsilon<em _boldsymbol_theta="\boldsymbol{\theta">{\text{sg}[\boldsymbol{\psi}^<em>]}, \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\rangle] + 2\mathbb{E}[\langle\nabla</em>^}}\boldsymbol{\epsilon}_{\boldsymbol{\psi<em>}(\text{sg}[\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)}]), \boldsymbol{\epsilon}</em>^</em>}\rangle] \tag{4.10}
\end{align}</p>
<p><strong>å…³é”®è§‚å¯Ÿ</strong>: åªæœ‰ç¬¬äºŒé¡¹å¯åº”ç”¨æ’ç­‰å¼!
\begin{equation}
\text{(4.10)} = 2\mathbb{E}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}<em _boldsymbol_theta="\boldsymbol{\theta">{\text{sg}[\boldsymbol{\psi}^<em>]}, \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\rangle] + 2\mathbb{E}[\langle\nabla</em>
\end{equation}}}\boldsymbol{\epsilon}_{\boldsymbol{\psi}^*}(\text{sg}[\boldsymbol{x}_t^{(g)}]), \boldsymbol{\varepsilon}\rangle] \tag{4.11</p>
<h4 id="45-mathcall_4">4.5 æ¨å¯¼$\mathcal{L}_4$</h4>
<p>è”ç«‹(4.7)å’Œ(4.11),è®¡ç®—$2\times$(4.7)$-$(4.11):
\begin{align}
&amp;\nabla_{\boldsymbol{\theta}}\mathbb{E}[\langle\boldsymbol{\epsilon}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\psi}^<em>}, \boldsymbol{\varepsilon}\rangle] \tag{4.12}\
=&amp;\, 2\mathbb{E}[\langle\nabla_{\boldsymbol{\theta}}\boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi}^</em>]}, \boldsymbol{\varepsilon}\rangle] - 2\mathbb{E}[\langle\nabla</em>}}\boldsymbol{\epsilon<em _boldsymbol_theta="\boldsymbol{\theta">{\text{sg}[\boldsymbol{\psi}^<em>]}, \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\rangle] \tag{4.13}\
=&amp;\, 2\nabla</em>}}\mathbb{E}[\langle\boldsymbol{\epsilon<em _boldsymbol_theta="\boldsymbol{\theta">{\text{sg}[\boldsymbol{\psi}^<em>]}, \boldsymbol{\varepsilon}\rangle] - \nabla_{\boldsymbol{\theta}}\mathbb{E}[\Vert\boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi}^</em>]}\Vert^2] \tag{4.14}\
=&amp;\, \nabla</em>^}}\mathbb{E}[2\langle\boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi<em>]}, \boldsymbol{\varepsilon}\rangle - \Vert\boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi}^</em>]}\Vert^2] \tag{4.15}
\end{align}</p>
<p><strong>æœ€ç»ˆçš„$\mathcal{L}_4$</strong>:</p>
<p>å°†(4.15)ä»£å…¥$\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">3$:
\begin{equation}
\mathcal{L}_4^{(\text{sg})} = \mathbb{E}\left[\Vert\boldsymbol{\epsilon}</em>^<em>}\Vert^2 - 2\langle\boldsymbol{\epsilon}_{\boldsymbol{\varphi}^</em>}, \boldsymbol{\varepsilon}\rangle + 2\langle\boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi}^<em>]}, \boldsymbol{\varepsilon}\rangle - \Vert\boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi}^</em>]}\Vert^2\right] \tag{4.16}
\end{equation}</p>
<h4 id="46-sid">4.6 ä¸SiDçš„å…³ç³»</h4>
<p>æ•´ç†$\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">4$:
\begin{align}
\mathcal{L}_4^{(\text{sg})} &amp;= \mathbb{E}\Big[\langle\boldsymbol{\epsilon}</em>^<em>} - \boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi}^</em>]}, \boldsymbol{\epsilon}<em _text_sg="\text{sg">{\boldsymbol{\varphi}^<em>} - \boldsymbol{\varepsilon}\rangle - \langle\boldsymbol{\epsilon}_{\text{sg}[\boldsymbol{\psi}^</em>]}, \boldsymbol{\epsilon}</em>\
&amp;= 2\mathcal{L}_2^{(\text{sg})} - \mathcal{L}_1^{(\text{sg})} \tag{4.18}\
&amp;= 2(\mathcal{L}_2^{(\text{sg})} - 0.5\mathcal{L}_1^{(\text{sg})}) \tag{4.19}
\end{equation}}[\boldsymbol{\psi}^*]} - \boldsymbol{\varepsilon}\rangle\Big] \tag{4.17</p>
<p><strong>ç»“è®º</strong>: FGMè¯æ˜äº†SiDçš„$\lambda=0.5$é€‰æ‹©!</p>
<h3 id="fisher">äº”ã€å¹¿ä¹‰Fisheræ•£åº¦ç†è®º</h3>
<h4 id="51">5.1 å›é¡¾å¾—åˆ†åŒ¹é…è§†è§’</h4>
<p>åˆ©ç”¨$\boldsymbol{\epsilon}<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\varphi}^<em>} = -\bar{\beta}<em _boldsymbol_psi="\boldsymbol{\psi">t\nabla\log p$å’Œ$\boldsymbol{\epsilon}</em>^</em>} = -\bar{\beta}_t\nabla\log p</em>$:}</p>
<p>\begin{align}
\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">1 &amp;= \mathbb{E}\left[\Vert\boldsymbol{\epsilon}</em>^<em>} - \boldsymbol{\epsilon}_{\boldsymbol{\psi}^</em>}\Vert^2\right] \tag{5.1}\
&amp;= \bar{\beta}<em _boldsymbol_theta="\boldsymbol{\theta">t^2\mathbb{E}\left[\Vert\nabla\log p</em>\
&amp;= \bar{\beta}}} - \nabla\log p\Vert^2\right] \tag{5.2<em _boldsymbol_theta="\boldsymbol{\theta">t^2\int p</em>\
&amp;= \bar{\beta}}}(\boldsymbol{x})\left\Vert\nabla\log p_{\boldsymbol{\theta}} - \nabla\log p\right\Vert^2 d\boldsymbol{x} \tag{5.3<em _boldsymbol_theta="\boldsymbol{\theta">t^2 \mathcal{F}(p, p</em>
\end{align}}}) \tag{5.4</p>
<p>è¿™å°±æ˜¯<strong>Fisheræ•£åº¦</strong>ã€‚</p>
<h4 id="52-fisherp_boldsymboltheta">5.2 åˆ†æFisheræ•£åº¦çš„ä¸¤å¤„$p_{\boldsymbol{\theta}}$</h4>
<p>å…¬å¼(5.3)ä¸­$p_{\boldsymbol{\theta}}$å‡ºç°ä¸¤æ¬¡:
1. <strong>ç§¯åˆ†æµ‹åº¦</strong>: $p_{\boldsymbol{\theta}}(\boldsymbol{x})d\boldsymbol{x}$
2. <strong>æ•£åº¦å†…éƒ¨</strong>: $\nabla\log p_{\boldsymbol{\theta}}$</p>
<p><strong>å®éªŒ</strong>: å›ºå®šå…¶ä¸­ä¸€å¤„,ä¼˜åŒ–å¦ä¸€å¤„</p>
<p><strong>å®éªŒ1</strong> - å›ºå®šæµ‹åº¦,ä¼˜åŒ–æ•£åº¦:
\begin{equation}
\min_{p_{\boldsymbol{\theta}}} \int \underbrace{p_0(\boldsymbol{x})}<em _boldsymbol_theta="\boldsymbol{\theta">{\text{å›ºå®š}} \left\Vert\nabla\log p</em>
\end{equation}}}(\boldsymbol{x}) - \nabla\log p(\boldsymbol{x})\right\Vert^2 d\boldsymbol{x} \tag{5.5</p>
<p>ç”±äº$\Vert\cdot\Vert^2$çš„å¼ºå‡¸æ€§,æœ€ä¼˜è§£ä»æ˜¯$p_{\boldsymbol{\theta}}=p$ã€‚</p>
<p><strong>å®éªŒ2</strong> - å›ºå®šæ•£åº¦,ä¼˜åŒ–æµ‹åº¦:
\begin{equation}
\min_{p_{\boldsymbol{\theta}}} \int p_{\boldsymbol{\theta}}(\boldsymbol{x}) \underbrace{\left\Vert\nabla\log p_0(\boldsymbol{x}) - \nabla\log p(\boldsymbol{x})\right\Vert^2}_{\text{å›ºå®š}=:c(\boldsymbol{x})} d\boldsymbol{x} \tag{5.6}
\end{equation}</p>
<p>æœ€ä¼˜è§£æ˜¯:
\begin{equation}
p_{\boldsymbol{\theta}}^<em>(\boldsymbol{x}) = \delta(\boldsymbol{x} - \boldsymbol{x}^</em>), \quad \boldsymbol{x}^* = \mathop{\text{argmin}}_{\boldsymbol{x}} c(\boldsymbol{x}) \tag{5.7}
\end{equation}</p>
<p>è¿™æ˜¯<strong>æ¨¡å¼åç¼©</strong>(Mode Collapse)!</p>
<h4 id="53-fisher">5.3 å¹¿ä¹‰Fisheræ•£åº¦</h4>
<p><strong>å®šä¹‰</strong>: å¯¹ä»»æ„åˆ†å¸ƒ$r(\boldsymbol{x})$:
\begin{equation}
\mathcal{F}(p,q|r) := \int r(\boldsymbol{x}) \left\Vert\nabla\log q(\boldsymbol{x}) - \nabla\log p(\boldsymbol{x})\right\Vert^2 d\boldsymbol{x} \tag{5.8}
\end{equation}</p>
<p><strong>æ€§è´¨</strong>: è‹¥$r(\boldsymbol{x}) &gt; 0$å¤„å¤„æˆç«‹,åˆ™$\mathcal{F}(p,q|r) \geq 0$ä¸”ç­‰å·æˆç«‹å½“ä¸”ä»…å½“$p=q$ã€‚</p>
<p><strong>è¯æ˜</strong>:
\begin{align}
\mathcal{F}(p,q|r) &amp;= \int r(\boldsymbol{x}) \Vert\nabla\log q - \nabla\log p\Vert^2 d\boldsymbol{x} \tag{5.9}\
&amp;= 0 \iff \nabla\log q = \nabla\log p \quad r\text{-a.e.} \tag{5.10}\
&amp;\iff q(\boldsymbol{x}) = C\cdot p(\boldsymbol{x}) \tag{5.11}
\end{align}</p>
<p>ç”±äº$\int q = \int p = 1$,å¾—$C=1$,å³$q=p$ã€‚$\square$</p>
<h4 id="54-fishermathcalf">5.4 ä¿®æ­£çš„Fisheræ•£åº¦$\mathcal{F}^+$</h4>
<p><strong>å…³é”®æ€æƒ³</strong>: åœ¨ç¬¬ä¸€å¤„$p_{\boldsymbol{\theta}}$ä¸Šåœæ­¢æ¢¯åº¦:
\begin{align}
\mathcal{F}^+(p, p_{\boldsymbol{\theta}}) &amp;= \int p_{\text{sg}[\boldsymbol{\theta}]}(\boldsymbol{x}) \left\Vert\nabla\log p_{\boldsymbol{\theta}}(\boldsymbol{x}) - \nabla\log p(\boldsymbol{x})\right\Vert^2 d\boldsymbol{x} \tag{5.12}\
&amp;= \mathbb{E}<em _text_sg="\text{sg">{\boldsymbol{x}\sim p</em>
\end{align}}[\boldsymbol{\theta}]}}\left[\left\Vert\nabla\log p_{\boldsymbol{\theta}}(\text{sg}[\boldsymbol{x}]) - \nabla\log p(\text{sg}[\boldsymbol{x}])\right\Vert^2\right] \tag{5.13</p>
<p>è½¬æ¢å›å™ªå£°é¢„æµ‹:
\begin{equation}
\mathcal{L}<em _boldsymbol_varphi="\boldsymbol{\varphi">5 = \mathbb{E}\left[\Vert\boldsymbol{\epsilon}</em>^<em>}(\text{sg}[\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)}]) - \boldsymbol{\epsilon}</em>^</em>}(\text{sg}[\boldsymbol{x}_t^{(g)}])\Vert^2\right] \tag{5.14}
\end{equation}</p>
<h4 id="55-mathcall_5">5.5 $\mathcal{L}_5$çš„æ¢¯åº¦åˆ†è§£</h4>
<p>è®¡ç®—$\nabla_{\boldsymbol{\theta}}\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">5$å’Œ$\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">1$çš„å…³ç³»:
\begin{align}
\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">5 &amp;= \nabla</em>}}\mathbb{E}\left[\Vert\boldsymbol{\epsilon<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\varphi}^<em>}(\text{sg}[\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)}]) - \boldsymbol{\epsilon}</em>^</em>}(\text{sg}[\boldsymbol{x}_t^{(g)}])\Vert^2\right] \tag{5.15}\
&amp;= \nabla</em>}}\mathbb{E}\left[\Vert\boldsymbol{\epsilon<em _boldsymbol_theta="\boldsymbol{\theta">{\boldsymbol{\varphi}^<em>}(\boldsymbol{x}<em _boldsymbol_psi="\boldsymbol{\psi">t^{(g)}) - \boldsymbol{\epsilon}</em>^</em>}(\boldsymbol{x}_t^{(g)})\Vert^2\right] - \nabla</em>}}\underbrace{\mathbb{E}\left[\Vert\boldsymbol{\epsilon<em _mathcal_L="\mathcal{L">{\boldsymbol{\varphi}^<em>}(\boldsymbol{x}<em _text_sg="\text{sg">t^{(g)}) - \boldsymbol{\epsilon}</em>^}[\boldsymbol{\psi</em>]}(\boldsymbol{x}_t^{(g)})\Vert^2\right]}</em><em _boldsymbol_theta="\boldsymbol{\theta">1^{(\text{sg})}} \tag{5.16}\
&amp;= \nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">1 - \nabla</em>
\end{align}}}\mathcal{L}_1^{(\text{sg})} \tag{5.17</p>
<p>ç»“åˆFGMçš„ç»“æœ:
\begin{align}
\nabla_{\boldsymbol{\theta}}\mathcal{L}<em _boldsymbol_theta="\boldsymbol{\theta">5 &amp;= \nabla</em>}}(2\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">2^{(\text{sg})} - \mathcal{L}_1^{(\text{sg})}) - \nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">1^{(\text{sg})} \tag{5.18}\
&amp;= 2\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">2^{(\text{sg})} - 2\nabla</em>}}\mathcal{L<em _boldsymbol_theta="\boldsymbol{\theta">1^{(\text{sg})} \tag{5.19}\
&amp;= 2\nabla</em>
\end{align}}}(\mathcal{L}_2^{(\text{sg})} - \mathcal{L}_1^{(\text{sg})}) \tag{5.20</p>
<p><strong>ç»“è®º</strong>: è¿™å¯¹åº”SiDçš„$\lambda=1$!</p>
<h3 id="_8">å…­ã€ç†è®ºå¯¹æ¯”ä¸ç»Ÿä¸€</h3>
<h4 id="61">6.1 ä¸‰ç§æŸå¤±çš„å…³ç³»æ€»ç»“</h4>
<p>\begin{align}
\mathcal{L}_1 &amp;: \text{æœ´ç´ æŸå¤±,ç†è®ºæ­£ç¡®ä½†å®è·µæ¢¯åº¦æœ‰å} \tag{6.1}\
\mathcal{L}_2 &amp;: \text{SiDæå‡º,éƒ¨åˆ†æ’ç­‰å˜æ¢} \tag{6.2}\
\mathcal{L}_3 &amp;: \text{å®Œå…¨æ’ç­‰å˜æ¢} \tag{6.3}\
\mathcal{L}_4 &amp;: \text{FGMæå‡º,æ¢¯åº¦ç²¾ç¡®åŒ¹é…} \tag{6.4}\
\mathcal{L}_5 &amp;: \text{ä¿®æ­£Fisheræ•£åº¦,å¯¹åº”}\lambda=1 \tag{6.5}
\end{align}</p>
<p><strong>æ¢¯åº¦å…³ç³»</strong>:
\begin{align}
\nabla\mathcal{L}_1 &amp;= \nabla\mathcal{L}_2 = \nabla\mathcal{L}_3 \quad\text{(ç†è®ºä¸Š)} \tag{6.6}\
\nabla\mathcal{L}_4^{(\text{sg})} &amp;= \nabla\mathcal{L}_1 = 2\nabla(\mathcal{L}_2^{(\text{sg})} - 0.5\mathcal{L}_1^{(\text{sg})}) \tag{6.7}\
\nabla\mathcal{L}_5 &amp;= \nabla\mathcal{L}_1 - \nabla\mathcal{L}_1^{(\text{sg})} = 2\nabla(\mathcal{L}_2^{(\text{sg})} - \mathcal{L}_1^{(\text{sg})}) \tag{6.8}
\end{align}</p>
<h4 id="62-lambda">6.2 $\lambda$å‚æ•°çš„ç†è®ºè§£é‡Š</h4>
<p>SiDå®é™…ä½¿ç”¨:
\begin{equation}
\mathcal{L}_{\text{SiD}} = \mathcal{L}_2^{(\text{sg})} - \lambda\mathcal{L}_1^{(\text{sg})} \tag{6.9}
\end{equation}</p>
<p><strong>ä¸‰ç§é€‰æ‹©</strong>:</p>
<ol>
<li><strong>$\lambda=0$</strong>: åªç”¨$\mathcal{L}_2$,å¿½ç•¥åŸå§‹ç›®æ ‡</li>
<li><strong>$\lambda=0.5$</strong>: FGMè¯æ˜çš„æ¢¯åº¦ç²¾ç¡®åŒ¹é…</li>
<li><strong>$\lambda=1$</strong>: ä¿®æ­£Fisheræ•£åº¦,é¿å…æ¨¡å¼åç¼©</li>
</ol>
<p><strong>å®éªŒè§‚å¯Ÿ</strong>: $\lambda\in[0.5, 1.2]$æ•ˆæœå¥½,éªŒè¯ç†è®ºé¢„æµ‹ã€‚</p>
<h3 id="_9">ä¸ƒã€å®ç°ç»†èŠ‚ä¸æŠ€å·§</h3>
<h4 id="71">7.1 åœæ­¢æ¢¯åº¦çš„æ­£ç¡®å®ç°</h4>
<p><strong>PyTorchç¤ºä¾‹</strong>:</p>
<div class="codehilite"><pre><span></span><code><span class="c1"># è®¡ç®—L2</span>
<span class="n">eps_teacher</span> <span class="o">=</span> <span class="n">teacher_model</span><span class="p">(</span><span class="n">x_t_gen</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># æ•™å¸ˆæ¨¡å‹</span>
<span class="n">eps_student</span> <span class="o">=</span> <span class="n">student_model</span><span class="p">(</span><span class="n">x_t_gen</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>  <span class="c1"># å­¦ç”Ÿæ¨¡å‹</span>

<span class="c1"># SiD (lambda=0.5)</span>
<span class="n">L2</span> <span class="o">=</span> <span class="p">((</span><span class="n">eps_teacher</span> <span class="o">-</span> <span class="n">eps_student</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">eps_teacher</span> <span class="o">-</span> <span class="n">eps</span><span class="p">))</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">L1_sg</span> <span class="o">=</span> <span class="p">((</span><span class="n">eps_teacher</span> <span class="o">-</span> <span class="n">eps_student</span><span class="o">.</span><span class="n">detach</span><span class="p">())</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">loss_gen</span> <span class="o">=</span> <span class="n">L2</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">L1_sg</span>

<span class="c1"># ä¿®æ­£Fisher (lambda=1)</span>
<span class="n">loss_gen_fisher</span> <span class="o">=</span> <span class="n">L2</span> <span class="o">-</span> <span class="n">L1_sg</span>
</code></pre></div>

<h4 id="72">7.2 æ•°å€¼ç¨³å®šæ€§</h4>
<p><strong>é—®é¢˜</strong>: $\Vert\nabla D\Vert^2$é¡¹å¯èƒ½æ•°å€¼ä¸ç¨³å®š</p>
<p><strong>è§£å†³</strong>:
1. æ¢¯åº¦è£å‰ª
2. å½’ä¸€åŒ–
3. ä½¿ç”¨EMA(æŒ‡æ•°ç§»åŠ¨å¹³å‡)</p>
<h3 id="_10">å…«ã€æ‰©å±•åº”ç”¨</h3>
<h4 id="81">8.1 å¤šæ­¥è’¸é¦</h4>
<p>æ‰©å±•åˆ°$k$æ­¥è’¸é¦:
\begin{equation}
\boldsymbol{x}<em _text_student="\text{student">0^{(k)} = \text{Solve-ODE-k-steps}(\boldsymbol{x}_T, \boldsymbol{\epsilon}</em>
\end{equation}}}) \tag{8.1</p>
<p>æŸå¤±å˜ä¸º:
\begin{equation}
\mathcal{L}<em i="0">{\text{multi}} = \sum</em>
\end{equation}}^{k-1} w_i\left[\mathcal{L}_2^{(i)} - \lambda\mathcal{L}_1^{(i)}\right] \tag{8.2</p>
<h4 id="82">8.2 æ¡ä»¶ç”Ÿæˆ</h4>
<p>å¯¹äºæ¡ä»¶æ‰©æ•£æ¨¡å‹$\boldsymbol{\epsilon}(\boldsymbol{x}<em _text_cond="\text{cond">t, t, \boldsymbol{c})$:
\begin{equation}
\mathcal{L}</em>}} = \mathbb{E<em _text_T="\text{T">{\boldsymbol{c},\boldsymbol{x}_0,\boldsymbol{\varepsilon}}\left[\langle\boldsymbol{\epsilon}</em>}} - \boldsymbol{\epsilon<em _text_T="\text{T">{\text{S}}, \boldsymbol{\epsilon}</em>
\end{equation}}} - \boldsymbol{\varepsilon}\rangle\right] \tag{8.3</p>
<p>æ’ç­‰å¼ä»ç„¶æˆç«‹!</p>
<h3 id="_11">ä¹ã€æ ¸å¿ƒæ´å¯Ÿä¸æ€»ç»“</h3>
<p><strong>æ´å¯Ÿ1 - æ’ç­‰å¼çš„åŠ›é‡</strong>:
æ’ç­‰å¼$\mathbb{E}[\langle\boldsymbol{f}, \boldsymbol{\epsilon}^<em>\rangle] = \mathbb{E}[\langle\boldsymbol{f}, \boldsymbol{\varepsilon}\rangle]$æ˜¯SiD/FGMçš„ç†è®ºåŸºçŸ³,å®ƒå…è®¸æˆ‘ä»¬ç”¨å·²çŸ¥çš„$\boldsymbol{\varepsilon}$æ›¿æ¢æœªçŸ¥çš„$\boldsymbol{\epsilon}^</em>$ã€‚</p>
<p><strong>æ´å¯Ÿ2 - æ¢¯åº¦åŒ¹é…çš„ç²¾å¦™</strong>:
FGMé€šè¿‡"å…ˆå˜æ¢åæ±‚å¯¼"vs"å…ˆæ±‚å¯¼åå˜æ¢"çš„å¯¹æ¯”,å·§å¦™åœ°æ‰¾åˆ°äº†æ¢¯åº¦ç²¾ç¡®åŒ¹é…çš„æŸå¤±å‡½æ•°ã€‚</p>
<p><strong>æ´å¯Ÿ3 - Fisheræ•£åº¦çš„åŒé‡è§’è‰²</strong>:
Fisheræ•£åº¦ä¸­çš„ä¸¤å¤„$p_{\boldsymbol{\theta}}$æœ‰ä¸åŒä½œç”¨:
- ç§¯åˆ†æµ‹åº¦: å¯èƒ½å¯¼è‡´æ¨¡å¼åç¼©
- æ•£åº¦å†…éƒ¨: æ‰æ˜¯çœŸæ­£çš„ä¼˜åŒ–ç›®æ ‡</p>
<p><strong>æ´å¯Ÿ4 - $\lambda$çš„ç†è®ºä¾æ®</strong>:
- $\lambda=0.5$: æ¢¯åº¦ç²¾ç¡®åŒ¹é…(FGM)
- $\lambda=1.0$: é¿å…æ¨¡å¼åç¼©(ä¿®æ­£Fisher)
- $\lambda&gt;1.0$: é¢å¤–æ­£åˆ™åŒ–</p>
<p><strong>æœªæ¥æ–¹å‘</strong>:
1. æ›´é«˜é˜¶çš„æ’ç­‰å˜æ¢
2. è‡ªé€‚åº”$\lambda$é€‰æ‹©
3. æ‰©å±•åˆ°å…¶ä»–ç”Ÿæˆæ¨¡å‹</p>
        </div>
    </div>
</body>
</html>