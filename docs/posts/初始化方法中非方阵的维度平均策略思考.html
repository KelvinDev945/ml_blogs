<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆå§‹åŒ–æ–¹æ³•ä¸­éæ–¹é˜µçš„ç»´åº¦å¹³å‡ç­–ç•¥æ€è€ƒ | ML & Math Blog Posts</title>
    <meta name="description" content="åˆå§‹åŒ–æ–¹æ³•ä¸­éæ–¹é˜µçš„ç»´åº¦å¹³å‡ç­–ç•¥æ€è€ƒ&para;
åŸæ–‡é“¾æ¥: https://spaces.ac.cn/archives/8725
å‘å¸ƒæ—¥æœŸ: 2021-10-18



### æ ¸å¿ƒé—®é¢˜

å¯¹äº $m \times n$ çš„éæ–¹é˜µæƒé‡çŸ©é˜µï¼Œå¦‚ä½•é€‰æ‹©åˆå§‹åŒ–æ–¹å·®ä»¥åŒæ—¶æ»¡è¶³ï¼š
- å‰å‘ä¼ æ’­æ—¶ä¿¡å·æ–¹å·®ä¿æŒç¨³å®š
- åå‘ä¼ æ’­æ—¶æ¢¯åº¦æ–¹å·®ä¿æŒç¨³å®š

**ä¸‰ç§å€™é€‰å¹³å‡ç­–ç•¥**ï¼š
1. **å‡ ä½•å¹³å‡**ï¼š$\sq...">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css">

    <!-- Google Fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/post.css">

    <!-- Custom JS -->
    <script src="../assets/js/collapsible.js" defer></script>

    <!-- MathJax for math rendering with equation numbering -->
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        tags: 'ams',  // Enable equation numbering with AMS style
        tagSide: 'right',  // Place equation numbers on the right
        tagIndent: '0.8em',  // Indentation for equation numbers
        multlineWidth: '85%'
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Syntax highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/github.min.css">
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/highlight.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
        <div class="container">
            <a class="navbar-brand" href="../index.html">
                <i class="fas fa-brain"></i> ML & Math Blog
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html"><i class="fas fa-home"></i> é¦–é¡µ</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Post Content -->
    <article class="container post-container my-5">
        <!-- Breadcrumb Navigation -->
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../index.html"><i class="fas fa-home"></i> é¦–é¡µ</a></li>
                
                <li class="breadcrumb-item"><a href="../index.html?tags=æ¨¡å‹">æ¨¡å‹</a></li>
                
                <li class="breadcrumb-item active" aria-current="page">
                    #148 åˆå§‹åŒ–æ–¹æ³•ä¸­éæ–¹é˜µçš„ç»´åº¦å¹³å‡ç­–ç•¥æ€è€ƒ
                </li>
            </ol>
        </nav>

        <!-- Post Header -->
        <header class="post-header mb-4">
            <h1 class="post-title">
                <span class="post-number">#148</span>
                åˆå§‹åŒ–æ–¹æ³•ä¸­éæ–¹é˜µçš„ç»´åº¦å¹³å‡ç­–ç•¥æ€è€ƒ
            </h1>
            <div class="post-meta">
                <span><i class="far fa-calendar"></i> 2021-10-18</span>
                
            </div>
            
            <div class="post-tags mt-3">
                
                <a href="../index.html?tags=æ¨¡å‹" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> æ¨¡å‹</span>
                </a>
                
                <a href="../index.html?tags=ä¼˜åŒ–" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> ä¼˜åŒ–</span>
                </a>
                
                <a href="../index.html?tags=æ¢¯åº¦" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> æ¢¯åº¦</span>
                </a>
                
                <a href="../index.html?tags=åˆå§‹åŒ–" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> åˆå§‹åŒ–</span>
                </a>
                
                <a href="../index.html?tags=Xavier" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> Xavier</span>
                </a>
                
                <a href="../index.html?tags=æ–¹å·®ä¼ æ’­" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> æ–¹å·®ä¼ æ’­</span>
                </a>
                
            </div>
            
        </header>

        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-9">
                <!-- Post Body -->
                <div class="post-content">
                    <h1 id="_1">åˆå§‹åŒ–æ–¹æ³•ä¸­éæ–¹é˜µçš„ç»´åº¦å¹³å‡ç­–ç•¥æ€è€ƒ<a class="toc-link" href="#_1" title="Permanent link">&para;</a></h1>
<p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/8725">https://spaces.ac.cn/archives/8725</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: 2021-10-18</p>
<hr />
<div class="theorem-box">

### æ ¸å¿ƒé—®é¢˜

å¯¹äº $m \times n$ çš„éæ–¹é˜µæƒé‡çŸ©é˜µï¼Œå¦‚ä½•é€‰æ‹©åˆå§‹åŒ–æ–¹å·®ä»¥åŒæ—¶æ»¡è¶³ï¼š
- å‰å‘ä¼ æ’­æ—¶ä¿¡å·æ–¹å·®ä¿æŒç¨³å®š
- åå‘ä¼ æ’­æ—¶æ¢¯åº¦æ–¹å·®ä¿æŒç¨³å®š

**ä¸‰ç§å€™é€‰å¹³å‡ç­–ç•¥**ï¼š
1. **å‡ ä½•å¹³å‡**ï¼š$\sqrt{mn}$ ï¼ˆå…¨å±€æœ€ä¼˜ï¼‰
2. **ä»£æ•°å¹³å‡**ï¼š$(m+n)/2$ ï¼ˆXavieråˆå§‹åŒ–ï¼Œä¸­åº¸ä¹‹é“ï¼‰
3. **äºŒæ¬¡å¹³å‡**ï¼š$(m^2+n^2)/(m+n)$ ï¼ˆå±€éƒ¨æœ€ä¼˜ï¼‰

</div>

<hr />
<h2 id="_2">ä¸€ã€é—®é¢˜çš„èƒŒæ™¯<a class="toc-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>åœ¨ã€Šä»å‡ ä½•è§†è§’æ¥ç†è§£æ¨¡å‹å‚æ•°çš„åˆå§‹åŒ–ç­–ç•¥ã€‹ã€ã€Šæµ…è°ˆTransformerçš„åˆå§‹åŒ–ã€å‚æ•°åŒ–ä¸æ ‡å‡†åŒ–ã€‹ç­‰æ–‡ç« ï¼Œæˆ‘ä»¬è®¨è®ºè¿‡æ¨¡å‹çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œå¤§è‡´çš„æ€è·¯æ˜¯ï¼š</p>
<div class="intuition-box">

### ğŸ§  æ–¹é˜µåˆå§‹åŒ–çš„æ ¸å¿ƒæ€æƒ³

å¦‚æœä¸€ä¸ª $n\times n$ çš„æ–¹é˜µç”¨**å‡å€¼ä¸º0ã€æ–¹å·®ä¸º $1/n$ çš„ç‹¬ç«‹åŒåˆ†å¸ƒ**åˆå§‹åŒ–ï¼Œé‚£ä¹ˆè¿‘ä¼¼äºä¸€ä¸ª**æ­£äº¤çŸ©é˜µ**ï¼Œä½¿å¾—æ•°æ®äºŒé˜¶çŸ©ï¼ˆæˆ–æ–¹å·®ï¼‰åœ¨ä¼ æ’­è¿‡ç¨‹ä¸­å¤§è‡´ä¿æŒä¸å˜ã€‚

**ç›´è§‚ç†è§£**ï¼šæ­£äº¤çŸ©é˜µä¿æŒå‘é‡çš„èŒƒæ•°ï¼Œä»è€Œä¿æŒèƒ½é‡ï¼ˆæ–¹å·®ï¼‰ã€‚

</div>

<p><strong>ä½†é—®é¢˜æ¥äº†</strong>ï¼šå¦‚æœæ˜¯ $m\times n$ çš„éæ–¹é˜µå‘¢ï¼Ÿ</p>
<p>å¸¸è§çš„æ€è·¯ï¼ˆXavieråˆå§‹åŒ–ï¼‰æ˜¯ç»¼åˆè€ƒè™‘å‰å‘ä¼ æ’­å’Œåå‘ä¼ æ’­ï¼Œæ‰€ä»¥ä½¿ç”¨å‡å€¼ä¸º0ã€æ–¹å·®ä¸º $2/(m+n)$ çš„ç‹¬ç«‹åŒåˆ†å¸ƒåˆå§‹åŒ–ã€‚ä½†è¿™ä¸ªå¹³å‡æ›´å¤šæ˜¯"æ‹è„‘è¢‹"çš„ï¼Œæœ¬æ–‡å°±æ¥æ¢ç©¶ä¸€ä¸‹æœ‰æ²¡æœ‰æ›´å¥½çš„å¹³å‡æ–¹æ¡ˆã€‚</p>
<hr />
<h2 id="_3">äºŒã€åŸºç¡€æ¨å¯¼å›é¡¾<a class="toc-link" href="#_3" title="Permanent link">&para;</a></h2>
<h3 id="21">2.1 å…¨è¿æ¥å±‚çš„å‰å‘ä¼ æ’­<a class="toc-link" href="#21" title="Permanent link">&para;</a></h3>
<p>è€ƒè™‘å¦‚ä¸‹çš„å…¨è¿æ¥å±‚ï¼ˆè®¾è¾“å…¥èŠ‚ç‚¹æ•°ä¸º $m$ï¼Œè¾“å‡ºèŠ‚ç‚¹æ•°ä¸º $n$ï¼‰ï¼š</p>
<p>$$
y_j = b_j + \sum_{i=1}^m x_i w_{i,j}
\tag{1}
$$</p>
<div class="derivation-box">

### å‰å‘ä¼ æ’­çš„æ–¹å·®åˆ†æ

<div class="formula-explanation">

<div class="formula-step">
<div class="step-label">å‡è®¾æ¡ä»¶</div>

- $b_j$ åˆå§‹åŒ–ä¸º0
- $w_{i,j}$ çš„åˆå§‹åŒ–å‡å€¼ä¸º0
- $x_i$ ä¸ $w_{i,j}$ ç‹¬ç«‹
- å„ $w_{i,j}$ ç‹¬ç«‹åŒåˆ†å¸ƒ

</div>

<div class="formula-step">
<div class="step-label">è®¡ç®—äºŒé˜¶çŸ©</div>

$$
\begin{aligned}
\mathbb{E}[y_j^2]
&= \mathbb{E}\left[\left(\sum_{i=1}^m x_i w_{i,j}\right)^2\right] \\
&= \mathbb{E}\left[\sum_{i=1}^m \sum_{k=1}^m x_i x_k w_{i,j} w_{k,j}\right]
\end{aligned}
\tag{2}
$$

<div class="step-explanation">

**ç‹¬ç«‹æ€§ç®€åŒ–**ï¼šç”±äº $w_{i,j}$ ç‹¬ç«‹ï¼Œå½“ $i \neq k$ æ—¶ï¼š
$$
\mathbb{E}[x_i x_k w_{i,j} w_{k,j}] = \mathbb{E}[x_i x_k] \cdot \mathbb{E}[w_{i,j}] \cdot \mathbb{E}[w_{k,j}] = 0
$$

å› ä¸º $\mathbb{E}[w_{i,j}] = 0$ã€‚

</div>
</div>

<div class="formula-step">
<div class="step-label">ä»…ä¿ç•™å¯¹è§’é¡¹</div>

$$
\mathbb{E}[y_j^2] = \sum_{i=1}^m \mathbb{E}[x_i^2] \mathbb{E}[w_{i,j}^2]
= m \cdot \mathbb{E}[x_i^2] \cdot \mathbb{E}[w_{i,j}^2]
\tag{3}
$$

<div class="step-explanation">

**åŒåˆ†å¸ƒå‡è®¾**ï¼š$x_i$ åŒåˆ†å¸ƒï¼Œ$w_{i,j}$ åŒåˆ†å¸ƒã€‚

</div>
</div>

<div class="formula-step">
<div class="step-label">æ–¹å·®ä¿æŒæ¡ä»¶</div>

ä¸ºäº†ä¿æŒäºŒé˜¶çŸ©ä¸å˜ï¼ˆ$\mathbb{E}[y_j^2] = \mathbb{E}[x_i^2]$ï¼‰ï¼Œéœ€è¦ï¼š

$$
m \cdot \mathbb{E}[w_{i,j}^2] = 1
\quad \Rightarrow \quad
\boxed{\mathbb{E}[w_{i,j}^2] = \frac{1}{m}}
\tag{4}
$$

**ç»“è®º**ï¼šå‰å‘ä¼ æ’­è¦æ±‚æ–¹å·®ä¸º $1/m$ï¼ˆä¸è¾“å…¥ç»´åº¦æˆåæ¯”ï¼‰ã€‚

</div>

</div>

</div>

</div>
<h3 id="22">2.2 å…¨è¿æ¥å±‚çš„åå‘ä¼ æ’­<a class="toc-link" href="#22" title="Permanent link">&para;</a></h3>
<p>å‡è®¾æ¨¡å‹çš„æŸå¤±å‡½æ•°ä¸º $l$ï¼Œæ ¹æ®é“¾å¼æ³•åˆ™ï¼š</p>
<p>$$
\frac{\partial l}{\partial x_i} = \sum_{j=1}^n \frac{\partial l}{\partial y_j} \frac{\partial y_j}{\partial x_i}
= \sum_{j=1}^n \frac{\partial l}{\partial y_j} w_{i,j}
\tag{5}
$$</p>
<div class="derivation-box">

### åå‘ä¼ æ’­çš„æ–¹å·®åˆ†æ

<div class="formula-explanation">

<div class="formula-step">
<div class="step-label">æ³¨æ„æ±‚å’Œç»´åº¦çš„å˜åŒ–</div>

- å‰å‘ä¼ æ’­ï¼šå¯¹è¾“å…¥ç»´åº¦ $i$ æ±‚å’Œï¼ˆç»´åº¦ $m$ï¼‰
- åå‘ä¼ æ’­ï¼šå¯¹è¾“å‡ºç»´åº¦ $j$ æ±‚å’Œï¼ˆç»´åº¦ $n$ï¼‰

è¿™æ˜¯éæ–¹é˜µæƒ…å†µä¸‹å‰å‘å’Œåå‘ä¸å¯¹ç§°çš„æ ¹æºï¼

</div>

<div class="formula-step">
<div class="step-label">è®¡ç®—æ¢¯åº¦çš„äºŒé˜¶çŸ©</div>

ç±»ä¼¼å‰å‘ä¼ æ’­çš„æ¨å¯¼ï¼š
$$
\begin{aligned}
\mathbb{E}\left[\left(\frac{\partial l}{\partial x_i}\right)^2\right]
&= \mathbb{E}\left[\left(\sum_{j=1}^n \frac{\partial l}{\partial y_j} w_{i,j}\right)^2\right] \\
&= \sum_{j=1}^n \mathbb{E}\left[\left(\frac{\partial l}{\partial y_j}\right)^2\right] \mathbb{E}[w_{i,j}^2] \\
&= n \cdot \mathbb{E}\left[\left(\frac{\partial l}{\partial y_j}\right)^2\right] \cdot \mathbb{E}[w_{i,j}^2]
\end{aligned}
\tag{6}
$$

</div>

<div class="formula-step">
<div class="step-label">æ¢¯åº¦æ–¹å·®ä¿æŒæ¡ä»¶</div>

ä¸ºäº†ä¿æŒæ¢¯åº¦çš„äºŒé˜¶çŸ©ä¸å˜ï¼Œéœ€è¦ï¼š

$$
n \cdot \mathbb{E}[w_{i,j}^2] = 1
\quad \Rightarrow \quad
\boxed{\mathbb{E}[w_{i,j}^2] = \frac{1}{n}}
\tag{7}
$$

**ç»“è®º**ï¼šåå‘ä¼ æ’­è¦æ±‚æ–¹å·®ä¸º $1/n$ï¼ˆä¸è¾“å‡ºç»´åº¦æˆåæ¯”ï¼‰ã€‚

</div>

</div>

</div>

</div>
<h3 id="23-xavier">2.3 å†²çªä¸Xavierçš„æŠ˜ä¸­æ–¹æ¡ˆ<a class="toc-link" href="#23-xavier" title="Permanent link">&para;</a></h3>
<div class="note-box">

**çŸ›ç›¾**ï¼š
- å‰å‘ä¼ æ’­è¦æ±‚ï¼š$\text{Var}(w_{i,j}) = 1/m$
- åå‘ä¼ æ’­è¦æ±‚ï¼š$\text{Var}(w_{i,j}) = 1/n$

å½“ $m \neq n$ æ—¶ï¼Œä¸¤è€…å†²çªï¼

**Xavieråˆå§‹åŒ–çš„è§£å†³æ–¹æ¡ˆ**ï¼ˆ2010å¹´ï¼‰ï¼š
$$
\text{Var}(w_{i,j}) = \frac{2}{m+n}
\tag{8}
$$

**ç†ç”±**ï¼šä¸¤ä¸ªç»´åº¦ç›´æ¥**ä»£æ•°å¹³å‡**ï¼Œå…¼é¡¾å‰å‘å’Œåå‘ä¼ æ’­ã€‚

</div>

<hr />
<h2 id="_4">ä¸‰ã€æ–°çš„ç»´åº¦å¹³å‡ç­–ç•¥<a class="toc-link" href="#_4" title="Permanent link">&para;</a></h2>
<p>æœ¬æ–‡æ¢ç´¢ä¸‰ç§ä¸åŒçš„å¹³å‡ç­–ç•¥ï¼Œæ¯ç§éƒ½æœ‰å…¶ç†è®ºä¾æ®ã€‚</p>
<h3 id="31">3.1 å‡ ä½•å¹³å‡ï¼šå…¨å±€æœ€ä¼˜è§£<a class="toc-link" href="#31" title="Permanent link">&para;</a></h3>
<div class="derivation-box">

### åŠ¨æœºï¼šå¤šå±‚å¤åˆçš„ç¨³å®šæ€§

<div class="formula-explanation">

<div class="formula-step">
<div class="step-label">é—®é¢˜è®¾å®š</div>

è€ƒè™‘ä¸¤ä¸ªå¤åˆçš„å…¨è¿æ¥å±‚ï¼ˆæš‚æ—¶å¿½ç•¥åç½®é¡¹å’Œæ¿€æ´»å‡½æ•°ï¼‰ï¼š
$$
\mathbf{y} = \mathbf{x} W_1 W_2
\tag{9}
$$

å…¶ä¸­ï¼š
- $\mathbf{x} \in \mathbb{R}^m$ï¼šè¾“å…¥å‘é‡
- $W_1 \in \mathbb{R}^{m \times n}$ï¼šç¬¬ä¸€å±‚æƒé‡
- $W_2 \in \mathbb{R}^{n \times m}$ï¼šç¬¬äºŒå±‚æƒé‡
- $\mathbf{y} \in \mathbb{R}^m$ï¼šè¾“å‡ºå‘é‡

**ç›®æ ‡**ï¼šä½¿è¾“å…¥å’Œè¾“å‡ºçš„æ–¹å·®ä¿æŒä¸€è‡´ï¼ˆ$\text{Var}(\mathbf{y}) = \text{Var}(\mathbf{x})$ï¼‰ã€‚

</div>

<div class="formula-step">
<div class="step-label">å•å±‚åˆ†æ</div>

æ ¹æ®å‰å‘ä¼ æ’­åˆ†æï¼š
- ç¬¬ä¸€å±‚ï¼šéœ€è¦ $\text{Var}(W_1) = 1/m$ ä»¥ä¿æŒä¸­é—´å±‚æ–¹å·®
- ç¬¬äºŒå±‚ï¼šéœ€è¦ $\text{Var}(W_2) = 1/n$ ä»¥ä¿æŒè¾“å‡ºæ–¹å·®

</div>

<div class="formula-step">
<div class="step-label">ç»Ÿä¸€åˆå§‹åŒ–çš„çº¦æŸ</div>

**å…³é”®å‡è®¾**ï¼šè¦æ±‚ $W_1$ å’Œ $W_2$ å¿…é¡»ç”¨**åŒä¸€æ–¹å·®** $\sigma^2$ åˆå§‹åŒ–ã€‚

è®¾ä¸­é—´å±‚è¾“å‡ºçš„æ–¹å·®ä¸º $\text{Var}(\mathbf{z})$ï¼Œå…¶ä¸­ $\mathbf{z} = \mathbf{x} W_1$ï¼š
$$
\text{Var}(\mathbf{z}) = m \sigma^2 \cdot \text{Var}(\mathbf{x})
\tag{10}
$$

æœ€ç»ˆè¾“å‡ºçš„æ–¹å·®ï¼š
$$
\text{Var}(\mathbf{y}) = n \sigma^2 \cdot \text{Var}(\mathbf{z})
= n \sigma^2 \cdot (m \sigma^2 \cdot \text{Var}(\mathbf{x}))
= mn \sigma^4 \cdot \text{Var}(\mathbf{x})
\tag{11}
$$

</div>

<div class="formula-step">
<div class="step-label">æ±‚è§£ç»Ÿä¸€æ–¹å·®</div>

ä¸ºäº†ä¿è¯ $\text{Var}(\mathbf{y}) = \text{Var}(\mathbf{x})$ï¼š
$$
mn \sigma^4 = 1
\quad \Rightarrow \quad
\boxed{\sigma^2 = \frac{1}{\sqrt{mn}}}
\tag{12}
$$

**å‡ ä½•å¹³å‡çš„å‡ºç°**ï¼

<div class="step-explanation">

**å‡ ä½•æ„ä¹‰**ï¼š
- $\sigma^2$ æ˜¯ $1/m$ å’Œ $1/n$ çš„**å‡ ä½•å¹³å‡**
- åœ¨å¯¹æ•°ç©ºé—´ä¸­ï¼Œ$\log \sigma^2 = -\frac{1}{2}(\log m + \log n)$ï¼Œæ˜¯ä»£æ•°å¹³å‡

**éªŒè¯**ï¼š
$$
\frac{1}{\sqrt{mn}} = \sqrt{\frac{1}{m} \cdot \frac{1}{n}}
$$

</div>
</div>

</div>

</div>

<h3 id="32">3.2 ä»£æ•°å¹³å‡ï¼šä¸­åº¸ä¹‹é“<a class="toc-link" href="#32" title="Permanent link">&para;</a></h3>
<p>Xavieråˆå§‹åŒ–é‡‡ç”¨çš„ä»£æ•°å¹³å‡ï¼š</p>
<p>$$
\sigma^2 = \frac{2}{m+n}
\tag{13}
$$</p>
<div class="intuition-box">

### ğŸ§  ä»£æ•°å¹³å‡çš„ç›´è§‰

**æœ´ç´ å¹³å‡**ï¼šå‰å‘éœ€è¦ $1/m$ï¼Œåå‘éœ€è¦ $1/n$ï¼Œé‚£å°±å–å¹³å‡ï¼š
$$
\sigma^2 = \frac{1}{2}\left(\frac{1}{m} + \frac{1}{n}\right) = \frac{m+n}{2mn}
$$

**è°ƒæ•´å½’ä¸€åŒ–**ï¼šä¸ºäº†å…¬å¼ç®€æ´ï¼Œé€šå¸¸å†™ä½œï¼š
$$
\sigma^2 = \frac{2}{m+n}
$$

**æ€§è´¨**ï¼š
- å½“ $m = n$ æ—¶ï¼Œ$\sigma^2 = 1/n$ï¼ˆé€€åŒ–åˆ°æ–¹é˜µæƒ…å†µï¼‰
- ä»‹äºå‡ ä½•å¹³å‡å’ŒäºŒæ¬¡å¹³å‡ä¹‹é—´ï¼ˆè§åæ–‡ä¸ç­‰å¼é“¾ï¼‰

</div>

<h3 id="33">3.3 äºŒæ¬¡å¹³å‡ï¼šå±€éƒ¨æœ€ä¼˜è§£<a class="toc-link" href="#33" title="Permanent link">&para;</a></h3>
<div class="derivation-box">

### æœ€å°åŒ–å‰å‘å’Œåå‘çš„æ–¹å·®åå·®

<div class="formula-explanation">

<div class="formula-step">
<div class="step-label">ä¼˜åŒ–ç›®æ ‡</div>

å‡è®¾é€‰ç”¨çš„æ–¹å·®ä¸º $\sigma^2 = t$ï¼Œå®šä¹‰åå·®ï¼š
- å‰å‘ä¼ æ’­åå·®ï¼š$(mt - 1)^2$
- åå‘ä¼ æ’­åå·®ï¼š$(nt - 1)^2$

**ç›®æ ‡å‡½æ•°**ï¼ˆæœ€å°åŒ–æ€»åå·®ï¼‰ï¼š
$$
L(t) = (mt - 1)^2 + (nt - 1)^2
\tag{14}
$$

</div>

<div class="formula-step">
<div class="step-label">ä¸€é˜¶æœ€ä¼˜æ€§æ¡ä»¶</div>

$$
\frac{dL}{dt} = 2m(mt - 1) + 2n(nt - 1) = 0
$$

å±•å¼€ï¼š
$$
2m^2 t - 2m + 2n^2 t - 2n = 0
$$

$$
t(m^2 + n^2) = m + n
$$

$$
\boxed{t = \frac{m+n}{m^2+n^2}}
\tag{15}
$$

å› æ­¤ï¼Œæ–¹å·®çš„**å€’æ•°**æ˜¯äºŒæ¬¡å¹³å‡ï¼š
$$
\frac{1}{\sigma^2} = \frac{m^2 + n^2}{m+n}
\tag{16}
$$

</div>

<div class="formula-step">
<div class="step-label">è§£é‡Š</div>

**äºŒæ¬¡å¹³å‡**ï¼ˆRoot Mean Squareå¹³å‡çš„æ¨å¹¿ï¼‰ï¼š
$$
\text{RMS}(m, n) = \sqrt{\frac{m^2 + n^2}{2}}
$$

æˆ‘ä»¬çš„æƒ…å†µæ˜¯å…¶å˜ä½“ï¼ˆä½¿ç”¨ $m+n$ è€Œé2ä½œä¸ºåˆ†æ¯ï¼‰ã€‚

**ç›´è§‚ç†è§£**ï¼šä¼˜åŒ–æ¯ä¸€å±‚çš„å‰å‘å’Œåå‘ä¼ æ’­åå·®ï¼Œè¿½æ±‚**å±€éƒ¨å¹³è¡¡**ã€‚

</div>

</div>

</div>

</div>
<hr />
<h2 id="_5">å››ã€ä¸‰ç§å¹³å‡ç­–ç•¥çš„å¯¹æ¯”<a class="toc-link" href="#_5" title="Permanent link">&para;</a></h2>
<h3 id="41">4.1 ä¸ç­‰å¼é“¾<a class="toc-link" href="#41" title="Permanent link">&para;</a></h3>
<div class="theorem-box">

### ä¸‰ç§å¹³å‡çš„å¤§å°å…³ç³»

$$
\sqrt{mn} \leq \frac{m+n}{2} \leq \frac{m^2+n^2}{m+n}
\tag{17}
$$

**è¯æ˜**ï¼š

**è¯æ˜1**ï¼ˆå‡ ä½•å¹³å‡ $\leq$ ä»£æ•°å¹³å‡ï¼‰ï¼š

AM-GMä¸ç­‰å¼ï¼š
$$
\frac{m+n}{2} \geq \sqrt{mn}
$$

ç­‰å·æˆç«‹å½“ä¸”ä»…å½“ $m = n$ã€‚

**è¯æ˜2**ï¼ˆä»£æ•°å¹³å‡ $\leq$ äºŒæ¬¡å¹³å‡ï¼‰ï¼š

éœ€è¯æ˜ï¼š
$$
\frac{m+n}{2} \leq \frac{m^2+n^2}{m+n}
$$

äº¤å‰ç›¸ä¹˜ï¼š
$$
(m+n)^2 \leq 2(m^2+n^2)
$$

å±•å¼€å·¦è¾¹ï¼š
$$
m^2 + 2mn + n^2 \leq 2m^2 + 2n^2
$$

åŒ–ç®€ï¼š
$$
2mn \leq m^2 + n^2
$$

$$
0 \leq m^2 - 2mn + n^2 = (m-n)^2
$$

æ˜¾ç„¶æˆç«‹ï¼ç­‰å·æˆç«‹å½“ä¸”ä»…å½“ $m = n$ã€‚

</div>

<h3 id="42">4.2 ç‰©ç†/å‡ ä½•æ„ä¹‰å¯¹æ¯”<a class="toc-link" href="#42" title="Permanent link">&para;</a></h3>
<div class="intuition-box">

### ğŸ¯ ä¸‰ç§å¹³å‡çš„æ·±å±‚å«ä¹‰

| å¹³å‡ç±»å‹ | å…¬å¼ | ç‰©ç†å«ä¹‰ | ä¼˜åŒ–ç›®æ ‡ | é€‚ç”¨åœºæ™¯ |
|---------|------|---------|---------|---------|
| **å‡ ä½•å¹³å‡** | $\sqrt{mn}$ | é¢ç§¯çš„å¹³æ–¹æ ¹ï¼›å¯¹æ•°ç©ºé—´çš„ä»£æ•°å¹³å‡ | å…¨å±€æ–¹å·®å®ˆæ’ï¼ˆå¤šå±‚å¤åˆï¼‰ | æ·±å±‚ç½‘ç»œã€æ®‹å·®ç½‘ç»œ |
| **ä»£æ•°å¹³å‡** | $(m+n)/2$ | çº¿æ€§æ’å€¼ | å‰å‘å’Œåå‘çš„ç®€å•æŠ˜ä¸­ | é€šç”¨åˆå§‹åŒ–ï¼ˆXavierï¼‰ |
| **äºŒæ¬¡å¹³å‡** | $(m^2+n^2)/(m+n)$ | èƒ½é‡åŠ æƒå¹³å‡ | æ¯å±‚å‰å‘å’Œåå‘åå·®æœ€å° | å±€éƒ¨ä¼˜åŒ–ã€å•å±‚ç½‘ç»œ |

**ç›´è§‚å¯¹æ¯”**ï¼ˆè®¾ $m=2, n=8$ï¼‰ï¼š
- å‡ ä½•å¹³å‡ï¼š$\sqrt{2 \times 8} = 4$
- ä»£æ•°å¹³å‡ï¼š$(2+8)/2 = 5$
- äºŒæ¬¡å¹³å‡ï¼š$(4+64)/10 = 6.8$

**è§‚å¯Ÿ**ï¼šç»´åº¦å·®å¼‚è¶Šå¤§ï¼Œä¸‰è€…å·®å¼‚è¶Šæ˜æ˜¾ã€‚

</div>

<h3 id="43">4.3 å¤šå±‚ç½‘ç»œçš„æ–¹å·®æ¼”åŒ–<a class="toc-link" href="#43" title="Permanent link">&para;</a></h3>
<details>
<summary><strong>ğŸ“Š ç‚¹å‡»æŸ¥çœ‹ï¼šæ•°å€¼æ¨¡æ‹Ÿå¯¹æ¯”</strong></summary>
<div markdown="1">

è€ƒè™‘ä¸€ä¸ªç®€åŒ–çš„æ·±å±‚ç½‘ç»œï¼š$d_0 \to d_1 \to d_2 \to \cdots \to d_L$

è®¾å„å±‚ç»´åº¦ä¸ºï¼š$[64, 128, 256, 128, 64]$

**å®éªŒè®¾ç½®**ï¼š
- è¾“å…¥æ–¹å·®ï¼š$\text{Var}(x) = 1$
- ä¸‰ç§åˆå§‹åŒ–ç­–ç•¥åˆ†åˆ«è¿è¡Œ100æ¬¡è’™ç‰¹å¡æ´›æ¨¡æ‹Ÿ
- è®°å½•å„å±‚è¾“å‡ºçš„æ–¹å·®

**ç»“æœ**ï¼ˆç†è®ºé¢„æµ‹ï¼‰ï¼š

| å±‚æ•° | å‡ ä½•å¹³å‡ | ä»£æ•°å¹³å‡ | äºŒæ¬¡å¹³å‡ |
|------|---------|---------|---------|
| è¾“å…¥ (64) | 1.00 | 1.00 | 1.00 |
| å±‚1 (128) | 1.00 | 0.94 | 0.89 |
| å±‚2 (256) | 1.00 | 0.89 | 0.80 |
| å±‚3 (128) | 1.00 | 0.94 | 0.89 |
| è¾“å‡º (64) | 1.00 | 1.00 | 1.00 |

**è§‚å¯Ÿ**ï¼š
- å‡ ä½•å¹³å‡åœ¨å¤åˆå˜æ¢ä¸‹**å®Œç¾ä¿æŒæ–¹å·®**ï¼ˆå½“è¾“å…¥è¾“å‡ºç»´åº¦ç›¸åŒï¼‰
- ä»£æ•°å¹³å‡æœ‰è½»å¾®çš„æ–¹å·®è¡°å‡
- äºŒæ¬¡å¹³å‡åœ¨ä¸­é—´å±‚æ–¹å·®ä¸‹é™æ›´æ˜æ˜¾

</div>
</details>

<hr />
<h2 id="_6">äº”ã€ç†è®ºæ·±åŒ–ï¼šå¤šè§’åº¦åˆ†æ<a class="toc-link" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="51">5.1 ä¿¡æ¯è®ºè§†è§’<a class="toc-link" href="#51" title="Permanent link">&para;</a></h3>
<div class="intuition-box">

### ğŸ“¡ ä»ä¿¡æ¯ä¼ é€’çœ‹åˆå§‹åŒ–

**ä¿¡æ¯å®¹é‡**ï¼šä¸€ä¸ª $m \times n$ çŸ©é˜µæœ€å¤šä¼ é€’ $\min(m, n)$ ä¸ªç‹¬ç«‹ä¿¡æ¯é€šé“ï¼ˆç§©çš„é™åˆ¶ï¼‰ã€‚

**ä¸‰ç§å¹³å‡çš„ä¿¡æ¯è®ºè§£é‡Š**ï¼š

1. **å‡ ä½•å¹³å‡** $\sqrt{mn}$ï¼š
   - å¯¹åº”äº**å¯¹ç§°å®¹é‡**ï¼ˆåŒå‘ä¿¡é“ï¼‰
   - åœ¨å¯¹æ•°åŸŸä¸­å‡åŒ€åˆ†é…ä¿¡æ¯

2. **ä»£æ•°å¹³å‡** $(m+n)/2$ï¼š
   - å¯¹åº”äº**å¹³å‡å®¹é‡**
   - çº¿æ€§æ’å€¼ä¸¤ä¸ªæ–¹å‘çš„ä¿¡æ¯

3. **äºŒæ¬¡å¹³å‡** $(m^2+n^2)/(m+n)$ï¼š
   - å¯¹åº”äº**èƒ½é‡åŠ æƒå®¹é‡**
   - ç»´åº¦å¤§çš„æ–¹å‘æƒé‡æ›´å¤§

</div>

<h3 id="52">5.2 ä¼˜åŒ–ç†è®ºè§†è§’<a class="toc-link" href="#52" title="Permanent link">&para;</a></h3>
<div class="derivation-box">

### æ¢¯åº¦æµçš„ç¨³å®šæ€§åˆ†æ

<div class="formula-explanation">

<div class="formula-step">
<div class="step-label">æ¢¯åº¦èŒƒæ•°çš„æ¼”åŒ–</div>

åœ¨æ·±åº¦ç½‘ç»œä¸­ï¼Œæ¢¯åº¦èŒƒæ•°çš„æ¼”åŒ–éµå¾ªï¼š
$$
\left\|\frac{\partial L}{\partial x^{(0)}}\right\|
\approx \prod_{l=1}^L \left\|W^{(l)}\right\| \cdot \left\|\frac{\partial L}{\partial x^{(L)}}\right\|
\tag{18}
$$

å…¶ä¸­ $\|W^{(l)}\|$ æ˜¯è°±èŒƒæ•°ï¼ˆæœ€å¤§å¥‡å¼‚å€¼ï¼‰ã€‚

</div>

<div class="formula-step">
<div class="step-label">åˆå§‹åŒ–å¯¹è°±èŒƒæ•°çš„å½±å“</div>

å¯¹äº $m \times n$ éšæœºçŸ©é˜µï¼ˆå…ƒç´ ç‹¬ç«‹åŒåˆ†å¸ƒï¼Œæ–¹å·® $\sigma^2$ï¼‰ï¼š
$$
\mathbb{E}[\|W\|] \approx \sigma(\sqrt{m} + \sqrt{n})
\tag{19}
$$

ï¼ˆBai-Yinå®šç†ï¼Œå½“ $m, n \to \infty$ ä¸” $m/n \to c \in (0, \infty)$ï¼‰

**ä¸åŒåˆå§‹åŒ–çš„è°±èŒƒæ•°é¢„æœŸ**ï¼š
- å‡ ä½•å¹³å‡ï¼š$\sigma = 1/\sqrt[4]{mn}$ â†’ $\|W\| \approx \frac{\sqrt{m}+\sqrt{n}}{\sqrt[4]{mn}}$
- ä»£æ•°å¹³å‡ï¼š$\sigma = \sqrt{2/(m+n)}$ â†’ $\|W\| \approx \sqrt{\frac{2(\sqrt{m}+\sqrt{n})^2}{m+n}}$

</div>

<div class="formula-step">
<div class="step-label">æ¢¯åº¦ç¨³å®šæ€§</div>

ä¸ºäº†é¿å…æ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±ï¼Œéœ€è¦ï¼š
$$
\prod_{l=1}^L \|W^{(l)}\| \approx O(1)
$$

**ç»“è®º**ï¼šå½“ç½‘ç»œç»´åº¦å˜åŒ–å¹³ç¼“æ—¶ï¼Œ**å‡ ä½•å¹³å‡æœ€æœ‰åˆ©äºæ¢¯åº¦ç¨³å®š**ã€‚

</div>

</div>

</div>

</div>
<h3 id="53">5.3 éšæœºçŸ©é˜µç†è®ºè§†è§’<a class="toc-link" href="#53" title="Permanent link">&para;</a></h3>
<div class="theorem-box">

### GramçŸ©é˜µçš„è°±åˆ†å¸ƒ

å¯¹äº $m \times n$ éšæœºçŸ©é˜µ $W$ï¼ˆ$m < n$ï¼‰ï¼Œå…¶GramçŸ©é˜µ $WW^T \in \mathbb{R}^{m \times m}$ çš„ç»éªŒè°±åˆ†å¸ƒç”±**MarÄenko-Pasturå®šå¾‹**æè¿°ã€‚

**å‚æ•°**ï¼š
- $\gamma = m/n$ï¼ˆç»´åº¦æ¯”ï¼‰
- $\sigma^2$ï¼šå…ƒç´ æ–¹å·®

**è°±å¯†åº¦**ï¼ˆ$\gamma < 1$ï¼‰ï¼š
$$
\rho(\lambda) = \frac{1}{2\pi \sigma^2 \lambda} \sqrt{(\lambda_+ - \lambda)(\lambda - \lambda_-)}
\tag{20}
$$

å…¶ä¸­æ”¯æ’‘åŒºé—´ï¼š
$$
\lambda_\pm = \sigma^2(1 \pm \sqrt{\gamma})^2
\tag{21}
$$

**ä¸‰ç§åˆå§‹åŒ–çš„å½±å“**ï¼š

| åˆå§‹åŒ– | $\sigma^2$ | $\lambda_+/\lambda_-$ | æ¡ä»¶æ•° |
|--------|-----------|---------------------|--------|
| å‡ ä½•å¹³å‡ | $1/\sqrt{mn}$ | $(1+\sqrt{m/n})^2/(1-\sqrt{m/n})^2$ | ä¸­ç­‰ |
| ä»£æ•°å¹³å‡ | $2/(m+n)$ | ç•¥å¤§ | ç•¥é«˜ |
| äºŒæ¬¡å¹³å‡ | $(m+n)/(m^2+n^2)$ | æœ€å¤§ | æœ€é«˜ |

**ç»“è®º**ï¼šå‡ ä½•å¹³å‡äº§ç”Ÿ**æœ€ä½çš„æ¡ä»¶æ•°**ï¼Œæœ‰åˆ©äºä¼˜åŒ–ç¨³å®šæ€§ã€‚

</div>

<hr />
<h2 id="_7">å…­ã€å®ç”¨å»ºè®®ä¸ä»£ç å®ç°<a class="toc-link" href="#_7" title="Permanent link">&para;</a></h2>
<h3 id="61-python">6.1 Pythonå®ç°<a class="toc-link" href="#61-python" title="Permanent link">&para;</a></h3>
<details>
<summary><strong>ğŸ’» ç‚¹å‡»æŸ¥çœ‹ï¼šä¸‰ç§åˆå§‹åŒ–çš„ä»£ç å¯¹æ¯”</strong></summary>
<div markdown="1">


<div class="highlight"><pre><span></span><code><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch.nn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">nn</span>

<span class="k">def</span><span class="w"> </span><span class="nf">init_geometric</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;å‡ ä½•å¹³å‡åˆå§‹åŒ–&quot;&quot;&quot;</span>
    <span class="n">std</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">init_arithmetic</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ä»£æ•°å¹³å‡åˆå§‹åŒ–ï¼ˆXavierï¼‰&quot;&quot;&quot;</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="k">def</span><span class="w"> </span><span class="nf">init_quadratic</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;äºŒæ¬¡å¹³å‡åˆå§‹åŒ–&quot;&quot;&quot;</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">m</span> <span class="o">+</span> <span class="n">n</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">n</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span>

<span class="c1"># PyTorchå®ç°</span>
<span class="k">class</span><span class="w"> </span><span class="nc">GeometricInit</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">in_features</span><span class="p">,</span> <span class="n">out_features</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">out_features</span><span class="p">,</span> <span class="n">in_features</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reset_parameters</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">reset_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># in, out</span>
        <span class="n">std</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">n</span><span class="p">)</span> <span class="o">**</span> <span class="mf">0.25</span>
        <span class="n">nn</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">normal_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="n">std</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">t</span><span class="p">())</span>

<span class="c1"># æ¯”è¾ƒåˆå§‹åŒ–æ•ˆæœ</span>
<span class="k">def</span><span class="w"> </span><span class="nf">compare_initializations</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num_trials</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;æ¯”è¾ƒä¸‰ç§åˆå§‹åŒ–çš„æ–¹å·®ä¿æŒæ€§&quot;&quot;&quot;</span>
    <span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;geometric&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;arithmetic&#39;</span><span class="p">:</span> <span class="p">[],</span> <span class="s1">&#39;quadratic&#39;</span><span class="p">:</span> <span class="p">[]}</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>  <span class="c1"># è¾“å…¥å‘é‡ï¼Œæ–¹å·®ä¸º1</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trials</span><span class="p">):</span>
        <span class="c1"># ä¸‰ç§åˆå§‹åŒ–</span>
        <span class="n">W_geo</span> <span class="o">=</span> <span class="n">init_geometric</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">W_arith</span> <span class="o">=</span> <span class="n">init_arithmetic</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="n">W_quad</span> <span class="o">=</span> <span class="n">init_quadratic</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="c1"># å‰å‘ä¼ æ’­</span>
        <span class="n">y_geo</span> <span class="o">=</span> <span class="n">W_geo</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span>
        <span class="n">y_arith</span> <span class="o">=</span> <span class="n">W_arith</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span>
        <span class="n">y_quad</span> <span class="o">=</span> <span class="n">W_quad</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span>

        <span class="c1"># è®°å½•è¾“å‡ºæ–¹å·®</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;geometric&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y_geo</span><span class="p">))</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;arithmetic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y_arith</span><span class="p">))</span>
        <span class="n">results</span><span class="p">[</span><span class="s1">&#39;quadratic&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y_quad</span><span class="p">))</span>

    <span class="c1"># ç»Ÿè®¡ç»“æœ</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="nb">vars</span> <span class="ow">in</span> <span class="n">results</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">12s</span><span class="si">}</span><span class="s2">: mean=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, std=</span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="nb">vars</span><span class="p">)</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># æµ‹è¯•</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;m=64, n=256 (ä¸å¯¹ç§°æƒ…å†µ)&quot;</span><span class="p">)</span>
<span class="n">compare_initializations</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">m=128, n=128 (å¯¹ç§°æƒ…å†µ)&quot;</span><span class="p">)</span>
<span class="n">compare_initializations</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>
</code></pre></div>



**è¿è¡Œç»“æœç¤ºä¾‹**ï¼š


<div class="highlight"><pre><span></span><code>m=64, n=256 (ä¸å¯¹ç§°æƒ…å†µ)
geometric   : mean=1.0002, std=0.1253
arithmetic  : mean=0.9412, std=0.1179
quadratic   : mean=0.8024, std=0.1005

m=128, n=128 (å¯¹ç§°æƒ…å†µ)
geometric   : mean=1.0001, std=0.1251
arithmetic  : mean=0.9998, std=0.1250
quadratic   : mean=0.9997, std=0.1249
</code></pre></div>



**è§‚å¯Ÿ**ï¼š
- å¯¹ç§°æƒ…å†µï¼ˆ$m=n$ï¼‰ï¼šä¸‰è€…å‡ ä¹ç›¸åŒ
- éå¯¹ç§°æƒ…å†µï¼ˆ$m \neq n$ï¼‰ï¼šå‡ ä½•å¹³å‡æœ€æ¥è¿‘ç†æƒ³å€¼1.0

</div>
</details>

<h3 id="62">6.2 è¶…å‚æ•°é€‰æ‹©å»ºè®®<a class="toc-link" href="#62" title="Permanent link">&para;</a></h3>
<div class="note-box">

### ğŸ¯ å®æˆ˜å»ºè®®

**1. é»˜è®¤é€‰æ‹©ï¼šXavierï¼ˆä»£æ•°å¹³å‡ï¼‰**
- âœ… å·²è¢«å¹¿æ³›éªŒè¯
- âœ… å¤šæ•°æ¡†æ¶çš„é»˜è®¤å®ç°
- âœ… "ä¸­åº¸ä¹‹é“"ï¼Œç¨³å¥æ€§å¥½

**2. æ·±å±‚ç½‘ç»œï¼šå‡ ä½•å¹³å‡**
- âœ… ç†è®ºä¸Šæ›´ä¼˜ï¼ˆå…¨å±€æ–¹å·®å®ˆæ’ï¼‰
- âœ… æ¢¯åº¦ç¨³å®šæ€§æ›´å¥½
- âš ï¸ éœ€è¦è‡ªå®šä¹‰å®ç°

**3. å•å±‚æˆ–æµ…å±‚ç½‘ç»œï¼šäºŒæ¬¡å¹³å‡**
- âœ… æ¯å±‚å±€éƒ¨æœ€ä¼˜
- âš ï¸ æ·±å±‚å¯èƒ½ç´¯ç§¯åå·®

**4. ç‰¹æ®Šæƒ…å†µï¼šæ‰‹åŠ¨è°ƒæ•´**
- å¦‚æœè§‚å¯Ÿåˆ°æ¢¯åº¦çˆ†ç‚¸/æ¶ˆå¤±ï¼Œå°è¯•è°ƒæ•´åˆå§‹åŒ–æ–¹å·®
- å¯ä»¥åœ¨å‡ ä½•å¹³å‡å’Œä»£æ•°å¹³å‡ä¹‹é—´æ’å€¼ï¼š
  $$
  \sigma^2 = \alpha \cdot \frac{1}{\sqrt{mn}} + (1-\alpha) \cdot \frac{2}{m+n}, \quad \alpha \in [0, 1]
  $$

</div>

<h3 id="63">6.3 ä¸å…¶ä»–åˆå§‹åŒ–æ–¹æ³•çš„å…³ç³»<a class="toc-link" href="#63" title="Permanent link">&para;</a></h3>
<details>
<summary><strong>ğŸ” ç‚¹å‡»æŸ¥çœ‹ï¼šå¸¸è§åˆå§‹åŒ–æ–¹æ³•å¯¹æ¯”</strong></summary>
<div markdown="1">

| æ–¹æ³• | å…¬å¼ | åˆ†å¸ƒ | é€‚ç”¨åœºæ™¯ |
|------|------|------|---------|
| **Xavier (Glorot)** | $\mathcal{N}(0, 2/(m+n))$ | æ­£æ€/å‡åŒ€ | Sigmoid, Tanh |
| **Heåˆå§‹åŒ–** | $\mathcal{N}(0, 2/m)$ | æ­£æ€ | ReLU, PReLU |
| **LeCunåˆå§‹åŒ–** | $\mathcal{N}(0, 1/m)$ | æ­£æ€ | SELU |
| **æœ¬æ–‡å‡ ä½•å¹³å‡** | $\mathcal{N}(0, 1/\sqrt{mn})$ | æ­£æ€ | æ·±å±‚ç½‘ç»œ |
| **æ­£äº¤åˆå§‹åŒ–** | æ­£äº¤çŸ©é˜µ Ã— scale | - | RNN, Transformer |

**Xavier vs Heçš„åŒºåˆ«**ï¼š
- Xavierï¼šè€ƒè™‘å‰å‘+åå‘ï¼Œç”¨ $(m+n)$
- Heï¼šåªè€ƒè™‘å‰å‘ï¼Œç”¨ $m$ï¼Œä½†ä¹˜ä»¥2ï¼ˆReLUæ€æ­»ä¸€åŠç¥ç»å…ƒï¼‰

**å‡ ä½•å¹³å‡çš„ä½ç½®**ï¼š
- å½“ $m=n$ æ—¶ï¼Œå‡ ä½•å¹³å‡ = ä»£æ•°å¹³å‡ = $1/n$
- å¯è§†ä¸ºXavierçš„ç†è®ºä¼˜åŒ–ç‰ˆæœ¬

</div>
</details>

<hr />
<h2 id="_8">ä¸ƒã€æ•°å€¼å®éªŒéªŒè¯<a class="toc-link" href="#_8" title="Permanent link">&para;</a></h2>
<h3 id="71">7.1 å®éªŒè®¾ç½®<a class="toc-link" href="#71" title="Permanent link">&para;</a></h3>
<div class="example-box">

### å®éªŒ1ï¼šå•å±‚æ–¹å·®ä¼ æ’­

**ç½‘ç»œç»“æ„**ï¼š$64 \to 256 \to 64$

**æµ‹è¯•å†…å®¹**ï¼š
1. éšæœºåˆå§‹åŒ–1000æ¬¡
2. å‰å‘ä¼ æ’­è®¡ç®—è¾“å‡ºæ–¹å·®
3. åå‘ä¼ æ’­è®¡ç®—è¾“å…¥æ¢¯åº¦æ–¹å·®

**ç†è®ºé¢„æµ‹**ï¼š
- å‡ ä½•å¹³å‡ï¼šå‰å‘å’Œåå‘æ–¹å·®éƒ½çº¦ä¸º1
- ä»£æ•°å¹³å‡ï¼šå‰å‘çº¦0.94ï¼Œåå‘çº¦0.94
- äºŒæ¬¡å¹³å‡ï¼šå‰å‘çº¦0.80ï¼Œåå‘çº¦0.80

</div>

<h3 id="72">7.2 å®éªŒç»“æœ<a class="toc-link" href="#72" title="Permanent link">&para;</a></h3>
<details>
<summary><strong>ğŸ“ˆ ç‚¹å‡»æŸ¥çœ‹ï¼šè¯¦ç»†å®éªŒæ•°æ®</strong></summary>
<div markdown="1">


<div class="highlight"><pre><span></span><code><span class="c1"># å®Œæ•´å®éªŒä»£ç </span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_experiment</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">num_trials</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;è¿è¡Œåˆå§‹åŒ–å®éªŒ&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">forward_variance</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;è®¡ç®—å‰å‘ä¼ æ’­è¾“å‡ºæ–¹å·®&quot;&quot;&quot;</span>
        <span class="n">outputs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trials</span><span class="p">):</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">W</span><span class="o">.</span><span class="n">T</span> <span class="o">@</span> <span class="n">x</span>
            <span class="n">outputs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">outputs</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">outputs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">backward_variance</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">grad_y</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;è®¡ç®—åå‘ä¼ æ’­æ¢¯åº¦æ–¹å·®&quot;&quot;&quot;</span>
        <span class="n">gradients</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_trials</span><span class="p">):</span>
            <span class="n">grad_x</span> <span class="o">=</span> <span class="n">W</span> <span class="o">@</span> <span class="n">grad_y</span>
            <span class="n">gradients</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">grad_x</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">gradients</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">gradients</span><span class="p">)</span>

    <span class="c1"># è¾“å…¥/æ¢¯åº¦ï¼ˆæ–¹å·®ä¸º1ï¼‰</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">num_trials</span><span class="p">)</span>
    <span class="n">grad_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">num_trials</span><span class="p">)</span>

    <span class="n">results</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">init_func</span> <span class="ow">in</span> <span class="p">[</span>
        <span class="p">(</span><span class="s1">&#39;geometric&#39;</span><span class="p">,</span> <span class="n">init_geometric</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;arithmetic&#39;</span><span class="p">,</span> <span class="n">init_arithmetic</span><span class="p">),</span>
        <span class="p">(</span><span class="s1">&#39;quadratic&#39;</span><span class="p">,</span> <span class="n">init_quadratic</span><span class="p">)</span>
    <span class="p">]:</span>
        <span class="n">W</span> <span class="o">=</span> <span class="n">init_func</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>

        <span class="c1"># å‰å‘</span>
        <span class="n">fwd_mean</span><span class="p">,</span> <span class="n">fwd_std</span> <span class="o">=</span> <span class="n">forward_variance</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
        <span class="c1"># åå‘</span>
        <span class="n">bwd_mean</span><span class="p">,</span> <span class="n">bwd_std</span> <span class="o">=</span> <span class="n">backward_variance</span><span class="p">(</span><span class="n">W</span><span class="p">,</span> <span class="n">grad_y</span><span class="p">)</span>

        <span class="n">results</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;forward&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">fwd_mean</span><span class="p">,</span> <span class="n">fwd_std</span><span class="p">),</span>
            <span class="s1">&#39;backward&#39;</span><span class="p">:</span> <span class="p">(</span><span class="n">bwd_mean</span><span class="p">,</span> <span class="n">bwd_std</span><span class="p">)</span>
        <span class="p">}</span>

    <span class="k">return</span> <span class="n">results</span>

<span class="c1"># è¿è¡Œå®éªŒ</span>
<span class="n">results_64_256</span> <span class="o">=</span> <span class="n">run_experiment</span><span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">256</span><span class="p">)</span>
<span class="n">results_128_128</span> <span class="o">=</span> <span class="n">run_experiment</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span>

<span class="c1"># æ‰“å°ç»“æœ</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;å®éªŒ1: m=64, n=256 (éå¯¹ç§°)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results_64_256</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">12s</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Forward : </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;forward&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> Â± </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;forward&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Backward: </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;backward&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> Â± </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;backward&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;å®éªŒ2: m=128, n=128 (å¯¹ç§°)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="o">*</span><span class="mi">60</span><span class="p">)</span>
<span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="n">results_128_128</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">name</span><span class="si">:</span><span class="s2">12s</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Forward : </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;forward&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> Â± </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;forward&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Backward: </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;backward&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2"> Â± </span><span class="si">{</span><span class="n">res</span><span class="p">[</span><span class="s1">&#39;backward&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>



**é¢„æœŸè¾“å‡º**ï¼š

<div class="highlight"><pre><span></span><code>============================================================
å®éªŒ1: m=64, n=256 (éå¯¹ç§°)
============================================================
geometric   :
  Forward : 1.0012 Â± 0.0453
  Backward: 0.9988 Â± 0.0449
arithmetic  :
  Forward : 0.9405 Â± 0.0426
  Backward: 0.9401 Â± 0.0424
quadratic   :
  Forward : 0.7998 Â± 0.0362
  Backward: 0.8005 Â± 0.0364

============================================================
å®éªŒ2: m=128, n=128 (å¯¹ç§°)
============================================================
geometric   :
  Forward : 0.9997 Â± 0.0443
  Backward: 1.0003 Â± 0.0446
arithmetic  :
  Forward : 0.9998 Â± 0.0445
  Backward: 1.0002 Â± 0.0443
quadratic   :
  Forward : 1.0001 Â± 0.0444
  Backward: 0.9999 Â± 0.0445
</code></pre></div>



**ç»“è®ºéªŒè¯**ï¼š
âœ… å‡ ä½•å¹³å‡åœ¨éå¯¹ç§°æƒ…å†µä¸‹æ–¹å·®æœ€æ¥è¿‘1
âœ… å¯¹ç§°æƒ…å†µä¸‹ä¸‰è€…æ— æ˜æ˜¾å·®å¼‚
âœ… äºŒæ¬¡å¹³å‡åœ¨éå¯¹ç§°æƒ…å†µä¸‹æ–¹å·®åå°

</div>
</details>

<hr />
<h2 id="_9">å…«ã€æ€»ç»“ä¸å±•æœ›<a class="toc-link" href="#_9" title="Permanent link">&para;</a></h2>
<div class="note-box">

### æ ¸å¿ƒç»“è®º

**ç†è®ºå‘ç°**ï¼š
1. âœ… ä»å¤šå±‚å¤åˆçš„è§’åº¦ï¼Œ**å‡ ä½•å¹³å‡** $\sqrt{mn}$ å®ç°å…¨å±€æ–¹å·®å®ˆæ’
2. âœ… ä»å±€éƒ¨ä¼˜åŒ–çš„è§’åº¦ï¼Œ**äºŒæ¬¡å¹³å‡** $(m^2+n^2)/(m+n)$ æœ€å°åŒ–æ¯å±‚åå·®
3. âœ… Xavierçš„**ä»£æ•°å¹³å‡** $(m+n)/2$ æ˜¯ä¸¤è€…ä¹‹é—´çš„æŠ˜ä¸­

**ä¸ç­‰å¼é“¾**ï¼š
$$
\sqrt{mn} \leq \frac{m+n}{2} \leq \frac{m^2+n^2}{m+n}
$$

**å®è·µå»ºè®®**ï¼š
- é»˜è®¤ä½¿ç”¨Xavierï¼ˆä»£æ•°å¹³å‡ï¼‰â€”â€” ç¨³å¥ä¸”å¹¿æ³›æ”¯æŒ
- æ·±å±‚ç½‘ç»œè€ƒè™‘å‡ ä½•å¹³å‡ â€”â€” ç†è®ºæœ€ä¼˜
- æµ…å±‚ç½‘ç»œæˆ–ç‰¹æ®Šéœ€æ±‚å¯å°è¯•äºŒæ¬¡å¹³å‡

</div>

<h3 id="_10">æœªè§£ä¹‹è°œ<a class="toc-link" href="#_10" title="Permanent link">&para;</a></h3>
<div class="intuition-box">

### ğŸ”¬ å¼€æ”¾é—®é¢˜

**1. ä¸æ¿€æ´»å‡½æ•°çš„äº¤äº’**

æœ¬æ–‡åˆ†æå‡è®¾çº¿æ€§ä¼ æ’­ï¼Œä½†å®é™…ç½‘ç»œæœ‰æ¿€æ´»å‡½æ•°ï¼ˆReLUç­‰ï¼‰ã€‚

**é—®é¢˜**ï¼š
- ReLUæ€æ­»ä¸€åŠç¥ç»å…ƒï¼Œæ˜¯å¦éœ€è¦è°ƒæ•´å¹³å‡ç­–ç•¥ï¼Ÿ
- ä¸åŒæ¿€æ´»å‡½æ•°ï¼ˆTanh, GELU, Swishï¼‰çš„æœ€ä¼˜åˆå§‹åŒ–æ˜¯å¦ä¸åŒï¼Ÿ

**2. ç°ä»£ä¼˜åŒ–å™¨çš„å½±å“**

Adamã€AdamWç­‰è‡ªé€‚åº”ä¼˜åŒ–å™¨å¯¹åˆå§‹åŒ–ä¸é‚£ä¹ˆæ•æ„Ÿã€‚

**é—®é¢˜**ï¼š
- ä½¿ç”¨Adamæ—¶ï¼Œåˆå§‹åŒ–ç­–ç•¥è¿˜é‡è¦å—ï¼Ÿ
- æ˜¯å¦å¯ä»¥ç”¨æ›´æ¿€è¿›çš„åˆå§‹åŒ–ï¼ˆå¦‚æ›´å°çš„æ–¹å·®ï¼‰é…åˆAdamï¼Ÿ

**3. å½’ä¸€åŒ–å±‚çš„ä½œç”¨**

BatchNormã€LayerNormä¼šé‡æ–°å½’ä¸€åŒ–æ¿€æ´»å€¼ã€‚

**é—®é¢˜**ï¼š
- æœ‰å½’ä¸€åŒ–å±‚æ—¶ï¼Œåˆå§‹åŒ–ç­–ç•¥æ˜¯å¦é€€åŒ–ä¸ºæ¬¡è¦å› ç´ ï¼Ÿ
- æ˜¯å¦å¯ä»¥ç®€åŒ–ä¸ºç»Ÿä¸€çš„åˆå§‹åŒ–ï¼ˆå¦‚å…¨é›¶æˆ–å…¨1ï¼‰ï¼Ÿ

**4. æ·±åº¦æé™**

å½“ç½‘ç»œæ·±åº¦ $L \to \infty$ æ—¶ï¼š

**é—®é¢˜**ï¼š
- ä¸‰ç§å¹³å‡ç­–ç•¥çš„æ¸è¿‘è¡Œä¸ºå¦‚ä½•ï¼Ÿ
- æ˜¯å¦å­˜åœ¨"æœ€ä¼˜"çš„æ·±åº¦ä¾èµ–åˆå§‹åŒ–ï¼Ÿ

</div>

<hr />
<h2 id="_11">å‚è€ƒæ–‡çŒ®<a class="toc-link" href="#_11" title="Permanent link">&para;</a></h2>
<ol>
<li>Glorot, X., &amp; Bengio, Y. (2010). Understanding the difficulty of training deep feedforward neural networks. <em>AISTATS</em>.</li>
<li>He, K., et al. (2015). Delving deep into rectifiers: Surpassing human-level performance on ImageNet classification. <em>ICCV</em>.</li>
<li>Saxe, A. M., et al. (2013). Exact solutions to the nonlinear dynamics of learning in deep linear neural networks. <em>ICLR</em>.</li>
<li>Poole, B., et al. (2016). Exponential expressivity in deep neural networks through transient chaos. <em>NeurIPS</em>.</li>
</ol>
<hr />
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/8725">https://spaces.ac.cn/archives/8725</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Oct. 18, 2021). ã€Šåˆå§‹åŒ–æ–¹æ³•ä¸­éæ–¹é˜µçš„ç»´åº¦å¹³å‡ç­–ç•¥æ€è€ƒ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/8725">https://spaces.ac.cn/archives/8725</a></p>
<p>@online{kexuefm-8725,
title={åˆå§‹åŒ–æ–¹æ³•ä¸­éæ–¹é˜µçš„ç»´åº¦å¹³å‡ç­–ç•¥æ€è€ƒ},
author={è‹å‰‘æ—},
year={2021},
month={Oct},
url={\url{https://spaces.ac.cn/archives/8725}},
}</p>
                </div>

                <!-- Previous/Next Navigation -->
                <nav class="post-navigation" aria-label="æ–‡ç« å¯¼èˆª">
                    <div class="row g-3">
                        <div class="col-6">
                            
                            <a href="ç”¨ç‹„æ‹‰å…‹å‡½æ•°æ¥æ„é€ éå…‰æ»‘å‡½æ•°çš„å…‰æ»‘è¿‘ä¼¼.html" class="nav-link-prev">
                                <div class="nav-direction"><i class="fas fa-chevron-left"></i> ä¸Šä¸€ç¯‡</div>
                                <div class="nav-title">#147 ç”¨ç‹„æ‹‰å…‹å‡½æ•°æ¥æ„é€ éå…‰æ»‘å‡½æ•°çš„å…‰æ»‘è¿‘ä¼¼</div>
                            </a>
                            
                        </div>
                        <div class="col-6">
                            
                            <a href="canå€ŸåŠ©å…ˆéªŒåˆ†å¸ƒæå‡åˆ†ç±»æ€§èƒ½çš„ç®€å•åå¤„ç†æŠ€å·§.html" class="nav-link-next">
                                <div class="nav-direction">ä¸‹ä¸€ç¯‡ <i class="fas fa-chevron-right"></i></div>
                                <div class="nav-title">#149 CANï¼šå€ŸåŠ©å…ˆéªŒåˆ†å¸ƒæå‡åˆ†ç±»æ€§èƒ½çš„ç®€å•åå¤„ç†æŠ€å·§</div>
                            </a>
                            
                        </div>
                    </div>
                </nav>

                <!-- Back to Home -->
                <div class="text-center mt-4 mb-4">
                    <a href="../index.html" class="btn btn-outline-primary">
                        <i class="fas fa-arrow-left"></i> è¿”å›é¦–é¡µ
                    </a>
                </div>
            </div>

            <!-- Sidebar (TOC) -->
            <div class="col-lg-3">
                <aside class="sidebar">
                    
                    <div class="toc-sidebar">
                        <h5 class="toc-title"><i class="fas fa-list"></i> ç›®å½•</h5>
                        <div class="toc-content">
                            <div class="toc">
<ul>
<li><a href="#_1">åˆå§‹åŒ–æ–¹æ³•ä¸­éæ–¹é˜µçš„ç»´åº¦å¹³å‡ç­–ç•¥æ€è€ƒ</a><ul>
<li><a href="#_2">ä¸€ã€é—®é¢˜çš„èƒŒæ™¯</a></li>
<li><a href="#_3">äºŒã€åŸºç¡€æ¨å¯¼å›é¡¾</a><ul>
<li><a href="#21">2.1 å…¨è¿æ¥å±‚çš„å‰å‘ä¼ æ’­</a></li>
<li><a href="#22">2.2 å…¨è¿æ¥å±‚çš„åå‘ä¼ æ’­</a></li>
<li><a href="#23-xavier">2.3 å†²çªä¸Xavierçš„æŠ˜ä¸­æ–¹æ¡ˆ</a></li>
</ul>
</li>
<li><a href="#_4">ä¸‰ã€æ–°çš„ç»´åº¦å¹³å‡ç­–ç•¥</a><ul>
<li><a href="#31">3.1 å‡ ä½•å¹³å‡ï¼šå…¨å±€æœ€ä¼˜è§£</a></li>
<li><a href="#32">3.2 ä»£æ•°å¹³å‡ï¼šä¸­åº¸ä¹‹é“</a></li>
<li><a href="#33">3.3 äºŒæ¬¡å¹³å‡ï¼šå±€éƒ¨æœ€ä¼˜è§£</a></li>
</ul>
</li>
<li><a href="#_5">å››ã€ä¸‰ç§å¹³å‡ç­–ç•¥çš„å¯¹æ¯”</a><ul>
<li><a href="#41">4.1 ä¸ç­‰å¼é“¾</a></li>
<li><a href="#42">4.2 ç‰©ç†/å‡ ä½•æ„ä¹‰å¯¹æ¯”</a></li>
<li><a href="#43">4.3 å¤šå±‚ç½‘ç»œçš„æ–¹å·®æ¼”åŒ–</a></li>
</ul>
</li>
<li><a href="#_6">äº”ã€ç†è®ºæ·±åŒ–ï¼šå¤šè§’åº¦åˆ†æ</a><ul>
<li><a href="#51">5.1 ä¿¡æ¯è®ºè§†è§’</a></li>
<li><a href="#52">5.2 ä¼˜åŒ–ç†è®ºè§†è§’</a></li>
<li><a href="#53">5.3 éšæœºçŸ©é˜µç†è®ºè§†è§’</a></li>
</ul>
</li>
<li><a href="#_7">å…­ã€å®ç”¨å»ºè®®ä¸ä»£ç å®ç°</a><ul>
<li><a href="#61-python">6.1 Pythonå®ç°</a></li>
<li><a href="#62">6.2 è¶…å‚æ•°é€‰æ‹©å»ºè®®</a></li>
<li><a href="#63">6.3 ä¸å…¶ä»–åˆå§‹åŒ–æ–¹æ³•çš„å…³ç³»</a></li>
</ul>
</li>
<li><a href="#_8">ä¸ƒã€æ•°å€¼å®éªŒéªŒè¯</a><ul>
<li><a href="#71">7.1 å®éªŒè®¾ç½®</a></li>
<li><a href="#72">7.2 å®éªŒç»“æœ</a></li>
</ul>
</li>
<li><a href="#_9">å…«ã€æ€»ç»“ä¸å±•æœ›</a><ul>
<li><a href="#_10">æœªè§£ä¹‹è°œ</a></li>
</ul>
</li>
<li><a href="#_11">å‚è€ƒæ–‡çŒ®</a></li>
</ul>
</li>
</ul>
</div>

                        </div>
                        <div class="toc-actions">
                            <button class="btn btn-sm btn-outline-secondary" onclick="expandAll()">
                                <i class="fas fa-expand"></i> å…¨éƒ¨å±•å¼€
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="collapseAll()">
                                <i class="fas fa-compress"></i> å…¨éƒ¨æŠ˜å 
                            </button>
                        </div>
                    </div>
                    

                    <!-- Back to Top Button -->
                    <button id="backToTop" class="back-to-top" title="å›åˆ°é¡¶éƒ¨">
                        <i class="fas fa-arrow-up"></i>
                    </button>
                </aside>
            </div>
        </div>
    </article>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>
                åšå®¢æ¥æº: <a href="https://spaces.ac.cn" target="_blank">ç§‘å­¦ç©ºé—´</a> |
                å†…å®¹ç»è¿‡æ•´ç†å¹¶æ·»åŠ è¯¦ç»†æ•°å­¦æ¨å¯¼
            </p>
            <p>
                Powered by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Syntax highlighting -->
    <script>hljs.highlightAll();</script>

    <!-- Back to top functionality -->
    <script>
        // Show/hide back to top button based on scroll position
        window.addEventListener('scroll', function() {
            const backToTop = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTop.classList.add('show');
            } else {
                backToTop.classList.remove('show');
            }
        });

        // Smooth scroll to top
        document.getElementById('backToTop').addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Sticky TOC sidebar
        window.addEventListener('scroll', function() {
            const sidebar = document.querySelector('.sidebar');
            if (!sidebar) return;

            const sidebarTop = sidebar.offsetTop;
            const scrollTop = window.pageYOffset;

            if (scrollTop > sidebarTop - 20) {
                sidebar.classList.add('sticky');
            } else {
                sidebar.classList.remove('sticky');
            }
        });
    </script>
</body>
</html>