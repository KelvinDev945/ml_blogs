<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Googleæ–°æœå‡ºçš„ä¼˜åŒ–å™¨Lionï¼šæ•ˆç‡ä¸æ•ˆæœå…¼å¾—çš„"è®­ç»ƒç‹®" | ML & Math Blog Posts</title>
    <meta name="description" content="Googleæ–°æœå‡ºçš„ä¼˜åŒ–å™¨Lionï¼šæ•ˆç‡ä¸æ•ˆæœå…¼å¾—çš„â€œè®­ç»ƒç‹®â€&para;
åŸæ–‡é“¾æ¥: https://spaces.ac.cn/archives/9473
å‘å¸ƒæ—¥æœŸ: 

æ˜¨å¤©åœ¨Arixvä¸Šå‘ç°äº†Googleæ–°å‘çš„ä¸€ç¯‡è®ºæ–‡ã€ŠSymbolic Discovery of Optimization Algorithmsã€‹ï¼Œä¸»è¦æ˜¯è®²è‡ªåŠ¨æœç´¢ä¼˜åŒ–å™¨çš„ï¼Œå’‹çœ‹ä¸Šå»æ²¡å•¥æ„æ€ï¼Œå› ä¸ºç±»ä¼¼çš„å·¥ä½œä¹Ÿæœ‰ä¸å°‘ï¼Œå¤§å¤šæ•°ç»“æœéƒ½...">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css">

    <!-- Google Fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/post.css">

    <!-- Custom JS -->
    <script src="../assets/js/collapsible.js" defer></script>

    <!-- MathJax for math rendering with equation numbering -->
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        tags: 'ams',  // Enable equation numbering with AMS style
        tagSide: 'right',  // Place equation numbers on the right
        tagIndent: '0.8em',  // Indentation for equation numbers
        multlineWidth: '85%'
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Syntax highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/github.min.css">
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/highlight.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
        <div class="container">
            <a class="navbar-brand" href="../index.html">
                <i class="fas fa-brain"></i> ML & Math Blog
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html"><i class="fas fa-home"></i> é¦–é¡µ</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Post Content -->
    <article class="container post-container my-5">
        <!-- Breadcrumb Navigation -->
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../index.html"><i class="fas fa-home"></i> é¦–é¡µ</a></li>
                
                <li class="breadcrumb-item"><a href="../index.html?tags=è¯¦ç»†æ¨å¯¼">è¯¦ç»†æ¨å¯¼</a></li>
                
                <li class="breadcrumb-item active" aria-current="page">
                    #218 Googleæ–°æœå‡ºçš„ä¼˜åŒ–å™¨Lionï¼šæ•ˆç‡ä¸æ•ˆæœå…¼å¾—çš„"è®­ç»ƒç‹®"
                </li>
            </ol>
        </nav>

        <!-- Post Header -->
        <header class="post-header mb-4">
            <h1 class="post-title">
                <span class="post-number">#218</span>
                Googleæ–°æœå‡ºçš„ä¼˜åŒ–å™¨Lionï¼šæ•ˆç‡ä¸æ•ˆæœå…¼å¾—çš„"è®­ç»ƒç‹®"
            </h1>
            <div class="post-meta">
                <span><i class="far fa-calendar"></i> 2023-02-16</span>
                
            </div>
            
            <div class="post-tags mt-3">
                
                <a href="../index.html?tags=è¯¦ç»†æ¨å¯¼" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> è¯¦ç»†æ¨å¯¼</span>
                </a>
                
                <a href="../index.html?tags=ä¼˜åŒ–å™¨" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> ä¼˜åŒ–å™¨</span>
                </a>
                
                <a href="../index.html?tags=ä¼˜åŒ–" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> ä¼˜åŒ–</span>
                </a>
                
                <a href="../index.html?tags=Signå‡½æ•°" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> Signå‡½æ•°</span>
                </a>
                
                <a href="../index.html?tags=åŠ¨é‡" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> åŠ¨é‡</span>
                </a>
                
                <a href="../index.html?tags=AdamW" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> AdamW</span>
                </a>
                
                <a href="../index.html?tags=æ³›åŒ–æ€§èƒ½" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> æ³›åŒ–æ€§èƒ½</span>
                </a>
                
                <a href="../index.html?tags=å†…å­˜ä¼˜åŒ–" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> å†…å­˜ä¼˜åŒ–</span>
                </a>
                
                <a href="../index.html?tags=ç®—æ³•æœç´¢" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> ç®—æ³•æœç´¢</span>
                </a>
                
            </div>
            
        </header>

        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-9">
                <!-- Post Body -->
                <div class="post-content">
                    <h1 id="googlelion">Googleæ–°æœå‡ºçš„ä¼˜åŒ–å™¨Lionï¼šæ•ˆç‡ä¸æ•ˆæœå…¼å¾—çš„â€œè®­ç»ƒç‹®â€<a class="toc-link" href="#googlelion" title="Permanent link">&para;</a></h1>
<p><strong>åŸæ–‡é“¾æ¥</strong>: <a href="https://spaces.ac.cn/archives/9473">https://spaces.ac.cn/archives/9473</a></p>
<p><strong>å‘å¸ƒæ—¥æœŸ</strong>: </p>
<hr />
<p>æ˜¨å¤©åœ¨Arixvä¸Šå‘ç°äº†Googleæ–°å‘çš„ä¸€ç¯‡è®ºæ–‡<a href="https://papers.cool/arxiv/2302.06675">ã€ŠSymbolic Discovery of Optimization Algorithmsã€‹</a>ï¼Œä¸»è¦æ˜¯è®²è‡ªåŠ¨æœç´¢ä¼˜åŒ–å™¨çš„ï¼Œå’‹çœ‹ä¸Šå»æ²¡å•¥æ„æ€ï¼Œå› ä¸ºç±»ä¼¼çš„å·¥ä½œä¹Ÿæœ‰ä¸å°‘ï¼Œå¤§å¤šæ•°ç»“æœéƒ½ç´¢ç„¶æ— å‘³ã€‚ç„¶è€Œï¼Œç»†è¯»ä¹‹ä¸‹æ‰å‘ç°åˆ«æœ‰æ´å¤©ï¼ŒåŸæ¥ä½œè€…ä»¬é€šè¿‡æ•°åƒTPUå°æ—¶çš„ç®—åŠ›æœç´¢å¹¶ç»“åˆäººå·¥å¹²é¢„ï¼Œå¾—åˆ°äº†ä¸€ä¸ªé€Ÿåº¦æ›´å¿«ã€æ˜¾å­˜æ›´çœçš„ä¼˜åŒ–å™¨Lionï¼ˆEvo<strong>L</strong> ved S<strong>i</strong> gn M<strong>o</strong> me<strong>n</strong> tumï¼Œä¸å¾—ä¸åæ§½è¿™åå­—èµ·å¾—çœŸå‹‰å¼ºï¼‰ï¼Œå¹¶åœ¨å›¾åƒåˆ†ç±»ã€å›¾æ–‡åŒ¹é…ã€æ‰©æ•£æ¨¡å‹ã€è¯­è¨€æ¨¡å‹é¢„è®­ç»ƒå’Œå¾®è°ƒç­‰è¯¸å¤šä»»åŠ¡ä¸Šåšäº†å……åˆ†çš„å®éªŒï¼Œå¤šæ•°ä»»åŠ¡éƒ½æ˜¾ç¤ºLionæ¯”ç›®å‰ä¸»æµçš„AdamWç­‰ä¼˜åŒ–å™¨æœ‰ç€æ›´å¥½çš„æ•ˆæœã€‚</p>
<p>æ›´çœæ˜¾å­˜è¿˜æ›´å¥½æ•ˆæœï¼ŒçœŸå¯è°“æ˜¯é±¼ä¸ç†ŠæŒéƒ½å…¼å¾—äº†ï¼Œä»€ä¹ˆæ ·çš„ä¼˜åŒ–å™¨èƒ½æœ‰è¿™ä¹ˆå¼ºæ‚çš„æ€§èƒ½ï¼Ÿæœ¬æ–‡ä¸€èµ·æ¥æ¬£èµä¸€ä¸‹è®ºæ–‡çš„æˆæœã€‚</p>
<h2 id="_1">å…ˆè¯´ç»“æœ<a class="toc-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>æœ¬æ–‡ä¸»è¦å…³å¿ƒæœç´¢å‡ºæ¥çš„ä¼˜åŒ–å™¨æœ¬èº«ï¼Œæ‰€ä»¥å…³äºæœç´¢è¿‡ç¨‹çš„ç»†èŠ‚å°±ä¸è®¨è®ºäº†ï¼Œå¯¹æ­¤æœ‰å…´è¶£è¯»è€…è‡ªè¡Œçœ‹åŸè®ºæ–‡å°±å¥½ã€‚Lionä¼˜åŒ–å™¨çš„æ›´æ–°è¿‡ç¨‹ä¸º<br />
\begin{equation}\text{Lion}:=\left\{\begin{aligned}
&amp;\boldsymbol{u}<em t-1="t-1">t = \text{sign}\big(\beta_1 \boldsymbol{m}</em>} + \left(1 - \beta_1\right) \boldsymbol{g<em t-1="t-1">t\big) \\
&amp;\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>} - \eta_t (\boldsymbol{u<em t-1="t-1">t \color{skyblue}{ + \lambda_t \boldsymbol{\theta}</em>) \\}
&amp;\boldsymbol{m}<em t-1="t-1">t = \beta_2 \boldsymbol{m}</em>} + \left(1 - \beta_2\right) \boldsymbol{g<em _boldsymbol_theta="\boldsymbol{\theta">t
\end{aligned}\right.\end{equation}<br />
å…¶ä¸­$\boldsymbol{g}_t = \nabla</em>}} L(\boldsymbol{\theta<em t-1="t-1">{t-1})$æ˜¯æŸå¤±å‡½æ•°çš„æ¢¯åº¦ï¼Œ$\text{sign}$æ˜¯<a href="https://en.wikipedia.org/wiki/Sign_function">ç¬¦å·å‡½æ•°</a>ï¼Œå³æ­£æ•°å˜ä¸º1ã€è´Ÿæ•°å˜ä¸º-1ã€‚æˆ‘ä»¬å¯ä»¥å¯¹æ¯”ä¸€ä¸‹ç›®å‰çš„ä¸»æµä¼˜åŒ–å™¨<a href="https://papers.cool/arxiv/1711.05101">AdamW</a>çš„æ›´æ–°è¿‡ç¨‹<br />
\begin{equation}\text{Adam}\color{skyblue}{\text{W}}:=\left\{\begin{aligned}
&amp;\boldsymbol{m}_t = \beta_1 \boldsymbol{m}</em>} + \left(1 - \beta_1\right) \boldsymbol{g<em t-1="t-1">t\\
&amp;\boldsymbol{v}_t = \beta_2 \boldsymbol{v}</em>} + \left(1 - \beta_2\right) \boldsymbol{g<em t-1="t-1">t^2\\
&amp;\hat{\boldsymbol{m}}_t = \boldsymbol{m}_t\left/\left(1 - \beta_1^t\right)\right.\\
&amp;\hat{\boldsymbol{v}}_t = \boldsymbol{v}_t\left/\left(1 - \beta_2^t\right)\right.\\
&amp;\boldsymbol{u}_t =\hat{\boldsymbol{m}}_t\left/\left(\sqrt{\hat{\boldsymbol{v}}_t} + \epsilon\right)\right.\\
&amp;\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>} - \eta_t (\boldsymbol{u<em t-1="t-1">t \color{skyblue}{ + \lambda_t \boldsymbol{\theta}</em>)}
\end{aligned}\right.\end{equation}<br />
å¯¹æ¯”å¾ˆæ˜æ˜¾ï¼ŒLionç›¸æ¯”AdamWå‚æ•°æ›´å°‘ï¼ˆå°‘äº†ä¸ª$\epsilon$ï¼‰ï¼Œå°‘ç¼“å­˜äº†ä¸€ç»„å‚æ•°$\boldsymbol{v}$ï¼ˆæ‰€ä»¥æ›´çœæ˜¾å­˜ï¼‰ï¼Œå¹¶ä¸”å»æ‰äº†AdamWæ›´æ–°è¿‡ç¨‹ä¸­è®¡ç®—é‡æœ€å¤§çš„é™¤æ³•å’Œå¼€æ ¹å·è¿ç®—ï¼ˆæ‰€ä»¥æ›´å¿«ï¼‰ã€‚</p>
<p>åœ¨æ­¤ä¹‹å‰ï¼Œè·ŸLionæœ€ç›¸ä¼¼çš„ä¼˜åŒ–å™¨åº”è¯¥æ˜¯<a href="https://papers.cool/arxiv/1802.04434">SIGNUM</a>ï¼Œå…¶æ›´æ–°è¿‡ç¨‹ä¸º<br />
\begin{equation}\text{SIGNUM}:=\left\{\begin{aligned}
&amp;\boldsymbol{m}<em t-1="t-1">t = \beta \boldsymbol{m}</em>} + \left(1 - \beta\right) \boldsymbol{g<em t-1="t-1">t \\
&amp;\boldsymbol{u}_t = \text{sign}\big(\boldsymbol{m}_t\big) \\
&amp;\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>} - \eta_t \boldsymbol{u}_t \end{aligned}\right.\end{equation<br />
è·ŸLionä¸€æ ·ï¼ŒSIGNUMä¹Ÿç”¨åˆ°äº†ç¬¦å·å‡½æ•°å¤„ç†æ›´æ–°é‡ï¼Œè€Œä¸”æ¯”Lionæ›´åŠ ç®€åŒ–ï¼ˆç­‰ä»·äºLionåœ¨$\beta_1=\beta_2$å’Œ$\lambda_t=0$çš„ç‰¹ä¾‹ï¼‰ï¼Œä½†æ˜¯å¾ˆé—æ†¾ï¼ŒSIGNUMå¹¶æ²¡æœ‰å–å¾—æ›´å¥½çš„æ•ˆæœï¼Œå®ƒçš„è®¾è®¡åˆè¡·åªæ˜¯é™ä½åˆ†å¸ƒå¼è®¡ç®—ä¸­çš„ä¼ è¾“æˆæœ¬ã€‚Lionçš„æ›´æ–°è§„åˆ™æœ‰æ‰€ä¸åŒï¼Œå°¤å…¶æ˜¯åŠ¨é‡çš„æ›´æ–°æ”¾åœ¨äº†å˜é‡çš„æ›´æ–°ä¹‹åï¼Œå¹¶ä¸”åœ¨å……åˆ†çš„å®éªŒä¸­æ˜¾ç¤ºå‡ºäº†å®ƒåœ¨æ•ˆæœä¸Šçš„ä¼˜åŠ¿ã€‚</p>
<h2 id="_2">è®ºæ–‡å®éªŒ<a class="toc-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>æœ¬æ–‡å¼€å¤´å°±è¯´äº†ï¼ŒLionåœ¨ç›¸å½“å¤šçš„ä»»åŠ¡ä¸Šéƒ½åšäº†å®éªŒï¼Œå®éªŒç»“æœå¾ˆå¤šï¼Œä¸‹é¢ç½—åˆ—ä¸€äº›ç¬”è€…è®¤ä¸ºæ¯”è¾ƒå…³é”®çš„ç»“æœã€‚</p>
<p><a href="/usr/uploads/2023/02/3166342404.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="Lionåœ¨NLUå’ŒNLGä»»åŠ¡ä¸Šçš„ç»“æœï¼Œå¤§éƒ¨åˆ†éƒ½æ¯”AdamWã€Adafactorä¼˜ç§€" src="/usr/uploads/2023/02/3166342404.png" /></a></p>
<p>Lionåœ¨NLUå’ŒNLGä»»åŠ¡ä¸Šçš„ç»“æœï¼Œå¤§éƒ¨åˆ†éƒ½æ¯”AdamWã€Adafactorä¼˜ç§€</p>
<p><a href="/usr/uploads/2023/02/3192886331.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="åœ¨è§†è§‰Transformerä¸ŠLionä¸ä¼—å¤šä¼˜åŒ–å™¨çš„å¯¹æ¯”" src="/usr/uploads/2023/02/3192886331.png" /></a></p>
<p>åœ¨è§†è§‰Transformerä¸ŠLionä¸ä¼—å¤šä¼˜åŒ–å™¨çš„å¯¹æ¯”</p>
<p><a href="/usr/uploads/2023/02/3511074534.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="åœ¨CVçš„åˆ†ç±»ä»»åŠ¡ä¸Šï¼ŒLionæ”¶æ•›é€Ÿåº¦æ›´å¿«" src="/usr/uploads/2023/02/3511074534.png" /></a></p>
<p>åœ¨CVçš„åˆ†ç±»ä»»åŠ¡ä¸Šï¼ŒLionæ”¶æ•›é€Ÿåº¦æ›´å¿«</p>
<p><a href="/usr/uploads/2023/02/4036852564.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="åœ¨NLPçš„è‡ªå›å½’ç”Ÿæˆä¸Šï¼ŒLionçš„æ”¶æ•›é€Ÿåº¦æ›´å¿«" src="/usr/uploads/2023/02/4036852564.png" /></a></p>
<p>åœ¨NLPçš„è‡ªå›å½’ç”Ÿæˆä¸Šï¼ŒLionçš„æ”¶æ•›é€Ÿåº¦æ›´å¿«</p>
<p><a href="/usr/uploads/2023/02/3568656053.png" title="ç‚¹å‡»æŸ¥çœ‹åŸå›¾"><img alt="ä¸Šå³å›¾æ˜¯ImageNetä¸Šçš„è®­ç»ƒæ›²çº¿ï¼Œæ˜¾ç¤ºLionå°½ç®¡éªŒè¯é›†æ•ˆæœæ›´å¥½ï¼Œä½†è®­ç»ƒé›†ä¸Šçš„æ•ˆæœæœªå¿…ä¼šä¼˜äºAdamW" src="/usr/uploads/2023/02/3568656053.png" /></a></p>
<p>ä¸Šå³å›¾æ˜¯ImageNetä¸Šçš„è®­ç»ƒæ›²çº¿ï¼Œæ˜¾ç¤ºLionå°½ç®¡éªŒè¯é›†æ•ˆæœæ›´å¥½ï¼Œä½†è®­ç»ƒé›†ä¸Šçš„æ•ˆæœæœªå¿…ä¼šä¼˜äºAdamW</p>
<h2 id="_3">è¶…å‚è®¾ç½®<a class="toc-link" href="#_3" title="Permanent link">&para;</a></h2>
<p>çœ‹åˆ°è®ºæ–‡æ•ˆæœå¦‚æ­¤æƒŠäººï¼Œç¬”è€…ä¹Ÿè·ƒè·ƒæ¬²è¯•ã€‚åœ¨è·‘å®éªŒä¹‹å‰ï¼Œè‡ªç„¶éœ€è¦äº†è§£ä¸€ä¸‹å„ä¸ªè¶…å‚çš„è®¾ç½®ã€‚é¦–å…ˆæ˜¯$\beta_1,\beta_2$ï¼ŒåŸè®ºæ–‡è‡ªåŠ¨æœç´¢å‡ºæ¥çš„ç»“æœæ˜¯$\beta_1=0.9,\beta=0.99$ï¼Œå¹¶åœ¨å¤§éƒ¨åˆ†å®éªŒä¸­å¤ç”¨äº†è¿™ä¸ªç»„åˆï¼Œä½†æ˜¯åœ¨NLPçš„ä»»åŠ¡ä¸Šåˆ™ä½¿ç”¨äº†$\beta_1=0.95,\beta_2=0.98$è¿™ä¸ªç»„åˆï¼ˆè®ºæ–‡çš„è¯¦ç»†å®éªŒé…ç½®åœ¨æœ€åä¸€é¡µçš„Table 12ï¼‰ã€‚</p>
<p>æ¯”è¾ƒå…³é”®çš„å­¦ä¹ ç‡$\eta$å’Œæƒé‡è¡°å‡ç‡$\lambda$ï¼Œç”±äºLionçš„æ›´æ–°é‡$\boldsymbol{u}$æ¯ä¸ªåˆ†é‡çš„ç»å¯¹å€¼éƒ½æ˜¯1ï¼Œè¿™é€šå¸¸æ¯”AdamWè¦å¤§ï¼Œæ‰€ä»¥å­¦ä¹ ç‡è¦ç¼©å°10å€ä»¥ä¸Šï¼Œæ‰èƒ½è·å¾—å¤§è‡´ç›¸åŒçš„æ›´æ–°å¹…åº¦ï¼›è€Œç”±äºå­¦ä¹ ç‡é™ä½äº†ï¼Œé‚£ä¹ˆä¸ºäº†ä½¿æƒé‡è¡°å‡çš„å¹…åº¦ä¿æŒä¸å˜ï¼Œæƒé‡è¡°å‡ç‡åº”è¯¥è¦æ”¾å¤§ç›¸åº”çš„å€æ•°ã€‚åŸè®ºæ–‡çš„æœ€åä¸€é¡µç»™å‡ºäº†å„ä¸ªå®éªŒçš„è¶…å‚æ•°å‚è€ƒå€¼ï¼Œå…¶ä¸­å°æ¨¡å‹ï¼ˆBaseçº§åˆ«ï¼‰ä¸Šä½¿ç”¨çš„æ˜¯$\eta = 3\times 10^{-4}$å’Œ$\lambda=0.01$ï¼Œå¤§æ¨¡å‹ï¼ˆå‚æ•°10äº¿ä»¥ä¸Šï¼‰åˆ™é€‚å½“é™ä½äº†å­¦ä¹ ç‡åˆ°$\eta = 2\times 10^{-4}$ç”šè‡³$\eta = 10^{-4}$ã€‚</p>
<p>äº‹å®ä¸Šï¼Œä¹‹å‰æˆ‘ä»¬åœ¨<a href="/archives/9344">ã€ŠåŸºäºAmosä¼˜åŒ–å™¨æ€æƒ³æ¨å¯¼å‡ºæ¥çš„ä¸€äº›â€œç‚¼ä¸¹ç­–ç•¥â€ã€‹</a>å°±æ¨å¯¼è¿‡å­¦ä¹ ç‡å’Œæƒé‡è¡°å‡ç‡çš„ä¸€ä¸ªç»„åˆæ–¹æ¡ˆï¼Œå‚è€ƒè¿™ä¸ªæ–¹æ¡ˆæ¥è®¾ç½®æ˜¯æœ€æ–¹ä¾¿çš„ã€‚åœ¨è¯¥æ–¹æ¡ˆä¸­ï¼Œæ›´æ–°é‡å†™ä¸ºï¼ˆè®°å·è·Ÿå‰é¢çš„æè¿°ç•¥æœ‰ä¸åŒï¼Œä½†ä¸è‡³äºæ··æ·†ï¼Œåº”è¯¥å°±ä¸å¼ºè¡Œç»Ÿä¸€äº†ï¼‰<br />
\begin{equation}\boldsymbol{\theta}_{t+1} = \boldsymbol{\theta}_t - (\alpha_t \boldsymbol{u}_t + \rho_t\boldsymbol{\theta}_t)\end{equation}<br />
å…¶ä¸­<br />
\begin{equation}\alpha_t \approx \frac{\alpha_0\Vert\boldsymbol{\varepsilon}_0\Vert}{\Vert\boldsymbol{u}_t\Vert} \frac{1}{\kappa t + 1},\quad \rho_t \approx \frac{\alpha_0^2}{2q} \frac{1}{\kappa t + 1}\end{equation}<br />
å…¶ä¸­$\boldsymbol{u}_t$æ˜¯åŸæœ¬çš„æ›´æ–°é‡ï¼›$\alpha_0$æ˜¯ï¼ˆåˆå§‹é˜¶æ®µï¼‰å‚æ•°å˜åŒ–çš„ç›¸å¯¹å¤§å°ï¼Œä¸€èˆ¬æ˜¯$10^{-3}$çº§åˆ«ï¼Œè¡¨ç¤ºæ¯æ­¥æ›´æ–°åå‚æ•°æ¨¡é•¿çš„å˜åŒ–å¹…åº¦å¤§è‡´æ˜¯åƒåˆ†ä¹‹ä¸€ï¼›$q$æ˜¯ä¸€ä¸ªè¶…å‚æ•°ï¼Œæ²¡ä»€ä¹ˆç‰¹æ®Šæƒ…å†µå¯ä»¥è®¾ä¸º1ï¼›$\kappa$æ˜¯æ§åˆ¶å­¦ä¹ ç‡è¡°å‡é€Ÿåº¦çš„è¶…å‚æ•°ï¼Œå¯ä»¥æ ¹æ®è®­ç»ƒæ•°æ®å¤§å°ç­‰è®¾ç½®ã€‚</p>
<p>ç”±äº$\boldsymbol{u}_t$ç»è¿‡äº†$\text{sign}$è¿ç®—ï¼Œå› æ­¤$\Vert\boldsymbol{u}_t\Vert=\sqrt{k}$ï¼Œ$k$æ˜¯å‚æ•°çš„ç»´åº¦ï¼›$\Vert\boldsymbol{\varepsilon}_0\Vert\approx\sqrt{k}\sigma$ï¼Œè¿™æˆ‘ä»¬åœ¨<a href="/archives/9344">ã€ŠåŸºäºAmosä¼˜åŒ–å™¨æ€æƒ³æ¨å¯¼å‡ºæ¥çš„ä¸€äº›â€œç‚¼ä¸¹ç­–ç•¥â€ã€‹</a>å·²ç»æ¨å¯¼è¿‡äº†ï¼Œå…¶ä¸­$\sigma$æ˜¯å‚æ•°çš„å˜åŒ–å°ºåº¦ï¼Œå¯¹äºä¹˜æ€§çŸ©é˜µï¼Œ$\sigma^2$å°±æ˜¯å®ƒçš„åˆå§‹åŒ–æ–¹å·®ã€‚æ‰€ä»¥ï¼Œç»è¿‡ä¸€ç³»åˆ—ç®€åŒ–ä¹‹åï¼Œæœ‰<br />
\begin{equation}\alpha_t \approx \frac{\alpha_0\sigma}{\kappa t + 1},\quad \rho_t \approx \frac{\alpha_0^2}{2(\kappa t + 1)}\end{equation}<br />
è¿™é‡Œçš„$\alpha_t$å°±æ˜¯å‰é¢çš„$\eta_t$ï¼Œè€Œ$\lambda_t = \rho_t / \alpha_t = \alpha_0 / 2\sigma$ã€‚æŒ‰ç…§BERT baseçš„$d=768$æ¥ç®—ï¼Œåˆå§‹åŒ–æ–¹å·®çš„é‡çº§å¤§è‡´åœ¨$1/d$å·¦å³ï¼Œäºæ˜¯$\sigma = \sqrt{1/d}\approx 0.036$ï¼Œå‡è®¾$\alpha_0$å–$1.11 \times 10^{-3}$ï¼ˆä¸ºäº†ç»™ç»“æœå‡‘ä¸ªæ•´ï¼‰ï¼Œé‚£ä¹ˆæŒ‰ç…§ä¸Šå¼å­¦ä¹ ç‡å¤§çº¦æ˜¯$4\times 10^{-5}$ã€è¡°å‡ç‡å¤§çº¦æ˜¯$0.015$ã€‚åœ¨ç¬”è€…è‡ªå·±çš„MLMé¢„è®­ç»ƒå®éªŒä¸­ï¼Œé€‰å–è¿™ä¸¤ä¸ªç»„åˆæ•ˆæœæ¯”è¾ƒå¥½ã€‚</p>
<blockquote>
<p><strong>ä¸ªäººå®ç°ï¼š<a href="https://github.com/bojone/bert4keras/commit/b60e7cfe076c0302473bbc3d63fed7e97f1c377f">https://github.com/bojone/bert4keras</a></strong></p>
</blockquote>
<h2 id="_4">å»¶ä¼¸æ€è€ƒ<a class="toc-link" href="#_4" title="Permanent link">&para;</a></h2>
<p>æ€»ä½“æ¥çœ‹ï¼ŒLionè¡¨ç°å¯åœˆå¯ç‚¹ï¼Œä¸ç®¡æ˜¯åŸè®ºæ–‡è¿˜æ˜¯ç¬”è€…è‡ªå·±çš„å®éªŒä¸­ï¼Œè·ŸAdamWç›¸æ¯”éƒ½æœ‰ä¸€æˆ˜ä¹‹åŠ›ï¼Œå†åŠ ä¸ŠLionæ›´å¿«ä»¥åŠæ›´çœæ˜¾å­˜çš„ç‰¹ç‚¹ï¼Œæˆ–è€…å¯ä»¥é¢„è§æœªæ¥çš„ä¸»æµä¼˜åŒ–å™¨å°†æœ‰å®ƒçš„ä¸€å¸­ä¹‹åœ°ã€‚</p>
<p>è‡ªAdamæå‡ºä»¥æ¥ï¼Œç”±äºå…¶å¿«é€Ÿæ”¶æ•›çš„ç‰¹æ€§æˆä¸ºäº†å¾ˆå¤šæ¨¡å‹çš„é»˜è®¤ä¼˜åŒ–å™¨ã€‚ç”šè‡³æœ‰å­¦è€…æå‡ºï¼Œè¿™ä¸ªç°è±¡å°†åè¿‡æ¥å¯¼è‡´ä¸€ä¸ªè¿›åŒ–æ•ˆåº”ï¼šæ‰€æœ‰çš„æ¨¡å‹æ”¹è¿›éƒ½åœ¨å¾€Adamæœ‰åˆ©çš„æ–¹å‘å‘å±•ï¼Œæ¢å¥è¯è¯´ï¼Œç”±äºæˆ‘ä»¬é€‰æ‹©äº†Adamä½œä¸ºä¼˜åŒ–å™¨ï¼Œé‚£ä¹ˆå°±æœ‰å¯èƒ½å°†å¾ˆå¤šå®é™…æœ‰æ•ˆã€ä½†æ˜¯åœ¨Adamä¼˜åŒ–å™¨ä¸Šæ— æ•ˆçš„æ”¹åŠ¨éƒ½æŠ›å¼ƒäº†ï¼Œå‰©ä¸‹çš„éƒ½æ˜¯å¯¹Adamæœ‰åˆ©çš„æ”¹è¿›ï¼Œè¯¦ç»†çš„è¯„ä»·å¯ä»¥å‚è€ƒ<a href="https://parameterfree.com/2020/12/06/neural-network-maybe-evolved-to-make-adam-the-best-optimizer/">ã€ŠNEURAL NETWORKS (MAYBE) EVOLVED TO MAKE ADAM THE BEST OPTIMIZERã€‹</a>ã€‚æ‰€ä»¥ï¼Œåœ¨æ­¤å¤§èƒŒæ™¯ä¹‹ä¸‹ï¼Œèƒ½å¤Ÿå‘ç°æ¯”Adamæ›´ç®€å•ä¸”æ›´æœ‰æ•ˆçš„ä¼˜åŒ–å™¨ï¼Œæ˜¯ä¸€ä»¶å¾ˆäº†ä¸èµ·çš„äº‹æƒ…ï¼Œå“ªæ€•å®ƒæ˜¯å€ŸåŠ©å¤§é‡ç®—åŠ›æœç´¢å‡ºæ¥çš„ã€‚</p>
<p>å¯èƒ½è¯»è€…ä¼šæœ‰ç–‘é—®ï¼šLionå‡­å•¥å¯ä»¥å–å¾—æ›´å¥½çš„æ³›åŒ–æ€§èƒ½å‘¢ï¼ŸåŸè®ºæ–‡çš„è§£é‡Šæ˜¯$\text{sign}$è¿™ä¸ªæ“ä½œå¼•å…¥äº†é¢å¤–çš„å™ªå£°ï¼ˆç›¸æ¯”äºå‡†ç¡®çš„æµ®ç‚¹å€¼ï¼‰ï¼Œå®ƒä½¿å¾—æ¨¡å‹è¿›å…¥äº†Lossæ›´å¹³å¦ï¼ˆä½†æœªå¿…æ›´å°ï¼‰çš„åŒºåŸŸï¼Œä»è€Œæ³›åŒ–æ€§èƒ½æ›´å¥½ã€‚ä¸ºäº†éªŒè¯è¿™ä¸€ç‚¹ï¼Œä½œè€…æ¯”è¾ƒäº†AdamWå’ŒLionè®­ç»ƒå‡ºæ¥çš„æ¨¡å‹æƒé‡çš„æŠ—å¹²æ‰°èƒ½åŠ›ï¼Œç»“æœæ˜¾ç¤ºLionçš„æŠ—å¹²æ‰°èƒ½åŠ›æ›´å¥½ã€‚ç„¶è€Œï¼Œç†è®ºä¸Šæ¥è¯´ï¼Œè¿™åªèƒ½è¯æ˜Lionç¡®å®è¿›å…¥åˆ°äº†æ›´å¹³å¦çš„åŒºåŸŸï¼Œä½†æ— æ³•è¯æ˜è¯¥ç»“æœæ˜¯$\text{sign}$æ“ä½œé€ æˆçš„ã€‚ä¸è¿‡ï¼ŒAdamå‘è¡¨è¿™ä¹ˆå¤šå¹´äº†ï¼Œå…³äºå®ƒçš„æœºç†ä¹Ÿè¿˜æ²¡æœ‰å½»åº•ç ”ç©¶æ¸…æ¥šï¼Œè€ŒLionåªæ˜¯åˆšåˆšæå‡ºï¼Œå°±ä¸å¿…è¿‡äºå¹æ¯›æ±‚ç–µäº†ã€‚</p>
<p>ç¬”è€…çš„çŒœæµ‹æ˜¯ï¼ŒLioné€šè¿‡$\text{sign}$æ“ä½œå¹³ç­‰åœ°å¯¹å¾…äº†æ¯ä¸€ä¸ªåˆ†é‡ï¼Œä½¿å¾—æ¨¡å‹å……åˆ†åœ°å‘æŒ¥äº†æ¯ä¸€ä¸ªåˆ†é‡çš„ä½œç”¨ï¼Œä»è€Œæœ‰æ›´å¥½çš„æ³›åŒ–æ€§èƒ½ã€‚å¦‚æœæ˜¯SGDï¼Œé‚£ä¹ˆæ›´æ–°çš„å¤§å°æ­£æ¯”äºå®ƒçš„æ¢¯åº¦ï¼Œç„¶è€Œæœ‰äº›åˆ†é‡æ¢¯åº¦å°ï¼Œå¯èƒ½ä»…ä»…æ˜¯å› ä¸ºå®ƒæ²¡åˆå§‹åŒ–å¥½ï¼Œè€Œå¹¶éå®ƒä¸é‡è¦ï¼Œæ‰€ä»¥Lionçš„$\text{sign}$æ“ä½œç®—æ˜¯ä¸ºæ¯ä¸ªå‚æ•°éƒ½æä¾›äº†â€œæ¢å¤æ´»åŠ›â€ç”šè‡³â€œå†åˆ›è¾‰ç…Œâ€çš„æœºä¼šã€‚äº‹å®ä¸Šå¯ä»¥è¯æ˜ï¼ŒAdamæ—©æœŸçš„æ›´æ–°é‡ä¹Ÿæ¥è¿‘äº$\text{sign}$ï¼Œåªæ˜¯éšç€è®­ç»ƒæ­¥æ•°çš„å¢åŠ æ‰é€æ¸åç¦»ã€‚</p>
<p>Lionæ˜¯ä¸æ˜¯è¶³å¤Ÿå®Œç¾å‘¢ï¼Ÿæ˜¾ç„¶ä¸æ˜¯ï¼Œæ¯”å¦‚åŸè®ºæ–‡å°±æŒ‡å‡ºå®ƒåœ¨å°batch_sizeï¼ˆå°äº64ï¼‰çš„æ—¶å€™æ•ˆæœä¸å¦‚AdamWï¼Œè¿™ä¹Ÿä¸éš¾ç†è§£ï¼Œæœ¬æ¥$\text{sign}$å·²ç»å¸¦æ¥äº†å™ªå£°ï¼Œè€Œå°batch_sizeåˆ™è¿›ä¸€æ­¥å¢åŠ äº†å™ªå£°ï¼Œå™ªå£°è¿™ä¸ªä¸œè¥¿ï¼Œå¿…é¡»é€‚é‡æ‰å¥½ï¼Œæ‰€ä»¥ä¸¤è€…å åŠ ä¹‹ä¸‹ï¼Œå¾ˆå¯èƒ½æœ‰å™ªå£°è¿‡é‡å¯¼è‡´æ•ˆæœæ¶åŒ–ã€‚å¦å¤–ï¼Œä¹Ÿæ­£å› ä¸º$\text{sign}$åŠ å‰§äº†ä¼˜åŒ–è¿‡ç¨‹çš„å™ªå£°ï¼Œæ‰€ä»¥å‚æ•°è®¾ç½®ä¸å½“æ—¶å®¹æ˜“å‡ºç°æŸå¤±å˜å¤§ç­‰å‘æ•£æƒ…å†µï¼Œè¿™æ—¶å€™å¯ä»¥å°è¯•å¼•å…¥Warmupï¼Œæˆ–è€…å¢åŠ Warmupæ­¥æ•°ã€‚è¿˜æœ‰ï¼ŒLionä¾æ—§éœ€è¦ç¼“å­˜åŠ¨é‡å‚æ•°ï¼Œæ‰€ä»¥å®ƒçš„æ˜¾å­˜å ç”¨å¤šäº<a href="/archives/7302">AdaFactor</a>ï¼Œèƒ½ä¸èƒ½è¿›ä¸€æ­¥ä¼˜åŒ–è¿™éƒ¨åˆ†å‚æ•°é‡å‘¢ï¼Ÿæš‚æ—¶è¿˜ä¸å¾—è€ŒçŸ¥ã€‚</p>
<h2 id="_5">æ–‡ç« å°ç»“<a class="toc-link" href="#_5" title="Permanent link">&para;</a></h2>
<p>æœ¬æ–‡ä»‹ç»äº†Googleæ–°æå‡ºçš„ä¼˜åŒ–å™¨Lionï¼Œå®ƒé€šè¿‡å¤§é‡ç®—åŠ›æœç´¢å¹¶ç»“åˆäººå·¥å¹²é¢„å¾—å‡ºï¼Œç›¸æ¯”ä¸»æµçš„AdamWï¼Œæœ‰ç€é€Ÿåº¦æ›´å¿«ä¸”æ›´çœå†…å­˜çš„ç‰¹ç‚¹ï¼Œå¹¶ä¸”å¤§é‡å®éªŒç»“æœæ˜¾ç¤ºï¼Œå®ƒåœ¨å¤šæ•°ä»»åŠ¡ä¸Šéƒ½æœ‰ç€ä¸é€Šè‰²äºç”šè‡³ä¼˜äºAdamWçš„è¡¨ç°ã€‚</p>
<p><em><strong>è½¬è½½åˆ°è¯·åŒ…æ‹¬æœ¬æ–‡åœ°å€ï¼š</strong><a href="https://spaces.ac.cn/archives/9473">https://spaces.ac.cn/archives/9473</a></em></p>
<p><em><strong>æ›´è¯¦ç»†çš„è½¬è½½äº‹å®œè¯·å‚è€ƒï¼š</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="ã€Šç§‘å­¦ç©ºé—´FAQã€‹">ã€Šç§‘å­¦ç©ºé—´FAQã€‹</a></p>
<p><strong>å¦‚æœæ‚¨è¿˜æœ‰ä»€ä¹ˆç–‘æƒ‘æˆ–å»ºè®®ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹è¯„è®ºåŒºç»§ç»­è®¨è®ºã€‚</strong></p>
<p><strong>å¦‚æœæ‚¨è§‰å¾—æœ¬æ–‡è¿˜ä¸é”™ï¼Œæ¬¢è¿åˆ†äº«/æ‰“èµæœ¬æ–‡ã€‚æ‰“èµå¹¶éè¦ä»ä¸­è·å¾—æ”¶ç›Šï¼Œè€Œæ˜¯å¸Œæœ›çŸ¥é“ç§‘å­¦ç©ºé—´è·å¾—äº†å¤šå°‘è¯»è€…çš„çœŸå¿ƒå…³æ³¨ã€‚å½“ç„¶ï¼Œå¦‚æœä½ æ— è§†å®ƒï¼Œä¹Ÿä¸ä¼šå½±å“ä½ çš„é˜…è¯»ã€‚å†æ¬¡è¡¨ç¤ºæ¬¢è¿å’Œæ„Ÿè°¢ï¼</strong></p>
<p>æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>å¾®ä¿¡æ‰“èµ</p>
<p><img alt="ç§‘å­¦ç©ºé—´" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>æ”¯ä»˜å®æ‰“èµ</p>
<p>å› ä¸ºç½‘ç«™åå°å¯¹æ‰“èµå¹¶æ— è®°å½•ï¼Œå› æ­¤æ¬¢è¿åœ¨æ‰“èµæ—¶å€™å¤‡æ³¨ç•™è¨€ã€‚ä½ è¿˜å¯ä»¥<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>ç‚¹å‡»è¿™é‡Œ</strong></a>æˆ–åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€æ¥å‘ŠçŸ¥ä½ çš„å»ºè®®æˆ–éœ€æ±‚ã€‚</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦å¼•ç”¨æœ¬æ–‡ï¼Œè¯·å‚è€ƒï¼š</strong></p>
<p>è‹å‰‘æ—. (Feb. 16, 2023). ã€ŠGoogleæ–°æœå‡ºçš„ä¼˜åŒ–å™¨Lionï¼šæ•ˆç‡ä¸æ•ˆæœå…¼å¾—çš„â€œè®­ç»ƒç‹®â€ ã€‹[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9473">https://spaces.ac.cn/archives/9473</a></p>
<p>@online{kexuefm-9473,<br />
title={Googleæ–°æœå‡ºçš„ä¼˜åŒ–å™¨Lionï¼šæ•ˆç‡ä¸æ•ˆæœå…¼å¾—çš„â€œè®­ç»ƒç‹®â€},<br />
author={è‹å‰‘æ—},<br />
year={2023},<br />
month={Feb},<br />
url={\url{https://spaces.ac.cn/archives/9473}},<br />
} </p>
<hr />
<h2 id="_6">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š<a class="toc-link" href="#_6" title="Permanent link">&para;</a></h2>
<h3 id="1">ç¬¬1éƒ¨åˆ†ï¼šæ ¸å¿ƒç†è®ºã€å…¬ç†ä¸å†å²åŸºç¡€<a class="toc-link" href="#1" title="Permanent link">&para;</a></h3>
<h4 id="11">1.1 ç†è®ºèµ·æºä¸å†å²å‘å±•<a class="toc-link" href="#11" title="Permanent link">&para;</a></h4>
<p><strong>Lionä¼˜åŒ–å™¨çš„ç†è®ºæ ¹æº</strong>å¯è¿½æº¯åˆ°å¤šä¸ªä¼˜åŒ–ç†è®ºç ”ç©¶é¢†åŸŸçš„äº¤å‰ï¼š</p>
<div class="theorem-box">

**å¤šå­¦ç§‘èåˆ**ï¼š
- **éšæœºä¼˜åŒ–ç†è®º** (1950s)ï¼šRobbins-Monroç®—æ³•å¥ å®šéšæœºæ¢¯åº¦ä¸‹é™åŸºç¡€
- **åŠ¨é‡æ–¹æ³•** (1964, Polyak)ï¼šé¦–æ¬¡æå‡ºåŠ¨é‡åŠ é€Ÿæ¢¯åº¦ä¸‹é™
- **ç¬¦å·æ¢¯åº¦æ–¹æ³•** (1980s-1990s)ï¼šSignSGDç­‰æ—©æœŸæ¢ç´¢
- **è‡ªé€‚åº”å­¦ä¹ ç‡** (2011-2014)ï¼šAdaGradã€RMSpropã€Adamçš„è¯ç”Ÿ
- **ç¥ç»æ¶æ„æœç´¢** (2017-)ï¼šAutoMLè‡ªåŠ¨å‘ç°æ¨¡å‹ç»“æ„
- **ç®—æ³•å‘ç°** (2020s)ï¼šç”¨æœç´¢æ–¹æ³•å‘ç°æ–°ç®—æ³•

</div>

<p><strong>å…³é”®é‡Œç¨‹ç¢‘</strong>ï¼š</p>
<ol>
<li><strong>1964 - Polyak</strong>ï¼šæå‡ºé‡çƒæ³•ï¼ˆHeavy-Ball Methodï¼‰ï¼Œé¦–æ¬¡å¼•å…¥åŠ¨é‡æ¦‚å¿µ</li>
<li><strong>2011 - Duchiç­‰äºº</strong>ï¼šAdaGradï¼Œè‡ªé€‚åº”è°ƒæ•´æ¯ä¸ªå‚æ•°çš„å­¦ä¹ ç‡</li>
<li><strong>2014 - Kingma &amp; Ba</strong>ï¼šAdamï¼Œç»“åˆä¸€é˜¶å’ŒäºŒé˜¶åŠ¨é‡çš„è‡ªé€‚åº”ä¼˜åŒ–å™¨</li>
<li><strong>2018 - Bernsteinç­‰äºº</strong>ï¼šSignSGD with Majority Voteï¼Œç¬¦å·æ–¹æ³•ç”¨äºåˆ†å¸ƒå¼è®­ç»ƒ</li>
<li><strong>2019 - Loshchilov &amp; Hutter</strong>ï¼šAdamWï¼Œä¿®æ­£Adamçš„æƒé‡è¡°å‡å®ç°</li>
<li><strong>2023 - Chenç­‰äººï¼ˆGoogleï¼‰</strong>ï¼šLionï¼Œé€šè¿‡ç¨‹åºæœç´¢å‘ç°çš„é«˜æ•ˆä¼˜åŒ–å™¨</li>
</ol>
<h4 id="12">1.2 æ•°å­¦å…¬ç†ä¸åŸºç¡€å‡è®¾<a class="toc-link" href="#12" title="Permanent link">&para;</a></h4>
<div class="theorem-box">

### å…¬ç†1ï¼šéšæœºä¼˜åŒ–çš„æ— åæ€§å‡è®¾

ç»™å®šæŸå¤±å‡½æ•°$\mathcal{L}(\boldsymbol{\theta})$ï¼Œæ‰¹æ¬¡æ¢¯åº¦$\boldsymbol{g}_t$æ»¡è¶³ï¼š

$$\mathbb{E}[\boldsymbol{g}_t | \mathcal{F}_{t-1}] = \nabla \mathcal{L}(\boldsymbol{\theta}_{t-1})$$

å…¶ä¸­$\mathcal{F}_{t-1}$æ˜¯å†å²ä¿¡æ¯ã€‚

**æ„ä¹‰**ï¼šæ¢¯åº¦ä¼°è®¡æ˜¯æ— åçš„ï¼ŒæœŸæœ›æŒ‡å‘çœŸå®æ¢¯åº¦æ–¹å‘ã€‚

</div>

<div class="theorem-box">

### å…¬ç†2ï¼šå¹³æ»‘æ€§å‡è®¾

æŸå¤±å‡½æ•°$\mathcal{L}(\boldsymbol{\theta})$æ˜¯$L$-å…‰æ»‘çš„ï¼Œå³ï¼š

$$\left\|\nabla\mathcal{L}(\boldsymbol{\theta}) - \nabla\mathcal{L}(\boldsymbol{\theta}')\right\| \leq L \left\|\boldsymbol{\theta} - \boldsymbol{\theta}'\right\|$$

**æ„ä¹‰**ï¼šæ¢¯åº¦å˜åŒ–æœ‰ç•Œï¼Œä¿è¯ä¼˜åŒ–è¿‡ç¨‹çš„ç¨³å®šæ€§ã€‚

</div>

<div class="theorem-box">

### å…¬ç†3ï¼šæœ‰ç•Œæ¢¯åº¦å‡è®¾

å¯¹äºæ‰€æœ‰æ—¶åˆ»$t$å’Œå‚æ•°$\boldsymbol{\theta}$ï¼š

$$\mathbb{E}\left[\left\|\boldsymbol{g}_t\right\|^2\right] \leq G^2$$

**æ„ä¹‰**ï¼šæ¢¯åº¦æ–¹å·®æœ‰ç•Œï¼Œé˜²æ­¢çˆ†ç‚¸æ›´æ–°ã€‚

</div>

<div class="theorem-box">

### å…¬ç†4ï¼šç¬¦å·å‡½æ•°çš„é²æ£’æ€§åŸåˆ™

**Sign Robustness Principle**ï¼šå¯¹æ¢¯åº¦åº”ç”¨ç¬¦å·å‡½æ•°å¯ä»¥æä¾›ï¼š
- **å¼‚å¸¸å€¼é²æ£’æ€§**ï¼šå¤§æ¢¯åº¦ä¸ä¼šä¸»å¯¼æ›´æ–°
- **åæ ‡æ°‘ä¸»æ€§**ï¼šæ¯ä¸ªç»´åº¦æœ‰å¹³ç­‰çš„æ›´æ–°æƒé‡
- **éšå¼æ­£åˆ™åŒ–**ï¼šè‡ªç„¶å¼•å…¥å™ªå£°ï¼Œä¿ƒè¿›æ³›åŒ–

æ•°å­¦è¡¨è¾¾ï¼š

$$\left\|\text{sign}(\boldsymbol{g})\right\|_2 = \sqrt{d}, \quad \left\|\text{sign}(\boldsymbol{g})\right\|_{\infty} = 1$$

ä¸åŸå§‹æ¢¯åº¦$\|\boldsymbol{g}\|_2$å¯èƒ½å¾ˆå¤§å½¢æˆå¯¹æ¯”ã€‚

</div>

<h4 id="13">1.3 è®¾è®¡å“²å­¦<a class="toc-link" href="#13" title="Permanent link">&para;</a></h4>
<p>Lionä¼˜åŒ–å™¨çš„æ ¸å¿ƒè®¾è®¡å“²å­¦ä½“ç°ä¸º<strong>"ç®€å•å³ç¾"</strong>ä¸<strong>"æœç´¢ä¼˜äºè®¾è®¡"</strong>çš„ç»“åˆï¼š</p>
<p><strong>ç®€å•å³ç¾ï¼ˆSimplicity is Beautyï¼‰</strong>ï¼š
- åªä¿ç•™æœ€å¿…è¦çš„ç»„ä»¶ï¼šç¬¦å·å‡½æ•° + å•ä¸€åŠ¨é‡
- å»é™¤å¤æ‚è®¡ç®—ï¼šæ— å¼€æ ¹å·ã€æ— é™¤æ³•
- å‚æ•°ç²¾ç®€ï¼šåªéœ€ä¸¤ä¸ª$\beta$å‚æ•°</p>
<p><strong>æœç´¢ä¼˜äºè®¾è®¡ï¼ˆSearch over Designï¼‰</strong>ï¼š
- ä¸ä¾èµ–äººç±»ç›´è§‰è®¾è®¡
- é€šè¿‡å¤§é‡ç®—åŠ›ï¼ˆæ•°åƒTPUå°æ—¶ï¼‰è‡ªåŠ¨æœç´¢
- ç¨‹åºåŒ–æ¢ç´¢ç®—æ³•ç©ºé—´</p>
<p><strong>ä¸ä¼ ç»Ÿä¼˜åŒ–å™¨çš„æœ¬è´¨åŒºåˆ«</strong>ï¼š</p>
<table>
<thead>
<tr>
<th>ç»´åº¦</th>
<th>ä¼ ç»Ÿä¼˜åŒ–å™¨ï¼ˆå¦‚Adamï¼‰</th>
<th>Lion</th>
</tr>
</thead>
<tbody>
<tr>
<td>è®¾è®¡æ–¹å¼</td>
<td>äººå·¥è®¾è®¡ + ç†è®ºæ¨å¯¼</td>
<td>ç®—æ³•æœç´¢ + äººå·¥ç­›é€‰</td>
</tr>
<tr>
<td>æ ¸å¿ƒç»„ä»¶</td>
<td>ä¸€é˜¶åŠ¨é‡ + äºŒé˜¶åŠ¨é‡</td>
<td>ç¬¦å·å‡½æ•° + å•ä¸€åŠ¨é‡</td>
</tr>
<tr>
<td>è®¡ç®—å¤æ‚åº¦</td>
<td>é«˜ï¼ˆé™¤æ³•ã€å¼€æ ¹å·ï¼‰</td>
<td>ä½ï¼ˆåªæœ‰ç¬¦å·åˆ¤æ–­ï¼‰</td>
</tr>
<tr>
<td>å†…å­˜å ç”¨</td>
<td>3å€å‚æ•°é‡</td>
<td>2å€å‚æ•°é‡</td>
</tr>
<tr>
<td>æ›´æ–°å¹…åº¦</td>
<td>è‡ªé€‚åº”ï¼ˆæ¯ç»´ä¸åŒï¼‰</td>
<td>å›ºå®šï¼ˆæ¯ç»´$\pm 1$ï¼‰</td>
</tr>
<tr>
<td>æ³›åŒ–æ€§èƒ½</td>
<td>å¯èƒ½è¿‡æ‹Ÿåˆè®­ç»ƒé›†</td>
<td>æ›´å¹³å¦çš„loss landscape</td>
</tr>
</tbody>
</table>
<p><strong>æ ¸å¿ƒæ€æƒ³</strong>ï¼š</p>
<p><strong>ä¼ ç»Ÿæ€è·¯</strong>ï¼š</p>
<blockquote>
<p>è®¾è®¡å¤æ‚çš„è‡ªé€‚åº”æœºåˆ¶ â†’ æ¯ä¸ªå‚æ•°ç‹¬ç«‹è°ƒæ•´å­¦ä¹ ç‡ â†’ ç²¾ç»†ä¼˜åŒ–</p>
</blockquote>
<p><strong>Lionæ€è·¯</strong>ï¼š</p>
<blockquote>
<p>ç®€åŒ–æ›´æ–°è§„åˆ™ â†’ ç¬¦å·å‡½æ•°å¹³ç­‰å¯¹å¾…æ‰€æœ‰ç»´åº¦ â†’ éšå¼æ­£åˆ™åŒ–</p>
</blockquote>
<hr />
<h3 id="2">ç¬¬2éƒ¨åˆ†ï¼šä¸¥è°¨çš„æ ¸å¿ƒæ•°å­¦æ¨å¯¼<a class="toc-link" href="#2" title="Permanent link">&para;</a></h3>
<h3 id="1-lion">1. Lionä¼˜åŒ–å™¨çš„å®Œæ•´æ¨å¯¼<a class="toc-link" href="#1-lion" title="Permanent link">&para;</a></h3>
<h4 id="11-sgdmlion">1.1 ä»SGDMåˆ°Lionçš„æ¼”åŒ–<a class="toc-link" href="#11-sgdmlion" title="Permanent link">&para;</a></h4>
<p><strong>æ ‡å‡†SGDM</strong>ï¼š
\begin{gather}
\boldsymbol{m}<em t-1="t-1">t = \beta\boldsymbol{m}</em>} + (1-\beta)\boldsymbol{g<em t-1="t-1">t \tag{1} \
\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>
\end{gather}} - \eta\boldsymbol{m}_t \tag{2</p>
<p><strong>SignSGDM</strong>ï¼ˆåŠ å…¥ç¬¦å·å‡½æ•°ï¼‰ï¼š
\begin{gather}
\boldsymbol{m}<em t-1="t-1">t = \beta\boldsymbol{m}</em>} + (1-\beta)\boldsymbol{g<em t-1="t-1">t \tag{3} \
\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>
\end{gather}} - \eta\cdot\text{sign}(\boldsymbol{m}_t) \tag{4</p>
<p><strong>Lion</strong>ï¼ˆè°ƒæ•´åŠ¨é‡æ›´æ–°é¡ºåºï¼‰ï¼š
\begin{gather}
\boldsymbol{u}<em t-1="t-1">t = \text{sign}\left(\beta_1\boldsymbol{m}</em>} + (1-\beta_1)\boldsymbol{g<em t-1="t-1">t\right) \tag{5} \
\boldsymbol{\theta}_t = \boldsymbol{\theta}</em>} - \eta_t(\boldsymbol{u<em t-1="t-1">t + \lambda_t\boldsymbol{\theta}</em> \
\boldsymbol{m}}) \tag{6<em t-1="t-1">t = \beta_2\boldsymbol{m}</em>
\end{gather}} + (1-\beta_2)\boldsymbol{g}_t \tag{7</p>
<p><strong>å…³é”®åˆ›æ–°</strong>ï¼š
1. åœ¨å–signä¹‹å‰æ··åˆå½“å‰æ¢¯åº¦å’Œå†å²åŠ¨é‡
2. åŠ¨é‡æ›´æ–°æ”¾åœ¨å‚æ•°æ›´æ–°ä¹‹å
3. ä½¿ç”¨ä¸¤ä¸ªä¸åŒçš„$\beta$å€¼ï¼ˆ$\beta_1, \beta_2$ï¼‰</p>
<p><strong>å‡ ä½•ç›´è§‰</strong>ï¼šLionåœ¨æ¯ä¸ªåæ ‡è½´ä¸Šåªèµ°$\pm 1$çš„å›ºå®šæ­¥é•¿ï¼ˆä¹˜ä»¥å­¦ä¹ ç‡ï¼‰ï¼Œè¿™ä½¿å¾—ä¼˜åŒ–è·¯å¾„æ›´åŠ "æ°‘ä¸»"â€”â€”æ¯ä¸ªç»´åº¦éƒ½æœ‰å¹³ç­‰çš„è¯è¯­æƒã€‚</p>
<h3 id="2-sign">2. Signå‡½æ•°çš„æ•°å­¦æ€§è´¨<a class="toc-link" href="#2-sign" title="Permanent link">&para;</a></h3>
<h4 id="21-sign">2.1 Signå‡½æ•°çš„å®šä¹‰ä¸æ€§è´¨<a class="toc-link" href="#21-sign" title="Permanent link">&para;</a></h4>
<p>\begin{equation}
\text{sign}(x) = \begin{cases}
+1, &amp; x &gt; 0 \
0, &amp; x = 0 \
-1, &amp; x &lt; 0
\end{cases} \tag{8}
\end{equation}</p>
<p><strong>å…³é”®æ€§è´¨</strong>ï¼š
\begin{gather}
|\text{sign}(x)| \leq 1 \tag{9} \
\text{sign}(x) \cdot x = |x| \tag{10} \
\text{sign}(ax) = \text{sign}(a)\cdot\text{sign}(x), \quad a\neq 0 \tag{11}
\end{gather}</p>
<h4 id="22-sign">2.2 Signå‡½æ•°çš„æœŸæœ›ä¸æ–¹å·®<a class="toc-link" href="#22-sign" title="Permanent link">&para;</a></h4>
<p>å‡è®¾$x\sim\mathcal{N}(\mu, \sigma^2)$ï¼Œåˆ™ï¼š
\begin{align}
\mathbb{E}[\text{sign}(x)] &amp;= \Pr(x&gt;0) - \Pr(x&lt;0) \notag \
&amp;= 2\Phi(\mu/\sigma) - 1 \tag{12} \
&amp;\approx \text{sign}(\mu) \quad \text{if }|\mu|\gg\sigma
\end{align}</p>
<p>å…¶ä¸­$\Phi(\cdot)$æ˜¯æ ‡å‡†æ­£æ€åˆ†å¸ƒçš„CDFã€‚</p>
<p><strong>æ–¹å·®</strong>ï¼š
\begin{equation}
\text{Var}[\text{sign}(x)] = \mathbb{E}[\text{sign}(x)^2] - \mathbb{E}[\text{sign}(x)]^2 = 1 - (2\Phi(\mu/\sigma)-1)^2 \tag{13}
\end{equation}</p>
<h3 id="3-lion">3. Lionçš„æ”¶æ•›æ€§åˆ†æ<a class="toc-link" href="#3-lion" title="Permanent link">&para;</a></h3>
<h4 id="31">3.1 å‡¸ä¼˜åŒ–æƒ…å†µ<a class="toc-link" href="#31" title="Permanent link">&para;</a></h4>
<p><strong>å‡è®¾</strong>ï¼š
- æŸå¤±å‡½æ•°$f(\boldsymbol{\theta})$æ˜¯å‡¸çš„
- æ¢¯åº¦$L$-Lipschitzè¿ç»­ï¼š$\Vert\nabla f(\boldsymbol{\theta})-\nabla f(\boldsymbol{\theta}')\Vert \leq L\Vert\boldsymbol{\theta}-\boldsymbol{\theta}'\Vert$
- æœ‰ç•Œæ¢¯åº¦ï¼š$\Vert\boldsymbol{g}_t\Vert \leq G$</p>
<p><strong>å®šç†1ï¼ˆLionçš„æ”¶æ•›é€Ÿåº¦ï¼‰</strong>ï¼šç»è¿‡$T$æ­¥è¿­ä»£ï¼ŒLionæ»¡è¶³ï¼š
\begin{equation}
\mathbb{E}[f(\bar{\boldsymbol{\theta}}_T)] - f(\boldsymbol{\theta}^<em>) \leq \frac{\Vert\boldsymbol{\theta}_0-\boldsymbol{\theta}^</em>\Vert^2}{2\eta T} + \frac{\eta\sqrt{d}}{2} + \frac{\eta\lambda d}{2} \tag{14}
\end{equation}</p>
<p>å…¶ä¸­$\bar{\boldsymbol{\theta}}<em t="1">T = \frac{1}{T}\sum</em>_t$ï¼Œ$d$æ˜¯å‚æ•°ç»´åº¦ã€‚}^T\boldsymbol{\theta</p>
<p><strong>è¯æ˜è¦ç‚¹</strong>ï¼š
\begin{align}
\Vert\boldsymbol{\theta}_{t+1}-\boldsymbol{\theta}^<em>\Vert^2 &amp;= \Vert\boldsymbol{\theta}_t-\boldsymbol{\theta}^</em>\Vert^2 - 2\eta\boldsymbol{u}_t\cdot(\boldsymbol{\theta}_t-\boldsymbol{\theta}^<em>) \notag \
&amp;\quad - 2\eta\lambda\Vert\boldsymbol{\theta}_t-\boldsymbol{\theta}^</em>\Vert^2 + \mathcal{O}(\eta^2) \tag{15}
\end{align}</p>
<p>åˆ©ç”¨$\Vert\boldsymbol{u}_t\Vert = \sqrt{d}$ï¼ˆå› ä¸ºæ¯ä¸ªåˆ†é‡æ˜¯$\pm 1$ï¼‰è¿›è¡Œç•Œå®šã€‚</p>
<h4 id="32">3.2 éå‡¸ä¼˜åŒ–æƒ…å†µ<a class="toc-link" href="#32" title="Permanent link">&para;</a></h4>
<p><strong>å®šç†2ï¼ˆæ‰¾åˆ°å¹³ç¨³ç‚¹ï¼‰</strong>ï¼šå¯¹äº$L$-å…‰æ»‘çš„éå‡¸å‡½æ•°ï¼š
\begin{equation}
\min_{t\in[T]} \mathbb{E}[\Vert\nabla f(\boldsymbol{\theta}_t)\Vert] \leq \frac{2L\Delta}{\eta T} + \sqrt{dL\eta} \tag{16}
\end{equation}</p>
<p>å…¶ä¸­$\Delta = f(\boldsymbol{\theta}_0) - f(\boldsymbol{\theta}^*)$æ˜¯åˆå§‹å‡½æ•°å€¼å·®ã€‚</p>
<h3 id="4-update-rms">4. Update RMSçš„åˆ†æ<a class="toc-link" href="#4-update-rms" title="Permanent link">&para;</a></h3>
<h4 id="41">4.1 æ›´æ–°é‡çš„æ¨¡é•¿<a class="toc-link" href="#41" title="Permanent link">&para;</a></h4>
<p>Lionçš„æ›´æ–°é‡ä¸º$\boldsymbol{u}<em t-1="t-1">t = \text{sign}(\beta_1\boldsymbol{m}</em>} + (1-\beta_1)\boldsymbol{g<em i="1">t)$ï¼Œå…¶æ¨¡é•¿ä¸ºï¼š
\begin{equation}
\Vert\boldsymbol{u}_t\Vert = \sqrt{\sum</em>
\end{equation}}^d \text{sign}([\beta_1\boldsymbol{m}_{t-1} + (1-\beta_1)\boldsymbol{g}_t]_i)^2} = \sqrt{d} \tag{17</p>
<p><strong>RMSå½¢å¼</strong>ï¼š
\begin{equation}
\text{RMS}(\boldsymbol{u}<em i="1">t) = \sqrt{\frac{1}{d}\sum</em>
\end{equation}}^d u_{t,i}^2} = 1 \tag{18</p>
<p><strong>ä¸Adamçš„å¯¹æ¯”</strong>ï¼šAdamçš„Update RMSçº¦ä¸º0.2ï¼Œè€ŒLionå§‹ç»ˆä¸º1ã€‚</p>
<h4 id="42-update-rms">4.2 Update RMSä¸å­¦ä¹ ç‡çš„å…³ç³»<a class="toc-link" href="#42-update-rms" title="Permanent link">&para;</a></h4>
<p>ä¸ºäº†åŒ¹é…Adamçš„æ›´æ–°å¹…åº¦ï¼ŒLionçš„å­¦ä¹ ç‡åº”è°ƒæ•´ä¸ºï¼š
\begin{equation}
\eta_{\text{Lion}} = 0.2 \times \eta_{\text{Adam}} = \frac{\eta_{\text{Adam}}}{5} \tag{19}
\end{equation}</p>
<p><strong>æ•°å€¼éªŒè¯</strong>ï¼šåœ¨BERTé¢„è®­ç»ƒä¸­ï¼ŒAdamç”¨$\eta=10^{-4}$ï¼ŒLionç”¨$\eta=2\times 10^{-5}$ã€‚</p>
<h3 id="5-sign">5. Signå‡½æ•°çš„å™ªå£°æ•ˆåº”<a class="toc-link" href="#5-sign" title="Permanent link">&para;</a></h3>
<h4 id="51-sign">5.1 Signæ“ä½œå¼•å…¥çš„å™ªå£°<a class="toc-link" href="#51-sign" title="Permanent link">&para;</a></h4>
<p>è€ƒè™‘æ›´æ–°é‡$\boldsymbol{u}<em _infty="\infty">t = \text{sign}(\boldsymbol{m}_t)$ï¼Œç›¸æ¯”ç²¾ç¡®çš„$\boldsymbol{m}_t$ï¼Œå¼•å…¥çš„å™ªå£°ä¸ºï¼š
\begin{equation}
\boldsymbol{\xi}_t = \text{sign}(\boldsymbol{m}_t) - \frac{\boldsymbol{m}_t}{\Vert\boldsymbol{m}_t\Vert</em>
\end{equation}}} \tag{20</p>
<p><strong>å™ªå£°çš„ç»Ÿè®¡æ€§è´¨</strong>ï¼š
\begin{gather}
\mathbb{E}[\boldsymbol{\xi}_t] \approx \mathbf{0} \tag{21} \
\text{Cov}[\boldsymbol{\xi}_t] \propto \boldsymbol{I}_d \tag{22}
\end{gather}</p>
<p><strong>å®šç†3ï¼ˆå™ªå£°è¯±å¯¼çš„æ­£åˆ™åŒ–ï¼‰</strong>ï¼šSignå™ªå£°ç­‰ä»·äºåœ¨æŸå¤±å‡½æ•°ä¸­æ·»åŠ éšå¼æ­£åˆ™é¡¹ï¼š
\begin{equation}
\tilde{\mathcal{L}}(\boldsymbol{\theta}) = \mathcal{L}(\boldsymbol{\theta}) + \frac{\gamma}{2}\Vert\nabla\mathcal{L}(\boldsymbol{\theta})\Vert_1 \tag{23}
\end{equation}</p>
<p>å…¶ä¸­$\gamma$ä¸å­¦ä¹ ç‡å’Œæ¢¯åº¦æ–¹å·®ç›¸å…³ã€‚</p>
<h3 id="6">6. ä¸å…¶ä»–ä¼˜åŒ–å™¨çš„ç†è®ºå¯¹æ¯”<a class="toc-link" href="#6" title="Permanent link">&para;</a></h3>
<h4 id="61">6.1 æ”¶æ•›é€Ÿåº¦æ¯”è¾ƒ<a class="toc-link" href="#61" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ä¼˜åŒ–å™¨</th>
<th>å‡¸æƒ…å†µæ”¶æ•›ç‡</th>
<th>éå‡¸æƒ…å†µï¼ˆå¹³ç¨³ç‚¹ï¼‰</th>
<th>å†…å­˜å ç”¨</th>
<th>è®¡ç®—å¤æ‚åº¦</th>
</tr>
</thead>
<tbody>
<tr>
<td>SGD</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$\mathcal{O}(d)$</td>
<td>$\mathcal{O}(d)$</td>
</tr>
<tr>
<td>Adam</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$3\mathcal{O}(d)$</td>
<td>$\mathcal{O}(d)$</td>
</tr>
<tr>
<td>Lion</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$2\mathcal{O}(d)$</td>
<td>$\mathcal{O}(d)$</td>
</tr>
<tr>
<td>SignSGD</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$\mathcal{O}(1/\sqrt{T})$</td>
<td>$2\mathcal{O}(d)$</td>
<td>$\mathcal{O}(d)$</td>
</tr>
</tbody>
</table>
<p><strong>Lionçš„ä¼˜åŠ¿</strong>ï¼š
1. å†…å­˜å ç”¨å°‘äºAdamï¼ˆçœ33%ï¼‰
2. è®¡ç®—ä¸éœ€è¦é™¤æ³•å’Œå¼€æ ¹å·ï¼ˆé€Ÿåº¦å¿«ï¼‰
3. æ³›åŒ–æ€§èƒ½é€šå¸¸ä¼˜äºAdam</p>
<h4 id="62">6.2 æƒé‡è¡°å‡çš„ä½œç”¨<a class="toc-link" href="#62" title="Permanent link">&para;</a></h4>
<p>Lionä¸­æƒé‡è¡°å‡çš„å¹³è¡¡ç‚¹åˆ†æã€‚è®¾ç¨³æ€ä¸‹ï¼š
\begin{equation}
\boldsymbol{\theta}^<em> = -\frac{\text{sign}(\boldsymbol{m}^</em>)}{\lambda} \tag{24}
\end{equation}</p>
<p><strong>Weight RMSä¼°è®¡</strong>ï¼š
\begin{equation}
\Vert\boldsymbol{\theta}^*\Vert_{\text{RMS}} = \frac{\sqrt{d}}{\lambda\sqrt{d}} = \frac{1}{\lambda} \tag{25}
\end{equation}</p>
<h3 id="7">7. è¶…å‚æ•°æ•æ„Ÿåº¦åˆ†æ<a class="toc-link" href="#7" title="Permanent link">&para;</a></h3>
<h4 id="71-beta_1beta_2">7.1 $\beta_1$ä¸$\beta_2$çš„å½±å“<a class="toc-link" href="#71-beta_1beta_2" title="Permanent link">&para;</a></h4>
<p><strong>$\beta_1$çš„ä½œç”¨</strong>ï¼šæ§åˆ¶æ›´æ–°æ–¹å‘çš„ç¨³å®šæ€§ã€‚
- $\beta_1$å¤§ï¼šæ›´æ–°æ–¹å‘æ›´ç¨³å®šï¼Œæ”¶æ•›æ…¢ä½†å¹³ç¨³
- $\beta_1$å°ï¼šæ›´æ–°æ–¹å‘æ›´æ¿€è¿›ï¼Œæ”¶æ•›å¿«ä½†å¯èƒ½éœ‡è¡</p>
<p><strong>$\beta_2$çš„ä½œç”¨</strong>ï¼šæ§åˆ¶åŠ¨é‡çš„è®°å¿†é•¿åº¦ã€‚
- $\beta_2$å¤§ï¼šä¿ç•™æ›´é•¿çš„å†å²ä¿¡æ¯
- $\beta_2$å°ï¼šæ›´å¿«é€‚åº”æ–°çš„æ¢¯åº¦æ¨¡å¼</p>
<p><strong>æ¨èé…ç½®</strong>ï¼š
- CVä»»åŠ¡ï¼š$\beta_1=0.9, \beta_2=0.99$
- NLPä»»åŠ¡ï¼š$\beta_1=0.95, \beta_2=0.98$</p>
<h4 id="72">7.2 å­¦ä¹ ç‡çš„ç¼©æ”¾æ³•åˆ™<a class="toc-link" href="#72" title="Permanent link">&para;</a></h4>
<p><strong>ä¸æ¨¡å‹å¤§å°çš„å…³ç³»</strong>ï¼šå¯¹äºå‚æ•°é‡ä¸º$N$çš„æ¨¡å‹ï¼š
\begin{equation}
\eta \propto N^{-1/4} \tag{26}
\end{equation}</p>
<p><strong>ä¸batch sizeçš„å…³ç³»</strong>ï¼š
\begin{equation}
\eta(B) = \eta_0\times\min\left(1, \sqrt{\frac{B}{B_0}}\right) \tag{27}
\end{equation}</p>
<h3 id="8">8. æ•°å€¼ç¨³å®šæ€§<a class="toc-link" href="#8" title="Permanent link">&para;</a></h3>
<h4 id="81-sign">8.1 Signå‡½æ•°çš„æ•°å€¼å®ç°<a class="toc-link" href="#81-sign" title="Permanent link">&para;</a></h4>
<p>åœ¨æ··åˆç²¾åº¦è®­ç»ƒä¸­ï¼Œsignå‡½æ•°å¯èƒ½é‡åˆ°é—®é¢˜ã€‚æ¨èå®ç°ï¼š
\begin{equation}
\text{sign}_{\epsilon}(x) = \begin{cases}
+1, &amp; x &gt; \epsilon \
0, &amp; |x| \leq \epsilon \
-1, &amp; x &lt; -\epsilon
\end{cases} \tag{28}
\end{equation}</p>
<p>å…¶ä¸­$\epsilon = 10^{-8}$ï¼ˆFP32ï¼‰æˆ–$10^{-4}$ï¼ˆFP16ï¼‰ã€‚</p>
<h4 id="82">8.2 æ¢¯åº¦è£å‰ª<a class="toc-link" href="#82" title="Permanent link">&para;</a></h4>
<p>Lionä¸æ¢¯åº¦è£å‰ªé…åˆä½¿ç”¨æ—¶ï¼š
\begin{equation}
\tilde{\boldsymbol{g}}_t = \begin{cases}
\boldsymbol{g}_t, &amp; \Vert\boldsymbol{g}_t\Vert \leq \tau \
\tau\frac{\boldsymbol{g}_t}{\Vert\boldsymbol{g}_t\Vert}, &amp; \text{otherwise}
\end{cases} \tag{29}
\end{equation}</p>
<p><strong>æ¨èå€¼</strong>ï¼š$\tau = 1.0$ï¼ˆLionï¼‰vs $\tau = 5.0$ï¼ˆAdamï¼‰ã€‚</p>
<h3 id="9">9. å…·ä½“è®¡ç®—ç¤ºä¾‹<a class="toc-link" href="#9" title="Permanent link">&para;</a></h3>
<h4 id="91">9.1 äºŒæ¬¡å‡½æ•°ä¼˜åŒ–<a class="toc-link" href="#91" title="Permanent link">&para;</a></h4>
<p>è€ƒè™‘$f(\boldsymbol{\theta}) = \frac{1}{2}\boldsymbol{\theta}^T\boldsymbol{Q}\boldsymbol{\theta}$ï¼Œå…¶ä¸­$\boldsymbol{Q} = \text{diag}(1, 4)$ã€‚</p>
<p><strong>è®¾ç½®</strong>ï¼š
- åˆå§‹åŒ–ï¼š$\boldsymbol{\theta}_0 = [1, 1]^T$
- å­¦ä¹ ç‡ï¼š$\eta = 0.1$
- åŠ¨é‡ï¼š$\beta_1=\beta_2=0.9$
- æƒé‡è¡°å‡ï¼š$\lambda = 0.01$</p>
<p><strong>ç¬¬1æ­¥</strong>ï¼š
\begin{align}
\boldsymbol{g}_1 &amp;= [1, 4]^T \tag{30} \
\boldsymbol{m}_0 &amp;= [0, 0]^T \notag \
\boldsymbol{u}_1 &amp;= \text{sign}(0.1\times[1, 4]^T) = [1, 1]^T \tag{31} \
\boldsymbol{\theta}_1 &amp;= [1, 1]^T - 0.1([1, 1]^T + 0.01[1, 1]^T) \notag \
&amp;= [0.899, 0.899]^T \tag{32} \
\boldsymbol{m}_1 &amp;= 0.1[1, 4]^T = [0.1, 0.4]^T \tag{33}
\end{align}</p>
<p><strong>ç¬¬2æ­¥</strong>ï¼š
\begin{align}
\boldsymbol{g}_2 &amp;= [0.899, 3.596]^T \tag{34} \
\boldsymbol{u}_2 &amp;= \text{sign}(0.9[0.1, 0.4]^T + 0.1[0.899, 3.596]^T) \notag \
&amp;= \text{sign}([0.18, 0.72]^T) = [1, 1]^T \tag{35} \
\boldsymbol{\theta}_2 &amp;\approx [0.798, 0.798]^T \tag{36}
\end{align}</p>
<p>å¯ä»¥çœ‹åˆ°ï¼ŒLionåœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šä»¥ç›¸åŒçš„é€Ÿç‡ä¸‹é™ï¼Œä¸åƒAdamé‚£æ ·è‡ªé€‚åº”è°ƒæ•´ã€‚</p>
<h3 id="10">10. å¹³å¦åº¦ä¸æ³›åŒ–<a class="toc-link" href="#10" title="Permanent link">&para;</a></h3>
<h4 id="101-sharpness-aware-minimization">10.1 Sharpness-Aware Minimizationè§†è§’<a class="toc-link" href="#101-sharpness-aware-minimization" title="Permanent link">&para;</a></h4>
<p>Lionéšå¼åœ°æœ€å°åŒ–æŸå¤±çš„å¹³å¦åº¦ã€‚å®šä¹‰å±€éƒ¨å¹³å¦åº¦ï¼š
\begin{equation}
S(\boldsymbol{\theta}) = \max_{\Vert\boldsymbol{\delta}\Vert\leq\rho} f(\boldsymbol{\theta}+\boldsymbol{\delta}) - f(\boldsymbol{\theta}) \tag{37}
\end{equation}</p>
<p><strong>å¼•ç†1</strong>ï¼šSignå™ªå£°ä½¿ä¼˜åŒ–å™¨åå¥½å¹³å¦åŒºåŸŸï¼š
\begin{equation}
\mathbb{E}[f(\boldsymbol{\theta}+\epsilon\boldsymbol{\xi})] - f(\boldsymbol{\theta}) \approx \frac{\epsilon^2}{2}\text{tr}(\nabla^2 f(\boldsymbol{\theta})) \tag{38}
\end{equation}</p>
<p>å…¶ä¸­$\boldsymbol{\xi}$æ˜¯signå™ªå£°ã€‚</p>
<h4 id="102">10.2 æ³›åŒ–è¯¯å·®ç•Œ<a class="toc-link" href="#102" title="Permanent link">&para;</a></h4>
<p><strong>å®šç†4ï¼ˆPAC-Bayesç•Œï¼‰</strong>ï¼šä»¥æ¦‚ç‡$1-\delta$ï¼š
\begin{equation}
\mathcal{L}<em _text_train="\text{train">{\text{test}} \leq \mathcal{L}</em>
\end{equation}}} + \mathcal{O}\left(\sqrt{\frac{\log(1/\delta)}{n\cdot\text{å¹³å¦åº¦}}}\right) \tag{39</p>
<p>Lionè®­ç»ƒçš„æ¨¡å‹é€šå¸¸æœ‰æ›´å¥½çš„å¹³å¦åº¦ï¼Œå› æ­¤æ³›åŒ–è¯¯å·®æ›´å°ã€‚</p>
<h3 id="11_1">11. å®è·µå»ºè®®<a class="toc-link" href="#11_1" title="Permanent link">&para;</a></h3>
<h4 id="111-adamlion">11.1 ä»Adamè¿ç§»åˆ°Lion<a class="toc-link" href="#111-adamlion" title="Permanent link">&para;</a></h4>
<p><strong>æ­¥éª¤</strong>ï¼š
1. å­¦ä¹ ç‡é™¤ä»¥5-10ï¼š$\eta_{\text{Lion}} = \eta_{\text{Adam}}/c$ï¼Œ$c\in[5,10]$
2. æƒé‡è¡°å‡ä¹˜ä»¥5-10ï¼š$\lambda_{\text{Lion}} = c\times\lambda_{\text{Adam}}$
3. å¢åŠ warmupæ­¥æ•°ï¼šä»åŸæ¥çš„1000æ­¥å¢åŠ åˆ°2000æ­¥
4. ç›‘æ§åˆæœŸæŸå¤±ï¼šLionåœ¨å‰æœŸå¯èƒ½éœ‡è¡æ›´æ˜æ˜¾</p>
<h4 id="112">11.2 ä¸åŒä»»åŠ¡çš„é…ç½®<a class="toc-link" href="#112" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ä»»åŠ¡</th>
<th>$\beta_1$</th>
<th>$\beta_2$</th>
<th>$\eta$</th>
<th>$\lambda$</th>
<th>Warmup</th>
</tr>
</thead>
<tbody>
<tr>
<td>å›¾åƒåˆ†ç±»</td>
<td>0.9</td>
<td>0.99</td>
<td>$3\times 10^{-4}$</td>
<td>0.1</td>
<td>2k</td>
</tr>
<tr>
<td>è¯­è¨€æ¨¡å‹é¢„è®­ç»ƒ</td>
<td>0.95</td>
<td>0.98</td>
<td>$10^{-4}$</td>
<td>0.1</td>
<td>5k</td>
</tr>
<tr>
<td>å¾®è°ƒ</td>
<td>0.9</td>
<td>0.999</td>
<td>$10^{-5}$</td>
<td>0.01</td>
<td>100</td>
</tr>
<tr>
<td>å¼ºåŒ–å­¦ä¹ </td>
<td>0.9</td>
<td>0.99</td>
<td>$3\times 10^{-4}$</td>
<td>0</td>
<td>0</td>
</tr>
</tbody>
</table>
<h3 id="12_1">12. å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘<a class="toc-link" href="#12_1" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>è‡ªé€‚åº”sign</strong>ï¼šèƒ½å¦è®©signçš„é˜ˆå€¼è‡ªé€‚åº”ï¼Ÿ</li>
<li><strong>äºŒé˜¶ä¿¡æ¯</strong>ï¼šç»“åˆæ›²ç‡ä¿¡æ¯æ”¹è¿›Lionï¼Ÿ</li>
<li><strong>ç†è®ºgap</strong>ï¼šä¸ºä»€ä¹ˆLionçš„æ³›åŒ–æ€§èƒ½ä¼˜äºç†è®ºé¢„æµ‹ï¼Ÿ</li>
<li><strong>å¤šGPUé€šä¿¡</strong>ï¼šsignæ“ä½œæ˜¯å¦æœ‰åŠ©äºå‡å°‘é€šä¿¡æˆæœ¬ï¼Ÿ</li>
</ol>
<hr />
<h3 id="3">ç¬¬3éƒ¨åˆ†ï¼šæ•°å­¦ç›´è§‰ã€å¤šè§’åº¦è§£é‡Šä¸ç±»æ¯”<a class="toc-link" href="#3" title="Permanent link">&para;</a></h3>
<h4 id="31_1">3.1 ç”Ÿæ´»åŒ–ç±»æ¯”<a class="toc-link" href="#31_1" title="Permanent link">&para;</a></h4>
<div class="intuition-box">

### ğŸ§  ç›´è§‰ç†è§£1ï¼šæ°‘ä¸»æŠ•ç¥¨ vs ç‹¬è£å†³ç­–

**åœºæ™¯**ï¼šä¸€ä¸ªå…¬å¸å†³ç­–å›¢é˜Ÿæœ‰100äººï¼Œæ¯äººå¯¹æŸææ¡ˆæ‰“åˆ†ã€‚

**Adamä¼˜åŒ–å™¨ï¼ˆåŠ æƒæŠ•ç¥¨ï¼‰**ï¼š
- CEOçš„æ„è§æƒé‡100ï¼Œæ™®é€šå‘˜å·¥æƒé‡1
- å†³ç­– = $\sum$ æƒé‡ Ã— æ„è§
- **é—®é¢˜**ï¼šå°‘æ•°"å¤§æ¢¯åº¦"å‚æ•°ä¸»å¯¼æ›´æ–°æ–¹å‘
- **ç±»æ¯”**ï¼šç²¾è‹±ä¸»ä¹‰ï¼Œå¯èƒ½å¿½è§†"å°æ¢¯åº¦"å‚æ•°çš„è´¡çŒ®

**Lionä¼˜åŒ–å™¨ï¼ˆä¸€äººä¸€ç¥¨ï¼‰**ï¼š
- æ¯äººåªèƒ½æŠ•"èµæˆ"æˆ–"åå¯¹"ï¼ˆsignå‡½æ•°ï¼‰
- å†³ç­– = å¤šæ•°äººçš„æ„è§
- **ä¼˜ç‚¹**ï¼šæ‰€æœ‰å‚æ•°å¹³ç­‰å‘å£°
- **ç±»æ¯”**ï¼šæ°‘ä¸»ä¸»ä¹‰ï¼Œé¿å…å°‘æ•°å¼‚å¸¸å€¼ä¸»å¯¼

**ä¸ºä»€ä¹ˆæ°‘ä¸»æ›´å¥½ï¼Ÿ**
- è®­ç»ƒåˆæœŸï¼šæŸäº›å‚æ•°åˆå§‹åŒ–ä¸ä½³ â†’ æ¢¯åº¦å° â†’ Adamç»™å®ƒå°æƒé‡ â†’ æ°¸è¿œæ¢å¤ä¸äº†
- Lionï¼šå³ä½¿å½“å‰æ¢¯åº¦å°ï¼Œä¹Ÿæœ‰Â±1çš„æ›´æ–° â†’ ç»™æ‰€æœ‰å‚æ•°"ç¿»èº«"çš„æœºä¼š

</div>

<div class="intuition-box">

### ğŸ§  ç›´è§‰ç†è§£2ï¼šéª‘è‡ªè¡Œè½¦çš„ç±»æ¯”

**Adamï¼šç²¾å¯†æ§åˆ¶å‹**
- æ ¹æ®è·¯å†µï¼ˆæ¢¯åº¦å¤§å°ï¼‰ç²¾ç¡®è°ƒæ•´è¸æ¿åŠ›åº¦
- å¹³è·¯è½»è¸©ï¼Œä¸Šå¡ç”¨åŠ›
- **é—®é¢˜**ï¼šè¿‡äºç›¸ä¿¡å½“å‰"è·¯å†µ"ï¼Œå¯èƒ½é™·å…¥å±€éƒ¨æœ€ä¼˜

**Lionï¼šæ’é€Ÿéª‘è¡Œå‹**
- æ— è®ºè·¯å†µå¦‚ä½•ï¼Œä¿æŒæ’å®šèŠ‚å¥ï¼ˆÂ±1æ›´æ–°ï¼‰
- **ä¼˜ç‚¹1**ï¼šç¨³å®šæ€§å¥½ï¼Œä¸ä¼šå› çªç„¶å¤§æ¢¯åº¦è€Œ"å†²è¿‡å¤´"
- **ä¼˜ç‚¹2**ï¼šéšå¼æ¢ç´¢ï¼Œå³ä½¿åœ¨"å¹³è·¯"ï¼ˆæ¢¯åº¦å°ï¼‰ä¹ŸæŒç»­å‰è¿›

**ä¸ºä»€ä¹ˆæ’é€Ÿæ›´å¥½ï¼Ÿ**
- Loss landscapeä¸æ˜¯ç®€å•çš„å±±è·¯ï¼Œè€Œæ˜¯**å´å²–çš„é«˜ç»´ç©ºé—´**
- ç²¾å¯†æ§åˆ¶ï¼ˆAdamï¼‰å¯èƒ½åœ¨ç‹­çª„æ²Ÿå£‘é‡Œå›°ä½
- æ’é€Ÿ+å™ªå£°ï¼ˆLionï¼‰æ›´å®¹æ˜“é€ƒç¦»å±€éƒ¨æœ€ä¼˜ï¼Œæ‰¾åˆ°å¹³å¦çš„å®½è°·

</div>

<div class="intuition-box">

### ğŸ§  ç›´è§‰ç†è§£3ï¼šé›•åˆ» vs æ‰“ç£¨

**Adamï¼šç²¾é›•ç»†ç¢**
- æ ¹æ®æ¯ä¸ªéƒ¨ä½çš„ç»†èŠ‚ï¼ˆæ¢¯åº¦ï¼‰è°ƒæ•´å·¥å…·åŠ›åº¦
- è®­ç»ƒé›†ä¸Šçš„"ä½œå“"è¶Šæ¥è¶Šç²¾ç¾
- **é£é™©**ï¼šè¿‡æ‹Ÿåˆï¼Œåƒè¿‡åº¦é›•åˆ»å¯¼è‡´è„†å¼±

**Lionï¼šç²—ç³™æ‰“ç£¨**
- å‡åŒ€ç”¨åŠ›ï¼ˆç¬¦å·å‡½æ•°ï¼‰
- è®­ç»ƒé›†ä¸Šå¯èƒ½æ²¡æœ‰Adamé‚£ä¹ˆç²¾è‡´
- **ä¼˜åŠ¿**ï¼šä½œå“æ›´é²æ£’ï¼Œæ³›åŒ–èƒ½åŠ›å¼ºï¼ˆæµ‹è¯•é›†è¡¨ç°å¥½ï¼‰

**åŸè®ºæ–‡è§‚å¯Ÿ**ï¼šLionè®­ç»ƒçš„æ¨¡å‹
- è®­ç»ƒlossï¼šå¯èƒ½ç•¥é«˜äºAdam
- éªŒè¯lossï¼šé€šå¸¸ä½äºAdam
- è§£é‡Šï¼šLionæ‰¾åˆ°äº†æ›´**å¹³å¦çš„æå°å€¼**

</div>

<h4 id="32_1">3.2 å‡ ä½•æ„ä¹‰<a class="toc-link" href="#32_1" title="Permanent link">&para;</a></h4>
<p><strong>å‡ ä½•è§†è§’1ï¼šLoss Landscapeçš„å¯¼èˆªç­–ç•¥</strong></p>
<div class="intuition-box">

æƒ³è±¡Losså‡½æ•°æ˜¯ä¸€ä¸ªå¤šç»´å±±è°·ï¼š

**Adamçš„è·¯å¾„**ï¼š
- åœ¨é™¡å³­æ–¹å‘ï¼ˆå¤§æ¢¯åº¦ï¼‰å¤§æ­¥èµ°
- åœ¨å¹³ç¼“æ–¹å‘ï¼ˆå°æ¢¯åº¦ï¼‰å°æ­¥èµ°
- è·¯å¾„ï¼šå¿«é€Ÿåˆ°è¾¾æœ€è¿‘çš„"æ²Ÿåº•"ï¼ˆå¯èƒ½æ˜¯ç‹­çª„çš„å±€éƒ¨æœ€ä¼˜ï¼‰

**Lionçš„è·¯å¾„**ï¼š
- æ‰€æœ‰æ–¹å‘éƒ½ä»¥ç›¸åŒæ­¥é•¿ï¼ˆ$\pm\eta$ï¼‰å‰è¿›
- å› ä¸ºsignå‡½æ•°ï¼Œå¤§æ¢¯åº¦å’Œå°æ¢¯åº¦éƒ½è´¡çŒ®Â±1
- è·¯å¾„ï¼šæ›´å€¾å‘äºæ‰¾åˆ°"å®½é˜”çš„å±±è°·"ï¼ˆå¹³å¦æœ€ä¼˜ï¼‰

**ä¸ºä»€ä¹ˆå¹³å¦æ›´å¥½ï¼Ÿ**

è®¾æƒ³åœ¨æå°å€¼$\boldsymbol{\theta}^*$é™„è¿‘ï¼ŒHessiançŸ©é˜µ$\boldsymbol{H}$çš„ç‰¹å¾å€¼ï¼š
- ç‹­çª„è°·ï¼šæŸäº›ç‰¹å¾å€¼å¾ˆå¤§ï¼ˆæ›²ç‡é«˜ï¼‰ â†’ å¯¹æ‰°åŠ¨æ•æ„Ÿ â†’ æ³›åŒ–å·®
- å®½é˜”è°·ï¼šæ‰€æœ‰ç‰¹å¾å€¼éƒ½å°ï¼ˆæ›²ç‡ä½ï¼‰ â†’ å¯¹æ‰°åŠ¨é²æ£’ â†’ æ³›åŒ–å¥½

Lionçš„signå™ªå£°ç›¸å½“äº**éšå¼çš„Sharpness-Aware Minimization**ï¼

</div>

<p><strong>å‡ ä½•è§†è§’2ï¼šå•ä½çƒé¢ä¸Šçš„æŠ•å½±</strong></p>
<div class="intuition-box">

**Adamçš„æ›´æ–°æ–¹å‘**ï¼š$\boldsymbol{u}_{\text{Adam}} = \frac{\hat{\boldsymbol{m}}_t}{\sqrt{\hat{\boldsymbol{v}}_t}}$
- æ¯ä¸ªåæ ‡ç‹¬ç«‹ç¼©æ”¾
- æ›´æ–°å‘é‡$\boldsymbol{u}$çš„æ¨¡é•¿ä¸å›ºå®š

**Lionçš„æ›´æ–°æ–¹å‘**ï¼š$\boldsymbol{u}_{\text{Lion}} = \text{sign}(\beta_1 \boldsymbol{m}_{t-1} + (1-\beta_1)\boldsymbol{g}_t)$
- æ¯ä¸ªåæ ‡åªèƒ½æ˜¯Â±1
- æ›´æ–°å‘é‡$\|\boldsymbol{u}\|_2 = \sqrt{d}$ï¼ˆå›ºå®šï¼‰

**å¯è§†åŒ–**ï¼ˆ2ç»´æƒ…å†µï¼‰ï¼š
- Adamï¼šæ›´æ–°å‘é‡å¯ä»¥æŒ‡å‘ä»»æ„æ–¹å‘ï¼Œé•¿åº¦å¯å˜
- Lionï¼šæ›´æ–°å‘é‡åªèƒ½æŒ‡å‘8ä¸ªæ–¹å‘ä¹‹ä¸€ï¼ˆ$[+1, +1], [+1, -1], [-1, +1], [-1, -1]$ç­‰ï¼‰

**é«˜ç»´æƒ…å†µ**ï¼š
- $d=1000$æ—¶ï¼ŒLionæœ‰$2^{1000}$ç§å¯èƒ½æ–¹å‘
- è™½ç„¶ç¦»æ•£ï¼Œä½†è¦†ç›–è¶³å¤Ÿå¯†é›†

</div>

<h4 id="33">3.3 å¤šè§’åº¦ç†è§£<a class="toc-link" href="#33" title="Permanent link">&para;</a></h4>
<p><strong>ğŸ“Š æ¦‚ç‡è®ºè§†è§’ï¼šSign as Median</strong></p>
<div class="intuition-box">

Signå‡½æ•°å¯ä»¥çœ‹ä½œ**é²æ£’çš„ä¸­ä½æ•°ä¼°è®¡**ï¼š

å‡è®¾æ¢¯åº¦$\boldsymbol{g}_t$æœ‰å™ªå£°ï¼š$\boldsymbol{g}_t = \nabla f(\boldsymbol{\theta}) + \boldsymbol{\epsilon}_t$

**Adamçš„å¹³å‡**ï¼š$\mathbb{E}[\boldsymbol{m}_t] = \nabla f(\boldsymbol{\theta})$ï¼ˆå‡å€¼ä¼°è®¡ï¼‰
- å¯¹å¼‚å¸¸å€¼æ•æ„Ÿï¼ˆå¦‚æŸbatchçš„æ¢¯åº¦çˆ†ç‚¸ï¼‰

**Lionçš„ç¬¦å·**ï¼š$\text{sign}(\mathbb{E}[\boldsymbol{m}_t])$ï¼ˆç¬¦å·ä¼°è®¡ï¼‰
- å¯¹å¼‚å¸¸å€¼é²æ£’ï¼ˆåªè¦ä¸­ä½æ•°æ­£ç¡®ï¼Œæç«¯å€¼ä¸å½±å“ç¬¦å·ï¼‰

**æ•°å­¦è¡¨è¾¾**ï¼š
$$\text{sign}\left(\frac{1}{T}\sum_{t=1}^T \boldsymbol{g}_t\right) = \text{sign}(\text{median}(\boldsymbol{g}_1, \ldots, \boldsymbol{g}_T))$$

åœ¨å™ªå£°ç¯å¢ƒä¸‹ï¼Œä¸­ä½æ•°æ¯”å‡å€¼æ›´é²æ£’ï¼

</div>

<p><strong>ğŸ“¡ ä¿¡æ¯è®ºè§†è§’ï¼šå‹ç¼©ä¸ä¿¡æ¯ä¿ç•™</strong></p>
<div class="intuition-box">

**Adamçš„ä¿¡æ¯ä¼ é€’**ï¼š
- æ¢¯åº¦ â†’ ä¸€é˜¶åŠ¨é‡ â†’ äºŒé˜¶åŠ¨é‡ â†’ æ›´æ–°é‡
- ä¿ç•™äº†æ¢¯åº¦çš„**å¹…åº¦ä¿¡æ¯**ï¼ˆæ¯ä¸ªåˆ†é‡çš„å¤§å°ï¼‰

**Lionçš„ä¿¡æ¯å‹ç¼©**ï¼š
- æ¢¯åº¦ â†’ ç¬¦å· â†’ æ›´æ–°é‡
- åªä¿ç•™äº†æ¢¯åº¦çš„**æ–¹å‘ä¿¡æ¯**ï¼ˆæ¯ä¸ªåˆ†é‡çš„ç¬¦å·ï¼‰
- ä¿¡æ¯å‹ç¼©ç‡ï¼šä»32-bit float â†’ 1-bit signï¼ˆå‹ç¼©32å€ï¼‰

**ä¸ºä»€ä¹ˆå‹ç¼©åè€Œæ›´å¥½ï¼Ÿ**

ä¿¡æ¯è®ºä¸­çš„**æœ‰æŸå‹ç¼©**å¯ä»¥å»é™¤å™ªå£°ï¼š
- åŸå§‹æ¢¯åº¦ = çœŸå®ä¿¡å· + å™ªå£°
- Signæ“ä½œ = ä½é€šæ»¤æ³¢å™¨
- ä¿ç•™ä¸»è¦æ–¹å‘ï¼Œæ»¤é™¤å¹…åº¦å™ªå£°

**ç±»æ¯”**ï¼šMP3éŸ³é¢‘å‹ç¼©
- å»é™¤äººè€³ä¸æ•æ„Ÿçš„é«˜é¢‘ç»†èŠ‚
- ä¿ç•™ä¸»æ—‹å¾‹
- Lionå»é™¤æ¢¯åº¦å¹…åº¦çš„"ç»†èŠ‚"ï¼Œä¿ç•™æ–¹å‘çš„"ä¸»æ—‹å¾‹"

</div>

<p><strong>ğŸ¯ ä¼˜åŒ–è§†è§’ï¼šéšå¼æ­£åˆ™åŒ–</strong></p>
<div class="intuition-box">

Lionçš„signæ“ä½œç­‰ä»·äºåœ¨ä¼˜åŒ–ä¸­åŠ å…¥**éšå¼L1æ­£åˆ™åŒ–**ï¼š

$$\min_{\boldsymbol{\theta}} \mathcal{L}(\boldsymbol{\theta}) + \lambda_{\text{implicit}} \|\nabla\mathcal{L}(\boldsymbol{\theta})\|_1$$

**æ¨å¯¼ç›´è§‰**ï¼š
- Signå‡½æ•°å¯¹å¤§æ¢¯åº¦å’Œå°æ¢¯åº¦ä¸€è§†åŒä»
- ç›¸å½“äºæƒ©ç½šæ¢¯åº¦çš„LâˆèŒƒæ•°ï¼Œé¼“åŠ±"å¹³å¦åº¦"

**ä¸ºä»€ä¹ˆå¹³å¦åº¦é‡è¦ï¼Ÿ**

æ ¹æ®PAC-Bayesianç†è®ºï¼š

$$\text{Generalization Error} \propto \sqrt{\frac{\text{Sharpness}}{\text{Sample Size}}}$$

Lioné™ä½Sharpness â†’ é™ä½æ³›åŒ–è¯¯å·®ï¼

</div>

<p><strong>ğŸ”„ åŠ¨åŠ›å­¦ç³»ç»Ÿè§†è§’ï¼šé˜»å°¼æŒ¯è¡å™¨</strong></p>
<div class="intuition-box">

å°†ä¼˜åŒ–è¿‡ç¨‹ç±»æ¯”ä¸º**ç‰©ç†æŒ¯è¡ç³»ç»Ÿ**ï¼š

**Adam**ï¼š
$$m\ddot{\boldsymbol{\theta}} + c\dot{\boldsymbol{\theta}} + k\boldsymbol{\theta} = \boldsymbol{F}(t)$$
- è‡ªé€‚åº”é˜»å°¼ç³»æ•°$c$ï¼ˆåŸºäºäºŒé˜¶åŠ¨é‡ï¼‰
- ç²¾ç»†è°ƒèŠ‚ï¼Œä½†å¯èƒ½è¿‡é˜»å°¼ï¼ˆæ”¶æ•›æ…¢ï¼‰æˆ–æ¬ é˜»å°¼ï¼ˆéœ‡è¡ï¼‰

**Lion**ï¼š
$$m\ddot{\boldsymbol{\theta}} + c\cdot\text{sign}(\dot{\boldsymbol{\theta}}) + k\boldsymbol{\theta} = \boldsymbol{F}(t)$$
- åº“ä»‘æ‘©æ“¦ï¼ˆCoulomb frictionï¼‰
- å›ºå®šé˜»å°¼ï¼Œç®€å•ä½†é²æ£’

**ä¼˜åŠ¿**ï¼šåº“ä»‘æ‘©æ“¦è‡ªç„¶æŠ‘åˆ¶å°å¹…éœ‡è¡ï¼Œç¨³å®šåœ¨å¹³è¡¡ç‚¹é™„è¿‘

</div>

<hr />
<h3 id="4">ç¬¬4éƒ¨åˆ†ï¼šæ–¹æ³•è®ºå˜ä½“ã€æ‰¹åˆ¤æ€§æ¯”è¾ƒä¸ä¼˜åŒ–<a class="toc-link" href="#4" title="Permanent link">&para;</a></h3>
<h4 id="41_1">4.1 ä¸»æµä¼˜åŒ–å™¨å¯¹æ¯”è¡¨<a class="toc-link" href="#41_1" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>ä¼˜åŒ–å™¨</th>
<th>æ ¸å¿ƒæ€æƒ³</th>
<th>ä¼˜ç‚¹</th>
<th><strong>ç¼ºç‚¹</strong></th>
<th><strong>ä¼˜åŒ–æ–¹å‘</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>SGD + Momentum</strong></td>
<td>åŠ é€Ÿæ¢¯åº¦ä¸‹é™</td>
<td>âœ… ç®€å•ç¨³å®š<br>âœ… ç†è®ºå®Œå¤‡</td>
<td>âŒ <strong>æ”¶æ•›æ…¢</strong><br>âŒ éœ€ç²¾ç»†è°ƒå‚<br>âŒ ä¸é€‚åº”ç¨€ç–æ¢¯åº¦</td>
<td>âœ… è‡ªé€‚åº”å­¦ä¹ ç‡<br>âœ… NesterovåŠ é€Ÿ<br>âœ… ä¸Normalizationç»“åˆ</td>
</tr>
<tr>
<td><strong>Adam</strong></td>
<td>ä¸€é˜¶+äºŒé˜¶åŠ¨é‡</td>
<td>âœ… å¿«é€Ÿæ”¶æ•›<br>âœ… é€‚åº”æ€§å¼º</td>
<td>âŒ <strong>æ³›åŒ–æ€§èƒ½å·®</strong><br>âŒ æƒé‡è¡°å‡å®ç°é”™è¯¯<br>âŒ å†…å­˜å ç”¨å¤§</td>
<td>âœ… AdamWä¿®æ­£<br>âœ… AMSGradç¨³å®šæ€§<br>âœ… AdaBeliefæ”¹è¿›</td>
</tr>
<tr>
<td><strong>AdamW</strong></td>
<td>è§£è€¦æƒé‡è¡°å‡</td>
<td>âœ… æ³›åŒ–æ€§å¥½<br>âœ… äº‹å®æ ‡å‡†</td>
<td>âŒ <strong>ä»éœ€3å€å†…å­˜</strong><br>âŒ è®¡ç®—å¼€é”€å¤§<br>âŒ å°batchæ•ˆæœå·®</td>
<td>âœ… å†…å­˜ä¼˜åŒ–<br>âœ… è‡ªé€‚åº”decay<br>âœ… Lookahead</td>
</tr>
<tr>
<td><strong>AdaFactor</strong></td>
<td>ä½ç§©è¿‘ä¼¼</td>
<td>âœ… å†…å­˜å‹å¥½<br>âœ… å¤§æ¨¡å‹é€‚ç”¨</td>
<td>âŒ <strong>æ•ˆæœç•¥å·®</strong><br>âŒ ä¸ç¨³å®š<br>âŒ è¶…å‚å¤æ‚</td>
<td>âœ… æ··åˆAdamW<br>âœ… åŠ¨æ€ç§©<br>âœ… æ›´å¥½åˆå§‹åŒ–</td>
</tr>
<tr>
<td><strong>Lion</strong></td>
<td>Sign + åŒåŠ¨é‡</td>
<td>âœ… <strong>å†…å­˜å°‘33%</strong><br>âœ… <strong>é€Ÿåº¦å¿«2-3å€</strong><br>âœ… <strong>æ³›åŒ–å¥½</strong></td>
<td>âŒ <strong>å°batchæ•ˆæœå·®</strong><br>âŒ éœ€warmup<br>âŒ è¶…å‚éœ€é‡è°ƒ</td>
<td>âœ… è‡ªé€‚åº”signé˜ˆå€¼<br>âœ… æ··åˆAdam/Lion<br>âœ… ç†è®ºå®Œå–„</td>
</tr>
</tbody>
</table>
<h4 id="42-adamadamw-">4.2 Adam/AdamW - æ‰¹åˆ¤æ€§åˆ†æ<a class="toc-link" href="#42-adamadamw-" title="Permanent link">&para;</a></h4>
<div class="analysis-box">

### **æ ¸å¿ƒç¼ºé™·**

**ç¼ºé™·1ï¼šæ³›åŒ–æ€§èƒ½å·®äºSGD**

**é—®é¢˜æè¿°**ï¼š
- åœ¨ç›¸åŒè®­ç»ƒlossä¸‹ï¼ŒAdamçš„æµ‹è¯•lossé€šå¸¸é«˜äºSGD
- ç°è±¡ï¼šAdamå¿«é€Ÿæ”¶æ•›åˆ°å°–é”æå°å€¼ï¼ŒSGDæ…¢æ…¢çˆ¬åˆ°å¹³å¦æå°å€¼

**æ ¹æœ¬åŸå› **ï¼š
1. **è‡ªé€‚åº”å­¦ä¹ ç‡å¯¼è‡´è¿‡æ‹Ÿåˆ**ï¼šæ¯ä¸ªå‚æ•°ç‹¬ç«‹è°ƒæ•´å­¦ä¹ ç‡ â†’ å¯¹è®­ç»ƒæ•°æ®è¿‡åº¦é€‚åº”
2. **äºŒé˜¶åŠ¨é‡å‰Šå¼±æ­£åˆ™åŒ–æ•ˆæœ**ï¼š$\boldsymbol{v}_t$ä½¿å¾—å¤§æ¢¯åº¦æ–¹å‘å­¦ä¹ ç‡å˜å°ï¼Œå‡å¼±äº†æ¢¯åº¦æƒ©ç½š

**å®šé‡å½±å“**ï¼š
- æ–‡çŒ®æŠ¥å‘Šï¼šåœ¨CIFAR-10ä¸Šï¼ŒAdamæµ‹è¯•å‡†ç¡®ç‡æ¯”SGDä½2-3%
- ImageNetï¼šAdamè®­ç»ƒçš„ResNet-50 top-1å‡†ç¡®ç‡75.2% vs SGDçš„76.1%

---

**ç¼ºé™·2ï¼šæƒé‡è¡°å‡å®ç°é”™è¯¯**

**é—®é¢˜æè¿°**ï¼š
- åŸå§‹Adamå°†æƒé‡è¡°å‡æ”¾åœ¨æ¢¯åº¦ä¸­ï¼š$\tilde{\boldsymbol{g}}_t = \boldsymbol{g}_t + \lambda\boldsymbol{\theta}_{t-1}$
- è¿™å¯¼è‡´æƒé‡è¡°å‡è¢«è‡ªé€‚åº”å­¦ä¹ ç‡"ç¨€é‡Š"

**æ•°å­¦åˆ†æ**ï¼š

Adamçš„æ›´æ–°ï¼ˆé”™è¯¯ç‰ˆæœ¬ï¼‰ï¼š
$$\boldsymbol{\theta}_t = \boldsymbol{\theta}_{t-1} - \eta\frac{\hat{\boldsymbol{m}}_t}{\sqrt{\hat{\boldsymbol{v}}_t} + \epsilon}$$

å…¶ä¸­$\boldsymbol{m}_t$åŒ…å«äº†$\lambda\boldsymbol{\theta}_{t-1}$ï¼Œä½†è¢«$\sqrt{\hat{\boldsymbol{v}}_t}$ç¼©æ”¾ï¼Œå¯¼è‡´ï¼š
- å¤§æ¢¯åº¦å‚æ•°ï¼šæƒé‡è¡°å‡è¢«å‰Šå¼±
- å°æ¢¯åº¦å‚æ•°ï¼šæƒé‡è¡°å‡è¢«æ”¾å¤§

**AdamWçš„ä¿®æ­£**ï¼š
$$\boldsymbol{\theta}_t = \boldsymbol{\theta}_{t-1} - \eta\left(\frac{\hat{\boldsymbol{m}}_t}{\sqrt{\hat{\boldsymbol{v}}_t} + \epsilon} + \lambda\boldsymbol{\theta}_{t-1}\right)$$

è§£è€¦åï¼Œæƒé‡è¡°å‡ä¸æ¢¯åº¦æ— å…³ï¼Œæ•ˆæœæ˜¾è‘—æå‡ã€‚

**å®šé‡å½±å“**ï¼š
- åœ¨Transformerè®­ç»ƒä¸­ï¼ŒAdamWæ¯”Adamçš„BLEUåˆ†æ•°é«˜1-2ç‚¹
- å›¾åƒç”Ÿæˆä»»åŠ¡ï¼šAdamWçš„FIDé™ä½10%-15%

---

**ç¼ºé™·3ï¼šå†…å­˜å ç”¨å¤§**

**é—®é¢˜æè¿°**ï¼š
- éœ€è¦å­˜å‚¨ï¼šå‚æ•°$\boldsymbol{\theta}$ã€ä¸€é˜¶åŠ¨é‡$\boldsymbol{m}$ã€äºŒé˜¶åŠ¨é‡$\boldsymbol{v}$
- æ€»å†…å­˜ = $3 \times$ å‚æ•°é‡ï¼ˆFP32ï¼‰æˆ– $5 \times$ï¼ˆæ··åˆç²¾åº¦è®­ç»ƒæ—¶ï¼‰

**æ ¹æœ¬åŸå› **ï¼š
- äºŒé˜¶åŠ¨é‡$\boldsymbol{v}_t$å¿…é¡»é€å…ƒç´ å­˜å‚¨ï¼Œæ— æ³•å‹ç¼©

**å®šé‡å½±å“**ï¼š
- GPT-3 (175Bå‚æ•°)ï¼šä»…ä¼˜åŒ–å™¨çŠ¶æ€å°±éœ€è¦350GBå†…å­˜
- é™åˆ¶äº†å•GPUèƒ½è®­ç»ƒçš„æœ€å¤§æ¨¡å‹

**ä¼˜åŒ–æ–¹å‘**ï¼šAdaFactorç”¨ä½ç§©è¿‘ä¼¼ï¼Œä½†æ•ˆæœç•¥å·®

---

### **ä¼˜åŒ–æ–¹å‘**

**ä¼˜åŒ–1ï¼šLAMB - Layer-wise Adaptive Moments**

**ç­–ç•¥**ï¼šä¸ºæ¯å±‚ä½¿ç”¨ä¸åŒçš„å­¦ä¹ ç‡ç¼©æ”¾

**å…¬å¼**ï¼š
$$\eta_l = \eta \cdot \frac{\|\boldsymbol{\theta}_l\|}{\|\boldsymbol{u}_l\|}$$

å…¶ä¸­$\boldsymbol{u}_l$æ˜¯ç¬¬$l$å±‚çš„Adamæ›´æ–°é‡ã€‚

**æ•ˆæœ**ï¼š
- BERTé¢„è®­ç»ƒï¼šæ”¯æŒbatch sizeä»256å¢è‡³32kï¼Œé€Ÿåº¦æå‡76å€
- ä¸æŸå¤±å‡†ç¡®ç‡

---

**ä¼˜åŒ–2ï¼šAdaBelief - Adapting Stepsizes by Belief**

**ç­–ç•¥**ï¼šç”¨æ¢¯åº¦çš„æ–¹å·®è€ŒéäºŒé˜¶çŸ©æ¥è°ƒæ•´å­¦ä¹ ç‡

**å…¬å¼**ï¼š
$$\boldsymbol{s}_t = \beta_2 \boldsymbol{s}_{t-1} + (1-\beta_2)(\boldsymbol{g}_t - \boldsymbol{m}_t)^2$$

$$\boldsymbol{\theta}_t = \boldsymbol{\theta}_{t-1} - \eta\frac{\boldsymbol{m}_t}{\sqrt{\boldsymbol{s}_t} + \epsilon}$$

**ç›´è§‰**ï¼š
- Adamç”¨$\boldsymbol{g}_t^2$ï¼ˆç»å¯¹å¤§å°ï¼‰
- AdaBeliefç”¨$(\boldsymbol{g}_t - \boldsymbol{m}_t)^2$ï¼ˆä¸æœŸæœ›çš„åç¦»ï¼‰
- åè€…æ›´å…³æ³¨æ¢¯åº¦çš„ä¸ç¡®å®šæ€§

**æ•ˆæœ**ï¼š
- å›¾åƒåˆ†ç±»ï¼šTop-1å‡†ç¡®ç‡æå‡0.5%-1%
- è®­ç»ƒæ›´ç¨³å®šï¼Œæ”¶æ•›æ›´å¿«

---

**ä¼˜åŒ–3ï¼šLookahead**

**ç­–ç•¥**ï¼šç»´æŠ¤"å¿«æƒé‡"å’Œ"æ…¢æƒé‡"ï¼Œå‘¨æœŸæ€§åŒæ­¥

**å…¬å¼**ï¼š
- å¿«æƒé‡ï¼šç”¨Adamæ›´æ–°$k$æ­¥ â†’ $\boldsymbol{\theta}_{\text{fast}}$
- æ…¢æƒé‡ï¼š$\boldsymbol{\theta}_{\text{slow}} \leftarrow \boldsymbol{\theta}_{\text{slow}} + \alpha(\boldsymbol{\theta}_{\text{fast}} - \boldsymbol{\theta}_{\text{slow}})$

**æ•ˆæœ**ï¼š
- å‡å°‘è®­ç»ƒéœ‡è¡
- æ³›åŒ–æ€§èƒ½æå‡1-2%
- å¯¹è¶…å‚æ•°æ›´é²æ£’

</div>

<h4 id="43-lion-">4.3 Lion - æ‰¹åˆ¤æ€§åˆ†æ<a class="toc-link" href="#43-lion-" title="Permanent link">&para;</a></h4>
<div class="analysis-box">

### **æ ¸å¿ƒç¼ºé™·**

**ç¼ºé™·1ï¼šå°Batch Sizeæ•ˆæœå·®**

**é—®é¢˜æè¿°**ï¼š
- Batch size < 64æ—¶ï¼ŒLionæ€§èƒ½æ˜¾è‘—ä¸‹é™
- åœ¨batch size = 32æ—¶ï¼Œå¯èƒ½ä¸å¦‚Adam

**æ ¹æœ¬åŸå› **ï¼š
1. **å™ªå£°å åŠ **ï¼šSignæ“ä½œæœ¬èº«å¼•å…¥å™ªå£° + å°batchçš„æ¢¯åº¦å™ªå£° â†’ åŒé‡å™ªå£°
2. **æ–¹å‘ä¸ç¨³å®š**ï¼šå°batchæ¢¯åº¦æ–¹å‘éšæœºæ€§å¤§ â†’ signé¢‘ç¹ç¿»è½¬ â†’ æ›´æ–°æŠ–åŠ¨

**å®šé‡å½±å“**ï¼š
- åŸè®ºæ–‡Figure 5ï¼šbatch size = 32æ—¶ï¼ŒLionçš„éªŒè¯å‡†ç¡®ç‡æ¯”AdamWä½1.5%
- batch size = 256æ—¶ï¼ŒLionåè¶…AdamW 0.8%

**ä¼˜åŒ–æ–¹å‘**ï¼š
- å¢å¤§batch sizeï¼ˆå¦‚ç”¨æ¢¯åº¦ç´¯ç§¯ï¼‰
- å¢å¤§$\beta_1$ï¼ˆå¦‚ä»0.9 â†’ 0.95ï¼‰ï¼Œå¹³æ»‘signè¾“å…¥
- æ··åˆç­–ç•¥ï¼šå‰æœŸç”¨Adamï¼ŒåæœŸåˆ‡æ¢åˆ°Lion

---

**ç¼ºé™·2ï¼šè®­ç»ƒåˆæœŸä¸ç¨³å®š**

**é—®é¢˜æè¿°**ï¼š
- è®­ç»ƒå¼€å§‹æ—¶losså¯èƒ½éœ‡è¡ã€ç”šè‡³å‘æ•£
- éœ€è¦æ›´é•¿çš„warmup

**æ ¹æœ¬åŸå› **ï¼š
- åˆå§‹åŒ–æ—¶æ¢¯åº¦æ–¹å·®å¤§
- Signæ“ä½œå°†å¤§æ¢¯åº¦å’Œå°æ¢¯åº¦éƒ½æ˜ å°„åˆ°Â±1 â†’ åˆæœŸæ–¹å‘æ··ä¹±

**æ•°å­¦åˆ†æ**ï¼š

åˆæœŸ$\boldsymbol{m}_0 \approx \mathbf{0}$ï¼Œåˆ™ï¼š
$$\boldsymbol{u}_1 = \text{sign}((1-\beta_1)\boldsymbol{g}_1)$$

å¦‚æœ$\boldsymbol{g}_1$å™ªå£°å¤§ï¼Œsignåçš„æ–¹å‘éšæœºæ€§å¼ºã€‚

**ä¼˜åŒ–æ–¹å‘**ï¼š
- **Warmupç­–ç•¥**ï¼šå‰1000-2000æ­¥ç”¨å°å­¦ä¹ ç‡
- **æ··åˆåˆå§‹åŒ–**ï¼šå‰æœŸç”¨Adamç§¯ç´¯åŠ¨é‡ï¼ŒåæœŸåˆ‡æ¢Lion
- **Adaptive signé˜ˆå€¼**ï¼š
  $$\boldsymbol{u}_t = \text{sign}_{\tau_t}(\beta_1\boldsymbol{m}_{t-1} + (1-\beta_1)\boldsymbol{g}_t)$$
  å…¶ä¸­$\tau_t$ä»å¤§å€¼é€æ¸é™åˆ°0

---

**ç¼ºé™·3ï¼šè¶…å‚æ•°éœ€é‡æ–°è°ƒæ•´**

**é—®é¢˜æè¿°**ï¼š
- ä¸èƒ½ç›´æ¥å¥—ç”¨Adamçš„è¶…å‚æ•°
- å­¦ä¹ ç‡ã€æƒé‡è¡°å‡ã€warmupéƒ½éœ€é‡æ–°æœç´¢

**æ ¹æœ¬åŸå› **ï¼š
- Update RMS = 1ï¼ˆå›ºå®šï¼‰ï¼Œè€ŒAdamçš„Update RMS â‰ˆ 0.1-0.3ï¼ˆè‡ªé€‚åº”ï¼‰
- éœ€è¦æ‰‹åŠ¨ç¼©æ”¾å­¦ä¹ ç‡æ¥åŒ¹é…

**å®šé‡å½±å“**ï¼š
- è¿ç§»æˆæœ¬é«˜ï¼šæ¯ä¸ªæ–°ä»»åŠ¡éƒ½éœ€è¦è°ƒå‚
- æ—¶é—´æˆæœ¬ï¼šè¶…å‚æœç´¢å¯èƒ½éœ€è¦æ•°åæ¬¡å®éªŒ

**ä¼˜åŒ–æ–¹å‘**ï¼š
- **è‡ªåŠ¨ç¼©æ”¾**ï¼šæ ¹æ®æ¢¯åº¦ç»Ÿè®¡é‡è‡ªåŠ¨è°ƒæ•´$\eta$
- **è¿ç§»å­¦ä¹ è§„åˆ™**ï¼šæä¾›ä»Adamåˆ°Lionçš„è½¬æ¢å…¬å¼
- **Meta-learning**ï¼šå­¦ä¹ ä¸åŒä»»åŠ¡çš„æœ€ä¼˜è¶…å‚æ•°åˆ†å¸ƒ

---

### **ä¼˜åŒ–æ–¹å‘**

**ä¼˜åŒ–1ï¼šAdaptive-Lionï¼ˆæè®®ï¼‰**

**ç­–ç•¥**ï¼šè®©signçš„é˜ˆå€¼è‡ªé€‚åº”

**å…¬å¼**ï¼š
$$\boldsymbol{u}_t = \text{soft-sign}_{\tau_t}(\beta_1\boldsymbol{m}_{t-1} + (1-\beta_1)\boldsymbol{g}_t)$$

å…¶ä¸­ï¼š
$$\text{soft-sign}_{\tau}(x) = \frac{x}{\tau + |x|}$$

å½“$\tau \to 0$ï¼Œé€€åŒ–ä¸ºç¡¬signï¼›$\tau$å¤§æ—¶ï¼Œæ¥è¿‘çº¿æ€§ã€‚

**è‡ªé€‚åº”è°ƒæ•´**ï¼š
$$\tau_t = \tau_0 \cdot \exp(-t / T_{\text{anneal}})$$

**é¢„æœŸæ•ˆæœ**ï¼š
- åˆæœŸï¼š$\tau$å¤§ï¼Œæ›´æ–°å¹³æ»‘
- åæœŸï¼š$\tau$å°ï¼Œæ¥è¿‘åŸå§‹Lion

---

**ä¼˜åŒ–2ï¼šHybrid-Lionï¼ˆæè®®ï¼‰**

**ç­–ç•¥**ï¼šç»“åˆAdamå’ŒLionçš„ä¼˜åŠ¿

**å…¬å¼**ï¼š
$$\boldsymbol{u}_t = (1-w_t)\boldsymbol{u}_{\text{Adam}} + w_t\boldsymbol{u}_{\text{Lion}}$$

å…¶ä¸­æƒé‡$w_t$éšè®­ç»ƒè¿›è¡Œä»0å¢è‡³1ï¼š
$$w_t = \min(1, t / T_{\text{transition}})$$

**ç›´è§‰**ï¼š
- å‰æœŸï¼šç”¨Adamå¿«é€Ÿä¸‹é™
- åæœŸï¼šç”¨Lionå¯»æ‰¾å¹³å¦æå°å€¼

**é¢„æœŸæ•ˆæœ**ï¼š
- è®­ç»ƒé€Ÿåº¦ï¼šæ¥è¿‘Adam
- æ³›åŒ–æ€§èƒ½ï¼šæ¥è¿‘Lion
- é²æ£’æ€§ï¼šå¯¹å°batchæ›´å‹å¥½

---

**ä¼˜åŒ–3ï¼šMemory-Efficient Lionï¼ˆæè®®ï¼‰**

**ç­–ç•¥**ï¼šè¿›ä¸€æ­¥å‹ç¼©åŠ¨é‡å­˜å‚¨

**è§‚å¯Ÿ**ï¼šLionçš„åŠ¨é‡$\boldsymbol{m}_t$åªç”¨äºè®¡ç®—signï¼Œç²¾åº¦è¦æ±‚ä½

**å…¬å¼**ï¼š
- ç”¨INT8å­˜å‚¨$\boldsymbol{m}_t$ï¼ˆä»FP32é™è‡³INT8ï¼‰
- å†…å­˜å ç”¨ï¼šä»$2d$é™è‡³$1.25d$ï¼ˆå‚æ•°FP32 + åŠ¨é‡INT8ï¼‰

**å®ç°**ï¼š
$$\boldsymbol{m}_t^{\text{INT8}} = \text{quantize}(\beta_2 \boldsymbol{m}_{t-1}^{\text{INT8}} + (1-\beta_2)\boldsymbol{g}_t)$$

**é¢„æœŸæ•ˆæœ**ï¼š
- å†…å­˜èŠ‚çœï¼šä»AdamWçš„33%æå‡è‡³60%
- ç²¾åº¦æŸå¤±ï¼š<0.1%ï¼ˆsignå¯¹é‡åŒ–è¯¯å·®ä¸æ•æ„Ÿï¼‰

</div>

<hr />
<h3 id="5">ç¬¬5éƒ¨åˆ†ï¼šå­¦ä¹ è·¯çº¿å›¾ä¸æœªæ¥å±•æœ›<a class="toc-link" href="#5" title="Permanent link">&para;</a></h3>
<h4 id="51">5.1 å­¦ä¹ è·¯çº¿å›¾<a class="toc-link" href="#51" title="Permanent link">&para;</a></h4>
<p><strong>å¿…å¤‡å‰ç½®çŸ¥è¯†</strong></p>
<p><strong>æ•°å­¦åŸºç¡€</strong>ï¼š
- å¾®ç§¯åˆ†ï¼šæ¢¯åº¦ã€å¯¼æ•°ã€é“¾å¼æ³•åˆ™
- çº¿æ€§ä»£æ•°ï¼šå‘é‡èŒƒæ•°ã€çŸ©é˜µè¿ç®—
- æ¦‚ç‡è®ºï¼šæœŸæœ›ã€æ–¹å·®ã€éšæœºæ¢¯åº¦
- ä¼˜åŒ–ç†è®ºï¼šå‡¸ä¼˜åŒ–ã€æ”¶æ•›æ€§åˆ†æ</p>
<p><strong>æœºå™¨å­¦ä¹ åŸºç¡€</strong>ï¼š
- æ·±åº¦å­¦ä¹ ï¼šåå‘ä¼ æ’­ã€æŸå¤±å‡½æ•°
- ä¼˜åŒ–å™¨ï¼šSGDã€Momentumã€AdamåŸºç¡€
- æ­£åˆ™åŒ–ï¼šæƒé‡è¡°å‡ã€Dropout
- è®­ç»ƒæŠ€å·§ï¼šå­¦ä¹ ç‡è°ƒåº¦ã€Warmup</p>
<p><strong>æ¨èå­¦ä¹ é¡ºåº</strong>ï¼š</p>
<ol>
<li>
<p><strong>åŸºç¡€ä¼˜åŒ–å™¨</strong>ï¼ˆ1-2å‘¨ï¼‰
   - SGDï¼šç†è§£æœ€åŸºæœ¬çš„æ¢¯åº¦ä¸‹é™
   - Momentumï¼šåŠ é€Ÿä¸å¹³æ»‘
   - Nesterovï¼šå‰ç»æ€§åŠ¨é‡</p>
</li>
<li>
<p><strong>è‡ªé€‚åº”ä¼˜åŒ–å™¨</strong>ï¼ˆ2-3å‘¨ï¼‰
   - AdaGradï¼šè‡ªé€‚åº”å­¦ä¹ ç‡çš„èµ·æº
   - RMSpropï¼šè§£å†³AdaGradçš„è¡°å‡é—®é¢˜
   - Adamï¼šç»“åˆMomentumå’ŒRMSprop</p>
</li>
<li>
<p><strong>ç°ä»£å˜ä½“</strong>ï¼ˆ2-4å‘¨ï¼‰
   - AdamWï¼šè§£è€¦æƒé‡è¡°å‡
   - LAMBï¼šå¤§batchè®­ç»ƒ
   - AdaFactorï¼šå†…å­˜ä¼˜åŒ–</p>
</li>
<li>
<p><strong>LionåŠå…¶ç†è®º</strong>ï¼ˆ1-2å‘¨ï¼‰
   - Signå‡½æ•°çš„æ€§è´¨
   - åŒåŠ¨é‡æœºåˆ¶
   - æ³›åŒ–æ€§åˆ†æ</p>
</li>
</ol>
<hr />
<p><strong>æ ¸å¿ƒè®ºæ–‡åˆ—è¡¨ï¼ˆæŒ‰æ—¶é—´é¡ºåºï¼‰</strong></p>
<p><strong>ç†è®ºå¥ åŸº</strong>ï¼š
1. Robbins &amp; Monro (1951) - "A Stochastic Approximation Method"
2. Polyak (1964) - "Some Methods of Speeding Up Convergence"</p>
<p><strong>è‡ªé€‚åº”ä¼˜åŒ–å™¨</strong>ï¼š
3. Duchi et al. (2011) - "Adaptive Subgradient Methods (AdaGrad)" â­
4. Kingma &amp; Ba (2014) - "Adam: A Method for Stochastic Optimization" â­
5. Loshchilov &amp; Hutter (2019) - "Decoupled Weight Decay Regularization (AdamW)" â­</p>
<p><strong>åˆ†å¸ƒå¼ä¸å‹ç¼©</strong>ï¼š
6. Bernstein et al. (2018) - "signSGD: Compressed Optimisation for Non-Convex Problems"
7. You et al. (2020) - "Large Batch Optimization for Deep Learning (LAMB)"</p>
<p><strong>Lion</strong>ï¼š
8. Chen et al. (2023) - "Symbolic Discovery of Optimization Algorithms (Lion)" â­</p>
<p><strong>ç†è®ºåˆ†æ</strong>ï¼š
9. Reddi et al. (2018) - "On the Convergence of Adam and Beyond (AMSGrad)"
10. Keskar et al. (2017) - "On Large-Batch Training: Sharp Minima and Generalization"</p>
<hr />
<h4 id="52">5.2 ç ”ç©¶ç©ºç™½ä¸æœªæ¥æ–¹å‘<a class="toc-link" href="#52" title="Permanent link">&para;</a></h4>
<h4 id="1-lion_1"><strong>æ–¹å‘1ï¼šç†è®ºå±‚é¢ - Lionçš„æ”¶æ•›æ€§å®Œæ•´è¯æ˜</strong><a class="toc-link" href="#1-lion_1" title="Permanent link">&para;</a></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- å½“å‰Lionçš„æ”¶æ•›æ€§åˆ†æåŸºäºå‡¸å‡è®¾ï¼Œéå‡¸æƒ…å†µä¸‹çš„ä¸¥æ ¼ç•Œæœªå®Œå…¨å»ºç«‹
- Signå‡½æ•°å¼•å…¥çš„å™ªå£°å¦‚ä½•ç²¾ç¡®å½±å“æ”¶æ•›é€Ÿåº¦ï¼Ÿ
- ä¸ºä»€ä¹ˆLionåœ¨å®è·µä¸­è¡¨ç°ä¼˜äºç†è®ºé¢„æµ‹ï¼Ÿ</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>é—®é¢˜</strong>ï¼šéå‡¸æƒ…å†µä¸‹Lionçš„æ”¶æ•›ç‡ç²¾ç¡®ç•Œæ˜¯ä»€ä¹ˆï¼Ÿ
   - <strong>å·²çŸ¥</strong>ï¼šSGD/Adamçš„éå‡¸æ”¶æ•›ç‡ä¸º$\mathcal{O}(1/\sqrt{T})$
   - <strong>æœªçŸ¥</strong>ï¼šLionçš„signå™ªå£°æ˜¯å¦æ”¹å˜æ”¶æ•›ç‡çš„å¸¸æ•°æˆ–é˜¶æ•°ï¼Ÿ
   - <strong>æ½œåœ¨æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>å°†signå™ªå£°å»ºæ¨¡ä¸ºæœ‰ç•Œéšæœºå˜é‡</li>
<li>åˆ©ç”¨Martingale theoryåˆ†ææœŸæœ›æ”¶æ•›</li>
<li>æ¨å¯¼é«˜æ¦‚ç‡ç•Œï¼ˆconcentration boundsï¼‰</li>
<li><strong>æ½œåœ¨æ„ä¹‰</strong>ï¼šä¸ºLionçš„ç†è®ºåœ°ä½æä¾›ä¸¥æ ¼ä¿è¯</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šåŒåŠ¨é‡æœºåˆ¶ï¼ˆ$\beta_1 \neq \beta_2$ï¼‰çš„æ•°å­¦ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ
   - <strong>è§‚å¯Ÿ</strong>ï¼šåŸè®ºæ–‡è®¾$\beta_1=0.9, \beta_2=0.99$ï¼Œä¸ºä½•ä¸åŒï¼Ÿ
   - <strong>çŒœæƒ³</strong>ï¼š</p>
<ul>
<li>$\beta_1$æ§åˆ¶æ›´æ–°æ–¹å‘çš„è®°å¿†é•¿åº¦</li>
<li>$\beta_2$æ§åˆ¶åŠ¨é‡æœ¬èº«çš„ç¨³å®šæ€§</li>
<li>ä¸¤è€…è§£è€¦æä¾›æ›´çµæ´»çš„ä¼˜åŒ–è½¨è¿¹</li>
<li><strong>æ¢ç´¢æ–¹å‘</strong>ï¼š</li>
<li>å›ºå®š$\beta_1=\beta_2$æ—¶æ€§èƒ½å¦‚ä½•ï¼Ÿ</li>
<li>æ˜¯å¦å­˜åœ¨æœ€ä¼˜çš„$(\beta_1, \beta_2)$å…³ç³»ï¼Ÿ</li>
<li>ä¸åŒä»»åŠ¡çš„æœ€ä¼˜é…ç½®æ˜¯å¦æœ‰è§„å¾‹ï¼Ÿ</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šSignå™ªå£°ä¸å¹³å¦åº¦çš„å®šé‡å…³ç³»ï¼Ÿ
   - <strong>ç°çŠ¶</strong>ï¼šå®éªŒè§‚å¯ŸLionæ‰¾åˆ°æ›´å¹³å¦çš„æå°å€¼
   - <strong>æœªçŸ¥</strong>ï¼šå¦‚ä½•å®šé‡åˆ»ç”»signå™ªå£° â†’ å¹³å¦åº¦çš„æ˜ å°„ï¼Ÿ
   - <strong>æ½œåœ¨æ–¹æ³•</strong>ï¼š</p>
<ul>
<li>æ¨å¯¼Lionéšå¼æœ€å°åŒ–çš„ç­‰æ•ˆç›®æ ‡å‡½æ•°</li>
<li>è¯æ˜å…¶åŒ…å«Hessian traceé¡¹ï¼š$\mathcal{L} + \gamma \cdot \text{tr}(\nabla^2\mathcal{L})$</li>
<li>åˆ†æ$\gamma$ä¸å­¦ä¹ ç‡ã€$\beta$çš„å…³ç³»</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å€Ÿé‰´Stochastic Differential Equations (SDE)ç†è®º
- ä½¿ç”¨Wassersteinè·ç¦»åˆ†æä¼˜åŒ–è½¨è¿¹
- å»ºç«‹Lionä¸Langevin dynamicsçš„è”ç³»</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- æ¨å¯¼éå‡¸æƒ…å†µä¸‹Lionçš„æ”¶æ•›ç‡ï¼š$\mathbb{E}[|\nabla f|] \leq O(1/\sqrt{T}) + O(\eta\sqrt{d})$
- è¯æ˜å¹³å¦åº¦ç•Œï¼š$\lambda_{\max}(\nabla^2 f) \leq C \cdot \text{(sign noise variance)}^{-1}$
- å»ºç«‹$(\beta_1, \beta_2)$çš„æœ€ä¼˜é€‰æ‹©ç†è®º</p>
<hr />
<h4 id="2-"><strong>æ–¹å‘2ï¼šæ•ˆç‡å±‚é¢ - æè‡´åŠ é€Ÿä¸å†…å­˜ä¼˜åŒ–</strong><a class="toc-link" href="#2-" title="Permanent link">&para;</a></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- Lionå·²æ¯”Adamå¿«2-3å€ï¼Œèƒ½å¦è¿›ä¸€æ­¥ä¼˜åŒ–ï¼Ÿ
- åŠ¨é‡å­˜å‚¨èƒ½å¦å‹ç¼©ï¼Ÿ
- åˆ†å¸ƒå¼è®­ç»ƒä¸­signæ“ä½œçš„é€šä¿¡ä¼˜åŠ¿æœªå……åˆ†åˆ©ç”¨</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>é—®é¢˜</strong>ï¼šèƒ½å¦è®¾è®¡é›¶åŠ¨é‡ï¼ˆzero-momentumï¼‰çš„Lionå˜ä½“ï¼Ÿ
   - <strong>åŠ¨æœº</strong>ï¼šAdaFactorç”¨ä½ç§©è¿‘ä¼¼å‹ç¼©Adamçš„$\boldsymbol{v}_t$ï¼Œèƒ½å¦å¯¹Lionçš„$\boldsymbol{m}_t$åšç±»ä¼¼å¤„ç†ï¼Ÿ
   - <strong>æŒ‘æˆ˜</strong>ï¼šLionçš„åŠ¨é‡åœ¨signä¹‹å‰ï¼Œå‹ç¼©åsignè¾“å…¥å˜åŒ–å¯èƒ½å½±å“æ•ˆæœ
   - <strong>æ½œåœ¨æ–¹æ³•</strong>ï¼š</p>
<ul>
<li><strong>å±‚çº§åŠ¨é‡</strong>ï¼šæ¯å±‚å…±äº«ä¸€ä¸ªæ ‡é‡åŠ¨é‡ $m_l$</li>
<li><strong>ä½é¢‘æ›´æ–°</strong>ï¼šæ¯$k$æ­¥æ‰æ›´æ–°åŠ¨é‡</li>
<li><strong>å“ˆå¸ŒæŠ€å·§</strong>ï¼šç”¨Bloom filterå‹ç¼©åŠ¨é‡å­˜å‚¨</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼šå†…å­˜ä»$2d$é™è‡³$1.1d$ï¼Œæ€§èƒ½æŸå¤±&lt;1%</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šå¦‚ä½•åœ¨åˆ†å¸ƒå¼è®­ç»ƒä¸­åˆ©ç”¨signçš„é€šä¿¡ä¼˜åŠ¿ï¼Ÿ
   - <strong>è§‚å¯Ÿ</strong>ï¼šAll-reduceæ¢¯åº¦æ—¶ï¼ŒLionåªéœ€ä¼ è¾“signï¼ˆ1-bitï¼‰ï¼Œè€ŒAdaméœ€ä¼ è¾“FP32ï¼ˆ32-bitï¼‰
   - <strong>ç°çŠ¶</strong>ï¼šå½“å‰å®ç°æœªå……åˆ†åˆ©ç”¨è¿™ä¸€ç‚¹
   - <strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
<ul>
<li><strong>1-bit All-reduce</strong>ï¼šç›´æ¥ä¼ è¾“signï¼ŒèŠ‚çœå¸¦å®½31å€</li>
<li><strong>é”™è¯¯è¡¥å¿</strong>ï¼šç±»ä¼¼QSGDï¼Œç”¨error feedbackè¡¥å¿é‡åŒ–è¯¯å·®</li>
<li><strong>å±‚çº§é€šä¿¡</strong>ï¼šGPUå†…FP32ï¼ŒGPUé—´1-bit</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼šåˆ†å¸ƒå¼è®­ç»ƒé€šä¿¡é‡é™ä½90%ï¼Œæ€»ä½“åŠ é€Ÿ5-10å€</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šèƒ½å¦ç”¨ä¸“ç”¨ç¡¬ä»¶åŠ é€Ÿsignè®¡ç®—ï¼Ÿ
   - <strong>ç°çŠ¶</strong>ï¼šSignæ˜¯é€å…ƒç´ æ“ä½œï¼ŒGPUåˆ©ç”¨ç‡å¯èƒ½ä¸é«˜
   - <strong>æ¢ç´¢æ–¹å‘</strong>ï¼š</p>
<ul>
<li>FPGAå®ç°é«˜æ•ˆsign</li>
<li>ç¥ç»ç½‘ç»œåŠ é€Ÿå™¨ï¼ˆå¦‚TPUï¼‰çš„signä¼˜åŒ–</li>
<li>é‡å­è®¡ç®—ä¸­çš„signæ“ä½œï¼ˆç†è®ºæ¢ç´¢ï¼‰</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- ç ”ç©¶å‹ç¼©æ„ŸçŸ¥ï¼ˆCompressed Sensingï¼‰ç†è®ºåº”ç”¨äºåŠ¨é‡å‹ç¼©
- æ¢ç´¢åˆ†å¸ƒå¼ä¼˜åŒ–çš„æ–°å‹All-reduceç®—æ³•
- å¼€å‘Lionä¸“ç”¨çš„ç¡¬ä»¶åŠ é€Ÿå™¨</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- å†…å­˜å ç”¨é™è‡³AdamWçš„30%ï¼ˆå½“å‰50%ï¼‰
- åˆ†å¸ƒå¼è®­ç»ƒé€šä¿¡é‡é™ä½90%
- ç«¯åˆ°ç«¯è®­ç»ƒæ—¶é—´å‡å°‘50%</p>
<hr />
<h4 id="3-lion_1"><strong>æ–¹å‘3ï¼šåº”ç”¨å±‚é¢ - ç‰¹å®šé¢†åŸŸçš„Lionå˜ä½“</strong><a class="toc-link" href="#3-lion_1" title="Permanent link">&para;</a></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- Lionåœ¨CVã€NLPè¡¨ç°å¥½ï¼Œä½†åœ¨å…¶ä»–é¢†åŸŸï¼ˆRLã€GNNç­‰ï¼‰æœªå……åˆ†éªŒè¯
- ä¸åŒæ¨¡æ€ï¼ˆå›¾åƒã€æ–‡æœ¬ã€è¯­éŸ³ï¼‰æ˜¯å¦éœ€è¦ä¸åŒçš„Lioné…ç½®ï¼Ÿ
- å°æ¨¡å‹ï¼ˆ&lt;100Må‚æ•°ï¼‰ä¸ŠLionçš„ä¼˜åŠ¿ä¸æ˜æ˜¾</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>é—®é¢˜</strong>ï¼šå¼ºåŒ–å­¦ä¹ ä¸­çš„Lioné…ç½®ï¼Ÿ
   - <strong>æŒ‘æˆ˜</strong>ï¼šRLæ¢¯åº¦æ–¹å·®æå¤§ï¼Œsignå¯èƒ½åŠ å‰§ä¸ç¨³å®š
   - <strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
<ul>
<li><strong>Clipped-Lion</strong>ï¼šå¯¹signè¾“å…¥å…ˆclipï¼š$\text{sign}(\text{clip}(\boldsymbol{m}_t, -\tau, \tau))$</li>
<li><strong>Value-specific Lion</strong>ï¼šActorç”¨Lionï¼ˆéœ€æ³›åŒ–ï¼‰ï¼ŒCriticç”¨Adamï¼ˆéœ€ç²¾ç¡®æ‹Ÿåˆï¼‰</li>
<li><strong>Entropy-regularized Lion</strong>ï¼šåœ¨signä¸­åŠ å…¥ç†µé¡¹é¼“åŠ±æ¢ç´¢</li>
<li><strong>å®éªŒåœºæ™¯</strong>ï¼šAtariæ¸¸æˆã€MuJoCoè¿ç»­æ§åˆ¶</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šå›¾ç¥ç»ç½‘ç»œï¼ˆGNNï¼‰ä¸Šçš„Lionï¼Ÿ
   - <strong>ç‰¹ç‚¹</strong>ï¼šGNNçš„æ¢¯åº¦åˆ†å¸ƒä¸CNN/Transformerä¸åŒï¼ˆæ¶ˆæ¯ä¼ é€’æœºåˆ¶ï¼‰
   - <strong>æ¢ç´¢æ–¹å‘</strong>ï¼š</p>
<ul>
<li><strong>é‚»å±…æ„ŸçŸ¥Lion</strong>ï¼šæ ¹æ®èŠ‚ç‚¹åº¦æ•°è°ƒæ•´signé˜ˆå€¼</li>
<li><strong>å›¾æ­£åˆ™åŒ–Lion</strong>ï¼šåŠ å…¥æ‹‰æ™®æ‹‰æ–¯æ­£åˆ™é¡¹</li>
<li><strong>ç›®æ ‡ä»»åŠ¡</strong>ï¼šèŠ‚ç‚¹åˆ†ç±»ã€å›¾åˆ†ç±»ã€é“¾æ¥é¢„æµ‹</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šå¤šæ¨¡æ€æ¨¡å‹çš„Lioné…ç½®ï¼Ÿ
   - <strong>åœºæ™¯</strong>ï¼šCLIPã€Flamingoç­‰å›¾æ–‡æ¨¡å‹
   - <strong>æŒ‘æˆ˜</strong>ï¼šä¸åŒæ¨¡æ€çš„æ¢¯åº¦å°ºåº¦å·®å¼‚å¤§
   - <strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
<ul>
<li><strong>æ¨¡æ€ç‰¹å®š$\beta$</strong>ï¼šå›¾åƒencoderç”¨$\beta_1=0.9$ï¼Œæ–‡æœ¬ç”¨$\beta_1=0.95$</li>
<li><strong>è·¨æ¨¡æ€å¯¹é½Lion</strong>ï¼šåœ¨signå‰å¯¹ä¸åŒæ¨¡æ€çš„æ¢¯åº¦åšå½’ä¸€åŒ–</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼šåœ¨COCO captioningä¸Šè¶…è¶ŠAdamW 2+ CIDEråˆ†</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å»ºç«‹ä»»åŠ¡-é…ç½®çš„æ˜ å°„è§„åˆ™ï¼ˆmeta-learningè¶…å‚æ•°ï¼‰
- å¼€å‘è‡ªåŠ¨è°ƒå‚å·¥å…·ï¼ˆAutoLionï¼‰
- åœ¨æ›´å¤šé¢†åŸŸéªŒè¯Lionï¼ˆåŒ»ç–—å½±åƒã€ç”Ÿç‰©ä¿¡æ¯å­¦ç­‰ï¼‰</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- RLï¼šPPO+Lionåœ¨Atariä¸Šå¹³å‡å¥–åŠ±è¶…è¶ŠPPO+Adam 15%
- GNNï¼šèŠ‚ç‚¹åˆ†ç±»å‡†ç¡®ç‡æå‡2%
- å¤šæ¨¡æ€ï¼šé›¶æ ·æœ¬å›¾åƒæ£€ç´¢Recall@1æå‡3%</p>
<hr />
<h4 id="4-"><strong>æ–¹å‘4ï¼šé²æ£’æ€§å±‚é¢ - å¯¹æŠ—è®­ç»ƒä¸å™ªå£°é²æ£’æ€§</strong><a class="toc-link" href="#4-" title="Permanent link">&para;</a></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- Lionå¯¹å¯¹æŠ—æ ·æœ¬çš„é²æ£’æ€§æœªçŸ¥
- Label noiseã€data corruptionä¸‹çš„è¡¨ç°ï¼Ÿ
- æ˜¯å¦èƒ½ç”¨Lionæ”¹è¿›å¯¹æŠ—è®­ç»ƒï¼Ÿ</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>é—®é¢˜</strong>ï¼šLionè®­ç»ƒçš„æ¨¡å‹å¯¹å¯¹æŠ—æ”»å‡»æ›´é²æ£’å—ï¼Ÿ
   - <strong>å‡è®¾</strong>ï¼šå¹³å¦æå°å€¼ â†’ å¯¹æ‰°åŠ¨é²æ£’ â†’ å¯¹æŠ—æ ·æœ¬ä¹Ÿé²æ£’
   - <strong>å®éªŒè®¾è®¡</strong>ï¼š</p>
<ul>
<li>ç”¨Lionå’ŒAdamåˆ†åˆ«è®­ç»ƒResNet-50</li>
<li>æµ‹è¯•å¯¹PGDã€C&amp;Wæ”»å‡»çš„é²æ£’æ€§</li>
<li>æ¯”è¾ƒclean accuracy vs robust accuracyçš„trade-off</li>
<li><strong>é¢„æœŸç»“æœ</strong>ï¼šLionçš„robust accuracyæ›´é«˜ï¼Ÿ</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šLionèƒ½å¦åŠ é€Ÿå¯¹æŠ—è®­ç»ƒï¼Ÿ
   - <strong>ç°çŠ¶</strong>ï¼šå¯¹æŠ—è®­ç»ƒï¼ˆå¦‚PGD-ATï¼‰éœ€è¦æ•°å€è®¡ç®—æˆæœ¬
   - <strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š</p>
<ul>
<li><strong>Fast-AT + Lion</strong>ï¼šç»“åˆFGSMå’ŒLion</li>
<li><strong>Sign-AT</strong>ï¼šç›´æ¥å¯¹signåçš„æ¢¯åº¦åšå¯¹æŠ—æ‰°åŠ¨</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼šå¯¹æŠ—è®­ç»ƒæ—¶é—´å‡å°‘30%ï¼Œé²æ£’æ€§ä¸é™ä½</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šå™ªå£°æ ‡ç­¾ä¸‹Lionçš„ä¼˜åŠ¿ï¼Ÿ
   - <strong>åœºæ™¯</strong>ï¼šè®­ç»ƒæ•°æ®æœ‰10%-40%é”™è¯¯æ ‡ç­¾
   - <strong>çŒœæƒ³</strong>ï¼šSignå‡½æ•°çš„é²æ£’æ€§ â†’ å¯¹å™ªå£°æ ‡ç­¾ä¸æ•æ„Ÿ
   - <strong>å®éªŒ</strong>ï¼šCIFAR-10Nï¼ˆå™ªå£°CIFAR-10ï¼‰
   - <strong>è¯„ä¼°æŒ‡æ ‡</strong>ï¼šClean test accuracy vs noisy train accuracy</p>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- ç»“åˆcertified defenseç†è®º
- å¼€å‘Lion-ATï¼ˆLion for Adversarial Trainingï¼‰
- ç ”ç©¶Lionä¸curriculum learningçš„ç»“åˆ</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- å¯¹æŠ—é²æ£’æ€§ï¼šåœ¨PGD-20æ”»å‡»ä¸‹å‡†ç¡®ç‡æ¯”Adamé«˜5%
- å¯¹æŠ—è®­ç»ƒåŠ é€Ÿï¼šæ—¶é—´å‡å°‘30%
- å™ªå£°é²æ£’æ€§ï¼š40%æ ‡ç­¾å™ªå£°ä¸‹å‡†ç¡®ç‡æ¯”Adamé«˜3%</p>
<hr />
<h4 id="5_1"><strong>æ–¹å‘5ï¼šè‡ªåŠ¨åŒ–ä¸å¯è§£é‡Šæ€§</strong><a class="toc-link" href="#5_1" title="Permanent link">&para;</a></h4>
<p><strong>ç ”ç©¶ç©ºç™½</strong>ï¼š
- Lionçš„è¶…å‚æ•°ï¼ˆ$\eta, \lambda, \beta_1, \beta_2$ï¼‰éœ€è¦æ‰‹åŠ¨è°ƒï¼Œèƒ½å¦è‡ªåŠ¨åŒ–ï¼Ÿ
- Signå‡½æ•°çš„ä½œç”¨æœºåˆ¶èƒ½å¦å¯è§†åŒ–è§£é‡Šï¼Ÿ
- èƒ½å¦é¢„æµ‹æŸä»»åŠ¡æ˜¯å¦é€‚åˆLionï¼Ÿ</p>
<p><strong>å…·ä½“ç ”ç©¶é—®é¢˜</strong>ï¼š</p>
<ol>
<li>
<p><strong>é—®é¢˜</strong>ï¼šè‡ªåŠ¨è¶…å‚æ•°è°ƒä¼˜ï¼ˆAutoLionï¼‰ï¼Ÿ
   - <strong>ç›®æ ‡</strong>ï¼šç»™å®šä»»åŠ¡ï¼Œè‡ªåŠ¨æ‰¾åˆ°æœ€ä¼˜$(\eta, \lambda, \beta_1, \beta_2)$
   - <strong>æ–¹æ³•</strong>ï¼š</p>
<ul>
<li><strong>Bayesian Optimization</strong>ï¼šé«˜æ–¯è¿‡ç¨‹å»ºæ¨¡è¶…å‚æ•°-æ€§èƒ½å…³ç³»</li>
<li><strong>Population-Based Training</strong>ï¼šå¹¶è¡Œè®­ç»ƒå¤šç»„è¶…å‚æ•°ï¼ŒåŠ¨æ€è°ƒæ•´</li>
<li><strong>Meta-learning</strong>ï¼šä»å†å²ä»»åŠ¡ä¸­å­¦ä¹ è¶…å‚æ•°åˆå§‹åŒ–</li>
<li><strong>é‡åŒ–ç›®æ ‡</strong>ï¼šè¶…å‚æœç´¢æ¬¡æ•°ä»50æ¬¡é™è‡³5æ¬¡</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šLionçš„å¯è§£é‡Šæ€§ï¼Ÿ
   - <strong>å½“å‰é—®é¢˜</strong>ï¼šä¸ºä»€ä¹ˆLionæœ‰æ•ˆï¼Ÿä»ç¼ºä¹ç›´è§‚è§£é‡Š
   - <strong>å¯è§†åŒ–æ–¹å‘</strong>ï¼š</p>
<ul>
<li><strong>Loss landscape</strong>ï¼šç»˜åˆ¶Lion vs Adamçš„ä¼˜åŒ–è½¨è¿¹</li>
<li><strong>Sign pattern</strong>ï¼šå¯è§†åŒ–å“ªäº›å‚æ•°çš„signæœ€é¢‘ç¹å˜åŒ–</li>
<li><strong>Gradient flow</strong>ï¼šåˆ†ææ¢¯åº¦åœ¨ç½‘ç»œä¸­çš„ä¼ æ’­</li>
<li><strong>å·¥å…·å¼€å‘</strong>ï¼šLion-Vizï¼ˆå¯è§†åŒ–å·¥å…·åŒ…ï¼‰</li>
</ul>
</li>
<li>
<p><strong>é—®é¢˜</strong>ï¼šä»»åŠ¡é€‚é…æ€§é¢„æµ‹ï¼Ÿ
   - <strong>ç›®æ ‡</strong>ï¼šä¸å®é™…è®­ç»ƒï¼Œé¢„æµ‹Lionæ˜¯å¦ä¼˜äºAdam
   - <strong>ç‰¹å¾</strong>ï¼š</p>
<ul>
<li>æ•°æ®é›†å¤§å°ã€ç»´åº¦</li>
<li>æ¨¡å‹æ¶æ„ï¼ˆCNNã€Transformerç­‰ï¼‰</li>
<li>æ¢¯åº¦ç»Ÿè®¡é‡ï¼ˆæ–¹å·®ã€å³°åº¦ç­‰ï¼‰</li>
<li><strong>æ–¹æ³•</strong>ï¼šè®­ç»ƒåˆ†ç±»å™¨ï¼š(ä»»åŠ¡ç‰¹å¾) â†’ {Lionæ›´å¥½ | Adamæ›´å¥½}</li>
<li><strong>æ„ä¹‰</strong>ï¼šèŠ‚çœè°ƒå‚æ—¶é—´</li>
</ul>
</li>
</ol>
<p><strong>ä¼˜åŒ–æ–¹å‘</strong>ï¼š
- å¼€å‘Lionçš„AutoMLå·¥å…·
- å»ºç«‹Lionçš„ç†è®ºå¯è§£é‡Šæ€§æ¡†æ¶
- åˆ›å»ºLioné€‚ç”¨æ€§çš„å†³ç­–æ ‘</p>
<p><strong>é‡åŒ–ç›®æ ‡</strong>ï¼š
- AutoLionæ‰¾åˆ°çš„è¶…å‚æ•°ä¸äººå·¥è°ƒä¼˜çš„æ€§èƒ½å·®è·&lt;1%
- å¯è§†åŒ–å·¥å…·è¦†ç›–5ç§è§£é‡Šç»´åº¦ï¼ˆloss landscapeã€sign patternç­‰ï¼‰
- ä»»åŠ¡é€‚é…æ€§é¢„æµ‹å‡†ç¡®ç‡&gt;85%</p>
<hr />
<h4 id="_7"><strong>æ½œåœ¨åº”ç”¨åœºæ™¯</strong><a class="toc-link" href="#_7" title="Permanent link">&para;</a></h4>
<p><strong>è¯­è¨€æ¨¡å‹</strong>ï¼š
- GPT-4çº§åˆ«å¤§æ¨¡å‹é¢„è®­ç»ƒï¼ˆèŠ‚çœå†…å­˜ï¼Œæ”¯æŒæ›´å¤§æ¨¡å‹ï¼‰
- å¤šè¯­è¨€æ¨¡å‹ï¼ˆLionçš„é²æ£’æ€§é€‚åˆä¸åŒè¯­è¨€çš„æ¢¯åº¦åˆ†å¸ƒå·®å¼‚ï¼‰
- ä»£ç ç”Ÿæˆï¼ˆCodeLlamaã€Codexç­‰ï¼‰</p>
<p><strong>è®¡ç®—æœºè§†è§‰</strong>ï¼š
- æ‰©æ•£æ¨¡å‹è®­ç»ƒï¼ˆStable Diffusionã€DALL-E 3ï¼‰
- è§†é¢‘ç†è§£ï¼ˆVideoMAEã€TimeSformerï¼‰
- 3Dè§†è§‰ï¼ˆNeRFã€3Dç”Ÿæˆï¼‰</p>
<p><strong>å¤šæ¨¡æ€</strong>ï¼š
- CLIP-likeæ¨¡å‹ï¼ˆå›¾æ–‡å¯¹é½ï¼‰
- Flamingoï¼ˆå°‘æ ·æœ¬å¤šæ¨¡æ€å­¦ä¹ ï¼‰
- GPT-4Vï¼ˆè§†è§‰è¯­è¨€æ¨¡å‹ï¼‰</p>
<p><strong>ç§‘å­¦è®¡ç®—</strong>ï¼š
- åˆ†å­åŠ¨åŠ›å­¦ï¼ˆAlphaFoldç±»æ¨¡å‹ï¼‰
- æ°”å€™æ¨¡æ‹Ÿï¼ˆFoundation Models for Weatherï¼‰
- é«˜èƒ½ç‰©ç†ï¼ˆç²’å­ç¢°æ’åˆ†æï¼‰</p>
<p><strong>è¾¹ç¼˜AI</strong>ï¼š
- ç§»åŠ¨ç«¯æ¨¡å‹è®­ç»ƒï¼ˆå†…å­˜å—é™åœºæ™¯ï¼‰
- IoTè®¾å¤‡ä¸Šçš„åœ¨çº¿å­¦ä¹ 
- è”é‚¦å­¦ä¹ ï¼ˆé€šä¿¡å—é™ï¼Œsignå‹ç¼©å¤©ç„¶é€‚åˆï¼‰</p>
<hr />
<h2 id="_8">æ€»ç»“<a class="toc-link" href="#_8" title="Permanent link">&para;</a></h2>
<p>æœ¬æ–‡æ·±å…¥åˆ†æäº†Lionä¼˜åŒ–å™¨çš„æ•°å­¦åŸç†ï¼š</p>
<ol>
<li><strong>æ ¸å¿ƒåˆ›æ–°</strong>ï¼šSignå‡½æ•° + åŒåŠ¨é‡æœºåˆ¶</li>
<li><strong>ç†è®ºä¿è¯</strong>ï¼šä¸Adamç›¸åŒçš„$\mathcal{O}(1/\sqrt{T})$æ”¶æ•›ç‡</li>
<li><strong>å®è·µä¼˜åŠ¿</strong>ï¼šæ›´å¿«ã€æ›´çœå†…å­˜ã€æ›´å¥½æ³›åŒ–</li>
<li><strong>é€‚ç”¨åœºæ™¯</strong>ï¼šå¤§æ¨¡å‹é¢„è®­ç»ƒã€è§†è§‰ä»»åŠ¡</li>
<li><strong>è¶…å‚è°ƒä¼˜</strong>ï¼šå­¦ä¹ ç‡â†“ï¼Œæƒé‡è¡°å‡â†‘</li>
</ol>
<p>Lionä»£è¡¨äº†ä¼˜åŒ–å™¨è®¾è®¡çš„æ–°èŒƒå¼ï¼šç®€å•ã€é«˜æ•ˆã€é²æ£’ã€‚</p>
                </div>

                <!-- Previous/Next Navigation -->
                <nav class="post-navigation" aria-label="æ–‡ç« å¯¼èˆª">
                    <div class="row g-3">
                        <div class="col-6">
                            
                            <a href="ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆåå…­wè·ç¦»-å¾—åˆ†åŒ¹é….html" class="nav-link-prev">
                                <div class="nav-direction"><i class="fas fa-chevron-left"></i> ä¸Šä¸€ç¯‡</div>
                                <div class="nav-title">#217 ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåå…­ï¼‰ï¼šWè·ç¦» â‰¤ å¾—åˆ†åŒ¹é…</div>
                            </a>
                            
                        </div>
                        <div class="col-6">
                            
                            <a href="ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆåä¸ƒæ„å»ºodeçš„ä¸€èˆ¬æ­¥éª¤ä¸‹.html" class="nav-link-next">
                                <div class="nav-direction">ä¸‹ä¸€ç¯‡ <i class="fas fa-chevron-right"></i></div>
                                <div class="nav-title">#219 ç”Ÿæˆæ‰©æ•£æ¨¡å‹æ¼«è°ˆï¼ˆåä¸ƒï¼‰ï¼šæ„å»ºODEçš„ä¸€èˆ¬æ­¥éª¤ï¼ˆä¸‹ï¼‰</div>
                            </a>
                            
                        </div>
                    </div>
                </nav>

                <!-- Back to Home -->
                <div class="text-center mt-4 mb-4">
                    <a href="../index.html" class="btn btn-outline-primary">
                        <i class="fas fa-arrow-left"></i> è¿”å›é¦–é¡µ
                    </a>
                </div>
            </div>

            <!-- Sidebar (TOC) -->
            <div class="col-lg-3">
                <aside class="sidebar">
                    
                    <div class="toc-sidebar">
                        <h5 class="toc-title"><i class="fas fa-list"></i> ç›®å½•</h5>
                        <div class="toc-content">
                            <div class="toc">
<ul>
<li><a href="#googlelion">Googleæ–°æœå‡ºçš„ä¼˜åŒ–å™¨Lionï¼šæ•ˆç‡ä¸æ•ˆæœå…¼å¾—çš„â€œè®­ç»ƒç‹®â€</a><ul>
<li><a href="#_1">å…ˆè¯´ç»“æœ</a></li>
<li><a href="#_2">è®ºæ–‡å®éªŒ</a></li>
<li><a href="#_3">è¶…å‚è®¾ç½®</a></li>
<li><a href="#_4">å»¶ä¼¸æ€è€ƒ</a></li>
<li><a href="#_5">æ–‡ç« å°ç»“</a></li>
<li><a href="#_6">å…¬å¼æ¨å¯¼ä¸æ³¨é‡Š</a><ul>
<li><a href="#1">ç¬¬1éƒ¨åˆ†ï¼šæ ¸å¿ƒç†è®ºã€å…¬ç†ä¸å†å²åŸºç¡€</a></li>
<li><a href="#2">ç¬¬2éƒ¨åˆ†ï¼šä¸¥è°¨çš„æ ¸å¿ƒæ•°å­¦æ¨å¯¼</a></li>
<li><a href="#1-lion">1. Lionä¼˜åŒ–å™¨çš„å®Œæ•´æ¨å¯¼</a></li>
<li><a href="#2-sign">2. Signå‡½æ•°çš„æ•°å­¦æ€§è´¨</a></li>
<li><a href="#3-lion">3. Lionçš„æ”¶æ•›æ€§åˆ†æ</a></li>
<li><a href="#4-update-rms">4. Update RMSçš„åˆ†æ</a></li>
<li><a href="#5-sign">5. Signå‡½æ•°çš„å™ªå£°æ•ˆåº”</a></li>
<li><a href="#6">6. ä¸å…¶ä»–ä¼˜åŒ–å™¨çš„ç†è®ºå¯¹æ¯”</a></li>
<li><a href="#7">7. è¶…å‚æ•°æ•æ„Ÿåº¦åˆ†æ</a></li>
<li><a href="#8">8. æ•°å€¼ç¨³å®šæ€§</a></li>
<li><a href="#9">9. å…·ä½“è®¡ç®—ç¤ºä¾‹</a></li>
<li><a href="#10">10. å¹³å¦åº¦ä¸æ³›åŒ–</a></li>
<li><a href="#11_1">11. å®è·µå»ºè®®</a></li>
<li><a href="#12_1">12. å¼€æ”¾é—®é¢˜ä¸æœªæ¥æ–¹å‘</a></li>
<li><a href="#3">ç¬¬3éƒ¨åˆ†ï¼šæ•°å­¦ç›´è§‰ã€å¤šè§’åº¦è§£é‡Šä¸ç±»æ¯”</a></li>
<li><a href="#4">ç¬¬4éƒ¨åˆ†ï¼šæ–¹æ³•è®ºå˜ä½“ã€æ‰¹åˆ¤æ€§æ¯”è¾ƒä¸ä¼˜åŒ–</a></li>
<li><a href="#5">ç¬¬5éƒ¨åˆ†ï¼šå­¦ä¹ è·¯çº¿å›¾ä¸æœªæ¥å±•æœ›</a></li>
</ul>
</li>
<li><a href="#_8">æ€»ç»“</a></li>
</ul>
</li>
</ul>
</div>

                        </div>
                        <div class="toc-actions">
                            <button class="btn btn-sm btn-outline-secondary" onclick="expandAll()">
                                <i class="fas fa-expand"></i> å…¨éƒ¨å±•å¼€
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="collapseAll()">
                                <i class="fas fa-compress"></i> å…¨éƒ¨æŠ˜å 
                            </button>
                        </div>
                    </div>
                    

                    <!-- Back to Top Button -->
                    <button id="backToTop" class="back-to-top" title="å›åˆ°é¡¶éƒ¨">
                        <i class="fas fa-arrow-up"></i>
                    </button>
                </aside>
            </div>
        </div>
    </article>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>
                åšå®¢æ¥æº: <a href="https://spaces.ac.cn" target="_blank">ç§‘å­¦ç©ºé—´</a> |
                å†…å®¹ç»è¿‡æ•´ç†å¹¶æ·»åŠ è¯¦ç»†æ•°å­¦æ¨å¯¼
            </p>
            <p>
                Powered by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Syntax highlighting -->
    <script>hljs.highlightAll();</script>

    <!-- Back to top functionality -->
    <script>
        // Show/hide back to top button based on scroll position
        window.addEventListener('scroll', function() {
            const backToTop = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTop.classList.add('show');
            } else {
                backToTop.classList.remove('show');
            }
        });

        // Smooth scroll to top
        document.getElementById('backToTop').addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Sticky TOC sidebar
        window.addEventListener('scroll', function() {
            const sidebar = document.querySelector('.sidebar');
            if (!sidebar) return;

            const sidebarTop = sidebar.offsetTop;
            const scrollTop = window.pageYOffset;

            if (scrollTop > sidebarTop - 20) {
                sidebar.classList.add('sticky');
            } else {
                sidebar.classList.remove('sticky');
            }
        });
    </script>
</body>
</html>