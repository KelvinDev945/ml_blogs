<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>圆内随机n点在同一个圆心角为θ的扇形的概率 | ML & Math Blog Posts</title>
    <meta name="description" content="圆内随机n点在同一个圆心角为θ的扇形的概率&para;
原文链接: https://spaces.ac.cn/archives/9324
发布日期: 

这几天网上热传了一道“四鸭共半圆”题目：  

四鸭共半圆问题
可能有不少读者看到后也尝试做过，就连李永乐老师也专门开了一节课讲这道题（参考《圆形水池四只鸭子在同一个半圆里，概率有多大？》）。就这道题目本身而言，答案并不算困难，可以有很多方法算出...">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css">

    <!-- Google Fonts -->
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="../assets/css/main.css">
    <link rel="stylesheet" href="../assets/css/post.css">

    <!-- Custom JS -->
    <script src="../assets/js/collapsible.js" defer></script>

    <!-- MathJax for math rendering with equation numbering -->
    <script>
    MathJax = {
      tex: {
        inlineMath: [['$', '$'], ['\\(', '\\)']],
        displayMath: [['$$', '$$'], ['\\[', '\\]']],
        processEscapes: true,
        processEnvironments: true,
        tags: 'ams',  // Enable equation numbering with AMS style
        tagSide: 'right',  // Place equation numbers on the right
        tagIndent: '0.8em',  // Indentation for equation numbers
        multlineWidth: '85%'
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <!-- Syntax highlighting -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/styles/github.min.css">
    <script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.7.0/build/highlight.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
        <div class="container">
            <a class="navbar-brand" href="../index.html">
                <i class="fas fa-brain"></i> ML & Math Blog
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="../index.html"><i class="fas fa-home"></i> 首页</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Post Content -->
    <article class="container post-container my-5">
        <!-- Breadcrumb Navigation -->
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../index.html"><i class="fas fa-home"></i> 首页</a></li>
                
                <li class="breadcrumb-item"><a href="../index.html?tags=详细推导">详细推导</a></li>
                
                <li class="breadcrumb-item active" aria-current="page">
                    #59 圆内随机n点在同一个圆心角为θ的扇形的概率
                </li>
            </ol>
        </nav>

        <!-- Post Header -->
        <header class="post-header mb-4">
            <h1 class="post-title">
                <span class="post-number">#59</span>
                圆内随机n点在同一个圆心角为θ的扇形的概率
            </h1>
            <div class="post-meta">
                <span><i class="far fa-calendar"></i> 2022-10-25</span>
                
            </div>
            
            <div class="post-tags mt-3">
                
                <a href="../index.html?tags=详细推导" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> 详细推导</span>
                </a>
                
                <a href="../index.html?tags=概率" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> 概率</span>
                </a>
                
                <a href="../index.html?tags=竞赛" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> 竞赛</span>
                </a>
                
                <a href="../index.html?tags=随机" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> 随机</span>
                </a>
                
                <a href="../index.html?tags=生成模型" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> 生成模型</span>
                </a>
                
                <a href="../index.html?tags=attention" class="tag-link">
                    <span class="tag"><i class="fas fa-tag"></i> attention</span>
                </a>
                
            </div>
            
        </header>

        <div class="row">
            <!-- Main Content -->
            <div class="col-lg-9">
                <!-- Post Body -->
                <div class="post-content">
                    <h1 id="n">圆内随机n点在同一个圆心角为θ的扇形的概率<a class="toc-link" href="#n" title="Permanent link">&para;</a></h1>
<p><strong>原文链接</strong>: <a href="https://spaces.ac.cn/archives/9324">https://spaces.ac.cn/archives/9324</a></p>
<p><strong>发布日期</strong>: </p>
<hr />
<p>这几天网上热传了一道“四鸭共半圆”题目：  </p>
<p><a href="/usr/uploads/2022/10/3296253276.png" title="点击查看原图"><img alt="四鸭共半圆问题" src="/usr/uploads/2022/10/3296253276.png" /></a></p>
<p>四鸭共半圆问题</p>
<p>可能有不少读者看到后也尝试做过，就连李永乐老师也专门开了一节课讲这道题（参考<a href="https://www.bilibili.com/read/cv19251490">《圆形水池四只鸭子在同一个半圆里，概率有多大？》</a>）。就这道题目本身而言，答案并不算困难，可以有很多方法算出来。稍微有难度的是它的推广版本，也就是本文标题所描述的，将鸭子的数目一般化为$n$只，将半圆一般化为圆心角为$\theta$的扇形。更有趣的是，当$\theta \leq \pi$时，依然有比较初等的解法，但是当$\theta &gt; \pi$后，复杂度开始“剧增”...</p>
<h2 id="_1">题目转换<a class="toc-link" href="#_1" title="Permanent link">&para;</a></h2>
<p>首先要说明的是，这里我们是将鸭子抽象为圆内均匀分布随机抽取的点来处理的，那些诸如“鸭子的占地面积”等推广这里我们就不考虑了。就“四鸭共半圆”而言，我们很容易去将它一般化，比如推广到高维空间中：</p>
<blockquote>
<p>$d$维超球内均匀分布的$n$个点，它们位于同一个$d$维超半球的概率是多少？</p>
</blockquote>
<p>这个推广的答案其实在1962年发表的论文<a href="https://www.mscand.dk/article/view/10655/8676">《A Problem in Geometric Probability》</a>就给出了。另一个推广就是本文的标题：</p>
<blockquote>
<p>圆内均匀分布的$n$个点，它们位于同一个圆心角为$\theta$的扇形的概率是多少？</p>
</blockquote>
<p>本文主要就是讨论这个问题，它还可以等价地转换成（怎么转换请读者自行思考）：</p>
<blockquote>
<p>圆周上均匀随机地选取$n$个点，将圆周分为$n$段圆弧，最长的圆弧所对的圆心角大于$2\pi - \theta$的概率是多少？</p>
</blockquote>
<p>进一步地，可以等价地转换为</p>
<blockquote>
<p>单位长线段上均匀随机地选取$n-1$个点，将线段分为$n$段，最长的线段长度大于$1 - \frac{\theta}{2\pi}$的概率是多少？</p>
</blockquote>
<h2 id="_2">分布求解<a class="toc-link" href="#_2" title="Permanent link">&para;</a></h2>
<p>其实，最后一个等价表述所涉及的分布，已经被很好地讨论过了，比如知乎上的<a href="https://www.zhihu.com/question/50198685/answer/1509793840">《在 (0, 1) 内随机取点将区间分成 n 段，最长段的长度期望是多少？》</a>。这里为了方便大家理解，笔者重新组织语言介绍一遍，将会分为几个步骤，整个过程有点长，但这是求通解（适用于$\theta &gt; \pi$）必须的。</p>
<p>顺便指出的是，多个随机变量的最值，属于“<a href="https://en.wikipedia.org/wiki/Order_statistic">顺序统计量（Order Statistic）</a>”之一，在机器学习中也颇为常见，比如<a href="/archives/7343#%E7%86%B5%E7%9A%84%E9%87%87%E6%A0%B7%E9%82%BB%E8%BF%91%E4%BC%B0%E8%AE%A1">《EAE：自编码器 + BN + 最大熵 = 生成模型》</a>介绍的熵的最邻近估计、<a href="/archives/9085">《从重参数的角度看离散概率分布的构建》</a>介绍的离散分布的一般构建，都可归结为此类。</p>
<h3 id="_3">联合分布<a class="toc-link" href="#_3" title="Permanent link">&para;</a></h3>
<p>从最后一个等价表述出发，设单位长线段被随机的$n-1$个点分为的$n$段，从左到右的长度依次为$x_1,x_2,\cdots,x_n$（注：只是定了个方向，并没有按大小排列），记它们的联合分布的概率密度函数为$p_n(x_1,x_2,\cdots,x_n)$。知乎链接中的答案是直接基于“$p_n(x_1,x_2,\cdots,x_n)$是均匀分布”这一事实来进行后续求解的，但不知道是不是笔者漏了什么细节，还是哪里没绕过弯，笔者觉得“$p_n(x_1,x_2,\cdots,x_n)$是均匀分布”并不是一件显然成立的事情，所以这里对它进行推导一遍。</p>
<p>首先，留意到两个事实：</p>
<blockquote>
<p>1、$x_1,x_2,\cdots,x_n$带有约束$x_1 + x_2 + \cdots + x_n = 1$，所以它只有$n-1$个自由度，我们取前$n-1$个变量为自由变量；</p>
<p>2、$p_n(x_1,x_2,\cdots,x_n)$是概率密度而非概率，$p_n(x_1,x_2,\cdots,x_n)dx_1 dx_2 \cdots dx_{n-1}$才是概率。</p>
</blockquote>
<p>为了理解“$p_n(x_1,x_2,\cdots,x_n)$是均匀分布”这一事实，我们从$n=2$出发，此时就是在$(0, 1)$中均匀随机取一个点将线段分为两部分，由于取点是均匀分布的（概率密度是1），取点跟$(x_1, x_2)$一一对应，所以也有$p_2(x_1, x_2)=1$。</p>
<p>接着考虑$n=3$，对应的概率是$p_3(x_1, x_2, x_3)dx_1 dx_2$，它有两种可能：</p>
<blockquote>
<p>1、先采样一个点，将线段分为$(x_1, x_2 + x_3)$两段，这部分概率为$p_2(x_1, x_2 + x_3) dx_1$，然后再采样一个点，将$x_2 + x_3$这一段分为$(x_2, x_3)$两段，这部分概率为$dx_2$，所以乘起来是$p_2(x_1, x_2 + x_3) dx_1 dx_2$；</p>
<p>2、先采样一个点，将线段分为$(x_1 + x_2, x_3)$两段，这部分概率为$p_2(x_1 + x_2, x_3) dx_2$，然后再采样一个点，将$x_1 + x_2$这一段分为$(x_1, x_2)$两段，这部分概率为$dx_1$，所以乘起来是$p_2(x_1 + x_2, x_3) dx_1 dx_2$；</p>
</blockquote>
<p>两者加起来是<br />
\begin{equation}p_3(x_1, x_2, x_3)dx_1 dx_2 = p_2(x_1, x_2 + x_3) dx_1 dx_2 + p_2(x_1 + x_2, x_3) dx_1 dx_2 = 2dx_1 dx_2\end{equation}<br />
即$p_3(x_1, x_2, x_3)=2$也是一个均匀分布。类似地递推，可以得到<br />
\begin{equation}p_n(x_1,x_2,\cdots,x_n) = (n - 1) p_{n-1}(x_1,x_2,\cdots,x_{n-1}) = \cdots = (n - 1)!\end{equation}</p>
<h3 id="_4">边缘分布<a class="toc-link" href="#_4" title="Permanent link">&para;</a></h3>
<p>有了联合分布，那么我们就可以求出任选$k$个变量的边缘分布了，这是为下一节使用“容斥原理”作准备的。由于联合分布就是一个均匀分布，所以各个变量是全对称的，因此不失一般性，我们求前$k$个变量的边缘分布即可。</p>
<p>根据定义<br />
\begin{equation}p_n(x_1,x_2,\cdots,x_k) = \int \cdots \int p_n(x_1,x_2,\cdots,x_n) dx_{k+1}\cdots dx_{n-1}\end{equation}<br />
要注意的是积分上下限，下限自然是$0$，因为约束$x_1 + x_2 + \cdots + x_n = 1$的存在，上限对于每个变量都是不一样的，给定$x_1,x_2,\cdots,x_i$后，$x_{i+1}$的取值就只能是$0\sim 1 - (x_1 + x_2 + \cdots + x_i)$，所以准确形式是<br />
\begin{equation}\int_0^{1 - (x_1 + x_2 + \cdots + x_k)} \cdots \left[\int_0^{1 - (x_1 + x_2 + \cdots + x_{n-2})} p_n(x_1,x_2,\cdots,x_n) dx_{n-1}\right] \cdots dx_{k+1}\end{equation}<br />
由于$p_n(x_1,x_2,\cdots,x_n)=(n-1)!$只是一个常数，所以上式是可以逐次积分出来的，最终结果是<br />
\begin{equation}p_n(x_1,x_2,\cdots,x_k) = \frac{(n-1)!}{(n - k - 1)!}[1 - (x_1 + x_2 + \cdots + x_k)]^{n-k-1}\end{equation}<br />
这时候我们就可以求出$x_1,x_2,\cdots,x_k$分别大于给定阈值$c_1, c_2, \cdots, c_k$（成立$c_1 + c_2 + \cdots + c_k \leq 1$）的概率：<br />
\begin{equation}\begin{aligned}
&amp;\, \qquad P_n(x_1 &gt; c_1,x_2 &gt; c_2,\cdots,x_k &gt; c_k) = \int_{c_1}^{1 - (c_2 + c_2 + \cdots + c_k)} \cdots
\\
&amp;\, \left[\int_{c_{k-1}}^{1 - (x_1 + x_2 + \cdots + x_{k-2} + c_k)}\left[\int_{c_k}^{1 - (x_1 + x_2 + \cdots + x_{k-1})} p_n(x_1,x_2,\cdots,x_k) dx_k\right]dx_{k-1}\right] \cdots dx_1
\end{aligned}\end{equation}<br />
积分上限跟前面类似，都是在约束$x_1 + x_2 + \cdots + x_n = 1$下进行推导的。跟$p_n(x_1,x_2,\cdots,x_n)$一样，上式也是可以逐次积分出来的，最终结果反而很简单<br />
\begin{equation}P_n(x_1 &gt; c_1,x_2 &gt; c_2,\cdots,x_k &gt; c_k) = [1 - (c_1 + c_2 + \cdots + c_k)]^{n-1}\end{equation}</p>
<h3 id="_5">容斥原理<a class="toc-link" href="#_5" title="Permanent link">&para;</a></h3>
<p>现在一切准备就绪，轮到“容斥原理”来完成“最后一击”了。别忘了我们的目标是求出最长段长度的概率，即对于某个阈值$x$，计算出$P_n(\max(x_1,x_2,\cdots,x_n) &gt; x)$，而$\max(x_1,x_2,\cdots,x_n) &gt; x$这件事本身是多个事件的并集：<br />
\begin{equation}\max(x_1,x_2,\cdots,x_n) &gt; x \quad\Leftrightarrow\quad x_1 &gt; x \,\color{red}{\text{或}}\, x_2 &gt; x \,\color{red}{\text{或}}\, \cdots \,\color{red}{\text{或}}\, x_n &gt; x \end{equation}<br />
关键是，当$x &lt; \frac{1}{2}$时，各个事件之间并非不相交的，所以不能直接将每一部分的概率简单相加，而需要用到“<a href="https://en.wikipedia.org/wiki/Inclusion%E2%80%93exclusion_principle">容斥原理</a>”：<br />
\begin{equation}\begin{aligned}
\text{存在一点大于}x\text{的概率} = &amp;\,\text{任一点大于}x\text{的概率之和} \\
&amp;\,\quad \color{red}{-} \text{任两点都大于}x\text{的概率之和} \\
&amp;\, \quad\quad \color{red}{+} \text{任三点都大于}x\text{的概率之和} \\
&amp;\, \quad\quad\quad \color{red}{-} \text{任四点都大于}x\text{的概率之和} \\
&amp;\, \quad\quad\quad\quad \color{red}{+} \cdots
\end{aligned}\end{equation}<br />
根据上一节的结果，任选$k$点，每一点都大于$x$的概率为$(1-kx)^{n-1}$，而任选$k$点的组合数为$C_n^k$，所以代入上式得<br />
\begin{equation}\begin{aligned}
P_n(\max(x_1,x_2,\cdots,x_n) &gt; x) =&amp;\, \sum_{k=1, 1 - kx &gt; 0}^n (-1)^{k-1} C_n^k (1-kx)^{n-1} \\
=&amp;\, C_n^1 (1 - x)^{n-1} - C_n^2 (1 - 2x)^{n-1} + \cdots
\end{aligned}\end{equation}</p>
<h2 id="_6">答案分析<a class="toc-link" href="#_6" title="Permanent link">&para;</a></h2>
<p>对于本文开始的题目来说，即$x = 1 - \frac{\theta}{2\pi}$，当$x &gt; \frac{1}{2}$（即$\theta &lt; \pi$）时，后面的$1 - k x$都小于0了，即实际上不存在，因此答案是最简单的：<br />
\begin{equation}C_n^1 (1 - x)^{n-1} = n \left(\frac{\theta}{2\pi}\right)^{n-1}\end{equation}<br />
当$x &lt; \frac{1}{2}$时，看$x$的具体大小来增减项，$x$越小，项数相对来说越多，这就是李永乐老师文章说的“当$\theta$大于180度时，情况将变得非常复杂”了。</p>
<p>我们也可以求它的期望，这知乎上的提问所讨论的问题。还有一个有意思的情况，显然当$x &lt; \frac{1}{n}$时，恒有$1 - kx &gt; 0$，即所有项都需要用上了：<br />
\begin{equation}P_n(\max(x_1,x_2,\cdots,x_n) &gt; x) = \sum_{k=1}^n (-1)^{k-1} C_n^k (1-kx)^{n-1}\end{equation}<br />
然而根据“抽屉原理”我们可以得知，将单位长线段分为$n$段后，最长的一段的长度必然是不小于$\frac{1}{n}$的，这意味着$P_n(\max(x_1,x_2,\cdots,x_n) &gt; \frac{1}{n}) = 1$，因此当$x &lt; \frac{1}{n}$时，必然成立<br />
\begin{equation}\sum_{k=1}^n (-1)^{k-1} C_n^k (1-kx)^{n-1} = 1\end{equation}<br />
又因为左端仅仅是简单的代数多项式，因此它必然是解析的，所以上式对于所有的$x$都恒成立。感兴趣的读者，不妨试试直接从代数角度证明它。</p>
<h2 id="_7">文章小结<a class="toc-link" href="#_7" title="Permanent link">&para;</a></h2>
<p>本文讨论了“四鸭共半圆”的推广问题的一般解法，其中主要思想是容斥原理。</p>
<p><em><strong>转载到请包括本文地址：</strong><a href="https://spaces.ac.cn/archives/9324">https://spaces.ac.cn/archives/9324</a></em></p>
<p><em><strong>更详细的转载事宜请参考：</strong></em><a href="https://spaces.ac.cn/archives/6508#%E6%96%87%E7%AB%A0%E5%A6%82%E4%BD%95%E8%BD%AC%E8%BD%BD/%E5%BC%95%E7%94%A8" title="《科学空间FAQ》">《科学空间FAQ》</a></p>
<p><strong>如果您还有什么疑惑或建议，欢迎在下方评论区继续讨论。</strong></p>
<p><strong>如果您觉得本文还不错，欢迎分享/打赏本文。打赏并非要从中获得收益，而是希望知道科学空间获得了多少读者的真心关注。当然，如果你无视它，也不会影响你的阅读。再次表示欢迎和感谢！</strong></p>
<p>打赏</p>
<p><img alt="科学空间" src="https://spaces.ac.cn/usr/themes/geekg/payment/wx.png" /></p>
<p>微信打赏</p>
<p><img alt="科学空间" src="https://spaces.ac.cn/usr/themes/geekg/payment/zfb.png" /></p>
<p>支付宝打赏</p>
<p>因为网站后台对打赏并无记录，因此欢迎在打赏时候备注留言。你还可以<a href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&amp;email=tN7d1drY3drrx8H0xcWa19vZ"><strong>点击这里</strong></a>或在下方评论区留言来告知你的建议或需求。</p>
<p><strong>如果您需要引用本文，请参考：</strong></p>
<p>苏剑林. (Oct. 25, 2022). 《圆内随机n点在同一个圆心角为θ的扇形的概率 》[Blog post]. Retrieved from <a href="https://spaces.ac.cn/archives/9324">https://spaces.ac.cn/archives/9324</a></p>
<p>@online{kexuefm-9324,<br />
title={圆内随机n点在同一个圆心角为θ的扇形的概率},<br />
author={苏剑林},<br />
year={2022},<br />
month={Oct},<br />
url={\url{https://spaces.ac.cn/archives/9324}},<br />
} </p>
<hr />
<h2 id="_8">公式推导与注释<a class="toc-link" href="#_8" title="Permanent link">&para;</a></h2>
<p>本文探讨了一个经典的几何概率问题：圆内随机n点在同一个扇形内的概率。这个问题涉及顺序统计量、容斥原理等重要概率论概念，下面我们进行极详细的数学推导。</p>
<h3 id="1">1. 问题背景与动机<a class="toc-link" href="#1" title="Permanent link">&para;</a></h3>
<h4 id="11">1.1 "四鸭共半圆"问题<a class="toc-link" href="#11" title="Permanent link">&para;</a></h4>
<p><strong>原问题</strong>：圆形水池中有4只鸭子随机分布，求它们都在某个半圆内的概率。</p>
<p><strong>数学形式化</strong>：
- 圆内均匀分布的4个点
- 事件：存在某个半圆包含所有4个点
- 求：该事件的概率 $P_4(\theta = \pi)$</p>
<h4 id="12">1.2 问题的推广<a class="toc-link" href="#12" title="Permanent link">&para;</a></h4>
<p><strong>推广1（维度推广）</strong>：
$$d\text{维超球内均匀分布的}n\text{个点位于同一}d\text{维超半球的概率}$$</p>
<p>这已在1962年的论文《A Problem in Geometric Probability》中解决。</p>
<p><strong>推广2（角度推广，本文重点）</strong>：
$$\text{圆内均匀分布的}n\text{个点位于同一圆心角为}\theta\text{的扇形的概率}$$</p>
<h3 id="2">2. 问题的等价转换<a class="toc-link" href="#2" title="Permanent link">&para;</a></h3>
<h4 id="21">2.1 从圆内点到圆周点<a class="toc-link" href="#21" title="Permanent link">&para;</a></h4>
<p><strong>定理 1</strong>：以下两个问题等价：</p>
<p><strong>问题 A</strong>：圆内均匀分布的 $n$ 个点位于某个圆心角为 $\theta$ 的扇形内。</p>
<p><strong>问题 B</strong>：圆周上均匀分布的 $n$ 个点，最长圆弧对应的圆心角 $&gt; 2\pi - \theta$。</p>
<p><strong>证明</strong>：</p>
<p>对于圆内的点，其位置由极坐标 $(r_i, \phi_i)$ 确定，其中：
- $r_i$ 的分布：$p(r) = 2r$（圆内均匀分布）
- $\phi_i$ 的分布：$p(\phi) = \frac{1}{2\pi}$（角度均匀）</p>
<p><strong>关键观察</strong>：是否在同一扇形内只依赖于角度 $\phi_i$，与半径 $r_i$ 无关。</p>
<p>因此，我们可以将每个点"投影"到圆周上（保持角度），问题变为圆周上的问题。</p>
<p><strong>扇形覆盖的等价性</strong>：</p>
<p>$n$ 个点在圆周上的角度为 $\phi_1, \ldots, \phi_n$（不失一般性设 $0 \leq \phi_1 &lt; \phi_2 &lt; \cdots &lt; \phi_n &lt; 2\pi$）。</p>
<p>存在圆心角为 $\theta$ 的扇形包含所有点，等价于：</p>
<p>存在某个起始角 $\alpha$ 使得所有 $\phi_i \in [\alpha, \alpha + \theta] \pmod{2\pi}$。</p>
<p>这等价于：相邻点之间的最大间隔角度 $\leq 2\pi - \theta$。</p>
<p><strong>间隔角度的定义</strong>：</p>
<p>$$\Delta_1 = \phi_2 - \phi_1, \quad \Delta_2 = \phi_3 - \phi_2, \quad \ldots, \quad \Delta_{n-1} = \phi_n - \phi_{n-1}, \quad \Delta_n = 2\pi + \phi_1 - \phi_n$$</p>
<p>注意 $\sum_{i=1}^n \Delta_i = 2\pi$。</p>
<p><strong>等价性</strong>：</p>
<p>$$\text{存在扇形覆盖所有点} \Leftrightarrow \max_{i} \Delta_i \leq 2\pi - \theta \Leftrightarrow \max_i \Delta_i &gt; 2\pi - \theta \text{ 不成立}$$</p>
<p>反过来：</p>
<p>$$P(\text{覆盖}) = 1 - P(\max_i \Delta_i &gt; 2\pi - \theta)$$</p>
<p>但我们要求的正是 $P(\max_i \Delta_i &gt; 2\pi - \theta)$（对于最长弧）。✅</p>
<h4 id="22">2.2 从圆周到线段（归一化）<a class="toc-link" href="#22" title="Permanent link">&para;</a></h4>
<p><strong>定理 2</strong>：问题B等价于：</p>
<p><strong>问题 C</strong>：单位线段 $[0, 1]$ 上均匀随机放置 $n-1$ 个点，将线段分成 $n$ 段，最长段的长度 $&gt; 1 - \frac{\theta}{2\pi}$。</p>
<p><strong>证明</strong>：</p>
<p>定义归一化长度：</p>
<p>$$x_i = \frac{\Delta_i}{2\pi}, \quad i = 1, \ldots, n$$</p>
<p>则：
- $x_i \geq 0$
- $\sum_{i=1}^n x_i = 1$
- $x_i$ 在 $[0, 1]$ 的单纯形上均匀分布</p>
<p><strong>等价性</strong>：</p>
<p>$$\max_i \Delta_i &gt; 2\pi - \theta \Leftrightarrow \max_i x_i &gt; \frac{2\pi - \theta}{2\pi} = 1 - \frac{\theta}{2\pi}$$</p>
<p>记 $c = 1 - \frac{\theta}{2\pi}$，则问题变为求 $P(\max_i x_i &gt; c)$。✅</p>
<h3 id="3">3. 联合分布的严格推导<a class="toc-link" href="#3" title="Permanent link">&para;</a></h3>
<h4 id="31">3.1 问题设定<a class="toc-link" href="#31" title="Permanent link">&para;</a></h4>
<p>在 $[0, 1]$ 上均匀随机放置 $n-1$ 个点 $u_1, \ldots, u_{n-1}$，排序后得到 $0 &lt; u_{(1)} &lt; u_{(2)} &lt; \cdots &lt; u_{(n-1)} &lt; 1$。</p>
<p>定义间隔：</p>
<p>$$x_1 = u_{(1)}, \quad x_2 = u_{(2)} - u_{(1)}, \quad \ldots, \quad x_{n-1} = u_{(n-1)} - u_{(n-2)}, \quad x_n = 1 - u_{(n-1)}$$</p>
<p>约束：$x_i &gt; 0$ 且 $\sum_{i=1}^n x_i = 1$。</p>
<h4 id="32">3.2 联合分布的推导<a class="toc-link" href="#32" title="Permanent link">&para;</a></h4>
<p><strong>定理 3</strong>：$(x_1, \ldots, x_n)$ 的联合概率密度函数为：</p>
<p>$$p_n(x_1, \ldots, x_n) = (n-1)! \quad \text{在单纯形 } \Delta^{n-1} = {x_i \geq 0, \sum x_i = 1} \text{ 上}$$</p>
<p><strong>证明（归纳法）</strong>：</p>
<p><strong>基础情况（$n=2$）</strong>：</p>
<p>一个点 $u_1 \sim \text{Uniform}(0, 1)$，分成两段：
- $x_1 = u_1$
- $x_2 = 1 - u_1$</p>
<p>雅可比变换：</p>
<p>$$\frac{\partial(x_1, x_2)}{\partial u_1} = \begin{vmatrix} 1 \ -1 \end{vmatrix}$$</p>
<p>但 $x_1, x_2$ 有约束 $x_1 + x_2 = 1$，只有1个自由度。</p>
<p>在约束下，$p_2(x_1, x_2) = p_{u_1}(u_1) = 1$（因为 $u_1 = x_1$ 是均匀分布）。✅</p>
<p><strong>归纳步骤（$n-1 \to n$）</strong>：</p>
<p>假设 $p_{n-1}(x_1, \ldots, x_{n-1}) = (n-2)!$。</p>
<p>现在添加第 $n-1$ 个点。考虑两种情况（以 $n=3$ 为例说明逻辑）：</p>
<p>设原来有1个点，分成 $(y_1, y_2)$ 两段，$p_2(y_1, y_2) = 1$。</p>
<p>现在加入第2个点，可能落在：
1. <strong>第1段</strong> $y_1$ 内（概率 $y_1$），将其分成 $(x_1, x_2)$，剩余 $x_3 = y_2$
2. <strong>第2段</strong> $y_2$ 内（概率 $y_2$），将其分成 $(x_2, x_3)$，剩余 $x_1 = y_1$</p>
<p><strong>情况1的密度贡献</strong>：</p>
<p>点落在 $y_1$ 内的位置 $\sim \text{Uniform}(0, y_1)$，设该位置为 $v$，则：
- $x_1 = v$，$x_2 = y_1 - v$，$x_3 = y_2$
- 雅可比：$\frac{1}{y_1}$（归一化到 $[0, y_1]$）
- 贡献：$p_2(y_1, y_2) \cdot y_1 \cdot \frac{1}{y_1} = 1$</p>
<p>但要考虑约束。实际上，通过更仔细的计算：</p>
<p>$$p_3(x_1, x_2, x_3) dx_1 dx_2 = p_2(x_1, x_2+x_3) dx_1 \cdot \frac{dx_2}{x_2+x_3} \cdot (x_2+x_3) + p_2(x_1+x_2, x_3) \cdot \frac{dx_1}{x_1+x_2} \cdot (x_1+x_2) dx_2$$</p>
<p>$$= p_2(x_1, x_2+x_3) dx_1 dx_2 + p_2(x_1+x_2, x_3) dx_1 dx_2$$</p>
<p>$$= 1 \cdot dx_1 dx_2 + 1 \cdot dx_1 dx_2 = 2 dx_1 dx_2$$</p>
<p>因此 $p_3(x_1, x_2, x_3) = 2 = 2!$。✅</p>
<p><strong>一般情况</strong>：</p>
<p>$$p_n(x_1, \ldots, x_n) = \sum_{i=1}^{n-1} p_{n-1}(\text{合并第}i\text{段和第}(i+1)\text{段后的}(n-1)\text{段})$$</p>
<p>由于对称性，每项贡献相同，且有 $n-1$ 项：</p>
<p>$$p_n = (n-1) \cdot p_{n-1} = (n-1) \cdot (n-2)! = (n-1)!$$ ✅</p>
<h4 id="33">3.3 几何解释<a class="toc-link" href="#33" title="Permanent link">&para;</a></h4>
<p><strong>单纯形的体积</strong>：</p>
<p>$n$ 维单纯形 $\Delta^{n-1} = {x \in \mathbb{R}^n: x_i \geq 0, \sum x_i = 1}$ 的 $(n-1)$ 维体积为：</p>
<p>$$\text{Vol}(\Delta^{n-1}) = \frac{1}{(n-1)!}$$</p>
<p><strong>均匀分布</strong>：</p>
<p>如果 $(x_1, \ldots, x_n)$ 在 $\Delta^{n-1}$ 上均匀分布，其密度应为：</p>
<p>$$p(x_1, \ldots, x_n) = \frac{1}{\text{Vol}(\Delta^{n-1})} = (n-1)!$$</p>
<p>这与我们的结果一致！✅</p>
<h3 id="4">4. 边缘分布的计算<a class="toc-link" href="#4" title="Permanent link">&para;</a></h3>
<h4 id="41-k">4.1 任意 $k$ 个变量的边缘分布<a class="toc-link" href="#41-k" title="Permanent link">&para;</a></h4>
<p><strong>定理 4</strong>：对于 $1 \leq k \leq n-1$，前 $k$ 个变量的边缘分布为：</p>
<p>$$p_n(x_1, \ldots, x_k) = \frac{(n-1)!}{(n-k-1)!} \left(1 - \sum_{i=1}^k x_i\right)^{n-k-1}$$</p>
<p><strong>证明</strong>：</p>
<p>$$p_n(x_1, \ldots, x_k) = \int_0^{\infty} \cdots \int_0^{\infty} p_n(x_1, \ldots, x_n) \, dx_{k+1} \cdots dx_{n-1} \cdot \delta\left(\sum_{i=1}^n x_i - 1\right)$$</p>
<p>由于 $x_n = 1 - \sum_{i=1}^{n-1} x_i$，实际上是 $(n-1)$ 维积分。</p>
<p><strong>逐次积分</strong>：</p>
<p>记 $S_k = \sum_{i=1}^k x_i$。</p>
<p>首先对 $x_{n-1}$ 积分，约束为 $x_{n-1} \in [0, 1 - S_{n-2}]$：</p>
<p>$$\int_0^{1-S_{n-2}} (n-1)! \, dx_{n-1} = (n-1)! \cdot (1 - S_{n-2})$$</p>
<p>然后对 $x_{n-2}$ 积分，约束为 $x_{n-2} \in [0, 1 - S_{n-3}]$：</p>
<p>$$\int_0^{1-S_{n-3}} (n-1)! (1 - S_{n-2}) \, dx_{n-2} = (n-1)! \int_0^{1-S_{n-3}} (1 - S_{n-3} - x_{n-2}) \, dx_{n-2}$$</p>
<p>$$= (n-1)! \left[(1-S_{n-3}) x_{n-2} - \frac{x_{n-2}^2}{2}\right]<em n-3="n-3">0^{1-S</em>$$}} = (n-1)! \cdot \frac{(1-S_{n-3})^2}{2</p>
<p><strong>归纳模式</strong>：</p>
<p>经过 $n-k-1$ 次积分后：</p>
<p>$$p_n(x_1, \ldots, x_k) = (n-1)! \cdot \frac{(1-S_k)^{n-k-1}}{(n-k-1)!} = \frac{(n-1)!}{(n-k-1)!} (1-S_k)^{n-k-1}$$ ✅</p>
<h4 id="42">4.2 联合超出概率<a class="toc-link" href="#42" title="Permanent link">&para;</a></h4>
<p><strong>定理 5</strong>：对于 $c_1, \ldots, c_k \geq 0$ 满足 $\sum c_i \leq 1$：</p>
<p>$$P_n(x_1 &gt; c_1, \ldots, x_k &gt; c_k) = \left(1 - \sum_{i=1}^k c_i\right)^{n-1}$$</p>
<p><strong>证明</strong>：</p>
<p>$$P_n(x_1 &gt; c_1, \ldots, x_k &gt; c_k) = \int_{c_1}^{\infty} \cdots \int_{c_k}^{\infty} p_n(x_1, \ldots, x_k) \prod_{i=1}^{k-1} dx_i$$</p>
<p>（注意由于约束，实际上限是有限的）</p>
<p>准确地：</p>
<p>$$= \int_{c_1}^{1-\sum_{j=2}^k c_j} \int_{c_2}^{1-x_1-\sum_{j=3}^k c_j} \cdots \int_{c_k}^{1-\sum_{i=1}^{k-1} x_i} p_n(x_1, \ldots, x_k) \, dx_k \cdots dx_1$$</p>
<p><strong>逐次积分（从内到外）</strong>：</p>
<p>$$\int_{c_k}^{1-S_{k-1}} \frac{(n-1)!}{(n-k-1)!} (1-S_{k-1}-x_k)^{n-k-1} dx_k$$</p>
<p>令 $t = 1 - S_{k-1} - x_k$，则 $dt = -dx_k$：</p>
<p>$$= \frac{(n-1)!}{(n-k-1)!} \int_0^{1-S_{k-1}-c_k} t^{n-k-1} dt = \frac{(n-1)!}{(n-k-1)!} \cdot \frac{(1-S_{k-1}-c_k)^{n-k}}{n-k}$$</p>
<p>$$= \frac{(n-1)!}{(n-k)!} (1-S_{k-1}-c_k)^{n-k}$$</p>
<p>继续对 $x_{k-1}$ 积分，类似地可得：</p>
<p>$$\frac{(n-1)!}{(n-k+1)!} (1-S_{k-2}-c_{k-1}-c_k)^{n-k+1}$$</p>
<p><strong>最终结果</strong>（经过 $k$ 次积分）：</p>
<p>$$P_n(x_1 &gt; c_1, \ldots, x_k &gt; c_k) = \frac{(n-1)!}{(n-1)!} \left(1 - \sum_{i=1}^k c_i\right)^{n-1} = \left(1 - \sum_{i=1}^k c_i\right)^{n-1}$$ ✅</p>
<p><strong>特例验证</strong>：</p>
<p>$$P_n(x_1 &gt; c_1) = (1 - c_1)^{n-1}$$</p>
<p>这符合直觉：第一段 $&gt; c_1$ 意味着第一个点落在 $[c_1, 1]$，概率为 $1-c_1$，其余 $n-2$ 个点独立，总概率 $(1-c_1)^{n-1}$（精确计算更复杂，但结果一致）。</p>
<h3 id="5">5. 容斥原理的应用<a class="toc-link" href="#5" title="Permanent link">&para;</a></h3>
<h4 id="51-inclusion-exclusion-principle">5.1 容斥原理（Inclusion-Exclusion Principle）<a class="toc-link" href="#51-inclusion-exclusion-principle" title="Permanent link">&para;</a></h4>
<p><strong>原理</strong>：对于事件 $A_1, \ldots, A_n$：</p>
<p>$$P\left(\bigcup_{i=1}^n A_i\right) = \sum_{k=1}^n (-1)^{k-1} \sum_{1 \leq i_1 &lt; \cdots &lt; i_k \leq n} P(A_{i_1} \cap \cdots \cap A_{i_k})$$</p>
<h4 id="52">5.2 应用于最大值问题<a class="toc-link" href="#52" title="Permanent link">&para;</a></h4>
<p>定义事件：$A_i = {x_i &gt; c}$。</p>
<p>则：</p>
<p>$${\max(x_1, \ldots, x_n) &gt; c} = A_1 \cup A_2 \cup \cdots \cup A_n$$</p>
<p><strong>容斥展开</strong>：</p>
<p>$$P(\max(x_1, \ldots, x_n) &gt; c) = \sum_{k=1}^n (-1)^{k-1} \sum_{1 \leq i_1 &lt; \cdots &lt; i_k \leq n} P(x_{i_1} &gt; c, \ldots, x_{i_k} &gt; c)$$</p>
<p><strong>对称性</strong>：</p>
<p>由于联合分布对所有变量对称（都是从同一过程产生），任意选择 $k$ 个变量的联合概率都相同：</p>
<p>$$P(x_{i_1} &gt; c, \ldots, x_{i_k} &gt; c) = P(x_1 &gt; c, \ldots, x_k &gt; c) = (1 - kc)^{n-1}$$</p>
<p>（当 $kc \leq 1$ 时有效；否则概率为0）</p>
<p><strong>组合计数</strong>：</p>
<p>从 $n$ 个变量中选 $k$ 个的方法数为 $\binom{n}{k}$。</p>
<h4 id="53">5.3 最终公式<a class="toc-link" href="#53" title="Permanent link">&para;</a></h4>
<p><strong>定理 6</strong>（最大值分布）：</p>
<p>$$P_n(\max(x_1, \ldots, x_n) &gt; c) = \sum_{k=1}^{\lfloor 1/c \rfloor} (-1)^{k-1} \binom{n}{k} (1 - kc)^{n-1}$$</p>
<p>其中求和上限 $\lfloor 1/c \rfloor$ 确保 $1 - kc &gt; 0$。</p>
<p><strong>展开形式</strong>：</p>
<p>$$= \binom{n}{1}(1-c)^{n-1} - \binom{n}{2}(1-2c)^{n-1} + \binom{n}{3}(1-3c)^{n-1} - \cdots$$</p>
<p><strong>特殊情况分析</strong>：</p>
<p><strong>情况1</strong>（$c &gt; 1/2$）：</p>
<p>此时 $1 - 2c &lt; 0$，只有第一项非零：</p>
<p>$$P_n(\max &gt; c) = n(1-c)^{n-1}$$</p>
<p><strong>情况2</strong>（$1/3 &lt; c \leq 1/2$）：</p>
<p>$$P_n(\max &gt; c) = n(1-c)^{n-1} - \binom{n}{2}(1-2c)^{n-1}$$</p>
<p><strong>情况3</strong>（$c \leq 1/n$）：</p>
<p>所有 $n$ 项都存在。由抽屉原理，$\max \geq 1/n$ 必然成立，所以：</p>
<p>$$\sum_{k=1}^n (-1)^{k-1} \binom{n}{k} (1-kc)^{n-1} = 1 \quad \text{当 } c \leq 1/n$$</p>
<h3 id="6">6. 回到原问题<a class="toc-link" href="#6" title="Permanent link">&para;</a></h3>
<h4 id="61">6.1 参数替换<a class="toc-link" href="#61" title="Permanent link">&para;</a></h4>
<p>回到圆内 $n$ 点在圆心角 $\theta$ 扇形内的问题：</p>
<p>$$c = 1 - \frac{\theta}{2\pi}$$</p>
<p>因此：</p>
<p>$$P_n(\text{存在扇形覆盖}) = P_n\left(\max &gt; 1 - \frac{\theta}{2\pi}\right)$$</p>
<h4 id="62">6.2 "四鸭共半圆"的答案<a class="toc-link" href="#62" title="Permanent link">&para;</a></h4>
<p>$n = 4$，$\theta = \pi$，$c = 1 - \frac{\pi}{2\pi} = \frac{1}{2}$。</p>
<p>由于 $c = 1/2$，只有第一项：</p>
<p>$$P_4\left(\max &gt; \frac{1}{2}\right) = 4 \left(1 - \frac{1}{2}\right)^{4-1} = 4 \cdot \frac{1}{8} = \frac{1}{2}$$</p>
<p><strong>答案：$\boxed{\frac{1}{2}}$</strong></p>
<h4 id="63">6.3 一般公式<a class="toc-link" href="#63" title="Permanent link">&para;</a></h4>
<p>$$P_n(\theta) = \sum_{k=1}^{\lfloor 2\pi/(2\pi - \theta) \rfloor} (-1)^{k-1} \binom{n}{k} \left(\frac{\theta}{2\pi}\right)^{n-1} \left(\frac{2\pi - k(2\pi - \theta)}{2\pi - \theta}\right)^{n-1}$$</p>
<p>简化：</p>
<p>$$P_n(\theta) = \sum_{k=1}^{K_\theta} (-1)^{k-1} \binom{n}{k} \left(1 - k\left(1 - \frac{\theta}{2\pi}\right)\right)^{n-1}$$</p>
<p>其中 $K_\theta = \lfloor 2\pi/(2\pi - \theta) \rfloor$。</p>
<p><strong>特殊情况</strong>：</p>
<ul>
<li>$\theta &lt; \pi$：$K_\theta = 1$，$P_n(\theta) = n \left(\frac{\theta}{2\pi}\right)^{n-1}$</li>
<li>$\theta = \pi$：$K_\pi = 2$</li>
<li>$\theta \to 2\pi$：$K_\theta \to n$（所有项都需要）</li>
</ul>
<h3 id="7">7. 顺序统计量理论<a class="toc-link" href="#7" title="Permanent link">&para;</a></h3>
<h4 id="71-cdf">7.1 最大值的累积分布函数（CDF）<a class="toc-link" href="#71-cdf" title="Permanent link">&para;</a></h4>
<p>对于 i.i.d. 随机变量 $X_1, \ldots, X_n \sim F(x)$：</p>
<p>$$F_{\max}(x) = P(\max(X_1, \ldots, X_n) \leq x) = \prod_{i=1}^n P(X_i \leq x) = [F(x)]^n$$</p>
<p>对于我们的问题，单个 $x_i$ 的边缘分布（通过积分联合分布得到）需要仔细计算。</p>
<p>实际上，由于联合分布的特殊性（Dirichlet 分布），直接推导更复杂，容斥原理提供了更简洁的路径。</p>
<h4 id="72-dirichlet">7.2 与 Dirichlet 分布的联系<a class="toc-link" href="#72-dirichlet" title="Permanent link">&para;</a></h4>
<p><strong>定理 7</strong>：$(x_1, \ldots, x_n) \sim \text{Dirichlet}(1, 1, \ldots, 1) = \text{Dirichlet}(\mathbf{1}_n)$。</p>
<p><strong>Dirichlet 分布</strong>的密度：</p>
<p>$$p(x_1, \ldots, x_n) = \frac{\Gamma(\sum \alpha_i)}{\prod \Gamma(\alpha_i)} \prod x_i^{\alpha_i - 1}$$</p>
<p>当 $\alpha_i = 1$ 时：</p>
<p>$$p(x_1, \ldots, x_n) = \frac{\Gamma(n)}{[\Gamma(1)]^n} \prod x_i^{0} = (n-1)!$$</p>
<p>（在单纯形上，考虑约束后实际是 $(n-1)$ 维）</p>
<p>这证实了我们之前的结果！</p>
<h4 id="73">7.3 期望值<a class="toc-link" href="#73" title="Permanent link">&para;</a></h4>
<p><strong>最大段的期望长度</strong>：</p>
<p>$$\mathbb{E}[\max(x_1, \ldots, x_n)] = \int_0^1 P(\max &gt; c) \, dc$$</p>
<p>$$= \int_0^1 \sum_{k=1}^{\lfloor 1/c \rfloor} (-1)^{k-1} \binom{n}{k} (1-kc)^{n-1} dc$$</p>
<p>这个积分比较复杂，但可以分段计算：</p>
<p>$$= \int_{1/2}^1 n(1-c)^{n-1} dc + \int_{1/3}^{1/2} \left[n(1-c)^{n-1} - \binom{n}{2}(1-2c)^{n-1}\right] dc + \cdots$$</p>
<p><strong>已知结果</strong>（通过复杂计算）：</p>
<p>$$\mathbb{E}[\max] = H_n / n$$</p>
<p>其中 $H_n = 1 + \frac{1}{2} + \cdots + \frac{1}{n}$ 是调和数。</p>
<h3 id="8">8. 数值验证与示例<a class="toc-link" href="#8" title="Permanent link">&para;</a></h3>
<h4 id="81-n4-theta-pi">8.1 $n=4$, $\theta = \pi$（四鸭共半圆）<a class="toc-link" href="#81-n4-theta-pi" title="Permanent link">&para;</a></h4>
<p>$$c = 1 - \frac{\pi}{2\pi} = \frac{1}{2}$$</p>
<p>$$P_4 = \binom{4}{1} \left(\frac{1}{2}\right)^3 = 4 \cdot \frac{1}{8} = \boxed{\frac{1}{2}}$$</p>
<h4 id="82-n4-theta-frac2pi3">8.2 $n=4$, $\theta = \frac{2\pi}{3}$<a class="toc-link" href="#82-n4-theta-frac2pi3" title="Permanent link">&para;</a></h4>
<p>$$c = 1 - \frac{1}{3} = \frac{2}{3} &gt; \frac{1}{2}$$</p>
<p>$$P_4 = 4 \left(\frac{1}{3}\right)^3 = \frac{4}{27} \approx 0.148$$</p>
<h4 id="83-n4-theta-frac3pi2">8.3 $n=4$, $\theta = \frac{3\pi}{2}$<a class="toc-link" href="#83-n4-theta-frac3pi2" title="Permanent link">&para;</a></h4>
<p>$$c = 1 - \frac{3}{4} = \frac{1}{4}$$</p>
<p>$$\lfloor 1/c \rfloor = 4$$，所有项都存在：</p>
<p>$$P_4 = 4 \cdot \left(\frac{3}{4}\right)^3 - 6 \cdot \left(\frac{1}{2}\right)^3 + 4 \cdot \left(\frac{1}{4}\right)^3 - 0$$</p>
<p>$$= 4 \cdot \frac{27}{64} - 6 \cdot \frac{1}{8} + 4 \cdot \frac{1}{64}$$</p>
<p>$$= \frac{108}{64} - \frac{48}{64} + \frac{4}{64} = \frac{64}{64} = 1$$</p>
<p>符合预期（$\theta &gt; \pi$ 意味着扇形超过半圆，必然能覆盖）。</p>
<h3 id="9">9. 恒等式的代数验证<a class="toc-link" href="#9" title="Permanent link">&para;</a></h3>
<p><strong>定理 8</strong>：对于 $c \leq 1/n$：</p>
<p>$$\sum_{k=1}^n (-1)^{k-1} \binom{n}{k} (1-kc)^{n-1} = 1$$</p>
<p><strong>证明（生成函数方法）</strong>：</p>
<p>考虑多项式：</p>
<p>$$f(x) = \sum_{k=1}^n (-1)^{k-1} \binom{n}{k} (1-kx)^{n-1}$$</p>
<p>我们需要证明当 $x \leq 1/n$ 时，$f(x) = 1$。</p>
<p><strong>关键观察</strong>：由于 $f(x)$ 是多项式，如果能证明它在某个区间恒为1，则它必是常数1（因为非常数多项式最多在有限个点等于常数）。</p>
<p>但这个论证不够严密。更严格的方法是直接展开计算（涉及二项式定理和复杂的组合恒等式）。</p>
<p><strong>另一角度（概率论证）</strong>：</p>
<p>当 $c = 1/n$ 时，由抽屉原理，$n$ 段中至少有一段 $\geq 1/n$，所以：</p>
<p>$$P(\max \geq 1/n) = 1$$</p>
<p>连续性论证表明对 $c &lt; 1/n$ 也成立。✅</p>
<h3 id="10">10. 应用与扩展<a class="toc-link" href="#10" title="Permanent link">&para;</a></h3>
<h4 id="101">10.1 生日问题的推广<a class="toc-link" href="#101" title="Permanent link">&para;</a></h4>
<p>经典生日问题：$n$ 个人，至少两人同一天生日的概率。</p>
<p>本问题的对偶：$n$ 个点在圆周，最大间隔的分布。</p>
<h4 id="102">10.2 机器学习中的应用<a class="toc-link" href="#102" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>熵估计</strong>：最邻近估计法依赖顺序统计量</li>
<li><strong>生成模型</strong>：Gumbel-Max 技巧（参见本系列其他文章）</li>
<li><strong>鲁棒性分析</strong>：数据分布的极值行为</li>
</ul>
<h3 id="11_1">11. 总结<a class="toc-link" href="#11_1" title="Permanent link">&para;</a></h3>
<p>本文通过以下步骤解决了圆内随机 $n$ 点在扇形内的概率问题：</p>
<ol>
<li><strong>等价转换</strong>：圆内点 → 圆周点 → 线段分割</li>
<li><strong>联合分布</strong>：证明间隔长度服从 Dirichlet$(1, \ldots, 1)$，密度为 $(n-1)!$</li>
<li><strong>边缘分布</strong>：推导任意 $k$ 个变量的边缘分布和联合超出概率</li>
<li><strong>容斥原理</strong>：应用于计算最大值超过阈值的概率</li>
<li><strong>最终公式</strong>：</li>
</ol>
<p>$$P_n(\max &gt; c) = \sum_{k=1}^{\lfloor 1/c \rfloor} (-1)^{k-1} \binom{n}{k} (1-kc)^{n-1}$$</p>
<p><strong>关键洞察</strong>：
- 均匀随机分割导致对称的 Dirichlet 分布
- 容斥原理优雅地处理了最大值的非独立性
- 几何概率问题可转化为组合优化问题</p>
                </div>

                <!-- Previous/Next Navigation -->
                <nav class="post-navigation" aria-label="文章导航">
                    <div class="row g-3">
                        <div class="col-6">
                            
                            <a href="生成扩散模型漫谈十三从万有引力到扩散模型.html" class="nav-link-prev">
                                <div class="nav-direction"><i class="fas fa-chevron-left"></i> 上一篇</div>
                                <div class="nav-title">#58 生成扩散模型漫谈（十三）：从万有引力到扩散模型</div>
                            </a>
                            
                        </div>
                        <div class="col-6">
                            
                            <a href="利用cur分解加速交互式相似度模型的检索.html" class="nav-link-next">
                                <div class="nav-direction">下一篇 <i class="fas fa-chevron-right"></i></div>
                                <div class="nav-title">#60 利用CUR分解加速交互式相似度模型的检索</div>
                            </a>
                            
                        </div>
                    </div>
                </nav>

                <!-- Back to Home -->
                <div class="text-center mt-4 mb-4">
                    <a href="../index.html" class="btn btn-outline-primary">
                        <i class="fas fa-arrow-left"></i> 返回首页
                    </a>
                </div>
            </div>

            <!-- Sidebar (TOC) -->
            <div class="col-lg-3">
                <aside class="sidebar">
                    
                    <div class="toc-sidebar">
                        <h5 class="toc-title"><i class="fas fa-list"></i> 目录</h5>
                        <div class="toc-content">
                            <div class="toc">
<ul>
<li><a href="#n">圆内随机n点在同一个圆心角为θ的扇形的概率</a><ul>
<li><a href="#_1">题目转换</a></li>
<li><a href="#_2">分布求解</a><ul>
<li><a href="#_3">联合分布</a></li>
<li><a href="#_4">边缘分布</a></li>
<li><a href="#_5">容斥原理</a></li>
</ul>
</li>
<li><a href="#_6">答案分析</a></li>
<li><a href="#_7">文章小结</a></li>
<li><a href="#_8">公式推导与注释</a><ul>
<li><a href="#1">1. 问题背景与动机</a></li>
<li><a href="#2">2. 问题的等价转换</a></li>
<li><a href="#3">3. 联合分布的严格推导</a></li>
<li><a href="#4">4. 边缘分布的计算</a></li>
<li><a href="#5">5. 容斥原理的应用</a></li>
<li><a href="#6">6. 回到原问题</a></li>
<li><a href="#7">7. 顺序统计量理论</a></li>
<li><a href="#8">8. 数值验证与示例</a></li>
<li><a href="#9">9. 恒等式的代数验证</a></li>
<li><a href="#10">10. 应用与扩展</a></li>
<li><a href="#11_1">11. 总结</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>

                        </div>
                        <div class="toc-actions">
                            <button class="btn btn-sm btn-outline-secondary" onclick="expandAll()">
                                <i class="fas fa-expand"></i> 全部展开
                            </button>
                            <button class="btn btn-sm btn-outline-secondary" onclick="collapseAll()">
                                <i class="fas fa-compress"></i> 全部折叠
                            </button>
                        </div>
                    </div>
                    

                    <!-- Back to Top Button -->
                    <button id="backToTop" class="back-to-top" title="回到顶部">
                        <i class="fas fa-arrow-up"></i>
                    </button>
                </aside>
            </div>
        </div>
    </article>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>
                博客来源: <a href="https://spaces.ac.cn" target="_blank">科学空间</a> |
                内容经过整理并添加详细数学推导
            </p>
            <p>
                Powered by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
            </p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

    <!-- Syntax highlighting -->
    <script>hljs.highlightAll();</script>

    <!-- Back to top functionality -->
    <script>
        // Show/hide back to top button based on scroll position
        window.addEventListener('scroll', function() {
            const backToTop = document.getElementById('backToTop');
            if (window.pageYOffset > 300) {
                backToTop.classList.add('show');
            } else {
                backToTop.classList.remove('show');
            }
        });

        // Smooth scroll to top
        document.getElementById('backToTop').addEventListener('click', function() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        });

        // Sticky TOC sidebar
        window.addEventListener('scroll', function() {
            const sidebar = document.querySelector('.sidebar');
            if (!sidebar) return;

            const sidebarTop = sidebar.offsetTop;
            const scrollTop = window.pageYOffset;

            if (scrollTop > sidebarTop - 20) {
                sidebar.classList.add('sticky');
            } else {
                sidebar.classList.remove('sticky');
            }
        });
    </script>
</body>
</html>